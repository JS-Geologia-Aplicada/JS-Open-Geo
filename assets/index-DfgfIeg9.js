var qT=n=>{throw TypeError(n)};var r_=(n,t,e)=>t.has(n)||qT("Cannot "+e);var Xn=(n,t,e)=>(r_(n,t,"read from private field"),e?e.call(n):t.get(n)),no=(n,t,e)=>t.has(n)?qT("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),is=(n,t,e,i)=>(r_(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),io=(n,t,e)=>(r_(n,t,"access private method"),e);var KT=(n,t,e,i)=>({set _(r){is(n,t,r,e)},get _(){return Xn(n,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();var Dg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ku(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function VM(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function i(){var r=!1;try{r=this instanceof i}catch{}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),e}var s_={exports:{}},rp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZT;function WM(){if(ZT)return rp;ZT=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,r,s){var a=null;if(s!==void 0&&(a=""+s),r.key!==void 0&&(a=""+r.key),"key"in r){s={};for(var l in r)l!=="key"&&(s[l]=r[l])}else s=r;return r=s.ref,{$$typeof:n,type:i,key:a,ref:r!==void 0?r:null,props:s}}return rp.Fragment=t,rp.jsx=e,rp.jsxs=e,rp}var QT;function XM(){return QT||(QT=1,s_.exports=WM()),s_.exports}var M=XM(),a_={exports:{}},Ke={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JT;function YM(){if(JT)return Ke;JT=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function m(P){return P===null||typeof P!="object"?null:(P=p&&P[p]||P["@@iterator"],typeof P=="function"?P:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,x={};function _(P,X,V){this.props=P,this.context=X,this.refs=x,this.updater=V||g}_.prototype.isReactComponent={},_.prototype.setState=function(P,X){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,X,"setState")},_.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function b(){}b.prototype=_.prototype;function S(P,X,V){this.props=P,this.context=X,this.refs=x,this.updater=V||g}var A=S.prototype=new b;A.constructor=S,y(A,_.prototype),A.isPureReactComponent=!0;var C=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function D(P,X,V,it,ht,yt){return V=yt.ref,{$$typeof:n,type:P,key:X,ref:V!==void 0?V:null,props:yt}}function L(P,X){return D(P.type,X,void 0,void 0,void 0,P.props)}function I(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function z(P){var X={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(V){return X[V]})}var j=/\/+/g;function B(P,X){return typeof P=="object"&&P!==null&&P.key!=null?z(""+P.key):X.toString(36)}function tt(){}function k(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(tt,tt):(P.status="pending",P.then(function(X){P.status==="pending"&&(P.status="fulfilled",P.value=X)},function(X){P.status==="pending"&&(P.status="rejected",P.reason=X)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function et(P,X,V,it,ht){var yt=typeof P;(yt==="undefined"||yt==="boolean")&&(P=null);var Rt=!1;if(P===null)Rt=!0;else switch(yt){case"bigint":case"string":case"number":Rt=!0;break;case"object":switch(P.$$typeof){case n:case t:Rt=!0;break;case d:return Rt=P._init,et(Rt(P._payload),X,V,it,ht)}}if(Rt)return ht=ht(P),Rt=it===""?"."+B(P,0):it,C(ht)?(V="",Rt!=null&&(V=Rt.replace(j,"$&/")+"/"),et(ht,X,V,"",function(lt){return lt})):ht!=null&&(I(ht)&&(ht=L(ht,V+(ht.key==null||P&&P.key===ht.key?"":(""+ht.key).replace(j,"$&/")+"/")+Rt)),X.push(ht)),1;Rt=0;var Et=it===""?".":it+":";if(C(P))for(var G=0;G<P.length;G++)it=P[G],yt=Et+B(it,G),Rt+=et(it,X,V,yt,ht);else if(G=m(P),typeof G=="function")for(P=G.call(P),G=0;!(it=P.next()).done;)it=it.value,yt=Et+B(it,G++),Rt+=et(it,X,V,yt,ht);else if(yt==="object"){if(typeof P.then=="function")return et(k(P),X,V,it,ht);throw X=String(P),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return Rt}function K(P,X,V){if(P==null)return P;var it=[],ht=0;return et(P,it,"","",function(yt){return X.call(V,yt,ht++)}),it}function q(P){if(P._status===-1){var X=P._result;X=X(),X.then(function(V){(P._status===0||P._status===-1)&&(P._status=1,P._result=V)},function(V){(P._status===0||P._status===-1)&&(P._status=2,P._result=V)}),P._status===-1&&(P._status=0,P._result=X)}if(P._status===1)return P._result.default;throw P._result}var _t=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function at(){}return Ke.Children={map:K,forEach:function(P,X,V){K(P,function(){X.apply(this,arguments)},V)},count:function(P){var X=0;return K(P,function(){X++}),X},toArray:function(P){return K(P,function(X){return X})||[]},only:function(P){if(!I(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Ke.Component=_,Ke.Fragment=e,Ke.Profiler=r,Ke.PureComponent=S,Ke.StrictMode=i,Ke.Suspense=u,Ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Ke.__COMPILER_RUNTIME={__proto__:null,c:function(P){return O.H.useMemoCache(P)}},Ke.cache=function(P){return function(){return P.apply(null,arguments)}},Ke.cloneElement=function(P,X,V){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var it=y({},P.props),ht=P.key,yt=void 0;if(X!=null)for(Rt in X.ref!==void 0&&(yt=void 0),X.key!==void 0&&(ht=""+X.key),X)!N.call(X,Rt)||Rt==="key"||Rt==="__self"||Rt==="__source"||Rt==="ref"&&X.ref===void 0||(it[Rt]=X[Rt]);var Rt=arguments.length-2;if(Rt===1)it.children=V;else if(1<Rt){for(var Et=Array(Rt),G=0;G<Rt;G++)Et[G]=arguments[G+2];it.children=Et}return D(P.type,ht,void 0,void 0,yt,it)},Ke.createContext=function(P){return P={$$typeof:a,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:s,_context:P},P},Ke.createElement=function(P,X,V){var it,ht={},yt=null;if(X!=null)for(it in X.key!==void 0&&(yt=""+X.key),X)N.call(X,it)&&it!=="key"&&it!=="__self"&&it!=="__source"&&(ht[it]=X[it]);var Rt=arguments.length-2;if(Rt===1)ht.children=V;else if(1<Rt){for(var Et=Array(Rt),G=0;G<Rt;G++)Et[G]=arguments[G+2];ht.children=Et}if(P&&P.defaultProps)for(it in Rt=P.defaultProps,Rt)ht[it]===void 0&&(ht[it]=Rt[it]);return D(P,yt,void 0,void 0,null,ht)},Ke.createRef=function(){return{current:null}},Ke.forwardRef=function(P){return{$$typeof:l,render:P}},Ke.isValidElement=I,Ke.lazy=function(P){return{$$typeof:d,_payload:{_status:-1,_result:P},_init:q}},Ke.memo=function(P,X){return{$$typeof:f,type:P,compare:X===void 0?null:X}},Ke.startTransition=function(P){var X=O.T,V={};O.T=V;try{var it=P(),ht=O.S;ht!==null&&ht(V,it),typeof it=="object"&&it!==null&&typeof it.then=="function"&&it.then(at,_t)}catch(yt){_t(yt)}finally{O.T=X}},Ke.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Ke.use=function(P){return O.H.use(P)},Ke.useActionState=function(P,X,V){return O.H.useActionState(P,X,V)},Ke.useCallback=function(P,X){return O.H.useCallback(P,X)},Ke.useContext=function(P){return O.H.useContext(P)},Ke.useDebugValue=function(){},Ke.useDeferredValue=function(P,X){return O.H.useDeferredValue(P,X)},Ke.useEffect=function(P,X,V){var it=O.H;if(typeof V=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return it.useEffect(P,X)},Ke.useId=function(){return O.H.useId()},Ke.useImperativeHandle=function(P,X,V){return O.H.useImperativeHandle(P,X,V)},Ke.useInsertionEffect=function(P,X){return O.H.useInsertionEffect(P,X)},Ke.useLayoutEffect=function(P,X){return O.H.useLayoutEffect(P,X)},Ke.useMemo=function(P,X){return O.H.useMemo(P,X)},Ke.useOptimistic=function(P,X){return O.H.useOptimistic(P,X)},Ke.useReducer=function(P,X,V){return O.H.useReducer(P,X,V)},Ke.useRef=function(P){return O.H.useRef(P)},Ke.useState=function(P){return O.H.useState(P)},Ke.useSyncExternalStore=function(P,X,V){return O.H.useSyncExternalStore(P,X,V)},Ke.useTransition=function(){return O.H.useTransition()},Ke.version="19.1.0",Ke}var tC;function U1(){return tC||(tC=1,a_.exports=YM()),a_.exports}var U=U1();const Je=ku(U);var o_={exports:{}},sp={},l_={exports:{}},c_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eC;function qM(){return eC||(eC=1,function(n){function t(K,q){var _t=K.length;K.push(q);t:for(;0<_t;){var at=_t-1>>>1,P=K[at];if(0<r(P,q))K[at]=q,K[_t]=P,_t=at;else break t}}function e(K){return K.length===0?null:K[0]}function i(K){if(K.length===0)return null;var q=K[0],_t=K.pop();if(_t!==q){K[0]=_t;t:for(var at=0,P=K.length,X=P>>>1;at<X;){var V=2*(at+1)-1,it=K[V],ht=V+1,yt=K[ht];if(0>r(it,_t))ht<P&&0>r(yt,it)?(K[at]=yt,K[ht]=_t,at=ht):(K[at]=it,K[V]=_t,at=V);else if(ht<P&&0>r(yt,_t))K[at]=yt,K[ht]=_t,at=ht;else break t}}return q}function r(K,q){var _t=K.sortIndex-q.sortIndex;return _t!==0?_t:K.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var u=[],f=[],d=1,p=null,m=3,g=!1,y=!1,x=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function C(K){for(var q=e(f);q!==null;){if(q.callback===null)i(f);else if(q.startTime<=K)i(f),q.sortIndex=q.expirationTime,t(u,q);else break;q=e(f)}}function O(K){if(x=!1,C(K),!y)if(e(u)!==null)y=!0,N||(N=!0,B());else{var q=e(f);q!==null&&et(O,q.startTime-K)}}var N=!1,D=-1,L=5,I=-1;function z(){return _?!0:!(n.unstable_now()-I<L)}function j(){if(_=!1,N){var K=n.unstable_now();I=K;var q=!0;try{t:{y=!1,x&&(x=!1,S(D),D=-1),g=!0;var _t=m;try{e:{for(C(K),p=e(u);p!==null&&!(p.expirationTime>K&&z());){var at=p.callback;if(typeof at=="function"){p.callback=null,m=p.priorityLevel;var P=at(p.expirationTime<=K);if(K=n.unstable_now(),typeof P=="function"){p.callback=P,C(K),q=!0;break e}p===e(u)&&i(u),C(K)}else i(u);p=e(u)}if(p!==null)q=!0;else{var X=e(f);X!==null&&et(O,X.startTime-K),q=!1}}break t}finally{p=null,m=_t,g=!1}q=void 0}}finally{q?B():N=!1}}}var B;if(typeof A=="function")B=function(){A(j)};else if(typeof MessageChannel<"u"){var tt=new MessageChannel,k=tt.port2;tt.port1.onmessage=j,B=function(){k.postMessage(null)}}else B=function(){b(j,0)};function et(K,q){D=b(function(){K(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(K){K.callback=null},n.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<K?Math.floor(1e3/K):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(K){switch(m){case 1:case 2:case 3:var q=3;break;default:q=m}var _t=m;m=q;try{return K()}finally{m=_t}},n.unstable_requestPaint=function(){_=!0},n.unstable_runWithPriority=function(K,q){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var _t=m;m=K;try{return q()}finally{m=_t}},n.unstable_scheduleCallback=function(K,q,_t){var at=n.unstable_now();switch(typeof _t=="object"&&_t!==null?(_t=_t.delay,_t=typeof _t=="number"&&0<_t?at+_t:at):_t=at,K){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=_t+P,K={id:d++,callback:q,priorityLevel:K,startTime:_t,expirationTime:P,sortIndex:-1},_t>at?(K.sortIndex=_t,t(f,K),e(u)===null&&K===e(f)&&(x?(S(D),D=-1):x=!0,et(O,_t-at))):(K.sortIndex=P,t(u,K),y||g||(y=!0,N||(N=!0,B()))),K},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(K){var q=m;return function(){var _t=m;m=q;try{return K.apply(this,arguments)}finally{m=_t}}}}(c_)),c_}var nC;function KM(){return nC||(nC=1,l_.exports=qM()),l_.exports}var u_={exports:{}},pr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iC;function ZM(){if(iC)return pr;iC=1;var n=U1();function t(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(u,f,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:u,containerInfo:f,implementation:d}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return pr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,pr.createPortal=function(u,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return s(u,f,null,d)},pr.flushSync=function(u){var f=a.T,d=i.p;try{if(a.T=null,i.p=2,u)return u()}finally{a.T=f,i.p=d,i.d.f()}},pr.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(u,f))},pr.prefetchDNS=function(u){typeof u=="string"&&i.d.D(u)},pr.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,g=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?i.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:g}):d==="script"&&i.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:g,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},pr.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);i.d.M(u,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(u)},pr.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin);i.d.L(u,d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},pr.preloadModule=function(u,f){if(typeof u=="string")if(f){var d=l(f.as,f.crossOrigin);i.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(u)},pr.requestFormReset=function(u){i.d.r(u)},pr.unstable_batchedUpdates=function(u,f){return u(f)},pr.useFormState=function(u,f,d){return a.H.useFormState(u,f,d)},pr.useFormStatus=function(){return a.H.useHostTransitionStatus()},pr.version="19.1.0",pr}var rC;function qO(){if(rC)return u_.exports;rC=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),u_.exports=ZM(),u_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sC;function QM(){if(sC)return sp;sC=1;var n=KM(),t=U1(),e=qO();function i(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var c=o,h=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(h=c.return),o=c.return;while(o)}return c.tag===3?h:null}function a(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function l(o){if(s(o)!==o)throw Error(i(188))}function u(o){var c=o.alternate;if(!c){if(c=s(o),c===null)throw Error(i(188));return c!==o?null:o}for(var h=o,v=c;;){var w=h.return;if(w===null)break;var T=w.alternate;if(T===null){if(v=w.return,v!==null){h=v;continue}break}if(w.child===T.child){for(T=w.child;T;){if(T===h)return l(w),o;if(T===v)return l(w),c;T=T.sibling}throw Error(i(188))}if(h.return!==v.return)h=w,v=T;else{for(var H=!1,Z=w.child;Z;){if(Z===h){H=!0,h=w,v=T;break}if(Z===v){H=!0,v=w,h=T;break}Z=Z.sibling}if(!H){for(Z=T.child;Z;){if(Z===h){H=!0,h=T,v=w;break}if(Z===v){H=!0,v=T,h=w;break}Z=Z.sibling}if(!H)throw Error(i(189))}}if(h.alternate!==v)throw Error(i(190))}if(h.tag!==3)throw Error(i(188));return h.stateNode.current===h?o:c}function f(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=f(o),c!==null)return c;o=o.sibling}return null}var d=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),S=Symbol.for("react.consumer"),A=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function B(o){return o===null||typeof o!="object"?null:(o=j&&o[j]||o["@@iterator"],typeof o=="function"?o:null)}var tt=Symbol.for("react.client.reference");function k(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===tt?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case y:return"Fragment";case _:return"Profiler";case x:return"StrictMode";case O:return"Suspense";case N:return"SuspenseList";case I:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case g:return"Portal";case A:return(o.displayName||"Context")+".Provider";case S:return(o._context.displayName||"Context")+".Consumer";case C:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case D:return c=o.displayName||null,c!==null?c:k(o.type)||"Memo";case L:c=o._payload,o=o._init;try{return k(o(c))}catch{}}return null}var et=Array.isArray,K=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_t={pending:!1,data:null,method:null,action:null},at=[],P=-1;function X(o){return{current:o}}function V(o){0>P||(o.current=at[P],at[P]=null,P--)}function it(o,c){P++,at[P]=o.current,o.current=c}var ht=X(null),yt=X(null),Rt=X(null),Et=X(null);function G(o,c){switch(it(Rt,c),it(yt,o),it(ht,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?ET(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=ET(c),o=AT(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}V(ht),it(ht,o)}function lt(){V(ht),V(yt),V(Rt)}function rt(o){o.memoizedState!==null&&it(Et,o);var c=ht.current,h=AT(c,o.type);c!==h&&(it(yt,o),it(ht,h))}function ot(o){yt.current===o&&(V(ht),V(yt)),Et.current===o&&(V(Et),Jh._currentValue=_t)}var bt=Object.prototype.hasOwnProperty,St=n.unstable_scheduleCallback,R=n.unstable_cancelCallback,mt=n.unstable_shouldYield,ut=n.unstable_requestPaint,J=n.unstable_now,Q=n.unstable_getCurrentPriorityLevel,gt=n.unstable_ImmediatePriority,Bt=n.unstable_UserBlockingPriority,Ht=n.unstable_NormalPriority,Ct=n.unstable_LowPriority,kt=n.unstable_IdlePriority,Dt=n.log,xt=n.unstable_setDisableYieldValue,te=null,ae=null;function ne(o){if(typeof Dt=="function"&&xt(o),ae&&typeof ae.setStrictMode=="function")try{ae.setStrictMode(te,o)}catch{}}var Me=Math.clz32?Math.clz32:gn,dn=Math.log,Se=Math.LN2;function gn(o){return o>>>=0,o===0?32:31-(dn(o)/Se|0)|0}var Ze=256,Zn=4194304;function Bn(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function On(o,c,h){var v=o.pendingLanes;if(v===0)return 0;var w=0,T=o.suspendedLanes,H=o.pingedLanes;o=o.warmLanes;var Z=v&134217727;return Z!==0?(v=Z&~T,v!==0?w=Bn(v):(H&=Z,H!==0?w=Bn(H):h||(h=Z&~o,h!==0&&(w=Bn(h))))):(Z=v&~T,Z!==0?w=Bn(Z):H!==0?w=Bn(H):h||(h=v&~o,h!==0&&(w=Bn(h)))),w===0?0:c!==0&&c!==w&&(c&T)===0&&(T=w&-w,h=c&-c,T>=h||T===32&&(h&4194048)!==0)?c:w}function Oi(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function Us(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pa(){var o=Ze;return Ze<<=1,(Ze&4194048)===0&&(Ze=256),o}function wo(){var o=Zn;return Zn<<=1,(Zn&62914560)===0&&(Zn=4194304),o}function ma(o){for(var c=[],h=0;31>h;h++)c.push(o);return c}function Pi(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Wr(o,c,h,v,w,T){var H=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var Z=o.entanglements,vt=o.expirationTimes,Pt=o.hiddenUpdates;for(h=H&~h;0<h;){var Vt=31-Me(h),Kt=1<<Vt;Z[Vt]=0,vt[Vt]=-1;var Ut=Pt[Vt];if(Ut!==null)for(Pt[Vt]=null,Vt=0;Vt<Ut.length;Vt++){var zt=Ut[Vt];zt!==null&&(zt.lane&=-536870913)}h&=~Kt}v!==0&&Rc(o,v,0),T!==0&&w===0&&o.tag!==0&&(o.suspendedLanes|=T&~(H&~c))}function Rc(o,c,h){o.pendingLanes|=c,o.suspendedLanes&=~c;var v=31-Me(c);o.entangledLanes|=c,o.entanglements[v]=o.entanglements[v]|1073741824|h&4194090}function Yu(o,c){var h=o.entangledLanes|=c;for(o=o.entanglements;h;){var v=31-Me(h),w=1<<v;w&c|o[v]&c&&(o[v]|=c),h&=~w}}function Nc(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Lc(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function qu(){var o=q.p;return o!==0?o:(o=window.event,o===void 0?32:$T(o.type))}function Pa(o,c){var h=q.p;try{return q.p=o,c()}finally{q.p=h}}var or=Math.random().toString(36).slice(2),vi="__reactFiber$"+or,xi="__reactProps$"+or,Ba="__reactContainer$"+or,Ic="__reactEvents$"+or,Ud="__reactListeners$"+or,Y="__reactHandles$"+or,dt="__reactResources$"+or,st="__reactMarker$"+or;function ct(o){delete o[vi],delete o[xi],delete o[Ic],delete o[Ud],delete o[Y]}function ft(o){var c=o[vi];if(c)return c;for(var h=o.parentNode;h;){if(c=h[Ba]||h[vi]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(o=DT(o);o!==null;){if(h=o[vi])return h;o=DT(o)}return c}o=h,h=o.parentNode}return null}function pt(o){if(o=o[vi]||o[Ba]){var c=o.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return o}return null}function Ft(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(i(33))}function $t(o){var c=o[dt];return c||(c=o[dt]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Tt(o){o[st]=!0}var Lt=new Set,It={};function Wt(o,c){ee(o,c),ee(o+"Capture",c)}function ee(o,c){for(It[o]=c,o=0;o<c.length;o++)Lt.add(c[o])}var ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qt={},ie={};function je(o){return bt.call(ie,o)?!0:bt.call(Qt,o)?!1:ue.test(o)?ie[o]=!0:(Qt[o]=!0,!1)}function hn(o,c,h){if(je(c))if(h===null)o.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var v=c.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+h)}}function an(o,c,h){if(h===null)o.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+h)}}function wn(o,c,h,v){if(v===null)o.removeAttribute(h);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(c,h,""+v)}}var ps,zs;function Sr(o){if(ps===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);ps=c&&c[1]||"",zs=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ps+o+zs}var Xr=!1;function ja(o,c){if(!o||Xr)return"";Xr=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(c){var Kt=function(){throw Error()};if(Object.defineProperty(Kt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Kt,[])}catch(zt){var Ut=zt}Reflect.construct(o,[],Kt)}else{try{Kt.call()}catch(zt){Ut=zt}o.call(Kt.prototype)}}else{try{throw Error()}catch(zt){Ut=zt}(Kt=o())&&typeof Kt.catch=="function"&&Kt.catch(function(){})}}catch(zt){if(zt&&Ut&&typeof zt.stack=="string")return[zt.stack,Ut.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=v.DetermineComponentFrameRoot(),H=T[0],Z=T[1];if(H&&Z){var vt=H.split(`
`),Pt=Z.split(`
`);for(w=v=0;v<vt.length&&!vt[v].includes("DetermineComponentFrameRoot");)v++;for(;w<Pt.length&&!Pt[w].includes("DetermineComponentFrameRoot");)w++;if(v===vt.length||w===Pt.length)for(v=vt.length-1,w=Pt.length-1;1<=v&&0<=w&&vt[v]!==Pt[w];)w--;for(;1<=v&&0<=w;v--,w--)if(vt[v]!==Pt[w]){if(v!==1||w!==1)do if(v--,w--,0>w||vt[v]!==Pt[w]){var Vt=`
`+vt[v].replace(" at new "," at ");return o.displayName&&Vt.includes("<anonymous>")&&(Vt=Vt.replace("<anonymous>",o.displayName)),Vt}while(1<=v&&0<=w);break}}}finally{Xr=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?Sr(h):""}function Yr(o){switch(o.tag){case 26:case 27:case 5:return Sr(o.type);case 16:return Sr("Lazy");case 13:return Sr("Suspense");case 19:return Sr("SuspenseList");case 0:case 15:return ja(o.type,!1);case 11:return ja(o.type.render,!1);case 1:return ja(o.type,!0);case 31:return Sr("Activity");default:return""}}function zd(o){try{var c="";do c+=Yr(o),o=o.return;while(o);return c}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function Tr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Hd(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Z0(o){var c=Hd(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),v=""+o[c];if(!o.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,T=h.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return w.call(this)},set:function(H){v=""+H,T.call(this,H)}}),Object.defineProperty(o,c,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(H){v=""+H},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function kc(o){o._valueTracker||(o._valueTracker=Z0(o))}function $d(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var h=c.getValue(),v="";return o&&(v=Hd(o)?o.checked?"true":"false":o.value),o=v,o!==h?(c.setValue(o),!0):!1}function Cr(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Dr=/[\n"\\]/g;function yi(o){return o.replace(Dr,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function lr(o,c,h,v,w,T,H,Z){o.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?o.type=H:o.removeAttribute("type"),c!=null?H==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+Tr(c)):o.value!==""+Tr(c)&&(o.value=""+Tr(c)):H!=="submit"&&H!=="reset"||o.removeAttribute("value"),c!=null?Mc(o,H,Tr(c)):h!=null?Mc(o,H,Tr(h)):v!=null&&o.removeAttribute("value"),w==null&&T!=null&&(o.defaultChecked=!!T),w!=null&&(o.checked=w&&typeof w!="function"&&typeof w!="symbol"),Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?o.name=""+Tr(Z):o.removeAttribute("name")}function Ku(o,c,h,v,w,T,H,Z){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(o.type=T),c!=null||h!=null){if(!(T!=="submit"&&T!=="reset"||c!=null))return;h=h!=null?""+Tr(h):"",c=c!=null?""+Tr(c):h,Z||c===o.value||(o.value=c),o.defaultValue=c}v=v??w,v=typeof v!="function"&&typeof v!="symbol"&&!!v,o.checked=Z?o.checked:!!v,o.defaultChecked=!!v,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(o.name=H)}function Mc(o,c,h){c==="number"&&Cr(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function Wi(o,c,h,v){if(o=o.options,c){c={};for(var w=0;w<h.length;w++)c["$"+h[w]]=!0;for(h=0;h<o.length;h++)w=c.hasOwnProperty("$"+o[h].value),o[h].selected!==w&&(o[h].selected=w),w&&v&&(o[h].defaultSelected=!0)}else{for(h=""+Tr(h),c=null,w=0;w<o.length;w++){if(o[w].value===h){o[w].selected=!0,v&&(o[w].defaultSelected=!0);return}c!==null||o[w].disabled||(c=o[w])}c!==null&&(c.selected=!0)}}function Ua(o,c,h){if(c!=null&&(c=""+Tr(c),c!==o.value&&(o.value=c),h==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=h!=null?""+Tr(h):""}function Fc(o,c,h,v){if(c==null){if(v!=null){if(h!=null)throw Error(i(92));if(et(v)){if(1<v.length)throw Error(i(93));v=v[0]}h=v}h==null&&(h=""),c=h}h=Tr(c),o.defaultValue=h,v=o.textContent,v===h&&v!==""&&v!==null&&(o.value=v)}function ms(o,c){if(c){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=c;return}}o.textContent=c}var Gd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vd(o,c,h){var v=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?v?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":v?o.setProperty(c,h):typeof h!="number"||h===0||Gd.has(c)?c==="float"?o.cssFloat=h:o[c]=(""+h).trim():o[c]=h+"px"}function Eo(o,c,h){if(c!=null&&typeof c!="object")throw Error(i(62));if(o=o.style,h!=null){for(var v in h)!h.hasOwnProperty(v)||c!=null&&c.hasOwnProperty(v)||(v.indexOf("--")===0?o.setProperty(v,""):v==="float"?o.cssFloat="":o[v]="");for(var w in c)v=c[w],c.hasOwnProperty(w)&&h[w]!==v&&Vd(o,w,v)}else for(var T in c)c.hasOwnProperty(T)&&Vd(o,T,c[T])}function Pc(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Q0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ga=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zu(o){return ga.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Hs=null;function Dl(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Ao=null,$s=null;function Qu(o){var c=pt(o);if(c&&(o=c.stateNode)){var h=o[xi]||null;t:switch(o=c.stateNode,c.type){case"input":if(lr(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+yi(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var v=h[c];if(v!==o&&v.form===o.form){var w=v[xi]||null;if(!w)throw Error(i(90));lr(v,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(c=0;c<h.length;c++)v=h[c],v.form===o.form&&$d(v)}break t;case"textarea":Ua(o,h.value,h.defaultValue);break t;case"select":c=h.value,c!=null&&Wi(o,!!h.multiple,c,!1)}}}var So=!1;function Wd(o,c,h){if(So)return o(c,h);So=!0;try{var v=o(c);return v}finally{if(So=!1,(Ao!==null||$s!==null)&&(og(),Ao&&(c=Ao,o=$s,$s=Ao=null,Qu(c),o)))for(c=0;c<o.length;c++)Qu(o[c])}}function Ol(o,c){var h=o.stateNode;if(h===null)return null;var v=h[xi]||null;if(v===null)return null;h=v[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break t;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(i(231,c,typeof h));return h}var Gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),za=!1;if(Gs)try{var Bc={};Object.defineProperty(Bc,"passive",{get:function(){za=!0}}),window.addEventListener("test",Bc,Bc),window.removeEventListener("test",Bc,Bc)}catch{za=!1}var va=null,jc=null,To=null;function Ju(){if(To)return To;var o,c=jc,h=c.length,v,w="value"in va?va.value:va.textContent,T=w.length;for(o=0;o<h&&c[o]===w[o];o++);var H=h-o;for(v=1;v<=H&&c[h-v]===w[T-v];v++);return To=w.slice(o,1<v?1-v:void 0)}function tf(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Co(){return!0}function J0(){return!1}function Xi(o){function c(h,v,w,T,H){this._reactName=h,this._targetInst=w,this.type=v,this.nativeEvent=T,this.target=H,this.currentTarget=null;for(var Z in o)o.hasOwnProperty(Z)&&(h=o[Z],this[Z]=h?h(T):T[Z]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Co:J0,this.isPropagationStopped=J0,this}return d(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Co)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Co)},persist:function(){},isPersistent:Co}),c}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rl=Xi(xa),Do=d({},xa,{view:0,detail:0}),tm=Xi(Do),Oo,Uc,Nl,zc=d({},Do,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yd,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Nl&&(Nl&&o.type==="mousemove"?(Oo=o.screenX-Nl.screenX,Uc=o.screenY-Nl.screenY):Uc=Oo=0,Nl=o),Oo)},movementY:function(o){return"movementY"in o?o.movementY:Uc}}),Ro=Xi(zc),Fx=d({},zc,{dataTransfer:0}),em=Xi(Fx),nm=d({},Do,{relatedTarget:0}),ef=Xi(nm),im=d({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),rm=Xi(im),Xd=d({},xa,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),sm=Xi(Xd),Px=d({},xa,{data:0}),am=Xi(Px),om={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bx(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=nf[o])?!!c[o]:!1}function Yd(){return Bx}var qd=d({},Do,{key:function(o){if(o.key){var c=om[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=tf(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?lm[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yd,charCode:function(o){return o.type==="keypress"?tf(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?tf(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),cm=Xi(qd),um=d({},zc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ha=Xi(um),Kd=d({},Do,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yd}),jx=Xi(Kd),fm=d({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ux=Xi(fm),zx=d({},zc,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Hx=Xi(zx),$x=d({},xa,{newState:0,oldState:0}),dm=Xi($x),hm=[9,13,27,32],Zd=Gs&&"CompositionEvent"in window,Vs=null;Gs&&"documentMode"in document&&(Vs=document.documentMode);var No=Gs&&"TextEvent"in window&&!Vs,pm=Gs&&(!Zd||Vs&&8<Vs&&11>=Vs),Hc=" ",mm=!1;function gm(o,c){switch(o){case"keyup":return hm.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vm(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Ll=!1;function Gx(o,c){switch(o){case"compositionend":return vm(c);case"keypress":return c.which!==32?null:(mm=!0,Hc);case"textInput":return o=c.data,o===Hc&&mm?null:o;default:return null}}function Vx(o,c){if(Ll)return o==="compositionend"||!Zd&&gm(o,c)?(o=Ju(),To=jc=va=null,Ll=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return pm&&c.locale!=="ko"?null:c.data;default:return null}}var Wx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xm(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!Wx[o.type]:c==="textarea"}function qr(o,c,h,v){Ao?$s?$s.push(v):$s=[v]:Ao=v,c=hg(c,"onChange"),0<c.length&&(h=new Rl("onChange","change",null,h,v),o.push({event:h,listeners:c}))}var Il=null,kl=null;function ym(o){xT(o,0)}function rf(o){var c=Ft(o);if($d(c))return o}function _m(o,c){if(o==="change")return c}var Qd=!1;if(Gs){var Ml;if(Gs){var Jd="oninput"in document;if(!Jd){var bm=document.createElement("div");bm.setAttribute("oninput","return;"),Jd=typeof bm.oninput=="function"}Ml=Jd}else Ml=!1;Qd=Ml&&(!document.documentMode||9<document.documentMode)}function th(){Il&&(Il.detachEvent("onpropertychange",wm),kl=Il=null)}function wm(o){if(o.propertyName==="value"&&rf(kl)){var c=[];qr(c,kl,o,Dl(o)),Wd(ym,c)}}function Xx(o,c,h){o==="focusin"?(th(),Il=c,kl=h,Il.attachEvent("onpropertychange",wm)):o==="focusout"&&th()}function Em(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return rf(kl)}function Am(o,c){if(o==="click")return rf(c)}function Sm(o,c){if(o==="input"||o==="change")return rf(c)}function sf(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var cr=typeof Object.is=="function"?Object.is:sf;function Lo(o,c){if(cr(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var h=Object.keys(o),v=Object.keys(c);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var w=h[v];if(!bt.call(c,w)||!cr(o[w],c[w]))return!1}return!0}function Or(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Tm(o,c){var h=Or(o);o=0;for(var v;h;){if(h.nodeType===3){if(v=o+h.textContent.length,o<=c&&v>=c)return{node:h,offset:c-o};o=v}t:{for(;h;){if(h.nextSibling){h=h.nextSibling;break t}h=h.parentNode}h=void 0}h=Or(h)}}function Cm(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?Cm(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function eh(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=Cr(o.document);c instanceof o.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)o=c.contentWindow;else break;c=Cr(o.document)}return c}function af(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var Yx=Gs&&"documentMode"in document&&11>=document.documentMode,Fl=null,nh=null,$c=null,ih=!1;function Dm(o,c,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;ih||Fl==null||Fl!==Cr(v)||(v=Fl,"selectionStart"in v&&af(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),$c&&Lo($c,v)||($c=v,v=hg(nh,"onSelect"),0<v.length&&(c=new Rl("onSelect","select",null,c,h),o.push({event:c,listeners:v}),c.target=Fl)))}function $a(o,c){var h={};return h[o.toLowerCase()]=c.toLowerCase(),h["Webkit"+o]="webkit"+c,h["Moz"+o]="moz"+c,h}var Io={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionrun:$a("Transition","TransitionRun"),transitionstart:$a("Transition","TransitionStart"),transitioncancel:$a("Transition","TransitionCancel"),transitionend:$a("Transition","TransitionEnd")},Gc={},Om={};Gs&&(Om=document.createElement("div").style,"AnimationEvent"in window||(delete Io.animationend.animation,delete Io.animationiteration.animation,delete Io.animationstart.animation),"TransitionEvent"in window||delete Io.transitionend.transition);function ko(o){if(Gc[o])return Gc[o];if(!Io[o])return o;var c=Io[o],h;for(h in c)if(c.hasOwnProperty(h)&&h in Om)return Gc[o]=c[h];return o}var Ga=ko("animationend"),Ws=ko("animationiteration"),rh=ko("animationstart"),qx=ko("transitionrun"),Rm=ko("transitionstart"),Nm=ko("transitioncancel"),sh=ko("transitionend"),ah=new Map,oh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");oh.push("scrollEnd");function gs(o,c){ah.set(o,c),Wt(c,[o])}var Lm=new WeakMap;function Rr(o,c){if(typeof o=="object"&&o!==null){var h=Lm.get(o);return h!==void 0?h:(c={value:o,source:c,stack:zd(c)},Lm.set(o,c),c)}return{value:o,source:c,stack:zd(c)}}var Nr=[],Pl=0,lh=0;function of(){for(var o=Pl,c=lh=Pl=0;c<o;){var h=Nr[c];Nr[c++]=null;var v=Nr[c];Nr[c++]=null;var w=Nr[c];Nr[c++]=null;var T=Nr[c];if(Nr[c++]=null,v!==null&&w!==null){var H=v.pending;H===null?w.next=w:(w.next=H.next,H.next=w),v.pending=w}T!==0&&uh(h,w,T)}}function lf(o,c,h,v){Nr[Pl++]=o,Nr[Pl++]=c,Nr[Pl++]=h,Nr[Pl++]=v,lh|=v,o.lanes|=v,o=o.alternate,o!==null&&(o.lanes|=v)}function ch(o,c,h,v){return lf(o,c,h,v),cf(o)}function ur(o,c){return lf(o,null,null,c),cf(o)}function uh(o,c,h){o.lanes|=h;var v=o.alternate;v!==null&&(v.lanes|=h);for(var w=!1,T=o.return;T!==null;)T.childLanes|=h,v=T.alternate,v!==null&&(v.childLanes|=h),T.tag===22&&(o=T.stateNode,o===null||o._visibility&1||(w=!0)),o=T,T=T.return;return o.tag===3?(T=o.stateNode,w&&c!==null&&(w=31-Me(h),o=T.hiddenUpdates,v=o[w],v===null?o[w]=[c]:v.push(c),c.lane=h|536870912),T):null}function cf(o){if(50<Vh)throw Vh=0,Dy=null,Error(i(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var Bl={};function Kx(o,c,h,v){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lr(o,c,h,v){return new Kx(o,c,h,v)}function fh(o){return o=o.prototype,!(!o||!o.isReactComponent)}function ya(o,c){var h=o.alternate;return h===null?(h=Lr(o.tag,c,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=c,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,c=o.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function Im(o,c){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,c=h.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function uf(o,c,h,v,w,T){var H=0;if(v=o,typeof o=="function")fh(o)&&(H=1);else if(typeof o=="string")H=LM(o,h,ht.current)?26:o==="html"||o==="head"||o==="body"?27:5;else t:switch(o){case I:return o=Lr(31,h,c,w),o.elementType=I,o.lanes=T,o;case y:return _a(h.children,w,T,c);case x:H=8,w|=24;break;case _:return o=Lr(12,h,c,w|2),o.elementType=_,o.lanes=T,o;case O:return o=Lr(13,h,c,w),o.elementType=O,o.lanes=T,o;case N:return o=Lr(19,h,c,w),o.elementType=N,o.lanes=T,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case b:case A:H=10;break t;case S:H=9;break t;case C:H=11;break t;case D:H=14;break t;case L:H=16,v=null;break t}H=29,h=Error(i(130,o===null?"null":typeof o,"")),v=null}return c=Lr(H,h,c,w),c.elementType=o,c.type=v,c.lanes=T,c}function _a(o,c,h,v){return o=Lr(7,o,v,c),o.lanes=h,o}function jl(o,c,h){return o=Lr(6,o,null,c),o.lanes=h,o}function dh(o,c,h){return c=Lr(4,o.children!==null?o.children:[],o.key,c),c.lanes=h,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var Mo=[],Fo=0,Va=null,Ul=0,fr=[],Kr=0,Po=null,ba=1,Yi="";function Bo(o,c){Mo[Fo++]=Ul,Mo[Fo++]=Va,Va=o,Ul=c}function km(o,c,h){fr[Kr++]=ba,fr[Kr++]=Yi,fr[Kr++]=Po,Po=o;var v=ba;o=Yi;var w=32-Me(v)-1;v&=~(1<<w),h+=1;var T=32-Me(c)+w;if(30<T){var H=w-w%5;T=(v&(1<<H)-1).toString(32),v>>=H,w-=H,ba=1<<32-Me(c)+w|h<<w|v,Yi=T+o}else ba=1<<T|h<<w|v,Yi=o}function hh(o){o.return!==null&&(Bo(o,1),km(o,1,0))}function ph(o){for(;o===Va;)Va=Mo[--Fo],Mo[Fo]=null,Ul=Mo[--Fo],Mo[Fo]=null;for(;o===Po;)Po=fr[--Kr],fr[Kr]=null,Yi=fr[--Kr],fr[Kr]=null,ba=fr[--Kr],fr[Kr]=null}var _i=null,zn=null,pn=!1,Wa=null,Xs=!1,Xa=Error(i(519));function wa(o){var c=Error(i(418,""));throw vs(Rr(c,o)),Xa}function mh(o){var c=o.stateNode,h=o.type,v=o.memoizedProps;switch(c[vi]=o,c[xi]=v,h){case"dialog":en("cancel",c),en("close",c);break;case"iframe":case"object":case"embed":en("load",c);break;case"video":case"audio":for(h=0;h<Xh.length;h++)en(Xh[h],c);break;case"source":en("error",c);break;case"img":case"image":case"link":en("error",c),en("load",c);break;case"details":en("toggle",c);break;case"input":en("invalid",c),Ku(c,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),kc(c);break;case"select":en("invalid",c);break;case"textarea":en("invalid",c),Fc(c,v.value,v.defaultValue,v.children),kc(c)}h=v.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||v.suppressHydrationWarning===!0||wT(c.textContent,h)?(v.popover!=null&&(en("beforetoggle",c),en("toggle",c)),v.onScroll!=null&&en("scroll",c),v.onScrollEnd!=null&&en("scrollend",c),v.onClick!=null&&(c.onclick=pg),c=!0):c=!1,c||wa(o)}function Mm(o){for(_i=o.return;_i;)switch(_i.tag){case 5:case 13:Xs=!1;return;case 27:case 3:Xs=!0;return;default:_i=_i.return}}function Vc(o){if(o!==_i)return!1;if(!pn)return Mm(o),pn=!0,!1;var c=o.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||Gy(o.type,o.memoizedProps)),h=!h),h&&zn&&wa(o),Mm(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(i(317));t:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8)if(h=o.data,h==="/$"){if(c===0){zn=Ta(o.nextSibling);break t}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++;o=o.nextSibling}zn=null}}else c===27?(c=zn,ec(o.type)?(o=Yy,Yy=null,zn=o):zn=c):zn=_i?Ta(o.stateNode.nextSibling):null;return!0}function Wc(){zn=_i=null,pn=!1}function zl(){var o=Wa;return o!==null&&(ns===null?ns=o:ns.push.apply(ns,o),Wa=null),o}function vs(o){Wa===null?Wa=[o]:Wa.push(o)}var gh=X(null),jo=null,Ea=null;function Ya(o,c,h){it(gh,c._currentValue),c._currentValue=h}function Aa(o){o._currentValue=gh.current,V(gh)}function vh(o,c,h){for(;o!==null;){var v=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,v!==null&&(v.childLanes|=c)):v!==null&&(v.childLanes&c)!==c&&(v.childLanes|=c),o===h)break;o=o.return}}function xh(o,c,h,v){var w=o.child;for(w!==null&&(w.return=o);w!==null;){var T=w.dependencies;if(T!==null){var H=w.child;T=T.firstContext;t:for(;T!==null;){var Z=T;T=w;for(var vt=0;vt<c.length;vt++)if(Z.context===c[vt]){T.lanes|=h,Z=T.alternate,Z!==null&&(Z.lanes|=h),vh(T.return,h,o),v||(H=null);break t}T=Z.next}}else if(w.tag===18){if(H=w.return,H===null)throw Error(i(341));H.lanes|=h,T=H.alternate,T!==null&&(T.lanes|=h),vh(H,h,o),H=null}else H=w.child;if(H!==null)H.return=w;else for(H=w;H!==null;){if(H===o){H=null;break}if(w=H.sibling,w!==null){w.return=H.return,H=w;break}H=H.return}w=H}}function Xc(o,c,h,v){o=null;for(var w=c,T=!1;w!==null;){if(!T){if((w.flags&524288)!==0)T=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var H=w.alternate;if(H===null)throw Error(i(387));if(H=H.memoizedProps,H!==null){var Z=w.type;cr(w.pendingProps.value,H.value)||(o!==null?o.push(Z):o=[Z])}}else if(w===Et.current){if(H=w.alternate,H===null)throw Error(i(387));H.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(o!==null?o.push(Jh):o=[Jh])}w=w.return}o!==null&&xh(c,o,h,v),c.flags|=262144}function Yc(o){for(o=o.firstContext;o!==null;){if(!cr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Uo(o){jo=o,Ea=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Ri(o){return yh(jo,o)}function Hl(o,c){return jo===null&&Uo(o),yh(o,c)}function yh(o,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},Ea===null){if(o===null)throw Error(i(308));Ea=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else Ea=Ea.next=c;return h}var zo=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(h,v){o.push(v)}};this.abort=function(){c.aborted=!0,o.forEach(function(h){return h()})}},Fm=n.unstable_scheduleCallback,_h=n.unstable_NormalPriority,si={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qc(){return{controller:new zo,data:new Map,refCount:0}}function $l(o){o.refCount--,o.refCount===0&&Fm(_h,function(){o.controller.abort()})}var Ho=null,bh=0,Zr=0,Ir=null;function Zx(o,c){if(Ho===null){var h=Ho=[];bh=0,Zr=My(),Ir={status:"pending",value:void 0,then:function(v){h.push(v)}}}return bh++,c.then(Pm,Pm),c}function Pm(){if(--bh===0&&Ho!==null){Ir!==null&&(Ir.status="fulfilled");var o=Ho;Ho=null,Zr=0,Ir=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function Qx(o,c){var h=[],v={status:"pending",value:null,reason:null,then:function(w){h.push(w)}};return o.then(function(){v.status="fulfilled",v.value=c;for(var w=0;w<h.length;w++)(0,h[w])(c)},function(w){for(v.status="rejected",v.reason=w,w=0;w<h.length;w++)(0,h[w])(void 0)}),v}var Bm=K.S;K.S=function(o,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Zx(o,c),Bm!==null&&Bm(o,c)};var $o=X(null);function wh(){var o=$o.current;return o!==null?o:Hn.pooledCache}function ff(o,c){c===null?it($o,$o.current):it($o,c.pool)}function jm(){var o=wh();return o===null?null:{parent:si._currentValue,pool:o}}var Gl=Error(i(460)),Kc=Error(i(474)),Go=Error(i(542)),Eh={then:function(){}};function Um(o){return o=o.status,o==="fulfilled"||o==="rejected"}function qa(){}function W(o,c,h){switch(h=o[h],h===void 0?o.push(c):h!==c&&(c.then(qa,qa),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,nt(o),o;default:if(typeof c.status=="string")c.then(qa,qa);else{if(o=Hn,o!==null&&100<o.shellSuspendCounter)throw Error(i(482));o=c,o.status="pending",o.then(function(v){if(c.status==="pending"){var w=c;w.status="fulfilled",w.value=v}},function(v){if(c.status==="pending"){var w=c;w.status="rejected",w.reason=v}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,nt(o),o}throw E=c,Gl}}var E=null;function F(){if(E===null)throw Error(i(459));var o=E;return E=null,o}function nt(o){if(o===Gl||o===Go)throw Error(i(483))}var At=!1;function Ot(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gt(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Xt(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function re(o,c,h){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(Sn&2)!==0){var w=v.pending;return w===null?c.next=c:(c.next=w.next,w.next=c),v.pending=c,c=cf(o),uh(o,null,h),c}return lf(o,v,c,h),cf(o)}function he(o,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var v=c.lanes;v&=o.pendingLanes,h|=v,c.lanes=h,Yu(o,h)}}function pe(o,c){var h=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var w=null,T=null;if(h=h.firstBaseUpdate,h!==null){do{var H={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};T===null?w=T=H:T=T.next=H,h=h.next}while(h!==null);T===null?w=T=c:T=T.next=c}else w=T=c;h={baseState:v.baseState,firstBaseUpdate:w,lastBaseUpdate:T,shared:v.shared,callbacks:v.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=c}var fe=!1;function ze(){if(fe){var o=Ir;if(o!==null)throw o}}function Te(o,c,h,v){fe=!1;var w=o.updateQueue;At=!1;var T=w.firstBaseUpdate,H=w.lastBaseUpdate,Z=w.shared.pending;if(Z!==null){w.shared.pending=null;var vt=Z,Pt=vt.next;vt.next=null,H===null?T=Pt:H.next=Pt,H=vt;var Vt=o.alternate;Vt!==null&&(Vt=Vt.updateQueue,Z=Vt.lastBaseUpdate,Z!==H&&(Z===null?Vt.firstBaseUpdate=Pt:Z.next=Pt,Vt.lastBaseUpdate=vt))}if(T!==null){var Kt=w.baseState;H=0,Vt=Pt=vt=null,Z=T;do{var Ut=Z.lane&-536870913,zt=Ut!==Z.lane;if(zt?(cn&Ut)===Ut:(v&Ut)===Ut){Ut!==0&&Ut===Zr&&(fe=!0),Vt!==null&&(Vt=Vt.next={lane:0,tag:Z.tag,payload:Z.payload,callback:null,next:null});t:{var Ue=o,Le=Z;Ut=c;var Ln=h;switch(Le.tag){case 1:if(Ue=Le.payload,typeof Ue=="function"){Kt=Ue.call(Ln,Kt,Ut);break t}Kt=Ue;break t;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=Le.payload,Ut=typeof Ue=="function"?Ue.call(Ln,Kt,Ut):Ue,Ut==null)break t;Kt=d({},Kt,Ut);break t;case 2:At=!0}}Ut=Z.callback,Ut!==null&&(o.flags|=64,zt&&(o.flags|=8192),zt=w.callbacks,zt===null?w.callbacks=[Ut]:zt.push(Ut))}else zt={lane:Ut,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Vt===null?(Pt=Vt=zt,vt=Kt):Vt=Vt.next=zt,H|=Ut;if(Z=Z.next,Z===null){if(Z=w.shared.pending,Z===null)break;zt=Z,Z=zt.next,zt.next=null,w.lastBaseUpdate=zt,w.shared.pending=null}}while(!0);Vt===null&&(vt=Kt),w.baseState=vt,w.firstBaseUpdate=Pt,w.lastBaseUpdate=Vt,T===null&&(w.shared.lanes=0),Zl|=H,o.lanes=H,o.memoizedState=Kt}}function He(o,c){if(typeof o!="function")throw Error(i(191,o));o.call(c)}function Fe(o,c){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)He(h[o],c)}var Ne=X(null),mn=X(0);function En(o,c){o=Zo,it(mn,o),it(Ne,c),Zo=o|c.baseLanes}function We(){it(mn,Zo),it(Ne,Ne.current)}function on(){Zo=mn.current,V(Ne),V(mn)}var Pe=0,de=null,_e=null,Be=null,ln=!1,Rn=!1,li=!1,dr=0,ci=0,Ni=null,Qr=0;function Ge(){throw Error(i(321))}function Jr(o,c){if(c===null)return!1;for(var h=0;h<c.length&&h<o.length;h++)if(!cr(o[h],c[h]))return!1;return!0}function ts(o,c,h,v,w,T){return Pe=T,de=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,K.H=o===null||o.memoizedState===null?nS:iS,li=!1,T=h(v,w),li=!1,Rn&&(T=ui(c,h,v,w)),Vo(o),T}function Vo(o){K.H=Ym;var c=_e!==null&&_e.next!==null;if(Pe=0,Be=_e=de=null,ln=!1,ci=0,Ni=null,c)throw Error(i(300));o===null||Bi||(o=o.dependencies,o!==null&&Yc(o)&&(Bi=!0))}function ui(o,c,h,v){de=o;var w=0;do{if(Rn&&(Ni=null),ci=0,Rn=!1,25<=w)throw Error(i(301));if(w+=1,Be=_e=null,o.updateQueue!=null){var T=o.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}K.H=$6,T=c(h,v)}while(Rn);return T}function An(){var o=K.H,c=o.useState()[0];return c=typeof c.then=="function"?Ka(c):c,o=o.useState()[0],(_e!==null?_e.memoizedState:null)!==o&&(de.flags|=1024),c}function Li(){var o=dr!==0;return dr=0,o}function hr(o,c,h){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~h}function Ys(o){if(ln){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}ln=!1}Pe=0,Be=_e=de=null,Rn=!1,ci=dr=0,Ni=null}function Ii(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Be===null?de.memoizedState=Be=o:Be=Be.next=o,Be}function Qn(){if(_e===null){var o=de.alternate;o=o!==null?o.memoizedState:null}else o=_e.next;var c=Be===null?de.memoizedState:Be.next;if(c!==null)Be=c,_e=o;else{if(o===null)throw de.alternate===null?Error(i(467)):Error(i(310));_e=o,o={memoizedState:_e.memoizedState,baseState:_e.baseState,baseQueue:_e.baseQueue,queue:_e.queue,next:null},Be===null?de.memoizedState=Be=o:Be=Be.next=o}return Be}function df(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ka(o){var c=ci;return ci+=1,Ni===null&&(Ni=[]),o=W(Ni,o,c),c=de,(Be===null?c.memoizedState:Be.next)===null&&(c=c.alternate,K.H=c===null||c.memoizedState===null?nS:iS),o}function hf(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Ka(o);if(o.$$typeof===A)return Ri(o)}throw Error(i(438,String(o)))}function Ah(o){var c=null,h=de.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var v=de.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(c={data:v.data.map(function(w){return w.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=df(),de.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(o),v=0;v<o;v++)h[v]=z;return c.index++,h}function xs(o,c){return typeof c=="function"?c(o):c}function pf(o){var c=Qn();return mf(c,_e,o)}function mf(o,c,h){var v=o.queue;if(v===null)throw Error(i(311));v.lastRenderedReducer=h;var w=o.baseQueue,T=v.pending;if(T!==null){if(w!==null){var H=w.next;w.next=T.next,T.next=H}c.baseQueue=w=T,v.pending=null}if(T=o.baseState,w===null)o.memoizedState=T;else{c=w.next;var Z=H=null,vt=null,Pt=c,Vt=!1;do{var Kt=Pt.lane&-536870913;if(Kt!==Pt.lane?(cn&Kt)===Kt:(Pe&Kt)===Kt){var Ut=Pt.revertLane;if(Ut===0)vt!==null&&(vt=vt.next={lane:0,revertLane:0,action:Pt.action,hasEagerState:Pt.hasEagerState,eagerState:Pt.eagerState,next:null}),Kt===Zr&&(Vt=!0);else if((Pe&Ut)===Ut){Pt=Pt.next,Ut===Zr&&(Vt=!0);continue}else Kt={lane:0,revertLane:Pt.revertLane,action:Pt.action,hasEagerState:Pt.hasEagerState,eagerState:Pt.eagerState,next:null},vt===null?(Z=vt=Kt,H=T):vt=vt.next=Kt,de.lanes|=Ut,Zl|=Ut;Kt=Pt.action,li&&h(T,Kt),T=Pt.hasEagerState?Pt.eagerState:h(T,Kt)}else Ut={lane:Kt,revertLane:Pt.revertLane,action:Pt.action,hasEagerState:Pt.hasEagerState,eagerState:Pt.eagerState,next:null},vt===null?(Z=vt=Ut,H=T):vt=vt.next=Ut,de.lanes|=Kt,Zl|=Kt;Pt=Pt.next}while(Pt!==null&&Pt!==c);if(vt===null?H=T:vt.next=Z,!cr(T,o.memoizedState)&&(Bi=!0,Vt&&(h=Ir,h!==null)))throw h;o.memoizedState=T,o.baseState=H,o.baseQueue=vt,v.lastRenderedState=T}return w===null&&(v.lanes=0),[o.memoizedState,v.dispatch]}function Sh(o){var c=Qn(),h=c.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=o;var v=h.dispatch,w=h.pending,T=c.memoizedState;if(w!==null){h.pending=null;var H=w=w.next;do T=o(T,H.action),H=H.next;while(H!==w);cr(T,c.memoizedState)||(Bi=!0),c.memoizedState=T,c.baseQueue===null&&(c.baseState=T),h.lastRenderedState=T}return[T,v]}function Th(o,c,h){var v=de,w=Qn(),T=pn;if(T){if(h===void 0)throw Error(i(407));h=h()}else h=c();var H=!cr((_e||w).memoizedState,h);H&&(w.memoizedState=h,Bi=!0),w=w.queue;var Z=Hm.bind(null,v,w,o);if(kh(2048,8,Z,[o]),w.getSnapshot!==c||H||Be!==null&&Be.memoizedState.tag&1){if(v.flags|=2048,yf(9,Vm(),zm.bind(null,v,w,h,c),null),Hn===null)throw Error(i(349));T||(Pe&124)!==0||Ch(v,c,h)}return h}function Ch(o,c,h){o.flags|=16384,o={getSnapshot:c,value:h},c=de.updateQueue,c===null?(c=df(),de.updateQueue=c,c.stores=[o]):(h=c.stores,h===null?c.stores=[o]:h.push(o))}function zm(o,c,h,v){c.value=h,c.getSnapshot=v,Za(c)&&Zc(o)}function Hm(o,c,h){return h(function(){Za(c)&&Zc(o)})}function Za(o){var c=o.getSnapshot;o=o.value;try{var h=c();return!cr(o,h)}catch{return!0}}function Zc(o){var c=ur(o,2);c!==null&&Es(c,o,2)}function gf(o){var c=Ii();if(typeof o=="function"){var h=o;if(o=h(),li){ne(!0);try{h()}finally{ne(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:o},c}function Dh(o,c,h,v){return o.baseState=h,mf(o,_e,typeof v=="function"?v:xs)}function Oh(o,c,h,v,w){if(Xm(o))throw Error(i(485));if(o=c.action,o!==null){var T={payload:w,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){T.listeners.push(H)}};K.T!==null?h(!0):T.isTransition=!1,v(T),h=c.pending,h===null?(T.next=c.pending=T,Rh(c,T)):(T.next=h.next,c.pending=h.next=T)}}function Rh(o,c){var h=c.action,v=c.payload,w=o.state;if(c.isTransition){var T=K.T,H={};K.T=H;try{var Z=h(w,v),vt=K.S;vt!==null&&vt(H,Z),Nh(o,c,Z)}catch(Pt){vf(o,c,Pt)}finally{K.T=T}}else try{T=h(w,v),Nh(o,c,T)}catch(Pt){vf(o,c,Pt)}}function Nh(o,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(v){Lh(o,c,v)},function(v){return vf(o,c,v)}):Lh(o,c,h)}function Lh(o,c,h){c.status="fulfilled",c.value=h,$m(c),o.state=h,c=o.pending,c!==null&&(h=c.next,h===c?o.pending=null:(h=h.next,c.next=h,Rh(o,h)))}function vf(o,c,h){var v=o.pending;if(o.pending=null,v!==null){v=v.next;do c.status="rejected",c.reason=h,$m(c),c=c.next;while(c!==v)}o.action=null}function $m(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function Gm(o,c){return c}function xf(o,c){if(pn){var h=Hn.formState;if(h!==null){t:{var v=de;if(pn){if(zn){e:{for(var w=zn,T=Xs;w.nodeType!==8;){if(!T){w=null;break e}if(w=Ta(w.nextSibling),w===null){w=null;break e}}T=w.data,w=T==="F!"||T==="F"?w:null}if(w){zn=Ta(w.nextSibling),v=w.data==="F!";break t}}wa(v)}v=!1}v&&(c=h[0])}}return h=Ii(),h.memoizedState=h.baseState=c,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gm,lastRenderedState:c},h.queue=v,h=JA.bind(null,de,v),v.dispatch=h,v=gf(!1),T=iy.bind(null,de,!1,v.queue),v=Ii(),w={state:c,dispatch:null,action:o,pending:null},v.queue=w,h=Oh.bind(null,de,w,T,h),w.dispatch=h,v.memoizedState=o,[c,h,!1]}function Ih(o){var c=Qn();return FA(c,_e,o)}function FA(o,c,h){if(c=mf(o,c,Gm)[0],o=pf(xs)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var v=Ka(c)}catch(H){throw H===Gl?Go:H}else v=c;c=Qn();var w=c.queue,T=w.dispatch;return h!==c.memoizedState&&(de.flags|=2048,yf(9,Vm(),j6.bind(null,w,h),null)),[v,T,o]}function j6(o,c){o.action=c}function PA(o){var c=Qn(),h=_e;if(h!==null)return FA(c,h,o);Qn(),c=c.memoizedState,h=Qn();var v=h.queue.dispatch;return h.memoizedState=o,[c,v,!1]}function yf(o,c,h,v){return o={tag:o,create:h,deps:v,inst:c,next:null},c=de.updateQueue,c===null&&(c=df(),de.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=o.next=o:(v=h.next,h.next=o,o.next=v,c.lastEffect=o),o}function Vm(){return{destroy:void 0,resource:void 0}}function BA(){return Qn().memoizedState}function Wm(o,c,h,v){var w=Ii();v=v===void 0?null:v,de.flags|=o,w.memoizedState=yf(1|c,Vm(),h,v)}function kh(o,c,h,v){var w=Qn();v=v===void 0?null:v;var T=w.memoizedState.inst;_e!==null&&v!==null&&Jr(v,_e.memoizedState.deps)?w.memoizedState=yf(c,T,h,v):(de.flags|=o,w.memoizedState=yf(1|c,T,h,v))}function jA(o,c){Wm(8390656,8,o,c)}function UA(o,c){kh(2048,8,o,c)}function zA(o,c){return kh(4,2,o,c)}function HA(o,c){return kh(4,4,o,c)}function $A(o,c){if(typeof c=="function"){o=o();var h=c(o);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function GA(o,c,h){h=h!=null?h.concat([o]):null,kh(4,4,$A.bind(null,c,o),h)}function Jx(){}function VA(o,c){var h=Qn();c=c===void 0?null:c;var v=h.memoizedState;return c!==null&&Jr(c,v[1])?v[0]:(h.memoizedState=[o,c],o)}function WA(o,c){var h=Qn();c=c===void 0?null:c;var v=h.memoizedState;if(c!==null&&Jr(c,v[1]))return v[0];if(v=o(),li){ne(!0);try{o()}finally{ne(!1)}}return h.memoizedState=[v,c],v}function ty(o,c,h){return h===void 0||(Pe&1073741824)!==0?o.memoizedState=c:(o.memoizedState=h,o=qS(),de.lanes|=o,Zl|=o,h)}function XA(o,c,h,v){return cr(h,c)?h:Ne.current!==null?(o=ty(o,h,v),cr(o,c)||(Bi=!0),o):(Pe&42)===0?(Bi=!0,o.memoizedState=h):(o=qS(),de.lanes|=o,Zl|=o,c)}function YA(o,c,h,v,w){var T=q.p;q.p=T!==0&&8>T?T:8;var H=K.T,Z={};K.T=Z,iy(o,!1,c,h);try{var vt=w(),Pt=K.S;if(Pt!==null&&Pt(Z,vt),vt!==null&&typeof vt=="object"&&typeof vt.then=="function"){var Vt=Qx(vt,v);Mh(o,c,Vt,ws(o))}else Mh(o,c,v,ws(o))}catch(Kt){Mh(o,c,{then:function(){},status:"rejected",reason:Kt},ws())}finally{q.p=T,K.T=H}}function U6(){}function ey(o,c,h,v){if(o.tag!==5)throw Error(i(476));var w=qA(o).queue;YA(o,w,c,_t,h===null?U6:function(){return KA(o),h(v)})}function qA(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:_t,baseState:_t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:_t},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:h},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function KA(o){var c=qA(o).next.queue;Mh(o,c,{},ws())}function ny(){return Ri(Jh)}function ZA(){return Qn().memoizedState}function QA(){return Qn().memoizedState}function z6(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var h=ws();o=Xt(h);var v=re(c,o,h);v!==null&&(Es(v,c,h),he(v,c,h)),c={cache:qc()},o.payload=c;return}c=c.return}}function H6(o,c,h){var v=ws();h={lane:v,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},Xm(o)?tS(c,h):(h=ch(o,c,h,v),h!==null&&(Es(h,o,v),eS(h,c,v)))}function JA(o,c,h){var v=ws();Mh(o,c,h,v)}function Mh(o,c,h,v){var w={lane:v,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(Xm(o))tS(c,w);else{var T=o.alternate;if(o.lanes===0&&(T===null||T.lanes===0)&&(T=c.lastRenderedReducer,T!==null))try{var H=c.lastRenderedState,Z=T(H,h);if(w.hasEagerState=!0,w.eagerState=Z,cr(Z,H))return lf(o,c,w,0),Hn===null&&of(),!1}catch{}finally{}if(h=ch(o,c,w,v),h!==null)return Es(h,o,v),eS(h,c,v),!0}return!1}function iy(o,c,h,v){if(v={lane:2,revertLane:My(),action:v,hasEagerState:!1,eagerState:null,next:null},Xm(o)){if(c)throw Error(i(479))}else c=ch(o,h,v,2),c!==null&&Es(c,o,2)}function Xm(o){var c=o.alternate;return o===de||c!==null&&c===de}function tS(o,c){Rn=ln=!0;var h=o.pending;h===null?c.next=c:(c.next=h.next,h.next=c),o.pending=c}function eS(o,c,h){if((h&4194048)!==0){var v=c.lanes;v&=o.pendingLanes,h|=v,c.lanes=h,Yu(o,h)}}var Ym={readContext:Ri,use:hf,useCallback:Ge,useContext:Ge,useEffect:Ge,useImperativeHandle:Ge,useLayoutEffect:Ge,useInsertionEffect:Ge,useMemo:Ge,useReducer:Ge,useRef:Ge,useState:Ge,useDebugValue:Ge,useDeferredValue:Ge,useTransition:Ge,useSyncExternalStore:Ge,useId:Ge,useHostTransitionStatus:Ge,useFormState:Ge,useActionState:Ge,useOptimistic:Ge,useMemoCache:Ge,useCacheRefresh:Ge},nS={readContext:Ri,use:hf,useCallback:function(o,c){return Ii().memoizedState=[o,c===void 0?null:c],o},useContext:Ri,useEffect:jA,useImperativeHandle:function(o,c,h){h=h!=null?h.concat([o]):null,Wm(4194308,4,$A.bind(null,c,o),h)},useLayoutEffect:function(o,c){return Wm(4194308,4,o,c)},useInsertionEffect:function(o,c){Wm(4,2,o,c)},useMemo:function(o,c){var h=Ii();c=c===void 0?null:c;var v=o();if(li){ne(!0);try{o()}finally{ne(!1)}}return h.memoizedState=[v,c],v},useReducer:function(o,c,h){var v=Ii();if(h!==void 0){var w=h(c);if(li){ne(!0);try{h(c)}finally{ne(!1)}}}else w=c;return v.memoizedState=v.baseState=w,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:w},v.queue=o,o=o.dispatch=H6.bind(null,de,o),[v.memoizedState,o]},useRef:function(o){var c=Ii();return o={current:o},c.memoizedState=o},useState:function(o){o=gf(o);var c=o.queue,h=JA.bind(null,de,c);return c.dispatch=h,[o.memoizedState,h]},useDebugValue:Jx,useDeferredValue:function(o,c){var h=Ii();return ty(h,o,c)},useTransition:function(){var o=gf(!1);return o=YA.bind(null,de,o.queue,!0,!1),Ii().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,h){var v=de,w=Ii();if(pn){if(h===void 0)throw Error(i(407));h=h()}else{if(h=c(),Hn===null)throw Error(i(349));(cn&124)!==0||Ch(v,c,h)}w.memoizedState=h;var T={value:h,getSnapshot:c};return w.queue=T,jA(Hm.bind(null,v,T,o),[o]),v.flags|=2048,yf(9,Vm(),zm.bind(null,v,T,h,c),null),h},useId:function(){var o=Ii(),c=Hn.identifierPrefix;if(pn){var h=Yi,v=ba;h=(v&~(1<<32-Me(v)-1)).toString(32)+h,c="«"+c+"R"+h,h=dr++,0<h&&(c+="H"+h.toString(32)),c+="»"}else h=Qr++,c="«"+c+"r"+h.toString(32)+"»";return o.memoizedState=c},useHostTransitionStatus:ny,useFormState:xf,useActionState:xf,useOptimistic:function(o){var c=Ii();c.memoizedState=c.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=iy.bind(null,de,!0,h),h.dispatch=c,[o,c]},useMemoCache:Ah,useCacheRefresh:function(){return Ii().memoizedState=z6.bind(null,de)}},iS={readContext:Ri,use:hf,useCallback:VA,useContext:Ri,useEffect:UA,useImperativeHandle:GA,useInsertionEffect:zA,useLayoutEffect:HA,useMemo:WA,useReducer:pf,useRef:BA,useState:function(){return pf(xs)},useDebugValue:Jx,useDeferredValue:function(o,c){var h=Qn();return XA(h,_e.memoizedState,o,c)},useTransition:function(){var o=pf(xs)[0],c=Qn().memoizedState;return[typeof o=="boolean"?o:Ka(o),c]},useSyncExternalStore:Th,useId:ZA,useHostTransitionStatus:ny,useFormState:Ih,useActionState:Ih,useOptimistic:function(o,c){var h=Qn();return Dh(h,_e,o,c)},useMemoCache:Ah,useCacheRefresh:QA},$6={readContext:Ri,use:hf,useCallback:VA,useContext:Ri,useEffect:UA,useImperativeHandle:GA,useInsertionEffect:zA,useLayoutEffect:HA,useMemo:WA,useReducer:Sh,useRef:BA,useState:function(){return Sh(xs)},useDebugValue:Jx,useDeferredValue:function(o,c){var h=Qn();return _e===null?ty(h,o,c):XA(h,_e.memoizedState,o,c)},useTransition:function(){var o=Sh(xs)[0],c=Qn().memoizedState;return[typeof o=="boolean"?o:Ka(o),c]},useSyncExternalStore:Th,useId:ZA,useHostTransitionStatus:ny,useFormState:PA,useActionState:PA,useOptimistic:function(o,c){var h=Qn();return _e!==null?Dh(h,_e,o,c):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:Ah,useCacheRefresh:QA},_f=null,Fh=0;function qm(o){var c=Fh;return Fh+=1,_f===null&&(_f=[]),W(_f,o,c)}function Ph(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function Km(o,c){throw c.$$typeof===p?Error(i(525)):(o=Object.prototype.toString.call(c),Error(i(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function rS(o){var c=o._init;return c(o._payload)}function sS(o){function c(Nt,wt){if(o){var Mt=Nt.deletions;Mt===null?(Nt.deletions=[wt],Nt.flags|=16):Mt.push(wt)}}function h(Nt,wt){if(!o)return null;for(;wt!==null;)c(Nt,wt),wt=wt.sibling;return null}function v(Nt){for(var wt=new Map;Nt!==null;)Nt.key!==null?wt.set(Nt.key,Nt):wt.set(Nt.index,Nt),Nt=Nt.sibling;return wt}function w(Nt,wt){return Nt=ya(Nt,wt),Nt.index=0,Nt.sibling=null,Nt}function T(Nt,wt,Mt){return Nt.index=Mt,o?(Mt=Nt.alternate,Mt!==null?(Mt=Mt.index,Mt<wt?(Nt.flags|=67108866,wt):Mt):(Nt.flags|=67108866,wt)):(Nt.flags|=1048576,wt)}function H(Nt){return o&&Nt.alternate===null&&(Nt.flags|=67108866),Nt}function Z(Nt,wt,Mt,Yt){return wt===null||wt.tag!==6?(wt=jl(Mt,Nt.mode,Yt),wt.return=Nt,wt):(wt=w(wt,Mt),wt.return=Nt,wt)}function vt(Nt,wt,Mt,Yt){var ge=Mt.type;return ge===y?Vt(Nt,wt,Mt.props.children,Yt,Mt.key):wt!==null&&(wt.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===L&&rS(ge)===wt.type)?(wt=w(wt,Mt.props),Ph(wt,Mt),wt.return=Nt,wt):(wt=uf(Mt.type,Mt.key,Mt.props,null,Nt.mode,Yt),Ph(wt,Mt),wt.return=Nt,wt)}function Pt(Nt,wt,Mt,Yt){return wt===null||wt.tag!==4||wt.stateNode.containerInfo!==Mt.containerInfo||wt.stateNode.implementation!==Mt.implementation?(wt=dh(Mt,Nt.mode,Yt),wt.return=Nt,wt):(wt=w(wt,Mt.children||[]),wt.return=Nt,wt)}function Vt(Nt,wt,Mt,Yt,ge){return wt===null||wt.tag!==7?(wt=_a(Mt,Nt.mode,Yt,ge),wt.return=Nt,wt):(wt=w(wt,Mt),wt.return=Nt,wt)}function Kt(Nt,wt,Mt){if(typeof wt=="string"&&wt!==""||typeof wt=="number"||typeof wt=="bigint")return wt=jl(""+wt,Nt.mode,Mt),wt.return=Nt,wt;if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case m:return Mt=uf(wt.type,wt.key,wt.props,null,Nt.mode,Mt),Ph(Mt,wt),Mt.return=Nt,Mt;case g:return wt=dh(wt,Nt.mode,Mt),wt.return=Nt,wt;case L:var Yt=wt._init;return wt=Yt(wt._payload),Kt(Nt,wt,Mt)}if(et(wt)||B(wt))return wt=_a(wt,Nt.mode,Mt,null),wt.return=Nt,wt;if(typeof wt.then=="function")return Kt(Nt,qm(wt),Mt);if(wt.$$typeof===A)return Kt(Nt,Hl(Nt,wt),Mt);Km(Nt,wt)}return null}function Ut(Nt,wt,Mt,Yt){var ge=wt!==null?wt.key:null;if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint")return ge!==null?null:Z(Nt,wt,""+Mt,Yt);if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case m:return Mt.key===ge?vt(Nt,wt,Mt,Yt):null;case g:return Mt.key===ge?Pt(Nt,wt,Mt,Yt):null;case L:return ge=Mt._init,Mt=ge(Mt._payload),Ut(Nt,wt,Mt,Yt)}if(et(Mt)||B(Mt))return ge!==null?null:Vt(Nt,wt,Mt,Yt,null);if(typeof Mt.then=="function")return Ut(Nt,wt,qm(Mt),Yt);if(Mt.$$typeof===A)return Ut(Nt,wt,Hl(Nt,Mt),Yt);Km(Nt,Mt)}return null}function zt(Nt,wt,Mt,Yt,ge){if(typeof Yt=="string"&&Yt!==""||typeof Yt=="number"||typeof Yt=="bigint")return Nt=Nt.get(Mt)||null,Z(wt,Nt,""+Yt,ge);if(typeof Yt=="object"&&Yt!==null){switch(Yt.$$typeof){case m:return Nt=Nt.get(Yt.key===null?Mt:Yt.key)||null,vt(wt,Nt,Yt,ge);case g:return Nt=Nt.get(Yt.key===null?Mt:Yt.key)||null,Pt(wt,Nt,Yt,ge);case L:var Qe=Yt._init;return Yt=Qe(Yt._payload),zt(Nt,wt,Mt,Yt,ge)}if(et(Yt)||B(Yt))return Nt=Nt.get(Mt)||null,Vt(wt,Nt,Yt,ge,null);if(typeof Yt.then=="function")return zt(Nt,wt,Mt,qm(Yt),ge);if(Yt.$$typeof===A)return zt(Nt,wt,Mt,Hl(wt,Yt),ge);Km(wt,Yt)}return null}function Ue(Nt,wt,Mt,Yt){for(var ge=null,Qe=null,be=wt,Ie=wt=0,Ui=null;be!==null&&Ie<Mt.length;Ie++){be.index>Ie?(Ui=be,be=null):Ui=be.sibling;var vn=Ut(Nt,be,Mt[Ie],Yt);if(vn===null){be===null&&(be=Ui);break}o&&be&&vn.alternate===null&&c(Nt,be),wt=T(vn,wt,Ie),Qe===null?ge=vn:Qe.sibling=vn,Qe=vn,be=Ui}if(Ie===Mt.length)return h(Nt,be),pn&&Bo(Nt,Ie),ge;if(be===null){for(;Ie<Mt.length;Ie++)be=Kt(Nt,Mt[Ie],Yt),be!==null&&(wt=T(be,wt,Ie),Qe===null?ge=be:Qe.sibling=be,Qe=be);return pn&&Bo(Nt,Ie),ge}for(be=v(be);Ie<Mt.length;Ie++)Ui=zt(be,Nt,Ie,Mt[Ie],Yt),Ui!==null&&(o&&Ui.alternate!==null&&be.delete(Ui.key===null?Ie:Ui.key),wt=T(Ui,wt,Ie),Qe===null?ge=Ui:Qe.sibling=Ui,Qe=Ui);return o&&be.forEach(function(ac){return c(Nt,ac)}),pn&&Bo(Nt,Ie),ge}function Le(Nt,wt,Mt,Yt){if(Mt==null)throw Error(i(151));for(var ge=null,Qe=null,be=wt,Ie=wt=0,Ui=null,vn=Mt.next();be!==null&&!vn.done;Ie++,vn=Mt.next()){be.index>Ie?(Ui=be,be=null):Ui=be.sibling;var ac=Ut(Nt,be,vn.value,Yt);if(ac===null){be===null&&(be=Ui);break}o&&be&&ac.alternate===null&&c(Nt,be),wt=T(ac,wt,Ie),Qe===null?ge=ac:Qe.sibling=ac,Qe=ac,be=Ui}if(vn.done)return h(Nt,be),pn&&Bo(Nt,Ie),ge;if(be===null){for(;!vn.done;Ie++,vn=Mt.next())vn=Kt(Nt,vn.value,Yt),vn!==null&&(wt=T(vn,wt,Ie),Qe===null?ge=vn:Qe.sibling=vn,Qe=vn);return pn&&Bo(Nt,Ie),ge}for(be=v(be);!vn.done;Ie++,vn=Mt.next())vn=zt(be,Nt,Ie,vn.value,Yt),vn!==null&&(o&&vn.alternate!==null&&be.delete(vn.key===null?Ie:vn.key),wt=T(vn,wt,Ie),Qe===null?ge=vn:Qe.sibling=vn,Qe=vn);return o&&be.forEach(function(GM){return c(Nt,GM)}),pn&&Bo(Nt,Ie),ge}function Ln(Nt,wt,Mt,Yt){if(typeof Mt=="object"&&Mt!==null&&Mt.type===y&&Mt.key===null&&(Mt=Mt.props.children),typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case m:t:{for(var ge=Mt.key;wt!==null;){if(wt.key===ge){if(ge=Mt.type,ge===y){if(wt.tag===7){h(Nt,wt.sibling),Yt=w(wt,Mt.props.children),Yt.return=Nt,Nt=Yt;break t}}else if(wt.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===L&&rS(ge)===wt.type){h(Nt,wt.sibling),Yt=w(wt,Mt.props),Ph(Yt,Mt),Yt.return=Nt,Nt=Yt;break t}h(Nt,wt);break}else c(Nt,wt);wt=wt.sibling}Mt.type===y?(Yt=_a(Mt.props.children,Nt.mode,Yt,Mt.key),Yt.return=Nt,Nt=Yt):(Yt=uf(Mt.type,Mt.key,Mt.props,null,Nt.mode,Yt),Ph(Yt,Mt),Yt.return=Nt,Nt=Yt)}return H(Nt);case g:t:{for(ge=Mt.key;wt!==null;){if(wt.key===ge)if(wt.tag===4&&wt.stateNode.containerInfo===Mt.containerInfo&&wt.stateNode.implementation===Mt.implementation){h(Nt,wt.sibling),Yt=w(wt,Mt.children||[]),Yt.return=Nt,Nt=Yt;break t}else{h(Nt,wt);break}else c(Nt,wt);wt=wt.sibling}Yt=dh(Mt,Nt.mode,Yt),Yt.return=Nt,Nt=Yt}return H(Nt);case L:return ge=Mt._init,Mt=ge(Mt._payload),Ln(Nt,wt,Mt,Yt)}if(et(Mt))return Ue(Nt,wt,Mt,Yt);if(B(Mt)){if(ge=B(Mt),typeof ge!="function")throw Error(i(150));return Mt=ge.call(Mt),Le(Nt,wt,Mt,Yt)}if(typeof Mt.then=="function")return Ln(Nt,wt,qm(Mt),Yt);if(Mt.$$typeof===A)return Ln(Nt,wt,Hl(Nt,Mt),Yt);Km(Nt,Mt)}return typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint"?(Mt=""+Mt,wt!==null&&wt.tag===6?(h(Nt,wt.sibling),Yt=w(wt,Mt),Yt.return=Nt,Nt=Yt):(h(Nt,wt),Yt=jl(Mt,Nt.mode,Yt),Yt.return=Nt,Nt=Yt),H(Nt)):h(Nt,wt)}return function(Nt,wt,Mt,Yt){try{Fh=0;var ge=Ln(Nt,wt,Mt,Yt);return _f=null,ge}catch(be){if(be===Gl||be===Go)throw be;var Qe=Lr(29,be,null,Nt.mode);return Qe.lanes=Yt,Qe.return=Nt,Qe}finally{}}}var bf=sS(!0),aS=sS(!1),qs=X(null),Qa=null;function Vl(o){var c=o.alternate;it(ki,ki.current&1),it(qs,o),Qa===null&&(c===null||Ne.current!==null||c.memoizedState!==null)&&(Qa=o)}function oS(o){if(o.tag===22){if(it(ki,ki.current),it(qs,o),Qa===null){var c=o.alternate;c!==null&&c.memoizedState!==null&&(Qa=o)}}else Wl()}function Wl(){it(ki,ki.current),it(qs,qs.current)}function Wo(o){V(qs),Qa===o&&(Qa=null),V(ki)}var ki=X(0);function Zm(o){for(var c=o;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||Xy(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function ry(o,c,h,v){c=o.memoizedState,h=h(v,c),h=h==null?c:d({},c,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var sy={enqueueSetState:function(o,c,h){o=o._reactInternals;var v=ws(),w=Xt(v);w.payload=c,h!=null&&(w.callback=h),c=re(o,w,v),c!==null&&(Es(c,o,v),he(c,o,v))},enqueueReplaceState:function(o,c,h){o=o._reactInternals;var v=ws(),w=Xt(v);w.tag=1,w.payload=c,h!=null&&(w.callback=h),c=re(o,w,v),c!==null&&(Es(c,o,v),he(c,o,v))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var h=ws(),v=Xt(h);v.tag=2,c!=null&&(v.callback=c),c=re(o,v,h),c!==null&&(Es(c,o,h),he(c,o,h))}};function lS(o,c,h,v,w,T,H){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,T,H):c.prototype&&c.prototype.isPureReactComponent?!Lo(h,v)||!Lo(w,T):!0}function cS(o,c,h,v){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,v),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,v),c.state!==o&&sy.enqueueReplaceState(c,c.state,null)}function Qc(o,c){var h=c;if("ref"in c){h={};for(var v in c)v!=="ref"&&(h[v]=c[v])}if(o=o.defaultProps){h===c&&(h=d({},h));for(var w in o)h[w]===void 0&&(h[w]=o[w])}return h}var Qm=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function uS(o){Qm(o)}function fS(o){console.error(o)}function dS(o){Qm(o)}function Jm(o,c){try{var h=o.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(v){setTimeout(function(){throw v})}}function hS(o,c,h){try{var v=o.onCaughtError;v(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function ay(o,c,h){return h=Xt(h),h.tag=3,h.payload={element:null},h.callback=function(){Jm(o,c)},h}function pS(o){return o=Xt(o),o.tag=3,o}function mS(o,c,h,v){var w=h.type.getDerivedStateFromError;if(typeof w=="function"){var T=v.value;o.payload=function(){return w(T)},o.callback=function(){hS(c,h,v)}}var H=h.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(o.callback=function(){hS(c,h,v),typeof w!="function"&&(Ql===null?Ql=new Set([this]):Ql.add(this));var Z=v.stack;this.componentDidCatch(v.value,{componentStack:Z!==null?Z:""})})}function G6(o,c,h,v,w){if(h.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(c=h.alternate,c!==null&&Xc(c,h,w,!0),h=qs.current,h!==null){switch(h.tag){case 13:return Qa===null?Ry():h.alternate===null&&ai===0&&(ai=3),h.flags&=-257,h.flags|=65536,h.lanes=w,v===Eh?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([v]):c.add(v),Ly(o,v,w)),!1;case 22:return h.flags|=65536,v===Eh?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([v])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([v]):h.add(v)),Ly(o,v,w)),!1}throw Error(i(435,h.tag))}return Ly(o,v,w),Ry(),!1}if(pn)return c=qs.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=w,v!==Xa&&(o=Error(i(422),{cause:v}),vs(Rr(o,h)))):(v!==Xa&&(c=Error(i(423),{cause:v}),vs(Rr(c,h))),o=o.current.alternate,o.flags|=65536,w&=-w,o.lanes|=w,v=Rr(v,h),w=ay(o.stateNode,v,w),pe(o,w),ai!==4&&(ai=2)),!1;var T=Error(i(520),{cause:v});if(T=Rr(T,h),Gh===null?Gh=[T]:Gh.push(T),ai!==4&&(ai=2),c===null)return!0;v=Rr(v,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,o=w&-w,h.lanes|=o,o=ay(h.stateNode,v,o),pe(h,o),!1;case 1:if(c=h.type,T=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ql===null||!Ql.has(T))))return h.flags|=65536,w&=-w,h.lanes|=w,w=pS(w),mS(w,o,h,v),pe(h,w),!1}h=h.return}while(h!==null);return!1}var gS=Error(i(461)),Bi=!1;function qi(o,c,h,v){c.child=o===null?aS(c,null,h,v):bf(c,o.child,h,v)}function vS(o,c,h,v,w){h=h.render;var T=c.ref;if("ref"in v){var H={};for(var Z in v)Z!=="ref"&&(H[Z]=v[Z])}else H=v;return Uo(c),v=ts(o,c,h,H,T,w),Z=Li(),o!==null&&!Bi?(hr(o,c,w),Xo(o,c,w)):(pn&&Z&&hh(c),c.flags|=1,qi(o,c,v,w),c.child)}function xS(o,c,h,v,w){if(o===null){var T=h.type;return typeof T=="function"&&!fh(T)&&T.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=T,yS(o,c,T,v,w)):(o=uf(h.type,null,v,c,c.mode,w),o.ref=c.ref,o.return=c,c.child=o)}if(T=o.child,!py(o,w)){var H=T.memoizedProps;if(h=h.compare,h=h!==null?h:Lo,h(H,v)&&o.ref===c.ref)return Xo(o,c,w)}return c.flags|=1,o=ya(T,v),o.ref=c.ref,o.return=c,c.child=o}function yS(o,c,h,v,w){if(o!==null){var T=o.memoizedProps;if(Lo(T,v)&&o.ref===c.ref)if(Bi=!1,c.pendingProps=v=T,py(o,w))(o.flags&131072)!==0&&(Bi=!0);else return c.lanes=o.lanes,Xo(o,c,w)}return oy(o,c,h,v,w)}function _S(o,c,h){var v=c.pendingProps,w=v.children,T=o!==null?o.memoizedState:null;if(v.mode==="hidden"){if((c.flags&128)!==0){if(v=T!==null?T.baseLanes|h:h,o!==null){for(w=c.child=o.child,T=0;w!==null;)T=T|w.lanes|w.childLanes,w=w.sibling;c.childLanes=T&~v}else c.childLanes=0,c.child=null;return bS(o,c,v,h)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&ff(c,T!==null?T.cachePool:null),T!==null?En(c,T):We(),oS(c);else return c.lanes=c.childLanes=536870912,bS(o,c,T!==null?T.baseLanes|h:h,h)}else T!==null?(ff(c,T.cachePool),En(c,T),Wl(),c.memoizedState=null):(o!==null&&ff(c,null),We(),Wl());return qi(o,c,w,h),c.child}function bS(o,c,h,v){var w=wh();return w=w===null?null:{parent:si._currentValue,pool:w},c.memoizedState={baseLanes:h,cachePool:w},o!==null&&ff(c,null),We(),oS(c),o!==null&&Xc(o,c,v,!0),null}function tg(o,c){var h=c.ref;if(h===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(i(284));(o===null||o.ref!==h)&&(c.flags|=4194816)}}function oy(o,c,h,v,w){return Uo(c),h=ts(o,c,h,v,void 0,w),v=Li(),o!==null&&!Bi?(hr(o,c,w),Xo(o,c,w)):(pn&&v&&hh(c),c.flags|=1,qi(o,c,h,w),c.child)}function wS(o,c,h,v,w,T){return Uo(c),c.updateQueue=null,h=ui(c,v,h,w),Vo(o),v=Li(),o!==null&&!Bi?(hr(o,c,T),Xo(o,c,T)):(pn&&v&&hh(c),c.flags|=1,qi(o,c,h,T),c.child)}function ES(o,c,h,v,w){if(Uo(c),c.stateNode===null){var T=Bl,H=h.contextType;typeof H=="object"&&H!==null&&(T=Ri(H)),T=new h(v,T),c.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=sy,c.stateNode=T,T._reactInternals=c,T=c.stateNode,T.props=v,T.state=c.memoizedState,T.refs={},Ot(c),H=h.contextType,T.context=typeof H=="object"&&H!==null?Ri(H):Bl,T.state=c.memoizedState,H=h.getDerivedStateFromProps,typeof H=="function"&&(ry(c,h,H,v),T.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(H=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),H!==T.state&&sy.enqueueReplaceState(T,T.state,null),Te(c,v,T,w),ze(),T.state=c.memoizedState),typeof T.componentDidMount=="function"&&(c.flags|=4194308),v=!0}else if(o===null){T=c.stateNode;var Z=c.memoizedProps,vt=Qc(h,Z);T.props=vt;var Pt=T.context,Vt=h.contextType;H=Bl,typeof Vt=="object"&&Vt!==null&&(H=Ri(Vt));var Kt=h.getDerivedStateFromProps;Vt=typeof Kt=="function"||typeof T.getSnapshotBeforeUpdate=="function",Z=c.pendingProps!==Z,Vt||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(Z||Pt!==H)&&cS(c,T,v,H),At=!1;var Ut=c.memoizedState;T.state=Ut,Te(c,v,T,w),ze(),Pt=c.memoizedState,Z||Ut!==Pt||At?(typeof Kt=="function"&&(ry(c,h,Kt,v),Pt=c.memoizedState),(vt=At||lS(c,h,vt,v,Ut,Pt,H))?(Vt||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(c.flags|=4194308)):(typeof T.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=v,c.memoizedState=Pt),T.props=v,T.state=Pt,T.context=H,v=vt):(typeof T.componentDidMount=="function"&&(c.flags|=4194308),v=!1)}else{T=c.stateNode,Gt(o,c),H=c.memoizedProps,Vt=Qc(h,H),T.props=Vt,Kt=c.pendingProps,Ut=T.context,Pt=h.contextType,vt=Bl,typeof Pt=="object"&&Pt!==null&&(vt=Ri(Pt)),Z=h.getDerivedStateFromProps,(Pt=typeof Z=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(H!==Kt||Ut!==vt)&&cS(c,T,v,vt),At=!1,Ut=c.memoizedState,T.state=Ut,Te(c,v,T,w),ze();var zt=c.memoizedState;H!==Kt||Ut!==zt||At||o!==null&&o.dependencies!==null&&Yc(o.dependencies)?(typeof Z=="function"&&(ry(c,h,Z,v),zt=c.memoizedState),(Vt=At||lS(c,h,Vt,v,Ut,zt,vt)||o!==null&&o.dependencies!==null&&Yc(o.dependencies))?(Pt||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(v,zt,vt),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(v,zt,vt)),typeof T.componentDidUpdate=="function"&&(c.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof T.componentDidUpdate!="function"||H===o.memoizedProps&&Ut===o.memoizedState||(c.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||H===o.memoizedProps&&Ut===o.memoizedState||(c.flags|=1024),c.memoizedProps=v,c.memoizedState=zt),T.props=v,T.state=zt,T.context=vt,v=Vt):(typeof T.componentDidUpdate!="function"||H===o.memoizedProps&&Ut===o.memoizedState||(c.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||H===o.memoizedProps&&Ut===o.memoizedState||(c.flags|=1024),v=!1)}return T=v,tg(o,c),v=(c.flags&128)!==0,T||v?(T=c.stateNode,h=v&&typeof h.getDerivedStateFromError!="function"?null:T.render(),c.flags|=1,o!==null&&v?(c.child=bf(c,o.child,null,w),c.child=bf(c,null,h,w)):qi(o,c,h,w),c.memoizedState=T.state,o=c.child):o=Xo(o,c,w),o}function AS(o,c,h,v){return Wc(),c.flags|=256,qi(o,c,h,v),c.child}var ly={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function cy(o){return{baseLanes:o,cachePool:jm()}}function uy(o,c,h){return o=o!==null?o.childLanes&~h:0,c&&(o|=Ks),o}function SS(o,c,h){var v=c.pendingProps,w=!1,T=(c.flags&128)!==0,H;if((H=T)||(H=o!==null&&o.memoizedState===null?!1:(ki.current&2)!==0),H&&(w=!0,c.flags&=-129),H=(c.flags&32)!==0,c.flags&=-33,o===null){if(pn){if(w?Vl(c):Wl(),pn){var Z=zn,vt;if(vt=Z){t:{for(vt=Z,Z=Xs;vt.nodeType!==8;){if(!Z){Z=null;break t}if(vt=Ta(vt.nextSibling),vt===null){Z=null;break t}}Z=vt}Z!==null?(c.memoizedState={dehydrated:Z,treeContext:Po!==null?{id:ba,overflow:Yi}:null,retryLane:536870912,hydrationErrors:null},vt=Lr(18,null,null,0),vt.stateNode=Z,vt.return=c,c.child=vt,_i=c,zn=null,vt=!0):vt=!1}vt||wa(c)}if(Z=c.memoizedState,Z!==null&&(Z=Z.dehydrated,Z!==null))return Xy(Z)?c.lanes=32:c.lanes=536870912,null;Wo(c)}return Z=v.children,v=v.fallback,w?(Wl(),w=c.mode,Z=eg({mode:"hidden",children:Z},w),v=_a(v,w,h,null),Z.return=c,v.return=c,Z.sibling=v,c.child=Z,w=c.child,w.memoizedState=cy(h),w.childLanes=uy(o,H,h),c.memoizedState=ly,v):(Vl(c),fy(c,Z))}if(vt=o.memoizedState,vt!==null&&(Z=vt.dehydrated,Z!==null)){if(T)c.flags&256?(Vl(c),c.flags&=-257,c=dy(o,c,h)):c.memoizedState!==null?(Wl(),c.child=o.child,c.flags|=128,c=null):(Wl(),w=v.fallback,Z=c.mode,v=eg({mode:"visible",children:v.children},Z),w=_a(w,Z,h,null),w.flags|=2,v.return=c,w.return=c,v.sibling=w,c.child=v,bf(c,o.child,null,h),v=c.child,v.memoizedState=cy(h),v.childLanes=uy(o,H,h),c.memoizedState=ly,c=w);else if(Vl(c),Xy(Z)){if(H=Z.nextSibling&&Z.nextSibling.dataset,H)var Pt=H.dgst;H=Pt,v=Error(i(419)),v.stack="",v.digest=H,vs({value:v,source:null,stack:null}),c=dy(o,c,h)}else if(Bi||Xc(o,c,h,!1),H=(h&o.childLanes)!==0,Bi||H){if(H=Hn,H!==null&&(v=h&-h,v=(v&42)!==0?1:Nc(v),v=(v&(H.suspendedLanes|h))!==0?0:v,v!==0&&v!==vt.retryLane))throw vt.retryLane=v,ur(o,v),Es(H,o,v),gS;Z.data==="$?"||Ry(),c=dy(o,c,h)}else Z.data==="$?"?(c.flags|=192,c.child=o.child,c=null):(o=vt.treeContext,zn=Ta(Z.nextSibling),_i=c,pn=!0,Wa=null,Xs=!1,o!==null&&(fr[Kr++]=ba,fr[Kr++]=Yi,fr[Kr++]=Po,ba=o.id,Yi=o.overflow,Po=c),c=fy(c,v.children),c.flags|=4096);return c}return w?(Wl(),w=v.fallback,Z=c.mode,vt=o.child,Pt=vt.sibling,v=ya(vt,{mode:"hidden",children:v.children}),v.subtreeFlags=vt.subtreeFlags&65011712,Pt!==null?w=ya(Pt,w):(w=_a(w,Z,h,null),w.flags|=2),w.return=c,v.return=c,v.sibling=w,c.child=v,v=w,w=c.child,Z=o.child.memoizedState,Z===null?Z=cy(h):(vt=Z.cachePool,vt!==null?(Pt=si._currentValue,vt=vt.parent!==Pt?{parent:Pt,pool:Pt}:vt):vt=jm(),Z={baseLanes:Z.baseLanes|h,cachePool:vt}),w.memoizedState=Z,w.childLanes=uy(o,H,h),c.memoizedState=ly,v):(Vl(c),h=o.child,o=h.sibling,h=ya(h,{mode:"visible",children:v.children}),h.return=c,h.sibling=null,o!==null&&(H=c.deletions,H===null?(c.deletions=[o],c.flags|=16):H.push(o)),c.child=h,c.memoizedState=null,h)}function fy(o,c){return c=eg({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function eg(o,c){return o=Lr(22,o,null,c),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function dy(o,c,h){return bf(c,o.child,null,h),o=fy(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function TS(o,c,h){o.lanes|=c;var v=o.alternate;v!==null&&(v.lanes|=c),vh(o.return,c,h)}function hy(o,c,h,v,w){var T=o.memoizedState;T===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:w}:(T.isBackwards=c,T.rendering=null,T.renderingStartTime=0,T.last=v,T.tail=h,T.tailMode=w)}function CS(o,c,h){var v=c.pendingProps,w=v.revealOrder,T=v.tail;if(qi(o,c,v.children,h),v=ki.current,(v&2)!==0)v=v&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)t:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&TS(o,h,c);else if(o.tag===19)TS(o,h,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break t;for(;o.sibling===null;){if(o.return===null||o.return===c)break t;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}switch(it(ki,v),w){case"forwards":for(h=c.child,w=null;h!==null;)o=h.alternate,o!==null&&Zm(o)===null&&(w=h),h=h.sibling;h=w,h===null?(w=c.child,c.child=null):(w=h.sibling,h.sibling=null),hy(c,!1,w,h,T);break;case"backwards":for(h=null,w=c.child,c.child=null;w!==null;){if(o=w.alternate,o!==null&&Zm(o)===null){c.child=w;break}o=w.sibling,w.sibling=h,h=w,w=o}hy(c,!0,h,null,T);break;case"together":hy(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Xo(o,c,h){if(o!==null&&(c.dependencies=o.dependencies),Zl|=c.lanes,(h&c.childLanes)===0)if(o!==null){if(Xc(o,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(i(153));if(c.child!==null){for(o=c.child,h=ya(o,o.pendingProps),c.child=h,h.return=c;o.sibling!==null;)o=o.sibling,h=h.sibling=ya(o,o.pendingProps),h.return=c;h.sibling=null}return c.child}function py(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&Yc(o)))}function V6(o,c,h){switch(c.tag){case 3:G(c,c.stateNode.containerInfo),Ya(c,si,o.memoizedState.cache),Wc();break;case 27:case 5:rt(c);break;case 4:G(c,c.stateNode.containerInfo);break;case 10:Ya(c,c.type,c.memoizedProps.value);break;case 13:var v=c.memoizedState;if(v!==null)return v.dehydrated!==null?(Vl(c),c.flags|=128,null):(h&c.child.childLanes)!==0?SS(o,c,h):(Vl(c),o=Xo(o,c,h),o!==null?o.sibling:null);Vl(c);break;case 19:var w=(o.flags&128)!==0;if(v=(h&c.childLanes)!==0,v||(Xc(o,c,h,!1),v=(h&c.childLanes)!==0),w){if(v)return CS(o,c,h);c.flags|=128}if(w=c.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),it(ki,ki.current),v)break;return null;case 22:case 23:return c.lanes=0,_S(o,c,h);case 24:Ya(c,si,o.memoizedState.cache)}return Xo(o,c,h)}function DS(o,c,h){if(o!==null)if(o.memoizedProps!==c.pendingProps)Bi=!0;else{if(!py(o,h)&&(c.flags&128)===0)return Bi=!1,V6(o,c,h);Bi=(o.flags&131072)!==0}else Bi=!1,pn&&(c.flags&1048576)!==0&&km(c,Ul,c.index);switch(c.lanes=0,c.tag){case 16:t:{o=c.pendingProps;var v=c.elementType,w=v._init;if(v=w(v._payload),c.type=v,typeof v=="function")fh(v)?(o=Qc(v,o),c.tag=1,c=ES(null,c,v,o,h)):(c.tag=0,c=oy(null,c,v,o,h));else{if(v!=null){if(w=v.$$typeof,w===C){c.tag=11,c=vS(null,c,v,o,h);break t}else if(w===D){c.tag=14,c=xS(null,c,v,o,h);break t}}throw c=k(v)||v,Error(i(306,c,""))}}return c;case 0:return oy(o,c,c.type,c.pendingProps,h);case 1:return v=c.type,w=Qc(v,c.pendingProps),ES(o,c,v,w,h);case 3:t:{if(G(c,c.stateNode.containerInfo),o===null)throw Error(i(387));v=c.pendingProps;var T=c.memoizedState;w=T.element,Gt(o,c),Te(c,v,null,h);var H=c.memoizedState;if(v=H.cache,Ya(c,si,v),v!==T.cache&&xh(c,[si],h,!0),ze(),v=H.element,T.isDehydrated)if(T={element:v,isDehydrated:!1,cache:H.cache},c.updateQueue.baseState=T,c.memoizedState=T,c.flags&256){c=AS(o,c,v,h);break t}else if(v!==w){w=Rr(Error(i(424)),c),vs(w),c=AS(o,c,v,h);break t}else{switch(o=c.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(zn=Ta(o.firstChild),_i=c,pn=!0,Wa=null,Xs=!0,h=aS(c,null,v,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Wc(),v===w){c=Xo(o,c,h);break t}qi(o,c,v,h)}c=c.child}return c;case 26:return tg(o,c),o===null?(h=LT(c.type,null,c.pendingProps,null))?c.memoizedState=h:pn||(h=c.type,o=c.pendingProps,v=mg(Rt.current).createElement(h),v[vi]=c,v[xi]=o,Zi(v,h,o),Tt(v),c.stateNode=v):c.memoizedState=LT(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return rt(c),o===null&&pn&&(v=c.stateNode=OT(c.type,c.pendingProps,Rt.current),_i=c,Xs=!0,w=zn,ec(c.type)?(Yy=w,zn=Ta(v.firstChild)):zn=w),qi(o,c,c.pendingProps.children,h),tg(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&pn&&((w=v=zn)&&(v=yM(v,c.type,c.pendingProps,Xs),v!==null?(c.stateNode=v,_i=c,zn=Ta(v.firstChild),Xs=!1,w=!0):w=!1),w||wa(c)),rt(c),w=c.type,T=c.pendingProps,H=o!==null?o.memoizedProps:null,v=T.children,Gy(w,T)?v=null:H!==null&&Gy(w,H)&&(c.flags|=32),c.memoizedState!==null&&(w=ts(o,c,An,null,null,h),Jh._currentValue=w),tg(o,c),qi(o,c,v,h),c.child;case 6:return o===null&&pn&&((o=h=zn)&&(h=_M(h,c.pendingProps,Xs),h!==null?(c.stateNode=h,_i=c,zn=null,o=!0):o=!1),o||wa(c)),null;case 13:return SS(o,c,h);case 4:return G(c,c.stateNode.containerInfo),v=c.pendingProps,o===null?c.child=bf(c,null,v,h):qi(o,c,v,h),c.child;case 11:return vS(o,c,c.type,c.pendingProps,h);case 7:return qi(o,c,c.pendingProps,h),c.child;case 8:return qi(o,c,c.pendingProps.children,h),c.child;case 12:return qi(o,c,c.pendingProps.children,h),c.child;case 10:return v=c.pendingProps,Ya(c,c.type,v.value),qi(o,c,v.children,h),c.child;case 9:return w=c.type._context,v=c.pendingProps.children,Uo(c),w=Ri(w),v=v(w),c.flags|=1,qi(o,c,v,h),c.child;case 14:return xS(o,c,c.type,c.pendingProps,h);case 15:return yS(o,c,c.type,c.pendingProps,h);case 19:return CS(o,c,h);case 31:return v=c.pendingProps,h=c.mode,v={mode:v.mode,children:v.children},o===null?(h=eg(v,h),h.ref=c.ref,c.child=h,h.return=c,c=h):(h=ya(o.child,v),h.ref=c.ref,c.child=h,h.return=c,c=h),c;case 22:return _S(o,c,h);case 24:return Uo(c),v=Ri(si),o===null?(w=wh(),w===null&&(w=Hn,T=qc(),w.pooledCache=T,T.refCount++,T!==null&&(w.pooledCacheLanes|=h),w=T),c.memoizedState={parent:v,cache:w},Ot(c),Ya(c,si,w)):((o.lanes&h)!==0&&(Gt(o,c),Te(c,null,null,h),ze()),w=o.memoizedState,T=c.memoizedState,w.parent!==v?(w={parent:v,cache:v},c.memoizedState=w,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=w),Ya(c,si,v)):(v=T.cache,Ya(c,si,v),v!==w.cache&&xh(c,[si],h,!0))),qi(o,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(i(156,c.tag))}function Yo(o){o.flags|=4}function OS(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!PT(c)){if(c=qs.current,c!==null&&((cn&4194048)===cn?Qa!==null:(cn&62914560)!==cn&&(cn&536870912)===0||c!==Qa))throw E=Eh,Kc;o.flags|=8192}}function ng(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?wo():536870912,o.lanes|=c,Sf|=c)}function Bh(o,c){if(!pn)switch(o.tailMode){case"hidden":c=o.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Jn(o){var c=o.alternate!==null&&o.alternate.child===o.child,h=0,v=0;if(c)for(var w=o.child;w!==null;)h|=w.lanes|w.childLanes,v|=w.subtreeFlags&65011712,v|=w.flags&65011712,w.return=o,w=w.sibling;else for(w=o.child;w!==null;)h|=w.lanes|w.childLanes,v|=w.subtreeFlags,v|=w.flags,w.return=o,w=w.sibling;return o.subtreeFlags|=v,o.childLanes=h,c}function W6(o,c,h){var v=c.pendingProps;switch(ph(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jn(c),null;case 1:return Jn(c),null;case 3:return h=c.stateNode,v=null,o!==null&&(v=o.memoizedState.cache),c.memoizedState.cache!==v&&(c.flags|=2048),Aa(si),lt(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(Vc(c)?Yo(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,zl())),Jn(c),null;case 26:return h=c.memoizedState,o===null?(Yo(c),h!==null?(Jn(c),OS(c,h)):(Jn(c),c.flags&=-16777217)):h?h!==o.memoizedState?(Yo(c),Jn(c),OS(c,h)):(Jn(c),c.flags&=-16777217):(o.memoizedProps!==v&&Yo(c),Jn(c),c.flags&=-16777217),null;case 27:ot(c),h=Rt.current;var w=c.type;if(o!==null&&c.stateNode!=null)o.memoizedProps!==v&&Yo(c);else{if(!v){if(c.stateNode===null)throw Error(i(166));return Jn(c),null}o=ht.current,Vc(c)?mh(c):(o=OT(w,v,h),c.stateNode=o,Yo(c))}return Jn(c),null;case 5:if(ot(c),h=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==v&&Yo(c);else{if(!v){if(c.stateNode===null)throw Error(i(166));return Jn(c),null}if(o=ht.current,Vc(c))mh(c);else{switch(w=mg(Rt.current),o){case 1:o=w.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:o=w.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":o=w.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":o=w.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":o=w.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof v.is=="string"?w.createElement("select",{is:v.is}):w.createElement("select"),v.multiple?o.multiple=!0:v.size&&(o.size=v.size);break;default:o=typeof v.is=="string"?w.createElement(h,{is:v.is}):w.createElement(h)}}o[vi]=c,o[xi]=v;t:for(w=c.child;w!==null;){if(w.tag===5||w.tag===6)o.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===c)break t;for(;w.sibling===null;){if(w.return===null||w.return===c)break t;w=w.return}w.sibling.return=w.return,w=w.sibling}c.stateNode=o;t:switch(Zi(o,h,v),h){case"button":case"input":case"select":case"textarea":o=!!v.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&Yo(c)}}return Jn(c),c.flags&=-16777217,null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==v&&Yo(c);else{if(typeof v!="string"&&c.stateNode===null)throw Error(i(166));if(o=Rt.current,Vc(c)){if(o=c.stateNode,h=c.memoizedProps,v=null,w=_i,w!==null)switch(w.tag){case 27:case 5:v=w.memoizedProps}o[vi]=c,o=!!(o.nodeValue===h||v!==null&&v.suppressHydrationWarning===!0||wT(o.nodeValue,h)),o||wa(c)}else o=mg(o).createTextNode(v),o[vi]=c,c.stateNode=o}return Jn(c),null;case 13:if(v=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(w=Vc(c),v!==null&&v.dehydrated!==null){if(o===null){if(!w)throw Error(i(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(i(317));w[vi]=c}else Wc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Jn(c),w=!1}else w=zl(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=w),w=!0;if(!w)return c.flags&256?(Wo(c),c):(Wo(c),null)}if(Wo(c),(c.flags&128)!==0)return c.lanes=h,c;if(h=v!==null,o=o!==null&&o.memoizedState!==null,h){v=c.child,w=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(w=v.alternate.memoizedState.cachePool.pool);var T=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(T=v.memoizedState.cachePool.pool),T!==w&&(v.flags|=2048)}return h!==o&&h&&(c.child.flags|=8192),ng(c,c.updateQueue),Jn(c),null;case 4:return lt(),o===null&&jy(c.stateNode.containerInfo),Jn(c),null;case 10:return Aa(c.type),Jn(c),null;case 19:if(V(ki),w=c.memoizedState,w===null)return Jn(c),null;if(v=(c.flags&128)!==0,T=w.rendering,T===null)if(v)Bh(w,!1);else{if(ai!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(T=Zm(o),T!==null){for(c.flags|=128,Bh(w,!1),o=T.updateQueue,c.updateQueue=o,ng(c,o),c.subtreeFlags=0,o=h,h=c.child;h!==null;)Im(h,o),h=h.sibling;return it(ki,ki.current&1|2),c.child}o=o.sibling}w.tail!==null&&J()>sg&&(c.flags|=128,v=!0,Bh(w,!1),c.lanes=4194304)}else{if(!v)if(o=Zm(T),o!==null){if(c.flags|=128,v=!0,o=o.updateQueue,c.updateQueue=o,ng(c,o),Bh(w,!0),w.tail===null&&w.tailMode==="hidden"&&!T.alternate&&!pn)return Jn(c),null}else 2*J()-w.renderingStartTime>sg&&h!==536870912&&(c.flags|=128,v=!0,Bh(w,!1),c.lanes=4194304);w.isBackwards?(T.sibling=c.child,c.child=T):(o=w.last,o!==null?o.sibling=T:c.child=T,w.last=T)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=J(),c.sibling=null,o=ki.current,it(ki,v?o&1|2:o&1),c):(Jn(c),null);case 22:case 23:return Wo(c),on(),v=c.memoizedState!==null,o!==null?o.memoizedState!==null!==v&&(c.flags|=8192):v&&(c.flags|=8192),v?(h&536870912)!==0&&(c.flags&128)===0&&(Jn(c),c.subtreeFlags&6&&(c.flags|=8192)):Jn(c),h=c.updateQueue,h!==null&&ng(c,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),v=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==h&&(c.flags|=2048),o!==null&&V($o),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),Aa(si),Jn(c),null;case 25:return null;case 30:return null}throw Error(i(156,c.tag))}function X6(o,c){switch(ph(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return Aa(si),lt(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return ot(c),null;case 13:if(Wo(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(i(340));Wc()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return V(ki),null;case 4:return lt(),null;case 10:return Aa(c.type),null;case 22:case 23:return Wo(c),on(),o!==null&&V($o),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return Aa(si),null;case 25:return null;default:return null}}function RS(o,c){switch(ph(c),c.tag){case 3:Aa(si),lt();break;case 26:case 27:case 5:ot(c);break;case 4:lt();break;case 13:Wo(c);break;case 19:V(ki);break;case 10:Aa(c.type);break;case 22:case 23:Wo(c),on(),o!==null&&V($o);break;case 24:Aa(si)}}function jh(o,c){try{var h=c.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var w=v.next;h=w;do{if((h.tag&o)===o){v=void 0;var T=h.create,H=h.inst;v=T(),H.destroy=v}h=h.next}while(h!==w)}}catch(Z){jn(c,c.return,Z)}}function Xl(o,c,h){try{var v=c.updateQueue,w=v!==null?v.lastEffect:null;if(w!==null){var T=w.next;v=T;do{if((v.tag&o)===o){var H=v.inst,Z=H.destroy;if(Z!==void 0){H.destroy=void 0,w=c;var vt=h,Pt=Z;try{Pt()}catch(Vt){jn(w,vt,Vt)}}}v=v.next}while(v!==T)}}catch(Vt){jn(c,c.return,Vt)}}function NS(o){var c=o.updateQueue;if(c!==null){var h=o.stateNode;try{Fe(c,h)}catch(v){jn(o,o.return,v)}}}function LS(o,c,h){h.props=Qc(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(v){jn(o,c,v)}}function Uh(o,c){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var v=o.stateNode;break;case 30:v=o.stateNode;break;default:v=o.stateNode}typeof h=="function"?o.refCleanup=h(v):h.current=v}}catch(w){jn(o,c,w)}}function Ja(o,c){var h=o.ref,v=o.refCleanup;if(h!==null)if(typeof v=="function")try{v()}catch(w){jn(o,c,w)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(w){jn(o,c,w)}else h.current=null}function IS(o){var c=o.type,h=o.memoizedProps,v=o.stateNode;try{t:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&v.focus();break t;case"img":h.src?v.src=h.src:h.srcSet&&(v.srcset=h.srcSet)}}catch(w){jn(o,o.return,w)}}function my(o,c,h){try{var v=o.stateNode;pM(v,o.type,h,c),v[xi]=c}catch(w){jn(o,o.return,w)}}function kS(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&ec(o.type)||o.tag===4}function gy(o){t:for(;;){for(;o.sibling===null;){if(o.return===null||kS(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&ec(o.type)||o.flags&2||o.child===null||o.tag===4)continue t;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function vy(o,c,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(o),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=pg));else if(v!==4&&(v===27&&ec(o.type)&&(h=o.stateNode,c=null),o=o.child,o!==null))for(vy(o,c,h),o=o.sibling;o!==null;)vy(o,c,h),o=o.sibling}function ig(o,c,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,c?h.insertBefore(o,c):h.appendChild(o);else if(v!==4&&(v===27&&ec(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(ig(o,c,h),o=o.sibling;o!==null;)ig(o,c,h),o=o.sibling}function MS(o){var c=o.stateNode,h=o.memoizedProps;try{for(var v=o.type,w=c.attributes;w.length;)c.removeAttributeNode(w[0]);Zi(c,v,h),c[vi]=o,c[xi]=h}catch(T){jn(o,o.return,T)}}var qo=!1,fi=!1,xy=!1,FS=typeof WeakSet=="function"?WeakSet:Set,ji=null;function Y6(o,c){if(o=o.containerInfo,Hy=bg,o=eh(o),af(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else t:{h=(h=o.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var w=v.anchorOffset,T=v.focusNode;v=v.focusOffset;try{h.nodeType,T.nodeType}catch{h=null;break t}var H=0,Z=-1,vt=-1,Pt=0,Vt=0,Kt=o,Ut=null;e:for(;;){for(var zt;Kt!==h||w!==0&&Kt.nodeType!==3||(Z=H+w),Kt!==T||v!==0&&Kt.nodeType!==3||(vt=H+v),Kt.nodeType===3&&(H+=Kt.nodeValue.length),(zt=Kt.firstChild)!==null;)Ut=Kt,Kt=zt;for(;;){if(Kt===o)break e;if(Ut===h&&++Pt===w&&(Z=H),Ut===T&&++Vt===v&&(vt=H),(zt=Kt.nextSibling)!==null)break;Kt=Ut,Ut=Kt.parentNode}Kt=zt}h=Z===-1||vt===-1?null:{start:Z,end:vt}}else h=null}h=h||{start:0,end:0}}else h=null;for($y={focusedElem:o,selectionRange:h},bg=!1,ji=c;ji!==null;)if(c=ji,o=c.child,(c.subtreeFlags&1024)!==0&&o!==null)o.return=c,ji=o;else for(;ji!==null;){switch(c=ji,T=c.alternate,o=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&T!==null){o=void 0,h=c,w=T.memoizedProps,T=T.memoizedState,v=h.stateNode;try{var Ue=Qc(h.type,w,h.elementType===h.type);o=v.getSnapshotBeforeUpdate(Ue,T),v.__reactInternalSnapshotBeforeUpdate=o}catch(Le){jn(h,h.return,Le)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,h=o.nodeType,h===9)Wy(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Wy(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(i(163))}if(o=c.sibling,o!==null){o.return=c.return,ji=o;break}ji=c.return}}function PS(o,c,h){var v=h.flags;switch(h.tag){case 0:case 11:case 15:Yl(o,h),v&4&&jh(5,h);break;case 1:if(Yl(o,h),v&4)if(o=h.stateNode,c===null)try{o.componentDidMount()}catch(H){jn(h,h.return,H)}else{var w=Qc(h.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(w,c,o.__reactInternalSnapshotBeforeUpdate)}catch(H){jn(h,h.return,H)}}v&64&&NS(h),v&512&&Uh(h,h.return);break;case 3:if(Yl(o,h),v&64&&(o=h.updateQueue,o!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{Fe(o,c)}catch(H){jn(h,h.return,H)}}break;case 27:c===null&&v&4&&MS(h);case 26:case 5:Yl(o,h),c===null&&v&4&&IS(h),v&512&&Uh(h,h.return);break;case 12:Yl(o,h);break;case 13:Yl(o,h),v&4&&US(o,h),v&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=iM.bind(null,h),bM(o,h))));break;case 22:if(v=h.memoizedState!==null||qo,!v){c=c!==null&&c.memoizedState!==null||fi,w=qo;var T=fi;qo=v,(fi=c)&&!T?ql(o,h,(h.subtreeFlags&8772)!==0):Yl(o,h),qo=w,fi=T}break;case 30:break;default:Yl(o,h)}}function BS(o){var c=o.alternate;c!==null&&(o.alternate=null,BS(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&ct(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Wn=null,es=!1;function Ko(o,c,h){for(h=h.child;h!==null;)jS(o,c,h),h=h.sibling}function jS(o,c,h){if(ae&&typeof ae.onCommitFiberUnmount=="function")try{ae.onCommitFiberUnmount(te,h)}catch{}switch(h.tag){case 26:fi||Ja(h,c),Ko(o,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:fi||Ja(h,c);var v=Wn,w=es;ec(h.type)&&(Wn=h.stateNode,es=!1),Ko(o,c,h),qh(h.stateNode),Wn=v,es=w;break;case 5:fi||Ja(h,c);case 6:if(v=Wn,w=es,Wn=null,Ko(o,c,h),Wn=v,es=w,Wn!==null)if(es)try{(Wn.nodeType===9?Wn.body:Wn.nodeName==="HTML"?Wn.ownerDocument.body:Wn).removeChild(h.stateNode)}catch(T){jn(h,c,T)}else try{Wn.removeChild(h.stateNode)}catch(T){jn(h,c,T)}break;case 18:Wn!==null&&(es?(o=Wn,CT(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),ip(o)):CT(Wn,h.stateNode));break;case 4:v=Wn,w=es,Wn=h.stateNode.containerInfo,es=!0,Ko(o,c,h),Wn=v,es=w;break;case 0:case 11:case 14:case 15:fi||Xl(2,h,c),fi||Xl(4,h,c),Ko(o,c,h);break;case 1:fi||(Ja(h,c),v=h.stateNode,typeof v.componentWillUnmount=="function"&&LS(h,c,v)),Ko(o,c,h);break;case 21:Ko(o,c,h);break;case 22:fi=(v=fi)||h.memoizedState!==null,Ko(o,c,h),fi=v;break;default:Ko(o,c,h)}}function US(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{ip(o)}catch(h){jn(c,c.return,h)}}function q6(o){switch(o.tag){case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new FS),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new FS),c;default:throw Error(i(435,o.tag))}}function yy(o,c){var h=q6(o);c.forEach(function(v){var w=rM.bind(null,o,v);h.has(v)||(h.add(v),v.then(w,w))})}function ys(o,c){var h=c.deletions;if(h!==null)for(var v=0;v<h.length;v++){var w=h[v],T=o,H=c,Z=H;t:for(;Z!==null;){switch(Z.tag){case 27:if(ec(Z.type)){Wn=Z.stateNode,es=!1;break t}break;case 5:Wn=Z.stateNode,es=!1;break t;case 3:case 4:Wn=Z.stateNode.containerInfo,es=!0;break t}Z=Z.return}if(Wn===null)throw Error(i(160));jS(T,H,w),Wn=null,es=!1,T=w.alternate,T!==null&&(T.return=null),w.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)zS(c,o),c=c.sibling}var Sa=null;function zS(o,c){var h=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:ys(c,o),_s(o),v&4&&(Xl(3,o,o.return),jh(3,o),Xl(5,o,o.return));break;case 1:ys(c,o),_s(o),v&512&&(fi||h===null||Ja(h,h.return)),v&64&&qo&&(o=o.updateQueue,o!==null&&(v=o.callbacks,v!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?v:h.concat(v))));break;case 26:var w=Sa;if(ys(c,o),_s(o),v&512&&(fi||h===null||Ja(h,h.return)),v&4){var T=h!==null?h.memoizedState:null;if(v=o.memoizedState,h===null)if(v===null)if(o.stateNode===null){t:{v=o.type,h=o.memoizedProps,w=w.ownerDocument||w;e:switch(v){case"title":T=w.getElementsByTagName("title")[0],(!T||T[st]||T[vi]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=w.createElement(v),w.head.insertBefore(T,w.querySelector("head > title"))),Zi(T,v,h),T[vi]=o,Tt(T),v=T;break t;case"link":var H=MT("link","href",w).get(v+(h.href||""));if(H){for(var Z=0;Z<H.length;Z++)if(T=H[Z],T.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&T.getAttribute("rel")===(h.rel==null?null:h.rel)&&T.getAttribute("title")===(h.title==null?null:h.title)&&T.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){H.splice(Z,1);break e}}T=w.createElement(v),Zi(T,v,h),w.head.appendChild(T);break;case"meta":if(H=MT("meta","content",w).get(v+(h.content||""))){for(Z=0;Z<H.length;Z++)if(T=H[Z],T.getAttribute("content")===(h.content==null?null:""+h.content)&&T.getAttribute("name")===(h.name==null?null:h.name)&&T.getAttribute("property")===(h.property==null?null:h.property)&&T.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&T.getAttribute("charset")===(h.charSet==null?null:h.charSet)){H.splice(Z,1);break e}}T=w.createElement(v),Zi(T,v,h),w.head.appendChild(T);break;default:throw Error(i(468,v))}T[vi]=o,Tt(T),v=T}o.stateNode=v}else FT(w,o.type,o.stateNode);else o.stateNode=kT(w,v,o.memoizedProps);else T!==v?(T===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):T.count--,v===null?FT(w,o.type,o.stateNode):kT(w,v,o.memoizedProps)):v===null&&o.stateNode!==null&&my(o,o.memoizedProps,h.memoizedProps)}break;case 27:ys(c,o),_s(o),v&512&&(fi||h===null||Ja(h,h.return)),h!==null&&v&4&&my(o,o.memoizedProps,h.memoizedProps);break;case 5:if(ys(c,o),_s(o),v&512&&(fi||h===null||Ja(h,h.return)),o.flags&32){w=o.stateNode;try{ms(w,"")}catch(zt){jn(o,o.return,zt)}}v&4&&o.stateNode!=null&&(w=o.memoizedProps,my(o,w,h!==null?h.memoizedProps:w)),v&1024&&(xy=!0);break;case 6:if(ys(c,o),_s(o),v&4){if(o.stateNode===null)throw Error(i(162));v=o.memoizedProps,h=o.stateNode;try{h.nodeValue=v}catch(zt){jn(o,o.return,zt)}}break;case 3:if(xg=null,w=Sa,Sa=gg(c.containerInfo),ys(c,o),Sa=w,_s(o),v&4&&h!==null&&h.memoizedState.isDehydrated)try{ip(c.containerInfo)}catch(zt){jn(o,o.return,zt)}xy&&(xy=!1,HS(o));break;case 4:v=Sa,Sa=gg(o.stateNode.containerInfo),ys(c,o),_s(o),Sa=v;break;case 12:ys(c,o),_s(o);break;case 13:ys(c,o),_s(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Sy=J()),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,yy(o,v)));break;case 22:w=o.memoizedState!==null;var vt=h!==null&&h.memoizedState!==null,Pt=qo,Vt=fi;if(qo=Pt||w,fi=Vt||vt,ys(c,o),fi=Vt,qo=Pt,_s(o),v&8192)t:for(c=o.stateNode,c._visibility=w?c._visibility&-2:c._visibility|1,w&&(h===null||vt||qo||fi||Jc(o)),h=null,c=o;;){if(c.tag===5||c.tag===26){if(h===null){vt=h=c;try{if(T=vt.stateNode,w)H=T.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{Z=vt.stateNode;var Kt=vt.memoizedProps.style,Ut=Kt!=null&&Kt.hasOwnProperty("display")?Kt.display:null;Z.style.display=Ut==null||typeof Ut=="boolean"?"":(""+Ut).trim()}}catch(zt){jn(vt,vt.return,zt)}}}else if(c.tag===6){if(h===null){vt=c;try{vt.stateNode.nodeValue=w?"":vt.memoizedProps}catch(zt){jn(vt,vt.return,zt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break t;for(;c.sibling===null;){if(c.return===null||c.return===o)break t;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}v&4&&(v=o.updateQueue,v!==null&&(h=v.retryQueue,h!==null&&(v.retryQueue=null,yy(o,h))));break;case 19:ys(c,o),_s(o),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,yy(o,v)));break;case 30:break;case 21:break;default:ys(c,o),_s(o)}}function _s(o){var c=o.flags;if(c&2){try{for(var h,v=o.return;v!==null;){if(kS(v)){h=v;break}v=v.return}if(h==null)throw Error(i(160));switch(h.tag){case 27:var w=h.stateNode,T=gy(o);ig(o,T,w);break;case 5:var H=h.stateNode;h.flags&32&&(ms(H,""),h.flags&=-33);var Z=gy(o);ig(o,Z,H);break;case 3:case 4:var vt=h.stateNode.containerInfo,Pt=gy(o);vy(o,Pt,vt);break;default:throw Error(i(161))}}catch(Vt){jn(o,o.return,Vt)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function HS(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;HS(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function Yl(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)PS(o,c.alternate,c),c=c.sibling}function Jc(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:Xl(4,c,c.return),Jc(c);break;case 1:Ja(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&LS(c,c.return,h),Jc(c);break;case 27:qh(c.stateNode);case 26:case 5:Ja(c,c.return),Jc(c);break;case 22:c.memoizedState===null&&Jc(c);break;case 30:Jc(c);break;default:Jc(c)}o=o.sibling}}function ql(o,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var v=c.alternate,w=o,T=c,H=T.flags;switch(T.tag){case 0:case 11:case 15:ql(w,T,h),jh(4,T);break;case 1:if(ql(w,T,h),v=T,w=v.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(Pt){jn(v,v.return,Pt)}if(v=T,w=v.updateQueue,w!==null){var Z=v.stateNode;try{var vt=w.shared.hiddenCallbacks;if(vt!==null)for(w.shared.hiddenCallbacks=null,w=0;w<vt.length;w++)He(vt[w],Z)}catch(Pt){jn(v,v.return,Pt)}}h&&H&64&&NS(T),Uh(T,T.return);break;case 27:MS(T);case 26:case 5:ql(w,T,h),h&&v===null&&H&4&&IS(T),Uh(T,T.return);break;case 12:ql(w,T,h);break;case 13:ql(w,T,h),h&&H&4&&US(w,T);break;case 22:T.memoizedState===null&&ql(w,T,h),Uh(T,T.return);break;case 30:break;default:ql(w,T,h)}c=c.sibling}}function _y(o,c){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&$l(h))}function by(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&$l(o))}function to(o,c,h,v){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)$S(o,c,h,v),c=c.sibling}function $S(o,c,h,v){var w=c.flags;switch(c.tag){case 0:case 11:case 15:to(o,c,h,v),w&2048&&jh(9,c);break;case 1:to(o,c,h,v);break;case 3:to(o,c,h,v),w&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&$l(o)));break;case 12:if(w&2048){to(o,c,h,v),o=c.stateNode;try{var T=c.memoizedProps,H=T.id,Z=T.onPostCommit;typeof Z=="function"&&Z(H,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(vt){jn(c,c.return,vt)}}else to(o,c,h,v);break;case 13:to(o,c,h,v);break;case 23:break;case 22:T=c.stateNode,H=c.alternate,c.memoizedState!==null?T._visibility&2?to(o,c,h,v):zh(o,c):T._visibility&2?to(o,c,h,v):(T._visibility|=2,wf(o,c,h,v,(c.subtreeFlags&10256)!==0)),w&2048&&_y(H,c);break;case 24:to(o,c,h,v),w&2048&&by(c.alternate,c);break;default:to(o,c,h,v)}}function wf(o,c,h,v,w){for(w=w&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var T=o,H=c,Z=h,vt=v,Pt=H.flags;switch(H.tag){case 0:case 11:case 15:wf(T,H,Z,vt,w),jh(8,H);break;case 23:break;case 22:var Vt=H.stateNode;H.memoizedState!==null?Vt._visibility&2?wf(T,H,Z,vt,w):zh(T,H):(Vt._visibility|=2,wf(T,H,Z,vt,w)),w&&Pt&2048&&_y(H.alternate,H);break;case 24:wf(T,H,Z,vt,w),w&&Pt&2048&&by(H.alternate,H);break;default:wf(T,H,Z,vt,w)}c=c.sibling}}function zh(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=o,v=c,w=v.flags;switch(v.tag){case 22:zh(h,v),w&2048&&_y(v.alternate,v);break;case 24:zh(h,v),w&2048&&by(v.alternate,v);break;default:zh(h,v)}c=c.sibling}}var Hh=8192;function Ef(o){if(o.subtreeFlags&Hh)for(o=o.child;o!==null;)GS(o),o=o.sibling}function GS(o){switch(o.tag){case 26:Ef(o),o.flags&Hh&&o.memoizedState!==null&&kM(Sa,o.memoizedState,o.memoizedProps);break;case 5:Ef(o);break;case 3:case 4:var c=Sa;Sa=gg(o.stateNode.containerInfo),Ef(o),Sa=c;break;case 22:o.memoizedState===null&&(c=o.alternate,c!==null&&c.memoizedState!==null?(c=Hh,Hh=16777216,Ef(o),Hh=c):Ef(o));break;default:Ef(o)}}function VS(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function $h(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var v=c[h];ji=v,XS(v,o)}VS(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)WS(o),o=o.sibling}function WS(o){switch(o.tag){case 0:case 11:case 15:$h(o),o.flags&2048&&Xl(9,o,o.return);break;case 3:$h(o);break;case 12:$h(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,rg(o)):$h(o);break;default:$h(o)}}function rg(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var v=c[h];ji=v,XS(v,o)}VS(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:Xl(8,c,c.return),rg(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,rg(c));break;default:rg(c)}o=o.sibling}}function XS(o,c){for(;ji!==null;){var h=ji;switch(h.tag){case 0:case 11:case 15:Xl(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var v=h.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:$l(h.memoizedState.cache)}if(v=h.child,v!==null)v.return=h,ji=v;else t:for(h=o;ji!==null;){v=ji;var w=v.sibling,T=v.return;if(BS(v),v===h){ji=null;break t}if(w!==null){w.return=T,ji=w;break t}ji=T}}}var K6={getCacheForType:function(o){var c=Ri(si),h=c.data.get(o);return h===void 0&&(h=o(),c.data.set(o,h)),h}},Z6=typeof WeakMap=="function"?WeakMap:Map,Sn=0,Hn=null,tn=null,cn=0,Tn=0,bs=null,Kl=!1,Af=!1,wy=!1,Zo=0,ai=0,Zl=0,tu=0,Ey=0,Ks=0,Sf=0,Gh=null,ns=null,Ay=!1,Sy=0,sg=1/0,ag=null,Ql=null,Ki=0,Jl=null,Tf=null,Cf=0,Ty=0,Cy=null,YS=null,Vh=0,Dy=null;function ws(){if((Sn&2)!==0&&cn!==0)return cn&-cn;if(K.T!==null){var o=Zr;return o!==0?o:My()}return qu()}function qS(){Ks===0&&(Ks=(cn&536870912)===0||pn?pa():536870912);var o=qs.current;return o!==null&&(o.flags|=32),Ks}function Es(o,c,h){(o===Hn&&(Tn===2||Tn===9)||o.cancelPendingCommit!==null)&&(Df(o,0),tc(o,cn,Ks,!1)),Pi(o,h),((Sn&2)===0||o!==Hn)&&(o===Hn&&((Sn&2)===0&&(tu|=h),ai===4&&tc(o,cn,Ks,!1)),eo(o))}function KS(o,c,h){if((Sn&6)!==0)throw Error(i(327));var v=!h&&(c&124)===0&&(c&o.expiredLanes)===0||Oi(o,c),w=v?tM(o,c):Ny(o,c,!0),T=v;do{if(w===0){Af&&!v&&tc(o,c,0,!1);break}else{if(h=o.current.alternate,T&&!Q6(h)){w=Ny(o,c,!1),T=!1;continue}if(w===2){if(T=c,o.errorRecoveryDisabledLanes&T)var H=0;else H=o.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){c=H;t:{var Z=o;w=Gh;var vt=Z.current.memoizedState.isDehydrated;if(vt&&(Df(Z,H).flags|=256),H=Ny(Z,H,!1),H!==2){if(wy&&!vt){Z.errorRecoveryDisabledLanes|=T,tu|=T,w=4;break t}T=ns,ns=w,T!==null&&(ns===null?ns=T:ns.push.apply(ns,T))}w=H}if(T=!1,w!==2)continue}}if(w===1){Df(o,0),tc(o,c,0,!0);break}t:{switch(v=o,T=w,T){case 0:case 1:throw Error(i(345));case 4:if((c&4194048)!==c)break;case 6:tc(v,c,Ks,!Kl);break t;case 2:ns=null;break;case 3:case 5:break;default:throw Error(i(329))}if((c&62914560)===c&&(w=Sy+300-J(),10<w)){if(tc(v,c,Ks,!Kl),On(v,0,!0)!==0)break t;v.timeoutHandle=ST(ZS.bind(null,v,h,ns,ag,Ay,c,Ks,tu,Sf,Kl,T,2,-0,0),w);break t}ZS(v,h,ns,ag,Ay,c,Ks,tu,Sf,Kl,T,0,-0,0)}}break}while(!0);eo(o)}function ZS(o,c,h,v,w,T,H,Z,vt,Pt,Vt,Kt,Ut,zt){if(o.timeoutHandle=-1,Kt=c.subtreeFlags,(Kt&8192||(Kt&16785408)===16785408)&&(Qh={stylesheets:null,count:0,unsuspend:IM},GS(c),Kt=MM(),Kt!==null)){o.cancelPendingCommit=Kt(rT.bind(null,o,c,T,h,v,w,H,Z,vt,Vt,1,Ut,zt)),tc(o,T,H,!Pt);return}rT(o,c,T,h,v,w,H,Z,vt)}function Q6(o){for(var c=o;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var v=0;v<h.length;v++){var w=h[v],T=w.getSnapshot;w=w.value;try{if(!cr(T(),w))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function tc(o,c,h,v){c&=~Ey,c&=~tu,o.suspendedLanes|=c,o.pingedLanes&=~c,v&&(o.warmLanes|=c),v=o.expirationTimes;for(var w=c;0<w;){var T=31-Me(w),H=1<<T;v[T]=-1,w&=~H}h!==0&&Rc(o,h,c)}function og(){return(Sn&6)===0?(Wh(0),!1):!0}function Oy(){if(tn!==null){if(Tn===0)var o=tn.return;else o=tn,Ea=jo=null,Ys(o),_f=null,Fh=0,o=tn;for(;o!==null;)RS(o.alternate,o),o=o.return;tn=null}}function Df(o,c){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,gM(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),Oy(),Hn=o,tn=h=ya(o.current,null),cn=c,Tn=0,bs=null,Kl=!1,Af=Oi(o,c),wy=!1,Sf=Ks=Ey=tu=Zl=ai=0,ns=Gh=null,Ay=!1,(c&8)!==0&&(c|=c&32);var v=o.entangledLanes;if(v!==0)for(o=o.entanglements,v&=c;0<v;){var w=31-Me(v),T=1<<w;c|=o[w],v&=~T}return Zo=c,of(),h}function QS(o,c){de=null,K.H=Ym,c===Gl||c===Go?(c=F(),Tn=3):c===Kc?(c=F(),Tn=4):Tn=c===gS?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,bs=c,tn===null&&(ai=1,Jm(o,Rr(c,o.current)))}function JS(){var o=K.H;return K.H=Ym,o===null?Ym:o}function tT(){var o=K.A;return K.A=K6,o}function Ry(){ai=4,Kl||(cn&4194048)!==cn&&qs.current!==null||(Af=!0),(Zl&134217727)===0&&(tu&134217727)===0||Hn===null||tc(Hn,cn,Ks,!1)}function Ny(o,c,h){var v=Sn;Sn|=2;var w=JS(),T=tT();(Hn!==o||cn!==c)&&(ag=null,Df(o,c)),c=!1;var H=ai;t:do try{if(Tn!==0&&tn!==null){var Z=tn,vt=bs;switch(Tn){case 8:Oy(),H=6;break t;case 3:case 2:case 9:case 6:qs.current===null&&(c=!0);var Pt=Tn;if(Tn=0,bs=null,Of(o,Z,vt,Pt),h&&Af){H=0;break t}break;default:Pt=Tn,Tn=0,bs=null,Of(o,Z,vt,Pt)}}J6(),H=ai;break}catch(Vt){QS(o,Vt)}while(!0);return c&&o.shellSuspendCounter++,Ea=jo=null,Sn=v,K.H=w,K.A=T,tn===null&&(Hn=null,cn=0,of()),H}function J6(){for(;tn!==null;)eT(tn)}function tM(o,c){var h=Sn;Sn|=2;var v=JS(),w=tT();Hn!==o||cn!==c?(ag=null,sg=J()+500,Df(o,c)):Af=Oi(o,c);t:do try{if(Tn!==0&&tn!==null){c=tn;var T=bs;e:switch(Tn){case 1:Tn=0,bs=null,Of(o,c,T,1);break;case 2:case 9:if(Um(T)){Tn=0,bs=null,nT(c);break}c=function(){Tn!==2&&Tn!==9||Hn!==o||(Tn=7),eo(o)},T.then(c,c);break t;case 3:Tn=7;break t;case 4:Tn=5;break t;case 7:Um(T)?(Tn=0,bs=null,nT(c)):(Tn=0,bs=null,Of(o,c,T,7));break;case 5:var H=null;switch(tn.tag){case 26:H=tn.memoizedState;case 5:case 27:var Z=tn;if(!H||PT(H)){Tn=0,bs=null;var vt=Z.sibling;if(vt!==null)tn=vt;else{var Pt=Z.return;Pt!==null?(tn=Pt,lg(Pt)):tn=null}break e}}Tn=0,bs=null,Of(o,c,T,5);break;case 6:Tn=0,bs=null,Of(o,c,T,6);break;case 8:Oy(),ai=6;break t;default:throw Error(i(462))}}eM();break}catch(Vt){QS(o,Vt)}while(!0);return Ea=jo=null,K.H=v,K.A=w,Sn=h,tn!==null?0:(Hn=null,cn=0,of(),ai)}function eM(){for(;tn!==null&&!mt();)eT(tn)}function eT(o){var c=DS(o.alternate,o,Zo);o.memoizedProps=o.pendingProps,c===null?lg(o):tn=c}function nT(o){var c=o,h=c.alternate;switch(c.tag){case 15:case 0:c=wS(h,c,c.pendingProps,c.type,void 0,cn);break;case 11:c=wS(h,c,c.pendingProps,c.type.render,c.ref,cn);break;case 5:Ys(c);default:RS(h,c),c=tn=Im(c,Zo),c=DS(h,c,Zo)}o.memoizedProps=o.pendingProps,c===null?lg(o):tn=c}function Of(o,c,h,v){Ea=jo=null,Ys(c),_f=null,Fh=0;var w=c.return;try{if(G6(o,w,c,h,cn)){ai=1,Jm(o,Rr(h,o.current)),tn=null;return}}catch(T){if(w!==null)throw tn=w,T;ai=1,Jm(o,Rr(h,o.current)),tn=null;return}c.flags&32768?(pn||v===1?o=!0:Af||(cn&536870912)!==0?o=!1:(Kl=o=!0,(v===2||v===9||v===3||v===6)&&(v=qs.current,v!==null&&v.tag===13&&(v.flags|=16384))),iT(c,o)):lg(c)}function lg(o){var c=o;do{if((c.flags&32768)!==0){iT(c,Kl);return}o=c.return;var h=W6(c.alternate,c,Zo);if(h!==null){tn=h;return}if(c=c.sibling,c!==null){tn=c;return}tn=c=o}while(c!==null);ai===0&&(ai=5)}function iT(o,c){do{var h=X6(o.alternate,o);if(h!==null){h.flags&=32767,tn=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(o=o.sibling,o!==null)){tn=o;return}tn=o=h}while(o!==null);ai=6,tn=null}function rT(o,c,h,v,w,T,H,Z,vt){o.cancelPendingCommit=null;do cg();while(Ki!==0);if((Sn&6)!==0)throw Error(i(327));if(c!==null){if(c===o.current)throw Error(i(177));if(T=c.lanes|c.childLanes,T|=lh,Wr(o,h,T,H,Z,vt),o===Hn&&(tn=Hn=null,cn=0),Tf=c,Jl=o,Cf=h,Ty=T,Cy=w,YS=v,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,sM(Ht,function(){return cT(),null})):(o.callbackNode=null,o.callbackPriority=0),v=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||v){v=K.T,K.T=null,w=q.p,q.p=2,H=Sn,Sn|=4;try{Y6(o,c,h)}finally{Sn=H,q.p=w,K.T=v}}Ki=1,sT(),aT(),oT()}}function sT(){if(Ki===1){Ki=0;var o=Jl,c=Tf,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=K.T,K.T=null;var v=q.p;q.p=2;var w=Sn;Sn|=4;try{zS(c,o);var T=$y,H=eh(o.containerInfo),Z=T.focusedElem,vt=T.selectionRange;if(H!==Z&&Z&&Z.ownerDocument&&Cm(Z.ownerDocument.documentElement,Z)){if(vt!==null&&af(Z)){var Pt=vt.start,Vt=vt.end;if(Vt===void 0&&(Vt=Pt),"selectionStart"in Z)Z.selectionStart=Pt,Z.selectionEnd=Math.min(Vt,Z.value.length);else{var Kt=Z.ownerDocument||document,Ut=Kt&&Kt.defaultView||window;if(Ut.getSelection){var zt=Ut.getSelection(),Ue=Z.textContent.length,Le=Math.min(vt.start,Ue),Ln=vt.end===void 0?Le:Math.min(vt.end,Ue);!zt.extend&&Le>Ln&&(H=Ln,Ln=Le,Le=H);var Nt=Tm(Z,Le),wt=Tm(Z,Ln);if(Nt&&wt&&(zt.rangeCount!==1||zt.anchorNode!==Nt.node||zt.anchorOffset!==Nt.offset||zt.focusNode!==wt.node||zt.focusOffset!==wt.offset)){var Mt=Kt.createRange();Mt.setStart(Nt.node,Nt.offset),zt.removeAllRanges(),Le>Ln?(zt.addRange(Mt),zt.extend(wt.node,wt.offset)):(Mt.setEnd(wt.node,wt.offset),zt.addRange(Mt))}}}}for(Kt=[],zt=Z;zt=zt.parentNode;)zt.nodeType===1&&Kt.push({element:zt,left:zt.scrollLeft,top:zt.scrollTop});for(typeof Z.focus=="function"&&Z.focus(),Z=0;Z<Kt.length;Z++){var Yt=Kt[Z];Yt.element.scrollLeft=Yt.left,Yt.element.scrollTop=Yt.top}}bg=!!Hy,$y=Hy=null}finally{Sn=w,q.p=v,K.T=h}}o.current=c,Ki=2}}function aT(){if(Ki===2){Ki=0;var o=Jl,c=Tf,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=K.T,K.T=null;var v=q.p;q.p=2;var w=Sn;Sn|=4;try{PS(o,c.alternate,c)}finally{Sn=w,q.p=v,K.T=h}}Ki=3}}function oT(){if(Ki===4||Ki===3){Ki=0,ut();var o=Jl,c=Tf,h=Cf,v=YS;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Ki=5:(Ki=0,Tf=Jl=null,lT(o,o.pendingLanes));var w=o.pendingLanes;if(w===0&&(Ql=null),Lc(h),c=c.stateNode,ae&&typeof ae.onCommitFiberRoot=="function")try{ae.onCommitFiberRoot(te,c,void 0,(c.current.flags&128)===128)}catch{}if(v!==null){c=K.T,w=q.p,q.p=2,K.T=null;try{for(var T=o.onRecoverableError,H=0;H<v.length;H++){var Z=v[H];T(Z.value,{componentStack:Z.stack})}}finally{K.T=c,q.p=w}}(Cf&3)!==0&&cg(),eo(o),w=o.pendingLanes,(h&4194090)!==0&&(w&42)!==0?o===Dy?Vh++:(Vh=0,Dy=o):Vh=0,Wh(0)}}function lT(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,$l(c)))}function cg(o){return sT(),aT(),oT(),cT()}function cT(){if(Ki!==5)return!1;var o=Jl,c=Ty;Ty=0;var h=Lc(Cf),v=K.T,w=q.p;try{q.p=32>h?32:h,K.T=null,h=Cy,Cy=null;var T=Jl,H=Cf;if(Ki=0,Tf=Jl=null,Cf=0,(Sn&6)!==0)throw Error(i(331));var Z=Sn;if(Sn|=4,WS(T.current),$S(T,T.current,H,h),Sn=Z,Wh(0,!1),ae&&typeof ae.onPostCommitFiberRoot=="function")try{ae.onPostCommitFiberRoot(te,T)}catch{}return!0}finally{q.p=w,K.T=v,lT(o,c)}}function uT(o,c,h){c=Rr(h,c),c=ay(o.stateNode,c,2),o=re(o,c,2),o!==null&&(Pi(o,2),eo(o))}function jn(o,c,h){if(o.tag===3)uT(o,o,h);else for(;c!==null;){if(c.tag===3){uT(c,o,h);break}else if(c.tag===1){var v=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Ql===null||!Ql.has(v))){o=Rr(h,o),h=pS(2),v=re(c,h,2),v!==null&&(mS(h,v,c,o),Pi(v,2),eo(v));break}}c=c.return}}function Ly(o,c,h){var v=o.pingCache;if(v===null){v=o.pingCache=new Z6;var w=new Set;v.set(c,w)}else w=v.get(c),w===void 0&&(w=new Set,v.set(c,w));w.has(h)||(wy=!0,w.add(h),o=nM.bind(null,o,c,h),c.then(o,o))}function nM(o,c,h){var v=o.pingCache;v!==null&&v.delete(c),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,Hn===o&&(cn&h)===h&&(ai===4||ai===3&&(cn&62914560)===cn&&300>J()-Sy?(Sn&2)===0&&Df(o,0):Ey|=h,Sf===cn&&(Sf=0)),eo(o)}function fT(o,c){c===0&&(c=wo()),o=ur(o,c),o!==null&&(Pi(o,c),eo(o))}function iM(o){var c=o.memoizedState,h=0;c!==null&&(h=c.retryLane),fT(o,h)}function rM(o,c){var h=0;switch(o.tag){case 13:var v=o.stateNode,w=o.memoizedState;w!==null&&(h=w.retryLane);break;case 19:v=o.stateNode;break;case 22:v=o.stateNode._retryCache;break;default:throw Error(i(314))}v!==null&&v.delete(c),fT(o,h)}function sM(o,c){return St(o,c)}var ug=null,Rf=null,Iy=!1,fg=!1,ky=!1,eu=0;function eo(o){o!==Rf&&o.next===null&&(Rf===null?ug=Rf=o:Rf=Rf.next=o),fg=!0,Iy||(Iy=!0,oM())}function Wh(o,c){if(!ky&&fg){ky=!0;do for(var h=!1,v=ug;v!==null;){if(o!==0){var w=v.pendingLanes;if(w===0)var T=0;else{var H=v.suspendedLanes,Z=v.pingedLanes;T=(1<<31-Me(42|o)+1)-1,T&=w&~(H&~Z),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(h=!0,mT(v,T))}else T=cn,T=On(v,v===Hn?T:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(T&3)===0||Oi(v,T)||(h=!0,mT(v,T));v=v.next}while(h);ky=!1}}function aM(){dT()}function dT(){fg=Iy=!1;var o=0;eu!==0&&(mM()&&(o=eu),eu=0);for(var c=J(),h=null,v=ug;v!==null;){var w=v.next,T=hT(v,c);T===0?(v.next=null,h===null?ug=w:h.next=w,w===null&&(Rf=h)):(h=v,(o!==0||(T&3)!==0)&&(fg=!0)),v=w}Wh(o)}function hT(o,c){for(var h=o.suspendedLanes,v=o.pingedLanes,w=o.expirationTimes,T=o.pendingLanes&-62914561;0<T;){var H=31-Me(T),Z=1<<H,vt=w[H];vt===-1?((Z&h)===0||(Z&v)!==0)&&(w[H]=Us(Z,c)):vt<=c&&(o.expiredLanes|=Z),T&=~Z}if(c=Hn,h=cn,h=On(o,o===c?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),v=o.callbackNode,h===0||o===c&&(Tn===2||Tn===9)||o.cancelPendingCommit!==null)return v!==null&&v!==null&&R(v),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||Oi(o,h)){if(c=h&-h,c===o.callbackPriority)return c;switch(v!==null&&R(v),Lc(h)){case 2:case 8:h=Bt;break;case 32:h=Ht;break;case 268435456:h=kt;break;default:h=Ht}return v=pT.bind(null,o),h=St(h,v),o.callbackPriority=c,o.callbackNode=h,c}return v!==null&&v!==null&&R(v),o.callbackPriority=2,o.callbackNode=null,2}function pT(o,c){if(Ki!==0&&Ki!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(cg()&&o.callbackNode!==h)return null;var v=cn;return v=On(o,o===Hn?v:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),v===0?null:(KS(o,v,c),hT(o,J()),o.callbackNode!=null&&o.callbackNode===h?pT.bind(null,o):null)}function mT(o,c){if(cg())return null;KS(o,c,!0)}function oM(){vM(function(){(Sn&6)!==0?St(gt,aM):dT()})}function My(){return eu===0&&(eu=pa()),eu}function gT(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Zu(""+o)}function vT(o,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,o.id&&h.setAttribute("form",o.id),c.parentNode.insertBefore(h,c),o=new FormData(o),h.parentNode.removeChild(h),o}function lM(o,c,h,v,w){if(c==="submit"&&h&&h.stateNode===w){var T=gT((w[xi]||null).action),H=v.submitter;H&&(c=(c=H[xi]||null)?gT(c.formAction):H.getAttribute("formAction"),c!==null&&(T=c,H=null));var Z=new Rl("action","action",null,v,w);o.push({event:Z,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(eu!==0){var vt=H?vT(w,H):new FormData(w);ey(h,{pending:!0,data:vt,method:w.method,action:T},null,vt)}}else typeof T=="function"&&(Z.preventDefault(),vt=H?vT(w,H):new FormData(w),ey(h,{pending:!0,data:vt,method:w.method,action:T},T,vt))},currentTarget:w}]})}}for(var Fy=0;Fy<oh.length;Fy++){var Py=oh[Fy],cM=Py.toLowerCase(),uM=Py[0].toUpperCase()+Py.slice(1);gs(cM,"on"+uM)}gs(Ga,"onAnimationEnd"),gs(Ws,"onAnimationIteration"),gs(rh,"onAnimationStart"),gs("dblclick","onDoubleClick"),gs("focusin","onFocus"),gs("focusout","onBlur"),gs(qx,"onTransitionRun"),gs(Rm,"onTransitionStart"),gs(Nm,"onTransitionCancel"),gs(sh,"onTransitionEnd"),ee("onMouseEnter",["mouseout","mouseover"]),ee("onMouseLeave",["mouseout","mouseover"]),ee("onPointerEnter",["pointerout","pointerover"]),ee("onPointerLeave",["pointerout","pointerover"]),Wt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fM=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xh));function xT(o,c){c=(c&4)!==0;for(var h=0;h<o.length;h++){var v=o[h],w=v.event;v=v.listeners;t:{var T=void 0;if(c)for(var H=v.length-1;0<=H;H--){var Z=v[H],vt=Z.instance,Pt=Z.currentTarget;if(Z=Z.listener,vt!==T&&w.isPropagationStopped())break t;T=Z,w.currentTarget=Pt;try{T(w)}catch(Vt){Qm(Vt)}w.currentTarget=null,T=vt}else for(H=0;H<v.length;H++){if(Z=v[H],vt=Z.instance,Pt=Z.currentTarget,Z=Z.listener,vt!==T&&w.isPropagationStopped())break t;T=Z,w.currentTarget=Pt;try{T(w)}catch(Vt){Qm(Vt)}w.currentTarget=null,T=vt}}}}function en(o,c){var h=c[Ic];h===void 0&&(h=c[Ic]=new Set);var v=o+"__bubble";h.has(v)||(yT(c,o,2,!1),h.add(v))}function By(o,c,h){var v=0;c&&(v|=4),yT(h,o,v,c)}var dg="_reactListening"+Math.random().toString(36).slice(2);function jy(o){if(!o[dg]){o[dg]=!0,Lt.forEach(function(h){h!=="selectionchange"&&(fM.has(h)||By(h,!1,o),By(h,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[dg]||(c[dg]=!0,By("selectionchange",!1,c))}}function yT(o,c,h,v){switch($T(c)){case 2:var w=BM;break;case 8:w=jM;break;default:w=Jy}h=w.bind(null,c,h,o),w=void 0,!za||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(w=!0),v?w!==void 0?o.addEventListener(c,h,{capture:!0,passive:w}):o.addEventListener(c,h,!0):w!==void 0?o.addEventListener(c,h,{passive:w}):o.addEventListener(c,h,!1)}function Uy(o,c,h,v,w){var T=v;if((c&1)===0&&(c&2)===0&&v!==null)t:for(;;){if(v===null)return;var H=v.tag;if(H===3||H===4){var Z=v.stateNode.containerInfo;if(Z===w)break;if(H===4)for(H=v.return;H!==null;){var vt=H.tag;if((vt===3||vt===4)&&H.stateNode.containerInfo===w)return;H=H.return}for(;Z!==null;){if(H=ft(Z),H===null)return;if(vt=H.tag,vt===5||vt===6||vt===26||vt===27){v=T=H;continue t}Z=Z.parentNode}}v=v.return}Wd(function(){var Pt=T,Vt=Dl(h),Kt=[];t:{var Ut=ah.get(o);if(Ut!==void 0){var zt=Rl,Ue=o;switch(o){case"keypress":if(tf(h)===0)break t;case"keydown":case"keyup":zt=cm;break;case"focusin":Ue="focus",zt=ef;break;case"focusout":Ue="blur",zt=ef;break;case"beforeblur":case"afterblur":zt=ef;break;case"click":if(h.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":zt=Ro;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":zt=em;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":zt=jx;break;case Ga:case Ws:case rh:zt=rm;break;case sh:zt=Ux;break;case"scroll":case"scrollend":zt=tm;break;case"wheel":zt=Hx;break;case"copy":case"cut":case"paste":zt=sm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":zt=Ha;break;case"toggle":case"beforetoggle":zt=dm}var Le=(c&4)!==0,Ln=!Le&&(o==="scroll"||o==="scrollend"),Nt=Le?Ut!==null?Ut+"Capture":null:Ut;Le=[];for(var wt=Pt,Mt;wt!==null;){var Yt=wt;if(Mt=Yt.stateNode,Yt=Yt.tag,Yt!==5&&Yt!==26&&Yt!==27||Mt===null||Nt===null||(Yt=Ol(wt,Nt),Yt!=null&&Le.push(Yh(wt,Yt,Mt))),Ln)break;wt=wt.return}0<Le.length&&(Ut=new zt(Ut,Ue,null,h,Vt),Kt.push({event:Ut,listeners:Le}))}}if((c&7)===0){t:{if(Ut=o==="mouseover"||o==="pointerover",zt=o==="mouseout"||o==="pointerout",Ut&&h!==Hs&&(Ue=h.relatedTarget||h.fromElement)&&(ft(Ue)||Ue[Ba]))break t;if((zt||Ut)&&(Ut=Vt.window===Vt?Vt:(Ut=Vt.ownerDocument)?Ut.defaultView||Ut.parentWindow:window,zt?(Ue=h.relatedTarget||h.toElement,zt=Pt,Ue=Ue?ft(Ue):null,Ue!==null&&(Ln=s(Ue),Le=Ue.tag,Ue!==Ln||Le!==5&&Le!==27&&Le!==6)&&(Ue=null)):(zt=null,Ue=Pt),zt!==Ue)){if(Le=Ro,Yt="onMouseLeave",Nt="onMouseEnter",wt="mouse",(o==="pointerout"||o==="pointerover")&&(Le=Ha,Yt="onPointerLeave",Nt="onPointerEnter",wt="pointer"),Ln=zt==null?Ut:Ft(zt),Mt=Ue==null?Ut:Ft(Ue),Ut=new Le(Yt,wt+"leave",zt,h,Vt),Ut.target=Ln,Ut.relatedTarget=Mt,Yt=null,ft(Vt)===Pt&&(Le=new Le(Nt,wt+"enter",Ue,h,Vt),Le.target=Mt,Le.relatedTarget=Ln,Yt=Le),Ln=Yt,zt&&Ue)e:{for(Le=zt,Nt=Ue,wt=0,Mt=Le;Mt;Mt=Nf(Mt))wt++;for(Mt=0,Yt=Nt;Yt;Yt=Nf(Yt))Mt++;for(;0<wt-Mt;)Le=Nf(Le),wt--;for(;0<Mt-wt;)Nt=Nf(Nt),Mt--;for(;wt--;){if(Le===Nt||Nt!==null&&Le===Nt.alternate)break e;Le=Nf(Le),Nt=Nf(Nt)}Le=null}else Le=null;zt!==null&&_T(Kt,Ut,zt,Le,!1),Ue!==null&&Ln!==null&&_T(Kt,Ln,Ue,Le,!0)}}t:{if(Ut=Pt?Ft(Pt):window,zt=Ut.nodeName&&Ut.nodeName.toLowerCase(),zt==="select"||zt==="input"&&Ut.type==="file")var ge=_m;else if(xm(Ut))if(Qd)ge=Sm;else{ge=Em;var Qe=Xx}else zt=Ut.nodeName,!zt||zt.toLowerCase()!=="input"||Ut.type!=="checkbox"&&Ut.type!=="radio"?Pt&&Pc(Pt.elementType)&&(ge=_m):ge=Am;if(ge&&(ge=ge(o,Pt))){qr(Kt,ge,h,Vt);break t}Qe&&Qe(o,Ut,Pt),o==="focusout"&&Pt&&Ut.type==="number"&&Pt.memoizedProps.value!=null&&Mc(Ut,"number",Ut.value)}switch(Qe=Pt?Ft(Pt):window,o){case"focusin":(xm(Qe)||Qe.contentEditable==="true")&&(Fl=Qe,nh=Pt,$c=null);break;case"focusout":$c=nh=Fl=null;break;case"mousedown":ih=!0;break;case"contextmenu":case"mouseup":case"dragend":ih=!1,Dm(Kt,h,Vt);break;case"selectionchange":if(Yx)break;case"keydown":case"keyup":Dm(Kt,h,Vt)}var be;if(Zd)t:{switch(o){case"compositionstart":var Ie="onCompositionStart";break t;case"compositionend":Ie="onCompositionEnd";break t;case"compositionupdate":Ie="onCompositionUpdate";break t}Ie=void 0}else Ll?gm(o,h)&&(Ie="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Ie="onCompositionStart");Ie&&(pm&&h.locale!=="ko"&&(Ll||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&Ll&&(be=Ju()):(va=Vt,jc="value"in va?va.value:va.textContent,Ll=!0)),Qe=hg(Pt,Ie),0<Qe.length&&(Ie=new am(Ie,o,null,h,Vt),Kt.push({event:Ie,listeners:Qe}),be?Ie.data=be:(be=vm(h),be!==null&&(Ie.data=be)))),(be=No?Gx(o,h):Vx(o,h))&&(Ie=hg(Pt,"onBeforeInput"),0<Ie.length&&(Qe=new am("onBeforeInput","beforeinput",null,h,Vt),Kt.push({event:Qe,listeners:Ie}),Qe.data=be)),lM(Kt,o,Pt,h,Vt)}xT(Kt,c)})}function Yh(o,c,h){return{instance:o,listener:c,currentTarget:h}}function hg(o,c){for(var h=c+"Capture",v=[];o!==null;){var w=o,T=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||T===null||(w=Ol(o,h),w!=null&&v.unshift(Yh(o,w,T)),w=Ol(o,c),w!=null&&v.push(Yh(o,w,T))),o.tag===3)return v;o=o.return}return[]}function Nf(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function _T(o,c,h,v,w){for(var T=c._reactName,H=[];h!==null&&h!==v;){var Z=h,vt=Z.alternate,Pt=Z.stateNode;if(Z=Z.tag,vt!==null&&vt===v)break;Z!==5&&Z!==26&&Z!==27||Pt===null||(vt=Pt,w?(Pt=Ol(h,T),Pt!=null&&H.unshift(Yh(h,Pt,vt))):w||(Pt=Ol(h,T),Pt!=null&&H.push(Yh(h,Pt,vt)))),h=h.return}H.length!==0&&o.push({event:c,listeners:H})}var dM=/\r\n?/g,hM=/\u0000|\uFFFD/g;function bT(o){return(typeof o=="string"?o:""+o).replace(dM,`
`).replace(hM,"")}function wT(o,c){return c=bT(c),bT(o)===c}function pg(){}function Nn(o,c,h,v,w,T){switch(h){case"children":typeof v=="string"?c==="body"||c==="textarea"&&v===""||ms(o,v):(typeof v=="number"||typeof v=="bigint")&&c!=="body"&&ms(o,""+v);break;case"className":an(o,"class",v);break;case"tabIndex":an(o,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":an(o,h,v);break;case"style":Eo(o,v,T);break;case"data":if(c!=="object"){an(o,"data",v);break}case"src":case"href":if(v===""&&(c!=="a"||h!=="href")){o.removeAttribute(h);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){o.removeAttribute(h);break}v=Zu(""+v),o.setAttribute(h,v);break;case"action":case"formAction":if(typeof v=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(h==="formAction"?(c!=="input"&&Nn(o,c,"name",w.name,w,null),Nn(o,c,"formEncType",w.formEncType,w,null),Nn(o,c,"formMethod",w.formMethod,w,null),Nn(o,c,"formTarget",w.formTarget,w,null)):(Nn(o,c,"encType",w.encType,w,null),Nn(o,c,"method",w.method,w,null),Nn(o,c,"target",w.target,w,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){o.removeAttribute(h);break}v=Zu(""+v),o.setAttribute(h,v);break;case"onClick":v!=null&&(o.onclick=pg);break;case"onScroll":v!=null&&en("scroll",o);break;case"onScrollEnd":v!=null&&en("scrollend",o);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(i(61));if(h=v.__html,h!=null){if(w.children!=null)throw Error(i(60));o.innerHTML=h}}break;case"multiple":o.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":o.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){o.removeAttribute("xlink:href");break}h=Zu(""+v),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(h,""+v):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":v===!0?o.setAttribute(h,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(h,v):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?o.setAttribute(h,v):o.removeAttribute(h);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?o.removeAttribute(h):o.setAttribute(h,v);break;case"popover":en("beforetoggle",o),en("toggle",o),hn(o,"popover",v);break;case"xlinkActuate":wn(o,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":wn(o,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":wn(o,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":wn(o,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":wn(o,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":wn(o,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":wn(o,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":wn(o,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":wn(o,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":hn(o,"is",v);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Q0.get(h)||h,hn(o,h,v))}}function zy(o,c,h,v,w,T){switch(h){case"style":Eo(o,v,T);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(i(61));if(h=v.__html,h!=null){if(w.children!=null)throw Error(i(60));o.innerHTML=h}}break;case"children":typeof v=="string"?ms(o,v):(typeof v=="number"||typeof v=="bigint")&&ms(o,""+v);break;case"onScroll":v!=null&&en("scroll",o);break;case"onScrollEnd":v!=null&&en("scrollend",o);break;case"onClick":v!=null&&(o.onclick=pg);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!It.hasOwnProperty(h))t:{if(h[0]==="o"&&h[1]==="n"&&(w=h.endsWith("Capture"),c=h.slice(2,w?h.length-7:void 0),T=o[xi]||null,T=T!=null?T[h]:null,typeof T=="function"&&o.removeEventListener(c,T,w),typeof v=="function")){typeof T!="function"&&T!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(c,v,w);break t}h in o?o[h]=v:v===!0?o.setAttribute(h,""):hn(o,h,v)}}}function Zi(o,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":en("error",o),en("load",o);var v=!1,w=!1,T;for(T in h)if(h.hasOwnProperty(T)){var H=h[T];if(H!=null)switch(T){case"src":v=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:Nn(o,c,T,H,h,null)}}w&&Nn(o,c,"srcSet",h.srcSet,h,null),v&&Nn(o,c,"src",h.src,h,null);return;case"input":en("invalid",o);var Z=T=H=w=null,vt=null,Pt=null;for(v in h)if(h.hasOwnProperty(v)){var Vt=h[v];if(Vt!=null)switch(v){case"name":w=Vt;break;case"type":H=Vt;break;case"checked":vt=Vt;break;case"defaultChecked":Pt=Vt;break;case"value":T=Vt;break;case"defaultValue":Z=Vt;break;case"children":case"dangerouslySetInnerHTML":if(Vt!=null)throw Error(i(137,c));break;default:Nn(o,c,v,Vt,h,null)}}Ku(o,T,Z,vt,Pt,H,w,!1),kc(o);return;case"select":en("invalid",o),v=H=T=null;for(w in h)if(h.hasOwnProperty(w)&&(Z=h[w],Z!=null))switch(w){case"value":T=Z;break;case"defaultValue":H=Z;break;case"multiple":v=Z;default:Nn(o,c,w,Z,h,null)}c=T,h=H,o.multiple=!!v,c!=null?Wi(o,!!v,c,!1):h!=null&&Wi(o,!!v,h,!0);return;case"textarea":en("invalid",o),T=w=v=null;for(H in h)if(h.hasOwnProperty(H)&&(Z=h[H],Z!=null))switch(H){case"value":v=Z;break;case"defaultValue":w=Z;break;case"children":T=Z;break;case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(91));break;default:Nn(o,c,H,Z,h,null)}Fc(o,v,w,T),kc(o);return;case"option":for(vt in h)if(h.hasOwnProperty(vt)&&(v=h[vt],v!=null))switch(vt){case"selected":o.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:Nn(o,c,vt,v,h,null)}return;case"dialog":en("beforetoggle",o),en("toggle",o),en("cancel",o),en("close",o);break;case"iframe":case"object":en("load",o);break;case"video":case"audio":for(v=0;v<Xh.length;v++)en(Xh[v],o);break;case"image":en("error",o),en("load",o);break;case"details":en("toggle",o);break;case"embed":case"source":case"link":en("error",o),en("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Pt in h)if(h.hasOwnProperty(Pt)&&(v=h[Pt],v!=null))switch(Pt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:Nn(o,c,Pt,v,h,null)}return;default:if(Pc(c)){for(Vt in h)h.hasOwnProperty(Vt)&&(v=h[Vt],v!==void 0&&zy(o,c,Vt,v,h,void 0));return}}for(Z in h)h.hasOwnProperty(Z)&&(v=h[Z],v!=null&&Nn(o,c,Z,v,h,null))}function pM(o,c,h,v){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,T=null,H=null,Z=null,vt=null,Pt=null,Vt=null;for(zt in h){var Kt=h[zt];if(h.hasOwnProperty(zt)&&Kt!=null)switch(zt){case"checked":break;case"value":break;case"defaultValue":vt=Kt;default:v.hasOwnProperty(zt)||Nn(o,c,zt,null,v,Kt)}}for(var Ut in v){var zt=v[Ut];if(Kt=h[Ut],v.hasOwnProperty(Ut)&&(zt!=null||Kt!=null))switch(Ut){case"type":T=zt;break;case"name":w=zt;break;case"checked":Pt=zt;break;case"defaultChecked":Vt=zt;break;case"value":H=zt;break;case"defaultValue":Z=zt;break;case"children":case"dangerouslySetInnerHTML":if(zt!=null)throw Error(i(137,c));break;default:zt!==Kt&&Nn(o,c,Ut,zt,v,Kt)}}lr(o,H,Z,vt,Pt,Vt,T,w);return;case"select":zt=H=Z=Ut=null;for(T in h)if(vt=h[T],h.hasOwnProperty(T)&&vt!=null)switch(T){case"value":break;case"multiple":zt=vt;default:v.hasOwnProperty(T)||Nn(o,c,T,null,v,vt)}for(w in v)if(T=v[w],vt=h[w],v.hasOwnProperty(w)&&(T!=null||vt!=null))switch(w){case"value":Ut=T;break;case"defaultValue":Z=T;break;case"multiple":H=T;default:T!==vt&&Nn(o,c,w,T,v,vt)}c=Z,h=H,v=zt,Ut!=null?Wi(o,!!h,Ut,!1):!!v!=!!h&&(c!=null?Wi(o,!!h,c,!0):Wi(o,!!h,h?[]:"",!1));return;case"textarea":zt=Ut=null;for(Z in h)if(w=h[Z],h.hasOwnProperty(Z)&&w!=null&&!v.hasOwnProperty(Z))switch(Z){case"value":break;case"children":break;default:Nn(o,c,Z,null,v,w)}for(H in v)if(w=v[H],T=h[H],v.hasOwnProperty(H)&&(w!=null||T!=null))switch(H){case"value":Ut=w;break;case"defaultValue":zt=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:w!==T&&Nn(o,c,H,w,v,T)}Ua(o,Ut,zt);return;case"option":for(var Ue in h)if(Ut=h[Ue],h.hasOwnProperty(Ue)&&Ut!=null&&!v.hasOwnProperty(Ue))switch(Ue){case"selected":o.selected=!1;break;default:Nn(o,c,Ue,null,v,Ut)}for(vt in v)if(Ut=v[vt],zt=h[vt],v.hasOwnProperty(vt)&&Ut!==zt&&(Ut!=null||zt!=null))switch(vt){case"selected":o.selected=Ut&&typeof Ut!="function"&&typeof Ut!="symbol";break;default:Nn(o,c,vt,Ut,v,zt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Le in h)Ut=h[Le],h.hasOwnProperty(Le)&&Ut!=null&&!v.hasOwnProperty(Le)&&Nn(o,c,Le,null,v,Ut);for(Pt in v)if(Ut=v[Pt],zt=h[Pt],v.hasOwnProperty(Pt)&&Ut!==zt&&(Ut!=null||zt!=null))switch(Pt){case"children":case"dangerouslySetInnerHTML":if(Ut!=null)throw Error(i(137,c));break;default:Nn(o,c,Pt,Ut,v,zt)}return;default:if(Pc(c)){for(var Ln in h)Ut=h[Ln],h.hasOwnProperty(Ln)&&Ut!==void 0&&!v.hasOwnProperty(Ln)&&zy(o,c,Ln,void 0,v,Ut);for(Vt in v)Ut=v[Vt],zt=h[Vt],!v.hasOwnProperty(Vt)||Ut===zt||Ut===void 0&&zt===void 0||zy(o,c,Vt,Ut,v,zt);return}}for(var Nt in h)Ut=h[Nt],h.hasOwnProperty(Nt)&&Ut!=null&&!v.hasOwnProperty(Nt)&&Nn(o,c,Nt,null,v,Ut);for(Kt in v)Ut=v[Kt],zt=h[Kt],!v.hasOwnProperty(Kt)||Ut===zt||Ut==null&&zt==null||Nn(o,c,Kt,Ut,v,zt)}var Hy=null,$y=null;function mg(o){return o.nodeType===9?o:o.ownerDocument}function ET(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function AT(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function Gy(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Vy=null;function mM(){var o=window.event;return o&&o.type==="popstate"?o===Vy?!1:(Vy=o,!0):(Vy=null,!1)}var ST=typeof setTimeout=="function"?setTimeout:void 0,gM=typeof clearTimeout=="function"?clearTimeout:void 0,TT=typeof Promise=="function"?Promise:void 0,vM=typeof queueMicrotask=="function"?queueMicrotask:typeof TT<"u"?function(o){return TT.resolve(null).then(o).catch(xM)}:ST;function xM(o){setTimeout(function(){throw o})}function ec(o){return o==="head"}function CT(o,c){var h=c,v=0,w=0;do{var T=h.nextSibling;if(o.removeChild(h),T&&T.nodeType===8)if(h=T.data,h==="/$"){if(0<v&&8>v){h=v;var H=o.ownerDocument;if(h&1&&qh(H.documentElement),h&2&&qh(H.body),h&4)for(h=H.head,qh(h),H=h.firstChild;H;){var Z=H.nextSibling,vt=H.nodeName;H[st]||vt==="SCRIPT"||vt==="STYLE"||vt==="LINK"&&H.rel.toLowerCase()==="stylesheet"||h.removeChild(H),H=Z}}if(w===0){o.removeChild(T),ip(c);return}w--}else h==="$"||h==="$?"||h==="$!"?w++:v=h.charCodeAt(0)-48;else v=0;h=T}while(h);ip(c)}function Wy(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":Wy(h),ct(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function yM(o,c,h,v){for(;o.nodeType===1;){var w=h;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!v&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(v){if(!o[st])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(T=o.getAttribute("rel"),T==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(T!==w.rel||o.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||o.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||o.getAttribute("title")!==(w.title==null?null:w.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(T=o.getAttribute("src"),(T!==(w.src==null?null:w.src)||o.getAttribute("type")!==(w.type==null?null:w.type)||o.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&T&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var T=w.name==null?null:""+w.name;if(w.type==="hidden"&&o.getAttribute("name")===T)return o}else return o;if(o=Ta(o.nextSibling),o===null)break}return null}function _M(o,c,h){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=Ta(o.nextSibling),o===null))return null;return o}function Xy(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function bM(o,c){var h=o.ownerDocument;if(o.data!=="$?"||h.readyState==="complete")c();else{var v=function(){c(),h.removeEventListener("DOMContentLoaded",v)};h.addEventListener("DOMContentLoaded",v),o._reactRetry=v}}function Ta(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return o}var Yy=null;function DT(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return o;c--}else h==="/$"&&c++}o=o.previousSibling}return null}function OT(o,c,h){switch(c=mg(h),o){case"html":if(o=c.documentElement,!o)throw Error(i(452));return o;case"head":if(o=c.head,!o)throw Error(i(453));return o;case"body":if(o=c.body,!o)throw Error(i(454));return o;default:throw Error(i(451))}}function qh(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);ct(o)}var Zs=new Map,RT=new Set;function gg(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Qo=q.d;q.d={f:wM,r:EM,D:AM,C:SM,L:TM,m:CM,X:OM,S:DM,M:RM};function wM(){var o=Qo.f(),c=og();return o||c}function EM(o){var c=pt(o);c!==null&&c.tag===5&&c.type==="form"?KA(c):Qo.r(o)}var Lf=typeof document>"u"?null:document;function NT(o,c,h){var v=Lf;if(v&&typeof c=="string"&&c){var w=yi(c);w='link[rel="'+o+'"][href="'+w+'"]',typeof h=="string"&&(w+='[crossorigin="'+h+'"]'),RT.has(w)||(RT.add(w),o={rel:o,crossOrigin:h,href:c},v.querySelector(w)===null&&(c=v.createElement("link"),Zi(c,"link",o),Tt(c),v.head.appendChild(c)))}}function AM(o){Qo.D(o),NT("dns-prefetch",o,null)}function SM(o,c){Qo.C(o,c),NT("preconnect",o,c)}function TM(o,c,h){Qo.L(o,c,h);var v=Lf;if(v&&o&&c){var w='link[rel="preload"][as="'+yi(c)+'"]';c==="image"&&h&&h.imageSrcSet?(w+='[imagesrcset="'+yi(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(w+='[imagesizes="'+yi(h.imageSizes)+'"]')):w+='[href="'+yi(o)+'"]';var T=w;switch(c){case"style":T=If(o);break;case"script":T=kf(o)}Zs.has(T)||(o=d({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:o,as:c},h),Zs.set(T,o),v.querySelector(w)!==null||c==="style"&&v.querySelector(Kh(T))||c==="script"&&v.querySelector(Zh(T))||(c=v.createElement("link"),Zi(c,"link",o),Tt(c),v.head.appendChild(c)))}}function CM(o,c){Qo.m(o,c);var h=Lf;if(h&&o){var v=c&&typeof c.as=="string"?c.as:"script",w='link[rel="modulepreload"][as="'+yi(v)+'"][href="'+yi(o)+'"]',T=w;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=kf(o)}if(!Zs.has(T)&&(o=d({rel:"modulepreload",href:o},c),Zs.set(T,o),h.querySelector(w)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Zh(T)))return}v=h.createElement("link"),Zi(v,"link",o),Tt(v),h.head.appendChild(v)}}}function DM(o,c,h){Qo.S(o,c,h);var v=Lf;if(v&&o){var w=$t(v).hoistableStyles,T=If(o);c=c||"default";var H=w.get(T);if(!H){var Z={loading:0,preload:null};if(H=v.querySelector(Kh(T)))Z.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":c},h),(h=Zs.get(T))&&qy(o,h);var vt=H=v.createElement("link");Tt(vt),Zi(vt,"link",o),vt._p=new Promise(function(Pt,Vt){vt.onload=Pt,vt.onerror=Vt}),vt.addEventListener("load",function(){Z.loading|=1}),vt.addEventListener("error",function(){Z.loading|=2}),Z.loading|=4,vg(H,c,v)}H={type:"stylesheet",instance:H,count:1,state:Z},w.set(T,H)}}}function OM(o,c){Qo.X(o,c);var h=Lf;if(h&&o){var v=$t(h).hoistableScripts,w=kf(o),T=v.get(w);T||(T=h.querySelector(Zh(w)),T||(o=d({src:o,async:!0},c),(c=Zs.get(w))&&Ky(o,c),T=h.createElement("script"),Tt(T),Zi(T,"link",o),h.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},v.set(w,T))}}function RM(o,c){Qo.M(o,c);var h=Lf;if(h&&o){var v=$t(h).hoistableScripts,w=kf(o),T=v.get(w);T||(T=h.querySelector(Zh(w)),T||(o=d({src:o,async:!0,type:"module"},c),(c=Zs.get(w))&&Ky(o,c),T=h.createElement("script"),Tt(T),Zi(T,"link",o),h.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},v.set(w,T))}}function LT(o,c,h,v){var w=(w=Rt.current)?gg(w):null;if(!w)throw Error(i(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=If(h.href),h=$t(w).hoistableStyles,v=h.get(c),v||(v={type:"style",instance:null,count:0,state:null},h.set(c,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=If(h.href);var T=$t(w).hoistableStyles,H=T.get(o);if(H||(w=w.ownerDocument||w,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(o,H),(T=w.querySelector(Kh(o)))&&!T._p&&(H.instance=T,H.state.loading=5),Zs.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Zs.set(o,h),T||NM(w,o,h,H.state))),c&&v===null)throw Error(i(528,""));return H}if(c&&v!==null)throw Error(i(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=kf(h),h=$t(w).hoistableScripts,v=h.get(c),v||(v={type:"script",instance:null,count:0,state:null},h.set(c,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,o))}}function If(o){return'href="'+yi(o)+'"'}function Kh(o){return'link[rel="stylesheet"]['+o+"]"}function IT(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function NM(o,c,h,v){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?v.loading=1:(c=o.createElement("link"),v.preload=c,c.addEventListener("load",function(){return v.loading|=1}),c.addEventListener("error",function(){return v.loading|=2}),Zi(c,"link",h),Tt(c),o.head.appendChild(c))}function kf(o){return'[src="'+yi(o)+'"]'}function Zh(o){return"script[async]"+o}function kT(o,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var v=o.querySelector('style[data-href~="'+yi(h.href)+'"]');if(v)return c.instance=v,Tt(v),v;var w=d({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return v=(o.ownerDocument||o).createElement("style"),Tt(v),Zi(v,"style",w),vg(v,h.precedence,o),c.instance=v;case"stylesheet":w=If(h.href);var T=o.querySelector(Kh(w));if(T)return c.state.loading|=4,c.instance=T,Tt(T),T;v=IT(h),(w=Zs.get(w))&&qy(v,w),T=(o.ownerDocument||o).createElement("link"),Tt(T);var H=T;return H._p=new Promise(function(Z,vt){H.onload=Z,H.onerror=vt}),Zi(T,"link",v),c.state.loading|=4,vg(T,h.precedence,o),c.instance=T;case"script":return T=kf(h.src),(w=o.querySelector(Zh(T)))?(c.instance=w,Tt(w),w):(v=h,(w=Zs.get(T))&&(v=d({},h),Ky(v,w)),o=o.ownerDocument||o,w=o.createElement("script"),Tt(w),Zi(w,"link",v),o.head.appendChild(w),c.instance=w);case"void":return null;default:throw Error(i(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(v=c.instance,c.state.loading|=4,vg(v,h.precedence,o));return c.instance}function vg(o,c,h){for(var v=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=v.length?v[v.length-1]:null,T=w,H=0;H<v.length;H++){var Z=v[H];if(Z.dataset.precedence===c)T=Z;else if(T!==w)break}T?T.parentNode.insertBefore(o,T.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(o,c.firstChild))}function qy(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function Ky(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var xg=null;function MT(o,c,h){if(xg===null){var v=new Map,w=xg=new Map;w.set(h,v)}else w=xg,v=w.get(h),v||(v=new Map,w.set(h,v));if(v.has(o))return v;for(v.set(o,null),h=h.getElementsByTagName(o),w=0;w<h.length;w++){var T=h[w];if(!(T[st]||T[vi]||o==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var H=T.getAttribute(c)||"";H=o+H;var Z=v.get(H);Z?Z.push(T):v.set(H,[T])}}return v}function FT(o,c,h){o=o.ownerDocument||o,o.head.insertBefore(h,c==="title"?o.querySelector("head > title"):null)}function LM(o,c,h){if(h===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return o=c.disabled,typeof c.precedence=="string"&&o==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function PT(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Qh=null;function IM(){}function kM(o,c,h){if(Qh===null)throw Error(i(475));var v=Qh;if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var w=If(h.href),T=o.querySelector(Kh(w));if(T){o=T._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(v.count++,v=yg.bind(v),o.then(v,v)),c.state.loading|=4,c.instance=T,Tt(T);return}T=o.ownerDocument||o,h=IT(h),(w=Zs.get(w))&&qy(h,w),T=T.createElement("link"),Tt(T);var H=T;H._p=new Promise(function(Z,vt){H.onload=Z,H.onerror=vt}),Zi(T,"link",h),c.instance=T}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(v.count++,c=yg.bind(v),o.addEventListener("load",c),o.addEventListener("error",c))}}function MM(){if(Qh===null)throw Error(i(475));var o=Qh;return o.stylesheets&&o.count===0&&Zy(o,o.stylesheets),0<o.count?function(c){var h=setTimeout(function(){if(o.stylesheets&&Zy(o,o.stylesheets),o.unsuspend){var v=o.unsuspend;o.unsuspend=null,v()}},6e4);return o.unsuspend=c,function(){o.unsuspend=null,clearTimeout(h)}}:null}function yg(){if(this.count--,this.count===0){if(this.stylesheets)Zy(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var _g=null;function Zy(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,_g=new Map,c.forEach(FM,o),_g=null,yg.call(o))}function FM(o,c){if(!(c.state.loading&4)){var h=_g.get(o);if(h)var v=h.get(null);else{h=new Map,_g.set(o,h);for(var w=o.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<w.length;T++){var H=w[T];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(h.set(H.dataset.precedence,H),v=H)}v&&h.set(null,v)}w=c.instance,H=w.getAttribute("data-precedence"),T=h.get(H)||v,T===v&&h.set(null,w),h.set(H,w),this.count++,v=yg.bind(this),w.addEventListener("load",v),w.addEventListener("error",v),T?T.parentNode.insertBefore(w,T.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(w,o.firstChild)),c.state.loading|=4}}var Jh={$$typeof:A,Provider:null,Consumer:null,_currentValue:_t,_currentValue2:_t,_threadCount:0};function PM(o,c,h,v,w,T,H,Z){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ma(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ma(0),this.hiddenUpdates=ma(null),this.identifierPrefix=v,this.onUncaughtError=w,this.onCaughtError=T,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function BT(o,c,h,v,w,T,H,Z,vt,Pt,Vt,Kt){return o=new PM(o,c,h,H,Z,vt,Pt,Kt),c=1,T===!0&&(c|=24),T=Lr(3,null,null,c),o.current=T,T.stateNode=o,c=qc(),c.refCount++,o.pooledCache=c,c.refCount++,T.memoizedState={element:v,isDehydrated:h,cache:c},Ot(T),o}function jT(o){return o?(o=Bl,o):Bl}function UT(o,c,h,v,w,T){w=jT(w),v.context===null?v.context=w:v.pendingContext=w,v=Xt(c),v.payload={element:h},T=T===void 0?null:T,T!==null&&(v.callback=T),h=re(o,v,c),h!==null&&(Es(h,o,c),he(h,o,c))}function zT(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<c?h:c}}function Qy(o,c){zT(o,c),(o=o.alternate)&&zT(o,c)}function HT(o){if(o.tag===13){var c=ur(o,67108864);c!==null&&Es(c,o,67108864),Qy(o,67108864)}}var bg=!0;function BM(o,c,h,v){var w=K.T;K.T=null;var T=q.p;try{q.p=2,Jy(o,c,h,v)}finally{q.p=T,K.T=w}}function jM(o,c,h,v){var w=K.T;K.T=null;var T=q.p;try{q.p=8,Jy(o,c,h,v)}finally{q.p=T,K.T=w}}function Jy(o,c,h,v){if(bg){var w=t_(v);if(w===null)Uy(o,c,v,wg,h),GT(o,v);else if(zM(w,o,c,h,v))v.stopPropagation();else if(GT(o,v),c&4&&-1<UM.indexOf(o)){for(;w!==null;){var T=pt(w);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var H=Bn(T.pendingLanes);if(H!==0){var Z=T;for(Z.pendingLanes|=2,Z.entangledLanes|=2;H;){var vt=1<<31-Me(H);Z.entanglements[1]|=vt,H&=~vt}eo(T),(Sn&6)===0&&(sg=J()+500,Wh(0))}}break;case 13:Z=ur(T,2),Z!==null&&Es(Z,T,2),og(),Qy(T,2)}if(T=t_(v),T===null&&Uy(o,c,v,wg,h),T===w)break;w=T}w!==null&&v.stopPropagation()}else Uy(o,c,v,null,h)}}function t_(o){return o=Dl(o),e_(o)}var wg=null;function e_(o){if(wg=null,o=ft(o),o!==null){var c=s(o);if(c===null)o=null;else{var h=c.tag;if(h===13){if(o=a(c),o!==null)return o;o=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return wg=o,null}function $T(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Q()){case gt:return 2;case Bt:return 8;case Ht:case Ct:return 32;case kt:return 268435456;default:return 32}default:return 32}}var n_=!1,nc=null,ic=null,rc=null,tp=new Map,ep=new Map,sc=[],UM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function GT(o,c){switch(o){case"focusin":case"focusout":nc=null;break;case"dragenter":case"dragleave":ic=null;break;case"mouseover":case"mouseout":rc=null;break;case"pointerover":case"pointerout":tp.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ep.delete(c.pointerId)}}function np(o,c,h,v,w,T){return o===null||o.nativeEvent!==T?(o={blockedOn:c,domEventName:h,eventSystemFlags:v,nativeEvent:T,targetContainers:[w]},c!==null&&(c=pt(c),c!==null&&HT(c)),o):(o.eventSystemFlags|=v,c=o.targetContainers,w!==null&&c.indexOf(w)===-1&&c.push(w),o)}function zM(o,c,h,v,w){switch(c){case"focusin":return nc=np(nc,o,c,h,v,w),!0;case"dragenter":return ic=np(ic,o,c,h,v,w),!0;case"mouseover":return rc=np(rc,o,c,h,v,w),!0;case"pointerover":var T=w.pointerId;return tp.set(T,np(tp.get(T)||null,o,c,h,v,w)),!0;case"gotpointercapture":return T=w.pointerId,ep.set(T,np(ep.get(T)||null,o,c,h,v,w)),!0}return!1}function VT(o){var c=ft(o.target);if(c!==null){var h=s(c);if(h!==null){if(c=h.tag,c===13){if(c=a(h),c!==null){o.blockedOn=c,Pa(o.priority,function(){if(h.tag===13){var v=ws();v=Nc(v);var w=ur(h,v);w!==null&&Es(w,h,v),Qy(h,v)}});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Eg(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var h=t_(o.nativeEvent);if(h===null){h=o.nativeEvent;var v=new h.constructor(h.type,h);Hs=v,h.target.dispatchEvent(v),Hs=null}else return c=pt(h),c!==null&&HT(c),o.blockedOn=h,!1;c.shift()}return!0}function WT(o,c,h){Eg(o)&&h.delete(c)}function HM(){n_=!1,nc!==null&&Eg(nc)&&(nc=null),ic!==null&&Eg(ic)&&(ic=null),rc!==null&&Eg(rc)&&(rc=null),tp.forEach(WT),ep.forEach(WT)}function Ag(o,c){o.blockedOn===c&&(o.blockedOn=null,n_||(n_=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,HM)))}var Sg=null;function XT(o){Sg!==o&&(Sg=o,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Sg===o&&(Sg=null);for(var c=0;c<o.length;c+=3){var h=o[c],v=o[c+1],w=o[c+2];if(typeof v!="function"){if(e_(v||h)===null)continue;break}var T=pt(h);T!==null&&(o.splice(c,3),c-=3,ey(T,{pending:!0,data:w,method:h.method,action:v},v,w))}}))}function ip(o){function c(vt){return Ag(vt,o)}nc!==null&&Ag(nc,o),ic!==null&&Ag(ic,o),rc!==null&&Ag(rc,o),tp.forEach(c),ep.forEach(c);for(var h=0;h<sc.length;h++){var v=sc[h];v.blockedOn===o&&(v.blockedOn=null)}for(;0<sc.length&&(h=sc[0],h.blockedOn===null);)VT(h),h.blockedOn===null&&sc.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(v=0;v<h.length;v+=3){var w=h[v],T=h[v+1],H=w[xi]||null;if(typeof T=="function")H||XT(h);else if(H){var Z=null;if(T&&T.hasAttribute("formAction")){if(w=T,H=T[xi]||null)Z=H.formAction;else if(e_(w)!==null)continue}else Z=H.action;typeof Z=="function"?h[v+1]=Z:(h.splice(v,3),v-=3),XT(h)}}}function i_(o){this._internalRoot=o}Tg.prototype.render=i_.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(i(409));var h=c.current,v=ws();UT(h,v,o,c,null,null)},Tg.prototype.unmount=i_.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;UT(o.current,2,null,o,null,null),og(),c[Ba]=null}};function Tg(o){this._internalRoot=o}Tg.prototype.unstable_scheduleHydration=function(o){if(o){var c=qu();o={blockedOn:null,target:o,priority:c};for(var h=0;h<sc.length&&c!==0&&c<sc[h].priority;h++);sc.splice(h,0,o),h===0&&VT(o)}};var YT=t.version;if(YT!=="19.1.0")throw Error(i(527,YT,"19.1.0"));q.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(i(188)):(o=Object.keys(o).join(","),Error(i(268,o)));return o=u(c),o=o!==null?f(o):null,o=o===null?null:o.stateNode,o};var $M={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cg.isDisabled&&Cg.supportsFiber)try{te=Cg.inject($M),ae=Cg}catch{}}return sp.createRoot=function(o,c){if(!r(o))throw Error(i(299));var h=!1,v="",w=uS,T=fS,H=dS,Z=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(T=c.onCaughtError),c.onRecoverableError!==void 0&&(H=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Z=c.unstable_transitionCallbacks)),c=BT(o,1,!1,null,null,h,v,w,T,H,Z,null),o[Ba]=c.current,jy(o),new i_(c)},sp.hydrateRoot=function(o,c,h){if(!r(o))throw Error(i(299));var v=!1,w="",T=uS,H=fS,Z=dS,vt=null,Pt=null;return h!=null&&(h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onUncaughtError!==void 0&&(T=h.onUncaughtError),h.onCaughtError!==void 0&&(H=h.onCaughtError),h.onRecoverableError!==void 0&&(Z=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(vt=h.unstable_transitionCallbacks),h.formState!==void 0&&(Pt=h.formState)),c=BT(o,1,!0,c,h??null,v,w,T,H,Z,vt,Pt),c.context=jT(null),h=c.current,v=ws(),v=Nc(v),w=Xt(v),w.callback=null,re(h,w,v),h=v,c.current.lanes=h,Pi(c,h),eo(c),o[Ba]=c.current,jy(o),new Tg(c)},sp.version="19.1.0",sp}var aC;function JM(){if(aC)return o_.exports;aC=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),o_.exports=QM(),o_.exports}var t8=JM(),Sv={exports:{}},$r="top",Ps="bottom",Bs="right",Gr="left",z1="auto",Ad=[$r,Ps,Bs,Gr],bu="start",ld="end",KO="clippingParents",PE="viewport",zf="popper",ZO="reference",Tw=Ad.reduce(function(n,t){return n.concat([t+"-"+bu,t+"-"+ld])},[]),BE=[].concat(Ad,[z1]).reduce(function(n,t){return n.concat([t,t+"-"+bu,t+"-"+ld])},[]),QO="beforeRead",JO="read",tR="afterRead",eR="beforeMain",nR="main",iR="afterMain",rR="beforeWrite",sR="write",aR="afterWrite",oR=[QO,JO,tR,eR,nR,iR,rR,sR,aR];function yo(n){return n?(n.nodeName||"").toLowerCase():null}function js(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var t=n.ownerDocument;return t&&t.defaultView||window}return n}function wu(n){var t=js(n).Element;return n instanceof t||n instanceof Element}function oa(n){var t=js(n).HTMLElement;return n instanceof t||n instanceof HTMLElement}function jE(n){if(typeof ShadowRoot>"u")return!1;var t=js(n).ShadowRoot;return n instanceof t||n instanceof ShadowRoot}function e8(n){var t=n.state;Object.keys(t.elements).forEach(function(e){var i=t.styles[e]||{},r=t.attributes[e]||{},s=t.elements[e];!oa(s)||!yo(s)||(Object.assign(s.style,i),Object.keys(r).forEach(function(a){var l=r[a];l===!1?s.removeAttribute(a):s.setAttribute(a,l===!0?"":l)}))})}function n8(n){var t=n.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],s=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:e[i]),l=a.reduce(function(u,f){return u[f]="",u},{});!oa(r)||!yo(r)||(Object.assign(r.style,l),Object.keys(s).forEach(function(u){r.removeAttribute(u)}))})}}const UE={name:"applyStyles",enabled:!0,phase:"write",fn:e8,effect:n8,requires:["computeStyles"]};function xo(n){return n.split("-")[0]}var xu=Math.max,Wv=Math.min,cd=Math.round;function Cw(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function lR(){return!/^((?!chrome|android).)*safari/i.test(Cw())}function ud(n,t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var i=n.getBoundingClientRect(),r=1,s=1;t&&oa(n)&&(r=n.offsetWidth>0&&cd(i.width)/n.offsetWidth||1,s=n.offsetHeight>0&&cd(i.height)/n.offsetHeight||1);var a=wu(n)?js(n):window,l=a.visualViewport,u=!lR()&&e,f=(i.left+(u&&l?l.offsetLeft:0))/r,d=(i.top+(u&&l?l.offsetTop:0))/s,p=i.width/r,m=i.height/s;return{width:p,height:m,top:d,right:f+p,bottom:d+m,left:f,x:f,y:d}}function zE(n){var t=ud(n),e=n.offsetWidth,i=n.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:n.offsetLeft,y:n.offsetTop,width:e,height:i}}function cR(n,t){var e=t.getRootNode&&t.getRootNode();if(n.contains(t))return!0;if(e&&jE(e)){var i=t;do{if(i&&n.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function xl(n){return js(n).getComputedStyle(n)}function i8(n){return["table","td","th"].indexOf(yo(n))>=0}function Sc(n){return((wu(n)?n.ownerDocument:n.document)||window.document).documentElement}function H1(n){return yo(n)==="html"?n:n.assignedSlot||n.parentNode||(jE(n)?n.host:null)||Sc(n)}function oC(n){return!oa(n)||xl(n).position==="fixed"?null:n.offsetParent}function r8(n){var t=/firefox/i.test(Cw()),e=/Trident/i.test(Cw());if(e&&oa(n)){var i=xl(n);if(i.position==="fixed")return null}var r=H1(n);for(jE(r)&&(r=r.host);oa(r)&&["html","body"].indexOf(yo(r))<0;){var s=xl(r);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return r;r=r.parentNode}return null}function E0(n){for(var t=js(n),e=oC(n);e&&i8(e)&&xl(e).position==="static";)e=oC(e);return e&&(yo(e)==="html"||yo(e)==="body"&&xl(e).position==="static")?t:e||r8(n)||t}function HE(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Mp(n,t,e){return xu(n,Wv(t,e))}function s8(n,t,e){var i=Mp(n,t,e);return i>e?e:i}function uR(){return{top:0,right:0,bottom:0,left:0}}function fR(n){return Object.assign({},uR(),n)}function dR(n,t){return t.reduce(function(e,i){return e[i]=n,e},{})}var a8=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,fR(typeof t!="number"?t:dR(t,Ad))};function o8(n){var t,e=n.state,i=n.name,r=n.options,s=e.elements.arrow,a=e.modifiersData.popperOffsets,l=xo(e.placement),u=HE(l),f=[Gr,Bs].indexOf(l)>=0,d=f?"height":"width";if(!(!s||!a)){var p=a8(r.padding,e),m=zE(s),g=u==="y"?$r:Gr,y=u==="y"?Ps:Bs,x=e.rects.reference[d]+e.rects.reference[u]-a[u]-e.rects.popper[d],_=a[u]-e.rects.reference[u],b=E0(s),S=b?u==="y"?b.clientHeight||0:b.clientWidth||0:0,A=x/2-_/2,C=p[g],O=S-m[d]-p[y],N=S/2-m[d]/2+A,D=Mp(C,N,O),L=u;e.modifiersData[i]=(t={},t[L]=D,t.centerOffset=D-N,t)}}function l8(n){var t=n.state,e=n.options,i=e.element,r=i===void 0?"[data-popper-arrow]":i;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||cR(t.elements.popper,r)&&(t.elements.arrow=r))}const $E={name:"arrow",enabled:!0,phase:"main",fn:o8,effect:l8,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function fd(n){return n.split("-")[1]}var c8={top:"auto",right:"auto",bottom:"auto",left:"auto"};function u8(n,t){var e=n.x,i=n.y,r=t.devicePixelRatio||1;return{x:cd(e*r)/r||0,y:cd(i*r)/r||0}}function lC(n){var t,e=n.popper,i=n.popperRect,r=n.placement,s=n.variation,a=n.offsets,l=n.position,u=n.gpuAcceleration,f=n.adaptive,d=n.roundOffsets,p=n.isFixed,m=a.x,g=m===void 0?0:m,y=a.y,x=y===void 0?0:y,_=typeof d=="function"?d({x:g,y:x}):{x:g,y:x};g=_.x,x=_.y;var b=a.hasOwnProperty("x"),S=a.hasOwnProperty("y"),A=Gr,C=$r,O=window;if(f){var N=E0(e),D="clientHeight",L="clientWidth";if(N===js(e)&&(N=Sc(e),xl(N).position!=="static"&&l==="absolute"&&(D="scrollHeight",L="scrollWidth")),N=N,r===$r||(r===Gr||r===Bs)&&s===ld){C=Ps;var I=p&&N===O&&O.visualViewport?O.visualViewport.height:N[D];x-=I-i.height,x*=u?1:-1}if(r===Gr||(r===$r||r===Ps)&&s===ld){A=Bs;var z=p&&N===O&&O.visualViewport?O.visualViewport.width:N[L];g-=z-i.width,g*=u?1:-1}}var j=Object.assign({position:l},f&&c8),B=d===!0?u8({x:g,y:x},js(e)):{x:g,y:x};if(g=B.x,x=B.y,u){var tt;return Object.assign({},j,(tt={},tt[C]=S?"0":"",tt[A]=b?"0":"",tt.transform=(O.devicePixelRatio||1)<=1?"translate("+g+"px, "+x+"px)":"translate3d("+g+"px, "+x+"px, 0)",tt))}return Object.assign({},j,(t={},t[C]=S?x+"px":"",t[A]=b?g+"px":"",t.transform="",t))}function f8(n){var t=n.state,e=n.options,i=e.gpuAcceleration,r=i===void 0?!0:i,s=e.adaptive,a=s===void 0?!0:s,l=e.roundOffsets,u=l===void 0?!0:l,f={placement:xo(t.placement),variation:fd(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,lC(Object.assign({},f,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,lC(Object.assign({},f,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const $1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:f8,data:{}};var Og={passive:!0};function d8(n){var t=n.state,e=n.instance,i=n.options,r=i.scroll,s=r===void 0?!0:r,a=i.resize,l=a===void 0?!0:a,u=js(t.elements.popper),f=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&f.forEach(function(d){d.addEventListener("scroll",e.update,Og)}),l&&u.addEventListener("resize",e.update,Og),function(){s&&f.forEach(function(d){d.removeEventListener("scroll",e.update,Og)}),l&&u.removeEventListener("resize",e.update,Og)}}const G1={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:d8,data:{}};var h8={left:"right",right:"left",bottom:"top",top:"bottom"};function Tv(n){return n.replace(/left|right|bottom|top/g,function(t){return h8[t]})}var p8={start:"end",end:"start"};function cC(n){return n.replace(/start|end/g,function(t){return p8[t]})}function GE(n){var t=js(n),e=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:e,scrollTop:i}}function VE(n){return ud(Sc(n)).left+GE(n).scrollLeft}function m8(n,t){var e=js(n),i=Sc(n),r=e.visualViewport,s=i.clientWidth,a=i.clientHeight,l=0,u=0;if(r){s=r.width,a=r.height;var f=lR();(f||!f&&t==="fixed")&&(l=r.offsetLeft,u=r.offsetTop)}return{width:s,height:a,x:l+VE(n),y:u}}function g8(n){var t,e=Sc(n),i=GE(n),r=(t=n.ownerDocument)==null?void 0:t.body,s=xu(e.scrollWidth,e.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=xu(e.scrollHeight,e.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),l=-i.scrollLeft+VE(n),u=-i.scrollTop;return xl(r||e).direction==="rtl"&&(l+=xu(e.clientWidth,r?r.clientWidth:0)-s),{width:s,height:a,x:l,y:u}}function WE(n){var t=xl(n),e=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(e+r+i)}function hR(n){return["html","body","#document"].indexOf(yo(n))>=0?n.ownerDocument.body:oa(n)&&WE(n)?n:hR(H1(n))}function Fp(n,t){var e;t===void 0&&(t=[]);var i=hR(n),r=i===((e=n.ownerDocument)==null?void 0:e.body),s=js(i),a=r?[s].concat(s.visualViewport||[],WE(i)?i:[]):i,l=t.concat(a);return r?l:l.concat(Fp(H1(a)))}function Dw(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function v8(n,t){var e=ud(n,!1,t==="fixed");return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}function uC(n,t,e){return t===PE?Dw(m8(n,e)):wu(t)?v8(t,e):Dw(g8(Sc(n)))}function x8(n){var t=Fp(H1(n)),e=["absolute","fixed"].indexOf(xl(n).position)>=0,i=e&&oa(n)?E0(n):n;return wu(i)?t.filter(function(r){return wu(r)&&cR(r,i)&&yo(r)!=="body"}):[]}function y8(n,t,e,i){var r=t==="clippingParents"?x8(n):[].concat(t),s=[].concat(r,[e]),a=s[0],l=s.reduce(function(u,f){var d=uC(n,f,i);return u.top=xu(d.top,u.top),u.right=Wv(d.right,u.right),u.bottom=Wv(d.bottom,u.bottom),u.left=xu(d.left,u.left),u},uC(n,a,i));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function pR(n){var t=n.reference,e=n.element,i=n.placement,r=i?xo(i):null,s=i?fd(i):null,a=t.x+t.width/2-e.width/2,l=t.y+t.height/2-e.height/2,u;switch(r){case $r:u={x:a,y:t.y-e.height};break;case Ps:u={x:a,y:t.y+t.height};break;case Bs:u={x:t.x+t.width,y:l};break;case Gr:u={x:t.x-e.width,y:l};break;default:u={x:t.x,y:t.y}}var f=r?HE(r):null;if(f!=null){var d=f==="y"?"height":"width";switch(s){case bu:u[f]=u[f]-(t[d]/2-e[d]/2);break;case ld:u[f]=u[f]+(t[d]/2-e[d]/2);break}}return u}function dd(n,t){t===void 0&&(t={});var e=t,i=e.placement,r=i===void 0?n.placement:i,s=e.strategy,a=s===void 0?n.strategy:s,l=e.boundary,u=l===void 0?KO:l,f=e.rootBoundary,d=f===void 0?PE:f,p=e.elementContext,m=p===void 0?zf:p,g=e.altBoundary,y=g===void 0?!1:g,x=e.padding,_=x===void 0?0:x,b=fR(typeof _!="number"?_:dR(_,Ad)),S=m===zf?ZO:zf,A=n.rects.popper,C=n.elements[y?S:m],O=y8(wu(C)?C:C.contextElement||Sc(n.elements.popper),u,d,a),N=ud(n.elements.reference),D=pR({reference:N,element:A,placement:r}),L=Dw(Object.assign({},A,D)),I=m===zf?L:N,z={top:O.top-I.top+b.top,bottom:I.bottom-O.bottom+b.bottom,left:O.left-I.left+b.left,right:I.right-O.right+b.right},j=n.modifiersData.offset;if(m===zf&&j){var B=j[r];Object.keys(z).forEach(function(tt){var k=[Bs,Ps].indexOf(tt)>=0?1:-1,et=[$r,Ps].indexOf(tt)>=0?"y":"x";z[tt]+=B[et]*k})}return z}function _8(n,t){t===void 0&&(t={});var e=t,i=e.placement,r=e.boundary,s=e.rootBoundary,a=e.padding,l=e.flipVariations,u=e.allowedAutoPlacements,f=u===void 0?BE:u,d=fd(i),p=d?l?Tw:Tw.filter(function(y){return fd(y)===d}):Ad,m=p.filter(function(y){return f.indexOf(y)>=0});m.length===0&&(m=p);var g=m.reduce(function(y,x){return y[x]=dd(n,{placement:x,boundary:r,rootBoundary:s,padding:a})[xo(x)],y},{});return Object.keys(g).sort(function(y,x){return g[y]-g[x]})}function b8(n){if(xo(n)===z1)return[];var t=Tv(n);return[cC(n),t,cC(t)]}function w8(n){var t=n.state,e=n.options,i=n.name;if(!t.modifiersData[i]._skip){for(var r=e.mainAxis,s=r===void 0?!0:r,a=e.altAxis,l=a===void 0?!0:a,u=e.fallbackPlacements,f=e.padding,d=e.boundary,p=e.rootBoundary,m=e.altBoundary,g=e.flipVariations,y=g===void 0?!0:g,x=e.allowedAutoPlacements,_=t.options.placement,b=xo(_),S=b===_,A=u||(S||!y?[Tv(_)]:b8(_)),C=[_].concat(A).reduce(function(ht,yt){return ht.concat(xo(yt)===z1?_8(t,{placement:yt,boundary:d,rootBoundary:p,padding:f,flipVariations:y,allowedAutoPlacements:x}):yt)},[]),O=t.rects.reference,N=t.rects.popper,D=new Map,L=!0,I=C[0],z=0;z<C.length;z++){var j=C[z],B=xo(j),tt=fd(j)===bu,k=[$r,Ps].indexOf(B)>=0,et=k?"width":"height",K=dd(t,{placement:j,boundary:d,rootBoundary:p,altBoundary:m,padding:f}),q=k?tt?Bs:Gr:tt?Ps:$r;O[et]>N[et]&&(q=Tv(q));var _t=Tv(q),at=[];if(s&&at.push(K[B]<=0),l&&at.push(K[q]<=0,K[_t]<=0),at.every(function(ht){return ht})){I=j,L=!1;break}D.set(j,at)}if(L)for(var P=y?3:1,X=function(yt){var Rt=C.find(function(Et){var G=D.get(Et);if(G)return G.slice(0,yt).every(function(lt){return lt})});if(Rt)return I=Rt,"break"},V=P;V>0;V--){var it=X(V);if(it==="break")break}t.placement!==I&&(t.modifiersData[i]._skip=!0,t.placement=I,t.reset=!0)}}const XE={name:"flip",enabled:!0,phase:"main",fn:w8,requiresIfExists:["offset"],data:{_skip:!1}};function fC(n,t,e){return e===void 0&&(e={x:0,y:0}),{top:n.top-t.height-e.y,right:n.right-t.width+e.x,bottom:n.bottom-t.height+e.y,left:n.left-t.width-e.x}}function dC(n){return[$r,Bs,Ps,Gr].some(function(t){return n[t]>=0})}function E8(n){var t=n.state,e=n.name,i=t.rects.reference,r=t.rects.popper,s=t.modifiersData.preventOverflow,a=dd(t,{elementContext:"reference"}),l=dd(t,{altBoundary:!0}),u=fC(a,i),f=fC(l,r,s),d=dC(u),p=dC(f);t.modifiersData[e]={referenceClippingOffsets:u,popperEscapeOffsets:f,isReferenceHidden:d,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":p})}const YE={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:E8};function A8(n,t,e){var i=xo(n),r=[Gr,$r].indexOf(i)>=0?-1:1,s=typeof e=="function"?e(Object.assign({},t,{placement:n})):e,a=s[0],l=s[1];return a=a||0,l=(l||0)*r,[Gr,Bs].indexOf(i)>=0?{x:l,y:a}:{x:a,y:l}}function S8(n){var t=n.state,e=n.options,i=n.name,r=e.offset,s=r===void 0?[0,0]:r,a=BE.reduce(function(d,p){return d[p]=A8(p,t.rects,s),d},{}),l=a[t.placement],u=l.x,f=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=f),t.modifiersData[i]=a}const qE={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:S8};function T8(n){var t=n.state,e=n.name;t.modifiersData[e]=pR({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const V1={name:"popperOffsets",enabled:!0,phase:"read",fn:T8,data:{}};function C8(n){return n==="x"?"y":"x"}function D8(n){var t=n.state,e=n.options,i=n.name,r=e.mainAxis,s=r===void 0?!0:r,a=e.altAxis,l=a===void 0?!1:a,u=e.boundary,f=e.rootBoundary,d=e.altBoundary,p=e.padding,m=e.tether,g=m===void 0?!0:m,y=e.tetherOffset,x=y===void 0?0:y,_=dd(t,{boundary:u,rootBoundary:f,padding:p,altBoundary:d}),b=xo(t.placement),S=fd(t.placement),A=!S,C=HE(b),O=C8(C),N=t.modifiersData.popperOffsets,D=t.rects.reference,L=t.rects.popper,I=typeof x=="function"?x(Object.assign({},t.rects,{placement:t.placement})):x,z=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),j=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,B={x:0,y:0};if(N){if(s){var tt,k=C==="y"?$r:Gr,et=C==="y"?Ps:Bs,K=C==="y"?"height":"width",q=N[C],_t=q+_[k],at=q-_[et],P=g?-L[K]/2:0,X=S===bu?D[K]:L[K],V=S===bu?-L[K]:-D[K],it=t.elements.arrow,ht=g&&it?zE(it):{width:0,height:0},yt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:uR(),Rt=yt[k],Et=yt[et],G=Mp(0,D[K],ht[K]),lt=A?D[K]/2-P-G-Rt-z.mainAxis:X-G-Rt-z.mainAxis,rt=A?-D[K]/2+P+G+Et+z.mainAxis:V+G+Et+z.mainAxis,ot=t.elements.arrow&&E0(t.elements.arrow),bt=ot?C==="y"?ot.clientTop||0:ot.clientLeft||0:0,St=(tt=j?.[C])!=null?tt:0,R=q+lt-St-bt,mt=q+rt-St,ut=Mp(g?Wv(_t,R):_t,q,g?xu(at,mt):at);N[C]=ut,B[C]=ut-q}if(l){var J,Q=C==="x"?$r:Gr,gt=C==="x"?Ps:Bs,Bt=N[O],Ht=O==="y"?"height":"width",Ct=Bt+_[Q],kt=Bt-_[gt],Dt=[$r,Gr].indexOf(b)!==-1,xt=(J=j?.[O])!=null?J:0,te=Dt?Ct:Bt-D[Ht]-L[Ht]-xt+z.altAxis,ae=Dt?Bt+D[Ht]+L[Ht]-xt-z.altAxis:kt,ne=g&&Dt?s8(te,Bt,ae):Mp(g?te:Ct,Bt,g?ae:kt);N[O]=ne,B[O]=ne-Bt}t.modifiersData[i]=B}}const KE={name:"preventOverflow",enabled:!0,phase:"main",fn:D8,requiresIfExists:["offset"]};function O8(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function R8(n){return n===js(n)||!oa(n)?GE(n):O8(n)}function N8(n){var t=n.getBoundingClientRect(),e=cd(t.width)/n.offsetWidth||1,i=cd(t.height)/n.offsetHeight||1;return e!==1||i!==1}function L8(n,t,e){e===void 0&&(e=!1);var i=oa(t),r=oa(t)&&N8(t),s=Sc(t),a=ud(n,r,e),l={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!e)&&((yo(t)!=="body"||WE(s))&&(l=R8(t)),oa(t)?(u=ud(t,!0),u.x+=t.clientLeft,u.y+=t.clientTop):s&&(u.x=VE(s))),{x:a.left+l.scrollLeft-u.x,y:a.top+l.scrollTop-u.y,width:a.width,height:a.height}}function I8(n){var t=new Map,e=new Set,i=[];n.forEach(function(s){t.set(s.name,s)});function r(s){e.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(l){if(!e.has(l)){var u=t.get(l);u&&r(u)}}),i.push(s)}return n.forEach(function(s){e.has(s.name)||r(s)}),i}function k8(n){var t=I8(n);return oR.reduce(function(e,i){return e.concat(t.filter(function(r){return r.phase===i}))},[])}function M8(n){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(n())})})),t}}function F8(n){var t=n.reduce(function(e,i){var r=e[i.name];return e[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,e},{});return Object.keys(t).map(function(e){return t[e]})}var hC={placement:"bottom",modifiers:[],strategy:"absolute"};function pC(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function A0(n){n===void 0&&(n={});var t=n,e=t.defaultModifiers,i=e===void 0?[]:e,r=t.defaultOptions,s=r===void 0?hC:r;return function(l,u,f){f===void 0&&(f=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},hC,s),modifiersData:{},elements:{reference:l,popper:u},attributes:{},styles:{}},p=[],m=!1,g={state:d,setOptions:function(b){var S=typeof b=="function"?b(d.options):b;x(),d.options=Object.assign({},s,d.options,S),d.scrollParents={reference:wu(l)?Fp(l):l.contextElement?Fp(l.contextElement):[],popper:Fp(u)};var A=k8(F8([].concat(i,d.options.modifiers)));return d.orderedModifiers=A.filter(function(C){return C.enabled}),y(),g.update()},forceUpdate:function(){if(!m){var b=d.elements,S=b.reference,A=b.popper;if(pC(S,A)){d.rects={reference:L8(S,E0(A),d.options.strategy==="fixed"),popper:zE(A)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(z){return d.modifiersData[z.name]=Object.assign({},z.data)});for(var C=0;C<d.orderedModifiers.length;C++){if(d.reset===!0){d.reset=!1,C=-1;continue}var O=d.orderedModifiers[C],N=O.fn,D=O.options,L=D===void 0?{}:D,I=O.name;typeof N=="function"&&(d=N({state:d,options:L,name:I,instance:g})||d)}}}},update:M8(function(){return new Promise(function(_){g.forceUpdate(),_(d)})}),destroy:function(){x(),m=!0}};if(!pC(l,u))return g;g.setOptions(f).then(function(_){!m&&f.onFirstUpdate&&f.onFirstUpdate(_)});function y(){d.orderedModifiers.forEach(function(_){var b=_.name,S=_.options,A=S===void 0?{}:S,C=_.effect;if(typeof C=="function"){var O=C({state:d,name:b,instance:g,options:A}),N=function(){};p.push(O||N)}})}function x(){p.forEach(function(_){return _()}),p=[]}return g}}var P8=A0(),B8=[G1,V1,$1,UE],j8=A0({defaultModifiers:B8}),U8=[G1,V1,$1,UE,qE,XE,KE,$E,YE],ZE=A0({defaultModifiers:U8});const QE=Object.freeze(Object.defineProperty({__proto__:null,afterMain:iR,afterRead:tR,afterWrite:aR,applyStyles:UE,arrow:$E,auto:z1,basePlacements:Ad,beforeMain:eR,beforeRead:QO,beforeWrite:rR,bottom:Ps,clippingParents:KO,computeStyles:$1,createPopper:ZE,createPopperBase:P8,createPopperLite:j8,detectOverflow:dd,end:ld,eventListeners:G1,flip:XE,hide:YE,left:Gr,main:nR,modifierPhases:oR,offset:qE,placements:BE,popper:zf,popperGenerator:A0,popperOffsets:V1,preventOverflow:KE,read:JO,reference:ZO,right:Bs,start:bu,top:$r,variationPlacements:Tw,viewport:PE,write:sR},Symbol.toStringTag,{value:"Module"})),mR=VM(QE);var Cv={exports:{}},Dv={exports:{}};/*!
  * Bootstrap data.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var z8=Dv.exports,mC;function H8(){return mC||(mC=1,function(n,t){(function(e,i){n.exports=i()})(z8,function(){const e=new Map;return{set(r,s,a){e.has(r)||e.set(r,new Map);const l=e.get(r);if(!l.has(s)&&l.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(l.keys())[0]}.`);return}l.set(s,a)},get(r,s){return e.has(r)&&e.get(r).get(s)||null},remove(r,s){if(!e.has(r))return;const a=e.get(r);a.delete(s),a.size===0&&e.delete(r)}}})}(Dv)),Dv.exports}var Ov={exports:{}},Ap={exports:{}};/*!
  * Bootstrap index.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var $8=Ap.exports,gC;function Mu(){return gC||(gC=1,function(n,t){(function(e,i){i(t)})($8,function(e){const s="transitionend",a=z=>(z&&window.CSS&&window.CSS.escape&&(z=z.replace(/#([^\s"#']+)/g,(j,B)=>`#${CSS.escape(B)}`)),z),l=z=>z==null?`${z}`:Object.prototype.toString.call(z).match(/\s([a-z]+)/i)[1].toLowerCase(),u=z=>{do z+=Math.floor(Math.random()*1e6);while(document.getElementById(z));return z},f=z=>{if(!z)return 0;let{transitionDuration:j,transitionDelay:B}=window.getComputedStyle(z);const tt=Number.parseFloat(j),k=Number.parseFloat(B);return!tt&&!k?0:(j=j.split(",")[0],B=B.split(",")[0],(Number.parseFloat(j)+Number.parseFloat(B))*1e3)},d=z=>{z.dispatchEvent(new Event(s))},p=z=>!z||typeof z!="object"?!1:(typeof z.jquery<"u"&&(z=z[0]),typeof z.nodeType<"u"),m=z=>p(z)?z.jquery?z[0]:z:typeof z=="string"&&z.length>0?document.querySelector(a(z)):null,g=z=>{if(!p(z)||z.getClientRects().length===0)return!1;const j=getComputedStyle(z).getPropertyValue("visibility")==="visible",B=z.closest("details:not([open])");if(!B)return j;if(B!==z){const tt=z.closest("summary");if(tt&&tt.parentNode!==B||tt===null)return!1}return j},y=z=>!z||z.nodeType!==Node.ELEMENT_NODE||z.classList.contains("disabled")?!0:typeof z.disabled<"u"?z.disabled:z.hasAttribute("disabled")&&z.getAttribute("disabled")!=="false",x=z=>{if(!document.documentElement.attachShadow)return null;if(typeof z.getRootNode=="function"){const j=z.getRootNode();return j instanceof ShadowRoot?j:null}return z instanceof ShadowRoot?z:z.parentNode?x(z.parentNode):null},_=()=>{},b=z=>{z.offsetHeight},S=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,A=[],C=z=>{document.readyState==="loading"?(A.length||document.addEventListener("DOMContentLoaded",()=>{for(const j of A)j()}),A.push(z)):z()},O=()=>document.documentElement.dir==="rtl",N=z=>{C(()=>{const j=S();if(j){const B=z.NAME,tt=j.fn[B];j.fn[B]=z.jQueryInterface,j.fn[B].Constructor=z,j.fn[B].noConflict=()=>(j.fn[B]=tt,z.jQueryInterface)}})},D=(z,j=[],B=z)=>typeof z=="function"?z.call(...j):B,L=(z,j,B=!0)=>{if(!B){D(z);return}const k=f(j)+5;let et=!1;const K=({target:q})=>{q===j&&(et=!0,j.removeEventListener(s,K),D(z))};j.addEventListener(s,K),setTimeout(()=>{et||d(j)},k)},I=(z,j,B,tt)=>{const k=z.length;let et=z.indexOf(j);return et===-1?!B&&tt?z[k-1]:z[0]:(et+=B?1:-1,tt&&(et=(et+k)%k),z[Math.max(0,Math.min(et,k-1))])};e.defineJQueryPlugin=N,e.execute=D,e.executeAfterTransition=L,e.findShadowRoot=x,e.getElement=m,e.getNextActiveElement=I,e.getTransitionDurationFromElement=f,e.getUID=u,e.getjQuery=S,e.isDisabled=y,e.isElement=p,e.isRTL=O,e.isVisible=g,e.noop=_,e.onDOMContentLoaded=C,e.parseSelector=a,e.reflow=b,e.toType=l,e.triggerTransitionEnd=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})}(Ap,Ap.exports)),Ap.exports}/*!
  * Bootstrap event-handler.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var G8=Ov.exports,vC;function JE(){return vC||(vC=1,function(n,t){(function(e,i){n.exports=i(Mu())})(G8,function(e){const i=/[^.]*(?=\..*)\.|.*/,r=/\..*/,s=/::\d+$/,a={};let l=1;const u={mouseenter:"mouseover",mouseleave:"mouseout"},f=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function d(N,D){return D&&`${D}::${l++}`||N.uidEvent||l++}function p(N){const D=d(N);return N.uidEvent=D,a[D]=a[D]||{},a[D]}function m(N,D){return function L(I){return O(I,{delegateTarget:N}),L.oneOff&&C.off(N,I.type,D),D.apply(N,[I])}}function g(N,D,L){return function I(z){const j=N.querySelectorAll(D);for(let{target:B}=z;B&&B!==this;B=B.parentNode)for(const tt of j)if(tt===B)return O(z,{delegateTarget:B}),I.oneOff&&C.off(N,z.type,D,L),L.apply(B,[z])}}function y(N,D,L=null){return Object.values(N).find(I=>I.callable===D&&I.delegationSelector===L)}function x(N,D,L){const I=typeof D=="string",z=I?L:D||L;let j=A(N);return f.has(j)||(j=N),[I,z,j]}function _(N,D,L,I,z){if(typeof D!="string"||!N)return;let[j,B,tt]=x(D,L,I);D in u&&(B=(P=>function(X){if(!X.relatedTarget||X.relatedTarget!==X.delegateTarget&&!X.delegateTarget.contains(X.relatedTarget))return P.call(this,X)})(B));const k=p(N),et=k[tt]||(k[tt]={}),K=y(et,B,j?L:null);if(K){K.oneOff=K.oneOff&&z;return}const q=d(B,D.replace(i,"")),_t=j?g(N,L,B):m(N,B);_t.delegationSelector=j?L:null,_t.callable=B,_t.oneOff=z,_t.uidEvent=q,et[q]=_t,N.addEventListener(tt,_t,j)}function b(N,D,L,I,z){const j=y(D[L],I,z);j&&(N.removeEventListener(L,j,!!z),delete D[L][j.uidEvent])}function S(N,D,L,I){const z=D[L]||{};for(const[j,B]of Object.entries(z))j.includes(I)&&b(N,D,L,B.callable,B.delegationSelector)}function A(N){return N=N.replace(r,""),u[N]||N}const C={on(N,D,L,I){_(N,D,L,I,!1)},one(N,D,L,I){_(N,D,L,I,!0)},off(N,D,L,I){if(typeof D!="string"||!N)return;const[z,j,B]=x(D,L,I),tt=B!==D,k=p(N),et=k[B]||{},K=D.startsWith(".");if(typeof j<"u"){if(!Object.keys(et).length)return;b(N,k,B,j,z?L:null);return}if(K)for(const q of Object.keys(k))S(N,k,q,D.slice(1));for(const[q,_t]of Object.entries(et)){const at=q.replace(s,"");(!tt||D.includes(at))&&b(N,k,B,_t.callable,_t.delegationSelector)}},trigger(N,D,L){if(typeof D!="string"||!N)return null;const I=e.getjQuery(),z=A(D),j=D!==z;let B=null,tt=!0,k=!0,et=!1;j&&I&&(B=I.Event(D,L),I(N).trigger(B),tt=!B.isPropagationStopped(),k=!B.isImmediatePropagationStopped(),et=B.isDefaultPrevented());const K=O(new Event(D,{bubbles:tt,cancelable:!0}),L);return et&&K.preventDefault(),k&&N.dispatchEvent(K),K.defaultPrevented&&B&&B.preventDefault(),K}};function O(N,D={}){for(const[L,I]of Object.entries(D))try{N[L]=I}catch{Object.defineProperty(N,L,{configurable:!0,get(){return I}})}return N}return C})}(Ov)),Ov.exports}var Rv={exports:{}},Nv={exports:{}};/*!
  * Bootstrap manipulator.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var V8=Nv.exports,xC;function t2(){return xC||(xC=1,function(n,t){(function(e,i){n.exports=i()})(V8,function(){function e(s){if(s==="true")return!0;if(s==="false")return!1;if(s===Number(s).toString())return Number(s);if(s===""||s==="null")return null;if(typeof s!="string")return s;try{return JSON.parse(decodeURIComponent(s))}catch{return s}}function i(s){return s.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)}return{setDataAttribute(s,a,l){s.setAttribute(`data-bs-${i(a)}`,l)},removeDataAttribute(s,a){s.removeAttribute(`data-bs-${i(a)}`)},getDataAttributes(s){if(!s)return{};const a={},l=Object.keys(s.dataset).filter(u=>u.startsWith("bs")&&!u.startsWith("bsConfig"));for(const u of l){let f=u.replace(/^bs/,"");f=f.charAt(0).toLowerCase()+f.slice(1),a[f]=e(s.dataset[u])}return a},getDataAttribute(s,a){return e(s.getAttribute(`data-bs-${i(a)}`))}}})}(Nv)),Nv.exports}/*!
  * Bootstrap config.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var W8=Rv.exports,yC;function gR(){return yC||(yC=1,function(n,t){(function(e,i){n.exports=i(t2(),Mu())})(W8,function(e,i){class r{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(a){return a=this._mergeConfigObj(a),a=this._configAfterMerge(a),this._typeCheckConfig(a),a}_configAfterMerge(a){return a}_mergeConfigObj(a,l){const u=i.isElement(l)?e.getDataAttribute(l,"config"):{};return{...this.constructor.Default,...typeof u=="object"?u:{},...i.isElement(l)?e.getDataAttributes(l):{},...typeof a=="object"?a:{}}}_typeCheckConfig(a,l=this.constructor.DefaultType){for(const[u,f]of Object.entries(l)){const d=a[u],p=i.isElement(d)?"element":i.toType(d);if(!new RegExp(f).test(p))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${u}" provided type "${p}" but expected type "${f}".`)}}}return r})}(Rv)),Rv.exports}/*!
  * Bootstrap base-component.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var X8=Cv.exports,_C;function vR(){return _C||(_C=1,function(n,t){(function(e,i){n.exports=i(H8(),JE(),gR(),Mu())})(X8,function(e,i,r,s){const a="5.3.7";class l extends r{constructor(f,d){super(),f=s.getElement(f),f&&(this._element=f,this._config=this._getConfig(d),e.set(this._element,this.constructor.DATA_KEY,this))}dispose(){e.remove(this._element,this.constructor.DATA_KEY),i.off(this._element,this.constructor.EVENT_KEY);for(const f of Object.getOwnPropertyNames(this))this[f]=null}_queueCallback(f,d,p=!0){s.executeAfterTransition(f,d,p)}_getConfig(f){return f=this._mergeConfigObj(f,this._element),f=this._configAfterMerge(f),this._typeCheckConfig(f),f}static getInstance(f){return e.get(s.getElement(f),this.DATA_KEY)}static getOrCreateInstance(f,d={}){return this.getInstance(f)||new this(f,typeof d=="object"?d:null)}static get VERSION(){return a}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(f){return`${f}${this.EVENT_KEY}`}}return l})}(Cv)),Cv.exports}var Sp={exports:{}};/*!
  * Bootstrap sanitizer.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var Y8=Sp.exports,bC;function xR(){return bC||(bC=1,function(n,t){(function(e,i){i(t)})(Y8,function(e){const r={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},s=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),a=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,l=(f,d)=>{const p=f.nodeName.toLowerCase();return d.includes(p)?s.has(p)?!!a.test(f.nodeValue):!0:d.filter(m=>m instanceof RegExp).some(m=>m.test(p))};function u(f,d,p){if(!f.length)return f;if(p&&typeof p=="function")return p(f);const g=new window.DOMParser().parseFromString(f,"text/html"),y=[].concat(...g.body.querySelectorAll("*"));for(const x of y){const _=x.nodeName.toLowerCase();if(!Object.keys(d).includes(_)){x.remove();continue}const b=[].concat(...x.attributes),S=[].concat(d["*"]||[],d[_]||[]);for(const A of b)l(A,S)||x.removeAttribute(A.nodeName)}return g.body.innerHTML}e.DefaultAllowlist=r,e.sanitizeHtml=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})}(Sp,Sp.exports)),Sp.exports}var Lv={exports:{}},Iv={exports:{}};/*!
  * Bootstrap selector-engine.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var q8=Iv.exports,wC;function yR(){return wC||(wC=1,function(n,t){(function(e,i){n.exports=i(Mu())})(q8,function(e){const i=s=>{let a=s.getAttribute("data-bs-target");if(!a||a==="#"){let l=s.getAttribute("href");if(!l||!l.includes("#")&&!l.startsWith("."))return null;l.includes("#")&&!l.startsWith("#")&&(l=`#${l.split("#")[1]}`),a=l&&l!=="#"?l.trim():null}return a?a.split(",").map(l=>e.parseSelector(l)).join(","):null},r={find(s,a=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(a,s))},findOne(s,a=document.documentElement){return Element.prototype.querySelector.call(a,s)},children(s,a){return[].concat(...s.children).filter(l=>l.matches(a))},parents(s,a){const l=[];let u=s.parentNode.closest(a);for(;u;)l.push(u),u=u.parentNode.closest(a);return l},prev(s,a){let l=s.previousElementSibling;for(;l;){if(l.matches(a))return[l];l=l.previousElementSibling}return[]},next(s,a){let l=s.nextElementSibling;for(;l;){if(l.matches(a))return[l];l=l.nextElementSibling}return[]},focusableChildren(s){const a=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(l=>`${l}:not([tabindex^="-"])`).join(",");return this.find(a,s).filter(l=>!e.isDisabled(l)&&e.isVisible(l))},getSelectorFromElement(s){const a=i(s);return a&&r.findOne(a)?a:null},getElementFromSelector(s){const a=i(s);return a?r.findOne(a):null},getMultipleElementsFromSelector(s){const a=i(s);return a?r.find(a):[]}};return r})}(Iv)),Iv.exports}/*!
  * Bootstrap template-factory.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var K8=Lv.exports,EC;function Z8(){return EC||(EC=1,function(n,t){(function(e,i){n.exports=i(yR(),gR(),xR(),Mu())})(K8,function(e,i,r,s){const a="TemplateFactory",l={allowList:r.DefaultAllowlist,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},u={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},f={entry:"(string|element|function|null)",selector:"(string|element)"};class d extends i{constructor(m){super(),this._config=this._getConfig(m)}static get Default(){return l}static get DefaultType(){return u}static get NAME(){return a}getContent(){return Object.values(this._config.content).map(m=>this._resolvePossibleFunction(m)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(m){return this._checkContent(m),this._config.content={...this._config.content,...m},this}toHtml(){const m=document.createElement("div");m.innerHTML=this._maybeSanitize(this._config.template);for(const[x,_]of Object.entries(this._config.content))this._setContent(m,_,x);const g=m.children[0],y=this._resolvePossibleFunction(this._config.extraClass);return y&&g.classList.add(...y.split(" ")),g}_typeCheckConfig(m){super._typeCheckConfig(m),this._checkContent(m.content)}_checkContent(m){for(const[g,y]of Object.entries(m))super._typeCheckConfig({selector:g,entry:y},f)}_setContent(m,g,y){const x=e.findOne(y,m);if(x){if(g=this._resolvePossibleFunction(g),!g){x.remove();return}if(s.isElement(g)){this._putElementInTemplate(s.getElement(g),x);return}if(this._config.html){x.innerHTML=this._maybeSanitize(g);return}x.textContent=g}}_maybeSanitize(m){return this._config.sanitize?r.sanitizeHtml(m,this._config.allowList,this._config.sanitizeFn):m}_resolvePossibleFunction(m){return s.execute(m,[void 0,this])}_putElementInTemplate(m,g){if(this._config.html){g.innerHTML="",g.append(m);return}g.textContent=m.textContent}}return d})}(Lv)),Lv.exports}/*!
  * Bootstrap tooltip.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var Q8=Sv.exports,AC;function J8(){return AC||(AC=1,function(n,t){(function(e,i){n.exports=i(mR,vR(),JE(),t2(),Mu(),xR(),Z8())})(Q8,function(e,i,r,s,a,l,u){function f(X){const V=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(X){for(const it in X)if(it!=="default"){const ht=Object.getOwnPropertyDescriptor(X,it);Object.defineProperty(V,it,ht.get?ht:{enumerable:!0,get:()=>X[it]})}}return V.default=X,Object.freeze(V)}const d=f(e),p="tooltip",m=new Set(["sanitize","allowList","sanitizeFn"]),g="fade",y="modal",x="show",_=".tooltip-inner",b=`.${y}`,S="hide.bs.modal",A="hover",C="focus",O="click",N="manual",D="hide",L="hidden",I="show",z="shown",j="inserted",B="click",tt="focusin",k="focusout",et="mouseenter",K="mouseleave",q={AUTO:"auto",TOP:"top",RIGHT:a.isRTL()?"left":"right",BOTTOM:"bottom",LEFT:a.isRTL()?"right":"left"},_t={allowList:l.DefaultAllowlist,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},at={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class P extends i{constructor(V,it){if(typeof d>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(V,it),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return _t}static get DefaultType(){return at}static get NAME(){return p}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),r.off(this._element.closest(b),S,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const V=r.trigger(this._element,this.constructor.eventName(I)),ht=(a.findShadowRoot(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(V.defaultPrevented||!ht)return;this._disposePopper();const yt=this._getTipElement();this._element.setAttribute("aria-describedby",yt.getAttribute("id"));const{container:Rt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(Rt.append(yt),r.trigger(this._element,this.constructor.eventName(j))),this._popper=this._createPopper(yt),yt.classList.add(x),"ontouchstart"in document.documentElement)for(const G of[].concat(...document.body.children))r.on(G,"mouseover",a.noop);const Et=()=>{r.trigger(this._element,this.constructor.eventName(z)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(Et,this.tip,this._isAnimated())}hide(){if(!this._isShown()||r.trigger(this._element,this.constructor.eventName(D)).defaultPrevented)return;if(this._getTipElement().classList.remove(x),"ontouchstart"in document.documentElement)for(const yt of[].concat(...document.body.children))r.off(yt,"mouseover",a.noop);this._activeTrigger[O]=!1,this._activeTrigger[C]=!1,this._activeTrigger[A]=!1,this._isHovered=null;const ht=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),r.trigger(this._element,this.constructor.eventName(L)))};this._queueCallback(ht,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(V){const it=this._getTemplateFactory(V).toHtml();if(!it)return null;it.classList.remove(g,x),it.classList.add(`bs-${this.constructor.NAME}-auto`);const ht=a.getUID(this.constructor.NAME).toString();return it.setAttribute("id",ht),this._isAnimated()&&it.classList.add(g),it}setContent(V){this._newContent=V,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(V){return this._templateFactory?this._templateFactory.changeContent(V):this._templateFactory=new u({...this._config,content:V,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(V){return this.constructor.getOrCreateInstance(V.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(g)}_isShown(){return this.tip&&this.tip.classList.contains(x)}_createPopper(V){const it=a.execute(this._config.placement,[this,V,this._element]),ht=q[it.toUpperCase()];return d.createPopper(this._element,V,this._getPopperConfig(ht))}_getOffset(){const{offset:V}=this._config;return typeof V=="string"?V.split(",").map(it=>Number.parseInt(it,10)):typeof V=="function"?it=>V(it,this._element):V}_resolvePossibleFunction(V){return a.execute(V,[this._element,this._element])}_getPopperConfig(V){const it={placement:V,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:ht=>{this._getTipElement().setAttribute("data-popper-placement",ht.state.placement)}}]};return{...it,...a.execute(this._config.popperConfig,[void 0,it])}}_setListeners(){const V=this._config.trigger.split(" ");for(const it of V)if(it==="click")r.on(this._element,this.constructor.eventName(B),this._config.selector,ht=>{const yt=this._initializeOnDelegatedTarget(ht);yt._activeTrigger[O]=!(yt._isShown()&&yt._activeTrigger[O]),yt.toggle()});else if(it!==N){const ht=it===A?this.constructor.eventName(et):this.constructor.eventName(tt),yt=it===A?this.constructor.eventName(K):this.constructor.eventName(k);r.on(this._element,ht,this._config.selector,Rt=>{const Et=this._initializeOnDelegatedTarget(Rt);Et._activeTrigger[Rt.type==="focusin"?C:A]=!0,Et._enter()}),r.on(this._element,yt,this._config.selector,Rt=>{const Et=this._initializeOnDelegatedTarget(Rt);Et._activeTrigger[Rt.type==="focusout"?C:A]=Et._element.contains(Rt.relatedTarget),Et._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},r.on(this._element.closest(b),S,this._hideModalHandler)}_fixTitle(){const V=this._element.getAttribute("title");V&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",V),this._element.setAttribute("data-bs-original-title",V),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(V,it){clearTimeout(this._timeout),this._timeout=setTimeout(V,it)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(V){const it=s.getDataAttributes(this._element);for(const ht of Object.keys(it))m.has(ht)&&delete it[ht];return V={...it,...typeof V=="object"&&V?V:{}},V=this._mergeConfigObj(V),V=this._configAfterMerge(V),this._typeCheckConfig(V),V}_configAfterMerge(V){return V.container=V.container===!1?document.body:a.getElement(V.container),typeof V.delay=="number"&&(V.delay={show:V.delay,hide:V.delay}),typeof V.title=="number"&&(V.title=V.title.toString()),typeof V.content=="number"&&(V.content=V.content.toString()),V}_getDelegateConfig(){const V={};for(const[it,ht]of Object.entries(this._config))this.constructor.Default[it]!==ht&&(V[it]=ht);return V.selector=!1,V.trigger="manual",V}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(V){return this.each(function(){const it=P.getOrCreateInstance(this,V);if(typeof V=="string"){if(typeof it[V]>"u")throw new TypeError(`No method named "${V}"`);it[V]()}})}}return a.defineJQueryPlugin(P),P})}(Sv)),Sv.exports}J8();var kv={exports:{}};/*!
  * Bootstrap dropdown.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var tF=kv.exports,SC;function eF(){return SC||(SC=1,function(n,t){(function(e,i){n.exports=i(mR,vR(),JE(),t2(),yR(),Mu())})(tF,function(e,i,r,s,a,l){function u(St){const R=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(St){for(const mt in St)if(mt!=="default"){const ut=Object.getOwnPropertyDescriptor(St,mt);Object.defineProperty(R,mt,ut.get?ut:{enumerable:!0,get:()=>St[mt]})}}return R.default=St,Object.freeze(R)}const f=u(e),d="dropdown",m=".bs.dropdown",g=".data-api",y="Escape",x="Tab",_="ArrowUp",b="ArrowDown",S=2,A=`hide${m}`,C=`hidden${m}`,O=`show${m}`,N=`shown${m}`,D=`click${m}${g}`,L=`keydown${m}${g}`,I=`keyup${m}${g}`,z="show",j="dropup",B="dropend",tt="dropstart",k="dropup-center",et="dropdown-center",K='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',q=`${K}.${z}`,_t=".dropdown-menu",at=".navbar",P=".navbar-nav",X=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",V=l.isRTL()?"top-end":"top-start",it=l.isRTL()?"top-start":"top-end",ht=l.isRTL()?"bottom-end":"bottom-start",yt=l.isRTL()?"bottom-start":"bottom-end",Rt=l.isRTL()?"left-start":"right-start",Et=l.isRTL()?"right-start":"left-start",G="top",lt="bottom",rt={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},ot={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class bt extends i{constructor(R,mt){super(R,mt),this._popper=null,this._parent=this._element.parentNode,this._menu=a.next(this._element,_t)[0]||a.prev(this._element,_t)[0]||a.findOne(_t,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return rt}static get DefaultType(){return ot}static get NAME(){return d}toggle(){return this._isShown()?this.hide():this.show()}show(){if(l.isDisabled(this._element)||this._isShown())return;const R={relatedTarget:this._element};if(!r.trigger(this._element,O,R).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(P))for(const ut of[].concat(...document.body.children))r.on(ut,"mouseover",l.noop);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(z),this._element.classList.add(z),r.trigger(this._element,N,R)}}hide(){if(l.isDisabled(this._element)||!this._isShown())return;const R={relatedTarget:this._element};this._completeHide(R)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(R){if(!r.trigger(this._element,A,R).defaultPrevented){if("ontouchstart"in document.documentElement)for(const ut of[].concat(...document.body.children))r.off(ut,"mouseover",l.noop);this._popper&&this._popper.destroy(),this._menu.classList.remove(z),this._element.classList.remove(z),this._element.setAttribute("aria-expanded","false"),s.removeDataAttribute(this._menu,"popper"),r.trigger(this._element,C,R),this._element.focus()}}_getConfig(R){if(R=super._getConfig(R),typeof R.reference=="object"&&!l.isElement(R.reference)&&typeof R.reference.getBoundingClientRect!="function")throw new TypeError(`${d.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return R}_createPopper(){if(typeof f>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let R=this._element;this._config.reference==="parent"?R=this._parent:l.isElement(this._config.reference)?R=l.getElement(this._config.reference):typeof this._config.reference=="object"&&(R=this._config.reference);const mt=this._getPopperConfig();this._popper=f.createPopper(R,this._menu,mt)}_isShown(){return this._menu.classList.contains(z)}_getPlacement(){const R=this._parent;if(R.classList.contains(B))return Rt;if(R.classList.contains(tt))return Et;if(R.classList.contains(k))return G;if(R.classList.contains(et))return lt;const mt=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return R.classList.contains(j)?mt?it:V:mt?yt:ht}_detectNavbar(){return this._element.closest(at)!==null}_getOffset(){const{offset:R}=this._config;return typeof R=="string"?R.split(",").map(mt=>Number.parseInt(mt,10)):typeof R=="function"?mt=>R(mt,this._element):R}_getPopperConfig(){const R={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(s.setDataAttribute(this._menu,"popper","static"),R.modifiers=[{name:"applyStyles",enabled:!1}]),{...R,...l.execute(this._config.popperConfig,[void 0,R])}}_selectMenuItem({key:R,target:mt}){const ut=a.find(X,this._menu).filter(J=>l.isVisible(J));ut.length&&l.getNextActiveElement(ut,mt,R===b,!ut.includes(mt)).focus()}static jQueryInterface(R){return this.each(function(){const mt=bt.getOrCreateInstance(this,R);if(typeof R=="string"){if(typeof mt[R]>"u")throw new TypeError(`No method named "${R}"`);mt[R]()}})}static clearMenus(R){if(R.button===S||R.type==="keyup"&&R.key!==x)return;const mt=a.find(q);for(const ut of mt){const J=bt.getInstance(ut);if(!J||J._config.autoClose===!1)continue;const Q=R.composedPath(),gt=Q.includes(J._menu);if(Q.includes(J._element)||J._config.autoClose==="inside"&&!gt||J._config.autoClose==="outside"&&gt||J._menu.contains(R.target)&&(R.type==="keyup"&&R.key===x||/input|select|option|textarea|form/i.test(R.target.tagName)))continue;const Bt={relatedTarget:J._element};R.type==="click"&&(Bt.clickEvent=R),J._completeHide(Bt)}}static dataApiKeydownHandler(R){const mt=/input|textarea/i.test(R.target.tagName),ut=R.key===y,J=[_,b].includes(R.key);if(!J&&!ut||mt&&!ut)return;R.preventDefault();const Q=this.matches(K)?this:a.prev(this,K)[0]||a.next(this,K)[0]||a.findOne(K,R.delegateTarget.parentNode),gt=bt.getOrCreateInstance(Q);if(J){R.stopPropagation(),gt.show(),gt._selectMenuItem(R);return}gt._isShown()&&(R.stopPropagation(),gt.hide(),Q.focus())}}return r.on(document,L,K,bt.dataApiKeydownHandler),r.on(document,L,_t,bt.dataApiKeydownHandler),r.on(document,D,bt.clearMenus),r.on(document,I,bt.clearMenus),r.on(document,D,K,function(St){St.preventDefault(),bt.getOrCreateInstance(this).toggle()}),l.defineJQueryPlugin(bt),bt})}(kv)),kv.exports}eF();var Mv={exports:{}};/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var nF=Mv.exports,TC;function iF(){return TC||(TC=1,function(n,t){(function(e,i){n.exports=i()})(nF,function(){const e=new Map,i={set(W,E,F){e.has(W)||e.set(W,new Map);const nt=e.get(W);nt.has(E)||nt.size===0?nt.set(E,F):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(nt.keys())[0]}.`)},get:(W,E)=>e.has(W)&&e.get(W).get(E)||null,remove(W,E){if(!e.has(W))return;const F=e.get(W);F.delete(E),F.size===0&&e.delete(W)}},r="transitionend",s=W=>(W&&window.CSS&&window.CSS.escape&&(W=W.replace(/#([^\s"#']+)/g,(E,F)=>`#${CSS.escape(F)}`)),W),a=W=>{W.dispatchEvent(new Event(r))},l=W=>!(!W||typeof W!="object")&&(W.jquery!==void 0&&(W=W[0]),W.nodeType!==void 0),u=W=>l(W)?W.jquery?W[0]:W:typeof W=="string"&&W.length>0?document.querySelector(s(W)):null,f=W=>{if(!l(W)||W.getClientRects().length===0)return!1;const E=getComputedStyle(W).getPropertyValue("visibility")==="visible",F=W.closest("details:not([open])");if(!F)return E;if(F!==W){const nt=W.closest("summary");if(nt&&nt.parentNode!==F||nt===null)return!1}return E},d=W=>!W||W.nodeType!==Node.ELEMENT_NODE||!!W.classList.contains("disabled")||(W.disabled!==void 0?W.disabled:W.hasAttribute("disabled")&&W.getAttribute("disabled")!=="false"),p=W=>{if(!document.documentElement.attachShadow)return null;if(typeof W.getRootNode=="function"){const E=W.getRootNode();return E instanceof ShadowRoot?E:null}return W instanceof ShadowRoot?W:W.parentNode?p(W.parentNode):null},m=()=>{},g=W=>{W.offsetHeight},y=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,x=[],_=()=>document.documentElement.dir==="rtl",b=W=>{var E;E=()=>{const F=y();if(F){const nt=W.NAME,At=F.fn[nt];F.fn[nt]=W.jQueryInterface,F.fn[nt].Constructor=W,F.fn[nt].noConflict=()=>(F.fn[nt]=At,W.jQueryInterface)}},document.readyState==="loading"?(x.length||document.addEventListener("DOMContentLoaded",()=>{for(const F of x)F()}),x.push(E)):E()},S=(W,E=[],F=W)=>typeof W=="function"?W.call(...E):F,A=(W,E,F=!0)=>{if(!F)return void S(W);const nt=(Gt=>{if(!Gt)return 0;let{transitionDuration:Xt,transitionDelay:re}=window.getComputedStyle(Gt);const he=Number.parseFloat(Xt),pe=Number.parseFloat(re);return he||pe?(Xt=Xt.split(",")[0],re=re.split(",")[0],1e3*(Number.parseFloat(Xt)+Number.parseFloat(re))):0})(E)+5;let At=!1;const Ot=({target:Gt})=>{Gt===E&&(At=!0,E.removeEventListener(r,Ot),S(W))};E.addEventListener(r,Ot),setTimeout(()=>{At||a(E)},nt)},C=(W,E,F,nt)=>{const At=W.length;let Ot=W.indexOf(E);return Ot===-1?!F&&nt?W[At-1]:W[0]:(Ot+=F?1:-1,nt&&(Ot=(Ot+At)%At),W[Math.max(0,Math.min(Ot,At-1))])},O=/[^.]*(?=\..*)\.|.*/,N=/\..*/,D=/::\d+$/,L={};let I=1;const z={mouseenter:"mouseover",mouseleave:"mouseout"},j=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function B(W,E){return E&&`${E}::${I++}`||W.uidEvent||I++}function tt(W){const E=B(W);return W.uidEvent=E,L[E]=L[E]||{},L[E]}function k(W,E,F=null){return Object.values(W).find(nt=>nt.callable===E&&nt.delegationSelector===F)}function et(W,E,F){const nt=typeof E=="string",At=nt?F:E||F;let Ot=at(W);return j.has(Ot)||(Ot=W),[nt,At,Ot]}function K(W,E,F,nt,At){if(typeof E!="string"||!W)return;let[Ot,Gt,Xt]=et(E,F,nt);E in z&&(Gt=(He=>function(Fe){if(!Fe.relatedTarget||Fe.relatedTarget!==Fe.delegateTarget&&!Fe.delegateTarget.contains(Fe.relatedTarget))return He.call(this,Fe)})(Gt));const re=tt(W),he=re[Xt]||(re[Xt]={}),pe=k(he,Gt,Ot?F:null);if(pe)return void(pe.oneOff=pe.oneOff&&At);const fe=B(Gt,E.replace(O,"")),ze=Ot?function(Te,He,Fe){return function Ne(mn){const En=Te.querySelectorAll(He);for(let{target:We}=mn;We&&We!==this;We=We.parentNode)for(const on of En)if(on===We)return X(mn,{delegateTarget:We}),Ne.oneOff&&P.off(Te,mn.type,He,Fe),Fe.apply(We,[mn])}}(W,F,Gt):function(Te,He){return function Fe(Ne){return X(Ne,{delegateTarget:Te}),Fe.oneOff&&P.off(Te,Ne.type,He),He.apply(Te,[Ne])}}(W,Gt);ze.delegationSelector=Ot?F:null,ze.callable=Gt,ze.oneOff=At,ze.uidEvent=fe,he[fe]=ze,W.addEventListener(Xt,ze,Ot)}function q(W,E,F,nt,At){const Ot=k(E[F],nt,At);Ot&&(W.removeEventListener(F,Ot,!!At),delete E[F][Ot.uidEvent])}function _t(W,E,F,nt){const At=E[F]||{};for(const[Ot,Gt]of Object.entries(At))Ot.includes(nt)&&q(W,E,F,Gt.callable,Gt.delegationSelector)}function at(W){return W=W.replace(N,""),z[W]||W}const P={on(W,E,F,nt){K(W,E,F,nt,!1)},one(W,E,F,nt){K(W,E,F,nt,!0)},off(W,E,F,nt){if(typeof E!="string"||!W)return;const[At,Ot,Gt]=et(E,F,nt),Xt=Gt!==E,re=tt(W),he=re[Gt]||{},pe=E.startsWith(".");if(Ot===void 0){if(pe)for(const fe of Object.keys(re))_t(W,re,fe,E.slice(1));for(const[fe,ze]of Object.entries(he)){const Te=fe.replace(D,"");Xt&&!E.includes(Te)||q(W,re,Gt,ze.callable,ze.delegationSelector)}}else{if(!Object.keys(he).length)return;q(W,re,Gt,Ot,At?F:null)}},trigger(W,E,F){if(typeof E!="string"||!W)return null;const nt=y();let At=null,Ot=!0,Gt=!0,Xt=!1;E!==at(E)&&nt&&(At=nt.Event(E,F),nt(W).trigger(At),Ot=!At.isPropagationStopped(),Gt=!At.isImmediatePropagationStopped(),Xt=At.isDefaultPrevented());const re=X(new Event(E,{bubbles:Ot,cancelable:!0}),F);return Xt&&re.preventDefault(),Gt&&W.dispatchEvent(re),re.defaultPrevented&&At&&At.preventDefault(),re}};function X(W,E={}){for(const[F,nt]of Object.entries(E))try{W[F]=nt}catch{Object.defineProperty(W,F,{configurable:!0,get:()=>nt})}return W}function V(W){if(W==="true")return!0;if(W==="false")return!1;if(W===Number(W).toString())return Number(W);if(W===""||W==="null")return null;if(typeof W!="string")return W;try{return JSON.parse(decodeURIComponent(W))}catch{return W}}function it(W){return W.replace(/[A-Z]/g,E=>`-${E.toLowerCase()}`)}const ht={setDataAttribute(W,E,F){W.setAttribute(`data-bs-${it(E)}`,F)},removeDataAttribute(W,E){W.removeAttribute(`data-bs-${it(E)}`)},getDataAttributes(W){if(!W)return{};const E={},F=Object.keys(W.dataset).filter(nt=>nt.startsWith("bs")&&!nt.startsWith("bsConfig"));for(const nt of F){let At=nt.replace(/^bs/,"");At=At.charAt(0).toLowerCase()+At.slice(1),E[At]=V(W.dataset[nt])}return E},getDataAttribute:(W,E)=>V(W.getAttribute(`data-bs-${it(E)}`))};class yt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(E){return E=this._mergeConfigObj(E),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}_configAfterMerge(E){return E}_mergeConfigObj(E,F){const nt=l(F)?ht.getDataAttribute(F,"config"):{};return{...this.constructor.Default,...typeof nt=="object"?nt:{},...l(F)?ht.getDataAttributes(F):{},...typeof E=="object"?E:{}}}_typeCheckConfig(E,F=this.constructor.DefaultType){for(const[At,Ot]of Object.entries(F)){const Gt=E[At],Xt=l(Gt)?"element":(nt=Gt)==null?`${nt}`:Object.prototype.toString.call(nt).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(Ot).test(Xt))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${At}" provided type "${Xt}" but expected type "${Ot}".`)}var nt}}class Rt extends yt{constructor(E,F){super(),(E=u(E))&&(this._element=E,this._config=this._getConfig(F),i.set(this._element,this.constructor.DATA_KEY,this))}dispose(){i.remove(this._element,this.constructor.DATA_KEY),P.off(this._element,this.constructor.EVENT_KEY);for(const E of Object.getOwnPropertyNames(this))this[E]=null}_queueCallback(E,F,nt=!0){A(E,F,nt)}_getConfig(E){return E=this._mergeConfigObj(E,this._element),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}static getInstance(E){return i.get(u(E),this.DATA_KEY)}static getOrCreateInstance(E,F={}){return this.getInstance(E)||new this(E,typeof F=="object"?F:null)}static get VERSION(){return"5.3.7"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(E){return`${E}${this.EVENT_KEY}`}}const Et=W=>{let E=W.getAttribute("data-bs-target");if(!E||E==="#"){let F=W.getAttribute("href");if(!F||!F.includes("#")&&!F.startsWith("."))return null;F.includes("#")&&!F.startsWith("#")&&(F=`#${F.split("#")[1]}`),E=F&&F!=="#"?F.trim():null}return E?E.split(",").map(F=>s(F)).join(","):null},G={find:(W,E=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(E,W)),findOne:(W,E=document.documentElement)=>Element.prototype.querySelector.call(E,W),children:(W,E)=>[].concat(...W.children).filter(F=>F.matches(E)),parents(W,E){const F=[];let nt=W.parentNode.closest(E);for(;nt;)F.push(nt),nt=nt.parentNode.closest(E);return F},prev(W,E){let F=W.previousElementSibling;for(;F;){if(F.matches(E))return[F];F=F.previousElementSibling}return[]},next(W,E){let F=W.nextElementSibling;for(;F;){if(F.matches(E))return[F];F=F.nextElementSibling}return[]},focusableChildren(W){const E=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(F=>`${F}:not([tabindex^="-"])`).join(",");return this.find(E,W).filter(F=>!d(F)&&f(F))},getSelectorFromElement(W){const E=Et(W);return E&&G.findOne(E)?E:null},getElementFromSelector(W){const E=Et(W);return E?G.findOne(E):null},getMultipleElementsFromSelector(W){const E=Et(W);return E?G.find(E):[]}},lt=(W,E="hide")=>{const F=`click.dismiss${W.EVENT_KEY}`,nt=W.NAME;P.on(document,F,`[data-bs-dismiss="${nt}"]`,function(At){if(["A","AREA"].includes(this.tagName)&&At.preventDefault(),d(this))return;const Ot=G.getElementFromSelector(this)||this.closest(`.${nt}`);W.getOrCreateInstance(Ot)[E]()})},rt=".bs.alert",ot=`close${rt}`,bt=`closed${rt}`;class St extends Rt{static get NAME(){return"alert"}close(){if(P.trigger(this._element,ot).defaultPrevented)return;this._element.classList.remove("show");const E=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,E)}_destroyElement(){this._element.remove(),P.trigger(this._element,bt),this.dispose()}static jQueryInterface(E){return this.each(function(){const F=St.getOrCreateInstance(this);if(typeof E=="string"){if(F[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);F[E](this)}})}}lt(St,"close"),b(St);const R='[data-bs-toggle="button"]';class mt extends Rt{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(E){return this.each(function(){const F=mt.getOrCreateInstance(this);E==="toggle"&&F[E]()})}}P.on(document,"click.bs.button.data-api",R,W=>{W.preventDefault();const E=W.target.closest(R);mt.getOrCreateInstance(E).toggle()}),b(mt);const ut=".bs.swipe",J=`touchstart${ut}`,Q=`touchmove${ut}`,gt=`touchend${ut}`,Bt=`pointerdown${ut}`,Ht=`pointerup${ut}`,Ct={endCallback:null,leftCallback:null,rightCallback:null},kt={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Dt extends yt{constructor(E,F){super(),this._element=E,E&&Dt.isSupported()&&(this._config=this._getConfig(F),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Ct}static get DefaultType(){return kt}static get NAME(){return"swipe"}dispose(){P.off(this._element,ut)}_start(E){this._supportPointerEvents?this._eventIsPointerPenTouch(E)&&(this._deltaX=E.clientX):this._deltaX=E.touches[0].clientX}_end(E){this._eventIsPointerPenTouch(E)&&(this._deltaX=E.clientX-this._deltaX),this._handleSwipe(),S(this._config.endCallback)}_move(E){this._deltaX=E.touches&&E.touches.length>1?0:E.touches[0].clientX-this._deltaX}_handleSwipe(){const E=Math.abs(this._deltaX);if(E<=40)return;const F=E/this._deltaX;this._deltaX=0,F&&S(F>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(P.on(this._element,Bt,E=>this._start(E)),P.on(this._element,Ht,E=>this._end(E)),this._element.classList.add("pointer-event")):(P.on(this._element,J,E=>this._start(E)),P.on(this._element,Q,E=>this._move(E)),P.on(this._element,gt,E=>this._end(E)))}_eventIsPointerPenTouch(E){return this._supportPointerEvents&&(E.pointerType==="pen"||E.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const xt=".bs.carousel",te=".data-api",ae="ArrowLeft",ne="ArrowRight",Me="next",dn="prev",Se="left",gn="right",Ze=`slide${xt}`,Zn=`slid${xt}`,Bn=`keydown${xt}`,On=`mouseenter${xt}`,Oi=`mouseleave${xt}`,Us=`dragstart${xt}`,pa=`load${xt}${te}`,wo=`click${xt}${te}`,ma="carousel",Pi="active",Wr=".active",Rc=".carousel-item",Yu=Wr+Rc,Nc={[ae]:gn,[ne]:Se},Lc={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},qu={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Pa extends Rt{constructor(E,F){super(E,F),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=G.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===ma&&this.cycle()}static get Default(){return Lc}static get DefaultType(){return qu}static get NAME(){return"carousel"}next(){this._slide(Me)}nextWhenVisible(){!document.hidden&&f(this._element)&&this.next()}prev(){this._slide(dn)}pause(){this._isSliding&&a(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?P.one(this._element,Zn,()=>this.cycle()):this.cycle())}to(E){const F=this._getItems();if(E>F.length-1||E<0)return;if(this._isSliding)return void P.one(this._element,Zn,()=>this.to(E));const nt=this._getItemIndex(this._getActive());if(nt===E)return;const At=E>nt?Me:dn;this._slide(At,F[E])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(E){return E.defaultInterval=E.interval,E}_addEventListeners(){this._config.keyboard&&P.on(this._element,Bn,E=>this._keydown(E)),this._config.pause==="hover"&&(P.on(this._element,On,()=>this.pause()),P.on(this._element,Oi,()=>this._maybeEnableCycle())),this._config.touch&&Dt.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const F of G.find(".carousel-item img",this._element))P.on(F,Us,nt=>nt.preventDefault());const E={leftCallback:()=>this._slide(this._directionToOrder(Se)),rightCallback:()=>this._slide(this._directionToOrder(gn)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new Dt(this._element,E)}_keydown(E){if(/input|textarea/i.test(E.target.tagName))return;const F=Nc[E.key];F&&(E.preventDefault(),this._slide(this._directionToOrder(F)))}_getItemIndex(E){return this._getItems().indexOf(E)}_setActiveIndicatorElement(E){if(!this._indicatorsElement)return;const F=G.findOne(Wr,this._indicatorsElement);F.classList.remove(Pi),F.removeAttribute("aria-current");const nt=G.findOne(`[data-bs-slide-to="${E}"]`,this._indicatorsElement);nt&&(nt.classList.add(Pi),nt.setAttribute("aria-current","true"))}_updateInterval(){const E=this._activeElement||this._getActive();if(!E)return;const F=Number.parseInt(E.getAttribute("data-bs-interval"),10);this._config.interval=F||this._config.defaultInterval}_slide(E,F=null){if(this._isSliding)return;const nt=this._getActive(),At=E===Me,Ot=F||C(this._getItems(),nt,At,this._config.wrap);if(Ot===nt)return;const Gt=this._getItemIndex(Ot),Xt=fe=>P.trigger(this._element,fe,{relatedTarget:Ot,direction:this._orderToDirection(E),from:this._getItemIndex(nt),to:Gt});if(Xt(Ze).defaultPrevented||!nt||!Ot)return;const re=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(Gt),this._activeElement=Ot;const he=At?"carousel-item-start":"carousel-item-end",pe=At?"carousel-item-next":"carousel-item-prev";Ot.classList.add(pe),g(Ot),nt.classList.add(he),Ot.classList.add(he),this._queueCallback(()=>{Ot.classList.remove(he,pe),Ot.classList.add(Pi),nt.classList.remove(Pi,pe,he),this._isSliding=!1,Xt(Zn)},nt,this._isAnimated()),re&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return G.findOne(Yu,this._element)}_getItems(){return G.find(Rc,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(E){return _()?E===Se?dn:Me:E===Se?Me:dn}_orderToDirection(E){return _()?E===dn?Se:gn:E===dn?gn:Se}static jQueryInterface(E){return this.each(function(){const F=Pa.getOrCreateInstance(this,E);if(typeof E!="number"){if(typeof E=="string"){if(F[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);F[E]()}}else F.to(E)})}}P.on(document,wo,"[data-bs-slide], [data-bs-slide-to]",function(W){const E=G.getElementFromSelector(this);if(!E||!E.classList.contains(ma))return;W.preventDefault();const F=Pa.getOrCreateInstance(E),nt=this.getAttribute("data-bs-slide-to");return nt?(F.to(nt),void F._maybeEnableCycle()):ht.getDataAttribute(this,"slide")==="next"?(F.next(),void F._maybeEnableCycle()):(F.prev(),void F._maybeEnableCycle())}),P.on(window,pa,()=>{const W=G.find('[data-bs-ride="carousel"]');for(const E of W)Pa.getOrCreateInstance(E)}),b(Pa);const or=".bs.collapse",vi=`show${or}`,xi=`shown${or}`,Ba=`hide${or}`,Ic=`hidden${or}`,Ud=`click${or}.data-api`,Y="show",dt="collapse",st="collapsing",ct=`:scope .${dt} .${dt}`,ft='[data-bs-toggle="collapse"]',pt={parent:null,toggle:!0},Ft={parent:"(null|element)",toggle:"boolean"};class $t extends Rt{constructor(E,F){super(E,F),this._isTransitioning=!1,this._triggerArray=[];const nt=G.find(ft);for(const At of nt){const Ot=G.getSelectorFromElement(At),Gt=G.find(Ot).filter(Xt=>Xt===this._element);Ot!==null&&Gt.length&&this._triggerArray.push(At)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return pt}static get DefaultType(){return Ft}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let E=[];if(this._config.parent&&(E=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(At=>At!==this._element).map(At=>$t.getOrCreateInstance(At,{toggle:!1}))),E.length&&E[0]._isTransitioning||P.trigger(this._element,vi).defaultPrevented)return;for(const At of E)At.hide();const F=this._getDimension();this._element.classList.remove(dt),this._element.classList.add(st),this._element.style[F]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const nt=`scroll${F[0].toUpperCase()+F.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(st),this._element.classList.add(dt,Y),this._element.style[F]="",P.trigger(this._element,xi)},this._element,!0),this._element.style[F]=`${this._element[nt]}px`}hide(){if(this._isTransitioning||!this._isShown()||P.trigger(this._element,Ba).defaultPrevented)return;const E=this._getDimension();this._element.style[E]=`${this._element.getBoundingClientRect()[E]}px`,g(this._element),this._element.classList.add(st),this._element.classList.remove(dt,Y);for(const F of this._triggerArray){const nt=G.getElementFromSelector(F);nt&&!this._isShown(nt)&&this._addAriaAndCollapsedClass([F],!1)}this._isTransitioning=!0,this._element.style[E]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(st),this._element.classList.add(dt),P.trigger(this._element,Ic)},this._element,!0)}_isShown(E=this._element){return E.classList.contains(Y)}_configAfterMerge(E){return E.toggle=!!E.toggle,E.parent=u(E.parent),E}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const E=this._getFirstLevelChildren(ft);for(const F of E){const nt=G.getElementFromSelector(F);nt&&this._addAriaAndCollapsedClass([F],this._isShown(nt))}}_getFirstLevelChildren(E){const F=G.find(ct,this._config.parent);return G.find(E,this._config.parent).filter(nt=>!F.includes(nt))}_addAriaAndCollapsedClass(E,F){if(E.length)for(const nt of E)nt.classList.toggle("collapsed",!F),nt.setAttribute("aria-expanded",F)}static jQueryInterface(E){const F={};return typeof E=="string"&&/show|hide/.test(E)&&(F.toggle=!1),this.each(function(){const nt=$t.getOrCreateInstance(this,F);if(typeof E=="string"){if(nt[E]===void 0)throw new TypeError(`No method named "${E}"`);nt[E]()}})}}P.on(document,Ud,ft,function(W){(W.target.tagName==="A"||W.delegateTarget&&W.delegateTarget.tagName==="A")&&W.preventDefault();for(const E of G.getMultipleElementsFromSelector(this))$t.getOrCreateInstance(E,{toggle:!1}).toggle()}),b($t);var Tt="top",Lt="bottom",It="right",Wt="left",ee="auto",ue=[Tt,Lt,It,Wt],Qt="start",ie="end",je="clippingParents",hn="viewport",an="popper",wn="reference",ps=ue.reduce(function(W,E){return W.concat([E+"-"+Qt,E+"-"+ie])},[]),zs=[].concat(ue,[ee]).reduce(function(W,E){return W.concat([E,E+"-"+Qt,E+"-"+ie])},[]),Sr="beforeRead",Xr="read",ja="afterRead",Yr="beforeMain",zd="main",Tr="afterMain",Hd="beforeWrite",Z0="write",kc="afterWrite",$d=[Sr,Xr,ja,Yr,zd,Tr,Hd,Z0,kc];function Cr(W){return W?(W.nodeName||"").toLowerCase():null}function Dr(W){if(W==null)return window;if(W.toString()!=="[object Window]"){var E=W.ownerDocument;return E&&E.defaultView||window}return W}function yi(W){return W instanceof Dr(W).Element||W instanceof Element}function lr(W){return W instanceof Dr(W).HTMLElement||W instanceof HTMLElement}function Ku(W){return typeof ShadowRoot<"u"&&(W instanceof Dr(W).ShadowRoot||W instanceof ShadowRoot)}const Mc={name:"applyStyles",enabled:!0,phase:"write",fn:function(W){var E=W.state;Object.keys(E.elements).forEach(function(F){var nt=E.styles[F]||{},At=E.attributes[F]||{},Ot=E.elements[F];lr(Ot)&&Cr(Ot)&&(Object.assign(Ot.style,nt),Object.keys(At).forEach(function(Gt){var Xt=At[Gt];Xt===!1?Ot.removeAttribute(Gt):Ot.setAttribute(Gt,Xt===!0?"":Xt)}))})},effect:function(W){var E=W.state,F={popper:{position:E.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(E.elements.popper.style,F.popper),E.styles=F,E.elements.arrow&&Object.assign(E.elements.arrow.style,F.arrow),function(){Object.keys(E.elements).forEach(function(nt){var At=E.elements[nt],Ot=E.attributes[nt]||{},Gt=Object.keys(E.styles.hasOwnProperty(nt)?E.styles[nt]:F[nt]).reduce(function(Xt,re){return Xt[re]="",Xt},{});lr(At)&&Cr(At)&&(Object.assign(At.style,Gt),Object.keys(Ot).forEach(function(Xt){At.removeAttribute(Xt)}))})}},requires:["computeStyles"]};function Wi(W){return W.split("-")[0]}var Ua=Math.max,Fc=Math.min,ms=Math.round;function Gd(){var W=navigator.userAgentData;return W!=null&&W.brands&&Array.isArray(W.brands)?W.brands.map(function(E){return E.brand+"/"+E.version}).join(" "):navigator.userAgent}function Vd(){return!/^((?!chrome|android).)*safari/i.test(Gd())}function Eo(W,E,F){E===void 0&&(E=!1),F===void 0&&(F=!1);var nt=W.getBoundingClientRect(),At=1,Ot=1;E&&lr(W)&&(At=W.offsetWidth>0&&ms(nt.width)/W.offsetWidth||1,Ot=W.offsetHeight>0&&ms(nt.height)/W.offsetHeight||1);var Gt=(yi(W)?Dr(W):window).visualViewport,Xt=!Vd()&&F,re=(nt.left+(Xt&&Gt?Gt.offsetLeft:0))/At,he=(nt.top+(Xt&&Gt?Gt.offsetTop:0))/Ot,pe=nt.width/At,fe=nt.height/Ot;return{width:pe,height:fe,top:he,right:re+pe,bottom:he+fe,left:re,x:re,y:he}}function Pc(W){var E=Eo(W),F=W.offsetWidth,nt=W.offsetHeight;return Math.abs(E.width-F)<=1&&(F=E.width),Math.abs(E.height-nt)<=1&&(nt=E.height),{x:W.offsetLeft,y:W.offsetTop,width:F,height:nt}}function Q0(W,E){var F=E.getRootNode&&E.getRootNode();if(W.contains(E))return!0;if(F&&Ku(F)){var nt=E;do{if(nt&&W.isSameNode(nt))return!0;nt=nt.parentNode||nt.host}while(nt)}return!1}function ga(W){return Dr(W).getComputedStyle(W)}function Zu(W){return["table","td","th"].indexOf(Cr(W))>=0}function Hs(W){return((yi(W)?W.ownerDocument:W.document)||window.document).documentElement}function Dl(W){return Cr(W)==="html"?W:W.assignedSlot||W.parentNode||(Ku(W)?W.host:null)||Hs(W)}function Ao(W){return lr(W)&&ga(W).position!=="fixed"?W.offsetParent:null}function $s(W){for(var E=Dr(W),F=Ao(W);F&&Zu(F)&&ga(F).position==="static";)F=Ao(F);return F&&(Cr(F)==="html"||Cr(F)==="body"&&ga(F).position==="static")?E:F||function(nt){var At=/firefox/i.test(Gd());if(/Trident/i.test(Gd())&&lr(nt)&&ga(nt).position==="fixed")return null;var Ot=Dl(nt);for(Ku(Ot)&&(Ot=Ot.host);lr(Ot)&&["html","body"].indexOf(Cr(Ot))<0;){var Gt=ga(Ot);if(Gt.transform!=="none"||Gt.perspective!=="none"||Gt.contain==="paint"||["transform","perspective"].indexOf(Gt.willChange)!==-1||At&&Gt.willChange==="filter"||At&&Gt.filter&&Gt.filter!=="none")return Ot;Ot=Ot.parentNode}return null}(W)||E}function Qu(W){return["top","bottom"].indexOf(W)>=0?"x":"y"}function So(W,E,F){return Ua(W,Fc(E,F))}function Wd(W){return Object.assign({},{top:0,right:0,bottom:0,left:0},W)}function Ol(W,E){return E.reduce(function(F,nt){return F[nt]=W,F},{})}const Gs={name:"arrow",enabled:!0,phase:"main",fn:function(W){var E,F=W.state,nt=W.name,At=W.options,Ot=F.elements.arrow,Gt=F.modifiersData.popperOffsets,Xt=Wi(F.placement),re=Qu(Xt),he=[Wt,It].indexOf(Xt)>=0?"height":"width";if(Ot&&Gt){var pe=function(Be,ln){return Wd(typeof(Be=typeof Be=="function"?Be(Object.assign({},ln.rects,{placement:ln.placement})):Be)!="number"?Be:Ol(Be,ue))}(At.padding,F),fe=Pc(Ot),ze=re==="y"?Tt:Wt,Te=re==="y"?Lt:It,He=F.rects.reference[he]+F.rects.reference[re]-Gt[re]-F.rects.popper[he],Fe=Gt[re]-F.rects.reference[re],Ne=$s(Ot),mn=Ne?re==="y"?Ne.clientHeight||0:Ne.clientWidth||0:0,En=He/2-Fe/2,We=pe[ze],on=mn-fe[he]-pe[Te],Pe=mn/2-fe[he]/2+En,de=So(We,Pe,on),_e=re;F.modifiersData[nt]=((E={})[_e]=de,E.centerOffset=de-Pe,E)}},effect:function(W){var E=W.state,F=W.options.element,nt=F===void 0?"[data-popper-arrow]":F;nt!=null&&(typeof nt!="string"||(nt=E.elements.popper.querySelector(nt)))&&Q0(E.elements.popper,nt)&&(E.elements.arrow=nt)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function za(W){return W.split("-")[1]}var Bc={top:"auto",right:"auto",bottom:"auto",left:"auto"};function va(W){var E,F=W.popper,nt=W.popperRect,At=W.placement,Ot=W.variation,Gt=W.offsets,Xt=W.position,re=W.gpuAcceleration,he=W.adaptive,pe=W.roundOffsets,fe=W.isFixed,ze=Gt.x,Te=ze===void 0?0:ze,He=Gt.y,Fe=He===void 0?0:He,Ne=typeof pe=="function"?pe({x:Te,y:Fe}):{x:Te,y:Fe};Te=Ne.x,Fe=Ne.y;var mn=Gt.hasOwnProperty("x"),En=Gt.hasOwnProperty("y"),We=Wt,on=Tt,Pe=window;if(he){var de=$s(F),_e="clientHeight",Be="clientWidth";de===Dr(F)&&ga(de=Hs(F)).position!=="static"&&Xt==="absolute"&&(_e="scrollHeight",Be="scrollWidth"),(At===Tt||(At===Wt||At===It)&&Ot===ie)&&(on=Lt,Fe-=(fe&&de===Pe&&Pe.visualViewport?Pe.visualViewport.height:de[_e])-nt.height,Fe*=re?1:-1),At!==Wt&&(At!==Tt&&At!==Lt||Ot!==ie)||(We=It,Te-=(fe&&de===Pe&&Pe.visualViewport?Pe.visualViewport.width:de[Be])-nt.width,Te*=re?1:-1)}var ln,Rn=Object.assign({position:Xt},he&&Bc),li=pe===!0?function(dr,ci){var Ni=dr.x,Qr=dr.y,Ge=ci.devicePixelRatio||1;return{x:ms(Ni*Ge)/Ge||0,y:ms(Qr*Ge)/Ge||0}}({x:Te,y:Fe},Dr(F)):{x:Te,y:Fe};return Te=li.x,Fe=li.y,re?Object.assign({},Rn,((ln={})[on]=En?"0":"",ln[We]=mn?"0":"",ln.transform=(Pe.devicePixelRatio||1)<=1?"translate("+Te+"px, "+Fe+"px)":"translate3d("+Te+"px, "+Fe+"px, 0)",ln)):Object.assign({},Rn,((E={})[on]=En?Fe+"px":"",E[We]=mn?Te+"px":"",E.transform="",E))}const jc={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(W){var E=W.state,F=W.options,nt=F.gpuAcceleration,At=nt===void 0||nt,Ot=F.adaptive,Gt=Ot===void 0||Ot,Xt=F.roundOffsets,re=Xt===void 0||Xt,he={placement:Wi(E.placement),variation:za(E.placement),popper:E.elements.popper,popperRect:E.rects.popper,gpuAcceleration:At,isFixed:E.options.strategy==="fixed"};E.modifiersData.popperOffsets!=null&&(E.styles.popper=Object.assign({},E.styles.popper,va(Object.assign({},he,{offsets:E.modifiersData.popperOffsets,position:E.options.strategy,adaptive:Gt,roundOffsets:re})))),E.modifiersData.arrow!=null&&(E.styles.arrow=Object.assign({},E.styles.arrow,va(Object.assign({},he,{offsets:E.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:re})))),E.attributes.popper=Object.assign({},E.attributes.popper,{"data-popper-placement":E.placement})},data:{}};var To={passive:!0};const Ju={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(W){var E=W.state,F=W.instance,nt=W.options,At=nt.scroll,Ot=At===void 0||At,Gt=nt.resize,Xt=Gt===void 0||Gt,re=Dr(E.elements.popper),he=[].concat(E.scrollParents.reference,E.scrollParents.popper);return Ot&&he.forEach(function(pe){pe.addEventListener("scroll",F.update,To)}),Xt&&re.addEventListener("resize",F.update,To),function(){Ot&&he.forEach(function(pe){pe.removeEventListener("scroll",F.update,To)}),Xt&&re.removeEventListener("resize",F.update,To)}},data:{}};var tf={left:"right",right:"left",bottom:"top",top:"bottom"};function Co(W){return W.replace(/left|right|bottom|top/g,function(E){return tf[E]})}var J0={start:"end",end:"start"};function Xi(W){return W.replace(/start|end/g,function(E){return J0[E]})}function xa(W){var E=Dr(W);return{scrollLeft:E.pageXOffset,scrollTop:E.pageYOffset}}function Rl(W){return Eo(Hs(W)).left+xa(W).scrollLeft}function Do(W){var E=ga(W),F=E.overflow,nt=E.overflowX,At=E.overflowY;return/auto|scroll|overlay|hidden/.test(F+At+nt)}function tm(W){return["html","body","#document"].indexOf(Cr(W))>=0?W.ownerDocument.body:lr(W)&&Do(W)?W:tm(Dl(W))}function Oo(W,E){var F;E===void 0&&(E=[]);var nt=tm(W),At=nt===((F=W.ownerDocument)==null?void 0:F.body),Ot=Dr(nt),Gt=At?[Ot].concat(Ot.visualViewport||[],Do(nt)?nt:[]):nt,Xt=E.concat(Gt);return At?Xt:Xt.concat(Oo(Dl(Gt)))}function Uc(W){return Object.assign({},W,{left:W.x,top:W.y,right:W.x+W.width,bottom:W.y+W.height})}function Nl(W,E,F){return E===hn?Uc(function(nt,At){var Ot=Dr(nt),Gt=Hs(nt),Xt=Ot.visualViewport,re=Gt.clientWidth,he=Gt.clientHeight,pe=0,fe=0;if(Xt){re=Xt.width,he=Xt.height;var ze=Vd();(ze||!ze&&At==="fixed")&&(pe=Xt.offsetLeft,fe=Xt.offsetTop)}return{width:re,height:he,x:pe+Rl(nt),y:fe}}(W,F)):yi(E)?function(nt,At){var Ot=Eo(nt,!1,At==="fixed");return Ot.top=Ot.top+nt.clientTop,Ot.left=Ot.left+nt.clientLeft,Ot.bottom=Ot.top+nt.clientHeight,Ot.right=Ot.left+nt.clientWidth,Ot.width=nt.clientWidth,Ot.height=nt.clientHeight,Ot.x=Ot.left,Ot.y=Ot.top,Ot}(E,F):Uc(function(nt){var At,Ot=Hs(nt),Gt=xa(nt),Xt=(At=nt.ownerDocument)==null?void 0:At.body,re=Ua(Ot.scrollWidth,Ot.clientWidth,Xt?Xt.scrollWidth:0,Xt?Xt.clientWidth:0),he=Ua(Ot.scrollHeight,Ot.clientHeight,Xt?Xt.scrollHeight:0,Xt?Xt.clientHeight:0),pe=-Gt.scrollLeft+Rl(nt),fe=-Gt.scrollTop;return ga(Xt||Ot).direction==="rtl"&&(pe+=Ua(Ot.clientWidth,Xt?Xt.clientWidth:0)-re),{width:re,height:he,x:pe,y:fe}}(Hs(W)))}function zc(W){var E,F=W.reference,nt=W.element,At=W.placement,Ot=At?Wi(At):null,Gt=At?za(At):null,Xt=F.x+F.width/2-nt.width/2,re=F.y+F.height/2-nt.height/2;switch(Ot){case Tt:E={x:Xt,y:F.y-nt.height};break;case Lt:E={x:Xt,y:F.y+F.height};break;case It:E={x:F.x+F.width,y:re};break;case Wt:E={x:F.x-nt.width,y:re};break;default:E={x:F.x,y:F.y}}var he=Ot?Qu(Ot):null;if(he!=null){var pe=he==="y"?"height":"width";switch(Gt){case Qt:E[he]=E[he]-(F[pe]/2-nt[pe]/2);break;case ie:E[he]=E[he]+(F[pe]/2-nt[pe]/2)}}return E}function Ro(W,E){E===void 0&&(E={});var F=E,nt=F.placement,At=nt===void 0?W.placement:nt,Ot=F.strategy,Gt=Ot===void 0?W.strategy:Ot,Xt=F.boundary,re=Xt===void 0?je:Xt,he=F.rootBoundary,pe=he===void 0?hn:he,fe=F.elementContext,ze=fe===void 0?an:fe,Te=F.altBoundary,He=Te!==void 0&&Te,Fe=F.padding,Ne=Fe===void 0?0:Fe,mn=Wd(typeof Ne!="number"?Ne:Ol(Ne,ue)),En=ze===an?wn:an,We=W.rects.popper,on=W.elements[He?En:ze],Pe=function(ci,Ni,Qr,Ge){var Jr=Ni==="clippingParents"?function(An){var Li=Oo(Dl(An)),hr=["absolute","fixed"].indexOf(ga(An).position)>=0&&lr(An)?$s(An):An;return yi(hr)?Li.filter(function(Ys){return yi(Ys)&&Q0(Ys,hr)&&Cr(Ys)!=="body"}):[]}(ci):[].concat(Ni),ts=[].concat(Jr,[Qr]),Vo=ts[0],ui=ts.reduce(function(An,Li){var hr=Nl(ci,Li,Ge);return An.top=Ua(hr.top,An.top),An.right=Fc(hr.right,An.right),An.bottom=Fc(hr.bottom,An.bottom),An.left=Ua(hr.left,An.left),An},Nl(ci,Vo,Ge));return ui.width=ui.right-ui.left,ui.height=ui.bottom-ui.top,ui.x=ui.left,ui.y=ui.top,ui}(yi(on)?on:on.contextElement||Hs(W.elements.popper),re,pe,Gt),de=Eo(W.elements.reference),_e=zc({reference:de,element:We,placement:At}),Be=Uc(Object.assign({},We,_e)),ln=ze===an?Be:de,Rn={top:Pe.top-ln.top+mn.top,bottom:ln.bottom-Pe.bottom+mn.bottom,left:Pe.left-ln.left+mn.left,right:ln.right-Pe.right+mn.right},li=W.modifiersData.offset;if(ze===an&&li){var dr=li[At];Object.keys(Rn).forEach(function(ci){var Ni=[It,Lt].indexOf(ci)>=0?1:-1,Qr=[Tt,Lt].indexOf(ci)>=0?"y":"x";Rn[ci]+=dr[Qr]*Ni})}return Rn}function Fx(W,E){E===void 0&&(E={});var F=E,nt=F.placement,At=F.boundary,Ot=F.rootBoundary,Gt=F.padding,Xt=F.flipVariations,re=F.allowedAutoPlacements,he=re===void 0?zs:re,pe=za(nt),fe=pe?Xt?ps:ps.filter(function(He){return za(He)===pe}):ue,ze=fe.filter(function(He){return he.indexOf(He)>=0});ze.length===0&&(ze=fe);var Te=ze.reduce(function(He,Fe){return He[Fe]=Ro(W,{placement:Fe,boundary:At,rootBoundary:Ot,padding:Gt})[Wi(Fe)],He},{});return Object.keys(Te).sort(function(He,Fe){return Te[He]-Te[Fe]})}const em={name:"flip",enabled:!0,phase:"main",fn:function(W){var E=W.state,F=W.options,nt=W.name;if(!E.modifiersData[nt]._skip){for(var At=F.mainAxis,Ot=At===void 0||At,Gt=F.altAxis,Xt=Gt===void 0||Gt,re=F.fallbackPlacements,he=F.padding,pe=F.boundary,fe=F.rootBoundary,ze=F.altBoundary,Te=F.flipVariations,He=Te===void 0||Te,Fe=F.allowedAutoPlacements,Ne=E.options.placement,mn=Wi(Ne),En=re||(mn!==Ne&&He?function(An){if(Wi(An)===ee)return[];var Li=Co(An);return[Xi(An),Li,Xi(Li)]}(Ne):[Co(Ne)]),We=[Ne].concat(En).reduce(function(An,Li){return An.concat(Wi(Li)===ee?Fx(E,{placement:Li,boundary:pe,rootBoundary:fe,padding:he,flipVariations:He,allowedAutoPlacements:Fe}):Li)},[]),on=E.rects.reference,Pe=E.rects.popper,de=new Map,_e=!0,Be=We[0],ln=0;ln<We.length;ln++){var Rn=We[ln],li=Wi(Rn),dr=za(Rn)===Qt,ci=[Tt,Lt].indexOf(li)>=0,Ni=ci?"width":"height",Qr=Ro(E,{placement:Rn,boundary:pe,rootBoundary:fe,altBoundary:ze,padding:he}),Ge=ci?dr?It:Wt:dr?Lt:Tt;on[Ni]>Pe[Ni]&&(Ge=Co(Ge));var Jr=Co(Ge),ts=[];if(Ot&&ts.push(Qr[li]<=0),Xt&&ts.push(Qr[Ge]<=0,Qr[Jr]<=0),ts.every(function(An){return An})){Be=Rn,_e=!1;break}de.set(Rn,ts)}if(_e)for(var Vo=function(An){var Li=We.find(function(hr){var Ys=de.get(hr);if(Ys)return Ys.slice(0,An).every(function(Ii){return Ii})});if(Li)return Be=Li,"break"},ui=He?3:1;ui>0&&Vo(ui)!=="break";ui--);E.placement!==Be&&(E.modifiersData[nt]._skip=!0,E.placement=Be,E.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function nm(W,E,F){return F===void 0&&(F={x:0,y:0}),{top:W.top-E.height-F.y,right:W.right-E.width+F.x,bottom:W.bottom-E.height+F.y,left:W.left-E.width-F.x}}function ef(W){return[Tt,It,Lt,Wt].some(function(E){return W[E]>=0})}const im={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(W){var E=W.state,F=W.name,nt=E.rects.reference,At=E.rects.popper,Ot=E.modifiersData.preventOverflow,Gt=Ro(E,{elementContext:"reference"}),Xt=Ro(E,{altBoundary:!0}),re=nm(Gt,nt),he=nm(Xt,At,Ot),pe=ef(re),fe=ef(he);E.modifiersData[F]={referenceClippingOffsets:re,popperEscapeOffsets:he,isReferenceHidden:pe,hasPopperEscaped:fe},E.attributes.popper=Object.assign({},E.attributes.popper,{"data-popper-reference-hidden":pe,"data-popper-escaped":fe})}},rm={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(W){var E=W.state,F=W.options,nt=W.name,At=F.offset,Ot=At===void 0?[0,0]:At,Gt=zs.reduce(function(pe,fe){return pe[fe]=function(ze,Te,He){var Fe=Wi(ze),Ne=[Wt,Tt].indexOf(Fe)>=0?-1:1,mn=typeof He=="function"?He(Object.assign({},Te,{placement:ze})):He,En=mn[0],We=mn[1];return En=En||0,We=(We||0)*Ne,[Wt,It].indexOf(Fe)>=0?{x:We,y:En}:{x:En,y:We}}(fe,E.rects,Ot),pe},{}),Xt=Gt[E.placement],re=Xt.x,he=Xt.y;E.modifiersData.popperOffsets!=null&&(E.modifiersData.popperOffsets.x+=re,E.modifiersData.popperOffsets.y+=he),E.modifiersData[nt]=Gt}},Xd={name:"popperOffsets",enabled:!0,phase:"read",fn:function(W){var E=W.state,F=W.name;E.modifiersData[F]=zc({reference:E.rects.reference,element:E.rects.popper,placement:E.placement})},data:{}},sm={name:"preventOverflow",enabled:!0,phase:"main",fn:function(W){var E=W.state,F=W.options,nt=W.name,At=F.mainAxis,Ot=At===void 0||At,Gt=F.altAxis,Xt=Gt!==void 0&&Gt,re=F.boundary,he=F.rootBoundary,pe=F.altBoundary,fe=F.padding,ze=F.tether,Te=ze===void 0||ze,He=F.tetherOffset,Fe=He===void 0?0:He,Ne=Ro(E,{boundary:re,rootBoundary:he,padding:fe,altBoundary:pe}),mn=Wi(E.placement),En=za(E.placement),We=!En,on=Qu(mn),Pe=on==="x"?"y":"x",de=E.modifiersData.popperOffsets,_e=E.rects.reference,Be=E.rects.popper,ln=typeof Fe=="function"?Fe(Object.assign({},E.rects,{placement:E.placement})):Fe,Rn=typeof ln=="number"?{mainAxis:ln,altAxis:ln}:Object.assign({mainAxis:0,altAxis:0},ln),li=E.modifiersData.offset?E.modifiersData.offset[E.placement]:null,dr={x:0,y:0};if(de){if(Ot){var ci,Ni=on==="y"?Tt:Wt,Qr=on==="y"?Lt:It,Ge=on==="y"?"height":"width",Jr=de[on],ts=Jr+Ne[Ni],Vo=Jr-Ne[Qr],ui=Te?-Be[Ge]/2:0,An=En===Qt?_e[Ge]:Be[Ge],Li=En===Qt?-Be[Ge]:-_e[Ge],hr=E.elements.arrow,Ys=Te&&hr?Pc(hr):{width:0,height:0},Ii=E.modifiersData["arrow#persistent"]?E.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Qn=Ii[Ni],df=Ii[Qr],Ka=So(0,_e[Ge],Ys[Ge]),hf=We?_e[Ge]/2-ui-Ka-Qn-Rn.mainAxis:An-Ka-Qn-Rn.mainAxis,Ah=We?-_e[Ge]/2+ui+Ka+df+Rn.mainAxis:Li+Ka+df+Rn.mainAxis,xs=E.elements.arrow&&$s(E.elements.arrow),pf=xs?on==="y"?xs.clientTop||0:xs.clientLeft||0:0,mf=(ci=li?.[on])!=null?ci:0,Sh=Jr+Ah-mf,Th=So(Te?Fc(ts,Jr+hf-mf-pf):ts,Jr,Te?Ua(Vo,Sh):Vo);de[on]=Th,dr[on]=Th-Jr}if(Xt){var Ch,zm=on==="x"?Tt:Wt,Hm=on==="x"?Lt:It,Za=de[Pe],Zc=Pe==="y"?"height":"width",gf=Za+Ne[zm],Dh=Za-Ne[Hm],Oh=[Tt,Wt].indexOf(mn)!==-1,Rh=(Ch=li?.[Pe])!=null?Ch:0,Nh=Oh?gf:Za-_e[Zc]-Be[Zc]-Rh+Rn.altAxis,Lh=Oh?Za+_e[Zc]+Be[Zc]-Rh-Rn.altAxis:Dh,vf=Te&&Oh?function($m,Gm,xf){var Ih=So($m,Gm,xf);return Ih>xf?xf:Ih}(Nh,Za,Lh):So(Te?Nh:gf,Za,Te?Lh:Dh);de[Pe]=vf,dr[Pe]=vf-Za}E.modifiersData[nt]=dr}},requiresIfExists:["offset"]};function Px(W,E,F){F===void 0&&(F=!1);var nt,At,Ot=lr(E),Gt=lr(E)&&function(fe){var ze=fe.getBoundingClientRect(),Te=ms(ze.width)/fe.offsetWidth||1,He=ms(ze.height)/fe.offsetHeight||1;return Te!==1||He!==1}(E),Xt=Hs(E),re=Eo(W,Gt,F),he={scrollLeft:0,scrollTop:0},pe={x:0,y:0};return(Ot||!Ot&&!F)&&((Cr(E)!=="body"||Do(Xt))&&(he=(nt=E)!==Dr(nt)&&lr(nt)?{scrollLeft:(At=nt).scrollLeft,scrollTop:At.scrollTop}:xa(nt)),lr(E)?((pe=Eo(E,!0)).x+=E.clientLeft,pe.y+=E.clientTop):Xt&&(pe.x=Rl(Xt))),{x:re.left+he.scrollLeft-pe.x,y:re.top+he.scrollTop-pe.y,width:re.width,height:re.height}}function am(W){var E=new Map,F=new Set,nt=[];function At(Ot){F.add(Ot.name),[].concat(Ot.requires||[],Ot.requiresIfExists||[]).forEach(function(Gt){if(!F.has(Gt)){var Xt=E.get(Gt);Xt&&At(Xt)}}),nt.push(Ot)}return W.forEach(function(Ot){E.set(Ot.name,Ot)}),W.forEach(function(Ot){F.has(Ot.name)||At(Ot)}),nt}var om={placement:"bottom",modifiers:[],strategy:"absolute"};function lm(){for(var W=arguments.length,E=new Array(W),F=0;F<W;F++)E[F]=arguments[F];return!E.some(function(nt){return!(nt&&typeof nt.getBoundingClientRect=="function")})}function nf(W){W===void 0&&(W={});var E=W,F=E.defaultModifiers,nt=F===void 0?[]:F,At=E.defaultOptions,Ot=At===void 0?om:At;return function(Gt,Xt,re){re===void 0&&(re=Ot);var he,pe,fe={placement:"bottom",orderedModifiers:[],options:Object.assign({},om,Ot),modifiersData:{},elements:{reference:Gt,popper:Xt},attributes:{},styles:{}},ze=[],Te=!1,He={state:fe,setOptions:function(Ne){var mn=typeof Ne=="function"?Ne(fe.options):Ne;Fe(),fe.options=Object.assign({},Ot,fe.options,mn),fe.scrollParents={reference:yi(Gt)?Oo(Gt):Gt.contextElement?Oo(Gt.contextElement):[],popper:Oo(Xt)};var En,We,on=function(Pe){var de=am(Pe);return $d.reduce(function(_e,Be){return _e.concat(de.filter(function(ln){return ln.phase===Be}))},[])}((En=[].concat(nt,fe.options.modifiers),We=En.reduce(function(Pe,de){var _e=Pe[de.name];return Pe[de.name]=_e?Object.assign({},_e,de,{options:Object.assign({},_e.options,de.options),data:Object.assign({},_e.data,de.data)}):de,Pe},{}),Object.keys(We).map(function(Pe){return We[Pe]})));return fe.orderedModifiers=on.filter(function(Pe){return Pe.enabled}),fe.orderedModifiers.forEach(function(Pe){var de=Pe.name,_e=Pe.options,Be=_e===void 0?{}:_e,ln=Pe.effect;if(typeof ln=="function"){var Rn=ln({state:fe,name:de,instance:He,options:Be});ze.push(Rn||function(){})}}),He.update()},forceUpdate:function(){if(!Te){var Ne=fe.elements,mn=Ne.reference,En=Ne.popper;if(lm(mn,En)){fe.rects={reference:Px(mn,$s(En),fe.options.strategy==="fixed"),popper:Pc(En)},fe.reset=!1,fe.placement=fe.options.placement,fe.orderedModifiers.forEach(function(ln){return fe.modifiersData[ln.name]=Object.assign({},ln.data)});for(var We=0;We<fe.orderedModifiers.length;We++)if(fe.reset!==!0){var on=fe.orderedModifiers[We],Pe=on.fn,de=on.options,_e=de===void 0?{}:de,Be=on.name;typeof Pe=="function"&&(fe=Pe({state:fe,options:_e,name:Be,instance:He})||fe)}else fe.reset=!1,We=-1}}},update:(he=function(){return new Promise(function(Ne){He.forceUpdate(),Ne(fe)})},function(){return pe||(pe=new Promise(function(Ne){Promise.resolve().then(function(){pe=void 0,Ne(he())})})),pe}),destroy:function(){Fe(),Te=!0}};if(!lm(Gt,Xt))return He;function Fe(){ze.forEach(function(Ne){return Ne()}),ze=[]}return He.setOptions(re).then(function(Ne){!Te&&re.onFirstUpdate&&re.onFirstUpdate(Ne)}),He}}var Bx=nf(),Yd=nf({defaultModifiers:[Ju,Xd,jc,Mc]}),qd=nf({defaultModifiers:[Ju,Xd,jc,Mc,rm,em,sm,Gs,im]});const cm=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Tr,afterRead:ja,afterWrite:kc,applyStyles:Mc,arrow:Gs,auto:ee,basePlacements:ue,beforeMain:Yr,beforeRead:Sr,beforeWrite:Hd,bottom:Lt,clippingParents:je,computeStyles:jc,createPopper:qd,createPopperBase:Bx,createPopperLite:Yd,detectOverflow:Ro,end:ie,eventListeners:Ju,flip:em,hide:im,left:Wt,main:zd,modifierPhases:$d,offset:rm,placements:zs,popper:an,popperGenerator:nf,popperOffsets:Xd,preventOverflow:sm,read:Xr,reference:wn,right:It,start:Qt,top:Tt,variationPlacements:ps,viewport:hn,write:Z0},Symbol.toStringTag,{value:"Module"})),um="dropdown",Ha=".bs.dropdown",Kd=".data-api",jx="ArrowUp",fm="ArrowDown",Ux=`hide${Ha}`,zx=`hidden${Ha}`,Hx=`show${Ha}`,$x=`shown${Ha}`,dm=`click${Ha}${Kd}`,hm=`keydown${Ha}${Kd}`,Zd=`keyup${Ha}${Kd}`,Vs="show",No='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',pm=`${No}.${Vs}`,Hc=".dropdown-menu",mm=_()?"top-end":"top-start",gm=_()?"top-start":"top-end",vm=_()?"bottom-end":"bottom-start",Ll=_()?"bottom-start":"bottom-end",Gx=_()?"left-start":"right-start",Vx=_()?"right-start":"left-start",Wx={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},xm={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class qr extends Rt{constructor(E,F){super(E,F),this._popper=null,this._parent=this._element.parentNode,this._menu=G.next(this._element,Hc)[0]||G.prev(this._element,Hc)[0]||G.findOne(Hc,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Wx}static get DefaultType(){return xm}static get NAME(){return um}toggle(){return this._isShown()?this.hide():this.show()}show(){if(d(this._element)||this._isShown())return;const E={relatedTarget:this._element};if(!P.trigger(this._element,Hx,E).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const F of[].concat(...document.body.children))P.on(F,"mouseover",m);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Vs),this._element.classList.add(Vs),P.trigger(this._element,$x,E)}}hide(){if(d(this._element)||!this._isShown())return;const E={relatedTarget:this._element};this._completeHide(E)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(E){if(!P.trigger(this._element,Ux,E).defaultPrevented){if("ontouchstart"in document.documentElement)for(const F of[].concat(...document.body.children))P.off(F,"mouseover",m);this._popper&&this._popper.destroy(),this._menu.classList.remove(Vs),this._element.classList.remove(Vs),this._element.setAttribute("aria-expanded","false"),ht.removeDataAttribute(this._menu,"popper"),P.trigger(this._element,zx,E),this._element.focus()}}_getConfig(E){if(typeof(E=super._getConfig(E)).reference=="object"&&!l(E.reference)&&typeof E.reference.getBoundingClientRect!="function")throw new TypeError(`${um.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return E}_createPopper(){if(cm===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let E=this._element;this._config.reference==="parent"?E=this._parent:l(this._config.reference)?E=u(this._config.reference):typeof this._config.reference=="object"&&(E=this._config.reference);const F=this._getPopperConfig();this._popper=qd(E,this._menu,F)}_isShown(){return this._menu.classList.contains(Vs)}_getPlacement(){const E=this._parent;if(E.classList.contains("dropend"))return Gx;if(E.classList.contains("dropstart"))return Vx;if(E.classList.contains("dropup-center"))return"top";if(E.classList.contains("dropdown-center"))return"bottom";const F=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return E.classList.contains("dropup")?F?gm:mm:F?Ll:vm}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:E}=this._config;return typeof E=="string"?E.split(",").map(F=>Number.parseInt(F,10)):typeof E=="function"?F=>E(F,this._element):E}_getPopperConfig(){const E={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ht.setDataAttribute(this._menu,"popper","static"),E.modifiers=[{name:"applyStyles",enabled:!1}]),{...E,...S(this._config.popperConfig,[void 0,E])}}_selectMenuItem({key:E,target:F}){const nt=G.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(At=>f(At));nt.length&&C(nt,F,E===fm,!nt.includes(F)).focus()}static jQueryInterface(E){return this.each(function(){const F=qr.getOrCreateInstance(this,E);if(typeof E=="string"){if(F[E]===void 0)throw new TypeError(`No method named "${E}"`);F[E]()}})}static clearMenus(E){if(E.button===2||E.type==="keyup"&&E.key!=="Tab")return;const F=G.find(pm);for(const nt of F){const At=qr.getInstance(nt);if(!At||At._config.autoClose===!1)continue;const Ot=E.composedPath(),Gt=Ot.includes(At._menu);if(Ot.includes(At._element)||At._config.autoClose==="inside"&&!Gt||At._config.autoClose==="outside"&&Gt||At._menu.contains(E.target)&&(E.type==="keyup"&&E.key==="Tab"||/input|select|option|textarea|form/i.test(E.target.tagName)))continue;const Xt={relatedTarget:At._element};E.type==="click"&&(Xt.clickEvent=E),At._completeHide(Xt)}}static dataApiKeydownHandler(E){const F=/input|textarea/i.test(E.target.tagName),nt=E.key==="Escape",At=[jx,fm].includes(E.key);if(!At&&!nt||F&&!nt)return;E.preventDefault();const Ot=this.matches(No)?this:G.prev(this,No)[0]||G.next(this,No)[0]||G.findOne(No,E.delegateTarget.parentNode),Gt=qr.getOrCreateInstance(Ot);if(At)return E.stopPropagation(),Gt.show(),void Gt._selectMenuItem(E);Gt._isShown()&&(E.stopPropagation(),Gt.hide(),Ot.focus())}}P.on(document,hm,No,qr.dataApiKeydownHandler),P.on(document,hm,Hc,qr.dataApiKeydownHandler),P.on(document,dm,qr.clearMenus),P.on(document,Zd,qr.clearMenus),P.on(document,dm,No,function(W){W.preventDefault(),qr.getOrCreateInstance(this).toggle()}),b(qr);const Il="backdrop",kl="show",ym=`mousedown.bs.${Il}`,rf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},_m={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Qd extends yt{constructor(E){super(),this._config=this._getConfig(E),this._isAppended=!1,this._element=null}static get Default(){return rf}static get DefaultType(){return _m}static get NAME(){return Il}show(E){if(!this._config.isVisible)return void S(E);this._append();const F=this._getElement();this._config.isAnimated&&g(F),F.classList.add(kl),this._emulateAnimation(()=>{S(E)})}hide(E){this._config.isVisible?(this._getElement().classList.remove(kl),this._emulateAnimation(()=>{this.dispose(),S(E)})):S(E)}dispose(){this._isAppended&&(P.off(this._element,ym),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const E=document.createElement("div");E.className=this._config.className,this._config.isAnimated&&E.classList.add("fade"),this._element=E}return this._element}_configAfterMerge(E){return E.rootElement=u(E.rootElement),E}_append(){if(this._isAppended)return;const E=this._getElement();this._config.rootElement.append(E),P.on(E,ym,()=>{S(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(E){A(E,this._getElement(),this._config.isAnimated)}}const Ml=".bs.focustrap",Jd=`focusin${Ml}`,bm=`keydown.tab${Ml}`,th="backward",wm={autofocus:!0,trapElement:null},Xx={autofocus:"boolean",trapElement:"element"};class Em extends yt{constructor(E){super(),this._config=this._getConfig(E),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return wm}static get DefaultType(){return Xx}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),P.off(document,Ml),P.on(document,Jd,E=>this._handleFocusin(E)),P.on(document,bm,E=>this._handleKeydown(E)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,P.off(document,Ml))}_handleFocusin(E){const{trapElement:F}=this._config;if(E.target===document||E.target===F||F.contains(E.target))return;const nt=G.focusableChildren(F);nt.length===0?F.focus():this._lastTabNavDirection===th?nt[nt.length-1].focus():nt[0].focus()}_handleKeydown(E){E.key==="Tab"&&(this._lastTabNavDirection=E.shiftKey?th:"forward")}}const Am=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Sm=".sticky-top",sf="padding-right",cr="margin-right";class Lo{constructor(){this._element=document.body}getWidth(){const E=document.documentElement.clientWidth;return Math.abs(window.innerWidth-E)}hide(){const E=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,sf,F=>F+E),this._setElementAttributes(Am,sf,F=>F+E),this._setElementAttributes(Sm,cr,F=>F-E)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,sf),this._resetElementAttributes(Am,sf),this._resetElementAttributes(Sm,cr)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(E,F,nt){const At=this.getWidth();this._applyManipulationCallback(E,Ot=>{if(Ot!==this._element&&window.innerWidth>Ot.clientWidth+At)return;this._saveInitialAttribute(Ot,F);const Gt=window.getComputedStyle(Ot).getPropertyValue(F);Ot.style.setProperty(F,`${nt(Number.parseFloat(Gt))}px`)})}_saveInitialAttribute(E,F){const nt=E.style.getPropertyValue(F);nt&&ht.setDataAttribute(E,F,nt)}_resetElementAttributes(E,F){this._applyManipulationCallback(E,nt=>{const At=ht.getDataAttribute(nt,F);At!==null?(ht.removeDataAttribute(nt,F),nt.style.setProperty(F,At)):nt.style.removeProperty(F)})}_applyManipulationCallback(E,F){if(l(E))F(E);else for(const nt of G.find(E,this._element))F(nt)}}const Or=".bs.modal",Tm=`hide${Or}`,Cm=`hidePrevented${Or}`,eh=`hidden${Or}`,af=`show${Or}`,Yx=`shown${Or}`,Fl=`resize${Or}`,nh=`click.dismiss${Or}`,$c=`mousedown.dismiss${Or}`,ih=`keydown.dismiss${Or}`,Dm=`click${Or}.data-api`,$a="modal-open",Io="show",Gc="modal-static",Om={backdrop:!0,focus:!0,keyboard:!0},ko={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Ga extends Rt{constructor(E,F){super(E,F),this._dialog=G.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Lo,this._addEventListeners()}static get Default(){return Om}static get DefaultType(){return ko}static get NAME(){return"modal"}toggle(E){return this._isShown?this.hide():this.show(E)}show(E){this._isShown||this._isTransitioning||P.trigger(this._element,af,{relatedTarget:E}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add($a),this._adjustDialog(),this._backdrop.show(()=>this._showElement(E)))}hide(){this._isShown&&!this._isTransitioning&&(P.trigger(this._element,Tm).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Io),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){P.off(window,Or),P.off(this._dialog,Or),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Qd({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Em({trapElement:this._element})}_showElement(E){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const F=G.findOne(".modal-body",this._dialog);F&&(F.scrollTop=0),g(this._element),this._element.classList.add(Io),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,P.trigger(this._element,Yx,{relatedTarget:E})},this._dialog,this._isAnimated())}_addEventListeners(){P.on(this._element,ih,E=>{E.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),P.on(window,Fl,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),P.on(this._element,$c,E=>{P.one(this._element,nh,F=>{this._element===E.target&&this._element===F.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove($a),this._resetAdjustments(),this._scrollBar.reset(),P.trigger(this._element,eh)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(P.trigger(this._element,Cm).defaultPrevented)return;const E=this._element.scrollHeight>document.documentElement.clientHeight,F=this._element.style.overflowY;F==="hidden"||this._element.classList.contains(Gc)||(E||(this._element.style.overflowY="hidden"),this._element.classList.add(Gc),this._queueCallback(()=>{this._element.classList.remove(Gc),this._queueCallback(()=>{this._element.style.overflowY=F},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const E=this._element.scrollHeight>document.documentElement.clientHeight,F=this._scrollBar.getWidth(),nt=F>0;if(nt&&!E){const At=_()?"paddingLeft":"paddingRight";this._element.style[At]=`${F}px`}if(!nt&&E){const At=_()?"paddingRight":"paddingLeft";this._element.style[At]=`${F}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(E,F){return this.each(function(){const nt=Ga.getOrCreateInstance(this,E);if(typeof E=="string"){if(nt[E]===void 0)throw new TypeError(`No method named "${E}"`);nt[E](F)}})}}P.on(document,Dm,'[data-bs-toggle="modal"]',function(W){const E=G.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&W.preventDefault(),P.one(E,af,nt=>{nt.defaultPrevented||P.one(E,eh,()=>{f(this)&&this.focus()})});const F=G.findOne(".modal.show");F&&Ga.getInstance(F).hide(),Ga.getOrCreateInstance(E).toggle(this)}),lt(Ga),b(Ga);const Ws=".bs.offcanvas",rh=".data-api",qx=`load${Ws}${rh}`,Rm="show",Nm="showing",sh="hiding",ah=".offcanvas.show",oh=`show${Ws}`,gs=`shown${Ws}`,Lm=`hide${Ws}`,Rr=`hidePrevented${Ws}`,Nr=`hidden${Ws}`,Pl=`resize${Ws}`,lh=`click${Ws}${rh}`,of=`keydown.dismiss${Ws}`,lf={backdrop:!0,keyboard:!0,scroll:!1},ch={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ur extends Rt{constructor(E,F){super(E,F),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return lf}static get DefaultType(){return ch}static get NAME(){return"offcanvas"}toggle(E){return this._isShown?this.hide():this.show(E)}show(E){this._isShown||P.trigger(this._element,oh,{relatedTarget:E}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new Lo().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Nm),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(Rm),this._element.classList.remove(Nm),P.trigger(this._element,gs,{relatedTarget:E})},this._element,!0))}hide(){this._isShown&&(P.trigger(this._element,Lm).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(sh),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(Rm,sh),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Lo().reset(),P.trigger(this._element,Nr)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const E=!!this._config.backdrop;return new Qd({className:"offcanvas-backdrop",isVisible:E,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:E?()=>{this._config.backdrop!=="static"?this.hide():P.trigger(this._element,Rr)}:null})}_initializeFocusTrap(){return new Em({trapElement:this._element})}_addEventListeners(){P.on(this._element,of,E=>{E.key==="Escape"&&(this._config.keyboard?this.hide():P.trigger(this._element,Rr))})}static jQueryInterface(E){return this.each(function(){const F=ur.getOrCreateInstance(this,E);if(typeof E=="string"){if(F[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);F[E](this)}})}}P.on(document,lh,'[data-bs-toggle="offcanvas"]',function(W){const E=G.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&W.preventDefault(),d(this))return;P.one(E,Nr,()=>{f(this)&&this.focus()});const F=G.findOne(ah);F&&F!==E&&ur.getInstance(F).hide(),ur.getOrCreateInstance(E).toggle(this)}),P.on(window,qx,()=>{for(const W of G.find(ah))ur.getOrCreateInstance(W).show()}),P.on(window,Pl,()=>{for(const W of G.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(W).position!=="fixed"&&ur.getOrCreateInstance(W).hide()}),lt(ur),b(ur);const uh={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},cf=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Bl=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Kx=(W,E)=>{const F=W.nodeName.toLowerCase();return E.includes(F)?!cf.has(F)||!!Bl.test(W.nodeValue):E.filter(nt=>nt instanceof RegExp).some(nt=>nt.test(F))},Lr={allowList:uh,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},fh={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},ya={entry:"(string|element|function|null)",selector:"(string|element)"};class Im extends yt{constructor(E){super(),this._config=this._getConfig(E)}static get Default(){return Lr}static get DefaultType(){return fh}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(E=>this._resolvePossibleFunction(E)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(E){return this._checkContent(E),this._config.content={...this._config.content,...E},this}toHtml(){const E=document.createElement("div");E.innerHTML=this._maybeSanitize(this._config.template);for(const[At,Ot]of Object.entries(this._config.content))this._setContent(E,Ot,At);const F=E.children[0],nt=this._resolvePossibleFunction(this._config.extraClass);return nt&&F.classList.add(...nt.split(" ")),F}_typeCheckConfig(E){super._typeCheckConfig(E),this._checkContent(E.content)}_checkContent(E){for(const[F,nt]of Object.entries(E))super._typeCheckConfig({selector:F,entry:nt},ya)}_setContent(E,F,nt){const At=G.findOne(nt,E);At&&((F=this._resolvePossibleFunction(F))?l(F)?this._putElementInTemplate(u(F),At):this._config.html?At.innerHTML=this._maybeSanitize(F):At.textContent=F:At.remove())}_maybeSanitize(E){return this._config.sanitize?function(F,nt,At){if(!F.length)return F;if(At&&typeof At=="function")return At(F);const Ot=new window.DOMParser().parseFromString(F,"text/html"),Gt=[].concat(...Ot.body.querySelectorAll("*"));for(const Xt of Gt){const re=Xt.nodeName.toLowerCase();if(!Object.keys(nt).includes(re)){Xt.remove();continue}const he=[].concat(...Xt.attributes),pe=[].concat(nt["*"]||[],nt[re]||[]);for(const fe of he)Kx(fe,pe)||Xt.removeAttribute(fe.nodeName)}return Ot.body.innerHTML}(E,this._config.allowList,this._config.sanitizeFn):E}_resolvePossibleFunction(E){return S(E,[void 0,this])}_putElementInTemplate(E,F){if(this._config.html)return F.innerHTML="",void F.append(E);F.textContent=E.textContent}}const uf=new Set(["sanitize","allowList","sanitizeFn"]),_a="fade",jl="show",dh=".tooltip-inner",Mo=".modal",Fo="hide.bs.modal",Va="hover",Ul="focus",fr="click",Kr={AUTO:"auto",TOP:"top",RIGHT:_()?"left":"right",BOTTOM:"bottom",LEFT:_()?"right":"left"},Po={allowList:uh,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ba={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Yi extends Rt{constructor(E,F){if(cm===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(E,F),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Po}static get DefaultType(){return ba}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),P.off(this._element.closest(Mo),Fo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const E=P.trigger(this._element,this.constructor.eventName("show")),F=(p(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(E.defaultPrevented||!F)return;this._disposePopper();const nt=this._getTipElement();this._element.setAttribute("aria-describedby",nt.getAttribute("id"));const{container:At}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(At.append(nt),P.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(nt),nt.classList.add(jl),"ontouchstart"in document.documentElement)for(const Ot of[].concat(...document.body.children))P.on(Ot,"mouseover",m);this._queueCallback(()=>{P.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!P.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(jl),"ontouchstart"in document.documentElement)for(const E of[].concat(...document.body.children))P.off(E,"mouseover",m);this._activeTrigger[fr]=!1,this._activeTrigger[Ul]=!1,this._activeTrigger[Va]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),P.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(E){const F=this._getTemplateFactory(E).toHtml();if(!F)return null;F.classList.remove(_a,jl),F.classList.add(`bs-${this.constructor.NAME}-auto`);const nt=(At=>{do At+=Math.floor(1e6*Math.random());while(document.getElementById(At));return At})(this.constructor.NAME).toString();return F.setAttribute("id",nt),this._isAnimated()&&F.classList.add(_a),F}setContent(E){this._newContent=E,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(E){return this._templateFactory?this._templateFactory.changeContent(E):this._templateFactory=new Im({...this._config,content:E,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[dh]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(E){return this.constructor.getOrCreateInstance(E.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(_a)}_isShown(){return this.tip&&this.tip.classList.contains(jl)}_createPopper(E){const F=S(this._config.placement,[this,E,this._element]),nt=Kr[F.toUpperCase()];return qd(this._element,E,this._getPopperConfig(nt))}_getOffset(){const{offset:E}=this._config;return typeof E=="string"?E.split(",").map(F=>Number.parseInt(F,10)):typeof E=="function"?F=>E(F,this._element):E}_resolvePossibleFunction(E){return S(E,[this._element,this._element])}_getPopperConfig(E){const F={placement:E,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:nt=>{this._getTipElement().setAttribute("data-popper-placement",nt.state.placement)}}]};return{...F,...S(this._config.popperConfig,[void 0,F])}}_setListeners(){const E=this._config.trigger.split(" ");for(const F of E)if(F==="click")P.on(this._element,this.constructor.eventName("click"),this._config.selector,nt=>{const At=this._initializeOnDelegatedTarget(nt);At._activeTrigger[fr]=!(At._isShown()&&At._activeTrigger[fr]),At.toggle()});else if(F!=="manual"){const nt=F===Va?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),At=F===Va?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");P.on(this._element,nt,this._config.selector,Ot=>{const Gt=this._initializeOnDelegatedTarget(Ot);Gt._activeTrigger[Ot.type==="focusin"?Ul:Va]=!0,Gt._enter()}),P.on(this._element,At,this._config.selector,Ot=>{const Gt=this._initializeOnDelegatedTarget(Ot);Gt._activeTrigger[Ot.type==="focusout"?Ul:Va]=Gt._element.contains(Ot.relatedTarget),Gt._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},P.on(this._element.closest(Mo),Fo,this._hideModalHandler)}_fixTitle(){const E=this._element.getAttribute("title");E&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",E),this._element.setAttribute("data-bs-original-title",E),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(E,F){clearTimeout(this._timeout),this._timeout=setTimeout(E,F)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(E){const F=ht.getDataAttributes(this._element);for(const nt of Object.keys(F))uf.has(nt)&&delete F[nt];return E={...F,...typeof E=="object"&&E?E:{}},E=this._mergeConfigObj(E),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}_configAfterMerge(E){return E.container=E.container===!1?document.body:u(E.container),typeof E.delay=="number"&&(E.delay={show:E.delay,hide:E.delay}),typeof E.title=="number"&&(E.title=E.title.toString()),typeof E.content=="number"&&(E.content=E.content.toString()),E}_getDelegateConfig(){const E={};for(const[F,nt]of Object.entries(this._config))this.constructor.Default[F]!==nt&&(E[F]=nt);return E.selector=!1,E.trigger="manual",E}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(E){return this.each(function(){const F=Yi.getOrCreateInstance(this,E);if(typeof E=="string"){if(F[E]===void 0)throw new TypeError(`No method named "${E}"`);F[E]()}})}}b(Yi);const Bo=".popover-header",km=".popover-body",hh={...Yi.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ph={...Yi.DefaultType,content:"(null|string|element|function)"};class _i extends Yi{static get Default(){return hh}static get DefaultType(){return ph}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Bo]:this._getTitle(),[km]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(E){return this.each(function(){const F=_i.getOrCreateInstance(this,E);if(typeof E=="string"){if(F[E]===void 0)throw new TypeError(`No method named "${E}"`);F[E]()}})}}b(_i);const zn=".bs.scrollspy",pn=`activate${zn}`,Wa=`click${zn}`,Xs=`load${zn}.data-api`,Xa="active",wa="[href]",mh=".nav-link",Mm=`${mh}, .nav-item > ${mh}, .list-group-item`,Vc={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Wc={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class zl extends Rt{constructor(E,F){super(E,F),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Vc}static get DefaultType(){return Wc}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const E of this._observableSections.values())this._observer.observe(E)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(E){return E.target=u(E.target)||document.body,E.rootMargin=E.offset?`${E.offset}px 0px -30%`:E.rootMargin,typeof E.threshold=="string"&&(E.threshold=E.threshold.split(",").map(F=>Number.parseFloat(F))),E}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(P.off(this._config.target,Wa),P.on(this._config.target,Wa,wa,E=>{const F=this._observableSections.get(E.target.hash);if(F){E.preventDefault();const nt=this._rootElement||window,At=F.offsetTop-this._element.offsetTop;if(nt.scrollTo)return void nt.scrollTo({top:At,behavior:"smooth"});nt.scrollTop=At}}))}_getNewObserver(){const E={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(F=>this._observerCallback(F),E)}_observerCallback(E){const F=Gt=>this._targetLinks.get(`#${Gt.target.id}`),nt=Gt=>{this._previousScrollData.visibleEntryTop=Gt.target.offsetTop,this._process(F(Gt))},At=(this._rootElement||document.documentElement).scrollTop,Ot=At>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=At;for(const Gt of E){if(!Gt.isIntersecting){this._activeTarget=null,this._clearActiveClass(F(Gt));continue}const Xt=Gt.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(Ot&&Xt){if(nt(Gt),!At)return}else Ot||Xt||nt(Gt)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const E=G.find(wa,this._config.target);for(const F of E){if(!F.hash||d(F))continue;const nt=G.findOne(decodeURI(F.hash),this._element);f(nt)&&(this._targetLinks.set(decodeURI(F.hash),F),this._observableSections.set(F.hash,nt))}}_process(E){this._activeTarget!==E&&(this._clearActiveClass(this._config.target),this._activeTarget=E,E.classList.add(Xa),this._activateParents(E),P.trigger(this._element,pn,{relatedTarget:E}))}_activateParents(E){if(E.classList.contains("dropdown-item"))G.findOne(".dropdown-toggle",E.closest(".dropdown")).classList.add(Xa);else for(const F of G.parents(E,".nav, .list-group"))for(const nt of G.prev(F,Mm))nt.classList.add(Xa)}_clearActiveClass(E){E.classList.remove(Xa);const F=G.find(`${wa}.${Xa}`,E);for(const nt of F)nt.classList.remove(Xa)}static jQueryInterface(E){return this.each(function(){const F=zl.getOrCreateInstance(this,E);if(typeof E=="string"){if(F[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);F[E]()}})}}P.on(window,Xs,()=>{for(const W of G.find('[data-bs-spy="scroll"]'))zl.getOrCreateInstance(W)}),b(zl);const vs=".bs.tab",gh=`hide${vs}`,jo=`hidden${vs}`,Ea=`show${vs}`,Ya=`shown${vs}`,Aa=`click${vs}`,vh=`keydown${vs}`,xh=`load${vs}`,Xc="ArrowLeft",Yc="ArrowRight",Uo="ArrowUp",Ri="ArrowDown",Hl="Home",yh="End",zo="active",Fm="fade",_h="show",si=".dropdown-toggle",qc=`:not(${si})`,$l='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ho=`.nav-link${qc}, .list-group-item${qc}, [role="tab"]${qc}, ${$l}`,bh=`.${zo}[data-bs-toggle="tab"], .${zo}[data-bs-toggle="pill"], .${zo}[data-bs-toggle="list"]`;class Zr extends Rt{constructor(E){super(E),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),P.on(this._element,vh,F=>this._keydown(F)))}static get NAME(){return"tab"}show(){const E=this._element;if(this._elemIsActive(E))return;const F=this._getActiveElem(),nt=F?P.trigger(F,gh,{relatedTarget:E}):null;P.trigger(E,Ea,{relatedTarget:F}).defaultPrevented||nt&&nt.defaultPrevented||(this._deactivate(F,E),this._activate(E,F))}_activate(E,F){E&&(E.classList.add(zo),this._activate(G.getElementFromSelector(E)),this._queueCallback(()=>{E.getAttribute("role")==="tab"?(E.removeAttribute("tabindex"),E.setAttribute("aria-selected",!0),this._toggleDropDown(E,!0),P.trigger(E,Ya,{relatedTarget:F})):E.classList.add(_h)},E,E.classList.contains(Fm)))}_deactivate(E,F){E&&(E.classList.remove(zo),E.blur(),this._deactivate(G.getElementFromSelector(E)),this._queueCallback(()=>{E.getAttribute("role")==="tab"?(E.setAttribute("aria-selected",!1),E.setAttribute("tabindex","-1"),this._toggleDropDown(E,!1),P.trigger(E,jo,{relatedTarget:F})):E.classList.remove(_h)},E,E.classList.contains(Fm)))}_keydown(E){if(![Xc,Yc,Uo,Ri,Hl,yh].includes(E.key))return;E.stopPropagation(),E.preventDefault();const F=this._getChildren().filter(At=>!d(At));let nt;if([Hl,yh].includes(E.key))nt=F[E.key===Hl?0:F.length-1];else{const At=[Yc,Ri].includes(E.key);nt=C(F,E.target,At,!0)}nt&&(nt.focus({preventScroll:!0}),Zr.getOrCreateInstance(nt).show())}_getChildren(){return G.find(Ho,this._parent)}_getActiveElem(){return this._getChildren().find(E=>this._elemIsActive(E))||null}_setInitialAttributes(E,F){this._setAttributeIfNotExists(E,"role","tablist");for(const nt of F)this._setInitialAttributesOnChild(nt)}_setInitialAttributesOnChild(E){E=this._getInnerElement(E);const F=this._elemIsActive(E),nt=this._getOuterElement(E);E.setAttribute("aria-selected",F),nt!==E&&this._setAttributeIfNotExists(nt,"role","presentation"),F||E.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(E,"role","tab"),this._setInitialAttributesOnTargetPanel(E)}_setInitialAttributesOnTargetPanel(E){const F=G.getElementFromSelector(E);F&&(this._setAttributeIfNotExists(F,"role","tabpanel"),E.id&&this._setAttributeIfNotExists(F,"aria-labelledby",`${E.id}`))}_toggleDropDown(E,F){const nt=this._getOuterElement(E);if(!nt.classList.contains("dropdown"))return;const At=(Ot,Gt)=>{const Xt=G.findOne(Ot,nt);Xt&&Xt.classList.toggle(Gt,F)};At(si,zo),At(".dropdown-menu",_h),nt.setAttribute("aria-expanded",F)}_setAttributeIfNotExists(E,F,nt){E.hasAttribute(F)||E.setAttribute(F,nt)}_elemIsActive(E){return E.classList.contains(zo)}_getInnerElement(E){return E.matches(Ho)?E:G.findOne(Ho,E)}_getOuterElement(E){return E.closest(".nav-item, .list-group-item")||E}static jQueryInterface(E){return this.each(function(){const F=Zr.getOrCreateInstance(this);if(typeof E=="string"){if(F[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);F[E]()}})}}P.on(document,Aa,$l,function(W){["A","AREA"].includes(this.tagName)&&W.preventDefault(),d(this)||Zr.getOrCreateInstance(this).show()}),P.on(window,xh,()=>{for(const W of G.find(bh))Zr.getOrCreateInstance(W)}),b(Zr);const Ir=".bs.toast",Zx=`mouseover${Ir}`,Pm=`mouseout${Ir}`,Qx=`focusin${Ir}`,Bm=`focusout${Ir}`,$o=`hide${Ir}`,wh=`hidden${Ir}`,ff=`show${Ir}`,jm=`shown${Ir}`,Gl="hide",Kc="show",Go="showing",Eh={animation:"boolean",autohide:"boolean",delay:"number"},Um={animation:!0,autohide:!0,delay:5e3};class qa extends Rt{constructor(E,F){super(E,F),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Um}static get DefaultType(){return Eh}static get NAME(){return"toast"}show(){P.trigger(this._element,ff).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Gl),g(this._element),this._element.classList.add(Kc,Go),this._queueCallback(()=>{this._element.classList.remove(Go),P.trigger(this._element,jm),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(P.trigger(this._element,$o).defaultPrevented||(this._element.classList.add(Go),this._queueCallback(()=>{this._element.classList.add(Gl),this._element.classList.remove(Go,Kc),P.trigger(this._element,wh)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Kc),super.dispose()}isShown(){return this._element.classList.contains(Kc)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(E,F){switch(E.type){case"mouseover":case"mouseout":this._hasMouseInteraction=F;break;case"focusin":case"focusout":this._hasKeyboardInteraction=F}if(F)return void this._clearTimeout();const nt=E.relatedTarget;this._element===nt||this._element.contains(nt)||this._maybeScheduleHide()}_setListeners(){P.on(this._element,Zx,E=>this._onInteraction(E,!0)),P.on(this._element,Pm,E=>this._onInteraction(E,!1)),P.on(this._element,Qx,E=>this._onInteraction(E,!0)),P.on(this._element,Bm,E=>this._onInteraction(E,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(E){return this.each(function(){const F=qa.getOrCreateInstance(this,E);if(typeof E=="string"){if(F[E]===void 0)throw new TypeError(`No method named "${E}"`);F[E](this)}})}}return lt(qa),b(qa),{Alert:St,Button:mt,Carousel:Pa,Collapse:$t,Dropdown:qr,Modal:Ga,Offcanvas:ur,Popover:_i,ScrollSpy:zl,Tab:Zr,Toast:qa,Tooltip:Yi}})}(Mv)),Mv.exports}iF();/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const oc=new Map,f_={set(n,t,e){oc.has(n)||oc.set(n,new Map);const i=oc.get(n);if(!i.has(t)&&i.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`);return}i.set(t,e)},get(n,t){return oc.has(n)&&oc.get(n).get(t)||null},remove(n,t){if(!oc.has(n))return;const e=oc.get(n);e.delete(t),e.size===0&&oc.delete(n)}},rF=1e6,sF=1e3,Ow="transitionend",_R=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(t,e)=>`#${CSS.escape(e)}`)),n),aF=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),oF=n=>{do n+=Math.floor(Math.random()*rF);while(document.getElementById(n));return n},lF=n=>{if(!n)return 0;let{transitionDuration:t,transitionDelay:e}=window.getComputedStyle(n);const i=Number.parseFloat(t),r=Number.parseFloat(e);return!i&&!r?0:(t=t.split(",")[0],e=e.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(e))*sF)},bR=n=>{n.dispatchEvent(new Event(Ow))},dl=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),vc=n=>dl(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(_R(n)):null,Sd=n=>{if(!dl(n)||n.getClientRects().length===0)return!1;const t=getComputedStyle(n).getPropertyValue("visibility")==="visible",e=n.closest("details:not([open])");if(!e)return t;if(e!==n){const i=n.closest("summary");if(i&&i.parentNode!==e||i===null)return!1}return t},xc=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",wR=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const t=n.getRootNode();return t instanceof ShadowRoot?t:null}return n instanceof ShadowRoot?n:n.parentNode?wR(n.parentNode):null},Xv=()=>{},S0=n=>{n.offsetHeight},ER=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,d_=[],cF=n=>{document.readyState==="loading"?(d_.length||document.addEventListener("DOMContentLoaded",()=>{for(const t of d_)t()}),d_.push(n)):n()},ca=()=>document.documentElement.dir==="rtl",da=n=>{cF(()=>{const t=ER();if(t){const e=n.NAME,i=t.fn[e];t.fn[e]=n.jQueryInterface,t.fn[e].Constructor=n,t.fn[e].noConflict=()=>(t.fn[e]=i,n.jQueryInterface)}})},fs=(n,t=[],e=n)=>typeof n=="function"?n.call(...t):e,AR=(n,t,e=!0)=>{if(!e){fs(n);return}const r=lF(t)+5;let s=!1;const a=({target:l})=>{l===t&&(s=!0,t.removeEventListener(Ow,a),fs(n))};t.addEventListener(Ow,a),setTimeout(()=>{s||bR(t)},r)},e2=(n,t,e,i)=>{const r=n.length;let s=n.indexOf(t);return s===-1?!e&&i?n[r-1]:n[0]:(s+=e?1:-1,i&&(s=(s+r)%r),n[Math.max(0,Math.min(s,r-1))])},uF=/[^.]*(?=\..*)\.|.*/,fF=/\..*/,dF=/::\d+$/,h_={};let CC=1;const SR={mouseenter:"mouseover",mouseleave:"mouseout"},hF=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function TR(n,t){return t&&`${t}::${CC++}`||n.uidEvent||CC++}function CR(n){const t=TR(n);return n.uidEvent=t,h_[t]=h_[t]||{},h_[t]}function pF(n,t){return function e(i){return n2(i,{delegateTarget:n}),e.oneOff&&Jt.off(n,i.type,t),t.apply(n,[i])}}function mF(n,t,e){return function i(r){const s=n.querySelectorAll(t);for(let{target:a}=r;a&&a!==this;a=a.parentNode)for(const l of s)if(l===a)return n2(r,{delegateTarget:a}),i.oneOff&&Jt.off(n,r.type,t,e),e.apply(a,[r])}}function DR(n,t,e=null){return Object.values(n).find(i=>i.callable===t&&i.delegationSelector===e)}function OR(n,t,e){const i=typeof t=="string",r=i?e:t||e;let s=RR(n);return hF.has(s)||(s=n),[i,r,s]}function DC(n,t,e,i,r){if(typeof t!="string"||!n)return;let[s,a,l]=OR(t,e,i);t in SR&&(a=(y=>function(x){if(!x.relatedTarget||x.relatedTarget!==x.delegateTarget&&!x.delegateTarget.contains(x.relatedTarget))return y.call(this,x)})(a));const u=CR(n),f=u[l]||(u[l]={}),d=DR(f,a,s?e:null);if(d){d.oneOff=d.oneOff&&r;return}const p=TR(a,t.replace(uF,"")),m=s?mF(n,e,a):pF(n,a);m.delegationSelector=s?e:null,m.callable=a,m.oneOff=r,m.uidEvent=p,f[p]=m,n.addEventListener(l,m,s)}function Rw(n,t,e,i,r){const s=DR(t[e],i,r);s&&(n.removeEventListener(e,s,!!r),delete t[e][s.uidEvent])}function gF(n,t,e,i){const r=t[e]||{};for(const[s,a]of Object.entries(r))s.includes(i)&&Rw(n,t,e,a.callable,a.delegationSelector)}function RR(n){return n=n.replace(fF,""),SR[n]||n}const Jt={on(n,t,e,i){DC(n,t,e,i,!1)},one(n,t,e,i){DC(n,t,e,i,!0)},off(n,t,e,i){if(typeof t!="string"||!n)return;const[r,s,a]=OR(t,e,i),l=a!==t,u=CR(n),f=u[a]||{},d=t.startsWith(".");if(typeof s<"u"){if(!Object.keys(f).length)return;Rw(n,u,a,s,r?e:null);return}if(d)for(const p of Object.keys(u))gF(n,u,p,t.slice(1));for(const[p,m]of Object.entries(f)){const g=p.replace(dF,"");(!l||t.includes(g))&&Rw(n,u,a,m.callable,m.delegationSelector)}},trigger(n,t,e){if(typeof t!="string"||!n)return null;const i=ER(),r=RR(t),s=t!==r;let a=null,l=!0,u=!0,f=!1;s&&i&&(a=i.Event(t,e),i(n).trigger(a),l=!a.isPropagationStopped(),u=!a.isImmediatePropagationStopped(),f=a.isDefaultPrevented());const d=n2(new Event(t,{bubbles:l,cancelable:!0}),e);return f&&d.preventDefault(),u&&n.dispatchEvent(d),d.defaultPrevented&&a&&a.preventDefault(),d}};function n2(n,t={}){for(const[e,i]of Object.entries(t))try{n[e]=i}catch{Object.defineProperty(n,e,{configurable:!0,get(){return i}})}return n}function OC(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function p_(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}const hl={setDataAttribute(n,t,e){n.setAttribute(`data-bs-${p_(t)}`,e)},removeDataAttribute(n,t){n.removeAttribute(`data-bs-${p_(t)}`)},getDataAttributes(n){if(!n)return{};const t={},e=Object.keys(n.dataset).filter(i=>i.startsWith("bs")&&!i.startsWith("bsConfig"));for(const i of e){let r=i.replace(/^bs/,"");r=r.charAt(0).toLowerCase()+r.slice(1),t[r]=OC(n.dataset[i])}return t},getDataAttribute(n,t){return OC(n.getAttribute(`data-bs-${p_(t)}`))}};class T0{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const i=dl(e)?hl.getDataAttribute(e,"config"):{};return{...this.constructor.Default,...typeof i=="object"?i:{},...dl(e)?hl.getDataAttributes(e):{},...typeof t=="object"?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[i,r]of Object.entries(e)){const s=t[i],a=dl(s)?"element":aF(s);if(!new RegExp(r).test(a))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${a}" but expected type "${r}".`)}}}const vF="5.3.7";class Fa extends T0{constructor(t,e){super(),t=vc(t),t&&(this._element=t,this._config=this._getConfig(e),f_.set(this._element,this.constructor.DATA_KEY,this))}dispose(){f_.remove(this._element,this.constructor.DATA_KEY),Jt.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,i=!0){AR(t,e,i)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return f_.get(vc(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,typeof e=="object"?e:null)}static get VERSION(){return vF}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const m_=n=>{let t=n.getAttribute("data-bs-target");if(!t||t==="#"){let e=n.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),t=e&&e!=="#"?e.trim():null}return t?t.split(",").map(e=>_R(e)).join(","):null},Oe={find(n,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,n))},findOne(n,t=document.documentElement){return Element.prototype.querySelector.call(t,n)},children(n,t){return[].concat(...n.children).filter(e=>e.matches(t))},parents(n,t){const e=[];let i=n.parentNode.closest(t);for(;i;)e.push(i),i=i.parentNode.closest(t);return e},prev(n,t){let e=n.previousElementSibling;for(;e;){if(e.matches(t))return[e];e=e.previousElementSibling}return[]},next(n,t){let e=n.nextElementSibling;for(;e;){if(e.matches(t))return[e];e=e.nextElementSibling}return[]},focusableChildren(n){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>`${e}:not([tabindex^="-"])`).join(",");return this.find(t,n).filter(e=>!xc(e)&&Sd(e))},getSelectorFromElement(n){const t=m_(n);return t&&Oe.findOne(t)?t:null},getElementFromSelector(n){const t=m_(n);return t?Oe.findOne(t):null},getMultipleElementsFromSelector(n){const t=m_(n);return t?Oe.find(t):[]}},W1=(n,t="hide")=>{const e=`click.dismiss${n.EVENT_KEY}`,i=n.NAME;Jt.on(document,e,`[data-bs-dismiss="${i}"]`,function(r){if(["A","AREA"].includes(this.tagName)&&r.preventDefault(),xc(this))return;const s=Oe.getElementFromSelector(this)||this.closest(`.${i}`);n.getOrCreateInstance(s)[t]()})},xF="alert",yF="bs.alert",NR=`.${yF}`,_F=`close${NR}`,bF=`closed${NR}`,wF="fade",EF="show";let LR=class IR extends Fa{static get NAME(){return xF}close(){if(Jt.trigger(this._element,_F).defaultPrevented)return;this._element.classList.remove(EF);const e=this._element.classList.contains(wF);this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),Jt.trigger(this._element,bF),this.dispose()}static jQueryInterface(t){return this.each(function(){const e=IR.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}};W1(LR,"close");da(LR);const AF="button",SF="bs.button",TF=`.${SF}`,CF=".data-api",DF="active",RC='[data-bs-toggle="button"]',OF=`click${TF}${CF}`;let kR=class MR extends Fa{static get NAME(){return AF}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(DF))}static jQueryInterface(t){return this.each(function(){const e=MR.getOrCreateInstance(this);t==="toggle"&&e[t]()})}};Jt.on(document,OF,RC,n=>{n.preventDefault();const t=n.target.closest(RC);kR.getOrCreateInstance(t).toggle()});da(kR);const RF="swipe",Td=".bs.swipe",NF=`touchstart${Td}`,LF=`touchmove${Td}`,IF=`touchend${Td}`,kF=`pointerdown${Td}`,MF=`pointerup${Td}`,FF="touch",PF="pen",BF="pointer-event",jF=40,UF={endCallback:null,leftCallback:null,rightCallback:null},zF={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Yv extends T0{constructor(t,e){super(),this._element=t,!(!t||!Yv.isSupported())&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return UF}static get DefaultType(){return zF}static get NAME(){return RF}dispose(){Jt.off(this._element,Td)}_start(t){if(!this._supportPointerEvents){this._deltaX=t.touches[0].clientX;return}this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX)}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),fs(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=jF)return;const e=t/this._deltaX;this._deltaX=0,e&&fs(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Jt.on(this._element,kF,t=>this._start(t)),Jt.on(this._element,MF,t=>this._end(t)),this._element.classList.add(BF)):(Jt.on(this._element,NF,t=>this._start(t)),Jt.on(this._element,LF,t=>this._move(t)),Jt.on(this._element,IF,t=>this._end(t)))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&(t.pointerType===PF||t.pointerType===FF)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const HF="carousel",$F="bs.carousel",Tc=`.${$F}`,FR=".data-api",GF="ArrowLeft",VF="ArrowRight",WF=500,ap="next",Mf="prev",Hf="left",Fv="right",XF=`slide${Tc}`,g_=`slid${Tc}`,YF=`keydown${Tc}`,qF=`mouseenter${Tc}`,KF=`mouseleave${Tc}`,ZF=`dragstart${Tc}`,QF=`load${Tc}${FR}`,JF=`click${Tc}${FR}`,PR="carousel",Rg="active",tP="slide",eP="carousel-item-end",nP="carousel-item-start",iP="carousel-item-next",rP="carousel-item-prev",BR=".active",jR=".carousel-item",sP=BR+jR,aP=".carousel-item img",oP=".carousel-indicators",lP="[data-bs-slide], [data-bs-slide-to]",cP='[data-bs-ride="carousel"]',uP={[GF]:Fv,[VF]:Hf},fP={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},dP={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class C0 extends Fa{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Oe.findOne(oP,this._element),this._addEventListeners(),this._config.ride===PR&&this.cycle()}static get Default(){return fP}static get DefaultType(){return dP}static get NAME(){return HF}next(){this._slide(ap)}nextWhenVisible(){!document.hidden&&Sd(this._element)&&this.next()}prev(){this._slide(Mf)}pause(){this._isSliding&&bR(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Jt.one(this._element,g_,()=>this.cycle());return}this.cycle()}}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding){Jt.one(this._element,g_,()=>this.to(t));return}const i=this._getItemIndex(this._getActive());if(i===t)return;const r=t>i?ap:Mf;this._slide(r,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&Jt.on(this._element,YF,t=>this._keydown(t)),this._config.pause==="hover"&&(Jt.on(this._element,qF,()=>this.pause()),Jt.on(this._element,KF,()=>this._maybeEnableCycle())),this._config.touch&&Yv.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const i of Oe.find(aP,this._element))Jt.on(i,ZF,r=>r.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(Hf)),rightCallback:()=>this._slide(this._directionToOrder(Fv)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),WF+this._config.interval))}};this._swipeHelper=new Yv(this._element,e)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=uP[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=Oe.findOne(BR,this._indicatorsElement);e.classList.remove(Rg),e.removeAttribute("aria-current");const i=Oe.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);i&&(i.classList.add(Rg),i.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),r=t===ap,s=e||e2(this._getItems(),i,r,this._config.wrap);if(s===i)return;const a=this._getItemIndex(s),l=g=>Jt.trigger(this._element,g,{relatedTarget:s,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:a});if(l(XF).defaultPrevented||!i||!s)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(a),this._activeElement=s;const d=r?nP:eP,p=r?iP:rP;s.classList.add(p),S0(s),i.classList.add(d),s.classList.add(d);const m=()=>{s.classList.remove(d,p),s.classList.add(Rg),i.classList.remove(Rg,p,d),this._isSliding=!1,l(g_)};this._queueCallback(m,i,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(tP)}_getActive(){return Oe.findOne(sP,this._element)}_getItems(){return Oe.find(jR,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return ca()?t===Hf?Mf:ap:t===Hf?ap:Mf}_orderToDirection(t){return ca()?t===Mf?Hf:Fv:t===Mf?Fv:Hf}static jQueryInterface(t){return this.each(function(){const e=C0.getOrCreateInstance(this,t);if(typeof t=="number"){e.to(t);return}if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(document,JF,lP,function(n){const t=Oe.getElementFromSelector(this);if(!t||!t.classList.contains(PR))return;n.preventDefault();const e=C0.getOrCreateInstance(t),i=this.getAttribute("data-bs-slide-to");if(i){e.to(i),e._maybeEnableCycle();return}if(hl.getDataAttribute(this,"slide")==="next"){e.next(),e._maybeEnableCycle();return}e.prev(),e._maybeEnableCycle()});Jt.on(window,QF,()=>{const n=Oe.find(cP);for(const t of n)C0.getOrCreateInstance(t)});da(C0);const hP="collapse",pP="bs.collapse",D0=`.${pP}`,mP=".data-api",gP=`show${D0}`,vP=`shown${D0}`,xP=`hide${D0}`,yP=`hidden${D0}`,_P=`click${D0}${mP}`,v_="show",Xf="collapse",Ng="collapsing",bP="collapsed",wP=`:scope .${Xf} .${Xf}`,EP="collapse-horizontal",AP="width",SP="height",TP=".collapse.show, .collapse.collapsing",Nw='[data-bs-toggle="collapse"]',CP={parent:null,toggle:!0},DP={parent:"(null|element)",toggle:"boolean"};let UR=class Lw extends Fa{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const i=Oe.find(Nw);for(const r of i){const s=Oe.getSelectorFromElement(r),a=Oe.find(s).filter(l=>l===this._element);s!==null&&a.length&&this._triggerArray.push(r)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return CP}static get DefaultType(){return DP}static get NAME(){return hP}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(TP).filter(l=>l!==this._element).map(l=>Lw.getOrCreateInstance(l,{toggle:!1}))),t.length&&t[0]._isTransitioning||Jt.trigger(this._element,gP).defaultPrevented)return;for(const l of t)l.hide();const i=this._getDimension();this._element.classList.remove(Xf),this._element.classList.add(Ng),this._element.style[i]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const r=()=>{this._isTransitioning=!1,this._element.classList.remove(Ng),this._element.classList.add(Xf,v_),this._element.style[i]="",Jt.trigger(this._element,vP)},a=`scroll${i[0].toUpperCase()+i.slice(1)}`;this._queueCallback(r,this._element,!0),this._element.style[i]=`${this._element[a]}px`}hide(){if(this._isTransitioning||!this._isShown()||Jt.trigger(this._element,xP).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,S0(this._element),this._element.classList.add(Ng),this._element.classList.remove(Xf,v_);for(const r of this._triggerArray){const s=Oe.getElementFromSelector(r);s&&!this._isShown(s)&&this._addAriaAndCollapsedClass([r],!1)}this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Ng),this._element.classList.add(Xf),Jt.trigger(this._element,yP)};this._element.style[e]="",this._queueCallback(i,this._element,!0)}_isShown(t=this._element){return t.classList.contains(v_)}_configAfterMerge(t){return t.toggle=!!t.toggle,t.parent=vc(t.parent),t}_getDimension(){return this._element.classList.contains(EP)?AP:SP}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(Nw);for(const e of t){const i=Oe.getElementFromSelector(e);i&&this._addAriaAndCollapsedClass([e],this._isShown(i))}}_getFirstLevelChildren(t){const e=Oe.find(wP,this._config.parent);return Oe.find(t,this._config.parent).filter(i=>!e.includes(i))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const i of t)i.classList.toggle(bP,!e),i.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return typeof t=="string"&&/show|hide/.test(t)&&(e.toggle=!1),this.each(function(){const i=Lw.getOrCreateInstance(this,e);if(typeof t=="string"){if(typeof i[t]>"u")throw new TypeError(`No method named "${t}"`);i[t]()}})}};Jt.on(document,_P,Nw,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const t of Oe.getMultipleElementsFromSelector(this))UR.getOrCreateInstance(t,{toggle:!1}).toggle()});da(UR);const NC="dropdown",OP="bs.dropdown",Fu=`.${OP}`,i2=".data-api",RP="Escape",LC="Tab",NP="ArrowUp",IC="ArrowDown",LP=2,IP=`hide${Fu}`,kP=`hidden${Fu}`,MP=`show${Fu}`,FP=`shown${Fu}`,zR=`click${Fu}${i2}`,HR=`keydown${Fu}${i2}`,PP=`keyup${Fu}${i2}`,$f="show",BP="dropup",jP="dropend",UP="dropstart",zP="dropup-center",HP="dropdown-center",fu='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',$P=`${fu}.${$f}`,Pv=".dropdown-menu",GP=".navbar",VP=".navbar-nav",WP=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",XP=ca()?"top-end":"top-start",YP=ca()?"top-start":"top-end",qP=ca()?"bottom-end":"bottom-start",KP=ca()?"bottom-start":"bottom-end",ZP=ca()?"left-start":"right-start",QP=ca()?"right-start":"left-start",JP="top",tB="bottom",eB={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},nB={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};let Cd=class Bv extends Fa{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=Oe.next(this._element,Pv)[0]||Oe.prev(this._element,Pv)[0]||Oe.findOne(Pv,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return eB}static get DefaultType(){return nB}static get NAME(){return NC}toggle(){return this._isShown()?this.hide():this.show()}show(){if(xc(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!Jt.trigger(this._element,MP,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(VP))for(const i of[].concat(...document.body.children))Jt.on(i,"mouseover",Xv);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add($f),this._element.classList.add($f),Jt.trigger(this._element,FP,t)}}hide(){if(xc(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!Jt.trigger(this._element,IP,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Jt.off(i,"mouseover",Xv);this._popper&&this._popper.destroy(),this._menu.classList.remove($f),this._element.classList.remove($f),this._element.setAttribute("aria-expanded","false"),hl.removeDataAttribute(this._menu,"popper"),Jt.trigger(this._element,kP,t),this._element.focus()}}_getConfig(t){if(t=super._getConfig(t),typeof t.reference=="object"&&!dl(t.reference)&&typeof t.reference.getBoundingClientRect!="function")throw new TypeError(`${NC.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(typeof QE>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let t=this._element;this._config.reference==="parent"?t=this._parent:dl(this._config.reference)?t=vc(this._config.reference):typeof this._config.reference=="object"&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=ZE(t,this._menu,e)}_isShown(){return this._menu.classList.contains($f)}_getPlacement(){const t=this._parent;if(t.classList.contains(jP))return ZP;if(t.classList.contains(UP))return QP;if(t.classList.contains(zP))return JP;if(t.classList.contains(HP))return tB;const e=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return t.classList.contains(BP)?e?YP:XP:e?KP:qP}_detectNavbar(){return this._element.closest(GP)!==null}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(hl.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...fs(this._config.popperConfig,[void 0,t])}}_selectMenuItem({key:t,target:e}){const i=Oe.find(WP,this._menu).filter(r=>Sd(r));i.length&&e2(i,e,t===IC,!i.includes(e)).focus()}static jQueryInterface(t){return this.each(function(){const e=Bv.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(t){if(t.button===LP||t.type==="keyup"&&t.key!==LC)return;const e=Oe.find($P);for(const i of e){const r=Bv.getInstance(i);if(!r||r._config.autoClose===!1)continue;const s=t.composedPath(),a=s.includes(r._menu);if(s.includes(r._element)||r._config.autoClose==="inside"&&!a||r._config.autoClose==="outside"&&a||r._menu.contains(t.target)&&(t.type==="keyup"&&t.key===LC||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const l={relatedTarget:r._element};t.type==="click"&&(l.clickEvent=t),r._completeHide(l)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),i=t.key===RP,r=[NP,IC].includes(t.key);if(!r&&!i||e&&!i)return;t.preventDefault();const s=this.matches(fu)?this:Oe.prev(this,fu)[0]||Oe.next(this,fu)[0]||Oe.findOne(fu,t.delegateTarget.parentNode),a=Bv.getOrCreateInstance(s);if(r){t.stopPropagation(),a.show(),a._selectMenuItem(t);return}a._isShown()&&(t.stopPropagation(),a.hide(),s.focus())}};Jt.on(document,HR,fu,Cd.dataApiKeydownHandler);Jt.on(document,HR,Pv,Cd.dataApiKeydownHandler);Jt.on(document,zR,Cd.clearMenus);Jt.on(document,PP,Cd.clearMenus);Jt.on(document,zR,fu,function(n){n.preventDefault(),Cd.getOrCreateInstance(this).toggle()});da(Cd);const $R="backdrop",iB="fade",kC="show",MC=`mousedown.bs.${$R}`,rB={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},sB={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class GR extends T0{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return rB}static get DefaultType(){return sB}static get NAME(){return $R}show(t){if(!this._config.isVisible){fs(t);return}this._append();const e=this._getElement();this._config.isAnimated&&S0(e),e.classList.add(kC),this._emulateAnimation(()=>{fs(t)})}hide(t){if(!this._config.isVisible){fs(t);return}this._getElement().classList.remove(kC),this._emulateAnimation(()=>{this.dispose(),fs(t)})}dispose(){this._isAppended&&(Jt.off(this._element,MC),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add(iB),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=vc(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),Jt.on(t,MC,()=>{fs(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(t){AR(t,this._getElement(),this._config.isAnimated)}}const aB="focustrap",oB="bs.focustrap",qv=`.${oB}`,lB=`focusin${qv}`,cB=`keydown.tab${qv}`,uB="Tab",fB="forward",FC="backward",dB={autofocus:!0,trapElement:null},hB={autofocus:"boolean",trapElement:"element"};class VR extends T0{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return dB}static get DefaultType(){return hB}static get NAME(){return aB}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Jt.off(document,qv),Jt.on(document,lB,t=>this._handleFocusin(t)),Jt.on(document,cB,t=>this._handleKeydown(t)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Jt.off(document,qv))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const i=Oe.focusableChildren(e);i.length===0?e.focus():this._lastTabNavDirection===FC?i[i.length-1].focus():i[0].focus()}_handleKeydown(t){t.key===uB&&(this._lastTabNavDirection=t.shiftKey?FC:fB)}}const PC=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",BC=".sticky-top",Lg="padding-right",jC="margin-right";class Iw{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Lg,e=>e+t),this._setElementAttributes(PC,Lg,e=>e+t),this._setElementAttributes(BC,jC,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Lg),this._resetElementAttributes(PC,Lg),this._resetElementAttributes(BC,jC)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const r=this.getWidth(),s=a=>{if(a!==this._element&&window.innerWidth>a.clientWidth+r)return;this._saveInitialAttribute(a,e);const l=window.getComputedStyle(a).getPropertyValue(e);a.style.setProperty(e,`${i(Number.parseFloat(l))}px`)};this._applyManipulationCallback(t,s)}_saveInitialAttribute(t,e){const i=t.style.getPropertyValue(e);i&&hl.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){const i=r=>{const s=hl.getDataAttribute(r,e);if(s===null){r.style.removeProperty(e);return}hl.removeDataAttribute(r,e),r.style.setProperty(e,s)};this._applyManipulationCallback(t,i)}_applyManipulationCallback(t,e){if(dl(t)){e(t);return}for(const i of Oe.find(t,this._element))e(i)}}const pB="modal",mB="bs.modal",ua=`.${mB}`,gB=".data-api",vB="Escape",xB=`hide${ua}`,yB=`hidePrevented${ua}`,WR=`hidden${ua}`,XR=`show${ua}`,_B=`shown${ua}`,bB=`resize${ua}`,wB=`click.dismiss${ua}`,EB=`mousedown.dismiss${ua}`,AB=`keydown.dismiss${ua}`,SB=`click${ua}${gB}`,UC="modal-open",TB="fade",zC="show",x_="modal-static",CB=".modal.show",DB=".modal-dialog",OB=".modal-body",RB='[data-bs-toggle="modal"]',NB={backdrop:!0,focus:!0,keyboard:!0},LB={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};let Yp=class YR extends Fa{constructor(t,e){super(t,e),this._dialog=Oe.findOne(DB,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Iw,this._addEventListeners()}static get Default(){return NB}static get DefaultType(){return LB}static get NAME(){return pB}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||Jt.trigger(this._element,XR,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(UC),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){!this._isShown||this._isTransitioning||Jt.trigger(this._element,xB).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(zC),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Jt.off(window,ua),Jt.off(this._dialog,ua),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new GR({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new VR({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=Oe.findOne(OB,this._dialog);e&&(e.scrollTop=0),S0(this._element),this._element.classList.add(zC);const i=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Jt.trigger(this._element,_B,{relatedTarget:t})};this._queueCallback(i,this._dialog,this._isAnimated())}_addEventListeners(){Jt.on(this._element,AB,t=>{if(t.key===vB){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Jt.on(window,bB,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Jt.on(this._element,EB,t=>{Jt.one(this._element,wB,e=>{if(!(this._element!==t.target||this._element!==e.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(UC),this._resetAdjustments(),this._scrollBar.reset(),Jt.trigger(this._element,WR)})}_isAnimated(){return this._element.classList.contains(TB)}_triggerBackdropTransition(){if(Jt.trigger(this._element,yB).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,i=this._element.style.overflowY;i==="hidden"||this._element.classList.contains(x_)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(x_),this._queueCallback(()=>{this._element.classList.remove(x_),this._queueCallback(()=>{this._element.style.overflowY=i},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;if(i&&!t){const r=ca()?"paddingLeft":"paddingRight";this._element.style[r]=`${e}px`}if(!i&&t){const r=ca()?"paddingRight":"paddingLeft";this._element.style[r]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each(function(){const i=YR.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof i[t]>"u")throw new TypeError(`No method named "${t}"`);i[t](e)}})}};Jt.on(document,SB,RB,function(n){const t=Oe.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Jt.one(t,XR,r=>{r.defaultPrevented||Jt.one(t,WR,()=>{Sd(this)&&this.focus()})});const e=Oe.findOne(CB);e&&Yp.getInstance(e).hide(),Yp.getOrCreateInstance(t).toggle(this)});W1(Yp);da(Yp);const IB="offcanvas",kB="bs.offcanvas",Sl=`.${kB}`,qR=".data-api",MB=`load${Sl}${qR}`,FB="Escape",HC="show",$C="showing",GC="hiding",PB="offcanvas-backdrop",KR=".offcanvas.show",BB=`show${Sl}`,jB=`shown${Sl}`,UB=`hide${Sl}`,VC=`hidePrevented${Sl}`,ZR=`hidden${Sl}`,zB=`resize${Sl}`,HB=`click${Sl}${qR}`,$B=`keydown.dismiss${Sl}`,GB='[data-bs-toggle="offcanvas"]',VB={backdrop:!0,keyboard:!0,scroll:!1},WB={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};let hd=class QR extends Fa{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return VB}static get DefaultType(){return WB}static get NAME(){return IB}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||Jt.trigger(this._element,BB,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Iw().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add($C);const i=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(HC),this._element.classList.remove($C),Jt.trigger(this._element,jB,{relatedTarget:t})};this._queueCallback(i,this._element,!0)}hide(){if(!this._isShown||Jt.trigger(this._element,UB).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(GC),this._backdrop.hide();const e=()=>{this._element.classList.remove(HC,GC),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Iw().reset(),Jt.trigger(this._element,ZR)};this._queueCallback(e,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=()=>{if(this._config.backdrop==="static"){Jt.trigger(this._element,VC);return}this.hide()},e=!!this._config.backdrop;return new GR({className:PB,isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?t:null})}_initializeFocusTrap(){return new VR({trapElement:this._element})}_addEventListeners(){Jt.on(this._element,$B,t=>{if(t.key===FB){if(this._config.keyboard){this.hide();return}Jt.trigger(this._element,VC)}})}static jQueryInterface(t){return this.each(function(){const e=QR.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}};Jt.on(document,HB,GB,function(n){const t=Oe.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),xc(this))return;Jt.one(t,ZR,()=>{Sd(this)&&this.focus()});const e=Oe.findOne(KR);e&&e!==t&&hd.getInstance(e).hide(),hd.getOrCreateInstance(t).toggle(this)});Jt.on(window,MB,()=>{for(const n of Oe.find(KR))hd.getOrCreateInstance(n).show()});Jt.on(window,zB,()=>{for(const n of Oe.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&hd.getOrCreateInstance(n).hide()});W1(hd);da(hd);const XB=/^aria-[\w-]*$/i,JR={"*":["class","dir","id","lang","role",XB],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},YB=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),qB=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,KB=(n,t)=>{const e=n.nodeName.toLowerCase();return t.includes(e)?YB.has(e)?!!qB.test(n.nodeValue):!0:t.filter(i=>i instanceof RegExp).some(i=>i.test(e))};function ZB(n,t,e){if(!n.length)return n;if(e&&typeof e=="function")return e(n);const r=new window.DOMParser().parseFromString(n,"text/html"),s=[].concat(...r.body.querySelectorAll("*"));for(const a of s){const l=a.nodeName.toLowerCase();if(!Object.keys(t).includes(l)){a.remove();continue}const u=[].concat(...a.attributes),f=[].concat(t["*"]||[],t[l]||[]);for(const d of u)KB(d,f)||a.removeAttribute(d.nodeName)}return r.body.innerHTML}const QB="TemplateFactory",JB={allowList:JR,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},t7={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},e7={entry:"(string|element|function|null)",selector:"(string|element)"};class n7 extends T0{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return JB}static get DefaultType(){return t7}static get NAME(){return QB}getContent(){return Object.values(this._config.content).map(t=>this._resolvePossibleFunction(t)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[r,s]of Object.entries(this._config.content))this._setContent(t,s,r);const e=t.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&e.classList.add(...i.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,i]of Object.entries(t))super._typeCheckConfig({selector:e,entry:i},e7)}_setContent(t,e,i){const r=Oe.findOne(i,t);if(r){if(e=this._resolvePossibleFunction(e),!e){r.remove();return}if(dl(e)){this._putElementInTemplate(vc(e),r);return}if(this._config.html){r.innerHTML=this._maybeSanitize(e);return}r.textContent=e}}_maybeSanitize(t){return this._config.sanitize?ZB(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return fs(t,[void 0,this])}_putElementInTemplate(t,e){if(this._config.html){e.innerHTML="",e.append(t);return}e.textContent=t.textContent}}const i7="tooltip",r7=new Set(["sanitize","allowList","sanitizeFn"]),y_="fade",s7="modal",Ig="show",a7=".tooltip-inner",WC=`.${s7}`,XC="hide.bs.modal",op="hover",__="focus",b_="click",o7="manual",l7="hide",c7="hidden",u7="show",f7="shown",d7="inserted",h7="click",p7="focusin",m7="focusout",g7="mouseenter",v7="mouseleave",x7={AUTO:"auto",TOP:"top",RIGHT:ca()?"left":"right",BOTTOM:"bottom",LEFT:ca()?"right":"left"},y7={allowList:JR,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},_7={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};let yc=class tN extends Fa{constructor(t,e){if(typeof QE>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return y7}static get DefaultType(){return _7}static get NAME(){return i7}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Jt.off(this._element.closest(WC),XC,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const t=Jt.trigger(this._element,this.constructor.eventName(u7)),i=(wR(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!i)return;this._disposePopper();const r=this._getTipElement();this._element.setAttribute("aria-describedby",r.getAttribute("id"));const{container:s}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(s.append(r),Jt.trigger(this._element,this.constructor.eventName(d7))),this._popper=this._createPopper(r),r.classList.add(Ig),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))Jt.on(l,"mouseover",Xv);const a=()=>{Jt.trigger(this._element,this.constructor.eventName(f7)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(a,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Jt.trigger(this._element,this.constructor.eventName(l7)).defaultPrevented)return;if(this._getTipElement().classList.remove(Ig),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))Jt.off(r,"mouseover",Xv);this._activeTrigger[b_]=!1,this._activeTrigger[__]=!1,this._activeTrigger[op]=!1,this._isHovered=null;const i=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Jt.trigger(this._element,this.constructor.eventName(c7)))};this._queueCallback(i,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(y_,Ig),e.classList.add(`bs-${this.constructor.NAME}-auto`);const i=oF(this.constructor.NAME).toString();return e.setAttribute("id",i),this._isAnimated()&&e.classList.add(y_),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new n7({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[a7]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(y_)}_isShown(){return this.tip&&this.tip.classList.contains(Ig)}_createPopper(t){const e=fs(this._config.placement,[this,t,this._element]),i=x7[e.toUpperCase()];return ZE(this._element,t,this._getPopperConfig(i))}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_resolvePossibleFunction(t){return fs(t,[this._element,this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:i=>{this._getTipElement().setAttribute("data-popper-placement",i.state.placement)}}]};return{...e,...fs(this._config.popperConfig,[void 0,e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if(e==="click")Jt.on(this._element,this.constructor.eventName(h7),this._config.selector,i=>{const r=this._initializeOnDelegatedTarget(i);r._activeTrigger[b_]=!(r._isShown()&&r._activeTrigger[b_]),r.toggle()});else if(e!==o7){const i=e===op?this.constructor.eventName(g7):this.constructor.eventName(p7),r=e===op?this.constructor.eventName(v7):this.constructor.eventName(m7);Jt.on(this._element,i,this._config.selector,s=>{const a=this._initializeOnDelegatedTarget(s);a._activeTrigger[s.type==="focusin"?__:op]=!0,a._enter()}),Jt.on(this._element,r,this._config.selector,s=>{const a=this._initializeOnDelegatedTarget(s);a._activeTrigger[s.type==="focusout"?__:op]=a._element.contains(s.relatedTarget),a._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Jt.on(this._element.closest(WC),XC,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=hl.getDataAttributes(this._element);for(const i of Object.keys(e))r7.has(i)&&delete e[i];return t={...e,...typeof t=="object"&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=t.container===!1?document.body:vc(t.container),typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),typeof t.title=="number"&&(t.title=t.title.toString()),typeof t.content=="number"&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,i]of Object.entries(this._config))this.constructor.Default[e]!==i&&(t[e]=i);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){const e=tN.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}};da(yc);const b7="popover",w7=".popover-header",E7=".popover-body",A7={...yc.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},S7={...yc.DefaultType,content:"(null|string|element|function)"};let T7=class eN extends yc{static get Default(){return A7}static get DefaultType(){return S7}static get NAME(){return b7}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[w7]:this._getTitle(),[E7]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){const e=eN.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}};da(T7);const C7="scrollspy",D7="bs.scrollspy",r2=`.${D7}`,O7=".data-api",R7=`activate${r2}`,YC=`click${r2}`,N7=`load${r2}${O7}`,L7="dropdown-item",Ff="active",I7='[data-bs-spy="scroll"]',w_="[href]",k7=".nav, .list-group",qC=".nav-link",M7=".nav-item",F7=".list-group-item",P7=`${qC}, ${M7} > ${qC}, ${F7}`,B7=".dropdown",j7=".dropdown-toggle",U7={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},z7={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class X1 extends Fa{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return U7}static get DefaultType(){return z7}static get NAME(){return C7}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=vc(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,typeof t.threshold=="string"&&(t.threshold=t.threshold.split(",").map(e=>Number.parseFloat(e))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Jt.off(this._config.target,YC),Jt.on(this._config.target,YC,w_,t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const i=this._rootElement||window,r=e.offsetTop-this._element.offsetTop;if(i.scrollTo){i.scrollTo({top:r,behavior:"smooth"});return}i.scrollTop=r}}))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),t)}_observerCallback(t){const e=a=>this._targetLinks.get(`#${a.target.id}`),i=a=>{this._previousScrollData.visibleEntryTop=a.target.offsetTop,this._process(e(a))},r=(this._rootElement||document.documentElement).scrollTop,s=r>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=r;for(const a of t){if(!a.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(a));continue}const l=a.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&l){if(i(a),!r)return;continue}!s&&!l&&i(a)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=Oe.find(w_,this._config.target);for(const e of t){if(!e.hash||xc(e))continue;const i=Oe.findOne(decodeURI(e.hash),this._element);Sd(i)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,i))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(Ff),this._activateParents(t),Jt.trigger(this._element,R7,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains(L7)){Oe.findOne(j7,t.closest(B7)).classList.add(Ff);return}for(const e of Oe.parents(t,k7))for(const i of Oe.prev(e,P7))i.classList.add(Ff)}_clearActiveClass(t){t.classList.remove(Ff);const e=Oe.find(`${w_}.${Ff}`,t);for(const i of e)i.classList.remove(Ff)}static jQueryInterface(t){return this.each(function(){const e=X1.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(window,N7,()=>{for(const n of Oe.find(I7))X1.getOrCreateInstance(n)});da(X1);const H7="tab",$7="bs.tab",Pu=`.${$7}`,G7=`hide${Pu}`,V7=`hidden${Pu}`,W7=`show${Pu}`,X7=`shown${Pu}`,Y7=`click${Pu}`,q7=`keydown${Pu}`,K7=`load${Pu}`,Z7="ArrowLeft",KC="ArrowRight",Q7="ArrowUp",ZC="ArrowDown",E_="Home",QC="End",du="active",JC="fade",A_="show",J7="dropdown",nN=".dropdown-toggle",t9=".dropdown-menu",S_=`:not(${nN})`,e9='.list-group, .nav, [role="tablist"]',n9=".nav-item, .list-group-item",i9=`.nav-link${S_}, .list-group-item${S_}, [role="tab"]${S_}`,iN='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',T_=`${i9}, ${iN}`,r9=`.${du}[data-bs-toggle="tab"], .${du}[data-bs-toggle="pill"], .${du}[data-bs-toggle="list"]`;class pd extends Fa{constructor(t){super(t),this._parent=this._element.closest(e9),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Jt.on(this._element,q7,e=>this._keydown(e)))}static get NAME(){return H7}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),i=e?Jt.trigger(e,G7,{relatedTarget:t}):null;Jt.trigger(t,W7,{relatedTarget:e}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){if(!t)return;t.classList.add(du),this._activate(Oe.getElementFromSelector(t));const i=()=>{if(t.getAttribute("role")!=="tab"){t.classList.add(A_);return}t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),Jt.trigger(t,X7,{relatedTarget:e})};this._queueCallback(i,t,t.classList.contains(JC))}_deactivate(t,e){if(!t)return;t.classList.remove(du),t.blur(),this._deactivate(Oe.getElementFromSelector(t));const i=()=>{if(t.getAttribute("role")!=="tab"){t.classList.remove(A_);return}t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),Jt.trigger(t,V7,{relatedTarget:e})};this._queueCallback(i,t,t.classList.contains(JC))}_keydown(t){if(![Z7,KC,Q7,ZC,E_,QC].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=this._getChildren().filter(r=>!xc(r));let i;if([E_,QC].includes(t.key))i=e[t.key===E_?0:e.length-1];else{const r=[KC,ZC].includes(t.key);i=e2(e,t.target,r,!0)}i&&(i.focus({preventScroll:!0}),pd.getOrCreateInstance(i).show())}_getChildren(){return Oe.find(T_,this._parent)}_getActiveElem(){return this._getChildren().find(t=>this._elemIsActive(t))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const i of e)this._setInitialAttributesOnChild(i)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),i=this._getOuterElement(t);t.setAttribute("aria-selected",e),i!==t&&this._setAttributeIfNotExists(i,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=Oe.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const i=this._getOuterElement(t);if(!i.classList.contains(J7))return;const r=(s,a)=>{const l=Oe.findOne(s,i);l&&l.classList.toggle(a,e)};r(nN,du),r(t9,A_),i.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,i){t.hasAttribute(e)||t.setAttribute(e,i)}_elemIsActive(t){return t.classList.contains(du)}_getInnerElement(t){return t.matches(T_)?t:Oe.findOne(T_,t)}_getOuterElement(t){return t.closest(n9)||t}static jQueryInterface(t){return this.each(function(){const e=pd.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(document,Y7,iN,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!xc(this)&&pd.getOrCreateInstance(this).show()});Jt.on(window,K7,()=>{for(const n of Oe.find(r9))pd.getOrCreateInstance(n)});da(pd);const s9="toast",a9="bs.toast",Cc=`.${a9}`,o9=`mouseover${Cc}`,l9=`mouseout${Cc}`,c9=`focusin${Cc}`,u9=`focusout${Cc}`,f9=`hide${Cc}`,d9=`hidden${Cc}`,h9=`show${Cc}`,p9=`shown${Cc}`,m9="fade",tD="hide",kg="show",Mg="showing",g9={animation:"boolean",autohide:"boolean",delay:"number"},v9={animation:!0,autohide:!0,delay:5e3};class Y1 extends Fa{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return v9}static get DefaultType(){return g9}static get NAME(){return s9}show(){if(Jt.trigger(this._element,h9).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(m9);const e=()=>{this._element.classList.remove(Mg),Jt.trigger(this._element,p9),this._maybeScheduleHide()};this._element.classList.remove(tD),S0(this._element),this._element.classList.add(kg,Mg),this._queueCallback(e,this._element,this._config.animation)}hide(){if(!this.isShown()||Jt.trigger(this._element,f9).defaultPrevented)return;const e=()=>{this._element.classList.add(tD),this._element.classList.remove(Mg,kg),Jt.trigger(this._element,d9)};this._element.classList.add(Mg),this._queueCallback(e,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(kg),super.dispose()}isShown(){return this._element.classList.contains(kg)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=e;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=e;break}}if(e){this._clearTimeout();return}const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){Jt.on(this._element,o9,t=>this._onInteraction(t,!0)),Jt.on(this._element,l9,t=>this._onInteraction(t,!1)),Jt.on(this._element,c9,t=>this._onInteraction(t,!0)),Jt.on(this._element,u9,t=>this._onInteraction(t,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const e=Y1.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}W1(Y1);da(Y1);const Pr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),kw=[.001,0,0,.001,0,0],C_=1.35,Ss={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},go={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},x9="pdfjs_internal_editor_",$e={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},sn={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},rN={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},mr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Pp={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},di={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Gf={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},O0={ERRORS:0,WARNINGS:1,INFOS:5},qp={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Fg={moveTo:0,lineTo:1,curveTo:2,closePath:3},sN={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let q1=O0.WARNINGS;function y9(n){Number.isInteger(n)&&(q1=n)}function _9(){return q1}function K1(n){q1>=O0.INFOS&&console.log(`Info: ${n}`)}function Ve(n){q1>=O0.WARNINGS&&console.log(`Warning: ${n}`)}function Pn(n){throw new Error(n)}function Ai(n,t){n||Pn(t)}function b9(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function s2(n,t=null,e=null){if(!n)return null;if(e&&typeof n=="string"&&(e.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),e.tryConvertEncoding))try{n=T9(n)}catch{}const i=t?URL.parse(n,t):URL.parse(n);return b9(i)?i:null}function a2(n,t,e=!1){const i=URL.parse(n);return i?(i.hash=t,i.href):e&&s2(n,"http://example.com")?n.split("#",1)[0]+`${t?`#${t}`:""}`:""}function rn(n,t,e,i=!1){return Object.defineProperty(n,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const Bu=function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class eD extends Bu{constructor(t,e){super(t,"PasswordException"),this.code=e}}class D_ extends Bu{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Kv extends Bu{constructor(t){super(t,"InvalidPDFException")}}class Kp extends Bu{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class w9 extends Bu{constructor(t){super(t,"FormatError")}}class yl extends Bu{constructor(t){super(t,"AbortException")}}function aN(n){(typeof n!="object"||n?.length===void 0)&&Pn("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const i=[];for(let r=0;r<t;r+=e){const s=Math.min(r+e,t),a=n.subarray(r,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function R0(n){typeof n!="string"&&Pn("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=n.charCodeAt(i)&255;return e}function E9(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function A9(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function S9(){try{return new Function(""),!0}catch{return!1}}class $i{static get isLittleEndian(){return rn(this,"isLittleEndian",A9())}static get isEvalSupported(){return rn(this,"isEvalSupported",S9())}static get isOffscreenCanvasSupported(){return rn(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return rn(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return rn(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return rn(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const O_=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class Ee{static makeHexColor(t,e,i){return`#${O_[t]}${O_[e]}${O_[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e,i=0){const r=t[i],s=t[i+1];t[i]=r*e[0]+s*e[2]+e[4],t[i+1]=r*e[1]+s*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const r=e[0],s=e[1],a=e[2],l=e[3],u=e[4],f=e[5];for(let d=0;d<6;d+=2){const p=t[i+d],m=t[i+d+1];t[i+d]=p*r+m*a+u,t[i+d+1]=p*s+m*l+f}}static applyInverseTransform(t,e){const i=t[0],r=t[1],s=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-r*e[2]+e[2]*e[5]-e[4]*e[3])/s,t[1]=(-i*e[1]+r*e[0]+e[4]*e[1]-e[5]*e[0])/s}static axialAlignedBoundingBox(t,e,i){const r=e[0],s=e[1],a=e[2],l=e[3],u=e[4],f=e[5],d=t[0],p=t[1],m=t[2],g=t[3];let y=r*d+u,x=y,_=r*m+u,b=_,S=l*p+f,A=S,C=l*g+f,O=C;if(s!==0||a!==0){const N=s*d,D=s*m,L=a*p,I=a*g;y+=L,b+=L,_+=I,x+=I,S+=N,O+=N,C+=D,A+=D}i[0]=Math.min(i[0],y,_,x,b),i[1]=Math.min(i[1],S,C,A,O),i[2]=Math.max(i[2],y,_,x,b),i[3]=Math.max(i[3],S,C,A,O)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],r=t[1],s=t[2],a=t[3],l=i**2+r**2,u=i*s+r*a,f=s**2+a**2,d=(l+f)/2,p=Math.sqrt(d**2-(l*f-u**2));e[0]=Math.sqrt(d+p||1),e[1]=Math.sqrt(d-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>r)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>a?null:[i,s,r,a]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,r,s){s[0]=Math.min(s[0],t,i),s[1]=Math.min(s[1],e,r),s[2]=Math.max(s[2],t,i),s[3]=Math.max(s[3],e,r)}static#t(t,e,i,r,s,a,l,u,f,d){if(f<=0||f>=1)return;const p=1-f,m=f*f,g=m*f,y=p*(p*(p*t+3*f*e)+3*m*i)+g*r,x=p*(p*(p*s+3*f*a)+3*m*l)+g*u;d[0]=Math.min(d[0],y),d[1]=Math.min(d[1],x),d[2]=Math.max(d[2],y),d[3]=Math.max(d[3],x)}static#e(t,e,i,r,s,a,l,u,f,d,p,m){if(Math.abs(f)<1e-12){Math.abs(d)>=1e-12&&this.#t(t,e,i,r,s,a,l,u,-p/d,m);return}const g=d**2-4*p*f;if(g<0)return;const y=Math.sqrt(g),x=2*f;this.#t(t,e,i,r,s,a,l,u,(-d+y)/x,m),this.#t(t,e,i,r,s,a,l,u,(-d-y)/x,m)}static bezierBoundingBox(t,e,i,r,s,a,l,u,f){f[0]=Math.min(f[0],t,l),f[1]=Math.min(f[1],e,u),f[2]=Math.max(f[2],t,l),f[3]=Math.max(f[3],e,u),this.#e(t,i,s,l,e,r,a,u,3*(-t+3*(i-s)+l),6*(t-2*i+s),3*(i-t),f),this.#e(t,i,s,l,e,r,a,u,3*(-e+3*(r-a)+u),6*(e-2*r+a),3*(r-e),f)}}function T9(n){return decodeURIComponent(escape(n))}let R_=null,nD=null;function oN(n){return R_||(R_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,nD=new Map([["ﬅ","ſt"]])),n.replaceAll(R_,(t,e,i)=>e?e.normalize("NFKC"):nD.get(i))}function o2(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),aN(n)}const l2="pdfjs_internal_id_";function C9(n,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,r,...s]=e;if(!n(i)&&!Number.isInteger(i)||!t(r))return!1;const a=s.length;let l=!0;switch(r.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const u of s)if(!(typeof u=="number"||l&&u===null))return!1;return!0}function vr(n,t,e){return Math.min(Math.max(n,t),e)}function lN(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(aN(n))}function D9(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):R0(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((t,e)=>t+e,0)});const nl="http://www.w3.org/2000/svg";class Eu{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Dd(n,t="text"){if(Tp(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class N0{constructor({viewBox:t,userUnit:e,scale:i,rotation:r,offsetX:s=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=r,this.offsetX=s,this.offsetY=a,i*=e;const u=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let d,p,m,g;switch(r%=360,r<0&&(r+=360),r){case 180:d=-1,p=0,m=0,g=1;break;case 90:d=0,p=1,m=1,g=0;break;case 270:d=0,p=-1,m=-1,g=0;break;case 0:d=1,p=0,m=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,g=-g);let y,x,_,b;d===0?(y=Math.abs(f-t[1])*i+s,x=Math.abs(u-t[0])*i+a,_=(t[3]-t[1])*i,b=(t[2]-t[0])*i):(y=Math.abs(u-t[0])*i+s,x=Math.abs(f-t[1])*i+a,_=(t[2]-t[0])*i,b=(t[3]-t[1])*i),this.transform=[d*i,p*i,m*i,g*i,y-d*i*u-m*i*f,x-p*i*u-g*i*f],this.width=_,this.height=b}get rawDims(){const t=this.viewBox;return rn(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:s=!1}={}){return new N0({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:r,dontFlip:s})}convertToViewportPoint(t,e){const i=[t,e];return Ee.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];Ee.applyTransform(e,this.transform);const i=[t[2],t[3]];return Ee.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return Ee.applyInverseTransform(i,this.transform),i}}class Z1 extends Bu{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function L0(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function Q1(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function cN(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function uN(n,t="document.pdf"){if(typeof n!="string")return t;if(L0(n))return Ve('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=e.exec(n);let s=i.exec(r[1])||i.exec(r[2])||i.exec(r[3]);if(s&&(s=s[0],s.includes("%")))try{s=i.exec(decodeURIComponent(s))[0]}catch{}return s||t}class iD{started=Object.create(null);times=[];time(t){t in this.started&&Ve(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Ve(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:r,end:s}of this.times)t.push(`${i.padEnd(e)} ${s-r}ms
`);return t.join("")}}function Tp(n,t){const e=t?URL.parse(n,t):URL.parse(n);return e?.protocol==="http:"||e?.protocol==="https:"}function fa(n){n.preventDefault()}function pi(n){n.preventDefault(),n.stopPropagation()}function O9(n){console.log("Deprecated API usage: "+n)}class c2{static#t;static toDateObject(t){if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let u=parseInt(e[6],10);u=u>=0&&u<=59?u:0;const f=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,f==="-"?(a+=d,l+=p):f==="+"&&(a-=d,l-=p),new Date(Date.UTC(i,r,s,a,l,u))}}function fN(n,{scale:t=1,rotation:e=0}){const{width:i,height:r}=n.attributes.style,s=[0,0,parseInt(i),parseInt(r)];return new N0({viewBox:s,userUnit:1,scale:t,rotation:e})}function u2(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Ve(`Not a valid color format: "${n}"`),[0,0,0])}function R9(n){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of n.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;n.set(e,u2(i))}t.remove()}function ei(n){const{a:t,b:e,c:i,d:r,e:s,f:a}=n.getTransform();return[t,e,i,r,s,a]}function ro(n){const{a:t,b:e,c:i,d:r,e:s,f:a}=n.getTransform().invertSelf();return[t,e,i,r,s,a]}function _c(n,t,e=!1,i=!0){if(t instanceof N0){const{pageWidth:r,pageHeight:s}=t.rawDims,{style:a}=n,l=$i.isCSSRoundSupported,u=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${s}px`,d=l?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,p=l?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(a.width=d,a.height=p):(a.width=p,a.height=d)}i&&n.setAttribute("data-main-rotation",t.rotation)}class Ma{constructor(){const{pixelRatio:t}=Ma;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,r,s=-1){let a=1/0,l=1/0,u=1/0;i=Ma.capPixels(i,s),i>0&&(a=Math.sqrt(i/(t*e))),r!==-1&&(l=r/t,u=r/e);const f=Math.min(a,l,u);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const Zv=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Bp{#t=null;#e=null;#n;#i=null;#s=null;#r=null;static#l=null;constructor(t){this.#n=t,Bp.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;t.addEventListener("contextmenu",fa,{signal:e}),t.addEventListener("pointerdown",Bp.#o,{signal:e});const i=this.#i=document.createElement("div");i.className="buttons",t.append(i);const r=this.#n.toolbarPosition;if(r){const{style:s}=t,a=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),t}get div(){return this.#t}static#o(t){t.stopPropagation()}#f(t){this.#n._focusEventsAllowed=!1,pi(t)}#c(t){this.#n._focusEventsAllowed=!0,pi(t)}#d(t){const e=this.#n._uiManager._signal;t.addEventListener("focusin",this.#f.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",fa,{signal:e})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown()}#u(){const{editorType:t,_uiManager:e}=this.#n,i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",Bp.#l[t]),this.#d(i),i.addEventListener("click",r=>{e.delete()},{signal:e._signal}),this.#i.append(i)}get#h(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#d(e),this.#i.prepend(e,this.#h),this.#s=t}addColorPicker(t){this.#e=t;const e=t.renderButton();this.#d(e),this.#i.prepend(e,this.#h)}async addEditSignatureButton(t){const e=this.#r=await t.renderEditButton(this.#n);this.#d(e),this.#i.prepend(e,this.#h)}updateEditSignatureButton(t){this.#r&&(this.#r.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class N9{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",fa,{signal:this.#n._signal});const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#r(),t}#s(t,e){let i=0,r=0;for(const s of t){const a=s.y+s.height;if(a<i)continue;const l=s.x+(e?s.width:0);if(a>i){r=l,i=a;continue}e?l>r&&(r=l):l<r&&(r=l)}return[e?1-r:r,i]}show(t,e,i){const[r,s]=this.#s(e,i),{style:a}=this.#e||=this.#i();t.append(this.#e),a.insetInlineEnd=`${100*r}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=this.#n._signal;t.addEventListener("contextmenu",fa,{signal:i}),t.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:i}),this.#t.append(t)}}function dN(n,t,e){for(const i of e)t.addEventListener(i,n[i].bind(n))}class L9{#t=0;get id(){return`${x9}${this.#t++}`}}class f2{#t=o2();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const s=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return rn(this,"_isSVGFittingCanvas",s)}async#i(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof e=="string"?(i.url=e,r=await Dd(e,"blob")):e instanceof File?r=i.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const s=f2._isSVGFittingCanvas,a=new FileReader,l=new Image,u=new Promise((f,d)=>{l.onload=()=>{i.bitmap=l,i.isSvg=!0,f()},a.onload=async()=>{const p=i.svgUrl=a.result;l.src=await s?`${p}#svgView(preserveAspectRatio(none))`:p},l.onerror=a.onerror=d});a.readAsDataURL(r),await u}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){Ve(r),i=null}return this.#n.set(t,i),i&&this.#n.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:r,type:s}=t;return this.#i(`${e}_${i}_${r}_${s}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const i=await e;return this.#i(t,i)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,i),this.#n.set(i.id,i),i}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=r.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class I9{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:i,mustExec:r,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(r&&t(),this.#e)return;const u={cmd:t,undo:e,post:i,type:s};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(u);return}if(a&&this.#t[this.#i].type===s){l&&(u.undo=this.#t[this.#i].undo),this.#t[this.#i]=u;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(u)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class I0{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=$i.platform;for(const[i,r,s={}]of t)for(const a of i){const l=a.startsWith("mac+");e&&l?(this.callbacks.set(a.slice(4),{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1))):!e&&!l&&(this.callbacks.set(a,{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:r,options:{bubbles:s=!1,args:a=[],checker:l=null}}=i;l&&!l(t,e)||(r.bind(t,...a,e)(),s||pi(e))}}class d2{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return R9(t),rn(this,"_colors",t)}convert(t){const e=u2(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,r]of this._colors)if(r.every((s,a)=>s===e[a]))return d2._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?Ee.makeHexColor(...e):t}}class _l{#t=new AbortController;#e=null;#n=new Map;#i=new Map;#s=null;#r=null;#l=null;#o=new I9;#f=null;#c=null;#d=0;#u=new Set;#h=null;#a=null;#p=new Set;_editorUndoBar=null;#g=!1;#m=!1;#v=!1;#x=null;#y=null;#b=null;#E=null;#S=!1;#C=null;#O=new L9;#w=!1;#D=!1;#T=null;#N=null;#L=null;#I=null;#U=null;#A=$e.NONE;#_=new Set;#P=null;#B=null;#$=null;#G=null;#V={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#k=null;#M=null;#H=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=_l.prototype,e=a=>a.#M.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:u}=l;return u!=="text"&&u!=="number"}return!0},r=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return rn(this,"_keyboardManager",new I0([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#M.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#M.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}constructor(t,e,i,r,s,a,l,u,f,d,p,m,g,y){const x=this._signal=this.#t.signal;this.#M=t,this.#H=e,this.#s=i,this.#B=r,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:x}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),s._on("setpreference",this.onSetPreference.bind(this),{signal:x}),s._on("switchannotationeditorparams",_=>this.updateParams(_.type,_.value),{signal:x}),this.#it(),this.#ot(),this.#K(),this.#r=a.annotationStorage,this.#x=a.filterFactory,this.#$=l,this.#E=u||null,this.#g=f,this.#m=d,this.#v=p,this.#U=m||null,this.viewParameters={realScale:Eu.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=y!==!1}destroy(){this.#F?.resolve(),this.#F=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#i.values())t.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#I?.clear(),this.#e=null,this.#_.clear(),this.#o.destroy(),this.#s?.destroy(),this.#B?.destroy(),this.#C?.hide(),this.#C=null,this.#L?.destroy(),this.#L=null,this.#y&&(clearTimeout(this.#y),this.#y=null),this.#k&&(clearTimeout(this.#k),this.#k=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#U}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return rn(this,"hcmFilter",this.#$?this.#x.addHCMFilter(this.#$.foreground,this.#$.background):"none")}get direction(){return rn(this,"direction",getComputedStyle(this.#M).direction)}get highlightColors(){return rn(this,"highlightColors",this.#E?new Map(this.#E.split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return rn(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#L=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}getSignature(t){this.#B?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#B}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=e;break}}onPageChanging({pageNumber:t}){this.#d=t-1}focusMainContainer(){this.#M.focus()}findParent(t,e){for(const i of this.#i.values()){const{x:r,y:s,width:a,height:l}=i.div.getBoundingClientRect();if(t>=r&&t<=r+a&&e>=s&&e<=s+l)return i}return null}disableUserSelect(t=!1){this.#H.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Eu.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#X({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#q(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#i.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a}=e,l=e.toString(),f=this.#X(e).closest(".textLayer"),d=this.getSelectionBoxes(f);if(!d)return;e.empty();const p=this.#q(f),m=this.#A===$e.NONE,g=()=>{p?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a,text:l}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode($e.HIGHLIGHT,g);return}g()}#et(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#X(t).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(this.#C||=new N9(this),this.#C.show(i,r,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}#nt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#P&&(this.#C?.hide(),this.#P=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#P)return;const r=this.#X(t).closest(".textLayer");if(!r){this.#P&&(this.#C?.hide(),this.#P=null,this.#R({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#P=e,this.#R({hasSelectedText:!0}),!(this.#A!==$e.HIGHLIGHT&&this.#A!==$e.NONE)&&(this.#A===$e.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const s=this.#A===$e.HIGHLIGHT?this.#q(r):null;s?.toggleDrawing();const a=new AbortController,l=this.combinedSignal(a),u=f=>{f.type==="pointerup"&&f.button!==0||(a.abort(),s?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",u,{signal:l}),window.addEventListener("blur",u,{signal:l})}}#Y(t=""){this.#A===$e.HIGHLIGHT?this.highlightSelection(t):this.#g&&this.#et()}#it(){document.addEventListener("selectionchange",this.#nt.bind(this),{signal:this._signal})}#rt(){if(this.#b)return;this.#b=new AbortController;const t=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#st(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#_)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#K(){if(this.#T)return;this.#T=new AbortController;const t=this.combinedSignal(this.#T);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#at(){this.#T?.abort(),this.#T=null}#Z(){if(this.#f)return;this.#f=new AbortController;const t=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#Q(){this.#f?.abort(),this.#f=null}#ot(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#K(),this.#Z()}removeEditListeners(){this.#at(),this.#Q()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#a)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#a)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#_){const r=i.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const a of this.#a)if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){Ve(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const s=[];for(const u of i){const f=await r.deserialize(u);if(!f)return;s.push(f)}const a=()=>{for(const u of s)this.#J(u);this.#tt(s)},l=()=>{for(const u of s)u.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(s){Ve(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==$e.NONE&&!this.isEditorHandlingKeyboard&&_l._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#R(t){Object.entries(t).some(([i,r])=>this.#V[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#V,t)}),this.#A===$e.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#j([[sn.HIGHLIGHT_FREE,!0]]))}#j(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#rt(),this.#Z(),this.#R({isEditing:this.#A!==$e.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#st(),this.#Q(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#a){this.#a=t;for(const e of this.#a)this.#j(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#i.get(this.#d)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#d}addLayer(t){this.#i.set(t.pageIndex,t),this.#w?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}async updateMode(t,e=null,i=!1){if(this.#A!==t&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#c?.commitOrRemove(),this.#A=t,t===$e.NONE){this.setEditingState(!1),this.#ct(),this._editorUndoBar?.hide(),this.#F.resolve();return}t===$e.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#lt(),this.unselectAll();for(const r of this.#i.values())r.updateMode(t);if(!e){i&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const r of this.#n.values())r.annotationElementId===e||r.id===e?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#a){switch(t){case sn.CREATE:this.currentLayer.addNewEditor(e);return;case sn.HIGHLIGHT_DEFAULT_COLOR:this.#L?.updateColor(e);break;case sn.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const i of this.#_)i.updateParams(t,e);for(const i of this.#a)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const s of this.#n.values())s.editorType===t&&s.show(e);(this.#G?.get(sn.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#j([[sn.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#D!==t){this.#D=t;for(const e of this.#i.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#lt(){if(!this.#w){this.#w=!0;const t=[];for(const e of this.#i.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#ct(){if(this.unselectAll(),this.#w){this.#w=!1;for(const t of this.#i.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const i of this.#n.values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.focusMainContainer(),this.#y=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#I?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#u.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#u.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#u.has(t)}removeDeletedAnnotationElement(t){this.#u.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#J(t){const e=this.#i.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#j(t.propertiesToUpdate))}get#ut(){let t=null;for(t of this.#_);return t}updateUI(t){this.#ut===t&&this.#j(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#j(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#_.has(t)){this.#_.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#_.add(t),t.select(),this.#j(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.#c?.commitOrRemove();for(const e of this.#_)e!==t&&e.unselect();this.#_.clear(),this.#_.add(t),t.select(),this.#j(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#_.has(t)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(t){t.unselect(),this.#_.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#R({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#o.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#o.cleanType(t)}#W(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#_],i=()=>{this._editorUndoBar?.show(r,e.length===1?e[0].editorType:e.length);for(const s of e)s.remove()},r=()=>{for(const s of e)this.#J(s)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#tt(t){for(const e of this.#_)e.unselect();this.#_.clear();for(const e of t)e.isEmpty()||(this.#_.add(e),e.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#_)t.commit();this.#tt(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#A!==$e.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const t of this.#_)t.unselect();this.#_.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=t,this.#z[1]+=e;const[r,s]=this.#z,a=[...this.#_],l=1e3;this.#k&&clearTimeout(this.#k),this.#k=setTimeout(()=>{this.#k=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const u of a)this.#n.has(u.id)&&(u.translateInPage(r,s),u.translationDone())},undo:()=>{for(const u of a)this.#n.has(u.id)&&(u.translateInPage(-r,-s),u.translationDone())},mustExec:!1})},l);for(const u of a)u.translateInPage(t,e),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#h=new Map;for(const t of this.#_)this.#h.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#h)return!1;this.disableUserSelect(!1);const t=this.#h;this.#h=null;let e=!1;for(const[{x:r,y:s,pageIndex:a},l]of t)l.newX=r,l.newY=s,l.newPageIndex=a,e||=r!==l.savedX||s!==l.savedY||a!==l.savedPageIndex;if(!e)return!1;const i=(r,s,a,l)=>{if(this.#n.has(r.id)){const u=this.#i.get(l);u?r._setParentAndPosition(u,s,a):(r.pageIndex=l,r.x=s,r.y=a)}};return this.addCommands({cmd:()=>{for(const[r,{newX:s,newY:a,newPageIndex:l}]of t)i(r,s,a,l)},undo:()=>{for(const[r,{savedX:s,savedY:a,savedPageIndex:l}]of t)i(r,s,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#h)for(const i of this.#h.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#A}get imageManager(){return rn(this,"imageManager",new f2)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,d=e.rangeCount;f<d;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:r,width:s,height:a}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(f,d,p,m)=>({x:(d-r)/a,y:1-(f+p-i)/s,width:m/a,height:p/s});break;case"180":l=(f,d,p,m)=>({x:1-(f+p-i)/s,y:1-(d+m-r)/a,width:p/s,height:m/a});break;case"270":l=(f,d,p,m)=>({x:1-(d+m-r)/a,y:(f-i)/s,width:m/a,height:p/s});break;default:l=(f,d,p,m)=>({x:(f-i)/s,y:(d-r)/a,width:p/s,height:m/a});break}const u=[];for(let f=0,d=e.rangeCount;f<d;f++){const p=e.getRangeAt(f);if(!p.collapsed)for(const{x:m,y:g,width:y,height:x}of p.getClientRects())y===0||x===0||u.push(l(m,g,y,x))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#l||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const e=this.#l?.get(t.data.id);if(!e)return;const i=this.#r.getRawValue(e);i&&(this.#A===$e.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const r=this.#I?.get(t);r&&(r.setCanvas(e,i),this.#I.delete(t))}addMissingCanvas(t,e){(this.#I||=new Map).set(t,e)}}class fo{#t=null;#e=!1;#n=null;#i=null;#s=null;#r=null;#l=!1;#o=null;#f=null;#c=null;#d=null;#u=!1;static#h=null;static _l10n=null;constructor(t){this.#f=t,this.#u=t._uiManager.useNewAltTextFlow,fo.#h||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){fo._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",fo.#h.missing),e.setAttribute("data-l10n-id",fo.#h["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#f._uiManager._signal;t.addEventListener("contextmenu",fa,{signal:i}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:i});const r=s=>{s.preventDefault(),this.#f._uiManager.editAltText(this.#f),this.#u&&this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return t.addEventListener("click",r,{capture:!0,signal:i}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(this.#l=!0,r(s))},{signal:i}),await this.#p(),t}get#a(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#d=await fo._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#f.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:r,cancel:s=!1}){i&&(this.#c=i,this.#d=r),!(this.#t===t&&this.#e===e)&&(s||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!t)}shown(){this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",fo.#h[this.#a]),this.#i?.setAttribute("data-l10n-id",fo.#h[`${this.#a}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#f.id}`;const r=100,s=this.#f._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#f._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:s}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:s})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#f.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class k0{#t;#e=!1;#n=null;#i;#s;#r;#l;#o=null;#f;#c=null;#d;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:s=null,onPinchEnd:a=null,signal:l}){this.#t=t,this.#n=i,this.#i=e,this.#s=r,this.#r=s,this.#l=a,this.#d=new AbortController,this.#f=AbortSignal.any([l,this.#d.signal]),t.addEventListener("touchstart",this.#h.bind(this),{passive:!1,signal:this.#f})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ma.pixelRatio}#h(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,s=AbortSignal.any([this.#f,r.signal]),a=this.#t,l={capture:!0,signal:s,passive:!1},u=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};a.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(pi(f),u(f))},l),a.addEventListener("pointerup",u,l),a.addEventListener("pointercancel",u,l);return}if(!this.#u){this.#u=new AbortController;const r=AbortSignal.any([this.#f,this.#u.signal]),s=this.#t,a={signal:r,capture:!1,passive:!1};s.addEventListener("touchmove",this.#a.bind(this),a);const l=this.#p.bind(this);s.addEventListener("touchend",l,a),s.addEventListener("touchcancel",l,a),a.capture=!0,s.addEventListener("pointerdown",pi,a),s.addEventListener("pointermove",pi,a),s.addEventListener("pointercancel",pi,a),s.addEventListener("pointerup",pi,a),this.#s?.()}if(pi(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#a(t){if(!this.#c||t.touches.length!==2)return;pi(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:r,screenY:s}=e,{screenX:a,screenY:l}=i,u=this.#c,{touch0X:f,touch0Y:d,touch1X:p,touch1Y:m}=u,g=p-f,y=m-d,x=a-r,_=l-s,b=Math.hypot(x,_)||1,S=Math.hypot(g,y)||1;if(!this.#e&&Math.abs(S-b)<=k0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=r,u.touch0Y=s,u.touch1X=a,u.touch1Y=l,!this.#e){this.#e=!0;return}const A=[(r+a)/2,(s+l)/2];this.#r?.(A,S,b)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#l?.()),this.#c&&(pi(t),this.#c=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Re{#t=null;#e=null;#n=null;#i=!1;#s=null;#r="";#l=!1;#o=null;#f=null;#c=null;#d=null;#u="";#h=!1;#a=null;#p=!1;#g=!1;#m=!1;#v=null;#x=0;#y=0;#b=null;#E=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#C=Re._zIndex++;static _borderLineWidth=-1;static _colorManager=new d2;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Re.prototype._resizeWithKeyboard,e=_l.TRANSLATE_SMALL,i=_l.TRANSLATE_BIG;return rn(this,"_resizerKeyboardManager",new I0([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Re.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:r,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[s,a];const[l,u]=this.parentDimensions;this.x=t.x/l,this.y=t.y/u,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return rn(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new k9({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Re._l10n??=t,Re._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Re._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Re._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Pn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#H(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#h?this.#h=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,r){const[s,a]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(t+i)/s,this.y=(e+r)/a,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,r]=this.parentDimensions;this.setAt(t*i,e*r,this.width*i,this.height*r),this._onTranslated()}#O([t,e],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#O(this.parentDimensions,t,e)}translateInPage(t,e){this.#a||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#a||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[r,s]}=this;if(this.x+=t/r,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[u,f]=this.getBaseTranslation();a+=u,l+=f;const{style:d}=i;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Re,r=i/t,s=i/e;switch(this.rotation){case 90:return[-r,s];case 180:return[r,s];case 270:return[r,-s];default:return[-r,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,r]}=this;let{x:s,y:a,width:l,height:u}=this;if(l*=i,u*=r,s*=i,a*=r,this._mustFixPosition)switch(t){case 0:s=vr(s,0,i-l),a=vr(a,0,r-u);break;case 90:s=vr(s,0,i-u),a=vr(a,l,r);break;case 180:s=vr(s,l,i),a=vr(a,u,r);break;case 270:s=vr(s,u,i),a=vr(a,0,r-l);break}this.x=s/=i,this.y=a/=r;const[f,d]=this.getBaseTranslation();s+=f,a+=d,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#w(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Re.#w(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Re.#w(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(t,e){const[i,r]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*t/i).toFixed(2)}%`,this.#l||(s.height=`${(100*e/r).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,r=i.endsWith("%"),s=!this.#l&&e.endsWith("%");if(r&&s)return;const[a,l]=this.parentDimensions;r||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!this.#l&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#T(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const r=document.createElement("div");this.#o.append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",this.#N.bind(this,i),{signal:e}),r.addEventListener("contextmenu",fa,{signal:e}),r.tabIndex=-1}this.div.prepend(this.#o)}#N(t,e){e.preventDefault();const{isMac:i}=$i.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#f=[e.screenX,e.screenY];const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#U.bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",pi,{passive:!1,signal:a}),window.addEventListener("contextmenu",fa,{signal:a}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const l=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=l,this.div.style.cursor=u,this.#I()};window.addEventListener("pointerup",f,{signal:a}),window.addEventListener("blur",f,{signal:a})}#L(t,e,i,r){this.width=i,this.height=r,this.x=t,this.y=e;const[s,a]=this.parentDimensions;this.setDims(s*i,a*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#I(){if(!this.#c)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:r}=this.#c;this.#c=null;const s=this.x,a=this.y,l=this.width,u=this.height;s===t&&a===e&&l===i&&u===r||this.addCommands({cmd:this.#L.bind(this,s,a,l,u),undo:this.#L.bind(this,t,e,i,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#U(t,e){const[i,r]=this.parentDimensions,s=this.x,a=this.y,l=this.width,u=this.height,f=Re.MIN_SIZE/i,d=Re.MIN_SIZE/r,p=this.#D(this.rotation),m=(K,q)=>[p[0]*K+p[2]*q,p[1]*K+p[3]*q],g=this.#D(360-this.rotation),y=(K,q)=>[g[0]*K+g[2]*q,g[1]*K+g[3]*q];let x,_,b=!1,S=!1;switch(t){case"topLeft":b=!0,x=(K,q)=>[0,0],_=(K,q)=>[K,q];break;case"topMiddle":x=(K,q)=>[K/2,0],_=(K,q)=>[K/2,q];break;case"topRight":b=!0,x=(K,q)=>[K,0],_=(K,q)=>[0,q];break;case"middleRight":S=!0,x=(K,q)=>[K,q/2],_=(K,q)=>[0,q/2];break;case"bottomRight":b=!0,x=(K,q)=>[K,q],_=(K,q)=>[0,0];break;case"bottomMiddle":x=(K,q)=>[K/2,q],_=(K,q)=>[K/2,0];break;case"bottomLeft":b=!0,x=(K,q)=>[0,q],_=(K,q)=>[K,0];break;case"middleLeft":S=!0,x=(K,q)=>[0,q/2],_=(K,q)=>[K,q/2];break}const A=x(l,u),C=_(l,u);let O=m(...C);const N=Re._round(s+O[0]),D=Re._round(a+O[1]);let L=1,I=1,z,j;if(e.fromKeyboard)({deltaX:z,deltaY:j}=e);else{const{screenX:K,screenY:q}=e,[_t,at]=this.#f;[z,j]=this.screenToPageTranslation(K-_t,q-at),this.#f[0]=K,this.#f[1]=q}if([z,j]=y(z/i,j/r),b){const K=Math.hypot(l,u);L=I=Math.max(Math.min(Math.hypot(C[0]-A[0]-z,C[1]-A[1]-j)/K,1/l,1/u),f/l,d/u)}else S?L=vr(Math.abs(C[0]-A[0]-z),f,1)/l:I=vr(Math.abs(C[1]-A[1]-j),d,1)/u;const B=Re._round(l*L),tt=Re._round(u*I);O=m(..._(B,tt));const k=N-O[0],et=D-O[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=B,this.height=tt,this.x=k,this.y=et,this.setDims(i*B,r*tt),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#g?this._editToolbar:(this._editToolbar=new Bp(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(fo.initialize(Re._l10n),this.#n=new fo(this),this.#t&&(this.#n.data=this.#t,this.#t=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#i?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#G();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[r,s]=this.getInitialTranslation();return this.translate(r,s),dN(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#E||=new k0({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#A.bind(this),onPinching:this.#_.bind(this),onPinchEnd:this.#P.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#A(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#_(t,e,i){let s=.7*(i/e)+1-.7;if(s===1)return;const a=this.#D(this.rotation),l=(N,D)=>[a[0]*N+a[2]*D,a[1]*N+a[3]*D],[u,f]=this.parentDimensions,d=this.x,p=this.y,m=this.width,g=this.height,y=Re.MIN_SIZE/u,x=Re.MIN_SIZE/f;s=Math.max(Math.min(s,1/m,1/g),y/m,x/g);const _=Re._round(m*s),b=Re._round(g*s);if(_===m&&b===g)return;this.#a||=[d,p,m,g];const S=l(m/2,g/2),A=Re._round(d+S[0]),C=Re._round(p+S[1]),O=l(_/2,b/2);this.x=A-O[0],this.y=C-O[1],this.width=_,this.height=b,this.setDims(u*_,f*b),this.fixAndSetPosition(),this._onResizing()}#P(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#I()}pointerdown(t){const{isMac:e}=$i.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#h=!0,this._isDraggable){this.#$(t);return}this.#B(t)}#B(t){const{isMac:e}=$i.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,s=this._uiManager.combinedSignal(r),a={capture:!0,passive:!1,signal:s},l=f=>{r.abort(),this.#s=null,this.#h=!1,this._uiManager.endDragSession()||this.#B(f),i&&this._onStopDragging()};e&&(this.#x=t.clientX,this.#y=t.clientY,this.#s=t.pointerId,this.#r=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._onStartDragging());const{clientX:d,clientY:p,pointerId:m}=f;if(m!==this.#s){pi(f);return}const[g,y]=this.screenToPageTranslation(d-this.#x,p-this.#y);this.#x=d,this.#y=p,this._uiManager.dragSelectedEditors(g,y)},a),window.addEventListener("touchmove",pi,a),window.addEventListener("pointerdown",f=>{f.pointerType===this.#r&&(this.#E||f.isPrimary)&&l(f),pi(f)},a));const u=f=>{if(!this.#s||this.#s===f.pointerId){l(f);return}pi(f)};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const r=this.parentScale,[s,a]=this.pageDimensions,[l,u]=this.pageTranslation,f=t/r,d=e/r,p=this.x*s,m=this.y*a,g=this.width*s,y=this.height*a;switch(i){case 0:return[p+f+l,a-m-d-y+u,p+f+g+l,a-m-d+u];case 90:return[p+d+l,a-m+f+u,p+d+y+l,a-m+f+g+u];case 180:return[p-f-g+l,a-m+d+u,p-f+l,a-m+d+y+u];case 270:return[p-d-y+l,a-m-f-g+u,p-d+l,a-m-f+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,r,s,a]=t,l=s-i,u=a-r;switch(this.rotation){case 0:return[i,e-a,l,u];case 90:return[i,e-r,u,l];case 180:return[s,e-r,l,u];case 270:return[s,e-a,u,l];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#g=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#g=!1,!0):!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#m}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return e<a&&r>0&&t<s&&i>0}#G(){if(this.#d||!this.div)return;this.#d=new AbortController;const t=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#G()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){Pn("An editor must be serializable")}static async deserialize(t,e,i){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[s,a]=r.pageDimensions,[l,u,f,d]=r.getRectInCurrentCoords(t.rect,a);return r.x=l/s,r.y=u/a,r.width=f/s,r.height=d/a,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#H(),this.removeEditToolbar(),this.#b){for(const t of this.#b.values())clearTimeout(t);this.#b=null}this.parent=null,this.#E?.destroy(),this.#E=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#T(),this.#o.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#o.children;if(!this.#e){this.#e=Array.from(e);const a=this.#V.bind(this),l=this.#z.bind(this),u=this._uiManager._signal;for(const f of this.#e){const d=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",a,{signal:u}),f.addEventListener("blur",l,{signal:u}),f.addEventListener("focus",this.#k.bind(this,d),{signal:u}),f.setAttribute("data-l10n-id",Re._l10nResizer[d])}}const i=this.#e[0];let r=0;for(const a of e){if(a===i)break;r++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(s!==r){if(s<r)for(let l=0;l<r-s;l++)this.#o.append(this.#o.firstChild);else if(s>r)for(let l=0;l<s-r;l++)this.#o.firstChild.before(this.#o.lastChild);let a=0;for(const l of e){const f=this.#e[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",Re._l10nResizer[f])}}this.#M(0),this.#m=!0,this.#o.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#V(t){Re._resizerKeyboardManager.exec(this,t)}#z(t){this.#m&&t.relatedTarget?.parentNode!==this.#o&&this.#H()}#k(t){this.#u=this.#m?t:""}#M(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#m&&this.#U(this.#u,{deltaX:t,deltaY:e,fromKeyboard:!0})}#H(){this.#m=!1,this.#M(-1),this.#I()}_stopResizingWithKeyboard(){this.#H(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#l=!0;const i=t/e,{style:r}=this.div;r.aspectRatio=i,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#b||=new Map;const{action:i}=t;let r=this.#b.get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#b.delete(i),this.#b.size===0&&(this.#b=null)},Re._telemetryTimeout),this.#b.set(i,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class k9 extends Re{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const rD=3285377520,Qs=4294901760,so=65535;class hN{constructor(t){this.h1=t?t&4294967295:rD,this.h2=t?t&4294967295:rD}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let x=0,_=t.length;x<_;x++){const b=t.charCodeAt(x);b<=255?e[i++]=b:(e[i++]=b>>>8,e[i++]=b&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,s=i-r*4,a=new Uint32Array(e.buffer,0,r);let l=0,u=0,f=this.h1,d=this.h2;const p=3432918353,m=461845907,g=p&so,y=m&so;for(let x=0;x<r;x++)x&1?(l=a[x],l=l*p&Qs|l*g&so,l=l<<15|l>>>17,l=l*m&Qs|l*y&so,f^=l,f=f<<13|f>>>19,f=f*5+3864292196):(u=a[x],u=u*p&Qs|u*g&so,u=u<<15|u>>>17,u=u*m&Qs|u*y&so,d^=u,d=d<<13|d>>>19,d=d*5+3864292196);switch(l=0,s){case 3:l^=e[r*4+2]<<16;case 2:l^=e[r*4+1]<<8;case 1:l^=e[r*4],l=l*p&Qs|l*g&so,l=l<<15|l>>>17,l=l*m&Qs|l*y&so,r&1?f^=l:d^=l}this.h1=f,this.h2=d}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Qs|t*36045&so,e=e*4283543511&Qs|((e<<16|t>>>16)*2950163797&Qs)>>>16,t^=e>>>1,t=t*444984403&Qs|t*60499&so,e=e*3301882366&Qs|((e<<16|t>>>16)*3120437893&Qs)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Mw=Object.freeze({map:null,hash:"",transfer:void 0});class h2{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#n.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof Re)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#n.get(t);let r=!1;if(i!==void 0)for(const[s,a]of Object.entries(e))i[s]!==a&&(r=!0,i[s]=a);else r=!0,this.#n.set(t,e);r&&this.#i(),e instanceof Re&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}get size(){return this.#n.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new pN(this)}get serializable(){if(this.#n.size===0)return Mw;const t=new Map,e=new hN,i=[],r=Object.create(null);let s=!1;for(const[a,l]of this.#n){const u=l instanceof Re?l.serialize(!1,r):l;u&&(t.set(a,u),e.update(`${a}:${JSON.stringify(u)}`),s||=!!u.bitmap)}if(s)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:Mw}get editorStats(){let t=null;const e=new Map;for(const i of this.#n.values()){if(!(i instanceof Re))continue;const r=i.telemetryFinalData;if(!r)continue;const{type:s}=r;e.has(s)||e.set(s,Object.getPrototypeOf(i).constructor),t||=Object.create(null);const a=t[s]||=new Map;for(const[l,u]of Object.entries(r)){if(l==="type")continue;let f=a.get(l);f||(f=new Map,a.set(l,f));const d=f.get(u)??0;f.set(u,d+1)}}for(const[i,r]of e)t[i]=r.computeTelemetryFinalData(t[i]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof Re)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class pN extends h2{#t;constructor(t){super();const{map:e,hash:i,transfer:r}=t.serializable,s=structuredClone(e,r?{transfer:r}:null);this.#t={map:s,hash:i,transfer:r}}get print(){Pn("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return rn(this,"modifiedIds",{ids:new Set,hash:""})}}class M9{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Ai(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:s,style:a}=t,l=new FontFace(r,s,a);this.addNativeFontFace(l);try{await l.load(),this.#t.add(r),i?.(t)}catch{Ve(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Pn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw Ve(`Failed to load font '${i.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return rn(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return rn(this,"isSyncFontLoadingSupported",Pr||$i.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Ai(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:e,callback:t};return i.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return rn(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(C,O){return C.charCodeAt(O)<<24|C.charCodeAt(O+1)<<16|C.charCodeAt(O+2)<<8|C.charCodeAt(O+3)&255}function r(C,O,N,D){const L=C.substring(0,O),I=C.substring(O+N);return L+D+I}let s,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const u=l.getContext("2d");let f=0;function d(C,O){if(++f>30){Ve("Load test font never loaded."),O();return}if(u.font="30px "+C,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(d.bind(null,C,O))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=r(m,976,p.length,p);const y=16,x=1482184792;let _=i(m,y);for(s=0,a=p.length-3;s<a;s+=4)_=_-x+i(p,s)|0;s<p.length&&(_=_-x+i(p+"XXX",s)|0),m=r(m,y,4,E9(_));const b=`url(data:font/opentype;base64,${btoa(m)});`,S=`@font-face {font-family:"${p}";src:${b}}`;this.insertRule(S);const A=this._document.createElement("div");A.style.visibility="hidden",A.style.width=A.style.height="10px",A.style.position="absolute",A.style.top=A.style.left="0px";for(const C of[t.loadedName,p]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=C,A.append(O)}this._document.body.append(A),d(p,()=>{A.remove(),e.complete()})}}class F9{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const i in t)this[i]=t[i];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${lN(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let r;try{r=t.get(i)}catch(a){Ve(`getPathGenerator - ignoring character: "${a}".`)}const s=new Path2D(r||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=s}}function P9(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Pr)return n;const t=URL.parse(n,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function B9(n){if(Pr&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return R0(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Pg(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Fw=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,j9=n=>typeof n=="object"&&typeof n?.name=="string",mN=C9.bind(null,Fw,j9);class U9{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,i)})}addEventListener(t,e,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:s}=i;if(s.aborted){Ve("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);r=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}this.#t.set(e,r)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Bg={DATA:1,ERROR:2},bi={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function sD(){}function as(n){if(n instanceof yl||n instanceof Kv||n instanceof eD||n instanceof Kp||n instanceof D_)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Pn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new yl(n.message);case"InvalidPDFException":return new Kv(n.message);case"PasswordException":return new eD(n.message,n.code);case"ResponseException":return new Kp(n.message,n.status,n.missing);case"UnknownErrorException":return new D_(n.message,n.details)}return new D_(n.message,n.toString())}class Cp{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const i=t.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Bg.DATA)r.resolve(t.data);else if(t.callback===Bg.ERROR)r.reject(as(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,r=t.sourceName,s=this.comObj;Promise.try(e,t.data).then(function(a){s.postMessage({sourceName:i,targetName:r,callback:Bg.DATA,callbackId:t.callbackId,data:a})},function(a){s.postMessage({sourceName:i,targetName:r,callback:Bg.ERROR,callbackId:t.callbackId,reason:as(a)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const r=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},i)}catch(a){s.reject(a)}return s.promise}sendWithStream(t,e,i,r){const s=this.streamId++,a=this.sourceName,l=this.targetName,u=this.comObj;return new ReadableStream({start:f=>{const d=Promise.withResolvers();return this.streamControllers[s]={controller:f,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:a,targetName:l,action:t,streamId:s,data:e,desiredSize:f.desiredSize},r),d.promise},pull:f=>{const d=Promise.withResolvers();return this.streamControllers[s].pullCall=d,u.postMessage({sourceName:a,targetName:l,stream:bi.PULL,streamId:s,desiredSize:f.desiredSize}),d.promise},cancel:f=>{Ai(f instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[s].cancelCall=d,this.streamControllers[s].isClosed=!0,u.postMessage({sourceName:a,targetName:l,stream:bi.CANCEL,streamId:s,reason:as(f)}),d.promise}},i)}#n(t){const e=t.streamId,i=this.sourceName,r=t.sourceName,s=this.comObj,a=this,l=this.actionHandler[t.action],u={enqueue(f,d=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=d,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:r,stream:bi.ENQUEUE,streamId:e,chunk:f},p)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:bi.CLOSE,streamId:e}),delete a.streamSinks[e])},error(f){Ai(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:bi.ERROR,streamId:e,reason:as(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[e]=u,Promise.try(l,t.data,u).then(function(){s.postMessage({sourceName:i,targetName:r,stream:bi.START_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:i,targetName:r,stream:bi.START_COMPLETE,streamId:e,reason:as(f)})})}#i(t){const e=t.streamId,i=this.sourceName,r=t.sourceName,s=this.comObj,a=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case bi.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(as(t.reason));break;case bi.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(as(t.reason));break;case bi.PULL:if(!l){s.postMessage({sourceName:i,targetName:r,stream:bi.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||sD).then(function(){s.postMessage({sourceName:i,targetName:r,stream:bi.PULL_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:i,targetName:r,stream:bi.PULL_COMPLETE,streamId:e,reason:as(f)})});break;case bi.ENQUEUE:if(Ai(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case bi.CLOSE:if(Ai(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#s(a,e);break;case bi.ERROR:Ai(a,"error should have stream controller"),a.controller.error(as(t.reason)),this.#s(a,e);break;case bi.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(as(t.reason)),this.#s(a,e);break;case bi.CANCEL:if(!l)break;const u=as(t.reason);Promise.try(l.onCancel||sD,u).then(function(){s.postMessage({sourceName:i,targetName:r,stream:bi.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:i,targetName:r,stream:bi.CANCEL_COMPLETE,streamId:e,reason:as(f)})}),l.sinkCapability.reject(u),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class gN{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Pn("Abstract method `_createCanvas` called.")}}class z9 extends gN{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class vN{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Pn("Abstract method `_fetch` called.")}}class aD extends vN{async _fetch(t){const e=await Dd(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):R0(e)}}class xN{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,r,s){return"none"}destroy(t=!1){}}class H9 extends xN{#t;#e;#n;#i;#s;#r;#l=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#s=e}get#o(){return this.#e||=new Map}get#f(){return this.#r||=new Map}get#c(){if(!this.#n){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(nl,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#n=this.#s.createElementNS(nl,"defs"),t.append(i),i.append(this.#n),this.#s.body.append(t)}return this.#n}#d(t){if(t.length===1){const u=t[0],f=new Array(256);for(let p=0;p<256;p++)f[p]=u[p]/255;const d=f.join(",");return[d,d,d]}const[e,i,r]=t,s=new Array(256),a=new Array(256),l=new Array(256);for(let u=0;u<256;u++)s[u]=e[u]/255,a[u]=i[u]/255,l[u]=r[u]/255;return[s.join(","),a.join(","),l.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(L0(e)?Ve('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=a2(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,r,s]=this.#d(t),a=t.length===1?i:`${i}${r}${s}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#i}_transfer_map_${this.#l++}`,u=this.#u(l);this.#o.set(t,u),this.#o.set(a,u);const f=this.#p(l);return this.#m(i,r,s,f),u}addHCMFilter(t,e){const i=`${t}-${e}`,r="base";let s=this.#f.get(r);if(s?.key===i||(s?(s.filter?.remove(),s.key=i,s.url="none",s.filter=null):(s={key:i,url:"none",filter:null},this.#f.set(r,s)),!t||!e))return s.url;const a=this.#x(t);t=Ee.makeHexColor(...a);const l=this.#x(e);if(e=Ee.makeHexColor(...l),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return s.url;const u=new Array(256);for(let g=0;g<=255;g++){const y=g/255;u[g]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const f=u.join(","),d=`g_${this.#i}_hcm_filter`,p=s.filter=this.#p(d);this.#m(f,f,f,p),this.#a(p);const m=(g,y)=>{const x=a[g]/255,_=l[g]/255,b=new Array(y+1);for(let S=0;S<=y;S++)b[S]=x+S/y*(_-x);return b.join(",")};return this.#m(m(0,5),m(1,5),m(2,5),p),s.url=this.#u(d),s.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),r=`alpha_${i}`;if(e=this.#o.get(r),e)return this.#o.set(t,e),e;const s=`g_${this.#i}_alpha_map_${this.#l++}`,a=this.#u(s);this.#o.set(t,a),this.#o.set(r,a);const l=this.#p(s);return this.#v(i,l),a}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,r;if(t?([i]=this.#d([t]),r=`luminosity_${i}`):r="luminosity",e=this.#o.get(r),e)return this.#o.set(t,e),e;const s=`g_${this.#i}_luminosity_map_${this.#l++}`,a=this.#u(s);this.#o.set(t,a),this.#o.set(r,a);const l=this.#p(s);return this.#h(l),t&&this.#v(i,l),a}addHighlightHCMFilter(t,e,i,r,s){const a=`${e}-${i}-${r}-${s}`;let l=this.#f.get(t);if(l?.key===a||(l?(l.filter?.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},this.#f.set(t,l)),!e||!i))return l.url;const[u,f]=[e,i].map(this.#x.bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[m,g]=[r,s].map(this.#x.bind(this));p<d&&([d,p,m,g]=[p,d,g,m]),this.#c.style.color="";const y=(b,S,A)=>{const C=new Array(256),O=(p-d)/A,N=b/255,D=(S-b)/(255*A);let L=0;for(let I=0;I<=A;I++){const z=Math.round(d+I*O),j=N+I*D;for(let B=L;B<=z;B++)C[B]=j;L=z+1}for(let I=L;I<256;I++)C[I]=C[L-1];return C.join(",")},x=`g_${this.#i}_hcm_${t}_filter`,_=l.filter=this.#p(x);return this.#a(_),this.#m(y(m[0],g[0],5),y(m[1],g[1],5),y(m[2],g[2],5),_),l.url=this.#u(x),l.url}destroy(t=!1){t&&this.#r?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#l=0)}#h(t){const e=this.#s.createElementNS(nl,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#a(t){const e=this.#s.createElementNS(nl,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#s.createElementNS(nl,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#g(t,e,i){const r=this.#s.createElementNS(nl,e);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)}#m(t,e,i,r){const s=this.#s.createElementNS(nl,"feComponentTransfer");r.append(s),this.#g(s,"feFuncR",t),this.#g(s,"feFuncG",e),this.#g(s,"feFuncB",i)}#v(t,e){const i=this.#s.createElementNS(nl,"feComponentTransfer");e.append(i),this.#g(i,"feFuncA",t)}#x(t){return this.#c.style.color=t,u2(getComputedStyle(this.#c).getPropertyValue("color"))}}class yN{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Pn("Abstract method `_fetch` called.")}}class oD extends yN{async _fetch(t){const e=await Dd(t,"arraybuffer");return new Uint8Array(e)}}class _N{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Pn("Abstract method `_fetch` called.")}}class lD extends _N{async _fetch(t){const e=await Dd(t,"arraybuffer");return new Uint8Array(e)}}Pr&&Ve("Please use the `legacy` build in Node.js environments.");async function p2(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class $9 extends xN{}class G9 extends gN{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class V9 extends vN{async _fetch(t){return p2(t)}}class W9 extends yN{async _fetch(t){return p2(t)}}class X9 extends _N{async _fetch(t){return p2(t)}}const Ji={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Pw(n,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,i),n.clip(r)}class m2{isModifyingCurrentTransform(){return!1}getPattern(){Pn("Abstract method `getPattern` called.")}}class Y9 extends m2{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,r){let s;if(r===Ji.STROKE||r===Ji.FILL){const a=e.current.getClippedPathBoundingBox(r,ei(t))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,u=Math.ceil(a[3]-a[1])||1,f=e.cachedCanvases.getCanvas("pattern",l,u),d=f.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),i=Ee.transform(i,[1,0,0,1,a[0],a[1]]),d.transform(...e.baseTransform),this.matrix&&d.transform(...this.matrix),Pw(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),s=t.createPattern(f.canvas,"no-repeat");const p=new DOMMatrix(i);s.setTransform(p)}else Pw(t,this._bbox),s=this._createGradient(t);return s}}function N_(n,t,e,i,r,s,a,l){const u=t.coords,f=t.colors,d=n.data,p=n.width*4;let m;u[e+1]>u[i+1]&&(m=e,e=i,i=m,m=s,s=a,a=m),u[i+1]>u[r+1]&&(m=i,i=r,r=m,m=a,a=l,l=m),u[e+1]>u[i+1]&&(m=e,e=i,i=m,m=s,s=a,a=m);const g=(u[e]+t.offsetX)*t.scaleX,y=(u[e+1]+t.offsetY)*t.scaleY,x=(u[i]+t.offsetX)*t.scaleX,_=(u[i+1]+t.offsetY)*t.scaleY,b=(u[r]+t.offsetX)*t.scaleX,S=(u[r+1]+t.offsetY)*t.scaleY;if(y>=S)return;const A=f[s],C=f[s+1],O=f[s+2],N=f[a],D=f[a+1],L=f[a+2],I=f[l],z=f[l+1],j=f[l+2],B=Math.round(y),tt=Math.round(S);let k,et,K,q,_t,at,P,X;for(let V=B;V<=tt;V++){if(V<_){const Et=V<y?0:(y-V)/(y-_);k=g-(g-x)*Et,et=A-(A-N)*Et,K=C-(C-D)*Et,q=O-(O-L)*Et}else{let Et;V>S?Et=1:_===S?Et=0:Et=(_-V)/(_-S),k=x-(x-b)*Et,et=N-(N-I)*Et,K=D-(D-z)*Et,q=L-(L-j)*Et}let it;V<y?it=0:V>S?it=1:it=(y-V)/(y-S),_t=g-(g-b)*it,at=A-(A-I)*it,P=C-(C-z)*it,X=O-(O-j)*it;const ht=Math.round(Math.min(k,_t)),yt=Math.round(Math.max(k,_t));let Rt=p*V+ht*4;for(let Et=ht;Et<=yt;Et++)it=(k-Et)/(k-_t),it<0?it=0:it>1&&(it=1),d[Rt++]=et-(et-at)*it|0,d[Rt++]=K-(K-P)*it|0,d[Rt++]=q-(q-X)*it|0,d[Rt++]=255}}function q9(n,t,e){const i=t.coords,r=t.colors;let s,a;switch(t.type){case"lattice":const l=t.verticesPerRow,u=Math.floor(i.length/l)-1,f=l-1;for(s=0;s<u;s++){let d=s*l;for(let p=0;p<f;p++,d++)N_(n,e,i[d],i[d+1],i[d+l],r[d],r[d+1],r[d+l]),N_(n,e,i[d+l+1],i[d+1],i[d+l],r[d+l+1],r[d+1],r[d+l])}break;case"triangles":for(s=0,a=i.length;s<a;s+=3)N_(n,e,i[s],i[s+1],i[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class K9 extends m2{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const l=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-l,d=Math.ceil(this._bounds[3])-u,p=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),g=f/p,y=d/m,x={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-u,scaleX:1/g,scaleY:1/y},_=p+2*2,b=m+2*2,S=i.getCanvas("mesh",_,b),A=S.context,C=A.createImageData(p,m);if(e){const N=C.data;for(let D=0,L=N.length;D<L;D+=4)N[D]=e[0],N[D+1]=e[1],N[D+2]=e[2],N[D+3]=255}for(const N of this._figures)q9(C,N,x);return A.putImageData(C,2,2),{canvas:S.canvas,offsetX:l-2*g,offsetY:u-2*y,scaleX:g,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,r){Pw(t,this._bbox);const s=new Float32Array(2);if(r===Ji.SHADING)Ee.singularValueDecompose2dScale(ei(t),s);else if(this.matrix){Ee.singularValueDecompose2dScale(this.matrix,s);const[l,u]=s;Ee.singularValueDecompose2dScale(e.baseTransform,s),s[0]*=l,s[1]*=u}else Ee.singularValueDecompose2dScale(e.baseTransform,s);const a=this._createMeshCanvas(s,r===Ji.SHADING?null:this._background,e.cachedCanvases);return r!==Ji.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class Z9 extends m2{getPattern(){return"hotpink"}}function Q9(n){switch(n[0]){case"RadialAxial":return new Y9(n);case"Mesh":return new K9(n);case"Dummy":return new Z9}throw new Error(`Unknown IR type: ${n[0]}`)}const cD={COLORED:1,UNCOLORED:2};class g2{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(t){const{bbox:e,operatorList:i,paintType:r,tilingType:s,color:a,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:f}=this;u=Math.abs(u),f=Math.abs(f),K1("TilingType: "+s);const d=e[0],p=e[1],m=e[2],g=e[3],y=m-d,x=g-p,_=new Float32Array(2);Ee.singularValueDecompose2dScale(this.matrix,_);const[b,S]=_;Ee.singularValueDecompose2dScale(this.baseTransform,_);const A=b*_[0],C=S*_[1];let O=y,N=x,D=!1,L=!1;const I=Math.ceil(u*A),z=Math.ceil(f*C),j=Math.ceil(y*A),B=Math.ceil(x*C);I>=j?O=u:D=!0,z>=B?N=f:L=!0;const tt=this.getSizeAndScale(O,this.ctx.canvas.width,A),k=this.getSizeAndScale(N,this.ctx.canvas.height,C),et=t.cachedCanvases.getCanvas("pattern",tt.size,k.size),K=et.context,q=l.createCanvasGraphics(K);if(q.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(q,r,a),K.translate(-tt.scale*d,-k.scale*p),q.transform(tt.scale,0,0,k.scale,0,0),K.save(),this.clipBbox(q,d,p,m,g),q.baseTransform=ei(q.ctx),q.executeOperatorList(i),q.endDrawing(),K.restore(),D||L){const _t=et.canvas;D&&(O=u),L&&(N=f);const at=this.getSizeAndScale(O,this.ctx.canvas.width,A),P=this.getSizeAndScale(N,this.ctx.canvas.height,C),X=at.size,V=P.size,it=t.cachedCanvases.getCanvas("pattern-workaround",X,V),ht=it.context,yt=D?Math.floor(y/u):0,Rt=L?Math.floor(x/f):0;for(let Et=0;Et<=yt;Et++)for(let G=0;G<=Rt;G++)ht.drawImage(_t,X*Et,V*G,X,V,0,0,X,V);return{canvas:it.canvas,scaleX:at.scale,scaleY:P.scale,offsetX:d,offsetY:p}}return{canvas:et.canvas,scaleX:tt.scale,scaleY:k.scale,offsetX:d,offsetY:p}}getSizeAndScale(t,e,i){const r=Math.max(g2.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*i);return s>=r?s=r:i=s/t,{scale:i,size:s}}clipBbox(t,e,i,r,s){const a=r-e,l=s-i;t.ctx.rect(e,i,a,l),Ee.axialAlignedBoundingBox([e,i,r,s],ei(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const r=t.ctx,s=t.current;switch(e){case cD.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;r.fillStyle=s.fillColor=a,r.strokeStyle=s.strokeColor=l;break;case cD.UNCOLORED:r.fillStyle=r.strokeStyle=i,s.fillColor=s.strokeColor=i;break;default:throw new w9(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,r){let s=i;r!==Ji.SHADING&&(s=Ee.transform(s,e.baseTransform),this.matrix&&(s=Ee.transform(s,this.matrix)));const a=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const u=t.createPattern(a.canvas,"repeat");return u.setTransform(l),u}}function J9({src:n,srcPos:t=0,dest:e,width:i,height:r,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const l=$i.isLittleEndian?4278190080:255,[u,f]=a?[s,l]:[l,s],d=i>>3,p=i&7,m=n.length;e=new Uint32Array(e.buffer);let g=0;for(let y=0;y<r;y++){for(const _=t+d;t<_;t++){const b=t<m?n[t]:255;e[g++]=b&128?f:u,e[g++]=b&64?f:u,e[g++]=b&32?f:u,e[g++]=b&16?f:u,e[g++]=b&8?f:u,e[g++]=b&4?f:u,e[g++]=b&2?f:u,e[g++]=b&1?f:u}if(p===0)continue;const x=t<m?n[t++]:255;for(let _=0;_<p;_++)e[g++]=x&1<<7-_?f:u}return{srcPos:t,destPos:g}}const uD=16,fD=100,tj=15,dD=10,cs=16,L_=new DOMMatrix,Ds=new Float32Array(2),Yf=new Float32Array([1/0,1/0,-1/0,-1/0]);function ej(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},n.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},n.transform=function(e,i,r,s,a,l){t.transform(e,i,r,s,a,l),this.__originalTransform(e,i,r,s,a,l)},n.setTransform=function(e,i,r,s,a,l){t.setTransform(e,i,r,s,a,l),this.__originalSetTransform(e,i,r,s,a,l)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(e){t.rotate(e),this.__originalRotate(e)},n.clip=function(e){t.clip(e),this.__originalClip(e)},n.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},n.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},n.bezierCurveTo=function(e,i,r,s,a,l){t.bezierCurveTo(e,i,r,s,a,l),this.__originalBezierCurveTo(e,i,r,s,a,l)},n.rect=function(e,i,r,s){t.rect(e,i,r,s),this.__originalRect(e,i,r,s)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class nj{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,i)):(r=this.canvasFactory.create(e,i),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function jg(n,t,e,i,r,s,a,l,u,f){const[d,p,m,g,y,x]=ei(n);if(p===0&&m===0){const S=a*d+y,A=Math.round(S),C=l*g+x,O=Math.round(C),N=(a+u)*d+y,D=Math.abs(Math.round(N)-A)||1,L=(l+f)*g+x,I=Math.abs(Math.round(L)-O)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(g),A,O),n.drawImage(t,e,i,r,s,0,0,D,I),n.setTransform(d,p,m,g,y,x),[D,I]}if(d===0&&g===0){const S=l*m+y,A=Math.round(S),C=a*p+x,O=Math.round(C),N=(l+f)*m+y,D=Math.abs(Math.round(N)-A)||1,L=(a+u)*p+x,I=Math.abs(Math.round(L)-O)||1;return n.setTransform(0,Math.sign(p),Math.sign(m),0,A,O),n.drawImage(t,e,i,r,s,0,0,I,D),n.setTransform(d,p,m,g,y,x),[I,D]}n.drawImage(t,e,i,r,s,a,l,u,f);const _=Math.hypot(d,p),b=Math.hypot(m,g);return[_*u,b*f]}class hD{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=kw;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=mr.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e){this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Yf.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ji.FILL,e=null){const i=this.minMax.slice();if(t===Ji.STROKE){e||Pn("Stroke bounding box must include transform."),Ee.singularValueDecompose2dScale(e,Ds);const r=Ds[0]*this.lineWidth/2,s=Ds[1]*this.lineWidth/2;i[0]-=r,i[1]-=s,i[2]+=r,i[3]+=s}return i}updateClipFromPath(){const t=Ee.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Yf,0)}getClippedPathBoundingBox(t=Ji.FILL,e=null){return Ee.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function pD(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,i=t.width,r=e%cs,s=(e-r)/cs,a=r===0?s:s+1,l=n.createImageData(i,cs);let u=0,f;const d=t.data,p=l.data;let m,g,y,x;if(t.kind===Pp.GRAYSCALE_1BPP){const _=d.byteLength,b=new Uint32Array(p.buffer,0,p.byteLength>>2),S=b.length,A=i+7>>3,C=4294967295,O=$i.isLittleEndian?4278190080:255;for(m=0;m<a;m++){for(y=m<s?cs:r,f=0,g=0;g<y;g++){const N=_-u;let D=0;const L=N>A?i:N*8-7,I=L&-8;let z=0,j=0;for(;D<I;D+=8)j=d[u++],b[f++]=j&128?C:O,b[f++]=j&64?C:O,b[f++]=j&32?C:O,b[f++]=j&16?C:O,b[f++]=j&8?C:O,b[f++]=j&4?C:O,b[f++]=j&2?C:O,b[f++]=j&1?C:O;for(;D<L;D++)z===0&&(j=d[u++],z=128),b[f++]=j&z?C:O,z>>=1}for(;f<S;)b[f++]=0;n.putImageData(l,0,m*cs)}}else if(t.kind===Pp.RGBA_32BPP){for(g=0,x=i*cs*4,m=0;m<s;m++)p.set(d.subarray(u,u+x)),u+=x,n.putImageData(l,0,g),g+=cs;m<a&&(x=i*r*4,p.set(d.subarray(u,u+x)),n.putImageData(l,0,g))}else if(t.kind===Pp.RGB_24BPP)for(y=cs,x=i*y,m=0;m<a;m++){for(m>=s&&(y=r,x=i*y),f=0,g=x;g--;)p[f++]=d[u++],p[f++]=d[u++],p[f++]=d[u++],p[f++]=255;n.putImageData(l,0,m*cs)}else throw new Error(`bad image kind: ${t.kind}`)}function mD(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,r=e%cs,s=(e-r)/cs,a=r===0?s:s+1,l=n.createImageData(i,cs);let u=0;const f=t.data,d=l.data;for(let p=0;p<a;p++){const m=p<s?cs:r;({srcPos:u}=J9({src:f,srcPos:u,dest:d,width:i,height:m,nonBlackColor:0})),n.putImageData(l,0,p*cs)}}function lp(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)n[i]!==void 0&&(t[i]=n[i]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function Ug(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}function gD(n,t){if(t)return!0;Ee.singularValueDecompose2dScale(n,Ds);const e=Math.fround(Ma.pixelRatio*Eu.PDF_TO_CSS_UNITS);return Ds[0]<=e&&Ds[1]<=e}const ij=["butt","round","square"],rj=["miter","round","bevel"],sj={},vD={};class Zf{constructor(t,e,i,r,s,{optionalContentConfig:a,markedContentStack:l=null},u,f){this.ctx=t,this.current=new hD(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=r,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new nj(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:r=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=l,i){const u=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...ei(this.compositeCtx))}this.ctx.save(),Ug(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ei(this.ctx)}executeOperatorList(t,e,i,r){const s=t.argsArray,a=t.fnArray;let l=e||0;const u=s.length;if(u===l)return l;const f=u-l>dD&&typeof i=="function",d=f?Date.now()+tj:0;let p=0;const m=this.commonObjs,g=this.objs;let y;for(;;){if(r!==void 0&&l===r.nextBreakPoint)return r.breakIt(l,i),l;if(y=a[l],y!==qp.dependency)this[y].apply(this,s[l]);else for(const x of s[l]){const _=x.startsWith("g_")?m:g;if(!_.has(x))return _.get(x,i),l}if(l++,l===u)return l;if(f&&++p>dD){if(Date.now()>d)return i(),l;p=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,r=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),l=i,u=r,f="prescale1",d,p;for(;s>2&&l>1||a>2&&u>1;){let m=l,g=u;s>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/m),a>2&&u>1&&(g=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,a/=u/g),d=this.cachedCanvases.getCanvas(f,m,g),p=d.context,p.clearRect(0,0,m,g),p.drawImage(t,0,0,l,u,0,0,m,g),t=d.canvas,l=m,u=g,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:u}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:r}=t,s=this.current.fillColor,a=this.current.patternFill,l=ei(e);let u,f,d,p;if((t.bitmap||t.data)&&t.count>1){const I=t.bitmap||t.data.buffer;f=JSON.stringify(a?l:[l.slice(0,4),s]),u=this._cachedBitmapsMap.get(I),u||(u=new Map,this._cachedBitmapsMap.set(I,u));const z=u.get(f);if(z&&!a){const j=Math.round(Math.min(l[0],l[2])+l[4]),B=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:z,offsetX:j,offsetY:B}}d=z}d||(p=this.cachedCanvases.getCanvas("maskCanvas",i,r),mD(p.context,t));let m=Ee.transform(l,[1/i,0,0,-1/r,0,0]);m=Ee.transform(m,[1,0,0,1,0,-r]);const g=Yf.slice();Ee.axialAlignedBoundingBox([0,0,i,r],m,g);const[y,x,_,b]=g,S=Math.round(_-y)||1,A=Math.round(b-x)||1,C=this.cachedCanvases.getCanvas("fillCanvas",S,A),O=C.context,N=y,D=x;O.translate(-N,-D),O.transform(...m),d||(d=this._scaleImage(p.canvas,ro(O)),d=d.img,u&&a&&u.set(f,d)),O.imageSmoothingEnabled=gD(ei(O),t.interpolate),jg(O,d,0,0,d.width,d.height,0,0,i,r),O.globalCompositeOperation="source-in";const L=Ee.transform(ro(O),[1,0,0,1,-N,-D]);return O.fillStyle=a?s.getPattern(e,this,L,Ji.FILL):s,O.fillRect(0,0,i,r),u&&!a&&(this.cachedCanvases.delete("fillCanvas"),u.set(f,C.canvas)),{canvas:C.canvas,offsetX:Math.round(N),offsetY:Math.round(D)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=ij[t]}setLineJoin(t){this.ctx.lineJoin=rj[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx;const s=this.ctx=r.context;s.setTransform(this.suspendedCtx.getTransform()),lp(this.suspendedCtx,s),ej(s,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),lp(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,r){const s=r[0],a=r[1],l=r[2]-s,u=r[3]-a;l===0||u===0||(this.genericComposeSMask(e.context,i,l,u,e.subtype,e.backdrop,e.transferMap,s,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,r,s,a,l,u,f,d,p){let m=t.canvas,g=u-d,y=f-p;if(a)if(g<0||y<0||g+i>m.width||y+r>m.height){const _=this.cachedCanvases.getCanvas("maskExtension",i,r),b=_.context;b.drawImage(m,-g,-y),b.globalCompositeOperation="destination-atop",b.fillStyle=a,b.fillRect(0,0,i,r),b.globalCompositeOperation="source-over",m=_.canvas,g=y=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const _=new Path2D;_.rect(g,y,i,r),t.clip(_),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(g,y,i,r),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const x=new Path2D;x.rect(u,f,i,r),e.clip(x),e.globalCompositeOperation="destination-in",e.drawImage(m,g,y,i,r,u,f,i,r),e.restore()}save(){this.inSMaskMode&&lp(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&lp(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,r,s,a){this.ctx.transform(t,e,i,r,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){let[r]=e;if(!i){r||=e[0]=new Path2D,this[t](r);return}if(!(r instanceof Path2D)){const s=e[0]=new Path2D;for(let a=0,l=r.length;a<l;)switch(r[a++]){case Fg.moveTo:s.moveTo(r[a++],r[a++]);break;case Fg.lineTo:s.lineTo(r[a++],r[a++]);break;case Fg.curveTo:s.bezierCurveTo(r[a++],r[a++],r[a++],r[a++],r[a++],r[a++]);break;case Fg.closePath:s.closePath();break;default:Ve(`Unrecognized drawing path operator: ${r[a-1]}`);break}r=s}Ee.axialAlignedBoundingBox(i,ei(this.ctx),this.current.minMax),this[t](r)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&r?.getPattern){const s=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,ro(i),Ji.STROKE),s){const a=new Path2D;a.addPath(t,i.getTransform().invertSelf().multiplySelf(s)),t=a}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(Ji.STROKE,ei(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const i=this.ctx,r=this.current.fillColor,s=this.current.patternFill;let a=!1;if(s){const u=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.fillStyle=r.getPattern(i,this,ro(i),Ji.FILL),u){const f=new Path2D;f.addPath(t,i.getTransform().invertSelf().multiplySelf(u)),t=f}a=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),a&&i.restore(),e&&this.consumePath(t,l)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=sj}eoClip(){this.pendingClip=vD}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0)return;const i=new Path2D,r=e.getTransform().invertSelf();for(const{transform:s,x:a,y:l,fontSize:u,path:f}of t)i.addPath(f,new DOMMatrix(s).preMultiplySelf(r).translate(a,l).scale(u,-u));e.clip(i),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=i.fontMatrix||kw,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Ve("Invalid font matrix for font "+t),e<0?(e=-e,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const s=i.loadedName||"sans-serif",a=i.systemFontInfo?.css||`"${s}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal";let f=e;e<uD?f=uD:e>fD&&(f=fD),this.current.fontSizeScale=e/f,this.ctx.font=`${u} ${l} ${f}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(t,e,i){const r=new Path2D;return r.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),r}paintChar(t,e,i,r,s){const a=this.ctx,l=this.current,u=l.font,f=l.textRenderingMode,d=l.fontSize/l.fontSizeScale,p=f&mr.FILL_STROKE_MASK,m=!!(f&mr.ADD_TO_PATH_FLAG),g=l.patternFill&&!u.missingFile,y=l.patternStroke&&!u.missingFile;let x;if((u.disableFontFace||m||g||y)&&(x=u.getPathGenerator(this.commonObjs,t)),u.disableFontFace||g||y){a.save(),a.translate(e,i),a.scale(d,-d);let _;if((p===mr.FILL||p===mr.FILL_STROKE)&&(r?(_=a.getTransform(),a.setTransform(...r),a.fill(this.#n(x,_,r))):a.fill(x)),p===mr.STROKE||p===mr.FILL_STROKE)if(s){_||=a.getTransform(),a.setTransform(...s);const{a:b,b:S,c:A,d:C}=_,O=Ee.inverseTransform(s),N=Ee.transform([b,S,A,C,0,0],O);Ee.singularValueDecompose2dScale(N,Ds),a.lineWidth*=Math.max(Ds[0],Ds[1])/d,a.stroke(this.#n(x,_,s))}else a.lineWidth/=d,a.stroke(x);a.restore()}else(p===mr.FILL||p===mr.FILL_STROKE)&&a.fillText(t,e,i),(p===mr.STROKE||p===mr.FILL_STROKE)&&a.strokeText(t,e,i);m&&(this.pendingTextPaths||=[]).push({transform:ei(a),x:e,y:i,fontSize:d,path:x})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){i=!0;break}return rn(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const r=e.fontSize;if(r===0)return;const s=this.ctx,a=e.fontSizeScale,l=e.charSpacing,u=e.wordSpacing,f=e.fontDirection,d=e.textHScale*f,p=t.length,m=i.vertical,g=m?1:-1,y=i.defaultVMetrics,x=r*e.fontMatrix[0],_=e.textRenderingMode===mr.FILL&&!i.disableFontFace&&!e.patternFill;s.save(),e.textMatrix&&s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),f>0?s.scale(d,-1):s.scale(d,1);let b,S;if(e.patternFill){s.save();const D=e.fillColor.getPattern(s,this,ro(s),Ji.FILL);b=ei(s),s.restore(),s.fillStyle=D}if(e.patternStroke){s.save();const D=e.strokeColor.getPattern(s,this,ro(s),Ji.STROKE);S=ei(s),s.restore(),s.strokeStyle=D}let A=e.lineWidth;const C=e.textMatrixScale;if(C===0||A===0){const D=e.textRenderingMode&mr.FILL_STROKE_MASK;(D===mr.STROKE||D===mr.FILL_STROKE)&&(A=this.getSinglePixelWidth())}else A/=C;if(a!==1&&(s.scale(a,a),A/=a),s.lineWidth=A,i.isInvalidPDFjsFont){const D=[];let L=0;for(const I of t)D.push(I.unicode),L+=I.width;s.fillText(D.join(""),0,0),e.x+=L*x*d,s.restore(),this.compose();return}let O=0,N;for(N=0;N<p;++N){const D=t[N];if(typeof D=="number"){O+=g*D*r/1e3;continue}let L=!1;const I=(D.isSpace?u:0)+l,z=D.fontChar,j=D.accent;let B,tt,k=D.width;if(m){const K=D.vmetric||y,q=-(D.vmetric?K[1]:k*.5)*x,_t=K[2]*x;k=K?-K[0]:k,B=q/a,tt=(O+_t)/a}else B=O/a,tt=0;if(i.remeasure&&k>0){const K=s.measureText(z).width*1e3/r*a;if(k<K&&this.isFontSubpixelAAEnabled){const q=k/K;L=!0,s.save(),s.scale(q,1),B/=q}else k!==K&&(B+=(k-K)/2e3*r/a)}if(this.contentVisible&&(D.isInFont||i.missingFile)){if(_&&!j)s.fillText(z,B,tt);else if(this.paintChar(z,B,tt,b,S),j){const K=B+r*j.offset.x/a,q=tt-r*j.offset.y/a;this.paintChar(j.fontChar,K,q,b,S)}}const et=m?k*x-I*f:k*x+I*f;O+=et,L&&s.restore()}m?e.y-=O:e.x+=O*d,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,r=i.font,s=i.fontSize,a=i.fontDirection,l=r.vertical?1:-1,u=i.charSpacing,f=i.wordSpacing,d=i.textHScale*a,p=i.fontMatrix||kw,m=t.length,g=i.textRenderingMode===mr.INVISIBLE;let y,x,_,b;if(!(g||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),i.textMatrix&&e.transform(...i.textMatrix),e.translate(i.x,i.y+i.textRise),e.scale(d,a),y=0;y<m;++y){if(x=t[y],typeof x=="number"){b=l*x*s/1e3,this.ctx.translate(b,0),i.x+=b*d;continue}const S=(x.isSpace?f:0)+u,A=r.charProcOperatorList[x.operatorListId];A?this.contentVisible&&(this.save(),e.scale(s,s),e.transform(...p),this.executeOperatorList(A),this.restore()):Ve(`Type3 character "${x.operatorListId}" is not available.`);const C=[x.width,0];Ee.applyTransform(C,p),_=C[0]*s+S,e.translate(_,0),i.x+=_*d}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,r,s,a){const l=new Path2D;l.rect(i,r,s-i,a-r),this.ctx.clip(l),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=this.baseTransform||ei(this.ctx),r={createCanvasGraphics:s=>new Zf(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new g2(t,this.ctx,r,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=Q9(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,ro(e),Ji.SHADING);const r=ro(e);if(r){const{width:s,height:a}=e.canvas,l=Yf.slice();Ee.axialAlignedBoundingBox([0,0,s,a],r,l);const[u,f,d,p]=l;this.ctx.fillRect(u,f,d-u,p-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Pn("Should not call beginInlineImage")}beginImageData(){Pn("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=ei(this.ctx),e)){Ee.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[i,r,s,a]=e,l=new Path2D;l.rect(i,r,s-i,a-r),this.ctx.clip(l),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||K1("TODO: Support non-isolated groups."),t.knockout&&Ve("Knockout groups not supported.");const i=ei(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=Yf.slice();Ee.axialAlignedBoundingBox(t.bbox,ei(e),r);const s=[0,0,e.canvas.width,e.canvas.height];r=Ee.intersect(r,s)||[0,0,0,0];const a=Math.floor(r[0]),l=Math.floor(r[1]),u=Math.max(Math.ceil(r[2])-a,1),f=Math.max(Math.ceil(r[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,f]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(d,u,f),m=p.context;m.translate(-a,-l),m.transform(...i);let g=new Path2D;const[y,x,_,b]=t.bbox;if(g.rect(y,x,_-y,b-x),t.matrix){const S=new Path2D;S.addPath(g,new DOMMatrix(t.matrix)),g=S}m.clip(g),t.smask?this.smaskStack.push({canvas:p.canvas,context:m,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,l),e.save()),lp(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=ei(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const s=Yf.slice();Ee.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],r,s),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,i,r,s){if(this.#t(),Ug(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=l,Ee.singularValueDecompose2dScale(ei(this.ctx),Ds);const{viewportScale:u}=this,f=Math.ceil(a*this.outputScaleX*u),d=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(f,d);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(Ds[0],0,0,-Ds[1],0,l*Ds[1]),Ug(this.ctx)}else{Ug(this.ctx),this.endPath();const u=new Path2D;u.rect(e[0],e[1],a,l),this.ctx.clip(u)}}this.current=new hD(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,r=this._createMaskCanvas(t),s=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(s,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,r=0,s,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const u=ei(l);l.transform(e,i,r,s,0,0);const f=this._createMaskCanvas(t);l.setTransform(1,0,0,1,f.offsetX-u[4],f.offsetY-u[5]);for(let d=0,p=a.length;d<p;d+=2){const m=Ee.transform(u,[e,i,r,s,a[d],a[d+1]]);l.drawImage(f.canvas,m[4],m[5])}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,r=this.current.patternFill;for(const s of t){const{data:a,width:l,height:u,transform:f}=s,d=this.cachedCanvases.getCanvas("maskCanvas",l,u),p=d.context;p.save();const m=this.getObject(a,s);mD(p,m),p.globalCompositeOperation="source-in",p.fillStyle=r?i.getPattern(p,this,ro(e),Ji.FILL):i,p.fillRect(0,0,l,u),p.restore(),e.save(),e.transform(...f),e.scale(1,-1),jg(e,d.canvas,0,0,l,u,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Ve("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,r){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){Ve("Dependent image isn't ready yet");return}const a=s.width,l=s.height,u=[];for(let f=0,d=r.length;f<d;f+=2)u.push({transform:[e,0,0,i,r[f],r[f+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(s,u)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:r}=t,s=this.cachedCanvases.getCanvas("inlineImage",i,r),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,r=this.ctx;this.save();const{filter:s}=r;s!=="none"&&s!==""&&(r.filter="none"),r.scale(1/e,-1/i);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",e,i).context;pD(f,t),a=this.applyTransferMapsToCanvas(f)}const l=this._scaleImage(a,ro(r));r.imageSmoothingEnabled=gD(ei(r),t.interpolate),jg(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const s=t.width,a=t.height,u=this.cachedCanvases.getCanvas("inlineImage",s,a).context;pD(u,t),r=this.applyTransferMapsToCanvas(u)}for(const s of e)i.save(),i.transform(...s.transform),i.scale(1,-1),jg(i,r,s.x,s.y,s.w,s.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const r=this.ctx;this.pendingClip&&(i||(this.pendingClip===vD?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ei(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:r,d:s}=this.ctx.getTransform();let a,l;if(i===0&&r===0){const u=Math.abs(e),f=Math.abs(s);if(u===f)if(t===0)a=l=1/u;else{const d=u*t;a=l=d<1?1/d:1}else if(t===0)a=1/u,l=1/f;else{const d=u*t,p=f*t;a=d<1?1/d:1,l=p<1?1/p:1}}else{const u=Math.abs(e*s-i*r),f=Math.hypot(e,i),d=Math.hypot(r,s);if(t===0)a=d/u,l=f/u;else{const p=t*u;a=d>p?d/p:1,l=f>p?f/p:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:r}}=this,[s,a]=this.getScaleForStroking();if(s===a){i.lineWidth=(r||1)*s,i.stroke(t);return}const l=i.getLineDash();e&&i.save(),i.scale(s,a),L_.a=1/s,L_.d=1/a;const u=new Path2D;if(u.addPath(t,L_),l.length>0){const f=Math.max(s,a);i.setLineDash(l.map(d=>d/f)),i.lineDashOffset/=f}i.lineWidth=r||1,i.stroke(u),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const n in qp)Zf.prototype[n]!==void 0&&(Zf.prototype[qp[n]]=Zf.prototype[n]);class pc{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class aj{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Vf=Symbol("INTERNAL");class oj{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:i,usage:r,rbGroups:s}){this.#t=!!(t&Ss.DISPLAY),this.#e=!!(t&Ss.PRINT),this.name=e,this.intent=i,this.usage=r,this.rbGroups=s}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==Vf&&Pn("Internal method `_setVisible` called."),this.#n=i,this.#i=e}}class lj{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=Ss.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const i of t.groups)this.#e.set(i.id,new oj(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(Vf,!1);for(const i of t.on)this.#e.get(i)._setVisible(Vf,!0);for(const i of t.off)this.#e.get(i)._setVisible(Vf,!1);this.#n=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let r=1;r<e;r++){const s=t[r];let a;if(Array.isArray(s))a=this.#s(s);else if(this.#e.has(s))a=this.#e.get(s).visible;else return Ve(`Optional content group not found: ${s}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return K1("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Ve(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Ve(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Ve(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Ve(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Ve(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Ve(`Unknown optional content policy ${t.policy}.`),!0}return Ve(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const r=this.#e.get(t);if(!r){Ve(`Optional content group not found: ${t}`);return}if(i&&e&&r.rbGroups.length)for(const s of r.rbGroups)for(const a of s)a!==t&&this.#e.get(a)?._setVisible(Vf,!1,!0);r._setVisible(Vf,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const s=this.#e.get(r);if(s)switch(i){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!s.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new hN;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class cj{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Ai(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:s,progressiveDone:a,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,s?.length>0){const u=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((u,f)=>{this._onReceiveData({begin:u,chunk:f})}),t.addProgressListener((u,f)=>{this._onProgress({loaded:u,total:f})}),t.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(i),!0)});Ai(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Ai(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new uj(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new fj(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class uj{constructor(t,e,i=!1,r=null){this._stream=t,this._done=i||!1,this._filename=Q1(r)?r:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class fj{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function dj(n){let t=!0,e=i("filename\\*","i").exec(n);if(e){e=e[1];let d=l(e);return d=unescape(d),d=u(d),d=f(d),s(d)}if(e=a(n),e){const d=f(e);return s(d)}if(e=i("filename","i").exec(n),e){e=e[1];let d=l(e);return d=f(d),s(d)}function i(d,p){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function r(d,p){if(d){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(d,{fatal:!0}),g=R0(p);p=m.decode(g),t=!1}catch{}}return p}function s(d){return t&&/[\x80-\xff]/.test(d)&&(d=r("utf-8",d),t&&(d=r("iso-8859-1",d))),d}function a(d){const p=[];let m;const g=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=g.exec(d))!==null;){let[,x,_,b]=m;if(x=parseInt(x,10),x in p){if(x===0)break;continue}p[x]=[_,b]}const y=[];for(let x=0;x<p.length&&x in p;++x){let[_,b]=p[x];b=l(b),_&&(b=unescape(b),x===0&&(b=u(b))),y.push(b)}return y.join("")}function l(d){if(d.startsWith('"')){const p=d.slice(1).split('\\"');for(let m=0;m<p.length;++m){const g=p[m].indexOf('"');g!==-1&&(p[m]=p[m].slice(0,g),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}d=p.join('"')}return d}function u(d){const p=d.indexOf("'");if(p===-1)return d;const m=d.slice(0,p),y=d.slice(p+1).replace(/^[^']*'/,"");return r(m,y)}function f(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,g,y){if(g==="q"||g==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,_){return String.fromCharCode(parseInt(_,16))}),r(m,y);try{y=atob(y)}catch{}return r(m,y)})}return""}function bN(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const i in t){const r=t[i];r!==void 0&&e.append(i,r)}return e}function J1(n){return URL.parse(n)?.origin??null}function wN({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(r.suggestedLength=s,s<=2*e)||i||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function EN(n){const t=n.get("Content-Disposition");if(t){let e=dj(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Q1(e))return e}return null}function M0(n,t){return new Kp(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n,n===404||n===0&&t.startsWith("file:"))}function AN(n){return n===200||n===206}function SN(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function TN(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Ve(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class hj{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=bN(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ai(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new pj(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new mj(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class pj{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),r=e.url;fetch(r,SN(i,this._withCredentials,this._abortController)).then(s=>{if(t._responseOrigin=J1(s.url),!AN(s.status))throw M0(s.status,r);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:l,suggestedLength:u}=wN({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=u||this._contentLength,this._filename=EN(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new yl("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:TN(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class mj{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${i-1}`);const a=r.url;fetch(a,SN(s,this._withCredentials,this._abortController)).then(l=>{const u=J1(l.url);if(u!==t._responseOrigin)throw new Error(`Expected range response-origin "${u}" to match "${t._responseOrigin}".`);if(!AN(l.status))throw M0(l.status,a);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:TN(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const I_=200,k_=206;function gj(n){const t=n.response;return typeof t!="string"?t:R0(t).buffer}class vj{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=bN(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,a]of this.headers)e.setRequestHeader(s,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=k_):r.expectedStatus=I_,e.responseType="arraybuffer",Ai(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){i.onError(r.status);return}const s=r.status||I_;if(!(s===I_&&i.expectedStatus===k_)&&s!==i.expectedStatus){i.onError(r.status);return}const l=gj(r);if(s===k_){const u=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);f?i.onDone({begin:parseInt(f[1],10),chunk:l}):(Ve('Missing or invalid "Content-Range" header.'),i.onError(0))}else l?i.onDone({begin:0,chunk:l}):i.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class xj{constructor(t){this._source=t,this._manager=new vj(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Ai(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new yj(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new _j(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class yj{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=J1(e.responseURL);const i=e.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[u,...f]=l.split(": ");return[u,f.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=wN({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=EN(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=M0(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _j{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=J1(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=M0(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const bj=/^[a-z][a-z0-9\-+.]+:/i;function wj(n){if(bj.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class Ej{constructor(t){this.source=t,this.url=wj(t.url),Ai(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ai(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Aj(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Sj(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Aj{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=M0(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new yl("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Sj{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const cp=Symbol("INITIAL_DATA");class CN{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:cp}}get(t,e=null){if(e){const r=this.#e(t);return r.promise.then(()=>e(r.data)),null}const i=this.#t[t];if(!i||i.data===cp)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==cp}delete(t){const e=this.#t[t];return!e||e.data===cp?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==cp&&(yield[t,e])}}}const Tj=1e5,xD=30;let Zp=class ta{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#l=0;#o=0;#f=null;#c=null;#d=0;#u=0;#h=Object.create(null);#a=[];#p=null;#g=[];#m=new WeakMap;#v=null;static#x=new Map;static#y=new Map;static#b=new WeakMap;static#E=null;static#S=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(u){u.enqueue(t),u.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=i.scale*Ma.pixelRatio,this.#d=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:s,pageX:a,pageY:l}=i.rawDims;this.#v=[1,0,0,-1,-a,l+s],this.#o=r,this.#l=s,ta.#N(),_c(e,i),this.#t.promise.finally(()=>{ta.#S.delete(this),this.#r=null,this.#h=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=$i.platform;return rn(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#f.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#h,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#f=this.#p.getReader(),ta.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*Ma.pixelRatio,r=t.rotation;if(r!==this.#d&&(e?.(),this.#d=r,_c(this.#c,{rotation:r})),i!==this.#u){e?.(),this.#u=i;const s={div:null,properties:null,ctx:ta.#D(this.#s)};for(const a of this.#g)s.properties=this.#m.get(a),s.div=a,this.#w(s)}}cancel(){const t=new yl("TextLayer task cancelled.");this.#f?.cancel(t).catch(()=>{}),this.#f=null,this.#t.reject(t)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#a}#C(t){if(this.#n)return;this.#r.ctx??=ta.#D(this.#s);const e=this.#g,i=this.#a;for(const r of t){if(e.length>Tj){Ve("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const s=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id!==null&&this.#e.setAttribute("id",`${r.id}`),s.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(r.str),this.#O(r)}}#O(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#g.push(e);const r=Ee.transform(this.#v,t.transform);let s=Math.atan2(r[1],r[0]);const a=this.#h[t.fontName];a.vertical&&(s+=Math.PI/2);let l=this.#i&&a.fontSubstitution||a.fontFamily;l=ta.fontFamilyMap.get(l)||l;const u=Math.hypot(r[2],r[3]),f=u*ta.#L(l,a,this.#s);let d,p;s===0?(d=r[4],p=r[5]-f):(d=r[4]+f*Math.sin(s),p=r[5]-f*Math.cos(s));const m="calc(var(--total-scale-factor) *",g=e.style;this.#e===this.#c?(g.left=`${(100*d/this.#o).toFixed(2)}%`,g.top=`${(100*p/this.#l).toFixed(2)}%`):(g.left=`${m}${d.toFixed(2)}px)`,g.top=`${m}${p.toFixed(2)}px)`),g.fontSize=`${m}${(ta.#E*u).toFixed(2)}px)`,g.fontFamily=l,i.fontSize=u,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),s!==0&&(i.angle=s*(180/Math.PI));let y=!1;if(t.str.length>1)y=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const x=Math.abs(t.transform[0]),_=Math.abs(t.transform[3]);x!==_&&Math.max(x,_)/Math.min(x,_)>1.5&&(y=!0)}if(y&&(i.canvasWidth=a.vertical?t.height:t.width),this.#m.set(e,i),this.#r.div=e,this.#r.properties=i,this.#w(this.#r),i.hasText&&this.#e.append(e),i.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),this.#e.append(x)}}#w(t){const{div:e,properties:i,ctx:r}=t,{style:s}=e;let a="";if(ta.#E>1&&(a=`scale(${1/ta.#E})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=s,{canvasWidth:u,fontSize:f}=i;ta.#T(r,f*this.#u,l);const{width:d}=r.measureText(e.textContent);d>0&&(a=`scaleX(${u*this.#u/d}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(s.transform=a)}static cleanup(){if(!(this.#S.size>0)){this.#x.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#D(t=null){let e=this.#y.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#b.set(e,{size:0,family:""})}return e}static#T(t,e,i){const r=this.#b.get(t);e===r.size&&i===r.family||(t.font=`${e}px ${i}`,r.size=e,r.family=i)}static#N(){if(this.#E!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#E=t.getBoundingClientRect().height,t.remove()}static#L(t,e,i){const r=this.#x.get(t);if(r)return r;const s=this.#D(i);s.canvas.width=s.canvas.height=xD,this.#T(s,xD,t);const a=s.measureText(""),l=a.fontBoundingBoxAscent,u=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let f=.8;return l?f=l/(l+u):($i.platform.isFirefox&&Ve("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#x.set(t,f),f}};class Qp{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function r(s){if(!s)return;let a=null;const l=s.name;if(l==="#text")a=s.value;else if(Qp.shouldBuildText(l))s?.attributes?.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&e.push({str:a}),!!s.children)for(const u of s.children)r(u)}return r(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const Cj=100;function v2(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new x2,{docId:e}=t,i=n.url?P9(n.url):null,r=n.data?B9(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,l=n.password??null,u=n.range instanceof y2?n.range:null,f=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof md?n.worker:null;const p=n.verbosity,m=typeof n.docBaseUrl=="string"&&!L0(n.docBaseUrl)?n.docBaseUrl:null,g=Pg(n.cMapUrl),y=n.cMapPacked!==!1,x=n.CMapReaderFactory||(Pr?V9:aD),_=Pg(n.iccUrl),b=Pg(n.standardFontDataUrl),S=n.StandardFontDataFactory||(Pr?W9:oD),A=Pg(n.wasmUrl),C=n.WasmFactory||(Pr?X9:lD),O=n.stopAtErrors!==!0,N=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,D=n.isEvalSupported!==!1,L=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Pr,I=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Pr&&($i.platform.isFirefox||!globalThis.chrome),z=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,j=typeof n.disableFontFace=="boolean"?n.disableFontFace:Pr,B=n.fontExtraProperties===!0,tt=n.enableXfa===!0,k=n.ownerDocument||globalThis.document,et=n.disableRange===!0,K=n.disableStream===!0,q=n.disableAutoFetch===!0,_t=n.pdfBug===!0,at=n.CanvasFactory||(Pr?G9:z9),P=n.FilterFactory||(Pr?$9:H9),X=n.enableHWA===!0,V=n.useWasm!==!1,it=u?u.length:n.length??NaN,ht=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Pr&&!j,yt=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(x===aD&&S===oD&&C===lD&&g&&b&&A&&Tp(g,document.baseURI)&&Tp(b,document.baseURI)&&Tp(A,document.baseURI)),Rt=null;y9(p);const Et={canvasFactory:new at({ownerDocument:k,enableHWA:X}),filterFactory:new P({docId:e,ownerDocument:k}),cMapReaderFactory:yt?null:new x({baseUrl:g,isCompressed:y}),standardFontDataFactory:yt?null:new S({baseUrl:b}),wasmFactory:yt?null:new C({baseUrl:A})};d||(d=md.create({verbosity:p,port:pc.workerPort}),t._worker=d);const G={docId:e,apiVersion:"5.3.31",data:r,password:l,disableAutoFetch:q,rangeChunkSize:f,length:it,docBaseUrl:m,enableXfa:tt,evaluatorOptions:{maxImageSize:N,disableFontFace:j,ignoreErrors:O,isEvalSupported:D,isOffscreenCanvasSupported:L,isImageDecoderSupported:I,canvasMaxAreaInBytes:z,fontExtraProperties:B,useSystemFonts:ht,useWasm:V,useWorkerFetch:yt,cMapUrl:g,iccUrl:_,standardFontDataUrl:b,wasmUrl:A}},lt={ownerDocument:k,pdfBug:_t,styleElement:Rt,loadingParams:{disableAutoFetch:q,enableXfa:tt}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const rt=d.messageHandler.sendWithPromise("GetDocRequest",G,r?[r.buffer]:null);let ot;if(u)ot=new cj(u,{disableRange:et,disableStream:K});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");const bt=Tp(i)?hj:Pr?Ej:xj;ot=new bt({url:i,length:it,httpHeaders:s,withCredentials:a,rangeChunkSize:f,disableRange:et,disableStream:K})}return rt.then(bt=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const St=new Cp(e,bt,d.port),R=new Rj(St,t,ot,lt,Et);t._transport=R,St.send("Ready",null)})}).catch(t._capability.reject),t}class x2{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${x2.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let y2=class{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#s=[];constructor(t,e,i=!1,r=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=r}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#s)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#i)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Pn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class Dj{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return rn(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Oj{#t=!1;constructor(t,e,i,r=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=r?new iD:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new CN,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:s=!1}={}){return new N0({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:r,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return rn(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:r=go.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:f=null,printAnnotationStorage:d=null,isEditing:p=!1}){this._stats?.time("Overall");const m=this._transport.getRenderingIntent(i,r,d,p),{renderingIntent:g,cacheKey:y}=m;this.#t=!1,l||=this._transport.getOptionalContentConfig(g);let x=this._intentStates.get(y);x||(x=Object.create(null),this._intentStates.set(y,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);const _=!!(g&Ss.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(m));const b=C=>{x.renderTasks.delete(S),_&&(this.#t=!0),this.#e(),C?(S.capability.reject(C),this._abortOperatorList({intentState:x,reason:C instanceof Error?C:new Error(C)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new qf({callback:b,params:{canvasContext:t,viewport:e,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:f});(x.renderTasks||=new Set).add(S);const A=S.task;return Promise.all([x.displayReadyCapability.promise,l]).then(([C,O])=>{if(this.destroyed){b();return}if(this._stats?.time("Rendering"),!(O.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:C,optionalContentConfig:O}),S.operatorListChanged()}).catch(b),A}getOperatorList({intent:t="display",annotationMode:e=go.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function s(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(u))}const a=this._transport.getRenderingIntent(t,e,i,r,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let u;return l.opListReadCapability||(u=Object.create(null),u.operatorListChanged=s,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||=new Set).add(u),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Qp.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,r){function s(){a.read().then(function({value:u,done:f}){if(f){i(l);return}l.lang??=u.lang,Object.assign(l.styles,u.styles),l.items.push(...u.items),s()},r)}const a=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new iD),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,r=t.length;i<r;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:r}){const{map:s,transfer:a}=i,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:r},a).getReader(),f=this._intentStates.get(e);f.streamReader=u;const d=()=>{u.read().then(({value:p,done:m})=>{if(m){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,f),d())},p=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const m of f.renderTasks)m.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(p);else if(f.opListReadCapability)f.opListReadCapability.reject(p);else throw p}})};d()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Z1){let r=Cj;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new yl(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,s]of this._intentStates)if(s===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var fc,Da,ol,mu,j1,gu,vu,Hr,jv,DN,ON,Dp,od,Uv;const Yn=class Yn{constructor({name:t=null,port:e=null,verbosity:i=_9()}={}){no(this,Hr);no(this,fc,Promise.withResolvers());no(this,Da,null);no(this,ol,null);no(this,mu,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Xn(Yn,vu).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Xn(Yn,vu).set(e,this),io(this,Hr,DN).call(this,e)}else io(this,Hr,ON).call(this)}get promise(){return Xn(this,fc).promise}get port(){return Xn(this,ol)}get messageHandler(){return Xn(this,Da)}destroy(){this.destroyed=!0,Xn(this,mu)?.terminate(),is(this,mu,null),Xn(Yn,vu).delete(Xn(this,ol)),is(this,ol,null),Xn(this,Da)?.destroy(),is(this,Da,null)}static create(t){const e=Xn(this,vu).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Yn(t)}static get workerSrc(){if(pc.workerSrc)return pc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return rn(this,"_setupFakeWorkerGlobal",(async()=>Xn(this,od,Uv)?Xn(this,od,Uv):(await import(this.workerSrc)).WorkerMessageHandler)())}};fc=new WeakMap,Da=new WeakMap,ol=new WeakMap,mu=new WeakMap,j1=new WeakMap,gu=new WeakMap,vu=new WeakMap,Hr=new WeakSet,jv=function(){Xn(this,fc).resolve(),Xn(this,Da).send("configure",{verbosity:this.verbosity})},DN=function(t){is(this,ol,t),is(this,Da,new Cp("main","worker",t)),Xn(this,Da).on("ready",()=>{}),io(this,Hr,jv).call(this)},ON=function(){if(Xn(Yn,gu)||Xn(Yn,od,Uv)){io(this,Hr,Dp).call(this);return}let{workerSrc:t}=Yn;try{Yn._isSameOrigin(window.location,t)||(t=Yn._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Cp("main","worker",e),r=()=>{s.abort(),i.destroy(),e.terminate(),this.destroyed?Xn(this,fc).reject(new Error("Worker was destroyed")):io(this,Hr,Dp).call(this)},s=new AbortController;e.addEventListener("error",()=>{Xn(this,mu)||r()},{signal:s.signal}),i.on("test",l=>{if(s.abort(),this.destroyed||!l){r();return}is(this,Da,i),is(this,ol,e),is(this,mu,e),io(this,Hr,jv).call(this)}),i.on("ready",l=>{if(s.abort(),this.destroyed){r();return}try{a()}catch{io(this,Hr,Dp).call(this)}});const a=()=>{const l=new Uint8Array;i.send("test",l,[l.buffer])};a();return}catch{K1("The worker has been disabled.")}io(this,Hr,Dp).call(this)},Dp=function(){Xn(Yn,gu)||(Ve("Setting up fake worker."),is(Yn,gu,!0)),Yn._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Xn(this,fc).reject(new Error("Worker was destroyed"));return}const e=new U9;is(this,ol,e);const i=`fake${KT(Yn,j1)._++}`,r=new Cp(i+"_worker",i,e);t.setup(r,e),is(this,Da,new Cp(i,i+"_worker",e)),io(this,Hr,jv).call(this)}).catch(t=>{Xn(this,fc).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},od=new WeakSet,Uv=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},no(Yn,od),no(Yn,j1,0),no(Yn,gu,!1),no(Yn,vu,new WeakMap),Pr&&(is(Yn,gu,!0),pc.workerSrc||="./pdf.worker.mjs"),Yn._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const r=new URL(e,i);return i.origin===r.origin},Yn._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Yn.fromPort=t=>{if(O9("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Yn.create(t)};let md=Yn;class Rj{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#s=null;constructor(t,e,i,r,s){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new CN,this.fontLoader=new M9({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#r(t,e=null){const i=this.#t.get(t);if(i)return i;const r=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,r),r}get annotationStorage(){return rn(this,"annotationStorage",new h2)}getRenderingIntent(t,e=go.ENABLE,i=null,r=!1,s=!1){let a=Ss.DISPLAY,l=Mw;switch(t){case"any":a=Ss.ANY;break;case"display":break;case"print":a=Ss.PRINT;break;default:Ve(`getRenderingIntent - invalid intent: ${t}`)}const u=a&Ss.PRINT&&i instanceof pN?i:this.annotationStorage;switch(e){case go.DISABLE:a+=Ss.ANNOTATIONS_DISABLE;break;case go.ENABLE:break;case go.ENABLE_FORMS:a+=Ss.ANNOTATIONS_FORMS;break;case go.ENABLE_STORAGE:a+=Ss.ANNOTATIONS_STORAGE,l=u.serializable;break;default:Ve(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(a+=Ss.IS_EDITING),s&&(a+=Ss.OPLIST);const{ids:f,hash:d}=u.modifiedIds,p=[a,l.hash,d];return{renderingIntent:a,cacheKey:p.join("_"),annotationStorageSerializable:l,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Zp.cleanup(),this._networkStream?.cancelAllRequests(new yl("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,r)=>{Ai(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},r.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){r.close();return}Ai(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{this._fullReader.cancel(s),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:s,contentLength:a}=this._fullReader;return(!r||!s)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=l=>{e.onProgress?.({loaded:l.loaded,total:l.total})}),{isStreamingSupported:r,isRangeSupported:s,contentLength:a}}),t.on("GetRangeReader",(i,r)=>{Ai(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(i.begin,i.end);if(!s){r.close();return}r.onPull=()=>{s.read().then(function({value:a,done:l}){if(l){r.close();return}Ai(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{s.cancel(a),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new Dj(i,this))}),t.on("DocException",i=>{e._capability.reject(as(i))}),t.on("PasswordRequest",i=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw as(i);const r=s=>{s instanceof Error?this.#s.reject(s):this.#s.resolve({password:s})};e.onPassword(r,i.code)}catch(r){this.#s.reject(r)}return this.#s.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,r,s])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":if("error"in s){const f=s.error;Ve(`Error during font loading: ${f}`),this.commonObjs.resolve(i,f);break}const a=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,d)=>globalThis.FontInspector.fontAdded(f,d):null,l=new F9(s,a);this.fontLoader.bind(l).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(i,l)});break;case"CopyLocalImage":const{imageRef:u}=s;Ai(u,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,d]of f.objs)if(d?.ref===u)return d.dataLen?(this.commonObjs.resolve(i,structuredClone(d)),d.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,s);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([i,r,s,a])=>{if(this.destroyed)return;const l=this.#e.get(r);if(!l.objs.has(i)){if(l._intentStates.size===0){a?.bitmap?.close();return}switch(s){case"Image":case"Pattern":l.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[i.type];if(!r)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ve("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#n.get(e);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#i.set(s.refStr,t);const a=new Oj(e,s,this,this._params.pdfBug);return this.#e.set(e,a),a});return this.#n.set(e,r),r}getPageIndex(t){return Fw(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#r("GetOptionalContentConfig").then(e=>new lj(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new aj(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Zp.cleanup()}}cachedPageNumber(t){if(!Fw(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class Nj{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class qf{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:r,annotationCanvasMap:s,operatorList:a,pageIndex:l,canvasFactory:u,filterFactory:f,useRequestAnimationFrame:d=!1,pdfBug:p=!1,pageColors:m=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=u,this.filterFactory=f,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Nj(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(qf.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");qf.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:r,transform:s,background:a}=this.params;this.gfx=new Zf(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:r,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),qf.#e.delete(this._canvas),t||=new Z1(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),qf.#e.delete(this._canvas),this.callback())))}}const RN="5.3.31",NN="47ad820d9";function yD(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function up(n){return Math.max(0,Math.min(255,255*n))}class _D{static CMYK_G([t,e,i,r]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=up(t),[t,t,t]}static G_HTML([t]){const e=yD(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(up)}static RGB_HTML(t){return`#${t.map(yD).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,i+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,i,r]){return[up(1-Math.min(1,t+r)),up(1-Math.min(1,i+r)),up(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const r=1-t,s=1-e,a=1-i,l=Math.min(r,s,a);return["CMYK",r,s,a,l]}}class Lj{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Pn("Abstract method `_createSVG` called.")}}class Jp extends Lj{_createSVG(t){return document.createElementNS(nl,t)}}class _2{static setupStorage(t,e,i,r,s){const a=r.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),s==="print")break;t.addEventListener("input",l=>{r.setValue(e,{value:l.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{r.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),s==="print")break;t.addEventListener("input",l=>{r.setValue(e,{value:l.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const l of i.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const u=l.target.options,f=u.selectedIndex===-1?"":u[u.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:r,linkService:s}){const{attributes:a}=e,l=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${r}`);for(const[u,f]of Object.entries(a))if(f!=null)switch(u){case"class":f.length&&t.setAttribute(u,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!l||u!=="href"&&u!=="newWindow")&&t.setAttribute(u,f)}l&&s.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,r=t.xfaHtml,s=t.intent||"display",a=document.createElement(r.name);r.attributes&&this.setAttributes({html:a,element:r,intent:s,linkService:i});const l=s!=="richText",u=t.div;if(u.append(a),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;u.style.transform=p}l&&u.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const p=document.createTextNode(r.value);a.append(p),l&&Qp.shouldBuildText(r.name)&&f.push(p)}return{textDivs:f}}const d=[[r,-1,a]];for(;d.length>0;){const[p,m,g]=d.at(-1);if(m+1===p.children.length){d.pop();continue}const y=p.children[++d.at(-1)[1]];if(y===null)continue;const{name:x}=y;if(x==="#text"){const b=document.createTextNode(y.value);f.push(b),g.append(b);continue}const _=y?.attributes?.xmlns?document.createElementNS(y.attributes.xmlns,x):document.createElement(x);if(g.append(_),y.attributes&&this.setAttributes({html:_,element:y,storage:e,intent:s,linkService:i}),y.children?.length>0)d.push([y,-1,_]);else if(y.value){const b=document.createTextNode(y.value);l&&Qp.shouldBuildText(x)&&f.push(b),_.append(b)}}for(const p of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const F0=1e3,Ij=9,Au=new WeakSet;class bD{static create(t){switch(t.data.annotationType){case di.LINK:return new LN(t);case di.TEXT:return new kj(t);case di.WIDGET:switch(t.data.fieldType){case"Tx":return new Mj(t);case"Btn":return t.data.radioButton?new IN(t):t.data.checkBox?new Pj(t):new Bj(t);case"Ch":return new jj(t);case"Sig":return new Fj(t)}return new ju(t);case di.POPUP:return new Bw(t);case di.FREETEXT:return new kN(t);case di.LINE:return new zj(t);case di.SQUARE:return new Hj(t);case di.CIRCLE:return new $j(t);case di.POLYLINE:return new MN(t);case di.CARET:return new Vj(t);case di.INK:return new b2(t);case di.POLYGON:return new Gj(t);case di.HIGHLIGHT:return new FN(t);case di.UNDERLINE:return new Wj(t);case di.SQUIGGLY:return new Xj(t);case di.STRIKEOUT:return new Yj(t);case di.STAMP:return new PN(t);case di.FILEATTACHMENT:return new qj(t);default:return new mi(t)}}}class mi{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t?.str||e?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return mi._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#i(e),this.#n?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:l,pageY:u}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(a-t[3]+u)/a}%`,r===0?(e.width=`${100*(t[2]-t[0])/s}%`,e.height=`${100*(t[3]-t[1])/a}%`):this.setRotation(r)}_createContainer(t){const{data:e,parent:{page:i,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof ju||(s.tabIndex=F0);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof Bw){const{rotation:x}=e;return!e.hasOwnCanvas&&x!==0&&this.setRotation(x,s),s}const{width:l,height:u}=this;if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const x=e.borderStyle.horizontalCornerRadius,_=e.borderStyle.verticalCornerRadius;if(x>0||_>0){const S=`calc(${x}px * var(--total-scale-factor)) / calc(${_}px * var(--total-scale-factor))`;a.borderRadius=S}else if(this instanceof IN){const S=`calc(${l}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;a.borderRadius=S}switch(e.borderStyle.style){case Gf.SOLID:a.borderStyle="solid";break;case Gf.DASHED:a.borderStyle="dashed";break;case Gf.BEVELED:Ve("Unimplemented border style: beveled");break;case Gf.INSET:Ve("Unimplemented border style: inset");break;case Gf.UNDERLINE:a.borderBottomStyle="solid";break}const b=e.borderColor||null;b?(this.#e=!0,a.borderColor=Ee.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):a.borderWidth=0}const f=Ee.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:d,pageHeight:p,pageX:m,pageY:g}=r.rawDims;a.left=`${100*(f[0]-m)/d}%`,a.top=`${100*(f[1]-g)/p}%`;const{rotation:y}=e;return e.hasOwnCanvas||y===0?(a.width=`${100*l/d}%`,a.height=`${100*u/p}%`):this.setRotation(y,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims;let{width:s,height:a}=this;t%180!==0&&([s,a]=[a,s]),e.style.width=`${100*s/i}%`,e.style.height=`${100*a/r}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,r)=>{const s=r.detail[e],a=s[0],l=s.slice(1);r.target.style[i]=_D[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[i]:_D[`${a}_rgb`](l)})};return rn(this,"_commonActions",{display:e=>{const{display:i}=e.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const r of Object.keys(e.detail))(t[r]||i[r])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[r,s]of Object.entries(e)){const a=i[r];if(a){const l={detail:{[r]:s},target:t};a(l),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,r,s]=this.data.rect.map(x=>Math.fround(x));if(t.length===8){const[x,_,b,S]=t.subarray(2,6);if(r===x&&s===_&&e===b&&i===S)return}const{style:a}=this.container;let l;if(this.#e){const{borderColor:x,borderWidth:_}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const u=r-e,f=s-i,{svgFactory:d}=this,p=d.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0);const m=d.createElement("defs");p.append(m);const g=d.createElement("clipPath"),y=`clippath_${this.data.id}`;g.setAttribute("id",y),g.setAttribute("clipPathUnits","objectBoundingBox"),m.append(g);for(let x=2,_=t.length;x<_;x+=8){const b=t[x],S=t[x+1],A=t[x+2],C=t[x+3],O=d.createElement("rect"),N=(A-e)/u,D=(s-S)/f,L=(b-A)/u,I=(S-C)/f;O.setAttribute("x",N),O.setAttribute("y",D),O.setAttribute("width",L),O.setAttribute("height",I),g.append(O),l?.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${D}" width="${L}" height="${I}"/>`)}this.#e&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(p),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:t}=this,e=this.#n=new Bw({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){Pn("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:s,id:a,exportValues:l}of r){if(s===-1||a===e)continue;const u=typeof l=="string"?l:null,f=document.querySelector(`[data-element-id="${a}"]`);if(f&&!Au.has(f)){Ve(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:u,domElement:f})}return i}for(const r of document.getElementsByName(t)){const{exportValue:s}=r,a=r.getAttribute("data-element-id");a!==e&&Au.has(r)&&i.push({id:a,exportValue:s,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class LN extends mi{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(this.#e(i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(this.#n(i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#t()}#e(t,e,i=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,i),!1),this.#t()}#n(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(e.actions)){const s=i.get(r);s&&(t[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:r}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Ve('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:r,refs:s,include:a}=e,l=[];if(r.length!==0||s.length!==0){const d=new Set(s);for(const p of r){const m=this._fieldObjects[p]||[];for(const{id:g}of m)d.add(g)}for(const p of Object.values(this._fieldObjects))for(const m of p)d.has(m.id)===a&&l.push(m)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const u=this.annotationStorage,f=[];for(const d of l){const{id:p}=d;switch(f.push(p),d.type){case"text":{const g=d.defaultValue||"";u.setValue(p,{value:g});break}case"checkbox":case"radiobutton":{const g=d.defaultValue===d.exportValues;u.setValue(p,{value:g});break}case"combobox":case"listbox":{const g=d.defaultValue||"";u.setValue(p,{value:g});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!Au.has(m)){Ve(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class kj extends mi{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class ju extends mi{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return $i.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,r,s){i.includes("mouse")?t.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a)}})})}_setEventListeners(t,e,i,r){for(const[s,a]of i)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,s,a,r),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Ee.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||Ij,s=t.style;let a;const l=2,u=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-l),d=Math.round(f/(C_*r))||1,p=f/d;a=Math.min(r,u(p/C_))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(r,u(f/C_))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=Ee.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Mj extends ju{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,r){const s=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),s.setValue(a.id,{[r]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=t.getValue(e,{value:this.data.fieldValue});let s=r.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&s.length>a&&(s=s.slice(0,a));let l=r.formattedValue||this.data.textContent?.join(`
`)||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const u={userValue:s,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=l??s,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",l??s),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Au.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=F0,this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",d=>{t.setValue(e,{value:d.target.value}),this.setPropertyOnSiblings(i,"value",d.target.value,"value"),u.formattedValue=null}),i.addEventListener("resetform",d=>{const p=this.data.defaultFieldValue??"";i.value=u.userValue=p,u.formattedValue=null});let f=d=>{const{formattedValue:p}=u;p!=null&&(d.target.value=p),d.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",p=>{if(u.focused)return;const{target:m}=p;u.userValue&&(m.value=u.userValue),u.lastCommittedValue=m.value,u.commitKey=1,this.data.actions?.Focus||(u.focused=!0)}),i.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const m={value(g){u.userValue=g.detail.value??"",t.setValue(e,{value:u.userValue.toString()}),g.target.value=u.userValue},formattedValue(g){const{formattedValue:y}=g.detail;u.formattedValue=y,y!=null&&g.target!==document.activeElement&&(g.target.value=y),t.setValue(e,{formattedValue:y})},selRange(g){g.target.setSelectionRange(...g.detail.selRange)},charLimit:g=>{const{charLimit:y}=g.detail,{target:x}=g;if(y===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",y);let _=u.userValue;!_||_.length<=y||(_=_.slice(0,y),x.value=u.userValue=_,t.setValue(e,{value:_}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(m,p)}),i.addEventListener("keydown",p=>{u.commitKey=1;let m=-1;if(p.key==="Escape"?m=0:p.key==="Enter"&&!this.data.multiLine?m=2:p.key==="Tab"&&(u.commitKey=3),m===-1)return;const{value:g}=p.target;u.lastCommittedValue!==g&&(u.lastCommittedValue=g,u.userValue=g,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:g,willCommit:!0,commitKey:m,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const d=f;f=null,i.addEventListener("blur",p=>{if(!u.focused||!p.relatedTarget)return;this.data.actions?.Blur||(u.focused=!1);const{value:m}=p.target;u.userValue=m,u.lastCommittedValue!==m&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:u.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}),d(p)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",p=>{u.lastCommittedValue=null;const{data:m,target:g}=p,{value:y,selectionStart:x,selectionEnd:_}=g;let b=x,S=_;switch(p.inputType){case"deleteWordBackward":{const A=y.substring(0,x).match(/\w*[^\w]*$/);A&&(b-=A[0].length);break}case"deleteWordForward":{const A=y.substring(x).match(/^[^\w]*\w*/);A&&(S+=A[0].length);break}case"deleteContentBackward":x===_&&(b-=1);break;case"deleteContentForward":x===_&&(S+=1);break}p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,change:m||"",willCommit:!1,selStart:b,selEnd:S}})}),this._setEventListeners(i,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(f&&i.addEventListener("blur",f),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Fj extends ju{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Pj extends ju{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let r=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Au.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,r&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=F0,s.addEventListener("change",a=>{const{name:l,checked:u}=a.target;for(const f of this._getElementsByName(l,i)){const d=u&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=d),t.setValue(f.id,{value:d})}t.setValue(i,{value:u})}),s.addEventListener("resetform",a=>{const l=e.defaultFieldValue||"Off";a.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const l={value(u){u.target.checked=u.detail.value!=="Off",t.setValue(i,{value:u.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class IN extends ju{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let r=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(i,{value:r})),r)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const s=document.createElement("input");if(Au.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,r&&s.setAttribute("checked",!0),s.tabIndex=F0,s.addEventListener("change",a=>{const{name:l,checked:u}=a.target;for(const f of this._getElementsByName(l,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:u})}),s.addEventListener("resetform",a=>{const l=e.defaultFieldValue;a.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const u={value:f=>{const d=a===f.detail.value;for(const p of this._getElementsByName(f.target.name)){const m=d&&p.id===i;p.domElement&&(p.domElement.checked=m),t.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Bj extends LN{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class jj extends ju{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");Au.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=F0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",d=>{const p=this.data.defaultFieldValue;for(const m of r.options)m.selected=m.value===p});for(const d of this.data.options){const p=document.createElement("option");p.textContent=d.displayValue,p.value=d.exportValue,i.value.includes(d.exportValue)&&(p.setAttribute("selected",!0),s=!1),r.append(p)}let a=null;if(s){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),r.prepend(d),a=()=>{d.remove(),r.removeEventListener("input",a),a=null},r.addEventListener("input",a)}const l=d=>{const p=d?"value":"textContent",{options:m,multiple:g}=r;return g?Array.prototype.filter.call(m,y=>y.selected).map(y=>y[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let u=l(!1);const f=d=>{const p=d.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",d=>{const p={value(m){a?.();const g=m.detail.value,y=new Set(Array.isArray(g)?g:[g]);for(const x of r.options)x.selected=y.has(x.value);t.setValue(e,{value:l(!0)}),u=l(!1)},multipleSelection(m){r.multiple=!0},remove(m){const g=r.options,y=m.detail.remove;g[y].selected=!1,r.remove(y),g.length>0&&Array.prototype.findIndex.call(g,_=>_.selected)===-1&&(g[0].selected=!0),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},clear(m){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),u=l(!1)},insert(m){const{index:g,displayValue:y,exportValue:x}=m.detail.insert,_=r.children[g],b=document.createElement("option");b.textContent=y,b.value=x,_?_.before(b):r.append(b),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},items(m){const{items:g}=m.detail;for(;r.length!==0;)r.remove(0);for(const y of g){const{displayValue:x,exportValue:_}=y,b=document.createElement("option");b.textContent=x,b.value=_,r.append(b)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},indices(m){const g=new Set(m.detail.indices);for(const y of m.target.options)y.selected=g.has(y.index);t.setValue(e,{value:l(!0)}),u=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,d)}),r.addEventListener("input",d=>{const p=l(!0),m=l(!1);t.setValue(e,{value:p}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:u,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):r.addEventListener("input",function(d){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Bw extends mi{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:mi._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new Uj({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${l2}${i}`).join(",")),this.container}}class Uj{#t=this.#C.bind(this);#e=this.#T.bind(this);#n=this.#D.bind(this);#i=this.#w.bind(this);#s=null;#r=null;#l=null;#o=null;#f=null;#c=null;#d=null;#u=!1;#h=null;#a=null;#p=null;#g=null;#m=null;#v=null;#x=!1;constructor({container:t,color:e,elements:i,titleObj:r,modificationDate:s,contentsObj:a,richText:l,parent:u,rect:f,parentRect:d,open:p}){this.#r=t,this.#m=r,this.#l=a,this.#g=l,this.#c=u,this.#s=e,this.#p=f,this.#d=d,this.#f=i,this.#o=c2.toDateObject(s),this.trigger=i.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",this.#i),m.addEventListener("mouseenter",this.#n),m.addEventListener("mouseleave",this.#e),m.classList.add("popupTriggerArea");for(const m of i)m.container?.addEventListener("keydown",this.#t);this.#r.hidden=!0,p&&this.#w()}render(){if(this.#h)return;const t=this.#h=document.createElement("div");if(t.className="popup",this.#s){const s=t.style.outlineColor=Ee.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=this.#m,t.append(e),this.#o){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),e.append(s)}const r=this.#y;if(r)_2.render({xfaHtml:r,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#l);t.append(s)}this.#r.append(t)}get#y(){const t=this.#g,e=this.#l;return t?.str&&(!e?.str||e.str===t.str)&&this.#g.html||null}get#b(){return this.#y?.attributes?.style?.fontSize||0}get#E(){return this.#y?.attributes?.style?.color||null}#S(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:this.#E,fontSize:this.#b?`calc(${this.#b}px * var(--total-scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:r});return i}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const r=t.split(/(?:\r\n?|\n)/);for(let s=0,a=r.length;s<a;++s){const l=r[s];i.append(document.createTextNode(l)),s<a-1&&i.append(document.createElement("br"))}return i}#C(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#u)&&this.#w()}updateEdited({rect:t,popupContent:e}){this.#v||={contentsObj:this.#l,richText:this.#g},t&&(this.#a=null),e&&(this.#g=this.#S(e),this.#l=null),this.#h?.remove(),this.#h=null}resetEdited(){this.#v&&({contentsObj:this.#l,richText:this.#g}=this.#v,this.#v=null,this.#h?.remove(),this.#h=null,this.#a=null)}#O(){if(this.#a!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:r,pageY:s}}}=this.#c;let a=!!this.#d,l=a?this.#d:this.#p;for(const y of this.#f)if(!l||Ee.intersect(y.data.rect,l)!==null){l=y.data.rect,a=!0;break}const u=Ee.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),d=a?l[2]-l[0]+5:0,p=u[0]+d,m=u[1];this.#a=[100*(p-r)/e,100*(m-s)/i];const{style:g}=this.#r;g.left=`${this.#a[0]}%`,g.top=`${this.#a[1]}%`}#w(){this.#u=!this.#u,this.#u?(this.#D(),this.#r.addEventListener("click",this.#i),this.#r.addEventListener("keydown",this.#t)):(this.#T(),this.#r.removeEventListener("click",this.#i),this.#r.removeEventListener("keydown",this.#t))}#D(){this.#h||this.render(),this.isVisible?this.#u&&this.#r.classList.add("focused"):(this.#O(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#T(){this.#r.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#r.hidden=!0)}maybeShow(){this.#x&&(this.#h||this.#D(),this.#x=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class kN extends mi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=$e.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class zj extends mi{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),s=this.#t=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),r.append(s),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Hj extends mi{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",s/2),a.setAttribute("y",s/2),a.setAttribute("width",e-s),a.setAttribute("height",i-s),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class $j extends mi{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",e/2),a.setAttribute("cy",i/2),a.setAttribute("rx",e/2-s/2),a.setAttribute("ry",i/2-s/2),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class MN extends mi{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:r},width:s,height:a}=this;if(!e)return this.container;const l=this.svgFactory.create(s,a,!0);let u=[];for(let d=0,p=e.length;d<p;d+=2){const m=e[d]-t[0],g=t[3]-e[d+1];u.push(`${m},${g}`)}u=u.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",u),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),l.append(f),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Gj extends MN{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Vj extends mi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class b2 extends mi{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?$e.HIGHLIGHT:$e.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:r,popupRef:s}}=this,{transform:a,width:l,height:u}=this.#n(e,t),f=this.svgFactory.create(l,u,!0),d=this.#t=this.svgFactory.createElement("svg:g");f.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",a);for(let p=0,m=i.length;p<m;p++){const g=this.svgFactory.createElement(this.svgElementName);this.#e.push(g),g.setAttribute("points",i[p].join(",")),d.append(g)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:r}=t,s=this.#t;if(e>=0&&s.setAttribute("stroke-width",e||1),i)for(let a=0,l=this.#e.length;a<l;a++)this.#e[a].setAttribute("points",i[a].join(","));if(r){const{transform:a,width:l,height:u}=this.#n(this.data.rotation,r);s.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),s.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class FN extends mi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=$e.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Wj extends mi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Xj extends mi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Yj extends mi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class PN extends mi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=$e.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class qj extends mi{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:r}=$i.platform;return t.addEventListener("keydown",s=>{s.key==="Enter"&&(r?s.metaKey:s.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let w2=class BN{#t=null;#e=null;#n=new Map;#i=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:r,page:s,viewport:a,structTreeLayer:l}){this.div=t,this.#t=e,this.#e=i,this.#i=l||null,this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#n.size>0}async#s(t,e){const i=t.firstChild||t,r=i.id=`${l2}${e}`,s=await this.#i?.getAriaAttributes(r);if(s)for(const[a,l]of s)i.setAttribute(a,l);this.div.append(t),this.#t?.moveElementInDOM(this.div,t,i,!1)}async render(t){const{annotations:e}=t,i=this.div;_c(i,this.viewport);const r=new Map,s={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Jp,annotationStorage:t.annotationStorage||new h2,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const l=a.annotationType===di.POPUP;if(l){const d=r.get(a.id);if(!d)continue;s.elements=d}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;s.data=a;const u=bD.create(s);if(!u.isRenderable)continue;if(!l&&a.popupRef){const d=r.get(a.popupRef);d?d.push(u):r.set(a.popupRef,[u])}const f=u.render();a.hidden&&(f.style.visibility="hidden"),await this.#s(f,a.id),u._isEditable&&(this.#n.set(u.data.id,u),this._annotationEditorUIManager?.renderAnnotationElement(u))}this.#r()}async addLinkAnnotations(t,e){const i={data:null,layer:this.div,linkService:e,svgFactory:new Jp,parent:this};for(const r of t){r.borderStyle||=BN._defaultBorderStyle,i.data=r;const s=bD.create(i);if(!s.isRenderable)continue;const a=s.render();await this.#s(a,r.id)}}update({viewport:t}){const e=this.div;this.viewport=t,_c(e,{rotation:t.rotation}),this.#r(),e.hidden=!1}#r(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const r=t.querySelector(`[data-annotation-id="${e}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:s}=r;s?s.nodeName==="CANVAS"?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):r.append(i);const a=this.#n.get(e);a&&(a._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,r.id,i),a._hasNoCanvas=!1):a.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}static get _defaultBorderStyle(){return rn(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Gf.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const zg=/\r\n?|\n/g;class Mi extends Re{#t;#e="";#n=`${this.id}-editor`;#i=null;#s;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Mi.prototype,e=s=>s.isEmpty(),i=_l.TRANSLATE_SMALL,r=_l.TRANSLATE_BIG;return rn(this,"_keyboardManager",new I0([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}]]))}static _type="freetext";static _editorType=$e.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||Mi._defaultColor||Re._defaultLineColor,this.#s=t.fontSize||Mi._defaultFontSize}static initialize(t,e){Re.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case sn.FREETEXT_SIZE:Mi._defaultFontSize=e;break;case sn.FREETEXT_COLOR:Mi._defaultColor=e;break}}updateParams(t,e){switch(t){case sn.FREETEXT_SIZE:this.#r(e);break;case sn.FREETEXT_COLOR:this.#l(e);break}}static get defaultPropertiesToUpdate(){return[[sn.FREETEXT_SIZE,Mi._defaultFontSize],[sn.FREETEXT_COLOR,Mi._defaultColor||Re._defaultLineColor]]}get propertiesToUpdate(){return[[sn.FREETEXT_SIZE,this.#s],[sn.FREETEXT_COLOR,this.#t]]}#r(t){const e=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#s)*this.parentScale),this.#s=r,this.#f()},i=this.#s;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:sn.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(t){const e=r=>{this.#t=this.editorDiv.style.color=r},i=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:sn.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Mi._internalPadding*t,-(Mi._internalPadding+this.#s)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(Mi.#c(i)),e=i);return t.join(`
`)}#f(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:s}=this,a=s.style.display,l=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",r.div.append(this.div),i=s.getBoundingClientRect(),s.remove(),s.style.display=a,s.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const i=r=>{if(this.#e=r,!r){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#f()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#f()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Mi._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,i.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,s]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[f,d]=this.pageDimensions,[p,m]=this.pageTranslation;let g,y;switch(this.rotation){case 0:g=t+(a[0]-p)/f,y=e+this.height-(a[1]-m)/d;break;case 90:g=t+(a[0]-p)/f,y=e-(a[1]-m)/d,[l,u]=[u,-l];break;case 180:g=t-this.width+(a[0]-p)/f,y=e-(a[1]-m)/d,[l,u]=[-l,-u];break;case 270:g=t+(a[0]-p-this.height*d)/f,y=e+(a[1]-m-this.width*f)/d,[l,u]=[-u,l];break}this.setAt(g*r,y*s,l,u)}else this._moveAfterPaste(t,e);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(zg,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=Mi.#h(e.getData("text")||"").replaceAll(zg,`
`);if(!r)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const a=s.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:l,startOffset:u}=a,f=[],d=[];if(l.nodeType===Node.TEXT_NODE){const g=l.parentElement;if(d.push(l.nodeValue.slice(u).replaceAll(zg,"")),g!==this.editorDiv){let y=f;for(const x of this.editorDiv.childNodes){if(x===g){y=d;continue}y.push(Mi.#c(x))}}f.push(l.nodeValue.slice(0,u).replaceAll(zg,""))}else if(l===this.editorDiv){let g=f,y=0;for(const x of this.editorDiv.childNodes)y++===u&&(g=d),g.push(Mi.#c(x))}this.#e=`${f.join(`
`)}${r}${d.join(`
`)}`,this.#d();const p=new Range;let m=Math.sumPrecise(f.map(g=>g.length));for(const{firstChild:g}of this.editorDiv.childNodes)if(g.nodeType===Node.TEXT_NODE){const y=g.nodeValue.length;if(m<=y){p.setStart(g,m),p.setEnd(g,m);break}m-=y}s.removeAllRanges(),s.addRange(p)}#d(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(" "," ")}static#h(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,i){let r=null;if(t instanceof kN){const{data:{defaultAppearanceData:{fontSize:a,fontColor:l},rect:u,rotation:f,id:d,popupRef:p},textContent:m,textPosition:g,parent:{page:{pageNumber:y}}}=t;if(!m||m.length===0)return null;r=t={annotationType:$e.FREETEXT,color:Array.from(l),fontSize:a,value:m.join(`
`),position:g,pageIndex:y-1,rect:u.slice(0),rotation:f,id:d,deleted:!1,popupRef:p}}const s=await super.deserialize(t,e,i);return s.#s=t.fontSize,s.#t=Ee.makeHexColor(...t.color),s.#e=Mi.#h(t.value),s.annotationElementId=t.id||null,s._initialData=r,s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Mi._internalPadding*this.parentScale,i=this.getRect(e,e),r=Re._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),s={annotationType:$e.FREETEXT,color:r,fontSize:this.#s,value:this.#u(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(s.isCopy=!0,s):this.annotationElementId&&!this.#a(s)?null:(s.id=this.annotationElementId,s)}#a(t){const{value:e,fontSize:i,color:r,pageIndex:s}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((a,l)=>a!==r[l])||t.pageIndex!==s}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:i}=e;i.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,i.color=this.#t,e.replaceChildren();for(const s of this.#e.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),e.append(a)}const r=Mi._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:this.#e}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class me{static PRECISION=1e-4;toSVGPath(){Pn("Abstract method `toSVGPath` must be implemented.")}get box(){Pn("Abstract getter `box` must be implemented.")}serialize(t,e){Pn("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,r,s,a){a||=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l+=2)a[l]=e+t[l]*r,a[l+1]=i+t[l+1]*s;return a}static _rescaleAndSwap(t,e,i,r,s,a){a||=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l+=2)a[l]=e+t[l+1]*r,a[l+1]=i+t[l]*s;return a}static _translate(t,e,i,r){r||=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s+=2)r[s]=e+t[s],r[s+1]=i+t[s+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,r,s){switch(s){case 90:return[1-e/i,t/r];case 180:return[1-t/i,1-e/r];case 270:return[e/i,1-t/r];default:return[t/i,e/r]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,r,s,a){return[(t+5*i)/6,(e+5*r)/6,(5*i+s)/6,(5*r+a)/6,(i+s)/2,(r+a)/2]}}class hu{#t;#e=[];#n;#i;#s=[];#r=new Float32Array(18);#l;#o;#f;#c;#d;#u;#h=[];static#a=8;static#p=2;static#g=hu.#a+hu.#p;constructor({x:t,y:e},i,r,s,a,l=0){this.#t=i,this.#u=s*r,this.#i=a,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=l,this.#c=hu.#a*r,this.#f=hu.#g*r,this.#d=r,this.#h.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#m(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[i,r,s,a]=this.#t;return[(this.#l+(t[0]-e[0])/2-i)/s,(this.#o+(t[1]-e[1])/2-r)/a,(this.#l+(e[0]-t[0])/2-i)/s,(this.#o+(e[1]-t[1])/2-r)/a]}add({x:t,y:e}){this.#l=t,this.#o=e;const[i,r,s,a]=this.#t;let[l,u,f,d]=this.#r.subarray(8,12);const p=t-f,m=e-d,g=Math.hypot(p,m);if(g<this.#f)return!1;const y=g-this.#c,x=y/g,_=x*p,b=x*m;let S=l,A=u;l=f,u=d,f+=_,d+=b,this.#h?.push(t,e);const C=-b/y,O=_/y,N=C*this.#u,D=O*this.#u;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+N,d+D],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-N,d-D],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([l+N,u+D],2),this.#s.push(NaN,NaN,NaN,NaN,(l+N-i)/s,(u+D-r)/a),this.#r.set([l-N,u-D],14),this.#e.push(NaN,NaN,NaN,NaN,(l-N-i)/s,(u-D-r)/a)),this.#r.set([S,A,l,u,f,d],6),!this.isEmpty()):(this.#r.set([S,A,l,u,f,d],6),Math.abs(Math.atan2(A-u,S-l)-Math.atan2(b,_))<Math.PI/2?([l,u,f,d]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((l+f)/2-i)/s,((u+d)/2-r)/a),[l,u,S,A]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((S+l)/2-i)/s,((A+u)/2-r)/a),!0):([S,A,l,u,f,d]=this.#r.subarray(0,6),this.#s.push(((S+5*l)/6-i)/s,((A+5*u)/6-r)/a,((5*l+f)/6-i)/s,((5*u+d)/6-r)/a,((l+f)/2-i)/s,((u+d)/2-r)/a),[f,d,l,u,S,A]=this.#r.subarray(12,18),this.#e.push(((S+5*l)/6-i)/s,((A+5*u)/6-r)/a,((5*l+f)/6-i)/s,((5*u+d)/6-r)/a,((l+f)/2-i)/s,((u+d)/2-r)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#v();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#y(i);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return this.#x(i),i.join(" ")}#v(){const[t,e,i,r]=this.#t,[s,a,l,u]=this.#m();return`M${(this.#r[2]-t)/i} ${(this.#r[3]-e)/r} L${(this.#r[4]-t)/i} ${(this.#r[5]-e)/r} L${s} ${a} L${l} ${u} L${(this.#r[16]-t)/i} ${(this.#r[17]-e)/r} L${(this.#r[14]-t)/i} ${(this.#r[15]-e)/r} Z`}#x(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,i,r,s]=this.#t,a=this.#r.subarray(4,6),l=this.#r.subarray(16,18),[u,f,d,p]=this.#m();t.push(`L${(a[0]-e)/r} ${(a[1]-i)/s} L${u} ${f} L${d} ${p} L${(l[0]-e)/r} ${(l[1]-i)/s}`)}newFreeDrawOutline(t,e,i,r,s,a){return new jN(t,e,i,r,s,a)}getOutlines(){const t=this.#s,e=this.#e,i=this.#r,[r,s,a,l]=this.#t,u=new Float32Array((this.#h?.length??0)+2);for(let p=0,m=u.length-2;p<m;p+=2)u[p]=(this.#h[p]-r)/a,u[p+1]=(this.#h[p+1]-s)/l;if(u[u.length-2]=(this.#l-r)/a,u[u.length-1]=(this.#o-s)/l,isNaN(i[6])&&!this.isEmpty())return this.#b(u);const f=new Float32Array(this.#s.length+24+this.#e.length);let d=t.length;for(let p=0;p<d;p+=2){if(isNaN(t[p])){f[p]=f[p+1]=NaN;continue}f[p]=t[p],f[p+1]=t[p+1]}d=this.#S(f,d);for(let p=e.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(e[p+m])){f[d]=f[d+1]=NaN,d+=2;continue}f[d]=e[p+m],f[d+1]=e[p+m+1],d+=2}return this.#E(f,d),this.newFreeDrawOutline(f,u,this.#t,this.#d,this.#n,this.#i)}#b(t){const e=this.#r,[i,r,s,a]=this.#t,[l,u,f,d]=this.#m(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-i)/s,(e[3]-r)/a,NaN,NaN,NaN,NaN,(e[4]-i)/s,(e[5]-r)/a,NaN,NaN,NaN,NaN,l,u,NaN,NaN,NaN,NaN,f,d,NaN,NaN,NaN,NaN,(e[16]-i)/s,(e[17]-r)/a,NaN,NaN,NaN,NaN,(e[14]-i)/s,(e[15]-r)/a],0),this.newFreeDrawOutline(p,t,this.#t,this.#d,this.#n,this.#i)}#E(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#S(t,e){const i=this.#r.subarray(4,6),r=this.#r.subarray(16,18),[s,a,l,u]=this.#t,[f,d,p,m]=this.#m();return t.set([NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-a)/u,NaN,NaN,NaN,NaN,f,d,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(r[0]-s)/l,(r[1]-a)/u],e),e+=24}}class jN extends me{#t;#e=new Float32Array(4);#n;#i;#s;#r;#l;constructor(t,e,i,r,s,a){super(),this.#l=t,this.#s=e,this.#t=i,this.#r=r,this.#n=s,this.#i=a,this.lastPoint=[NaN,NaN],this.#o(a);const[l,u,f,d]=this.#e;for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/f,t[p+1]=(t[p+1]-u)/d;for(let p=0,m=e.length;p<m;p+=2)e[p]=(e[p]-l)/f,e[p+1]=(e[p+1]-u)/d}toSVGPath(){const t=[`M${this.#l[4]} ${this.#l[5]}`];for(let e=6,i=this.#l.length;e<i;e+=6){if(isNaN(this.#l[e])){t.push(`L${this.#l[e+4]} ${this.#l[e+5]}`);continue}t.push(`C${this.#l[e]} ${this.#l[e+1]} ${this.#l[e+2]} ${this.#l[e+3]} ${this.#l[e+4]} ${this.#l[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,r],s){const a=i-t,l=r-e;let u,f;switch(s){case 0:u=me._rescale(this.#l,t,r,a,-l),f=me._rescale(this.#s,t,r,a,-l);break;case 90:u=me._rescaleAndSwap(this.#l,t,e,a,l),f=me._rescaleAndSwap(this.#s,t,e,a,l);break;case 180:u=me._rescale(this.#l,i,e,-a,l),f=me._rescale(this.#s,i,e,-a,l);break;case 270:u=me._rescaleAndSwap(this.#l,i,r,-a,-l),f=me._rescaleAndSwap(this.#s,i,r,-a,-l);break}return{outline:Array.from(u),points:[Array.from(f)]}}#o(t){const e=this.#l;let i=e[4],r=e[5];const s=[i,r,i,r];let a=i,l=r;const u=t?Math.max:Math.min;for(let d=6,p=e.length;d<p;d+=6){const m=e[d+4],g=e[d+5];if(isNaN(e[d]))Ee.pointBoundingBox(m,g,s),l<g?(a=m,l=g):l===g&&(a=u(a,m));else{const y=[1/0,1/0,-1/0,-1/0];Ee.bezierBoundingBox(i,r,...e.slice(d,d+6),y),Ee.rectBoundingBox(...y,s),l<y[3]?(a=y[2],l=y[3]):l===y[3]&&(a=u(a,y[2]))}i=m,r=g}const f=this.#e;f[0]=s[0]-this.#n,f[1]=s[1]-this.#n,f[2]=s[2]-s[0]+2*this.#n,f[3]=s[3]-s[1]+2*this.#n,this.lastPoint=[a,l]}get box(){return this.#e}newOutliner(t,e,i,r,s,a=0){return new hu(t,e,i,r,s,a)}getNewOutline(t,e){const[i,r,s,a]=this.#e,[l,u,f,d]=this.#t,p=s*f,m=a*d,g=i*f+l,y=r*d+u,x=this.newOutliner({x:this.#s[0]*p+g,y:this.#s[1]*m+y},this.#t,this.#r,t,this.#i,e??this.#n);for(let _=2;_<this.#s.length;_+=2)x.add({x:this.#s[_]*p+g,y:this.#s[_+1]*m+y});return x.getOutlines()}}class jw{#t;#e;#n=[];#i=[];constructor(t,e=0,i=0,r=!0){const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:g,y,width:x,height:_}of t){const b=Math.floor((g-e)/a)*a,S=Math.ceil((g+x+e)/a)*a,A=Math.floor((y-e)/a)*a,C=Math.ceil((y+_+e)/a)*a,O=[b,A,C,!0],N=[S,A,C,!1];this.#n.push(O,N),Ee.rectBoundingBox(b,A,S,C,s)}const l=s[2]-s[0]+2*i,u=s[3]-s[1]+2*i,f=s[0]-i,d=s[1]-i,p=this.#n.at(r?-1:-2),m=[p[0],p[2]];for(const g of this.#n){const[y,x,_]=g;g[0]=(y-f)/l,g[1]=(x-d)/u,g[2]=(_-d)/u}this.#t=new Float32Array([f,d,l,u]),this.#e=m}getOutlines(){this.#n.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#f(e)),this.#l(e)):(this.#o(e),t.push(...this.#f(e)));return this.#s(t)}#s(t){const e=[],i=new Set;for(const a of t){const[l,u,f]=a;e.push([l,u,a],[l,f,a])}e.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=e.length;a<l;a+=2){const u=e[a][2],f=e[a+1][2];u.push(f),f.push(u),i.add(u),i.add(f)}const r=[];let s;for(;i.size>0;){const a=i.values().next().value;let[l,u,f,d,p]=a;i.delete(a);let m=l,g=u;for(s=[l,f],r.push(s);;){let y;if(i.has(d))y=d;else if(i.has(p))y=p;else break;i.delete(y),[l,u,f,d,p]=y,m!==l&&(s.push(m,g,l,g===u?u:f),m=l),g=g===u?f:u}s.push(m,g)}return new Kj(r,this.#t,this.#e)}#r(t){const e=this.#i;let i=0,r=e.length-1;for(;i<=r;){const s=i+r>>1,a=e[s][0];if(a===t)return s;a<t?i=s+1:r=s-1}return r+1}#l([,t,e]){const i=this.#r(t);this.#i.splice(i,0,[t,e])}#o([,t,e]){const i=this.#r(t);for(let r=i;r<this.#i.length;r++){const[s,a]=this.#i[r];if(s!==t)break;if(s===t&&a===e){this.#i.splice(r,1);return}}for(let r=i-1;r>=0;r--){const[s,a]=this.#i[r];if(s!==t)break;if(s===t&&a===e){this.#i.splice(r,1);return}}}#f(t){const[e,i,r]=t,s=[[e,i,r]],a=this.#r(r);for(let l=0;l<a;l++){const[u,f]=this.#i[l];for(let d=0,p=s.length;d<p;d++){const[,m,g]=s[d];if(!(f<=m||g<=u)){if(m>=u){if(g>f)s[d][1]=f;else{if(p===1)return[];s.splice(d,1),d--,p--}continue}s[d][2]=u,g>f&&s.push([e,f,g])}}}return s}}class Kj extends me{#t;#e;constructor(t,e,i){super(),this.#e=t,this.#t=e,this.lastPoint=i}toSVGPath(){const t=[];for(const e of this.#e){let[i,r]=e;t.push(`M${i} ${r}`);for(let s=2;s<e.length;s+=2){const a=e[s],l=e[s+1];a===i?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,e,i,r],s){const a=[],l=i-t,u=r-e;for(const f of this.#e){const d=new Array(f.length);for(let p=0;p<f.length;p+=2)d[p]=t+f[p]*l,d[p+1]=r-f[p+1]*u;a.push(d)}return a}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Uw extends hu{newFreeDrawOutline(t,e,i,r,s,a){return new Zj(t,e,i,r,s,a)}}class Zj extends jN{newOutliner(t,e,i,r,s,a=0){return new Uw(t,e,i,r,s,a)}}class Ts{#t=null;#e=null;#n;#i=null;#s=!1;#r=!1;#l=null;#o;#f=null;#c=null;#d;static#u=null;static get _keyboardManager(){return rn(this,"_keyboardManager",new I0([[["Escape","mac+Escape"],Ts.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ts.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ts.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ts.prototype._moveToPrevious],[["Home","mac+Home"],Ts.prototype._moveToBeginning],[["End","mac+End"],Ts.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#d=sn.HIGHLIGHT_COLOR,this.#l=t):(this.#r=!0,this.#d=sn.HIGHLIGHT_DEFAULT_COLOR),this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",Ts.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#c._signal;t.addEventListener("click",this.#g.bind(this),{signal:e}),t.addEventListener("keydown",this.#p.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=this.#n,t.append(i),t}renderMainDropdown(){const t=this.#i=this.#h();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#h(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",fa,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,r]of this.#c.highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",r),s.title=i,s.setAttribute("data-l10n-id",Ts.#u[i]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=r,s.setAttribute("aria-selected",r===this.#n),s.addEventListener("click",this.#a.bind(this,r),{signal:e}),t.append(s)}return t.addEventListener("keydown",this.#p.bind(this),{signal:e}),t}#a(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#d,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const e=t.target.getAttribute("data-color");e&&this.#a(e,t)}_moveToNext(t){if(!this.#v){this.#g(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#v){this.#g(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#v){this.#g(t);return}this.#i.lastChild?.focus()}#p(t){Ts._keyboardManager.exec(this,t)}#g(t){if(this.#v){this.hideDropdown();return}if(this.#s=t.detail===0,this.#f||(this.#f=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#c.combinedSignal(this.#f)})),this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#h();this.#t.append(e)}#m(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#f?.abort(),this.#f=null}get#v(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#v){this.#l?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#c.highlightColors.values();for(const i of this.#i.children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class hi extends Re{#t=null;#e=0;#n;#i=null;#s=null;#r=null;#l=null;#o=0;#f=null;#c=null;#d=null;#u=!1;#h=null;#a;#p=null;#g="";#m;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=$e.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=hi.prototype;return rn(this,"_keyboardManager",new I0([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||hi._defaultColor,this.#m=t.thickness||hi._defaultThickness,this.#a=t.opacity||hi._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#g=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#y(t),this.#O()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#l=t.focusNode,this.#o=t.focusOffset,this.#x(),this.#O(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#x(){const t=new jw(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new jw(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{lastPoint:i}=this.#r;this.#h=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#c=t;const r=1.5;if(this.#r=t.getNewOutline(this.#m/2+r,.0025),e>=0)this.#d=e,this.#i=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const d=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:hi.#w(this.#c.box,(d-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:hi.#w(this.#r.box,d),path:{d:this.#r.toSVGPath()}})}const[s,a,l,u]=t.box;switch(this.rotation){case 0:this.x=s,this.y=a,this.width=l,this.height=u;break;case 90:{const[d,p]=this.parentDimensions;this.x=a,this.y=1-s,this.width=l*p/d,this.height=u*d/p;break}case 180:this.x=1-s,this.y=1-a,this.width=l,this.height=u;break;case 270:{const[d,p]=this.parentDimensions;this.x=1-a,this.y=s,this.width=l*p/d,this.height=u*d/p;break}}const{lastPoint:f}=this.#r;this.#h=[(f[0]-s)/l,(f[1]-a)/u]}static initialize(t,e){Re.initialize(t,e),hi._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case sn.HIGHLIGHT_DEFAULT_COLOR:hi._defaultColor=e;break;case sn.HIGHLIGHT_THICKNESS:hi._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#h}updateParams(t,e){switch(t){case sn.HIGHLIGHT_COLOR:this.#b(e);break;case sn.HIGHLIGHT_THICKNESS:this.#E(e);break}}static get defaultPropertiesToUpdate(){return[[sn.HIGHLIGHT_DEFAULT_COLOR,hi._defaultColor],[sn.HIGHLIGHT_THICKNESS,hi._defaultThickness]]}get propertiesToUpdate(){return[[sn.HIGHLIGHT_COLOR,this.color||hi._defaultColor],[sn.HIGHLIGHT_THICKNESS,this.#m||hi._defaultThickness],[sn.HIGHLIGHT_FREE,this.#u]]}#b(t){const e=(s,a)=>{this.color=s,this.#a=a,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:s,"fill-opacity":a}}),this.#s?.updateColor(s)},i=this.color,r=this.#a;this.addCommands({cmd:e.bind(this,t,hi._defaultOpacity),undo:e.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:sn.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#E(t){const e=this.#m,i=r=>{this.#m=r,this.#S(r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:sn.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#s=new Ts({editor:this}),t.addColorPicker(this.#s)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#N())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#O(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#O(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#S(t){if(!this.#u)return;this.#y({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#O(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#u),this.#f&&(this.#f.style.clipPath=this.#i))}static#w([t,e,i,r],s){switch(s){case 90:return[1-e-r,t,r,i];case 180:return[1-t-i,1-e-r,i,r];case 270:return[e,1-t-i,r,i]}return[t,e,i,r]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#u?(t=(t-this.rotation+360)%360,i=hi.#w(this.#c.box,t)):i=hi.#w([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:hi.#w(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#g&&(t.setAttribute("aria-label",this.#g),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#f=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i;const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),dN(this,this.#f,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#D(t){hi._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#T(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#N(){return this.#u?this.rotation:0}#L(){if(this.#u)return null;const[t,e]=this.pageDimensions,[i,r]=this.pageTranslation,s=this.#n,a=new Float32Array(s.length*8);let l=0;for(const{x:u,y:f,width:d,height:p}of s){const m=u*t+i,g=(1-f)*e+r;a[l]=a[l+4]=m,a[l+1]=a[l+3]=g,a[l+2]=a[l+6]=m+d*t,a[l+5]=a[l+7]=g-p*e,l+=8}return a}#I(t){return this.#c.serialize(t,this.#N())}static startHighlighting(t,e,{target:i,x:r,y:s}){const{x:a,y:l,width:u,height:f}=i.getBoundingClientRect(),d=new AbortController,p=t.combinedSignal(d),m=g=>{d.abort(),this.#A(t,g)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",pi,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",fa,{signal:p}),i.addEventListener("pointermove",this.#U.bind(this,t),{signal:p}),this._freeHighlight=new Uw({x:r,y:s},[a,l,u,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#U(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#A(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let r=null;if(t instanceof FN){const{data:{quadPoints:y,rect:x,rotation:_,id:b,color:S,opacity:A,popupRef:C},parent:{page:{pageNumber:O}}}=t;r=t={annotationType:$e.HIGHLIGHT,color:Array.from(S),opacity:A,quadPoints:y,boxes:null,pageIndex:O-1,rect:x.slice(0),rotation:_,id:b,deleted:!1,popupRef:C}}else if(t instanceof b2){const{data:{inkLists:y,rect:x,rotation:_,id:b,color:S,borderStyle:{rawWidth:A},popupRef:C},parent:{page:{pageNumber:O}}}=t;r=t={annotationType:$e.HIGHLIGHT,color:Array.from(S),thickness:A,inkLists:y,boxes:null,pageIndex:O-1,rect:x.slice(0),rotation:_,id:b,deleted:!1,popupRef:C}}const{color:s,quadPoints:a,inkLists:l,opacity:u}=t,f=await super.deserialize(t,e,i);f.color=Ee.makeHexColor(...s),f.#a=u||1,l&&(f.#m=t.thickness),f.annotationElementId=t.id||null,f._initialData=r;const[d,p]=f.pageDimensions,[m,g]=f.pageTranslation;if(a){const y=f.#n=[];for(let x=0;x<a.length;x+=8)y.push({x:(a[x]-m)/d,y:1-(a[x+1]-g)/p,width:(a[x+2]-a[x])/d,height:(a[x+1]-a[x+5])/p});f.#x(),f.#O(),f.rotate(f.rotation)}else if(l){f.#u=!0;const y=l[0],x={x:y[0]-m,y:p-(y[1]-g)},_=new Uw(x,[0,0,d,p],1,f.#m/2,!0,.001);for(let A=0,C=y.length;A<C;A+=2)x.x=y[A]-m,x.y=p-(y[A+1]-g),_.add(x);const{id:b,clipPathId:S}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);f.#y({highlightOutlines:_.getOutlines(),highlightId:b,clipPathId:S}),f.#O(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),i=Re._colorManager.convert(this.color),r={annotationType:$e.HIGHLIGHT,color:i,opacity:this.#a,thickness:this.#m,quadPoints:this.#L(),outlines:this.#I(e),pageIndex:this.pageIndex,rect:e,rotation:this.#N(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#_(r)?null:(r.id=this.annotationElementId,r)}#_(t){const{color:e}=this._initialData;return t.color.some((i,r)=>i!==e[r])}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class UN{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Pn("Not implemented")}}class ke extends Re{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#s=null;static#r=NaN;static#l=null;static#o=null;static#f=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#h())}#c({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#g(t.box)}#d(t,e){const{id:i}=e.drawLayer.draw(ke._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[r,s]of Object.entries(e))i.has(r)?Object.assign(t[r],s):t[r]=s;return t}static getDefaultDrawingOptions(t){Pn("Not implemented")}static get typesMap(){Pn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(ke.#n.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,e[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,e[r]]);return t}_updateProperty(t,e,i){const r=this._drawingOptions,s=r[e],a=l=>{r.updateProperty(e,l);const u=this.#t.updateProperty(e,l);u&&this.#g(u),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,ke._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,ke._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,ke._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#h(),this.#g(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#h(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#h(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#a([t,e,i,r]){const{parentDimensions:[s,a],rotation:l}=this;switch(l){case 90:return[e,1-t,i*(a/s),r*(s/a)];case 180:return[1-t,1-e,i,r];case 270:return[1-e,t,i*(a/s),r*(s/a)];default:return[t,e,i,r]}}#p(){const{x:t,y:e,width:i,height:r,parentDimensions:[s,a],rotation:l}=this;switch(l){case 90:return[1-e,t,i*(s/a),r*(a/s)];case 180:return[1-t,1-e,i,r];case 270:return[e,1-t,i*(s/a),r*(a/s)];default:return[t,e,i,r]}}#g(t){if([this.x,this.y,this.width,this.height]=this.#a(t),this.div){this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}this._onResized()}#m(){const{x:t,y:e,width:i,height:r,rotation:s,parentRotation:a,parentDimensions:[l,u]}=this;switch((s*4+a)/90){case 1:return[1-e-r,t,r,i];case 2:return[1-t-i,1-e-r,i,r];case 3:return[e,1-t-i,r,i];case 4:return[t,e-i*(l/u),r*(u/l),i*(l/u)];case 5:return[1-e,t,i*(l/u),r*(u/l)];case 6:return[1-t-r*(u/l),1-e,r*(u/l),i*(l/u)];case 7:return[e-i*(l/u),1-t-r*(u/l),i*(l/u),r*(u/l)];case 8:return[t-i,e-r,i,r];case 9:return[1-e,t-i,r,i];case 10:return[1-t,1-e,i,r];case 11:return[e-r,1-t,r,i];case 12:return[t-r*(u/l),e,r*(u/l),i*(l/u)];case 13:return[1-e-i*(l/u),t-r*(u/l),i*(l/u),r*(u/l)];case 14:return[1-t,1-e-i*(l/u),r*(u/l),i*(l/u)];case 15:return[e,1-t,i*(l/u),r*(u/l)];default:return[t,e,i,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ke._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#g(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[s,a]=this.parentDimensions;return this.setDims(this.width*s,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,r,s){Pn("Not implemented")}static startDrawing(t,e,i,r){const{target:s,offsetX:a,offsetY:l,pointerId:u,pointerType:f}=r;if(ke.#l&&ke.#l!==f)return;const{viewport:{rotation:d}}=t,{width:p,height:m}=s.getBoundingClientRect(),g=ke.#i=new AbortController,y=t.combinedSignal(g);if(ke.#r||=u,ke.#l??=f,window.addEventListener("pointerup",x=>{ke.#r===x.pointerId?this._endDraw(x):ke.#o?.delete(x.pointerId)},{signal:y}),window.addEventListener("pointercancel",x=>{ke.#r===x.pointerId?this._currentParent.endDrawingSession():ke.#o?.delete(x.pointerId)},{signal:y}),window.addEventListener("pointerdown",x=>{ke.#l===x.pointerType&&((ke.#o||=new Set).add(x.pointerId),ke.#n.isCancellable()&&(ke.#n.removeLastElement(),ke.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",fa,{signal:y}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),s.addEventListener("touchmove",x=>{x.timeStamp===ke.#f&&pi(x)},{signal:y}),t.toggleDrawing(),e._editorUndoBar?.hide(),ke.#n){t.drawLayer.updateProperties(this._currentDrawId,ke.#n.startNew(a,l,p,m,d));return}e.updateUIForDefaultProperties(this),ke.#n=this.createDrawerInstance(a,l,p,m,d),ke.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(ke.#s.toSVGProperties(),ke.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(ke.#f=-1,!ke.#n)return;const{offsetX:e,offsetY:i,pointerId:r}=t;if(ke.#r===r){if(ke.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,ke.#n.add(e,i)),ke.#f=t.timeStamp,pi(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,ke.#n=null,ke.#s=null,ke.#l=null,ke.#f=NaN),ke.#i&&(ke.#i.abort(),ke.#i=null,ke.#r=NaN,ke.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,ke.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=ke.#n,r=this._currentDrawId,s=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(r,i.setLastElement(s))},undo:()=>{e.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:sn.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(sn.DRAW_STEP),!ke.#n.isEmpty()){const{pageDimensions:[i,r],scale:s}=e,a=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:ke.#n.getOutlines(i*s,r*s,s,this._INNER_MARGIN),drawingOptions:ke.#s,mustBeCommitted:!t});return this._cleanup(!0),a}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,r,s,a){Pn("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:r,pageHeight:s,pageX:a,pageY:l}}=e.viewport,u=this.deserializeDraw(a,l,r,s,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#c({drawOutlines:u}),f.#h(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[r,s]=this.pageDimensions;return this.#t.serialize([e,i,r,s],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Qj{#t=new Float64Array(6);#e;#n;#i;#s;#r;#l="";#o=0;#f=new P0;#c;#d;constructor(t,e,i,r,s,a){this.#c=i,this.#d=r,this.#i=s,this.#s=a,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#n=[{line:l,points:this.#r}],this.#t.set(l,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#u(t,e){return me._normalizePoint(t,e,this.#c,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#u(t,e);const[i,r,s,a]=this.#t.subarray(2,6),l=t-s,u=e-a;return Math.hypot(this.#c*l,this.#d*u)<=2?null:(this.#r.push(t,e),isNaN(i)?(this.#t.set([s,a,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,r,s,a,t,e],0),this.#e.push(...me.createBezierPoints(i,r,s,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,r,s){this.#c=i,this.#d=r,this.#i=s,[t,e]=this.#u(t,e);const a=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const l=this.#n.at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),this.#n.push({line:a,points:this.#r}),this.#t.set(a,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#f.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#f.removeLastElement();this.#n.pop(),this.#l="";for(let t=0,e=this.#n.length;t<e;t++){const{line:i,points:r}=this.#n[t];this.#e=i,this.#r=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const t=me.svgRound(this.#e[4]),e=me.svgRound(this.#e[5]);if(this.#r.length===2)return this.#l=`${this.#l} M ${t} ${e} Z`,this.#l;if(this.#r.length<=6){const r=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,r)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const r=me.svgRound(this.#e[10]),s=me.svgRound(this.#e[11]);return this.#l=`${this.#l} L ${r} ${s}`,this.#o=12,this.#l}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let r=this.#o,s=this.#e.length;r<s;r+=6){const[a,l,u,f,d,p]=this.#e.slice(r,r+6).map(me.svgRound);i.push(`C${a} ${l} ${u} ${f} ${d} ${p}`)}return this.#l+=i.join(" "),this.#o=this.#e.length,this.#l}getOutlines(t,e,i,r){const s=this.#n.at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),this.#f.build(this.#n,t,e,i,this.#i,this.#s,r),this.#t=null,this.#e=null,this.#n=null,this.#l=null,this.#f}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class P0 extends me{#t;#e=0;#n;#i;#s;#r;#l;#o;#f;build(t,e,i,r,s,a,l){this.#s=e,this.#r=i,this.#l=r,this.#o=s,this.#f=a,this.#n=l??0,this.#i=t,this.#u()}get thickness(){return this.#f}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${me.svgRound(e[4])} ${me.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${me.svgRound(e[10])} ${me.svgRound(e[11])}`);continue}for(let i=6,r=e.length;i<r;i+=6){const[s,a,l,u,f,d]=e.subarray(i,i+6).map(me.svgRound);t.push(`C${s} ${a} ${l} ${u} ${f} ${d}`)}}return t.join("")}serialize([t,e,i,r],s){const a=[],l=[],[u,f,d,p]=this.#d();let m,g,y,x,_,b,S,A,C;switch(this.#o){case 0:C=me._rescale,m=t,g=e+r,y=i,x=-r,_=t+u*i,b=e+(1-f-p)*r,S=t+(u+d)*i,A=e+(1-f)*r;break;case 90:C=me._rescaleAndSwap,m=t,g=e,y=i,x=r,_=t+f*i,b=e+u*r,S=t+(f+p)*i,A=e+(u+d)*r;break;case 180:C=me._rescale,m=t+i,g=e,y=-i,x=r,_=t+(1-u-d)*i,b=e+f*r,S=t+(1-u)*i,A=e+(f+p)*r;break;case 270:C=me._rescaleAndSwap,m=t+i,g=e+r,y=-i,x=-r,_=t+(1-f-p)*i,b=e+(1-u-d)*r,S=t+(1-f)*i,A=e+(1-u)*r;break}for(const{line:O,points:N}of this.#i)a.push(C(O,m,g,y,x,s?new Array(O.length):null)),l.push(C(N,m,g,y,x,s?new Array(N.length):null));return{lines:a,points:l,rect:[_,b,S,A]}}static deserialize(t,e,i,r,s,{paths:{lines:a,points:l},rotation:u,thickness:f}){const d=[];let p,m,g,y,x;switch(u){case 0:x=me._rescale,p=-t/i,m=e/r+1,g=1/i,y=-1/r;break;case 90:x=me._rescaleAndSwap,p=-e/r,m=-t/i,g=1/r,y=1/i;break;case 180:x=me._rescale,p=t/i+1,m=-e/r,g=-1/i,y=1/r;break;case 270:x=me._rescaleAndSwap,p=e/r+1,m=t/i+1,g=-1/r,y=-1/i;break}if(!a){a=[];for(const b of l){const S=b.length;if(S===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(S===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const A=new Float32Array(3*(S-2));a.push(A);let[C,O,N,D]=b.subarray(0,4);A.set([NaN,NaN,NaN,NaN,C,O],0);for(let L=4;L<S;L+=2){const I=b[L],z=b[L+1];A.set(me.createBezierPoints(C,O,N,D,I,z),(L-2)*3),[C,O,N,D]=[N,D,I,z]}}}for(let b=0,S=a.length;b<S;b++)d.push({line:x(a[b].map(A=>A??NaN),p,m,g,y),points:x(l[b].map(A=>A??NaN),p,m,g,y)});const _=new this.prototype.constructor;return _.build(d,i,r,1,u,f,s),_}#c(t=this.#f){const e=this.#n+t/2*this.#l;return this.#o%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#d(){const[t,e,i,r]=this.#t,[s,a]=this.#c(0);return[t+s,e+a,i-2*s,r-2*a]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let l=4,u=r.length;l<u;l+=6)Ee.pointBoundingBox(r[l],r[l+1],t);continue}let s=r[4],a=r[5];for(let l=6,u=r.length;l<u;l+=6){const[f,d,p,m,g,y]=r.subarray(l,l+6);Ee.bezierBoundingBox(s,a,f,d,p,m,g,y,t),s=g,a=y}}const[e,i]=this.#c();t[0]=vr(t[0]-e,0,1),t[1]=vr(t[1]-i,0,1),t[2]=vr(t[2]+e,0,1),t[3]=vr(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#h(e):null}#h(t){const[e,i]=this.#c();this.#f=t;const[r,s]=this.#c(),[a,l]=[r-e,s-i],u=this.#t;return u[0]-=a,u[1]-=l,u[2]+=2*a,u[3]+=2*l,u}updateParentDimensions([t,e],i){const[r,s]=this.#c();this.#s=t,this.#r=e,this.#l=i;const[a,l]=this.#c(),u=a-r,f=l-s,d=this.#t;return d[0]-=u,d[1]-=f,d[2]+=2*u,d[3]+=2*f,d}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(me.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${me.svgRound(t)} ${me.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,r=0,s=0,a=0,l=0,u=0;switch(this.#e){case 90:r=e/t,s=-t/e,l=t;break;case 180:i=-1,a=-1,l=t,u=e;break;case 270:r=-e/t,s=t/e,u=e;break;default:return""}return`matrix(${i} ${r} ${s} ${a} ${me.svgRound(l)} ${me.svgRound(u)})`}getPathResizingSVGProperties([t,e,i,r]){const[s,a]=this.#c(),[l,u,f,d]=this.#t;if(Math.abs(f-s)<=me.PRECISION||Math.abs(d-a)<=me.PRECISION){const x=t+i/2-(l+f/2),_=e+r/2-(u+d/2);return{path:{"transform-origin":`${me.svgRound(t)} ${me.svgRound(e)}`,transform:`${this.rotationTransform} translate(${x} ${_})`}}}const p=(i-2*s)/(f-2*s),m=(r-2*a)/(d-2*a),g=f/i,y=d/r;return{path:{"transform-origin":`${me.svgRound(l)} ${me.svgRound(u)}`,transform:`${this.rotationTransform} scale(${g} ${y}) translate(${me.svgRound(s)} ${me.svgRound(a)}) scale(${p} ${m}) translate(${me.svgRound(-s)} ${me.svgRound(-a)})`}}}getPathResizedSVGProperties([t,e,i,r]){const[s,a]=this.#c(),l=this.#t,[u,f,d,p]=l;if(l[0]=t,l[1]=e,l[2]=i,l[3]=r,Math.abs(d-s)<=me.PRECISION||Math.abs(p-a)<=me.PRECISION){const _=t+i/2-(u+d/2),b=e+r/2-(f+p/2);for(const{line:S,points:A}of this.#i)me._translate(S,_,b,S),me._translate(A,_,b,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${me.svgRound(t)} ${me.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*s)/(d-2*s),g=(r-2*a)/(p-2*a),y=-m*(u+s)+t+s,x=-g*(f+a)+e+a;if(m!==1||g!==1||y!==0||x!==0)for(const{line:_,points:b}of this.#i)me._rescale(_,y,x,m,g,_),me._rescale(b,y,x,m,g,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${me.svgRound(t)} ${me.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[r,s]=i,a=this.#t,l=t-a[0],u=e-a[1];if(this.#s===r&&this.#r===s)for(const{line:f,points:d}of this.#i)me._translate(f,l,u,f),me._translate(d,l,u,d);else{const f=this.#s/r,d=this.#r/s;this.#s=r,this.#r=s;for(const{line:p,points:m}of this.#i)me._rescale(p,l,u,f,d,p),me._rescale(m,l,u,f,d,m);a[2]*=f,a[3]*=d}return a[0]=t,a[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${me.svgRound(t)} ${me.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${me.svgRound(t[0])} ${me.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class tx extends UN{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Re._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new tx(this._viewParameters);return t.updateAll(this),t}}class E2 extends ke{static _type="ink";static _editorType=$e.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Re.initialize(t,e),this._defaultDrawingOptions=new tx(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return rn(this,"typesMap",new Map([[sn.INK_THICKNESS,"stroke-width"],[sn.INK_COLOR,"stroke"],[sn.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,r,s){return new Qj(t,e,i,r,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,r,s,a){return P0.deserialize(t,e,i,r,s,a)}static async deserialize(t,e,i){let r=null;if(t instanceof b2){const{data:{inkLists:a,rect:l,rotation:u,id:f,color:d,opacity:p,borderStyle:{rawWidth:m},popupRef:g},parent:{page:{pageNumber:y}}}=t;r=t={annotationType:$e.INK,color:Array.from(d),thickness:m,opacity:p,paths:{points:a},boxes:null,pageIndex:y-1,rect:l.slice(0),rotation:u,id:f,deleted:!1,popupRef:g}}const s=await super.deserialize(t,e,i);return s.annotationElementId=t.id||null,s._initialData=r,s}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=E2.getDefaultDrawingOptions({stroke:Ee.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":l}}=this,u={annotationType:$e.INK,color:Re._colorManager.convert(s),opacity:a,thickness:l,paths:{lines:e,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:r,pageIndex:s}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==e[l])||t.thickness!==i||t.opacity!==r||t.pageIndex!==s}renderAnnotationElement(t){const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e}),null}}class zw extends P0{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Hg=8,fp=3;class lu{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,r){return i-=t,r-=e,i===0?r>0?0:4:i===1?r+6:2-r}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,i,r,s,a,l){const u=this.#e(i,r,s,a);for(let f=0;f<8;f++){const d=(-f+u-l+16)%8,p=this.#n[2*d],m=this.#n[2*d+1];if(t[(i+p)*e+(r+m)]!==0)return d}return-1}static#s(t,e,i,r,s,a,l){const u=this.#e(i,r,s,a);for(let f=0;f<8;f++){const d=(f+u+l+16)%8,p=this.#n[2*d],m=this.#n[2*d+1];if(t[(i+p)*e+(r+m)]!==0)return d}return-1}static#r(t,e,i,r){const s=t.length,a=new Int32Array(s);for(let d=0;d<s;d++)a[d]=t[d]<=r?1:0;for(let d=1;d<i-1;d++)a[d*e]=a[d*e+e-1]=0;for(let d=0;d<e;d++)a[d]=a[e*i-1-d]=0;let l=1,u;const f=[];for(let d=1;d<i-1;d++){u=1;for(let p=1;p<e-1;p++){const m=d*e+p,g=a[m];if(g===0)continue;let y=d,x=p;if(g===1&&a[m-1]===0)l+=1,x-=1;else if(g>=1&&a[m+1]===0)l+=1,x+=1,g>1&&(u=g);else{g!==1&&(u=Math.abs(g));continue}const _=[p,d],b=x===p+1,S={isHole:b,points:_,id:l,parent:0};f.push(S);let A;for(const j of f)if(j.id===u){A=j;break}A?A.isHole?S.parent=b?A.parent:u:S.parent=b?u:A.parent:S.parent=b?u:0;const C=this.#i(a,e,d,p,y,x,0);if(C===-1){a[m]=-l,a[m]!==1&&(u=Math.abs(a[m]));continue}let O=this.#n[2*C],N=this.#n[2*C+1];const D=d+O,L=p+N;y=D,x=L;let I=d,z=p;for(;;){const j=this.#s(a,e,I,z,y,x,1);O=this.#n[2*j],N=this.#n[2*j+1];const B=I+O,tt=z+N;_.push(tt,B);const k=I*e+z;if(a[k+1]===0?a[k]=-l:a[k]===1&&(a[k]=l),B===d&&tt===p&&I===D&&z===L){a[m]!==1&&(u=Math.abs(a[m]));break}else y=I,x=z,I=B,z=tt}}}return f}static#l(t,e,i,r){if(i-e<=4){for(let D=e;D<i-2;D+=2)r.push(t[D],t[D+1]);return}const s=t[e],a=t[e+1],l=t[i-4]-s,u=t[i-3]-a,f=Math.hypot(l,u),d=l/f,p=u/f,m=d*a-p*s,g=u/l,y=1/f,x=Math.atan(g),_=Math.cos(x),b=Math.sin(x),S=y*(Math.abs(_)+Math.abs(b)),A=y*(1-S+S**2),C=Math.max(Math.atan(Math.abs(b+_)*A),Math.atan(Math.abs(b-_)*A));let O=0,N=e;for(let D=e+2;D<i-2;D+=2){const L=Math.abs(m-d*t[D+1]+p*t[D]);L>O&&(N=D,O=L)}O>(f*C)**2?(this.#l(t,e,N+2,r),this.#l(t,N,i,r)):r.push(s,a)}static#o(t){const e=[],i=t.length;return this.#l(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#f(t,e,i,r,s,a){const l=new Float32Array(a**2),u=-2*r**2,f=a>>1;for(let x=0;x<a;x++){const _=(x-f)**2;for(let b=0;b<a;b++)l[x*a+b]=Math.exp((_+(b-f)**2)/u)}const d=new Float32Array(256),p=-2*s**2;for(let x=0;x<256;x++)d[x]=Math.exp(x**2/p);const m=t.length,g=new Uint8Array(m),y=new Uint32Array(256);for(let x=0;x<i;x++)for(let _=0;_<e;_++){const b=x*e+_,S=t[b];let A=0,C=0;for(let N=0;N<a;N++){const D=x+N-f;if(!(D<0||D>=i))for(let L=0;L<a;L++){const I=_+L-f;if(I<0||I>=e)continue;const z=t[D*e+I],j=l[N*a+L]*d[Math.abs(z-S)];A+=z*j,C+=j}}const O=g[b]=Math.round(A/C);y[O]++}return[g,y]}static#c(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let r=-1/0,s=1/0;for(let l=0,u=i.length;l<u;l++){if(t[(l<<2)+3]===0){r=i[l]=255;continue}const d=i[l]=t[l<<2];d>r&&(r=d),d<s&&(s=d)}const a=255/(r-s);for(let l=0;l<e;l++)i[l]=(i[l]-s)*a;return i}static#u(t){let e,i=-1/0,r=-1/0;const s=t.findIndex(u=>u!==0);let a=s,l=s;for(e=s;e<256;e++){const u=t[e];u>i&&(e-a>r&&(r=e-a,l=e-1),i=u,a=e)}for(e=l-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#h(t){const e=t,{width:i,height:r}=t,{maxDim:s}=this.#t;let a=i,l=r;if(i>s||r>s){let m=i,g=r,y=Math.log2(Math.max(i,r)/s);const x=Math.floor(y);y=y===x?x-1:x;for(let b=0;b<y;b++){a=Math.ceil(m/2),l=Math.ceil(g/2);const S=new OffscreenCanvas(a,l);S.getContext("2d").drawImage(t,0,0,m,g,0,0,a,l),m=a,g=l,t!==e&&t.close(),t=S.transferToImageBitmap()}const _=Math.min(s/a,s/l);a=Math.round(a*_),l=Math.round(l*_)}const f=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,a,l);const d=f.getImageData(0,0,a,l).data;return[this.#d(d),a,l]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:r},s,a,l,u){let f=new OffscreenCanvas(1,1),d=f.getContext("2d",{alpha:!1});const p=200,m=d.font=`${i} ${r} ${p}px ${e}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:y,actualBoundingBoxAscent:x,actualBoundingBoxDescent:_,fontBoundingBoxAscent:b,fontBoundingBoxDescent:S,width:A}=d.measureText(t),C=1.5,O=Math.ceil(Math.max(Math.abs(g)+Math.abs(y)||0,A)*C),N=Math.ceil(Math.max(Math.abs(x)+Math.abs(_)||p,Math.abs(b)+Math.abs(S)||p)*C);f=new OffscreenCanvas(O,N),d=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=m,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,O,N),d.fillStyle="black",d.fillText(t,O*(C-1)/2,N*(3-C)/2);const D=this.#d(d.getImageData(0,0,O,N).data),L=this.#c(D),I=this.#u(L),z=this.#r(D,O,N,I);return this.processDrawnLines({lines:{curves:z,width:O,height:N},pageWidth:s,pageHeight:a,rotation:l,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(t,e,i,r,s){const[a,l,u]=this.#h(t),[f,d]=this.#f(a,l,u,Math.hypot(l,u)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#u(d),m=this.#r(f,l,u,p);return this.processDrawnLines({lines:{curves:m,width:l,height:u},pageWidth:e,pageHeight:i,rotation:r,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:r,innerMargin:s,mustSmooth:a,areContours:l}){r%180!==0&&([e,i]=[i,e]);const{curves:u,width:f,height:d}=t,p=t.thickness??0,m=[],g=Math.min(e/f,i/d),y=g/e,x=g/i,_=[];for(const{points:S}of u){const A=a?this.#o(S):S;if(!A)continue;_.push(A);const C=A.length,O=new Float32Array(C),N=new Float32Array(3*(C===2?2:C-2));if(m.push({line:N,points:O}),C===2){O[0]=A[0]*y,O[1]=A[1]*x,N.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[D,L,I,z]=A;D*=y,L*=x,I*=y,z*=x,O.set([D,L,I,z],0),N.set([NaN,NaN,NaN,NaN,D,L],0);for(let j=4;j<C;j+=2){const B=O[j]=A[j]*y,tt=O[j+1]=A[j+1]*x;N.set(me.createBezierPoints(D,L,I,z,B,tt),(j-2)*3),[D,L,I,z]=[I,z,B,tt]}}if(m.length===0)return null;const b=l?new zw:new P0;return b.build(m,e,i,1,r,l?0:p,s),{outline:b,newCurves:_,areContours:l,thickness:p,width:f,height:d}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:r,height:s}){let a=1/0,l=-1/0,u=0;for(const A of t){u+=A.length;for(let C=2,O=A.length;C<O;C++){const N=A[C]-A[C-2];a=Math.min(a,N),l=Math.max(l,N)}}let f;a>=-128&&l<=127?f=Int8Array:a>=-32768&&l<=32767?f=Int16Array:f=Int32Array;const d=t.length,p=Hg+fp*d,m=new Uint32Array(p);let g=0;m[g++]=p*Uint32Array.BYTES_PER_ELEMENT+(u-2*d)*f.BYTES_PER_ELEMENT,m[g++]=0,m[g++]=r,m[g++]=s,m[g++]=e?0:1,m[g++]=Math.max(0,Math.floor(i??0)),m[g++]=d,m[g++]=f.BYTES_PER_ELEMENT;for(const A of t)m[g++]=A.length-2,m[g++]=A[0],m[g++]=A[1];const y=new CompressionStream("deflate-raw"),x=y.writable.getWriter();await x.ready,x.write(m);const _=f.prototype.constructor;for(const A of t){const C=new _(A.length-2);for(let O=2,N=A.length;O<N;O++)C[O-2]=A[O]-A[O-2];x.write(C)}x.close();const b=await new Response(y.readable).arrayBuffer(),S=new Uint8Array(b);return lN(S)}static async decompressSignature(t){try{const e=D9(t),{readable:i,writable:r}=new DecompressionStream("deflate-raw"),s=r.getWriter();await s.ready,s.write(e).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,l=0;for await(const A of i)a||=new Uint8Array(new Uint32Array(A.buffer,0,4)[0]),a.set(A,l),l+=A.length;const u=new Uint32Array(a.buffer,0,a.length>>2),f=u[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const d=u[2],p=u[3],m=u[4]===0,g=u[5],y=u[6],x=u[7],_=[],b=(Hg+fp*y)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(x){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(a.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(a.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(a.buffer,b);break}l=0;for(let A=0;A<y;A++){const C=u[fp*A+Hg],O=new Float32Array(C+2);_.push(O);for(let N=0;N<fp-1;N++)O[N]=u[fp*A+Hg+N+1];for(let N=0;N<C;N++)O[N+2]=O[N]+S[l++]}return{areContours:m,thickness:g,outlines:_,width:d,height:p}}catch(e){return Ve(`decompressSignature: ${e}`),null}}}class A2 extends UN{constructor(){super(),super.updateProperties({fill:Re._defaultLineColor,"stroke-width":0})}clone(){const t=new A2;return t.updateAll(this),t}}class S2 extends tx{constructor(t){super(t),super.updateProperties({stroke:Re._defaultLineColor,"stroke-width":1})}clone(){const t=new S2(this._viewParameters);return t.updateAll(this),t}}class uo extends ke{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=$e.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Re.initialize(t,e),this._defaultDrawingOptions=new A2,this._defaultDrawnSignatureOptions=new S2(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return rn(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:r,mustSmooth:s,areContours:a,description:l,uuid:u,heightInPage:f}=this.#n,{rawDims:{pageWidth:d,pageHeight:p},rotation:m}=this.parent.viewport,g=lu.processDrawnLines({lines:r,pageWidth:d,pageHeight:p,rotation:m,innerMargin:uo._INNER_MARGIN,mustSmooth:s,areContours:a});this.addSignature(g,f,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:r,height:s}=this.#n,a=Math.max(r,s),l=lu.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:r,height:s},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:l.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&this.#e!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,this.#i,this.#e),t.show()),t):null}addSignature(t,e,i,r){const{x:s,y:a}=this,{outline:l}=this.#n=t;this.#t=l instanceof zw,this.#e=i,this.div.setAttribute("data-l10n-args",JSON.stringify({description:i}));let u;this.#t?u=uo.getDefaultDrawingOptions():(u=uo._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[f,d]=this.parentDimensions,[,p]=this.pageDimensions;let m=e/p;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(f*this.width,d*this.height),this.x=s,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:r}=this.parent.viewport;return lu.process(t,e,i,r,uo._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:r},rotation:s}=this.parent.viewport;return lu.extractContoursFromText(t,e,i,r,s,uo._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:r}=this.parent.viewport;return lu.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:r,innerMargin:uo._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=uo.getDefaultDrawingOptions():(this._drawingOptions=uo._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,a={annotationType:$e.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.paths={lines:e,points:i},a.uuid=this.#i,a.isCopy=!0):a.lines=e,this.#e&&(a.accessibilityData={type:"Figure",alt:this.#e}),a}static deserializeDraw(t,e,i,r,s,a){return a.areContours?zw.deserialize(t,e,i,r,s,a):P0.deserialize(t,e,i,r,s,a)}static async deserialize(t,e,i){const r=await super.deserialize(t,e,i);return r.#t=t.areContours,r.#e=t.accessibilityData?.alt||"",r.#i=t.uuid,r}}class Jj extends Re{#t=null;#e=null;#n=null;#i=null;#s=null;#r="";#l=null;#o=!1;#f=null;#c=!1;#d=!1;static _type="stamp";static _editorType=$e.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Re.initialize(t,e)}static isHandlingMimeForPasting(t){return Zv.includes(t)}static paste(t,e){e.pasteEditor({mode:$e.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#r=t.file.name),this.#p()}#h(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:s,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:r,width:s,height:a,channels:r.length/(s*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),e&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}#a(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#u(i,!0)).finally(()=>this.#h());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(i).then(r=>this.#u(r)).finally(()=>this.#h());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(i).then(r=>this.#u(r)).finally(()=>this.#h());return}const t=document.createElement("input");t.type="file",t.accept=Zv.join(",");const e=this._uiManager._signal;this.#n=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(r)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#h()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#l?.remove(),this.#l=null,this.#f&&(clearTimeout(this.#f),this.#f=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#a();return}super.rebuild(),this.div!==null&&(this.#e&&this.#l===null&&this.#a(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#s||this.#e||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#o||(this.#t?this.#p():this.#a()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,r&&(this.#t=r),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#f!==null&&clearTimeout(this.#f);const t=200;this.#f=setTimeout(()=>{this.#f=null,this.#m()},t)}#p(){const{div:t}=this;let{width:e,height:i}=this.#t;const[r,s]=this.pageDimensions,a=.75;if(this.width)e=this.width*r,i=this.height*s;else if(e>a*r||i>a*s){const d=Math.min(a*r/e,a*s/i);e*=d,i*=d}const[l,u]=this.parentDimensions;this.setDims(e*l/r,i*u/s),this._uiManager.enableWaiting(!1);const f=this.#l=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/r,this.height=i/s,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r)}copyCanvas(t,e,i=!1){t||(t=224);const{width:r,height:s}=this.#t,a=new Ma;let l=this.#t,u=r,f=s,d=null;if(e){if(r>e||s>e){const N=Math.min(e/r,e/s);u=Math.floor(r*N),f=Math.floor(s*N)}d=document.createElement("canvas");const m=d.width=Math.ceil(u*a.sx),g=d.height=Math.ceil(f*a.sy);this.#c||(l=this.#g(m,g));const y=d.getContext("2d");y.filter=this._uiManager.hcmFilter;let x="white",_="#cfcfd8";this._uiManager.hcmFilter!=="none"?_="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(x="#8f8f9d",_="#42414d");const b=15,S=b*a.sx,A=b*a.sy,C=new OffscreenCanvas(S*2,A*2),O=C.getContext("2d");O.fillStyle=x,O.fillRect(0,0,S*2,A*2),O.fillStyle=_,O.fillRect(0,0,S,A),O.fillRect(S,A,S,A),y.fillStyle=y.createPattern(C,"repeat"),y.fillRect(0,0,m,g),y.drawImage(l,0,0,l.width,l.height,0,0,m,g)}let p=null;if(i){let m,g;if(a.symmetric&&l.width<t&&l.height<t)m=l.width,g=l.height;else if(l=this.#t,r>t||s>t){const _=Math.min(t/r,t/s);m=Math.floor(r*_),g=Math.floor(s*_),this.#c||(l=this.#g(m,g))}const x=new OffscreenCanvas(m,g).getContext("2d",{willReadFrequently:!0});x.drawImage(l,0,0,l.width,l.height,0,0,m,g),p={width:m,height:g,data:x.getImageData(0,0,m,g).data}}return{canvas:d,width:u,height:f,imageData:p}}#g(t,e){const{width:i,height:r}=this.#t;let s=i,a=r,l=this.#t;for(;s>2*t||a>2*e;){const u=s,f=a;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const d=new OffscreenCanvas(s,a);d.getContext("2d").drawImage(l,0,0,u,f,0,0,s,a),l=d.transferToImageBitmap()}return l}#m(){const[t,e]=this.parentDimensions,{width:i,height:r}=this,s=new Ma,a=Math.ceil(i*t*s.sx),l=Math.ceil(r*e*s.sy),u=this.#l;if(!u||u.width===a&&u.height===l)return;u.width=a,u.height=l;const f=this.#c?this.#t:this.#g(a,l),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(f,0,0,f.width,f.height,0,0,a,l)}#v(t){if(t){if(this.#c){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,i]=this.pageDimensions,r=Math.round(this.width*e*Eu.PDF_TO_CSS_UNITS),s=Math.round(this.height*i*Eu.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,s);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,s),a.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let r=null,s=!1;if(t instanceof PN){const{data:{rect:x,rotation:_,id:b,structParent:S,popupRef:A},container:C,parent:{page:{pageNumber:O}},canvas:N}=t;let D,L;N?(delete t.canvas,{id:D,bitmap:L}=i.imageManager.getFromCanvas(C.id,N),N.remove()):(s=!0,t._hasNoCanvas=!0);const I=(await e._structTree.getAriaAttributes(`${l2}${b}`))?.get("aria-label")||"";r=t={annotationType:$e.STAMP,bitmapId:D,bitmap:L,pageIndex:O-1,rect:x.slice(0),rotation:_,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:S,popupRef:A}}const a=await super.deserialize(t,e,i),{rect:l,bitmap:u,bitmapUrl:f,bitmapId:d,isSvg:p,accessibilityData:m}=t;s?(i.addMissingCanvas(t.id,a),a.#o=!0):d&&i.imageManager.isValidId(d)?(a.#e=d,u&&(a.#t=u)):a.#i=f,a.#c=p;const[g,y]=a.pageDimensions;return a.width=(l[2]-l[0])/g,a.height=(l[3]-l[1])/y,a.annotationElementId=t.id||null,m&&(a.altTextData=m),a._initialData=r,a.#d=!!r,a}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:$e.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=this.#v(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:s}=this.serializeAltText(!1);if(!r&&s&&(i.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const l=this.#x(i);if(l.isSame)return null;l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,e===null)return i;e.stamps||=new Map;const a=this.#c?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:a,serialized:i}),i.bitmap=this.#v(!1);else if(this.#c){const l=e.stamps.get(this.#e);a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=this.#v(!1))}return i}#x(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===e,s=(t.accessibilityData?.alt||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&s,isSameAltText:s}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class ho{#t;#e=!1;#n=null;#i=null;#s=null;#r=new Map;#l=!1;#o=!1;#f=!1;#c=null;#d=null;#u=null;#h=null;#a;static _initialized=!1;static#p=new Map([Mi,E2,Jj,hi,uo].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:r,accessibilityManager:s,annotationLayer:a,drawLayer:l,textLayer:u,viewport:f,l10n:d}){const p=[...ho.#p.values()];if(!ho._initialized){ho._initialized=!0;for(const m of p)m.initialize(d,t)}t.registerEditorTypes(p),this.#a=t,this.pageIndex=e,this.div=i,this.#t=s,this.#n=a,this.viewport=f,this.#u=u,this.drawLayer=l,this._structTree=r,this.#a.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===$e.NONE}updateToolbar(t){this.#a.updateToolbar(t)}updateMode(t=this.#a.getMode()){switch(this.#y(),t){case $e.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case $e.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case $e.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of ho.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#a.setEditingState(t)}addCommands(t){this.#a.addCommands(t)}cleanUndoStack(t){this.#a.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#f=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of this.#r.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#a.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#n){this.#f=!1;return}const e=this.#n.getEditableAnnotations();for(const i of e){if(i.hide(),this.#a.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}this.#f=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const r of this.#r.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#n){const r=this.#n.getEditableAnnotations();for(const s of r){const{id:a}=s.data;if(this.#a.isDeletedAnnotationElement(a))continue;let l=e.get(a);if(l){l.resetAnnotationElement(s),l.show(!1),s.show();continue}l=t.get(a),l&&(this.#a.addChangedExistingAnnotation(l),l.renderAnnotationElement(s)&&l.show(!1)),s.show()}}this.#y(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of ho.#p.values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#a.getActive()!==t&&this.#a.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#h){this.#h=new AbortController;const t=this.#a.combinedSignal(this.#h);this.#u.div.addEventListener("pointerdown",this.#g.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#h&&(this.#h.abort(),this.#h=null,this.#u.div.classList.remove("highlighting"))}#g(t){this.#a.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:i}=$i.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#a.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),hi.startHighlighting(this,this.#a.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#a.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#a.isDeletedAnnotationElement(e)&&this.#a.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#a.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#a.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#a.addDeletedAnnotationElement(t.annotationElementId),Re.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#a.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#f),this.#a.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return this.#a.getId()}get#m(){return ho.#p.get(this.#a.getMode())}combinedSignal(t){return this.#a.combinedSignal(t)}#v(t){const e=this.#m;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#m?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#a.updateMode(t.mode);const{offsetX:i,offsetY:r}=this.#x(),s=this.getNextId(),a=this.#v({parent:this,id:s,x:i,y:r,uiManager:this.#a,isCentered:!0,...e});a&&this.add(a)}async deserialize(t){return await ho.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#a)||null}createAndAddNewEditor(t,e,i={}){const r=this.getNextId(),s=this.#v({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#a,isCentered:e,...i});return s&&this.add(s),s}#x(){const{x:t,y:e,width:i,height:r}=this.div.getBoundingClientRect(),s=Math.max(0,t),a=Math.max(0,e),l=Math.min(window.innerWidth,t+i),u=Math.min(window.innerHeight,e+r),f=(s+l)/2-t,d=(a+u)/2-e,[p,m]=this.viewport.rotation%180===0?[f,d]:[d,f];return{offsetX:p,offsetY:m}}addNewEditor(t={}){this.createAndAddNewEditor(this.#x(),!0,t)}setSelected(t){this.#a.setSelected(t)}toggleSelected(t){this.#a.toggleSelected(t)}unselect(t){this.#a.unselect(t)}pointerup(t){const{isMac:e}=$i.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#l||(this.#l=!1,this.#m?.isDrawer&&this.#m.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#a.getMode();if(i===$e.STAMP||i===$e.SIGNATURE){this.#a.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#a.getMode()===$e.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:e}=$i.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#l=!0,this.#m?.isDrawer){this.startDrawingSession(t);return}const i=this.#a.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#m.startDrawing(this,this.#a,!1,t);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#m.startDrawing(this,this.#a,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#d=null,this.#m.endDrawing(t)):null}findNewParent(t,e,i){const r=this.#a.findParent(e,i);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#m.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#a.removeLayer(this)}#y(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,_c(this.div,t);for(const e of this.#a.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#a.commitOrRemove(),this.#y();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,_c(this.div,{rotation:i}),e!==i)for(const r of this.#r.values())r.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#a.viewParameters.realScale}}class zi{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return rn(this,"_svgFactory",new Jp)}static#s(t,[e,i,r,s]){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*r}%`,a.height=`${100*s}%`}#r(){const t=zi._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#l(t,e){const i=zi._svgFactory.createElement("clipPath");t.append(i);const r=`clip_${e}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const s=zi._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),r}#o(t,e){for(const[i,r]of Object.entries(e))r===null?t.removeAttribute(i):t.setAttribute(i,r)}draw(t,e=!1,i=!1){const r=zi.#i++,s=this.#r(),a=zi._svgFactory.createElement("defs");s.append(a);const l=zi._svgFactory.createElement("path");a.append(l);const u=`path_p${this.pageIndex}_${r}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(r,l);const f=i?this.#l(a,u):null,d=zi._svgFactory.createElement("use");return s.append(d),d.setAttribute("href",`#${u}`),this.updateProperties(s,t),this.#e.set(r,s),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=zi.#i++,r=this.#r(),s=zi._svgFactory.createElement("defs");r.append(s);const a=zi._svgFactory.createElement("path");s.append(a);const l=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let u;if(e){const p=zi._svgFactory.createElement("mask");s.append(p),u=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",u),p.setAttribute("maskUnits","objectBoundingBox");const m=zi._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const g=zi._svgFactory.createElement("use");p.append(g),g.setAttribute("href",`#${l}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const f=zi._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${l}`),u&&f.setAttribute("mask",`url(#${u})`);const d=f.cloneNode();return r.append(d),f.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(i,r),i}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:r,rootClass:s,path:a}=e,l=typeof t=="number"?this.#e.get(t):t;if(l){if(i&&this.#o(l,i),r&&zi.#s(l,r),s){const{classList:u}=l;for(const[f,d]of Object.entries(s))u.toggle(f,d)}if(a){const f=l.firstChild.firstChild;this.#o(f,a)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:jw};globalThis.pdfjsLib={AbortException:yl,AnnotationEditorLayer:ho,AnnotationEditorParamsType:sn,AnnotationEditorType:$e,AnnotationEditorUIManager:_l,AnnotationLayer:w2,AnnotationMode:go,AnnotationType:di,build:NN,ColorPicker:Ts,createValidAbsoluteUrl:s2,DOMSVGFactory:Jp,DrawLayer:zi,FeatureTest:$i,fetchData:Dd,getDocument:v2,getFilenameFromUrl:cN,getPdfFilenameFromUrl:uN,getUuid:o2,getXfaPageViewport:fN,GlobalWorkerOptions:pc,ImageKind:Pp,InvalidPDFException:Kv,isDataScheme:L0,isPdfFile:Q1,isValidExplicitDest:mN,MathClamp:vr,noContextMenu:fa,normalizeUnicode:oN,OPS:qp,OutputScale:Ma,PasswordResponses:sN,PDFDataRangeTransport:y2,PDFDateString:c2,PDFWorker:md,PermissionFlag:rN,PixelsPerInch:Eu,RenderingCancelledException:Z1,ResponseException:Kp,setLayerDimensions:_c,shadow:rn,SignatureExtractor:lu,stopEvent:pi,SupportedImageMimeTypes:Zv,TextLayer:Zp,TouchManager:k0,updateUrlHash:a2,Util:Ee,VerbosityLevel:O0,version:RN,XfaLayer:_2};const tU=Object.freeze(Object.defineProperty({__proto__:null,AbortException:yl,AnnotationEditorLayer:ho,AnnotationEditorParamsType:sn,AnnotationEditorType:$e,AnnotationEditorUIManager:_l,AnnotationLayer:w2,AnnotationMode:go,AnnotationType:di,ColorPicker:Ts,DOMSVGFactory:Jp,DrawLayer:zi,FeatureTest:$i,GlobalWorkerOptions:pc,ImageKind:Pp,InvalidPDFException:Kv,MathClamp:vr,OPS:qp,OutputScale:Ma,PDFDataRangeTransport:y2,PDFDateString:c2,PDFWorker:md,PasswordResponses:sN,PermissionFlag:rN,PixelsPerInch:Eu,RenderingCancelledException:Z1,ResponseException:Kp,SignatureExtractor:lu,SupportedImageMimeTypes:Zv,TextLayer:Zp,TouchManager:k0,Util:Ee,VerbosityLevel:O0,XfaLayer:_2,build:NN,createValidAbsoluteUrl:s2,fetchData:Dd,getDocument:v2,getFilenameFromUrl:cN,getPdfFilenameFromUrl:uN,getUuid:o2,getXfaPageViewport:fN,isDataScheme:L0,isPdfFile:Q1,isValidExplicitDest:mN,noContextMenu:fa,normalizeUnicode:oN,setLayerDimensions:_c,shadow:rn,stopEvent:pi,updateUrlHash:a2,version:RN},Symbol.toStringTag,{value:"Module"})),eU=["onCopy","onCut","onPaste"],nU=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],iU=["onFocus","onBlur"],rU=["onInput","onInvalid","onReset","onSubmit"],sU=["onLoad","onError"],aU=["onKeyDown","onKeyPress","onKeyUp"],oU=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],lU=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],cU=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],uU=["onSelect"],fU=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],dU=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],hU=["onScroll"],pU=["onWheel"],mU=["onAnimationStart","onAnimationEnd","onAnimationIteration"],gU=["onTransitionEnd"],vU=["onToggle"],xU=["onChange"],yU=[...eU,...nU,...iU,...rU,...sU,...aU,...oU,...lU,...cU,...uU,...fU,...dU,...hU,...pU,...mU,...gU,...xU,...vU];function zN(n,t){const e={};for(const i of yU){const r=n[i];r&&(t?e[i]=s=>r(s,t(i)):e[i]=r)}return e}function B0(n){let t=!1;return{promise:new Promise((i,r)=>{n.then(s=>!t&&i(s)).catch(s=>!t&&r(s))}),cancel(){t=!0}}}function HN(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(t=0;t<r;t++)n[t]&&(e=HN(n[t]))&&(i&&(i+=" "),i+=e)}else for(e in n)n[e]&&(i&&(i+=" "),i+=e);return i}function ex(){for(var n,t,e=0,i="",r=arguments.length;e<r;e++)(n=arguments[e])&&(t=HN(n))&&(i&&(i+=" "),i+=t);return i}var _U="Invariant failed";function Mn(n,t){if(!n)throw new Error(_U)}var M_,wD;function bU(){if(wD)return M_;wD=1;var n=function(){};return M_=n,M_}var wU=bU();const tr=ku(wU);var ED=Object.prototype.hasOwnProperty;function AD(n,t,e){for(e of n.keys())if(yu(e,t))return e}function yu(n,t){var e,i,r;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((i=n.length)===t.length)for(;i--&&yu(n[i],t[i]););return i===-1}if(e===Set){if(n.size!==t.size)return!1;for(i of n)if(r=i,r&&typeof r=="object"&&(r=AD(t,r),!r)||!t.has(r))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(i of n)if(r=i[0],r&&typeof r=="object"&&(r=AD(t,r),!r)||!yu(i[1],t.get(r)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((i=n.byteLength)===t.byteLength)for(;i--&&n.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(n)){if((i=n.byteLength)===t.byteLength)for(;i--&&n[i]===t[i];);return i===-1}if(!e||typeof n=="object"){i=0;for(e in n)if(ED.call(n,e)&&++i&&!ED.call(t,e)||!(e in t)||!yu(n[e],t[e]))return!1;return Object.keys(t).length===i}}return n!==n&&t!==t}const $N=U.createContext(null);function Qf({children:n,type:t}){return M.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:n})}const EU="noopener noreferrer nofollow";class AU{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Mn(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){Mn(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{Mn(this.pdfDocument),Mn(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{Mn(Array.isArray(e));const i=e[0];new Promise(r=>{Mn(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(s=>{r(s)}).catch(()=>{Mn(!1)}):typeof i=="number"?r(i):Mn(!1)}).then(r=>{const s=r+1;Mn(this.pdfViewer),Mn(s>=1&&s<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:r,pageNumber:s})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;Mn(this.pdfViewer),Mn(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||EU,t.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const SD={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},nx=typeof window<"u",GN=nx&&window.location.protocol==="file:";function SU(n){return typeof n<"u"}function nu(n){return SU(n)&&n!==null}function TU(n){return typeof n=="string"}function CU(n){return n instanceof ArrayBuffer}function DU(n){return Mn(nx),n instanceof Blob}function Hw(n){return TU(n)&&/^data:/.test(n)}function TD(n){Mn(Hw(n));const[t="",e=""]=n.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function OU(){return nx&&window.devicePixelRatio||1}const VN="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function CD(){tr(!GN,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${VN}`)}function RU(){tr(!GN,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${VN}`)}function Su(n){n?.cancel&&n.cancel()}function $w(n,t){return Object.defineProperty(n,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function NU(n){return n.name==="RenderingCancelledException"}function LU(n){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=r=>{if(!r.target)return e(new Error("Error while reading a file."));const{error:s}=r.target;if(!s)return e(new Error("Error while reading a file."));switch(s.code){case s.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case s.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case s.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(n)})}function IU(n,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function gd(){return U.useReducer(IU,{value:void 0,error:void 0})}var DD=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const{PDFDataRangeTransport:kU}=tU,MU=(n,t)=>{switch(t){case SD.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");n(e);break}case SD.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");n(e);break}}};function OD(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const FU=U.forwardRef(function(t,e){var{children:i,className:r,error:s="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:l,file:u,inputRef:f,imageResourcesPath:d,loading:p="Loading PDF…",noData:m="No PDF file specified.",onItemClick:g,onLoadError:y,onLoadProgress:x,onLoadSuccess:_,onPassword:b=MU,onSourceError:S,onSourceSuccess:A,options:C,renderMode:O,rotate:N,scale:D}=t,L=DD(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[I,z]=gd(),{value:j,error:B}=I,[tt,k]=gd(),{value:et,error:K}=tt,q=U.useRef(new AU),_t=U.useRef([]),at=U.useRef(void 0),P=U.useRef(void 0);u&&u!==at.current&&OD(u)&&(tr(!yu(u,at.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),at.current=u),C&&C!==P.current&&(tr(!yu(C,P.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),P.current=C);const X=U.useRef({scrollPageIntoView:R=>{const{dest:mt,pageNumber:ut,pageIndex:J=ut-1}=R;if(g){g({dest:mt,pageIndex:J,pageNumber:ut});return}const Q=_t.current[J];if(Q){Q.scrollIntoView();return}tr(!1,`An internal link leading to page ${ut} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});U.useImperativeHandle(e,()=>({linkService:q,pages:_t,viewer:X}),[]);function V(){A&&A()}function it(){B&&(tr(!1,B.toString()),S&&S(B))}function ht(){z({type:"RESET"})}U.useEffect(ht,[u,z]);const yt=U.useCallback(async()=>{if(!u)return null;if(typeof u=="string")return Hw(u)?{data:TD(u)}:(CD(),{url:u});if(u instanceof kU)return{range:u};if(CU(u))return{data:u};if(nx&&DU(u))return{data:await LU(u)};if(Mn(typeof u=="object"),Mn(OD(u)),"url"in u&&typeof u.url=="string"){if(Hw(u.url)){const{url:R}=u,mt=DD(u,["url"]),ut=TD(R);return Object.assign({data:ut},mt)}CD()}return u},[u]);U.useEffect(()=>{const R=B0(yt());return R.promise.then(mt=>{z({type:"RESOLVE",value:mt})}).catch(mt=>{z({type:"REJECT",error:mt})}),()=>{Su(R)}},[yt,z]),U.useEffect(()=>{if(!(typeof j>"u")){if(j===!1){it();return}V()}},[j]);function Rt(){et&&(_&&_(et),_t.current=new Array(et.numPages),q.current.setDocument(et))}function Et(){K&&(tr(!1,K.toString()),y&&y(K))}U.useEffect(function(){k({type:"RESET"})},[k,j]),U.useEffect(function(){if(!j)return;const mt=C?Object.assign(Object.assign({},j),C):j,ut=v2(mt);x&&(ut.onProgress=x),b&&(ut.onPassword=b);const J=ut,Q=J.promise.then(gt=>{k({type:"RESOLVE",value:gt})}).catch(gt=>{J.destroyed||k({type:"REJECT",error:gt})});return()=>{Q.finally(()=>J.destroy())}},[C,k,j]),U.useEffect(()=>{if(!(typeof et>"u")){if(et===!1){Et();return}Rt()}},[et]),U.useEffect(function(){q.current.setViewer(X.current),q.current.setExternalLinkRel(a),q.current.setExternalLinkTarget(l)},[a,l]);const G=U.useCallback((R,mt)=>{_t.current[R]=mt},[]),lt=U.useCallback(R=>{delete _t.current[R]},[]),rt=U.useMemo(()=>({imageResourcesPath:d,linkService:q.current,onItemClick:g,pdf:et,registerPage:G,renderMode:O,rotate:N,scale:D,unregisterPage:lt}),[d,g,et,G,O,N,D,lt]),ot=U.useMemo(()=>zN(L,()=>et),[L,et]);function bt(){return M.jsx($N.Provider,{value:rt,children:i})}function St(){return u?et==null?M.jsx(Qf,{type:"loading",children:typeof p=="function"?p():p}):et===!1?M.jsx(Qf,{type:"error",children:typeof s=="function"?s():s}):bt():M.jsx(Qf,{type:"no-data",children:typeof m=="function"?m():m})}return M.jsx("div",Object.assign({className:ex("react-pdf__Document",r),ref:f},ot,{children:St()}))});function WN(){return U.useContext($N)}function XN(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(s){for(var a=0,l=e;a<l.length;a++){var u=l[a];typeof u=="function"?u(s):u&&(u.current=s)}}}const YN=U.createContext(null),qN={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},PU=/^H(\d+)$/;function BU(n){return n in qN}function ix(n){return"children"in n}function KN(n){return ix(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function jU(n){const t={};if(ix(n)){const{role:e}=n,i=e.match(PU);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(BU(e)){const r=qN[e];r&&(t.role=r)}}return t}function ZN(n){const t={};if(ix(n)){if(n.alt!==void 0&&(t["aria-label"]=n.alt),n.lang!==void 0&&(t.lang=n.lang),KN(n)){const[e]=n.children;if(e){const i=ZN(e);return Object.assign(Object.assign({},t),i)}}}else"id"in n&&(t["aria-owns"]=n.id);return t}function UU(n){return n?Object.assign(Object.assign({},jU(n)),ZN(n)):null}function QN({className:n,node:t}){const e=U.useMemo(()=>UU(t),[t]),i=U.useMemo(()=>!ix(t)||KN(t)?null:t.children.map((r,s)=>M.jsx(QN,{node:r},s)),[t]);return M.jsx("span",Object.assign({className:n},e,{children:i}))}function rx(){return U.useContext(YN)}function zU(){const n=rx();Mn(n);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=n,[i,r]=gd(),{value:s,error:a}=i,{customTextRenderer:l,page:u}=n;function f(){s&&e&&e(s)}function d(){a&&(tr(!1,a.toString()),t&&t(a))}return U.useEffect(function(){r({type:"RESET"})},[r,u]),U.useEffect(function(){if(l||!u)return;const m=B0(u.getStructTree()),g=m;return m.promise.then(y=>{r({type:"RESOLVE",value:y})}).catch(y=>{r({type:"REJECT",error:y})}),()=>Su(g)},[l,u,r]),U.useEffect(()=>{if(s!==void 0){if(s===!1){d();return}f()}},[s]),s?M.jsx(QN,{className:"react-pdf__Page__structTree structTree",node:s}):null}const RD=go;function HU(n){const t=rx();Mn(t);const e=Object.assign(Object.assign({},t),n),{_className:i,canvasBackground:r,devicePixelRatio:s=OU(),onRenderError:a,onRenderSuccess:l,page:u,renderForms:f,renderTextLayer:d,rotate:p,scale:m}=e,{canvasRef:g}=n;Mn(u);const y=U.useRef(null);function x(){u&&l&&l($w(u,m))}function _(C){NU(C)||(tr(!1,C.toString()),a&&a(C))}const b=U.useMemo(()=>u.getViewport({scale:m*s,rotation:p}),[s,u,p,m]),S=U.useMemo(()=>u.getViewport({scale:m,rotation:p}),[u,p,m]);U.useEffect(function(){if(!u)return;u.cleanup();const{current:O}=y;if(!O)return;O.width=b.width,O.height=b.height,O.style.width=`${Math.floor(S.width)}px`,O.style.height=`${Math.floor(S.height)}px`,O.style.visibility="hidden";const N={annotationMode:f?RD.ENABLE_FORMS:RD.ENABLE,canvasContext:O.getContext("2d",{alpha:!1}),viewport:b};r&&(N.background=r);const D=u.render(N),L=D;return D.promise.then(()=>{O.style.visibility="",x()}).catch(_),()=>Su(L)},[r,u,f,b,S]);const A=U.useCallback(()=>{const{current:C}=y;C&&(C.width=0,C.height=0)},[]);return U.useEffect(()=>A,[A]),M.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:XN(g,y),style:{display:"block",userSelect:"none"},children:d?M.jsx(zU,{}):null})}function $U(n){return"str"in n}function GU(){const n=rx();Mn(n);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:r,onRenderTextLayerSuccess:s,page:a,pageIndex:l,pageNumber:u,rotate:f,scale:d}=n;Mn(a);const[p,m]=gd(),{value:g,error:y}=p,x=U.useRef(null);tr(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function _(){g&&i&&i(g)}function b(){y&&(tr(!1,y.toString()),e&&e(y))}U.useEffect(function(){m({type:"RESET"})},[a,m]),U.useEffect(function(){if(!a)return;const L=B0(a.getTextContent()),I=L;return L.promise.then(z=>{m({type:"RESOLVE",value:z})}).catch(z=>{m({type:"REJECT",error:z})}),()=>Su(I)},[a,m]),U.useEffect(()=>{if(g!==void 0){if(g===!1){b();return}_()}},[g]);const S=U.useCallback(()=>{s&&s()},[s]),A=U.useCallback(D=>{tr(!1,D.toString()),r&&r(D)},[r]);function C(){const D=x.current;D&&D.classList.add("selecting")}function O(){const D=x.current;D&&D.classList.remove("selecting")}const N=U.useMemo(()=>a.getViewport({scale:d,rotation:f}),[a,f,d]);return U.useLayoutEffect(function(){if(!a||!g)return;const{current:L}=x;if(!L)return;L.innerHTML="";const I=a.streamTextContent({includeMarkedContent:!0}),z={container:L,textContentSource:I,viewport:N},j=new Zp(z),B=j;return j.render().then(()=>{const tt=document.createElement("div");tt.className="endOfContent",L.append(tt);const k=L.querySelectorAll('[role="presentation"]');if(t){let et=0;g.items.forEach((K,q)=>{if(!$U(K))return;const _t=k[et];if(!_t)return;const at=t(Object.assign({pageIndex:l,pageNumber:u,itemIndex:q},K));_t.innerHTML=at,et+=K.str&&K.hasEOL?2:1})}S()}).catch(A),()=>Su(B)},[t,A,S,a,l,u,g,N]),M.jsx("div",{className:ex("react-pdf__Page__textContent","textLayer"),onMouseUp:O,onMouseDown:C,ref:x})}function VU(){const n=WN(),t=rx();Mn(t);const e=Object.assign(Object.assign({},n),t),{imageResourcesPath:i,linkService:r,onGetAnnotationsError:s,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:u,page:f,pdf:d,renderForms:p,rotate:m,scale:g=1}=e;Mn(d),Mn(f),Mn(r);const[y,x]=gd(),{value:_,error:b}=y,S=U.useRef(null);tr(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function A(){_&&a&&a(_)}function C(){b&&(tr(!1,b.toString()),s&&s(b))}U.useEffect(function(){x({type:"RESET"})},[x,f]),U.useEffect(function(){if(!f)return;const I=B0(f.getAnnotations()),z=I;return I.promise.then(j=>{x({type:"RESOLVE",value:j})}).catch(j=>{x({type:"REJECT",error:j})}),()=>{Su(z)}},[x,f]),U.useEffect(()=>{if(_!==void 0){if(_===!1){C();return}A()}},[_]);function O(){u&&u()}function N(L){tr(!1,`${L}`),l&&l(L)}const D=U.useMemo(()=>f.getViewport({scale:g,rotation:m}),[f,m,g]);return U.useEffect(function(){if(!d||!f||!r||!_)return;const{current:I}=S;if(!I)return;const z=D.clone({dontFlip:!0}),j={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:I,l10n:null,page:f,structTreeLayer:null,viewport:z},B={annotations:_,annotationStorage:d.annotationStorage,div:I,imageResourcesPath:i,linkService:r,page:f,renderForms:p,viewport:z};I.innerHTML="";try{new w2(j).render(B),O()}catch(tt){N(tt)}return()=>{}},[_,i,r,f,d,p,D]),M.jsx("div",{className:ex("react-pdf__Page__annotations","annotationLayer"),ref:S})}var WU=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const ND=1;function XU(n){const t=WN(),e=Object.assign(Object.assign({},t),n),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:r=!0,canvasBackground:s,canvasRef:a,children:l,className:u,customRenderer:f,customTextRenderer:d,devicePixelRatio:p,error:m="Failed to load the page.",height:g,inputRef:y,loading:x="Loading page…",noData:_="No page specified.",onGetAnnotationsError:b,onGetAnnotationsSuccess:S,onGetStructTreeError:A,onGetStructTreeSuccess:C,onGetTextError:O,onGetTextSuccess:N,onLoadError:D,onLoadSuccess:L,onRenderAnnotationLayerError:I,onRenderAnnotationLayerSuccess:z,onRenderError:j,onRenderSuccess:B,onRenderTextLayerError:tt,onRenderTextLayerSuccess:k,pageIndex:et,pageNumber:K,pdf:q,registerPage:_t,renderAnnotationLayer:at=!0,renderForms:P=!1,renderMode:X="canvas",renderTextLayer:V=!0,rotate:it,scale:ht=ND,unregisterPage:yt,width:Rt}=e,Et=WU(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[G,lt]=gd(),{value:rt,error:ot}=G,bt=U.useRef(null);Mn(q);const St=nu(K)?K-1:et??null,R=K??(nu(et)?et+1:null),mt=it??(rt?rt.rotate:null),ut=U.useMemo(()=>{if(!rt)return null;let ae=1;const ne=ht??ND;if(Rt||g){const Me=rt.getViewport({scale:1,rotation:mt});Rt?ae=Rt/Me.width:g&&(ae=g/Me.height)}return ne*ae},[g,rt,mt,ht,Rt]);U.useEffect(function(){return()=>{nu(St)&&r&&yt&&yt(St)}},[r,q,St,yt]);function J(){if(L){if(!rt||!ut)return;L($w(rt,ut))}if(r&&_t){if(!nu(St)||!bt.current)return;_t(St,bt.current)}}function Q(){ot&&(tr(!1,ot.toString()),D&&D(ot))}U.useEffect(function(){lt({type:"RESET"})},[lt,q,St]),U.useEffect(function(){if(!q||!R)return;const ne=B0(q.getPage(R)),Me=ne;return ne.promise.then(dn=>{lt({type:"RESOLVE",value:dn})}).catch(dn=>{lt({type:"REJECT",error:dn})}),()=>Su(Me)},[lt,q,R]),U.useEffect(()=>{if(rt!==void 0){if(rt===!1){Q();return}J()}},[rt,ut]);const gt=U.useMemo(()=>rt&&nu(St)&&R&&nu(mt)&&nu(ut)?{_className:i,canvasBackground:s,customTextRenderer:d,devicePixelRatio:p,onGetAnnotationsError:b,onGetAnnotationsSuccess:S,onGetStructTreeError:A,onGetStructTreeSuccess:C,onGetTextError:O,onGetTextSuccess:N,onRenderAnnotationLayerError:I,onRenderAnnotationLayerSuccess:z,onRenderError:j,onRenderSuccess:B,onRenderTextLayerError:tt,onRenderTextLayerSuccess:k,page:rt,pageIndex:St,pageNumber:R,renderForms:P,renderTextLayer:V,rotate:mt,scale:ut}:null,[i,s,d,p,b,S,A,C,O,N,I,z,j,B,tt,k,rt,St,R,P,V,mt,ut]),Bt=U.useMemo(()=>zN(Et,()=>rt&&(ut?$w(rt,ut):void 0)),[Et,rt,ut]),Ht=`${St}@${ut}/${mt}`;function Ct(){switch(X){case"custom":return Mn(f),M.jsx(f,{},`${Ht}_custom`);case"none":return null;case"canvas":default:return M.jsx(HU,{canvasRef:a},`${Ht}_canvas`)}}function kt(){return V?M.jsx(GU,{},`${Ht}_text`):null}function Dt(){return at?M.jsx(VU,{},`${Ht}_annotations`):null}function xt(){return M.jsxs(YN.Provider,{value:gt,children:[Ct(),kt(),Dt(),l]})}function te(){return R?q===null||rt===void 0||rt===null?M.jsx(Qf,{type:"loading",children:typeof x=="function"?x():x}):q===!1||rt===!1?M.jsx(Qf,{type:"error",children:typeof m=="function"?m():m}):xt():M.jsx(Qf,{type:"no-data",children:typeof _=="function"?_():_})}return M.jsx("div",Object.assign({className:ex(i,u),"data-page-number":R,ref:XN(y,bt),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${ut}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Bt,{children:te()}))}RU();pc.workerSrc="pdf.worker.mjs";const $g=3,Op=(n,t,e,i)=>({x:n.x*e/t,width:n.width*e/t,y:i.height-n.y*e/t-n.height*e/t,height:n.height*e/t}),Gg=(n,t)=>n.items.filter(e=>{const i=e.transform[4],r=e.transform[5],s=e.transform[4]+e.width,a=e.transform[5]+e.height;return i>=t.x-$g&&s<=t.x+t.width+$g&&r>=t.y-$g&&a<=t.y+t.height+$g}),LD=n=>{const t=n.filter(l=>{const u=l.str.trim();return/^(P|\d+)(\/\d+)?(\*+)?$|^-$/.test(u)});if(t.length===0)return[];const e=t.filter(l=>T2(l.str.trim()));if(e.length<2)return t.map(l=>l.str.trim());const i=[];for(let l=0;l+1<e.length;l++)i.push(Math.abs(e[l].transform[5]-e[l+1].transform[5]));i.sort((l,u)=>l-u);const r=e.length<4?e[0].height*1.2:i[i.length-1]-i[0]<=i[0]*1.2?0:i[0]*1.1,s=[],a=[];return t.forEach((l,u)=>{if(a.length>0){a.push(l.str.trim()),s.push(a.join("/")),a.length=0;return}if(l.str.trim()==="-"){s.push(l.str.trim());return}if(u+1<t.length&&Math.abs(l.transform[5]-t[u+1].transform[5])<=r){a.push(l.str.trim());return}s.push(l.str.trim())}),a.length>0&&s.push(a.join("/")),s},Vg=(n,t)=>{const e=Array(),i=Array();let r=!1;return n.sort((s,a)=>{const l=a.transform[5]-s.transform[5],f=(s.height+a.height)/2*.5;return Math.abs(l)<=f?s.transform[4]-a.transform[4]:l}),n.forEach((s,a)=>{if(s.str.trim()=="")return;const l=s.height*1.5;if(r){e.push(s.str.trim());const u=e.join("/");i.push(u),e.length=0,r=!1;return}if(a<n.length-1){const u={x:s.transform[4]+s.width/5,y:s.transform[5]-s.height/2,width:s.width*.6,height:Math.min(Math.abs(s.transform[5]-n[a+1].transform[5]),s.height/2)},f={x:s.transform[4]+s.width/5,width:s.width*(3/5),y:s.transform[5]-s.height,height:s.height};if(Math.abs(s.transform[5]-n[a+1].transform[5])<=l&&!ID(u,t))e.push(s.str.trim());else if(ID(f,t,!0)&&T2(s.str.trim())&&YU(n,a)&&Math.abs(s.transform[5]-n[a+1].transform[5])<=l&&e.length<1)e.push(s.str.trim()),r=!0;else if(e.length>0){e.push(s.str.trim());const d=e.join(" ");i.push(d),e.length=0}else i.push(s.str.trim())}else{e.push(s.str.trim());const u=e.join(" ");i.push(u),e.length=0}}),e.length>0&&i.push(e.join(" ")),i},F_=(n,t,e)=>Math.max(Math.min(n,e),t),ID=(n,t,e=!1)=>{const i=n.x,r=n.x+n.width,s=n.y,a=n.y+n.height;return t.some(l=>l.x1<=r&&l.x2>=i&&l.y>=s&&l.y<=a&&(Math.abs(l.x2-l.x1)<=15||!e))},T2=n=>/^\d+(\.\d+)?$/.test(n.trim()),YU=(n,t)=>{for(let e=t+1;e<n.length;e++){const i=n[e].str.trim();if(i.trim())return T2(i)}return!1},ks=(n,t=0)=>{if(!n)return t;if(/^\d+\.\d+$/.test(n.trim()))return parseFloat(n.trim());const e=n.match(/\d+(?:[.,]\d+)*/);if(!e)return t;const i=e[0].trim().replaceAll(".","").replace(",","."),r=parseFloat(i);return isNaN(r)?t:r},Od=n=>{const t=new Map;return n.forEach(e=>{e.dataType&&t.set(e.dataType,e.name)}),t},us=(n,t,e)=>{const i=t.get(e);return!i||!n[i]?e==="z"?"0":"":n[i][0]},ul=(n,t,e)=>{const i=t.get(e);return!i||!n[i]?[]:n[i]},sx=(n,t)=>{const e=t.get("depth");if(e&&n[e])return ks(n[e][0]);const i=t.get("depth_from_to");if(i&&n[i]){const r=n[i];return Math.max(...r.map(s=>ks(s)))}return 0},qU=n=>{if(!n||n.length===0)return"-";if(n.length===1)return`${n[0]}`;const t=[...n].sort((e,i)=>e-i);return KU(t)?`${t[0]}-${t[t.length-1]}`:`${t.join(", ")}`},KU=n=>{for(let t=1;t<n.length;t++)if(n[t]!==n[t-1]+1)return!1;return!0},JN=n=>n?["hole_id","x","y","z","depth","date","campaign","water_level"].includes(n):!1,ZU=n=>n?["x","y","z","depth"].includes(n):!1,kD=(n,t)=>{if(!n||n.length===0)return[];const e=n.filter(i=>i.trim()!=="");if(e.length===0)return[];if(JN(t)){const i=e.join(" ").trim();if(t==="water_level"){const r=ks(i,-1);return[r===-1?"Seco":r.toString()]}return ZU(t)?[ks(i).toString()]:[i]}return e},QU=(n,t)=>{const e=n/1e3,i=Math.floor(n/1e3),r=Math.floor((e-i)*t),s=i%60,l=Math.floor(i/60).toString(),u=s.toString().padStart(2,"0"),f=r.toString().padStart(t.toString().length-1,"0");return`${l}:${u},${f}`},JU=({areas:n,zoomScale:t,activeAreaId:e})=>M.jsx(M.Fragment,{children:n.map(i=>!i.coordinates||i.id===e?null:M.jsx("div",{className:"position-absolute border",style:{left:i.coordinates.x*t,top:i.coordinates.y*t,width:i.coordinates.width*t,height:i.coordinates.height*t,backgroundColor:`${i.color}20`,borderColor:i.color,borderWidth:"2px",zIndex:10},title:i.name},`selected-${i.id}`))});/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ez=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase()),MD=n=>{const t=ez(n);return t.charAt(0).toUpperCase()+t.slice(1)},tL=(...n)=>n.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim(),nz=n=>{for(const t in n)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var iz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=U.forwardRef(({color:n="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:a,...l},u)=>U.createElement("svg",{ref:u,...iz,width:t,height:t,stroke:n,strokeWidth:i?Number(e)*24/Number(t):e,className:tL("lucide",r),...!s&&!nz(l)&&{"aria-hidden":"true"},...l},[...a.map(([f,d])=>U.createElement(f,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=(n,t)=>{const e=U.forwardRef(({className:i,...r},s)=>U.createElement(rz,{ref:s,iconNode:t,className:tL(`lucide-${tz(MD(n))}`,`lucide-${n}`,i),...r}));return e.displayName=MD(n),e};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],eL=ar("check",sz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],nL=ar("chevron-left",az);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],iL=ar("chevron-right",oz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],cz=ar("circle-question-mark",lz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Gw=ar("download",uz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],dz=ar("eraser",fz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pz=ar("eye",hz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],gz=ar("folder",mz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],xz=ar("play",vz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],_z=ar("plus",yz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],wz=ar("save",bz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=[["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 14v1",key:"169vum"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M7 16h6",key:"1vyc9m"}],["path",{d:"M7 8h8",key:"1jbsf9"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M9 3h1",key:"1yesri"}]],Az=ar("text-select",Ez);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Tz=ar("trash-2",Sz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Dz=ar("trash",Cz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ax=ar("x",Oz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Nz=ar("zoom-in",Rz);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Iz=ar("zoom-out",Lz);pc.workerSrc=new URL("/JS-Open-Geo/assets/pdf.worker.min-BFAMBS4k.mjs",import.meta.url).toString();const P_=.5,B_=3,kz=U.forwardRef(({file:n,isSelectingActive:t,activeAreaId:e,onFinishSelection:i,areas:r},s)=>{const a=U.useRef(null),[l,u]=U.useState(),[f,d]=U.useState(1),[p,m]=U.useState(!1),[g,y]=U.useState(f),[x,_]=U.useState(!1),[b,S]=U.useState(null),[A,C]=U.useState(null),O=U.useRef(null),N=U.useRef(null),[D,L]=U.useState(1),[I,z]=U.useState(null),j=()=>{L(St=>Math.min(St+.25,B_)),bt(0,0)},B=()=>{bt(0,0),L(St=>Math.max(St-.25,P_))},[tt,k]=U.useState({x:0,y:0}),[et,K]=U.useState(null),[q,_t]=U.useState(!1);function at(St){d(R=>R+St)}function P(){at(-1)}function X(){at(1)}const V=()=>{y(f),m(!0)},it=()=>{g>=1&&g<=(l||1)&&d(g),m(!1)},ht=()=>{y(f),m(!1)},yt=St=>{St.key==="Enter"&&it(),St.key==="Escape"&&ht()};U.useEffect(()=>{p&&O.current&&(O.current.focus(),O.current.select())},[p]);const Rt=St=>{if(N.current){if(x&&A&&A.x>=10&&A.y>=10)_(!1),C(null),i(A);else if(!x){const R=N.current.getBoundingClientRect(),mt=(St.clientX-R.left)/D,ut=(St.clientY-R.top)/D;S({x:mt,y:ut}),_(!0),C(null)}}},Et=St=>{if(!N.current)return;const R=N.current.getBoundingClientRect();K({x:St.clientX-R.left,y:St.clientY-R.top}),_t(!0)},G=U.useCallback(St=>{N.current&&(St.currentTarget.setPointerCapture(St.pointerId),t?Rt(St):Et(St))},[x,A,D,t]),lt=U.useCallback(St=>{if(!N.current)return;const R=N.current.getBoundingClientRect();if(q){if(q&&et){const Q=St.clientX-R.left-et.x,gt=St.clientY-R.top-et.y;bt(Q,gt)}return}if(!x||!b)return;const mt=(St.clientX-R.left)/D,ut=(St.clientY-R.top)/D,J={x:Math.min(b.x,mt),y:Math.min(b.y,ut),width:Math.abs(b.x-mt),height:Math.abs(b.y-ut)};C(J)},[x,b,q,et]),rt=U.useCallback(St=>{St.currentTarget.releasePointerCapture(St.pointerId),q&&_t(!1)},[q,Et]);U.useEffect(()=>{t||ot()},[t]);const ot=()=>{_(!1),C(null),S(null)},bt=U.useCallback((St,R)=>{const mt=document.querySelector(".pdf-container"),ut=mt?.getBoundingClientRect().width||600,J=mt?parseInt(getComputedStyle(mt).height):800,Q=N.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().width||ut,gt=N.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().height||J,Bt=document.querySelector(".pdf-nav")?.getBoundingClientRect().height||40,Ht=Q>=ut,Ct=gt>=J-Bt,kt=Math.max(0,Q-ut),Dt=Math.max(0,gt-J+Bt);k(xt=>({x:Ht?F_(xt.x+St,-kt,0):0,y:Ct?F_(xt.y+R,-Dt,0):0}))},[]);return U.useEffect(()=>{if(!n)return;const St=document.querySelector(".pdf-container");if(!St)return;const R=mt=>{mt.preventDefault();const ut=St.getBoundingClientRect(),J=(mt.clientX-ut.left)/ut.width,Q=(mt.clientY-ut.top)/ut.height,gt=.1;L(Bt=>{const Ht=mt.deltaY>0?-gt:gt,Ct=F_(Bt+Ht,P_,B_),kt=N.current?.querySelector(".react-pdf__Page"),Dt=kt?.getBoundingClientRect().width||0,xt=kt?.getBoundingClientRect().height||0,te=Ct-Bt,ae=Dt*te,ne=xt*te,Me=ae*J,dn=ne*Q;return z({x:-Me,y:-dn}),Ct})};return St.addEventListener("wheel",R,{passive:!1}),()=>{St.removeEventListener("wheel",R)}},[n,D]),U.useEffect(()=>{I&&(bt(I.x,I.y),z(null))},[D]),U.useImperativeHandle(s,()=>({getDocument:()=>a.current})),n?M.jsx(M.Fragment,{children:M.jsxs("div",{className:"pdf-container mt-2",style:{height:"min(800px, 80vh)",overflow:"hidden",position:"relative",border:"2px solid black",marginBottom:"15px"},children:[M.jsxs("div",{ref:N,className:`position-relative d-inline-block ${t?"pdf-cursor-crosshair":q?"pdf-cursor-grabbing":"pdf-cursor-grab"}`,onPointerDown:G,onPointerMove:lt,onPointerUp:rt,style:{userSelect:"none",transform:`translate(${tt.x}px, ${tt.y}px)`},children:[M.jsx(FU,{file:n,onLoadSuccess:St=>{u(St.numPages),d(1),L(1),a.current=St},children:M.jsx(XU,{pageNumber:f,renderTextLayer:!1,renderAnnotationLayer:!1,scale:D})}),M.jsx(JU,{areas:r,zoomScale:D,activeAreaId:e}),A&&M.jsx("div",{className:"position-absolute border border-secondary",style:{left:A.x*D,top:A.y*D,width:A.width*D,height:A.height*D,backgroundColor:"rgba(134, 142, 135, 0.2)",zIndex:10}})]}),M.jsxs("div",{className:"pdf-nav position-absolute bottom-0 start-0 end-0 d-flex align-items-center",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",padding:"4px 12px"},children:[M.jsx("div",{className:"flex-grow-1 d-flex justify-content-center",children:p?M.jsxs("div",{className:"d-flex align-items-center gap-1",children:[M.jsx("input",{ref:O,type:"number",className:"form-control form-control-sm text-center",style:{width:"40px",fontSize:"12px",backgroundColor:"rgba(108, 108, 108, 0.8)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"2px",color:"white"},value:g,min:1,max:l||1,onChange:St=>y(parseInt(St.target.value)||1),onKeyDown:yt,onBlur:ht,autoFocus:!0}),M.jsxs("span",{className:"text-white small",children:["de ",l||1]})]}):M.jsxs("span",{onClick:V,className:"text-white small",title:"Selecionar página",style:{cursor:"pointer"},children:["Página ",f||1," ",l&&`de ${l}`]})}),M.jsxs("div",{className:"d-flex gap-1",children:[M.jsx("button",{className:"pdf-nav-button",title:"Página anterior",onClick:P,disabled:f<=1,children:M.jsx(nL,{size:24,color:"#d0d0d0"})}),M.jsx("button",{className:"pdf-nav-button",title:"Próxima página",onClick:X,disabled:f>=(l??0),children:M.jsx(iL,{size:24,color:"#d0d0d0"})}),M.jsx("button",{className:"pdf-nav-button",onClick:B,disabled:D<=P_,children:M.jsx(Iz,{size:24,color:"#d0d0d0"})}),M.jsx("button",{className:"pdf-nav-button",onClick:j,disabled:D>=B_,children:M.jsx(Nz,{size:24,color:"#d0d0d0"})})]})]})]})}):M.jsx(M.Fragment,{children:M.jsx("div",{className:"row",children:M.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",style:{minHeight:"50vh"},children:M.jsx("p",{className:"text-muted",children:"Carregue um pdf para ser exibido aqui"})})})})}),Mz=["default","hole_id","x","y","z","depth","date","depth_from_to","water_level","geology","nspt","campaign","interp","generic_info"],Tu={default:"Padrão",hole_id:"ID da Sondagem",x:"Coordenada X",y:"Coordenada Y",z:"Cota",depth:"Profundidade Total",date:"Data",depth_from_to:"Profundidades",water_level:"Nível d'Água",geology:"Descrição Geológica",nspt:"NSPT",campaign:"Campanha",interp:"Interpretação Geológica",generic_info:"Outras Informações"},rL=["hole_id","x","y","z","depth","date","water_level","campaign"],sL=["hole_id"],Fz=["hole_id","x","y","z","depth"],j_=["hole_id","x","y","z","depth","depth_from_to","geology","nspt","water_level","interp"],zv=["collar","nspt","na","geology","interp"],Pz={collar:"Collar",nspt:"NSPT",na:"NA",geology:"Geologia",interp:"Interpretação"},Bz={collar:["hole_id","x","y"],nspt:["hole_id","nspt"],na:["hole_id","water_level"],geology:["hole_id","geology","depth_from_to"],interp:["hole_id","interp","depth_from_to"]},jz=({hasFile:n,area:t,areas:e,extractionMode:i,onStartSelection:r,onClearArea:s,onDeleteArea:a,onRenameArea:l,onToggleMandatory:u,onToggleRepeat:f,onToggleAreaOCR:d,onChangeAreaType:p})=>{const[m,g]=U.useState(!1),[y,x]=U.useState(t.name),_=U.useRef(null);U.useEffect(()=>{const L=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));return L.forEach(I=>new yc(I)),()=>{L.forEach(I=>{const z=yc.getInstance(I);z&&z.dispose()})}},[t]),U.useEffect(()=>{m&&_.current&&(_.current.focus(),_.current.select())},[m]);const b=()=>{r(t.id)},S=()=>{a(t.id)},A=()=>{s(t.id)},C=()=>{x(t.name),g(!0)},O=L=>{L.key==="Enter"&&N(),L.key==="Escape"&&D()},N=()=>{y.trim()&&y.trim()!==t.name?(l(t.id,y.trim()),g(!1)):D()},D=()=>{x(t.name),g(!1)};return M.jsx(M.Fragment,{children:M.jsxs("div",{className:"border rounded mb-1",children:[M.jsxs("div",{className:"d-flex align-items-center gap-1 pt-2 px-2 pb-1",children:[M.jsx("div",{className:"drag-handle",style:{cursor:"grab"},children:"⋮⋮"}),M.jsx("div",{className:"d-flex align-items-center",children:M.jsxs("span",{className:"badge me-2",style:{backgroundColor:t.color,color:"white"},children:["#",t.order]})}),m?M.jsxs("div",{className:"d-flex align-items-center flex-grow-1",children:[M.jsx("input",{ref:_,type:"text",className:"form-control form-control-sm me-2",value:y,onChange:L=>x(L.target.value),onKeyDown:O,onBlur:N}),M.jsxs("div",{className:"d-flex gap-2",children:[M.jsx("button",{className:"menu-btn menu-btn-cta",title:"Confirmar",onClick:N,children:M.jsx(eL,{size:16})}),M.jsx("button",{className:"menu-btn menu-btn-warning",title:"Cancelar",onClick:D,children:M.jsx(ax,{size:16})})]})]}):M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"flex-grow-1 text-start area-name-section",style:{minWidth:0},children:M.jsx("span",{onClick:C,style:{width:"calc(100% - 10px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},title:t.name,children:t.name})}),M.jsx("button",{className:"menu-btn menu-btn-cta",disabled:!n,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Selecionar área",onClick:b,children:M.jsx(Az,{size:16})}),t.coordinates&&M.jsx("button",{className:"menu-btn menu-btn-alert",onClick:A,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Limpar seleção",children:M.jsx(dz,{size:16})}),M.jsx("button",{className:"menu-btn menu-btn-warning area-delete",onClick:S,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Excluir área",children:M.jsx(Dz,{size:14})})]})]}),M.jsxs("div",{className:"d-flex align-items-center gap-2 px-2 pb-2 justify-content-between",children:[M.jsx("div",{className:"flex-grow-1 me-2",children:M.jsxs("select",{className:"form-select form-select-sm w-100",value:t.dataType||"",onChange:L=>p(t.id,L.target.value),children:[M.jsx("option",{value:"default",children:"Tipo padrão"}),Mz.filter(L=>L!=="default"&&(!Fz.includes(L)||!e.find(I=>I.dataType===L&&I.id!==t.id))).map(L=>M.jsx("option",{value:L,children:Tu[L]},L))]})}),M.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Extrair textos com OCR",children:[M.jsx("input",{className:"form-check-input",type:"checkbox",id:`ocr-${t.id}`,disabled:i!=="both",checked:t.ocr,onChange:L=>d(t.id,L.target.checked)}),M.jsx("label",{className:"form-check-label small",children:"OCR"})]}),M.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Pular páginas sem texto nesta área",children:[M.jsx("input",{className:"form-check-input",type:"checkbox",id:`mandatory-${t.id}`,checked:t.isMandatory,onChange:L=>u(t.id,L.target.checked)}),M.jsx("label",{className:"form-check-label small",children:"Obrig."})]}),M.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":e.find(L=>L.dataType==="hole_id")?"Usar um único valor por sondagem":"Adicione uma área como ID da Sondagem para utilizar essa opção",children:[M.jsx("input",{className:"form-check-input",type:"checkbox",id:`repeat-${t.id}`,checked:t.repeatInPages,onChange:L=>f(t.id,L.target.checked),disabled:!e.find(L=>L.dataType==="hole_id")}),M.jsx("label",{className:"form-check-label small",children:"Único"})]})]})]})})};var U_={exports:{}},z_,FD;function Uz(){if(FD)return z_;FD=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return z_=n,z_}var H_,PD;function zz(){if(PD)return H_;PD=1;var n=Uz();function t(){}function e(){}return e.resetWarningCache=t,H_=function(){function i(a,l,u,f,d,p){if(p!==n){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}i.isRequired=i;function r(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:r,element:i,elementType:i,instanceOf:r,node:i,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:e,resetWarningCache:t};return s.PropTypes=s,s},H_}var BD;function Hz(){return BD||(BD=1,U_.exports=zz()()),U_.exports}var $z=Hz();const nn=ku($z);function Uu(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function l(d){try{f(i.next(d))}catch(p){a(p)}}function u(d){try{f(i.throw(d))}catch(p){a(p)}}function f(d){d.done?s(d.value):r(d.value).then(l,u)}f((i=i.apply(n,t||[])).next())})}const Gz=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function vd(n,t,e){const i=Vz(n),{webkitRelativePath:r}=n,s=typeof t=="string"?t:typeof r=="string"&&r.length>0?r:`./${n.name}`;return typeof i.path!="string"&&jD(i,"path",s),jD(i,"relativePath",s),i}function Vz(n){const{name:t}=n;if(t&&t.lastIndexOf(".")!==-1&&!n.type){const i=t.split(".").pop().toLowerCase(),r=Gz.get(i);r&&Object.defineProperty(n,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return n}function jD(n,t,e){Object.defineProperty(n,t,{value:e,writable:!1,configurable:!1,enumerable:!0})}const Wz=[".DS_Store","Thumbs.db"];function Xz(n){return Uu(this,void 0,void 0,function*(){return Qv(n)&&Yz(n.dataTransfer)?Qz(n.dataTransfer,n.type):qz(n)?Kz(n):Array.isArray(n)&&n.every(t=>"getFile"in t&&typeof t.getFile=="function")?Zz(n):[]})}function Yz(n){return Qv(n)}function qz(n){return Qv(n)&&Qv(n.target)}function Qv(n){return typeof n=="object"&&n!==null}function Kz(n){return Vw(n.target.files).map(t=>vd(t))}function Zz(n){return Uu(this,void 0,void 0,function*(){return(yield Promise.all(n.map(e=>e.getFile()))).map(e=>vd(e))})}function Qz(n,t){return Uu(this,void 0,void 0,function*(){if(n.items){const e=Vw(n.items).filter(r=>r.kind==="file");if(t!=="drop")return e;const i=yield Promise.all(e.map(Jz));return UD(aL(i))}return UD(Vw(n.files).map(e=>vd(e)))})}function UD(n){return n.filter(t=>Wz.indexOf(t.name)===-1)}function Vw(n){if(n===null)return[];const t=[];for(let e=0;e<n.length;e++){const i=n[e];t.push(i)}return t}function Jz(n){if(typeof n.webkitGetAsEntry!="function")return zD(n);const t=n.webkitGetAsEntry();return t&&t.isDirectory?oL(t):zD(n,t)}function aL(n){return n.reduce((t,e)=>[...t,...Array.isArray(e)?aL(e):[e]],[])}function zD(n,t){return Uu(this,void 0,void 0,function*(){var e;if(globalThis.isSecureContext&&typeof n.getAsFileSystemHandle=="function"){const s=yield n.getAsFileSystemHandle();if(s===null)throw new Error(`${n} is not a File`);if(s!==void 0){const a=yield s.getFile();return a.handle=s,vd(a)}}const i=n.getAsFile();if(!i)throw new Error(`${n} is not a File`);return vd(i,(e=t?.fullPath)!==null&&e!==void 0?e:void 0)})}function tH(n){return Uu(this,void 0,void 0,function*(){return n.isDirectory?oL(n):eH(n)})}function oL(n){const t=n.createReader();return new Promise((e,i)=>{const r=[];function s(){t.readEntries(a=>Uu(this,void 0,void 0,function*(){if(a.length){const l=Promise.all(a.map(tH));r.push(l),s()}else try{const l=yield Promise.all(r);e(l)}catch(l){i(l)}}),a=>{i(a)})}s()})}function eH(n){return Uu(this,void 0,void 0,function*(){return new Promise((t,e)=>{n.file(i=>{const r=vd(i,n.fullPath);t(r)},i=>{e(i)})})})}var Wg={},HD;function nH(){return HD||(HD=1,Wg.__esModule=!0,Wg.default=function(n,t){if(n&&t){var e=Array.isArray(t)?t:t.split(",");if(e.length===0)return!0;var i=n.name||"",r=(n.type||"").toLowerCase(),s=r.replace(/\/.*$/,"");return e.some(function(a){var l=a.trim().toLowerCase();return l.charAt(0)==="."?i.toLowerCase().endsWith(l):l.endsWith("/*")?s===l.replace(/\/.*$/,""):r===l})}return!0}),Wg}var iH=nH();const $_=ku(iH);function $D(n){return aH(n)||sH(n)||cL(n)||rH()}function rH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sH(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function aH(n){if(Array.isArray(n))return Ww(n)}function GD(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),e.push.apply(e,i)}return e}function VD(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?GD(Object(e),!0).forEach(function(i){lL(n,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):GD(Object(e)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(e,i))})}return n}function lL(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function t0(n,t){return cH(n)||lH(n,t)||cL(n,t)||oH()}function oH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cL(n,t){if(n){if(typeof n=="string")return Ww(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ww(n,t)}}function Ww(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,i=new Array(t);e<t;e++)i[e]=n[e];return i}function lH(n,t){var e=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(e!=null){var i=[],r=!0,s=!1,a,l;try{for(e=e.call(n);!(r=(a=e.next()).done)&&(i.push(a.value),!(t&&i.length===t));r=!0);}catch(u){s=!0,l=u}finally{try{!r&&e.return!=null&&e.return()}finally{if(s)throw l}}return i}}function cH(n){if(Array.isArray(n))return n}var uH=typeof $_=="function"?$_:$_.default,fH="file-invalid-type",dH="file-too-large",hH="file-too-small",pH="too-many-files",mH=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=t.split(","),i=e.length>1?"one of ".concat(e.join(", ")):e[0];return{code:fH,message:"File type must be ".concat(i)}},WD=function(t){return{code:dH,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},XD=function(t){return{code:hH,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},gH={code:pH,message:"Too many files"};function uL(n,t){var e=n.type==="application/x-moz-file"||uH(n,t);return[e,e?null:mH(t)]}function fL(n,t,e){if(cu(n.size))if(cu(t)&&cu(e)){if(n.size>e)return[!1,WD(e)];if(n.size<t)return[!1,XD(t)]}else{if(cu(t)&&n.size<t)return[!1,XD(t)];if(cu(e)&&n.size>e)return[!1,WD(e)]}return[!0,null]}function cu(n){return n!=null}function vH(n){var t=n.files,e=n.accept,i=n.minSize,r=n.maxSize,s=n.multiple,a=n.maxFiles,l=n.validator;return!s&&t.length>1||s&&a>=1&&t.length>a?!1:t.every(function(u){var f=uL(u,e),d=t0(f,1),p=d[0],m=fL(u,i,r),g=t0(m,1),y=g[0],x=l?l(u):null;return p&&y&&!x})}function Jv(n){return typeof n.isPropagationStopped=="function"?n.isPropagationStopped():typeof n.cancelBubble<"u"?n.cancelBubble:!1}function Xg(n){return n.dataTransfer?Array.prototype.some.call(n.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!n.target&&!!n.target.files}function YD(n){n.preventDefault()}function xH(n){return n.indexOf("MSIE")!==-1||n.indexOf("Trident/")!==-1}function yH(n){return n.indexOf("Edge/")!==-1}function _H(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return xH(n)||yH(n)}function ao(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return t.some(function(l){return!Jv(i)&&l&&l.apply(void 0,[i].concat(s)),Jv(i)})}}function bH(){return"showOpenFilePicker"in window}function wH(n){if(cu(n)){var t=Object.entries(n).filter(function(e){var i=t0(e,2),r=i[0],s=i[1],a=!0;return dL(r)||(console.warn('Skipped "'.concat(r,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),a=!1),(!Array.isArray(s)||!s.every(hL))&&(console.warn('Skipped "'.concat(r,'" because an invalid file extension was provided.')),a=!1),a}).reduce(function(e,i){var r=t0(i,2),s=r[0],a=r[1];return VD(VD({},e),{},lL({},s,a))},{});return[{description:"Files",accept:t}]}return n}function EH(n){if(cu(n))return Object.entries(n).reduce(function(t,e){var i=t0(e,2),r=i[0],s=i[1];return[].concat($D(t),[r],$D(s))},[]).filter(function(t){return dL(t)||hL(t)}).join(",")}function AH(n){return n instanceof DOMException&&(n.name==="AbortError"||n.code===n.ABORT_ERR)}function SH(n){return n instanceof DOMException&&(n.name==="SecurityError"||n.code===n.SECURITY_ERR)}function dL(n){return n==="audio/*"||n==="video/*"||n==="image/*"||n==="text/*"||n==="application/*"||/\w+\/[-+.\w]+/g.test(n)}function hL(n){return/^.*\.[\w]+$/.test(n)}var TH=["children"],CH=["open"],DH=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],OH=["refKey","onChange","onClick"];function RH(n){return IH(n)||LH(n)||pL(n)||NH()}function NH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LH(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function IH(n){if(Array.isArray(n))return Xw(n)}function G_(n,t){return FH(n)||MH(n,t)||pL(n,t)||kH()}function kH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pL(n,t){if(n){if(typeof n=="string")return Xw(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Xw(n,t)}}function Xw(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,i=new Array(t);e<t;e++)i[e]=n[e];return i}function MH(n,t){var e=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(e!=null){var i=[],r=!0,s=!1,a,l;try{for(e=e.call(n);!(r=(a=e.next()).done)&&(i.push(a.value),!(t&&i.length===t));r=!0);}catch(u){s=!0,l=u}finally{try{!r&&e.return!=null&&e.return()}finally{if(s)throw l}}return i}}function FH(n){if(Array.isArray(n))return n}function qD(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),e.push.apply(e,i)}return e}function ni(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?qD(Object(e),!0).forEach(function(i){Yw(n,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):qD(Object(e)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(e,i))})}return n}function Yw(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function t1(n,t){if(n==null)return{};var e=PH(n,t),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(e[i]=n[i])}return e}function PH(n,t){if(n==null)return{};var e={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&(e[r]=n[r]);return e}var C2=U.forwardRef(function(n,t){var e=n.children,i=t1(n,TH),r=gL(i),s=r.open,a=t1(r,CH);return U.useImperativeHandle(t,function(){return{open:s}},[s]),Je.createElement(U.Fragment,null,e(ni(ni({},a),{},{open:s})))});C2.displayName="Dropzone";var mL={disabled:!1,getFilesFromEvent:Xz,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};C2.defaultProps=mL;C2.propTypes={children:nn.func,accept:nn.objectOf(nn.arrayOf(nn.string)),multiple:nn.bool,preventDropOnDocument:nn.bool,noClick:nn.bool,noKeyboard:nn.bool,noDrag:nn.bool,noDragEventsBubbling:nn.bool,minSize:nn.number,maxSize:nn.number,maxFiles:nn.number,disabled:nn.bool,getFilesFromEvent:nn.func,onFileDialogCancel:nn.func,onFileDialogOpen:nn.func,useFsAccessApi:nn.bool,autoFocus:nn.bool,onDragEnter:nn.func,onDragLeave:nn.func,onDragOver:nn.func,onDrop:nn.func,onDropAccepted:nn.func,onDropRejected:nn.func,onError:nn.func,validator:nn.func};var qw={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function gL(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=ni(ni({},mL),n),e=t.accept,i=t.disabled,r=t.getFilesFromEvent,s=t.maxSize,a=t.minSize,l=t.multiple,u=t.maxFiles,f=t.onDragEnter,d=t.onDragLeave,p=t.onDragOver,m=t.onDrop,g=t.onDropAccepted,y=t.onDropRejected,x=t.onFileDialogCancel,_=t.onFileDialogOpen,b=t.useFsAccessApi,S=t.autoFocus,A=t.preventDropOnDocument,C=t.noClick,O=t.noKeyboard,N=t.noDrag,D=t.noDragEventsBubbling,L=t.onError,I=t.validator,z=U.useMemo(function(){return EH(e)},[e]),j=U.useMemo(function(){return wH(e)},[e]),B=U.useMemo(function(){return typeof _=="function"?_:KD},[_]),tt=U.useMemo(function(){return typeof x=="function"?x:KD},[x]),k=U.useRef(null),et=U.useRef(null),K=U.useReducer(BH,qw),q=G_(K,2),_t=q[0],at=q[1],P=_t.isFocused,X=_t.isFileDialogActive,V=U.useRef(typeof window<"u"&&window.isSecureContext&&b&&bH()),it=function(){!V.current&&X&&setTimeout(function(){if(et.current){var xt=et.current.files;xt.length||(at({type:"closeDialog"}),tt())}},300)};U.useEffect(function(){return window.addEventListener("focus",it,!1),function(){window.removeEventListener("focus",it,!1)}},[et,X,tt,V]);var ht=U.useRef([]),yt=function(xt){k.current&&k.current.contains(xt.target)||(xt.preventDefault(),ht.current=[])};U.useEffect(function(){return A&&(document.addEventListener("dragover",YD,!1),document.addEventListener("drop",yt,!1)),function(){A&&(document.removeEventListener("dragover",YD),document.removeEventListener("drop",yt))}},[k,A]),U.useEffect(function(){return!i&&S&&k.current&&k.current.focus(),function(){}},[k,S,i]);var Rt=U.useCallback(function(Dt){L?L(Dt):console.error(Dt)},[L]),Et=U.useCallback(function(Dt){Dt.preventDefault(),Dt.persist(),Bt(Dt),ht.current=[].concat(RH(ht.current),[Dt.target]),Xg(Dt)&&Promise.resolve(r(Dt)).then(function(xt){if(!(Jv(Dt)&&!D)){var te=xt.length,ae=te>0&&vH({files:xt,accept:z,minSize:a,maxSize:s,multiple:l,maxFiles:u,validator:I}),ne=te>0&&!ae;at({isDragAccept:ae,isDragReject:ne,isDragActive:!0,type:"setDraggedFiles"}),f&&f(Dt)}}).catch(function(xt){return Rt(xt)})},[r,f,Rt,D,z,a,s,l,u,I]),G=U.useCallback(function(Dt){Dt.preventDefault(),Dt.persist(),Bt(Dt);var xt=Xg(Dt);if(xt&&Dt.dataTransfer)try{Dt.dataTransfer.dropEffect="copy"}catch{}return xt&&p&&p(Dt),!1},[p,D]),lt=U.useCallback(function(Dt){Dt.preventDefault(),Dt.persist(),Bt(Dt);var xt=ht.current.filter(function(ae){return k.current&&k.current.contains(ae)}),te=xt.indexOf(Dt.target);te!==-1&&xt.splice(te,1),ht.current=xt,!(xt.length>0)&&(at({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Xg(Dt)&&d&&d(Dt))},[k,d,D]),rt=U.useCallback(function(Dt,xt){var te=[],ae=[];Dt.forEach(function(ne){var Me=uL(ne,z),dn=G_(Me,2),Se=dn[0],gn=dn[1],Ze=fL(ne,a,s),Zn=G_(Ze,2),Bn=Zn[0],On=Zn[1],Oi=I?I(ne):null;if(Se&&Bn&&!Oi)te.push(ne);else{var Us=[gn,On];Oi&&(Us=Us.concat(Oi)),ae.push({file:ne,errors:Us.filter(function(pa){return pa})})}}),(!l&&te.length>1||l&&u>=1&&te.length>u)&&(te.forEach(function(ne){ae.push({file:ne,errors:[gH]})}),te.splice(0)),at({acceptedFiles:te,fileRejections:ae,isDragReject:ae.length>0,type:"setFiles"}),m&&m(te,ae,xt),ae.length>0&&y&&y(ae,xt),te.length>0&&g&&g(te,xt)},[at,l,z,a,s,u,m,g,y,I]),ot=U.useCallback(function(Dt){Dt.preventDefault(),Dt.persist(),Bt(Dt),ht.current=[],Xg(Dt)&&Promise.resolve(r(Dt)).then(function(xt){Jv(Dt)&&!D||rt(xt,Dt)}).catch(function(xt){return Rt(xt)}),at({type:"reset"})},[r,rt,Rt,D]),bt=U.useCallback(function(){if(V.current){at({type:"openDialog"}),B();var Dt={multiple:l,types:j};window.showOpenFilePicker(Dt).then(function(xt){return r(xt)}).then(function(xt){rt(xt,null),at({type:"closeDialog"})}).catch(function(xt){AH(xt)?(tt(xt),at({type:"closeDialog"})):SH(xt)?(V.current=!1,et.current?(et.current.value=null,et.current.click()):Rt(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Rt(xt)});return}et.current&&(at({type:"openDialog"}),B(),et.current.value=null,et.current.click())},[at,B,tt,b,rt,Rt,j,l]),St=U.useCallback(function(Dt){!k.current||!k.current.isEqualNode(Dt.target)||(Dt.key===" "||Dt.key==="Enter"||Dt.keyCode===32||Dt.keyCode===13)&&(Dt.preventDefault(),bt())},[k,bt]),R=U.useCallback(function(){at({type:"focus"})},[]),mt=U.useCallback(function(){at({type:"blur"})},[]),ut=U.useCallback(function(){C||(_H()?setTimeout(bt,0):bt())},[C,bt]),J=function(xt){return i?null:xt},Q=function(xt){return O?null:J(xt)},gt=function(xt){return N?null:J(xt)},Bt=function(xt){D&&xt.stopPropagation()},Ht=U.useMemo(function(){return function(){var Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},xt=Dt.refKey,te=xt===void 0?"ref":xt,ae=Dt.role,ne=Dt.onKeyDown,Me=Dt.onFocus,dn=Dt.onBlur,Se=Dt.onClick,gn=Dt.onDragEnter,Ze=Dt.onDragOver,Zn=Dt.onDragLeave,Bn=Dt.onDrop,On=t1(Dt,DH);return ni(ni(Yw({onKeyDown:Q(ao(ne,St)),onFocus:Q(ao(Me,R)),onBlur:Q(ao(dn,mt)),onClick:J(ao(Se,ut)),onDragEnter:gt(ao(gn,Et)),onDragOver:gt(ao(Ze,G)),onDragLeave:gt(ao(Zn,lt)),onDrop:gt(ao(Bn,ot)),role:typeof ae=="string"&&ae!==""?ae:"presentation"},te,k),!i&&!O?{tabIndex:0}:{}),On)}},[k,St,R,mt,ut,Et,G,lt,ot,O,N,i]),Ct=U.useCallback(function(Dt){Dt.stopPropagation()},[]),kt=U.useMemo(function(){return function(){var Dt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},xt=Dt.refKey,te=xt===void 0?"ref":xt,ae=Dt.onChange,ne=Dt.onClick,Me=t1(Dt,OH),dn=Yw({accept:z,multiple:l,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:J(ao(ae,ot)),onClick:J(ao(ne,Ct)),tabIndex:-1},te,et);return ni(ni({},dn),Me)}},[et,e,l,ot,i]);return ni(ni({},_t),{},{isFocused:P&&!i,getRootProps:Ht,getInputProps:kt,rootRef:k,inputRef:et,open:J(bt)})}function BH(n,t){switch(t.type){case"focus":return ni(ni({},n),{},{isFocused:!0});case"blur":return ni(ni({},n),{},{isFocused:!1});case"openDialog":return ni(ni({},qw),{},{isFileDialogActive:!0});case"closeDialog":return ni(ni({},n),{},{isFileDialogActive:!1});case"setDraggedFiles":return ni(ni({},n),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return ni(ni({},n),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case"reset":return ni({},qw);default:return n}}function KD(){}const jH=100*1024*1024;function UH({onFileSelect:n}){const[t,e]=U.useState(null),[i,r]=U.useState(null),s=async A=>{if(A){const C=A[0],O=await l(C);if(!O.isValid){e({type:"error",message:`${O.error} - O arquivo pode estar corrompido ou não ser um PDF real.`});return}r(C),e({type:"success",message:`PDF "${C.name}" carregado com sucesso! (${(C.size/1024/1024).toFixed(2)} MB)`}),n(C)}};U.useEffect(()=>{if(t?.type==="success"){const A=setTimeout(()=>{e(null)},5e3);return()=>clearTimeout(A)}},[t]);const a=()=>{e(null)},l=async A=>new Promise(C=>{const O=new FileReader;O.onload=N=>{if(!N.target?.result){C({isValid:!1,error:"Não foi possível ler o arquivo"});return}const D=new Uint8Array(N.target.result),I=[37,80,68,70,45].every((z,j)=>D[j]===z);C(I?{isValid:!0}:{isValid:!1,error:"Arquivo não é um PDF válido"})},O.onerror=()=>{C({isValid:!1,error:"Erro ao ler arquivo"})},O.readAsArrayBuffer(A.slice(0,5))}),u=A=>{if(A.length>0){const C=A[0],O=C.file,N=C.errors;N.some(D=>D.code==="file-invalid-type")?e({type:"error",message:`Arquivo "${O.name}" não é um PDF válido. Apenas arquivos PDF são permitidos!`}):N.some(D=>D.code==="file-too-large")?e({type:"error",message:`Arquivo "${O.name}" muito grande! Limite máximo: 100MB. Seu arquivo: ${(O.size/1024/1024).toFixed(1)}MB`}):N.some(D=>D.code==="too-many-files")?e({type:"error",message:"Apenas um arquivo por vez é permitido!"}):e({type:"error",message:`Erro ao carregar "${O.name}": ${N[0]?.message||"Arquivo inválido"}`})}},f={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"10px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},d={borderColor:"#2196f3"},p={borderColor:"#00e676"},m={borderColor:"#ff1744"},{getRootProps:g,getInputProps:y,isFocused:x,isDragAccept:_,isDragReject:b}=gL({accept:{"application/pdf":[".pdf"]},onDropAccepted:s,onDropRejected:u,maxFiles:1,maxSize:jH}),S=U.useMemo(()=>({...f,...x?d:{},..._?p:{},...b?m:{}}),[x,_,b,i]);return M.jsxs("div",{children:[t&&M.jsxs("div",{className:`alert alert-${t.type==="success"?"success":"danger"} alert-dismissible fade show`,role:"alert",children:[M.jsx("strong",{children:t.type==="success"?"Sucesso!":"Erro!"})," ",t.message,M.jsx("button",{type:"button",className:"btn-close",onClick:a,"aria-label":"Close"})]}),M.jsx("div",{className:"container",children:M.jsxs("div",{...g({style:S}),children:[M.jsx("input",{...y()}),i?M.jsxs("div",{style:{color:"#4caf50",textAlign:"center"},children:[M.jsx("p",{style:{margin:0,wordBreak:"break-all",wordWrap:"break-word",overflowWrap:"break-word",maxWidth:"100%",fontSize:14},children:M.jsx("strong",{children:i.name})}),M.jsx("p",{className:"m-0 small",children:"Clique ou arraste para trocar o arquivo"})]}):M.jsx("p",{className:"m-0",children:"Arraste seu PDF aqui, ou clique para selecionar arquivos"})]})})]})}const ZD="extrator-dados-pdf-presets",zH=({isOpen:n,onClose:t,currentAreas:e,onLoadPreset:i})=>{const[r,s]=U.useState(""),[a,l]=U.useState([]);U.useEffect(()=>{u()},[]);const u=()=>{try{const x=localStorage.getItem(ZD);if(x){const _=JSON.parse(x);l(_)}}catch(x){console.error("Erro ao carregar presets:",x)}},f=x=>{try{localStorage.setItem(ZD,JSON.stringify(x))}catch(_){console.error("Erro ao salvar presets:",_)}},d=()=>{if(!r.trim())return;if(e.length<=0){alert("Não é possível salvar um preset sem áreas");return}const x={name:r.trim(),areas:e},_=[...a,x];l(_),f(_),s("")},p=x=>{confirm("Isso vai substituir todas as áreas atuais. Continuar?")&&(i(x.areas),t())},m=x=>{if(!confirm("Tem certeza que deseja excluir este preset?"))return;const _=a.filter((b,S)=>S!==x);l(_),f(_)},g=x=>{const _=JSON.stringify(x,null,2),b=new Blob([_],{type:"application/json"}),S=URL.createObjectURL(b),A=document.createElement("a");A.href=S,A.download=`${x.name}.json`,A.click(),URL.revokeObjectURL(S)},y=x=>{const _=x.target.files?.[0];if(!_)return;const b=new FileReader;b.onload=S=>{try{const A=S.target?.result,C=JSON.parse(A);if(!C.name||!Array.isArray(C.areas)){alert("Arquivo JSON inválido!");return}const O=[...a,C];l(O),f(O),x.target.value="",alert(`Preset "${C.name}" importado com sucesso!`)}catch(A){alert("Erro ao ler arquivo JSON!"),console.error(A)}},b.readAsText(_)};return n?M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50",style:{zIndex:1050},onClick:t}),M.jsxs("div",{className:"position-fixed top-50 start-50 translate-middle bg-white rounded shadow-lg p-4",style:{zIndex:1051,width:"500px",maxHeight:"80vh",overflowY:"auto"},children:[M.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[M.jsx("h5",{className:"mb-0",children:"Gerenciar Presets"}),M.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:t,children:M.jsx(ax,{size:16})})]}),M.jsxs("div",{className:"mb-4 p-3 border rounded",children:[M.jsx("h6",{children:"Salvar Preset Atual"}),M.jsxs("div",{className:"d-flex gap-2",children:[M.jsx("input",{type:"text",className:"form-control",placeholder:"Nome do preset...",value:r,onChange:x=>s(x.target.value),onKeyDown:x=>x.key==="Enter"&&d()}),M.jsxs("button",{className:"btn btn-success",onClick:d,disabled:!r.trim()||e.length===0,children:[M.jsx(wz,{size:16,className:"me-1"}),"Salvar"]})]}),M.jsx("small",{className:"text-muted",children:e.length===0?"Nenhuma área para salvar":e.length===1?"1 área será salva":`${e.length} áreas serão salvas`})]}),M.jsxs("div",{className:"mb-4",children:[M.jsx("h6",{children:"Presets Salvos"}),a.length===0?M.jsx("p",{className:"text-muted",children:"Nenhum preset salvo ainda."}):a.map((x,_)=>M.jsxs("div",{className:"d-flex justify-content-between align-items-center p-2 border rounded mb-2",children:[M.jsxs("div",{children:[M.jsx("strong",{children:x.name}),M.jsx("br",{}),M.jsxs("small",{className:"text-muted",children:[x.areas.length," área(s)"]})]}),M.jsxs("div",{className:"d-flex gap-1",children:[M.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>p(x),title:"Carregar preset",children:M.jsx(xz,{size:14})}),M.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>g(x),title:"Download JSON",children:M.jsx(Gw,{size:14})}),M.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>m(_),title:"Excluir preset",children:M.jsx(Tz,{size:14})})]})]},_))]}),M.jsxs("div",{className:"p-3 border rounded",children:[M.jsx("h6",{children:"Importar Preset"}),M.jsx("input",{type:"file",className:"form-control",accept:".json",onChange:x=>{y(x)}})]})]})]}):null};var D2=qO();const dc=ku(D2);function Fr(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var HH=typeof Symbol=="function"&&Symbol.observable||"@@observable",QD=HH,JD=()=>Math.random().toString(36).substring(7).split("").join("."),$H={INIT:`@@redux/INIT${JD()}`,REPLACE:`@@redux/REPLACE${JD()}`},t4=$H;function GH(n){if(typeof n!="object"||n===null)return!1;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t||Object.getPrototypeOf(n)===null}function vL(n,t,e){if(typeof n!="function")throw new Error(Fr(2));if(typeof t=="function"&&typeof e=="function"||typeof e=="function"&&typeof arguments[3]=="function")throw new Error(Fr(0));if(typeof t=="function"&&typeof e>"u"&&(e=t,t=void 0),typeof e<"u"){if(typeof e!="function")throw new Error(Fr(1));return e(vL)(n,t)}let i=n,r=t,s=new Map,a=s,l=0,u=!1;function f(){a===s&&(a=new Map,s.forEach((_,b)=>{a.set(b,_)}))}function d(){if(u)throw new Error(Fr(3));return r}function p(_){if(typeof _!="function")throw new Error(Fr(4));if(u)throw new Error(Fr(5));let b=!0;f();const S=l++;return a.set(S,_),function(){if(b){if(u)throw new Error(Fr(6));b=!1,f(),a.delete(S),s=null}}}function m(_){if(!GH(_))throw new Error(Fr(7));if(typeof _.type>"u")throw new Error(Fr(8));if(typeof _.type!="string")throw new Error(Fr(17));if(u)throw new Error(Fr(9));try{u=!0,r=i(r,_)}finally{u=!1}return(s=a).forEach(S=>{S()}),_}function g(_){if(typeof _!="function")throw new Error(Fr(10));i=_,m({type:t4.REPLACE})}function y(){const _=p;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(Fr(11));function S(){const C=b;C.next&&C.next(d())}return S(),{unsubscribe:_(S)}},[QD](){return this}}}return m({type:t4.INIT}),{dispatch:m,subscribe:p,getState:d,replaceReducer:g,[QD]:y}}function e4(n,t){return function(...e){return t(n.apply(this,e))}}function n4(n,t){if(typeof n=="function")return e4(n,t);if(typeof n!="object"||n===null)throw new Error(Fr(16));const e={};for(const i in n){const r=n[i];typeof r=="function"&&(e[i]=e4(r,t))}return e}function xL(...n){return n.length===0?t=>t:n.length===1?n[0]:n.reduce((t,e)=>(...i)=>t(e(...i)))}function VH(...n){return t=>(e,i)=>{const r=t(e,i);let s=()=>{throw new Error(Fr(15))};const a={getState:r.getState,dispatch:(u,...f)=>s(u,...f)},l=n.map(u=>u(a));return s=xL(...l)(r.dispatch),{...r,dispatch:s}}}var V_={exports:{}},W_={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i4;function WH(){if(i4)return W_;i4=1;var n=U1();function t(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var e=typeof Object.is=="function"?Object.is:t,i=n.useSyncExternalStore,r=n.useRef,s=n.useEffect,a=n.useMemo,l=n.useDebugValue;return W_.useSyncExternalStoreWithSelector=function(u,f,d,p,m){var g=r(null);if(g.current===null){var y={hasValue:!1,value:null};g.current=y}else y=g.current;g=a(function(){function _(O){if(!b){if(b=!0,S=O,O=p(O),m!==void 0&&y.hasValue){var N=y.value;if(m(N,O))return A=N}return A=O}if(N=A,e(S,O))return N;var D=p(O);return m!==void 0&&m(N,D)?(S=O,N):(S=O,A=D)}var b=!1,S,A,C=d===void 0?null:d;return[function(){return _(f())},C===null?void 0:function(){return _(C())}]},[f,d,p,m]);var x=i(u,g[0],g[1]);return s(function(){y.hasValue=!0,y.value=x},[x]),l(x),x},W_}var r4;function XH(){return r4||(r4=1,V_.exports=WH()),V_.exports}XH();var YH=U.version.startsWith("19"),qH=Symbol.for(YH?"react.transitional.element":"react.element"),KH=Symbol.for("react.portal"),ZH=Symbol.for("react.fragment"),QH=Symbol.for("react.strict_mode"),JH=Symbol.for("react.profiler"),t$=Symbol.for("react.consumer"),e$=Symbol.for("react.context"),yL=Symbol.for("react.forward_ref"),n$=Symbol.for("react.suspense"),i$=Symbol.for("react.suspense_list"),O2=Symbol.for("react.memo"),r$=Symbol.for("react.lazy"),s$=yL,a$=O2;function o$(n){if(typeof n=="object"&&n!==null){const{$$typeof:t}=n;switch(t){case qH:switch(n=n.type,n){case ZH:case JH:case QH:case n$:case i$:return n;default:switch(n=n&&n.$$typeof,n){case e$:case yL:case r$:case O2:return n;case t$:return n;default:return t}}case KH:return t}}}function l$(n){return o$(n)===O2}function c$(n,t,e,i,{areStatesEqual:r,areOwnPropsEqual:s,areStatePropsEqual:a}){let l=!1,u,f,d,p,m;function g(S,A){return u=S,f=A,d=n(u,f),p=t(i,f),m=e(d,p,f),l=!0,m}function y(){return d=n(u,f),t.dependsOnOwnProps&&(p=t(i,f)),m=e(d,p,f),m}function x(){return n.dependsOnOwnProps&&(d=n(u,f)),t.dependsOnOwnProps&&(p=t(i,f)),m=e(d,p,f),m}function _(){const S=n(u,f),A=!a(S,d);return d=S,A&&(m=e(d,p,f)),m}function b(S,A){const C=!s(A,f),O=!r(S,u,A,f);return u=S,f=A,C&&O?y():C?x():O?_():m}return function(A,C){return l?b(A,C):g(A,C)}}function u$(n,{initMapStateToProps:t,initMapDispatchToProps:e,initMergeProps:i,...r}){const s=t(n,r),a=e(n,r),l=i(n,r);return c$(s,a,l,n,r)}function f$(n,t){const e={};for(const i in n){const r=n[i];typeof r=="function"&&(e[i]=(...s)=>t(r(...s)))}return e}function Kw(n){return function(e){const i=n(e);function r(){return i}return r.dependsOnOwnProps=!1,r}}function s4(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function _L(n,t){return function(i,{displayName:r}){const s=function(l,u){return s.dependsOnOwnProps?s.mapToProps(l,u):s.mapToProps(l,void 0)};return s.dependsOnOwnProps=!0,s.mapToProps=function(l,u){s.mapToProps=n,s.dependsOnOwnProps=s4(n);let f=s(l,u);return typeof f=="function"&&(s.mapToProps=f,s.dependsOnOwnProps=s4(f),f=s(l,u)),f},s}}function R2(n,t){return(e,i)=>{throw new Error(`Invalid value of type ${typeof n} for ${t} argument when connecting component ${i.wrappedComponentName}.`)}}function d$(n){return n&&typeof n=="object"?Kw(t=>f$(n,t)):n?typeof n=="function"?_L(n):R2(n,"mapDispatchToProps"):Kw(t=>({dispatch:t}))}function h$(n){return n?typeof n=="function"?_L(n):R2(n,"mapStateToProps"):Kw(()=>({}))}function p$(n,t,e){return{...e,...n,...t}}function m$(n){return function(e,{displayName:i,areMergedPropsEqual:r}){let s=!1,a;return function(u,f,d){const p=n(u,f,d);return s?r(p,a)||(a=p):(s=!0,a=p),a}}}function g$(n){return n?typeof n=="function"?m$(n):R2(n,"mergeProps"):()=>p$}function v$(n){n()}function x$(){let n=null,t=null;return{clear(){n=null,t=null},notify(){v$(()=>{let e=n;for(;e;)e.callback(),e=e.next})},get(){const e=[];let i=n;for(;i;)e.push(i),i=i.next;return e},subscribe(e){let i=!0;const r=t={callback:e,next:null,prev:t};return r.prev?r.prev.next=r:n=r,function(){!i||n===null||(i=!1,r.next?r.next.prev=r.prev:t=r.prev,r.prev?r.prev.next=r.next:n=r.next)}}}}var a4={notify(){},get:()=>[]};function bL(n,t){let e,i=a4,r=0,s=!1;function a(x){d();const _=i.subscribe(x);let b=!1;return()=>{b||(b=!0,_(),p())}}function l(){i.notify()}function u(){y.onStateChange&&y.onStateChange()}function f(){return s}function d(){r++,e||(e=t?t.addNestedSub(u):n.subscribe(u),i=x$())}function p(){r--,e&&r===0&&(e(),e=void 0,i.clear(),i=a4)}function m(){s||(s=!0,d())}function g(){s&&(s=!1,p())}const y={addNestedSub:a,notifyNestedSubs:l,handleChangeWrapper:u,isSubscribed:f,trySubscribe:m,tryUnsubscribe:g,getListeners:()=>i};return y}var y$=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_$=y$(),b$=()=>typeof navigator<"u"&&navigator.product==="ReactNative",w$=b$(),E$=()=>_$||w$?U.useLayoutEffect:U.useEffect,e1=E$();function o4(n,t){return n===t?n!==0||t!==0||1/n===1/t:n!==n&&t!==t}function X_(n,t){if(o4(n,t))return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null)return!1;const e=Object.keys(n),i=Object.keys(t);if(e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(!Object.prototype.hasOwnProperty.call(t,e[r])||!o4(n[e[r]],t[e[r]]))return!1;return!0}var A$={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},S$={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},T$={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},wL={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},C$={[s$]:T$,[a$]:wL};function l4(n){return l$(n)?wL:C$[n.$$typeof]||A$}var D$=Object.defineProperty,O$=Object.getOwnPropertyNames,c4=Object.getOwnPropertySymbols,R$=Object.getOwnPropertyDescriptor,N$=Object.getPrototypeOf,u4=Object.prototype;function Zw(n,t){if(typeof t!="string"){if(u4){const s=N$(t);s&&s!==u4&&Zw(n,s)}let e=O$(t);c4&&(e=e.concat(c4(t)));const i=l4(n),r=l4(t);for(let s=0;s<e.length;++s){const a=e[s];if(!S$[a]&&!(r&&r[a])&&!(i&&i[a])){const l=R$(t,a);try{D$(n,a,l)}catch{}}}}return n}var L$=Symbol.for("react-redux-context"),I$=typeof globalThis<"u"?globalThis:{};function k$(){if(!U.createContext)return{};const n=I$[L$]??=new Map;let t=n.get(U.createContext);return t||(t=U.createContext(null),n.set(U.createContext,t)),t}var EL=k$(),M$=[null,null];function F$(n,t,e){e1(()=>n(...t),e)}function P$(n,t,e,i,r,s){n.current=i,e.current=!1,r.current&&(r.current=null,s())}function B$(n,t,e,i,r,s,a,l,u,f,d){if(!n)return()=>{};let p=!1,m=null;const g=()=>{if(p||!l.current)return;const x=t.getState();let _,b;try{_=i(x,r.current)}catch(S){b=S,m=S}b||(m=null),_===s.current?a.current||f():(s.current=_,u.current=_,a.current=!0,d())};return e.onStateChange=g,e.trySubscribe(),g(),()=>{if(p=!0,e.tryUnsubscribe(),e.onStateChange=null,m)throw m}}function j$(n,t){return n===t}function U$(n,t,e,{pure:i,areStatesEqual:r=j$,areOwnPropsEqual:s=X_,areStatePropsEqual:a=X_,areMergedPropsEqual:l=X_,forwardRef:u=!1,context:f=EL}={}){const d=f,p=h$(n),m=d$(t),g=g$(e),y=!!n;return _=>{const b=_.displayName||_.name||"Component",S=`Connect(${b})`,A={shouldHandleStateChanges:y,displayName:S,wrappedComponentName:b,WrappedComponent:_,initMapStateToProps:p,initMapDispatchToProps:m,initMergeProps:g,areStatesEqual:r,areStatePropsEqual:a,areOwnPropsEqual:s,areMergedPropsEqual:l};function C(D){const[L,I,z]=U.useMemo(()=>{const{reactReduxForwardedRef:bt,...St}=D;return[D.context,bt,St]},[D]),j=U.useMemo(()=>{let bt=d;return L?.Consumer,bt},[L,d]),B=U.useContext(j),tt=!!D.store&&!!D.store.getState&&!!D.store.dispatch,k=!!B&&!!B.store,et=tt?D.store:B.store,K=k?B.getServerState:et.getState,q=U.useMemo(()=>u$(et.dispatch,A),[et]),[_t,at]=U.useMemo(()=>{if(!y)return M$;const bt=bL(et,tt?void 0:B.subscription),St=bt.notifyNestedSubs.bind(bt);return[bt,St]},[et,tt,B]),P=U.useMemo(()=>tt?B:{...B,subscription:_t},[tt,B,_t]),X=U.useRef(void 0),V=U.useRef(z),it=U.useRef(void 0),ht=U.useRef(!1),yt=U.useRef(!1),Rt=U.useRef(void 0);e1(()=>(yt.current=!0,()=>{yt.current=!1}),[]);const Et=U.useMemo(()=>()=>it.current&&z===V.current?it.current:q(et.getState(),z),[et,z]),G=U.useMemo(()=>St=>_t?B$(y,et,_t,q,V,X,ht,yt,it,at,St):()=>{},[_t]);F$(P$,[V,X,ht,z,it,at]);let lt;try{lt=U.useSyncExternalStore(G,Et,K?()=>q(K(),z):Et)}catch(bt){throw Rt.current&&(bt.message+=`
The error may be correlated with this previous error:
${Rt.current.stack}

`),bt}e1(()=>{Rt.current=void 0,it.current=void 0,X.current=lt});const rt=U.useMemo(()=>U.createElement(_,{...lt,ref:I}),[I,_,lt]);return U.useMemo(()=>y?U.createElement(j.Provider,{value:P},rt):rt,[j,rt,P])}const N=U.memo(C);if(N.WrappedComponent=_,N.displayName=C.displayName=S,u){const L=U.forwardRef(function(z,j){return U.createElement(N,{...z,reactReduxForwardedRef:j})});return L.displayName=S,L.WrappedComponent=_,Zw(L,_)}return Zw(N,_)}}var AL=U$;function z$(n){const{children:t,context:e,serverState:i,store:r}=n,s=U.useMemo(()=>{const u=bL(r);return{store:r,subscription:u,getServerState:i?()=>i:void 0}},[r,i]),a=U.useMemo(()=>r.getState(),[r]);e1(()=>{const{subscription:u}=s;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),a!==r.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[s,a]);const l=e||EL;return U.createElement(l.Provider,{value:s},t)}var H$=z$,La=function(t){var e=t.top,i=t.right,r=t.bottom,s=t.left,a=i-s,l=r-e,u={top:e,right:i,bottom:r,left:s,width:a,height:l,x:s,y:e,center:{x:(i+s)/2,y:(r+e)/2}};return u},N2=function(t,e){return{top:t.top-e.top,left:t.left-e.left,bottom:t.bottom+e.bottom,right:t.right+e.right}},f4=function(t,e){return{top:t.top+e.top,left:t.left+e.left,bottom:t.bottom-e.bottom,right:t.right-e.right}},$$=function(t,e){return{top:t.top+e.y,left:t.left+e.x,bottom:t.bottom+e.y,right:t.right+e.x}},Y_={top:0,right:0,bottom:0,left:0},L2=function(t){var e=t.borderBox,i=t.margin,r=i===void 0?Y_:i,s=t.border,a=s===void 0?Y_:s,l=t.padding,u=l===void 0?Y_:l,f=La(N2(e,r)),d=La(f4(e,a)),p=La(f4(d,u));return{marginBox:f,borderBox:La(e),paddingBox:d,contentBox:p,margin:r,border:a,padding:u}},Js=function(t){var e=t.slice(0,-2),i=t.slice(-2);if(i!=="px")return 0;var r=Number(e);return isNaN(r)&&Mn(!1),r},G$=function(){return{x:window.pageXOffset,y:window.pageYOffset}},n1=function(t,e){var i=t.borderBox,r=t.border,s=t.margin,a=t.padding,l=$$(i,e);return L2({borderBox:l,border:r,margin:s,padding:a})},i1=function(t,e){return e===void 0&&(e=G$()),n1(t,e)},SL=function(t,e){var i={top:Js(e.marginTop),right:Js(e.marginRight),bottom:Js(e.marginBottom),left:Js(e.marginLeft)},r={top:Js(e.paddingTop),right:Js(e.paddingRight),bottom:Js(e.paddingBottom),left:Js(e.paddingLeft)},s={top:Js(e.borderTopWidth),right:Js(e.borderRightWidth),bottom:Js(e.borderBottomWidth),left:Js(e.borderLeftWidth)};return L2({borderBox:t,margin:i,padding:r,border:s})},TL=function(t){var e=t.getBoundingClientRect(),i=window.getComputedStyle(t);return SL(e,i)},e0=function(t){var e=[],i=null,r=function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];e=l,!i&&(i=requestAnimationFrame(function(){i=null,t.apply(void 0,e)}))};return r.cancel=function(){i&&(cancelAnimationFrame(i),i=null)},r};function n0(){return n0=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)({}).hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},n0.apply(null,arguments)}function CL(n,t){}CL.bind(null,"warn");CL.bind(null,"error");function mc(){}function V$(n,t){return{...n,...t}}function aa(n,t,e){const i=t.map(r=>{const s=V$(e,r.options);return n.addEventListener(r.eventName,r.fn,s),function(){n.removeEventListener(r.eventName,r.fn,s)}});return function(){i.forEach(s=>{s()})}}const W$="Invariant failed";class r1 extends Error{}r1.prototype.toString=function(){return this.message};function oe(n,t){throw new r1(W$)}class X$ extends Je.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=mc,this.onWindowError=e=>{const i=this.getCallbacks();i.isDragging()&&i.tryAbort(),e.error instanceof r1&&e.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=e=>{this.callbacks=e}}componentDidMount(){this.unbind=aa(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof r1){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const Y$=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,s1=n=>n+1,q$=n=>`
  You have lifted an item in position ${s1(n.source.index)}
`,DL=(n,t)=>{const e=n.droppableId===t.droppableId,i=s1(n.index),r=s1(t.index);return e?`
      You have moved the item from position ${i}
      to position ${r}
    `:`
    You have moved the item from position ${i}
    in list ${n.droppableId}
    to list ${t.droppableId}
    in position ${r}
  `},OL=(n,t,e)=>t.droppableId===e.droppableId?`
      The item ${n}
      has been combined with ${e.draggableId}`:`
      The item ${n}
      in list ${t.droppableId}
      has been combined with ${e.draggableId}
      in list ${e.droppableId}
    `,K$=n=>{const t=n.destination;if(t)return DL(n.source,t);const e=n.combine;return e?OL(n.draggableId,n.source,e):"You are over an area that cannot be dropped on"},d4=n=>`
  The item has returned to its starting position
  of ${s1(n.index)}
`,Z$=n=>{if(n.reason==="CANCEL")return`
      Movement cancelled.
      ${d4(n.source)}
    `;const t=n.destination,e=n.combine;return t?`
      You have dropped the item.
      ${DL(n.source,t)}
    `:e?`
      You have dropped the item.
      ${OL(n.draggableId,n.source,e)}
    `:`
    The item has been dropped while not over a drop area.
    ${d4(n.source)}
  `},Hv={dragHandleUsageInstructions:Y$,onDragStart:q$,onDragUpdate:K$,onDragEnd:Z$};function Q$(n,t){return!!(n===t||Number.isNaN(n)&&Number.isNaN(t))}function RL(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!Q$(n[e],t[e]))return!1;return!0}function fn(n,t){const e=U.useState(()=>({inputs:t,result:n()}))[0],i=U.useRef(!0),r=U.useRef(e),a=i.current||!!(t&&r.current.inputs&&RL(t,r.current.inputs))?r.current:{inputs:t,result:n()};return U.useEffect(()=>{i.current=!1,r.current=a},[a]),a.result}function we(n,t){return fn(()=>n,t)}const Vi={x:0,y:0},ir=(n,t)=>({x:n.x+t.x,y:n.y+t.y}),Ls=(n,t)=>({x:n.x-t.x,y:n.y-t.y}),gc=(n,t)=>n.x===t.x&&n.y===t.y,Rd=n=>({x:n.x!==0?-n.x:0,y:n.y!==0?-n.y:0}),Cu=(n,t,e=0)=>n==="x"?{x:t,y:e}:{x:e,y:t},i0=(n,t)=>Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2),h4=(n,t)=>Math.min(...t.map(e=>i0(n,e))),NL=n=>t=>({x:n(t.x),y:n(t.y)});var J$=(n,t)=>{const e=La({top:Math.max(t.top,n.top),right:Math.min(t.right,n.right),bottom:Math.min(t.bottom,n.bottom),left:Math.max(t.left,n.left)});return e.width<=0||e.height<=0?null:e};const j0=(n,t)=>({top:n.top+t.y,left:n.left+t.x,bottom:n.bottom+t.y,right:n.right+t.x}),p4=n=>[{x:n.left,y:n.top},{x:n.right,y:n.top},{x:n.left,y:n.bottom},{x:n.right,y:n.bottom}],tG={top:0,right:0,bottom:0,left:0},eG=(n,t)=>t?j0(n,t.scroll.diff.displacement):n,nG=(n,t,e)=>e&&e.increasedBy?{...n,[t.end]:n[t.end]+e.increasedBy[t.line]}:n,iG=(n,t)=>t&&t.shouldClipSubject?J$(t.pageMarginBox,n):La(n);var xd=({page:n,withPlaceholder:t,axis:e,frame:i})=>{const r=eG(n.marginBox,i),s=nG(r,e,t),a=iG(s,i);return{page:n,withPlaceholder:t,active:a}},I2=(n,t)=>{n.frame||oe();const e=n.frame,i=Ls(t,e.scroll.initial),r=Rd(i),s={...e,scroll:{initial:e.scroll.initial,current:t,diff:{value:i,displacement:r},max:e.scroll.max}},a=xd({page:n.subject.page,withPlaceholder:n.subject.withPlaceholder,axis:n.axis,frame:s});return{...n,frame:s,subject:a}};function Gi(n,t=RL){let e=null;function i(...r){if(e&&e.lastThis===this&&t(r,e.lastArgs))return e.lastResult;const s=n.apply(this,r);return e={lastResult:s,lastArgs:r,lastThis:this},s}return i.clear=function(){e=null},i}const LL=Gi(n=>n.reduce((t,e)=>(t[e.descriptor.id]=e,t),{})),IL=Gi(n=>n.reduce((t,e)=>(t[e.descriptor.id]=e,t),{})),ox=Gi(n=>Object.values(n)),rG=Gi(n=>Object.values(n));var Nd=Gi((n,t)=>rG(t).filter(i=>n===i.descriptor.droppableId).sort((i,r)=>i.descriptor.index-r.descriptor.index));function k2(n){return n.at&&n.at.type==="REORDER"?n.at.destination:null}function lx(n){return n.at&&n.at.type==="COMBINE"?n.at.combine:null}var cx=Gi((n,t)=>t.filter(e=>e.descriptor.id!==n.descriptor.id)),sG=({isMovingForward:n,draggable:t,destination:e,insideDestination:i,previousImpact:r})=>{if(!e.isCombineEnabled||!k2(r))return null;function a(g){const y={type:"COMBINE",combine:{draggableId:g,droppableId:e.descriptor.id}};return{...r,at:y}}const l=r.displaced.all,u=l.length?l[0]:null;if(n)return u?a(u):null;const f=cx(t,i);if(!u){if(!f.length)return null;const g=f[f.length-1];return a(g.descriptor.id)}const d=f.findIndex(g=>g.descriptor.id===u);d===-1&&oe();const p=d-1;if(p<0)return null;const m=f[p];return a(m.descriptor.id)},Ld=(n,t)=>n.descriptor.droppableId===t.descriptor.id;const kL={point:Vi,value:0},r0={invisible:{},visible:{},all:[]},aG={displaced:r0,displacedBy:kL,at:null};var la=(n,t)=>e=>n<=e&&e<=t,ML=n=>{const t=la(n.top,n.bottom),e=la(n.left,n.right);return i=>{if(t(i.top)&&t(i.bottom)&&e(i.left)&&e(i.right))return!0;const s=t(i.top)||t(i.bottom),a=e(i.left)||e(i.right);if(s&&a)return!0;const u=i.top<n.top&&i.bottom>n.bottom,f=i.left<n.left&&i.right>n.right;return u&&f?!0:u&&a||f&&s}},oG=n=>{const t=la(n.top,n.bottom),e=la(n.left,n.right);return i=>t(i.top)&&t(i.bottom)&&e(i.left)&&e(i.right)};const M2={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},FL={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var lG=n=>t=>{const e=la(t.top,t.bottom),i=la(t.left,t.right);return r=>n===M2?e(r.top)&&e(r.bottom):i(r.left)&&i(r.right)};const cG=(n,t)=>{const e=t.frame?t.frame.scroll.diff.displacement:Vi;return j0(n,e)},uG=(n,t,e)=>t.subject.active?e(t.subject.active)(n):!1,fG=(n,t,e)=>e(t)(n),F2=({target:n,destination:t,viewport:e,withDroppableDisplacement:i,isVisibleThroughFrameFn:r})=>{const s=i?cG(n,t):n;return uG(s,t,r)&&fG(s,e,r)},dG=n=>F2({...n,isVisibleThroughFrameFn:ML}),PL=n=>F2({...n,isVisibleThroughFrameFn:oG}),hG=n=>F2({...n,isVisibleThroughFrameFn:lG(n.destination.axis)}),pG=(n,t,e)=>{if(typeof e=="boolean")return e;if(!t)return!0;const{invisible:i,visible:r}=t;if(i[n])return!1;const s=r[n];return s?s.shouldAnimate:!0};function mG(n,t){const e=n.page.marginBox,i={top:t.point.y,right:0,bottom:0,left:t.point.x};return La(N2(e,i))}function s0({afterDragging:n,destination:t,displacedBy:e,viewport:i,forceShouldAnimate:r,last:s}){return n.reduce(function(l,u){const f=mG(u,e),d=u.descriptor.id;if(l.all.push(d),!dG({target:f,destination:t,viewport:i,withDroppableDisplacement:!0}))return l.invisible[u.descriptor.id]=!0,l;const m=pG(d,s,r),g={draggableId:d,shouldAnimate:m};return l.visible[d]=g,l},{all:[],visible:{},invisible:{}})}function gG(n,t){if(!n.length)return 0;const e=n[n.length-1].descriptor.index;return t.inHomeList?e:e+1}function m4({insideDestination:n,inHomeList:t,displacedBy:e,destination:i}){const r=gG(n,{inHomeList:t});return{displaced:r0,displacedBy:e,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:r}}}}function a1({draggable:n,insideDestination:t,destination:e,viewport:i,displacedBy:r,last:s,index:a,forceShouldAnimate:l}){const u=Ld(n,e);if(a==null)return m4({insideDestination:t,inHomeList:u,displacedBy:r,destination:e});const f=t.find(y=>y.descriptor.index===a);if(!f)return m4({insideDestination:t,inHomeList:u,displacedBy:r,destination:e});const d=cx(n,t),p=t.indexOf(f),m=d.slice(p);return{displaced:s0({afterDragging:m,destination:e,displacedBy:r,last:s,viewport:i.frame,forceShouldAnimate:l}),displacedBy:r,at:{type:"REORDER",destination:{droppableId:e.descriptor.id,index:a}}}}function bc(n,t){return!!t.effected[n]}var vG=({isMovingForward:n,destination:t,draggables:e,combine:i,afterCritical:r})=>{if(!t.isCombineEnabled)return null;const s=i.draggableId,l=e[s].descriptor.index;return bc(s,r)?n?l:l-1:n?l+1:l},xG=({isMovingForward:n,isInHomeList:t,insideDestination:e,location:i})=>{if(!e.length)return null;const r=i.index,s=n?r+1:r-1,a=e[0].descriptor.index,l=e[e.length-1].descriptor.index,u=t?l:l+1;return s<a||s>u?null:s},yG=({isMovingForward:n,isInHomeList:t,draggable:e,draggables:i,destination:r,insideDestination:s,previousImpact:a,viewport:l,afterCritical:u})=>{const f=a.at;if(f||oe(),f.type==="REORDER"){const p=xG({isMovingForward:n,isInHomeList:t,location:f.destination,insideDestination:s});return p==null?null:a1({draggable:e,insideDestination:s,destination:r,viewport:l,last:a.displaced,displacedBy:a.displacedBy,index:p})}const d=vG({isMovingForward:n,destination:r,displaced:a.displaced,draggables:i,combine:f.combine,afterCritical:u});return d==null?null:a1({draggable:e,insideDestination:s,destination:r,viewport:l,last:a.displaced,displacedBy:a.displacedBy,index:d})},_G=({displaced:n,afterCritical:t,combineWith:e,displacedBy:i})=>{const r=!!(n.visible[e]||n.invisible[e]);return bc(e,t)?r?Vi:Rd(i.point):r?i.point:Vi},bG=({afterCritical:n,impact:t,draggables:e})=>{const i=lx(t);i||oe();const r=i.draggableId,s=e[r].page.borderBox.center,a=_G({displaced:t.displaced,afterCritical:n,combineWith:r,displacedBy:t.displacedBy});return ir(s,a)};const BL=(n,t)=>t.margin[n.start]+t.borderBox[n.size]/2,wG=(n,t)=>t.margin[n.end]+t.borderBox[n.size]/2,P2=(n,t,e)=>t[n.crossAxisStart]+e.margin[n.crossAxisStart]+e.borderBox[n.crossAxisSize]/2,g4=({axis:n,moveRelativeTo:t,isMoving:e})=>Cu(n.line,t.marginBox[n.end]+BL(n,e),P2(n,t.marginBox,e)),v4=({axis:n,moveRelativeTo:t,isMoving:e})=>Cu(n.line,t.marginBox[n.start]-wG(n,e),P2(n,t.marginBox,e)),EG=({axis:n,moveInto:t,isMoving:e})=>Cu(n.line,t.contentBox[n.start]+BL(n,e),P2(n,t.contentBox,e));var AG=({impact:n,draggable:t,draggables:e,droppable:i,afterCritical:r})=>{const s=Nd(i.descriptor.id,e),a=t.page,l=i.axis;if(!s.length)return EG({axis:l,moveInto:i.page,isMoving:a});const{displaced:u,displacedBy:f}=n,d=u.all[0];if(d){const m=e[d];if(bc(d,r))return v4({axis:l,moveRelativeTo:m.page,isMoving:a});const g=n1(m.page,f.point);return v4({axis:l,moveRelativeTo:g,isMoving:a})}const p=s[s.length-1];if(p.descriptor.id===t.descriptor.id)return a.borderBox.center;if(bc(p.descriptor.id,r)){const m=n1(p.page,Rd(r.displacedBy.point));return g4({axis:l,moveRelativeTo:m,isMoving:a})}return g4({axis:l,moveRelativeTo:p.page,isMoving:a})},Qw=(n,t)=>{const e=n.frame;return e?ir(t,e.scroll.diff.displacement):t};const SG=({impact:n,draggable:t,droppable:e,draggables:i,afterCritical:r})=>{const s=t.page.borderBox.center,a=n.at;return!e||!a?s:a.type==="REORDER"?AG({impact:n,draggable:t,draggables:i,droppable:e,afterCritical:r}):bG({impact:n,draggables:i,afterCritical:r})};var ux=n=>{const t=SG(n),e=n.droppable;return e?Qw(e,t):t},jL=(n,t)=>{const e=Ls(t,n.scroll.initial),i=Rd(e);return{frame:La({top:t.y,bottom:t.y+n.frame.height,left:t.x,right:t.x+n.frame.width}),scroll:{initial:n.scroll.initial,max:n.scroll.max,current:t,diff:{value:e,displacement:i}}}};function x4(n,t){return n.map(e=>t[e])}function TG(n,t){for(let e=0;e<t.length;e++){const i=t[e].visible[n];if(i)return i}return null}var CG=({impact:n,viewport:t,destination:e,draggables:i,maxScrollChange:r})=>{const s=jL(t,ir(t.scroll.current,r)),a=e.frame?I2(e,ir(e.frame.scroll.current,r)):e,l=n.displaced,u=s0({afterDragging:x4(l.all,i),destination:e,displacedBy:n.displacedBy,viewport:s.frame,last:l,forceShouldAnimate:!1}),f=s0({afterDragging:x4(l.all,i),destination:a,displacedBy:n.displacedBy,viewport:t.frame,last:l,forceShouldAnimate:!1}),d={},p={},m=[l,u,f];return l.all.forEach(y=>{const x=TG(y,m);if(x){p[y]=x;return}d[y]=!0}),{...n,displaced:{all:l.all,invisible:d,visible:p}}},DG=(n,t)=>ir(n.scroll.diff.displacement,t),B2=({pageBorderBoxCenter:n,draggable:t,viewport:e})=>{const i=DG(e,n),r=Ls(i,t.page.borderBox.center);return ir(t.client.borderBox.center,r)},UL=({draggable:n,destination:t,newPageBorderBoxCenter:e,viewport:i,withDroppableDisplacement:r,onlyOnMainAxis:s=!1})=>{const a=Ls(e,n.page.borderBox.center),u={target:j0(n.page.borderBox,a),destination:t,withDroppableDisplacement:r,viewport:i};return s?hG(u):PL(u)},OG=({isMovingForward:n,draggable:t,destination:e,draggables:i,previousImpact:r,viewport:s,previousPageBorderBoxCenter:a,previousClientSelection:l,afterCritical:u})=>{if(!e.isEnabled)return null;const f=Nd(e.descriptor.id,i),d=Ld(t,e),p=sG({isMovingForward:n,draggable:t,destination:e,insideDestination:f,previousImpact:r})||yG({isMovingForward:n,isInHomeList:d,draggable:t,draggables:i,destination:e,insideDestination:f,previousImpact:r,viewport:s,afterCritical:u});if(!p)return null;const m=ux({impact:p,draggable:t,droppable:e,draggables:i,afterCritical:u});if(UL({draggable:t,destination:e,newPageBorderBoxCenter:m,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:B2({pageBorderBoxCenter:m,draggable:t,viewport:s}),impact:p,scrollJumpRequest:null};const y=Ls(m,a),x=CG({impact:p,viewport:s,destination:e,draggables:i,maxScrollChange:y});return{clientSelection:l,impact:x,scrollJumpRequest:y}};const kr=n=>{const t=n.subject.active;return t||oe(),t};var RG=({isMovingForward:n,pageBorderBoxCenter:t,source:e,droppables:i,viewport:r})=>{const s=e.subject.active;if(!s)return null;const a=e.axis,l=la(s[a.start],s[a.end]),u=ox(i).filter(d=>d!==e).filter(d=>d.isEnabled).filter(d=>!!d.subject.active).filter(d=>ML(r.frame)(kr(d))).filter(d=>{const p=kr(d);return n?s[a.crossAxisEnd]<p[a.crossAxisEnd]:p[a.crossAxisStart]<s[a.crossAxisStart]}).filter(d=>{const p=kr(d),m=la(p[a.start],p[a.end]);return l(p[a.start])||l(p[a.end])||m(s[a.start])||m(s[a.end])}).sort((d,p)=>{const m=kr(d)[a.crossAxisStart],g=kr(p)[a.crossAxisStart];return n?m-g:g-m}).filter((d,p,m)=>kr(d)[a.crossAxisStart]===kr(m[0])[a.crossAxisStart]);if(!u.length)return null;if(u.length===1)return u[0];const f=u.filter(d=>la(kr(d)[a.start],kr(d)[a.end])(t[a.line]));return f.length===1?f[0]:f.length>1?f.sort((d,p)=>kr(d)[a.start]-kr(p)[a.start])[0]:u.sort((d,p)=>{const m=h4(t,p4(kr(d))),g=h4(t,p4(kr(p)));return m!==g?m-g:kr(d)[a.start]-kr(p)[a.start]})[0]};const y4=(n,t)=>{const e=n.page.borderBox.center;return bc(n.descriptor.id,t)?Ls(e,t.displacedBy.point):e},NG=(n,t)=>{const e=n.page.borderBox;return bc(n.descriptor.id,t)?j0(e,Rd(t.displacedBy.point)):e};var LG=({pageBorderBoxCenter:n,viewport:t,destination:e,insideDestination:i,afterCritical:r})=>i.filter(a=>PL({target:NG(a,r),destination:e,viewport:t.frame,withDroppableDisplacement:!0})).sort((a,l)=>{const u=i0(n,Qw(e,y4(a,r))),f=i0(n,Qw(e,y4(l,r)));return u<f?-1:f<u?1:a.descriptor.index-l.descriptor.index})[0]||null,U0=Gi(function(t,e){const i=e[t.line];return{value:i,point:Cu(t.line,i)}});const IG=(n,t,e)=>{const i=n.axis;if(n.descriptor.mode==="virtual")return Cu(i.line,t[i.line]);const r=n.subject.page.contentBox[i.size],u=Nd(n.descriptor.id,e).reduce((f,d)=>f+d.client.marginBox[i.size],0)+t[i.line]-r;return u<=0?null:Cu(i.line,u)},zL=(n,t)=>({...n,scroll:{...n.scroll,max:t}}),HL=(n,t,e)=>{const i=n.frame;Ld(t,n)&&oe(),n.subject.withPlaceholder&&oe();const r=U0(n.axis,t.displaceBy).point,s=IG(n,r,e),a={placeholderSize:r,increasedBy:s,oldFrameMaxScroll:n.frame?n.frame.scroll.max:null};if(!i){const d=xd({page:n.subject.page,withPlaceholder:a,axis:n.axis,frame:n.frame});return{...n,subject:d}}const l=s?ir(i.scroll.max,s):i.scroll.max,u=zL(i,l),f=xd({page:n.subject.page,withPlaceholder:a,axis:n.axis,frame:u});return{...n,subject:f,frame:u}},kG=n=>{const t=n.subject.withPlaceholder;t||oe();const e=n.frame;if(!e){const a=xd({page:n.subject.page,axis:n.axis,frame:null,withPlaceholder:null});return{...n,subject:a}}const i=t.oldFrameMaxScroll;i||oe();const r=zL(e,i),s=xd({page:n.subject.page,axis:n.axis,frame:r,withPlaceholder:null});return{...n,subject:s,frame:r}};var MG=({previousPageBorderBoxCenter:n,moveRelativeTo:t,insideDestination:e,draggable:i,draggables:r,destination:s,viewport:a,afterCritical:l})=>{if(!t){if(e.length)return null;const p={displaced:r0,displacedBy:kL,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:0}}},m=ux({impact:p,draggable:i,droppable:s,draggables:r,afterCritical:l}),g=Ld(i,s)?s:HL(s,i,r);return UL({draggable:i,destination:g,newPageBorderBoxCenter:m,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?p:null}const u=n[s.axis.line]<=t.page.borderBox.center[s.axis.line],f=(()=>{const p=t.descriptor.index;return t.descriptor.id===i.descriptor.id||u?p:p+1})(),d=U0(s.axis,i.displaceBy);return a1({draggable:i,insideDestination:e,destination:s,viewport:a,displacedBy:d,last:r0,index:f})},FG=({isMovingForward:n,previousPageBorderBoxCenter:t,draggable:e,isOver:i,draggables:r,droppables:s,viewport:a,afterCritical:l})=>{const u=RG({isMovingForward:n,pageBorderBoxCenter:t,source:i,droppables:s,viewport:a});if(!u)return null;const f=Nd(u.descriptor.id,r),d=LG({pageBorderBoxCenter:t,viewport:a,destination:u,insideDestination:f,afterCritical:l}),p=MG({previousPageBorderBoxCenter:t,destination:u,draggable:e,draggables:r,moveRelativeTo:d,insideDestination:f,viewport:a,afterCritical:l});if(!p)return null;const m=ux({impact:p,draggable:e,droppable:u,draggables:r,afterCritical:l});return{clientSelection:B2({pageBorderBoxCenter:m,draggable:e,viewport:a}),impact:p,scrollJumpRequest:null}},Ms=n=>{const t=n.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const PG=(n,t)=>{const e=Ms(n);return e?t[e]:null};var BG=({state:n,type:t})=>{const e=PG(n.impact,n.dimensions.droppables),i=!!e,r=n.dimensions.droppables[n.critical.droppable.id],s=e||r,a=s.axis.direction,l=a==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||a==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(l&&!i)return null;const u=t==="MOVE_DOWN"||t==="MOVE_RIGHT",f=n.dimensions.draggables[n.critical.draggable.id],d=n.current.page.borderBoxCenter,{draggables:p,droppables:m}=n.dimensions;return l?OG({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:f,destination:s,draggables:p,viewport:n.viewport,previousClientSelection:n.current.client.selection,previousImpact:n.impact,afterCritical:n.afterCritical}):FG({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:f,isOver:s,draggables:p,droppables:m,viewport:n.viewport,afterCritical:n.afterCritical})};function ou(n){return n.phase==="DRAGGING"||n.phase==="COLLECTING"}function $L(n){const t=la(n.top,n.bottom),e=la(n.left,n.right);return function(r){return t(r.y)&&e(r.x)}}function jG(n,t){return n.left<t.right&&n.right>t.left&&n.top<t.bottom&&n.bottom>t.top}function UG({pageBorderBox:n,draggable:t,candidates:e}){const i=t.page.borderBox.center,r=e.map(s=>{const a=s.axis,l=Cu(s.axis.line,n.center[a.line],s.page.borderBox.center[a.crossAxisLine]);return{id:s.descriptor.id,distance:i0(i,l)}}).sort((s,a)=>a.distance-s.distance);return r[0]?r[0].id:null}function zG({pageBorderBox:n,draggable:t,droppables:e}){const i=ox(e).filter(r=>{if(!r.isEnabled)return!1;const s=r.subject.active;if(!s||!jG(n,s))return!1;if($L(s)(n.center))return!0;const a=r.axis,l=s.center[a.crossAxisLine],u=n[a.crossAxisStart],f=n[a.crossAxisEnd],d=la(s[a.crossAxisStart],s[a.crossAxisEnd]),p=d(u),m=d(f);return!p&&!m?!0:p?u<l:f>l});return i.length?i.length===1?i[0].descriptor.id:UG({pageBorderBox:n,draggable:t,candidates:i}):null}const GL=(n,t)=>La(j0(n,t));var HG=(n,t)=>{const e=n.frame;return e?GL(t,e.scroll.diff.value):t};function VL({displaced:n,id:t}){return!!(n.visible[t]||n.invisible[t])}function $G({draggable:n,closest:t,inHomeList:e}){return t?e&&t.descriptor.index>n.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var GG=({pageBorderBoxWithDroppableScroll:n,draggable:t,destination:e,insideDestination:i,last:r,viewport:s,afterCritical:a})=>{const l=e.axis,u=U0(e.axis,t.displaceBy),f=u.value,d=n[l.start],p=n[l.end],g=cx(t,i).find(x=>{const _=x.descriptor.id,b=x.page.borderBox.center[l.line],S=bc(_,a),A=VL({displaced:r,id:_});return S?A?p<=b:d<b-f:A?p<=b+f:d<b})||null,y=$G({draggable:t,closest:g,inHomeList:Ld(t,e)});return a1({draggable:t,insideDestination:i,destination:e,viewport:s,last:r,displacedBy:u,index:y})};const VG=4;var WG=({draggable:n,pageBorderBoxWithDroppableScroll:t,previousImpact:e,destination:i,insideDestination:r,afterCritical:s})=>{if(!i.isCombineEnabled)return null;const a=i.axis,l=U0(i.axis,n.displaceBy),u=l.value,f=t[a.start],d=t[a.end],m=cx(n,r).find(y=>{const x=y.descriptor.id,_=y.page.borderBox,S=_[a.size]/VG,A=bc(x,s),C=VL({displaced:e.displaced,id:x});return A?C?d>_[a.start]+S&&d<_[a.end]-S:f>_[a.start]-u+S&&f<_[a.end]-u-S:C?d>_[a.start]+u+S&&d<_[a.end]+u-S:f>_[a.start]+S&&f<_[a.end]-S});return m?{displacedBy:l,displaced:e.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:i.descriptor.id}}}:null},WL=({pageOffset:n,draggable:t,draggables:e,droppables:i,previousImpact:r,viewport:s,afterCritical:a})=>{const l=GL(t.page.borderBox,n),u=zG({pageBorderBox:l,draggable:t,droppables:i});if(!u)return aG;const f=i[u],d=Nd(f.descriptor.id,e),p=HG(f,l);return WG({pageBorderBoxWithDroppableScroll:p,draggable:t,previousImpact:r,destination:f,insideDestination:d,afterCritical:a})||GG({pageBorderBoxWithDroppableScroll:p,draggable:t,destination:f,insideDestination:d,last:r.displaced,viewport:s,afterCritical:a})},j2=(n,t)=>({...n,[t.descriptor.id]:t});const XG=({previousImpact:n,impact:t,droppables:e})=>{const i=Ms(n),r=Ms(t);if(!i||i===r)return e;const s=e[i];if(!s.subject.withPlaceholder)return e;const a=kG(s);return j2(e,a)};var YG=({draggable:n,draggables:t,droppables:e,previousImpact:i,impact:r})=>{const s=XG({previousImpact:i,impact:r,droppables:e}),a=Ms(r);if(!a)return s;const l=e[a];if(Ld(n,l)||l.subject.withPlaceholder)return s;const u=HL(l,n,t);return j2(s,u)},jp=({state:n,clientSelection:t,dimensions:e,viewport:i,impact:r,scrollJumpRequest:s})=>{const a=i||n.viewport,l=e||n.dimensions,u=t||n.current.client.selection,f=Ls(u,n.initial.client.selection),d={offset:f,selection:u,borderBoxCenter:ir(n.initial.client.borderBoxCenter,f)},p={selection:ir(d.selection,a.scroll.current),borderBoxCenter:ir(d.borderBoxCenter,a.scroll.current),offset:ir(d.offset,a.scroll.diff.value)},m={client:d,page:p};if(n.phase==="COLLECTING")return{...n,dimensions:l,viewport:a,current:m};const g=l.draggables[n.critical.draggable.id],y=r||WL({pageOffset:p.offset,draggable:g,draggables:l.draggables,droppables:l.droppables,previousImpact:n.impact,viewport:a,afterCritical:n.afterCritical}),x=YG({draggable:g,impact:y,previousImpact:n.impact,draggables:l.draggables,droppables:l.droppables});return{...n,current:m,dimensions:{draggables:l.draggables,droppables:x},impact:y,viewport:a,scrollJumpRequest:s||null,forceShouldAnimate:s?!1:null}};function qG(n,t){return n.map(e=>t[e])}var XL=({impact:n,viewport:t,draggables:e,destination:i,forceShouldAnimate:r})=>{const s=n.displaced,a=qG(s.all,e),l=s0({afterDragging:a,destination:i,displacedBy:n.displacedBy,viewport:t.frame,forceShouldAnimate:r,last:s});return{...n,displaced:l}},YL=({impact:n,draggable:t,droppable:e,draggables:i,viewport:r,afterCritical:s})=>{const a=ux({impact:n,draggable:t,draggables:i,droppable:e,afterCritical:s});return B2({pageBorderBoxCenter:a,draggable:t,viewport:r})},qL=({state:n,dimensions:t,viewport:e})=>{n.movementMode!=="SNAP"&&oe();const i=n.impact,r=e||n.viewport,s=t||n.dimensions,{draggables:a,droppables:l}=s,u=a[n.critical.draggable.id],f=Ms(i);f||oe();const d=l[f],p=XL({impact:i,viewport:r,destination:d,draggables:a}),m=YL({impact:p,draggable:u,droppable:d,draggables:a,viewport:r,afterCritical:n.afterCritical});return jp({impact:p,clientSelection:m,state:n,dimensions:s,viewport:r})},KG=n=>({index:n.index,droppableId:n.droppableId}),KL=({draggable:n,home:t,draggables:e,viewport:i})=>{const r=U0(t.axis,n.displaceBy),s=Nd(t.descriptor.id,e),a=s.indexOf(n);a===-1&&oe();const l=s.slice(a+1),u=l.reduce((m,g)=>(m[g.descriptor.id]=!0,m),{}),f={inVirtualList:t.descriptor.mode==="virtual",displacedBy:r,effected:u};return{impact:{displaced:s0({afterDragging:l,destination:t,displacedBy:r,last:null,viewport:i.frame,forceShouldAnimate:!1}),displacedBy:r,at:{type:"REORDER",destination:KG(n.descriptor)}},afterCritical:f}},ZG=(n,t)=>({draggables:n.draggables,droppables:j2(n.droppables,t)}),QG=({draggable:n,offset:t,initialWindowScroll:e})=>{const i=n1(n.client,t),r=i1(i,e);return{...n,placeholder:{...n.placeholder,client:i},client:i,page:r}},JG=n=>{const t=n.frame;return t||oe(),t},tV=({additions:n,updatedDroppables:t,viewport:e})=>{const i=e.scroll.diff.value;return n.map(r=>{const s=r.descriptor.droppableId,a=t[s],u=JG(a).scroll.diff.value,f=ir(i,u);return QG({draggable:r,offset:f,initialWindowScroll:e.scroll.initial})})},eV=({state:n,published:t})=>{const e=t.modified.map(b=>{const S=n.dimensions.droppables[b.droppableId];return I2(S,b.scroll)}),i={...n.dimensions.droppables,...LL(e)},r=IL(tV({additions:t.additions,updatedDroppables:i,viewport:n.viewport})),s={...n.dimensions.draggables,...r};t.removals.forEach(b=>{delete s[b]});const a={droppables:i,draggables:s},l=Ms(n.impact),u=l?a.droppables[l]:null,f=a.draggables[n.critical.draggable.id],d=a.droppables[n.critical.droppable.id],{impact:p,afterCritical:m}=KL({draggable:f,home:d,draggables:s,viewport:n.viewport}),g=u&&u.isCombineEnabled?n.impact:p,y=WL({pageOffset:n.current.page.offset,draggable:a.draggables[n.critical.draggable.id],draggables:a.draggables,droppables:a.droppables,previousImpact:g,viewport:n.viewport,afterCritical:m}),x={...n,phase:"DRAGGING",impact:y,onLiftImpact:p,dimensions:a,afterCritical:m,forceShouldAnimate:!1};return n.phase==="COLLECTING"?x:{...x,phase:"DROP_PENDING",reason:n.reason,isWaiting:!1}};const Jw=n=>n.movementMode==="SNAP",q_=(n,t,e)=>{const i=ZG(n.dimensions,t);return!Jw(n)||e?jp({state:n,dimensions:i}):qL({state:n,dimensions:i})};function K_(n){return n.isDragging&&n.movementMode==="SNAP"?{...n,scrollJumpRequest:null}:n}const _4={phase:"IDLE",completed:null,shouldFlush:!1};var nV=(n=_4,t)=>{if(t.type==="FLUSH")return{..._4,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){n.phase!=="IDLE"&&oe();const{critical:e,clientSelection:i,viewport:r,dimensions:s,movementMode:a}=t.payload,l=s.draggables[e.draggable.id],u=s.droppables[e.droppable.id],f={selection:i,borderBoxCenter:l.client.borderBox.center,offset:Vi},d={client:f,page:{selection:ir(f.selection,r.scroll.initial),borderBoxCenter:ir(f.selection,r.scroll.initial),offset:ir(f.selection,r.scroll.diff.value)}},p=ox(s.droppables).every(x=>!x.isFixedOnPage),{impact:m,afterCritical:g}=KL({draggable:l,home:u,draggables:s.draggables,viewport:r});return{phase:"DRAGGING",isDragging:!0,critical:e,movementMode:a,dimensions:s,initial:d,current:d,isWindowScrollAllowed:p,impact:m,afterCritical:g,onLiftImpact:m,viewport:r,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"?n:(n.phase!=="DRAGGING"&&oe(),{...n,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"||oe(),eV({state:n,published:t.payload});if(t.type==="MOVE"){if(n.phase==="DROP_PENDING")return n;ou(n)||oe();const{client:e}=t.payload;return gc(e,n.current.client.selection)?n:jp({state:n,clientSelection:e,impact:Jw(n)?n.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="COLLECTING")return K_(n);ou(n)||oe();const{id:e,newScroll:i}=t.payload,r=n.dimensions.droppables[e];if(!r)return n;const s=I2(r,i);return q_(n,s,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(n.phase==="DROP_PENDING")return n;ou(n)||oe();const{id:e,isEnabled:i}=t.payload,r=n.dimensions.droppables[e];r||oe(),r.isEnabled===i&&oe();const s={...r,isEnabled:i};return q_(n,s,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(n.phase==="DROP_PENDING")return n;ou(n)||oe();const{id:e,isCombineEnabled:i}=t.payload,r=n.dimensions.droppables[e];r||oe(),r.isCombineEnabled===i&&oe();const s={...r,isCombineEnabled:i};return q_(n,s,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="DROP_ANIMATING")return n;ou(n)||oe(),n.isWindowScrollAllowed||oe();const e=t.payload.newScroll;if(gc(n.viewport.scroll.current,e))return K_(n);const i=jL(n.viewport,e);return Jw(n)?qL({state:n,viewport:i}):jp({state:n,viewport:i})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!ou(n))return n;const e=t.payload.maxScroll;if(gc(e,n.viewport.scroll.max))return n;const i={...n.viewport,scroll:{...n.viewport.scroll,max:e}};return{...n,viewport:i}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(n.phase==="COLLECTING"||n.phase==="DROP_PENDING")return n;n.phase!=="DRAGGING"&&oe();const e=BG({state:n,type:t.type});return e?jp({state:n,impact:e.impact,clientSelection:e.clientSelection,scrollJumpRequest:e.scrollJumpRequest}):n}if(t.type==="DROP_PENDING"){const e=t.payload.reason;return n.phase!=="COLLECTING"&&oe(),{...n,phase:"DROP_PENDING",isWaiting:!0,reason:e}}if(t.type==="DROP_ANIMATE"){const{completed:e,dropDuration:i,newHomeClientOffset:r}=t.payload;return n.phase==="DRAGGING"||n.phase==="DROP_PENDING"||oe(),{phase:"DROP_ANIMATING",completed:e,dropDuration:i,newHomeClientOffset:r,dimensions:n.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:e}=t.payload;return{phase:"IDLE",completed:e,shouldFlush:!1}}return n};function bn(n,t){return n instanceof Object&&"type"in n&&n.type===t}const iV=n=>({type:"BEFORE_INITIAL_CAPTURE",payload:n}),rV=n=>({type:"LIFT",payload:n}),sV=n=>({type:"INITIAL_PUBLISH",payload:n}),aV=n=>({type:"PUBLISH_WHILE_DRAGGING",payload:n}),oV=()=>({type:"COLLECTION_STARTING",payload:null}),lV=n=>({type:"UPDATE_DROPPABLE_SCROLL",payload:n}),cV=n=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:n}),uV=n=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:n}),ZL=n=>({type:"MOVE",payload:n}),fV=n=>({type:"MOVE_BY_WINDOW_SCROLL",payload:n}),dV=n=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:n}),hV=()=>({type:"MOVE_UP",payload:null}),pV=()=>({type:"MOVE_DOWN",payload:null}),mV=()=>({type:"MOVE_RIGHT",payload:null}),gV=()=>({type:"MOVE_LEFT",payload:null}),U2=()=>({type:"FLUSH",payload:null}),vV=n=>({type:"DROP_ANIMATE",payload:n}),z2=n=>({type:"DROP_COMPLETE",payload:n}),QL=n=>({type:"DROP",payload:n}),xV=n=>({type:"DROP_PENDING",payload:n}),JL=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var yV=n=>({getState:t,dispatch:e})=>i=>r=>{if(!bn(r,"LIFT")){i(r);return}const{id:s,clientSelection:a,movementMode:l}=r.payload,u=t();u.phase==="DROP_ANIMATING"&&e(z2({completed:u.completed})),t().phase!=="IDLE"&&oe(),e(U2()),e(iV({draggableId:s,movementMode:l}));const d={draggableId:s,scrollOptions:{shouldPublishImmediately:l==="SNAP"}},{critical:p,dimensions:m,viewport:g}=n.startPublishing(d);e(sV({critical:p,dimensions:m,clientSelection:a,movementMode:l,viewport:g}))},_V=n=>()=>t=>e=>{bn(e,"INITIAL_PUBLISH")&&n.dragging(),bn(e,"DROP_ANIMATE")&&n.dropping(e.payload.completed.result.reason),(bn(e,"FLUSH")||bn(e,"DROP_COMPLETE"))&&n.resting(),t(e)};const H2={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},a0={opacity:{drop:0,combining:.7},scale:{drop:.75}},t5={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},iu=`${t5.outOfTheWay}s ${H2.outOfTheWay}`,Up={fluid:`opacity ${iu}`,snap:`transform ${iu}, opacity ${iu}`,drop:n=>{const t=`${n}s ${H2.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${iu}`,placeholder:`height ${iu}, width ${iu}, margin ${iu}`},b4=n=>gc(n,Vi)?void 0:`translate(${n.x}px, ${n.y}px)`,tE={moveTo:b4,drop:(n,t)=>{const e=b4(n);if(e)return t?`${e} scale(${a0.scale.drop})`:e}},{minDropTime:eE,maxDropTime:e5}=t5,bV=e5-eE,w4=1500,wV=.6;var EV=({current:n,destination:t,reason:e})=>{const i=i0(n,t);if(i<=0)return eE;if(i>=w4)return e5;const r=i/w4,s=eE+bV*r,a=e==="CANCEL"?s*wV:s;return Number(a.toFixed(2))},AV=({impact:n,draggable:t,dimensions:e,viewport:i,afterCritical:r})=>{const{draggables:s,droppables:a}=e,l=Ms(n),u=l?a[l]:null,f=a[t.descriptor.droppableId],d=YL({impact:n,draggable:t,draggables:s,afterCritical:r,droppable:u||f,viewport:i});return Ls(d,t.client.borderBox.center)},SV=({draggables:n,reason:t,lastImpact:e,home:i,viewport:r,onLiftImpact:s})=>!e.at||t!=="DROP"?{impact:XL({draggables:n,impact:s,destination:i,viewport:r,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:e.at.type==="REORDER"?{impact:e,didDropInsideDroppable:!0}:{impact:{...e,displaced:r0},didDropInsideDroppable:!0};const TV=({getState:n,dispatch:t})=>e=>i=>{if(!bn(i,"DROP")){e(i);return}const r=n(),s=i.payload.reason;if(r.phase==="COLLECTING"){t(xV({reason:s}));return}if(r.phase==="IDLE")return;r.phase==="DROP_PENDING"&&r.isWaiting&&oe(),r.phase==="DRAGGING"||r.phase==="DROP_PENDING"||oe();const l=r.critical,u=r.dimensions,f=u.draggables[r.critical.draggable.id],{impact:d,didDropInsideDroppable:p}=SV({reason:s,lastImpact:r.impact,afterCritical:r.afterCritical,onLiftImpact:r.onLiftImpact,home:r.dimensions.droppables[r.critical.droppable.id],viewport:r.viewport,draggables:r.dimensions.draggables}),m=p?k2(d):null,g=p?lx(d):null,y={index:l.draggable.index,droppableId:l.droppable.id},x={draggableId:f.descriptor.id,type:f.descriptor.type,source:y,reason:s,mode:r.movementMode,destination:m,combine:g},_=AV({impact:d,draggable:f,dimensions:u,viewport:r.viewport,afterCritical:r.afterCritical}),b={critical:r.critical,afterCritical:r.afterCritical,result:x,impact:d};if(!(!gc(r.current.client.offset,_)||!!x.combine)){t(z2({completed:b}));return}const A=EV({current:r.current.client.offset,destination:_,reason:s});t(vV({newHomeClientOffset:_,dropDuration:A,completed:b}))};var n5=()=>({x:window.pageXOffset,y:window.pageYOffset});function CV(n){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||n()}}}function DV({onWindowScroll:n}){function t(){n(n5())}const e=e0(t),i=CV(e);let r=mc;function s(){return r!==mc}function a(){s()&&oe(),r=aa(window,[i])}function l(){s()||oe(),e.cancel(),r(),r=mc}return{start:a,stop:l,isActive:s}}const OV=n=>bn(n,"DROP_COMPLETE")||bn(n,"DROP_ANIMATE")||bn(n,"FLUSH"),RV=n=>{const t=DV({onWindowScroll:e=>{n.dispatch(fV({newScroll:e}))}});return e=>i=>{!t.isActive()&&bn(i,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&OV(i)&&t.stop(),e(i)}};var NV=n=>{let t=!1,e=!1;const i=setTimeout(()=>{e=!0}),r=s=>{t||e||(t=!0,n(s),clearTimeout(i))};return r.wasCalled=()=>t,r},LV=()=>{const n=[],t=r=>{const s=n.findIndex(l=>l.timerId===r);s===-1&&oe();const[a]=n.splice(s,1);a.callback()};return{add:r=>{const s=setTimeout(()=>t(s)),a={timerId:s,callback:r};n.push(a)},flush:()=>{if(!n.length)return;const r=[...n];n.length=0,r.forEach(s=>{clearTimeout(s.timerId),s.callback()})}}};const IV=(n,t)=>n==null&&t==null?!0:n==null||t==null?!1:n.droppableId===t.droppableId&&n.index===t.index,kV=(n,t)=>n==null&&t==null?!0:n==null||t==null?!1:n.draggableId===t.draggableId&&n.droppableId===t.droppableId,MV=(n,t)=>{if(n===t)return!0;const e=n.draggable.id===t.draggable.id&&n.draggable.droppableId===t.draggable.droppableId&&n.draggable.type===t.draggable.type&&n.draggable.index===t.draggable.index,i=n.droppable.id===t.droppable.id&&n.droppable.type===t.droppable.type;return e&&i},dp=(n,t)=>{t()},Yg=(n,t)=>({draggableId:n.draggable.id,type:n.droppable.type,source:{droppableId:n.droppable.id,index:n.draggable.index},mode:t});function Z_(n,t,e,i){if(!n){e(i(t));return}const r=NV(e);n(t,{announce:r}),r.wasCalled()||e(i(t))}var FV=(n,t)=>{const e=LV();let i=null;const r=(p,m)=>{i&&oe(),dp("onBeforeCapture",()=>{const g=n().onBeforeCapture;g&&g({draggableId:p,mode:m})})},s=(p,m)=>{i&&oe(),dp("onBeforeDragStart",()=>{const g=n().onBeforeDragStart;g&&g(Yg(p,m))})},a=(p,m)=>{i&&oe();const g=Yg(p,m);i={mode:m,lastCritical:p,lastLocation:g.source,lastCombine:null},e.add(()=>{dp("onDragStart",()=>Z_(n().onDragStart,g,t,Hv.onDragStart))})},l=(p,m)=>{const g=k2(m),y=lx(m);i||oe();const x=!MV(p,i.lastCritical);x&&(i.lastCritical=p);const _=!IV(i.lastLocation,g);_&&(i.lastLocation=g);const b=!kV(i.lastCombine,y);if(b&&(i.lastCombine=y),!x&&!_&&!b)return;const S={...Yg(p,i.mode),combine:y,destination:g};e.add(()=>{dp("onDragUpdate",()=>Z_(n().onDragUpdate,S,t,Hv.onDragUpdate))})},u=()=>{i||oe(),e.flush()},f=p=>{i||oe(),i=null,dp("onDragEnd",()=>Z_(n().onDragEnd,p,t,Hv.onDragEnd))};return{beforeCapture:r,beforeStart:s,start:a,update:l,flush:u,drop:f,abort:()=>{if(!i)return;const p={...Yg(i.lastCritical,i.mode),combine:null,destination:null,reason:"CANCEL"};f(p)}}},PV=(n,t)=>{const e=FV(n,t);return i=>r=>s=>{if(bn(s,"BEFORE_INITIAL_CAPTURE")){e.beforeCapture(s.payload.draggableId,s.payload.movementMode);return}if(bn(s,"INITIAL_PUBLISH")){const l=s.payload.critical;e.beforeStart(l,s.payload.movementMode),r(s),e.start(l,s.payload.movementMode);return}if(bn(s,"DROP_COMPLETE")){const l=s.payload.completed.result;e.flush(),r(s),e.drop(l);return}if(r(s),bn(s,"FLUSH")){e.abort();return}const a=i.getState();a.phase==="DRAGGING"&&e.update(a.critical,a.impact)}};const BV=n=>t=>e=>{if(!bn(e,"DROP_ANIMATION_FINISHED")){t(e);return}const i=n.getState();i.phase!=="DROP_ANIMATING"&&oe(),n.dispatch(z2({completed:i.completed}))},jV=n=>{let t=null,e=null;function i(){e&&(cancelAnimationFrame(e),e=null),t&&(t(),t=null)}return r=>s=>{if((bn(s,"FLUSH")||bn(s,"DROP_COMPLETE")||bn(s,"DROP_ANIMATION_FINISHED"))&&i(),r(s),!bn(s,"DROP_ANIMATE"))return;const a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){n.getState().phase==="DROP_ANIMATING"&&n.dispatch(JL())}};e=requestAnimationFrame(()=>{e=null,t=aa(window,[a])})}};var UV=n=>()=>t=>e=>{(bn(e,"DROP_COMPLETE")||bn(e,"FLUSH")||bn(e,"DROP_ANIMATE"))&&n.stopPublishing(),t(e)},zV=n=>{let t=!1;return()=>e=>i=>{if(bn(i,"INITIAL_PUBLISH")){t=!0,n.tryRecordFocus(i.payload.critical.draggable.id),e(i),n.tryRestoreFocusRecorded();return}if(e(i),!!t){if(bn(i,"FLUSH")){t=!1,n.tryRestoreFocusRecorded();return}if(bn(i,"DROP_COMPLETE")){t=!1;const r=i.payload.completed.result;r.combine&&n.tryShiftRecord(r.draggableId,r.combine.draggableId),n.tryRestoreFocusRecorded()}}}};const HV=n=>bn(n,"DROP_COMPLETE")||bn(n,"DROP_ANIMATE")||bn(n,"FLUSH");var $V=n=>t=>e=>i=>{if(HV(i)){n.stop(),e(i);return}if(bn(i,"INITIAL_PUBLISH")){e(i);const r=t.getState();r.phase!=="DRAGGING"&&oe(),n.start(r);return}e(i),n.scroll(t.getState())};const GV=n=>t=>e=>{if(t(e),!bn(e,"PUBLISH_WHILE_DRAGGING"))return;const i=n.getState();i.phase==="DROP_PENDING"&&(i.isWaiting||n.dispatch(QL({reason:i.reason})))},VV=xL;var WV=({dimensionMarshal:n,focusMarshal:t,styleMarshal:e,getResponders:i,announce:r,autoScroller:s})=>vL(nV,VV(VH(_V(e),UV(n),yV(n),TV,BV,jV,GV,$V(s),RV,zV(t),PV(i,r))));const Q_=()=>({additions:{},removals:{},modified:{}});function XV({registry:n,callbacks:t}){let e=Q_(),i=null;const r=()=>{i||(t.collectionStarting(),i=requestAnimationFrame(()=>{i=null;const{additions:u,removals:f,modified:d}=e,p=Object.keys(u).map(y=>n.draggable.getById(y).getDimension(Vi)).sort((y,x)=>y.descriptor.index-x.descriptor.index),m=Object.keys(d).map(y=>{const _=n.droppable.getById(y).callbacks.getScrollWhileDragging();return{droppableId:y,scroll:_}}),g={additions:p,removals:Object.keys(f),modified:m};e=Q_(),t.publish(g)}))};return{add:u=>{const f=u.descriptor.id;e.additions[f]=u,e.modified[u.descriptor.droppableId]=!0,e.removals[f]&&delete e.removals[f],r()},remove:u=>{const f=u.descriptor;e.removals[f.id]=!0,e.modified[f.droppableId]=!0,e.additions[f.id]&&delete e.additions[f.id],r()},stop:()=>{i&&(cancelAnimationFrame(i),i=null,e=Q_())}}}var i5=({scrollHeight:n,scrollWidth:t,height:e,width:i})=>{const r=Ls({x:t,y:n},{x:i,y:e});return{x:Math.max(0,r.x),y:Math.max(0,r.y)}},r5=()=>{const n=document.documentElement;return n||oe(),n},s5=()=>{const n=r5();return i5({scrollHeight:n.scrollHeight,scrollWidth:n.scrollWidth,width:n.clientWidth,height:n.clientHeight})},YV=()=>{const n=n5(),t=s5(),e=n.y,i=n.x,r=r5(),s=r.clientWidth,a=r.clientHeight,l=i+s,u=e+a;return{frame:La({top:e,left:i,right:l,bottom:u}),scroll:{initial:n,current:n,max:t,diff:{value:Vi,displacement:Vi}}}},qV=({critical:n,scrollOptions:t,registry:e})=>{const i=YV(),r=i.scroll.current,s=n.droppable,a=e.droppable.getAllByType(s.type).map(d=>d.callbacks.getDimensionAndWatchScroll(r,t)),l=e.draggable.getAllByType(n.draggable.type).map(d=>d.getDimension(r));return{dimensions:{draggables:IL(l),droppables:LL(a)},critical:n,viewport:i}};function E4(n,t,e){return!(e.descriptor.id===t.id||e.descriptor.type!==t.type||n.droppable.getById(e.descriptor.droppableId).descriptor.mode!=="virtual")}var KV=(n,t)=>{let e=null;const i=XV({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:n}),r=(m,g)=>{n.droppable.exists(m)||oe(),e&&t.updateDroppableIsEnabled({id:m,isEnabled:g})},s=(m,g)=>{e&&(n.droppable.exists(m)||oe(),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:g}))},a=(m,g)=>{e&&(n.droppable.exists(m)||oe(),t.updateDroppableScroll({id:m,newScroll:g}))},l=(m,g)=>{e&&n.droppable.getById(m).callbacks.scroll(g)},u=()=>{if(!e)return;i.stop();const m=e.critical.droppable;n.droppable.getAllByType(m.type).forEach(g=>g.callbacks.dragStopped()),e.unsubscribe(),e=null},f=m=>{e||oe();const g=e.critical.draggable;m.type==="ADDITION"&&E4(n,g,m.value)&&i.add(m.value),m.type==="REMOVAL"&&E4(n,g,m.value)&&i.remove(m.value)};return{updateDroppableIsEnabled:r,updateDroppableIsCombineEnabled:s,scrollDroppable:l,updateDroppableScroll:a,startPublishing:m=>{e&&oe();const g=n.draggable.getById(m.draggableId),y=n.droppable.getById(g.descriptor.droppableId),x={draggable:g.descriptor,droppable:y.descriptor},_=n.subscribe(f);return e={critical:x,unsubscribe:_},qV({critical:x,registry:n,scrollOptions:m.scrollOptions})},stopPublishing:u}},a5=(n,t)=>n.phase==="IDLE"?!0:n.phase!=="DROP_ANIMATING"||n.completed.result.draggableId===t?!1:n.completed.result.reason==="DROP",ZV=n=>{window.scrollBy(n.x,n.y)};const QV=Gi(n=>ox(n).filter(t=>!(!t.isEnabled||!t.frame))),JV=(n,t)=>QV(t).find(i=>(i.frame||oe(),$L(i.frame.pageMarginBox)(n)))||null;var tW=({center:n,destination:t,droppables:e})=>{if(t){const r=e[t];return r.frame?r:null}return JV(n,e)};const o0={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:n=>n**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var eW=(n,t,e=()=>o0)=>{const i=e(),r=n[t.size]*i.startFromPercentage,s=n[t.size]*i.maxScrollAtPercentage;return{startScrollingFrom:r,maxScrollValueAt:s}},o5=({startOfRange:n,endOfRange:t,current:e})=>{const i=t-n;return i===0?0:(e-n)/i},$2=1,nW=(n,t,e=()=>o0)=>{const i=e();if(n>t.startScrollingFrom)return 0;if(n<=t.maxScrollValueAt)return i.maxPixelScroll;if(n===t.startScrollingFrom)return $2;const s=1-o5({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:n}),a=i.maxPixelScroll*i.ease(s);return Math.ceil(a)},iW=(n,t,e)=>{const i=e(),r=i.durationDampening.accelerateAt,s=i.durationDampening.stopDampeningAt,a=t,l=s,f=Date.now()-a;if(f>=s)return n;if(f<r)return $2;const d=o5({startOfRange:r,endOfRange:l,current:f}),p=n*i.ease(d);return Math.ceil(p)},A4=({distanceToEdge:n,thresholds:t,dragStartTime:e,shouldUseTimeDampening:i,getAutoScrollerOptions:r})=>{const s=nW(n,t,r);return s===0?0:i?Math.max(iW(s,e,r),$2):s},S4=({container:n,distanceToEdges:t,dragStartTime:e,axis:i,shouldUseTimeDampening:r,getAutoScrollerOptions:s})=>{const a=eW(n,i,s);return t[i.end]<t[i.start]?A4({distanceToEdge:t[i.end],thresholds:a,dragStartTime:e,shouldUseTimeDampening:r,getAutoScrollerOptions:s}):-1*A4({distanceToEdge:t[i.start],thresholds:a,dragStartTime:e,shouldUseTimeDampening:r,getAutoScrollerOptions:s})},rW=({container:n,subject:t,proposedScroll:e})=>{const i=t.height>n.height,r=t.width>n.width;return!r&&!i?e:r&&i?null:{x:r?0:e.x,y:i?0:e.y}};const sW=NL(n=>n===0?0:n);var l5=({dragStartTime:n,container:t,subject:e,center:i,shouldUseTimeDampening:r,getAutoScrollerOptions:s})=>{const a={top:i.y-t.top,right:t.right-i.x,bottom:t.bottom-i.y,left:i.x-t.left},l=S4({container:t,distanceToEdges:a,dragStartTime:n,axis:M2,shouldUseTimeDampening:r,getAutoScrollerOptions:s}),u=S4({container:t,distanceToEdges:a,dragStartTime:n,axis:FL,shouldUseTimeDampening:r,getAutoScrollerOptions:s}),f=sW({x:u,y:l});if(gc(f,Vi))return null;const d=rW({container:t,subject:e,proposedScroll:f});return d?gc(d,Vi)?null:d:null};const aW=NL(n=>n===0?0:n>0?1:-1),G2=(()=>{const n=(t,e)=>t<0?t:t>e?t-e:0;return({current:t,max:e,change:i})=>{const r=ir(t,i),s={x:n(r.x,e.x),y:n(r.y,e.y)};return gc(s,Vi)?null:s}})(),c5=({max:n,current:t,change:e})=>{const i={x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)},r=aW(e),s=G2({max:i,current:t,change:r});return!s||r.x!==0&&s.x===0||r.y!==0&&s.y===0},V2=(n,t)=>c5({current:n.scroll.current,max:n.scroll.max,change:t}),oW=(n,t)=>{if(!V2(n,t))return null;const e=n.scroll.max,i=n.scroll.current;return G2({current:i,max:e,change:t})},W2=(n,t)=>{const e=n.frame;return e?c5({current:e.scroll.current,max:e.scroll.max,change:t}):!1},lW=(n,t)=>{const e=n.frame;return!e||!W2(n,t)?null:G2({current:e.scroll.current,max:e.scroll.max,change:t})};var cW=({viewport:n,subject:t,center:e,dragStartTime:i,shouldUseTimeDampening:r,getAutoScrollerOptions:s})=>{const a=l5({dragStartTime:i,container:n.frame,subject:t,center:e,shouldUseTimeDampening:r,getAutoScrollerOptions:s});return a&&V2(n,a)?a:null},uW=({droppable:n,subject:t,center:e,dragStartTime:i,shouldUseTimeDampening:r,getAutoScrollerOptions:s})=>{const a=n.frame;if(!a)return null;const l=l5({dragStartTime:i,container:a.pageMarginBox,subject:t,center:e,shouldUseTimeDampening:r,getAutoScrollerOptions:s});return l&&W2(n,l)?l:null},T4=({state:n,dragStartTime:t,shouldUseTimeDampening:e,scrollWindow:i,scrollDroppable:r,getAutoScrollerOptions:s})=>{const a=n.current.page.borderBoxCenter,u=n.dimensions.draggables[n.critical.draggable.id].page.marginBox;if(n.isWindowScrollAllowed){const p=n.viewport,m=cW({dragStartTime:t,viewport:p,subject:u,center:a,shouldUseTimeDampening:e,getAutoScrollerOptions:s});if(m){i(m);return}}const f=tW({center:a,destination:Ms(n.impact),droppables:n.dimensions.droppables});if(!f)return;const d=uW({dragStartTime:t,droppable:f,subject:u,center:a,shouldUseTimeDampening:e,getAutoScrollerOptions:s});d&&r(f.descriptor.id,d)},fW=({scrollWindow:n,scrollDroppable:t,getAutoScrollerOptions:e=()=>o0})=>{const i=e0(n),r=e0(t);let s=null;const a=f=>{s||oe();const{shouldUseTimeDampening:d,dragStartTime:p}=s;T4({state:f,scrollWindow:i,scrollDroppable:r,dragStartTime:p,shouldUseTimeDampening:d,getAutoScrollerOptions:e})};return{start:f=>{s&&oe();const d=Date.now();let p=!1;const m=()=>{p=!0};T4({state:f,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m,getAutoScrollerOptions:e}),s={dragStartTime:d,shouldUseTimeDampening:p},p&&a(f)},stop:()=>{s&&(i.cancel(),r.cancel(),s=null)},scroll:a}},dW=({move:n,scrollDroppable:t,scrollWindow:e})=>{const i=(l,u)=>{const f=ir(l.current.client.selection,u);n({client:f})},r=(l,u)=>{if(!W2(l,u))return u;const f=lW(l,u);if(!f)return t(l.descriptor.id,u),null;const d=Ls(u,f);return t(l.descriptor.id,d),Ls(u,d)},s=(l,u,f)=>{if(!l||!V2(u,f))return f;const d=oW(u,f);if(!d)return e(f),null;const p=Ls(f,d);return e(p),Ls(f,p)};return l=>{const u=l.scrollJumpRequest;if(!u)return;const f=Ms(l.impact);f||oe();const d=r(l.dimensions.droppables[f],u);if(!d)return;const p=l.viewport,m=s(l.isWindowScrollAllowed,p,d);m&&i(l,m)}},hW=({scrollDroppable:n,scrollWindow:t,move:e,getAutoScrollerOptions:i})=>{const r=fW({scrollWindow:t,scrollDroppable:n,getAutoScrollerOptions:i}),s=dW({move:e,scrollWindow:t,scrollDroppable:n});return{scroll:u=>{if(!(i().disabled||u.phase!=="DRAGGING")){if(u.movementMode==="FLUID"){r.scroll(u);return}u.scrollJumpRequest&&s(u)}},start:r.start,stop:r.stop}};const yd="data-rfd",_d=(()=>{const n=`${yd}-drag-handle`;return{base:n,draggableId:`${n}-draggable-id`,contextId:`${n}-context-id`}})(),nE=(()=>{const n=`${yd}-draggable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),pW=(()=>{const n=`${yd}-droppable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),C4={contextId:`${yd}-scroll-container-context-id`},mW=n=>t=>`[${t}="${n}"]`,hp=(n,t)=>n.map(e=>{const i=e.styles[t];return i?`${e.selector} { ${i} }`:""}).join(" "),gW="pointer-events: none;";var vW=n=>{const t=mW(n),e=(()=>{const l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(_d.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:gW,dropAnimating:l}}})(),i=(()=>{const l=`
      transition: ${Up.outOfTheWay};
    `;return{selector:t(nE.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}})(),r={selector:t(pW.contextId),styles:{always:"overflow-anchor: none;"}},a=[i,e,r,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:hp(a,"always"),resting:hp(a,"resting"),dragging:hp(a,"dragging"),dropAnimating:hp(a,"dropAnimating"),userCancel:hp(a,"userCancel")}};const Fs=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?U.useLayoutEffect:U.useEffect,J_=()=>{const n=document.querySelector("head");return n||oe(),n},D4=n=>{const t=document.createElement("style");return n&&t.setAttribute("nonce",n),t.type="text/css",t};function xW(n,t){const e=fn(()=>vW(n),[n]),i=U.useRef(null),r=U.useRef(null),s=we(Gi(p=>{const m=r.current;m||oe(),m.textContent=p}),[]),a=we(p=>{const m=i.current;m||oe(),m.textContent=p},[]);Fs(()=>{!i.current&&!r.current||oe();const p=D4(t),m=D4(t);return i.current=p,r.current=m,p.setAttribute(`${yd}-always`,n),m.setAttribute(`${yd}-dynamic`,n),J_().appendChild(p),J_().appendChild(m),a(e.always),s(e.resting),()=>{const g=y=>{const x=y.current;x||oe(),J_().removeChild(x),y.current=null};g(i),g(r)}},[t,a,s,e.always,e.resting,n]);const l=we(()=>s(e.dragging),[s,e.dragging]),u=we(p=>{if(p==="DROP"){s(e.dropAnimating);return}s(e.userCancel)},[s,e.dropAnimating,e.userCancel]),f=we(()=>{r.current&&s(e.resting)},[s,e.resting]);return fn(()=>({dragging:l,dropping:u,resting:f}),[l,u,f])}function u5(n,t){return Array.from(n.querySelectorAll(t))}var f5=n=>n&&n.ownerDocument&&n.ownerDocument.defaultView?n.ownerDocument.defaultView:window;function fx(n){return n instanceof f5(n).HTMLElement}function yW(n,t){const e=`[${_d.contextId}="${n}"]`,i=u5(document,e);if(!i.length)return null;const r=i.find(s=>s.getAttribute(_d.draggableId)===t);return!r||!fx(r)?null:r}function _W(n){const t=U.useRef({}),e=U.useRef(null),i=U.useRef(null),r=U.useRef(!1),s=we(function(m,g){const y={id:m,focus:g};return t.current[m]=y,function(){const _=t.current;_[m]!==y&&delete _[m]}},[]),a=we(function(m){const g=yW(n,m);g&&g!==document.activeElement&&g.focus()},[n]),l=we(function(m,g){e.current===m&&(e.current=g)},[]),u=we(function(){i.current||r.current&&(i.current=requestAnimationFrame(()=>{i.current=null;const m=e.current;m&&a(m)}))},[a]),f=we(function(m){e.current=null;const g=document.activeElement;g&&g.getAttribute(_d.draggableId)===m&&(e.current=m)},[]);return Fs(()=>(r.current=!0,function(){r.current=!1;const m=i.current;m&&cancelAnimationFrame(m)}),[]),fn(()=>({register:s,tryRecordFocus:f,tryRestoreFocusRecorded:u,tryShiftRecord:l}),[s,f,u,l])}function bW(){const n={draggables:{},droppables:{}},t=[];function e(p){return t.push(p),function(){const g=t.indexOf(p);g!==-1&&t.splice(g,1)}}function i(p){t.length&&t.forEach(m=>m(p))}function r(p){return n.draggables[p]||null}function s(p){const m=r(p);return m||oe(),m}const a={register:p=>{n.draggables[p.descriptor.id]=p,i({type:"ADDITION",value:p})},update:(p,m)=>{const g=n.draggables[m.descriptor.id];g&&g.uniqueId===p.uniqueId&&(delete n.draggables[m.descriptor.id],n.draggables[p.descriptor.id]=p)},unregister:p=>{const m=p.descriptor.id,g=r(m);g&&p.uniqueId===g.uniqueId&&(delete n.draggables[m],n.droppables[p.descriptor.droppableId]&&i({type:"REMOVAL",value:p}))},getById:s,findById:r,exists:p=>!!r(p),getAllByType:p=>Object.values(n.draggables).filter(m=>m.descriptor.type===p)};function l(p){return n.droppables[p]||null}function u(p){const m=l(p);return m||oe(),m}const f={register:p=>{n.droppables[p.descriptor.id]=p},unregister:p=>{const m=l(p.descriptor.id);m&&p.uniqueId===m.uniqueId&&delete n.droppables[p.descriptor.id]},getById:u,findById:l,exists:p=>!!l(p),getAllByType:p=>Object.values(n.droppables).filter(m=>m.descriptor.type===p)};function d(){n.draggables={},n.droppables={},t.length=0}return{draggable:a,droppable:f,subscribe:e,clean:d}}function wW(){const n=fn(bW,[]);return U.useEffect(()=>function(){n.clean()},[n]),n}var X2=Je.createContext(null),o1=()=>{const n=document.body;return n||oe(),n};const EW={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},AW=n=>`rfd-announcement-${n}`;function SW(n){const t=fn(()=>AW(n),[n]),e=U.useRef(null);return U.useEffect(function(){const s=document.createElement("div");return e.current=s,s.id=t,s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true"),n0(s.style,EW),o1().appendChild(s),function(){setTimeout(function(){const u=o1();u.contains(s)&&u.removeChild(s),s===e.current&&(e.current=null)})}},[t]),we(r=>{const s=e.current;if(s){s.textContent=r;return}},[])}const TW={separator:"::"};function Y2(n,t=TW){const e=Je.useId();return fn(()=>`${n}${t.separator}${e}`,[t.separator,n,e])}function CW({contextId:n,uniqueId:t}){return`rfd-hidden-text-${n}-${t}`}function DW({contextId:n,text:t}){const e=Y2("hidden-text",{separator:"-"}),i=fn(()=>CW({contextId:n,uniqueId:e}),[e,n]);return U.useEffect(function(){const s=document.createElement("div");return s.id=i,s.textContent=t,s.style.display="none",o1().appendChild(s),function(){const l=o1();l.contains(s)&&l.removeChild(s)}},[i,t]),i}var dx=Je.createContext(null);function d5(n){const t=U.useRef(n);return U.useEffect(()=>{t.current=n}),t}function OW(){let n=null;function t(){return!!n}function e(a){return a===n}function i(a){n&&oe();const l={abandon:a};return n=l,l}function r(){n||oe(),n=null}function s(){n&&(n.abandon(),r())}return{isClaimed:t,isActive:e,claim:i,release:r,tryAbandon:s}}function l0(n){return n.phase==="IDLE"||n.phase==="DROP_ANIMATING"?!1:n.isDragging}const RW=9,NW=13,q2=27,h5=32,LW=33,IW=34,kW=35,MW=36,FW=37,PW=38,BW=39,jW=40,UW={[NW]:!0,[RW]:!0};var p5=n=>{UW[n.keyCode]&&n.preventDefault()};const hx=(()=>{const n="visibilitychange";return typeof document>"u"?n:[n,`ms${n}`,`webkit${n}`,`moz${n}`,`o${n}`].find(i=>`on${i}`in document)||n})(),m5=0,O4=5;function zW(n,t){return Math.abs(t.x-n.x)>=O4||Math.abs(t.y-n.y)>=O4}const R4={type:"IDLE"};function HW({cancel:n,completed:t,getPhase:e,setPhase:i}){return[{eventName:"mousemove",fn:r=>{const{button:s,clientX:a,clientY:l}=r;if(s!==m5)return;const u={x:a,y:l},f=e();if(f.type==="DRAGGING"){r.preventDefault(),f.actions.move(u);return}f.type!=="PENDING"&&oe();const d=f.point;if(!zW(d,u))return;r.preventDefault();const p=f.actions.fluidLift(u);i({type:"DRAGGING",actions:p})}},{eventName:"mouseup",fn:r=>{const s=e();if(s.type!=="DRAGGING"){n();return}r.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:r=>{e().type==="DRAGGING"&&r.preventDefault(),n()}},{eventName:"keydown",fn:r=>{if(e().type==="PENDING"){n();return}if(r.keyCode===q2){r.preventDefault(),n();return}p5(r)}},{eventName:"resize",fn:n},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{e().type==="PENDING"&&n()}},{eventName:"webkitmouseforcedown",fn:r=>{const s=e();if(s.type==="IDLE"&&oe(),s.actions.shouldRespectForcePress()){n();return}r.preventDefault()}},{eventName:hx,fn:n}]}function $W(n){const t=U.useRef(R4),e=U.useRef(mc),i=fn(()=>({eventName:"mousedown",fn:function(p){if(p.defaultPrevented||p.button!==m5||p.ctrlKey||p.metaKey||p.shiftKey||p.altKey)return;const m=n.findClosestDraggableId(p);if(!m)return;const g=n.tryGetLock(m,a,{sourceEvent:p});if(!g)return;p.preventDefault();const y={x:p.clientX,y:p.clientY};e.current(),f(g,y)}}),[n]),r=fn(()=>({eventName:"webkitmouseforcewillbegin",fn:d=>{if(d.defaultPrevented)return;const p=n.findClosestDraggableId(d);if(!p)return;const m=n.findOptionsForDraggable(p);m&&(m.shouldRespectForcePress||n.canGetLock(p)&&d.preventDefault())}}),[n]),s=we(function(){const p={passive:!1,capture:!0};e.current=aa(window,[r,i],p)},[r,i]),a=we(()=>{t.current.type!=="IDLE"&&(t.current=R4,e.current(),s())},[s]),l=we(()=>{const d=t.current;a(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[a]),u=we(function(){const p={capture:!0,passive:!1},m=HW({cancel:l,completed:a,getPhase:()=>t.current,setPhase:g=>{t.current=g}});e.current=aa(window,m,p)},[l,a]),f=we(function(p,m){t.current.type!=="IDLE"&&oe(),t.current={type:"PENDING",point:m,actions:p},u()},[u]);Fs(function(){return s(),function(){e.current()}},[s])}function GW(){}const VW={[IW]:!0,[LW]:!0,[MW]:!0,[kW]:!0};function WW(n,t){function e(){t(),n.cancel()}function i(){t(),n.drop()}return[{eventName:"keydown",fn:r=>{if(r.keyCode===q2){r.preventDefault(),e();return}if(r.keyCode===h5){r.preventDefault(),i();return}if(r.keyCode===jW){r.preventDefault(),n.moveDown();return}if(r.keyCode===PW){r.preventDefault(),n.moveUp();return}if(r.keyCode===BW){r.preventDefault(),n.moveRight();return}if(r.keyCode===FW){r.preventDefault(),n.moveLeft();return}if(VW[r.keyCode]){r.preventDefault();return}p5(r)}},{eventName:"mousedown",fn:e},{eventName:"mouseup",fn:e},{eventName:"click",fn:e},{eventName:"touchstart",fn:e},{eventName:"resize",fn:e},{eventName:"wheel",fn:e,options:{passive:!0}},{eventName:hx,fn:e}]}function XW(n){const t=U.useRef(GW),e=fn(()=>({eventName:"keydown",fn:function(s){if(s.defaultPrevented||s.keyCode!==h5)return;const a=n.findClosestDraggableId(s);if(!a)return;const l=n.tryGetLock(a,d,{sourceEvent:s});if(!l)return;s.preventDefault();let u=!0;const f=l.snapLift();t.current();function d(){u||oe(),u=!1,t.current(),i()}t.current=aa(window,WW(f,d),{capture:!0,passive:!1})}}),[n]),i=we(function(){const s={passive:!1,capture:!0};t.current=aa(window,[e],s)},[e]);Fs(function(){return i(),function(){t.current()}},[i])}const tb={type:"IDLE"},YW=120,qW=.15;function KW({cancel:n,getPhase:t}){return[{eventName:"orientationchange",fn:n},{eventName:"resize",fn:n},{eventName:"contextmenu",fn:e=>{e.preventDefault()}},{eventName:"keydown",fn:e=>{if(t().type!=="DRAGGING"){n();return}e.keyCode===q2&&e.preventDefault(),n()}},{eventName:hx,fn:n}]}function ZW({cancel:n,completed:t,getPhase:e}){return[{eventName:"touchmove",options:{capture:!1},fn:i=>{const r=e();if(r.type!=="DRAGGING"){n();return}r.hasMoved=!0;const{clientX:s,clientY:a}=i.touches[0],l={x:s,y:a};i.preventDefault(),r.actions.move(l)}},{eventName:"touchend",fn:i=>{const r=e();if(r.type!=="DRAGGING"){n();return}i.preventDefault(),r.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:i=>{if(e().type!=="DRAGGING"){n();return}i.preventDefault(),n()}},{eventName:"touchforcechange",fn:i=>{const r=e();r.type==="IDLE"&&oe();const s=i.touches[0];if(!s||!(s.force>=qW))return;const l=r.actions.shouldRespectForcePress();if(r.type==="PENDING"){l&&n();return}if(l){if(r.hasMoved){i.preventDefault();return}n();return}i.preventDefault()}},{eventName:hx,fn:n}]}function QW(n){const t=U.useRef(tb),e=U.useRef(mc),i=we(function(){return t.current},[]),r=we(function(g){t.current=g},[]),s=fn(()=>({eventName:"touchstart",fn:function(g){if(g.defaultPrevented)return;const y=n.findClosestDraggableId(g);if(!y)return;const x=n.tryGetLock(y,l,{sourceEvent:g});if(!x)return;const _=g.touches[0],{clientX:b,clientY:S}=_,A={x:b,y:S};e.current(),p(x,A)}}),[n]),a=we(function(){const g={capture:!0,passive:!1};e.current=aa(window,[s],g)},[s]),l=we(()=>{const m=t.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),r(tb),e.current(),a())},[a,r]),u=we(()=>{const m=t.current;l(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[l]),f=we(function(){const g={capture:!0,passive:!1},y={cancel:u,completed:l,getPhase:i},x=aa(window,ZW(y),g),_=aa(window,KW(y),g);e.current=function(){x(),_()}},[u,i,l]),d=we(function(){const g=i();g.type!=="PENDING"&&oe();const y=g.actions.fluidLift(g.point);r({type:"DRAGGING",actions:y,hasMoved:!1})},[i,r]),p=we(function(g,y){i().type!=="IDLE"&&oe();const x=setTimeout(d,YW);r({type:"PENDING",point:y,actions:g,longPressTimerId:x}),f()},[f,i,r,d]);Fs(function(){return a(),function(){e.current();const y=i();y.type==="PENDING"&&(clearTimeout(y.longPressTimerId),r(tb))}},[i,a,r]),Fs(function(){return aa(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const JW=["input","button","textarea","select","option","optgroup","video","audio"];function g5(n,t){if(t==null)return!1;if(JW.includes(t.tagName.toLowerCase()))return!0;const i=t.getAttribute("contenteditable");return i==="true"||i===""?!0:t===n?!1:g5(n,t.parentElement)}function tX(n,t){const e=t.target;return fx(e)?g5(n,e):!1}var eX=n=>La(n.getBoundingClientRect()).center;function nX(n){return n instanceof f5(n).Element}const iX=(()=>{const n="matches";return typeof document>"u"?n:[n,"msMatchesSelector","webkitMatchesSelector"].find(i=>i in Element.prototype)||n})();function v5(n,t){return n==null?null:n[iX](t)?n:v5(n.parentElement,t)}function rX(n,t){return n.closest?n.closest(t):v5(n,t)}function sX(n){return`[${_d.contextId}="${n}"]`}function aX(n,t){const e=t.target;if(!nX(e))return null;const i=sX(n),r=rX(e,i);return!r||!fx(r)?null:r}function oX(n,t){const e=aX(n,t);return e?e.getAttribute(_d.draggableId):null}function lX(n,t){const e=`[${nE.contextId}="${n}"]`,r=u5(document,e).find(s=>s.getAttribute(nE.id)===t);return!r||!fx(r)?null:r}function cX(n){n.preventDefault()}function qg({expected:n,phase:t,isLockActive:e,shouldWarn:i}){return!(!e()||n!==t)}function x5({lockAPI:n,store:t,registry:e,draggableId:i}){if(n.isClaimed())return!1;const r=e.draggable.findById(i);return!(!r||!r.options.isEnabled||!a5(t.getState(),i))}function uX({lockAPI:n,contextId:t,store:e,registry:i,draggableId:r,forceSensorStop:s,sourceEvent:a}){if(!x5({lockAPI:n,store:e,registry:i,draggableId:r}))return null;const u=i.draggable.getById(r),f=lX(t,u.descriptor.id);if(!f||a&&!u.options.canDragInteractiveElements&&tX(f,a))return null;const d=n.claim(s||mc);let p="PRE_DRAG";function m(){return u.options.shouldRespectForcePress}function g(){return n.isActive(d)}function y(O,N){qg({expected:O,phase:p,isLockActive:g,shouldWarn:!0})&&e.dispatch(N())}const x=y.bind(null,"DRAGGING");function _(O){function N(){n.release(),p="COMPLETED"}p!=="PRE_DRAG"&&(N(),oe()),e.dispatch(rV(O.liftActionArgs)),p="DRAGGING";function D(L,I={shouldBlockNextClick:!1}){if(O.cleanup(),I.shouldBlockNextClick){const z=aa(window,[{eventName:"click",fn:cX,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(z)}N(),e.dispatch(QL({reason:L}))}return{isActive:()=>qg({expected:"DRAGGING",phase:p,isLockActive:g,shouldWarn:!1}),shouldRespectForcePress:m,drop:L=>D("DROP",L),cancel:L=>D("CANCEL",L),...O.actions}}function b(O){const N=e0(L=>{x(()=>ZL({client:L}))});return{..._({liftActionArgs:{id:r,clientSelection:O,movementMode:"FLUID"},cleanup:()=>N.cancel(),actions:{move:N}}),move:N}}function S(){const O={moveUp:()=>x(hV),moveRight:()=>x(mV),moveDown:()=>x(pV),moveLeft:()=>x(gV)};return _({liftActionArgs:{id:r,clientSelection:eX(f),movementMode:"SNAP"},cleanup:mc,actions:O})}function A(){qg({expected:"PRE_DRAG",phase:p,isLockActive:g,shouldWarn:!0})&&n.release()}return{isActive:()=>qg({expected:"PRE_DRAG",phase:p,isLockActive:g,shouldWarn:!1}),shouldRespectForcePress:m,fluidLift:b,snapLift:S,abort:A}}const fX=[$W,XW,QW];function dX({contextId:n,store:t,registry:e,customSensors:i,enableDefaultSensors:r}){const s=[...r?fX:[],...i||[]],a=U.useState(()=>OW())[0],l=we(function(_,b){l0(_)&&!l0(b)&&a.tryAbandon()},[a]);Fs(function(){let _=t.getState();return t.subscribe(()=>{const S=t.getState();l(_,S),_=S})},[a,t,l]),Fs(()=>a.tryAbandon,[a.tryAbandon]);const u=we(x=>x5({lockAPI:a,registry:e,store:t,draggableId:x}),[a,e,t]),f=we((x,_,b)=>uX({lockAPI:a,registry:e,contextId:n,store:t,draggableId:x,forceSensorStop:_||null,sourceEvent:b&&b.sourceEvent?b.sourceEvent:null}),[n,a,e,t]),d=we(x=>oX(n,x),[n]),p=we(x=>{const _=e.draggable.findById(x);return _?_.options:null},[e.draggable]),m=we(function(){a.isClaimed()&&(a.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(U2()))},[a,t]),g=we(()=>a.isClaimed(),[a]),y=fn(()=>({canGetLock:u,tryGetLock:f,findClosestDraggableId:d,findOptionsForDraggable:p,tryReleaseLock:m,isLockClaimed:g}),[u,f,d,p,m,g]);for(let x=0;x<s.length;x++)s[x](y)}const hX=n=>({onBeforeCapture:t=>{const e=()=>{n.onBeforeCapture&&n.onBeforeCapture(t)};D2.flushSync(e)},onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd,onDragUpdate:n.onDragUpdate}),pX=n=>({...o0,...n.autoScrollerOptions,durationDampening:{...o0.durationDampening,...n.autoScrollerOptions}});function pp(n){return n.current||oe(),n.current}function mX(n){const{contextId:t,setCallbacks:e,sensors:i,nonce:r,dragHandleUsageInstructions:s}=n,a=U.useRef(null),l=d5(n),u=we(()=>hX(l.current),[l]),f=we(()=>pX(l.current),[l]),d=SW(t),p=DW({contextId:t,text:s}),m=xW(t,r),g=we(z=>{pp(a).dispatch(z)},[]),y=fn(()=>n4({publishWhileDragging:aV,updateDroppableScroll:lV,updateDroppableIsEnabled:cV,updateDroppableIsCombineEnabled:uV,collectionStarting:oV},g),[g]),x=wW(),_=fn(()=>KV(x,y),[x,y]),b=fn(()=>hW({scrollWindow:ZV,scrollDroppable:_.scrollDroppable,getAutoScrollerOptions:f,...n4({move:ZL},g)}),[_.scrollDroppable,g,f]),S=_W(t),A=fn(()=>WV({announce:d,autoScroller:b,dimensionMarshal:_,focusMarshal:S,getResponders:u,styleMarshal:m}),[d,b,_,S,u,m]);a.current=A;const C=we(()=>{const z=pp(a);z.getState().phase!=="IDLE"&&z.dispatch(U2())},[]),O=we(()=>{const z=pp(a).getState();return z.phase==="DROP_ANIMATING"?!0:z.phase==="IDLE"?!1:z.isDragging},[]),N=fn(()=>({isDragging:O,tryAbort:C}),[O,C]);e(N);const D=we(z=>a5(pp(a).getState(),z),[]),L=we(()=>ou(pp(a).getState()),[]),I=fn(()=>({marshal:_,focus:S,contextId:t,canLift:D,isMovementAllowed:L,dragHandleUsageInstructionsId:p,registry:x}),[t,_,p,S,D,L,x]);return dX({contextId:t,store:A,registry:x,customSensors:i||null,enableDefaultSensors:n.enableDefaultSensors!==!1}),U.useEffect(()=>C,[C]),Je.createElement(dx.Provider,{value:I},Je.createElement(H$,{context:X2,store:A},n.children))}function gX(){return Je.useId()}function vX(n){const t=gX(),e=n.dragHandleUsageInstructions||Hv.dragHandleUsageInstructions;return Je.createElement(X$,null,i=>Je.createElement(mX,{nonce:n.nonce,contextId:t,setCallbacks:i,dragHandleUsageInstructions:e,enableDefaultSensors:n.enableDefaultSensors,sensors:n.sensors,onBeforeCapture:n.onBeforeCapture,onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragUpdate:n.onDragUpdate,onDragEnd:n.onDragEnd,autoScrollerOptions:n.autoScrollerOptions},n.children))}const N4={dragging:5e3,dropAnimating:4500},xX=(n,t)=>t?Up.drop(t.duration):n?Up.snap:Up.fluid,yX=(n,t)=>{if(n)return t?a0.opacity.drop:a0.opacity.combining},_X=n=>n.forceShouldAnimate!=null?n.forceShouldAnimate:n.mode==="SNAP";function bX(n){const e=n.dimension.client,{offset:i,combineWith:r,dropping:s}=n,a=!!r,l=_X(n),u=!!s,f=u?tE.drop(i,a):tE.moveTo(i);return{position:"fixed",top:e.marginBox.top,left:e.marginBox.left,boxSizing:"border-box",width:e.borderBox.width,height:e.borderBox.height,transition:xX(l,s),transform:f,opacity:yX(a,u),zIndex:u?N4.dropAnimating:N4.dragging,pointerEvents:"none"}}function wX(n){return{transform:tE.moveTo(n.offset),transition:n.shouldAnimateDisplacement?void 0:"none"}}function EX(n){return n.type==="DRAGGING"?bX(n):wX(n)}function AX(n,t,e=Vi){const i=window.getComputedStyle(t),r=t.getBoundingClientRect(),s=SL(r,i),a=i1(s,e),l={client:s,tagName:t.tagName.toLowerCase(),display:i.display},u={x:s.marginBox.width,y:s.marginBox.height};return{descriptor:n,placeholder:l,displaceBy:u,client:s,page:a}}function SX(n){const t=Y2("draggable"),{descriptor:e,registry:i,getDraggableRef:r,canDragInteractiveElements:s,shouldRespectForcePress:a,isEnabled:l}=n,u=fn(()=>({canDragInteractiveElements:s,shouldRespectForcePress:a,isEnabled:l}),[s,l,a]),f=we(g=>{const y=r();return y||oe(),AX(e,y,g)},[e,r]),d=fn(()=>({uniqueId:t,descriptor:e,options:u,getDimension:f}),[e,f,u,t]),p=U.useRef(d),m=U.useRef(!0);Fs(()=>(i.draggable.register(p.current),()=>i.draggable.unregister(p.current)),[i.draggable]),Fs(()=>{if(m.current){m.current=!1;return}const g=p.current;p.current=d,i.draggable.update(d,g)},[d,i.draggable])}var K2=Je.createContext(null);function l1(n){const t=U.useContext(n);return t||oe(),t}function TX(n){n.preventDefault()}const CX=n=>{const t=U.useRef(null),e=we((N=null)=>{t.current=N},[]),i=we(()=>t.current,[]),{contextId:r,dragHandleUsageInstructionsId:s,registry:a}=l1(dx),{type:l,droppableId:u}=l1(K2),f=fn(()=>({id:n.draggableId,index:n.index,type:l,droppableId:u}),[n.draggableId,n.index,l,u]),{children:d,draggableId:p,isEnabled:m,shouldRespectForcePress:g,canDragInteractiveElements:y,isClone:x,mapped:_,dropAnimationFinished:b}=n;if(!x){const N=fn(()=>({descriptor:f,registry:a,getDraggableRef:i,canDragInteractiveElements:y,shouldRespectForcePress:g,isEnabled:m}),[f,a,i,y,g,m]);SX(N)}const S=fn(()=>m?{tabIndex:0,role:"button","aria-describedby":s,"data-rfd-drag-handle-draggable-id":p,"data-rfd-drag-handle-context-id":r,draggable:!1,onDragStart:TX}:null,[r,s,p,m]),A=we(N=>{_.type==="DRAGGING"&&_.dropping&&N.propertyName==="transform"&&D2.flushSync(b)},[b,_]),C=fn(()=>{const N=EX(_),D=_.type==="DRAGGING"&&_.dropping?A:void 0;return{innerRef:e,draggableProps:{"data-rfd-draggable-context-id":r,"data-rfd-draggable-id":p,style:N,onTransitionEnd:D},dragHandleProps:S}},[r,S,p,_,A,e]),O=fn(()=>({draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}),[f.droppableId,f.id,f.index,f.type]);return Je.createElement(Je.Fragment,null,d(C,_.snapshot,O))};var y5=(n,t)=>n===t,_5=n=>{const{combine:t,destination:e}=n;return e?e.droppableId:t?t.droppableId:null};const DX=n=>n.combine?n.combine.draggableId:null,OX=n=>n.at&&n.at.type==="COMBINE"?n.at.combine.draggableId:null;function RX(){const n=Gi((r,s)=>({x:r,y:s})),t=Gi((r,s,a=null,l=null,u=null)=>({isDragging:!0,isClone:s,isDropAnimating:!!u,dropAnimation:u,mode:r,draggingOver:a,combineWith:l,combineTargetFor:null})),e=Gi((r,s,a,l,u=null,f=null,d=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:u,combineWith:f,mode:s,offset:r,dimension:a,forceShouldAnimate:d,snapshot:t(s,l,u,f,null)}}));return(r,s)=>{if(l0(r)){if(r.critical.draggable.id!==s.draggableId)return null;const a=r.current.client.offset,l=r.dimensions.draggables[s.draggableId],u=Ms(r.impact),f=OX(r.impact),d=r.forceShouldAnimate;return e(n(a.x,a.y),r.movementMode,l,s.isClone,u,f,d)}if(r.phase==="DROP_ANIMATING"){const a=r.completed;if(a.result.draggableId!==s.draggableId)return null;const l=s.isClone,u=r.dimensions.draggables[s.draggableId],f=a.result,d=f.mode,p=_5(f),m=DX(f),y={duration:r.dropDuration,curve:H2.drop,moveTo:r.newHomeClientOffset,opacity:m?a0.opacity.drop:null,scale:m?a0.scale.drop:null};return{mapped:{type:"DRAGGING",offset:r.newHomeClientOffset,dimension:u,dropping:y,draggingOver:p,combineWith:m,mode:d,forceShouldAnimate:null,snapshot:t(d,l,p,m,y)}}}return null}}function b5(n=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:n,combineWith:null}}const NX={mapped:{type:"SECONDARY",offset:Vi,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:b5(null)}};function LX(){const n=Gi((a,l)=>({x:a,y:l})),t=Gi(b5),e=Gi((a,l=null,u)=>({mapped:{type:"SECONDARY",offset:a,combineTargetFor:l,shouldAnimateDisplacement:u,snapshot:t(l)}})),i=a=>a?e(Vi,a,!0):null,r=(a,l,u,f)=>{const d=u.displaced.visible[a],p=!!(f.inVirtualList&&f.effected[a]),m=lx(u),g=m&&m.draggableId===a?l:null;if(!d){if(!p)return i(g);if(u.displaced.invisible[a])return null;const _=Rd(f.displacedBy.point),b=n(_.x,_.y);return e(b,g,!0)}if(p)return i(g);const y=u.displacedBy.point,x=n(y.x,y.y);return e(x,g,d.shouldAnimate)};return(a,l)=>{if(l0(a))return a.critical.draggable.id===l.draggableId?null:r(l.draggableId,a.critical.draggable.id,a.impact,a.afterCritical);if(a.phase==="DROP_ANIMATING"){const u=a.completed;return u.result.draggableId===l.draggableId?null:r(l.draggableId,u.result.draggableId,u.impact,u.afterCritical)}return null}}const IX=()=>{const n=RX(),t=LX();return(i,r)=>n(i,r)||t(i,r)||NX},kX={dropAnimationFinished:JL},MX=AL(IX,kX,null,{context:X2,areStatePropsEqual:y5})(CX);function w5(n){return l1(K2).isUsingCloneFor===n.draggableId&&!n.isClone?null:Je.createElement(MX,n)}function FX(n){const t=typeof n.isDragDisabled=="boolean"?!n.isDragDisabled:!0,e=!!n.disableInteractiveElementBlocking,i=!!n.shouldRespectForcePress;return Je.createElement(w5,n0({},n,{isClone:!1,isEnabled:t,canDragInteractiveElements:e,shouldRespectForcePress:i}))}const E5=n=>t=>n===t,PX=E5("scroll"),BX=E5("auto"),L4=(n,t)=>t(n.overflowX)||t(n.overflowY),jX=n=>{const t=window.getComputedStyle(n),e={overflowX:t.overflowX,overflowY:t.overflowY};return L4(e,PX)||L4(e,BX)},UX=()=>!1,A5=n=>n==null?null:n===document.body?UX()?n:null:n===document.documentElement?null:jX(n)?n:A5(n.parentElement);var iE=n=>({x:n.scrollLeft,y:n.scrollTop});const S5=n=>n?window.getComputedStyle(n).position==="fixed"?!0:S5(n.parentElement):!1;var zX=n=>{const t=A5(n),e=S5(n);return{closestScrollable:t,isFixedOnPage:e}},HX=({descriptor:n,isEnabled:t,isCombineEnabled:e,isFixedOnPage:i,direction:r,client:s,page:a,closest:l})=>{const u=(()=>{if(!l)return null;const{scrollSize:m,client:g}=l,y=i5({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:g.paddingBox.height,width:g.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:g,scrollSize:m,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:y,diff:{value:Vi,displacement:Vi}}}})(),f=r==="vertical"?M2:FL,d=xd({page:a,withPlaceholder:null,axis:f,frame:u});return{descriptor:n,isCombineEnabled:e,isFixedOnPage:i,axis:f,isEnabled:t,client:s,page:a,frame:u,subject:d}};const $X=(n,t)=>{const e=TL(n);if(!t||n!==t)return e;const i=e.paddingBox.top-t.scrollTop,r=e.paddingBox.left-t.scrollLeft,s=i+t.scrollHeight,a=r+t.scrollWidth,u=N2({top:i,right:a,bottom:s,left:r},e.border);return L2({borderBox:u,margin:e.margin,border:e.border,padding:e.padding})};var GX=({ref:n,descriptor:t,env:e,windowScroll:i,direction:r,isDropDisabled:s,isCombineEnabled:a,shouldClipSubject:l})=>{const u=e.closestScrollable,f=$X(n,u),d=i1(f,i),p=(()=>{if(!u)return null;const g=TL(u),y={scrollHeight:u.scrollHeight,scrollWidth:u.scrollWidth};return{client:g,page:i1(g,i),scroll:iE(u),scrollSize:y,shouldClipSubject:l}})();return HX({descriptor:t,isEnabled:!s,isCombineEnabled:a,isFixedOnPage:e.isFixedOnPage,direction:r,client:f,page:d,closest:p})};const VX={passive:!1},WX={passive:!0};var I4=n=>n.shouldPublishImmediately?VX:WX;const Kg=n=>n&&n.env.closestScrollable||null;function XX(n){const t=U.useRef(null),e=l1(dx),i=Y2("droppable"),{registry:r,marshal:s}=e,a=d5(n),l=fn(()=>({id:n.droppableId,type:n.type,mode:n.mode}),[n.droppableId,n.mode,n.type]),u=U.useRef(l),f=fn(()=>Gi((C,O)=>{t.current||oe();const N={x:C,y:O};s.updateDroppableScroll(l.id,N)}),[l.id,s]),d=we(()=>{const C=t.current;return!C||!C.env.closestScrollable?Vi:iE(C.env.closestScrollable)},[]),p=we(()=>{const C=d();f(C.x,C.y)},[d,f]),m=fn(()=>e0(p),[p]),g=we(()=>{const C=t.current,O=Kg(C);if(C&&O||oe(),C.scrollOptions.shouldPublishImmediately){p();return}m()},[m,p]),y=we((C,O)=>{t.current&&oe();const N=a.current,D=N.getDroppableRef();D||oe();const L=zX(D),I={ref:D,descriptor:l,env:L,scrollOptions:O};t.current=I;const z=GX({ref:D,descriptor:l,env:L,windowScroll:C,direction:N.direction,isDropDisabled:N.isDropDisabled,isCombineEnabled:N.isCombineEnabled,shouldClipSubject:!N.ignoreContainerClipping}),j=L.closestScrollable;return j&&(j.setAttribute(C4.contextId,e.contextId),j.addEventListener("scroll",g,I4(I.scrollOptions))),z},[e.contextId,l,g,a]),x=we(()=>{const C=t.current,O=Kg(C);return C&&O||oe(),iE(O)},[]),_=we(()=>{const C=t.current;C||oe();const O=Kg(C);t.current=null,O&&(m.cancel(),O.removeAttribute(C4.contextId),O.removeEventListener("scroll",g,I4(C.scrollOptions)))},[g,m]),b=we(C=>{const O=t.current;O||oe();const N=Kg(O);N||oe(),N.scrollTop+=C.y,N.scrollLeft+=C.x},[]),S=fn(()=>({getDimensionAndWatchScroll:y,getScrollWhileDragging:x,dragStopped:_,scroll:b}),[_,y,x,b]),A=fn(()=>({uniqueId:i,descriptor:l,callbacks:S}),[S,l,i]);Fs(()=>(u.current=A.descriptor,r.droppable.register(A),()=>{t.current&&_(),r.droppable.unregister(A)}),[S,l,_,A,s,r.droppable]),Fs(()=>{t.current&&s.updateDroppableIsEnabled(u.current.id,!n.isDropDisabled)},[n.isDropDisabled,s]),Fs(()=>{t.current&&s.updateDroppableIsCombineEnabled(u.current.id,n.isCombineEnabled)},[n.isCombineEnabled,s])}function eb(){}const k4={width:0,height:0,margin:tG},YX=({isAnimatingOpenOnMount:n,placeholder:t,animate:e})=>n||e==="close"?k4:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},qX=({isAnimatingOpenOnMount:n,placeholder:t,animate:e})=>{const i=YX({isAnimatingOpenOnMount:n,placeholder:t,animate:e});return{display:t.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:e!=="none"?Up.placeholder:null}},KX=n=>{const t=U.useRef(null),e=we(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:i,onTransitionEnd:r,onClose:s,contextId:a}=n,[l,u]=U.useState(n.animate==="open");U.useEffect(()=>l?i!=="open"?(e(),u(!1),eb):t.current?eb:(t.current=setTimeout(()=>{t.current=null,u(!1)}),e):eb,[i,l,e]);const f=we(p=>{p.propertyName==="height"&&(r(),i==="close"&&s())},[i,s,r]),d=qX({isAnimatingOpenOnMount:l,animate:n.animate,placeholder:n.placeholder});return Je.createElement(n.placeholder.tagName,{style:d,"data-rfd-placeholder-context-id":a,onTransitionEnd:f,ref:n.innerRef})};var ZX=Je.memo(KX);class QX extends Je.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,e){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:e.isVisible?{isVisible:!0,data:e.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const JX=n=>{const t=U.useContext(dx);t||oe();const{contextId:e,isMovementAllowed:i}=t,r=U.useRef(null),s=U.useRef(null),{children:a,droppableId:l,type:u,mode:f,direction:d,ignoreContainerClipping:p,isDropDisabled:m,isCombineEnabled:g,snapshot:y,useClone:x,updateViewportMaxScroll:_,getContainerForClone:b}=n,S=we(()=>r.current,[]),A=we((j=null)=>{r.current=j},[]);we(()=>s.current,[]);const C=we((j=null)=>{s.current=j},[]),O=we(()=>{i()&&_({maxScroll:s5()})},[i,_]);XX({droppableId:l,type:u,mode:f,direction:d,isDropDisabled:m,isCombineEnabled:g,ignoreContainerClipping:p,getDroppableRef:S});const N=fn(()=>Je.createElement(QX,{on:n.placeholder,shouldAnimate:n.shouldAnimatePlaceholder},({onClose:j,data:B,animate:tt})=>Je.createElement(ZX,{placeholder:B,onClose:j,innerRef:C,animate:tt,contextId:e,onTransitionEnd:O})),[e,O,n.placeholder,n.shouldAnimatePlaceholder,C]),D=fn(()=>({innerRef:A,placeholder:N,droppableProps:{"data-rfd-droppable-id":l,"data-rfd-droppable-context-id":e}}),[e,l,N,A]),L=x?x.dragging.draggableId:null,I=fn(()=>({droppableId:l,type:u,isUsingCloneFor:L}),[l,L,u]);function z(){if(!x)return null;const{dragging:j,render:B}=x,tt=Je.createElement(w5,{draggableId:j.draggableId,index:j.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(k,et)=>B(k,et,j));return dc.createPortal(tt,b())}return Je.createElement(K2.Provider,{value:I},a(D,y),z())};function tY(){return document.body||oe(),document.body}const M4={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:tY},T5=n=>{let t={...n},e;for(e in M4)n[e]===void 0&&(t={...t,[e]:M4[e]});return t},nb=(n,t)=>n===t.droppable.type,F4=(n,t)=>t.draggables[n.draggable.id],eY=()=>{const n={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...n,shouldAnimatePlaceholder:!1},e=Gi(s=>({draggableId:s.id,type:s.type,source:{index:s.index,droppableId:s.droppableId}})),i=Gi((s,a,l,u,f,d)=>{const p=f.descriptor.id;if(f.descriptor.droppableId===s){const y=d?{render:d,dragging:e(f.descriptor)}:null,x={isDraggingOver:l,draggingOverWith:l?p:null,draggingFromThisWith:p,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!1,snapshot:x,useClone:y}}if(!a)return t;if(!u)return n;const g={isDraggingOver:l,draggingOverWith:p,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!0,snapshot:g,useClone:null}});return(s,a)=>{const l=T5(a),u=l.droppableId,f=l.type,d=!l.isDropDisabled,p=l.renderClone;if(l0(s)){const m=s.critical;if(!nb(f,m))return t;const g=F4(m,s.dimensions),y=Ms(s.impact)===u;return i(u,d,y,y,g,p)}if(s.phase==="DROP_ANIMATING"){const m=s.completed;if(!nb(f,m.critical))return t;const g=F4(m.critical,s.dimensions);return i(u,d,_5(m.result)===u,Ms(m.impact)===u,g,p)}if(s.phase==="IDLE"&&s.completed&&!s.shouldFlush){const m=s.completed;if(!nb(f,m.critical))return t;const g=Ms(m.impact)===u,y=!!(m.impact.at&&m.impact.at.type==="COMBINE"),x=m.critical.droppable.id===u;return g?y?n:t:x?n:t}return t}},nY={updateViewportMaxScroll:dV},iY=AL(eY,nY,(n,t,e)=>({...T5(e),...n,...t}),{context:X2,areStatePropsEqual:y5})(JX),rY=({showOnLoad:n,onToggleShowOnLoad:t})=>M.jsx(M.Fragment,{children:M.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:M.jsxs("div",{className:"modal-content",children:[M.jsxs("div",{className:"modal-header",children:[M.jsx("img",{src:"js_logo_simbolo.png",alt:"JS Geologia Aplicada",style:{maxWidth:"50px"}}),M.jsx("h5",{className:"modal-title flex-grow-1 text-center",children:"Extrator de dados de PDFs"}),M.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),M.jsxs("div",{className:"modal-body text-start",children:[M.jsx("p",{className:"lead text-muted mb-3",children:"O Extrator de Dados de PDF da JS Geologia Aplicada é uma ferramenta desenvolvida para automatizar a extração de informações de relatórios de sondagem e outros documentos técnicos, facilitando a organização e análise de dados geológicos."}),M.jsxs("div",{className:"mt-3 px-3 text-start",children:[M.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Como usar"}),M.jsxs("ol",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[M.jsxs("li",{className:"mb-1 text-start",children:[M.jsx("strong",{children:"Carregue um PDF"}),' clicando em "Escolher arquivo"']}),M.jsxs("li",{className:"mb-1 text-start",children:[M.jsx("strong",{children:"Adicione áreas"})," para marcar regiões que deseja extrair texto"]}),M.jsxs("li",{className:"mb-1 text-start",children:[M.jsx("strong",{children:"Renomeie as áreas"})," clicando no nome para facilitar identificação"]}),M.jsxs("li",{className:"mb-1 text-start",children:[M.jsx("strong",{children:"Selecione as áreas"})," clicando no ícone de seleção e arrastando no PDF"]}),M.jsxs("li",{className:"mb-1 text-start",children:[M.jsx("strong",{children:"Extraia os dados"})," e exporte em JSON, CSV ou Excel"]})]})]}),M.jsxs("div",{className:"mt-3 px-3 text-start",children:[M.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Recursos disponíveis"}),M.jsxs("ul",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[M.jsxs("li",{className:"mb-1 text-start",children:[M.jsx("strong",{children:"Até 10 áreas"})," de extração com cores diferentes"]}),M.jsxs("li",{className:"mb-1 text-start",children:[M.jsx("strong",{children:"Sistema de presets"})," para salvar configurações"]}),M.jsxs("li",{className:"mb-1 text-start",children:[M.jsx("strong",{children:"Campos obrigatórios"})," para ignorar páginas que não contenham dados essenciais"]})]})]}),M.jsx("div",{className:"alert alert-warning mt-3 mb-0 text-start",role:"alert",children:M.jsx("p",{className:"mb-0 text-start",children:"A JS Geologia Aplicada não se responsabiliza por eventuais erros na leitura automática dos dados."})})]}),M.jsxs("div",{className:"modal-footer d-flex justify-content-between",children:[M.jsxs("div",{className:"form-check form-switch",children:[M.jsx("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:n,onChange:e=>{t(e.target.checked)}}),M.jsx("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Mostrar ao abrir"})]}),M.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Fechar"})]})]})})});function sY({onFileSelect:n,onStartAreaSelection:t,onDeleteArea:e,onRenameArea:i,onClearArea:r,onAddNewArea:s,onLoadPreset:a,onDragEnd:l,onToggleMandatory:u,onToggleRepeat:f,onChangeAreaType:d,onToggleAreaOCR:p,areas:m,hasFile:g,extractionMode:y,onChangeExtractionMode:x}){U.useEffect(()=>{const L=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));return L.forEach(I=>new yc(I)),()=>{L.forEach(I=>{const z=yc.getInstance(I);z&&z.dispose()})}},[m.length]);const[_,b]=U.useState(!1),S=()=>{b(!0)},[A,C]=U.useState(()=>localStorage.getItem("showHelpOnLoad")!=="false");U.useEffect(()=>{const L=()=>{new Yp("#helpModal").show()};if(A)if(document.readyState==="complete")L();else return window.addEventListener("load",L),()=>window.removeEventListener("load",L)},[]);const O=L=>{C(L),localStorage.setItem("showHelpOnLoad",L.toString())},N=()=>{confirm("Deseja remover todas as áreas?")&&m.forEach(L=>{e(L.id)})},D=()=>{j_.forEach(L=>{m.find(I=>I.dataType===L)||s(L)})};return M.jsxs(M.Fragment,{children:[M.jsx(UH,{onFileSelect:n}),M.jsx("div",{className:"modal fade",id:"helpModal",tabIndex:-1,children:M.jsx(rY,{showOnLoad:A,onToggleShowOnLoad:O})}),M.jsxs("div",{className:"d-flex justify-content-end gap-2 my-3",children:[M.jsxs("select",{className:"form-select form-select-sm",defaultValue:"text",onChange:L=>x(L.target.value),children:[M.jsx("option",{value:"text",children:"Extração de texto"}),M.jsx("option",{value:"ocr",children:"Extração OCR (em implementação)"}),M.jsx("option",{value:"both",children:"Escolha por área"})]}),m.length>0&&M.jsx("button",{"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Excluir todas as áreas",className:"menu-btn menu-btn-warning",onClick:N,children:M.jsx(ax,{size:24})}),M.jsx("span",{"data-bs-placement":"top","data-bs-toggle":"tooltip","data-bs-title":"Ajuda",children:M.jsx("button",{className:"menu-btn","data-bs-toggle":"modal","data-bs-target":"#helpModal",children:M.jsx(cz,{size:24})})}),M.jsx("button",{"data-bs-title":"Presets","data-bs-toggle":"tooltip","data-bs-target":"tooltip",className:"menu-btn",onClick:S,children:M.jsx(gz,{size:24})}),M.jsxs("div",{className:"btn-group",children:[M.jsx("button",{type:"button","data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-trigger":"hover","data-bs-title":"Adicionar área",className:"menu-btn",onClick:()=>s(),children:M.jsx(_z,{size:24})}),M.jsx("button",{className:"menu-btn dropdown-toggle dropdown-toggle-split",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:M.jsx("span",{className:"visually-hidden",children:"Toggle Dropdown"})}),M.jsxs("ul",{className:"dropdown-menu",id:"add-area-dropdown",style:{zIndex:1001},children:[j_.filter(L=>!m.find(I=>I.dataType===L)).map((L,I)=>M.jsx("li",{children:M.jsx("button",{className:"dropdown-item",type:"button","data-bs-dismiss":"dropdown",onClick:()=>s(L),children:Tu[L]})},`list-item${I}`)),M.jsx("div",{className:"dropdown-divider"}),M.jsx("li",{children:M.jsx("button",{className:"dropdown-item",onClick:D,disabled:j_.some(L=>m.find(I=>I.dataType===L)),children:"Criar todos ausentes"})})]})]})]}),m.length===0&&M.jsx("p",{className:"text-muted",children:"Adicione uma área para começar!"}),M.jsx(vX,{onDragEnd:l,children:M.jsx(iY,{droppableId:"areas",children:L=>M.jsxs("div",{className:"areas-container",...L.droppableProps,ref:L.innerRef,children:[m.map((I,z)=>M.jsx(FX,{draggableId:I.id,index:z,children:j=>M.jsx("div",{ref:j.innerRef,...j.draggableProps,...j.dragHandleProps,children:M.jsx(jz,{area:I,areas:m,hasFile:g,extractionMode:y,onStartSelection:t,onClearArea:r,onDeleteArea:e,onRenameArea:i,onToggleMandatory:u,onToggleRepeat:f,onChangeAreaType:d,onToggleAreaOCR:p},I.id)})},I.id)),L.placeholder]})})}),M.jsx(zH,{isOpen:_,onClose:()=>b(!1),currentAreas:m,onLoadPreset:a})]})}const aY=(n,t,e)=>{const r={id:`area-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,name:c0(e?Tu[e]:"Nova Área",n),order:n.length+1,color:dY(n),coordinates:null,isMandatory:e?sL.includes(e):!1,repeatInPages:e?rL.includes(e):!1,dataType:e,ocr:t};return[...n,r]},oY=(n,t)=>n.filter(e=>e.id!==t).map((e,i)=>({...e,order:i+1})),lY=(n,t,e)=>{if(e.trim().toLowerCase()==="pagenumber")return alert('Nome "pageNumber" é reservado. Use outro nome.'),n;const i=c0(e,n);return n.map(r=>r.id===t?{...r,name:i}:r)},cY=(n,t)=>n.map(e=>e.id===t?{...e,coordinates:null}:e),P4=n=>Object.values(Tu).includes(n)||/^Nova Área( \(\d+\))?$/.test(n),uY=(n,t,e)=>n.map(i=>i.id===t?{...i,coordinates:e}:i),c0=(n,t)=>{let e=2,i=n;for(;t.some(r=>r.name===i);)i=`${n} (${e})`,e++;return i},fY=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F97316","#84CC16","#6B7280","#DC2626","#059669","#7C3AED","#BE123C","#0369A1"],dY=n=>{const t=n.map(e=>e.color);return fY.find(e=>!t.includes(e))??"#000000"},B4=(n,t)=>{const e=n.map(r=>({id:r.id,name:r.name,dataType:r.dataType,coordinates:r.coordinates,isMandatory:r.isMandatory,repeatInPages:r.repeatInPages,ocr:r.ocr})),i=t?{name:t.name,size:t.size,lastModified:t.lastModified,type:t.type}:null;return JSON.stringify({areas:e,file:i})},hY=({areasMenu:n,extractMenu:t,areas:e})=>M.jsxs("div",{className:"card mt-2",children:[M.jsx("div",{className:"card-header",children:M.jsx("h4",{className:"card-title",children:"Extrator de dados de PDF"})}),M.jsx("div",{className:"card-body",children:n}),e.length>0&&M.jsx("div",{className:"card-footer",children:t})]});var ib={exports:{}},j4;function pY(){return j4||(j4=1,function(n){var t=function(e){var i=Object.prototype,r=i.hasOwnProperty,s=Object.defineProperty||function(at,P,X){at[P]=X.value},a,l=typeof Symbol=="function"?Symbol:{},u=l.iterator||"@@iterator",f=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function p(at,P,X){return Object.defineProperty(at,P,{value:X,enumerable:!0,configurable:!0,writable:!0}),at[P]}try{p({},"")}catch{p=function(P,X,V){return P[X]=V}}function m(at,P,X,V){var it=P&&P.prototype instanceof A?P:A,ht=Object.create(it.prototype),yt=new K(V||[]);return s(ht,"_invoke",{value:B(at,X,yt)}),ht}e.wrap=m;function g(at,P,X){try{return{type:"normal",arg:at.call(P,X)}}catch(V){return{type:"throw",arg:V}}}var y="suspendedStart",x="suspendedYield",_="executing",b="completed",S={};function A(){}function C(){}function O(){}var N={};p(N,u,function(){return this});var D=Object.getPrototypeOf,L=D&&D(D(q([])));L&&L!==i&&r.call(L,u)&&(N=L);var I=O.prototype=A.prototype=Object.create(N);C.prototype=O,s(I,"constructor",{value:O,configurable:!0}),s(O,"constructor",{value:C,configurable:!0}),C.displayName=p(O,d,"GeneratorFunction");function z(at){["next","throw","return"].forEach(function(P){p(at,P,function(X){return this._invoke(P,X)})})}e.isGeneratorFunction=function(at){var P=typeof at=="function"&&at.constructor;return P?P===C||(P.displayName||P.name)==="GeneratorFunction":!1},e.mark=function(at){return Object.setPrototypeOf?Object.setPrototypeOf(at,O):(at.__proto__=O,p(at,d,"GeneratorFunction")),at.prototype=Object.create(I),at},e.awrap=function(at){return{__await:at}};function j(at,P){function X(ht,yt,Rt,Et){var G=g(at[ht],at,yt);if(G.type==="throw")Et(G.arg);else{var lt=G.arg,rt=lt.value;return rt&&typeof rt=="object"&&r.call(rt,"__await")?P.resolve(rt.__await).then(function(ot){X("next",ot,Rt,Et)},function(ot){X("throw",ot,Rt,Et)}):P.resolve(rt).then(function(ot){lt.value=ot,Rt(lt)},function(ot){return X("throw",ot,Rt,Et)})}}var V;function it(ht,yt){function Rt(){return new P(function(Et,G){X(ht,yt,Et,G)})}return V=V?V.then(Rt,Rt):Rt()}s(this,"_invoke",{value:it})}z(j.prototype),p(j.prototype,f,function(){return this}),e.AsyncIterator=j,e.async=function(at,P,X,V,it){it===void 0&&(it=Promise);var ht=new j(m(at,P,X,V),it);return e.isGeneratorFunction(P)?ht:ht.next().then(function(yt){return yt.done?yt.value:ht.next()})};function B(at,P,X){var V=y;return function(ht,yt){if(V===_)throw new Error("Generator is already running");if(V===b){if(ht==="throw")throw yt;return _t()}for(X.method=ht,X.arg=yt;;){var Rt=X.delegate;if(Rt){var Et=tt(Rt,X);if(Et){if(Et===S)continue;return Et}}if(X.method==="next")X.sent=X._sent=X.arg;else if(X.method==="throw"){if(V===y)throw V=b,X.arg;X.dispatchException(X.arg)}else X.method==="return"&&X.abrupt("return",X.arg);V=_;var G=g(at,P,X);if(G.type==="normal"){if(V=X.done?b:x,G.arg===S)continue;return{value:G.arg,done:X.done}}else G.type==="throw"&&(V=b,X.method="throw",X.arg=G.arg)}}}function tt(at,P){var X=P.method,V=at.iterator[X];if(V===a)return P.delegate=null,X==="throw"&&at.iterator.return&&(P.method="return",P.arg=a,tt(at,P),P.method==="throw")||X!=="return"&&(P.method="throw",P.arg=new TypeError("The iterator does not provide a '"+X+"' method")),S;var it=g(V,at.iterator,P.arg);if(it.type==="throw")return P.method="throw",P.arg=it.arg,P.delegate=null,S;var ht=it.arg;if(!ht)return P.method="throw",P.arg=new TypeError("iterator result is not an object"),P.delegate=null,S;if(ht.done)P[at.resultName]=ht.value,P.next=at.nextLoc,P.method!=="return"&&(P.method="next",P.arg=a);else return ht;return P.delegate=null,S}z(I),p(I,d,"Generator"),p(I,u,function(){return this}),p(I,"toString",function(){return"[object Generator]"});function k(at){var P={tryLoc:at[0]};1 in at&&(P.catchLoc=at[1]),2 in at&&(P.finallyLoc=at[2],P.afterLoc=at[3]),this.tryEntries.push(P)}function et(at){var P=at.completion||{};P.type="normal",delete P.arg,at.completion=P}function K(at){this.tryEntries=[{tryLoc:"root"}],at.forEach(k,this),this.reset(!0)}e.keys=function(at){var P=Object(at),X=[];for(var V in P)X.push(V);return X.reverse(),function it(){for(;X.length;){var ht=X.pop();if(ht in P)return it.value=ht,it.done=!1,it}return it.done=!0,it}};function q(at){if(at){var P=at[u];if(P)return P.call(at);if(typeof at.next=="function")return at;if(!isNaN(at.length)){var X=-1,V=function it(){for(;++X<at.length;)if(r.call(at,X))return it.value=at[X],it.done=!1,it;return it.value=a,it.done=!0,it};return V.next=V}}return{next:_t}}e.values=q;function _t(){return{value:a,done:!0}}return K.prototype={constructor:K,reset:function(at){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(et),!at)for(var P in this)P.charAt(0)==="t"&&r.call(this,P)&&!isNaN(+P.slice(1))&&(this[P]=a)},stop:function(){this.done=!0;var at=this.tryEntries[0],P=at.completion;if(P.type==="throw")throw P.arg;return this.rval},dispatchException:function(at){if(this.done)throw at;var P=this;function X(Et,G){return ht.type="throw",ht.arg=at,P.next=Et,G&&(P.method="next",P.arg=a),!!G}for(var V=this.tryEntries.length-1;V>=0;--V){var it=this.tryEntries[V],ht=it.completion;if(it.tryLoc==="root")return X("end");if(it.tryLoc<=this.prev){var yt=r.call(it,"catchLoc"),Rt=r.call(it,"finallyLoc");if(yt&&Rt){if(this.prev<it.catchLoc)return X(it.catchLoc,!0);if(this.prev<it.finallyLoc)return X(it.finallyLoc)}else if(yt){if(this.prev<it.catchLoc)return X(it.catchLoc,!0)}else if(Rt){if(this.prev<it.finallyLoc)return X(it.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(at,P){for(var X=this.tryEntries.length-1;X>=0;--X){var V=this.tryEntries[X];if(V.tryLoc<=this.prev&&r.call(V,"finallyLoc")&&this.prev<V.finallyLoc){var it=V;break}}it&&(at==="break"||at==="continue")&&it.tryLoc<=P&&P<=it.finallyLoc&&(it=null);var ht=it?it.completion:{};return ht.type=at,ht.arg=P,it?(this.method="next",this.next=it.finallyLoc,S):this.complete(ht)},complete:function(at,P){if(at.type==="throw")throw at.arg;return at.type==="break"||at.type==="continue"?this.next=at.arg:at.type==="return"?(this.rval=this.arg=at.arg,this.method="return",this.next="end"):at.type==="normal"&&P&&(this.next=P),S},finish:function(at){for(var P=this.tryEntries.length-1;P>=0;--P){var X=this.tryEntries[P];if(X.finallyLoc===at)return this.complete(X.completion,X.afterLoc),et(X),S}},catch:function(at){for(var P=this.tryEntries.length-1;P>=0;--P){var X=this.tryEntries[P];if(X.tryLoc===at){var V=X.completion;if(V.type==="throw"){var it=V.arg;et(X)}return it}}throw new Error("illegal catch attempt")},delegateYield:function(at,P,X){return this.delegate={iterator:q(at),resultName:P,nextLoc:X},this.method==="next"&&(this.arg=a),S}},e}(n.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(ib)),ib.exports}var rb,U4;function Z2(){return U4||(U4=1,rb=(n,t)=>`${n}-${t}-${Math.random().toString(16).slice(3,8)}`),rb}var sb,z4;function C5(){if(z4)return sb;z4=1;const n=Z2();let t=0;return sb=({id:e,action:i,payload:r={}})=>{let s=e;return typeof s>"u"&&(s=n("Job",t),t+=1),{id:s,action:i,payload:r}},sb}var mp={},H4;function Q2(){if(H4)return mp;H4=1;let n=!1;return mp.logging=n,mp.setLogging=t=>{n=t},mp.log=(...t)=>n?console.log.apply(this,t):null,mp}var ab,$4;function mY(){if($4)return ab;$4=1;const n=C5(),{log:t}=Q2(),e=Z2();let i=0;return ab=()=>{const r=e("Scheduler",i),s={},a={};let l=[];i+=1;const u=()=>l.length,f=()=>Object.keys(s).length,d=()=>{if(l.length!==0){const x=Object.keys(s);for(let _=0;_<x.length;_+=1)if(typeof a[x[_]]>"u"){l[0](s[x[_]]);break}}},p=(x,_)=>new Promise((b,S)=>{const A=n({action:x,payload:_});l.push(async C=>{l.shift(),a[C.id]=A;try{b(await C[x].apply(this,[..._,A.id]))}catch(O){S(O)}finally{delete a[C.id],d()}}),t(`[${r}]: Add ${A.id} to JobQueue`),t(`[${r}]: JobQueue length=${l.length}`),d()});return{addWorker:x=>(s[x.id]=x,t(`[${r}]: Add ${x.id}`),t(`[${r}]: Number of workers=${f()}`),d(),x.id),addJob:async(x,..._)=>{if(f()===0)throw Error(`[${r}]: You need to have at least one worker before adding jobs`);return p(x,_)},terminate:async()=>{Object.keys(s).forEach(async x=>{await s[x].terminate()}),l=[]},getQueueLen:u,getNumWorkers:f}},ab}function Rp(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ob,G4;function gY(){return G4||(G4=1,ob=n=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof Rp=="function"&&(t.type="node"),typeof n>"u"?t:t[n]}),ob}var lb,V4;function vY(){if(V4)return lb;V4=1;const t=gY()("type")==="browser"?e=>new URL(e,window.location.href).href:e=>e;return lb=e=>{const i={...e};return["corePath","workerPath","langPath"].forEach(r=>{e[r]&&(i[r]=t(i[r]))}),i},lb}var cb,W4;function D5(){return W4||(W4=1,cb={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),cb}const xY="6.0.1",yY={version:xY};var ub,X4;function _Y(){return X4||(X4=1,ub={workerBlobURL:!0,logger:()=>{}}),ub}var fb,Y4;function bY(){if(Y4)return fb;Y4=1;const n=yY.version;return fb={..._Y(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},fb}var db,q4;function wY(){return q4||(q4=1,db=({workerPath:n,workerBlobURL:t})=>{let e;if(Blob&&URL&&t){const i=new Blob([`importScripts("${n}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(i))}else e=new Worker(n);return e}),db}var hb,K4;function EY(){return K4||(K4=1,hb=n=>{n.terminate()}),hb}var pb,Z4;function AY(){return Z4||(Z4=1,pb=(n,t)=>{n.onmessage=({data:e})=>{t(e)}}),pb}var mb,Q4;function SY(){return Q4||(Q4=1,mb=async(n,t)=>{n.postMessage(t)}),mb}var gb,J4;function TY(){if(J4)return gb;J4=1;const n=e=>new Promise((i,r)=>{const s=new FileReader;s.onload=()=>{i(s.result)},s.onerror=({target:{error:{code:a}}})=>{r(Error(`File could not be read! Code=${a}`))},s.readAsArrayBuffer(e)}),t=async e=>{let i=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?i=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):i=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(i=await t(e.src)),e.tagName==="VIDEO"&&(i=await t(e.poster)),e.tagName==="CANVAS"&&await new Promise(r=>{e.toBlob(async s=>{i=await n(s),r()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const r=await e.convertToBlob();i=await n(r)}else(e instanceof File||e instanceof Blob)&&(i=await n(e));return new Uint8Array(i)};return gb=t,gb}var vb,t3;function CY(){if(t3)return vb;t3=1;const n=bY(),t=wY(),e=EY(),i=AY(),r=SY(),s=TY();return vb={defaultOptions:n,spawnWorker:t,terminateWorker:e,onMessage:i,send:r,loadImage:s},vb}var xb,e3;function O5(){if(e3)return xb;e3=1;const n=vY(),t=C5(),{log:e}=Q2(),i=Z2(),r=D5(),{defaultOptions:s,spawnWorker:a,terminateWorker:l,onMessage:u,loadImage:f,send:d}=CY();let p=0;return xb=async(m="eng",g=r.LSTM_ONLY,y={},x={})=>{const _=i("Worker",p),{logger:b,errorHandler:S,...A}=n({...s,...y}),C={},O=typeof m=="string"?m.split("+"):m;let N=g,D=x;const L=[r.DEFAULT,r.LSTM_ONLY].includes(g)&&!A.legacyCore;let I,z;const j=new Promise((lt,rt)=>{z=lt,I=rt}),B=lt=>{I(lt.message)};let tt=a(A);tt.onerror=B,p+=1;const k=({id:lt,action:rt,payload:ot})=>new Promise((bt,St)=>{e(`[${_}]: Start ${lt}, action=${rt}`);const R=`${rt}-${lt}`;C[R]={resolve:bt,reject:St},d(tt,{workerId:_,jobId:lt,action:rt,payload:ot})}),et=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),K=lt=>k(t({id:lt,action:"load",payload:{options:{lstmOnly:L,corePath:A.corePath,logging:A.logging}}})),q=(lt,rt,ot)=>k(t({id:ot,action:"FS",payload:{method:"writeFile",args:[lt,rt]}})),_t=(lt,rt)=>k(t({id:rt,action:"FS",payload:{method:"readFile",args:[lt,{encoding:"utf8"}]}})),at=(lt,rt)=>k(t({id:rt,action:"FS",payload:{method:"unlink",args:[lt]}})),P=(lt,rt,ot)=>k(t({id:ot,action:"FS",payload:{method:lt,args:rt}})),X=(lt,rt)=>k(t({id:rt,action:"loadLanguage",payload:{langs:lt,options:{langPath:A.langPath,dataPath:A.dataPath,cachePath:A.cachePath,cacheMethod:A.cacheMethod,gzip:A.gzip,lstmOnly:[r.DEFAULT,r.LSTM_ONLY].includes(N)&&!A.legacyLang}}})),V=(lt,rt,ot,bt)=>k(t({id:bt,action:"initialize",payload:{langs:lt,oem:rt,config:ot}})),it=(lt="eng",rt,ot,bt)=>{if(L&&[r.TESSERACT_ONLY,r.TESSERACT_LSTM_COMBINED].includes(rt))throw Error("Legacy model requested but code missing.");const St=rt||N;N=St;const R=ot||D;D=R;const ut=(typeof lt=="string"?lt.split("+"):lt).filter(J=>!O.includes(J));return O.push(...ut),ut.length>0?X(ut,bt).then(()=>V(lt,St,R,bt)):V(lt,St,R,bt)},ht=(lt={},rt)=>k(t({id:rt,action:"setParameters",payload:{params:lt}})),yt=async(lt,rt={},ot={text:!0},bt)=>k(t({id:bt,action:"recognize",payload:{image:await f(lt),options:rt,output:ot}})),Rt=async(lt,rt)=>{if(L)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return k(t({id:rt,action:"detect",payload:{image:await f(lt)}}))},Et=async()=>(tt!==null&&(l(tt),tt=null),Promise.resolve());u(tt,({workerId:lt,jobId:rt,status:ot,action:bt,data:St})=>{const R=`${bt}-${rt}`;if(ot==="resolve")e(`[${lt}]: Complete ${rt}`),C[R].resolve({jobId:rt,data:St}),delete C[R];else if(ot==="reject")if(C[R].reject(St),delete C[R],bt==="load"&&I(St),S)S(St);else throw Error(St);else ot==="progress"&&b({...St,userJobId:rt})});const G={id:_,worker:tt,load:et,writeText:q,readText:_t,removeFile:at,FS:P,reinitialize:it,setParameters:ht,recognize:yt,detect:Rt,terminate:Et};return K().then(()=>X(m)).then(()=>V(m,g,x)).then(()=>z(G)).catch(()=>{}),j},xb}var yb,n3;function DY(){if(n3)return yb;n3=1;const n=O5();return yb={recognize:async(i,r,s)=>{const a=await n(r,1,s);return a.recognize(i).finally(async()=>{await a.terminate()})},detect:async(i,r)=>{const s=await n("osd",0,r);return s.detect(i).finally(async()=>{await s.terminate()})}},yb}var _b,i3;function OY(){return i3||(i3=1,_b={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),_b}var bb,r3;function RY(){return r3||(r3=1,bb={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),bb}var wb,s3;function NY(){if(s3)return wb;s3=1,pY();const n=mY(),t=O5(),e=DY(),i=OY(),r=D5(),s=RY(),{setLogging:a}=Q2();return wb={languages:i,OEM:r,PSM:s,createScheduler:n,createWorker:t,setLogging:a,...e},wb}var LY=NY();const $v=async(n,t)=>{const e=document.createElement("canvas"),i=e.getContext("2d");return e.width=t.width,e.height=t.height,await n.render({canvasContext:i,viewport:t}).promise,e},IY=(n,t)=>{const e=document.createElement("canvas"),i=e.getContext("2d");return e.width=t.width,e.height=t.height,i.drawImage(n,t.x,t.y,t.width,t.height,0,0,t.width,t.height),e},kY=async(n,t)=>{const{data:e}=await t.recognize(n,{},{blocks:!0,text:!0});return e.blocks?.flatMap(r=>r.paragraphs)?.flatMap(r=>r.lines)??[]},MY=n=>{const e=[],i=[];return n.forEach((r,s)=>{const a=r.rowAttributes.rowHeight||20,l=n[s+1];i.push(r.text.trim());const u=s===n.length-1||r.baseline.y0+a*1.3<=l?.baseline.y0;console.log(`Linha ${s}: "${r.text.trim()}" | y0: ${r.baseline.y0} | altura: ${a} | quebra: ${u}`),u&&(e.push(i.join(" ")),console.log("📦 Bloco criado:",i.join(" ")),i.length=0)}),console.log("📋 Resultado final:",e),e},a3=(n,t)=>{let e=[];return t==="geology"?e=MY(n):n.forEach(i=>{e.push(i.text.trim())}),e},Zg=async(n,t,e,i)=>{const r=t.getViewport({scale:2}),s=i||await $v(t,r),a=Op(n,1,2,r),l=IY(s,{x:a.x,y:r.height-a.y-a.height,width:a.width,height:a.height});return await kY(l,e)},FY=async(n,t,e,i)=>{const r=()=>{if(e?.aborted)throw new Error("Extração cancelada pelo usuário")};i?.({stage:"starting",message:"Iniciando extração..."});const s=[],a=n.filter(m=>m.isMandatory&&m.coordinates),l=t.numPages,u=n.find(m=>m.dataType==="hole_id"),f=n.filter(m=>!m.repeatInPages&&m.dataType!=="hole_id"),d=n.some(m=>m.ocr),p=d?await LY.createWorker("por"):null;r();try{let m=null,g=null;d&&(m=new Map,g=async(_,b)=>{if(m.has(b))return m.get(b);const S=_.getViewport({scale:2}),A=await $v(_,S);return m.set(b,A),A}),r();const y=async _=>{if(a.length===0)return!0;const b=await t.getPage(_),S=b.getViewport({scale:1}),A=await b.getTextContent();for(const C of a)if(C.ocr){if(!b||!p||!C.coordinates)continue;if((await Zg(C.coordinates,b,p)).every(N=>!N.text.trim()))return!1}else{const O=Op(C.coordinates,1,1,S),N=Gg(A,O);if(!Vg(N,[]).join(" ").trim())return!1}return!0},x=[];for(let _=1;_<=l;_++)r(),i?.({stage:"validating",message:`Verificando páginas obrigatórias ${_}/${l}`}),await y(_)&&x.push(_);if(u&&u.coordinates){const _=u.name,b=[],S=[],A=[];let C=0;for(const N of x){r(),C++,i?.({stage:"hole_ids",message:`Extraindo IDs de sondagem da página ${C}/${x.length}`});const D=await t.getPage(N);let L="";if(u.ocr){if(!p)continue;L=(await Zg(u.coordinates,D,p)).map(z=>z.text.trim()).filter(z=>z).join(" ").trim()}else{const I=await D.getTextContent(),z=D.getViewport({scale:1}),j=Op(u.coordinates,1,1,z),B=Gg(I,j);B.sort((tt,k)=>k.transform[5]-tt.transform[5]),L=Vg(B,[]).join(" ").trim()}if(b.push({page:N,holeId:L}),L){const I=s.find(z=>z[_]&&Array.isArray(z[_])&&z[_][0]===L);I?I.pageNumber.push(N):(A.push(L),s.push({pageNumber:[N],[_]:[L]}))}else S.push(N)}const O=n.filter(N=>N.repeatInPages);if(O.length>0){let N=0;for(const D of s){r(),N++,i?.({stage:"repeat_areas",message:`Processando áreas únicas da sondagem ${N}/${s.length}`});const L=D.pageNumber[0],I=await t.getPage(L),z=await I.getOperatorList(),j=await I.getTextContent(),B=I.getViewport({scale:1}),tt=o3(z),k=I.getViewport({scale:2}),et=g?await g(I,L):await $v(I,k);for(const K of O)if(K.coordinates)try{let q=[];if(K.ocr){if(!p)continue;const _t=await Zg(K.coordinates,I,p,et);q=a3(_t,K.dataType)}else{const _t=Op(K.coordinates,1,1,B),at=Gg(j,_t);at.sort((P,X)=>X.transform[5]-P.transform[5]),q=K.dataType==="nspt"?LD(at):Vg(at,tt)}D[K.name]=kD(q,K.dataType)}catch(q){console.error(`Erro ao processar área ${K.name}: ${q}`),D[K.name]=[]}}}}else for(const _ of x)s.push({pageNumber:[_]});if(f.length>0){let _=0;for(const b of s){_++;let S=0;for(const A of b.pageNumber){r(),S++,i?.({stage:"non_repeat_areas",message:`Processando áreas não únicas da sondagem ${_}/${s.length}, página ${S}/${b.pageNumber.length} ...`});const C=await t.getPage(A),O=await C.getOperatorList(),N=await C.getTextContent(),D=C.getViewport({scale:1}),L=o3(O),I=C.getViewport({scale:2}),z=g?await g(C,A):await $v(C,I);for(const j of f)if(j.coordinates)try{let B=[];if(j.ocr){if(!p)continue;const et=await Zg(j.coordinates,C,p,z);B=a3(et,j.dataType)}else{const et=Op(j.coordinates,1,1,D),K=Gg(N,et);K.sort((q,_t)=>_t.transform[5]-q.transform[5]),B=j.dataType==="nspt"?LD(K):Vg(K,L)}const tt=kD(B,j.dataType);b[j.name]||(b[j.name]=[]);const k=b[j.name];if(JN(j.dataType))tt.length>0&&(b[j.name]=tt);else{const et=[...tt];if(k.length>0&&et.length>0){const K=k[k.length-1].trim().toLowerCase().replace(/\s+/g," "),q=et[0].trim().toLowerCase().replace(/\s+/g," ");K===q&&et.shift()}k.push(...et)}}catch(B){console.error(`Erro ao processar área ${j.name}:`,B)}}}}return i?.({stage:"complete",message:"Finalizando extração..."}),s}finally{p&&await p.terminate()}},o3=n=>{const t=[];for(let e=0;e<n.fnArray.length;e++)if(n.fnArray[e]===91){const i=n.argsArray[e][1][0];for(let r=0;r<i.length;r++)if(i[r]===1&&r>=2){const s=i[r-2],a=i[r-1],l=i[r+1],u=i[r+2];Math.abs(a-u)<2&&t.push({x1:Math.min(s,l),x2:Math.max(s,l),y:a})}}return t},PY=({extractedTexts:n,isExtracting:t,fileName:e})=>{const i=n.length>0?Object.keys(n[0]).filter(r=>r!=="pageNumber"):[];return M.jsx("div",{className:"data-panel mt-2",children:t?M.jsxs(M.Fragment,{children:[M.jsx("span",{className:"spinner-border spinner-border-sm me-1"}),e?`Extraindo dados do arquivo ${e}`:"Extraindo..."]}):!n||n.length<=0?M.jsx("div",{children:M.jsx("p",{className:"text-muted",children:"Os dados extraídos serão exibidos aqui"})}):M.jsxs(M.Fragment,{children:[M.jsx("h5",{className:"mb-3 pb-2 border-bottom",children:"Dados Extraídos"}),M.jsx("div",{className:"data-table mb-3",style:{maxHeight:"65vh",overflowY:"auto"},children:M.jsxs("table",{className:"table table-hover",children:[M.jsx("thead",{children:M.jsxs("tr",{children:[M.jsx("th",{scope:"col",style:{minWidth:"100px"},children:"Páginas"}),i.map((r,s)=>M.jsx("th",{scope:"col",style:{minWidth:"100px"},children:r.toString()},`coluna${s}`))]})}),M.jsx("tbody",{children:n.map((r,s)=>M.jsxs("tr",{children:[M.jsx("th",{scope:"row",children:qU(r.pageNumber)}),i.map((a,l)=>{const u=r[a];return M.jsx("td",{children:Array.isArray(u)?u.join(", "):"-"},`area-${l}`)})]},`coluna-pag-${s}`))})]})})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var c1={};c1.version="0.20.3";var ll=1200,u0=function(n){ll=n};function BY(){u0(1200)}var Qg=function(t){return String.fromCharCode(t)},l3=function(t){return String.fromCharCode(t)},br="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function u1(n){for(var t="",e=0,i=0,r=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n.charCodeAt(f++),s=e>>2,i=n.charCodeAt(f++),a=(e&3)<<4|i>>4,r=n.charCodeAt(f++),l=(i&15)<<2|r>>6,u=r&63,isNaN(i)?l=u=64:isNaN(r)&&(u=64),t+=br.charAt(s)+br.charAt(a)+br.charAt(l)+br.charAt(u);return t}function jY(n){for(var t="",e=0,i=0,r=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n.charCodeAt(f++),e>255&&(e=95),s=e>>2,i=n.charCodeAt(f++),i>255&&(i=95),a=(e&3)<<4|i>>4,r=n.charCodeAt(f++),r>255&&(r=95),l=(i&15)<<2|r>>6,u=r&63,isNaN(i)?l=u=64:isNaN(r)&&(u=64),t+=br.charAt(s)+br.charAt(a)+br.charAt(l)+br.charAt(u);return t}function UY(n){for(var t="",e=0,i=0,r=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n[f++],s=e>>2,i=n[f++],a=(e&3)<<4|i>>4,r=n[f++],l=(i&15)<<2|r>>6,u=r&63,isNaN(i)?l=u=64:isNaN(r)&&(u=64),t+=br.charAt(s)+br.charAt(a)+br.charAt(l)+br.charAt(u);return t}function wc(n){var t="",e=0,i=0,r=0,s=0,a=0,l=0,u=0;if(n.slice(0,5)=="data:"){var f=n.slice(0,1024).indexOf(";base64,");f>-1&&(n=n.slice(f+8))}n=n.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<n.length;)s=br.indexOf(n.charAt(f++)),a=br.indexOf(n.charAt(f++)),e=s<<2|a>>4,t+=String.fromCharCode(e),l=br.indexOf(n.charAt(f++)),i=(a&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(i)),u=br.indexOf(n.charAt(f++)),r=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(r));return t}var _n=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),bo=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}(),f1=function(){if(typeof Buffer>"u")return!1;var n=bo([65,0]);if(!n)return!1;var t=n.toString("utf16le");return t.length==1}();function Du(n){return _n?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function c3(n){return _n?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Os=function(t){return _n?bo(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function px(n){if(typeof ArrayBuffer>"u")return Os(n);for(var t=new ArrayBuffer(n.length),e=new Uint8Array(t),i=0;i!=n.length;++i)e[i]=n.charCodeAt(i)&255;return t}function Ou(n){if(Array.isArray(n))return n.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],e=0;e<n.length;++e)t[e]=String.fromCharCode(n[e]);return t.join("")}function zY(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var Si=_n?function(n){return Buffer.concat(n.map(function(t){return Buffer.isBuffer(t)?t:bo(t)}))}:function(n){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<n.length;++t)e+=n[t].length;var i=new Uint8Array(e),r=0;for(t=0,e=0;t<n.length;e+=r,++t)r=n[t].length,n[t]instanceof Uint8Array?i.set(n[t],e):typeof n[t]=="string"?i.set(new Uint8Array(Os(n[t])),e):i.set(new Uint8Array(n[t]),e);return i}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function HY(n){for(var t=[],e=0,i=n.length+250,r=Du(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)r[e++]=a;else if(a<2048)r[e++]=192|a>>6&31,r[e++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=n.charCodeAt(++s)&1023;r[e++]=240|a>>8&7,r[e++]=128|a>>2&63,r[e++]=128|l>>6&15|(a&3)<<4,r[e++]=128|l&63}else r[e++]=224|a>>12&15,r[e++]=128|a>>6&63,r[e++]=128|a&63;e>i&&(t.push(r.slice(0,e)),e=0,r=Du(65535),i=65530)}return t.push(r.slice(0,e)),Si(t)}var zp=/\u0000/g,Jg=/[\u0001-\u0006]/g;function Jf(n){for(var t="",e=n.length-1;e>=0;)t+=n.charAt(e--);return t}function Ia(n,t){var e=""+n;return e.length>=t?e:qn("0",t-e.length)+e}function J2(n,t){var e=""+n;return e.length>=t?e:qn(" ",t-e.length)+e}function d1(n,t){var e=""+n;return e.length>=t?e:e+qn(" ",t-e.length)}function $Y(n,t){var e=""+Math.round(n);return e.length>=t?e:qn("0",t-e.length)+e}function GY(n,t){var e=""+n;return e.length>=t?e:qn("0",t-e.length)+e}var u3=Math.pow(2,32);function Pf(n,t){if(n>u3||n<-u3)return $Y(n,t);var e=Math.round(n);return GY(e,t)}function h1(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var f3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Eb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function VY(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',n}var Gn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},d3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},WY={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function p1(n,t,e){for(var i=n<0?-1:1,r=n*i,s=0,a=1,l=0,u=1,f=0,d=0,p=Math.floor(r);f<t&&(p=Math.floor(r),l=p*a+s,d=p*f+u,!(r-p<5e-8));)r=1/(r-p),s=a,a=l,u=f,f=d;if(d>t&&(f>t?(d=u,l=s):(d=f,l=a)),!e)return[0,i*l,d];var m=Math.floor(i*l/d);return[m,i*l-m*d,d]}function XY(n){var t=n.toPrecision(16);if(t.indexOf("e")>-1){var e=t.slice(0,t.indexOf("e"));return e=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+qn("0",e.length-15),e+t.slice(t.indexOf("e"))}var i=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+qn("0",t.length-15);return Number(i)}function Bf(n,t,e){if(n>2958465||n<0)return null;n=XY(n);var i=n|0,r=Math.floor(86400*(n-i)),s=0,a=[],l={D:i,T:r,u:86400*(n-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(i+=1462),l.u>.9999&&(l.u=0,++r==86400&&(l.T=r=0,++i,++l.D)),i===60)a=e?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=e?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var u=new Date(1900,0,1);u.setDate(u.getDate()+i-1),a=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),i<60&&(s=(s+6)%7),e&&(s=QY(u,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=r%60,r=Math.floor(r/60),l.M=r%60,r=Math.floor(r/60),l.H=r,l.q=s,l}function tA(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function YY(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qY(n){var t=n<0?12:11,e=tA(n.toFixed(12));return e.length<=t||(e=n.toPrecision(10),e.length<=t)?e:n.toExponential(5)}function KY(n){var t=tA(n.toFixed(11));return t.length>(n<0?12:11)||t==="0"||t==="-0"?n.toPrecision(6):t}function ZY(n){if(!isFinite(n))return isNaN(n)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),e;return t>=-4&&t<=-1?e=n.toPrecision(10+t):Math.abs(t)<=9?e=qY(n):t===10?e=n.toFixed(10).substr(0,12):e=KY(n),tA(YY(e.toUpperCase()))}function rE(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):ZY(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return bl(14,sr(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}function QY(n,t){t[0]-=581;var e=n.getDay();return n<60&&(e=(e+6)%7),e}function JY(n,t,e,i){var r="",s=0,a=0,l=e.y,u,f=0;switch(n){case 98:l=e.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=e.m,f=t.length;break;case 3:return Eb[e.m-1][1];case 5:return Eb[e.m-1][0];default:return Eb[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=e.d,f=t.length;break;case 3:return f3[e.q][0];default:return f3[e.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(e.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=e.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=e.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Ia(e.S,t.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(e.S+e.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(r=Ia(s,2+i),t==="ss"?r.substr(0,2):"."+r.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=e.D*24+e.H;break;case"[m]":case"[mm]":u=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":u=((e.D*24+e.H)*60+e.M)*60+(i==0?Math.round(e.S+e.u):e.S);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var d=f>0?Ia(u,f):"";return d}function hc(n){var t=3;if(n.length<=t)return n;for(var e=n.length%t,i=n.substr(0,e);e!=n.length;e+=t)i+=(i.length>0?",":"")+n.substr(e,t);return i}var R5=/%/g;function tq(n,t,e){var i=t.replace(R5,""),r=t.length-i.length;return pl(n,i,e*Math.pow(10,2*r))+qn("%",r)}function eq(n,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return pl(n,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function N5(n,t){var e,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+N5(n,-t);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%r;if(s<0&&(s+=r),e=(t/Math.pow(10,s)).toPrecision(i+1+(r+s)%r),e.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,r)+"."+e.substr(2+r),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(r+s)%r)+"."+d.substr(s)+"E"})}else e=t.toExponential(i);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var L5=/# (\?+)( ?)\/( ?)(\d+)/;function nq(n,t,e){var i=parseInt(n[4],10),r=Math.round(t*i),s=Math.floor(r/i),a=r-s*i,l=i;return e+(s===0?"":""+s)+" "+(a===0?qn(" ",n[1].length+1+n[4].length):J2(a,n[1].length)+n[2]+"/"+n[3]+Ia(l,n[4].length))}function iq(n,t,e){return e+(t===0?"":""+t)+qn(" ",n[1].length+2+n[4].length)}var I5=/^#*0*\.([0#]+)/,k5=/\)[^)]*[0#]/,M5=/\(###\) ###\\?-####/;function jr(n){for(var t="",e,i=0;i!=n.length;++i)switch(e=n.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function h3(n,t){var e=Math.pow(10,t);return""+Math.round(n*e)/e}function p3(n,t){var e=n-Math.floor(n),i=Math.pow(10,t);return t<(""+Math.round(e*i)).length?0:Math.round(e*i)}function rq(n,t){return t<(""+Math.round((n-Math.floor(n))*Math.pow(10,t))).length?1:0}function sq(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function ea(n,t,e){if(n.charCodeAt(0)===40&&!t.match(k5)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?ea("n",i,e):"("+ea("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return eq(n,t,e);if(t.indexOf("%")!==-1)return tq(n,t,e);if(t.indexOf("E")!==-1)return N5(t,e);if(t.charCodeAt(0)===36)return"$"+ea(n,t.substr(t.charAt(1)==" "?2:1),e);var r,s,a,l,u=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+Pf(u,t.length);if(t.match(/^[#?]+$/))return r=Pf(e,0),r==="0"&&(r=""),r.length>t.length?r:jr(t.substr(0,t.length-r.length))+r;if(s=t.match(L5))return nq(s,u,f);if(t.match(/^#+0+$/))return f+Pf(u,t.length-t.indexOf("0"));if(s=t.match(I5))return r=h3(e,s[1].length).replace(/^([^\.]+)$/,"$1."+jr(s[1])).replace(/\.$/,"."+jr(s[1])).replace(/\.(\d*)$/,function(y,x){return"."+x+qn("0",jr(s[1]).length-x.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+h3(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+hc(Pf(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+ea(n,t,-e):hc(""+(Math.floor(e)+rq(e,s[1].length)))+"."+Ia(p3(e,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ea(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Jf(ea(n,t.replace(/[\\-]/g,""),e)),a=0,Jf(Jf(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<r.length?r.charAt(a++):y==="0"?"0":""}));if(t.match(M5))return r=ea(n,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=p1(u,Math.pow(10,a)-1,!1),r=""+f,d=pl("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),r+=d+s[2]+"/"+s[3],d=d1(l[2],a),d.length<s[4].length&&(d=jr(s[4].substr(s[4].length-d.length))+d),r+=d,r;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=p1(u,Math.pow(10,a)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?J2(l[1],a)+s[2]+"/"+s[3]+d1(l[2],a):qn(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return r=Pf(e,0),t.length<=r.length?r:jr(t.substr(0,t.length-r.length))+r;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=r.indexOf(".");var p=t.indexOf(".")-a,m=t.length-r.length-p;return jr(t.substr(0,p)+r+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=p3(e,s[1].length),e<0?"-"+ea(n,t,-e):hc(sq(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ia(0,3-y.length):"")+y})+"."+Ia(a,s[1].length);switch(t){case"###,##0.00":return ea(n,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var g=hc(Pf(u,0));return g!=="0"?f+g:"";case"###,###.00":return ea(n,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return ea(n,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function aq(n,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return pl(n,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function oq(n,t,e){var i=t.replace(R5,""),r=t.length-i.length;return pl(n,i,e*Math.pow(10,2*r))+qn("%",r)}function F5(n,t){var e,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+F5(n,-t);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%r;if(s<0&&(s+=r),e=(t/Math.pow(10,s)).toPrecision(i+1+(r+s)%r),!e.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(r+s)%r)+"."+d.substr(s)+"E"})}else e=t.toExponential(i);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function lo(n,t,e){if(n.charCodeAt(0)===40&&!t.match(k5)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?lo("n",i,e):"("+lo("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return aq(n,t,e);if(t.indexOf("%")!==-1)return oq(n,t,e);if(t.indexOf("E")!==-1)return F5(t,e);if(t.charCodeAt(0)===36)return"$"+lo(n,t.substr(t.charAt(1)==" "?2:1),e);var r,s,a,l,u=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+Ia(u,t.length);if(t.match(/^[#?]+$/))return r=""+e,e===0&&(r=""),r.length>t.length?r:jr(t.substr(0,t.length-r.length))+r;if(s=t.match(L5))return iq(s,u,f);if(t.match(/^#+0+$/))return f+Ia(u,t.length-t.indexOf("0"));if(s=t.match(I5))return r=(""+e).replace(/^([^\.]+)$/,"$1."+jr(s[1])).replace(/\.$/,"."+jr(s[1])),r=r.replace(/\.(\d*)$/,function(y,x){return"."+x+qn("0",jr(s[1]).length-x.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+hc(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+lo(n,t,-e):hc(""+e)+"."+qn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return lo(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Jf(lo(n,t.replace(/[\\-]/g,""),e)),a=0,Jf(Jf(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return a<r.length?r.charAt(a++):y==="0"?"0":""}));if(t.match(M5))return r=lo(n,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=p1(u,Math.pow(10,a)-1,!1),r=""+f,d=pl("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),r+=d+s[2]+"/"+s[3],d=d1(l[2],a),d.length<s[4].length&&(d=jr(s[4].substr(s[4].length-d.length))+d),r+=d,r;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=p1(u,Math.pow(10,a)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?J2(l[1],a)+s[2]+"/"+s[3]+d1(l[2],a):qn(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return r=""+e,t.length<=r.length?r:jr(t.substr(0,t.length-r.length))+r;if(s=t.match(/^([#0]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=r.indexOf(".");var p=t.indexOf(".")-a,m=t.length-r.length-p;return jr(t.substr(0,p)+r+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+lo(n,t,-e):hc(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ia(0,3-y.length):"")+y})+"."+Ia(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=hc(""+u);return g!=="0"?f+g:"";default:if(t.match(/\.[0#?]*$/))return lo(n,t.slice(0,t.lastIndexOf(".")),e)+jr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function pl(n,t,e){return(e|0)===e?lo(n,t,e):ea(n,t,e)}function lq(n){for(var t=[],e=!1,i=0,r=0;i<n.length;++i)switch(n.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=n.substr(r,i-r),r=i+1}if(t[t.length]=n.substr(r),e===!0)throw new Error("Format |"+n+"| unterminated string ");return t}var P5=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ru(n){for(var t=0,e="",i="";t<n.length;)switch(e=n.charAt(t)){case"G":h1(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(i=e;n.charAt(t++)!=="]"&&t<n.length;)i+=n.charAt(t);if(i.match(P5))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(e=n.charAt(++t))>-1||e=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===e;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function cq(n,t,e,i){for(var r=[],s="",a=0,l="",u="t",f,d,p,m="H";a<n.length;)switch(l=n.charAt(a)){case"G":if(!h1(n,a))throw new Error("unrecognized character "+l+" in "+n);r[r.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(p);r[r.length]={t:"t",v:s},++a;break;case"\\":var g=n.charAt(++a),y=g==="("||g===")"?g:"t";r[r.length]={t:y,v:g},++a;break;case"_":r[r.length]={t:"t",v:" "},a+=2;break;case"@":r[r.length]={t:"T",v:t},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(f==null&&(f=Bf(t,e,n.charAt(a+1)==="2"),f==null))return"";r[r.length]={t:"X",v:n.substr(a,2)},u=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Bf(t,e),f==null))return"";for(s=l;++a<n.length&&n.charAt(a).toLowerCase()===l;)s+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),r[r.length]={t:l,v:s},u=l;break;case"A":case"a":case"上":var x={t:l,v:l};if(f==null&&(f=Bf(t,e)),n.substr(a,3).toUpperCase()==="A/P"?(f!=null&&(x.v=f.H>=12?n.charAt(a+2):l),x.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(f!=null&&(x.v=f.H>=12?"PM":"AM"),x.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="上午/下午"?(f!=null&&(x.v=f.H>=12?"下午":"上午"),x.t="T",a+=5,m="h"):(x.t="t",++a),f==null&&x.t==="T")return"";r[r.length]=x,u=l;break;case"[":for(s=l;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(P5)){if(f==null&&(f=Bf(t,e),f==null))return"";r[r.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ru(n)||(r[r.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=l;++a<n.length&&(l=n.charAt(a))==="0";)s+=l;r[r.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++a<n.length&&"0#?.,E+-%".indexOf(l=n.charAt(a))>-1;)s+=l;r[r.length]={t:"n",v:s};break;case"?":for(s=l;n.charAt(++a)===l;)s+=l;r[r.length]={t:l,v:s},u=l;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":r[r.length]={t:i===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);r[r.length]={t:"D",v:s};break;case" ":r[r.length]={t:l,v:l},++a;break;case"$":r[r.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+n);r[r.length]={t:"t",v:l},++a;break}var _=0,b=0,S;for(a=r.length-1,u="t";a>=0;--a)switch(r[a].t){case"h":case"H":r[a].t=m,u="h",_<1&&(_=1);break;case"s":(S=r[a].v.match(/\.0+$/))&&(b=Math.max(b,S[0].length-1),_=4),_<3&&(_=3);case"d":case"y":case"e":u=r[a].t;break;case"M":u=r[a].t,_<2&&(_=2);break;case"m":u==="s"&&(r[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&r[a].v.match(/[Hh]/)&&(_=1),_<2&&r[a].v.match(/[Mm]/)&&(_=2),_<3&&r[a].v.match(/[Ss]/)&&(_=3)}var A;switch(_){case 0:break;case 1:case 2:case 3:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H),f.H>=24&&(f.H=0,++f.D,A=Bf(f.D),A.u=f.u,A.S=f.S,A.M=f.M,A.H=f.H,f=A);break;case 4:switch(b){case 1:f.u=Math.round(f.u*10)/10;break;case 2:f.u=Math.round(f.u*100)/100;break;case 3:f.u=Math.round(f.u*1e3)/1e3;break}f.u>=1&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H),f.H>=24&&(f.H=0,++f.D,A=Bf(f.D),A.u=f.u,A.S=f.S,A.M=f.M,A.H=f.H,f=A);break}var C="",O;for(a=0;a<r.length;++a)switch(r[a].t){case"t":case"T":case" ":case"D":break;case"X":r[a].v="",r[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[a].v=JY(r[a].t.charCodeAt(0),r[a].v,f,b),r[a].t="t";break;case"n":case"?":for(O=a+1;r[O]!=null&&((l=r[O].t)==="?"||l==="D"||(l===" "||l==="t")&&r[O+1]!=null&&(r[O+1].t==="?"||r[O+1].t==="t"&&r[O+1].v==="/")||r[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(r[O].v==="/"||r[O].v===" "&&r[O+1]!=null&&r[O+1].t=="?"));)r[a].v+=r[O].v,r[O]={v:"",t:";"},++O;C+=r[a].v,a=O-1;break;case"G":r[a].t="t",r[a].v=rE(t,e);break}var N="",D,L;if(C.length>0){C.charCodeAt(0)==40?(D=t<0&&C.charCodeAt(0)===45?-t:t,L=pl("n",C,D)):(D=t<0&&i>1?-t:t,L=pl("n",C,D),D<0&&r[0]&&r[0].t=="t"&&(L=L.substr(1),r[0].v="-"+r[0].v)),O=L.length-1;var I=r.length;for(a=0;a<r.length;++a)if(r[a]!=null&&r[a].t!="t"&&r[a].v.indexOf(".")>-1){I=a;break}var z=r.length;if(I===r.length&&L.indexOf("E")===-1){for(a=r.length-1;a>=0;--a)r[a]==null||"n?".indexOf(r[a].t)===-1||(O>=r[a].v.length-1?(O-=r[a].v.length,r[a].v=L.substr(O+1,r[a].v.length)):O<0?r[a].v="":(r[a].v=L.substr(0,O+1),O=-1),r[a].t="t",z=a);O>=0&&z<r.length&&(r[z].v=L.substr(0,O+1)+r[z].v)}else if(I!==r.length&&L.indexOf("E")===-1){for(O=L.indexOf(".")-1,a=I;a>=0;--a)if(!(r[a]==null||"n?".indexOf(r[a].t)===-1)){for(d=r[a].v.indexOf(".")>-1&&a===I?r[a].v.indexOf(".")-1:r[a].v.length-1,N=r[a].v.substr(d+1);d>=0;--d)O>=0&&(r[a].v.charAt(d)==="0"||r[a].v.charAt(d)==="#")&&(N=L.charAt(O--)+N);r[a].v=N,r[a].t="t",z=a}for(O>=0&&z<r.length&&(r[z].v=L.substr(0,O+1)+r[z].v),O=L.indexOf(".")+1,a=I;a<r.length;++a)if(!(r[a]==null||"n?(".indexOf(r[a].t)===-1&&a!==I)){for(d=r[a].v.indexOf(".")>-1&&a===I?r[a].v.indexOf(".")+1:0,N=r[a].v.substr(0,d);d<r[a].v.length;++d)O<L.length&&(N+=L.charAt(O++));r[a].v=N,r[a].t="t",z=a}}}for(a=0;a<r.length;++a)r[a]!=null&&"n?".indexOf(r[a].t)>-1&&(D=i>1&&t<0&&a>0&&r[a-1].v==="-"?-t:t,r[a].v=pl(r[a].t,r[a].v,D),r[a].t="t");var j="";for(a=0;a!==r.length;++a)r[a]!=null&&(j+=r[a].v);return j}var m3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function g3(n,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(n==e)return!0;break;case">":if(n>e)return!0;break;case"<":if(n<e)return!0;break;case"<>":if(n!=e)return!0;break;case">=":if(n>=e)return!0;break;case"<=":if(n<=e)return!0;break}return!1}function uq(n,t){var e=lq(n),i=e.length,r=e[i-1].indexOf("@");if(i<4&&r>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||r>-1?e[e.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),e.length){case 1:e=r>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=r>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=r>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var s=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,s];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var a=e[0].match(m3),l=e[1].match(m3);return g3(t,a)?[i,e[0]]:g3(t,l)?[i,e[1]]:[i,e[a!=null&&l!=null?2:1]]}return[i,s]}function bl(n,t,e){e==null&&(e={});var i="";switch(typeof n){case"string":n=="m/d/yy"&&e.dateNF?i=e.dateNF:i=n;break;case"number":n==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:Gn)[n],i==null&&(i=e.table&&e.table[d3[n]]||Gn[d3[n]]),i==null&&(i=WY[n]||"General");break}if(h1(i,0))return rE(t,e);t instanceof Date&&(t=sr(t,e.date1904));var r=uq(i,t);if(h1(r[1]))return rE(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&r[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&r[1].indexOf("0")>-1)return"#DIV/0!"}return cq(r[1],t,e,r[0])}function B5(n,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(Gn[e]==null){t<0&&(t=e);continue}if(Gn[e]==n){t=e;break}}t<0&&(t=391)}return Gn[t]=n,t}function mx(n){for(var t=0;t!=392;++t)n[t]!==void 0&&B5(n[t],t)}function gx(){Gn=VY()}var m1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fq(n){var t=typeof n=="number"?Gn[n]:n;return t=t.replace(m1,"(\\d+)"),m1.lastIndex=0,new RegExp("^"+t+"$")}function dq(n,t,e){var i=-1,r=-1,s=-1,a=-1,l=-1,u=-1;(t.match(m1)||[]).forEach(function(p,m){var g=parseInt(e[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":i=g;break;case"d":s=g;break;case"h":a=g;break;case"s":u=g;break;case"m":a>=0?l=g:r=g;break}}),m1.lastIndex=0,u>=0&&l==-1&&r>=0&&(l=r,r=-1);var f=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return a==-1&&l==-1&&u==-1?f:i==-1&&r==-1&&s==-1?d:f+"T"+d}var hq={"d.m":"d\\.m"};function pq(n,t){return B5(hq[n]||n,t)}var v3=function(){var n={};n.version="1.2.0";function t(){for(var D=0,L=new Array(256),I=0;I!=256;++I)D=I,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,L[I]=D;return typeof Int32Array<"u"?new Int32Array(L):L}var e=t();function i(D){var L=0,I=0,z=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(z=0;z!=256;++z)j[z]=D[z];for(z=0;z!=256;++z)for(I=D[z],L=256+z;L<4096;L+=256)I=j[L]=I>>>8^D[I&255];var B=[];for(z=1;z!=16;++z)B[z-1]=typeof Int32Array<"u"&&typeof j.subarray=="function"?j.subarray(z*256,z*256+256):j.slice(z*256,z*256+256);return B}var r=i(e),s=r[0],a=r[1],l=r[2],u=r[3],f=r[4],d=r[5],p=r[6],m=r[7],g=r[8],y=r[9],x=r[10],_=r[11],b=r[12],S=r[13],A=r[14];function C(D,L){for(var I=L^-1,z=0,j=D.length;z<j;)I=I>>>8^e[(I^D.charCodeAt(z++))&255];return~I}function O(D,L){for(var I=L^-1,z=D.length-15,j=0;j<z;)I=A[D[j++]^I&255]^S[D[j++]^I>>8&255]^b[D[j++]^I>>16&255]^_[D[j++]^I>>>24]^x[D[j++]]^y[D[j++]]^g[D[j++]]^m[D[j++]]^p[D[j++]]^d[D[j++]]^f[D[j++]]^u[D[j++]]^l[D[j++]]^a[D[j++]]^s[D[j++]]^e[D[j++]];for(z+=15;j<z;)I=I>>>8^e[(I^D[j++])&255];return~I}function N(D,L){for(var I=L^-1,z=0,j=D.length,B=0,tt=0;z<j;)B=D.charCodeAt(z++),B<128?I=I>>>8^e[(I^B)&255]:B<2048?(I=I>>>8^e[(I^(192|B>>6&31))&255],I=I>>>8^e[(I^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,tt=D.charCodeAt(z++)&1023,I=I>>>8^e[(I^(240|B>>8&7))&255],I=I>>>8^e[(I^(128|B>>2&63))&255],I=I>>>8^e[(I^(128|tt>>6&15|(B&3)<<4))&255],I=I>>>8^e[(I^(128|tt&63))&255]):(I=I>>>8^e[(I^(224|B>>12&15))&255],I=I>>>8^e[(I^(128|B>>6&63))&255],I=I>>>8^e[(I^(128|B&63))&255]);return~I}return n.table=e,n.bstr=C,n.buf=O,n.str=N,n}(),Un=function(){var t={};t.version="1.2.2";function e(Y,dt){for(var st=Y.split("/"),ct=dt.split("/"),ft=0,pt=0,Ft=Math.min(st.length,ct.length);ft<Ft;++ft){if(pt=st[ft].length-ct[ft].length)return pt;if(st[ft]!=ct[ft])return st[ft]<ct[ft]?-1:1}return st.length-ct.length}function i(Y){if(Y.charAt(Y.length-1)=="/")return Y.slice(0,-1).indexOf("/")===-1?Y:i(Y.slice(0,-1));var dt=Y.lastIndexOf("/");return dt===-1?Y:Y.slice(0,dt+1)}function r(Y){if(Y.charAt(Y.length-1)=="/")return r(Y.slice(0,-1));var dt=Y.lastIndexOf("/");return dt===-1?Y:Y.slice(dt+1)}function s(Y,dt){typeof dt=="string"&&(dt=new Date(dt));var st=dt.getHours();st=st<<6|dt.getMinutes(),st=st<<5|dt.getSeconds()>>>1,Y.write_shift(2,st);var ct=dt.getFullYear()-1980;ct=ct<<4|dt.getMonth()+1,ct=ct<<5|dt.getDate(),Y.write_shift(2,ct)}function a(Y){var dt=Y.read_shift(2)&65535,st=Y.read_shift(2)&65535,ct=new Date,ft=st&31;st>>>=5;var pt=st&15;st>>>=4,ct.setMilliseconds(0),ct.setFullYear(st+1980),ct.setMonth(pt-1),ct.setDate(ft);var Ft=dt&31;dt>>>=5;var $t=dt&63;return dt>>>=6,ct.setHours(dt),ct.setMinutes($t),ct.setSeconds(Ft<<1),ct}function l(Y){Ur(Y,0);for(var dt={},st=0;Y.l<=Y.length-4;){var ct=Y.read_shift(2),ft=Y.read_shift(2),pt=Y.l+ft,Ft={};switch(ct){case 21589:st=Y.read_shift(1),st&1&&(Ft.mtime=Y.read_shift(4)),ft>5&&(st&2&&(Ft.atime=Y.read_shift(4)),st&4&&(Ft.ctime=Y.read_shift(4))),Ft.mtime&&(Ft.mt=new Date(Ft.mtime*1e3));break;case 1:{var $t=Y.read_shift(4),Tt=Y.read_shift(4);Ft.usz=Tt*Math.pow(2,32)+$t,$t=Y.read_shift(4),Tt=Y.read_shift(4),Ft.csz=Tt*Math.pow(2,32)+$t}break}Y.l=pt,dt[ct]=Ft}return dt}var u;function f(){return u||(u=mq)}function d(Y,dt){if(Y[0]==80&&Y[1]==75)return wo(Y,dt);if((Y[0]|32)==109&&(Y[1]|32)==105)return Pa(Y,dt);if(Y.length<512)throw new Error("CFB file size "+Y.length+" < 512");var st=3,ct=512,ft=0,pt=0,Ft=0,$t=0,Tt=0,Lt=[],It=Y.slice(0,512);Ur(It,0);var Wt=p(It);switch(st=Wt[0],st){case 3:ct=512;break;case 4:ct=4096;break;case 0:if(Wt[1]==0)return wo(Y,dt);default:throw new Error("Major Version: Expected 3 or 4 saw "+st)}ct!==512&&(It=Y.slice(0,ct),Ur(It,28));var ee=Y.slice(0,ct);m(It,st);var ue=It.read_shift(4,"i");if(st===3&&ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ue);It.l+=4,Ft=It.read_shift(4,"i"),It.l+=4,It.chk("00100000","Mini Stream Cutoff Size: "),$t=It.read_shift(4,"i"),ft=It.read_shift(4,"i"),Tt=It.read_shift(4,"i"),pt=It.read_shift(4,"i");for(var Qt=-1,ie=0;ie<109&&(Qt=It.read_shift(4,"i"),!(Qt<0));++ie)Lt[ie]=Qt;var je=g(Y,ct);_(Tt,pt,je,ct,Lt);var hn=S(je,Ft,Lt,ct);Ft<hn.length&&(hn[Ft].name="!Directory"),ft>0&&$t!==tt&&(hn[$t].name="!MiniFAT"),hn[Lt[0]].name="!FAT",hn.fat_addrs=Lt,hn.ssz=ct;var an={},wn=[],ps=[],zs=[];A(Ft,hn,je,wn,ft,an,ps,$t),y(ps,zs,wn),wn.shift();var Sr={FileIndex:ps,FullPaths:zs};return dt&&dt.raw&&(Sr.raw={header:ee,sectors:je}),Sr}function p(Y){if(Y[Y.l]==80&&Y[Y.l+1]==75)return[0,0];Y.chk(k,"Header Signature: "),Y.l+=16;var dt=Y.read_shift(2,"u");return[Y.read_shift(2,"u"),dt]}function m(Y,dt){var st=9;switch(Y.l+=2,st=Y.read_shift(2)){case 9:if(dt!=3)throw new Error("Sector Shift: Expected 9 saw "+st);break;case 12:if(dt!=4)throw new Error("Sector Shift: Expected 12 saw "+st);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+st)}Y.chk("0600","Mini Sector Shift: "),Y.chk("000000000000","Reserved: ")}function g(Y,dt){for(var st=Math.ceil(Y.length/dt)-1,ct=[],ft=1;ft<st;++ft)ct[ft-1]=Y.slice(ft*dt,(ft+1)*dt);return ct[st-1]=Y.slice(st*dt),ct}function y(Y,dt,st){for(var ct=0,ft=0,pt=0,Ft=0,$t=0,Tt=st.length,Lt=[],It=[];ct<Tt;++ct)Lt[ct]=It[ct]=ct,dt[ct]=st[ct];for(;$t<It.length;++$t)ct=It[$t],ft=Y[ct].L,pt=Y[ct].R,Ft=Y[ct].C,Lt[ct]===ct&&(ft!==-1&&Lt[ft]!==ft&&(Lt[ct]=Lt[ft]),pt!==-1&&Lt[pt]!==pt&&(Lt[ct]=Lt[pt])),Ft!==-1&&(Lt[Ft]=ct),ft!==-1&&ct!=Lt[ct]&&(Lt[ft]=Lt[ct],It.lastIndexOf(ft)<$t&&It.push(ft)),pt!==-1&&ct!=Lt[ct]&&(Lt[pt]=Lt[ct],It.lastIndexOf(pt)<$t&&It.push(pt));for(ct=1;ct<Tt;++ct)Lt[ct]===ct&&(pt!==-1&&Lt[pt]!==pt?Lt[ct]=Lt[pt]:ft!==-1&&Lt[ft]!==ft&&(Lt[ct]=Lt[ft]));for(ct=1;ct<Tt;++ct)if(Y[ct].type!==0){if($t=ct,$t!=Lt[$t])do $t=Lt[$t],dt[ct]=dt[$t]+"/"+dt[ct];while($t!==0&&Lt[$t]!==-1&&$t!=Lt[$t]);Lt[ct]=-1}for(dt[0]+="/",ct=1;ct<Tt;++ct)Y[ct].type!==2&&(dt[ct]+="/")}function x(Y,dt,st){for(var ct=Y.start,ft=Y.size,pt=[],Ft=ct;st&&ft>0&&Ft>=0;)pt.push(dt.slice(Ft*B,Ft*B+B)),ft-=B,Ft=uu(st,Ft*4);return pt.length===0?jt(0):Si(pt).slice(0,Y.size)}function _(Y,dt,st,ct,ft){var pt=tt;if(Y===tt){if(dt!==0)throw new Error("DIFAT chain shorter than expected")}else if(Y!==-1){var Ft=st[Y],$t=(ct>>>2)-1;if(!Ft)return;for(var Tt=0;Tt<$t&&(pt=uu(Ft,Tt*4))!==tt;++Tt)ft.push(pt);dt>=1&&_(uu(Ft,ct-4),dt-1,st,ct,ft)}}function b(Y,dt,st,ct,ft){var pt=[],Ft=[];ft||(ft=[]);var $t=ct-1,Tt=0,Lt=0;for(Tt=dt;Tt>=0;){ft[Tt]=!0,pt[pt.length]=Tt,Ft.push(Y[Tt]);var It=st[Math.floor(Tt*4/ct)];if(Lt=Tt*4&$t,ct<4+Lt)throw new Error("FAT boundary crossed: "+Tt+" 4 "+ct);if(!Y[It])break;Tt=uu(Y[It],Lt)}return{nodes:pt,data:A3([Ft])}}function S(Y,dt,st,ct){var ft=Y.length,pt=[],Ft=[],$t=[],Tt=[],Lt=ct-1,It=0,Wt=0,ee=0,ue=0;for(It=0;It<ft;++It)if($t=[],ee=It+dt,ee>=ft&&(ee-=ft),!Ft[ee]){Tt=[];var Qt=[];for(Wt=ee;Wt>=0;){Qt[Wt]=!0,Ft[Wt]=!0,$t[$t.length]=Wt,Tt.push(Y[Wt]);var ie=st[Math.floor(Wt*4/ct)];if(ue=Wt*4&Lt,ct<4+ue)throw new Error("FAT boundary crossed: "+Wt+" 4 "+ct);if(!Y[ie]||(Wt=uu(Y[ie],ue),Qt[Wt]))break}pt[ee]={nodes:$t,data:A3([Tt])}}return pt}function A(Y,dt,st,ct,ft,pt,Ft,$t){for(var Tt=0,Lt=ct.length?2:0,It=dt[Y].data,Wt=0,ee=0,ue;Wt<It.length;Wt+=128){var Qt=It.slice(Wt,Wt+128);Ur(Qt,64),ee=Qt.read_shift(2),ue=aA(Qt,0,ee-Lt),ct.push(ue);var ie={name:ue,type:Qt.read_shift(1),color:Qt.read_shift(1),L:Qt.read_shift(4,"i"),R:Qt.read_shift(4,"i"),C:Qt.read_shift(4,"i"),clsid:Qt.read_shift(16),state:Qt.read_shift(4,"i"),start:0,size:0},je=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);je!==0&&(ie.ct=C(Qt,Qt.l-8));var hn=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);hn!==0&&(ie.mt=C(Qt,Qt.l-8)),ie.start=Qt.read_shift(4,"i"),ie.size=Qt.read_shift(4,"i"),ie.size<0&&ie.start<0&&(ie.size=ie.type=0,ie.start=tt,ie.name=""),ie.type===5?(Tt=ie.start,ft>0&&Tt!==tt&&(dt[Tt].name="!StreamData")):ie.size>=4096?(ie.storage="fat",dt[ie.start]===void 0&&(dt[ie.start]=b(st,ie.start,dt.fat_addrs,dt.ssz)),dt[ie.start].name=ie.name,ie.content=dt[ie.start].data.slice(0,ie.size)):(ie.storage="minifat",ie.size<0?ie.size=0:Tt!==tt&&ie.start!==tt&&dt[Tt]&&(ie.content=x(ie,dt[Tt].data,(dt[$t]||{}).data))),ie.content&&Ur(ie.content,0),pt[ue]=ie,Ft.push(ie)}}function C(Y,dt){return new Date((Ns(Y,dt+4)/1e7*Math.pow(2,32)+Ns(Y,dt)/1e7-11644473600)*1e3)}function O(Y,dt){return f(),d(u.readFileSync(Y),dt)}function N(Y,dt){var st=dt&&dt.type;switch(st||_n&&Buffer.isBuffer(Y)&&(st="buffer"),st||"base64"){case"file":return O(Y,dt);case"base64":return d(Os(wc(Y)),dt);case"binary":return d(Os(Y),dt)}return d(Y,dt)}function D(Y,dt){var st=dt||{},ct=st.root||"Root Entry";if(Y.FullPaths||(Y.FullPaths=[]),Y.FileIndex||(Y.FileIndex=[]),Y.FullPaths.length!==Y.FileIndex.length)throw new Error("inconsistent CFB structure");Y.FullPaths.length===0&&(Y.FullPaths[0]=ct+"/",Y.FileIndex[0]={name:ct,type:5}),st.CLSID&&(Y.FileIndex[0].clsid=st.CLSID),L(Y)}function L(Y){var dt="Sh33tJ5";if(!Un.find(Y,"/"+dt)){var st=jt(4);st[0]=55,st[1]=st[3]=50,st[2]=54,Y.FileIndex.push({name:dt,type:2,content:st,size:4,L:69,R:69,C:69}),Y.FullPaths.push(Y.FullPaths[0]+dt),I(Y)}}function I(Y,dt){D(Y);for(var st=!1,ct=!1,ft=Y.FullPaths.length-1;ft>=0;--ft){var pt=Y.FileIndex[ft];switch(pt.type){case 0:ct?st=!0:(Y.FileIndex.pop(),Y.FullPaths.pop());break;case 1:case 2:case 5:ct=!0,isNaN(pt.R*pt.L*pt.C)&&(st=!0),pt.R>-1&&pt.L>-1&&pt.R==pt.L&&(st=!0);break;default:st=!0;break}}if(!(!st&&!dt)){var Ft=new Date(1987,1,19),$t=0,Tt=Object.create?Object.create(null):{},Lt=[];for(ft=0;ft<Y.FullPaths.length;++ft)Tt[Y.FullPaths[ft]]=!0,Y.FileIndex[ft].type!==0&&Lt.push([Y.FullPaths[ft],Y.FileIndex[ft]]);for(ft=0;ft<Lt.length;++ft){var It=i(Lt[ft][0]);for(ct=Tt[It];!ct;){for(;i(It)&&!Tt[i(It)];)It=i(It);Lt.push([It,{name:r(It).replace("/",""),type:1,clsid:K,ct:Ft,mt:Ft,content:null}]),Tt[It]=!0,It=i(Lt[ft][0]),ct=Tt[It]}}for(Lt.sort(function(ue,Qt){return e(ue[0],Qt[0])}),Y.FullPaths=[],Y.FileIndex=[],ft=0;ft<Lt.length;++ft)Y.FullPaths[ft]=Lt[ft][0],Y.FileIndex[ft]=Lt[ft][1];for(ft=0;ft<Lt.length;++ft){var Wt=Y.FileIndex[ft],ee=Y.FullPaths[ft];if(Wt.name=r(ee).replace("/",""),Wt.L=Wt.R=Wt.C=-(Wt.color=1),Wt.size=Wt.content?Wt.content.length:0,Wt.start=0,Wt.clsid=Wt.clsid||K,ft===0)Wt.C=Lt.length>1?1:-1,Wt.size=0,Wt.type=5;else if(ee.slice(-1)=="/"){for($t=ft+1;$t<Lt.length&&i(Y.FullPaths[$t])!=ee;++$t);for(Wt.C=$t>=Lt.length?-1:$t,$t=ft+1;$t<Lt.length&&i(Y.FullPaths[$t])!=i(ee);++$t);Wt.R=$t>=Lt.length?-1:$t,Wt.type=1}else i(Y.FullPaths[ft+1]||"")==i(ee)&&(Wt.R=ft+1),Wt.type=2}}}function z(Y,dt){var st=dt||{};if(st.fileType=="mad")return or(Y,st);switch(I(Y),st.fileType){case"zip":return Pi(Y,st)}var ct=function(ue){for(var Qt=0,ie=0,je=0;je<ue.FileIndex.length;++je){var hn=ue.FileIndex[je];if(hn.content){var an=hn.content.length;an>0&&(an<4096?Qt+=an+63>>6:ie+=an+511>>9)}}for(var wn=ue.FullPaths.length+3>>2,ps=Qt+7>>3,zs=Qt+127>>7,Sr=ps+ie+wn+zs,Xr=Sr+127>>7,ja=Xr<=109?0:Math.ceil((Xr-109)/127);Sr+Xr+ja+127>>7>Xr;)ja=++Xr<=109?0:Math.ceil((Xr-109)/127);var Yr=[1,ja,Xr,zs,wn,ie,Qt,0];return ue.FileIndex[0].size=Qt<<6,Yr[7]=(ue.FileIndex[0].start=Yr[0]+Yr[1]+Yr[2]+Yr[3]+Yr[4]+Yr[5])+(Yr[6]+7>>3),Yr}(Y),ft=jt(ct[7]<<9),pt=0,Ft=0;{for(pt=0;pt<8;++pt)ft.write_shift(1,et[pt]);for(pt=0;pt<8;++pt)ft.write_shift(2,0);for(ft.write_shift(2,62),ft.write_shift(2,3),ft.write_shift(2,65534),ft.write_shift(2,9),ft.write_shift(2,6),pt=0;pt<3;++pt)ft.write_shift(2,0);for(ft.write_shift(4,0),ft.write_shift(4,ct[2]),ft.write_shift(4,ct[0]+ct[1]+ct[2]+ct[3]-1),ft.write_shift(4,0),ft.write_shift(4,4096),ft.write_shift(4,ct[3]?ct[0]+ct[1]+ct[2]-1:tt),ft.write_shift(4,ct[3]),ft.write_shift(-4,ct[1]?ct[0]-1:tt),ft.write_shift(4,ct[1]),pt=0;pt<109;++pt)ft.write_shift(-4,pt<ct[2]?ct[1]+pt:-1)}if(ct[1])for(Ft=0;Ft<ct[1];++Ft){for(;pt<236+Ft*127;++pt)ft.write_shift(-4,pt<ct[2]?ct[1]+pt:-1);ft.write_shift(-4,Ft===ct[1]-1?tt:Ft+1)}var $t=function(ue){for(Ft+=ue;pt<Ft-1;++pt)ft.write_shift(-4,pt+1);ue&&(++pt,ft.write_shift(-4,tt))};for(Ft=pt=0,Ft+=ct[1];pt<Ft;++pt)ft.write_shift(-4,q.DIFSECT);for(Ft+=ct[2];pt<Ft;++pt)ft.write_shift(-4,q.FATSECT);$t(ct[3]),$t(ct[4]);for(var Tt=0,Lt=0,It=Y.FileIndex[0];Tt<Y.FileIndex.length;++Tt)It=Y.FileIndex[Tt],It.content&&(Lt=It.content.length,!(Lt<4096)&&(It.start=Ft,$t(Lt+511>>9)));for($t(ct[6]+7>>3);ft.l&511;)ft.write_shift(-4,q.ENDOFCHAIN);for(Ft=pt=0,Tt=0;Tt<Y.FileIndex.length;++Tt)It=Y.FileIndex[Tt],It.content&&(Lt=It.content.length,!(!Lt||Lt>=4096)&&(It.start=Ft,$t(Lt+63>>6)));for(;ft.l&511;)ft.write_shift(-4,q.ENDOFCHAIN);for(pt=0;pt<ct[4]<<2;++pt){var Wt=Y.FullPaths[pt];if(!Wt||Wt.length===0){for(Tt=0;Tt<17;++Tt)ft.write_shift(4,0);for(Tt=0;Tt<3;++Tt)ft.write_shift(4,-1);for(Tt=0;Tt<12;++Tt)ft.write_shift(4,0);continue}It=Y.FileIndex[pt],pt===0&&(It.start=It.size?It.start-1:tt);var ee=pt===0&&st.root||It.name;if(ee.length>31&&(console.error("Name "+ee+" will be truncated to "+ee.slice(0,31)),ee=ee.slice(0,31)),Lt=2*(ee.length+1),ft.write_shift(64,ee,"utf16le"),ft.write_shift(2,Lt),ft.write_shift(1,It.type),ft.write_shift(1,It.color),ft.write_shift(-4,It.L),ft.write_shift(-4,It.R),ft.write_shift(-4,It.C),It.clsid)ft.write_shift(16,It.clsid,"hex");else for(Tt=0;Tt<4;++Tt)ft.write_shift(4,0);ft.write_shift(4,It.state||0),ft.write_shift(4,0),ft.write_shift(4,0),ft.write_shift(4,0),ft.write_shift(4,0),ft.write_shift(4,It.start),ft.write_shift(4,It.size),ft.write_shift(4,0)}for(pt=1;pt<Y.FileIndex.length;++pt)if(It=Y.FileIndex[pt],It.size>=4096)if(ft.l=It.start+1<<9,_n&&Buffer.isBuffer(It.content))It.content.copy(ft,ft.l,0,It.size),ft.l+=It.size+511&-512;else{for(Tt=0;Tt<It.size;++Tt)ft.write_shift(1,It.content[Tt]);for(;Tt&511;++Tt)ft.write_shift(1,0)}for(pt=1;pt<Y.FileIndex.length;++pt)if(It=Y.FileIndex[pt],It.size>0&&It.size<4096)if(_n&&Buffer.isBuffer(It.content))It.content.copy(ft,ft.l,0,It.size),ft.l+=It.size+63&-64;else{for(Tt=0;Tt<It.size;++Tt)ft.write_shift(1,It.content[Tt]);for(;Tt&63;++Tt)ft.write_shift(1,0)}if(_n)ft.l=ft.length;else for(;ft.l<ft.length;)ft.write_shift(1,0);return ft}function j(Y,dt){var st=Y.FullPaths.map(function(Tt){return Tt.toUpperCase()}),ct=st.map(function(Tt){var Lt=Tt.split("/");return Lt[Lt.length-(Tt.slice(-1)=="/"?2:1)]}),ft=!1;dt.charCodeAt(0)===47?(ft=!0,dt=st[0].slice(0,-1)+dt):ft=dt.indexOf("/")!==-1;var pt=dt.toUpperCase(),Ft=ft===!0?st.indexOf(pt):ct.indexOf(pt);if(Ft!==-1)return Y.FileIndex[Ft];var $t=!pt.match(Jg);for(pt=pt.replace(zp,""),$t&&(pt=pt.replace(Jg,"!")),Ft=0;Ft<st.length;++Ft)if(($t?st[Ft].replace(Jg,"!"):st[Ft]).replace(zp,"")==pt||($t?ct[Ft].replace(Jg,"!"):ct[Ft]).replace(zp,"")==pt)return Y.FileIndex[Ft];return null}var B=64,tt=-2,k="d0cf11e0a1b11ae1",et=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:tt,FREESECT:-1,HEADER_SIGNATURE:k,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _t(Y,dt,st){f();var ct=z(Y,st);u.writeFileSync(dt,ct)}function at(Y){for(var dt=new Array(Y.length),st=0;st<Y.length;++st)dt[st]=String.fromCharCode(Y[st]);return dt.join("")}function P(Y,dt){var st=z(Y,dt);switch(dt&&dt.type||"buffer"){case"file":return f(),u.writeFileSync(dt.filename,st),st;case"binary":return typeof st=="string"?st:at(st);case"base64":return u1(typeof st=="string"?st:at(st));case"buffer":if(_n)return Buffer.isBuffer(st)?st:bo(st);case"array":return typeof st=="string"?Os(st):st}return st}var X;function V(Y){try{var dt=Y.InflateRaw,st=new dt;if(st._processChunk(new Uint8Array([3,0]),st._finishFlushFlag),st.bytesRead)X=Y;else throw new Error("zlib does not expose bytesRead")}catch(ct){console.error("cannot use native zlib: "+(ct.message||ct))}}function it(Y,dt){if(!X)return Us(Y,dt);var st=X.InflateRaw,ct=new st,ft=ct._processChunk(Y.slice(Y.l),ct._finishFlushFlag);return Y.l+=ct.bytesRead,ft}function ht(Y){return X?X.deflateRawSync(Y):dn(Y)}var yt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Rt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Et=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function G(Y){var dt=(Y<<1|Y<<11)&139536|(Y<<5|Y<<15)&558144;return(dt>>16|dt>>8|dt)&255}for(var lt=typeof Uint8Array<"u",rt=lt?new Uint8Array(256):[],ot=0;ot<256;++ot)rt[ot]=G(ot);function bt(Y,dt){var st=rt[Y&255];return dt<=8?st>>>8-dt:(st=st<<8|rt[Y>>8&255],dt<=16?st>>>16-dt:(st=st<<8|rt[Y>>16&255],st>>>24-dt))}function St(Y,dt){var st=dt&7,ct=dt>>>3;return(Y[ct]|(st<=6?0:Y[ct+1]<<8))>>>st&3}function R(Y,dt){var st=dt&7,ct=dt>>>3;return(Y[ct]|(st<=5?0:Y[ct+1]<<8))>>>st&7}function mt(Y,dt){var st=dt&7,ct=dt>>>3;return(Y[ct]|(st<=4?0:Y[ct+1]<<8))>>>st&15}function ut(Y,dt){var st=dt&7,ct=dt>>>3;return(Y[ct]|(st<=3?0:Y[ct+1]<<8))>>>st&31}function J(Y,dt){var st=dt&7,ct=dt>>>3;return(Y[ct]|(st<=1?0:Y[ct+1]<<8))>>>st&127}function Q(Y,dt,st){var ct=dt&7,ft=dt>>>3,pt=(1<<st)-1,Ft=Y[ft]>>>ct;return st<8-ct||(Ft|=Y[ft+1]<<8-ct,st<16-ct)||(Ft|=Y[ft+2]<<16-ct,st<24-ct)||(Ft|=Y[ft+3]<<24-ct),Ft&pt}function gt(Y,dt,st){var ct=dt&7,ft=dt>>>3;return ct<=5?Y[ft]|=(st&7)<<ct:(Y[ft]|=st<<ct&255,Y[ft+1]=(st&7)>>8-ct),dt+3}function Bt(Y,dt,st){var ct=dt&7,ft=dt>>>3;return st=(st&1)<<ct,Y[ft]|=st,dt+1}function Ht(Y,dt,st){var ct=dt&7,ft=dt>>>3;return st<<=ct,Y[ft]|=st&255,st>>>=8,Y[ft+1]=st,dt+8}function Ct(Y,dt,st){var ct=dt&7,ft=dt>>>3;return st<<=ct,Y[ft]|=st&255,st>>>=8,Y[ft+1]=st&255,Y[ft+2]=st>>>8,dt+16}function kt(Y,dt){var st=Y.length,ct=2*st>dt?2*st:dt+5,ft=0;if(st>=dt)return Y;if(_n){var pt=c3(ct);if(Y.copy)Y.copy(pt);else for(;ft<Y.length;++ft)pt[ft]=Y[ft];return pt}else if(lt){var Ft=new Uint8Array(ct);if(Ft.set)Ft.set(Y);else for(;ft<st;++ft)Ft[ft]=Y[ft];return Ft}return Y.length=ct,Y}function Dt(Y){for(var dt=new Array(Y),st=0;st<Y;++st)dt[st]=0;return dt}function xt(Y,dt,st){var ct=1,ft=0,pt=0,Ft=0,$t=0,Tt=Y.length,Lt=lt?new Uint16Array(32):Dt(32);for(pt=0;pt<32;++pt)Lt[pt]=0;for(pt=Tt;pt<st;++pt)Y[pt]=0;Tt=Y.length;var It=lt?new Uint16Array(Tt):Dt(Tt);for(pt=0;pt<Tt;++pt)Lt[ft=Y[pt]]++,ct<ft&&(ct=ft),It[pt]=0;for(Lt[0]=0,pt=1;pt<=ct;++pt)Lt[pt+16]=$t=$t+Lt[pt-1]<<1;for(pt=0;pt<Tt;++pt)$t=Y[pt],$t!=0&&(It[pt]=Lt[$t+16]++);var Wt=0;for(pt=0;pt<Tt;++pt)if(Wt=Y[pt],Wt!=0)for($t=bt(It[pt],ct)>>ct-Wt,Ft=(1<<ct+4-Wt)-1;Ft>=0;--Ft)dt[$t|Ft<<Wt]=Wt&15|pt<<4;return ct}var te=lt?new Uint16Array(512):Dt(512),ae=lt?new Uint16Array(32):Dt(32);if(!lt){for(var ne=0;ne<512;++ne)te[ne]=0;for(ne=0;ne<32;++ne)ae[ne]=0}(function(){for(var Y=[],dt=0;dt<32;dt++)Y.push(5);xt(Y,ae,32);var st=[];for(dt=0;dt<=143;dt++)st.push(8);for(;dt<=255;dt++)st.push(9);for(;dt<=279;dt++)st.push(7);for(;dt<=287;dt++)st.push(8);xt(st,te,288)})();var Me=function(){for(var dt=lt?new Uint8Array(32768):[],st=0,ct=0;st<Et.length-1;++st)for(;ct<Et[st+1];++ct)dt[ct]=st;for(;ct<32768;++ct)dt[ct]=29;var ft=lt?new Uint8Array(259):[];for(st=0,ct=0;st<Rt.length-1;++st)for(;ct<Rt[st+1];++ct)ft[ct]=st;function pt($t,Tt){for(var Lt=0;Lt<$t.length;){var It=Math.min(65535,$t.length-Lt),Wt=Lt+It==$t.length;for(Tt.write_shift(1,+Wt),Tt.write_shift(2,It),Tt.write_shift(2,~It&65535);It-- >0;)Tt[Tt.l++]=$t[Lt++]}return Tt.l}function Ft($t,Tt){for(var Lt=0,It=0,Wt=lt?new Uint16Array(32768):[];It<$t.length;){var ee=Math.min(65535,$t.length-It);if(ee<10){for(Lt=gt(Tt,Lt,+(It+ee==$t.length)),Lt&7&&(Lt+=8-(Lt&7)),Tt.l=Lt/8|0,Tt.write_shift(2,ee),Tt.write_shift(2,~ee&65535);ee-- >0;)Tt[Tt.l++]=$t[It++];Lt=Tt.l*8;continue}Lt=gt(Tt,Lt,+(It+ee==$t.length)+2);for(var ue=0;ee-- >0;){var Qt=$t[It];ue=(ue<<5^Qt)&32767;var ie=-1,je=0;if((ie=Wt[ue])&&(ie|=It&-32768,ie>It&&(ie-=32768),ie<It))for(;$t[ie+je]==$t[It+je]&&je<250;)++je;if(je>2){Qt=ft[je],Qt<=22?Lt=Ht(Tt,Lt,rt[Qt+1]>>1)-1:(Ht(Tt,Lt,3),Lt+=5,Ht(Tt,Lt,rt[Qt-23]>>5),Lt+=3);var hn=Qt<8?0:Qt-4>>2;hn>0&&(Ct(Tt,Lt,je-Rt[Qt]),Lt+=hn),Qt=dt[It-ie],Lt=Ht(Tt,Lt,rt[Qt]>>3),Lt-=3;var an=Qt<4?0:Qt-2>>1;an>0&&(Ct(Tt,Lt,It-ie-Et[Qt]),Lt+=an);for(var wn=0;wn<je;++wn)Wt[ue]=It&32767,ue=(ue<<5^$t[It])&32767,++It;ee-=je-1}else Qt<=143?Qt=Qt+48:Lt=Bt(Tt,Lt,1),Lt=Ht(Tt,Lt,rt[Qt]),Wt[ue]=It&32767,++It}Lt=Ht(Tt,Lt,0)-1}return Tt.l=(Lt+7)/8|0,Tt.l}return function(Tt,Lt){return Tt.length<8?pt(Tt,Lt):Ft(Tt,Lt)}}();function dn(Y){var dt=jt(50+Math.floor(Y.length*1.1)),st=Me(Y,dt);return dt.slice(0,st)}var Se=lt?new Uint16Array(32768):Dt(32768),gn=lt?new Uint16Array(32768):Dt(32768),Ze=lt?new Uint16Array(128):Dt(128),Zn=1,Bn=1;function On(Y,dt){var st=ut(Y,dt)+257;dt+=5;var ct=ut(Y,dt)+1;dt+=5;var ft=mt(Y,dt)+4;dt+=4;for(var pt=0,Ft=lt?new Uint8Array(19):Dt(19),$t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Tt=1,Lt=lt?new Uint8Array(8):Dt(8),It=lt?new Uint8Array(8):Dt(8),Wt=Ft.length,ee=0;ee<ft;++ee)Ft[yt[ee]]=pt=R(Y,dt),Tt<pt&&(Tt=pt),Lt[pt]++,dt+=3;var ue=0;for(Lt[0]=0,ee=1;ee<=Tt;++ee)It[ee]=ue=ue+Lt[ee-1]<<1;for(ee=0;ee<Wt;++ee)(ue=Ft[ee])!=0&&($t[ee]=It[ue]++);var Qt=0;for(ee=0;ee<Wt;++ee)if(Qt=Ft[ee],Qt!=0){ue=rt[$t[ee]]>>8-Qt;for(var ie=(1<<7-Qt)-1;ie>=0;--ie)Ze[ue|ie<<Qt]=Qt&7|ee<<3}var je=[];for(Tt=1;je.length<st+ct;)switch(ue=Ze[J(Y,dt)],dt+=ue&7,ue>>>=3){case 16:for(pt=3+St(Y,dt),dt+=2,ue=je[je.length-1];pt-- >0;)je.push(ue);break;case 17:for(pt=3+R(Y,dt),dt+=3;pt-- >0;)je.push(0);break;case 18:for(pt=11+J(Y,dt),dt+=7;pt-- >0;)je.push(0);break;default:je.push(ue),Tt<ue&&(Tt=ue);break}var hn=je.slice(0,st),an=je.slice(st);for(ee=st;ee<286;++ee)hn[ee]=0;for(ee=ct;ee<30;++ee)an[ee]=0;return Zn=xt(hn,Se,286),Bn=xt(an,gn,30),dt}function Oi(Y,dt){if(Y[0]==3&&!(Y[1]&3))return[Du(dt),2];for(var st=0,ct=0,ft=c3(dt||1<<18),pt=0,Ft=ft.length>>>0,$t=0,Tt=0;(ct&1)==0;){if(ct=R(Y,st),st+=3,ct>>>1)ct>>1==1?($t=9,Tt=5):(st=On(Y,st),$t=Zn,Tt=Bn);else{st&7&&(st+=8-(st&7));var Lt=Y[st>>>3]|Y[(st>>>3)+1]<<8;if(st+=32,Lt>0)for(!dt&&Ft<pt+Lt&&(ft=kt(ft,pt+Lt),Ft=ft.length);Lt-- >0;)ft[pt++]=Y[st>>>3],st+=8;continue}for(;;){!dt&&Ft<pt+32767&&(ft=kt(ft,pt+32767),Ft=ft.length);var It=Q(Y,st,$t),Wt=ct>>>1==1?te[It]:Se[It];if(st+=Wt&15,Wt>>>=4,(Wt>>>8&255)===0)ft[pt++]=Wt;else{if(Wt==256)break;Wt-=257;var ee=Wt<8?0:Wt-4>>2;ee>5&&(ee=0);var ue=pt+Rt[Wt];ee>0&&(ue+=Q(Y,st,ee),st+=ee),It=Q(Y,st,Tt),Wt=ct>>>1==1?ae[It]:gn[It],st+=Wt&15,Wt>>>=4;var Qt=Wt<4?0:Wt-2>>1,ie=Et[Wt];for(Qt>0&&(ie+=Q(Y,st,Qt),st+=Qt),!dt&&Ft<ue&&(ft=kt(ft,ue+100),Ft=ft.length);pt<ue;)ft[pt]=ft[pt-ie],++pt}}}return dt?[ft,st+7>>>3]:[ft.slice(0,pt),st+7>>>3]}function Us(Y,dt){var st=Y.slice(Y.l||0),ct=Oi(st,dt);return Y.l+=ct[1],ct[0]}function pa(Y,dt){if(Y)typeof console<"u"&&console.error(dt);else throw new Error(dt)}function wo(Y,dt){var st=Y;Ur(st,0);var ct=[],ft=[],pt={FileIndex:ct,FullPaths:ft};D(pt,{root:dt.root});for(var Ft=st.length-4;(st[Ft]!=80||st[Ft+1]!=75||st[Ft+2]!=5||st[Ft+3]!=6)&&Ft>=0;)--Ft;st.l=Ft+4,st.l+=4;var $t=st.read_shift(2);st.l+=6;var Tt=st.read_shift(4);for(st.l=Tt,Ft=0;Ft<$t;++Ft){st.l+=20;var Lt=st.read_shift(4),It=st.read_shift(4),Wt=st.read_shift(2),ee=st.read_shift(2),ue=st.read_shift(2);st.l+=8;var Qt=st.read_shift(4),ie=l(st.slice(st.l+Wt,st.l+Wt+ee));st.l+=Wt+ee+ue;var je=st.l;st.l=Qt+4,ie&&ie[1]&&((ie[1]||{}).usz&&(It=ie[1].usz),(ie[1]||{}).csz&&(Lt=ie[1].csz)),ma(st,Lt,It,pt,ie),st.l=je}return pt}function ma(Y,dt,st,ct,ft){Y.l+=2;var pt=Y.read_shift(2),Ft=Y.read_shift(2),$t=a(Y);if(pt&8257)throw new Error("Unsupported ZIP encryption");for(var Tt=Y.read_shift(4),Lt=Y.read_shift(4),It=Y.read_shift(4),Wt=Y.read_shift(2),ee=Y.read_shift(2),ue="",Qt=0;Qt<Wt;++Qt)ue+=String.fromCharCode(Y[Y.l++]);if(ee){var ie=l(Y.slice(Y.l,Y.l+ee));(ie[21589]||{}).mt&&($t=ie[21589].mt),(ie[1]||{}).usz&&(It=ie[1].usz),(ie[1]||{}).csz&&(Lt=ie[1].csz),ft&&((ft[21589]||{}).mt&&($t=ft[21589].mt),(ft[1]||{}).usz&&(It=ft[1].usz),(ft[1]||{}).csz&&(Lt=ft[1].csz))}Y.l+=ee;var je=Y.slice(Y.l,Y.l+Lt);switch(Ft){case 8:je=it(Y,It);break;case 0:Y.l+=Lt;break;default:throw new Error("Unsupported ZIP Compression method "+Ft)}var hn=!1;pt&8&&(Tt=Y.read_shift(4),Tt==134695760&&(Tt=Y.read_shift(4),hn=!0),Lt=Y.read_shift(4),It=Y.read_shift(4)),Lt!=dt&&pa(hn,"Bad compressed size: "+dt+" != "+Lt),It!=st&&pa(hn,"Bad uncompressed size: "+st+" != "+It),xi(ct,ue,je,{unsafe:!0,mt:$t})}function Pi(Y,dt){var st=dt||{},ct=[],ft=[],pt=jt(1),Ft=st.compression?8:0,$t=0,Tt=0,Lt=0,It=0,Wt=0,ee=Y.FullPaths[0],ue=ee,Qt=Y.FileIndex[0],ie=[],je=0;for(Tt=1;Tt<Y.FullPaths.length;++Tt)if(ue=Y.FullPaths[Tt].slice(ee.length),Qt=Y.FileIndex[Tt],!(!Qt.size||!Qt.content||Array.isArray(Qt.content)&&Qt.content.length==0||ue=="Sh33tJ5")){var hn=It,an=jt(ue.length);for(Lt=0;Lt<ue.length;++Lt)an.write_shift(1,ue.charCodeAt(Lt)&127);an=an.slice(0,an.l),ie[Wt]=typeof Qt.content=="string"?v3.bstr(Qt.content,0):v3.buf(Qt.content,0);var wn=typeof Qt.content=="string"?Os(Qt.content):Qt.content;Ft==8&&(wn=ht(wn)),pt=jt(30),pt.write_shift(4,67324752),pt.write_shift(2,20),pt.write_shift(2,$t),pt.write_shift(2,Ft),Qt.mt?s(pt,Qt.mt):pt.write_shift(4,0),pt.write_shift(-4,ie[Wt]),pt.write_shift(4,wn.length),pt.write_shift(4,Qt.content.length),pt.write_shift(2,an.length),pt.write_shift(2,0),It+=pt.length,ct.push(pt),It+=an.length,ct.push(an),It+=wn.length,ct.push(wn),pt=jt(46),pt.write_shift(4,33639248),pt.write_shift(2,0),pt.write_shift(2,20),pt.write_shift(2,$t),pt.write_shift(2,Ft),pt.write_shift(4,0),pt.write_shift(-4,ie[Wt]),pt.write_shift(4,wn.length),pt.write_shift(4,Qt.content.length),pt.write_shift(2,an.length),pt.write_shift(2,0),pt.write_shift(2,0),pt.write_shift(2,0),pt.write_shift(2,0),pt.write_shift(4,0),pt.write_shift(4,hn),je+=pt.l,ft.push(pt),je+=an.length,ft.push(an),++Wt}return pt=jt(22),pt.write_shift(4,101010256),pt.write_shift(2,0),pt.write_shift(2,0),pt.write_shift(2,Wt),pt.write_shift(2,Wt),pt.write_shift(4,je),pt.write_shift(4,It),pt.write_shift(2,0),Si([Si(ct),Si(ft),pt])}var Wr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Rc(Y,dt){if(Y.ctype)return Y.ctype;var st=Y.name||"",ct=st.match(/\.([^\.]+)$/);return ct&&Wr[ct[1]]||dt&&(ct=(st=dt).match(/[\.\\]([^\.\\])+$/),ct&&Wr[ct[1]])?Wr[ct[1]]:"application/octet-stream"}function Yu(Y){for(var dt=u1(Y),st=[],ct=0;ct<dt.length;ct+=76)st.push(dt.slice(ct,ct+76));return st.join(`\r
`)+`\r
`}function Nc(Y){var dt=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Lt){var It=Lt.charCodeAt(0).toString(16).toUpperCase();return"="+(It.length==1?"0"+It:It)});dt=dt.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),dt.charAt(0)==`
`&&(dt="=0D"+dt.slice(1)),dt=dt.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var st=[],ct=dt.split(`\r
`),ft=0;ft<ct.length;++ft){var pt=ct[ft];if(pt.length==0){st.push("");continue}for(var Ft=0;Ft<pt.length;){var $t=76,Tt=pt.slice(Ft,Ft+$t);Tt.charAt($t-1)=="="?$t--:Tt.charAt($t-2)=="="?$t-=2:Tt.charAt($t-3)=="="&&($t-=3),Tt=pt.slice(Ft,Ft+$t),Ft+=$t,Ft<pt.length&&(Tt+="="),st.push(Tt)}}return st.join(`\r
`)}function Lc(Y){for(var dt=[],st=0;st<Y.length;++st){for(var ct=Y[st];st<=Y.length&&ct.charAt(ct.length-1)=="=";)ct=ct.slice(0,ct.length-1)+Y[++st];dt.push(ct)}for(var ft=0;ft<dt.length;++ft)dt[ft]=dt[ft].replace(/[=][0-9A-Fa-f]{2}/g,function(pt){return String.fromCharCode(parseInt(pt.slice(1),16))});return Os(dt.join(`\r
`))}function qu(Y,dt,st){for(var ct="",ft="",pt="",Ft,$t=0;$t<10;++$t){var Tt=dt[$t];if(!Tt||Tt.match(/^\s*$/))break;var Lt=Tt.match(/^([^:]*?):\s*([^\s].*)$/);if(Lt)switch(Lt[1].toLowerCase()){case"content-location":ct=Lt[2].trim();break;case"content-type":pt=Lt[2].trim();break;case"content-transfer-encoding":ft=Lt[2].trim();break}}switch(++$t,ft.toLowerCase()){case"base64":Ft=Os(wc(dt.slice($t).join("")));break;case"quoted-printable":Ft=Lc(dt.slice($t));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ft)}var It=xi(Y,ct.slice(st.length),Ft,{unsafe:!0});pt&&(It.ctype=pt)}function Pa(Y,dt){if(at(Y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var st=dt&&dt.root||"",ct=(_n&&Buffer.isBuffer(Y)?Y.toString("binary"):at(Y)).split(`\r
`),ft=0,pt="";for(ft=0;ft<ct.length;++ft)if(pt=ct[ft],!!/^Content-Location:/i.test(pt)&&(pt=pt.slice(pt.indexOf("file")),st||(st=pt.slice(0,pt.lastIndexOf("/")+1)),pt.slice(0,st.length)!=st))for(;st.length>0&&(st=st.slice(0,st.length-1),st=st.slice(0,st.lastIndexOf("/")+1),pt.slice(0,st.length)!=st););var Ft=(ct[1]||"").match(/boundary="(.*?)"/);if(!Ft)throw new Error("MAD cannot find boundary");var $t="--"+(Ft[1]||""),Tt=[],Lt=[],It={FileIndex:Tt,FullPaths:Lt};D(It);var Wt,ee=0;for(ft=0;ft<ct.length;++ft){var ue=ct[ft];ue!==$t&&ue!==$t+"--"||(ee++&&qu(It,ct.slice(Wt,ft),st),Wt=ft)}return It}function or(Y,dt){var st=dt||{},ct=st.boundary||"SheetJS";ct="------="+ct;for(var ft=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ct.slice(2)+'"',"","",""],pt=Y.FullPaths[0],Ft=pt,$t=Y.FileIndex[0],Tt=1;Tt<Y.FullPaths.length;++Tt)if(Ft=Y.FullPaths[Tt].slice(pt.length),$t=Y.FileIndex[Tt],!(!$t.size||!$t.content||Ft=="Sh33tJ5")){Ft=Ft.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(je){return"_x"+je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(je){return"_u"+je.charCodeAt(0).toString(16)+"_"});for(var Lt=$t.content,It=_n&&Buffer.isBuffer(Lt)?Lt.toString("binary"):at(Lt),Wt=0,ee=Math.min(1024,It.length),ue=0,Qt=0;Qt<=ee;++Qt)(ue=It.charCodeAt(Qt))>=32&&ue<128&&++Wt;var ie=Wt>=ee*4/5;ft.push(ct),ft.push("Content-Location: "+(st.root||"file:///C:/SheetJS/")+Ft),ft.push("Content-Transfer-Encoding: "+(ie?"quoted-printable":"base64")),ft.push("Content-Type: "+Rc($t,Ft)),ft.push(""),ft.push(ie?Nc(It):Yu(It))}return ft.push(ct+`--\r
`),ft.join(`\r
`)}function vi(Y){var dt={};return D(dt,Y),dt}function xi(Y,dt,st,ct){var ft=ct&&ct.unsafe;ft||D(Y);var pt=!ft&&Un.find(Y,dt);if(!pt){var Ft=Y.FullPaths[0];dt.slice(0,Ft.length)==Ft?Ft=dt:(Ft.slice(-1)!="/"&&(Ft+="/"),Ft=(Ft+dt).replace("//","/")),pt={name:r(dt),type:2},Y.FileIndex.push(pt),Y.FullPaths.push(Ft),ft||Un.utils.cfb_gc(Y)}return pt.content=st,pt.size=st?st.length:0,ct&&(ct.CLSID&&(pt.clsid=ct.CLSID),ct.mt&&(pt.mt=ct.mt),ct.ct&&(pt.ct=ct.ct)),pt}function Ba(Y,dt){D(Y);var st=Un.find(Y,dt);if(st){for(var ct=0;ct<Y.FileIndex.length;++ct)if(Y.FileIndex[ct]==st)return Y.FileIndex.splice(ct,1),Y.FullPaths.splice(ct,1),!0}return!1}function Ic(Y,dt,st){D(Y);var ct=Un.find(Y,dt);if(ct){for(var ft=0;ft<Y.FileIndex.length;++ft)if(Y.FileIndex[ft]==ct)return Y.FileIndex[ft].name=r(st),Y.FullPaths[ft]=st,!0}return!1}function Ud(Y){I(Y,!0)}return t.find=j,t.read=N,t.parse=d,t.write=P,t.writeFile=_t,t.utils={cfb_new:vi,cfb_add:xi,cfb_del:Ba,cfb_mov:Ic,cfb_gc:Ud,ReadShift:Hp,CheckField:eI,prep_blob:Ur,bconcat:Si,use_zlib:V,_deflateRaw:dn,_inflateRaw:Us,consts:q},t}(),mq;function x3(n){return typeof n=="string"?px(n):Array.isArray(n)?zY(n):n}function z0(n,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=px(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(n,t)}var i=e=="utf8"?f0(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,n);if(typeof Blob<"u"){var r=new Blob([x3(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,n);if(typeof saveAs<"u")return saveAs(r,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+UY(new Uint8Array(x3(i)));return chrome.downloads.download({url:l,filename:n,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(n);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Ou(t)),u.write(t),u.close(),t}catch(f){if(!f.message||f.message.indexOf("onstruct")==-1)throw f}throw new Error("cannot save file "+n)}function Ti(n){for(var t=Object.keys(n),e=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(n,t[i])&&e.push(t[i]);return e}function y3(n,t){for(var e=[],i=Ti(n),r=0;r!==i.length;++r)e[n[i[r]][t]]==null&&(e[n[i[r]][t]]=i[r]);return e}function eA(n){for(var t=[],e=Ti(n),i=0;i!==e.length;++i)t[n[e[i]]]=e[i];return t}function vx(n){for(var t=[],e=Ti(n),i=0;i!==e.length;++i)t[n[e[i]]]=parseInt(e[i],10);return t}function gq(n){for(var t=[],e=Ti(n),i=0;i!==e.length;++i)t[n[e[i]]]==null&&(t[n[e[i]]]=[]),t[n[e[i]]].push(e[i]);return t}var j5=Date.UTC(1899,11,30,0,0,0),vq=Date.UTC(1899,11,31,0,0,0),xq=Date.UTC(1904,0,1,0,0,0);function sr(n,t){var e=n.getTime(),i=(e-j5)/(24*60*60*1e3);return t?(i-=1462,i<-1402?i-1:i):i<60?i-1:i}function td(n){if(n>=60&&n<61)return n;var t=new Date;return t.setTime((n>60?n:n+1)*24*60*60*1e3+j5),t}var yq=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,_q=/^(\d+)-(\d+)-(\d+)$/,U5=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function hs(n,t){if(n instanceof Date)return n;var e=n.match(yq);if(e)return new Date((t?xq:vq)+((parseInt(e[1],10)*60+parseInt(e[2],10))*60+(e[3]?parseInt(e[3].slice(1),10):0))*1e3+(e[4]?parseInt((e[4]+"000").slice(1,4),10):0));if(e=n.match(_q),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],0,0,0,0));if(e=n.match(U5),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5],e[6]&&parseInt(e[6].slice(1),10)||0,e[7]&&parseInt((e[7]+"0000").slice(1,4),10)||0));var i=new Date(n);return i}function nA(n,t){if(_n&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return e[s]||s})}catch{}var i=[],r=0;try{for(r=0;r<n.length-65536;r+=65536)i.push(String.fromCharCode.apply(0,n.slice(r,r+65536)));i.push(String.fromCharCode.apply(0,n.slice(r)))}catch{try{for(;r<n.length-16384;r+=16384)i.push(String.fromCharCode.apply(0,n.slice(r,r+16384)));i.push(String.fromCharCode.apply(0,n.slice(r)))}catch{for(;r!=n.length;++r)i.push(String.fromCharCode(n[r]))}}return i.join("")}function Ar(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var t={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=Ar(n[e]));return t}function qn(n,t){for(var e="";e.length<t;)e+=n;return e}function ml(n){var t=Number(n);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(n))return t;var e=1,i=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(]([^()]*)[)]/,function(r,s){return e=-e,s}),!isNaN(t=Number(i)))?t/e:t}var bq=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,wq=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,Eq=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,Aq=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function Sq(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,n[7]=="p"?12:0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),0,0,0))}function Tq(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1],+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1],0,0,0))}var Cq=["january","february","march","april","may","june","july","august","september","october","november","december"];function g1(n){if(Eq.test(n))return n.indexOf("Z")==-1?xx(new Date(n)):new Date(n);var t=n.toLowerCase(),e=t.replace(/\s+/g," ").trim(),i=e.match(bq);if(i)return Sq(i);if(i=e.match(wq),i)return Tq(i);if(i=e.match(U5),i)return new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],i[6]&&parseInt(i[6].slice(1),10)||0,i[7]&&parseInt((i[7]+"0000").slice(1,4),10)||0));var r=new Date(Aq&&n.indexOf("UTC")==-1?n+" UTC":n),s=new Date(NaN),a=r.getYear();r.getMonth();var l=r.getDate();if(isNaN(l))return s;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&Cq.indexOf(t)==-1)return s}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return s;return a<0||a>8099||n.match(/[^-0-9:,\/\\\ ]/)?s:r}function bd(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds())}function xx(n){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()))}function Ye(n,t,e){if(n.FullPaths){if(Array.isArray(e)&&typeof e[0]=="string"&&(e=e.join("")),typeof e=="string"){var i;return _n?i=bo(e):i=HY(e),Un.utils.cfb_add(n,t,i)}Un.utils.cfb_add(n,t,e)}else n.file(t,e)}function iA(){return Un.utils.cfb_new()}var Di=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Dq={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rA=eA(Dq),sA=/[&<>'"]/g,Oq=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function qe(n){var t=n+"";return t.replace(sA,function(e){return rA[e]}).replace(Oq,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function _3(n){return qe(n).replace(/ /g,"_x0020_")}var z5=/[\u0000-\u001f]/g;function Ab(n){var t=n+"";return t.replace(sA,function(e){return rA[e]}).replace(/\n/g,"<br/>").replace(z5,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Rq(n){var t=n+"";return t.replace(sA,function(e){return rA[e]}).replace(z5,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function Nq(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function Lq(n){switch(n){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Sb(n){for(var t="",e=0,i=0,r=0,s=0,a=0,l=0;e<n.length;){if(i=n.charCodeAt(e++),i<128){t+=String.fromCharCode(i);continue}if(r=n.charCodeAt(e++),i>191&&i<224){a=(i&31)<<6,a|=r&63,t+=String.fromCharCode(a);continue}if(s=n.charCodeAt(e++),i<240){t+=String.fromCharCode((i&15)<<12|(r&63)<<6|s&63);continue}a=n.charCodeAt(e++),l=((i&7)<<18|(r&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function b3(n){var t=Du(2*n.length),e,i,r=1,s=0,a=0,l;for(i=0;i<n.length;i+=r)r=1,(l=n.charCodeAt(i))<128?e=l:l<224?(e=(l&31)*64+(n.charCodeAt(i+1)&63),r=2):l<240?(e=(l&15)*4096+(n.charCodeAt(i+1)&63)*64+(n.charCodeAt(i+2)&63),r=3):(r=4,e=(l&7)*262144+(n.charCodeAt(i+1)&63)*4096+(n.charCodeAt(i+2)&63)*64+(n.charCodeAt(i+3)&63),e-=65536,a=55296+(e>>>10&1023),e=56320+(e&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=e%256,t[s++]=e>>>8;return t.slice(0,s).toString("ucs2")}function w3(n){return bo(n,"binary").toString("utf8")}var tv="foo bar bazâð£",ed=_n&&(w3(tv)==Sb(tv)&&w3||b3(tv)==Sb(tv)&&b3)||Sb,f0=_n?function(n){return bo(n,"utf8").toString("binary")}:function(n){for(var t=[],e=0,i=0,r=0;e<n.length;)switch(i=n.charCodeAt(e++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=n.charCodeAt(e++)-56320+(i<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")},Iq=function(){var n=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),r=0;r<n.length;++r)i=i.replace(n[r][0],n[r][1]);return i}}(),H5=/(^\s|\s$|\n)/;function er(n,t){return"<"+n+(t.match(H5)?' xml:space="preserve"':"")+">"+t+"</"+n+">"}function d0(n){return Ti(n).map(function(t){return" "+t+'="'+n[t]+'"'}).join("")}function se(n,t,e){return"<"+n+(e!=null?d0(e):"")+(t!=null?(t.match(H5)?' xml:space="preserve"':"")+">"+t+"</"+n:"/")+">"}function sE(n,t){try{return n.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function kq(n,t){switch(typeof n){case"string":var e=se("vt:lpwstr",qe(n));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return se((n|0)==n?"vt:i4":"vt:r8",qe(String(n)));case"boolean":return se("vt:bool",n?"true":"false")}if(n instanceof Date)return se("vt:filetime",sE(n));throw new Error("Unable to serialize "+n)}var Hi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Id=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Rs={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Mq(n,t){for(var e=1-2*(n[t+7]>>>7),i=((n[t+7]&127)<<4)+(n[t+6]>>>4&15),r=n[t+6]&15,s=5;s>=0;--s)r=r*256+n[t+s];return i==2047?r==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),e*Math.pow(2,i-52)*r)}function Fq(n,t,e){var i=(t<0||1/t==-1/0?1:0)<<7,r=0,s=0,a=i?-t:t;isFinite(a)?a==0?r=s=0:(r=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-r),r<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?r=-1022:(s-=Math.pow(2,52),r+=1023)):(r=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)n[e+l]=s&255;n[e+6]=(r&15)<<4|s&15,n[e+7]=r>>4|i}var E3=function(n){for(var t=[],e=10240,i=0;i<n[0].length;++i)if(n[0][i])for(var r=0,s=n[0][i].length;r<s;r+=e)t.push.apply(t,n[0][i].slice(r,r+e));return t},A3=_n?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(t){return Buffer.isBuffer(t)?t:bo(t)})):E3(n)}:E3,S3=function(n,t,e){for(var i=[],r=t;r<e;r+=2)i.push(String.fromCharCode(Np(n,r)));return i.join("").replace(zp,"")},aA=_n?function(n,t,e){return!Buffer.isBuffer(n)||!f1?S3(n,t,e):n.toString("utf16le",t,e).replace(zp,"")}:S3,T3=function(n,t,e){for(var i=[],r=t;r<t+e;++r)i.push(("0"+n[r].toString(16)).slice(-2));return i.join("")},$5=_n?function(n,t,e){return Buffer.isBuffer(n)?n.toString("hex",t,t+e):T3(n,t,e)}:T3,C3=function(n,t,e){for(var i=[],r=t;r<e;r++)i.push(String.fromCharCode(Wf(n,r)));return i.join("")},H0=_n?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):C3(t,e,i)}:C3,G5=function(n,t){var e=Ns(n,t);return e>0?H0(n,t+4,t+4+e-1):""},V5=G5,W5=function(n,t){var e=Ns(n,t);return e>0?H0(n,t+4,t+4+e-1):""},X5=W5,Y5=function(n,t){var e=2*Ns(n,t);return e>0?H0(n,t+4,t+4+e-1):""},q5=Y5,K5=function(t,e){var i=Ns(t,e);return i>0?aA(t,e+4,e+4+i):""},Z5=K5,Q5=function(n,t){var e=Ns(n,t);return e>0?H0(n,t+4,t+4+e):""},J5=Q5,tI=function(n,t){return Mq(n,t)},v1=tI,oA=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};_n&&(V5=function(t,e){if(!Buffer.isBuffer(t))return G5(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},X5=function(t,e){if(!Buffer.isBuffer(t))return W5(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},q5=function(t,e){if(!Buffer.isBuffer(t)||!f1)return Y5(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},Z5=function(t,e){if(!Buffer.isBuffer(t)||!f1)return K5(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},J5=function(t,e){if(!Buffer.isBuffer(t))return Q5(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},v1=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):tI(t,e)},oA=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Wf=function(n,t){return n[t]},Np=function(n,t){return n[t+1]*256+n[t]},Pq=function(n,t){var e=n[t+1]*256+n[t];return e<32768?e:(65535-e+1)*-1},Ns=function(n,t){return n[t+3]*(1<<24)+(n[t+2]<<16)+(n[t+1]<<8)+n[t]},uu=function(n,t){return n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]},Bq=function(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]};function Hp(n,t){var e="",i,r,s=[],a,l,u,f;switch(t){case"dbcs":if(f=this.l,_n&&Buffer.isBuffer(this)&&f1)e=this.slice(this.l,this.l+2*n).toString("utf16le");else for(u=0;u<n;++u)e+=String.fromCharCode(Np(this,f)),f+=2;n*=2;break;case"utf8":e=H0(this,this.l,this.l+n);break;case"utf16le":n*=2,e=aA(this,this.l,this.l+n);break;case"wstr":return Hp.call(this,n,"dbcs");case"lpstr-ansi":e=V5(this,this.l),n=4+Ns(this,this.l);break;case"lpstr-cp":e=X5(this,this.l),n=4+Ns(this,this.l);break;case"lpwstr":e=q5(this,this.l),n=4+2*Ns(this,this.l);break;case"lpp4":n=4+Ns(this,this.l),e=Z5(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Ns(this,this.l),e=J5(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,e="";(a=Wf(this,this.l+n++))!==0;)s.push(Qg(a));e=s.join("");break;case"_wstr":for(n=0,e="";(a=Np(this,this.l+n))!==0;)s.push(Qg(a)),n+=2;n+=2,e=s.join("");break;case"dbcs-cont":for(e="",f=this.l,u=0;u<n;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return a=Wf(this,f),this.l=f+1,l=Hp.call(this,n-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Qg(Np(this,f))),f+=2}e=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(e="",f=this.l,u=0;u!=n;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return a=Wf(this,f),this.l=f+1,l=Hp.call(this,n-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Qg(Wf(this,f))),f+=1}e=s.join("");break;default:switch(n){case 1:return i=Wf(this,this.l),this.l++,i;case 2:return i=(t==="i"?Pq:Np)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(i=(n>0?uu:Bq)(this,this.l),this.l+=4,i):(r=Ns(this,this.l),this.l+=4,r);case 8:case-8:if(t==="f")return n==8?r=v1(this,this.l):r=v1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;n=8;case 16:e=$5(this,this.l,n);break}}return this.l+=n,e}var jq=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},Uq=function(n,t,e){n[e]=t&255,n[e+1]=t>>8&255,n[e+2]=t>>16&255,n[e+3]=t>>24&255},zq=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255};function Hq(n,t,e){var i=0,r=0;if(e==="dbcs"){for(r=0;r!=t.length;++r)zq(this,t.charCodeAt(r),this.l+2*r);i=2*t.length}else if(e==="sbcs"||e=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=t.charCodeAt(r)&255;i=t.length}else if(e==="hex"){for(;r<n;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+n,this.length);for(r=0;r<Math.min(t.length,n);++r){var a=t.charCodeAt(r);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,jq(this,t,this.l);break;case 8:if(i=8,e==="f"){Fq(this,t,this.l);break}case 16:break;case-4:i=4,Uq(this,t,this.l);break}return this.l+=i,this}function eI(n,t){var e=$5(this,this.l,n.length>>1);if(e!==n)throw new Error(t+"Expected "+n+" saw "+e);this.l+=n.length>>1}function Ur(n,t){n.l=t,n.read_shift=Hp,n.chk=eI,n.write_shift=Hq}function _o(n,t){n.l+=t}function jt(n){var t=Du(n);return Ur(t,0),t}function wr(){var n=[],t=_n?16384:2048;_n&&jt(t).copy;var e=function(d){var p=jt(d);return Ur(p,0),p},i=e(t),r=function(){i&&(i.l&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&n.push(i)),i=null)},s=function(d){return i&&d<i.length-i.l?i:(r(),i=e(Math.max(d+1,t)))},a=function(){return r(),Si(n)},l=function(){return r(),n},u=function(d){r(),i=d,i.l==null&&(i.l=i.length),s(t)};return{next:s,push:u,end:a,_bufs:n,end2:l}}function qt(n,t,e,i){var r=+t,s;if(!isNaN(r)){i||(i=Zet[r].p||(e||[]).length||0),s=1+(r>=128?1:0)+1,i>=128&&++s,i>=16384&&++s,i>=2097152&&++s;var a=n.next(s);r<=127?a.write_shift(1,r):(a.write_shift(1,(r&127)+128),a.write_shift(1,r>>7));for(var l=0;l!=4;++l)if(i>=128)a.write_shift(1,(i&127)+128),i>>=7;else{a.write_shift(1,i);break}i>0&&oA(e)&&n.push(e)}}function $p(n,t,e){var i=Ar(n);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function D3(n,t,e){var i=Ar(n);return i.s=$p(i.s,t.s,e),i.e=$p(i.e,t.s,e),i}function Gp(n,t){if(n.cRel&&n.c<0)for(n=Ar(n);n.c<0;)n.c+=t>8?16384:256;if(n.rRel&&n.r<0)for(n=Ar(n);n.r<0;)n.r+=t>8?1048576:t>5?65536:16384;var e=ri(n);return!n.cRel&&n.cRel!=null&&(e=Vq(e)),!n.rRel&&n.rRel!=null&&(e=$q(e)),e}function Tb(n,t){return n.s.r==0&&!n.s.rRel&&n.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Dn(n.s.c)+":"+(n.e.cRel?"":"$")+Dn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(t.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Fn(n.s.r)+":"+(n.e.rRel?"":"$")+Fn(n.e.r):Gp(n.s,t.biff)+":"+Gp(n.e,t.biff)}function lA(n){return parseInt(Gq(n),10)-1}function Fn(n){return""+(n+1)}function $q(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Gq(n){return n.replace(/\$(\d+)$/,"$1")}function cA(n){for(var t=Wq(n),e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function Dn(n){if(n<0)throw new Error("invalid column "+n);var t="";for(++n;n;n=Math.floor((n-1)/26))t=String.fromCharCode((n-1)%26+65)+t;return t}function Vq(n){return n.replace(/^([A-Z])/,"$$$1")}function Wq(n){return n.replace(/^\$([A-Z])/,"$1")}function Xq(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kn(n){for(var t=0,e=0,i=0;i<n.length;++i){var r=n.charCodeAt(i);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(e=26*e+(r-64))}return{c:e-1,r:t-1}}function ri(n){for(var t=n.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(n.r+1)}function rr(n){var t=n.indexOf(":");return t==-1?{s:Kn(n),e:Kn(n)}:{s:Kn(n.slice(0,t)),e:Kn(n.slice(t+1))}}function Ci(n,t){return typeof t>"u"||typeof t=="number"?Ci(n.s,n.e):(typeof n!="string"&&(n=ri(n)),typeof t!="string"&&(t=ri(t)),n==t?n:n+":"+t)}function h0(n){var t=rr(n);return"$"+Dn(t.s.c)+"$"+Fn(t.s.r)+":$"+Dn(t.e.c)+"$"+Fn(t.e.r)}function p0(n,t){if(!n&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n.replace(/'/g,"''")+"'":n}function Vn(n){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,r=0,s=n.length;for(e=0;i<s&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(t.s.c=--e,e=0;i<s&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;if(t.s.r=--e,i===s||r!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,e=0;i!=s&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(t.e.c=--e,e=0;i!=s&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;return t.e.r=--e,t}function O3(n,t){var e=n.t=="d"&&t instanceof Date;if(n.z!=null)try{return n.w=bl(n.z,e?sr(t):t)}catch{}try{return n.w=bl((n.XF||{}).numFmtId||(e?14:0),e?sr(t):t)}catch{return""+t}}function wl(n,t,e){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&e&&e.dateNF&&(n.z=e.dateNF),n.t=="e"?Vr[n.v]||n.v:t==null?O3(n,n.v):O3(n,t))}function kd(n,t){var e=t&&t.sheet?t.sheet:"Sheet1",i={};return i[e]=n,{SheetNames:[e],Sheets:i}}function Yq(n){var t={},e=n||{};return e.dense&&(t["!data"]=[]),t}function nI(n,t,e){var i=e||{},r=n?n["!data"]!=null:i.dense,s=n||(r?{"!data":[]}:{});r&&!s["!data"]&&(s["!data"]=[]);var a=0,l=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var u=typeof i.origin=="string"?Kn(i.origin):i.origin;a=u.r,l=u.c}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Vn(s["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),a==-1&&(f.e.r=a=s["!ref"]?d.e.r+1:0)}else f.s.c=f.e.c=f.s.r=f.e.r=0;for(var p=[],m=!1,g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");var y=a+g;r&&(s["!data"][y]||(s["!data"][y]=[]),p=s["!data"][y]);for(var x=t[g],_=0;_!=x.length;++_)if(!(typeof x[_]>"u")){var b={v:x[_],t:""},S=l+_;if(f.s.r>y&&(f.s.r=y),f.s.c>S&&(f.s.c=S),f.e.r<y&&(f.e.r=y),f.e.c<S&&(f.e.c=S),m=!0,x[_]&&typeof x[_]=="object"&&!Array.isArray(x[_])&&!(x[_]instanceof Date))b=x[_];else if(Array.isArray(b.v)&&(b.f=x[_][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(i.nullError)b.t="e",b.v=0;else if(i.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?isFinite(b.v)?b.t="n":isNaN(b.v)?(b.t="e",b.v=15):(b.t="e",b.v=7):typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=i.dateNF||Gn[14],i.UTC||(b.v=xx(b.v)),i.cellDates?(b.t="d",b.w=bl(b.z,sr(b.v,i.date1904))):(b.t="n",b.v=sr(b.v,i.date1904),b.w=bl(b.z,b.v))):b.t="s";if(r)p[S]&&p[S].z&&(b.z=p[S].z),p[S]=b;else{var A=Dn(S)+(y+1);s[A]&&s[A].z&&(b.z=s[A].z),s[A]=b}}}return m&&f.s.c<104e5&&(s["!ref"]=Ci(f)),s}function Md(n,t){return nI(null,n,t)}function qq(n){return n.read_shift(4,"i")}function ka(n,t){return t||(t=jt(4)),t.write_shift(4,n),t}function Er(n){var t=n.read_shift(4);return t===0?"":n.read_shift(t,"dbcs")}function Fi(n,t){var e=!1;return t==null&&(e=!0,t=jt(4+2*n.length)),t.write_shift(4,n.length),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}function Kq(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function Zq(n,t){return t||(t=jt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function uA(n,t){var e=n.l,i=n.read_shift(1),r=Er(n),s=[],a={t:r,h:r};if((i&1)!==0){for(var l=n.read_shift(4),u=0;u!=l;++u)s.push(Kq(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=e+t,a}function Qq(n,t){var e=!1;return t==null&&(e=!0,t=jt(15+4*n.t.length)),t.write_shift(1,0),Fi(n.t,t),e?t.slice(0,t.l):t}var Jq=uA;function tK(n,t){var e=!1;return t==null&&(e=!0,t=jt(23+4*n.t.length)),t.write_shift(1,1),Fi(n.t,t),t.write_shift(4,1),Zq({},t),e?t.slice(0,t.l):t}function ha(n){var t=n.read_shift(4),e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:t,iStyleRef:e}}function zu(n,t){return t==null&&(t=jt(8)),t.write_shift(-4,n.c),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}function Hu(n){var t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:t}}function $u(n,t){return t==null&&(t=jt(4)),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}var eK=Er,iI=Fi;function yx(n){var t=n.read_shift(4);return t===0||t===4294967295?"":n.read_shift(t,"dbcs")}function m0(n,t){var e=!1;return t==null&&(e=!0,t=jt(127)),t.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}var nK=Er,aE=yx,fA=m0;function dA(n){var t=n.slice(n.l,n.l+4),e=t[0]&1,i=t[0]&2;n.l+=4;var r=i===0?v1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):uu(t,0)>>2;return e?r/100:r}function rI(n,t){t==null&&(t=jt(4));var e=0,i=0,r=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?i=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(i=1,e=1),i)t.write_shift(-4,((e?r:n)<<2)+(e+2));else throw new Error("unsupported RkNumber "+n)}function sI(n){var t={s:{},e:{}};return t.s.r=n.read_shift(4),t.e.r=n.read_shift(4),t.s.c=n.read_shift(4),t.e.c=n.read_shift(4),t}function iK(n,t){return t||(t=jt(16)),t.write_shift(4,n.s.r),t.write_shift(4,n.e.r),t.write_shift(4,n.s.c),t.write_shift(4,n.e.c),t}var Gu=sI,Fd=iK;function Pd(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Nu(n,t){return(t||jt(8)).write_shift(8,n,"f")}function rK(n){var t={},e=n.read_shift(1),i=e>>>1,r=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),l=n.read_shift(1),u=n.read_shift(1);switch(n.l++,i){case 0:t.auto=1;break;case 1:t.index=r;var f=hK[r];f&&(t.rgb=z3(f));break;case 2:t.rgb=z3([a,l,u]);break;case 3:t.theme=r;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function x1(n,t){if(t||(t=jt(8)),!n||n.auto)return t.write_shift(4,0),t.write_shift(4,0),t;n.index!=null?(t.write_shift(1,2),t.write_shift(1,n.index)):n.theme!=null?(t.write_shift(1,6),t.write_shift(1,n.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=n.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!n.rgb||n.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=n.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function sK(n){var t=n.read_shift(1);n.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function aK(n,t){t||(t=jt(2));var e=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var aI=2,Cs=3,ev=11,y1=19,nv=64,oK=65,lK=71,cK=4108,uK=4126,Qi=80,R3={1:{n:"CodePage",t:aI},2:{n:"Category",t:Qi},3:{n:"PresentationFormat",t:Qi},4:{n:"ByteCount",t:Cs},5:{n:"LineCount",t:Cs},6:{n:"ParagraphCount",t:Cs},7:{n:"SlideCount",t:Cs},8:{n:"NoteCount",t:Cs},9:{n:"HiddenCount",t:Cs},10:{n:"MultimediaClipCount",t:Cs},11:{n:"ScaleCrop",t:ev},12:{n:"HeadingPairs",t:cK},13:{n:"TitlesOfParts",t:uK},14:{n:"Manager",t:Qi},15:{n:"Company",t:Qi},16:{n:"LinksUpToDate",t:ev},17:{n:"CharacterCount",t:Cs},19:{n:"SharedDoc",t:ev},22:{n:"HyperlinksChanged",t:ev},23:{n:"AppVersion",t:Cs,p:"version"},24:{n:"DigSig",t:oK},26:{n:"ContentType",t:Qi},27:{n:"ContentStatus",t:Qi},28:{n:"Language",t:Qi},29:{n:"Version",t:Qi},255:{},2147483648:{n:"Locale",t:y1},2147483651:{n:"Behavior",t:y1},1919054434:{}},N3={1:{n:"CodePage",t:aI},2:{n:"Title",t:Qi},3:{n:"Subject",t:Qi},4:{n:"Author",t:Qi},5:{n:"Keywords",t:Qi},6:{n:"Comments",t:Qi},7:{n:"Template",t:Qi},8:{n:"LastAuthor",t:Qi},9:{n:"RevNumber",t:Qi},10:{n:"EditTime",t:nv},11:{n:"LastPrinted",t:nv},12:{n:"CreatedDate",t:nv},13:{n:"ModifiedDate",t:nv},14:{n:"PageCount",t:Cs},15:{n:"WordCount",t:Cs},16:{n:"CharCount",t:Cs},17:{n:"Thumbnail",t:lK},18:{n:"Application",t:Qi},19:{n:"DocSecurity",t:Cs},255:{},2147483648:{n:"Locale",t:y1},2147483651:{n:"Behavior",t:y1},1919054434:{}};function fK(n){return n.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var dK=fK([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),hK=Ar(dK),Vr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vo={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pK=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],mK={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},iv={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function oI(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lI(n,t,e){var i=gq(mK),r=[],s;r[r.length]=Di,r[r.length]=se("Types",null,{xmlns:Hi.CT,"xmlns:xsd":Hi.xsd,"xmlns:xsi":Hi.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return se("Default",null,{Extension:f[0],ContentType:f[1]})}));var a=function(f){n[f]&&n[f].length>0&&(s=n[f][0],r[r.length]=se("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:iv[f][t.bookType]||iv[f].xlsx}))},l=function(f){(n[f]||[]).forEach(function(d){r[r.length]=se("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:iv[f][t.bookType]||iv[f].xlsx})})},u=function(f){(n[f]||[]).forEach(function(d){r[r.length]=se("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:i[f][0]})})};return a("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var un={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function cI(n){var t=n.lastIndexOf("/");return n.slice(0,t+1)+"_rels/"+n.slice(t+1)+".rels"}function nd(n){var t=[Di,se("Relationships",null,{xmlns:Hi.RELS})];return Ti(n["!id"]).forEach(function(e){t[t.length]=se("Relationship",null,n["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function yn(n,t,e,i,r,s){if(r||(r={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),t<0)for(t=n["!idx"];n["!id"]["rId"+t];++t);if(n["!idx"]=t+1,r.Id="rId"+t,r.Type=i,r.Target=e,[un.HLINK,un.XPATH,un.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),n["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return n["!id"][r.Id]=r,n[("/"+r.Target).replace("//","/")]=r,t}function gK(n){var t=[Di];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<n.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+n[e][0]+'" manifest:media-type="'+n[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function L3(n,t,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function vK(n,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function xK(n){var t=[Di];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=n.length;++e)t.push(L3(n[e][0],n[e][1])),t.push(vK("",n[e][0]));return t.push(L3("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function uI(n,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+c1.version+"</meta:generator></office:meta></office:document-meta>"}var _u=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Cb(n,t,e,i,r){r[n]!=null||t==null||t===""||(r[n]=t,t=qe(t),i[i.length]=e?se(n,t,e):er(n,t))}function fI(n,t){var e=t||{},i=[Di,se("cp:coreProperties",null,{"xmlns:cp":Hi.CORE_PROPS,"xmlns:dc":Hi.dc,"xmlns:dcterms":Hi.dcterms,"xmlns:dcmitype":Hi.dcmitype,"xmlns:xsi":Hi.xsi})],r={};if(!n&&!e.Props)return i.join("");n&&(n.CreatedDate!=null&&Cb("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:sE(n.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),n.ModifiedDate!=null&&Cb("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:sE(n.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var s=0;s!=_u.length;++s){var a=_u[s],l=e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:n?n[a[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Cb(a[0],l,null,i,r)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var id=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],dI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hI(n){var t=[],e=se;return n||(n={}),n.Application="SheetJS",t[t.length]=Di,t[t.length]=se("Properties",null,{xmlns:Hi.EXT_PROPS,"xmlns:vt":Hi.vt}),id.forEach(function(i){if(n[i[1]]!==void 0){var r;switch(i[2]){case"string":r=qe(String(n[i[1]]));break;case"bool":r=n[i[1]]?"true":"false";break}r!==void 0&&(t[t.length]=e(i[0],r))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",n.SheetNames.map(function(i){return"<vt:lpstr>"+qe(i)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function pI(n){var t=[Di,se("Properties",null,{xmlns:Hi.CUST_PROPS,"xmlns:vt":Hi.vt})];if(!n)return t.join("");var e=1;return Ti(n).forEach(function(r){++e,t[t.length]=se("property",kq(n[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:qe(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var I3={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function yK(n,t){var e=[];return Ti(I3).map(function(i){for(var r=0;r<_u.length;++r)if(_u[r][1]==i)return _u[r];for(r=0;r<id.length;++r)if(id[r][1]==i)return id[r];throw i}).forEach(function(i){if(n[i[1]]!=null){var r=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:n[i[1]];switch(i[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),e.push(er(I3[i[1]]||i[1],r))}}),se("DocumentProperties",e.join(""),{xmlns:Rs.o})}function _K(n,t){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",r=[];return n&&Ti(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<_u.length;++a)if(s==_u[a][1])return;for(a=0;a<id.length;++a)if(s==id[a][1])return;for(a=0;a<e.length;++a)if(s==e[a])return;var l=n[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l=String(l),r.push(se(_3(s),l,{"dt:dt":u}))}}),t&&Ti(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a instanceof Date?(l="dateTime.tz",a=a.toISOString()):a=String(a),r.push(se(_3(s),a,{"dt:dt":l}))}}),"<"+i+' xmlns="'+Rs.o+'">'+r.join("")+"</"+i+">"}function bK(n){var t=typeof n=="string"?new Date(Date.parse(n)):n,e=t.getTime()/1e3+11644473600,i=e%Math.pow(2,32),r=(e-i)/Math.pow(2,32);i*=1e7,r*=1e7;var s=i/Math.pow(2,32)|0;s>0&&(i=i%Math.pow(2,32),r+=s);var a=jt(8);return a.write_shift(4,i),a.write_shift(4,r),a}function k3(n,t){var e=jt(4),i=jt(4);switch(e.write_shift(4,n==80?31:n),n){case 3:i.write_shift(-4,t);break;case 5:i=jt(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=bK(t);break;case 31:case 80:for(i=jt(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+t)}return Si([e,i])}var mI=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function wK(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function M3(n,t,e){var i=jt(8),r=[],s=[],a=8,l=0,u=jt(8),f=jt(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),s.push(u),r.push(f),a+=8+u.length,!t){f=jt(8),f.write_shift(4,0),r.unshift(f);var d=[jt(4)];for(d[0].write_shift(4,n.length),l=0;l<n.length;++l){var p=n[l][0];for(u=jt(8+2*(p.length+1)+(p.length%2?0:2)),u.write_shift(4,l+2),u.write_shift(4,p.length+1),u.write_shift(0,p,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=Si(d),s.unshift(u),a+=8+u.length}for(l=0;l<n.length;++l)if(!(t&&!t[n[l][0]])&&!(mI.indexOf(n[l][0])>-1||dI.indexOf(n[l][0])>-1)&&n[l][1]!=null){var m=n[l][1],g=0;if(t){g=+t[n[l][0]];var y=e[g];if(y.p=="version"&&typeof m=="string"){var x=m.split(".");m=(+x[0]<<16)+(+x[1]||0)}u=k3(y.t,m)}else{var _=wK(m);_==-1&&(_=31,m=String(m)),u=k3(_,m)}s.push(u),f=jt(8),f.write_shift(4,t?g:2+l),r.push(f),a+=8+u.length}var b=8*(s.length+1);for(l=0;l<s.length;++l)r[l].write_shift(4,b),b+=s[l].length;return i.write_shift(4,a),i.write_shift(4,s.length),Si([i].concat(r).concat(s))}function F3(n,t,e,i,r,s){var a=jt(r?68:48),l=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Un.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,r?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,r?68:48);var u=M3(n,e,i);if(l.push(u),r){var f=M3(r,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+u.length),l.push(f)}return Si(l)}function EK(n,t){t||(t=jt(n));for(var e=0;e<n;++e)t.write_shift(1,0);return t}function AK(n,t){return n.read_shift(t)===1}function _r(n,t){return t||(t=jt(2)),t.write_shift(2,+!!n),t}function Gv(n){return n.read_shift(2,"u")}function sa(n,t){return t||(t=jt(2)),t.write_shift(2,n),t}function gI(n,t,e){return e||(e=jt(2)),e.write_shift(1,t=="e"?+n:+!!n),e.write_shift(1,t=="e"?1:0),e}function vI(n,t,e){var i=n.read_shift(e&&e.biff>=12?2:1),r="sbcs-cont",s=ll;if(e&&e.biff>=8&&(ll=1200),!e||e.biff==8){var a=n.read_shift(1);a&&(r="dbcs-cont")}else e.biff==12&&(r="wstr");e.biff>=2&&e.biff<=5&&(r="cpstr");var l=i?n.read_shift(i,r):"";return ll=s,l}function SK(n){var t=n.t||"",e=jt(3);e.write_shift(2,t.length),e.write_shift(1,1);var i=jt(2*t.length);i.write_shift(2*t.length,t,"utf16le");var r=[e,i];return Si(r)}function TK(n,t,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return n.read_shift(t,"cpstr");if(e.biff>=12)return n.read_shift(t,"dbcs-cont")}var r=n.read_shift(1);return r===0?i=n.read_shift(t,"sbcs-cont"):i=n.read_shift(t,"dbcs-cont"),i}function CK(n,t,e){var i=n.read_shift(e&&e.biff==2?1:2);return i===0?(n.l++,""):TK(n,i,e)}function DK(n,t,e){if(e.biff>5)return CK(n,t,e);var i=n.read_shift(1);return i===0?(n.l++,""):n.read_shift(i,e.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function xI(n,t,e){return e||(e=jt(3+2*n.length)),e.write_shift(2,n.length),e.write_shift(1,1),e.write_shift(31,n,"utf16le"),e}function P3(n,t){t||(t=jt(6+n.length*2)),t.write_shift(4,1+n.length);for(var e=0;e<n.length;++e)t.write_shift(2,n.charCodeAt(e));return t.write_shift(2,0),t}function OK(n){var t=jt(512),e=0,i=n.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var r=i.indexOf("#"),s=r>-1?31:23;switch(i.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)t.write_shift(4,a[e]);if(s==28)i=i.slice(1),P3(i,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));var l=r>-1?i.slice(0,r):i;for(t.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)t.write_shift(2,l.charCodeAt(e));t.write_shift(2,0),s&8&&P3(r>-1?i.slice(r+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));for(var u=0;i.slice(u*3,u*3+3)=="../"||i.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,i.length-3*u+1),e=0;e<i.length-3*u;++e)t.write_shift(1,i.charCodeAt(e+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function Lu(n,t,e,i){return i||(i=jt(6)),i.write_shift(2,n),i.write_shift(2,t),i.write_shift(2,e||0),i}function RK(n,t,e){var i=e.biff>8?4:2,r=n.read_shift(i),s=n.read_shift(i,"i"),a=n.read_shift(i,"i");return[r,s,a]}function NK(n){var t=n.read_shift(2),e=n.read_shift(2),i=n.read_shift(2),r=n.read_shift(2);return{s:{c:i,r:t},e:{c:r,r:e}}}function yI(n,t){return t||(t=jt(8)),t.write_shift(2,n.s.r),t.write_shift(2,n.e.r),t.write_shift(2,n.s.c),t.write_shift(2,n.e.c),t}function hA(n,t,e){var i=1536,r=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=jt(r);return s.write_shift(2,i),s.write_shift(2,t),r>4&&s.write_shift(2,29282),r>6&&s.write_shift(2,1997),r>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function LK(n,t){var e=!t||t.biff==8,i=jt(e?112:54);for(i.write_shift(t.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function IK(n,t){var e=!t||t.biff>=8?2:1,i=jt(8+e*n.name.length);i.write_shift(4,n.pos),i.write_shift(1,n.hs||0),i.write_shift(1,n.dt),i.write_shift(1,n.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(e*n.name.length,n.name,t.biff<8?"sbcs":"utf16le");var r=i.slice(0,i.l);return r.l=i.l,r}function kK(n,t){var e=jt(8);e.write_shift(4,n.Count),e.write_shift(4,n.Unique);for(var i=[],r=0;r<n.length;++r)i[r]=SK(n[r]);var s=Si([e].concat(i));return s.parts=[e.length].concat(i.map(function(a){return a.length})),s}function MK(){var n=jt(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function FK(n){var t=jt(18),e=1718;return n&&n.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function PK(n,t){var e=n.name||"Arial",i=t&&t.biff==5,r=i?15+e.length:16+2*e.length,s=jt(r);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,e.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),s}function BK(n,t,e,i){var r=jt(10);return Lu(n,t,i,r),r.write_shift(4,e),r}function jK(n,t,e,i,r){var s=!r||r.biff==8,a=jt(8+ +s+(1+s)*e.length);return Lu(n,t,i,a),a.write_shift(2,e.length),s&&a.write_shift(1,1),a.write_shift((1+s)*e.length,e,s?"utf16le":"sbcs"),a}function UK(n,t,e,i){var r=e&&e.biff==5;i||(i=jt(r?3+t.length:5+2*t.length)),i.write_shift(2,n),i.write_shift(r?1:2,t.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var s=i.length>i.l?i.slice(0,i.l):i;return s.l==null&&(s.l=s.length),s}function zK(n){var t=jt(1+n.length);return t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t}function HK(n){var t=jt(3+n.length);return t.l+=2,t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t}function $K(n,t){var e=t.biff==8||!t.biff?4:2,i=jt(2*e+6);return i.write_shift(e,n.s.r),i.write_shift(e,n.e.r+1),i.write_shift(2,n.s.c),i.write_shift(2,n.e.c+1),i.write_shift(2,0),i}function B3(n,t,e,i){var r=e&&e.biff==5;i||(i=jt(r?16:20)),i.write_shift(2,0),n.style?(i.write_shift(2,n.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,n.numFmtId||0),i.write_shift(2,t<<4));var s=0;return n.numFmtId>0&&r&&(s|=1024),i.write_shift(4,s),i.write_shift(4,0),r||i.write_shift(4,0),i.write_shift(2,0),i}function GK(n){var t=jt(4);return t.l+=2,t.write_shift(1,n.numFmtId),t.l++,t}function _I(n){var t=jt(12);return t.l++,t.write_shift(1,n.numFmtId),t.l+=10,t}var VK=_I;function WK(n){var t=jt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Db(n,t,e,i,r,s){var a=jt(8);return Lu(n,t,i,a),gI(e,s,a),a}function XK(n,t,e,i){var r=jt(14);return Lu(n,t,i,r),Nu(e,r),r}function YK(n,t,e){if(e.biff<8||!(e.biff>8)&&t==n[n.l]+(n[n.l+1]==3?1:0)+1)return j3(n,t,e);for(var i=[],r=n.l+t,s=n.read_shift(e.biff>8?4:2);s--!==0;)i.push(RK(n,e.biff>8?12:6,e));if(n.l!=r)throw new Error("Bad ExternSheet: "+n.l+" != "+r);return i}function j3(n,t,e){n[n.l+1]==3&&n[n.l]++;var i=vI(n,t,e);return i.charCodeAt(0)==3?i.slice(1):i}function Ob(n,t,e,i){var r=jt(6+(i||n.length));return r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,i||n.length),r.write_shift(n.length,n,"sbcs"),r}function qK(n){var t=jt(2+n.length*8);t.write_shift(2,n.length);for(var e=0;e<n.length;++e)yI(n[e],t);return t}function KK(n){var t=jt(24),e=Kn(n[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(i[r],16));return Si([t,OK(n[1])])}function ZK(n){var t=n[1].Tooltip,e=jt(10+2*(t.length+1));e.write_shift(2,2048);var i=Kn(n[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function QK(n){return n||(n=jt(4)),n.write_shift(2,1),n.write_shift(2,1),n}function JK(n,t,e){if(!e.cellStyles)return _o(n,t);var i=e&&e.biff>=12?4:2,r=n.read_shift(i),s=n.read_shift(i),a=n.read_shift(i),l=n.read_shift(i),u=n.read_shift(2);i==2&&(n.l+=2);var f={s:r,e:s,w:a,ixfe:l,flags:u};return(e.biff>=5||!e.biff)&&(f.level=u>>8&7),f}function tZ(n,t){var e=jt(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,n.width*256),e.write_shift(2,0);var i=0;return n.hidden&&(i|=1),e.write_shift(1,i),i=n.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function eZ(n){for(var t=jt(2*n),e=0;e<n;++e)t.write_shift(2,e+1);return t}function $0(n,t,e,i,r){return n||(n=jt(7)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,i||0),n.write_shift(1,r||0),n.write_shift(1,0),n}function nZ(n,t,e,i,r){var s=jt(15);return $0(s,n,t,i||0,r||0),s.write_shift(8,e,"f"),s}function iZ(n,t,e,i,r){var s=jt(9);return $0(s,n,t,i||0,r||0),s.write_shift(2,e),s}var rZ=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=eA({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,u){var f=[],d=Du(1);switch(u.type){case"base64":d=Os(wc(l));break;case"binary":d=Os(l);break;case"buffer":case"array":d=l;break}Ur(d,0);var p=d.read_shift(1),m=!!(p&136),g=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:g=!0,m=!0;break;case 49:g=!0,m=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var x=0,_=521;p==2&&(x=d.read_shift(2)),d.l+=3,p!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),p!=2&&(_=d.read_shift(2));var b=d.read_shift(2);u.codepage,p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&n[d[d.l]],d.l+=1,d.l+=2),y&&(d.l+=36);for(var S=[],A={},C=Math.min(d.length,p==2?521:_-10-(g?264:0)),O=y?32:11;d.l<C&&d[d.l]!=13;)switch(A={},A.name=Ou(d.slice(d.l,d.l+O)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=O,A.type=String.fromCharCode(d.read_shift(1)),p!=2&&!y&&(A.offset=d.read_shift(4)),A.len=d.read_shift(1),p==2&&(A.offset=d.read_shift(2)),A.dec=d.read_shift(1),A.name.length&&S.push(A),p!=2&&(d.l+=y?13:14),A.type){case"B":(!g||A.len!=8)&&u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(d[d.l]!==13&&(d.l=_-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=_;var N=0,D=0;for(f[0]=[],D=0;D!=S.length;++D)f[0][D]=S[D].name;for(;x-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,f[++N]=[],D=0,D=0;D!=S.length;++D){var L=d.slice(d.l,d.l+S[D].len);d.l+=S[D].len,Ur(L,0);var I=Ou(L);switch(S[D].type){case"C":I.trim().length&&(f[N][D]=I.replace(/([^\s])\s+$/,"$1"));break;case"D":I.length===8?(f[N][D]=new Date(Date.UTC(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8),0,0,0,0)),u&&u.UTC||(f[N][D]=bd(f[N][D]))):f[N][D]=I;break;case"F":f[N][D]=parseFloat(I.trim());break;case"+":case"I":f[N][D]=y?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":f[N][D]=!0;break;case"N":case"F":f[N][D]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[N][D]="##MEMO##"+(y?parseInt(I.trim(),10):L.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(f[N][D]=+I||0);break;case"@":f[N][D]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":{var z=L.read_shift(4),j=L.read_shift(4);if(z==0&&j==0)break;f[N][D]=new Date((z-2440588)*864e5+j),u&&u.UTC||(f[N][D]=bd(f[N][D]))}break;case"Y":f[N][D]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[N][D]=-L.read_shift(-8,"f");break;case"B":if(g&&S[D].len==8){f[N][D]=L.read_shift(8,"f");break}case"G":case"P":L.l+=S[D].len;break;case"0":if(S[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[D].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=S,f}function i(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=Md(e(l,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function r(l,u){try{var f=kd(i(l,u),u);return f.bookType="dbf",f}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,u){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var f=u||{},d=ll;if(+f.codepage>=0&&u0(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=wr(),m=uE(l,{header:1,raw:!0,cellDates:!0}),g=m[0],y=m.slice(1),x=l["!cols"]||[],_=0,b=0,S=0,A=1;for(_=0;_<g.length;++_){if(((x[_]||{}).DBF||{}).name){g[_]=x[_].DBF.name,++S;continue}if(g[_]!=null){if(++S,typeof g[_]=="number"&&(g[_]=g[_].toString(10)),typeof g[_]!="string")throw new Error("DBF Invalid column name "+g[_]+" |"+typeof g[_]+"|");if(g.indexOf(g[_])!==_){for(b=0;b<1024;++b)if(g.indexOf(g[_]+"_"+b)==-1){g[_]+="_"+b;break}}}}var C=Vn(l["!ref"]),O=[],N=[],D=[];for(_=0;_<=C.e.c-C.s.c;++_){var L="",I="",z=0,j=[];for(b=0;b<y.length;++b)y[b][_]!=null&&j.push(y[b][_]);if(j.length==0||g[_]==null){O[_]="?";continue}for(b=0;b<j.length;++b){switch(typeof j[b]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=j[b]instanceof Date?"D":"C";break;default:I="C"}z=Math.max(z,String(j[b]).length),L=L&&L!=I?"C":I}z>250&&(z=250),I=((x[_]||{}).DBF||{}).type,I=="C"&&x[_].DBF.len>z&&(z=x[_].DBF.len),L=="B"&&I=="N"&&(L="N",D[_]=x[_].DBF.dec,z=x[_].DBF.len),N[_]=L=="C"||I=="N"?z:s[L]||0,A+=N[_],O[_]=L}var B=p.next(32);for(B.write_shift(4,318902576),B.write_shift(4,y.length),B.write_shift(2,296+32*S),B.write_shift(2,A),_=0;_<4;++_)B.write_shift(4,0);var tt=+t[ll]||3;for(B.write_shift(4,0|tt<<8),n[tt]!=+f.codepage&&(f.codepage&&console.error("DBF Unsupported codepage "+ll+", using 1252"),ll=1252),_=0,b=0;_<g.length;++_)if(g[_]!=null){var k=p.next(32),et=(g[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,et,"sbcs"),k.write_shift(1,O[_]=="?"?"C":O[_],"sbcs"),k.write_shift(4,b),k.write_shift(1,N[_]||s[O[_]]||0),k.write_shift(1,D[_]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),b+=N[_]||s[O[_]]||0}var K=p.next(264);for(K.write_shift(4,13),_=0;_<65;++_)K.write_shift(4,0);for(_=0;_<y.length;++_){var q=p.next(A);for(q.write_shift(1,0),b=0;b<g.length;++b)if(g[b]!=null)switch(O[b]){case"L":q.write_shift(1,y[_][b]==null?63:y[_][b]?84:70);break;case"B":q.write_shift(8,y[_][b]||0,"f");break;case"N":var _t="0";for(typeof y[_][b]=="number"&&(_t=y[_][b].toFixed(D[b]||0)),_t.length>N[b]&&(_t=_t.slice(0,N[b])),S=0;S<N[b]-_t.length;++S)q.write_shift(1,32);q.write_shift(1,_t,"sbcs");break;case"D":y[_][b]?(q.write_shift(4,("0000"+y[_][b].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(y[_][b].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+y[_][b].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var at=q.l,P=String(y[_][b]!=null?y[_][b]:"").slice(0,N[b]);for(q.write_shift(1,P,"cpstr"),at+=N[b]-q.l,S=0;S<at;++S)q.write_shift(1,32);break}}return ll=d,p.next(1).write_shift(1,26),p.end()}return{to_workbook:r,to_sheet:i,from_sheet:a}}(),sZ=function(){var n={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ti(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+Ti(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var e=function(g,y){var x=n[y];return typeof x=="number"?l3(x):x},i=function(g,y,x){var _=y.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return _==59?g:l3(_)};n["|"]=254;var r=function(g){return g.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function s(g,y){switch(y.type){case"base64":return a(wc(g),y);case"binary":return a(g,y);case"buffer":return a(_n&&Buffer.isBuffer(g)?g.toString("binary"):Ou(g),y);case"array":return a(nA(g),y)}throw new Error("Unrecognized type "+y.type)}function a(g,y){var x=g.split(/[\n\r]+/),_=-1,b=-1,S=0,A=0,C=[],O=[],N=null,D={},L=[],I=[],z=[],j=0,B,tt={Workbook:{WBProps:{},Names:[]}};for(+y.codepage>=0&&u0(+y.codepage);S!==x.length;++S){j=0;var k=x[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,e),et=k.replace(/;;/g,"\0").split(";").map(function(ot){return ot.replace(/\u0000/g,";")}),K=et[0],q;if(k.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":for(A=1;A<et.length;++A)switch(et[A].charAt(0)){case"V":{var _t=parseInt(et[A].slice(1),10);_t>=1&&_t<=4&&(tt.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(et[1].charAt(0)){case"P":O.push(k.slice(3).replace(/;;/g,";"));break}break;case"NN":{var at={Sheet:0};for(A=1;A<et.length;++A)switch(et[A].charAt(0)){case"N":at.Name=et[A].slice(1);break;case"E":at.Ref=(y&&y.sheet||"Sheet1")+"!"+G3(et[A].slice(1));break}tt.Workbook.Names.push(at)}break;case"C":var P=!1,X=!1,V=!1,it=!1,ht=-1,yt=-1,Rt="",Et="z",G="";for(A=1;A<et.length;++A)switch(et[A].charAt(0)){case"A":G=et[A].slice(1);break;case"X":b=parseInt(et[A].slice(1),10)-1,X=!0;break;case"Y":for(_=parseInt(et[A].slice(1),10)-1,X||(b=0),B=C.length;B<=_;++B)C[B]=[];break;case"K":q=et[A].slice(1),q.charAt(0)==='"'?(q=q.slice(1,q.length-1),Et="s"):q==="TRUE"||q==="FALSE"?(q=q==="TRUE",Et="b"):q.charAt(0)=="#"&&vo[q]!=null?(Et="e",q=vo[q]):isNaN(ml(q))||(q=ml(q),Et="n",N!==null&&Ru(N)&&y.cellDates&&(q=td(tt.Workbook.WBProps.date1904?q+1462:q),Et=typeof q=="number"?"n":"d")),P=!0;break;case"E":it=!0,Rt=G3(et[A].slice(1),{r:_,c:b});break;case"S":V=!0;break;case"G":break;case"R":ht=parseInt(et[A].slice(1),10)-1;break;case"C":yt=parseInt(et[A].slice(1),10)-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+k)}if(P&&(C[_][b]?(C[_][b].t=Et,C[_][b].v=q):C[_][b]={t:Et,v:q},N&&(C[_][b].z=N),y.cellText!==!1&&N&&(C[_][b].w=bl(C[_][b].z,C[_][b].v,{date1904:tt.Workbook.WBProps.date1904})),N=null),V){if(it)throw new Error("SYLK shared formula cannot have own formula");var lt=ht>-1&&C[ht][yt];if(!lt||!lt[1])throw new Error("SYLK shared formula cannot find base");Rt=aQ(lt[1],{r:_-ht,c:b-yt})}Rt&&(C[_][b]?C[_][b].f=Rt:C[_][b]={t:"n",f:Rt}),G&&(C[_][b]||(C[_][b]={t:"z"}),C[_][b].c=[{a:"SheetJSYLK",t:G}]);break;case"F":var rt=0;for(A=1;A<et.length;++A)switch(et[A].charAt(0)){case"X":b=parseInt(et[A].slice(1),10)-1,++rt;break;case"Y":for(_=parseInt(et[A].slice(1),10)-1,B=C.length;B<=_;++B)C[B]=[];break;case"M":j=parseInt(et[A].slice(1),10)/20;break;case"F":break;case"G":break;case"P":N=O[parseInt(et[A].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(z=et[A].slice(1).split(" "),B=parseInt(z[0],10);B<=parseInt(z[1],10);++B)j=parseInt(z[2],10),I[B-1]=j===0?{hidden:!0}:{wch:j};break;case"C":b=parseInt(et[A].slice(1),10)-1,I[b]||(I[b]={});break;case"R":_=parseInt(et[A].slice(1),10)-1,L[_]||(L[_]={}),j>0?(L[_].hpt=j,L[_].hpx=AI(j)):j===0&&(L[_].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+k)}rt<1&&(N=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+k)}}return L.length>0&&(D["!rows"]=L),I.length>0&&(D["!cols"]=I),I.forEach(function(ot){pA(ot)}),y&&y.sheetRows&&(C=C.slice(0,y.sheetRows)),[C,D,tt]}function l(g,y){var x=s(g,y),_=x[0],b=x[1],S=x[2],A=Ar(y);A.date1904=(((S||{}).Workbook||{}).WBProps||{}).date1904;var C=Md(_,A);Ti(b).forEach(function(N){C[N]=b[N]});var O=kd(C,y);return Ti(S).forEach(function(N){O[N]=S[N]}),O.bookType="sylk",O}function u(g,y,x,_,b,S){var A="C;Y"+(x+1)+";X"+(_+1)+";K";switch(g.t){case"n":A+=isFinite(g.v)?g.v||0:Vr[isNaN(g.v)?36:7],g.f&&!g.F&&(A+=";E"+bx(g.f,{r:x,c:_}));break;case"b":A+=g.v?"TRUE":"FALSE";break;case"e":A+=g.w||Vr[g.v]||g.v;break;case"d":A+=sr(hs(g.v,S),S);break;case"s":A+='"'+(g.v==null?"":String(g.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function f(g,y,x){var _="C;Y"+(y+1)+";X"+(x+1)+";A";return _+=r(g.map(function(b){return b.t}).join("")),_}function d(g,y){y.forEach(function(x,_){var b="F;W"+(_+1)+" "+(_+1)+" ";x.hidden?b+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=_1(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=b1(x.wpx)),typeof x.wch=="number"&&(b+=Math.round(x.wch))),b.charAt(b.length-1)!=" "&&g.push(b)})}function p(g,y){y.forEach(function(x,_){var b="F;";x.hidden?b+="M0;":x.hpt?b+="M"+20*x.hpt+";":x.hpx&&(b+="M"+20*w1(x.hpx)+";"),b.length>2&&g.push(b+"R"+(_+1))})}function m(g,y,x){y||(y={}),y._formats=["General"];var _=["ID;PSheetJS;N;E"],b=[],S=Vn(g["!ref"]||"A1"),A,C=g["!data"]!=null,O=`\r
`,N=(((x||{}).Workbook||{}).WBProps||{}).date1904,D="General";_.push("P;PGeneral");var L=S.s.r,I=S.s.c,z=[];if(g["!ref"]){for(L=S.s.r;L<=S.e.r;++L)if(!(C&&!g["!data"][L])){for(z=[],I=S.s.c;I<=S.e.c;++I)A=C?g["!data"][L][I]:g[Dn(I)+Fn(L)],!(!A||!A.c)&&z.push(f(A.c,L,I));z.length&&b.push(z.join(O))}}if(g["!ref"]){for(L=S.s.r;L<=S.e.r;++L)if(!(C&&!g["!data"][L])){for(z=[],I=S.s.c;I<=S.e.c;++I)if(A=C?g["!data"][L][I]:g[Dn(I)+Fn(L)],!(!A||A.v==null&&(!A.f||A.F))){if((A.z||(A.t=="d"?Gn[14]:"General"))!=D){var j=y._formats.indexOf(A.z);j==-1&&(y._formats.push(A.z),j=y._formats.length-1,_.push("P;P"+A.z.replace(/;/g,";;"))),z.push("F;P"+j+";Y"+(L+1)+";X"+(I+1))}z.push(u(A,g,L,I,y,N))}b.push(z.join(O))}}return _.push("F;P0;DG0G8;M255"),g["!cols"]&&d(_,g["!cols"]),g["!rows"]&&p(_,g["!rows"]),g["!ref"]&&_.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" ")),_.push("O;L;D;B"+(N?";V4":"")+";K47;G100 0.001"),delete y._formats,_.join(O)+O+b.join(O)+O+"E"+O}return{to_workbook:l,from_sheet:m}}(),aZ=function(){function n(l,u){switch(u.type){case"base64":return t(wc(l),u);case"binary":return t(l,u);case"buffer":return t(_n&&Buffer.isBuffer(l)?l.toString("binary"):Ou(l),u);case"array":return t(nA(l),u)}throw new Error("Unrecognized type "+u.type)}function t(l,u){for(var f=l.split(`
`),d=-1,p=-1,m=0,g=[];m!==f.length;++m){if(f[m].trim()==="BOT"){g[++d]=[],p=0;continue}if(!(d<0)){var y=f[m].trim().split(","),x=y[0],_=y[1];++m;for(var b=f[m]||"";(b.match(/["]/g)||[]).length&1&&m<f.length-1;)b+=`
`+f[++m];switch(b=b.trim(),+x){case-1:if(b==="BOT"){g[++d]=[],p=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?g[d][p]=!0:b==="FALSE"?g[d][p]=!1:isNaN(ml(_))?isNaN(g1(_).getDate())?g[d][p]=_:(g[d][p]=hs(_),u&&u.UTC||(g[d][p]=bd(g[d][p]))):g[d][p]=ml(_),++p;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),g[d][p++]=b!==""?b:null;break}if(b==="EOD")break}}return u&&u.sheetRows&&(g=g.slice(0,u.sheetRows)),g}function e(l,u){return Md(n(l,u),u)}function i(l,u){var f=kd(e(l,u),u);return f.bookType="dif",f}function r(l,u){return"0,"+String(l)+`\r
`+u}function s(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function a(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var u=Vn(l["!ref"]),f=l["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(u.e.r-u.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(u.e.c-u.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],p=u.s.r;p<=u.e.r;++p){for(var m=f?l["!data"][p]:[],g=`-1,0\r
BOT\r
`,y=u.s.c;y<=u.e.c;++y){var x=f?m&&m[y]:l[ri({r:p,c:y})];if(x==null){g+=`1,0\r
""\r
`;continue}switch(x.t){case"n":x.w!=null?g+="0,"+x.w+`\r
V`:x.v!=null?g+=r(x.v,"V"):x.f!=null&&!x.F?g+=s("="+x.f):g+=`1,0\r
""`;break;case"b":g+=x.v?r(1,"TRUE"):r(0,"FALSE");break;case"s":g+=s(isNaN(+x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=bl(x.z||Gn[14],sr(hs(x.v)))),g+=r(x.w,"V");break;default:g+=`1,0\r
""`}g+=`\r
`}d.push(g)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:i,to_sheet:e,from_sheet:a}}(),bI=function(){function n(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,m){for(var g=p.split(`
`),y=-1,x=-1,_=0,b=[];_!==g.length;++_){var S=g[_].trim().split(":");if(S[0]==="cell"){var A=Kn(S[1]);if(b.length<=A.r)for(y=b.length;y<=A.r;++y)b[y]||(b[y]=[]);switch(y=A.r,x=A.c,S[2]){case"t":b[y][x]=n(S[3]);break;case"v":b[y][x]=+S[3];break;case"vtf":var C=S[S.length-1];case"vtc":switch(S[3]){case"nl":b[y][x]=!!+S[4];break;default:b[y][x]=S[S.length-1].charAt(0)=="#"?{t:"e",v:vo[S[S.length-1]]}:+S[4];break}S[2]=="vtf"&&(b[y][x]=[b[y][x],C])}}}return m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),b}function i(p,m){return Md(e(p,m),m)}function r(p,m){return kd(i(p,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],g=[],y,x="",_=rr(p["!ref"]),b=p["!data"]!=null,S=_.s.r;S<=_.e.r;++S)for(var A=_.s.c;A<=_.e.c;++A)if(x=ri({r:S,c:A}),y=b?(p["!data"][S]||[])[A]:p[x],!(!y||y.v==null||y.t==="z")){switch(g=["cell",x,"t"],y.t){case"s":g.push(t(y.v));break;case"b":g[2]="vt"+(y.f?"f":"c"),g[3]="nl",g[4]=y.v?"1":"0",g[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var C=sr(hs(y.v));g[2]="vtc",g[3]="nd",g[4]=""+C,g[5]=y.w||bl(y.z||Gn[14],C);break;case"n":isFinite(y.v)?y.f?(g[2]="vtf",g[3]="n",g[4]=y.v,g[5]=t(y.f)):(g[2]="v",g[3]=y.v):(g[2]="vt"+(y.f?"f":"c"),g[3]="e"+Vr[isNaN(y.v)?36:7],g[4]="0",g[5]=y.f||g[3].slice(1),g[6]="e",g[7]=g[3].slice(1));break;case"e":continue}m.push(g.join(":"))}return m.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(p){return[s,a,l,a,f(p),u].join(`
`)}return{to_workbook:r,to_sheet:i,from_sheet:d}}(),oZ=function(){function n(d,p,m,g,y){y.raw?p[m][g]=d:d===""||(d==="TRUE"?p[m][g]=!0:d==="FALSE"?p[m][g]=!1:isNaN(ml(d))?isNaN(g1(d).getDate())?d.charCodeAt(0)==35&&vo[d]!=null?p[m][g]={t:"e",v:vo[d],w:d}:p[m][g]=d:p[m][g]=hs(d):p[m][g]=ml(d))}function t(d,p){var m=p||{},g=[];if(!d||d.length===0)return g;for(var y=d.split(/[\r\n]/),x=y.length-1;x>=0&&y[x].length===0;)--x;for(var _=10,b=0,S=0;S<=x;++S)b=y[S].indexOf(" "),b==-1?b=y[S].length:b++,_=Math.max(_,b);for(S=0;S<=x;++S){g[S]=[];var A=0;for(n(y[S].slice(0,_).trim(),g,S,A,m),A=1;A<=(y[S].length-_)/10+1;++A)n(y[S].slice(_+(A-1)*10,_+A*10).trim(),g,S,A,m)}return m.sheetRows&&(g=g.slice(0,m.sheetRows)),g}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(d){for(var p={},m=!1,g=0,y=0;g<d.length;++g)(y=d.charCodeAt(g))==34?m=!m:!m&&y in e&&(p[y]=(p[y]||0)+1);y=[];for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&y.push([p[g],g]);if(!y.length){p=i;for(g in p)Object.prototype.hasOwnProperty.call(p,g)&&y.push([p[g],g])}return y.sort(function(x,_){return x[0]-_[0]||i[x[1]]-i[_[1]]}),e[y.pop()[1]]||44}function s(d,p){var m=p||{},g="",y={};m.dense&&(y["!data"]=[]);var x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=r(d.slice(0,1024)):m&&m.FS?g=m.FS:g=r(d.slice(0,1024));var _=0,b=0,S=0,A=0,C=0,O=g.charCodeAt(0),N=!1,D=0,L=d.charCodeAt(0),I=m.dateNF!=null?fq(m.dateNF):null;function z(){var j=d.slice(A,C);j.slice(-1)=="\r"&&(j=j.slice(0,-1));var B={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),m.cellText!==!1&&(B.w=j),j.length===0)B.t="z";else if(m.raw)B.t="s",B.v=j;else if(j.trim().length===0)B.t="s",B.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(B.t="s",B.v=j.slice(2,-1).replace(/""/g,'"')):oQ(j)?(B.t="s",B.f=j.slice(1),B.v=j):(B.t="s",B.v=j);else if(j=="TRUE")B.t="b",B.v=!0;else if(j=="FALSE")B.t="b",B.v=!1;else if(!isNaN(S=ml(j)))B.t="n",B.v=S;else if(!isNaN((S=g1(j)).getDate())||I&&j.match(I)){if(B.z=m.dateNF||Gn[14],I&&j.match(I)){var tt=dq(j,m.dateNF,j.match(I)||[]);S=hs(tt),m&&m.UTC===!1&&(S=bd(S))}else m&&m.UTC===!1?S=bd(S):m.cellText!==!1&&m.dateNF&&(B.w=bl(B.z,S));m.cellDates?(B.t="d",B.v=S):(B.t="n",B.v=sr(S)),m.cellNF||delete B.z}else j.charCodeAt(0)==35&&vo[j]!=null?(B.t="e",B.w=j,B.v=vo[j]):(B.t="s",B.v=j);if(B.t=="z"||(m.dense?(y["!data"][_]||(y["!data"][_]=[]),y["!data"][_][b]=B):y[ri({c:b,r:_})]=B),A=C+1,L=d.charCodeAt(A),x.e.c<b&&(x.e.c=b),x.e.r<_&&(x.e.r=_),D==O)++b;else if(b=0,++_,m.sheetRows&&m.sheetRows<=_)return!0}t:for(;C<d.length;++C)switch(D=d.charCodeAt(C)){case 34:L===34&&(N=!N);break;case 13:if(N)break;d.charCodeAt(C+1)==10&&++C;case O:case 10:if(!N&&z())break t;break}return C-A>0&&z(),y["!ref"]=Ci(x),y}function a(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,p):Md(t(d,p),p)}function l(d,p){var m="",g=p.type=="string"?[0,0,0,0]:Fnt(d,p);switch(p.type){case"base64":m=wc(d);break;case"binary":m=d;break;case"buffer":p.codepage==65001?m=d.toString("utf8"):(p.codepage,m=_n&&Buffer.isBuffer(d)?d.toString("binary"):Ou(d));break;case"array":m=nA(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+p.type)}return g[0]==239&&g[1]==187&&g[2]==191?m=ed(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=ed(m):p.type=="binary",m.slice(0,19)=="socialcalc:version:"?bI.to_sheet(p.type=="string"?m:ed(m),p):a(m,p)}function u(d,p){return kd(l(d,p),p)}function f(d){var p=[];if(!d["!ref"])return"";for(var m=Vn(d["!ref"]),g,y=d["!data"]!=null,x=m.s.r;x<=m.e.r;++x){for(var _=[],b=m.s.c;b<=m.e.c;++b){var S=ri({r:x,c:b});if(g=y?(d["!data"][x]||[])[b]:d[S],!g||g.v==null){_.push("          ");continue}for(var A=(g.w||(wl(g),g.w)||"").slice(0,10);A.length<10;)A+=" ";_.push(A+(b===0?" ":""))}p.push(_.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}(),U3=function(){function n(G,lt,rt){if(G){Ur(G,G.l||0);for(var ot=rt.Enum||it;G.l<G.length;){var bt=G.read_shift(2),St=ot[bt]||ot[65535],R=G.read_shift(2),mt=G.l+R,ut=St.f&&St.f(G,R,rt);if(G.l=mt,lt(ut,St,bt))return}}}function t(G,lt){switch(lt.type){case"base64":return i(Os(wc(G)),lt);case"binary":return i(Os(G),lt);case"buffer":case"array":return i(G,lt)}throw"Unsupported type "+lt.type}var e=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function i(G,lt){if(!G)return G;var rt=lt||{},ot={},bt="Sheet1",St="",R=0,mt={},ut=[],J=[],Q=[];rt.dense&&(Q=ot["!data"]=[]);var gt={s:{r:0,c:0},e:{r:0,c:0}},Bt=rt.sheetRows||0,Ht={};if(G[4]==81&&G[5]==80&&G[6]==87)return Et(G,lt);if(G[2]==0&&(G[3]==8||G[3]==9)&&G.length>=16&&G[14]==5&&G[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(G[2]==2)rt.Enum=it,n(G,function(xt,te,ae){switch(ae){case 0:rt.vers=xt,xt>=4096&&(rt.qpro=!0);break;case 255:rt.vers=xt,rt.works=!0;break;case 6:gt=xt;break;case 204:xt&&(St=xt);break;case 222:St=xt;break;case 15:case 51:(!rt.qpro&&!rt.works||ae==51)&&xt[1].v.charCodeAt(0)<48&&(xt[1].v=xt[1].v.slice(1)),(rt.works||rt.works2)&&(xt[1].v=xt[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(xt[2]&112)==112&&(xt[2]&15)>1&&(xt[2]&15)<15&&(xt[1].z=rt.dateNF||e[(xt[2]&15)-1]||Gn[14],rt.cellDates&&(xt[1].v=td(xt[1].v),xt[1].t=typeof xt[1].v=="number"?"n":"d")),rt.qpro&&xt[3]>R&&(ot["!ref"]=Ci(gt),mt[bt]=ot,ut.push(bt),ot={},rt.dense&&(Q=ot["!data"]=[]),gt={s:{r:0,c:0},e:{r:0,c:0}},R=xt[3],bt=St||"Sheet"+(R+1),St="");var ne=rt.dense?(Q[xt[0].r]||[])[xt[0].c]:ot[ri(xt[0])];if(ne){ne.t=xt[1].t,ne.v=xt[1].v,xt[1].z!=null&&(ne.z=xt[1].z),xt[1].f!=null&&(ne.f=xt[1].f),Ht=ne;break}rt.dense?(Q[xt[0].r]||(Q[xt[0].r]=[]),Q[xt[0].r][xt[0].c]=xt[1]):ot[ri(xt[0])]=xt[1],Ht=xt[1];break;case 21509:rt.works2=!0;break;case 21506:xt==5281&&(Ht.z="hh:mm:ss",rt.cellDates&&Ht.t=="n"&&(Ht.v=td(Ht.v),Ht.t=typeof Ht.v=="number"?"n":"d"));break}},rt);else if(G[2]==26||G[2]==14)rt.Enum=ht,G[2]==14&&(rt.qpro=!0,G.l=0),n(G,function(xt,te,ae){switch(ae){case 204:bt=xt;break;case 22:xt[1].v.charCodeAt(0)<48&&(xt[1].v=xt[1].v.slice(1)),xt[1].v=xt[1].v.replace(/\x0F./g,function(ne){return String.fromCharCode(ne.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(xt[3]>R&&(ot["!ref"]=Ci(gt),mt[bt]=ot,ut.push(bt),ot={},rt.dense&&(Q=ot["!data"]=[]),gt={s:{r:0,c:0},e:{r:0,c:0}},R=xt[3],bt="Sheet"+(R+1)),Bt>0&&xt[0].r>=Bt)break;rt.dense?(Q[xt[0].r]||(Q[xt[0].r]=[]),Q[xt[0].r][xt[0].c]=xt[1]):ot[ri(xt[0])]=xt[1],gt.e.c<xt[0].c&&(gt.e.c=xt[0].c),gt.e.r<xt[0].r&&(gt.e.r=xt[0].r);break;case 27:xt[14e3]&&(J[xt[14e3][0]]=xt[14e3][1]);break;case 1537:J[xt[0]]=xt[1],xt[0]==R&&(bt=xt[1]);break}},rt);else throw new Error("Unrecognized LOTUS BOF "+G[2]);if(ot["!ref"]=Ci(gt),mt[St||bt]=ot,ut.push(St||bt),!J.length)return{SheetNames:ut,Sheets:mt};for(var Ct={},kt=[],Dt=0;Dt<J.length;++Dt)mt[ut[Dt]]?(kt.push(J[Dt]||ut[Dt]),Ct[J[Dt]]=mt[J[Dt]]||mt[ut[Dt]]):(kt.push(J[Dt]),Ct[J[Dt]]={"!ref":"A1"});return{SheetNames:kt,Sheets:Ct}}function r(G,lt){var rt=lt||{};if(+rt.codepage>=0&&u0(+rt.codepage),rt.type=="string")throw new Error("Cannot write WK1 to JS string");var ot=wr();if(!G["!ref"])throw new Error("Cannot export empty sheet to WK1");var bt=Vn(G["!ref"]),St=G["!data"]!=null,R=[];Zt(ot,0,a(1030)),Zt(ot,6,f(bt));for(var mt=Math.min(bt.e.r,8191),ut=bt.s.c;ut<=bt.e.c;++ut)R[ut]=Dn(ut);for(var J=bt.s.r;J<=mt;++J){var Q=Fn(J);for(ut=bt.s.c;ut<=bt.e.c;++ut){var gt=St?(G["!data"][J]||[])[ut]:G[R[ut]+Q];if(!(!gt||gt.t=="z"))switch(gt.t){case"n":(gt.v|0)==gt.v&&gt.v>=-32768&&gt.v<=32767?Zt(ot,13,_(J,ut,gt)):Zt(ot,14,S(J,ut,gt));break;case"d":var Bt=sr(gt.v);(Bt|0)==Bt&&Bt>=-32768&&Bt<=32767?Zt(ot,13,_(J,ut,{v:Bt,z:gt.z||Gn[14]})):Zt(ot,14,S(J,ut,{v:Bt,z:gt.z||Gn[14]}));break;default:var Ht=wl(gt);Zt(ot,15,g(J,ut,Ht.slice(0,239)))}}}return Zt(ot,1),ot.end()}function s(G,lt){var rt=lt||{};if(+rt.codepage>=0&&u0(+rt.codepage),rt.type=="string")throw new Error("Cannot write WK3 to JS string");var ot=wr();Zt(ot,0,l(G));for(var bt=0,St=0;bt<G.SheetNames.length;++bt)(G.Sheets[G.SheetNames[bt]]||{})["!ref"]&&Zt(ot,27,V(G.SheetNames[bt],St++));var R=0;for(bt=0;bt<G.SheetNames.length;++bt){var mt=G.Sheets[G.SheetNames[bt]];if(!(!mt||!mt["!ref"])){for(var ut=Vn(mt["!ref"]),J=mt["!data"]!=null,Q=[],gt=Math.min(ut.e.r,8191),Bt=ut.s.r;Bt<=gt;++Bt)for(var Ht=Fn(Bt),Ct=ut.s.c;Ct<=ut.e.c;++Ct){Bt===ut.s.r&&(Q[Ct]=Dn(Ct));var kt=Q[Ct]+Ht,Dt=J?(mt["!data"][Bt]||[])[Ct]:mt[kt];if(!(!Dt||Dt.t=="z"))if(Dt.t=="n")Zt(ot,23,tt(Bt,Ct,R,Dt.v));else{var xt=wl(Dt);Zt(ot,22,z(Bt,Ct,R,xt.slice(0,239)))}}++R}}return Zt(ot,1),ot.end()}function a(G){var lt=jt(2);return lt.write_shift(2,G),lt}function l(G){var lt=jt(26);lt.write_shift(2,4096),lt.write_shift(2,4),lt.write_shift(4,0);for(var rt=0,ot=0,bt=0,St=0;St<G.SheetNames.length;++St){var R=G.SheetNames[St],mt=G.Sheets[R];if(!(!mt||!mt["!ref"])){++bt;var ut=rr(mt["!ref"]);rt<ut.e.r&&(rt=ut.e.r),ot<ut.e.c&&(ot=ut.e.c)}}return rt>8191&&(rt=8191),lt.write_shift(2,rt),lt.write_shift(1,bt),lt.write_shift(1,ot),lt.write_shift(2,0),lt.write_shift(2,0),lt.write_shift(1,1),lt.write_shift(1,2),lt.write_shift(4,0),lt.write_shift(4,0),lt}function u(G,lt,rt){var ot={s:{c:0,r:0},e:{c:0,r:0}};return lt==8&&rt.qpro?(ot.s.c=G.read_shift(1),G.l++,ot.s.r=G.read_shift(2),ot.e.c=G.read_shift(1),G.l++,ot.e.r=G.read_shift(2),ot):(ot.s.c=G.read_shift(2),ot.s.r=G.read_shift(2),lt==12&&rt.qpro&&(G.l+=2),ot.e.c=G.read_shift(2),ot.e.r=G.read_shift(2),lt==12&&rt.qpro&&(G.l+=2),ot.s.c==65535&&(ot.s.c=ot.e.c=ot.s.r=ot.e.r=0),ot)}function f(G){var lt=jt(8);return lt.write_shift(2,G.s.c),lt.write_shift(2,G.s.r),lt.write_shift(2,G.e.c),lt.write_shift(2,G.e.r),lt}function d(G,lt,rt){var ot=[{c:0,r:0},{t:"n",v:0},0,0];return rt.qpro&&rt.vers!=20768?(ot[0].c=G.read_shift(1),ot[3]=G.read_shift(1),ot[0].r=G.read_shift(2),G.l+=2):rt.works?(ot[0].c=G.read_shift(2),ot[0].r=G.read_shift(2),ot[2]=G.read_shift(2)):(ot[2]=G.read_shift(1),ot[0].c=G.read_shift(2),ot[0].r=G.read_shift(2)),ot}function p(G){return G.z&&Ru(G.z)?240|(e.indexOf(G.z)+1||2):255}function m(G,lt,rt){var ot=G.l+lt,bt=d(G,lt,rt);if(bt[1].t="s",(rt.vers&65534)==20768){G.l++;var St=G.read_shift(1);return bt[1].v=G.read_shift(St,"utf8"),bt}return rt.qpro&&G.l++,bt[1].v=G.read_shift(ot-G.l,"cstr"),bt}function g(G,lt,rt){var ot=jt(7+rt.length);ot.write_shift(1,255),ot.write_shift(2,lt),ot.write_shift(2,G),ot.write_shift(1,39);for(var bt=0;bt<ot.length;++bt){var St=rt.charCodeAt(bt);ot.write_shift(1,St>=128?95:St)}return ot.write_shift(1,0),ot}function y(G,lt,rt){var ot=G.l+lt,bt=d(G,lt,rt);if(bt[1].t="s",rt.vers==20768){var St=G.read_shift(1);return bt[1].v=G.read_shift(St,"utf8"),bt}return bt[1].v=G.read_shift(ot-G.l,"cstr"),bt}function x(G,lt,rt){var ot=d(G,lt,rt);return ot[1].v=G.read_shift(2,"i"),ot}function _(G,lt,rt){var ot=jt(7);return ot.write_shift(1,p(rt)),ot.write_shift(2,lt),ot.write_shift(2,G),ot.write_shift(2,rt.v,"i"),ot}function b(G,lt,rt){var ot=d(G,lt,rt);return ot[1].v=G.read_shift(8,"f"),ot}function S(G,lt,rt){var ot=jt(13);return ot.write_shift(1,p(rt)),ot.write_shift(2,lt),ot.write_shift(2,G),ot.write_shift(8,rt.v,"f"),ot}function A(G,lt,rt){var ot=G.l+lt,bt=d(G,lt,rt);if(bt[1].v=G.read_shift(8,"f"),rt.qpro)G.l=ot;else{var St=G.read_shift(2);D(G.slice(G.l,G.l+St),bt),G.l+=St}return bt}function C(G,lt,rt){var ot=lt&32768;return lt&=-32769,lt=(ot?G:0)+(lt>=8192?lt-16384:lt),(ot?"":"$")+(rt?Dn(lt):Fn(lt))}var O={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(G,lt){Ur(G,0);for(var rt=[],ot=0,bt="",St="",R="",mt="";G.l<G.length;){var ut=G[G.l++];switch(ut){case 0:rt.push(G.read_shift(8,"f"));break;case 1:St=C(lt[0].c,G.read_shift(2),!0),bt=C(lt[0].r,G.read_shift(2),!1),rt.push(St+bt);break;case 2:{var J=C(lt[0].c,G.read_shift(2),!0),Q=C(lt[0].r,G.read_shift(2),!1);St=C(lt[0].c,G.read_shift(2),!0),bt=C(lt[0].r,G.read_shift(2),!1),rt.push(J+Q+":"+St+bt)}break;case 3:if(G.l<G.length){console.error("WK1 premature formula end");return}break;case 4:rt.push("("+rt.pop()+")");break;case 5:rt.push(G.read_shift(2));break;case 6:{for(var gt="";ut=G[G.l++];)gt+=String.fromCharCode(ut);rt.push('"'+gt.replace(/"/g,'""')+'"')}break;case 8:rt.push("-"+rt.pop());break;case 23:rt.push("+"+rt.pop());break;case 22:rt.push("NOT("+rt.pop()+")");break;case 20:case 21:mt=rt.pop(),R=rt.pop(),rt.push(["AND","OR"][ut-20]+"("+R+","+mt+")");break;default:if(ut<32&&N[ut])mt=rt.pop(),R=rt.pop(),rt.push(R+N[ut]+mt);else if(O[ut]){if(ot=O[ut][1],ot==69&&(ot=G[G.l++]),ot>rt.length){console.error("WK1 bad formula parse 0x"+ut.toString(16)+":|"+rt.join("|")+"|");return}var Bt=rt.slice(-ot);rt.length-=ot,rt.push(O[ut][0]+"("+Bt.join(",")+")")}else return ut<=7?console.error("WK1 invalid opcode "+ut.toString(16)):ut<=24?console.error("WK1 unsupported op "+ut.toString(16)):ut<=30?console.error("WK1 invalid opcode "+ut.toString(16)):ut<=115?console.error("WK1 unsupported function opcode "+ut.toString(16)):console.error("WK1 unrecognized opcode "+ut.toString(16))}}rt.length==1?lt[1].f=""+rt[0]:console.error("WK1 bad formula parse |"+rt.join("|")+"|")}function L(G){var lt=[{c:0,r:0},{t:"n",v:0},0];return lt[0].r=G.read_shift(2),lt[3]=G[G.l++],lt[0].c=G[G.l++],lt}function I(G,lt){var rt=L(G);return rt[1].t="s",rt[1].v=G.read_shift(lt-4,"cstr"),rt}function z(G,lt,rt,ot){var bt=jt(6+ot.length);bt.write_shift(2,G),bt.write_shift(1,rt),bt.write_shift(1,lt),bt.write_shift(1,39);for(var St=0;St<ot.length;++St){var R=ot.charCodeAt(St);bt.write_shift(1,R>=128?95:R)}return bt.write_shift(1,0),bt}function j(G,lt){var rt=L(G);rt[1].v=G.read_shift(2);var ot=rt[1].v>>1;if(rt[1].v&1)switch(ot&7){case 0:ot=(ot>>3)*5e3;break;case 1:ot=(ot>>3)*500;break;case 2:ot=(ot>>3)/20;break;case 3:ot=(ot>>3)/200;break;case 4:ot=(ot>>3)/2e3;break;case 5:ot=(ot>>3)/2e4;break;case 6:ot=(ot>>3)/16;break;case 7:ot=(ot>>3)/64;break}return rt[1].v=ot,rt}function B(G,lt){var rt=L(G),ot=G.read_shift(4),bt=G.read_shift(4),St=G.read_shift(2);if(St==65535)return ot===0&&bt===3221225472?(rt[1].t="e",rt[1].v=15):ot===0&&bt===3489660928?(rt[1].t="e",rt[1].v=42):rt[1].v=0,rt;var R=St&32768;return St=(St&32767)-16446,rt[1].v=(1-R*2)*(bt*Math.pow(2,St+32)+ot*Math.pow(2,St)),rt}function tt(G,lt,rt,ot){var bt=jt(14);if(bt.write_shift(2,G),bt.write_shift(1,rt),bt.write_shift(1,lt),ot==0)return bt.write_shift(4,0),bt.write_shift(4,0),bt.write_shift(2,65535),bt;var St=0,R=0,mt=0,ut=0;return ot<0&&(St=1,ot=-ot),R=Math.log2(ot)|0,ot/=Math.pow(2,R-31),ut=ot>>>0,(ut&2147483648)==0&&(ot/=2,++R,ut=ot>>>0),ot-=ut,ut|=2147483648,ut>>>=0,ot*=Math.pow(2,32),mt=ot>>>0,bt.write_shift(4,mt),bt.write_shift(4,ut),R+=16383+(St?32768:0),bt.write_shift(2,R),bt}function k(G,lt){var rt=B(G);return G.l+=lt-14,rt}function et(G,lt){var rt=L(G),ot=G.read_shift(4);return rt[1].v=ot>>6,rt}function K(G,lt){var rt=L(G),ot=G.read_shift(8,"f");return rt[1].v=ot,rt}function q(G,lt){var rt=K(G);return G.l+=lt-12,rt}function _t(G,lt){return G[G.l+lt-1]==0?G.read_shift(lt,"cstr"):""}function at(G,lt){var rt=G[G.l++];rt>lt-1&&(rt=lt-1);for(var ot="";ot.length<rt;)ot+=String.fromCharCode(G[G.l++]);return ot}function P(G,lt,rt){if(!(!rt.qpro||lt<21)){var ot=G.read_shift(1);G.l+=17,G.l+=1,G.l+=2;var bt=G.read_shift(lt-21,"cstr");return[ot,bt]}}function X(G,lt){for(var rt={},ot=G.l+lt;G.l<ot;){var bt=G.read_shift(2);if(bt==14e3){for(rt[bt]=[0,""],rt[bt][0]=G.read_shift(2);G[G.l];)rt[bt][1]+=String.fromCharCode(G[G.l]),G.l++;G.l++}}return rt}function V(G,lt){var rt=jt(5+G.length);rt.write_shift(2,14e3),rt.write_shift(2,lt);for(var ot=0;ot<G.length;++ot){var bt=G.charCodeAt(ot);rt[rt.l++]=bt>127?95:bt}return rt[rt.l++]=0,rt}var it={0:{n:"BOF",f:Gv},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:y},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_t},222:{n:"SHEETNAMELP",f:at},255:{n:"BOF",f:Gv},21506:{n:"WKSNF",f:Gv},65535:{n:""}},ht={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:X},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:et},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_t},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:P},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},yt={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Rt(G){var lt=G.read_shift(2),rt=G.read_shift(1);if(rt!=0)throw"unsupported QPW string type "+rt.toString(16);return G.read_shift(lt,"sbcs-cont")}function Et(G,lt){Ur(G,0);var rt=lt||{},ot={};rt.dense&&(ot["!data"]=[]);var bt=[],St="",R={s:{r:-1,c:-1},e:{r:-1,c:-1}},mt=0,ut=0,J=0,Q=0,gt={SheetNames:[],Sheets:{}},Bt=[];t:for(;G.l<G.length;){var Ht=G.read_shift(2),Ct=G.read_shift(2),kt=G.slice(G.l,G.l+Ct);switch(Ur(kt,0),Ht){case 1:if(kt.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break t;case 8:break;case 10:for(var Dt=kt.read_shift(4),xt=(kt.length-kt.l)/Dt|0,te=0;te<Dt;++te){var ae=kt.l+xt,ne={};kt.l+=2,ne.numFmtId=kt.read_shift(2),yt[ne.numFmtId]&&(ne.z=yt[ne.numFmtId]),kt.l=ae,Bt.push(ne)}break;case 1025:break;case 1026:break;case 1031:for(kt.l+=12;kt.l<kt.length;)mt=kt.read_shift(2),ut=kt.read_shift(1),bt.push(kt.read_shift(mt,"cstr"));break;case 1032:break;case 1537:{var Me=kt.read_shift(2);ot={},rt.dense&&(ot["!data"]=[]),R.s.c=kt.read_shift(2),R.e.c=kt.read_shift(2),R.s.r=kt.read_shift(4),R.e.r=kt.read_shift(4),kt.l+=4,kt.l+2<kt.length&&(mt=kt.read_shift(2),ut=kt.read_shift(1),St=mt==0?"":kt.read_shift(mt,"cstr")),St||(St=Dn(Me))}break;case 1538:{if(R.s.c>255||R.s.r>999999)break;R.e.c<R.s.c&&(R.e.c=R.s.c),R.e.r<R.s.r&&(R.e.r=R.s.r),ot["!ref"]=Ci(R),yA(gt,ot,St)}break;case 2561:J=kt.read_shift(2),R.e.c<J&&(R.e.c=J),R.s.c>J&&(R.s.c=J),Q=kt.read_shift(4),R.s.r>Q&&(R.s.r=Q),Q=kt.read_shift(4),R.e.r<Q&&(R.e.r=Q);break;case 3073:{Q=kt.read_shift(4),mt=kt.read_shift(4),R.s.r>Q&&(R.s.r=Q),R.e.r<Q+mt-1&&(R.e.r=Q+mt-1);for(var dn=Dn(J);kt.l<kt.length;){var Se={t:"z"},gn=kt.read_shift(1),Ze=-1;gn&128&&(Ze=kt.read_shift(2));var Zn=gn&64?kt.read_shift(2)-1:0;switch(gn&31){case 0:break;case 1:break;case 2:Se={t:"n",v:kt.read_shift(2)};break;case 3:Se={t:"n",v:kt.read_shift(2,"i")};break;case 4:Se={t:"n",v:dA(kt)};break;case 5:Se={t:"n",v:kt.read_shift(8,"f")};break;case 7:Se={t:"s",v:bt[ut=kt.read_shift(4)-1]};break;case 8:Se={t:"n",v:kt.read_shift(8,"f")},kt.l+=2,kt.l+=4,isNaN(Se.v)&&(Se={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(gn&31)}Ze!=-1&&(Bt[Ze-1]||{}).z&&(Se.z=Bt[Ze-1].z);var Bn=0;if(gn&32)switch(gn&31){case 2:Bn=kt.read_shift(2);break;case 3:Bn=kt.read_shift(2,"i");break;case 7:Bn=kt.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(gn&31)}if(!(!rt.sheetStubs&&Se.t=="z")){var On=Ar(Se);Se.t=="n"&&Se.z&&Ru(Se.z)&&rt.cellDates&&(On.v=td(Se.v),On.t=typeof On.v=="number"?"n":"d"),ot["!data"]!=null?(ot["!data"][Q]||(ot["!data"][Q]=[]),ot["!data"][Q][J]=On):ot[dn+Fn(Q)]=On}for(++Q,--mt;Zn-- >0&&mt>=0;){if(gn&32)switch(gn&31){case 2:Se={t:"n",v:Se.v+Bn&65535};break;case 3:Se={t:"n",v:Se.v+Bn&65535},Se.v>32767&&(Se.v-=65536);break;case 7:Se={t:"s",v:bt[ut=ut+Bn>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(gn&31)}else switch(gn&31){case 1:Se={t:"z"};break;case 2:Se={t:"n",v:kt.read_shift(2)};break;case 7:Se={t:"s",v:bt[ut=kt.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(gn&31)}!rt.sheetStubs&&Se.t=="z"||(ot["!data"]!=null?(ot["!data"][Q]||(ot["!data"][Q]=[]),ot["!data"][Q][J]=Se):ot[dn+Fn(Q)]=Se),++Q,--mt}}}break;case 3074:{J=kt.read_shift(2),Q=kt.read_shift(4);var Oi=Rt(kt);ot["!data"]!=null?(ot["!data"][Q]||(ot["!data"][Q]=[]),ot["!data"][Q][J]={t:"s",v:Oi}):ot[Dn(J)+Fn(Q)]={t:"s",v:Oi}}break}G.l+=Ct}return gt}return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:t}}(),lZ=/^\s|\s$|[\t\n\r]/;function cZ(n,t){if(!t.bookSST)return"";var e=[Di];e[e.length]=se("sst",null,{xmlns:Id[0],count:n.Count,uniqueCount:n.Unique});for(var i=0;i!=n.length;++i)if(n[i]!=null){var r=n[i],s="<si>";r.r?s+=r.r:(s+="<t",r.t||(r.t=""),typeof r.t!="string"&&(r.t=String(r.t)),r.t.match(lZ)&&(s+=' xml:space="preserve"'),s+=">"+qe(r.t)+"</t>"),s+="</si>",e[e.length]=s}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function uZ(n){return[n.read_shift(4),n.read_shift(4)]}function fZ(n,t){return t||(t=jt(8)),t.write_shift(4,n.Count),t.write_shift(4,n.Unique),t}var dZ=Qq;function hZ(n){var t=wr();qt(t,159,fZ(n));for(var e=0;e<n.length;++e)qt(t,19,dZ(n[e]));return qt(t,160),t.end()}function pZ(n){for(var t=[],e=n.split(""),i=0;i<e.length;++i)t[i]=e[i].charCodeAt(0);return t}function wI(n){var t=0,e,i=pZ(n),r=i.length+1,s,a,l,u,f;for(e=Du(r),e[0]=i.length,s=1;s!=r;++s)e[s]=i[s-1];for(s=r-1;s>=0;--s)a=e[s],l=(t&16384)===0?0:1,u=t<<1&32767,f=l|u,t=f^a;return t^52811}function mZ(n,t){var e=["{\\rtf1\\ansi"];if(!n["!ref"])return e[0]+"}";for(var i=Vn(n["!ref"]),r,s=n["!data"]!=null,a=[],l=i.s.r;l<=i.e.r;++l){e.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)e.push("\\cellx"+(u+1));for(e.push("\\pard\\intbl"),s&&(a=n["!data"][l]||[]),u=i.s.c;u<=i.e.c;++u){var f=ri({r:l,c:u});if(r=s?a[u]:n[f],!r||r.v==null&&(!r.f||r.F)){e.push(" \\cell");continue}e.push(" "+(r.w||(wl(r),r.w)||"").replace(/[\r\n]/g,"\\par ")),e.push("\\cell")}e.push("\\pard\\intbl\\row")}return e.join("")+"}"}function z3(n){for(var t=0,e=1;t!=3;++t)e=e*256+(n[t]>255?255:n[t]<0?0:n[t]);return e.toString(16).toUpperCase().slice(1)}var gZ=6,gl=gZ;function _1(n){return Math.floor((n+Math.round(128/gl)/256)*gl)}function b1(n){return Math.floor((n-5)/gl*100+.5)/100}function oE(n){return Math.round((n*gl+5)/gl*256)/256}function pA(n){n.width?(n.wpx=_1(n.width),n.wch=b1(n.wpx),n.MDW=gl):n.wpx?(n.wch=b1(n.wpx),n.width=oE(n.wch),n.MDW=gl):typeof n.wch=="number"&&(n.width=oE(n.wch),n.wpx=_1(n.width),n.MDW=gl),n.customWidth&&delete n.customWidth}var vZ=96,EI=vZ;function w1(n){return n*96/EI}function AI(n){return n*EI/96}function xZ(n){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)n[i]!=null&&(t[t.length]=se("numFmt",null,{numFmtId:i,formatCode:qe(n[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function yZ(n){var t=[];return t[t.length]=se("cellXfs",null),n.forEach(function(e){t[t.length]=se("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function _Z(n,t){var e=[Di,se("styleSheet",null,{xmlns:Id[0],"xmlns:vt":Hi.vt})],i;return n.SSF&&(i=xZ(n.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=yZ(t.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function bZ(n,t){var e=n.read_shift(2),i=Er(n);return[e,i]}function wZ(n,t,e){e||(e=jt(6+4*t.length)),e.write_shift(2,n),Fi(t,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function EZ(n,t,e){var i={};i.sz=n.read_shift(2)/20;var r=sK(n);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var s=n.read_shift(2);switch(s===700&&(i.bold=1),n.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(i.underline=a);var l=n.read_shift(1);l>0&&(i.family=l);var u=n.read_shift(1);switch(u>0&&(i.charset=u),n.l++,i.color=rK(n),n.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Er(n),i}function AZ(n,t){t||(t=jt(25+4*32)),t.write_shift(2,n.sz*20),aK(n,t),t.write_shift(2,n.bold?700:400);var e=0;n.vertAlign=="superscript"?e=1:n.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,n.underline||0),t.write_shift(1,n.family||0),t.write_shift(1,n.charset||0),t.write_shift(1,0),x1(n.color,t);var i=0;return i=2,t.write_shift(1,i),Fi(n.name,t),t.length>t.l?t.slice(0,t.l):t}var SZ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Rb,TZ=_o;function H3(n,t){t||(t=jt(4*3+8*7+16*1)),Rb||(Rb=eA(SZ));var e=Rb[n.patternType];e==null&&(e=40),t.write_shift(4,e);var i=0;if(e!=40)for(x1({auto:1},t),x1({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function CZ(n,t){var e=n.l+t,i=n.read_shift(2),r=n.read_shift(2);return n.l=e,{ixfe:i,numFmtId:r}}function SI(n,t,e){e||(e=jt(16)),e.write_shift(2,t||0),e.write_shift(2,n.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function gp(n,t){return t||(t=jt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var DZ=_o;function OZ(n,t){return t||(t=jt(51)),t.write_shift(1,0),gp(null,t),gp(null,t),gp(null,t),gp(null,t),gp(null,t),t.length>t.l?t.slice(0,t.l):t}function RZ(n,t){return t||(t=jt(12+4*10)),t.write_shift(4,n.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),m0(n.name||"",t),t.length>t.l?t.slice(0,t.l):t}function NZ(n,t,e){var i=jt(2052);return i.write_shift(4,n),m0(t,i),m0(e,i),i.length>i.l?i.slice(0,i.l):i}function LZ(n,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&++e}),e!=0&&(qt(n,615,ka(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&qt(n,44,wZ(r,t[r]))}),qt(n,616))}}function IZ(n){var t=1;qt(n,611,ka(t)),qt(n,43,AZ({sz:12,color:{theme:1},name:"Calibri",family:2})),qt(n,612)}function kZ(n){var t=2;qt(n,603,ka(t)),qt(n,45,H3({patternType:"none"})),qt(n,45,H3({patternType:"gray125"})),qt(n,604)}function MZ(n){var t=1;qt(n,613,ka(t)),qt(n,46,OZ()),qt(n,614)}function FZ(n){var t=1;qt(n,626,ka(t)),qt(n,47,SI({numFmtId:0},65535)),qt(n,627)}function PZ(n,t){qt(n,617,ka(t.length)),t.forEach(function(e){qt(n,47,SI(e,0))}),qt(n,618)}function BZ(n){var t=1;qt(n,619,ka(t)),qt(n,48,RZ({xfId:0,name:"Normal"})),qt(n,620)}function jZ(n){var t=0;qt(n,505,ka(t)),qt(n,506)}function UZ(n){var t=0;qt(n,508,NZ(t,"TableStyleMedium9","PivotStyleMedium4")),qt(n,509)}function zZ(n,t){var e=wr();return qt(e,278),LZ(e,n.SSF),IZ(e),kZ(e),MZ(e),FZ(e),PZ(e,t.cellXfs),BZ(e),jZ(e),UZ(e),qt(e,279),e.end()}function TI(n,t){if(t&&t.themeXLSX)return t.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var e=[Di];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function HZ(n,t){return{flags:n.read_shift(4),version:n.read_shift(4),name:Er(n)}}function $Z(n){var t=jt(12+2*n.name.length);return t.write_shift(4,n.flags),t.write_shift(4,n.version),Fi(n.name,t),t.slice(0,t.l)}function GZ(n){for(var t=[],e=n.read_shift(4);e-- >0;)t.push([n.read_shift(4),n.read_shift(4)]);return t}function VZ(n){var t=jt(4+8*n.length);t.write_shift(4,n.length);for(var e=0;e<n.length;++e)t.write_shift(4,n[e][0]),t.write_shift(4,n[e][1]);return t}function WZ(n,t){var e=jt(8+2*t.length);return e.write_shift(4,n),Fi(t,e),e.slice(0,e.l)}function XZ(n){return n.l+=4,n.read_shift(4)!=0}function YZ(n,t){var e=jt(8);return e.write_shift(4,n),e.write_shift(4,1),e}function qZ(){var n=wr();return qt(n,332),qt(n,334,ka(1)),qt(n,335,$Z({name:"XLDAPR",version:12e4,flags:3496657072})),qt(n,336),qt(n,339,WZ(1,"XLDAPR")),qt(n,52),qt(n,35,ka(514)),qt(n,4096,ka(0)),qt(n,4097,sa(1)),qt(n,36),qt(n,53),qt(n,340),qt(n,337,YZ(1)),qt(n,51,VZ([[1,0]])),qt(n,338),qt(n,333),n.end()}function KZ(){var n=[Di];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function ZZ(n){var t={};t.i=n.read_shift(4);var e={};e.r=n.read_shift(4),e.c=n.read_shift(4),t.r=ri(e);var i=n.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}function CI(n,t,e){var i=[21600,21600],r=["m0,0l0",i[1],i[0],i[1],i[0],"0xe"].join(","),s=[se("xml",null,{"xmlns:v":Rs.v,"xmlns:o":Rs.o,"xmlns:x":Rs.x,"xmlns:mv":Rs.mv}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"})],a=65536*n,l=t||[];return l.length>0&&s.push(se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:i.join(","),"o:spt":202,path:r})),l.forEach(function(u){++a,s.push(QZ(u,a))}),s.push("</xml>"),s.join("")}function QZ(n,t,e){var i=Kn(n[0]),r={color2:"#BEFF82",type:"gradient"};r.type=="gradient"&&(r.angle="-180");var s=r.type=="gradient"?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=se("v:fill",s,r),l={on:"t",obscured:"t"};return["<v:shape"+d0({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,se("v:shadow",null,l),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",er("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),er("x:AutoFill","False"),er("x:Row",String(i.r)),er("x:Column",String(i.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function JZ(n){var t=[Di,se("comments",null,{xmlns:Id[0]})],e=[];return t.push("<authors>"),n.forEach(function(i){i[1].forEach(function(r){var s=qe(r.a);e.indexOf(s)==-1&&(e.push(s),t.push("<author>"+s+"</author>")),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),t.push("<author>tc="+r.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),n.forEach(function(i){var r=0,s=[],a=0;if(i[1][0]&&i[1][0].T&&i[1][0].ID&&(r=e.indexOf("tc="+i[1][0].ID)),i[1].forEach(function(f){f.a&&(r=e.indexOf(qe(f.a))),f.T&&++a,s.push(f.t==null?"":qe(f.t))}),a===0)i[1].forEach(function(f){t.push('<comment ref="'+i[0]+'" authorId="'+e.indexOf(qe(f.a))+'"><text>'),t.push(er("t",f.t==null?"":qe(f.t))),t.push("</text></comment>")});else{i[1][0]&&i[1][0].T&&i[1][0].ID&&(r=e.indexOf("tc="+i[1][0].ID)),t.push('<comment ref="'+i[0]+'" authorId="'+r+'"><text>');for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;t.push(er("t",qe(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function DI(n,t,e){var i=[Di,se("ThreadedComments",null,{xmlns:Hi.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(r){var s="";(r[1]||[]).forEach(function(a,l){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var u={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};l==0?s=u.id:u.parentId=s,a.ID=u.id,a.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),i.push(se("threadedComment",er("text",a.t||""),u))})}),i.push("</ThreadedComments>"),i.join("")}function OI(n){var t=[Di,se("personList",null,{xmlns:Hi.TCMNT,"xmlns:x":Id[0]}).replace(/[\/]>/,">")];return n.forEach(function(e,i){t.push(se("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function tQ(n){var t={};t.iauthor=n.read_shift(4);var e=Gu(n);return t.rfx=e.s,t.ref=ri(e.s),n.l+=16,t}function eQ(n,t){return t==null&&(t=jt(36)),t.write_shift(4,n[1].iauthor),Fd(n[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var nQ=Er;function $3(n){return Fi(n.slice(0,54))}function iQ(n){var t=wr(),e=[];return qt(t,628),qt(t,630),n.forEach(function(i){i[1].forEach(function(r){e.indexOf(r.a)>-1||(e.push(r.a.slice(0,54)),qt(t,632,$3(r.a)),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),qt(t,632,$3("tc="+r.ID))))})}),qt(t,631),qt(t,633),n.forEach(function(i){i[1].forEach(function(r){var s=-1;r.ID&&(s=e.indexOf("tc="+r.ID)),s==-1&&i[1][0].T&&i[1][0].ID&&(s=e.indexOf("tc="+i[1][0].ID)),s==-1&&(s=e.indexOf(r.a)),r.iauthor=s;var a={s:Kn(i[0]),e:Kn(i[0])};qt(t,635,eQ([a,r])),r.t&&r.t.length>0&&qt(t,637,tK(r)),qt(t,636),delete r.iauthor})}),qt(t,634),qt(t,629),t.end()}function rQ(n,t){t.FullPaths.forEach(function(e,i){if(i!=0){var r=e.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&Un.utils.cfb_add(n,r,t.FileIndex[i].content)}})}var sQ=["xlsb","xlsm","xlam","biff8","xla"],G3=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(i,r,s,a){var l=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return l?d+=t.c:--d,u?f+=t.r:--f,r+(l?"":"$")+Dn(d)+(u?"":"$")+Fn(f)}return function(r,s){return t=s,r.replace(n,e)}}(),_x=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{_x=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var bx=function(){return function(t,e){return t.replace(_x,function(i,r,s,a,l,u){var f=cA(a)-(s?0:e.c),d=lA(u)-(l?0:e.r),p=l=="$"?d+1:d==0?"":"["+d+"]",m=s=="$"?f+1:f==0?"":"["+f+"]";return r+"R"+p+"C"+m})}}();function aQ(n,t){return n.replace(_x,function(e,i,r,s,a,l){return i+(r=="$"?r+s:Dn(cA(s)+t.c))+(a=="$"?a+l:Fn(lA(l)+t.r))})}function oQ(n){return n.length!=1}function wi(n){n.l+=1}function Ec(n,t){var e=n.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function RI(n,t,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return NI(n);e.biff==12&&(i=4)}var r=n.read_shift(i),s=n.read_shift(i),a=Ec(n),l=Ec(n);return{s:{r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function NI(n){var t=Ec(n),e=Ec(n),i=n.read_shift(1),r=n.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:e[0],c:r,cRel:e[1],rRel:e[2]}}}function lQ(n,t,e){if(e.biff<8)return NI(n);var i=n.read_shift(e.biff==12?4:2),r=n.read_shift(e.biff==12?4:2),s=Ec(n),a=Ec(n);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r,c:a[0],cRel:a[1],rRel:a[2]}}}function LI(n,t,e){if(e&&e.biff>=2&&e.biff<=5)return cQ(n);var i=n.read_shift(e&&e.biff==12?4:2),r=Ec(n);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function cQ(n){var t=Ec(n),e=n.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function uQ(n){var t=n.read_shift(2),e=n.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function fQ(n,t,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return dQ(n);var r=n.read_shift(i>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;r>524287;)r-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r,c:s,cRel:a,rRel:l}}function dQ(n){var t=n.read_shift(2),e=n.read_shift(1),i=(t&32768)>>15,r=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),r==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:r,rRel:i}}function hQ(n,t,e){var i=(n[n.l++]&96)>>5,r=RI(n,e.biff>=2&&e.biff<=5?6:8,e);return[i,r]}function pQ(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2,"i"),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=RI(n,s,e);return[i,r,a]}function mQ(n,t,e){var i=(n[n.l++]&96)>>5;return n.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function gQ(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[i,r]}function vQ(n,t,e){var i=(n[n.l++]&96)>>5,r=lQ(n,t-1,e);return[i,r]}function xQ(n,t,e){var i=(n[n.l++]&96)>>5;return n.l+=e.biff==2?6:e.biff==12?14:7,[i]}function V3(n){var t=n[n.l+1]&1,e=1;return n.l+=4,[t,e]}function yQ(n,t,e){n.l+=2;for(var i=n.read_shift(e&&e.biff==2?1:2),r=[],s=0;s<=i;++s)r.push(n.read_shift(e&&e.biff==2?1:2));return r}function _Q(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(e&&e.biff==2?1:2)]}function bQ(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(e&&e.biff==2?1:2)]}function wQ(n){var t=n[n.l+1]&255?1:0;return n.l+=2,[t,n.read_shift(2)]}function EQ(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=e&&e.biff==2?3:4,[i]}function II(n){var t=n.read_shift(1),e=n.read_shift(1);return[t,e]}function AQ(n){return n.read_shift(2),II(n)}function SQ(n){return n.read_shift(2),II(n)}function TQ(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=LI(n,0,e);return[i,r]}function CQ(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=fQ(n,0,e);return[i,r]}function DQ(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(2);e&&e.biff==5&&(n.l+=12);var s=LI(n,0,e);return[i,r,s]}function OQ(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(e&&e.biff<=3?1:2);return[UJ[r],FI[r],i]}function RQ(n,t,e){var i=n[n.l++],r=n.read_shift(1),s=e&&e.biff<=3?[i==88?-1:0,n.read_shift(1)]:NQ(n);return[r,(s[0]===0?FI:jJ)[s[1]]]}function NQ(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function LQ(n,t,e){n.l+=e&&e.biff==2?3:4}function IQ(n,t,e){if(n.l++,e&&e.biff==12)return[n.read_shift(4,"i"),0];var i=n.read_shift(2),r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function kQ(n){return n.l++,Vr[n.read_shift(1)]}function MQ(n){return n.l++,n.read_shift(2)}function FQ(n){return n.l++,n.read_shift(1)!==0}function PQ(n){return n.l++,Pd(n)}function BQ(n,t,e){return n.l++,vI(n,t-1,e)}function jQ(n,t){var e=[n.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=AK(n,1)?"TRUE":"FALSE",t!=12&&(n.l+=7);break;case 37:case 16:e[1]=Vr[n[n.l]],n.l+=t==12?4:8;break;case 0:n.l+=8;break;case 1:e[1]=Pd(n);break;case 2:e[1]=DK(n,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function UQ(n,t,e){for(var i=n.read_shift(e.biff==12?4:2),r=[],s=0;s!=i;++s)r.push((e.biff==12?Gu:NK)(n));return r}function zQ(n,t,e){var i=0,r=0;e.biff==12?(i=n.read_shift(4),r=n.read_shift(4)):(r=1+n.read_shift(1),i=1+n.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--r==0&&(r=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var l=0;l!=r;++l)a[s][l]=jQ(n,e.biff);return a}function HQ(n,t,e){var i=n.read_shift(1)>>>5&3,r=!e||e.biff>=8?4:2,s=n.read_shift(r);switch(e.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[i,0,s]}function $Q(n,t,e){if(e.biff==5)return GQ(n);var i=n.read_shift(1)>>>5&3,r=n.read_shift(2),s=n.read_shift(4);return[i,r,s]}function GQ(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2,"i");n.l+=8;var i=n.read_shift(2);return n.l+=12,[t,e,i]}function VQ(n,t,e){var i=n.read_shift(1)>>>5&3;n.l+=e&&e.biff==2?3:4;var r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function WQ(n,t,e){var i=n.read_shift(1)>>>5&3,r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function XQ(n,t,e){var i=n.read_shift(1)>>>5&3;return n.l+=4,e.biff<8&&n.l--,e.biff==12&&(n.l+=2),[i]}function YQ(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),s=4;if(e)switch(e.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[i,r]}var qQ=_o,KQ=_o,ZQ=_o;function G0(n,t,e){return n.l+=2,[uQ(n)]}function mA(n){return n.l+=6,[]}var QQ=G0,JQ=mA,tJ=mA,eJ=G0;function kI(n){return n.l+=2,[Gv(n),n.read_shift(2)&1]}var nJ=G0,iJ=kI,rJ=mA,sJ=G0,aJ=G0,oJ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lJ(n){n.l+=2;var t=n.read_shift(2),e=n.read_shift(2),i=n.read_shift(4),r=n.read_shift(2),s=n.read_shift(2),a=oJ[e>>2&31];return{ixti:t,coltype:e&3,rt:a,idx:i,c:r,C:s}}function cJ(n){return n.l+=2,[n.read_shift(4)]}function uJ(n,t,e){return n.l+=5,n.l+=2,n.l+=e.biff==2?1:4,["PTGSHEET"]}function fJ(n,t,e){return n.l+=e.biff==2?4:5,["PTGENDSHEET"]}function dJ(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function hJ(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function pJ(n){return n.l+=4,[0,0]}var W3={1:{n:"PtgExp",f:IQ},2:{n:"PtgTbl",f:ZQ},3:{n:"PtgAdd",f:wi},4:{n:"PtgSub",f:wi},5:{n:"PtgMul",f:wi},6:{n:"PtgDiv",f:wi},7:{n:"PtgPower",f:wi},8:{n:"PtgConcat",f:wi},9:{n:"PtgLt",f:wi},10:{n:"PtgLe",f:wi},11:{n:"PtgEq",f:wi},12:{n:"PtgGe",f:wi},13:{n:"PtgGt",f:wi},14:{n:"PtgNe",f:wi},15:{n:"PtgIsect",f:wi},16:{n:"PtgUnion",f:wi},17:{n:"PtgRange",f:wi},18:{n:"PtgUplus",f:wi},19:{n:"PtgUminus",f:wi},20:{n:"PtgPercent",f:wi},21:{n:"PtgParen",f:wi},22:{n:"PtgMissArg",f:wi},23:{n:"PtgStr",f:BQ},26:{n:"PtgSheet",f:uJ},27:{n:"PtgEndSheet",f:fJ},28:{n:"PtgErr",f:kQ},29:{n:"PtgBool",f:FQ},30:{n:"PtgInt",f:MQ},31:{n:"PtgNum",f:PQ},32:{n:"PtgArray",f:xQ},33:{n:"PtgFunc",f:OQ},34:{n:"PtgFuncVar",f:RQ},35:{n:"PtgName",f:HQ},36:{n:"PtgRef",f:TQ},37:{n:"PtgArea",f:hQ},38:{n:"PtgMemArea",f:VQ},39:{n:"PtgMemErr",f:qQ},40:{n:"PtgMemNoMem",f:KQ},41:{n:"PtgMemFunc",f:WQ},42:{n:"PtgRefErr",f:XQ},43:{n:"PtgAreaErr",f:mQ},44:{n:"PtgRefN",f:CQ},45:{n:"PtgAreaN",f:vQ},46:{n:"PtgMemAreaN",f:dJ},47:{n:"PtgMemNoMemN",f:hJ},57:{n:"PtgNameX",f:$Q},58:{n:"PtgRef3d",f:DQ},59:{n:"PtgArea3d",f:pQ},60:{n:"PtgRefErr3d",f:YQ},61:{n:"PtgAreaErr3d",f:gQ},255:{}},mJ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},gJ={1:{n:"PtgElfLel",f:kI},2:{n:"PtgElfRw",f:sJ},3:{n:"PtgElfCol",f:QQ},6:{n:"PtgElfRwV",f:aJ},7:{n:"PtgElfColV",f:eJ},10:{n:"PtgElfRadical",f:nJ},11:{n:"PtgElfRadicalS",f:rJ},13:{n:"PtgElfColS",f:JQ},15:{n:"PtgElfColSV",f:tJ},16:{n:"PtgElfRadicalLel",f:iJ},25:{n:"PtgList",f:lJ},29:{n:"PtgSxName",f:cJ},255:{}},vJ={0:{n:"PtgAttrNoop",f:pJ},1:{n:"PtgAttrSemi",f:EQ},2:{n:"PtgAttrIf",f:bQ},4:{n:"PtgAttrChoose",f:yQ},8:{n:"PtgAttrGoto",f:_Q},16:{n:"PtgAttrSum",f:LQ},32:{n:"PtgAttrBaxcel",f:V3},33:{n:"PtgAttrBaxcel",f:V3},64:{n:"PtgAttrSpace",f:AQ},65:{n:"PtgAttrSpaceSemi",f:SQ},128:{n:"PtgAttrIfError",f:wQ},255:{}};function xJ(n,t,e,i){if(i.biff<8)return _o(n,t);for(var r=n.l+t,s=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=zQ(n,0,i),s.push(e[a][1]);break;case"PtgMemArea":e[a][2]=UQ(n,e[a][1],i),s.push(e[a][2]);break;case"PtgExp":i&&i.biff==12&&(e[a][1][1]=n.read_shift(4),s.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0]}return t=r-n.l,t!==0&&s.push(_o(n,t)),s}function yJ(n,t,e){for(var i=n.l+t,r,s,a=[];i!=n.l;)t=i-n.l,s=n[n.l],r=W3[s]||W3[mJ[s]],(s===24||s===25)&&(r=(s===24?gJ:vJ)[n[n.l+1]]),!r||!r.f?_o(n,t):a.push([r.n,r.f(n,t,e)]);return a}function _J(n){for(var t=[],e=0;e<n.length;++e){for(var i=n[e],r=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:r.push('"'+a[1].replace(/"/g,'""')+'"');break;default:r.push(a[1])}else r.push("")}t.push(r.join(","))}return t.join(";")}var bJ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function wJ(n,t){var e=n.lastIndexOf("!"),i=t.lastIndexOf("!");return e==-1&&i==-1?n+":"+t:e>0&&i>0&&n.slice(0,e).toLowerCase()==t.slice(0,i).toLowerCase()?n+":"+t.slice(i+1):(console.error("Cannot hydrate range",n,t),n+":"+t)}function MI(n,t,e){if(!n)return"SH33TJSERR0";if(e.biff>8&&(!n.XTI||!n.XTI[t]))return n.SheetNames[t];if(!n.XTI)return"SH33TJSERR6";var i=n.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":n.XTI[t-1];if(!i)return"SH33TJSERR1";var r="";if(e.biff>8)switch(n[i[0]][0]){case 357:return r=i[1]==-1?"#REF":n.SheetNames[i[1]],i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 358:return e.SID!=null?n.SheetNames[e.SID]:"SH33TJSSAME"+n[i[0]][0];case 355:default:return"SH33TJSSRC"+n[i[0]][0]}switch(n[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":n.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 14849:return n[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[i[0]][0][3]?(r=i[1]==-1?"#REF":n[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+n[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function X3(n,t,e){var i=MI(n,t,e);return i=="#REF"?i:p0(i,e)}function wd(n,t,e,i,r){var s=r&&r.biff||8,a={s:{c:0,r:0}},l=[],u,f,d,p=0,m=0,g,y="";if(!n[0]||!n[0][0])return"";for(var x=-1,_="",b=0,S=n[0].length;b<S;++b){var A=n[0][b];switch(A[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),x>=0){switch(n[0][x][1][0]){case 0:_=qn(" ",n[0][x][1][1]);break;case 1:_=qn("\r",n[0][x][1][1]);break;default:if(_="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}f=f+_,x=-1}l.push(f+bJ[A[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(wJ(f,u));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=$p(A[1][1],a,r),l.push(Gp(d,s));break;case"PtgRefN":d=e?$p(A[1][1],e,r):A[1][1],l.push(Gp(d,s));break;case"PtgRef3d":p=A[1][1],d=$p(A[1][2],a,r),y=X3(i,p,r),l.push(y+"!"+Gp(d,s));break;case"PtgFunc":case"PtgFuncVar":var C=A[1][0],O=A[1][1];C||(C=0),C&=127;var N=C==0?[]:l.slice(-C);l.length-=C,O==="User"&&(O=N.shift()),l.push(O+"("+N.join(",")+")");break;case"PtgBool":l.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(A[1]);break;case"PtgNum":l.push(String(A[1]));break;case"PtgStr":l.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(A[1]);break;case"PtgAreaN":g=D3(A[1][1],e?{s:e}:a,r),l.push(Tb(g,r));break;case"PtgArea":g=D3(A[1][1],a,r),l.push(Tb(g,r));break;case"PtgArea3d":p=A[1][1],g=A[1][2],y=X3(i,p,r),l.push(y+"!"+Tb(g,r));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=A[1][2];var D=(i.names||[])[m-1]||(i[0]||[])[m],L=D?D.Name:"SH33TJSNAME"+String(m);L&&L.slice(0,6)=="_xlfn."&&!r.xlfn&&(L=L.slice(6)),l.push(L);break;case"PtgNameX":var I=A[1][1];m=A[1][2];var z;if(r.biff<=5)I<0&&(I=-I),i[I]&&(z=i[I][m]);else{var j="";if(((i[I]||[])[0]||[])[0]==14849||(((i[I]||[])[0]||[])[0]==1025?i[I][m]&&i[I][m].itab>0&&(j=i.SheetNames[i[I][m].itab-1]+"!"):j=i.SheetNames[m-1]+"!"),i[I]&&i[I][m])j+=i[I][m].Name;else if(i[0]&&i[0][m])j+=i[0][m].Name;else{var B=(MI(i,I,r)||"").split(";;");B[m-1]?j=B[m-1]:j+="SH33TJSERRX"}l.push(j);break}z||(z={Name:"SH33TJSERRY"}),l.push(z.Name);break;case"PtgParen":var tt="(",k=")";if(x>=0){switch(_="",n[0][x][1][0]){case 2:tt=qn(" ",n[0][x][1][1])+tt;break;case 3:tt=qn("\r",n[0][x][1][1])+tt;break;case 4:k=qn(" ",n[0][x][1][1])+k;break;case 5:k=qn("\r",n[0][x][1][1])+k;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}l.push(tt+l.pop()+k);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:A[1][1],r:A[1][0]};var et={c:e.c,r:e.r};if(i.sharedf[ri(d)]){var K=i.sharedf[ri(d)];l.push(wd(K,a,et,i,r))}else{var q=!1;for(u=0;u!=i.arrayf.length;++u)if(f=i.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(wd(f[1],a,et,i,r)),q=!0;break}q||l.push(A[1])}break;case"PtgArray":l.push("{"+_J(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var _t=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&x>=0&&_t.indexOf(n[0][b][0])==-1){A=n[0][x];var at=!0;switch(A[1][0]){case 4:at=!1;case 0:_=qn(" ",A[1][1]);break;case 5:at=!1;case 1:_=qn("\r",A[1][1]);break;default:if(_="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}l.push((at?_:"")+l.pop()+(at?"":_)),x=-1}}if(l.length>1&&r.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function EJ(n){if(n==null){var t=jt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof n=="number")return Nu(n);return Nu(0)}function AJ(n,t,e,i,r){var s=Lu(t,e,r),a=EJ(n.v),l=jt(6),u=33;l.write_shift(2,u),l.write_shift(4,0);for(var f=jt(n.bf.length),d=0;d<n.bf.length;++d)f[d]=n.bf[d];var p=Si([s,a,l,f]);return p}function wx(n,t,e){var i=n.read_shift(4),r=yJ(n,i,e),s=n.read_shift(4),a=s>0?xJ(n,s,r,e):null;return[r,a]}var SJ=wx,Ex=wx,TJ=wx,CJ=wx;function Y3(n){if((n|0)==n&&n<Math.pow(2,16)&&n>=0){var t=jt(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,n),t.write_shift(4,0),t}var e=jt(17);return e.write_shift(4,11),e.write_shift(1,31),e.write_shift(8,n),e.write_shift(4,0),e}function DJ(n){var t=jt(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,n),t.write_shift(4,0),t}function OJ(n){var t=jt(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,n?1:0),t.write_shift(4,0),t}function RJ(n){var t=jt(7);t.write_shift(4,3+2*n.length),t.write_shift(1,23),t.write_shift(2,n.length);var e=jt(2*n.length);e.write_shift(2*n.length,n,"utf16le");var i=jt(4);return i.write_shift(4,0),Si([t,e,i])}function NJ(n){var t=Kn(n),e=jt(15);return e.write_shift(4,7),e.write_shift(1,36),e.write_shift(4,t.r),e.write_shift(2,t.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),e.write_shift(4,0),e}function LJ(n,t){var e=n.lastIndexOf("!"),i=n.slice(0,e);n=n.slice(e+1);var r=Kn(n);i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var s=jt(17);return s.write_shift(4,9),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,r.r),s.write_shift(2,r.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s}function IJ(n,t){var e=n.lastIndexOf("!"),i=n.slice(0,e);n=n.slice(e+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var r=jt(17);return r.write_shift(4,9),r.write_shift(1,60),r.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(i.toLowerCase())),r.write_shift(4,0),r.write_shift(2,0),r.write_shift(4,0),r}function kJ(n){var t=n.split(":"),e=t[0],i=jt(23);i.write_shift(4,15),e=t[0];var r=Kn(e);return i.write_shift(1,36),i.write_shift(4,r.r),i.write_shift(2,r.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),e=t[1],r=Kn(e),i.write_shift(1,36),i.write_shift(4,r.r),i.write_shift(2,r.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i.write_shift(1,17),i.write_shift(4,0),i}function MJ(n,t){var e=n.lastIndexOf("!"),i=n.slice(0,e);n=n.slice(e+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var r=n.split(":"),s=jt(27);s.write_shift(4,19);var a=r[0],l=Kn(a);return s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(u){return u.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),a=r[1],l=Kn(a),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(u){return u.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),s.write_shift(1,17),s.write_shift(4,0),s}function FJ(n,t){var e=n.lastIndexOf("!"),i=n.slice(0,e);n=n.slice(e+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var r=rr(n),s=jt(23);return s.write_shift(4,15),s.write_shift(1,59),s.write_shift(2,2+t.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,r.s.r),s.write_shift(4,r.e.r),s.write_shift(2,r.s.c),s.write_shift(2,r.e.c),s.write_shift(4,0),s}function PJ(n,t){if(typeof n=="number")return Y3(n);if(typeof n=="boolean")return OJ(n);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(n))return DJ(+vo[n]);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return NJ(n);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return kJ(n);if(n.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return FJ(n,t);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return LJ(n,t);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return MJ(n,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(n))return IJ(n,t);if(/^".*"$/.test(n))return RJ(n);if(/^[+-]\d+$/.test(n))return Y3(parseInt(n,10));throw"Formula |"+n+"| not supported for XLSB"}var BJ=PJ,jJ={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},FI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},UJ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function zJ(n){var t="of:="+n.replace(_x,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function PI(n){return n.replace(/!/,".").replace(/:/,":.")}var Vp=typeof Map<"u";function gA(n,t,e){var i=0,r=n.length;if(e){if(Vp?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var s=Vp?e.get(t):e[t];i<s.length;++i)if(n[s[i]].t===t)return n.Count++,s[i]}}else for(;i<r;++i)if(n[i].t===t)return n.Count++,i;return n[r]={t},n.Count++,n.Unique++,e&&(Vp?(e.has(t)||e.set(t,[]),e.get(t).push(r)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(r))),r}function Ax(n,t){var e={min:n+1,max:n+1},i=-1;return t.MDW&&(gl=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?i=b1(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(e.width=oE(i),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function BI(n,t){if(n){var e=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=e[0]),n.right==null&&(n.right=e[1]),n.top==null&&(n.top=e[2]),n.bottom==null&&(n.bottom=e[3]),n.header==null&&(n.header=e[4]),n.footer==null&&(n.footer=e[5])}}function Dc(n,t,e){var i=e.revssf[t.z!=null?t.z:"General"],r=60,s=n.length;if(i==null&&e.ssf){for(;r<392;++r)if(e.ssf[r]==null){pq(t.z,r),e.ssf[r]=t.z,e.revssf[t.z]=i=r;break}}for(r=0;r!=s;++r)if(n[r].numFmtId===i)return r;return n[s]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function HJ(n,t,e){if(n&&n["!ref"]){var i=Vn(n["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+n["!ref"])}}function $J(n){if(n.length===0)return"";for(var t='<mergeCells count="'+n.length+'">',e=0;e!=n.length;++e)t+='<mergeCell ref="'+Ci(n[e])+'"/>';return t+"</mergeCells>"}function GJ(n,t,e,i,r){var s=!1,a={},l=null;if(i.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[e];try{t.Workbook&&(u=t.Workbook.Sheets[e].CodeName||u)}catch{}s=!0,a.codeName=f0(qe(u))}if(n&&n["!outline"]){var f={summaryBelow:1,summaryRight:1};n["!outline"].above&&(f.summaryBelow=0),n["!outline"].left&&(f.summaryRight=0),l=(l||"")+se("outlinePr",null,f)}!s&&!l||(r[r.length]=se("sheetPr",l,a))}var VJ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],WJ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function XJ(n){var t={sheet:1};return VJ.forEach(function(e){n[e]!=null&&n[e]&&(t[e]="1")}),WJ.forEach(function(e){n[e]!=null&&!n[e]&&(t[e]="0")}),n.password&&(t.password=wI(n.password).toString(16).toUpperCase()),se("sheetProtection",null,t)}function YJ(n){return BI(n),se("pageMargins",null,n)}function qJ(n,t){for(var e=["<cols>"],i,r=0;r!=t.length;++r)(i=t[r])&&(e[e.length]=se("col",null,Ax(r,i)));return e[e.length]="</cols>",e.join("")}function KJ(n,t,e,i){var r=typeof n.ref=="string"?n.ref:Ci(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,a=rr(r);a.s.r==a.e.r&&(a.e.r=rr(t["!ref"]).e.r,r=Ci(a));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==i){u.Ref=p0(e.SheetNames[i])+"!"+h0(r);break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+r}),se("autoFilter",null,{ref:r})}function ZJ(n,t,e,i){var r={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,r),{})}function QJ(n,t,e,i,r,s,a){if(n.c&&e["!comments"].push([t,n.c]),(n.v===void 0||n.t==="z"&&!(i||{}).sheetStubs)&&typeof n.f!="string"&&typeof n.z>"u")return"";var l="",u=n.t,f=n.v;if(n.t!=="z")switch(n.t){case"b":l=n.v?"1":"0";break;case"n":isNaN(n.v)?(n.t="e",l=Vr[n.v=36]):isFinite(n.v)?l=""+n.v:(n.t="e",l=Vr[n.v=7]);break;case"e":l=Vr[n.v];break;case"d":if(i&&i.cellDates){var d=hs(n.v,a);l=d.toISOString(),d.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else n=Ar(n),n.t="n",l=""+(n.v=sr(hs(n.v,a),a));typeof n.z>"u"&&(n.z=Gn[14]);break;default:l=n.v;break}var p=n.t=="z"||n.v==null?"":er("v",qe(l)),m={r:t},g=Dc(i.cellXfs,n,i);switch(g!==0&&(m.s=g),n.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){p=er("v",""+gA(i.Strings,n.v,i.revStrings)),m.t="s";break}else m.t="str";break}if(n.t!=u&&(n.t=u,n.v=f),typeof n.f=="string"&&n.f){var y=n.F&&n.F.slice(0,t.length)==t?{t:"array",ref:n.F}:null;p=se("f",qe(n.f),y)+(n.v!=null?p:"")}return n.l&&(n.l.display=qe(l),e["!links"].push([t,n.l])),n.D&&(m.cm=1),se("c",p,m)}function JJ(n,t,e,i){var r=[],s=[],a=Vn(n["!ref"]),l="",u,f="",d=[],p=0,m=0,g=n["!rows"],y=n["!data"]!=null,x=y?n["!data"]:[],_={r:f},b,S=-1,A=(((i||{}).Workbook||{}).WBProps||{}).date1904;for(m=a.s.c;m<=a.e.c;++m)d[m]=Dn(m);for(p=a.s.r;p<=a.e.r;++p){s=[],f=Fn(p);var C=y?x[p]:[];for(m=a.s.c;m<=a.e.c;++m){u=d[m]+f;var O=y?C[m]:n[u];O!==void 0&&(l=QJ(O,u,n,t,e,i,A))!=null&&s.push(l)}(s.length>0||g&&g[p])&&(_={r:f},g&&g[p]&&(b=g[p],b.hidden&&(_.hidden=1),S=-1,b.hpx?S=w1(b.hpx):b.hpt&&(S=b.hpt),S>-1&&(_.ht=S,_.customHeight=1),b.level&&(_.outlineLevel=b.level)),r[r.length]=se("row",s.join(""),_))}if(g)for(;p<g.length;++p)g&&g[p]&&(_={r:p+1},b=g[p],b.hidden&&(_.hidden=1),S=-1,b.hpx?S=w1(b.hpx):b.hpt&&(S=b.hpt),S>-1&&(_.ht=S,_.customHeight=1),b.level&&(_.outlineLevel=b.level),r[r.length]=se("row","",_));return r.join("")}function ttt(n,t,e,i){var r=[Di,se("worksheet",null,{xmlns:Id[0],"xmlns:r":Hi.r})],s=e.SheetNames[n],a=0,l="",u=e.Sheets[s];u==null&&(u={});var f=u["!ref"]||"A1",d=Vn(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=Ci(d)}i||(i={}),u["!comments"]=[];var p=[];GJ(u,e,n,t,r),r[r.length]=se("dimension",null,{ref:f}),r[r.length]=ZJ(u,t,n,e),t.sheetFormat&&(r[r.length]=se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(r[r.length]=qJ(u,u["!cols"])),r[a=r.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(l=JJ(u,t,n,e),l.length>0&&(r[r.length]=l)),r.length>a+1&&(r[r.length]="</sheetData>",r[a]=r[a].replace("/>",">")),u["!protect"]&&(r[r.length]=XJ(u["!protect"])),u["!autofilter"]!=null&&(r[r.length]=KJ(u["!autofilter"],u,e,n)),u["!merges"]!=null&&u["!merges"].length>0&&(r[r.length]=$J(u["!merges"]));var m=-1,g,y=-1;return u["!links"].length>0&&(r[r.length]="<hyperlinks>",u["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(y=yn(i,-1,qe(x[1].Target).replace(/#[\s\S]*$/,""),un.HLINK),g["r:id"]="rId"+y),(m=x[1].Target.indexOf("#"))>-1&&(g.location=qe(x[1].Target.slice(m+1))),x[1].Tooltip&&(g.tooltip=qe(x[1].Tooltip)),g.display=x[1].display,r[r.length]=se("hyperlink",null,g))}),r[r.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(r[r.length]=YJ(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(r[r.length]=er("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(y=yn(i,-1,"../drawings/drawing"+(n+1)+".xml",un.DRAW),r[r.length]=se("drawing",null,{"r:id":"rId"+y}),u["!drawing"]=p),u["!comments"].length>0&&(y=yn(i,-1,"../drawings/vmlDrawing"+(n+1)+".vml",un.VML),r[r.length]=se("legacyDrawing",null,{"r:id":"rId"+y}),u["!legacy"]=y),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ett(n,t){var e={},i=n.l+t;e.r=n.read_shift(4),n.l+=4;var r=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=i,s&7&&(e.level=s&7),s&16&&(e.hidden=!0),s&32&&(e.hpt=r/20),e}function ntt(n,t,e){var i=jt(145),r=(e["!rows"]||[])[n]||{};i.write_shift(4,n),i.write_shift(4,0);var s=320;r.hpx?s=w1(r.hpx)*20:r.hpt&&(s=r.hpt*20),i.write_shift(2,s),i.write_shift(1,0);var a=0;r.level&&(a|=r.level),r.hidden&&(a|=16),(r.hpx||r.hpt)&&(a|=32),i.write_shift(1,a),i.write_shift(1,0);var l=0,u=i.l;i.l+=4;for(var f={r:n,c:0},d=e["!data"]!=null,p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var m=-1,g=-1,y=p<<10;y<p+1<<10;++y){f.c=y;var x=d?(e["!data"][f.r]||[])[f.c]:e[ri(f)];x&&(m<0&&(m=y),g=y)}m<0||(++l,i.write_shift(4,m),i.write_shift(4,g))}var _=i.l;return i.l=u,i.write_shift(4,l),i.l=_,i.length>i.l?i.slice(0,i.l):i}function itt(n,t,e,i){var r=ntt(i,e,t);(r.length>17||(t["!rows"]||[])[i])&&qt(n,0,r)}var rtt=Gu,stt=Fd;function att(){}function ott(n,t){var e={},i=n[n.l];return++n.l,e.above=!(i&64),e.left=!(i&128),n.l+=18,e.name=eK(n),e}function ltt(n,t,e){e==null&&(e=jt(84+4*n.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),e.write_shift(1,i);for(var r=1;r<3;++r)e.write_shift(1,0);return x1({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),iI(n,e),e.slice(0,e.l)}function ctt(n){var t=ha(n);return[t]}function utt(n,t,e){return e==null&&(e=jt(8)),zu(t,e)}function ftt(n){var t=Hu(n);return[t]}function dtt(n,t,e){return e==null&&(e=jt(4)),$u(t,e)}function htt(n){var t=ha(n),e=n.read_shift(1);return[t,e,"b"]}function ptt(n,t,e){return e==null&&(e=jt(9)),zu(t,e),e.write_shift(1,n.v?1:0),e}function mtt(n){var t=Hu(n),e=n.read_shift(1);return[t,e,"b"]}function gtt(n,t,e){return e==null&&(e=jt(5)),$u(t,e),e.write_shift(1,n.v?1:0),e}function vtt(n){var t=ha(n),e=n.read_shift(1);return[t,e,"e"]}function Nb(n,t,e){return e==null&&(e=jt(9)),zu(t,e),e.write_shift(1,n.v),e}function xtt(n){var t=Hu(n),e=n.read_shift(1);return[t,e,"e"]}function Lb(n,t,e){return e==null&&(e=jt(8)),$u(t,e),e.write_shift(1,n.v),e.write_shift(2,0),e.write_shift(1,0),e}function ytt(n){var t=ha(n),e=n.read_shift(4);return[t,e,"s"]}function _tt(n,t,e){return e==null&&(e=jt(12)),zu(t,e),e.write_shift(4,t.v),e}function btt(n){var t=Hu(n),e=n.read_shift(4);return[t,e,"s"]}function wtt(n,t,e){return e==null&&(e=jt(8)),$u(t,e),e.write_shift(4,t.v),e}function Ett(n){var t=ha(n),e=Pd(n);return[t,e,"n"]}function Att(n,t,e){return e==null&&(e=jt(16)),zu(t,e),Nu(n.v,e),e}function Stt(n){var t=Hu(n),e=Pd(n);return[t,e,"n"]}function Ttt(n,t,e){return e==null&&(e=jt(12)),$u(t,e),Nu(n.v,e),e}function Ctt(n){var t=ha(n),e=dA(n);return[t,e,"n"]}function Dtt(n,t,e){return e==null&&(e=jt(12)),zu(t,e),rI(n.v,e),e}function Ott(n){var t=Hu(n),e=dA(n);return[t,e,"n"]}function Rtt(n,t,e){return e==null&&(e=jt(8)),$u(t,e),rI(n.v,e),e}function Ntt(n){var t=ha(n),e=uA(n);return[t,e,"is"]}function Ltt(n){var t=ha(n),e=Er(n);return[t,e,"str"]}function Itt(n,t,e){var i=n.v==null?"":String(n.v);return e==null&&(e=jt(12+4*n.v.length)),zu(t,e),Fi(i,e),e.length>e.l?e.slice(0,e.l):e}function ktt(n){var t=Hu(n),e=Er(n);return[t,e,"str"]}function Mtt(n,t,e){var i=n.v==null?"":String(n.v);return e==null&&(e=jt(8+4*i.length)),$u(t,e),Fi(i,e),e.length>e.l?e.slice(0,e.l):e}function Ftt(n,t,e){var i=n.l+t,r=ha(n);r.r=e["!row"];var s=n.read_shift(1),a=[r,s,"b"];if(e.cellFormula){n.l+=2;var l=Ex(n,i-n.l,e);a[3]=wd(l,null,r,e.supbooks,e)}else n.l=i;return a}function Ptt(n,t,e){var i=n.l+t,r=ha(n);r.r=e["!row"];var s=n.read_shift(1),a=[r,s,"e"];if(e.cellFormula){n.l+=2;var l=Ex(n,i-n.l,e);a[3]=wd(l,null,r,e.supbooks,e)}else n.l=i;return a}function Btt(n,t,e){var i=n.l+t,r=ha(n);r.r=e["!row"];var s=Pd(n),a=[r,s,"n"];if(e.cellFormula){n.l+=2;var l=Ex(n,i-n.l,e);a[3]=wd(l,null,r,e.supbooks,e)}else n.l=i;return a}function jtt(n,t,e){var i=n.l+t,r=ha(n);r.r=e["!row"];var s=Er(n),a=[r,s,"str"];if(e.cellFormula){n.l+=2;var l=Ex(n,i-n.l,e);a[3]=wd(l,null,r,e.supbooks,e)}else n.l=i;return a}var Utt=Gu,ztt=Fd;function Htt(n,t){return t==null&&(t=jt(4)),t.write_shift(4,n),t}function $tt(n,t){var e=n.l+t,i=Gu(n),r=yx(n),s=Er(n),a=Er(n),l=Er(n);n.l=e;var u={rfx:i,relId:r,loc:s,display:l};return a&&(u.Tooltip=a),u}function Gtt(n,t){var e=jt(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Fd({s:Kn(n[0]),e:Kn(n[0])},e),fA("rId"+t,e);var i=n[1].Target.indexOf("#"),r=i==-1?"":n[1].Target.slice(i+1);return Fi(r||"",e),Fi(n[1].Tooltip||"",e),Fi("",e),e.slice(0,e.l)}function Vtt(){}function Wtt(n,t,e){var i=n.l+t,r=sI(n),s=n.read_shift(1),a=[r];if(a[2]=s,e.cellFormula){var l=SJ(n,i-n.l,e);a[1]=l}else n.l=i;return a}function Xtt(n,t,e){var i=n.l+t,r=Gu(n),s=[r];if(e.cellFormula){var a=CJ(n,i-n.l,e);s[1]=a,n.l=i}else n.l=i;return s}function Ytt(n,t,e){e==null&&(e=jt(18));var i=Ax(n,t);e.write_shift(-4,n),e.write_shift(-4,n),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var r=0;return t.hidden&&(r|=1),typeof i.width=="number"&&(r|=2),t.level&&(r|=t.level<<8),e.write_shift(2,r),e}var jI=["left","right","top","bottom","header","footer"];function qtt(n){var t={};return jI.forEach(function(e){t[e]=Pd(n)}),t}function Ktt(n,t){return t==null&&(t=jt(6*8)),BI(n),jI.forEach(function(e){Nu(n[e],t)}),t}function Ztt(n){var t=n.read_shift(2);return n.l+=28,{RTL:t&32}}function Qtt(n,t,e){e==null&&(e=jt(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Jtt(n){var t=jt(24);return t.write_shift(4,4),t.write_shift(4,1),Fd(n,t),t}function tet(n,t){return t==null&&(t=jt(16*4+2)),t.write_shift(2,n.password?wI(n.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,n[e[0]]!=null&&!n[e[0]]?1:0):t.write_shift(4,n[e[0]]!=null&&n[e[0]]?0:1)}),t}function eet(){}function net(){}function iet(n,t,e,i,r,s,a,l){var u={r:e,c:i};if(t.c&&s["!comments"].push([ri(u),t.c]),t.v===void 0)return!1;var f="";switch(t.t){case"b":f=t.v?"1":"0";break;case"d":t=Ar(t),t.z=t.z||Gn[14],t.v=sr(hs(t.v,l),l),t.t="n";break;case"n":case"e":f=""+t.v;break;default:f=t.v;break}switch(u.s=Dc(r.cellXfs,t,r),t.l&&s["!links"].push([ri(u),t.l]),t.t){case"s":case"str":return r.bookSST?(f=gA(r.Strings,t.v==null?"":String(t.v),r.revStrings),u.t="s",u.v=f,a?qt(n,18,wtt(t,u)):qt(n,7,_tt(t,u))):(u.t="str",a?qt(n,17,Mtt(t,u)):qt(n,6,Itt(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?qt(n,13,Rtt(t,u)):qt(n,2,Dtt(t,u)):isFinite(t.v)?a?qt(n,16,Ttt(t,u)):qt(n,5,Att(t,u)):(u.t="e",isNaN(t.v)?a?qt(n,14,Lb({v:36},u)):qt(n,3,Nb({v:36},u)):a?qt(n,14,Lb({v:7},u)):qt(n,3,Nb({v:7},u))),!0;case"b":return u.t="b",a?qt(n,15,gtt(t,u)):qt(n,4,ptt(t,u)),!0;case"e":return u.t="e",a?qt(n,14,Lb(t,u)):qt(n,3,Nb(t,u)),!0}return a?qt(n,12,dtt(t,u)):qt(n,1,utt(t,u)),!0}function ret(n,t,e,i,r){var s=Vn(t["!ref"]||"A1"),a="",l=[],u=(((r||{}).Workbook||{}).WBProps||{}).date1904;qt(n,145);var f=t["!data"]!=null,d=f?t["!data"][s.s.r]:[],p=s.e.r;t["!rows"]&&(p=Math.max(s.e.r,t["!rows"].length-1));for(var m=s.s.r;m<=p;++m)if(a=Fn(m),f&&(d=t["!data"][m]),itt(n,t,s,m),!(f&&!d)){var g=!1;if(m<=s.e.r)for(var y=s.s.c;y<=s.e.c;++y){m===s.s.r&&(l[y]=Dn(y));var x=f?d[y]:t[l[y]+a];if(!x){g=!1;continue}g=iet(n,x,m,y,i,t,g,u)}}qt(n,146)}function set(n,t){!t||!t["!merges"]||(qt(n,177,Htt(t["!merges"].length)),t["!merges"].forEach(function(e){qt(n,176,ztt(e))}),qt(n,178))}function aet(n,t){!t||!t["!cols"]||(qt(n,390),t["!cols"].forEach(function(e,i){e&&qt(n,60,Ytt(i,e))}),qt(n,391))}function oet(n,t){!t||!t["!ref"]||(qt(n,648),qt(n,649,Jtt(Vn(t["!ref"]))),qt(n,650))}function cet(n,t,e){t["!links"].forEach(function(i){if(i[1].Target){var r=yn(e,-1,i[1].Target.replace(/#[\s\S]*$/,""),un.HLINK);qt(n,494,Gtt(i,r))}}),delete t["!links"]}function uet(n,t,e,i){if(t["!comments"].length>0){var r=yn(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",un.VML);qt(n,551,fA("rId"+r)),t["!legacy"]=r}}function fet(n,t,e,i){if(t["!autofilter"]){var r=t["!autofilter"],s=typeof r.ref=="string"?r.ref:Ci(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,l=rr(s);l.s.r==l.e.r&&(l.e.r=rr(t["!ref"]).e.r,s=Ci(l));for(var u=0;u<a.length;++u){var f=a[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i){f.Ref=p0(e.SheetNames[i])+"!"+h0(s);break}}u==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:p0(e.SheetNames[i])+"!"+h0(s)}),qt(n,161,Fd(Vn(s))),qt(n,162)}}function det(n,t,e){qt(n,133),qt(n,137,Qtt(t,e)),qt(n,138),qt(n,134)}function het(n,t){t["!protect"]&&qt(n,535,tet(t["!protect"]))}function pet(n,t,e,i){var r=wr(),s=e.SheetNames[n],a=e.Sheets[s]||{},l=s;try{e&&e.Workbook&&(l=e.Workbook.Sheets[n].CodeName||l)}catch{}var u=Vn(a["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],qt(r,129),(e.vbaraw||a["!outline"])&&qt(r,147,ltt(l,a["!outline"])),qt(r,148,stt(u)),det(r,a,e.Workbook),aet(r,a),ret(r,a,n,t,e),het(r,a),fet(r,a,e,n),set(r,a),cet(r,a,i),a["!margins"]&&qt(r,476,Ktt(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&oet(r,a),uet(r,a,n,i),qt(r,130),r.end()}function met(n,t){n.l+=10;var e=Er(n);return{name:e}}var get=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function vet(n){return!n.Workbook||!n.Workbook.WBProps?"false":Lq(n.Workbook.WBProps.date1904)?"true":"false"}var xet=":][*?/\\".split("");function UI(n,t){try{if(n=="")throw new Error("Sheet name cannot be blank");if(n.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(n.charCodeAt(0)==39||n.charCodeAt(n.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(n.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");xet.forEach(function(e){if(n.indexOf(e)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(e){throw e}return!0}function yet(n,t,e){n.forEach(function(i,r){UI(i);for(var s=0;s<r;++s)if(i==n[s])throw new Error("Duplicate Sheet Name: "+i);if(e){var a=t&&t[r]&&t[r].CodeName||i;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function _et(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var t=n.Workbook&&n.Workbook.Sheets||[];yet(n.SheetNames,t,!!n.vbaraw);for(var e=0;e<n.SheetNames.length;++e)HJ(n.Sheets[n.SheetNames[e]],n.SheetNames[e],e);n.SheetNames.forEach(function(i,r){var s=n.Sheets[i];if(!(!s||!s["!autofilter"])){var a;n.Workbook||(n.Workbook={}),n.Workbook.Names||(n.Workbook.Names=[]),n.Workbook.Names.forEach(function(u){u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r&&(a=u)});var l=p0(i)+"!"+h0(s["!autofilter"].ref);a?a.Ref=l:n.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:l})}})}function bet(n){var t=[Di];t[t.length]=se("workbook",null,{xmlns:Id[0],"xmlns:r":Hi.r});var e=n.Workbook&&(n.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(get.forEach(function(l){n.Workbook.WBProps[l[0]]!=null&&n.Workbook.WBProps[l[0]]!=l[1]&&(i[l[0]]=n.Workbook.WBProps[l[0]])}),n.Workbook.WBProps.CodeName&&(i.codeName=n.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=se("workbookPr",null,i);var r=n.Workbook&&n.Workbook.Sheets||[],s=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!r[s]||!r[s].Hidden);++s);s==n.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:qe(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),r[s])switch(r[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=se("sheet",null,a)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(l){var u={name:l.Name};l.Comment&&(u.comment=l.Comment),l.Sheet!=null&&(u.localSheetId=""+l.Sheet),l.Hidden&&(u.hidden="1"),l.Ref&&(t[t.length]=se("definedName",qe(l.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function wet(n,t){var e={};return e.Hidden=n.read_shift(4),e.iTabID=n.read_shift(4),e.strRelID=aE(n),e.name=Er(n),e}function Eet(n,t){return t||(t=jt(127)),t.write_shift(4,n.Hidden),t.write_shift(4,n.iTabID),fA(n.strRelID,t),Fi(n.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Aet(n,t){var e={},i=n.read_shift(4);e.defaultThemeVersion=n.read_shift(4);var r=t>8?Er(n):"";return r.length>0&&(e.CodeName=r),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function Tet(n,t){t||(t=jt(72));var e=0;return n&&(n.date1904&&(e|=1),n.filterPrivacy&&(e|=8)),t.write_shift(4,e),t.write_shift(4,0),iI(n&&n.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Cet(n,t,e){var i=n.l+t,r=n.read_shift(4);n.l+=1;var s=n.read_shift(4),a=nK(n),l,u="";try{l=TJ(n,0,e);try{u=yx(n)}catch{}}catch{console.error("Could not parse defined name "+a)}r&32&&(a="_xlnm."+a),n.l=i;var f={Name:a,Ptg:l,Flags:r};return s<268435455&&(f.Sheet=s),u&&(f.Comment=u),f}function Det(n,t){var e=jt(9),i=0,r=n.Name;pK.indexOf(r)>-1&&(i|=32,r=r.slice(6)),e.write_shift(4,i),e.write_shift(1,0),e.write_shift(4,n.Sheet==null?4294967295:n.Sheet);var s=[e,Fi(r),BJ(n.Ref,t)];if(n.Comment)s.push(m0(n.Comment));else{var a=jt(4);a.write_shift(4,4294967295),s.push(a)}return Si(s)}function Oet(n,t){qt(n,143);for(var e=0;e!=t.SheetNames.length;++e){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,r={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};qt(n,156,Eet(r))}qt(n,144)}function Ret(n,t){t||(t=jt(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return Fi("SheetJS",t),Fi(c1.version,t),Fi(c1.version,t),Fi("7262",t),t.length>t.l?t.slice(0,t.l):t}function Net(n,t){t||(t=jt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,n),t.write_shift(4,n);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function Let(n,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,i=0,r=-1,s=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&r==-1?r=i:e[i].Hidden==1&&s==-1&&(s=i);s>r||(qt(n,135),qt(n,158,Net(r)),qt(n,136))}}function Iet(n,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(e){try{if(e.Flags&14)return;qt(n,39,Det(e,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(e))}})}function ket(n){var t=n.SheetNames.length,e=jt(12*t+28);e.write_shift(4,t+2),e.write_shift(4,0),e.write_shift(4,-2),e.write_shift(4,-2),e.write_shift(4,0),e.write_shift(4,-1),e.write_shift(4,-1);for(var i=0;i<t;++i)e.write_shift(4,0),e.write_shift(4,i),e.write_shift(4,i);return e}function Met(n,t){qt(n,353),qt(n,357),qt(n,362,ket(t)),qt(n,354)}function Fet(n,t){var e=wr();return qt(e,131),qt(e,128,Ret()),qt(e,153,Tet(n.Workbook&&n.Workbook.WBProps||null)),Let(e,n),Oet(e,n),Met(e,n),(n.Workbook||{}).Names&&Iet(e,n),qt(e,132),e.end()}function Pet(n,t){var e=[];return n.Props&&e.push(yK(n.Props,t)),n.Custprops&&e.push(_K(n.Props,n.Custprops)),e.join("")}function Bet(n){return(((n||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function jet(n,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,r){var s=[];s.push(se("NumberFormat",null,{"ss:Format":qe(Gn[i.numFmtId])}));var a={"ss:ID":"s"+(21+r)};e.push(se("Style",s.join(""),a))}),se("Styles",e.join(""))}function zI(n){return se("NamedRange",null,{"ss:Name":n.Name.slice(0,6)=="_xlnm."?n.Name.slice(6):n.Name,"ss:RefersTo":"="+bx(n.Ref,{r:0,c:0})})}function Uet(n){if(!((n||{}).Workbook||{}).Names)return"";for(var t=n.Workbook.Names,e=[],i=0;i<t.length;++i){var r=t[i];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||e.push(zI(r)))}return se("Names",e.join(""))}function zet(n,t,e,i){if(!n||!((i||{}).Workbook||{}).Names)return"";for(var r=i.Workbook.Names,s=[],a=0;a<r.length;++a){var l=r[a];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||s.push(zI(l)))}return s.join("")}function Het(n,t,e,i){if(!n)return"";var r=[];if(n["!margins"]&&(r.push("<PageSetup>"),n["!margins"].header&&r.push(se("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&r.push(se("Footer",null,{"x:Margin":n["!margins"].footer})),r.push(se("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),r.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)r.push(se("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<e&&!(i.Workbook.Sheets[s]&&!i.Workbook.Sheets[s].Hidden);++s);s==e&&r.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),n["!protect"]&&(r.push(er("ProtectContents","True")),n["!protect"].objects&&r.push(er("ProtectObjects","True")),n["!protect"].scenarios&&r.push(er("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?r.push(er("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&r.push(er("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&r.push("<"+a[1]+"/>")})),r.length==0?"":se("WorksheetOptions",r.join(""),{xmlns:Rs.x})}function $et(n){return n.map(function(t){var e=Nq(t.t||""),i=se("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"}),r={};return t.a&&(r["ss:Author"]=t.a),n.hidden||(r["ss:ShowAlways"]="1"),se("Comment",i,r)}).join("")}function Get(n,t,e,i,r,s,a){if(!n||n.v==null&&n.f==null)return"";var l={};if(n.f&&(l["ss:Formula"]="="+qe(bx(n.f,a))),n.F&&n.F.slice(0,t.length)==t){var u=Kn(n.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(u.r==a.r?"":"["+(u.r-a.r)+"]")+"C"+(u.c==a.c?"":"["+(u.c-a.c)+"]")}if(n.l&&n.l.Target&&(l["ss:HRef"]=qe(n.l.Target),n.l.Tooltip&&(l["x:HRefScreenTip"]=qe(n.l.Tooltip))),e["!merges"])for(var f=e["!merges"],d=0;d!=f.length;++d)f[d].s.c!=a.c||f[d].s.r!=a.r||(f[d].e.c>f[d].s.c&&(l["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(l["ss:MergeDown"]=f[d].e.r-f[d].s.r));var p="",m="";switch(n.t){case"z":if(!i.sheetStubs)return"";break;case"n":isFinite(n.v)?(p="Number",m=String(n.v)):(p="Error",m=Vr[isNaN(n.v)?36:7]);break;case"b":p="Boolean",m=n.v?"1":"0";break;case"e":p="Error",m=Vr[n.v];break;case"d":p="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Gn[14]);break;case"s":p="String",m=Rq(n.v||"");break}var g=Dc(i.cellXfs,n,i);l["ss:StyleID"]="s"+(21+g),l["ss:Index"]=a.c+1;var y=n.v!=null?m:"",x=n.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(n.c||[]).length>0&&(x+=$et(n.c)),se("Cell",x,l)}function Vet(n,t){var e='<Row ss:Index="'+(n+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=AI(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function Wet(n,t,e,i){if(!n["!ref"])return"";var r=Vn(n["!ref"]),s=n["!merges"]||[],a=0,l=[];n["!cols"]&&n["!cols"].forEach(function(_,b){pA(_);var S=!!_.width,A=Ax(b,_),C={"ss:Index":b+1};S&&(C["ss:Width"]=_1(A.width)),_.hidden&&(C["ss:Hidden"]="1"),l.push(se("Column",null,C))});for(var u=n["!data"]!=null,f={r:0,c:0},d=r.s.r;d<=r.e.r;++d){var p=[Vet(d,(n["!rows"]||[])[d])];f.r=d;for(var m=r.s.c;m<=r.e.c;++m){f.c=m;var g=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>m)&&!(s[a].s.r>d)&&!(s[a].e.c<m)&&!(s[a].e.r<d)){(s[a].s.c!=m||s[a].s.r!=d)&&(g=!0);break}if(!g){var y=Dn(m)+Fn(d),x=u?(n["!data"][d]||[])[m]:n[y];p.push(Get(x,y,n,t,e,i,f))}}p.push("</Row>"),p.length>2&&l.push(p.join(""))}return l.join("")}function Xet(n,t,e){var i=[],r=e.SheetNames[n],s=e.Sheets[r],a=s?zet(s,t,n,e):"";return a.length>0&&i.push("<Names>"+a+"</Names>"),a=s?Wet(s,t,n,e):"",a.length>0&&i.push("<Table>"+a+"</Table>"),i.push(Het(s,t,n,e)),s&&s["!autofilter"]&&i.push('<AutoFilter x:Range="'+bx(h0(s["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),i.join("")}function Yet(n,t){t||(t={}),n.SSF||(n.SSF=Ar(Gn)),n.SSF&&(gx(),mx(n.SSF),t.revssf=vx(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF,t.cellXfs=[],Dc(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(Pet(n,t)),e.push(Bet(n)),e.push(""),e.push(Uet(n));for(var i=0;i<n.SheetNames.length;++i)e.push(se("Worksheet",Xet(i,t,n),{"ss:Name":qe(n.SheetNames[i])}));return e[2]=jet(n,t),Di+se("Workbook",e.join(""),{xmlns:Rs.ss,"xmlns:o":Rs.o,"xmlns:x":Rs.x,"xmlns:ss":Rs.ss,"xmlns:dt":Rs.dt,"xmlns:html":Rs.html})}var Ib={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function qet(n,t){var e=[],i=[],r=[],s=0,a,l=y3(R3,"n"),u=y3(N3,"n");if(n.Props)for(a=Ti(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(l,a[s])?e:Object.prototype.hasOwnProperty.call(u,a[s])?i:r).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=Ti(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(l,a[s])?e:Object.prototype.hasOwnProperty.call(u,a[s])?i:r).push([a[s],n.Custprops[a[s]]]);var f=[];for(s=0;s<r.length;++s)mI.indexOf(r[s][0])>-1||dI.indexOf(r[s][0])>-1||r[s][1]!=null&&f.push(r[s]);i.length&&Un.utils.cfb_add(t,"/SummaryInformation",F3(i,Ib.SI,u,N3)),(e.length||f.length)&&Un.utils.cfb_add(t,"/DocumentSummaryInformation",F3(e,Ib.DSI,l,R3,f.length?f:null,Ib.UDI))}function Ket(n,t){var e=t||{},i=Un.utils.cfb_new({root:"R"}),r="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":r="/Workbook",e.biff=8;break;case"biff5":r="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Un.utils.cfb_add(i,r,$I(n,e)),e.biff==8&&(n.Props||n.Custprops)&&qet(n,i),e.biff==8&&n.vbaraw&&rQ(i,Un.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),i}var Zet={0:{f:ett},1:{f:ctt},2:{f:Ctt},3:{f:vtt},4:{f:htt},5:{f:Ett},6:{f:Ltt},7:{f:ytt},8:{f:jtt},9:{f:Btt},10:{f:Ftt},11:{f:Ptt},12:{f:ftt},13:{f:Ott},14:{f:xtt},15:{f:mtt},16:{f:Stt},17:{f:ktt},18:{f:btt},19:{f:uA},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Cet},40:{},42:{},43:{f:EZ},44:{f:bZ},45:{f:TZ},46:{f:DZ},47:{f:CZ},48:{},49:{f:qq},50:{},51:{f:GZ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:JK},62:{f:Ntt},63:{f:ZZ},64:{f:eet},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_o,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ztt},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ott},148:{f:rtt,p:16},151:{f:Vtt},152:{},153:{f:Aet},154:{},155:{},156:{f:wet},157:{},158:{},159:{T:1,f:uZ},160:{T:-1},161:{T:1,f:Gu},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Utt},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:HZ},336:{T:-1},337:{f:XZ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:aE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:YK},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Wtt},427:{f:Xtt},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:qtt},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:att},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:$tt},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:aE},551:{f:yx},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nQ},633:{T:1},634:{T:-1},635:{T:1,f:tQ},636:{T:-1},637:{f:Jq},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:met},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:net},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Zt(n,t,e,i){var r=t;if(!isNaN(r)){var s=i||(e||[]).length||0,a=n.next(4);a.write_shift(2,r),a.write_shift(2,s),s>0&&oA(e)&&n.push(e)}}function Qet(n,t,e,i){var r=(e||[]).length||0;if(r<=8224)return Zt(n,t,e,r);var s=t;if(!isNaN(s)){for(var a=e.parts||[],l=0,u=0,f=0;f+(a[l]||8224)<=8224;)f+=a[l]||8224,l++;var d=n.next(4);for(d.write_shift(2,s),d.write_shift(2,f),n.push(e.slice(u,u+f)),u+=f;u<r;){for(d=n.next(4),d.write_shift(2,60),f=0;f+(a[l]||8224)<=8224;)f+=a[l]||8224,l++;d.write_shift(2,f),n.push(e.slice(u,u+f)),u+=f}}}function kb(n,t,e,i){var r=jt(9);return $0(r,n,t),gI(e,i||"b",r),r}function Jet(n,t,e){var i=jt(8+2*e.length);return $0(i,n,t),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function HI(n,t){t.forEach(function(e){var i=e[0].map(function(s){return s.t}).join("");if(i.length<=2048)return Zt(n,28,Ob(i,e[1],e[2]));Zt(n,28,Ob(i.slice(0,2048),e[1],e[2],i.length));for(var r=2048;r<i.length;r+=2048)Zt(n,28,Ob(i.slice(r,Math.min(r+2048,i.length)),-1,-1,Math.min(2048,i.length-r)))})}function tnt(n,t,e,i,r,s){var a=0;t.z!=null&&(a=r._BIFF2FmtTable.indexOf(t.z),a==-1&&(r._BIFF2FmtTable.push(t.z),a=r._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<r.cellXfs.length&&r.cellXfs[l].numFmtId!=a;++l);l==r.cellXfs.length&&r.cellXfs.push({numFmtId:a})}if(t.v!=null)switch(t.t){case"d":case"n":var u=t.t=="d"?sr(hs(t.v,s),s):t.v;r.biff==2&&u==(u|0)&&u>=0&&u<65536?Zt(n,2,iZ(e,i,u,l,a)):isNaN(u)?Zt(n,5,kb(e,i,36,"e")):isFinite(u)?Zt(n,3,nZ(e,i,u,l,a)):Zt(n,5,kb(e,i,7,"e"));return;case"b":case"e":Zt(n,5,kb(e,i,t.v,t.t));return;case"s":case"str":Zt(n,4,Jet(e,i,t.v==null?"":String(t.v).slice(0,255)));return}Zt(n,1,$0(null,e,i))}function ent(n,t,e,i,r){var s=t["!data"]!=null,a=Vn(t["!ref"]||"A1"),l="",u=[];if(a.e.c>255||a.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.r,16383)}for(var f=(((r||{}).Workbook||{}).WBProps||{}).date1904,d=[],p=[],m=a.s.c;m<=a.e.c;++m)u[m]=Dn(m);for(var g=a.s.r;g<=a.e.r;++g)for(s&&(d=t["!data"][g]||[]),l=Fn(g),m=a.s.c;m<=a.e.c;++m){var y=s?d[m]:t[u[m]+l];y&&(tnt(n,y,g,m,i,f),y.c&&p.push([y.c,g,m]))}HI(n,p)}function nnt(n,t){for(var e=t||{},i=wr(),r=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==e.sheet&&(r=s);if(r==0&&e.sheet&&n.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);Zt(i,e.biff==4?1033:e.biff==3?521:9,hA(n,16,e)),((n.Workbook||{}).WBProps||{}).date1904&&Zt(i,34,_r(!0)),e.cellXfs=[{numFmtId:0}],e._BIFF2FmtTable=["General"],e._Fonts=[];var a=wr();return ent(a,n.Sheets[n.SheetNames[r]],r,e,n),e._BIFF2FmtTable.forEach(function(l){e.biff<=3?Zt(i,30,zK(l)):Zt(i,1054,HK(l))}),e.cellXfs.forEach(function(l){switch(e.biff){case 2:Zt(i,67,GK(l));break;case 3:Zt(i,579,_I(l));break;case 4:Zt(i,1091,VK(l));break}}),delete e._BIFF2FmtTable,delete e.cellXfs,delete e._Fonts,i.push(a.end()),Zt(i,10),i.end()}var Ca=1,ia=[];function int(){var n=jt(82+8*ia.length);n.write_shift(2,15),n.write_shift(2,61440),n.write_shift(4,74+8*ia.length);{n.write_shift(2,0),n.write_shift(2,61446),n.write_shift(4,16+8*ia.length);{n.write_shift(4,Ca),n.write_shift(4,ia.length+1);for(var t=0,e=0;e<ia.length;++e)t+=ia[e]&&ia[e][1]||0;n.write_shift(4,t),n.write_shift(4,ia.length)}ia.forEach(function(i){n.write_shift(4,i[0]),n.write_shift(4,i[2])})}return n.write_shift(2,51),n.write_shift(2,61451),n.write_shift(4,18),n.write_shift(2,191),n.write_shift(4,524296),n.write_shift(2,385),n.write_shift(4,134217793),n.write_shift(2,448),n.write_shift(4,134217792),n.write_shift(2,64),n.write_shift(2,61726),n.write_shift(4,16),n.write_shift(4,134217741),n.write_shift(4,134217740),n.write_shift(4,134217751),n.write_shift(4,268435703),n}function rnt(n,t){var e=[],i=0,r=wr(),s=Ca,a;t.forEach(function(u,f){var d="",p=u[0].map(function(A){return A.a&&!d&&(d=A.a),A.t}).join("");++Ca;{var m=jt(150);m.write_shift(2,15),m.write_shift(2,61444),m.write_shift(4,150),m.write_shift(2,3234),m.write_shift(2,61450),m.write_shift(4,8),m.write_shift(4,Ca),m.write_shift(4,2560),m.write_shift(2,227),m.write_shift(2,61451),m.write_shift(4,84),m.write_shift(2,128),m.write_shift(4,0),m.write_shift(2,139),m.write_shift(4,2),m.write_shift(2,191),m.write_shift(4,524296),m.write_shift(2,344),m.l+=4,m.write_shift(2,385),m.write_shift(4,134217808),m.write_shift(2,387),m.write_shift(4,134217808),m.write_shift(2,389),m.write_shift(4,268435700),m.write_shift(2,447),m.write_shift(4,1048592),m.write_shift(2,448),m.write_shift(4,134217809),m.write_shift(2,451),m.write_shift(4,268435700),m.write_shift(2,513),m.write_shift(4,134217809),m.write_shift(2,515),m.write_shift(4,268435700),m.write_shift(2,575),m.write_shift(4,196609),m.write_shift(2,959),m.write_shift(4,131072|(u[0].hidden?2:0)),m.l+=2,m.write_shift(2,61456),m.write_shift(4,18),m.write_shift(2,3),m.write_shift(2,u[2]+2),m.l+=2,m.write_shift(2,u[1]+1),m.l+=2,m.write_shift(2,u[2]+4),m.l+=2,m.write_shift(2,u[1]+5),m.l+=2,m.l+=2,m.write_shift(2,61457),m.l+=4,m.l=150,f==0?a=m:Zt(r,236,m)}i+=150;{var g=jt(52);g.write_shift(2,21),g.write_shift(2,18),g.write_shift(2,25),g.write_shift(2,Ca),g.write_shift(2,0),g.l=22,g.write_shift(2,13),g.write_shift(2,22),g.write_shift(4,1651663474),g.write_shift(4,2503426821),g.write_shift(4,2150634280),g.write_shift(4,1768515844+Ca*256),g.write_shift(2,0),g.write_shift(4,0),g.l+=4,Zt(r,93,g)}{var y=jt(8);y.l+=2,y.write_shift(2,61453),y.l+=4,Zt(r,236,y)}i+=8;{var x=jt(18);x.write_shift(2,18),x.l+=8,x.write_shift(2,p.length),x.write_shift(2,16),x.l+=4,Zt(r,438,x);{var _=jt(1+p.length);_.write_shift(1,0),_.write_shift(p.length,p,"sbcs"),Zt(r,60,_)}{var b=jt(16);b.l+=8,b.write_shift(2,p.length),b.l+=6,Zt(r,60,b)}}{var S=jt(12+d.length);S.write_shift(2,u[1]),S.write_shift(2,u[2]),S.write_shift(2,0|(u[0].hidden?0:2)),S.write_shift(2,Ca),S.write_shift(2,d.length),S.write_shift(1,0),S.write_shift(d.length,d,"sbcs"),S.l++,e.push(S)}});{var l=jt(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,i+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,Ca),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,i+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,s),l.write_shift(4,5),Zt(n,236,a?Si([l,a]):l)}n.push(r.end()),e.forEach(function(u){Zt(n,28,u)}),ia.push([s,t.length+1,Ca]),++Ca}function snt(n,t,e){Zt(n,49,PK({sz:12,name:"Arial"},e))}function ant(n,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&Zt(n,1054,UK(r,t[r],e))})}function ont(n,t){var e=jt(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Zt(n,2151,e),e=jt(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),yI(Vn(t["!ref"]||"A1"),e),e.write_shift(4,4),Zt(n,2152,e)}function lnt(n,t){for(var e=0;e<16;++e)Zt(n,224,B3({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){Zt(n,224,B3(i,0,t))})}function cnt(n,t){for(var e=0;e<t["!links"].length;++e){var i=t["!links"][e];Zt(n,440,KK(i)),i[1].Tooltip&&Zt(n,2048,ZK(i))}delete t["!links"]}function unt(n,t){if(t){var e=0;t.forEach(function(i,r){++e<=256&&i&&Zt(n,125,tZ(Ax(r,i),r))})}}function fnt(n,t,e,i,r,s){var a=16+Dc(r.cellXfs,t,r);if(t.v==null&&!t.bf){Zt(n,513,Lu(e,i,a));return}if(t.bf)Zt(n,6,AJ(t,e,i,r,a));else switch(t.t){case"d":case"n":var l=t.t=="d"?sr(hs(t.v,s),s):t.v;isNaN(l)?Zt(n,517,Db(e,i,36,a,r,"e")):isFinite(l)?Zt(n,515,XK(e,i,l,a)):Zt(n,517,Db(e,i,7,a,r,"e"));break;case"b":case"e":Zt(n,517,Db(e,i,t.v,a,r,t.t));break;case"s":case"str":if(r.bookSST){var u=gA(r.Strings,t.v==null?"":String(t.v),r.revStrings);Zt(n,253,BK(e,i,u,a))}else Zt(n,516,jK(e,i,(t.v==null?"":String(t.v)).slice(0,255),a,r));break;default:Zt(n,513,Lu(e,i,a))}}function dnt(n,t,e){var i=wr(),r=e.SheetNames[n],s=e.Sheets[r]||{},a=(e||{}).Workbook||{},l=(a.Sheets||[])[n]||{},u=s["!data"]!=null,f=t.biff==8,d="",p=[],m=Vn(s["!ref"]||"A1"),g=f?65536:16384;if(m.e.c>255||m.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV"+g);m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.r,g-1)}Zt(i,2057,hA(e,16,t)),Zt(i,13,sa(1)),Zt(i,12,sa(100)),Zt(i,15,_r(!0)),Zt(i,17,_r(!1)),Zt(i,16,Nu(.001)),Zt(i,95,_r(!0)),Zt(i,42,_r(!1)),Zt(i,43,_r(!1)),Zt(i,130,sa(1)),Zt(i,128,WK()),Zt(i,131,_r(!1)),Zt(i,132,_r(!1)),f&&unt(i,s["!cols"]),Zt(i,512,$K(m,t));var y=(((e||{}).Workbook||{}).WBProps||{}).date1904;f&&(s["!links"]=[]);for(var x=m.s.c;x<=m.e.c;++x)p[x]=Dn(x);for(var _=[],b=[],S=m.s.r;S<=m.e.r;++S)for(u&&(b=s["!data"][S]||[]),d=Fn(S),x=m.s.c;x<=m.e.c;++x){var A=u?b[x]:s[p[x]+d];A&&(fnt(i,A,S,x,t,y),f&&A.l&&s["!links"].push([p[x]+d,A.l]),A.c&&_.push([A.c,S,x]))}var C=l.CodeName||l.name||r;return f?rnt(i,_):HI(i,_),f&&Zt(i,574,FK((a.Views||[])[0])),f&&(s["!merges"]||[]).length&&Zt(i,229,qK(s["!merges"])),f&&cnt(i,s),Zt(i,442,xI(C)),f&&ont(i,s),Zt(i,10),i.end()}function hnt(n,t,e){var i=wr(),r=(n||{}).Workbook||{},s=r.Sheets||[],a=r.WBProps||{},l=e.biff==8,u=e.biff==5;if(Zt(i,2057,hA(n,5,e)),e.bookType=="xla"&&Zt(i,135),Zt(i,225,l?sa(1200):null),Zt(i,193,EK(2)),u&&Zt(i,191),u&&Zt(i,192),Zt(i,226),Zt(i,92,LK("SheetJS",e)),Zt(i,66,sa(l?1200:1252)),l&&Zt(i,353,sa(0)),l&&Zt(i,448),Zt(i,317,eZ(n.SheetNames.length)),l&&n.vbaraw&&Zt(i,211),l&&n.vbaraw){var f=a.CodeName||"ThisWorkbook";Zt(i,442,xI(f))}Zt(i,156,sa(17)),Zt(i,25,_r(!1)),Zt(i,18,_r(!1)),Zt(i,19,sa(0)),l&&Zt(i,431,_r(!1)),l&&Zt(i,444,sa(0)),Zt(i,61,MK()),Zt(i,64,_r(!1)),Zt(i,141,sa(0)),Zt(i,34,_r(vet(n)=="true")),Zt(i,14,_r(!0)),l&&Zt(i,439,_r(!1)),Zt(i,218,sa(0)),snt(i,n,e),ant(i,n.SSF,e),lnt(i,e),l&&Zt(i,352,_r(!1));var d=i.end(),p=wr();l&&Zt(p,140,QK()),l&&ia.length&&Zt(p,235,int()),l&&e.Strings&&Qet(p,252,kK(e.Strings)),Zt(p,10);var m=p.end(),g=wr(),y=0,x=0;for(x=0;x<n.SheetNames.length;++x)y+=(l?12:11)+(l?2:1)*n.SheetNames[x].length;var _=d.length+y+m.length;for(x=0;x<n.SheetNames.length;++x){var b=s[x]||{};Zt(g,133,IK({pos:_,hs:b.Hidden||0,dt:0,name:n.SheetNames[x]},e)),_+=t[x].length}var S=g.end();if(y!=S.length)throw new Error("BS8 "+y+" != "+S.length);var A=[];return d.length&&A.push(d),S.length&&A.push(S),m.length&&A.push(m),Si(A)}function pnt(n,t){var e=t||{},i=[];n&&!n.SSF&&(n.SSF=Ar(Gn)),n&&n.SSF&&(gx(),mx(n.SSF),e.revssf=vx(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),Ca=1,ia=[],e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,vA(e),e.cellXfs=[],Dc(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var r=0;r<n.SheetNames.length;++r)i[i.length]=dnt(r,e,n);return i.unshift(hnt(n,i,e)),Si(i)}function $I(n,t){for(var e=0;e<=n.SheetNames.length;++e){var i=n.Sheets[n.SheetNames[e]];if(!(!i||!i["!ref"])){var r=rr(i["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost."),r.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond row 65536.  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return pnt(n,t);case 4:case 3:case 2:return nnt(n,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function mnt(n,t,e,i){for(var r=n["!merges"]||[],s=[],a={},l=n["!data"]!=null,u=t.s.c;u<=t.e.c;++u){for(var f=0,d=0,p=0;p<r.length;++p)if(!(r[p].s.r>e||r[p].s.c>u)&&!(r[p].e.r<e||r[p].e.c<u)){if(r[p].s.r<e||r[p].s.c<u){f=-1;break}f=r[p].e.r-r[p].s.r+1,d=r[p].e.c-r[p].s.c+1;break}if(!(f<0)){var m=Dn(u)+Fn(e),g=l?(n["!data"][e]||[])[u]:n[m];g&&g.t=="n"&&g.v!=null&&!isFinite(g.v)&&(isNaN(g.v)?g={t:"e",v:36,w:Vr[36]}:g={t:"e",v:7,w:Vr[7]});var y=g&&g.v!=null&&(g.h||Ab(g.w||(wl(g),g.w)||""))||"";a={},f>1&&(a.rowspan=f),d>1&&(a.colspan=d),i.editable?y='<span contenteditable="true">'+y+"</span>":g&&(a["data-t"]=g&&g.t||"z",g.v!=null&&(a["data-v"]=Ab(g.v instanceof Date?g.v.toISOString():g.v)),g.z!=null&&(a["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+Ab(g.l.Target)+'">'+y+"</a>")),a.id=(i.id||"sjs")+"-"+m,s.push(se("td",y,a))}}var x="<tr>";return x+s.join("")+"</tr>"}var gnt='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vnt="</body></html>";function xnt(n,t,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function GI(n,t){var e=t||{},i=e.header!=null?e.header:gnt,r=e.footer!=null?e.footer:vnt,s=[i],a=rr(n["!ref"]||"A1");if(s.push(xnt(n,a,e)),n["!ref"])for(var l=a.s.r;l<=a.e.r;++l)s.push(mnt(n,a,l,e));return s.push("</table>"+r),s.join("")}function VI(n,t,e){var i=t.rows;if(!i)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var r=e||{},s=n["!data"]!=null,a=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Kn(r.origin):r.origin;a=u.r,l=u.c}var f=Math.min(r.sheetRows||1e7,i.length),d={s:{r:0,c:0},e:{r:a,c:l}};if(n["!ref"]){var p=rr(n["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),a==-1&&(d.e.r=a=p.e.r+1)}var m=[],g=0,y=n["!rows"]||(n["!rows"]=[]),x=0,_=0,b=0,S=0,A=0,C=0;for(n["!cols"]||(n["!cols"]=[]);x<i.length&&_<f;++x){var O=i[x];if(q3(O)){if(r.display)continue;y[_]={hidden:!0}}var N=O.cells;for(b=S=0;b<N.length;++b){var D=N[b];if(!(r.display&&q3(D))){var L=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):Iq(D.innerHTML),I=D.getAttribute("data-z")||D.getAttribute("z");for(g=0;g<m.length;++g){var z=m[g];z.s.c==S+l&&z.s.r<_+a&&_+a<=z.e.r&&(S=z.e.c+1-l,g=-1)}C=+D.getAttribute("colspan")||1,((A=+D.getAttribute("rowspan")||1)>1||C>1)&&m.push({s:{r:_+a,c:S+l},e:{r:_+a+(A||1)-1,c:S+l+(C||1)-1}});var j={t:"s",v:L},B=D.getAttribute("data-t")||D.getAttribute("t")||"";L!=null&&(L.length==0?j.t=B||"z":r.raw||L.trim().length==0||B=="s"||(B=="e"&&Vr[+L]?j={t:"e",v:+L,w:Vr[+L]}:L==="TRUE"?j={t:"b",v:!0}:L==="FALSE"?j={t:"b",v:!1}:isNaN(ml(L))?isNaN(g1(L).getDate())?L.charCodeAt(0)==35&&vo[L]!=null&&(j={t:"e",v:vo[L],w:L}):(j={t:"d",v:hs(L)},r.UTC&&(j.v=xx(j.v)),r.cellDates||(j={t:"n",v:sr(j.v)}),j.z=r.dateNF||Gn[14]):j={t:"n",v:ml(L)})),j.z===void 0&&I!=null&&(j.z=I);var tt="",k=D.getElementsByTagName("A");if(k&&k.length)for(var et=0;et<k.length&&!(k[et].hasAttribute("href")&&(tt=k[et].getAttribute("href"),tt.charAt(0)!="#"));++et);tt&&tt.charAt(0)!="#"&&tt.slice(0,11).toLowerCase()!="javascript:"&&(j.l={Target:tt}),s?(n["!data"][_+a]||(n["!data"][_+a]=[]),n["!data"][_+a][S+l]=j):n[ri({c:S+l,r:_+a})]=j,d.e.c<S+l&&(d.e.c=S+l),S+=C}}++_}return m.length&&(n["!merges"]=(n["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,_-1+a),n["!ref"]=Ci(d),_>=f&&(n["!fullref"]=Ci((d.e.r=i.length-x+_-1+a,d))),n}function WI(n,t){var e=t||{},i={};return e.dense&&(i["!data"]=[]),VI(i,n,t)}function ynt(n,t){var e=kd(WI(n,t),t);return e}function q3(n){var t="",e=_nt(n);return e&&(t=e(n).getPropertyValue("display")),t||(t=n.style&&n.style.display),t==="none"}function _nt(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var bnt=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+d0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return Di+t}}();function wnt(n,t){var e="number",i="",r={"style:name":t},s="",a=0;n=n.replace(/"[$]"/g,"$");t:{if(n.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+n),n=n.slice(0,n.indexOf(";"))),n=="@"){e="text",i="<number:text-content/>";break t}if(n.indexOf(/\$/)>-1&&(e="currency"),n[a]=='"'){for(s="";n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,n[a+1]=="*"?(a++,i+="<number:fill-character>"+qe(s.replace(/""/g,'"'))+"</number:fill-character>"):i+="<number:text>"+qe(s.replace(/""/g,'"'))+"</number:text>",n=n.slice(a+1),a=0}var l=n.match(/# (\?+)\/(\?+)/);if(l){i+=se("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break t}if(l=n.match(/# (\?+)\/(\d+)/)){i+=se("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break t}if(l=n.match(/\b(\d+)(|\.\d+)%/)){e="percentage",i+=se("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break t}var u=!1;if(["y","m","d"].indexOf(n[0])>-1){e="date";e:for(;a<n.length;++a)switch(s=n[a].toLowerCase()){case"h":case"s":u=!0,--a;break e;case"m":n:for(var f=a+1;f<n.length;++f)switch(n[f]){case"y":case"d":break n;case"h":case"s":u=!0,--a;break e}case"y":case"d":for(;(n[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"y":case"yy":i+="<number:year/>";break;case"yyy":case"yyyy":i+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":i+='<number:month number:style="'+(s.length%2?"short":"long")+'" number:textual="'+(s.length>=3?"true":"false")+'"/>';break;case"d":case"dd":i+='<number:day number:style="'+(s.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":i+='<number:day-of-week number:style="'+(s.length%2?"short":"long")+'"/>';break}break;case'"':for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,i+="<number:text>"+qe(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":s=n[++a],i+="<number:text>"+qe(s)+"</number:text>";break;case"/":case":":i+="<number:text>"+qe(s)+"</number:text>";break;default:console.error("unrecognized character "+s+" in ODF format "+n)}if(!u)break t;n=n.slice(a+1),a=0}if(n.match(/^\[?[hms]/)){for(e=="number"&&(e="time"),n.match(/\[/)&&(n=n.replace(/[\[\]]/g,""),r["number:truncate-on-overflow"]="false");a<n.length;++a)switch(s=n[a].toLowerCase()){case"h":case"m":case"s":for(;(n[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"h":case"hh":i+='<number:hours number:style="'+(s.length%2?"short":"long")+'"/>';break;case"m":case"mm":i+='<number:minutes number:style="'+(s.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(n[a+1]==".")do s+=n[a+1],++a;while(n[a+1]=="0");i+='<number:seconds number:style="'+(s.match("ss")?"long":"short")+'"'+(s.match(/\./)?' number:decimal-places="'+(s.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,i+="<number:text>"+qe(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":i+="<number:text>"+qe(s)+"</number:text>";break;case"a":if(n.slice(a,a+3).toLowerCase()=="a/p"){i+="<number:am-pm/>",a+=2;break}if(n.slice(a,a+5).toLowerCase()=="am/pm"){i+="<number:am-pm/>",a+=4;break}default:console.error("unrecognized character "+s+" in ODF format "+n)}break t}if(n.indexOf(/\$/)>-1&&(e="currency"),n[0]=="$"&&(i+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',n=n.slice(1),a=0),a=0,n[a]=='"'){for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,n[a+1]=="*"?(a++,i+="<number:fill-character>"+qe(s.replace(/""/g,'"'))+"</number:fill-character>"):i+="<number:text>"+qe(s.replace(/""/g,'"'))+"</number:text>",n=n.slice(a+1),a=0}var d=n.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+n);else{var p=d[1].replace(/,/g,"");i+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(p.indexOf("0")==-1?"0":p.length-p.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",a=d.index+d[0].length}if(n[a]=='"'){for(s="";n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,i+="<number:text>"+qe(s.replace(/""/g,'"'))+"</number:text>"}}return i?se("number:"+e+"-style",i,r):(console.error("Could not generate ODS number format for |"+n+"|"),"")}function K3(n,t,e){for(var i=[],r=0;r<n.length;++r){var s=n[r];s&&s.Sheet==(e==-1?null:e)&&i.push(s)}return i.length?`      <table:named-expressions>
`+i.map(function(a){var l=(e==-1?"$":"")+PI(a.Ref);return"        "+se("table:named-range",null,{"table:name":a.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var Z3=function(){var n=function(r,s){return qe(r).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=function(r,s,a,l,u,f){var d=[];d.push('      <table:table table:name="'+qe(s.SheetNames[a])+`" table:style-name="ta1">
`);var p=0,m=0,g=rr(r["!ref"]||"A1"),y=r["!merges"]||[],x=0,_=r["!data"]!=null;if(r["!cols"])for(m=0;m<=g.e.c;++m)d.push("        <table:table-column"+(r["!cols"][m]?' table:style-name="co'+r["!cols"][m].ods+'"':"")+`></table:table-column>
`);var b="",S=r["!rows"]||[];for(p=0;p<g.s.r;++p)b=S[p]?' table:style-name="ro'+S[p].ods+'"':"",d.push("        <table:table-row"+b+`></table:table-row>
`);for(;p<=g.e.r;++p){for(b=S[p]?' table:style-name="ro'+S[p].ods+'"':"",d.push("        <table:table-row"+b+`>
`),m=0;m<g.s.c;++m)d.push(t);for(;m<=g.e.c;++m){var A=!1,C={},O="";for(x=0;x!=y.length;++x)if(!(y[x].s.c>m)&&!(y[x].s.r>p)&&!(y[x].e.c<m)&&!(y[x].e.r<p)){(y[x].s.c!=m||y[x].s.r!=p)&&(A=!0),C["table:number-columns-spanned"]=y[x].e.c-y[x].s.c+1,C["table:number-rows-spanned"]=y[x].e.r-y[x].s.r+1;break}if(A){d.push(`          <table:covered-table-cell/>
`);continue}var N=ri({r:p,c:m}),D=_?(r["!data"][p]||[])[m]:r[N];if(D&&D.f&&(C["table:formula"]=qe(zJ(D.f)),D.F&&D.F.slice(0,N.length)==N)){var L=rr(D.F);C["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,C["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!D){d.push(t);continue}switch(D.t){case"b":O=D.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=D.v?"true":"false";break;case"n":isFinite(D.v)?(O=D.w||String(D.v||0),C["office:value-type"]="float",C["office:value"]=D.v||0):(isNaN(D.v)?(O="#NUM!",C["table:formula"]="of:=#NUM!"):(O="#DIV/0!",C["table:formula"]="of:="+(D.v<0?"-":"")+"1/0"),C["office:string-value"]="",C["office:value-type"]="string",C["calcext:value-type"]="error");break;case"s":case"str":O=D.v==null?"":D.v,C["office:value-type"]="string";break;case"d":O=D.w||hs(D.v,f).toISOString(),C["office:value-type"]="date",C["office:date-value"]=hs(D.v,f).toISOString(),C["table:style-name"]="ce1";break;default:d.push(t);continue}var I=n(O);if(D.l&&D.l.Target){var z=D.l.Target;z=z.charAt(0)=="#"?"#"+PI(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),I=se("text:a",I,{"xlink:href":z.replace(/&/g,"&amp;")})}u[D.z]&&(C["table:style-name"]="ce"+u[D.z].slice(1));var j=se("text:p",I,{});if(D.c){for(var B="",tt="",k={},et=0;et<D.c.length;++et)!B&&D.c[et].a&&(B=D.c[et].a),tt+="<text:p>"+n(D.c[et].t)+"</text:p>";D.c.hidden||(k["office:display"]=!0),j=se("office:annotation",tt,k)+j}d.push("          "+se("table:table-cell",j,C)+`
`)}d.push(`        </table:table-row>
`)}return(s.Workbook||{}).Names&&d.push(K3(s.Workbook.Names,s.SheetNames,a)),d.push(`      </table:table>
`),d.join("")},i=function(r,s){r.push(` <office:automatic-styles>
`);var a=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var m=d["!cols"][p];if(m.width==null&&m.wpx==null&&m.wch==null)continue;pA(m),m.ods=a;var g=d["!cols"][p].wpx+"px";r.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),r.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),r.push(`  </style:style>
`),++a}}});var l=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=l;var m=d["!rows"][p].hpx+"px";r.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),r.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),r.push(`  </style:style>
`),++l}}}),r.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),r.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),r.push(`  </style:style>
`),r.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),r.push(`   <number:month number:style="long"/>
`),r.push(`   <number:text>/</number:text>
`),r.push(`   <number:day number:style="long"/>
`),r.push(`   <number:text>/</number:text>
`),r.push(`   <number:year/>
`),r.push(`  </number:date-style>
`);var u={},f=69;return s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d){var p=d["!data"]!=null;if(d["!ref"])for(var m=rr(d["!ref"]),g=0;g<=m.e.r;++g)for(var y=0;y<=m.e.c;++y){var x=p?(d["!data"][g]||[])[y]:d[ri({r:g,c:y})];if(!(!x||!x.z||x.z.toLowerCase()=="general")&&!u[x.z]){var _=wnt(x.z,"N"+f);_&&(u[x.z]="N"+f,++f,r.push(_+`
`))}}}}),r.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Ti(u).forEach(function(d){r.push('<style:style style:name="ce'+u[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+u[d]+`"/>
`)}),r.push(` </office:automatic-styles>
`),u};return function(s,a){var l=[Di],u=d0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=d0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(uI().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+u+`>
`);var d=i(l,s);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((s.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var p=0;p!=s.SheetNames.length;++p)l.push(e(s.Sheets[s.SheetNames[p]],s,p,a,d,((s.Workbook||{}).WBProps||{}).date1904));return(s.Workbook||{}).Names&&l.push(K3(s.Workbook.Names,s.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function XI(n,t){if(t.bookType=="fods")return Z3(n,t);var e=iA(),i="",r=[],s=[];return i="mimetype",Ye(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Ye(e,i,Z3(n,t)),r.push([i,"text/xml"]),s.push([i,"ContentFile"]),i="styles.xml",Ye(e,i,bnt(n,t)),r.push([i,"text/xml"]),s.push([i,"StylesFile"]),i="meta.xml",Ye(e,i,Di+uI()),r.push([i,"text/xml"]),s.push([i,"MetadataFile"]),i="manifest.rdf",Ye(e,i,xK(s)),r.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Ye(e,i,gK(r)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var zr=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function E1(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function g0(n){return typeof TextDecoder<"u"?new TextDecoder().decode(n):ed(Ou(n))}function Br(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):Os(f0(n))}function Ac(n){for(var t=0,e=0;e<n.length;++e)t+=n[e].length;var i=new Uint8Array(t),r=0;for(e=0;e<n.length;++e){var s=n[e],a=s.length;if(a<250)for(var l=0;l<a;++l)i[r++]=s[l];else i.set(s,r),r+=a}return i}function Ent(n,t,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-16,r=e/Math.pow(10,i-6176);n[t+15]|=i>>7,n[t+14]|=(i&127)<<1;for(var s=0;r>=1;++s,r/=256)n[t+s]=r&255;n[t+15]|=e>=0?0:128}function v0(n,t){var e=t.l,i=n[e]&127;t:if(n[e++]>=128&&(i|=(n[e]&127)<<7,n[e++]<128||(i|=(n[e]&127)<<14,n[e++]<128)||(i|=(n[e]&127)<<21,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,28),++e,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,35),++e,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,42),++e,n[e++]<128)))break t;return t.l=e,i}function ve(n){var t=new Uint8Array(7);t[0]=n&127;var e=1;t:if(n>127){if(t[e-1]|=128,t[e]=n>>7&127,++e,n<=16383||(t[e-1]|=128,t[e]=n>>14&127,++e,n<=2097151)||(t[e-1]|=128,t[e]=n>>21&127,++e,n<=268435455)||(t[e-1]|=128,t[e]=n/256>>>21&127,++e,n<=34359738367)||(t[e-1]|=128,t[e]=n/65536>>>21&127,++e,n<=4398046511103))break t;t[e-1]|=128,t[e]=n/16777216>>>21&127,++e}return t[zr](0,e)}function YI(n){for(var t={l:0},e=[];t.l<n.length;)e.push(v0(n,t));return e}function qI(n){return Ac(n.map(function(t){return ve(t)}))}function Is(n){var t=0,e=n[t]&127;return n[t++]<128||(e|=(n[t]&127)<<7,n[t++]<128)||(e|=(n[t]&127)<<14,n[t++]<128)||(e|=(n[t]&127)<<21,n[t++]<128)||(e|=(n[t]&15)<<28),e}function De(n){for(var t=[],e={l:0};e.l<n.length;){var i=e.l,r=v0(n,e),s=r&7;r=r/8|0;var a,l=e.l;switch(s){case 0:{for(;n[l++]>=128;);a=n[zr](e.l,l),e.l=l}break;case 1:a=n[zr](l,l+8),e.l=l+8;break;case 2:{var u=v0(n,e);a=n[zr](e.l,e.l+u),e.l+=u}break;case 5:a=n[zr](l,l+4),e.l=l+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(r," at offset ").concat(i))}var f={data:a,type:s};t[r]==null&&(t[r]=[]),t[r].push(f)}return t}function ye(n){var t=[];return n.forEach(function(e,i){i!=0&&e.forEach(function(r){r.data&&(t.push(ve(i*8+r.type)),r.type==2&&t.push(ve(r.data.length)),t.push(r.data))})}),Ac(t)}function A1(n,t){return n?.map(function(e){return t(e.data)})||[]}function S1(n){for(var t,e=[],i={l:0};i.l<n.length;){var r=v0(n,i),s=De(n[zr](i.l,i.l+r));i.l+=r;var a={id:Is(s[1][0].data),messages:[]};s[2].forEach(function(l){var u=De(l.data),f=Is(u[3][0].data);a.messages.push({meta:u,data:n[zr](i.l,i.l+f)}),i.l+=f}),(t=s[3])!=null&&t[0]&&(a.merge=Is(s[3][0].data)>>>0>0),e.push(a)}return e}function rd(n){var t=[];return n.forEach(function(e){var i=[[],[{data:ve(e.id),type:0}],[]];e.merge!=null&&(i[3]=[{data:ve(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(a){r.push(a.data),a.meta[3]=[{type:0,data:ve(a.data.length)}],i[2].push({data:ye(a.meta),type:2})});var s=ye(i);t.push(ve(s.length)),t.push(s),r.forEach(function(a){return t.push(a)})}),Ac(t)}function Ant(n,t){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var e={l:0},i=v0(t,e),r=[],s=e.l;s<t.length;){var a=t[s]&3;if(a==0){var l=t[s++]>>2;if(l<60)++l;else{var u=l-59;l=t[s],u>1&&(l|=t[s+1]<<8),u>2&&(l|=t[s+2]<<16),u>3&&(l|=t[s+3]<<24),l>>>=0,l++,s+=u}r.push(t[zr](s,s+l)),s+=l;continue}else{var f=0,d=0;if(a==1?(d=(t[s]>>2&7)+4,f=(t[s++]&224)<<3,f|=t[s++]):(d=(t[s++]>>2)+1,a==2?(f=t[s]|t[s+1]<<8,s+=2):(f=(t[s]|t[s+1]<<8|t[s+2]<<16|t[s+3]<<24)>>>0,s+=4)),f==0)throw new Error("Invalid offset 0");for(var p=r.length-1,m=f;p>=0&&m>=r[p].length;)m-=r[p].length,--p;if(p<0)if(m==0)m=r[p=0].length;else throw new Error("Invalid offset beyond length");if(d<m)r.push(r[p][zr](r[p].length-m,r[p].length-m+d));else{for(m>0&&(r.push(r[p][zr](r[p].length-m)),d-=m),++p;d>=r[p].length;)r.push(r[p]),d-=r[p].length,++p;d&&r.push(r[p][zr](0,d))}r.length>25&&(r=[Ac(r)])}}for(var g=0,y=0;y<r.length;++y)g+=r[y].length;if(g!=i)throw new Error("Unexpected length: ".concat(g," != ").concat(i));return r}function T1(n){Array.isArray(n)&&(n=new Uint8Array(n));for(var t=[],e=0;e<n.length;){var i=n[e++],r=n[e]|n[e+1]<<8|n[e+2]<<16;e+=3,t.push.apply(t,Ant(i,n[zr](e,e+r))),e+=r}if(e!==n.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:Ac(t)}function sd(n){for(var t=[],e=0;e<n.length;){var i=Math.min(n.length-e,268435455),r=new Uint8Array(4);t.push(r);var s=ve(i),a=s.length;t.push(s),i<=60?(a++,t.push(new Uint8Array([i-1<<2]))):i<=256?(a+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(a+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(a+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(a+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(n[zr](e,e+i)),a+=i,r[0]=0,r[1]=a&255,r[2]=a>>8&255,r[3]=a>>16&255,e+=i}return Ac(t)}function Mb(n,t){var e=new Uint8Array(32),i=E1(e),r=12,s=0;switch(e[0]=5,n.t){case"n":if(n.z&&Ru(n.z)){e[1]=5,i.setFloat64(r,(td(n.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,r+=8;break}else e[1]=2,Ent(e,r,n.v),s|=1,r+=16;break;case"b":e[1]=6,i.setFloat64(r,n.v?1:0,!0),s|=2,r+=8;break;case"s":{var a=n.v==null?"":String(n.v);if(n.l){var l=t.rsst.findIndex(function(f){var d;return f.v==a&&f.l==((d=n.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:a,l:n.l.Target}),e[1]=9,i.setUint32(r,l,!0),s|=16,r+=4}else{var u=t.sst.indexOf(a);u==-1&&(t.sst[u=t.sst.length]=a),e[1]=3,i.setUint32(r,u,!0),s|=8,r+=4}}break;case"d":e[1]=5,i.setFloat64(r,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,r+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+n.t}return n.c&&(t.cmnt.push(Snt(n.c)),i.setUint32(r,t.cmnt.length-1,!0),s|=524288,r+=4),i.setUint32(8,s,!0),e[zr](0,r)}function Fb(n,t){var e=new Uint8Array(32),i=E1(e),r=12,s=0,a="";switch(e[0]=4,n.t){case"n":break;case"b":break;case"s":if(a=n.v==null?"":String(n.v),n.l){var l=t.rsst.findIndex(function(f){var d;return f.v==a&&f.l==((d=n.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:a,l:n.l.Target}),e[1]=9,i.setUint32(r,l,!0),s|=512,r+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+n.t}switch(n.c&&(i.setUint32(r,t.cmnt.length-1,!0),s|=4096,r+=4),n.t){case"n":e[1]=2,i.setFloat64(r,n.v,!0),s|=32,r+=8;break;case"b":e[1]=6,i.setFloat64(r,n.v?1:0,!0),s|=32,r+=8;break;case"s":if(a=n.v==null?"":String(n.v),!n.l){var u=t.sst.indexOf(a);u==-1&&(t.sst[u=t.sst.length]=a),e[1]=3,i.setUint32(r,u,!0),s|=16,r+=4}break;case"d":e[1]=5,i.setFloat64(r,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=64,r+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+n.t}return i.setUint32(8,s,!0),e[zr](0,r)}function Ei(n){var t=De(n);return Is(t[1][0].data)}function yr(n){return ye([[],[{type:0,data:ve(n)}]])}function xr(n,t){var e,i=(e=n.messages[0].meta[5])!=null&&e[0]?YI(n.messages[0].meta[5][0].data):[],r=i.indexOf(t);r==-1&&(i.push(t),n.messages[0].meta[5]=[{type:2,data:qI(i)}])}function il(n,t){var e,i=(e=n.messages[0].meta[5])!=null&&e[0]?YI(n.messages[0].meta[5][0].data):[];n.messages[0].meta[5]=[{type:2,data:qI(i.filter(function(r){return r!=t}))}]}function Snt(n){for(var t={a:"",t:"",replies:[]},e=0;e<n.length;++e)e==0?(t.a=n[e].a,t.t=n[e].t):t.replies.push({a:n[e].a,t:n[e].t});return t}function Tnt(n,t,e){var i,r,s,a=[[],[{type:0,data:ve(0)}],[{type:0,data:ve(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ve(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ve(1)}]];if(!((i=a[6])!=null&&i[0])||!((r=a[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(a[7][0].data.length<2*n.length){var u=new Uint8Array(2*n.length);u.set(a[7][0].data),a[7][0].data=u}if(a[4][0].data.length<2*n.length){var f=new Uint8Array(2*n.length);f.set(a[4][0].data),a[4][0].data=f}for(var d=E1(a[7][0].data),p=0,m=[],g=E1(a[4][0].data),y=0,x=[],_=4,b=0;b<n.length;++b){if(n[b]==null||n[b].t=="z"&&!((s=n[b].c)!=null&&s.length)||n[b].t=="e"){d.setUint16(b*2,65535,!0),g.setUint16(b*2,65535);continue}d.setUint16(b*2,p/_,!0),g.setUint16(b*2,y/_,!0);var S,A;switch(n[b].t){case"d":if(n[b].v instanceof Date){S=Mb(n[b],t),A=Fb(n[b],t);break}S=Mb(n[b],t),A=Fb(n[b],t);break;case"s":case"n":case"b":case"z":S=Mb(n[b],t),A=Fb(n[b],t);break;default:throw new Error("Unsupported value "+n[b])}m.push(S),p+=S.length,x.push(A),y+=A.length,++l}for(a[2][0].data=ve(l),a[5][0].data=ve(5);b<a[7][0].data.length/2;++b)d.setUint16(b*2,65535,!0),g.setUint16(b*2,65535,!0);return a[6][0].data=Ac(m),a[3][0].data=Ac(x),a[8]=[{type:0,data:ve(1)}],a}function lE(n,t){return{meta:[[],[{type:0,data:ve(n)}]],data:t}}function po(n,t){t.last||(t.last=927262);for(var e=t.last;e<2e6;++e)if(!t[e])return t[t.last=e]=n,e;throw new Error("Too many messages")}function Cnt(n){var t={},e=[];return n.FileIndex.map(function(i,r){return[i,n.FullPaths[r]]}).forEach(function(i){var r=i[0],s=i[1];r.type==2&&r.name.match(/\.iwa/)&&r.content[0]==0&&S1(T1(r.content)).forEach(function(a){e.push(a.id),t[a.id]={deps:[],location:s,type:Is(a.messages[0].meta[1][0].data)}})}),n.FileIndex.forEach(function(i){i.name.match(/\.iwa/)&&i.content[0]==0&&S1(T1(i.content)).forEach(function(r){r.messages.forEach(function(s){[5,6].forEach(function(a){s.meta[a]&&s.meta[a].forEach(function(l){t[r.id].deps.push(Is(l.data))})})})})}),t}function rv(n,t,e){return ye([[],[{type:0,data:ve(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([n/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:ve(1)}]])}function Q3(n){switch(n){case 0:return rv(99,222,171);case 1:return rv(162,197,240);case 2:return rv(255,189,189)}return rv(Math.random()*255,Math.random()*255,Math.random()*255)}function Dnt(n,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=Un.read(t.numbers,{type:"base64"}),i=Cnt(e),r=mo(e,i,1);if(r==null)throw"Could not find message ".concat(1," in Numbers template");var s=A1(De(r.messages[0].data)[1],Ei);if(s.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return n.SheetNames.forEach(function(a,l){l>=1&&(Rnt(e,i,l+1),r=mo(e,i,1),s=A1(De(r.messages[0].data)[1],Ei)),Nnt(e,i,n.Sheets[a],a,l,s[l])}),e}function Cn(n,t,e,i){var r=Un.find(n,t[e].location);if(!r)throw"Could not find ".concat(t[e].location," in Numbers template");var s=S1(T1(r.content)),a=s.find(function(l){return l.id==e});i(a,s),r.content=sd(rd(s)),r.size=r.content.length}function mo(n,t,e){var i=Un.find(n,t[e].location);if(!i)throw"Could not find ".concat(t[e].location," in Numbers template");var r=S1(T1(i.content)),s=r.find(function(a){return a.id==e});return s}function cE(n,t,e){n[3].push({type:2,data:ye([[],[{type:0,data:ve(t)}],[{type:2,data:Br(e.replace(/-[\s\S]*$/,""))}],[{type:2,data:Br(e)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ve(0)}],[],[{type:0,data:ve(0)}]])}),n[1]=[{type:0,data:ve(Math.max(t+1,Is(n[1][0].data)))}]}function ru(n,t,e,i,r,s){s||(s=po({deps:[],location:"",type:t},r));var a="".concat(i,"-").concat(s,".iwa");r[s].location="Root Entry"+a,Un.utils.cfb_add(n,a,sd(rd([{id:s,messages:[lE(t,ye(e))]}])));var l=a.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return Cn(n,r,2,function(u){var f=De(u.messages[0].data);cE(f,s||0,l),u.messages[0].data=ye(f)}),s}function ls(n,t,e,i){var r=t[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=n[3].findIndex(function(l){var u,f,d=De(l.data);return(u=d[3])!=null&&u[0]?g0(d[3][0].data)==r:!!((f=d[2])!=null&&f[0]&&g0(d[2][0].data)==r)}),a=De(n[3][s].data);a[6]||(a[6]=[]),(Array.isArray(i)?i:[i]).forEach(function(l){a[6].push({type:2,data:ye([[],[{type:0,data:ve(l)}]])})}),n[3][s].data=ye(a)}function Ont(n,t,e,i){var r=t[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=n[3].findIndex(function(l){var u,f,d=De(l.data);return(u=d[3])!=null&&u[0]?g0(d[3][0].data)==r:!!((f=d[2])!=null&&f[0]&&g0(d[2][0].data)==r)}),a=De(n[3][s].data);a[6]||(a[6]=[]),a[6]=a[6].filter(function(l){return Is(De(l.data)[1][0].data)!=i}),n[3][s].data=ye(a)}function Rnt(n,t,e){var i=-1,r=-1,s={};Cn(n,t,1,function(u,f){var d=De(u.messages[0].data);i=Ei(De(u.messages[0].data)[1][0].data),r=po({deps:[1],location:t[i].location,type:2},t),s[i]=r,xr(u,r),d[1].push({type:2,data:yr(r)});var p=mo(n,t,i);p.id=r,t[1].location==t[r].location?f.push(p):Cn(n,t,r,function(m,g){return g.push(p)}),u.messages[0].data=ye(d)});var a=-1;Cn(n,t,r,function(u,f){for(var d=De(u.messages[0].data),p=3;p<=69;++p)delete d[p];var m=A1(d[2],Ei);m.forEach(function(y){return il(u,y)}),a=po({deps:[r],location:t[m[0]].location,type:t[m[0]].type},t),xr(u,a),s[m[0]]=a,d[2]=[{type:2,data:yr(a)}];var g=mo(n,t,m[0]);g.id=a,t[m[0]].location==t[r].location?f.push(g):(Cn(n,t,2,function(y){var x=De(y.messages[0].data);ls(x,t,r,a),y.messages[0].data=ye(x)}),Cn(n,t,a,function(y,x){return x.push(g)})),u.messages[0].data=ye(d)});var l=-1;Cn(n,t,a,function(u,f){for(var d=De(u.messages[0].data),p=De(d[1][0].data),m=3;m<=69;++m)delete p[m];var g=Ei(p[2][0].data);p[2][0].data=yr(s[g]),d[1][0].data=ye(p);var y=Ei(d[2][0].data);il(u,y),l=po({deps:[a],location:t[y].location,type:t[y].type},t),xr(u,l),s[y]=l,d[2][0].data=yr(l);var x=mo(n,t,y);x.id=l,t[a].location==t[l].location?f.push(x):Cn(n,t,l,function(_,b){return b.push(x)}),u.messages[0].data=ye(d)}),Cn(n,t,l,function(u,f){var d,p,m=De(u.messages[0].data),g=g0(m[1][0].data),y=g.replace(/-[A-Z0-9]*/,"-".concat(("0000"+e.toString(16)).slice(-4)));if(m[1][0].data=Br(y),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(O){return delete m[O]}),m[45]){var x=De(m[45][0].data),_=Ei(x[1][0].data);il(u,_),delete m[45]}if(m[70]){var b=De(m[70][0].data);(d=b[2])==null||d.forEach(function(O){var N=De(O.data);[2,3].map(function(D){return N[D][0]}).forEach(function(D){var L=De(D.data);if(L[8]){var I=Ei(L[8][0].data);il(u,I)}})}),delete m[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(O){if(m[O]){var N=Ei(m[O][0].data);delete m[O],il(u,N)}});var S=De(m[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(O){var N;if((N=S[O])!=null&&N[0]){var D=Ei(S[O][0].data),L=po({deps:[l],location:t[D].location,type:t[D].type},t);il(u,D),xr(u,L),s[D]=L;var I=mo(n,t,D);if(I.id=L,t[D].location==t[l].location)f.push(I);else{t[L].location=t[D].location.replace(D.toString(),L.toString()),t[L].location==t[D].location&&(t[L].location=t[L].location.replace(/\.iwa/,"-".concat(L,".iwa"))),Un.utils.cfb_add(n,t[L].location,sd(rd([I])));var z=t[L].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Cn(n,t,2,function(j){var B=De(j.messages[0].data);cE(B,L,z),ls(B,t,l,L),j.messages[0].data=ye(B)})}S[O][0].data=yr(L)}});var A=De(S[1][0].data);(p=A[2])==null||p.forEach(function(O){var N=Ei(O.data),D=po({deps:[l],location:t[N].location,type:t[N].type},t);il(u,N),xr(u,D),s[N]=D;var L=mo(n,t,N);if(L.id=D,t[N].location==t[l].location)f.push(L);else{t[D].location=t[N].location.replace(N.toString(),D.toString()),t[D].location==t[N].location&&(t[D].location=t[D].location.replace(/\.iwa/,"-".concat(D,".iwa"))),Un.utils.cfb_add(n,t[D].location,sd(rd([L])));var I=t[D].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");Cn(n,t,2,function(z){var j=De(z.messages[0].data);cE(j,D,I),ls(j,t,l,D),z.messages[0].data=ye(j)})}O.data=yr(D)}),S[1][0].data=ye(A);var C=De(S[3][0].data);C[1].forEach(function(O){var N=De(O.data),D=Ei(N[2][0].data),L=s[D];if(!s[D]){L=po({deps:[l],location:"",type:t[D].type},t),t[L].location="Root Entry/Index/Tables/Tile-".concat(L,".iwa"),s[D]=L;var I=mo(n,t,D);I.id=L,il(u,D),xr(u,L),Un.utils.cfb_add(n,"/Index/Tables/Tile-".concat(L,".iwa"),sd(rd([I]))),Cn(n,t,2,function(z){var j=De(z.messages[0].data);j[3].push({type:2,data:ye([[],[{type:0,data:ve(L)}],[{type:2,data:Br("Tables/Tile")}],[{type:2,data:Br("Tables/Tile-".concat(L))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ve(0)}],[],[{type:0,data:ve(0)}]])}),j[1]=[{type:0,data:ve(Math.max(L+1,Is(j[1][0].data)))}],ls(j,t,l,L),z.messages[0].data=ye(j)})}N[2][0].data=yr(L),O.data=ye(N)}),S[3][0].data=ye(C)}m[4][0].data=ye(S),u.messages[0].data=ye(m)})}function Nnt(n,t,e,i,r,s){var a=[];Cn(n,t,s,function(f){var d=De(f.messages[0].data);d[1]=[{type:2,data:Br(i)}],a=A1(d[2],Ei),f.messages[0].data=ye(d)});var l=mo(n,t,a[0]),u=Ei(De(l.messages[0].data)[2][0].data);Cn(n,t,u,function(f,d){return Lnt(n,t,e,f,d,u)})}function Lnt(n,t,e,i,r,s){if(!e["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var a=rr(e["!ref"]);a.s.r=a.s.c=0;var l=!1;a.e.c>999&&(l=!0,a.e.c=999),a.e.r>999999&&(l=!0,a.e.r=999999),l&&console.error("Truncating to ".concat(Ci(a)));var u=[];if(e["!data"])u=e["!data"];else{for(var f=[],d=0;d<=a.e.c;++d)f[d]=Dn(d);for(var p=0;p<=a.e.r;++p){u[p]=[];var m=""+(p+1);for(d=0;d<=a.e.c;++d){var g=e[f[d]+m];g&&(u[p][d]=g)}}}var y={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},x=De(i.messages[0].data);{x[6][0].data=ve(a.e.r+1),x[7][0].data=ve(a.e.c+1),delete x[46];var _=De(x[4][0].data);{var b=Ei(De(_[1][0].data)[2][0].data);Cn(n,t,b,function(V,it){var ht,yt=De(V.messages[0].data);if((ht=yt?.[2])!=null&&ht[0])for(var Rt=0;Rt<u.length;++Rt){var Et=De(yt[2][0].data);Et[1][0].data=ve(Rt),Et[4][0].data=ve(u[Rt].length),yt[2][Rt]={type:yt[2][0].type,data:ye(Et)}}V.messages[0].data=ye(yt)});var S=Ei(_[2][0].data);Cn(n,t,S,function(V,it){for(var ht=De(V.messages[0].data),yt=0;yt<=a.e.c;++yt){var Rt=De(ht[2][0].data);Rt[1][0].data=ve(yt),Rt[4][0].data=ve(a.e.r+1),ht[2][yt]={type:ht[2][0].type,data:ye(Rt)}}V.messages[0].data=ye(ht)});var A=De(_[9][0].data);A[1]=[];var C=De(_[3][0].data);{var O=256;C[2]=[{type:0,data:ve(O)}];var N=Ei(De(C[1][0].data)[2][0].data),D=function(){var V=mo(n,t,2),it=De(V.messages[0].data),ht=it[3].filter(function(yt){return Is(De(yt.data)[1][0].data)==N});return ht?.length?Is(De(ht[0].data)[12][0].data):0}();Un.utils.cfb_del(n,t[N].location),Cn(n,t,2,function(V){var it=De(V.messages[0].data);it[3]=it[3].filter(function(ht){return Is(De(ht.data)[1][0].data)!=N}),Ont(it,t,s,N),V.messages[0].data=ye(it)}),il(i,N),C[1]=[];for(var L=Math.ceil((a.e.r+1)/O),I=0;I<L;++I){var z=po({deps:[],location:"",type:6002},t);t[z].location="Root Entry/Index/Tables/Tile-".concat(z,".iwa");for(var j=[[],[{type:0,data:ve(0)}],[{type:0,data:ve(Math.min(a.e.r+1,(I+1)*O))}],[{type:0,data:ve(0)}],[{type:0,data:ve(Math.min((I+1)*O,a.e.r+1)-I*O)}],[],[{type:0,data:ve(5)}],[{type:0,data:ve(1)}],[{type:0,data:ve(1)}]],B=I*O;B<=Math.min(a.e.r,(I+1)*O-1);++B){var tt=Tnt(u[B],y);tt[1][0].data=ve(B-I*O),j[5].push({data:ye(tt),type:2})}C[1].push({type:2,data:ye([[],[{type:0,data:ve(I)}],[{type:2,data:yr(z)}]])});var k={id:z,messages:[lE(6002,ye(j))]},et=sd(rd([k]));Un.utils.cfb_add(n,"/Index/Tables/Tile-".concat(z,".iwa"),et),Cn(n,t,2,function(V){var it=De(V.messages[0].data);it[3].push({type:2,data:ye([[],[{type:0,data:ve(z)}],[{type:2,data:Br("Tables/Tile")}],[{type:2,data:Br("Tables/Tile-".concat(z))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ve(0)}],[],[{type:0,data:ve(D)}]])}),it[1]=[{type:0,data:ve(Math.max(z+1,Is(it[1][0].data)))}],ls(it,t,s,z),V.messages[0].data=ye(it)}),xr(i,z),A[1].push({type:2,data:ye([[],[{type:0,data:ve(I*O)}],[{type:0,data:ve(I)}]])})}}if(_[3][0].data=ye(C),_[9][0].data=ye(A),_[10]=[{type:2,data:new Uint8Array([])}],e["!merges"]){var K=po({type:6144,deps:[s],location:t[s].location},t);r.push({id:K,messages:[lE(6144,ye([[],e["!merges"].map(function(V){return{type:2,data:ye([[],[{type:2,data:ye([[],[{type:5,data:new Uint8Array(new Uint16Array([V.s.r,V.s.c]).buffer)}]])}],[{type:2,data:ye([[],[{type:5,data:new Uint8Array(new Uint16Array([V.e.r-V.s.r+1,V.e.c-V.s.c+1]).buffer)}]])}]])}})]))]}),_[13]=[{type:2,data:yr(K)}],Cn(n,t,2,function(V){var it=De(V.messages[0].data);ls(it,t,s,K),V.messages[0].data=ye(it)}),xr(i,K)}else delete _[13];var q=Ei(_[4][0].data);Cn(n,t,q,function(V){var it=De(V.messages[0].data);it[3]=[],y.sst.forEach(function(ht,yt){yt!=0&&it[3].push({type:2,data:ye([[],[{type:0,data:ve(yt)}],[{type:0,data:ve(1)}],[{type:2,data:Br(ht)}]])})}),V.messages[0].data=ye(it)});var _t=Ei(_[17][0].data);if(Cn(n,t,_t,function(V){var it=De(V.messages[0].data);it[3]=[];var ht=[904980,903835,903815,903845];y.rsst.forEach(function(yt,Rt){if(Rt!=0){var Et=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:Br(yt.v)}]];Et[10]=[{type:0,data:new Uint8Array([1])}],Et[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Et[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Et[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Et[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Et[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Et[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Et[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Et[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var G=po({deps:[],location:"",type:2001},t),lt=[];if(yt.l){var rt=ru(n,2032,[[],[],[{type:2,data:Br(yt.l)}]],"/Index/Tables/DataList",t);Et[11]=[];var ot=[[],[]];ot[1]||(ot[1]=[]),ot[1].push({type:2,data:ye([[],[{type:0,data:ve(0)}],[{type:2,data:yr(rt)}]])}),Et[11][0]={type:2,data:ye(ot)},lt.push(rt)}ru(n,2001,Et,"/Index/Tables/DataList",t,G),Cn(n,t,G,function(St){ht.forEach(function(R){return xr(St,R)}),lt.forEach(function(R){return xr(St,R)})});var bt=ru(n,6218,[[],[{type:2,data:yr(G)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);Cn(n,t,bt,function(St){return xr(St,G)}),it[3].push({type:2,data:ye([[],[{type:0,data:ve(Rt)}],[{type:0,data:ve(1)}],[],[],[],[],[],[],[{type:2,data:yr(bt)}]])}),xr(V,bt),Cn(n,t,2,function(St){var R=De(St.messages[0].data);ls(R,t,_t,bt),ls(R,t,bt,G),ls(R,t,G,lt),ls(R,t,G,ht),St.messages[0].data=ye(R)})}}),V.messages[0].data=ye(it)}),y.cmnt.length>1){var at=Ei(_[19][0].data),P={},X=0;Cn(n,t,at,function(V){var it=De(V.messages[0].data);it[3]=[],y.cmnt.forEach(function(ht,yt){if(yt!=0){var Rt=[];ht.replies&&ht.replies.forEach(function(lt){P[lt.a||""]||(P[lt.a||""]=ru(n,212,[[],[{type:2,data:Br(lt.a||"")}],[{type:2,data:Q3(++X)}],[],[{type:0,data:ve(0)}]],"/Index/Tables/DataList",t));var rt=P[lt.a||""],ot=ru(n,3056,[[],[{type:2,data:Br(lt.t||"")}],[{type:2,data:ye([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:yr(rt)}]],"/Index/Tables/DataList",t);Cn(n,t,ot,function(bt){return xr(bt,rt)}),Rt.push(ot),Cn(n,t,2,function(bt){var St=De(bt.messages[0].data);ls(St,t,ot,rt),bt.messages[0].data=ye(St)})}),P[ht.a||""]||(P[ht.a||""]=ru(n,212,[[],[{type:2,data:Br(ht.a||"")}],[{type:2,data:Q3(++X)}],[],[{type:0,data:ve(0)}]],"/Index/Tables/DataList",t));var Et=P[ht.a||""],G=ru(n,3056,[[],[{type:2,data:Br(ht.t||"")}],[{type:2,data:ye([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:yr(Et)}],Rt.map(function(lt){return{type:2,data:yr(lt)}}),[{type:2,data:ye([[],[{type:0,data:ve(yt)}],[{type:0,data:ve(0)}]])}]],"/Index/Tables/DataList",t);Cn(n,t,G,function(lt){xr(lt,Et),Rt.forEach(function(rt){return xr(lt,rt)})}),it[3].push({type:2,data:ye([[],[{type:0,data:ve(yt)}],[{type:0,data:ve(1)}],[],[],[],[],[],[],[],[{type:2,data:yr(G)}]])}),xr(V,G),Cn(n,t,2,function(lt){var rt=De(lt.messages[0].data);ls(rt,t,at,G),ls(rt,t,G,Et),Rt.length&&ls(rt,t,G,Rt),lt.messages[0].data=ye(rt)})}}),it[2][0].data=ve(y.cmnt.length+1),V.messages[0].data=ye(it)})}}x[4][0].data=ye(_)}i.messages[0].data=ye(x)}function Int(n){return function(e){for(var i=0;i!=n.length;++i){var r=n[i];e[r[0]]===void 0&&(e[r[0]]=r[1]),r[2]==="n"&&(e[r[0]]=Number(e[r[0]]))}}}function vA(n){Int([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function knt(n,t){n&&!n.SSF&&(n.SSF=Ar(Gn)),n&&n.SSF&&(gx(),mx(n.SSF),t.revssf=vx(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vp?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="bin",i=!0,r=oI();vA(t=t||{});var s=iA(),a="",l=0;if(t.cellXfs=[],Dc(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",Ye(s,a,fI(n.Props,t)),r.coreprops.push(a),yn(t.rels,2,a,un.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var u=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(n.SheetNames[f]);n.Props.SheetNames=u}n.Props.Worksheets=n.Props.SheetNames.length,Ye(s,a,hI(n.Props)),r.extprops.push(a),yn(t.rels,3,a,un.EXT_PROPS),n.Custprops!==n.Props&&Ti(n.Custprops||{}).length>0&&(a="docProps/custom.xml",Ye(s,a,pI(n.Custprops)),r.custprops.push(a),yn(t.rels,4,a,un.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=n.SheetNames.length;++l){var p={"!id":{}},m=n.Sheets[n.SheetNames[l-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+l+"."+e,Ye(s,a,pet(l-1,t,n,p)),r.sheets.push(a),yn(t.wbrels,-1,"worksheets/sheet"+l+"."+e,un.WS[0])}if(m){var y=m["!comments"],x=!1,_="";if(y&&y.length>0){var b=!1;y.forEach(function(A){A[1].forEach(function(C){C.T==!0&&(b=!0)})}),b&&(_="xl/threadedComments/threadedComment"+l+".xml",Ye(s,_,DI(y,d,t)),r.threadedcomments.push(_),yn(p,-1,"../threadedComments/threadedComment"+l+".xml",un.TCMNT)),_="xl/comments"+l+"."+e,Ye(s,_,iQ(y)),r.comments.push(_),yn(p,-1,"../comments"+l+"."+e,un.CMNT),x=!0}m["!legacy"]&&x&&Ye(s,"xl/drawings/vmlDrawing"+l+".vml",CI(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&Ye(s,cI(a),nd(p))}t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,Ye(s,a,hZ(t.Strings)),r.strs.push(a),yn(t.wbrels,-1,"sharedStrings."+e,un.SST)),a="xl/workbook."+e,Ye(s,a,Fet(n)),r.workbooks.push(a),yn(t.rels,1,a,un.WB),a="xl/theme/theme1.xml";var S=TI(n.Themes,t);return Ye(s,a,S),r.themes.push(a),yn(t.wbrels,-1,"theme/theme1.xml",un.THEME),a="xl/styles."+e,Ye(s,a,zZ(n,t)),r.styles.push(a),yn(t.wbrels,-1,"styles."+e,un.STY),n.vbaraw&&i&&(a="xl/vbaProject.bin",Ye(s,a,n.vbaraw),r.vba.push(a),yn(t.wbrels,-1,"vbaProject.bin",un.VBA)),a="xl/metadata."+e,Ye(s,a,qZ()),r.metadata.push(a),yn(t.wbrels,-1,"metadata."+e,un.XLMETA),d.length>1&&(a="xl/persons/person.xml",Ye(s,a,OI(d)),r.people.push(a),yn(t.wbrels,-1,"persons/person.xml",un.PEOPLE)),Ye(s,"[Content_Types].xml",lI(r,t)),Ye(s,"_rels/.rels",nd(t.rels)),Ye(s,"xl/_rels/workbook."+e+".rels",nd(t.wbrels)),delete t.revssf,delete t.ssf,s}function Mnt(n,t){n&&!n.SSF&&(n.SSF=Ar(Gn)),n&&n.SSF&&(gx(),mx(n.SSF),t.revssf=vx(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Vp?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",i=sQ.indexOf(t.bookType)>-1,r=oI();vA(t=t||{});var s=iA(),a="",l=0;if(t.cellXfs=[],Dc(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",Ye(s,a,fI(n.Props,t)),r.coreprops.push(a),yn(t.rels,2,a,un.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var u=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(n.SheetNames[f]);n.Props.SheetNames=u}n.Props.Worksheets=n.Props.SheetNames.length,Ye(s,a,hI(n.Props)),r.extprops.push(a),yn(t.rels,3,a,un.EXT_PROPS),n.Custprops!==n.Props&&Ti(n.Custprops||{}).length>0&&(a="docProps/custom.xml",Ye(s,a,pI(n.Custprops)),r.custprops.push(a),yn(t.rels,4,a,un.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=n.SheetNames.length;++l){var p={"!id":{}},m=n.Sheets[n.SheetNames[l-1]],g=(m||{})["!type"]||"sheet";switch(g){case"chart":default:a="xl/worksheets/sheet"+l+"."+e,Ye(s,a,ttt(l-1,t,n,p)),r.sheets.push(a),yn(t.wbrels,-1,"worksheets/sheet"+l+"."+e,un.WS[0])}if(m){var y=m["!comments"],x=!1,_="";if(y&&y.length>0){var b=!1;y.forEach(function(S){S[1].forEach(function(A){A.T==!0&&(b=!0)})}),b&&(_="xl/threadedComments/threadedComment"+l+".xml",Ye(s,_,DI(y,d,t)),r.threadedcomments.push(_),yn(p,-1,"../threadedComments/threadedComment"+l+".xml",un.TCMNT)),_="xl/comments"+l+"."+e,Ye(s,_,JZ(y)),r.comments.push(_),yn(p,-1,"../comments"+l+"."+e,un.CMNT),x=!0}m["!legacy"]&&x&&Ye(s,"xl/drawings/vmlDrawing"+l+".vml",CI(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&Ye(s,cI(a),nd(p))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,Ye(s,a,cZ(t.Strings,t)),r.strs.push(a),yn(t.wbrels,-1,"sharedStrings."+e,un.SST)),a="xl/workbook."+e,Ye(s,a,bet(n)),r.workbooks.push(a),yn(t.rels,1,a,un.WB),a="xl/theme/theme1.xml",Ye(s,a,TI(n.Themes,t)),r.themes.push(a),yn(t.wbrels,-1,"theme/theme1.xml",un.THEME),a="xl/styles."+e,Ye(s,a,_Z(n,t)),r.styles.push(a),yn(t.wbrels,-1,"styles."+e,un.STY),n.vbaraw&&i&&(a="xl/vbaProject.bin",Ye(s,a,n.vbaraw),r.vba.push(a),yn(t.wbrels,-1,"vbaProject.bin",un.VBA)),a="xl/metadata."+e,Ye(s,a,KZ()),r.metadata.push(a),yn(t.wbrels,-1,"metadata."+e,un.XLMETA),d.length>1&&(a="xl/persons/person.xml",Ye(s,a,OI(d)),r.people.push(a),yn(t.wbrels,-1,"persons/person.xml",un.PEOPLE)),Ye(s,"[Content_Types].xml",lI(r,t)),Ye(s,"_rels/.rels",nd(t.rels)),Ye(s,"xl/_rels/workbook."+e+".rels",nd(t.wbrels)),delete t.revssf,delete t.ssf,s}function Fnt(n,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":e=wc(n.slice(0,12));break;case"binary":e=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function KI(n,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return z0(t.file,Un.write(n,{type:_n?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Un.write(n,t)}function Pnt(n,t){switch(t.bookType){case"ods":return XI(n,t);case"numbers":return Dnt(n,t);case"xlsb":return knt(n,t);default:return Mnt(n,t)}}function Bnt(n,t){var e=Ar(t||{}),i=Pnt(n,e);return jnt(i,e)}function jnt(n,t){var e={},i=_n?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=i;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var r=n.FullPaths?Un.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):n.generate(e);if(typeof Deno<"u"&&typeof r=="string"){if(t.type=="binary"||t.type=="base64")return r;r=new Uint8Array(px(r))}return t.password&&typeof encrypt_agile<"u"?KI(encrypt_agile(r,t.password),t):t.type==="file"?z0(t.file,r):t.type=="string"?ed(r):r}function Unt(n,t){var e=t||{},i=Ket(n,e);return KI(i,e)}function co(n,t,e){e||(e="");var i=e+n;switch(t.type){case"base64":return u1(f0(i));case"binary":return f0(i);case"string":return n;case"file":return z0(t.file,i,"utf8");case"buffer":return _n?bo(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):co(i,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function znt(n,t){switch(t.type){case"base64":return jY(n);case"binary":return n;case"string":return n;case"file":return z0(t.file,n,"binary");case"buffer":return _n?bo(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function sv(n,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",i=0;i<n.length;++i)e+=String.fromCharCode(n[i]);return t.type=="base64"?u1(e):t.type=="string"?ed(e):e;case"file":return z0(t.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+t.type)}}function ZI(n,t){BY(),_et(n);var e=Ar(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=ZI(n,e);return e.type="array",px(i)}var r=0;if(e.sheet&&(typeof e.sheet=="number"?r=e.sheet:r=n.SheetNames.indexOf(e.sheet),!n.SheetNames[r]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return co(Yet(n,e),e);case"slk":case"sylk":return co(sZ.from_sheet(n.Sheets[n.SheetNames[r]],e,n),e);case"htm":case"html":return co(GI(n.Sheets[n.SheetNames[r]],e),e);case"txt":return znt(QI(n.Sheets[n.SheetNames[r]],e),e);case"csv":return co(xA(n.Sheets[n.SheetNames[r]],e),e,"\uFEFF");case"dif":return co(aZ.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"dbf":return sv(rZ.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"prn":return co(oZ.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"rtf":return co(mZ(n.Sheets[n.SheetNames[r]]),e);case"eth":return co(bI.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"fods":return co(XI(n,e),e);case"wk1":return sv(U3.sheet_to_wk1(n.Sheets[n.SheetNames[r]],e),e);case"wk3":return sv(U3.book_to_wk3(n,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),sv($I(n,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),Unt(n,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Bnt(n,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function Hnt(n){if(!n.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(n.bookType=e.slice(1)),n.bookType=t[n.bookType]||n.bookType}}function $nt(n,t,e){var i=e||{};return i.type="file",i.file=t,Hnt(i),ZI(n,i)}function Gnt(n,t,e,i,r,s,a){var l=Fn(e),u=a.defval,f=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,p=n["!data"]!=null,m=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:e,enumerable:!1})}catch{m.__rowNum__=e}else m.__rowNum__=e;if(!p||n["!data"][e])for(var g=t.s.c;g<=t.e.c;++g){var y=p?(n["!data"][e]||[])[g]:n[i[g]+l];if(y==null||y.t===void 0){if(u===void 0)continue;s[g]!=null&&(m[s[g]]=u);continue}var x=y.v;switch(y.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"b":case"n":if(!y.z||!Ru(y.z)||(x=td(x),typeof x=="number"))break;case"d":a&&(a.UTC||a.raw===!1)||(x=bd(new Date(x)));break;default:throw new Error("unrecognized type "+y.t)}if(s[g]!=null){if(x==null)if(y.t=="e"&&x===null)m[s[g]]=null;else if(u!==void 0)m[s[g]]=u;else if(f&&x===null)m[s[g]]=null;else continue;else m[s[g]]=(y.t==="n"&&typeof a.rawNumbers=="boolean"?a.rawNumbers:f)?x:wl(y,x,a);x!=null&&(d=!1)}}return{row:m,isempty:d}}function uE(n,t){if(n==null||n["!ref"]==null)return[];var e={t:"n",v:0},i=0,r=1,s=[],a=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:n["!ref"];switch(f.header===1?i=1:f.header==="A"?i=2:Array.isArray(f.header)?i=3:f.header==null&&(i=0),typeof d){case"string":u=Vn(d);break;case"number":u=Vn(n["!ref"]),u.s.r=d;break;default:u=d}i>0&&(r=0);var p=Fn(u.s.r),m=[],g=[],y=0,x=0,_=n["!data"]!=null,b=u.s.r,S=0,A={};_&&!n["!data"][b]&&(n["!data"][b]=[]);var C=f.skipHidden&&n["!cols"]||[],O=f.skipHidden&&n["!rows"]||[];for(S=u.s.c;S<=u.e.c;++S)if(!(C[S]||{}).hidden)switch(m[S]=Dn(S),e=_?n["!data"][b][S]:n[m[S]+p],i){case 1:s[S]=S-u.s.c;break;case 2:s[S]=m[S];break;case 3:s[S]=f.header[S-u.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=a=wl(e,null,f),x=A[a]||0,!x)A[a]=1;else{do l=a+"_"+x++;while(A[l]);A[a]=x,A[l]=1}s[S]=l}for(b=u.s.r+r;b<=u.e.r;++b)if(!(O[b]||{}).hidden){var N=Gnt(n,u,b,m,i,s,f);(N.isempty===!1||(i===1?f.blankrows!==!1:f.blankrows))&&(g[y++]=N.row)}return g.length=y,g}var J3=/"/g;function Vnt(n,t,e,i,r,s,a,l,u){for(var f=!0,d=[],p="",m=Fn(e),g=n["!data"]!=null,y=g&&n["!data"][e]||[],x=t.s.c;x<=t.e.c;++x)if(i[x]){var _=g?y[x]:n[i[x]+m];if(_==null)p="";else if(_.v!=null){f=!1,p=""+(u.rawNumbers&&_.t=="n"?_.v:wl(_,null,u));for(var b=0,S=0;b!==p.length;++b)if((S=p.charCodeAt(b))===r||S===s||S===34||u.forceQuotes){p='"'+p.replace(J3,'""')+'"';break}p=="ID"&&l==0&&d.length==0&&(p='"ID"')}else _.f!=null&&!_.F?(f=!1,p="="+_.f,p.indexOf(",")>=0&&(p='"'+p.replace(J3,'""')+'"')):p="";d.push(p)}if(u.strip)for(;d[d.length-1]==="";)--d.length;return u.blankrows===!1&&f?null:d.join(a)}function xA(n,t){var e=[],i=t??{};if(n==null||n["!ref"]==null)return"";for(var r=Vn(n["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),l=i.RS!==void 0?i.RS:`
`,u=l.charCodeAt(0),f="",d=[],p=i.skipHidden&&n["!cols"]||[],m=i.skipHidden&&n["!rows"]||[],g=r.s.c;g<=r.e.c;++g)(p[g]||{}).hidden||(d[g]=Dn(g));for(var y=0,x=r.s.r;x<=r.e.r;++x)(m[x]||{}).hidden||(f=Vnt(n,r,x,d,a,u,s,y,i),f!=null&&(f||i.blankrows!==!1)&&e.push((y++?l:"")+f));return e.join("")}function QI(n,t){t||(t={}),t.FS="	",t.RS=`
`;var e=xA(n,t);return e}function Wnt(n,t){var e="",i,r="";if(n==null||n["!ref"]==null)return[];var s=Vn(n["!ref"]),a="",l=[],u,f=[],d=n["!data"]!=null;for(u=s.s.c;u<=s.e.c;++u)l[u]=Dn(u);for(var p=s.s.r;p<=s.e.r;++p)for(a=Fn(p),u=s.s.c;u<=s.e.c;++u)if(e=l[u]+a,i=d?(n["!data"][p]||[])[u]:n[e],r="",i!==void 0){if(i.F!=null){if(e=i.F,!i.f)continue;r=i.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(i.f!=null)r=i.f;else{if(t&&t.values===!1)continue;if(i.t=="z")continue;if(i.t=="n"&&i.v!=null)r=""+i.v;else if(i.t=="b")r=i.v?"TRUE":"FALSE";else if(i.w!==void 0)r="'"+i.w;else{if(i.v===void 0)continue;i.t=="s"?r="'"+i.v:r=""+i.v}}f[f.length]=e+"="+r}return f}function JI(n,t,e){var i=e||{},r=n?n["!data"]!=null:i.dense,s=+!i.skipHeader,a=n||{};!n&&r&&(a["!data"]=[]);var l=0,u=0;if(a&&i.origin!=null)if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?Kn(i.origin):i.origin;l=f.r,u=f.c}var d={s:{c:0,r:0},e:{c:u,r:l+t.length-1+s}};if(a["!ref"]){var p=Vn(a["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),l==-1&&(l=p.e.r+1,d.e.r=l+t.length-1+s)}else l==-1&&(l=0,d.e.r=t.length-1+s);var m=i.header||[],g=0,y=[];t.forEach(function(_,b){r&&!a["!data"][l+b+s]&&(a["!data"][l+b+s]=[]),r&&(y=a["!data"][l+b+s]),Ti(_).forEach(function(S){(g=m.indexOf(S))==-1&&(m[g=m.length]=S);var A=_[S],C="z",O="",N=r?"":Dn(u+g)+Fn(l+b+s),D=r?y[u+g]:a[N];A&&typeof A=="object"&&!(A instanceof Date)?r?y[u+g]=A:a[N]=A:(typeof A=="number"?C="n":typeof A=="boolean"?C="b":typeof A=="string"?C="s":A instanceof Date?(C="d",i.UTC||(A=xx(A)),i.cellDates||(C="n",A=sr(A)),O=D!=null&&D.z&&Ru(D.z)?D.z:i.dateNF||Gn[14]):A===null&&i.nullError&&(C="e",A=0),D?(D.t=C,D.v=A,delete D.w,delete D.R,O&&(D.z=O)):r?y[u+g]=D={t:C,v:A}:a[N]=D={t:C,v:A},O&&(D.z=O))})}),d.e.c=Math.max(d.e.c,u+m.length-1);var x=Fn(l);if(r&&!a["!data"][l]&&(a["!data"][l]=[]),s)for(g=0;g<m.length;++g)r?a["!data"][l][g+u]={t:"s",v:m[g]}:a[Dn(g+u)+x]={t:"s",v:m[g]};return a["!ref"]=Ci(d),a}function Xnt(n,t){return JI(null,n,t)}function C1(n,t,e){if(typeof t=="string"){if(n["!data"]!=null){var i=Kn(t);return n["!data"][i.r]||(n["!data"][i.r]=[]),n["!data"][i.r][i.c]||(n["!data"][i.r][i.c]={t:"z"})}return n[t]||(n[t]={t:"z"})}return typeof t!="number"?C1(n,ri(t)):C1(n,Dn(e||0)+Fn(t))}function Ynt(n,t){if(typeof t=="number"){if(t>=0&&n.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=n.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function qnt(n,t){var e={SheetNames:[],Sheets:{}};return n&&yA(e,n,t||"Sheet1"),e}function yA(n,t,e,i){var r=1;if(!e)for(;r<=65535&&n.SheetNames.indexOf(e="Sheet"+r)!=-1;++r,e=void 0);if(!e||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&n.SheetNames.indexOf(e)>=0&&e.length<32){var s=e.match(/\d+$/);r=s&&+s[0]||0;var a=s&&e.slice(0,s.index)||e;for(++r;r<=65535&&n.SheetNames.indexOf(e=a+r)!=-1;++r);}if(UI(e),n.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return n.SheetNames.push(e),n.Sheets[e]=t,e}function Knt(n,t,e){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var i=Ynt(n,t);switch(n.Workbook.Sheets[i]||(n.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}n.Workbook.Sheets[i].Hidden=e}function Znt(n,t){return n.z=t,n}function tk(n,t,e){return t?(n.l={Target:t},e&&(n.l.Tooltip=e)):delete n.l,n}function Qnt(n,t,e){return tk(n,"#"+t,e)}function Jnt(n,t,e){n.c||(n.c=[]),n.c.push({t,a:e||"SheetJS"})}function tit(n,t,e,i){for(var r=typeof t!="string"?t:Vn(t),s=typeof t=="string"?t:Ci(t),a=r.s.r;a<=r.e.r;++a)for(var l=r.s.c;l<=r.e.c;++l){var u=C1(n,a,l);u.t="n",u.F=s,delete u.v,a==r.s.r&&l==r.s.c&&(u.f=e,i&&(u.D=!0))}var f=rr(n["!ref"]);return f.s.r>r.s.r&&(f.s.r=r.s.r),f.s.c>r.s.c&&(f.s.c=r.s.c),f.e.r<r.e.r&&(f.e.r=r.e.r),f.e.c<r.e.c&&(f.e.c=r.e.c),n["!ref"]=Ci(f),n}var Pb={encode_col:Dn,encode_row:Fn,encode_cell:ri,encode_range:Ci,decode_col:cA,decode_row:lA,split_cell:Xq,decode_cell:Kn,decode_range:rr,format_cell:wl,sheet_new:Yq,sheet_add_aoa:nI,sheet_add_json:JI,sheet_add_dom:VI,aoa_to_sheet:Md,json_to_sheet:Xnt,table_to_sheet:WI,table_to_book:ynt,sheet_to_csv:xA,sheet_to_txt:QI,sheet_to_json:uE,sheet_to_html:GI,sheet_to_formulae:Wnt,sheet_to_row_object_array:uE,sheet_get_cell:C1,book_new:qnt,book_append_sheet:yA,book_set_sheet_visibility:Knt,cell_set_number_format:Znt,cell_set_hyperlink:tk,cell_set_internal_link:Qnt,cell_add_comment:Jnt,sheet_set_array_formula:tit,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const eit=(n,t)=>{const e=Od(t),i=[];return n.forEach(r=>{const s=us(r,e,"date"),a=us(r,e,"campaign");i.push({"HOLE ID":us(r,e,"hole_id"),X:ks(us(r,e,"x")),Y:ks(us(r,e,"y")),Z:ks(us(r,e,"z")),DEPTH:sx(r,e),...s&&{DATA:s},...a&&{CAMPANHA:a}})}),i},nit=(n,t)=>{const e=Od(t),i=[];return n.forEach(r=>{const s=us(r,e,"hole_id"),a=ul(r,e,"nspt"),l=sx(r,e),u=Math.ceil(l)-a.length+1;let f=0;a.forEach((d,p)=>{const m=p===0?u:p===a.length-1?l:f+1;i.push({"HOLE ID":s,from:f,to:m,NSPT:d}),f=m})}),i},iit=(n,t)=>{const e=Od(t),i=[];return n.forEach(r=>{const s=us(r,e,"hole_id"),a=sx(r,e),l=us(r,e,"water_level"),u=ks(l,-1);typeof u=="number"&&u>=0?u!==0?i.push({"HOLE ID":s,from:0,to:u,cond:"SECO"},{"HOLE ID":s,from:u,to:a,cond:"ÁGUA"}):i.push({"HOLE ID":s,from:0,to:a,cond:"ÁGUA"}):i.push({"HOLE ID":s,from:0,to:a,cond:"SECO"})}),i},rit=(n,t)=>{const e=Od(t),i=[];return n.forEach(r=>{const s=us(r,e,"hole_id"),l=ul(r,e,"depth_from_to").map(d=>ks(d)).sort((d,p)=>d-p);l.includes(0)||l.unshift(0);const f=ul(r,e,"geology").filter(d=>!d.toUpperCase().startsWith("LIMITE DE SONDAGEM"));if(f.length>0){const d=f.length-1,p=f[d],m=p.toUpperCase().indexOf("LIMITE DE SONDAGEM");m!==-1&&(f[d]=p.substring(0,m).trim())}for(let d=0;d<l.length-1;d++)i.push({"HOLE ID":s,from:l[d],to:l[d+1],Descrição:f[d]||""})}),i},sit=(n,t)=>{const e=Od(t),i=[];return n.forEach(r=>{const s=us(r,e,"hole_id"),l=ul(r,e,"depth_from_to").map(d=>ks(d)).sort((d,p)=>d-p);l.includes(0)||l.unshift(0);const u=ul(r,e,"interp"),f=[];for(let d=0;d<l.length-1;d++)f.push({"HOLE ID":s,from:l[d],to:l[d+1],"interp. geol":u[d]||""});i.push(...f)}),i},ek=(n,t)=>[t.join(";"),...n.map(i=>t.map(r=>`"${i[r]??""}"`).join(";"))].join(`
`),nk=(n,t,e)=>{switch(e){case"collar":const i=["HOLE ID","X","Y","Z","DEPTH"];return t.find(r=>r.dataType==="date")&&i.push("DATA"),t.find(r=>r.dataType==="campaign")&&i.push("CAMPANHA"),{data:eit(n,t),headers:i,filename:"collar.csv"};case"nspt":return{data:nit(n,t),headers:["HOLE ID","from","to","NSPT"],filename:"nspt.csv"};case"na":return{data:iit(n,t),headers:["HOLE ID","from","to","cond"],filename:"na.csv"};case"geology":return{data:rit(n,t),headers:["HOLE ID","from","to","Descrição"],filename:"geology.csv"};case"interp":return{data:sit(n,t),headers:["HOLE ID","from","to","interp. geol"],filename:"interp.csv"};default:return}},Sx=(n,t)=>{const e=Bz[t];if(!e)return{isValid:!1,missingFields:[],errorMessage:`Tipo de exportação '${t}' não reconhecido`};const i=[],r=n.filter(s=>s.dataType&&s.coordinates).map(s=>s.dataType);if(e.forEach(s=>{r.includes(s)||i.push(s)}),t==="nspt"||t==="collar"||t==="na"){const s=r.includes("depth"),a=r.includes("depth_from_to");!s&&!a&&i.unshift("depth")}return{isValid:i.length===0,missingFields:i,errorMessage:i.length>0?`Campos obrigatórios ausentes: ${i.join(", ")}`:void 0}};var Bb={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var tO;function ait(){return tO||(tO=1,function(n,t){(function(e){n.exports=e()})(function(){return function e(i,r,s){function a(f,d){if(!r[f]){if(!i[f]){var p=typeof Rp=="function"&&Rp;if(!d&&p)return p(f,!0);if(l)return l(f,!0);var m=new Error("Cannot find module '"+f+"'");throw m.code="MODULE_NOT_FOUND",m}var g=r[f]={exports:{}};i[f][0].call(g.exports,function(y){var x=i[f][1][y];return a(x||y)},g,g.exports,e,i,r,s)}return r[f].exports}for(var l=typeof Rp=="function"&&Rp,u=0;u<s.length;u++)a(s[u]);return a}({1:[function(e,i,r){var s=e("./utils"),a=e("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(u){for(var f,d,p,m,g,y,x,_=[],b=0,S=u.length,A=S,C=s.getTypeOf(u)!=="string";b<u.length;)A=S-b,p=C?(f=u[b++],d=b<S?u[b++]:0,b<S?u[b++]:0):(f=u.charCodeAt(b++),d=b<S?u.charCodeAt(b++):0,b<S?u.charCodeAt(b++):0),m=f>>2,g=(3&f)<<4|d>>4,y=1<A?(15&d)<<2|p>>6:64,x=2<A?63&p:64,_.push(l.charAt(m)+l.charAt(g)+l.charAt(y)+l.charAt(x));return _.join("")},r.decode=function(u){var f,d,p,m,g,y,x=0,_=0,b="data:";if(u.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var S,A=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===l.charAt(64)&&A--,u.charAt(u.length-2)===l.charAt(64)&&A--,A%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=a.uint8array?new Uint8Array(0|A):new Array(0|A);x<u.length;)f=l.indexOf(u.charAt(x++))<<2|(m=l.indexOf(u.charAt(x++)))>>4,d=(15&m)<<4|(g=l.indexOf(u.charAt(x++)))>>2,p=(3&g)<<6|(y=l.indexOf(u.charAt(x++))),S[_++]=f,g!==64&&(S[_++]=d),y!==64&&(S[_++]=p);return S}},{"./support":30,"./utils":32}],2:[function(e,i,r){var s=e("./external"),a=e("./stream/DataWorker"),l=e("./stream/Crc32Probe"),u=e("./stream/DataLengthProbe");function f(d,p,m,g,y){this.compressedSize=d,this.uncompressedSize=p,this.crc32=m,this.compression=g,this.compressedContent=y}f.prototype={getContentWorker:function(){var d=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(d,p,m){return d.pipe(new l).pipe(new u("uncompressedSize")).pipe(p.compressWorker(m)).pipe(new u("compressedSize")).withStreamInfo("compression",p)},i.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,i,r){var s=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,i,r){var s=e("./utils"),a=function(){for(var l,u=[],f=0;f<256;f++){l=f;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;u[f]=l}return u}();i.exports=function(l,u){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(f,d,p,m){var g=a,y=m+p;f^=-1;for(var x=m;x<y;x++)f=f>>>8^g[255&(f^d[x])];return-1^f}(0|u,l,l.length,0):function(f,d,p,m){var g=a,y=m+p;f^=-1;for(var x=m;x<y;x++)f=f>>>8^g[255&(f^d.charCodeAt(x))];return-1^f}(0|u,l,l.length,0):0}},{"./utils":32}],5:[function(e,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,i,r){var s=null;s=typeof Promise<"u"?Promise:e("lie"),i.exports={Promise:s}},{lie:37}],7:[function(e,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),l=e("./utils"),u=e("./stream/GenericWorker"),f=s?"uint8array":"array";function d(p,m){u.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=m,this.meta={}}r.magic="\b\0",l.inherits(d,u),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(f,p.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(m){p.push({data:m,meta:p.meta})}},r.compressWorker=function(p){return new d("Deflate",p)},r.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,i,r){function s(g,y){var x,_="";for(x=0;x<y;x++)_+=String.fromCharCode(255&g),g>>>=8;return _}function a(g,y,x,_,b,S){var A,C,O=g.file,N=g.compression,D=S!==f.utf8encode,L=l.transformTo("string",S(O.name)),I=l.transformTo("string",f.utf8encode(O.name)),z=O.comment,j=l.transformTo("string",S(z)),B=l.transformTo("string",f.utf8encode(z)),tt=I.length!==O.name.length,k=B.length!==z.length,et="",K="",q="",_t=O.dir,at=O.date,P={crc32:0,compressedSize:0,uncompressedSize:0};y&&!x||(P.crc32=g.crc32,P.compressedSize=g.compressedSize,P.uncompressedSize=g.uncompressedSize);var X=0;y&&(X|=8),D||!tt&&!k||(X|=2048);var V=0,it=0;_t&&(V|=16),b==="UNIX"?(it=798,V|=function(yt,Rt){var Et=yt;return yt||(Et=Rt?16893:33204),(65535&Et)<<16}(O.unixPermissions,_t)):(it=20,V|=function(yt){return 63&(yt||0)}(O.dosPermissions)),A=at.getUTCHours(),A<<=6,A|=at.getUTCMinutes(),A<<=5,A|=at.getUTCSeconds()/2,C=at.getUTCFullYear()-1980,C<<=4,C|=at.getUTCMonth()+1,C<<=5,C|=at.getUTCDate(),tt&&(K=s(1,1)+s(d(L),4)+I,et+="up"+s(K.length,2)+K),k&&(q=s(1,1)+s(d(j),4)+B,et+="uc"+s(q.length,2)+q);var ht="";return ht+=`
\0`,ht+=s(X,2),ht+=N.magic,ht+=s(A,2),ht+=s(C,2),ht+=s(P.crc32,4),ht+=s(P.compressedSize,4),ht+=s(P.uncompressedSize,4),ht+=s(L.length,2),ht+=s(et.length,2),{fileRecord:p.LOCAL_FILE_HEADER+ht+L+et,dirRecord:p.CENTRAL_FILE_HEADER+s(it,2)+ht+s(j.length,2)+"\0\0\0\0"+s(V,4)+s(_,4)+L+et+j}}var l=e("../utils"),u=e("../stream/GenericWorker"),f=e("../utf8"),d=e("../crc32"),p=e("../signature");function m(g,y,x,_){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=x,this.encodeFileName=_,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(m,u),m.prototype.push=function(g){var y=g.meta.percent||0,x=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,u.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:x?(y+100*(x-_-1))/x:100}}))},m.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var y=this.streamFiles&&!g.file.dir;if(y){var x=a(g,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:x.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(g){this.accumulate=!1;var y=this.streamFiles&&!g.file.dir,x=a(g,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(x.dirRecord),y)this.push({data:function(_){return p.DATA_DESCRIPTOR+s(_.crc32,4)+s(_.compressedSize,4)+s(_.uncompressedSize,4)}(g),meta:{percent:100}});else for(this.push({data:x.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var g=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var x=this.bytesWritten-g,_=function(b,S,A,C,O){var N=l.transformTo("string",O(C));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(b,2)+s(b,2)+s(S,4)+s(A,4)+s(N.length,2)+N}(this.dirRecords.length,x,g,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(g){this._sources.push(g);var y=this;return g.on("data",function(x){y.processChunk(x)}),g.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),g.on("error",function(x){y.error(x)}),this},m.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(g){var y=this._sources;if(!u.prototype.error.call(this,g))return!1;for(var x=0;x<y.length;x++)try{y[x].error(g)}catch{}return!0},m.prototype.lock=function(){u.prototype.lock.call(this);for(var g=this._sources,y=0;y<g.length;y++)g[y].lock()},i.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,i,r){var s=e("../compressions"),a=e("./ZipFileWorker");r.generateWorker=function(l,u,f){var d=new a(u.streamFiles,f,u.platform,u.encodeFileName),p=0;try{l.forEach(function(m,g){p++;var y=function(S,A){var C=S||A,O=s[C];if(!O)throw new Error(C+" is not a valid compression method !");return O}(g.options.compression,u.compression),x=g.options.compressionOptions||u.compressionOptions||{},_=g.dir,b=g.date;g._compressWorker(y,x).withStreamInfo("file",{name:m,dir:_,date:b,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(d)}),d.entriesCount=p}catch(m){d.error(m)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,i,r){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var l in this)typeof this[l]!="function"&&(a[l]=this[l]);return a}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(a,l){return new s().loadAsync(a,l)},s.external=e("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,i,r){var s=e("./utils"),a=e("./external"),l=e("./utf8"),u=e("./zipEntries"),f=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function p(m){return new a.Promise(function(g,y){var x=m.decompressed.getContentWorker().pipe(new f);x.on("error",function(_){y(_)}).on("end",function(){x.streamInfo.crc32!==m.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}i.exports=function(m,g){var y=this;return g=s.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(m)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",m,!0,g.optimizedBinaryString,g.base64).then(function(x){var _=new u(g);return _.load(x),_}).then(function(x){var _=[a.Promise.resolve(x)],b=x.files;if(g.checkCRC32)for(var S=0;S<b.length;S++)_.push(p(b[S]));return a.Promise.all(_)}).then(function(x){for(var _=x.shift(),b=_.files,S=0;S<b.length;S++){var A=b[S],C=A.fileNameStr,O=s.resolve(A.fileNameStr);y.file(O,A.decompressed,{binary:!0,optimizedBinaryString:!0,date:A.date,dir:A.dir,comment:A.fileCommentStr.length?A.fileCommentStr:null,unixPermissions:A.unixPermissions,dosPermissions:A.dosPermissions,createFolders:g.createFolders}),A.dir||(y.file(O).unsafeOriginalName=C)}return _.zipComment.length&&(y.comment=_.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,i,r){var s=e("../utils"),a=e("../stream/GenericWorker");function l(u,f){a.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}s.inherits(l,a),l.prototype._bindStream=function(u){var f=this;(this._stream=u).pause(),u.on("data",function(d){f.push({data:d,meta:{percent:0}})}).on("error",function(d){f.isPaused?this.generatedError=d:f.error(d)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},l.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,i,r){var s=e("readable-stream").Readable;function a(l,u,f){s.call(this,u),this._helper=l;var d=this;l.on("data",function(p,m){d.push(p)||d._helper.pause(),f&&f(m)}).on("error",function(p){d.emit("error",p)}).on("end",function(){d.push(null)})}e("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},i.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,i,r){function s(O,N,D){var L,I=l.getTypeOf(N),z=l.extend(D||{},d);z.date=z.date||new Date,z.compression!==null&&(z.compression=z.compression.toUpperCase()),typeof z.unixPermissions=="string"&&(z.unixPermissions=parseInt(z.unixPermissions,8)),z.unixPermissions&&16384&z.unixPermissions&&(z.dir=!0),z.dosPermissions&&16&z.dosPermissions&&(z.dir=!0),z.dir&&(O=b(O)),z.createFolders&&(L=_(O))&&S.call(this,L,!0);var j=I==="string"&&z.binary===!1&&z.base64===!1;D&&D.binary!==void 0||(z.binary=!j),(N instanceof p&&N.uncompressedSize===0||z.dir||!N||N.length===0)&&(z.base64=!1,z.binary=!0,N="",z.compression="STORE",I="string");var B=null;B=N instanceof p||N instanceof u?N:y.isNode&&y.isStream(N)?new x(O,N):l.prepareContent(O,N,z.binary,z.optimizedBinaryString,z.base64);var tt=new m(O,B,z);this.files[O]=tt}var a=e("./utf8"),l=e("./utils"),u=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),d=e("./defaults"),p=e("./compressedObject"),m=e("./zipObject"),g=e("./generate"),y=e("./nodejsUtils"),x=e("./nodejs/NodejsStreamInputAdapter"),_=function(O){O.slice(-1)==="/"&&(O=O.substring(0,O.length-1));var N=O.lastIndexOf("/");return 0<N?O.substring(0,N):""},b=function(O){return O.slice(-1)!=="/"&&(O+="/"),O},S=function(O,N){return N=N!==void 0?N:d.createFolders,O=b(O),this.files[O]||s.call(this,O,null,{dir:!0,createFolders:N}),this.files[O]};function A(O){return Object.prototype.toString.call(O)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(O){var N,D,L;for(N in this.files)L=this.files[N],(D=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&O(D,L)},filter:function(O){var N=[];return this.forEach(function(D,L){O(D,L)&&N.push(L)}),N},file:function(O,N,D){if(arguments.length!==1)return O=this.root+O,s.call(this,O,N,D),this;if(A(O)){var L=O;return this.filter(function(z,j){return!j.dir&&L.test(z)})}var I=this.files[this.root+O];return I&&!I.dir?I:null},folder:function(O){if(!O)return this;if(A(O))return this.filter(function(I,z){return z.dir&&O.test(I)});var N=this.root+O,D=S.call(this,N),L=this.clone();return L.root=D.name,L},remove:function(O){O=this.root+O;var N=this.files[O];if(N||(O.slice(-1)!=="/"&&(O+="/"),N=this.files[O]),N&&!N.dir)delete this.files[O];else for(var D=this.filter(function(I,z){return z.name.slice(0,O.length)===O}),L=0;L<D.length;L++)delete this.files[D[L].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(O){var N,D={};try{if((D=l.extend(O||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");l.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var L=D.comment||this.comment||"";N=g.generateWorker(this,D,L)}catch(I){(N=new u("error")).error(I)}return new f(N,D.type||"string",D.mimeType)},generateAsync:function(O,N){return this.generateInternalStream(O).accumulate(N)},generateNodeStream:function(O,N){return(O=O||{}).type||(O.type="nodebuffer"),this.generateInternalStream(O).toNodejsStream(N)}};i.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,i,r){i.exports=e("stream")},{stream:void 0}],17:[function(e,i,r){var s=e("./DataReader");function a(l){s.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=255&l[u]}e("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===u&&this.data[m+1]===f&&this.data[m+2]===d&&this.data[m+3]===p)return m-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),m=this.readData(4);return u===m[0]&&f===m[1]&&d===m[2]&&p===m[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,i,r){var s=e("../utils");function a(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var u,f=0;for(this.checkOffset(l),u=this.index+l-1;u>=this.index;u--)f=(f<<8)+this.byteAt(u);return this.index+=l,f},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},i.exports=a},{"../utils":32}],19:[function(e,i,r){var s=e("./Uint8ArrayReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,i,r){var s=e("./DataReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,i,r){var s=e("./ArrayReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,i,r){var s=e("../utils"),a=e("../support"),l=e("./ArrayReader"),u=e("./StringReader"),f=e("./NodeBufferReader"),d=e("./Uint8ArrayReader");i.exports=function(p){var m=s.getTypeOf(p);return s.checkSupport(m),m!=="string"||a.uint8array?m==="nodebuffer"?new f(p):a.uint8array?new d(s.transformTo("uint8array",p)):new l(s.transformTo("array",p)):new u(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,i,r){var s=e("./GenericWorker"),a=e("../utils");function l(u){s.call(this,"ConvertWorker to "+u),this.destType=u}a.inherits(l,s),l.prototype.processChunk=function(u){this.push({data:a.transformTo(this.destType,u.data),meta:u.meta})},i.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,i,r){var s=e("./GenericWorker"),a=e("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,s),l.prototype.processChunk=function(u){this.streamInfo.crc32=a(u.data,this.streamInfo.crc32||0),this.push(u)},i.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,i,r){var s=e("../utils"),a=e("./GenericWorker");function l(u){a.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}s.inherits(l,a),l.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}a.prototype.processChunk.call(this,u)},i.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,i,r){var s=e("../utils"),a=e("./GenericWorker");function l(u){a.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){f.dataIsReady=!0,f.data=d,f.max=d&&d.length||0,f.type=s.getTypeOf(d),f.isPaused||f._tickAndRepeat()},function(d){f.error(d)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,f);break;case"uint8array":u=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":u=this.data.slice(this.index,f)}return this.index=f,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,i,r){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,l){return this._listeners[a].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,l){if(this._listeners[a])for(var u=0;u<this._listeners[a].length;u++)this._listeners[a][u].call(this,l)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var l=this;return a.on("data",function(u){l.processChunk(u)}),a.on("end",function(){l.end()}),a.on("error",function(u){l.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,l){return this.extraStreamInfo[a]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=s},{}],29:[function(e,i,r){var s=e("../utils"),a=e("./ConvertWorker"),l=e("./GenericWorker"),u=e("../base64"),f=e("../support"),d=e("../external"),p=null;if(f.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(y,x){return new d.Promise(function(_,b){var S=[],A=y._internalType,C=y._outputType,O=y._mimeType;y.on("data",function(N,D){S.push(N),x&&x(D)}).on("error",function(N){S=[],b(N)}).on("end",function(){try{var N=function(D,L,I){switch(D){case"blob":return s.newBlob(s.transformTo("arraybuffer",L),I);case"base64":return u.encode(L);default:return s.transformTo(D,L)}}(C,function(D,L){var I,z=0,j=null,B=0;for(I=0;I<L.length;I++)B+=L[I].length;switch(D){case"string":return L.join("");case"array":return Array.prototype.concat.apply([],L);case"uint8array":for(j=new Uint8Array(B),I=0;I<L.length;I++)j.set(L[I],z),z+=L[I].length;return j;case"nodebuffer":return Buffer.concat(L);default:throw new Error("concat : unsupported type '"+D+"'")}}(A,S),O);_(N)}catch(D){b(D)}S=[]}).resume()})}function g(y,x,_){var b=x;switch(x){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=x,this._mimeType=_,s.checkSupport(b),this._worker=y.pipe(new a(b)),y.lock()}catch(S){this._worker=new l("error"),this._worker.error(S)}}g.prototype={accumulate:function(y){return m(this,y)},on:function(y,x){var _=this;return y==="data"?this._worker.on(y,function(b){x.call(_,b.data,b.meta)}):this._worker.on(y,function(){s.delay(x,arguments,_)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},y)}},i.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var s=new ArrayBuffer(0);try{r.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),r.blob=a.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(e,i,r){for(var s=e("./utils"),a=e("./support"),l=e("./nodejsUtils"),u=e("./stream/GenericWorker"),f=new Array(256),d=0;d<256;d++)f[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;f[254]=f[254]=1;function p(){u.call(this,"utf-8 decode"),this.leftOver=null}function m(){u.call(this,"utf-8 encode")}r.utf8encode=function(g){return a.nodebuffer?l.newBufferFrom(g,"utf-8"):function(y){var x,_,b,S,A,C=y.length,O=0;for(S=0;S<C;S++)(64512&(_=y.charCodeAt(S)))==55296&&S+1<C&&(64512&(b=y.charCodeAt(S+1)))==56320&&(_=65536+(_-55296<<10)+(b-56320),S++),O+=_<128?1:_<2048?2:_<65536?3:4;for(x=a.uint8array?new Uint8Array(O):new Array(O),S=A=0;A<O;S++)(64512&(_=y.charCodeAt(S)))==55296&&S+1<C&&(64512&(b=y.charCodeAt(S+1)))==56320&&(_=65536+(_-55296<<10)+(b-56320),S++),_<128?x[A++]=_:(_<2048?x[A++]=192|_>>>6:(_<65536?x[A++]=224|_>>>12:(x[A++]=240|_>>>18,x[A++]=128|_>>>12&63),x[A++]=128|_>>>6&63),x[A++]=128|63&_);return x}(g)},r.utf8decode=function(g){return a.nodebuffer?s.transformTo("nodebuffer",g).toString("utf-8"):function(y){var x,_,b,S,A=y.length,C=new Array(2*A);for(x=_=0;x<A;)if((b=y[x++])<128)C[_++]=b;else if(4<(S=f[b]))C[_++]=65533,x+=S-1;else{for(b&=S===2?31:S===3?15:7;1<S&&x<A;)b=b<<6|63&y[x++],S--;1<S?C[_++]=65533:b<65536?C[_++]=b:(b-=65536,C[_++]=55296|b>>10&1023,C[_++]=56320|1023&b)}return C.length!==_&&(C.subarray?C=C.subarray(0,_):C.length=_),s.applyFromCharCode(C)}(g=s.transformTo(a.uint8array?"uint8array":"array",g))},s.inherits(p,u),p.prototype.processChunk=function(g){var y=s.transformTo(a.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var x=y;(y=new Uint8Array(x.length+this.leftOver.length)).set(this.leftOver,0),y.set(x,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var _=function(S,A){var C;for((A=A||S.length)>S.length&&(A=S.length),C=A-1;0<=C&&(192&S[C])==128;)C--;return C<0||C===0?A:C+f[S[C]]>A?C:A}(y),b=y;_!==y.length&&(a.uint8array?(b=y.subarray(0,_),this.leftOver=y.subarray(_,y.length)):(b=y.slice(0,_),this.leftOver=y.slice(_,y.length))),this.push({data:r.utf8decode(b),meta:g.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=p,s.inherits(m,u),m.prototype.processChunk=function(g){this.push({data:r.utf8encode(g.data),meta:g.meta})},r.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,i,r){var s=e("./support"),a=e("./base64"),l=e("./nodejsUtils"),u=e("./external");function f(x){return x}function d(x,_){for(var b=0;b<x.length;++b)_[b]=255&x.charCodeAt(b);return _}e("setimmediate"),r.newBlob=function(x,_){r.checkSupport("blob");try{return new Blob([x],{type:_})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(x),b.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(x,_,b){var S=[],A=0,C=x.length;if(C<=b)return String.fromCharCode.apply(null,x);for(;A<C;)_==="array"||_==="nodebuffer"?S.push(String.fromCharCode.apply(null,x.slice(A,Math.min(A+b,C)))):S.push(String.fromCharCode.apply(null,x.subarray(A,Math.min(A+b,C)))),A+=b;return S.join("")},stringifyByChar:function(x){for(var _="",b=0;b<x.length;b++)_+=String.fromCharCode(x[b]);return _},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function m(x){var _=65536,b=r.getTypeOf(x),S=!0;if(b==="uint8array"?S=p.applyCanBeUsed.uint8array:b==="nodebuffer"&&(S=p.applyCanBeUsed.nodebuffer),S)for(;1<_;)try{return p.stringifyByChunk(x,b,_)}catch{_=Math.floor(_/2)}return p.stringifyByChar(x)}function g(x,_){for(var b=0;b<x.length;b++)_[b]=x[b];return _}r.applyFromCharCode=m;var y={};y.string={string:f,array:function(x){return d(x,new Array(x.length))},arraybuffer:function(x){return y.string.uint8array(x).buffer},uint8array:function(x){return d(x,new Uint8Array(x.length))},nodebuffer:function(x){return d(x,l.allocBuffer(x.length))}},y.array={string:m,array:f,arraybuffer:function(x){return new Uint8Array(x).buffer},uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return l.newBufferFrom(x)}},y.arraybuffer={string:function(x){return m(new Uint8Array(x))},array:function(x){return g(new Uint8Array(x),new Array(x.byteLength))},arraybuffer:f,uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return l.newBufferFrom(new Uint8Array(x))}},y.uint8array={string:m,array:function(x){return g(x,new Array(x.length))},arraybuffer:function(x){return x.buffer},uint8array:f,nodebuffer:function(x){return l.newBufferFrom(x)}},y.nodebuffer={string:m,array:function(x){return g(x,new Array(x.length))},arraybuffer:function(x){return y.nodebuffer.uint8array(x).buffer},uint8array:function(x){return g(x,new Uint8Array(x.length))},nodebuffer:f},r.transformTo=function(x,_){if(_=_||"",!x)return _;r.checkSupport(x);var b=r.getTypeOf(_);return y[b][x](_)},r.resolve=function(x){for(var _=x.split("/"),b=[],S=0;S<_.length;S++){var A=_[S];A==="."||A===""&&S!==0&&S!==_.length-1||(A===".."?b.pop():b.push(A))}return b.join("/")},r.getTypeOf=function(x){return typeof x=="string"?"string":Object.prototype.toString.call(x)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(x)?"nodebuffer":s.uint8array&&x instanceof Uint8Array?"uint8array":s.arraybuffer&&x instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(x){if(!s[x.toLowerCase()])throw new Error(x+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(x){var _,b,S="";for(b=0;b<(x||"").length;b++)S+="\\x"+((_=x.charCodeAt(b))<16?"0":"")+_.toString(16).toUpperCase();return S},r.delay=function(x,_,b){setImmediate(function(){x.apply(b||null,_||[])})},r.inherits=function(x,_){function b(){}b.prototype=_.prototype,x.prototype=new b},r.extend=function(){var x,_,b={};for(x=0;x<arguments.length;x++)for(_ in arguments[x])Object.prototype.hasOwnProperty.call(arguments[x],_)&&b[_]===void 0&&(b[_]=arguments[x][_]);return b},r.prepareContent=function(x,_,b,S,A){return u.Promise.resolve(_).then(function(C){return s.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new u.Promise(function(O,N){var D=new FileReader;D.onload=function(L){O(L.target.result)},D.onerror=function(L){N(L.target.error)},D.readAsArrayBuffer(C)}):C}).then(function(C){var O=r.getTypeOf(C);return O?(O==="arraybuffer"?C=r.transformTo("uint8array",C):O==="string"&&(A?C=a.decode(C):b&&S!==!0&&(C=function(N){return d(N,s.uint8array?new Uint8Array(N.length):new Array(N.length))}(C))),C):u.Promise.reject(new Error("Can't read the data of '"+x+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,i,r){var s=e("./reader/readerFor"),a=e("./utils"),l=e("./signature"),u=e("./zipEntry"),f=e("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(m)+", expected "+a.pretty(p)+")")}},isSignature:function(p,m){var g=this.reader.index;this.reader.setIndex(p);var y=this.reader.readString(4)===m;return this.reader.setIndex(g),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),m=f.uint8array?"uint8array":"array",g=a.transformTo(m,p);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,m,g,y=this.zip64EndOfCentralSize-44;0<y;)p=this.reader.readInt(2),m=this.reader.readInt(4),g=this.reader.readData(m),this.zip64ExtensibleData[p]={id:p,length:m,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,m;for(p=0;p<this.files.length;p++)m=this.files[p],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var m=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var y=m-g;if(0<y)this.isSignature(m,l.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,i,r){var s=e("./reader/readerFor"),a=e("./utils"),l=e("./compressedObject"),u=e("./crc32"),f=e("./utf8"),d=e("./compressions"),p=e("./support");function m(g,y){this.options=g,this.loadOptions=y}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var y,x;if(g.skip(22),this.fileNameLength=g.readInt(2),x=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(x),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(_){for(var b in d)if(Object.prototype.hasOwnProperty.call(d,b)&&d[b].magic===_)return d[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,y,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var y=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(y),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var y,x,_,b=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<b;)y=g.readInt(2),x=g.readInt(2),_=g.readData(x),this.extraFields[y]={id:y,length:x,value:_};g.setIndex(b)},handleUTF8:function(){var g=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var x=a.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(x)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var b=a.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var y=s(g.value);return y.readInt(1)!==1||u(this.fileName)!==y.readInt(4)?null:f.utf8decode(y.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var y=s(g.value);return y.readInt(1)!==1||u(this.fileComment)!==y.readInt(4)?null:f.utf8decode(y.readData(g.length-5))}return null}},i.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,i,r){function s(y,x,_){this.name=y,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=x,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var a=e("./stream/StreamHelper"),l=e("./stream/DataWorker"),u=e("./utf8"),f=e("./compressedObject"),d=e("./stream/GenericWorker");s.prototype={internalStream:function(y){var x=null,_="string";try{if(!y)throw new Error("No output type specified.");var b=(_=y.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),x=this._decompressWorker();var S=!this._dataBinary;S&&!b&&(x=x.pipe(new u.Utf8EncodeWorker)),!S&&b&&(x=x.pipe(new u.Utf8DecodeWorker))}catch(A){(x=new d("error")).error(A)}return new a(x,_,"")},async:function(y,x){return this.internalStream(y).accumulate(x)},nodeStream:function(y,x){return this.internalStream(y||"nodebuffer").toNodejsStream(x)},_compressWorker:function(y,x){if(this._data instanceof f&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new u.Utf8EncodeWorker)),f.createWorkerFrom(_,y,x)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<p.length;g++)s.prototype[p[g]]=m;i.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,i,r){(function(s){var a,l,u=s.MutationObserver||s.WebKitMutationObserver;if(u){var f=0,d=new u(y),p=s.document.createTextNode("");d.observe(p,{characterData:!0}),a=function(){p.data=f=++f%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var x=s.document.createElement("script");x.onreadystatechange=function(){y(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},s.document.documentElement.appendChild(x)}:function(){setTimeout(y,0)};else{var m=new s.MessageChannel;m.port1.onmessage=y,a=function(){m.port2.postMessage(0)}}var g=[];function y(){var x,_;l=!0;for(var b=g.length;b;){for(_=g,g=[],x=-1;++x<b;)_[x]();b=g.length}l=!1}i.exports=function(x){g.push(x)!==1||l||a()}}).call(this,typeof Dg<"u"?Dg:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,i,r){var s=e("immediate");function a(){}var l={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];function p(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,b!==a&&x(this,b)}function m(b,S,A){this.promise=b,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof A=="function"&&(this.onRejected=A,this.callRejected=this.otherCallRejected)}function g(b,S,A){s(function(){var C;try{C=S(A)}catch(O){return l.reject(b,O)}C===b?l.reject(b,new TypeError("Cannot resolve promise with itself")):l.resolve(b,C)})}function y(b){var S=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof S=="function")return function(){S.apply(b,arguments)}}function x(b,S){var A=!1;function C(D){A||(A=!0,l.reject(b,D))}function O(D){A||(A=!0,l.resolve(b,D))}var N=_(function(){S(O,C)});N.status==="error"&&C(N.value)}function _(b,S){var A={};try{A.value=b(S),A.status="success"}catch(C){A.status="error",A.value=C}return A}(i.exports=p).prototype.finally=function(b){if(typeof b!="function")return this;var S=this.constructor;return this.then(function(A){return S.resolve(b()).then(function(){return A})},function(A){return S.resolve(b()).then(function(){throw A})})},p.prototype.catch=function(b){return this.then(null,b)},p.prototype.then=function(b,S){if(typeof b!="function"&&this.state===f||typeof S!="function"&&this.state===u)return this;var A=new this.constructor(a);return this.state!==d?g(A,this.state===f?b:S,this.outcome):this.queue.push(new m(A,b,S)),A},m.prototype.callFulfilled=function(b){l.resolve(this.promise,b)},m.prototype.otherCallFulfilled=function(b){g(this.promise,this.onFulfilled,b)},m.prototype.callRejected=function(b){l.reject(this.promise,b)},m.prototype.otherCallRejected=function(b){g(this.promise,this.onRejected,b)},l.resolve=function(b,S){var A=_(y,S);if(A.status==="error")return l.reject(b,A.value);var C=A.value;if(C)x(b,C);else{b.state=f,b.outcome=S;for(var O=-1,N=b.queue.length;++O<N;)b.queue[O].callFulfilled(S)}return b},l.reject=function(b,S){b.state=u,b.outcome=S;for(var A=-1,C=b.queue.length;++A<C;)b.queue[A].callRejected(S);return b},p.resolve=function(b){return b instanceof this?b:l.resolve(new this(a),b)},p.reject=function(b){var S=new this(a);return l.reject(S,b)},p.all=function(b){var S=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=b.length,C=!1;if(!A)return this.resolve([]);for(var O=new Array(A),N=0,D=-1,L=new this(a);++D<A;)I(b[D],D);return L;function I(z,j){S.resolve(z).then(function(B){O[j]=B,++N!==A||C||(C=!0,l.resolve(L,O))},function(B){C||(C=!0,l.reject(L,B))})}},p.race=function(b){var S=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var A=b.length,C=!1;if(!A)return this.resolve([]);for(var O=-1,N=new this(a);++O<A;)D=b[O],S.resolve(D).then(function(L){C||(C=!0,l.resolve(N,L))},function(L){C||(C=!0,l.reject(N,L))});var D;return N}},{immediate:36}],38:[function(e,i,r){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),i.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,i,r){var s=e("./zlib/deflate"),a=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/messages"),f=e("./zlib/zstream"),d=Object.prototype.toString,p=0,m=-1,g=0,y=8;function x(b){if(!(this instanceof x))return new x(b);this.options=a.assign({level:m,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},b||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var A=s.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(A!==p)throw new Error(u[A]);if(S.header&&s.deflateSetHeader(this.strm,S.header),S.dictionary){var C;if(C=typeof S.dictionary=="string"?l.string2buf(S.dictionary):d.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(A=s.deflateSetDictionary(this.strm,C))!==p)throw new Error(u[A]);this._dict_set=!0}}function _(b,S){var A=new x(S);if(A.push(b,!0),A.err)throw A.msg||u[A.err];return A.result}x.prototype.push=function(b,S){var A,C,O=this.strm,N=this.options.chunkSize;if(this.ended)return!1;C=S===~~S?S:S===!0?4:0,typeof b=="string"?O.input=l.string2buf(b):d.call(b)==="[object ArrayBuffer]"?O.input=new Uint8Array(b):O.input=b,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new a.Buf8(N),O.next_out=0,O.avail_out=N),(A=s.deflate(O,C))!==1&&A!==p)return this.onEnd(A),!(this.ended=!0);O.avail_out!==0&&(O.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(a.shrinkBuf(O.output,O.next_out))):this.onData(a.shrinkBuf(O.output,O.next_out)))}while((0<O.avail_in||O.avail_out===0)&&A!==1);return C===4?(A=s.deflateEnd(this.strm),this.onEnd(A),this.ended=!0,A===p):C!==2||(this.onEnd(p),!(O.avail_out=0))},x.prototype.onData=function(b){this.chunks.push(b)},x.prototype.onEnd=function(b){b===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},r.Deflate=x,r.deflate=_,r.deflateRaw=function(b,S){return(S=S||{}).raw=!0,_(b,S)},r.gzip=function(b,S){return(S=S||{}).gzip=!0,_(b,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,i,r){var s=e("./zlib/inflate"),a=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/constants"),f=e("./zlib/messages"),d=e("./zlib/zstream"),p=e("./zlib/gzheader"),m=Object.prototype.toString;function g(x){if(!(this instanceof g))return new g(x);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},x||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||x&&x.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&(15&_.windowBits)==0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var b=s.inflateInit2(this.strm,_.windowBits);if(b!==u.Z_OK)throw new Error(f[b]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function y(x,_){var b=new g(_);if(b.push(x,!0),b.err)throw b.msg||f[b.err];return b.result}g.prototype.push=function(x,_){var b,S,A,C,O,N,D=this.strm,L=this.options.chunkSize,I=this.options.dictionary,z=!1;if(this.ended)return!1;S=_===~~_?_:_===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof x=="string"?D.input=l.binstring2buf(x):m.call(x)==="[object ArrayBuffer]"?D.input=new Uint8Array(x):D.input=x,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new a.Buf8(L),D.next_out=0,D.avail_out=L),(b=s.inflate(D,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&I&&(N=typeof I=="string"?l.string2buf(I):m.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,b=s.inflateSetDictionary(this.strm,N)),b===u.Z_BUF_ERROR&&z===!0&&(b=u.Z_OK,z=!1),b!==u.Z_STREAM_END&&b!==u.Z_OK)return this.onEnd(b),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&b!==u.Z_STREAM_END&&(D.avail_in!==0||S!==u.Z_FINISH&&S!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(A=l.utf8border(D.output,D.next_out),C=D.next_out-A,O=l.buf2string(D.output,A),D.next_out=C,D.avail_out=L-C,C&&a.arraySet(D.output,D.output,A,C,0),this.onData(O)):this.onData(a.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(z=!0)}while((0<D.avail_in||D.avail_out===0)&&b!==u.Z_STREAM_END);return b===u.Z_STREAM_END&&(S=u.Z_FINISH),S===u.Z_FINISH?(b=s.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===u.Z_OK):S!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(D.avail_out=0))},g.prototype.onData=function(x){this.chunks.push(x)},g.prototype.onEnd=function(x){x===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},r.Inflate=g,r.inflate=y,r.inflateRaw=function(x,_){return(_=_||{}).raw=!0,y(x,_)},r.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var d=f.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(u[p]=d[p])}}return u},r.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var a={arraySet:function(u,f,d,p,m){if(f.subarray&&u.subarray)u.set(f.subarray(d,d+p),m);else for(var g=0;g<p;g++)u[m+g]=f[d+g]},flattenChunks:function(u){var f,d,p,m,g,y;for(f=p=0,d=u.length;f<d;f++)p+=u[f].length;for(y=new Uint8Array(p),f=m=0,d=u.length;f<d;f++)g=u[f],y.set(g,m),m+=g.length;return y}},l={arraySet:function(u,f,d,p,m){for(var g=0;g<p;g++)u[m+g]=f[d+g]},flattenChunks:function(u){return[].concat.apply([],u)}};r.setTyped=function(u){u?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,l))},r.setTyped(s)},{}],42:[function(e,i,r){var s=e("./common"),a=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var u=new s.Buf8(256),f=0;f<256;f++)u[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function d(p,m){if(m<65537&&(p.subarray&&l||!p.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(p,m));for(var g="",y=0;y<m;y++)g+=String.fromCharCode(p[y]);return g}u[254]=u[254]=1,r.string2buf=function(p){var m,g,y,x,_,b=p.length,S=0;for(x=0;x<b;x++)(64512&(g=p.charCodeAt(x)))==55296&&x+1<b&&(64512&(y=p.charCodeAt(x+1)))==56320&&(g=65536+(g-55296<<10)+(y-56320),x++),S+=g<128?1:g<2048?2:g<65536?3:4;for(m=new s.Buf8(S),x=_=0;_<S;x++)(64512&(g=p.charCodeAt(x)))==55296&&x+1<b&&(64512&(y=p.charCodeAt(x+1)))==56320&&(g=65536+(g-55296<<10)+(y-56320),x++),g<128?m[_++]=g:(g<2048?m[_++]=192|g>>>6:(g<65536?m[_++]=224|g>>>12:(m[_++]=240|g>>>18,m[_++]=128|g>>>12&63),m[_++]=128|g>>>6&63),m[_++]=128|63&g);return m},r.buf2binstring=function(p){return d(p,p.length)},r.binstring2buf=function(p){for(var m=new s.Buf8(p.length),g=0,y=m.length;g<y;g++)m[g]=p.charCodeAt(g);return m},r.buf2string=function(p,m){var g,y,x,_,b=m||p.length,S=new Array(2*b);for(g=y=0;g<b;)if((x=p[g++])<128)S[y++]=x;else if(4<(_=u[x]))S[y++]=65533,g+=_-1;else{for(x&=_===2?31:_===3?15:7;1<_&&g<b;)x=x<<6|63&p[g++],_--;1<_?S[y++]=65533:x<65536?S[y++]=x:(x-=65536,S[y++]=55296|x>>10&1023,S[y++]=56320|1023&x)}return d(S,y)},r.utf8border=function(p,m){var g;for((m=m||p.length)>p.length&&(m=p.length),g=m-1;0<=g&&(192&p[g])==128;)g--;return g<0||g===0?m:g+u[p[g]]>m?g:m}},{"./common":41}],43:[function(e,i,r){i.exports=function(s,a,l,u){for(var f=65535&s|0,d=s>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;d=d+(f=f+a[u++]|0)|0,--p;);f%=65521,d%=65521}return f|d<<16|0}},{}],44:[function(e,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,i,r){var s=function(){for(var a,l=[],u=0;u<256;u++){a=u;for(var f=0;f<8;f++)a=1&a?3988292384^a>>>1:a>>>1;l[u]=a}return l}();i.exports=function(a,l,u,f){var d=s,p=f+u;a^=-1;for(var m=f;m<p;m++)a=a>>>8^d[255&(a^l[m])];return-1^a}},{}],46:[function(e,i,r){var s,a=e("../utils/common"),l=e("./trees"),u=e("./adler32"),f=e("./crc32"),d=e("./messages"),p=0,m=4,g=0,y=-2,x=-1,_=4,b=2,S=8,A=9,C=286,O=30,N=19,D=2*C+1,L=15,I=3,z=258,j=z+I+1,B=42,tt=113,k=1,et=2,K=3,q=4;function _t(R,mt){return R.msg=d[mt],mt}function at(R){return(R<<1)-(4<R?9:0)}function P(R){for(var mt=R.length;0<=--mt;)R[mt]=0}function X(R){var mt=R.state,ut=mt.pending;ut>R.avail_out&&(ut=R.avail_out),ut!==0&&(a.arraySet(R.output,mt.pending_buf,mt.pending_out,ut,R.next_out),R.next_out+=ut,mt.pending_out+=ut,R.total_out+=ut,R.avail_out-=ut,mt.pending-=ut,mt.pending===0&&(mt.pending_out=0))}function V(R,mt){l._tr_flush_block(R,0<=R.block_start?R.block_start:-1,R.strstart-R.block_start,mt),R.block_start=R.strstart,X(R.strm)}function it(R,mt){R.pending_buf[R.pending++]=mt}function ht(R,mt){R.pending_buf[R.pending++]=mt>>>8&255,R.pending_buf[R.pending++]=255&mt}function yt(R,mt){var ut,J,Q=R.max_chain_length,gt=R.strstart,Bt=R.prev_length,Ht=R.nice_match,Ct=R.strstart>R.w_size-j?R.strstart-(R.w_size-j):0,kt=R.window,Dt=R.w_mask,xt=R.prev,te=R.strstart+z,ae=kt[gt+Bt-1],ne=kt[gt+Bt];R.prev_length>=R.good_match&&(Q>>=2),Ht>R.lookahead&&(Ht=R.lookahead);do if(kt[(ut=mt)+Bt]===ne&&kt[ut+Bt-1]===ae&&kt[ut]===kt[gt]&&kt[++ut]===kt[gt+1]){gt+=2,ut++;do;while(kt[++gt]===kt[++ut]&&kt[++gt]===kt[++ut]&&kt[++gt]===kt[++ut]&&kt[++gt]===kt[++ut]&&kt[++gt]===kt[++ut]&&kt[++gt]===kt[++ut]&&kt[++gt]===kt[++ut]&&kt[++gt]===kt[++ut]&&gt<te);if(J=z-(te-gt),gt=te-z,Bt<J){if(R.match_start=mt,Ht<=(Bt=J))break;ae=kt[gt+Bt-1],ne=kt[gt+Bt]}}while((mt=xt[mt&Dt])>Ct&&--Q!=0);return Bt<=R.lookahead?Bt:R.lookahead}function Rt(R){var mt,ut,J,Q,gt,Bt,Ht,Ct,kt,Dt,xt=R.w_size;do{if(Q=R.window_size-R.lookahead-R.strstart,R.strstart>=xt+(xt-j)){for(a.arraySet(R.window,R.window,xt,xt,0),R.match_start-=xt,R.strstart-=xt,R.block_start-=xt,mt=ut=R.hash_size;J=R.head[--mt],R.head[mt]=xt<=J?J-xt:0,--ut;);for(mt=ut=xt;J=R.prev[--mt],R.prev[mt]=xt<=J?J-xt:0,--ut;);Q+=xt}if(R.strm.avail_in===0)break;if(Bt=R.strm,Ht=R.window,Ct=R.strstart+R.lookahead,kt=Q,Dt=void 0,Dt=Bt.avail_in,kt<Dt&&(Dt=kt),ut=Dt===0?0:(Bt.avail_in-=Dt,a.arraySet(Ht,Bt.input,Bt.next_in,Dt,Ct),Bt.state.wrap===1?Bt.adler=u(Bt.adler,Ht,Dt,Ct):Bt.state.wrap===2&&(Bt.adler=f(Bt.adler,Ht,Dt,Ct)),Bt.next_in+=Dt,Bt.total_in+=Dt,Dt),R.lookahead+=ut,R.lookahead+R.insert>=I)for(gt=R.strstart-R.insert,R.ins_h=R.window[gt],R.ins_h=(R.ins_h<<R.hash_shift^R.window[gt+1])&R.hash_mask;R.insert&&(R.ins_h=(R.ins_h<<R.hash_shift^R.window[gt+I-1])&R.hash_mask,R.prev[gt&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=gt,gt++,R.insert--,!(R.lookahead+R.insert<I)););}while(R.lookahead<j&&R.strm.avail_in!==0)}function Et(R,mt){for(var ut,J;;){if(R.lookahead<j){if(Rt(R),R.lookahead<j&&mt===p)return k;if(R.lookahead===0)break}if(ut=0,R.lookahead>=I&&(R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+I-1])&R.hash_mask,ut=R.prev[R.strstart&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=R.strstart),ut!==0&&R.strstart-ut<=R.w_size-j&&(R.match_length=yt(R,ut)),R.match_length>=I)if(J=l._tr_tally(R,R.strstart-R.match_start,R.match_length-I),R.lookahead-=R.match_length,R.match_length<=R.max_lazy_match&&R.lookahead>=I){for(R.match_length--;R.strstart++,R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+I-1])&R.hash_mask,ut=R.prev[R.strstart&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=R.strstart,--R.match_length!=0;);R.strstart++}else R.strstart+=R.match_length,R.match_length=0,R.ins_h=R.window[R.strstart],R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+1])&R.hash_mask;else J=l._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++;if(J&&(V(R,!1),R.strm.avail_out===0))return k}return R.insert=R.strstart<I-1?R.strstart:I-1,mt===m?(V(R,!0),R.strm.avail_out===0?K:q):R.last_lit&&(V(R,!1),R.strm.avail_out===0)?k:et}function G(R,mt){for(var ut,J,Q;;){if(R.lookahead<j){if(Rt(R),R.lookahead<j&&mt===p)return k;if(R.lookahead===0)break}if(ut=0,R.lookahead>=I&&(R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+I-1])&R.hash_mask,ut=R.prev[R.strstart&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=R.strstart),R.prev_length=R.match_length,R.prev_match=R.match_start,R.match_length=I-1,ut!==0&&R.prev_length<R.max_lazy_match&&R.strstart-ut<=R.w_size-j&&(R.match_length=yt(R,ut),R.match_length<=5&&(R.strategy===1||R.match_length===I&&4096<R.strstart-R.match_start)&&(R.match_length=I-1)),R.prev_length>=I&&R.match_length<=R.prev_length){for(Q=R.strstart+R.lookahead-I,J=l._tr_tally(R,R.strstart-1-R.prev_match,R.prev_length-I),R.lookahead-=R.prev_length-1,R.prev_length-=2;++R.strstart<=Q&&(R.ins_h=(R.ins_h<<R.hash_shift^R.window[R.strstart+I-1])&R.hash_mask,ut=R.prev[R.strstart&R.w_mask]=R.head[R.ins_h],R.head[R.ins_h]=R.strstart),--R.prev_length!=0;);if(R.match_available=0,R.match_length=I-1,R.strstart++,J&&(V(R,!1),R.strm.avail_out===0))return k}else if(R.match_available){if((J=l._tr_tally(R,0,R.window[R.strstart-1]))&&V(R,!1),R.strstart++,R.lookahead--,R.strm.avail_out===0)return k}else R.match_available=1,R.strstart++,R.lookahead--}return R.match_available&&(J=l._tr_tally(R,0,R.window[R.strstart-1]),R.match_available=0),R.insert=R.strstart<I-1?R.strstart:I-1,mt===m?(V(R,!0),R.strm.avail_out===0?K:q):R.last_lit&&(V(R,!1),R.strm.avail_out===0)?k:et}function lt(R,mt,ut,J,Q){this.good_length=R,this.max_lazy=mt,this.nice_length=ut,this.max_chain=J,this.func=Q}function rt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*D),this.dyn_dtree=new a.Buf16(2*(2*O+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),P(this.dyn_ltree),P(this.dyn_dtree),P(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(L+1),this.heap=new a.Buf16(2*C+1),P(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*C+1),P(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ot(R){var mt;return R&&R.state?(R.total_in=R.total_out=0,R.data_type=b,(mt=R.state).pending=0,mt.pending_out=0,mt.wrap<0&&(mt.wrap=-mt.wrap),mt.status=mt.wrap?B:tt,R.adler=mt.wrap===2?0:1,mt.last_flush=p,l._tr_init(mt),g):_t(R,y)}function bt(R){var mt=ot(R);return mt===g&&function(ut){ut.window_size=2*ut.w_size,P(ut.head),ut.max_lazy_match=s[ut.level].max_lazy,ut.good_match=s[ut.level].good_length,ut.nice_match=s[ut.level].nice_length,ut.max_chain_length=s[ut.level].max_chain,ut.strstart=0,ut.block_start=0,ut.lookahead=0,ut.insert=0,ut.match_length=ut.prev_length=I-1,ut.match_available=0,ut.ins_h=0}(R.state),mt}function St(R,mt,ut,J,Q,gt){if(!R)return y;var Bt=1;if(mt===x&&(mt=6),J<0?(Bt=0,J=-J):15<J&&(Bt=2,J-=16),Q<1||A<Q||ut!==S||J<8||15<J||mt<0||9<mt||gt<0||_<gt)return _t(R,y);J===8&&(J=9);var Ht=new rt;return(R.state=Ht).strm=R,Ht.wrap=Bt,Ht.gzhead=null,Ht.w_bits=J,Ht.w_size=1<<Ht.w_bits,Ht.w_mask=Ht.w_size-1,Ht.hash_bits=Q+7,Ht.hash_size=1<<Ht.hash_bits,Ht.hash_mask=Ht.hash_size-1,Ht.hash_shift=~~((Ht.hash_bits+I-1)/I),Ht.window=new a.Buf8(2*Ht.w_size),Ht.head=new a.Buf16(Ht.hash_size),Ht.prev=new a.Buf16(Ht.w_size),Ht.lit_bufsize=1<<Q+6,Ht.pending_buf_size=4*Ht.lit_bufsize,Ht.pending_buf=new a.Buf8(Ht.pending_buf_size),Ht.d_buf=1*Ht.lit_bufsize,Ht.l_buf=3*Ht.lit_bufsize,Ht.level=mt,Ht.strategy=gt,Ht.method=ut,bt(R)}s=[new lt(0,0,0,0,function(R,mt){var ut=65535;for(ut>R.pending_buf_size-5&&(ut=R.pending_buf_size-5);;){if(R.lookahead<=1){if(Rt(R),R.lookahead===0&&mt===p)return k;if(R.lookahead===0)break}R.strstart+=R.lookahead,R.lookahead=0;var J=R.block_start+ut;if((R.strstart===0||R.strstart>=J)&&(R.lookahead=R.strstart-J,R.strstart=J,V(R,!1),R.strm.avail_out===0)||R.strstart-R.block_start>=R.w_size-j&&(V(R,!1),R.strm.avail_out===0))return k}return R.insert=0,mt===m?(V(R,!0),R.strm.avail_out===0?K:q):(R.strstart>R.block_start&&(V(R,!1),R.strm.avail_out),k)}),new lt(4,4,8,4,Et),new lt(4,5,16,8,Et),new lt(4,6,32,32,Et),new lt(4,4,16,16,G),new lt(8,16,32,32,G),new lt(8,16,128,128,G),new lt(8,32,128,256,G),new lt(32,128,258,1024,G),new lt(32,258,258,4096,G)],r.deflateInit=function(R,mt){return St(R,mt,S,15,8,0)},r.deflateInit2=St,r.deflateReset=bt,r.deflateResetKeep=ot,r.deflateSetHeader=function(R,mt){return R&&R.state?R.state.wrap!==2?y:(R.state.gzhead=mt,g):y},r.deflate=function(R,mt){var ut,J,Q,gt;if(!R||!R.state||5<mt||mt<0)return R?_t(R,y):y;if(J=R.state,!R.output||!R.input&&R.avail_in!==0||J.status===666&&mt!==m)return _t(R,R.avail_out===0?-5:y);if(J.strm=R,ut=J.last_flush,J.last_flush=mt,J.status===B)if(J.wrap===2)R.adler=0,it(J,31),it(J,139),it(J,8),J.gzhead?(it(J,(J.gzhead.text?1:0)+(J.gzhead.hcrc?2:0)+(J.gzhead.extra?4:0)+(J.gzhead.name?8:0)+(J.gzhead.comment?16:0)),it(J,255&J.gzhead.time),it(J,J.gzhead.time>>8&255),it(J,J.gzhead.time>>16&255),it(J,J.gzhead.time>>24&255),it(J,J.level===9?2:2<=J.strategy||J.level<2?4:0),it(J,255&J.gzhead.os),J.gzhead.extra&&J.gzhead.extra.length&&(it(J,255&J.gzhead.extra.length),it(J,J.gzhead.extra.length>>8&255)),J.gzhead.hcrc&&(R.adler=f(R.adler,J.pending_buf,J.pending,0)),J.gzindex=0,J.status=69):(it(J,0),it(J,0),it(J,0),it(J,0),it(J,0),it(J,J.level===9?2:2<=J.strategy||J.level<2?4:0),it(J,3),J.status=tt);else{var Bt=S+(J.w_bits-8<<4)<<8;Bt|=(2<=J.strategy||J.level<2?0:J.level<6?1:J.level===6?2:3)<<6,J.strstart!==0&&(Bt|=32),Bt+=31-Bt%31,J.status=tt,ht(J,Bt),J.strstart!==0&&(ht(J,R.adler>>>16),ht(J,65535&R.adler)),R.adler=1}if(J.status===69)if(J.gzhead.extra){for(Q=J.pending;J.gzindex<(65535&J.gzhead.extra.length)&&(J.pending!==J.pending_buf_size||(J.gzhead.hcrc&&J.pending>Q&&(R.adler=f(R.adler,J.pending_buf,J.pending-Q,Q)),X(R),Q=J.pending,J.pending!==J.pending_buf_size));)it(J,255&J.gzhead.extra[J.gzindex]),J.gzindex++;J.gzhead.hcrc&&J.pending>Q&&(R.adler=f(R.adler,J.pending_buf,J.pending-Q,Q)),J.gzindex===J.gzhead.extra.length&&(J.gzindex=0,J.status=73)}else J.status=73;if(J.status===73)if(J.gzhead.name){Q=J.pending;do{if(J.pending===J.pending_buf_size&&(J.gzhead.hcrc&&J.pending>Q&&(R.adler=f(R.adler,J.pending_buf,J.pending-Q,Q)),X(R),Q=J.pending,J.pending===J.pending_buf_size)){gt=1;break}gt=J.gzindex<J.gzhead.name.length?255&J.gzhead.name.charCodeAt(J.gzindex++):0,it(J,gt)}while(gt!==0);J.gzhead.hcrc&&J.pending>Q&&(R.adler=f(R.adler,J.pending_buf,J.pending-Q,Q)),gt===0&&(J.gzindex=0,J.status=91)}else J.status=91;if(J.status===91)if(J.gzhead.comment){Q=J.pending;do{if(J.pending===J.pending_buf_size&&(J.gzhead.hcrc&&J.pending>Q&&(R.adler=f(R.adler,J.pending_buf,J.pending-Q,Q)),X(R),Q=J.pending,J.pending===J.pending_buf_size)){gt=1;break}gt=J.gzindex<J.gzhead.comment.length?255&J.gzhead.comment.charCodeAt(J.gzindex++):0,it(J,gt)}while(gt!==0);J.gzhead.hcrc&&J.pending>Q&&(R.adler=f(R.adler,J.pending_buf,J.pending-Q,Q)),gt===0&&(J.status=103)}else J.status=103;if(J.status===103&&(J.gzhead.hcrc?(J.pending+2>J.pending_buf_size&&X(R),J.pending+2<=J.pending_buf_size&&(it(J,255&R.adler),it(J,R.adler>>8&255),R.adler=0,J.status=tt)):J.status=tt),J.pending!==0){if(X(R),R.avail_out===0)return J.last_flush=-1,g}else if(R.avail_in===0&&at(mt)<=at(ut)&&mt!==m)return _t(R,-5);if(J.status===666&&R.avail_in!==0)return _t(R,-5);if(R.avail_in!==0||J.lookahead!==0||mt!==p&&J.status!==666){var Ht=J.strategy===2?function(Ct,kt){for(var Dt;;){if(Ct.lookahead===0&&(Rt(Ct),Ct.lookahead===0)){if(kt===p)return k;break}if(Ct.match_length=0,Dt=l._tr_tally(Ct,0,Ct.window[Ct.strstart]),Ct.lookahead--,Ct.strstart++,Dt&&(V(Ct,!1),Ct.strm.avail_out===0))return k}return Ct.insert=0,kt===m?(V(Ct,!0),Ct.strm.avail_out===0?K:q):Ct.last_lit&&(V(Ct,!1),Ct.strm.avail_out===0)?k:et}(J,mt):J.strategy===3?function(Ct,kt){for(var Dt,xt,te,ae,ne=Ct.window;;){if(Ct.lookahead<=z){if(Rt(Ct),Ct.lookahead<=z&&kt===p)return k;if(Ct.lookahead===0)break}if(Ct.match_length=0,Ct.lookahead>=I&&0<Ct.strstart&&(xt=ne[te=Ct.strstart-1])===ne[++te]&&xt===ne[++te]&&xt===ne[++te]){ae=Ct.strstart+z;do;while(xt===ne[++te]&&xt===ne[++te]&&xt===ne[++te]&&xt===ne[++te]&&xt===ne[++te]&&xt===ne[++te]&&xt===ne[++te]&&xt===ne[++te]&&te<ae);Ct.match_length=z-(ae-te),Ct.match_length>Ct.lookahead&&(Ct.match_length=Ct.lookahead)}if(Ct.match_length>=I?(Dt=l._tr_tally(Ct,1,Ct.match_length-I),Ct.lookahead-=Ct.match_length,Ct.strstart+=Ct.match_length,Ct.match_length=0):(Dt=l._tr_tally(Ct,0,Ct.window[Ct.strstart]),Ct.lookahead--,Ct.strstart++),Dt&&(V(Ct,!1),Ct.strm.avail_out===0))return k}return Ct.insert=0,kt===m?(V(Ct,!0),Ct.strm.avail_out===0?K:q):Ct.last_lit&&(V(Ct,!1),Ct.strm.avail_out===0)?k:et}(J,mt):s[J.level].func(J,mt);if(Ht!==K&&Ht!==q||(J.status=666),Ht===k||Ht===K)return R.avail_out===0&&(J.last_flush=-1),g;if(Ht===et&&(mt===1?l._tr_align(J):mt!==5&&(l._tr_stored_block(J,0,0,!1),mt===3&&(P(J.head),J.lookahead===0&&(J.strstart=0,J.block_start=0,J.insert=0))),X(R),R.avail_out===0))return J.last_flush=-1,g}return mt!==m?g:J.wrap<=0?1:(J.wrap===2?(it(J,255&R.adler),it(J,R.adler>>8&255),it(J,R.adler>>16&255),it(J,R.adler>>24&255),it(J,255&R.total_in),it(J,R.total_in>>8&255),it(J,R.total_in>>16&255),it(J,R.total_in>>24&255)):(ht(J,R.adler>>>16),ht(J,65535&R.adler)),X(R),0<J.wrap&&(J.wrap=-J.wrap),J.pending!==0?g:1)},r.deflateEnd=function(R){var mt;return R&&R.state?(mt=R.state.status)!==B&&mt!==69&&mt!==73&&mt!==91&&mt!==103&&mt!==tt&&mt!==666?_t(R,y):(R.state=null,mt===tt?_t(R,-3):g):y},r.deflateSetDictionary=function(R,mt){var ut,J,Q,gt,Bt,Ht,Ct,kt,Dt=mt.length;if(!R||!R.state||(gt=(ut=R.state).wrap)===2||gt===1&&ut.status!==B||ut.lookahead)return y;for(gt===1&&(R.adler=u(R.adler,mt,Dt,0)),ut.wrap=0,Dt>=ut.w_size&&(gt===0&&(P(ut.head),ut.strstart=0,ut.block_start=0,ut.insert=0),kt=new a.Buf8(ut.w_size),a.arraySet(kt,mt,Dt-ut.w_size,ut.w_size,0),mt=kt,Dt=ut.w_size),Bt=R.avail_in,Ht=R.next_in,Ct=R.input,R.avail_in=Dt,R.next_in=0,R.input=mt,Rt(ut);ut.lookahead>=I;){for(J=ut.strstart,Q=ut.lookahead-(I-1);ut.ins_h=(ut.ins_h<<ut.hash_shift^ut.window[J+I-1])&ut.hash_mask,ut.prev[J&ut.w_mask]=ut.head[ut.ins_h],ut.head[ut.ins_h]=J,J++,--Q;);ut.strstart=J,ut.lookahead=I-1,Rt(ut)}return ut.strstart+=ut.lookahead,ut.block_start=ut.strstart,ut.insert=ut.lookahead,ut.lookahead=0,ut.match_length=ut.prev_length=I-1,ut.match_available=0,R.next_in=Ht,R.input=Ct,R.avail_in=Bt,ut.wrap=gt,g},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,i,r){i.exports=function(s,a){var l,u,f,d,p,m,g,y,x,_,b,S,A,C,O,N,D,L,I,z,j,B,tt,k,et;l=s.state,u=s.next_in,k=s.input,f=u+(s.avail_in-5),d=s.next_out,et=s.output,p=d-(a-s.avail_out),m=d+(s.avail_out-257),g=l.dmax,y=l.wsize,x=l.whave,_=l.wnext,b=l.window,S=l.hold,A=l.bits,C=l.lencode,O=l.distcode,N=(1<<l.lenbits)-1,D=(1<<l.distbits)-1;t:do{A<15&&(S+=k[u++]<<A,A+=8,S+=k[u++]<<A,A+=8),L=C[S&N];e:for(;;){if(S>>>=I=L>>>24,A-=I,(I=L>>>16&255)===0)et[d++]=65535&L;else{if(!(16&I)){if((64&I)==0){L=C[(65535&L)+(S&(1<<I)-1)];continue e}if(32&I){l.mode=12;break t}s.msg="invalid literal/length code",l.mode=30;break t}z=65535&L,(I&=15)&&(A<I&&(S+=k[u++]<<A,A+=8),z+=S&(1<<I)-1,S>>>=I,A-=I),A<15&&(S+=k[u++]<<A,A+=8,S+=k[u++]<<A,A+=8),L=O[S&D];n:for(;;){if(S>>>=I=L>>>24,A-=I,!(16&(I=L>>>16&255))){if((64&I)==0){L=O[(65535&L)+(S&(1<<I)-1)];continue n}s.msg="invalid distance code",l.mode=30;break t}if(j=65535&L,A<(I&=15)&&(S+=k[u++]<<A,(A+=8)<I&&(S+=k[u++]<<A,A+=8)),g<(j+=S&(1<<I)-1)){s.msg="invalid distance too far back",l.mode=30;break t}if(S>>>=I,A-=I,(I=d-p)<j){if(x<(I=j-I)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break t}if(tt=b,(B=0)===_){if(B+=y-I,I<z){for(z-=I;et[d++]=b[B++],--I;);B=d-j,tt=et}}else if(_<I){if(B+=y+_-I,(I-=_)<z){for(z-=I;et[d++]=b[B++],--I;);if(B=0,_<z){for(z-=I=_;et[d++]=b[B++],--I;);B=d-j,tt=et}}}else if(B+=_-I,I<z){for(z-=I;et[d++]=b[B++],--I;);B=d-j,tt=et}for(;2<z;)et[d++]=tt[B++],et[d++]=tt[B++],et[d++]=tt[B++],z-=3;z&&(et[d++]=tt[B++],1<z&&(et[d++]=tt[B++]))}else{for(B=d-j;et[d++]=et[B++],et[d++]=et[B++],et[d++]=et[B++],2<(z-=3););z&&(et[d++]=et[B++],1<z&&(et[d++]=et[B++]))}break}}break}}while(u<f&&d<m);u-=z=A>>3,S&=(1<<(A-=z<<3))-1,s.next_in=u,s.next_out=d,s.avail_in=u<f?f-u+5:5-(u-f),s.avail_out=d<m?m-d+257:257-(d-m),l.hold=S,l.bits=A}},{}],49:[function(e,i,r){var s=e("../utils/common"),a=e("./adler32"),l=e("./crc32"),u=e("./inffast"),f=e("./inftrees"),d=1,p=2,m=0,g=-2,y=1,x=852,_=592;function b(B){return(B>>>24&255)+(B>>>8&65280)+((65280&B)<<8)+((255&B)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function A(B){var tt;return B&&B.state?(tt=B.state,B.total_in=B.total_out=tt.total=0,B.msg="",tt.wrap&&(B.adler=1&tt.wrap),tt.mode=y,tt.last=0,tt.havedict=0,tt.dmax=32768,tt.head=null,tt.hold=0,tt.bits=0,tt.lencode=tt.lendyn=new s.Buf32(x),tt.distcode=tt.distdyn=new s.Buf32(_),tt.sane=1,tt.back=-1,m):g}function C(B){var tt;return B&&B.state?((tt=B.state).wsize=0,tt.whave=0,tt.wnext=0,A(B)):g}function O(B,tt){var k,et;return B&&B.state?(et=B.state,tt<0?(k=0,tt=-tt):(k=1+(tt>>4),tt<48&&(tt&=15)),tt&&(tt<8||15<tt)?g:(et.window!==null&&et.wbits!==tt&&(et.window=null),et.wrap=k,et.wbits=tt,C(B))):g}function N(B,tt){var k,et;return B?(et=new S,(B.state=et).window=null,(k=O(B,tt))!==m&&(B.state=null),k):g}var D,L,I=!0;function z(B){if(I){var tt;for(D=new s.Buf32(512),L=new s.Buf32(32),tt=0;tt<144;)B.lens[tt++]=8;for(;tt<256;)B.lens[tt++]=9;for(;tt<280;)B.lens[tt++]=7;for(;tt<288;)B.lens[tt++]=8;for(f(d,B.lens,0,288,D,0,B.work,{bits:9}),tt=0;tt<32;)B.lens[tt++]=5;f(p,B.lens,0,32,L,0,B.work,{bits:5}),I=!1}B.lencode=D,B.lenbits=9,B.distcode=L,B.distbits=5}function j(B,tt,k,et){var K,q=B.state;return q.window===null&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=0,q.window=new s.Buf8(q.wsize)),et>=q.wsize?(s.arraySet(q.window,tt,k-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(et<(K=q.wsize-q.wnext)&&(K=et),s.arraySet(q.window,tt,k-et,K,q.wnext),(et-=K)?(s.arraySet(q.window,tt,k-et,et,0),q.wnext=et,q.whave=q.wsize):(q.wnext+=K,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=K))),0}r.inflateReset=C,r.inflateReset2=O,r.inflateResetKeep=A,r.inflateInit=function(B){return N(B,15)},r.inflateInit2=N,r.inflate=function(B,tt){var k,et,K,q,_t,at,P,X,V,it,ht,yt,Rt,Et,G,lt,rt,ot,bt,St,R,mt,ut,J,Q=0,gt=new s.Buf8(4),Bt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!B||!B.state||!B.output||!B.input&&B.avail_in!==0)return g;(k=B.state).mode===12&&(k.mode=13),_t=B.next_out,K=B.output,P=B.avail_out,q=B.next_in,et=B.input,at=B.avail_in,X=k.hold,V=k.bits,it=at,ht=P,mt=m;t:for(;;)switch(k.mode){case y:if(k.wrap===0){k.mode=13;break}for(;V<16;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if(2&k.wrap&&X===35615){gt[k.check=0]=255&X,gt[1]=X>>>8&255,k.check=l(k.check,gt,2,0),V=X=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&X)<<8)+(X>>8))%31){B.msg="incorrect header check",k.mode=30;break}if((15&X)!=8){B.msg="unknown compression method",k.mode=30;break}if(V-=4,R=8+(15&(X>>>=4)),k.wbits===0)k.wbits=R;else if(R>k.wbits){B.msg="invalid window size",k.mode=30;break}k.dmax=1<<R,B.adler=k.check=1,k.mode=512&X?10:12,V=X=0;break;case 2:for(;V<16;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if(k.flags=X,(255&k.flags)!=8){B.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){B.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=X>>8&1),512&k.flags&&(gt[0]=255&X,gt[1]=X>>>8&255,k.check=l(k.check,gt,2,0)),V=X=0,k.mode=3;case 3:for(;V<32;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}k.head&&(k.head.time=X),512&k.flags&&(gt[0]=255&X,gt[1]=X>>>8&255,gt[2]=X>>>16&255,gt[3]=X>>>24&255,k.check=l(k.check,gt,4,0)),V=X=0,k.mode=4;case 4:for(;V<16;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}k.head&&(k.head.xflags=255&X,k.head.os=X>>8),512&k.flags&&(gt[0]=255&X,gt[1]=X>>>8&255,k.check=l(k.check,gt,2,0)),V=X=0,k.mode=5;case 5:if(1024&k.flags){for(;V<16;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}k.length=X,k.head&&(k.head.extra_len=X),512&k.flags&&(gt[0]=255&X,gt[1]=X>>>8&255,k.check=l(k.check,gt,2,0)),V=X=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(at<(yt=k.length)&&(yt=at),yt&&(k.head&&(R=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),s.arraySet(k.head.extra,et,q,yt,R)),512&k.flags&&(k.check=l(k.check,et,yt,q)),at-=yt,q+=yt,k.length-=yt),k.length))break t;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(at===0)break t;for(yt=0;R=et[q+yt++],k.head&&R&&k.length<65536&&(k.head.name+=String.fromCharCode(R)),R&&yt<at;);if(512&k.flags&&(k.check=l(k.check,et,yt,q)),at-=yt,q+=yt,R)break t}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(at===0)break t;for(yt=0;R=et[q+yt++],k.head&&R&&k.length<65536&&(k.head.comment+=String.fromCharCode(R)),R&&yt<at;);if(512&k.flags&&(k.check=l(k.check,et,yt,q)),at-=yt,q+=yt,R)break t}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;V<16;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if(X!==(65535&k.check)){B.msg="header crc mismatch",k.mode=30;break}V=X=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),B.adler=k.check=0,k.mode=12;break;case 10:for(;V<32;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}B.adler=k.check=b(X),V=X=0,k.mode=11;case 11:if(k.havedict===0)return B.next_out=_t,B.avail_out=P,B.next_in=q,B.avail_in=at,k.hold=X,k.bits=V,2;B.adler=k.check=1,k.mode=12;case 12:if(tt===5||tt===6)break t;case 13:if(k.last){X>>>=7&V,V-=7&V,k.mode=27;break}for(;V<3;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}switch(k.last=1&X,V-=1,3&(X>>>=1)){case 0:k.mode=14;break;case 1:if(z(k),k.mode=20,tt!==6)break;X>>>=2,V-=2;break t;case 2:k.mode=17;break;case 3:B.msg="invalid block type",k.mode=30}X>>>=2,V-=2;break;case 14:for(X>>>=7&V,V-=7&V;V<32;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if((65535&X)!=(X>>>16^65535)){B.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&X,V=X=0,k.mode=15,tt===6)break t;case 15:k.mode=16;case 16:if(yt=k.length){if(at<yt&&(yt=at),P<yt&&(yt=P),yt===0)break t;s.arraySet(K,et,q,yt,_t),at-=yt,q+=yt,P-=yt,_t+=yt,k.length-=yt;break}k.mode=12;break;case 17:for(;V<14;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if(k.nlen=257+(31&X),X>>>=5,V-=5,k.ndist=1+(31&X),X>>>=5,V-=5,k.ncode=4+(15&X),X>>>=4,V-=4,286<k.nlen||30<k.ndist){B.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;V<3;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}k.lens[Bt[k.have++]]=7&X,X>>>=3,V-=3}for(;k.have<19;)k.lens[Bt[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,ut={bits:k.lenbits},mt=f(0,k.lens,0,19,k.lencode,0,k.work,ut),k.lenbits=ut.bits,mt){B.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;lt=(Q=k.lencode[X&(1<<k.lenbits)-1])>>>16&255,rt=65535&Q,!((G=Q>>>24)<=V);){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if(rt<16)X>>>=G,V-=G,k.lens[k.have++]=rt;else{if(rt===16){for(J=G+2;V<J;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if(X>>>=G,V-=G,k.have===0){B.msg="invalid bit length repeat",k.mode=30;break}R=k.lens[k.have-1],yt=3+(3&X),X>>>=2,V-=2}else if(rt===17){for(J=G+3;V<J;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}V-=G,R=0,yt=3+(7&(X>>>=G)),X>>>=3,V-=3}else{for(J=G+7;V<J;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}V-=G,R=0,yt=11+(127&(X>>>=G)),X>>>=7,V-=7}if(k.have+yt>k.nlen+k.ndist){B.msg="invalid bit length repeat",k.mode=30;break}for(;yt--;)k.lens[k.have++]=R}}if(k.mode===30)break;if(k.lens[256]===0){B.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,ut={bits:k.lenbits},mt=f(d,k.lens,0,k.nlen,k.lencode,0,k.work,ut),k.lenbits=ut.bits,mt){B.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,ut={bits:k.distbits},mt=f(p,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,ut),k.distbits=ut.bits,mt){B.msg="invalid distances set",k.mode=30;break}if(k.mode=20,tt===6)break t;case 20:k.mode=21;case 21:if(6<=at&&258<=P){B.next_out=_t,B.avail_out=P,B.next_in=q,B.avail_in=at,k.hold=X,k.bits=V,u(B,ht),_t=B.next_out,K=B.output,P=B.avail_out,q=B.next_in,et=B.input,at=B.avail_in,X=k.hold,V=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;lt=(Q=k.lencode[X&(1<<k.lenbits)-1])>>>16&255,rt=65535&Q,!((G=Q>>>24)<=V);){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if(lt&&(240&lt)==0){for(ot=G,bt=lt,St=rt;lt=(Q=k.lencode[St+((X&(1<<ot+bt)-1)>>ot)])>>>16&255,rt=65535&Q,!(ot+(G=Q>>>24)<=V);){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}X>>>=ot,V-=ot,k.back+=ot}if(X>>>=G,V-=G,k.back+=G,k.length=rt,lt===0){k.mode=26;break}if(32&lt){k.back=-1,k.mode=12;break}if(64&lt){B.msg="invalid literal/length code",k.mode=30;break}k.extra=15&lt,k.mode=22;case 22:if(k.extra){for(J=k.extra;V<J;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}k.length+=X&(1<<k.extra)-1,X>>>=k.extra,V-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;lt=(Q=k.distcode[X&(1<<k.distbits)-1])>>>16&255,rt=65535&Q,!((G=Q>>>24)<=V);){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if((240&lt)==0){for(ot=G,bt=lt,St=rt;lt=(Q=k.distcode[St+((X&(1<<ot+bt)-1)>>ot)])>>>16&255,rt=65535&Q,!(ot+(G=Q>>>24)<=V);){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}X>>>=ot,V-=ot,k.back+=ot}if(X>>>=G,V-=G,k.back+=G,64&lt){B.msg="invalid distance code",k.mode=30;break}k.offset=rt,k.extra=15&lt,k.mode=24;case 24:if(k.extra){for(J=k.extra;V<J;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}k.offset+=X&(1<<k.extra)-1,X>>>=k.extra,V-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){B.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(P===0)break t;if(yt=ht-P,k.offset>yt){if((yt=k.offset-yt)>k.whave&&k.sane){B.msg="invalid distance too far back",k.mode=30;break}Rt=yt>k.wnext?(yt-=k.wnext,k.wsize-yt):k.wnext-yt,yt>k.length&&(yt=k.length),Et=k.window}else Et=K,Rt=_t-k.offset,yt=k.length;for(P<yt&&(yt=P),P-=yt,k.length-=yt;K[_t++]=Et[Rt++],--yt;);k.length===0&&(k.mode=21);break;case 26:if(P===0)break t;K[_t++]=k.length,P--,k.mode=21;break;case 27:if(k.wrap){for(;V<32;){if(at===0)break t;at--,X|=et[q++]<<V,V+=8}if(ht-=P,B.total_out+=ht,k.total+=ht,ht&&(B.adler=k.check=k.flags?l(k.check,K,ht,_t-ht):a(k.check,K,ht,_t-ht)),ht=P,(k.flags?X:b(X))!==k.check){B.msg="incorrect data check",k.mode=30;break}V=X=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;V<32;){if(at===0)break t;at--,X+=et[q++]<<V,V+=8}if(X!==(4294967295&k.total)){B.msg="incorrect length check",k.mode=30;break}V=X=0}k.mode=29;case 29:mt=1;break t;case 30:mt=-3;break t;case 31:return-4;case 32:default:return g}return B.next_out=_t,B.avail_out=P,B.next_in=q,B.avail_in=at,k.hold=X,k.bits=V,(k.wsize||ht!==B.avail_out&&k.mode<30&&(k.mode<27||tt!==4))&&j(B,B.output,B.next_out,ht-B.avail_out)?(k.mode=31,-4):(it-=B.avail_in,ht-=B.avail_out,B.total_in+=it,B.total_out+=ht,k.total+=ht,k.wrap&&ht&&(B.adler=k.check=k.flags?l(k.check,K,ht,B.next_out-ht):a(k.check,K,ht,B.next_out-ht)),B.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),(it==0&&ht===0||tt===4)&&mt===m&&(mt=-5),mt)},r.inflateEnd=function(B){if(!B||!B.state)return g;var tt=B.state;return tt.window&&(tt.window=null),B.state=null,m},r.inflateGetHeader=function(B,tt){var k;return B&&B.state?(2&(k=B.state).wrap)==0?g:((k.head=tt).done=!1,m):g},r.inflateSetDictionary=function(B,tt){var k,et=tt.length;return B&&B.state?(k=B.state).wrap!==0&&k.mode!==11?g:k.mode===11&&a(1,tt,et,0)!==k.check?-3:j(B,tt,et,et)?(k.mode=31,-4):(k.havedict=1,m):g},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,i,r){var s=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(d,p,m,g,y,x,_,b){var S,A,C,O,N,D,L,I,z,j=b.bits,B=0,tt=0,k=0,et=0,K=0,q=0,_t=0,at=0,P=0,X=0,V=null,it=0,ht=new s.Buf16(16),yt=new s.Buf16(16),Rt=null,Et=0;for(B=0;B<=15;B++)ht[B]=0;for(tt=0;tt<g;tt++)ht[p[m+tt]]++;for(K=j,et=15;1<=et&&ht[et]===0;et--);if(et<K&&(K=et),et===0)return y[x++]=20971520,y[x++]=20971520,b.bits=1,0;for(k=1;k<et&&ht[k]===0;k++);for(K<k&&(K=k),B=at=1;B<=15;B++)if(at<<=1,(at-=ht[B])<0)return-1;if(0<at&&(d===0||et!==1))return-1;for(yt[1]=0,B=1;B<15;B++)yt[B+1]=yt[B]+ht[B];for(tt=0;tt<g;tt++)p[m+tt]!==0&&(_[yt[p[m+tt]]++]=tt);if(D=d===0?(V=Rt=_,19):d===1?(V=a,it-=257,Rt=l,Et-=257,256):(V=u,Rt=f,-1),B=k,N=x,_t=tt=X=0,C=-1,O=(P=1<<(q=K))-1,d===1&&852<P||d===2&&592<P)return 1;for(;;){for(L=B-_t,z=_[tt]<D?(I=0,_[tt]):_[tt]>D?(I=Rt[Et+_[tt]],V[it+_[tt]]):(I=96,0),S=1<<B-_t,k=A=1<<q;y[N+(X>>_t)+(A-=S)]=L<<24|I<<16|z|0,A!==0;);for(S=1<<B-1;X&S;)S>>=1;if(S!==0?(X&=S-1,X+=S):X=0,tt++,--ht[B]==0){if(B===et)break;B=p[m+_[tt]]}if(K<B&&(X&O)!==C){for(_t===0&&(_t=K),N+=k,at=1<<(q=B-_t);q+_t<et&&!((at-=ht[q+_t])<=0);)q++,at<<=1;if(P+=1<<q,d===1&&852<P||d===2&&592<P)return 1;y[C=X&O]=K<<24|q<<16|N-x|0}}return X!==0&&(y[N+X]=B-_t<<24|64<<16|0),b.bits=K,0}},{"../utils/common":41}],51:[function(e,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,i,r){var s=e("../utils/common"),a=0,l=1;function u(Q){for(var gt=Q.length;0<=--gt;)Q[gt]=0}var f=0,d=29,p=256,m=p+1+d,g=30,y=19,x=2*m+1,_=15,b=16,S=7,A=256,C=16,O=17,N=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=new Array(2*(m+2));u(j);var B=new Array(2*g);u(B);var tt=new Array(512);u(tt);var k=new Array(256);u(k);var et=new Array(d);u(et);var K,q,_t,at=new Array(g);function P(Q,gt,Bt,Ht,Ct){this.static_tree=Q,this.extra_bits=gt,this.extra_base=Bt,this.elems=Ht,this.max_length=Ct,this.has_stree=Q&&Q.length}function X(Q,gt){this.dyn_tree=Q,this.max_code=0,this.stat_desc=gt}function V(Q){return Q<256?tt[Q]:tt[256+(Q>>>7)]}function it(Q,gt){Q.pending_buf[Q.pending++]=255&gt,Q.pending_buf[Q.pending++]=gt>>>8&255}function ht(Q,gt,Bt){Q.bi_valid>b-Bt?(Q.bi_buf|=gt<<Q.bi_valid&65535,it(Q,Q.bi_buf),Q.bi_buf=gt>>b-Q.bi_valid,Q.bi_valid+=Bt-b):(Q.bi_buf|=gt<<Q.bi_valid&65535,Q.bi_valid+=Bt)}function yt(Q,gt,Bt){ht(Q,Bt[2*gt],Bt[2*gt+1])}function Rt(Q,gt){for(var Bt=0;Bt|=1&Q,Q>>>=1,Bt<<=1,0<--gt;);return Bt>>>1}function Et(Q,gt,Bt){var Ht,Ct,kt=new Array(_+1),Dt=0;for(Ht=1;Ht<=_;Ht++)kt[Ht]=Dt=Dt+Bt[Ht-1]<<1;for(Ct=0;Ct<=gt;Ct++){var xt=Q[2*Ct+1];xt!==0&&(Q[2*Ct]=Rt(kt[xt]++,xt))}}function G(Q){var gt;for(gt=0;gt<m;gt++)Q.dyn_ltree[2*gt]=0;for(gt=0;gt<g;gt++)Q.dyn_dtree[2*gt]=0;for(gt=0;gt<y;gt++)Q.bl_tree[2*gt]=0;Q.dyn_ltree[2*A]=1,Q.opt_len=Q.static_len=0,Q.last_lit=Q.matches=0}function lt(Q){8<Q.bi_valid?it(Q,Q.bi_buf):0<Q.bi_valid&&(Q.pending_buf[Q.pending++]=Q.bi_buf),Q.bi_buf=0,Q.bi_valid=0}function rt(Q,gt,Bt,Ht){var Ct=2*gt,kt=2*Bt;return Q[Ct]<Q[kt]||Q[Ct]===Q[kt]&&Ht[gt]<=Ht[Bt]}function ot(Q,gt,Bt){for(var Ht=Q.heap[Bt],Ct=Bt<<1;Ct<=Q.heap_len&&(Ct<Q.heap_len&&rt(gt,Q.heap[Ct+1],Q.heap[Ct],Q.depth)&&Ct++,!rt(gt,Ht,Q.heap[Ct],Q.depth));)Q.heap[Bt]=Q.heap[Ct],Bt=Ct,Ct<<=1;Q.heap[Bt]=Ht}function bt(Q,gt,Bt){var Ht,Ct,kt,Dt,xt=0;if(Q.last_lit!==0)for(;Ht=Q.pending_buf[Q.d_buf+2*xt]<<8|Q.pending_buf[Q.d_buf+2*xt+1],Ct=Q.pending_buf[Q.l_buf+xt],xt++,Ht===0?yt(Q,Ct,gt):(yt(Q,(kt=k[Ct])+p+1,gt),(Dt=D[kt])!==0&&ht(Q,Ct-=et[kt],Dt),yt(Q,kt=V(--Ht),Bt),(Dt=L[kt])!==0&&ht(Q,Ht-=at[kt],Dt)),xt<Q.last_lit;);yt(Q,A,gt)}function St(Q,gt){var Bt,Ht,Ct,kt=gt.dyn_tree,Dt=gt.stat_desc.static_tree,xt=gt.stat_desc.has_stree,te=gt.stat_desc.elems,ae=-1;for(Q.heap_len=0,Q.heap_max=x,Bt=0;Bt<te;Bt++)kt[2*Bt]!==0?(Q.heap[++Q.heap_len]=ae=Bt,Q.depth[Bt]=0):kt[2*Bt+1]=0;for(;Q.heap_len<2;)kt[2*(Ct=Q.heap[++Q.heap_len]=ae<2?++ae:0)]=1,Q.depth[Ct]=0,Q.opt_len--,xt&&(Q.static_len-=Dt[2*Ct+1]);for(gt.max_code=ae,Bt=Q.heap_len>>1;1<=Bt;Bt--)ot(Q,kt,Bt);for(Ct=te;Bt=Q.heap[1],Q.heap[1]=Q.heap[Q.heap_len--],ot(Q,kt,1),Ht=Q.heap[1],Q.heap[--Q.heap_max]=Bt,Q.heap[--Q.heap_max]=Ht,kt[2*Ct]=kt[2*Bt]+kt[2*Ht],Q.depth[Ct]=(Q.depth[Bt]>=Q.depth[Ht]?Q.depth[Bt]:Q.depth[Ht])+1,kt[2*Bt+1]=kt[2*Ht+1]=Ct,Q.heap[1]=Ct++,ot(Q,kt,1),2<=Q.heap_len;);Q.heap[--Q.heap_max]=Q.heap[1],function(ne,Me){var dn,Se,gn,Ze,Zn,Bn,On=Me.dyn_tree,Oi=Me.max_code,Us=Me.stat_desc.static_tree,pa=Me.stat_desc.has_stree,wo=Me.stat_desc.extra_bits,ma=Me.stat_desc.extra_base,Pi=Me.stat_desc.max_length,Wr=0;for(Ze=0;Ze<=_;Ze++)ne.bl_count[Ze]=0;for(On[2*ne.heap[ne.heap_max]+1]=0,dn=ne.heap_max+1;dn<x;dn++)Pi<(Ze=On[2*On[2*(Se=ne.heap[dn])+1]+1]+1)&&(Ze=Pi,Wr++),On[2*Se+1]=Ze,Oi<Se||(ne.bl_count[Ze]++,Zn=0,ma<=Se&&(Zn=wo[Se-ma]),Bn=On[2*Se],ne.opt_len+=Bn*(Ze+Zn),pa&&(ne.static_len+=Bn*(Us[2*Se+1]+Zn)));if(Wr!==0){do{for(Ze=Pi-1;ne.bl_count[Ze]===0;)Ze--;ne.bl_count[Ze]--,ne.bl_count[Ze+1]+=2,ne.bl_count[Pi]--,Wr-=2}while(0<Wr);for(Ze=Pi;Ze!==0;Ze--)for(Se=ne.bl_count[Ze];Se!==0;)Oi<(gn=ne.heap[--dn])||(On[2*gn+1]!==Ze&&(ne.opt_len+=(Ze-On[2*gn+1])*On[2*gn],On[2*gn+1]=Ze),Se--)}}(Q,gt),Et(kt,ae,Q.bl_count)}function R(Q,gt,Bt){var Ht,Ct,kt=-1,Dt=gt[1],xt=0,te=7,ae=4;for(Dt===0&&(te=138,ae=3),gt[2*(Bt+1)+1]=65535,Ht=0;Ht<=Bt;Ht++)Ct=Dt,Dt=gt[2*(Ht+1)+1],++xt<te&&Ct===Dt||(xt<ae?Q.bl_tree[2*Ct]+=xt:Ct!==0?(Ct!==kt&&Q.bl_tree[2*Ct]++,Q.bl_tree[2*C]++):xt<=10?Q.bl_tree[2*O]++:Q.bl_tree[2*N]++,kt=Ct,ae=(xt=0)===Dt?(te=138,3):Ct===Dt?(te=6,3):(te=7,4))}function mt(Q,gt,Bt){var Ht,Ct,kt=-1,Dt=gt[1],xt=0,te=7,ae=4;for(Dt===0&&(te=138,ae=3),Ht=0;Ht<=Bt;Ht++)if(Ct=Dt,Dt=gt[2*(Ht+1)+1],!(++xt<te&&Ct===Dt)){if(xt<ae)for(;yt(Q,Ct,Q.bl_tree),--xt!=0;);else Ct!==0?(Ct!==kt&&(yt(Q,Ct,Q.bl_tree),xt--),yt(Q,C,Q.bl_tree),ht(Q,xt-3,2)):xt<=10?(yt(Q,O,Q.bl_tree),ht(Q,xt-3,3)):(yt(Q,N,Q.bl_tree),ht(Q,xt-11,7));kt=Ct,ae=(xt=0)===Dt?(te=138,3):Ct===Dt?(te=6,3):(te=7,4)}}u(at);var ut=!1;function J(Q,gt,Bt,Ht){ht(Q,(f<<1)+(Ht?1:0),3),function(Ct,kt,Dt,xt){lt(Ct),it(Ct,Dt),it(Ct,~Dt),s.arraySet(Ct.pending_buf,Ct.window,kt,Dt,Ct.pending),Ct.pending+=Dt}(Q,gt,Bt)}r._tr_init=function(Q){ut||(function(){var gt,Bt,Ht,Ct,kt,Dt=new Array(_+1);for(Ct=Ht=0;Ct<d-1;Ct++)for(et[Ct]=Ht,gt=0;gt<1<<D[Ct];gt++)k[Ht++]=Ct;for(k[Ht-1]=Ct,Ct=kt=0;Ct<16;Ct++)for(at[Ct]=kt,gt=0;gt<1<<L[Ct];gt++)tt[kt++]=Ct;for(kt>>=7;Ct<g;Ct++)for(at[Ct]=kt<<7,gt=0;gt<1<<L[Ct]-7;gt++)tt[256+kt++]=Ct;for(Bt=0;Bt<=_;Bt++)Dt[Bt]=0;for(gt=0;gt<=143;)j[2*gt+1]=8,gt++,Dt[8]++;for(;gt<=255;)j[2*gt+1]=9,gt++,Dt[9]++;for(;gt<=279;)j[2*gt+1]=7,gt++,Dt[7]++;for(;gt<=287;)j[2*gt+1]=8,gt++,Dt[8]++;for(Et(j,m+1,Dt),gt=0;gt<g;gt++)B[2*gt+1]=5,B[2*gt]=Rt(gt,5);K=new P(j,D,p+1,m,_),q=new P(B,L,0,g,_),_t=new P(new Array(0),I,0,y,S)}(),ut=!0),Q.l_desc=new X(Q.dyn_ltree,K),Q.d_desc=new X(Q.dyn_dtree,q),Q.bl_desc=new X(Q.bl_tree,_t),Q.bi_buf=0,Q.bi_valid=0,G(Q)},r._tr_stored_block=J,r._tr_flush_block=function(Q,gt,Bt,Ht){var Ct,kt,Dt=0;0<Q.level?(Q.strm.data_type===2&&(Q.strm.data_type=function(xt){var te,ae=4093624447;for(te=0;te<=31;te++,ae>>>=1)if(1&ae&&xt.dyn_ltree[2*te]!==0)return a;if(xt.dyn_ltree[18]!==0||xt.dyn_ltree[20]!==0||xt.dyn_ltree[26]!==0)return l;for(te=32;te<p;te++)if(xt.dyn_ltree[2*te]!==0)return l;return a}(Q)),St(Q,Q.l_desc),St(Q,Q.d_desc),Dt=function(xt){var te;for(R(xt,xt.dyn_ltree,xt.l_desc.max_code),R(xt,xt.dyn_dtree,xt.d_desc.max_code),St(xt,xt.bl_desc),te=y-1;3<=te&&xt.bl_tree[2*z[te]+1]===0;te--);return xt.opt_len+=3*(te+1)+5+5+4,te}(Q),Ct=Q.opt_len+3+7>>>3,(kt=Q.static_len+3+7>>>3)<=Ct&&(Ct=kt)):Ct=kt=Bt+5,Bt+4<=Ct&&gt!==-1?J(Q,gt,Bt,Ht):Q.strategy===4||kt===Ct?(ht(Q,2+(Ht?1:0),3),bt(Q,j,B)):(ht(Q,4+(Ht?1:0),3),function(xt,te,ae,ne){var Me;for(ht(xt,te-257,5),ht(xt,ae-1,5),ht(xt,ne-4,4),Me=0;Me<ne;Me++)ht(xt,xt.bl_tree[2*z[Me]+1],3);mt(xt,xt.dyn_ltree,te-1),mt(xt,xt.dyn_dtree,ae-1)}(Q,Q.l_desc.max_code+1,Q.d_desc.max_code+1,Dt+1),bt(Q,Q.dyn_ltree,Q.dyn_dtree)),G(Q),Ht&&lt(Q)},r._tr_tally=function(Q,gt,Bt){return Q.pending_buf[Q.d_buf+2*Q.last_lit]=gt>>>8&255,Q.pending_buf[Q.d_buf+2*Q.last_lit+1]=255&gt,Q.pending_buf[Q.l_buf+Q.last_lit]=255&Bt,Q.last_lit++,gt===0?Q.dyn_ltree[2*Bt]++:(Q.matches++,gt--,Q.dyn_ltree[2*(k[Bt]+p+1)]++,Q.dyn_dtree[2*V(gt)]++),Q.last_lit===Q.lit_bufsize-1},r._tr_align=function(Q){ht(Q,2,3),yt(Q,A,j),function(gt){gt.bi_valid===16?(it(gt,gt.bi_buf),gt.bi_buf=0,gt.bi_valid=0):8<=gt.bi_valid&&(gt.pending_buf[gt.pending++]=255&gt.bi_buf,gt.bi_buf>>=8,gt.bi_valid-=8)}(Q)}},{"../utils/common":41}],53:[function(e,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,i,r){(function(s){(function(a,l){if(!a.setImmediate){var u,f,d,p,m=1,g={},y=!1,x=a.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(a);_=_&&_.setTimeout?_:a,u={}.toString.call(a.process)==="[object process]"?function(C){process.nextTick(function(){S(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,O=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=O,C}}()?(p="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",A,!1):a.attachEvent("onmessage",A),function(C){a.postMessage(p+C,"*")}):a.MessageChannel?((d=new MessageChannel).port1.onmessage=function(C){S(C.data)},function(C){d.port2.postMessage(C)}):x&&"onreadystatechange"in x.createElement("script")?(f=x.documentElement,function(C){var O=x.createElement("script");O.onreadystatechange=function(){S(C),O.onreadystatechange=null,f.removeChild(O),O=null},f.appendChild(O)}):function(C){setTimeout(S,0,C)},_.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var O=new Array(arguments.length-1),N=0;N<O.length;N++)O[N]=arguments[N+1];var D={callback:C,args:O};return g[m]=D,u(m),m++},_.clearImmediate=b}function b(C){delete g[C]}function S(C){if(y)setTimeout(S,0,C);else{var O=g[C];if(O){y=!0;try{(function(N){var D=N.callback,L=N.args;switch(L.length){case 0:D();break;case 1:D(L[0]);break;case 2:D(L[0],L[1]);break;case 3:D(L[0],L[1],L[2]);break;default:D.apply(l,L)}})(O)}finally{b(C),y=!1}}}}function A(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(p)===0&&S(+C.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Dg<"u"?Dg:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(Bb)),Bb.exports}var oit=ait();const lit=ku(oit),cit=(n,t)=>{const e=ik(n,t),i=JSON.stringify(e,null,2),r=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(r),a=document.createElement("a");a.href=s,a.download="dados-estruturados.json",a.click(),URL.revokeObjectURL(s)},ik=(n,t)=>{const e=Od(n),i=[];return t.forEach(r=>{const s={hole_id:us(r,e,"hole_id"),nspt:{start_depth:1,interval:1,values:[]},depths:[],geology:[]},a=sx(r,e);a>0&&(s.max_depth=a);const l=ks(us(r,e,"z"));l!==-1&&(s.z=l);const u=us(r,e,"water_level");if(u){const g=ks(u,-1);g>=0&&(s.water_level=g)}const f=ul(r,e,"depth_from_to").map(g=>ks(g)).filter(g=>g!==-1).sort((g,y)=>g-y);f.length>0&&!f.includes(0)&&f.unshift(0),f.length>0&&(s.depths=f);const d=ul(r,e,"geology");d.length>0&&(s.geology=d);const p=ul(r,e,"interp");p.length>0&&(s.interp=p);const m=ul(r,e,"nspt");m.length>0&&(s.nspt={start_depth:1,interval:1,values:m}),i.push(s)}),i},uit=(n,t)=>{const e=n.map(p=>p.name),i=["Página",...e],r=t.map(p=>{const m=[p.pageNumber.join(", ")];return e.forEach(g=>{const y=p[g];Array.isArray(y)?m.push(y.join("; ")):m.push(y||"")}),m}),l="\uFEFF"+[i,...r].map(p=>p.map(m=>`"${m}"`).join(",")).join(`
`),u=new Blob([l],{type:"text/csv;charset=utf-8;"}),f=URL.createObjectURL(u),d=document.createElement("a");d.href=f,d.download="dados-extraidos.csv",d.click(),URL.revokeObjectURL(f)},fit=(n,t)=>{const e=n.map(a=>a.name),i=t.map(a=>{const l={Página:a.pageNumber};return e.forEach(u=>{const f=a[u];Array.isArray(f)?l[u]=f.join("; "):l[u]=f||""}),l});var r=Pb.json_to_sheet(i),s=Pb.book_new();Pb.book_append_sheet(s,r,"Dados extraídos"),$nt(s,"dados-pdf.xlsx")},dit=(n,t,e)=>{const i=nk(t,n,e);if(!i){alert("Não existem todas as áreas necessárias para gerar esse arquivo");return}const s="\uFEFF"+ek(i.data,i.headers),a=new Blob([s],{type:"text/csv"}),l=URL.createObjectURL(a),u=document.createElement("a");u.href=l,u.download=i.filename,u.click(),URL.revokeObjectURL(l)},hit=async(n,t,e)=>{const i=new lit,r="\uFEFF";["collar","nspt","na","geology","interp"].forEach(f=>{if(Sx(n,f).isValid||e){const d=nk(t,n,f);if(d){const p=r+ek(d.data,d.headers);i.file(d.filename,p)}}});const a=await i.generateAsync({type:"blob"}),l=URL.createObjectURL(a),u=document.createElement("a");u.href=l,u.download="leapfrog-data.zip",u.click(),URL.revokeObjectURL(l)},pit=(n,t,e)=>`dropdown-item${Sx(n,t).isValid||e?"":" disabled"}`,eO=n=>{const t=zv.filter(e=>Sx(n,e).isValid);return{validExports:t,nonValidExports:zv.filter(e=>!t.includes(e)),someValid:t.length>0,allValid:t.length===zv.length}};var jb={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var nO;function mit(){return nO||(nO=1,function(n){(function(){var t={}.hasOwnProperty;function e(){for(var s="",a=0;a<arguments.length;a++){var l=arguments[a];l&&(s=r(s,i(l)))}return s}function i(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return e.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var l in s)t.call(s,l)&&s[l]&&(a=r(a,l));return a}function r(s,a){return a?s?s+" "+a:s+a:s}n.exports?(e.default=e,n.exports=e):window.classNames=e})()}(jb)),jb.exports}var git=mit();const xe=ku(git);function rk(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)!==-1)continue;e[i]=n[i]}return e}function iO(n){return"default"+n.charAt(0).toUpperCase()+n.substr(1)}function vit(n){var t=xit(n,"string");return typeof t=="symbol"?t:String(t)}function xit(n,t){if(typeof n!="object"||n===null)return n;var e=n[Symbol.toPrimitive];if(e!==void 0){var i=e.call(n,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function sk(n,t,e){var i=U.useRef(n!==void 0),r=U.useState(t),s=r[0],a=r[1],l=n!==void 0,u=i.current;return i.current=l,!l&&u&&s!==t&&a(t),[l?n:s,U.useCallback(function(f){for(var d=arguments.length,p=new Array(d>1?d-1:0),m=1;m<d;m++)p[m-1]=arguments[m];e&&e.apply(void 0,[f].concat(p)),a(f)},[e])]}function Tx(n,t){return Object.keys(t).reduce(function(e,i){var r,s=e,a=s[iO(i)],l=s[i],u=rk(s,[iO(i),i].map(vit)),f=t[i],d=sk(l,a,n[f]),p=d[0],m=d[1];return n0({},u,(r={},r[i]=p,r[f]=m,r))},n)}function fE(n,t){return fE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e},fE(n,t)}function yit(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n,fE(n,t)}const _it=["xxl","xl","lg","md","sm","xs"],bit="xs",V0=U.createContext({prefixes:{},breakpoints:_it,minBreakpoint:bit}),{Consumer:Qat,Provider:Jat}=V0;function Ae(n,t){const{prefixes:e}=U.useContext(V0);return n||e[t]||t}function ak(){const{breakpoints:n}=U.useContext(V0);return n}function ok(){const{minBreakpoint:n}=U.useContext(V0);return n}function _A(){const{dir:n}=U.useContext(V0);return n==="rtl"}function W0(n){return n&&n.ownerDocument||document}function wit(n){var t=W0(n);return t&&t.defaultView||window}function Eit(n,t){return wit(n).getComputedStyle(n,t)}var Ait=/([A-Z])/g;function Sit(n){return n.replace(Ait,"-$1").toLowerCase()}var Tit=/^ms-/;function av(n){return Sit(n).replace(Tit,"-ms-")}var Cit=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function Dit(n){return!!(n&&Cit.test(n))}function vl(n,t){var e="",i="";if(typeof t=="string")return n.style.getPropertyValue(av(t))||Eit(n).getPropertyValue(av(t));Object.keys(t).forEach(function(r){var s=t[r];!s&&s!==0?n.style.removeProperty(av(r)):Dit(r)?i+=r+"("+s+") ":e+=av(r)+": "+s+";"}),i&&(e+="transform: "+i+";"),n.style.cssText+=";"+e}const rO={disabled:!1},lk=Je.createContext(null);var Oit=function(t){return t.scrollTop},Lp="unmounted",lc="exited",Oa="entering",cl="entered",x0="exiting",Tl=function(n){yit(t,n);function t(i,r){var s;s=n.call(this,i,r)||this;var a=r,l=a&&!a.isMounting?i.enter:i.appear,u;return s.appearStatus=null,i.in?l?(u=lc,s.appearStatus=Oa):u=cl:i.unmountOnExit||i.mountOnEnter?u=Lp:u=lc,s.state={status:u},s.nextCallback=null,s}t.getDerivedStateFromProps=function(r,s){var a=r.in;return a&&s.status===Lp?{status:lc}:null};var e=t.prototype;return e.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},e.componentDidUpdate=function(r){var s=null;if(r!==this.props){var a=this.state.status;this.props.in?a!==Oa&&a!==cl&&(s=Oa):(a===Oa||a===cl)&&(s=x0)}this.updateStatus(!1,s)},e.componentWillUnmount=function(){this.cancelNextCallback()},e.getTimeouts=function(){var r=this.props.timeout,s,a,l;return s=a=l=r,r!=null&&typeof r!="number"&&(s=r.exit,a=r.enter,l=r.appear!==void 0?r.appear:a),{exit:s,enter:a,appear:l}},e.updateStatus=function(r,s){if(r===void 0&&(r=!1),s!==null)if(this.cancelNextCallback(),s===Oa){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:dc.findDOMNode(this);a&&Oit(a)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===lc&&this.setState({status:Lp})},e.performEnter=function(r){var s=this,a=this.props.enter,l=this.context?this.context.isMounting:r,u=this.props.nodeRef?[l]:[dc.findDOMNode(this),l],f=u[0],d=u[1],p=this.getTimeouts(),m=l?p.appear:p.enter;if(!r&&!a||rO.disabled){this.safeSetState({status:cl},function(){s.props.onEntered(f)});return}this.props.onEnter(f,d),this.safeSetState({status:Oa},function(){s.props.onEntering(f,d),s.onTransitionEnd(m,function(){s.safeSetState({status:cl},function(){s.props.onEntered(f,d)})})})},e.performExit=function(){var r=this,s=this.props.exit,a=this.getTimeouts(),l=this.props.nodeRef?void 0:dc.findDOMNode(this);if(!s||rO.disabled){this.safeSetState({status:lc},function(){r.props.onExited(l)});return}this.props.onExit(l),this.safeSetState({status:x0},function(){r.props.onExiting(l),r.onTransitionEnd(a.exit,function(){r.safeSetState({status:lc},function(){r.props.onExited(l)})})})},e.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},e.safeSetState=function(r,s){s=this.setNextCallback(s),this.setState(r,s)},e.setNextCallback=function(r){var s=this,a=!0;return this.nextCallback=function(l){a&&(a=!1,s.nextCallback=null,r(l))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},e.onTransitionEnd=function(r,s){this.setNextCallback(s);var a=this.props.nodeRef?this.props.nodeRef.current:dc.findDOMNode(this),l=r==null&&!this.props.addEndListener;if(!a||l){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var u=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],f=u[0],d=u[1];this.props.addEndListener(f,d)}r!=null&&setTimeout(this.nextCallback,r)},e.render=function(){var r=this.state.status;if(r===Lp)return null;var s=this.props,a=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var l=rk(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Je.createElement(lk.Provider,{value:null},typeof a=="function"?a(r,l):Je.cloneElement(Je.Children.only(a),l))},t}(Je.Component);Tl.contextType=lk;Tl.propTypes={};function jf(){}Tl.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:jf,onEntering:jf,onEntered:jf,onExit:jf,onExiting:jf,onExited:jf};Tl.UNMOUNTED=Lp;Tl.EXITED=lc;Tl.ENTERING=Oa;Tl.ENTERED=cl;Tl.EXITING=x0;function ck(n){return n.code==="Escape"||n.keyCode===27}function Rit(){const n=U.version.split(".");return{major:+n[0],minor:+n[1],patch:+n[2]}}function Vu(n){if(!n||typeof n=="function")return null;const{major:t}=Rit();return t>=19?n.props.ref:n.ref}const Cx=!!(typeof window<"u"&&window.document&&window.document.createElement);var dE=!1,hE=!1;try{var Ub={get passive(){return dE=!0},get once(){return hE=dE=!0}};Cx&&(window.addEventListener("test",Ub,Ub),window.removeEventListener("test",Ub,!0))}catch{}function uk(n,t,e,i){if(i&&typeof i!="boolean"&&!hE){var r=i.once,s=i.capture,a=e;!hE&&r&&(a=e.__once||function l(u){this.removeEventListener(t,l,s),e.call(this,u)},e.__once=a),n.addEventListener(t,a,dE?i:s)}n.addEventListener(t,e,i)}function Nit(n,t,e,i){var r=i&&typeof i!="boolean"?i.capture:i;n.removeEventListener(t,e,r),e.__once&&n.removeEventListener(t,e.__once,r)}function fl(n,t,e,i){return uk(n,t,e,i),function(){Nit(n,t,e,i)}}function Lit(n,t,e,i){if(i===void 0&&(i=!0),n){var r=document.createEvent("HTMLEvents");r.initEvent(t,e,i),n.dispatchEvent(r)}}function Iit(n){var t=vl(n,"transitionDuration")||"",e=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*e}function kit(n,t,e){e===void 0&&(e=5);var i=!1,r=setTimeout(function(){i||Lit(n,"transitionend",!0)},t+e),s=fl(n,"transitionend",function(){i=!0},{once:!0});return function(){clearTimeout(r),s()}}function Mit(n,t,e,i){e==null&&(e=Iit(n)||0);var r=kit(n,e,i),s=fl(n,"transitionend",t);return function(){r(),s()}}function sO(n,t){const e=vl(n,t)||"",i=e.indexOf("ms")===-1?1e3:1;return parseFloat(e)*i}function bA(n,t){const e=sO(n,"transitionDuration"),i=sO(n,"transitionDelay"),r=Mit(n,s=>{s.target===n&&(r(),t(s))},e+i)}function vp(...n){return n.filter(t=>t!=null).reduce((t,e)=>{if(typeof e!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return t===null?e:function(...r){t.apply(this,r),e.apply(this,r)}},null)}function fk(n){n.offsetHeight}const aO=n=>!n||typeof n=="function"?n:t=>{n.current=t};function Fit(n,t){const e=aO(n),i=aO(t);return r=>{e&&e(r),i&&i(r)}}function X0(n,t){return U.useMemo(()=>Fit(n,t),[n,t])}function D1(n){return n&&"setState"in n?dc.findDOMNode(n):n??null}const Dx=Je.forwardRef(({onEnter:n,onEntering:t,onEntered:e,onExit:i,onExiting:r,onExited:s,addEndListener:a,children:l,childRef:u,...f},d)=>{const p=U.useRef(null),m=X0(p,u),g=N=>{m(D1(N))},y=N=>D=>{N&&p.current&&N(p.current,D)},x=U.useCallback(y(n),[n]),_=U.useCallback(y(t),[t]),b=U.useCallback(y(e),[e]),S=U.useCallback(y(i),[i]),A=U.useCallback(y(r),[r]),C=U.useCallback(y(s),[s]),O=U.useCallback(y(a),[a]);return M.jsx(Tl,{ref:d,...f,onEnter:x,onEntered:b,onEntering:_,onExit:S,onExited:C,onExiting:A,addEndListener:O,nodeRef:p,children:typeof l=="function"?(N,D)=>l(N,{...D,ref:g}):Je.cloneElement(l,{ref:g})})});Dx.displayName="TransitionWrapper";const Pit={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function Bit(n,t){const e=`offset${n[0].toUpperCase()}${n.slice(1)}`,i=t[e],r=Pit[n];return i+parseInt(vl(t,r[0]),10)+parseInt(vl(t,r[1]),10)}const jit={[lc]:"collapse",[x0]:"collapsing",[Oa]:"collapsing",[cl]:"collapse show"},dk=Je.forwardRef(({onEnter:n,onEntering:t,onEntered:e,onExit:i,onExiting:r,className:s,children:a,dimension:l="height",in:u=!1,timeout:f=300,mountOnEnter:d=!1,unmountOnExit:p=!1,appear:m=!1,getDimensionValue:g=Bit,...y},x)=>{const _=typeof l=="function"?l():l,b=U.useMemo(()=>vp(N=>{N.style[_]="0"},n),[_,n]),S=U.useMemo(()=>vp(N=>{const D=`scroll${_[0].toUpperCase()}${_.slice(1)}`;N.style[_]=`${N[D]}px`},t),[_,t]),A=U.useMemo(()=>vp(N=>{N.style[_]=null},e),[_,e]),C=U.useMemo(()=>vp(N=>{N.style[_]=`${g(_,N)}px`,fk(N)},i),[i,g,_]),O=U.useMemo(()=>vp(N=>{N.style[_]=null},r),[_,r]);return M.jsx(Dx,{ref:x,addEndListener:bA,...y,"aria-expanded":y.role?u:null,onEnter:b,onEntering:S,onEntered:A,onExit:C,onExiting:O,childRef:Vu(a),in:u,timeout:f,mountOnEnter:d,unmountOnExit:p,appear:m,children:(N,D)=>Je.cloneElement(a,{...D,className:xe(s,a.props.className,jit[N],_==="width"&&"collapse-horizontal")})})});dk.displayName="Collapse";function Uit(n){const t=U.useRef(n);return U.useEffect(()=>{t.current=n},[n]),t}function Wu(n){const t=Uit(n);return U.useCallback(function(...e){return t.current&&t.current(...e)},[t])}const Ox=n=>U.forwardRef((t,e)=>M.jsx("div",{...t,ref:e,className:xe(t.className,n)})),hk=Ox("h4");hk.displayName="DivStyledAsH4";const pk=U.forwardRef(({className:n,bsPrefix:t,as:e=hk,...i},r)=>(t=Ae(t,"alert-heading"),M.jsx(e,{ref:r,className:xe(n,t),...i})));pk.displayName="AlertHeading";function pE(){return U.useState(null)}function zit(n){const t=U.useRef(n);return U.useEffect(()=>{t.current=n},[n]),t}function nr(n){const t=zit(n);return U.useCallback(function(...e){return t.current&&t.current(...e)},[t])}function Hit(n,t,e,i=!1){const r=nr(e);U.useEffect(()=>{const s=typeof n=="function"?n():n;return s.addEventListener(t,r,i),()=>s.removeEventListener(t,r,i)},[n])}function mk(){const n=U.useRef(!0),t=U.useRef(()=>n.current);return U.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),t.current}function gk(n){const t=U.useRef(null);return U.useEffect(()=>{t.current=n}),t.current}const $it=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",Git=typeof document<"u",oO=Git||$it?U.useLayoutEffect:U.useEffect,Vit=["as","disabled"];function Wit(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}function Xit(n){return!n||n.trim()==="#"}function wA({tagName:n,disabled:t,href:e,target:i,rel:r,role:s,onClick:a,tabIndex:l=0,type:u}){n||(e!=null||i!=null||r!=null?n="a":n="button");const f={tagName:n};if(n==="button")return[{type:u||"button",disabled:t},f];const d=m=>{if((t||n==="a"&&Xit(e))&&m.preventDefault(),t){m.stopPropagation();return}a?.(m)},p=m=>{m.key===" "&&(m.preventDefault(),d(m))};return n==="a"&&(e||(e="#"),t&&(e=void 0)),[{role:s??"button",disabled:void 0,tabIndex:t?void 0:l,href:e,target:n==="a"?i:void 0,"aria-disabled":t||void 0,rel:n==="a"?r:void 0,onClick:d,onKeyDown:p},f]}const EA=U.forwardRef((n,t)=>{let{as:e,disabled:i}=n,r=Wit(n,Vit);const[s,{tagName:a}]=wA(Object.assign({tagName:e,disabled:i},r));return M.jsx(a,Object.assign({},r,s,{ref:t}))});EA.displayName="Button";const Yit=["onKeyDown"];function qit(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}function Kit(n){return!n||n.trim()==="#"}const Rx=U.forwardRef((n,t)=>{let{onKeyDown:e}=n,i=qit(n,Yit);const[r]=wA(Object.assign({tagName:"a"},i)),s=nr(a=>{r.onKeyDown(a),e?.(a)});return Kit(i.href)||i.role==="button"?M.jsx("a",Object.assign({ref:t},i,r,{onKeyDown:s})):M.jsx("a",Object.assign({ref:t},i,{onKeyDown:e}))});Rx.displayName="Anchor";const vk=U.forwardRef(({className:n,bsPrefix:t,as:e=Rx,...i},r)=>(t=Ae(t,"alert-link"),M.jsx(e,{ref:r,className:xe(n,t),...i})));vk.displayName="AlertLink";const Zit={[Oa]:"show",[cl]:"show"},Ed=U.forwardRef(({className:n,children:t,transitionClasses:e={},onEnter:i,...r},s)=>{const a={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...r},l=U.useCallback((u,f)=>{fk(u),i?.(u,f)},[i]);return M.jsx(Dx,{ref:s,addEndListener:bA,...a,onEnter:l,childRef:Vu(t),children:(u,f)=>U.cloneElement(t,{...f,className:xe("fade",n,t.props.className,Zit[u],e[u])})})});Ed.displayName="Fade";const Qit={"aria-label":nn.string,onClick:nn.func,variant:nn.oneOf(["white"])},Nx=U.forwardRef(({className:n,variant:t,"aria-label":e="Close",...i},r)=>M.jsx("button",{ref:r,type:"button",className:xe("btn-close",t&&`btn-close-${t}`,n),"aria-label":e,...i}));Nx.displayName="CloseButton";Nx.propTypes=Qit;const xk=U.forwardRef((n,t)=>{const{bsPrefix:e,show:i=!0,closeLabel:r="Close alert",closeVariant:s,className:a,children:l,variant:u="primary",onClose:f,dismissible:d,transition:p=Ed,...m}=Tx(n,{show:"onClose"}),g=Ae(e,"alert"),y=Wu(b=>{f&&f(!1,b)}),x=p===!0?Ed:p,_=M.jsxs("div",{role:"alert",...x?void 0:m,ref:t,className:xe(a,g,u&&`${g}-${u}`,d&&`${g}-dismissible`),children:[d&&M.jsx(Nx,{onClick:y,"aria-label":r,variant:s}),l]});return x?M.jsx(x,{unmountOnExit:!0,...m,ref:void 0,in:i,children:_}):i?_:null});xk.displayName="Alert";const Jit=Object.assign(xk,{Link:vk,Heading:pk}),Ra=U.forwardRef(({as:n,bsPrefix:t,variant:e="primary",size:i,active:r=!1,disabled:s=!1,className:a,...l},u)=>{const f=Ae(t,"btn"),[d,{tagName:p}]=wA({tagName:n,disabled:s,...l}),m=p;return M.jsx(m,{...d,...l,ref:u,disabled:s,className:xe(a,f,r&&"active",e&&`${f}-${e}`,i&&`${f}-${i}`,l.href&&s&&"disabled")})});Ra.displayName="Button";const yk=U.forwardRef(({bsPrefix:n,size:t,vertical:e=!1,className:i,role:r="group",as:s="div",...a},l)=>{const u=Ae(n,"btn-group");let f=u;return e&&(f=`${u}-vertical`),M.jsx(s,{...a,ref:l,role:r,className:xe(i,f,t&&`${u}-${t}`)})});yk.displayName="ButtonGroup";const AA=U.forwardRef(({className:n,bsPrefix:t,as:e="div",...i},r)=>(t=Ae(t,"card-body"),M.jsx(e,{ref:r,className:xe(n,t),...i})));AA.displayName="CardBody";const _k=U.forwardRef(({className:n,bsPrefix:t,as:e="div",...i},r)=>(t=Ae(t,"card-footer"),M.jsx(e,{ref:r,className:xe(n,t),...i})));_k.displayName="CardFooter";const SA=U.createContext(null);SA.displayName="CardHeaderContext";const bk=U.forwardRef(({bsPrefix:n,className:t,as:e="div",...i},r)=>{const s=Ae(n,"card-header"),a=U.useMemo(()=>({cardHeaderBsPrefix:s}),[s]);return M.jsx(SA.Provider,{value:a,children:M.jsx(e,{ref:r,...i,className:xe(t,s)})})});bk.displayName="CardHeader";const wk=U.forwardRef(({bsPrefix:n,className:t,variant:e,as:i="img",...r},s)=>{const a=Ae(n,"card-img");return M.jsx(i,{ref:s,className:xe(e?`${a}-${e}`:a,t),...r})});wk.displayName="CardImg";const Ek=U.forwardRef(({className:n,bsPrefix:t,as:e="div",...i},r)=>(t=Ae(t,"card-img-overlay"),M.jsx(e,{ref:r,className:xe(n,t),...i})));Ek.displayName="CardImgOverlay";const Ak=U.forwardRef(({className:n,bsPrefix:t,as:e="a",...i},r)=>(t=Ae(t,"card-link"),M.jsx(e,{ref:r,className:xe(n,t),...i})));Ak.displayName="CardLink";const trt=Ox("h6"),Sk=U.forwardRef(({className:n,bsPrefix:t,as:e=trt,...i},r)=>(t=Ae(t,"card-subtitle"),M.jsx(e,{ref:r,className:xe(n,t),...i})));Sk.displayName="CardSubtitle";const Tk=U.forwardRef(({className:n,bsPrefix:t,as:e="p",...i},r)=>(t=Ae(t,"card-text"),M.jsx(e,{ref:r,className:xe(n,t),...i})));Tk.displayName="CardText";const ert=Ox("h5"),Ck=U.forwardRef(({className:n,bsPrefix:t,as:e=ert,...i},r)=>(t=Ae(t,"card-title"),M.jsx(e,{ref:r,className:xe(n,t),...i})));Ck.displayName="CardTitle";const Dk=U.forwardRef(({bsPrefix:n,className:t,bg:e,text:i,border:r,body:s=!1,children:a,as:l="div",...u},f)=>{const d=Ae(n,"card");return M.jsx(l,{ref:f,...u,className:xe(t,d,e&&`bg-${e}`,i&&`text-${i}`,r&&`border-${r}`),children:s?M.jsx(AA,{children:a}):a})});Dk.displayName="Card";const sl=Object.assign(Dk,{Img:wk,Title:Ck,Subtitle:Sk,Body:AA,Link:Ak,Text:Tk,Header:bk,Footer:_k,ImgOverlay:Ek});function nrt(){const n=U.useRef(!0),t=U.useRef(()=>n.current);return U.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),t.current}function irt(n){const t=U.useRef(n);return t.current=n,t}function rrt(n){const t=irt(n);U.useEffect(()=>()=>t.current(),[])}const mE=2**31-1;function Ok(n,t,e){const i=e-Date.now();n.current=i<=mE?setTimeout(t,i):setTimeout(()=>Ok(n,t,e),mE)}function srt(){const n=nrt(),t=U.useRef();return rrt(()=>clearTimeout(t.current)),U.useMemo(()=>{const e=()=>clearTimeout(t.current);function i(r,s=0){n()&&(e(),s<=mE?t.current=setTimeout(r,s):Ok(t,r,Date.now()+s))}return{set:i,clear:e,handleRef:t}},[])}function art(n,t){return U.Children.toArray(n).some(e=>U.isValidElement(e)&&e.type===t)}function ort({as:n,bsPrefix:t,className:e,...i}){t=Ae(t,"col");const r=ak(),s=ok(),a=[],l=[];return r.forEach(u=>{const f=i[u];delete i[u];let d,p,m;typeof f=="object"&&f!=null?{span:d,offset:p,order:m}=f:d=f;const g=u!==s?`-${u}`:"";d&&a.push(d===!0?`${t}${g}`:`${t}${g}-${d}`),m!=null&&l.push(`order${g}-${m}`),p!=null&&l.push(`offset${g}-${p}`)}),[{...i,className:xe(e,...a,...l)},{as:n,bsPrefix:t,spans:a}]}const ii=U.forwardRef((n,t)=>{const[{className:e,...i},{as:r="div",bsPrefix:s,spans:a}]=ort(n);return M.jsx(r,{...i,ref:t,className:xe(e,!a.length&&s)})});ii.displayName="Col";const Y0=U.forwardRef(({bsPrefix:n,fluid:t=!1,as:e="div",className:i,...r},s)=>{const a=Ae(n,"container"),l=typeof t=="string"?`-${t}`:"-fluid";return M.jsx(e,{ref:s,...r,className:xe(i,t?`${a}${l}`:a)})});Y0.displayName="Container";var lrt=Function.prototype.bind.call(Function.prototype.call,[].slice);function al(n,t){return lrt(n.querySelectorAll(t))}function crt(n,t,e){const i=U.useRef(n!==void 0),[r,s]=U.useState(t),a=n!==void 0,l=i.current;return i.current=a,!a&&l&&r!==t&&s(t),[a?n:r,U.useCallback((...u)=>{const[f,...d]=u;let p=e?.(f,...d);return s(f),p},[e])]}function Rk(){const[,n]=U.useReducer(t=>t+1,0);return n}const Lx=U.createContext(null);function urt(n){const t=mk();return[n[0],U.useCallback(e=>{if(t())return n[1](e)},[t,n[1]])]}const frt=A0({defaultModifiers:[YE,V1,$1,G1,qE,XE,KE,$E]}),drt=["enabled","placement","strategy","modifiers"];function hrt(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}const prt={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},mrt={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:n})=>()=>{const{reference:t,popper:e}=n.elements;if("removeAttribute"in t){const i=(t.getAttribute("aria-describedby")||"").split(",").filter(r=>r.trim()!==e.id);i.length?t.setAttribute("aria-describedby",i.join(",")):t.removeAttribute("aria-describedby")}},fn:({state:n})=>{var t;const{popper:e,reference:i}=n.elements,r=(t=e.getAttribute("role"))==null?void 0:t.toLowerCase();if(e.id&&r==="tooltip"&&"setAttribute"in i){const s=i.getAttribute("aria-describedby");if(s&&s.split(",").indexOf(e.id)!==-1)return;i.setAttribute("aria-describedby",s?`${s},${e.id}`:e.id)}}},grt=[];function Nk(n,t,e={}){let{enabled:i=!0,placement:r="bottom",strategy:s="absolute",modifiers:a=grt}=e,l=hrt(e,drt);const u=U.useRef(a),f=U.useRef(),d=U.useCallback(()=>{var _;(_=f.current)==null||_.update()},[]),p=U.useCallback(()=>{var _;(_=f.current)==null||_.forceUpdate()},[]),[m,g]=urt(U.useState({placement:r,update:d,forceUpdate:p,attributes:{},styles:{popper:{},arrow:{}}})),y=U.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:_})=>{const b={},S={};Object.keys(_.elements).forEach(A=>{b[A]=_.styles[A],S[A]=_.attributes[A]}),g({state:_,styles:b,attributes:S,update:d,forceUpdate:p,placement:_.placement})}}),[d,p,g]),x=U.useMemo(()=>(yu(u.current,a)||(u.current=a),u.current),[a]);return U.useEffect(()=>{!f.current||!i||f.current.setOptions({placement:r,strategy:s,modifiers:[...x,y,prt]})},[s,r,y,i,x]),U.useEffect(()=>{if(!(!i||n==null||t==null))return f.current=frt(n,t,Object.assign({},l,{placement:r,strategy:s,modifiers:[...x,mrt,y]})),()=>{f.current!=null&&(f.current.destroy(),f.current=void 0,g(_=>Object.assign({},_,{attributes:{},styles:{popper:{}}})))}},[i,n,t]),m}function y0(n,t){if(n.contains)return n.contains(t);if(n.compareDocumentPosition)return n===t||!!(n.compareDocumentPosition(t)&16)}const lO=()=>{};function vrt(n){return n.button===0}function xrt(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}const Vv=n=>n&&("current"in n?n.current:n),cO={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function Lk(n,t=lO,{disabled:e,clickTrigger:i="click"}={}){const r=U.useRef(!1),s=U.useRef(!1),a=U.useCallback(f=>{const d=Vv(n);tr(!!d,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),r.current=!d||xrt(f)||!vrt(f)||!!y0(d,f.target)||s.current,s.current=!1},[n]),l=nr(f=>{const d=Vv(n);d&&y0(d,f.target)?s.current=!0:s.current=!1}),u=nr(f=>{r.current||t(f)});U.useEffect(()=>{var f,d;if(e||n==null)return;const p=W0(Vv(n)),m=p.defaultView||window;let g=(f=m.event)!=null?f:(d=m.parent)==null?void 0:d.event,y=null;cO[i]&&(y=fl(p,cO[i],l,!0));const x=fl(p,i,a,!0),_=fl(p,i,S=>{if(S===g){g=void 0;return}u(S)});let b=[];return"ontouchstart"in p.documentElement&&(b=[].slice.call(p.body.children).map(S=>fl(S,"mousemove",lO))),()=>{y?.(),x(),_(),b.forEach(S=>S())}},[n,e,i,a,l,u])}function yrt(n){const t={};return Array.isArray(n)?(n?.forEach(e=>{t[e.name]=e}),t):n||t}function _rt(n={}){return Array.isArray(n)?n:Object.keys(n).map(t=>(n[t].name=t,n[t]))}function Ik({enabled:n,enableEvents:t,placement:e,flip:i,offset:r,fixed:s,containerPadding:a,arrowElement:l,popperConfig:u={}}){var f,d,p,m,g;const y=yrt(u.modifiers);return Object.assign({},u,{placement:e,enabled:n,strategy:s?"fixed":u.strategy,modifiers:_rt(Object.assign({},y,{eventListeners:{enabled:t,options:(f=y.eventListeners)==null?void 0:f.options},preventOverflow:Object.assign({},y.preventOverflow,{options:a?Object.assign({padding:a},(d=y.preventOverflow)==null?void 0:d.options):(p=y.preventOverflow)==null?void 0:p.options}),offset:{options:Object.assign({offset:r},(m=y.offset)==null?void 0:m.options)},arrow:Object.assign({},y.arrow,{enabled:!!l,options:Object.assign({},(g=y.arrow)==null?void 0:g.options,{element:l})}),flip:Object.assign({enabled:!!i},y.flip)}))})}const brt=["children","usePopper"];function wrt(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}const Ert=()=>{};function kk(n={}){const t=U.useContext(Lx),[e,i]=pE(),r=U.useRef(!1),{flip:s,offset:a,rootCloseEvent:l,fixed:u=!1,placement:f,popperConfig:d={},enableEventListeners:p=!0,usePopper:m=!!t}=n,g=t?.show==null?!!n.show:t.show;g&&!r.current&&(r.current=!0);const y=N=>{t?.toggle(!1,N)},{placement:x,setMenu:_,menuElement:b,toggleElement:S}=t||{},A=Nk(S,b,Ik({placement:f||x||"bottom-start",enabled:m,enableEvents:p??g,offset:a,flip:s,fixed:u,arrowElement:e,popperConfig:d})),C=Object.assign({ref:_||Ert,"aria-labelledby":S?.id},A.attributes.popper,{style:A.styles.popper}),O={show:g,placement:x,hasShown:r.current,toggle:t?.toggle,popper:m?A:null,arrowProps:m?Object.assign({ref:i},A.attributes.arrow,{style:A.styles.arrow}):{}};return Lk(b,y,{clickTrigger:l,disabled:!g}),[C,O]}function Mk(n){let{children:t,usePopper:e=!0}=n,i=wrt(n,brt);const[r,s]=kk(Object.assign({},i,{usePopper:e}));return M.jsx(M.Fragment,{children:t(r,s)})}Mk.displayName="DropdownMenu";const Fk={prefix:String(Math.round(Math.random()*1e10)),current:0},Pk=Je.createContext(Fk),Art=Je.createContext(!1);let zb=new WeakMap;function Srt(n=!1){let t=U.useContext(Pk),e=U.useRef(null);if(e.current===null&&!n){var i,r;let s=(r=Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||r===void 0||(i=r.ReactCurrentOwner)===null||i===void 0?void 0:i.current;if(s){let a=zb.get(s);a==null?zb.set(s,{id:t.current,state:s.memoizedState}):s.memoizedState!==a.state&&(t.current=a.id,zb.delete(s))}e.current=++t.current}return e.current}function Trt(n){let t=U.useContext(Pk),e=Srt(!!n),i=`react-aria${t.prefix}`;return n||`${i}-${e}`}function Crt(n){let t=Je.useId(),[e]=U.useState(Lrt()),i=e?"react-aria":`react-aria${Fk.prefix}`;return n||`${i}-${t}`}const Drt=typeof Je.useId=="function"?Crt:Trt;function Ort(){return!1}function Rrt(){return!0}function Nrt(n){return()=>{}}function Lrt(){return typeof Je.useSyncExternalStore=="function"?Je.useSyncExternalStore(Nrt,Ort,Rrt):U.useContext(Art)}const Bk=n=>{var t;return((t=n.getAttribute("role"))==null?void 0:t.toLowerCase())==="menu"},uO=()=>{};function jk(){const n=Drt(),{show:t=!1,toggle:e=uO,setToggle:i,menuElement:r}=U.useContext(Lx)||{},s=U.useCallback(l=>{e(!t,l)},[t,e]),a={id:n,ref:i||uO,onClick:s,"aria-expanded":!!t};return r&&Bk(r)&&(a["aria-haspopup"]=!0),[a,{show:t,toggle:e}]}function Uk({children:n}){const[t,e]=jk();return M.jsx(M.Fragment,{children:n(t,e)})}Uk.displayName="DropdownToggle";const Iu=U.createContext(null),_0=(n,t=null)=>n!=null?String(n):t||null,Ix=U.createContext(null);Ix.displayName="NavContext";const Irt="data-rr-ui-",krt="rrUi";function Bd(n){return`${Irt}${n}`}function Mrt(n){return`${krt}${n}`}const Frt=["eventKey","disabled","onClick","active","as"];function Prt(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}function zk({key:n,href:t,active:e,disabled:i,onClick:r}){const s=U.useContext(Iu),a=U.useContext(Ix),{activeKey:l}=a||{},u=_0(n,t),f=e==null&&n!=null?_0(l)===u:e;return[{onClick:nr(p=>{i||(r?.(p),s&&!p.isPropagationStopped()&&s(u,p))}),"aria-disabled":i||void 0,"aria-selected":f,[Bd("dropdown-item")]:""},{isActive:f}]}const Hk=U.forwardRef((n,t)=>{let{eventKey:e,disabled:i,onClick:r,active:s,as:a=EA}=n,l=Prt(n,Frt);const[u]=zk({key:e,href:l.href,disabled:i,onClick:r,active:s});return M.jsx(a,Object.assign({},l,{ref:t},u))});Hk.displayName="DropdownItem";const $k=U.createContext(Cx?window:void 0);$k.Provider;function kx(){return U.useContext($k)}function fO(){const n=Rk(),t=U.useRef(null),e=U.useCallback(i=>{t.current=i,n()},[n]);return[t,e]}function q0({defaultShow:n,show:t,onSelect:e,onToggle:i,itemSelector:r=`* [${Bd("dropdown-item")}]`,focusFirstItemOnShow:s,placement:a="bottom-start",children:l}){const u=kx(),[f,d]=crt(t,n,i),[p,m]=fO(),g=p.current,[y,x]=fO(),_=y.current,b=gk(f),S=U.useRef(null),A=U.useRef(!1),C=U.useContext(Iu),O=U.useCallback((j,B,tt=B?.type)=>{d(j,{originalEvent:B,source:tt})},[d]),N=nr((j,B)=>{e?.(j,B),O(!1,B,"select"),B.isPropagationStopped()||C?.(j,B)}),D=U.useMemo(()=>({toggle:O,placement:a,show:f,menuElement:g,toggleElement:_,setMenu:m,setToggle:x}),[O,a,f,g,_,m,x]);g&&b&&!f&&(A.current=g.contains(g.ownerDocument.activeElement));const L=nr(()=>{_&&_.focus&&_.focus()}),I=nr(()=>{const j=S.current;let B=s;if(B==null&&(B=p.current&&Bk(p.current)?"keyboard":!1),B===!1||B==="keyboard"&&!/^key.+$/.test(j))return;const tt=al(p.current,r)[0];tt&&tt.focus&&tt.focus()});U.useEffect(()=>{f?I():A.current&&(A.current=!1,L())},[f,A,L,I]),U.useEffect(()=>{S.current=null});const z=(j,B)=>{if(!p.current)return null;const tt=al(p.current,r);let k=tt.indexOf(j)+B;return k=Math.max(0,Math.min(k,tt.length)),tt[k]};return Hit(U.useCallback(()=>u.document,[u]),"keydown",j=>{var B,tt;const{key:k}=j,et=j.target,K=(B=p.current)==null?void 0:B.contains(et),q=(tt=y.current)==null?void 0:tt.contains(et);if(/input|textarea/i.test(et.tagName)&&(k===" "||k!=="Escape"&&K||k==="Escape"&&et.type==="search")||!K&&!q||k==="Tab"&&(!p.current||!f))return;S.current=j.type;const at={originalEvent:j,source:j.type};switch(k){case"ArrowUp":{const P=z(et,-1);P&&P.focus&&P.focus(),j.preventDefault();return}case"ArrowDown":if(j.preventDefault(),!f)d(!0,at);else{const P=z(et,1);P&&P.focus&&P.focus()}return;case"Tab":uk(et.ownerDocument,"keyup",P=>{var X;(P.key==="Tab"&&!P.target||!((X=p.current)!=null&&X.contains(P.target)))&&d(!1,at)},{once:!0});break;case"Escape":k==="Escape"&&(j.preventDefault(),j.stopPropagation()),d(!1,at);break}}),M.jsx(Iu.Provider,{value:N,children:M.jsx(Lx.Provider,{value:D,children:l})})}q0.displayName="Dropdown";q0.Menu=Mk;q0.Toggle=Uk;q0.Item=Hk;const TA=U.createContext({});TA.displayName="DropdownContext";const Gk=U.forwardRef(({className:n,bsPrefix:t,as:e="hr",role:i="separator",...r},s)=>(t=Ae(t,"dropdown-divider"),M.jsx(e,{ref:s,className:xe(n,t),role:i,...r})));Gk.displayName="DropdownDivider";const Vk=U.forwardRef(({className:n,bsPrefix:t,as:e="div",role:i="heading",...r},s)=>(t=Ae(t,"dropdown-header"),M.jsx(e,{ref:s,className:xe(n,t),role:i,...r})));Vk.displayName="DropdownHeader";const Wk=U.forwardRef(({bsPrefix:n,className:t,eventKey:e,disabled:i=!1,onClick:r,active:s,as:a=Rx,...l},u)=>{const f=Ae(n,"dropdown-item"),[d,p]=zk({key:e,href:l.href,disabled:i,onClick:r,active:s});return M.jsx(a,{...l,...d,ref:u,className:xe(t,f,p.isActive&&"active",i&&"disabled")})});Wk.displayName="DropdownItem";const Xk=U.forwardRef(({className:n,bsPrefix:t,as:e="span",...i},r)=>(t=Ae(t,"dropdown-item-text"),M.jsx(e,{ref:r,className:xe(n,t),...i})));Xk.displayName="DropdownItemText";const Brt=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",jrt=typeof document<"u",CA=jrt||Brt?U.useLayoutEffect:U.useEffect,DA=U.createContext(null);DA.displayName="InputGroupContext";const Xu=U.createContext(null);Xu.displayName="NavbarContext";function Yk(n,t){return n}function qk(n,t,e){const i=e?"top-end":"top-start",r=e?"top-start":"top-end",s=e?"bottom-end":"bottom-start",a=e?"bottom-start":"bottom-end",l=e?"right-start":"left-start",u=e?"right-end":"left-end",f=e?"left-start":"right-start",d=e?"left-end":"right-end";let p=n?a:s;return t==="up"?p=n?r:i:t==="end"?p=n?d:f:t==="start"?p=n?u:l:t==="down-centered"?p="bottom":t==="up-centered"&&(p="top"),p}const Kk=U.forwardRef(({bsPrefix:n,className:t,align:e,rootCloseEvent:i,flip:r=!0,show:s,renderOnMount:a,as:l="div",popperConfig:u,variant:f,...d},p)=>{let m=!1;const g=U.useContext(Xu),y=Ae(n,"dropdown-menu"),{align:x,drop:_,isRTL:b}=U.useContext(TA);e=e||x;const S=U.useContext(DA),A=[];if(e)if(typeof e=="object"){const j=Object.keys(e);if(j.length){const B=j[0],tt=e[B];m=tt==="start",A.push(`${y}-${B}-${tt}`)}}else e==="end"&&(m=!0);const C=qk(m,_,b),[O,{hasShown:N,popper:D,show:L,toggle:I}]=kk({flip:r,rootCloseEvent:i,show:s,usePopper:!g&&A.length===0,offset:[0,2],popperConfig:u,placement:C});if(O.ref=X0(Yk(p),O.ref),CA(()=>{L&&D?.update()},[L]),!N&&!a&&!S)return null;typeof l!="string"&&(O.show=L,O.close=()=>I?.(!1),O.align=e);let z=d.style;return D!=null&&D.placement&&(z={...d.style,...O.style},d["x-placement"]=D.placement),M.jsx(l,{...d,...O,style:z,...(A.length||g)&&{"data-bs-popper":"static"},className:xe(t,y,L&&"show",m&&`${y}-end`,f&&`${y}-${f}`,...A)})});Kk.displayName="DropdownMenu";const Zk=U.forwardRef(({bsPrefix:n,split:t,className:e,childBsPrefix:i,as:r=Ra,...s},a)=>{const l=Ae(n,"dropdown-toggle"),u=U.useContext(Lx);i!==void 0&&(s.bsPrefix=i);const[f]=jk();return f.ref=X0(f.ref,Yk(a)),M.jsx(r,{className:xe(e,l,t&&`${l}-split`,u?.show&&"show"),...f,...s})});Zk.displayName="DropdownToggle";const Qk=U.forwardRef((n,t)=>{const{bsPrefix:e,drop:i="down",show:r,className:s,align:a="start",onSelect:l,onToggle:u,focusFirstItemOnShow:f,as:d="div",navbar:p,autoClose:m=!0,...g}=Tx(n,{show:"onToggle"}),y=U.useContext(DA),x=Ae(e,"dropdown"),_=_A(),b=D=>m===!1?D==="click":m==="inside"?D!=="rootClose":m==="outside"?D!=="select":!0,S=Wu((D,L)=>{var I;!((I=L.originalEvent)==null||(I=I.target)==null)&&I.classList.contains("dropdown-toggle")&&L.source==="mousedown"||(L.originalEvent.currentTarget===document&&(L.source!=="keydown"||L.originalEvent.key==="Escape")&&(L.source="rootClose"),b(L.source)&&u?.(D,L))}),C=qk(a==="end",i,_),O=U.useMemo(()=>({align:a,drop:i,isRTL:_}),[a,i,_]),N={down:x,"down-centered":`${x}-center`,up:"dropup","up-centered":"dropup-center dropup",end:"dropend",start:"dropstart"};return M.jsx(TA.Provider,{value:O,children:M.jsx(q0,{placement:C,show:r,onSelect:l,onToggle:S,focusFirstItemOnShow:f,itemSelector:`.${x}-item:not(.disabled):not(:disabled)`,children:y?g.children:M.jsx(d,{...g,ref:t,className:xe(s,r&&"show",N[i])})})})});Qk.displayName="Dropdown";const pu=Object.assign(Qk,{Toggle:Zk,Menu:Kk,Item:Wk,ItemText:Xk,Divider:Gk,Header:Vk}),Urt={type:nn.string,tooltip:nn.bool,as:nn.elementType},Mx=U.forwardRef(({as:n="div",className:t,type:e="valid",tooltip:i=!1,...r},s)=>M.jsx(n,{...r,ref:s,className:xe(t,`${e}-${i?"tooltip":"feedback"}`)}));Mx.displayName="Feedback";Mx.propTypes=Urt;const El=U.createContext({}),OA=U.forwardRef(({id:n,bsPrefix:t,className:e,type:i="checkbox",isValid:r=!1,isInvalid:s=!1,as:a="input",...l},u)=>{const{controlId:f}=U.useContext(El);return t=Ae(t,"form-check-input"),M.jsx(a,{...l,ref:u,type:i,id:n||f,className:xe(e,t,r&&"is-valid",s&&"is-invalid")})});OA.displayName="FormCheckInput";const O1=U.forwardRef(({bsPrefix:n,className:t,htmlFor:e,...i},r)=>{const{controlId:s}=U.useContext(El);return n=Ae(n,"form-check-label"),M.jsx("label",{...i,ref:r,htmlFor:e||s,className:xe(t,n)})});O1.displayName="FormCheckLabel";const Jk=U.forwardRef(({id:n,bsPrefix:t,bsSwitchPrefix:e,inline:i=!1,reverse:r=!1,disabled:s=!1,isValid:a=!1,isInvalid:l=!1,feedbackTooltip:u=!1,feedback:f,feedbackType:d,className:p,style:m,title:g="",type:y="checkbox",label:x,children:_,as:b="input",...S},A)=>{t=Ae(t,"form-check"),e=Ae(e,"form-switch");const{controlId:C}=U.useContext(El),O=U.useMemo(()=>({controlId:n||C}),[C,n]),N=!_&&x!=null&&x!==!1||art(_,O1),D=M.jsx(OA,{...S,type:y==="switch"?"checkbox":y,ref:A,isValid:a,isInvalid:l,disabled:s,as:b});return M.jsx(El.Provider,{value:O,children:M.jsx("div",{style:m,className:xe(p,N&&t,i&&`${t}-inline`,r&&`${t}-reverse`,y==="switch"&&e),children:_||M.jsxs(M.Fragment,{children:[D,N&&M.jsx(O1,{title:g,children:x}),f&&M.jsx(Mx,{type:d,tooltip:u,children:f})]})})})});Jk.displayName="FormCheck";const R1=Object.assign(Jk,{Input:OA,Label:O1}),t6=U.forwardRef(({bsPrefix:n,type:t,size:e,htmlSize:i,id:r,className:s,isValid:a=!1,isInvalid:l=!1,plaintext:u,readOnly:f,as:d="input",...p},m)=>{const{controlId:g}=U.useContext(El);return n=Ae(n,"form-control"),M.jsx(d,{...p,type:t,size:i,ref:m,readOnly:f,id:r||g,className:xe(s,u?`${n}-plaintext`:n,e&&`${n}-${e}`,t==="color"&&`${n}-color`,a&&"is-valid",l&&"is-invalid")})});t6.displayName="FormControl";const zrt=Object.assign(t6,{Feedback:Mx}),e6=U.forwardRef(({className:n,bsPrefix:t,as:e="div",...i},r)=>(t=Ae(t,"form-floating"),M.jsx(e,{ref:r,className:xe(n,t),...i})));e6.displayName="FormFloating";const RA=U.forwardRef(({controlId:n,as:t="div",...e},i)=>{const r=U.useMemo(()=>({controlId:n}),[n]);return M.jsx(El.Provider,{value:r,children:M.jsx(t,{...e,ref:i})})});RA.displayName="FormGroup";const n6=U.forwardRef(({as:n="label",bsPrefix:t,column:e=!1,visuallyHidden:i=!1,className:r,htmlFor:s,...a},l)=>{const{controlId:u}=U.useContext(El);t=Ae(t,"form-label");let f="col-form-label";typeof e=="string"&&(f=`${f} ${f}-${e}`);const d=xe(r,t,i&&"visually-hidden",e&&f);return s=s||u,e?M.jsx(ii,{ref:l,as:"label",className:d,htmlFor:s,...a}):M.jsx(n,{ref:l,className:d,htmlFor:s,...a})});n6.displayName="FormLabel";const i6=U.forwardRef(({bsPrefix:n,className:t,id:e,...i},r)=>{const{controlId:s}=U.useContext(El);return n=Ae(n,"form-range"),M.jsx("input",{...i,type:"range",ref:r,className:xe(t,n),id:e||s})});i6.displayName="FormRange";const r6=U.forwardRef(({bsPrefix:n,size:t,htmlSize:e,className:i,isValid:r=!1,isInvalid:s=!1,id:a,...l},u)=>{const{controlId:f}=U.useContext(El);return n=Ae(n,"form-select"),M.jsx("select",{...l,size:e,ref:u,className:xe(i,n,t&&`${n}-${t}`,r&&"is-valid",s&&"is-invalid"),id:a||f})});r6.displayName="FormSelect";const s6=U.forwardRef(({bsPrefix:n,className:t,as:e="small",muted:i,...r},s)=>(n=Ae(n,"form-text"),M.jsx(e,{...r,ref:s,className:xe(t,n,i&&"text-muted")})));s6.displayName="FormText";const a6=U.forwardRef((n,t)=>M.jsx(R1,{...n,ref:t,type:"switch"}));a6.displayName="Switch";const Hrt=Object.assign(a6,{Input:R1.Input,Label:R1.Label}),o6=U.forwardRef(({bsPrefix:n,className:t,children:e,controlId:i,label:r,...s},a)=>(n=Ae(n,"form-floating"),M.jsxs(RA,{ref:a,className:xe(t,n),controlId:i,...s,children:[e,M.jsx("label",{htmlFor:i,children:r})]})));o6.displayName="FloatingLabel";const $rt={_ref:nn.any,validated:nn.bool,as:nn.elementType},NA=U.forwardRef(({className:n,validated:t,as:e="form",...i},r)=>M.jsx(e,{...i,ref:r,className:xe(n,t&&"was-validated")}));NA.displayName="Form";NA.propTypes=$rt;const As=Object.assign(NA,{Group:RA,Control:zrt,Floating:e6,Check:R1,Switch:Hrt,Label:n6,Text:s6,Range:i6,Select:r6,FloatingLabel:o6}),dO=n=>!n||typeof n=="function"?n:t=>{n.current=t};function Grt(n,t){const e=dO(n),i=dO(t);return r=>{e&&e(r),i&&i(r)}}function K0(n,t){return U.useMemo(()=>Grt(n,t),[n,t])}const l6=U.createContext(null),Vrt=["as","active","eventKey"];function Wrt(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}function c6({key:n,onClick:t,active:e,id:i,role:r,disabled:s}){const a=U.useContext(Iu),l=U.useContext(Ix),u=U.useContext(l6);let f=e;const d={role:r};if(l){!r&&l.role==="tablist"&&(d.role="tab");const p=l.getControllerId(n??null),m=l.getControlledId(n??null);d[Bd("event-key")]=n,d.id=p||i,f=e==null&&n!=null?l.activeKey===n:e,(f||!(u!=null&&u.unmountOnExit)&&!(u!=null&&u.mountOnEnter))&&(d["aria-controls"]=m)}return d.role==="tab"&&(d["aria-selected"]=f,f||(d.tabIndex=-1),s&&(d.tabIndex=-1,d["aria-disabled"]=!0)),d.onClick=nr(p=>{s||(t?.(p),n!=null&&a&&!p.isPropagationStopped()&&a(n,p))}),[d,{isActive:f}]}const u6=U.forwardRef((n,t)=>{let{as:e=EA,active:i,eventKey:r}=n,s=Wrt(n,Vrt);const[a,l]=c6(Object.assign({key:_0(r,s.href),active:i},s));return a[Bd("active")]=l.isActive,M.jsx(e,Object.assign({},s,a,{ref:t}))});u6.displayName="NavItem";const Xrt=["as","onSelect","activeKey","role","onKeyDown"];function Yrt(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}const hO=()=>{},pO=Bd("event-key"),f6=U.forwardRef((n,t)=>{let{as:e="div",onSelect:i,activeKey:r,role:s,onKeyDown:a}=n,l=Yrt(n,Xrt);const u=Rk(),f=U.useRef(!1),d=U.useContext(Iu),p=U.useContext(l6);let m,g;p&&(s=s||"tablist",r=p.activeKey,m=p.getControlledId,g=p.getControllerId);const y=U.useRef(null),x=A=>{const C=y.current;if(!C)return null;const O=al(C,`[${pO}]:not([aria-disabled=true])`),N=C.querySelector("[aria-selected=true]");if(!N||N!==document.activeElement)return null;const D=O.indexOf(N);if(D===-1)return null;let L=D+A;return L>=O.length&&(L=0),L<0&&(L=O.length-1),O[L]},_=(A,C)=>{A!=null&&(i?.(A,C),d?.(A,C))},b=A=>{if(a?.(A),!p)return;let C;switch(A.key){case"ArrowLeft":case"ArrowUp":C=x(-1);break;case"ArrowRight":case"ArrowDown":C=x(1);break;default:return}C&&(A.preventDefault(),_(C.dataset[Mrt("EventKey")]||null,A),f.current=!0,u())};U.useEffect(()=>{if(y.current&&f.current){const A=y.current.querySelector(`[${pO}][aria-selected=true]`);A?.focus()}f.current=!1});const S=K0(t,y);return M.jsx(Iu.Provider,{value:_,children:M.jsx(Ix.Provider,{value:{role:s,activeKey:_0(r),getControlledId:m||hO,getControllerId:g||hO},children:M.jsx(e,Object.assign({},l,{onKeyDown:b,ref:S,role:s}))})})});f6.displayName="Nav";const qrt=Object.assign(f6,{Item:u6});function Hb(n){n===void 0&&(n=W0());try{var t=n.activeElement;return!t||!t.nodeName?null:t}catch{return n.body}}function Krt(n){const t=U.useRef(n);return t.current=n,t}function Zrt(n){const t=Krt(n);U.useEffect(()=>()=>t.current(),[])}function Qrt(n=document){const t=n.defaultView;return Math.abs(t.innerWidth-n.documentElement.clientWidth)}const mO=Bd("modal-open");class LA{constructor({ownerDocument:t,handleContainerOverflow:e=!0,isRTL:i=!1}={}){this.handleContainerOverflow=e,this.isRTL=i,this.modals=[],this.ownerDocument=t}getScrollbarWidth(){return Qrt(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(t){}removeModalAttributes(t){}setContainerStyle(t){const e={overflow:"hidden"},i=this.isRTL?"paddingLeft":"paddingRight",r=this.getElement();t.style={overflow:r.style.overflow,[i]:r.style[i]},t.scrollBarWidth&&(e[i]=`${parseInt(vl(r,i)||"0",10)+t.scrollBarWidth}px`),r.setAttribute(mO,""),vl(r,e)}reset(){[...this.modals].forEach(t=>this.remove(t))}removeContainerStyle(t){const e=this.getElement();e.removeAttribute(mO),Object.assign(e.style,t.style)}add(t){let e=this.modals.indexOf(t);return e!==-1||(e=this.modals.length,this.modals.push(t),this.setModalAttributes(t),e!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),e}remove(t){const e=this.modals.indexOf(t);e!==-1&&(this.modals.splice(e,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(t))}isTopModal(t){return!!this.modals.length&&this.modals[this.modals.length-1]===t}}const $b=(n,t)=>Cx?n==null?(t||W0()).body:(typeof n=="function"&&(n=n()),n&&"current"in n&&(n=n.current),n&&("nodeType"in n||n.getBoundingClientRect)?n:null):null;function gE(n,t){const e=kx(),[i,r]=U.useState(()=>$b(n,e?.document));if(!i){const s=$b(n);s&&r(s)}return U.useEffect(()=>{},[t,i]),U.useEffect(()=>{const s=$b(n);s!==i&&r(s)},[n,i]),i}function Jrt({children:n,in:t,onExited:e,mountOnEnter:i,unmountOnExit:r}){const s=U.useRef(null),a=U.useRef(t),l=nr(e);U.useEffect(()=>{t?a.current=!0:l(s.current)},[t,l]);const u=K0(s,Vu(n)),f=U.cloneElement(n,{ref:u});return t?f:r||!a.current&&i?null:f}const tst=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function est(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}function nst(n){let{onEnter:t,onEntering:e,onEntered:i,onExit:r,onExiting:s,onExited:a,addEndListener:l,children:u}=n,f=est(n,tst);const d=U.useRef(null),p=K0(d,Vu(u)),m=C=>O=>{C&&d.current&&C(d.current,O)},g=U.useCallback(m(t),[t]),y=U.useCallback(m(e),[e]),x=U.useCallback(m(i),[i]),_=U.useCallback(m(r),[r]),b=U.useCallback(m(s),[s]),S=U.useCallback(m(a),[a]),A=U.useCallback(m(l),[l]);return Object.assign({},f,{nodeRef:d},t&&{onEnter:g},e&&{onEntering:y},i&&{onEntered:x},r&&{onExit:_},s&&{onExiting:b},a&&{onExited:S},l&&{addEndListener:A},{children:typeof u=="function"?(C,O)=>u(C,Object.assign({},O,{ref:p})):U.cloneElement(u,{ref:p})})}const ist=["component"];function rst(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}const sst=U.forwardRef((n,t)=>{let{component:e}=n,i=rst(n,ist);const r=nst(i);return M.jsx(e,Object.assign({ref:t},r))});function ast({in:n,onTransition:t}){const e=U.useRef(null),i=U.useRef(!0),r=nr(t);return oO(()=>{if(!e.current)return;let s=!1;return r({in:n,element:e.current,initial:i.current,isStale:()=>s}),()=>{s=!0}},[n,r]),oO(()=>(i.current=!1,()=>{i.current=!0}),[]),e}function ost({children:n,in:t,onExited:e,onEntered:i,transition:r}){const[s,a]=U.useState(!t);t&&s&&a(!1);const l=ast({in:!!t,onTransition:f=>{const d=()=>{f.isStale()||(f.in?i?.(f.element,f.initial):(a(!0),e?.(f.element)))};Promise.resolve(r(f)).then(d,p=>{throw f.in||a(!0),p})}}),u=K0(l,Vu(n));return s&&!t?null:U.cloneElement(n,{ref:u})}function vE(n,t,e){return n?M.jsx(sst,Object.assign({},e,{component:n})):t?M.jsx(ost,Object.assign({},e,{transition:t})):M.jsx(Jrt,Object.assign({},e))}const lst=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function cst(n,t){if(n==null)return{};var e={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(t.indexOf(i)>=0)continue;e[i]=n[i]}return e}let Gb;function ust(n){return Gb||(Gb=new LA({ownerDocument:n?.document})),Gb}function fst(n){const t=kx(),e=n||ust(t),i=U.useRef({dialog:null,backdrop:null});return Object.assign(i.current,{add:()=>e.add(i.current),remove:()=>e.remove(i.current),isTopModal:()=>e.isTopModal(i.current),setDialogRef:U.useCallback(r=>{i.current.dialog=r},[]),setBackdropRef:U.useCallback(r=>{i.current.backdrop=r},[])})}const d6=U.forwardRef((n,t)=>{let{show:e=!1,role:i="dialog",className:r,style:s,children:a,backdrop:l=!0,keyboard:u=!0,onBackdropClick:f,onEscapeKeyDown:d,transition:p,runTransition:m,backdropTransition:g,runBackdropTransition:y,autoFocus:x=!0,enforceFocus:_=!0,restoreFocus:b=!0,restoreFocusOptions:S,renderDialog:A,renderBackdrop:C=mt=>M.jsx("div",Object.assign({},mt)),manager:O,container:N,onShow:D,onHide:L=()=>{},onExit:I,onExited:z,onExiting:j,onEnter:B,onEntering:tt,onEntered:k}=n,et=cst(n,lst);const K=kx(),q=gE(N),_t=fst(O),at=mk(),P=gk(e),[X,V]=U.useState(!e),it=U.useRef(null);U.useImperativeHandle(t,()=>_t,[_t]),Cx&&!P&&e&&(it.current=Hb(K?.document)),e&&X&&V(!1);const ht=nr(()=>{if(_t.add(),rt.current=fl(document,"keydown",G),lt.current=fl(document,"focus",()=>setTimeout(Rt),!0),D&&D(),x){var mt,ut;const J=Hb((mt=(ut=_t.dialog)==null?void 0:ut.ownerDocument)!=null?mt:K?.document);_t.dialog&&J&&!y0(_t.dialog,J)&&(it.current=J,_t.dialog.focus())}}),yt=nr(()=>{if(_t.remove(),rt.current==null||rt.current(),lt.current==null||lt.current(),b){var mt;(mt=it.current)==null||mt.focus==null||mt.focus(S),it.current=null}});U.useEffect(()=>{!e||!q||ht()},[e,q,ht]),U.useEffect(()=>{X&&yt()},[X,yt]),Zrt(()=>{yt()});const Rt=nr(()=>{if(!_||!at()||!_t.isTopModal())return;const mt=Hb(K?.document);_t.dialog&&mt&&!y0(_t.dialog,mt)&&_t.dialog.focus()}),Et=nr(mt=>{mt.target===mt.currentTarget&&(f?.(mt),l===!0&&L())}),G=nr(mt=>{u&&ck(mt)&&_t.isTopModal()&&(d?.(mt),mt.defaultPrevented||L())}),lt=U.useRef(),rt=U.useRef(),ot=(...mt)=>{V(!0),z?.(...mt)};if(!q)return null;const bt=Object.assign({role:i,ref:_t.setDialogRef,"aria-modal":i==="dialog"?!0:void 0},et,{style:s,className:r,tabIndex:-1});let St=A?A(bt):M.jsx("div",Object.assign({},bt,{children:U.cloneElement(a,{role:"document"})}));St=vE(p,m,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!e,onExit:I,onExiting:j,onExited:ot,onEnter:B,onEntering:tt,onEntered:k,children:St});let R=null;return l&&(R=C({ref:_t.setBackdropRef,onClick:Et}),R=vE(g,y,{in:!!e,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:R})),M.jsx(M.Fragment,{children:dc.createPortal(M.jsxs(M.Fragment,{children:[R,St]}),q)})});d6.displayName="Modal";const dst=Object.assign(d6,{Manager:LA});function xE(n,t){return n.classList?!!t&&n.classList.contains(t):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+t+" ")!==-1}function hst(n,t){n.classList?n.classList.add(t):xE(n,t)||(typeof n.className=="string"?n.className=n.className+" "+t:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+t))}function gO(n,t){return n.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function pst(n,t){n.classList?n.classList.remove(t):typeof n.className=="string"?n.className=gO(n.className,t):n.setAttribute("class",gO(n.className&&n.className.baseVal||"",t))}const Uf={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class h6 extends LA{adjustAndStore(t,e,i){const r=e.style[t];e.dataset[t]=r,vl(e,{[t]:`${parseFloat(vl(e,t))+i}px`})}restore(t,e){const i=e.dataset[t];i!==void 0&&(delete e.dataset[t],vl(e,{[t]:i}))}setContainerStyle(t){super.setContainerStyle(t);const e=this.getElement();if(hst(e,"modal-open"),!t.scrollBarWidth)return;const i=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";al(e,Uf.FIXED_CONTENT).forEach(s=>this.adjustAndStore(i,s,t.scrollBarWidth)),al(e,Uf.STICKY_CONTENT).forEach(s=>this.adjustAndStore(r,s,-t.scrollBarWidth)),al(e,Uf.NAVBAR_TOGGLER).forEach(s=>this.adjustAndStore(r,s,t.scrollBarWidth))}removeContainerStyle(t){super.removeContainerStyle(t);const e=this.getElement();pst(e,"modal-open");const i=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";al(e,Uf.FIXED_CONTENT).forEach(s=>this.restore(i,s)),al(e,Uf.STICKY_CONTENT).forEach(s=>this.restore(r,s)),al(e,Uf.NAVBAR_TOGGLER).forEach(s=>this.restore(r,s))}}let Vb;function mst(n){return Vb||(Vb=new h6(n)),Vb}const p6=U.createContext({onHide(){}}),m6=U.forwardRef(({closeLabel:n="Close",closeVariant:t,closeButton:e=!1,onHide:i,children:r,...s},a)=>{const l=U.useContext(p6),u=Wu(()=>{l?.onHide(),i?.()});return M.jsxs("div",{ref:a,...s,children:[r,e&&M.jsx(Nx,{"aria-label":n,variant:t,onClick:u})]})});m6.displayName="AbstractModalHeader";const g6=U.forwardRef(({className:n,bsPrefix:t,as:e="div",...i},r)=>(t=Ae(t,"nav-item"),M.jsx(e,{ref:r,className:xe(n,t),...i})));g6.displayName="NavItem";const IA=U.forwardRef(({bsPrefix:n,className:t,as:e=Rx,active:i,eventKey:r,disabled:s=!1,...a},l)=>{n=Ae(n,"nav-link");const[u,f]=c6({key:_0(r,a.href),active:i,disabled:s,...a});return M.jsx(e,{...a,...u,ref:l,disabled:s,className:xe(t,n,s&&"disabled",f.isActive&&"active")})});IA.displayName="NavLink";const v6=U.forwardRef((n,t)=>{const{as:e="div",bsPrefix:i,variant:r,fill:s=!1,justify:a=!1,navbar:l,navbarScroll:u,className:f,activeKey:d,...p}=Tx(n,{activeKey:"onSelect"}),m=Ae(i,"nav");let g,y,x=!1;const _=U.useContext(Xu),b=U.useContext(SA);return _?(g=_.bsPrefix,x=l??!0):b&&({cardHeaderBsPrefix:y}=b),M.jsx(qrt,{as:e,ref:t,activeKey:d,className:xe(f,{[m]:!x,[`${g}-nav`]:x,[`${g}-nav-scroll`]:x&&u,[`${y}-${r}`]:!!y,[`${m}-${r}`]:!!r,[`${m}-fill`]:s,[`${m}-justified`]:a}),...p})});v6.displayName="Nav";const ra=Object.assign(v6,{Item:g6,Link:IA}),x6=U.forwardRef(({bsPrefix:n,className:t,as:e,...i},r)=>{n=Ae(n,"navbar-brand");const s=e||(i.href?"a":"span");return M.jsx(s,{...i,ref:r,className:xe(t,n)})});x6.displayName="NavbarBrand";const y6=U.forwardRef(({children:n,bsPrefix:t,...e},i)=>{t=Ae(t,"navbar-collapse");const r=U.useContext(Xu);return M.jsx(dk,{in:!!(r&&r.expanded),...e,children:M.jsx("div",{ref:i,className:t,children:n})})});y6.displayName="NavbarCollapse";const _6=U.forwardRef(({bsPrefix:n,className:t,children:e,label:i="Toggle navigation",as:r="button",onClick:s,...a},l)=>{n=Ae(n,"navbar-toggler");const{onToggle:u,expanded:f}=U.useContext(Xu)||{},d=Wu(p=>{s&&s(p),u&&u()});return r==="button"&&(a.type="button"),M.jsx(r,{...a,ref:l,onClick:d,"aria-label":i,className:xe(t,n,!f&&"collapsed"),children:e||M.jsx("span",{className:`${n}-icon`})})});_6.displayName="NavbarToggle";const yE=new WeakMap,vO=(n,t)=>{if(!n||!t)return;const e=yE.get(t)||new Map;yE.set(t,e);let i=e.get(n);return i||(i=t.matchMedia(n),i.refCount=0,e.set(i.media,i)),i};function gst(n,t=typeof window>"u"?void 0:window){const e=vO(n,t),[i,r]=U.useState(()=>e?e.matches:!1);return CA(()=>{let s=vO(n,t);if(!s)return r(!1);let a=yE.get(t);const l=()=>{r(s.matches)};return s.refCount++,s.addListener(l),l(),()=>{s.removeListener(l),s.refCount--,s.refCount<=0&&a?.delete(s.media),s=void 0}},[n]),i}function vst(n){const t=Object.keys(n);function e(l,u){return l===u?u:l?`${l} and ${u}`:u}function i(l){return t[Math.min(t.indexOf(l)+1,t.length-1)]}function r(l){const u=i(l);let f=n[u];return typeof f=="number"?f=`${f-.2}px`:f=`calc(${f} - 0.2px)`,`(max-width: ${f})`}function s(l){let u=n[l];return typeof u=="number"&&(u=`${u}px`),`(min-width: ${u})`}function a(l,u,f){let d;typeof l=="object"?(d=l,f=u,u=!0):(u=u||!0,d={[l]:u});let p=U.useMemo(()=>Object.entries(d).reduce((m,[g,y])=>((y==="up"||y===!0)&&(m=e(m,s(g))),(y==="down"||y===!0)&&(m=e(m,r(g))),m),""),[JSON.stringify(d)]);return gst(p,f)}return a}const xst=vst({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),b6=U.forwardRef(({className:n,bsPrefix:t,as:e="div",...i},r)=>(t=Ae(t,"offcanvas-body"),M.jsx(e,{ref:r,className:xe(n,t),...i})));b6.displayName="OffcanvasBody";const yst={[Oa]:"show",[cl]:"show"},w6=U.forwardRef(({bsPrefix:n,className:t,children:e,in:i=!1,mountOnEnter:r=!1,unmountOnExit:s=!1,appear:a=!1,...l},u)=>(n=Ae(n,"offcanvas"),M.jsx(Dx,{ref:u,addEndListener:bA,in:i,mountOnEnter:r,unmountOnExit:s,appear:a,...l,childRef:Vu(e),children:(f,d)=>U.cloneElement(e,{...d,className:xe(t,e.props.className,(f===Oa||f===x0)&&`${n}-toggling`,yst[f])})})));w6.displayName="OffcanvasToggling";const E6=U.forwardRef(({bsPrefix:n,className:t,closeLabel:e="Close",closeButton:i=!1,...r},s)=>(n=Ae(n,"offcanvas-header"),M.jsx(m6,{ref:s,...r,className:xe(t,n),closeLabel:e,closeButton:i})));E6.displayName="OffcanvasHeader";const _st=Ox("h5"),A6=U.forwardRef(({className:n,bsPrefix:t,as:e=_st,...i},r)=>(t=Ae(t,"offcanvas-title"),M.jsx(e,{ref:r,className:xe(n,t),...i})));A6.displayName="OffcanvasTitle";function bst(n){return M.jsx(w6,{...n})}function wst(n){return M.jsx(Ed,{...n})}const S6=U.forwardRef(({bsPrefix:n,className:t,children:e,"aria-labelledby":i,placement:r="start",responsive:s,show:a=!1,backdrop:l=!0,keyboard:u=!0,scroll:f=!1,onEscapeKeyDown:d,onShow:p,onHide:m,container:g,autoFocus:y=!0,enforceFocus:x=!0,restoreFocus:_=!0,restoreFocusOptions:b,onEntered:S,onExit:A,onExiting:C,onEnter:O,onEntering:N,onExited:D,backdropClassName:L,manager:I,renderStaticNode:z=!1,...j},B)=>{const tt=U.useRef();n=Ae(n,"offcanvas");const[k,et]=U.useState(!1),K=Wu(m),q=xst(s||"xs","up");U.useEffect(()=>{et(s?a&&!q:a)},[a,s,q]);const _t=U.useMemo(()=>({onHide:K}),[K]);function at(){return I||(f?(tt.current||(tt.current=new h6({handleContainerOverflow:!1})),tt.current):mst())}const P=(ht,...yt)=>{ht&&(ht.style.visibility="visible"),O?.(ht,...yt)},X=(ht,...yt)=>{ht&&(ht.style.visibility=""),D?.(...yt)},V=U.useCallback(ht=>M.jsx("div",{...ht,className:xe(`${n}-backdrop`,L)}),[L,n]),it=ht=>M.jsx("div",{...ht,...j,className:xe(t,s?`${n}-${s}`:n,`${n}-${r}`),"aria-labelledby":i,children:e});return M.jsxs(M.Fragment,{children:[!k&&(s||z)&&it({}),M.jsx(p6.Provider,{value:_t,children:M.jsx(dst,{show:k,ref:B,backdrop:l,container:g,keyboard:u,autoFocus:y,enforceFocus:x&&!f,restoreFocus:_,restoreFocusOptions:b,onEscapeKeyDown:d,onShow:p,onHide:K,onEnter:P,onEntering:N,onEntered:S,onExit:A,onExiting:C,onExited:X,manager:at(),transition:bst,backdropTransition:wst,renderBackdrop:V,renderDialog:it})})]})});S6.displayName="Offcanvas";const Est=Object.assign(S6,{Body:b6,Header:E6,Title:A6}),T6=U.forwardRef(({onHide:n,...t},e)=>{const i=U.useContext(Xu),r=Wu(()=>{i==null||i.onToggle==null||i.onToggle(),n?.()});return M.jsx(Est,{ref:e,show:!!(i!=null&&i.expanded),...t,renderStaticNode:!0,onHide:r})});T6.displayName="NavbarOffcanvas";const C6=U.forwardRef(({className:n,bsPrefix:t,as:e="span",...i},r)=>(t=Ae(t,"navbar-text"),M.jsx(e,{ref:r,className:xe(n,t),...i})));C6.displayName="NavbarText";const D6=U.forwardRef((n,t)=>{const{bsPrefix:e,expand:i=!0,variant:r="light",bg:s,fixed:a,sticky:l,className:u,as:f="nav",expanded:d,onToggle:p,onSelect:m,collapseOnSelect:g=!1,...y}=Tx(n,{expanded:"onToggle"}),x=Ae(e,"navbar"),_=U.useCallback((...A)=>{m?.(...A),g&&d&&p?.(!1)},[m,g,d,p]);y.role===void 0&&f!=="nav"&&(y.role="navigation");let b=`${x}-expand`;typeof i=="string"&&(b=`${b}-${i}`);const S=U.useMemo(()=>({onToggle:()=>p?.(!d),bsPrefix:x,expanded:!!d,expand:i}),[x,d,i,p]);return M.jsx(Xu.Provider,{value:S,children:M.jsx(Iu.Provider,{value:_,children:M.jsx(f,{ref:t,...y,className:xe(u,x,i&&b,r&&`${x}-${r}`,s&&`bg-${s}`,l&&`sticky-${l}`,a&&`fixed-${a}`)})})})});D6.displayName="Navbar";const Kf=Object.assign(D6,{Brand:x6,Collapse:y6,Offcanvas:T6,Text:C6,Toggle:_6}),O6=U.forwardRef(({id:n,title:t,children:e,bsPrefix:i,className:r,rootCloseEvent:s,menuRole:a,disabled:l,active:u,renderMenuOnMount:f,menuVariant:d,...p},m)=>{const g=Ae(void 0,"nav-item");return M.jsxs(pu,{ref:m,...p,className:xe(r,g),children:[M.jsx(pu.Toggle,{id:n,eventKey:null,active:u,disabled:l,childBsPrefix:i,as:IA,children:t}),M.jsx(pu.Menu,{role:a,renderOnMount:f,rootCloseEvent:s,variant:d,children:e})]})});O6.displayName="NavDropdown";const Wb=Object.assign(O6,{Item:pu.Item,ItemText:pu.ItemText,Divider:pu.Divider,Header:pu.Header}),Ast=()=>{};function Sst(n,t,{disabled:e,clickTrigger:i}={}){const r=t||Ast;Lk(n,r,{disabled:e,clickTrigger:i});const s=nr(a=>{ck(a)&&r(a)});U.useEffect(()=>{if(e||n==null)return;const a=W0(Vv(n));let l=(a.defaultView||window).event;const u=fl(a,"keyup",f=>{if(f===l){l=void 0;return}s(f)});return()=>{u()}},[n,e,s])}const R6=U.forwardRef((n,t)=>{const{flip:e,offset:i,placement:r,containerPadding:s,popperConfig:a={},transition:l,runTransition:u}=n,[f,d]=pE(),[p,m]=pE(),g=K0(d,t),y=gE(n.container),x=gE(n.target),[_,b]=U.useState(!n.show),S=Nk(x,f,Ik({placement:r,enableEvents:!!n.show,containerPadding:s||5,flip:e,offset:i,arrowElement:p,popperConfig:a}));n.show&&_&&b(!1);const A=(...j)=>{b(!0),n.onExited&&n.onExited(...j)},C=n.show||!_;if(Sst(f,n.onHide,{disabled:!n.rootClose||n.rootCloseDisabled,clickTrigger:n.rootCloseEvent}),!C)return null;const{onExit:O,onExiting:N,onEnter:D,onEntering:L,onEntered:I}=n;let z=n.children(Object.assign({},S.attributes.popper,{style:S.styles.popper,ref:g}),{popper:S,placement:r,show:!!n.show,arrowProps:Object.assign({},S.attributes.arrow,{style:S.styles.arrow,ref:m})});return z=vE(l,u,{in:!!n.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:z,onExit:O,onExiting:N,onExited:A,onEnter:D,onEntering:L,onEntered:I}),y?dc.createPortal(z,y):null});R6.displayName="Overlay";const N6=U.forwardRef(({className:n,bsPrefix:t,as:e="div",...i},r)=>(t=Ae(t,"popover-header"),M.jsx(e,{ref:r,className:xe(n,t),...i})));N6.displayName="PopoverHeader";const kA=U.forwardRef(({className:n,bsPrefix:t,as:e="div",...i},r)=>(t=Ae(t,"popover-body"),M.jsx(e,{ref:r,className:xe(n,t),...i})));kA.displayName="PopoverBody";function L6(n,t){let e=n;return n==="left"?e=t?"end":"start":n==="right"&&(e=t?"start":"end"),e}function I6(n="absolute"){return{position:n,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const k6=U.forwardRef(({bsPrefix:n,placement:t="right",className:e,style:i,children:r,body:s,arrowProps:a,hasDoneInitialMeasure:l,popper:u,show:f,...d},p)=>{const m=Ae(n,"popover"),g=_A(),[y]=t?.split("-")||[],x=L6(y,g);let _=i;return f&&!l&&(_={...i,...I6(u?.strategy)}),M.jsxs("div",{ref:p,role:"tooltip",style:_,"x-placement":y,className:xe(e,m,y&&`bs-popover-${x}`),...d,children:[M.jsx("div",{className:"popover-arrow",...a}),s?M.jsx(kA,{children:r}):r]})});k6.displayName="Popover";const Tst=Object.assign(k6,{Header:N6,Body:kA,POPPER_OFFSET:[0,8]}),M6=U.forwardRef(({bsPrefix:n,placement:t="right",className:e,style:i,children:r,arrowProps:s,hasDoneInitialMeasure:a,popper:l,show:u,...f},d)=>{n=Ae(n,"tooltip");const p=_A(),[m]=t?.split("-")||[],g=L6(m,p);let y=i;return u&&!a&&(y={...i,...I6(l?.strategy)}),M.jsxs("div",{ref:d,style:y,role:"tooltip","x-placement":m,className:xe(e,n,`bs-tooltip-${g}`),...f,children:[M.jsx("div",{className:"tooltip-arrow",...s}),M.jsx("div",{className:`${n}-inner`,children:r})]})});M6.displayName="Tooltip";const F6=Object.assign(M6,{TOOLTIP_OFFSET:[0,6]});function Cst(n){const t=U.useRef(null),e=Ae(void 0,"popover"),i=Ae(void 0,"tooltip"),r=U.useMemo(()=>({name:"offset",options:{offset:()=>{if(n)return n;if(t.current){if(xE(t.current,e))return Tst.POPPER_OFFSET;if(xE(t.current,i))return F6.TOOLTIP_OFFSET}return[0,0]}}}),[n,e,i]);return[t,[r]]}function Dst(n,t){const{ref:e}=n,{ref:i}=t;n.ref=e.__wrapped||(e.__wrapped=r=>e(D1(r))),t.ref=i.__wrapped||(i.__wrapped=r=>i(D1(r)))}const P6=U.forwardRef(({children:n,transition:t=Ed,popperConfig:e={},rootClose:i=!1,placement:r="top",show:s=!1,...a},l)=>{const u=U.useRef({}),[f,d]=U.useState(null),[p,m]=Cst(a.offset),g=X0(l,p),y=t===!0?Ed:t||void 0,x=Wu(_=>{d(_),e==null||e.onFirstUpdate==null||e.onFirstUpdate(_)});return CA(()=>{f&&a.target&&(u.current.scheduleUpdate==null||u.current.scheduleUpdate())},[f,a.target]),U.useEffect(()=>{s||d(null)},[s]),M.jsx(R6,{...a,ref:g,popperConfig:{...e,modifiers:m.concat(e.modifiers||[]),onFirstUpdate:x},transition:y,rootClose:i,placement:r,show:s,children:(_,{arrowProps:b,popper:S,show:A})=>{var C;Dst(_,b);const O=S?.placement,N=Object.assign(u.current,{state:S?.state,scheduleUpdate:S?.update,placement:O,outOfBoundaries:(S==null||(C=S.state)==null||(C=C.modifiersData.hide)==null?void 0:C.isReferenceHidden)||!1,strategy:e.strategy}),D=!!f;return typeof n=="function"?n({..._,placement:O,show:A,...!t&&A&&{className:"show"},popper:N,arrowProps:b,hasDoneInitialMeasure:D}):U.cloneElement(n,{..._,placement:O,arrowProps:b,popper:N,hasDoneInitialMeasure:D,className:xe(n.props.className,!t&&A&&"show"),style:{...n.props.style,..._.style}})}})});P6.displayName="Overlay";function Ost(n){return n&&typeof n=="object"?n:{show:n,hide:n}}function xO(n,t,e){const[i]=t,r=i.currentTarget,s=i.relatedTarget||i.nativeEvent[e];(!s||s!==r)&&!y0(r,s)&&n(...t)}nn.oneOf(["click","hover","focus"]);const Rst=({trigger:n=["hover","focus"],overlay:t,children:e,popperConfig:i={},show:r,defaultShow:s=!1,onToggle:a,delay:l,placement:u,flip:f=u&&u.indexOf("auto")!==-1,...d})=>{const p=U.useRef(null),m=X0(p,Vu(e)),g=srt(),y=U.useRef(""),[x,_]=sk(r,s,a),b=Ost(l),{onFocus:S,onBlur:A,onClick:C}=typeof e!="function"?U.Children.only(e).props:{},O=et=>{m(D1(et))},N=U.useCallback(()=>{if(g.clear(),y.current="show",!b.show){_(!0);return}g.set(()=>{y.current==="show"&&_(!0)},b.show)},[b.show,_,g]),D=U.useCallback(()=>{if(g.clear(),y.current="hide",!b.hide){_(!1);return}g.set(()=>{y.current==="hide"&&_(!1)},b.hide)},[b.hide,_,g]),L=U.useCallback((...et)=>{N(),S?.(...et)},[N,S]),I=U.useCallback((...et)=>{D(),A?.(...et)},[D,A]),z=U.useCallback((...et)=>{_(!x),C?.(...et)},[C,_,x]),j=U.useCallback((...et)=>{xO(N,et,"fromElement")},[N]),B=U.useCallback((...et)=>{xO(D,et,"toElement")},[D]),tt=n==null?[]:[].concat(n),k={ref:O};return tt.indexOf("click")!==-1&&(k.onClick=z),tt.indexOf("focus")!==-1&&(k.onFocus=L,k.onBlur=I),tt.indexOf("hover")!==-1&&(k.onMouseOver=j,k.onMouseOut=B),M.jsxs(M.Fragment,{children:[typeof e=="function"?e(k):U.cloneElement(e,k),M.jsx(P6,{...d,show:x,onHide:D,flip:f,placement:u,popperConfig:i,target:p.current,children:t})]})},Na=U.forwardRef(({bsPrefix:n,className:t,as:e="div",...i},r)=>{const s=Ae(n,"row"),a=ak(),l=ok(),u=`${s}-cols`,f=[];return a.forEach(d=>{const p=i[d];delete i[d];let m;p!=null&&typeof p=="object"?{cols:m}=p:m=p;const g=d!==l?`-${d}`:"";m!=null&&f.push(`${u}${g}-${m}`)}),M.jsx(e,{ref:r,...i,className:xe(t,s,...f)})});Na.displayName="Row";const Nst=({areas:n,hasFile:t,isExtracting:e,extractionProgress:i,extractionStartTime:r,fileName:s,onPreview:a,onExtractTexts:l,onCancelExtraction:u})=>{const[f,d]=U.useState(eO(n)),[p,m]=U.useState(!1),[g,y]=U.useState("");U.useEffect(()=>{d(eO(n))},[n,p]);const x=async()=>{try{const C=await l();fit(n,C)}catch(C){if(C instanceof Error&&C.message==="Extração cancelada pelo usuário"){console.log("Download cancelado pelo usuário");return}console.error("Download cancelado:",C)}},_=async()=>{try{const C=await l();uit(n,C)}catch(C){if(C instanceof Error&&C.message==="Extração cancelada pelo usuário"){console.log("Download cancelado pelo usuário");return}console.error("Download cancelado:",C)}},b=async()=>{try{const C=await l();cit(n,C)}catch(C){if(C instanceof Error&&C.message==="Extração cancelada pelo usuário"){console.log("Download cancelado pelo usuário");return}console.error("Download cancelado:",C)}},S=async()=>{try{const C=await l();hit(n,C,p)}catch(C){if(C instanceof Error&&C.message==="Extração cancelada pelo usuário"){console.log("Download cancelado pelo usuário");return}console.error("Download cancelado:",C)}},A=async C=>{try{const O=await l();dit(n,O,C)}catch(O){if(O instanceof Error&&O.message==="Extração cancelada pelo usuário"){console.log("Download cancelado pelo usuário");return}console.error("Download cancelado:",O)}};return U.useEffect(()=>{if(!e){y("");return}const C=setInterval(()=>{const O=Date.now()-r;y(QU(O,10))},100);return()=>clearInterval(C)},[e,r]),e?M.jsxs("div",{className:"d-flex align-items-center justify-content-between p-1",children:[M.jsxs("div",{className:"d-flex flex-column text-start",children:[s&&M.jsxs("small",{className:"text-muted",children:["Extraindo dados do arquivo ",M.jsx("strong",{children:s})]}),M.jsx("small",{className:"text-muted",children:i&&i.message}),M.jsxs("small",{className:"text-secondary",children:["Tempo decorrido: ",M.jsx("strong",{children:g})]})]}),M.jsx("button",{className:"btn btn-outline-danger btn-sm ms-3",onClick:u,children:"Cancelar"})]}):M.jsxs("div",{className:"d-flex align-items-start gap-3",children:[M.jsx("div",{children:M.jsxs("button",{className:"btn btn-outline-primary",onClick:a,disabled:!(n.length>0&&t&&n.some(C=>C.coordinates)),children:[M.jsx(pz,{className:"me-1",size:16}),"Visualizar"]})}),M.jsxs("div",{className:"btn-group dropup",children:[M.jsx(Rst,{overlay:M.jsx(F6,{id:"xls-tooltip",children:"Download XLS"}),children:M.jsxs(Ra,{variant:"secondary",type:"button",onClick:x,children:[M.jsx(Gw,{className:"me-1",size:16}),"Excel"]})}),M.jsx("button",{className:"btn btn-secondary dropdown-toggle dropdown-toggle-split",type:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:M.jsx("span",{className:"visually-hidden",children:"Mais opções"})}),M.jsxs("ul",{className:"dropdown-menu",children:[M.jsx("li",{children:M.jsx("button",{className:"dropdown-item",type:"button",onClick:b,children:"JSON"})}),M.jsx("li",{children:M.jsx("button",{className:"dropdown-item",type:"button",onClick:_,children:"CSV"})})]})]}),M.jsxs("div",{className:"d-flex flex-column align-items-start",children:[M.jsx("div",{children:M.jsxs("div",{className:"btn-group dropup",children:[M.jsxs("button",{className:"btn btn-secondary",type:"button",onClick:S,disabled:!f.someValid,"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"top","data-bs-title":f.allValid?"Exportar todos os arquivos":p&&f.someValid?`Exportar ${f.validExports.join(", ")} completo(s) e ${f.nonValidExports.join(", ")} incompleto(s)`:p?"Exportar todos incompletos":f.someValid?`Exportar ${f.validExports.join(", ")}`:"Dados insuficientes para gerar arquivos",children:[M.jsx(Gw,{className:"me-1",size:16}),"Leapfrog"]}),M.jsx("button",{type:"button",className:"btn btn-secondary dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:M.jsx("span",{className:"visually-hidden",children:"Mais opções"})}),M.jsx("ul",{className:"dropdown-menu",style:{zIndex:"1001"},children:zv.map(C=>{const O=Sx(n,C);return M.jsx("li",{"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"left","data-bs-title":O.isValid?`Exportar ${C}.csv`:p?`Exportar ${C}.csv incompleto (dados ausentes: ${O.missingFields.map(N=>N==="depth"?"Profundidades ou Profundidade Total":Tu[N]).join(", ")})`:`Campos faltantes: ${O.missingFields.map(N=>N==="depth"?"Profundidades ou Profundidade Total":Tu[N]).join(", ")}`,children:M.jsx("button",{className:pit(n,C,p),onClick:()=>A(C),children:Pz[C]})},`export-leapfrog-${C}`)})})]})}),M.jsxs("div",{className:"form-check form-switch mt-2",children:[M.jsx("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"switchCheckDefault",checked:p,onChange:C=>m(C.target.checked)}),M.jsx("label",{className:"form-check-label small",htmlFor:"switchCheckDefault",children:"Aceitar dados incompletos"})]})]})]})};function Lst({areas:n,setAreas:t,selectedFile:e,setSelectedFile:i,extractedTexts:r,setExtractedTexts:s}){const a=U.useRef(null),[l,u]=U.useState(!1),[f,d]=U.useState(null),[p,m]=U.useState(0),[g,y]=U.useState(null),[x,_]=U.useState("text"),[b,S]=U.useState(!1),[A,C]=U.useState(null),O=Et=>{if(n.length>=15){alert("Limite de 15 áreas atingido");return}t(aY(n,x==="ocr",Et))},N=Et=>{t(oY(n,Et))},D=(Et,G)=>{t(lY(n,Et,G))},L=Et=>{t(cY(n,Et))},I=Et=>{C(Et),S(!0)},z=Et=>{A&&t(uY(n,A,Et)),S(!1),C(null)},[j,B]=U.useState(""),[tt,k]=U.useState([]),et=()=>B4(n,e)!==j||tt.length===0,K=async()=>{if(console.log(et()),!et())return tt;const Et=new AbortController;y(Et),u(!0),m(Date.now());try{const G=a.current?.getDocument(),lt=n.some(St=>St.repeatInPages),rt=n.find(St=>St.dataType==="hole_id"),ot=n.filter(St=>!St.coordinates).map(St=>St.name);if(ot.length>0&&!confirm(`A(s) seguinte(s) área(s) não possue(m) coordenadas:
`+ot.join(", ")+`
Deseja continuar mesmo assim?`))throw new Error("Extração cancelada pelo usuário");if(!rt&&lt&&!confirm("Algumas áreas estão configuradas como 'Único' mas não há uma área de ID da Sondagem. A função não vai funcionar corretamente. Deseja continuar mesmo assim?"))throw new Error("Extração cancelada pelo usuário");if(!G)throw new Error("PDF não carregado");const bt=await FY(n,G,Et.signal,d);return s(bt),k(bt),B(B4(n,e)),bt}catch(G){throw G}finally{u(!1),d(null),y(null)}},q=async()=>{try{u(!0),await K()}catch(Et){console.error("Erro na extração: ",Et)}finally{u(!1)}},_t=Et=>{t(Et)},at=()=>{S(!1),C(null)};U.useEffect(()=>{const Et=lt=>{lt.key==="Escape"&&b&&at()},G=lt=>{const rt=document.querySelector(".pdf-container");b&&!rt?.contains(lt.target)&&at()};return document.addEventListener("keydown",Et),document.addEventListener("mousedown",G),()=>{document.removeEventListener("keydown",Et),document.removeEventListener("mousedown",G)}},[b]);const P=Et=>{if(!Et.destination)return;const G=Et.source.index,lt=Et.destination.index;if(G===lt)return;const rt=Array.from(n),[ot]=rt.splice(G,1);rt.splice(lt,0,ot);const bt=rt.map((St,R)=>({...St,order:R+1}));t(bt)},X=(Et,G)=>{t(n.map(lt=>lt.id===Et?{...lt,isMandatory:G}:lt))},V=(Et,G)=>{t(n.map(lt=>lt.id===Et?{...lt,repeatInPages:G}:lt))},it=(Et,G)=>{t(n.map(lt=>lt.id===Et?{...lt,ocr:G}:lt))},ht=Et=>{if(_(Et),Et!=="both"){const G=Et==="ocr";t(n.map(lt=>({...lt,ocr:G})))}},yt=(Et,G)=>{const lt=rL.includes(G),rt=sL.includes(G);t(n.map(ot=>ot.id===Et?{...ot,dataType:G,repeatInPages:lt,isMandatory:rt,name:P4(ot.name)&&G==="default"?c0("Nova Área",n):P4(ot.name)?c0(Tu[G],n):ot.name}:ot))},Rt=()=>{g&&g.abort()};return M.jsxs(M.Fragment,{children:[b&&M.jsx("div",{className:"selection-mode-overlay"}),M.jsxs(Na,{className:"justify-content-center",children:[M.jsx(ii,{xs:12,lg:6,xxl:4,style:{maxWidth:"450px",minWidth:"300px"},children:M.jsx(hY,{areas:n,areasMenu:M.jsx(sY,{onFileSelect:i,onStartAreaSelection:I,onClearArea:L,onDeleteArea:N,onRenameArea:D,onAddNewArea:O,onLoadPreset:_t,onDragEnd:P,onToggleMandatory:X,onToggleRepeat:V,onChangeAreaType:yt,onToggleAreaOCR:it,areas:n,hasFile:!!e,extractionMode:x,onChangeExtractionMode:ht}),extractMenu:M.jsx(Nst,{onPreview:q,onExtractTexts:K,onCancelExtraction:Rt,areas:n,hasFile:!!e,isExtracting:l,extractionProgress:f,extractionStartTime:p,fileName:e?.name})})}),M.jsx(ii,{xs:12,lg:6,xxl:5,xxxl:4,children:M.jsx(kz,{ref:a,file:e,isSelectingActive:b,activeAreaId:A,onFinishSelection:z,areas:n})}),M.jsx(ii,{xs:12,lg:6,xxl:3,xxxl:4,children:M.jsx(PY,{extractedTexts:r,areas:n,isExtracting:l,fileName:e?.name||void 0})})]})]})}const Ist=()=>M.jsx(M.Fragment,{children:M.jsx(Kf,{bg:"white",expand:"lg",className:"border-bottom",children:M.jsxs(Y0,{fluid:!0,children:[M.jsx(Kf.Brand,{href:"https://www.jsgeo.com.br/",target:"_blank",children:M.jsx("img",{src:"js_logo_horizontal.png",alt:"JS Geologia Aplicada",style:{height:"40px"}})}),M.jsx(Kf.Toggle,{"aria-controls":"basic-navbar-nav"}),M.jsx(Kf.Collapse,{id:"basic-navbar-nav",children:M.jsxs(ra,{className:"ms-auto",children:[M.jsx(ra.Link,{href:"https://www.jsgeo.com.br/",target:"_blank",children:"Home"}),M.jsx(ra.Link,{href:"https://www.jsgeo.com.br/quem-e-a-js",target:"_blank",children:"Quem é a JS"}),M.jsxs(Wb,{title:M.jsx("a",{href:"https://www.jsgeo.com.br/areas-de-atuacao",target:"_blank",className:"text-decoration-none text-muted",onClick:n=>n.stopPropagation(),children:"Áreas de atuação"}),id:"areas-dropdown",className:"text-secondary mx-1",style:{fontSize:"0.95rem"},children:[M.jsx(Wb.Item,{href:"https://www.jsgeo.com.br/clientes",target:"_blank",children:"Clientes"}),M.jsx(Wb.Item,{href:"https://www.jsgeo.com.br/projetos",target:"_blank",children:"Projetos"})]}),M.jsx(ra.Link,{href:"https://www.jsgeo.com.br/publicacoes",target:"_blank",children:"Publicações"}),M.jsx(ra.Link,{href:"https://www.jsgeo.com.br/patrocinios",target:"_blank",children:"Patrocínios"}),M.jsx(ra.Link,{href:"https://js-geologia-aplicada.github.io/JS-Open-Geo/",target:"_blank",children:"JS OpenGeo"}),M.jsx(ra.Link,{href:"https://www.jsgeo.com.br/cursos",target:"_blank",children:"Cursos"}),M.jsx(ra.Link,{href:"https://www.jsgeo.com.br/blog",target:"_blank",children:"Blog"}),M.jsx(ra.Link,{href:"https://www.jsgeo.com.br/contato",target:"_blank",children:"Contato"})]})})]})})});function kst(n){const t=Math.sqrt(Math.pow(n,2)+Math.pow(n,2))/2;return-(n-Math.sqrt(Math.pow(n,2)-Math.pow(t,2)))/t}function Ce(n,t,e){return{x:n??0,y:t??0,z:e??0}}function xn(n,t){return{x:n??0,y:t??0}}class ds{static next(){return(++ds.seed).toString(16).toUpperCase()}static peek(){return(ds.seed+1).toString(16).toUpperCase()}static clear(){ds.seed=0}}ds.seed=0;class Mst{constructor(){this.handle=ds.next()}dxfy(t){t.type("ENDBLK"),t.handle(this.handle),t.push(330,this.ownerObjectHandle),t.subclassMarker("AcDbEntity"),t.layerName("0"),t.subclassMarker("AcDbBlockEnd")}}const ov=(n,t)=>({tl:n,br:t});class $n{static centerRadiusBBox(t,e){return ov(Ce(t.x-e,t.y+e),Ce(t.x+e,t.y-e))}static pointBBox(t){return ov(Ce(t.x-100,t.y+100),Ce(t.x+100,t.y-100))}static lineBBox(t,e){const i=t.x>e.x?t.x:e.x,r=t.x<e.x?t.x:e.x,s=t.y>e.y?t.y:e.y,a=t.y<e.y?t.y:e.y,l=t.z>e.z?t.z:e.z,u=t.z<e.z?t.z:e.z;return ov(Ce(r,s,u),Ce(i,a,l))}static verticesBBox(t){let e=-1/0,i=-1/0,r=1/0,s=1/0;for(let a=0;a<t.length;a++){const{x:l,y:u}=t[a];e<l&&(e=l),i<u&&(i=u),r>l&&(r=l),s>u&&(s=u)}return ov(Ce(r,i),Ce(e,s))}static boundingBox(t){if(t.length===0)return $n.pointBBox(Ce());const e=[];for(let i=0;i<t.length;i++){const r=t[i];e.push(r.tl,r.br)}return $n.verticesBBox(e)}static boundingBoxCenter(t){return Ce(t.tl.x+(t.br.x-t.tl.x)/2,t.br.y+(t.tl.y-t.br.y)/2,0)}static boundingBoxHeight(t){return t.tl.y-t.br.y}}var N1,_E,bE;(function(n){n[n.None=0]="None",n[n.Frozen=1]="Frozen",n[n.FrozenInNewViewports=2]="FrozenInNewViewports",n[n.Locked=4]="Locked",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(N1||(N1={})),function(n){n[n.None=0]="None",n[n.DescribeShape=1]="DescribeShape",n[n.VerticalText=4]="VerticalText",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"}(_E||(_E={})),function(n){n[n.None=0]="None",n[n.PaperSpace=1]="PaperSpace",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"}(bE||(bE={}));class Oc{constructor(t){this.type=t,this.handle=ds.next()}dxfy(t){t.type(this.type),t.handle(this.handle),t.push(330,this.ownerObjectHandle),t.subclassMarker("AcDbSymbolTableRecord")}}class ad extends Oc{constructor(t,e,i,r){super("LAYER"),this.name=t,this.colorNumber=e,this.lineType=i,this.flags=r??N1.None}dxfy(t){super.dxfy(t),t.subclassMarker("AcDbLayerTableRecord"),t.name(this.name),t.push(70,this.flags),t.colorNumber(this.colorNumber),t.push(420,this.trueColor),t.lineType(this.lineType),t.push(370,0),t.push(390,0),t.push(347,this.materialObject)}}ad.layerZeroName="0";const Fst=[[["00","00","00"],0,["0","0","0"]],[["FF","00","00"],1,["255","0","0"]],[["FF","FF","00"],2,["255","255","0"]],[["00","FF","00"],3,["0","255","0"]],[["00","FF","FF"],4,["0","255","255"]],[["00","00","FF"],5,["0","0","255"]],[["FF","00","FF"],6,["255","0","255"]],[["FF","FF","FF"],7,["255","255","255"]],[["41","41","41"],8,["65","65","65"]],[["80","80","80"],9,["128","128","128"]],[["FF","00","00"],10,["255","0","0"]],[["FF","AA","AA"],11,["255","170","170"]],[["BD","00","00"],12,["189","0","0"]],[["BD","7E","7E"],13,["189","126","126"]],[["81","00","00"],14,["129","0","0"]],[["81","56","56"],15,["129","86","86"]],[["68","00","00"],16,["104","0","0"]],[["68","45","45"],17,["104","69","69"]],[["4F","00","00"],18,["79","0","0"]],[["4F","35","35"],19,["79","53","53"]],[["FF","3F","00"],20,["255","63","0"]],[["FF","BF","AA"],21,["255","191","170"]],[["BD","2E","00"],22,["189","46","0"]],[["BD","8D","7E"],23,["189","141","126"]],[["81","1F","00"],24,["129","31","0"]],[["81","60","56"],25,["129","96","86"]],[["68","19","00"],26,["104","25","0"]],[["68","4E","45"],27,["104","78","69"]],[["4F","13","00"],28,["79","19","0"]],[["4F","3B","35"],29,["79","59","53"]],[["FF","7F","00"],30,["255","127","0"]],[["FF","D4","AA"],31,["255","212","170"]],[["BD","5E","00"],32,["189","94","0"]],[["BD","9D","7E"],33,["189","157","126"]],[["81","40","00"],34,["129","64","0"]],[["81","6B","56"],35,["129","107","86"]],[["68","34","00"],36,["104","52","0"]],[["68","56","45"],37,["104","86","69"]],[["4F","27","00"],38,["79","39","0"]],[["4F","42","35"],39,["79","66","53"]],[["FF","BF","00"],40,["255","191","0"]],[["FF","EA","AA"],41,["255","234","170"]],[["BD","8D","00"],42,["189","141","0"]],[["BD","AD","7E"],43,["189","173","126"]],[["81","60","00"],44,["129","96","0"]],[["81","76","56"],45,["129","118","86"]],[["68","4E","00"],46,["104","78","0"]],[["68","5F","45"],47,["104","95","69"]],[["4F","3B","00"],48,["79","59","0"]],[["4F","49","35"],49,["79","73","53"]],[["FF","FF","00"],50,["255","255","0"]],[["FF","FF","AA"],51,["255","255","170"]],[["BD","BD","00"],52,["189","189","0"]],[["BD","BD","7E"],53,["189","189","126"]],[["81","81","00"],54,["129","129","0"]],[["81","81","56"],55,["129","129","86"]],[["68","68","00"],56,["104","104","0"]],[["68","68","45"],57,["104","104","69"]],[["4F","4F","00"],58,["79","79","0"]],[["4F","4F","35"],59,["79","79","53"]],[["BF","FF","00"],60,["191","255","0"]],[["EA","FF","AA"],61,["234","255","170"]],[["8D","BD","00"],62,["141","189","0"]],[["AD","BD","7E"],63,["173","189","126"]],[["60","81","00"],64,["96","129","0"]],[["76","81","56"],65,["118","129","86"]],[["4E","68","00"],66,["78","104","0"]],[["5F","68","45"],67,["95","104","69"]],[["3B","4F","00"],68,["59","79","0"]],[["49","4F","35"],69,["73","79","53"]],[["7F","FF","00"],70,["127","255","0"]],[["D4","FF","AA"],71,["212","255","170"]],[["5E","BD","00"],72,["94","189","0"]],[["9D","BD","7E"],73,["157","189","126"]],[["40","81","00"],74,["64","129","0"]],[["6B","81","56"],75,["107","129","86"]],[["34","68","00"],76,["52","104","0"]],[["56","68","45"],77,["86","104","69"]],[["27","4F","00"],78,["39","79","0"]],[["42","4F","35"],79,["66","79","53"]],[["3F","FF","00"],80,["63","255","0"]],[["BF","FF","AA"],81,["191","255","170"]],[["2E","BD","00"],82,["46","189","0"]],[["8D","BD","7E"],83,["141","189","126"]],[["1F","81","00"],84,["31","129","0"]],[["60","81","56"],85,["96","129","86"]],[["19","68","00"],86,["25","104","0"]],[["4E","68","45"],87,["78","104","69"]],[["13","4F","00"],88,["19","79","0"]],[["3B","4F","35"],89,["59","79","53"]],[["00","FF","00"],90,["0","255","0"]],[["AA","FF","AA"],91,["170","255","170"]],[["00","BD","00"],92,["0","189","0"]],[["7E","BD","7E"],93,["126","189","126"]],[["00","81","00"],94,["0","129","0"]],[["56","81","56"],95,["86","129","86"]],[["00","68","00"],96,["0","104","0"]],[["45","68","45"],97,["69","104","69"]],[["00","4F","00"],98,["0","79","0"]],[["35","4F","35"],99,["53","79","53"]],[["00","FF","3F"],100,["0","255","63"]],[["AA","FF","BF"],101,["170","255","191"]],[["00","BD","2E"],102,["0","189","46"]],[["7E","BD","8D"],103,["126","189","141"]],[["00","81","1F"],104,["0","129","31"]],[["56","81","60"],105,["86","129","96"]],[["00","68","19"],106,["0","104","25"]],[["45","68","4E"],107,["69","104","78"]],[["00","4F","13"],108,["0","79","19"]],[["35","4F","3B"],109,["53","79","59"]],[["00","FF","7F"],110,["0","255","127"]],[["AA","FF","D4"],111,["170","255","212"]],[["00","BD","5E"],112,["0","189","94"]],[["7E","BD","9D"],113,["126","189","157"]],[["00","81","40"],114,["0","129","64"]],[["56","81","6B"],115,["86","129","107"]],[["00","68","34"],116,["0","104","52"]],[["45","68","56"],117,["69","104","86"]],[["00","4F","27"],118,["0","79","39"]],[["35","4F","42"],119,["53","79","66"]],[["00","FF","BF"],120,["0","255","191"]],[["AA","FF","EA"],121,["170","255","234"]],[["00","BD","8D"],122,["0","189","141"]],[["7E","BD","AD"],123,["126","189","173"]],[["00","81","60"],124,["0","129","96"]],[["56","81","76"],125,["86","129","118"]],[["00","68","4E"],126,["0","104","78"]],[["45","68","5F"],127,["69","104","95"]],[["00","4F","3B"],128,["0","79","59"]],[["35","4F","49"],129,["53","79","73"]],[["00","FF","FF"],130,["0","255","255"]],[["AA","FF","FF"],131,["170","255","255"]],[["00","BD","BD"],132,["0","189","189"]],[["7E","BD","BD"],133,["126","189","189"]],[["00","81","81"],134,["0","129","129"]],[["56","81","81"],135,["86","129","129"]],[["00","68","68"],136,["0","104","104"]],[["45","68","68"],137,["69","104","104"]],[["00","4F","4F"],138,["0","79","79"]],[["35","4F","4F"],139,["53","79","79"]],[["00","BF","FF"],140,["0","191","255"]],[["AA","EA","FF"],141,["170","234","255"]],[["00","8D","BD"],142,["0","141","189"]],[["7E","AD","BD"],143,["126","173","189"]],[["00","60","81"],144,["0","96","129"]],[["56","76","81"],145,["86","118","129"]],[["00","4E","68"],146,["0","78","104"]],[["45","5F","68"],147,["69","95","104"]],[["00","3B","4F"],148,["0","59","79"]],[["35","49","4F"],149,["53","73","79"]],[["00","7F","FF"],150,["0","127","255"]],[["AA","D4","FF"],151,["170","212","255"]],[["00","5E","BD"],152,["0","94","189"]],[["7E","9D","BD"],153,["126","157","189"]],[["00","40","81"],154,["0","64","129"]],[["56","6B","81"],155,["86","107","129"]],[["00","34","68"],156,["0","52","104"]],[["45","56","68"],157,["69","86","104"]],[["00","27","4F"],158,["0","39","79"]],[["35","42","4F"],159,["53","66","79"]],[["00","3F","FF"],160,["0","63","255"]],[["AA","BF","FF"],161,["170","191","255"]],[["00","2E","BD"],162,["0","46","189"]],[["7E","8D","BD"],163,["126","141","189"]],[["00","1F","81"],164,["0","31","129"]],[["56","60","81"],165,["86","96","129"]],[["00","19","68"],166,["0","25","104"]],[["45","4E","68"],167,["69","78","104"]],[["00","13","4F"],168,["0","19","79"]],[["35","3B","4F"],169,["53","59","79"]],[["00","00","FF"],170,["0","0","255"]],[["AA","AA","FF"],171,["170","170","255"]],[["00","00","BD"],172,["0","0","189"]],[["7E","7E","BD"],173,["126","126","189"]],[["00","00","81"],174,["0","0","129"]],[["56","56","81"],175,["86","86","129"]],[["00","00","68"],176,["0","0","104"]],[["45","45","68"],177,["69","69","104"]],[["00","00","4F"],178,["0","0","79"]],[["35","35","4F"],179,["53","53","79"]],[["3F","00","FF"],180,["63","0","255"]],[["BF","AA","FF"],181,["191","170","255"]],[["2E","00","BD"],182,["46","0","189"]],[["8D","7E","BD"],183,["141","126","189"]],[["1F","00","81"],184,["31","0","129"]],[["60","56","81"],185,["96","86","129"]],[["19","00","68"],186,["25","0","104"]],[["4E","45","68"],187,["78","69","104"]],[["13","00","4F"],188,["19","0","79"]],[["3B","35","4F"],189,["59","53","79"]],[["7F","00","FF"],190,["127","0","255"]],[["D4","AA","FF"],191,["212","170","255"]],[["5E","00","BD"],192,["94","0","189"]],[["9D","7E","BD"],193,["157","126","189"]],[["40","00","81"],194,["64","0","129"]],[["6B","56","81"],195,["107","86","129"]],[["34","00","68"],196,["52","0","104"]],[["56","45","68"],197,["86","69","104"]],[["27","00","4F"],198,["39","0","79"]],[["42","35","4F"],199,["66","53","79"]],[["BF","00","FF"],200,["191","0","255"]],[["EA","AA","FF"],201,["234","170","255"]],[["8D","00","BD"],202,["141","0","189"]],[["AD","7E","BD"],203,["173","126","189"]],[["60","00","81"],204,["96","0","129"]],[["76","56","81"],205,["118","86","129"]],[["4E","00","68"],206,["78","0","104"]],[["5F","45","68"],207,["95","69","104"]],[["3B","00","4F"],208,["59","0","79"]],[["49","35","4F"],209,["73","53","79"]],[["FF","00","FF"],210,["255","0","255"]],[["FF","AA","FF"],211,["255","170","255"]],[["BD","00","BD"],212,["189","0","189"]],[["BD","7E","BD"],213,["189","126","189"]],[["81","00","81"],214,["129","0","129"]],[["81","56","81"],215,["129","86","129"]],[["68","00","68"],216,["104","0","104"]],[["68","45","68"],217,["104","69","104"]],[["4F","00","4F"],218,["79","0","79"]],[["4F","35","4F"],219,["79","53","79"]],[["FF","00","BF"],220,["255","0","191"]],[["FF","AA","EA"],221,["255","170","234"]],[["BD","00","8D"],222,["189","0","141"]],[["BD","7E","AD"],223,["189","126","173"]],[["81","00","60"],224,["129","0","96"]],[["81","56","76"],225,["129","86","118"]],[["68","00","4E"],226,["104","0","78"]],[["68","45","5F"],227,["104","69","95"]],[["4F","00","3B"],228,["79","0","59"]],[["4F","35","49"],229,["79","53","73"]],[["FF","00","7F"],230,["255","0","127"]],[["FF","AA","D4"],231,["255","170","212"]],[["BD","00","5E"],232,["189","0","94"]],[["BD","7E","9D"],233,["189","126","157"]],[["81","00","40"],234,["129","0","64"]],[["81","56","6B"],235,["129","86","107"]],[["68","00","34"],236,["104","0","52"]],[["68","45","56"],237,["104","69","86"]],[["4F","00","27"],238,["79","0","39"]],[["4F","35","42"],239,["79","53","66"]],[["FF","00","3F"],240,["255","0","63"]],[["FF","AA","BF"],241,["255","170","191"]],[["BD","00","2E"],242,["189","0","46"]],[["BD","7E","8D"],243,["189","126","141"]],[["81","00","1F"],244,["129","0","31"]],[["81","56","60"],245,["129","86","96"]],[["68","00","19"],246,["104","0","25"]],[["68","45","4E"],247,["104","69","78"]],[["4F","00","13"],248,["79","0","19"]],[["4F","35","3B"],249,["79","53","59"]],[["33","33","33"],250,["51","51","51"]],[["50","50","50"],251,["80","80","80"]],[["69","69","69"],252,["105","105","105"]],[["82","82","82"],253,["130","130","130"]],[["BE","BE","BE"],254,["190","190","190"]],[["FF","FF","FF"],255,["255","255","255"]]];function yO(n){let t="";const e=Fst.find(i=>{const[,r]=i;return r===n});if(e){const[i]=e,[r,s,a]=i;t=`${r}${s}${a}`}return t}class Pst{constructor(t){this.name=t,this.tags=[]}add(t,e){this.tags.push({code:t,value:e})}dxfy(t){t.push(102,`{${this.name}`);for(const e of this.tags)t.push(e.code,e.value);t.push(102,"}")}}class Bst{constructor(){this.lines=[]}push(t,e){e!=null&&this.lines.push(t,e)}stringify(){return this.lines.join(`
`)}start(t){this.push(0,"SECTION"),this.push(2,t)}end(){this.push(0,"ENDSEC")}variableName(t){this.push(9,t)}type(t){this.push(0,t)}primaryText(t){this.push(1,t)}name(t,e=2){this.push(e,t)}handle(t){this.push(5,t)}lineType(t){this.push(6,t)}textStyle(t){this.push(7,t)}layerName(t){this.push(8,t)}point2d(t,e=0){this.push(10+e,t?.x),this.push(20+e,t?.y)}point3d(t,e=0){this.point2d(t,e),this.push(30+e,t?.z)}elevation(t){this.push(38,t)}thickness(t){this.push(39,t)}visibilty(t){t!=null&&this.push(60,t?0:1)}colorNumber(t){this.push(62,t)}subclassMarker(t){this.push(100,t)}}var gr,b0,L1,In;function kn(n,t,e,i){if(typeof t=="function"?n!==t||!i:!t.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?i:e==="a"?i.call(n):i?i.value:t.get(n)}function Ip(n,t,e,i,r){if(typeof t=="function"?n!==t||!0:!t.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(n,e),e}function ti(n,t){return{code:n,value:t}}function _O(n,t=255){const e=[],i=[];for(let r=0;r<n.length;r++){const s=n[r];i.length===t||r===n.length-1?(e.push(i.join("")),i.length=0):i.push(s)}return e}(function(n){n[n.Red=1]="Red",n[n.Green=3]="Green",n[n.Cyan=4]="Cyan",n[n.Blue=5]="Blue",n[n.Magenta=6]="Magenta",n[n.White=7]="White",n[n.Black=0]="Black",n[n.Yellow=2]="Yellow"})(gr||(gr={})),function(n){n[n.Unitless=0]="Unitless",n[n.Inches=1]="Inches",n[n.Feet=2]="Feet",n[n.Miles=3]="Miles",n[n.Millimeters=4]="Millimeters",n[n.Centimeters=5]="Centimeters",n[n.Meters=6]="Meters",n[n.Kilometers=7]="Kilometers",n[n.Microinches=8]="Microinches",n[n.Mils=9]="Mils",n[n.Yards=10]="Yards",n[n.Angstroms=11]="Angstroms",n[n.Nanometers=12]="Nanometers",n[n.Microns=13]="Microns",n[n.Decimeters=14]="Decimeters",n[n.Decameters=15]="Decameters",n[n.Hectometers=16]="Hectometers",n[n.Gigameters=17]="Gigameters",n[n.AstronomicalUnits=18]="AstronomicalUnits",n[n.LightYears=19]="LightYears",n[n.Parsecs=20]="Parsecs",n[n.USSurveyFeet=21]="USSurveyFeet",n[n.USSurveyInch=22]="USSurveyInch",n[n.USSurveyYard=23]="USSurveyYard",n[n.USSurveyMile=24]="USSurveyMile"}(b0||(b0={})),function(n){n.Continuous="Continuous"}(L1||(L1={})),typeof SuppressedError=="function"&&SuppressedError;class jst{constructor(t){In.set(this,void 0),this.name=t,Ip(this,In,[])}clear(){kn(this,In,"f").length=0}string(t){_O(t).forEach(e=>kn(this,In,"f").push(ti(1e3,e)))}beginList(){kn(this,In,"f").push(ti(1002,"{"))}endList(){kn(this,In,"f").push(ti(1002,"}"))}layerName(t){kn(this,In,"f").push(ti(1003,t))}binaryData(t){_O(t).forEach(e=>kn(this,In,"f").push(ti(1004,e)))}databaseHandle(t){kn(this,In,"f").push(ti(1005,t))}point(t){kn(this,In,"f").push(ti(1010,t.x)),kn(this,In,"f").push(ti(1020,t.y)),kn(this,In,"f").push(ti(1030,t.z))}position(t){kn(this,In,"f").push(ti(1011,t.x)),kn(this,In,"f").push(ti(1021,t.y)),kn(this,In,"f").push(ti(1031,t.z))}displacement(t){kn(this,In,"f").push(ti(1012,t.x)),kn(this,In,"f").push(ti(1022,t.y)),kn(this,In,"f").push(ti(1032,t.z))}direction(t){kn(this,In,"f").push(ti(1013,t.x)),kn(this,In,"f").push(ti(1023,t.y)),kn(this,In,"f").push(ti(1033,t.z))}real(t){kn(this,In,"f").push(ti(1040,t))}distance(t){kn(this,In,"f").push(ti(1041,t))}scale(t){kn(this,In,"f").push(ti(1042,t))}integer(t){kn(this,In,"f").push(ti(1070,t))}long(t){kn(this,In,"f").push(ti(1071,t))}dxfy(t){t.push(1001,this.name),t.push(1002,"{"),kn(this,In,"f").forEach(e=>t.push(e.code,e.value)),t.push(1002,"}")}}In=new WeakMap;class ce{set angle(t){this.patternsData.forEach(e=>e.lineAngle=t)}constructor(t){this.name=t,this.patternsData=[],this.scale=1}dxfy(t){t.push(78,this.patternsData.length);for(const e of this.patternsData){t.push(53,e.lineAngle),t.push(43,e.x),t.push(44,e.y),t.push(45,e.offsetX*this.scale),t.push(46,e.offsetY*this.scale),t.push(79,e.dashLengthItems.length);for(const i of e.dashLengthItems)t.push(49,i*this.scale)}}add(t){this.patternsData.push(t)}}const le=new Map,Xb=new ce("ANGLE");Xb.add({lineAngle:0,x:0,y:0,offsetX:.275,offsetY:.2,dashLengthItems:[-.075]}),Xb.add({lineAngle:90,x:0,y:0,offsetX:.275,offsetY:.2,dashLengthItems:[-.075]}),le.set("ANGLE",Xb);const bO=new ce("ANSI31");bO.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:1.25,dashLengthItems:[]}),le.set("ANSI31",bO);const wO=new ce("ANSI32");wO.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),le.set("ANSI32",wO);const Yb=new ce("ANSI33");Yb.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),Yb.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),le.set("ANSI33",Yb);const qb=new ce("ANSI34");qb.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),qb.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-1.5875]}),le.set("ANSI34",qb);const xp=new ce("ANSI35");xp.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),xp.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),xp.add({lineAngle:45,x:8.98026,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),xp.add({lineAngle:45,x:13.4704,y:0,offsetX:0,offsetY:19.05,dashLengthItems:[]}),le.set("ANSI35",xp);const Kb=new ce("ANSI36");Kb.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Kb.add({lineAngle:45,x:4.49013,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[7.9375,-1.5875,0,-1.5875]}),le.set("ANSI36",Kb);const EO=new ce("ANSI37");EO.add({lineAngle:45,x:0,y:0,offsetX:5.55625,offsetY:3.175,dashLengthItems:[7.9375,-1.5875,0,-1.5875]}),le.set("ANSI37",EO);const Zb=new ce("ANSI38");Zb.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Zb.add({lineAngle:135,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),le.set("ANSI38",Zb);const Qb=new ce("AR_B816");Qb.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),Qb.add({lineAngle:135,x:0,y:0,offsetX:6.35,offsetY:3.175,dashLengthItems:[7.9375,-4.7625]}),le.set("AR_B816",Qb);const Jb=new ce("AR_B816C");Jb.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[]}),Jb.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[203.2,-203.2]}),le.set("AR_B816C",Jb);const yp=new ce("AR_B88");yp.add({lineAngle:0,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[396.875,-9.525]}),yp.add({lineAngle:0,x:-203.2,y:9.525,offsetX:203.2,offsetY:203.2,dashLengthItems:[396.875,-9.525]}),yp.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[-212.725,193.675]}),yp.add({lineAngle:90,x:-9.525,y:0,offsetX:203.2,offsetY:203.2,dashLengthItems:[-212.725,193.675]}),le.set("AR_B88",yp);const tw=new ce("AR_BRELM");tw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[]}),tw.add({lineAngle:90,x:0,y:0,offsetX:203.2,offsetY:101.6,dashLengthItems:[203.2,-203.2]}),le.set("AR_BRELM",tw);const Jo=new ce("AR_BRSTD");Jo.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:135.484,dashLengthItems:[193.675,-9.525]}),Jo.add({lineAngle:0,x:0,y:57.15,offsetX:0,offsetY:135.484,dashLengthItems:[193.675,-9.525]}),Jo.add({lineAngle:0,x:50.8,y:67.7418,offsetX:0,offsetY:135.484,dashLengthItems:[92.075,-9.525]}),Jo.add({lineAngle:0,x:50.8,y:124.892,offsetX:0,offsetY:135.484,dashLengthItems:[92.075,-9.525]}),Jo.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[57.15,-78.334]}),Jo.add({lineAngle:90,x:-9.525,y:0,offsetX:0,offsetY:203.2,dashLengthItems:[57.15,-78.334]}),Jo.add({lineAngle:90,x:50.8,y:67.7418,offsetX:0,offsetY:101.6,dashLengthItems:[57.15,-78.334]}),Jo.add({lineAngle:90,x:41.275,y:67.7418,offsetX:0,offsetY:101.6,dashLengthItems:[57.15,-78.334]}),le.set("AR_BRSTD",Jo);const ew=new ce("AR_CONC");ew.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:67.7418,dashLengthItems:[]}),ew.add({lineAngle:90,x:0,y:0,offsetX:67.7418,offsetY:101.6,dashLengthItems:[67.7418,-67.7418]}),le.set("AR_CONC",ew);const rs=new ce("AR_HBONE");rs.add({lineAngle:50,x:0,y:0,offsetX:104.896,offsetY:-149.807,dashLengthItems:[19.05,-209.55]}),rs.add({lineAngle:355,x:0,y:0,offsetX:-51.76101082,offsetY:187.25814969,dashLengthItems:[15.24,-167.64058417]}),rs.add({lineAngle:100.4514447,x:15.182007,y:-1.3282535,offsetX:145.5569059,offsetY:-176.270089,dashLengthItems:[16.1900088,-178.0902446]}),rs.add({lineAngle:46.1842,x:0,y:50.8,offsetX:157.343,offsetY:-224.71,dashLengthItems:[28.575,-314.325]}),rs.add({lineAngle:96.63555761,x:22.5899,y:47.2965,offsetX:218.33577212,offsetY:-264.40480444,dashLengthItems:[24.28502314,-267.13560816]}),rs.add({lineAngle:351.18415117,x:0,y:50.8,offsetX:196.67912063,offsetY:280.88740361,dashLengthItems:[22.85996707,-251.45973192]}),rs.add({lineAngle:21,x:25.4,y:38.1,offsetX:104.89565868,offsetY:-149.80652586,dashLengthItems:[19.05,-209.55]}),rs.add({lineAngle:326,x:25.4,y:38.1,offsetX:-51.7604,offsetY:187.258,dashLengthItems:[15.24,-167.64]}),rs.add({lineAngle:71.451445,x:38.0345326,y:29.5779001,offsetX:145.5567546,offsetY:-176.2700748,dashLengthItems:[16.1900088,-178.0899376]}),rs.add({lineAngle:37.5,x:0,y:0,offsetX:53.9242,offsetY:65.2018,dashLengthItems:[0,-165.608,0,-170.18,0,-168.275]}),rs.add({lineAngle:7.5,x:0,y:0,offsetX:79.3242,offsetY:90.6018,dashLengthItems:[0,-97.028,0,-161.798,0,-64.135]}),rs.add({lineAngle:-32.5,x:-56.642,y:0,offsetX:117.434,offsetY:68.0212,dashLengthItems:[0,-63.5,0,-198.12,0,-262.89]}),rs.add({lineAngle:-42.5,x:-82.042,y:0,offsetX:92.0344,offsetY:118.821,dashLengthItems:[0,-82.55,0,-131.572,0,-186.69]}),le.set("AR_HBONE",rs);const nw=new ce("AR_PARQ1");nw.add({lineAngle:45,x:0,y:0,offsetX:101.6,offsetY:101.6,dashLengthItems:[304.8,-101.6]}),nw.add({lineAngle:135,x:71.842,y:71.842,offsetX:101.6,offsetY:-101.6,dashLengthItems:[304.8,-101.6]}),le.set("AR_PARQ1",nw);const Mr=new ce("AR_RROOF");Mr.add({lineAngle:90,x:0,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:90,x:50.8,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:90,x:101.6,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:90,x:152.4,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:90,x:203.2,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:90,x:254,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:90,x:304.8,y:0,offsetX:304.8,offsetY:304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:0,x:0,y:304.8,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:0,x:0,y:355.6,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:0,x:0,y:406.4,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:0,x:0,y:457.2,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:0,x:0,y:508,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:0,x:0,y:558.8,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),Mr.add({lineAngle:0,x:0,y:609.6,offsetX:304.8,offsetY:-304.8,dashLengthItems:[304.8,-304.8]}),le.set("AR_RROOF",Mr);const lv=new ce("AR_RSHKE");lv.add({lineAngle:0,x:0,y:0,offsetX:55.88,offsetY:25.4,dashLengthItems:[381,-50.8,127,-25.4]}),lv.add({lineAngle:0,x:33.782,y:12.7,offsetX:-25.4,offsetY:33.782,dashLengthItems:[76.2,-8.382,152.4,-19.05]}),lv.add({lineAngle:0,x:12.7,y:21.59,offsetX:132.08,offsetY:17.018,dashLengthItems:[203.2,-35.56,101.6,-25.4]}),le.set("AR_RSHKE",lv);const oo=new ce("AR_SAND");oo.add({lineAngle:0,x:0,y:0,offsetX:647.7,offsetY:304.8,dashLengthItems:[152.4,-127,177.8,-76.2,228.6,-101.6]}),oo.add({lineAngle:0,x:152.4,y:12.7,offsetX:647.7,offsetY:304.8,dashLengthItems:[127,-482.6,101.6,-152.4]}),oo.add({lineAngle:0,x:457.2,y:-19.05,offsetX:647.7,offsetY:304.8,dashLengthItems:[76.2,-787.4]}),oo.add({lineAngle:90,x:0,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),oo.add({lineAngle:90,x:152.4,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[285.75,-933.45]}),oo.add({lineAngle:90,x:279.4,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[266.7,-952.5]}),oo.add({lineAngle:90,x:457.2,y:-19.05,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),oo.add({lineAngle:90,x:533.4,y:-19.05,offsetX:304.8,offsetY:215.9,dashLengthItems:[292.1,-927.1]}),oo.add({lineAngle:90,x:762,y:0,offsetX:304.8,offsetY:215.9,dashLengthItems:[279.4,-939.8]}),le.set("AR_SAND",oo);const _p=new ce("BOX");_p.add({lineAngle:37.5,x:0,y:0,offsetX:28.5242,offsetY:39.8018,dashLengthItems:[0,-38.608,0,-43.18,0,-41.275]}),_p.add({lineAngle:7.5,x:0,y:0,offsetX:53.9242,offsetY:65.2018,dashLengthItems:[0,-20.828,0,-34.798,0,-13.335]}),_p.add({lineAngle:-32.5,x:-31.242,y:0,offsetX:66.6344,offsetY:42.6212,dashLengthItems:[0,-12.7,0,-45.72,0,-59.69]}),_p.add({lineAngle:-42.5,x:-31.242,y:0,offsetX:41.2344,offsetY:68.0212,dashLengthItems:[0,-6.35,0,-29.972,0,-34.29]}),le.set("BOX",_p);const tl=new ce("BRASS");tl.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[]}),tl.add({lineAngle:90,x:6.35,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[]}),tl.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[-6.35,6.35]}),tl.add({lineAngle:0,x:0,y:6.35,offsetX:0,offsetY:25.4,dashLengthItems:[-6.35,6.35]}),tl.add({lineAngle:0,x:0,y:12.7,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),tl.add({lineAngle:0,x:0,y:19.05,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),tl.add({lineAngle:90,x:12.7,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),tl.add({lineAngle:90,x:19.05,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[6.35,-6.35]}),le.set("BRASS",tl);const iw=new ce("BRICK");iw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),iw.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-1.5875]}),le.set("BRICK",iw);const cv=new ce("BRSTONE");cv.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),cv.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:12.7,dashLengthItems:[6.35,-6.35]}),cv.add({lineAngle:90,x:6.35,y:0,offsetX:0,offsetY:12.7,dashLengthItems:[-6.35,6.35]}),le.set("BRSTONE",cv);const el=new ce("CLAY");el.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:8.382,dashLengthItems:[]}),el.add({lineAngle:90,x:22.86,y:0,offsetX:8.382,offsetY:12.7,dashLengthItems:[8.382,-8.382]}),el.add({lineAngle:90,x:20.32,y:0,offsetX:8.382,offsetY:12.7,dashLengthItems:[8.382,-8.382]}),el.add({lineAngle:0,x:22.86,y:1.397,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),el.add({lineAngle:0,x:22.86,y:2.794,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),el.add({lineAngle:0,x:22.86,y:4.191,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),el.add({lineAngle:0,x:22.86,y:5.588,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),el.add({lineAngle:0,x:22.86,y:6.985,offsetX:12.7,offsetY:8.382,dashLengthItems:[-22.86,2.54]}),le.set("CLAY",el);const bp=new ce("CORK");bp.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),bp.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),bp.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:4.7625,dashLengthItems:[]}),bp.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:4.7625,dashLengthItems:[4.7625,-3.175]}),le.set("CORK",bp);const wp=new ce("CROSS");wp.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),wp.add({lineAngle:135,x:1.5875,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),wp.add({lineAngle:135,x:2.38125,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),wp.add({lineAngle:135,x:3.175,y:-1.5875,offsetX:0,offsetY:8.98026,dashLengthItems:[4.49013,-4.49013]}),le.set("CROSS",wp);const rw=new ce("DASH");rw.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:6.35,dashLengthItems:[3.175,-9.525]}),rw.add({lineAngle:90,x:1.5875,y:-1.5875,offsetX:6.35,offsetY:6.35,dashLengthItems:[3.175,-9.525]}),le.set("DASH",rw);const AO=new ce("DOLMIT");AO.add({lineAngle:0,x:0,y:0,offsetX:3.175,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),le.set("DOLMIT",AO);const sw=new ce("DOTS");sw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),sw.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:17.9605,dashLengthItems:[8.980256121069154,-17.960512242138307]}),le.set("DOTS",sw);const SO=new ce("EARTH");SO.add({lineAngle:0,x:0,y:0,offsetX:.79375,offsetY:1.5875,dashLengthItems:[0,-1.5875]}),le.set("EARTH",SO);const su=new ce("ESCHER");su.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),su.add({lineAngle:0,x:0,y:2.38125,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),su.add({lineAngle:0,x:0,y:4.7625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),su.add({lineAngle:90,x:.79375,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),su.add({lineAngle:90,x:3.175,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),su.add({lineAngle:90,x:5.55625,y:5.55625,offsetX:6.35,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),le.set("ESCHER",su);const oi=new ce("FLEX");oi.add({lineAngle:60,x:0,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),oi.add({lineAngle:180,x:0,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),oi.add({lineAngle:300,x:0,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[27.94,-2.54]}),oi.add({lineAngle:60,x:2.54,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:300,x:2.54,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:60,x:-1.27,y:2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:180,x:-1.27,y:2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:300,x:-1.27,y:-2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:180,x:-1.27,y:-2.199704516,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:60,x:-10.16,y:0,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:300,x:-10.16,y:0,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:60,x:5.08,y:-8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:180,x:5.08,y:-8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:300,x:5.08,y:8.7988180894,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:180,x:5.08,y:8.7988180894,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[5.08,-25.4]}),oi.add({lineAngle:0,x:5.08,y:4.3994090574,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),oi.add({lineAngle:0,x:5.08,y:-4.3994090574,offsetX:-15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),oi.add({lineAngle:120,x:1.27,y:6.5991135734,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),oi.add({lineAngle:120,x:-6.35,y:2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),oi.add({lineAngle:240,x:-6.35,y:-2.199704516,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),oi.add({lineAngle:240,x:1.27,y:-6.5991135734,offsetX:15.24,offsetY:26.3964542936,dashLengthItems:[17.78,-12.7]}),le.set("FLEX",oi);const aw=new ce("GOST_GLASS");aw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[6.35,-6.35]}),aw.add({lineAngle:45,x:6.35,y:0,offsetX:4.490128053,offsetY:4.490128053,dashLengthItems:[1.5875,-5.8052561314,1.5875,-8.9802561314]}),le.set("GOST_GLASS",aw);const uv=new ce("GOST_WOOD");uv.add({lineAngle:45,x:0,y:0,offsetX:6,offsetY:-6,dashLengthItems:[5,-7]}),uv.add({lineAngle:45,x:2.12132,y:0,offsetX:6,offsetY:-6,dashLengthItems:[2,-10]}),uv.add({lineAngle:45,x:0,y:2.12132,offsetX:6,offsetY:-6,dashLengthItems:[2,-10]}),le.set("GOST_WOOD",uv);const fv=new ce("GOST_GROUND");fv.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:-6,dashLengthItems:[10,-2]}),fv.add({lineAngle:90,x:2,y:-2,offsetX:0,offsetY:-6,dashLengthItems:[6,-1.5,3,-1.5]}),fv.add({lineAngle:90,x:4,y:-5,offsetX:0,offsetY:-6,dashLengthItems:[10,-2]}),le.set("GOST_GROUND",fv);const dv=new ce("GRASS");dv.add({lineAngle:45,x:0,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),dv.add({lineAngle:45,x:3,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),dv.add({lineAngle:45,x:6,y:0,offsetX:10,offsetY:-10,dashLengthItems:[20]}),le.set("GRASS",dv);const hv=new ce("GRATE");hv.add({lineAngle:90,x:0,y:0,offsetX:17.96051224,offsetY:17.96051224,dashLengthItems:[4.7625,-31.15852448]}),hv.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[4.7625,-20.6375]}),hv.add({lineAngle:135,x:0,y:0,offsetX:0,offsetY:25.4,dashLengthItems:[4.7625,-20.6375]}),le.set("GRATE",hv);const ow=new ce("GRAVEL");ow.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:.79375,dashLengthItems:[]}),ow.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),le.set("GRAVEL",ow);const Xe=new ce("HEX");Xe.add({lineAngle:228.0127875,x:18.288,y:25.4,offsetX:305.85067529778,offsetY:1.88796713245,dashLengthItems:[3.4172144,-338.30483639565]}),Xe.add({lineAngle:184.969741,x:16.002,y:22.86,offsetX:-305.8545235377,offsetY:1.10019612724,dashLengthItems:[5.8640472,-580.54048893524]}),Xe.add({lineAngle:132.5104471,x:10.16,y:22.352,offsetX:-377.59492241548,offsetY:1.56030959675,dashLengthItems:[4.1348152,-409.347227941]}),Xe.add({lineAngle:267.273689,x:.254,y:16.002,offsetX:-508.63316875916,offsetY:1.20815479432,dashLengthItems:[5.3400452,-528.66437425738]}),Xe.add({lineAngle:292.83365418,x:0,y:10.668,offsetX:-330.19770134945,offsetY:1.23208097566,dashLengthItems:[5.236337,-518.39807745344]}),Xe.add({lineAngle:357.273689,x:2.032,y:5.842,offsetX:-508.63316875916,offsetY:1.20815479432,dashLengthItems:[5.3400452,-528.66437425738]}),Xe.add({lineAngle:37.69424047,x:7.366,y:5.588,offsetX:-416.58997273292,offsetY:.91357450169,dashLengthItems:[7.0619366,-699.13115314247]}),Xe.add({lineAngle:72.25532837,x:12.954,y:9.906,offsetX:586.40373773403,offsetY:.96766293399,dashLengthItems:[6.6671952,-660.05256601905]}),Xe.add({lineAngle:121.42956562,x:14.986,y:16.256,offsetX:387.71230339293,offsetY:1.2040754753,dashLengthItems:[5.35813,-530.45545698712]}),Xe.add({lineAngle:175.2363583,x:12.192,y:20.828,offsetX:-280.5442400419,offsetY:2.10935518695,dashLengthItems:[6.1171328,-299.7393695]}),Xe.add({lineAngle:222.3974378,x:6.096,y:21.336,offsetX:413.48123885686,offsetY:.81554484621,dashLengthItems:[7.9107792,-783.16772512177]}),Xe.add({lineAngle:138.81407483,x:25.4,y:15.748,offsetX:234.164238558,offsetY:2.38943100688,dashLengthItems:[2.7000454,-267.30565824344]}),Xe.add({lineAngle:171.4692344,x:23.368,y:17.526,offsetX:-334.082478726,offsetY:1.25594916784,dashLengthItems:[5.1368198,-508.5463899704]}),Xe.add({lineAngle:225,x:18.288,y:18.288,offsetX:17.96051224214,offsetY:17.96051224214,dashLengthItems:[3.5920934,-32.32893108428]}),Xe.add({lineAngle:203.19859051,x:16.51,y:21.336,offsetX:-136.74251918,offsetY:3.33518339548,dashLengthItems:[1.9344132,-191.50622368894]}),Xe.add({lineAngle:291.80140949,x:14.732,y:20.574,offsetX:-80.18324702488,offsetY:4.71666158921,dashLengthItems:[2.7356562,-134.0475299]}),Xe.add({lineAngle:30.96375653,x:15.748,y:18.034,offsetX:91.47734531502,offsetY:4.35606406258,dashLengthItems:[4.4431966,-143.6629815291]}),Xe.add({lineAngle:161.56505118,x:19.558,y:20.32,offsetX:-56.2252967978,offsetY:8.03218525675,dashLengthItems:[3.2128714,-77.10898116828]}),Xe.add({lineAngle:16.389540334,x:0,y:20.574,offsetX:265.17991128726,offsetY:1.43340492604,dashLengthItems:[4.50088,-445.58826672539]}),Xe.add({lineAngle:70.34617594,x:4.318,y:21.844,offsetX:-297.29446803469,offsetY:1.70858889651,dashLengthItems:[3.7759894,-373.822156782]}),Xe.add({lineAngle:293.19859051,x:19.558,y:25.4,offsetX:-136.7425191801,offsetY:3.33518339548,dashLengthItems:[3.868801,-189.57183588894]}),Xe.add({lineAngle:343.61045967,x:21.082,y:21.844,offsetX:-265.17991128725,offsetY:1.433404926,dashLengthItems:[4.50088,-445.5882667254]}),Xe.add({lineAngle:339.44395478,x:0,y:4.826,offsetX:-136.75087638398,offsetY:2.97284513779,dashLengthItems:[4.340352,-212.67734313106]}),Xe.add({lineAngle:294.7751406,x:4.064,y:3.302,offsetX:-306.90424056705,offsetY:1.77401295215,dashLengthItems:[3.6367212,-360.0359338072]}),Xe.add({lineAngle:66.80140949,x:19.812,y:0,offsetX:136.74251918012,offsetY:3.33518339452,dashLengthItems:[3.868801,-189.57183588894]}),Xe.add({lineAngle:17.35402464,x:21.336,y:3.556,offsetX:-345.47402804977,offsetY:1.51523696536,dashLengthItems:[4.2578274,-421.523759802]}),Xe.add({lineAngle:69.44395478,x:7.366,y:0,offsetX:-136.75087638396,offsetY:2.97284513874,dashLengthItems:[2.170176,-214.84751913106]}),Xe.add({lineAngle:101.309932474,x:18.288,y:0,offsetX:104.60834648271,offsetY:4.98134983255,dashLengthItems:[1.295146,-128.21994964526]}),Xe.add({lineAngle:165.963756532,x:18.034,y:1.27,offsetX:-80.085263387,offsetY:6.16040487582,dashLengthItems:[5.236337,-99.49054589069]}),Xe.add({lineAngle:186.00900596,x:12.954,y:2.54,offsetX:-255.26337856879,offsetY:1.32949676118,dashLengthItems:[4.85267,-480.41364863337]}),Xe.add({lineAngle:303.69006753,x:15.748,y:15.748,offsetX:-56.35753993648,offsetY:7.0446924921,dashLengthItems:[3.6632388,-87.9177635968]}),Xe.add({lineAngle:353.15722659,x:17.78,y:12.7,offsetX:434.77679606606,offsetY:1.0087628707,dashLengthItems:[6.3955676,-633.16009065031]}),Xe.add({lineAngle:60.9453959,x:24.13,y:11.938,offsetX:-204.76648550216,offsetY:2.46706609031,dashLengthItems:[2.6150824,-258.8939231811]}),Xe.add({lineAngle:90,x:25.4,y:14.224,offsetX:25.4,offsetY:25.4,dashLengthItems:[1.524,-23.876]}),Xe.add({lineAngle:120.25643716,x:12.446,y:3.302,offsetX:-204.77318477297,offsetY:1.8283320086,dashLengthItems:[3.5286696,-349.339407732]}),Xe.add({lineAngle:48.0127875,x:10.668,y:6.35,offsetX:305.85067529778,offsetY:1.88796713138,dashLengthItems:[6.8344288,-334.88762199565]}),Xe.add({lineAngle:0,x:15.24,y:11.43,offsetX:25.4,offsetY:25.4,dashLengthItems:[6.604,-18.796]}),Xe.add({lineAngle:325.3048465,x:21.844,y:11.43,offsetX:310.04235091354,offsetY:-1.6064370526,dashLengthItems:[4.0160956,-397.5931672414]}),Xe.add({lineAngle:254.0546041,x:25.146,y:9.144,offsetX:104.6687497289,offsetY:3.48895832444,dashLengthItems:[3.6982908,-181.21650038772]}),Xe.add({lineAngle:207.64597536,x:24.13,y:5.588,offsetX:545.36007557253,offsetY:1.07143433066,dashLengthItems:[6.021451,-596.12464422938]}),Xe.add({lineAngle:175.42607874,x:18.796,y:2.794,offsetX:331.1739336186,offsetY:1.01276432357,dashLengthItems:[6.3702946,-630.6584645624]}),le.set("HEX",Xe);const pv=new ce("HONEY");pv.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),pv.add({lineAngle:120,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),pv.add({lineAngle:60,x:3.175,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-6.35]}),le.set("HONEY",pv);const mv=new ce("HOUND");mv.add({lineAngle:0,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[3.175,-6.35]}),mv.add({lineAngle:120,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[3.175,-6.35]}),mv.add({lineAngle:60,x:0,y:0,offsetX:4.7625,offsetY:2.749630645,dashLengthItems:[-6.35,3.175]}),le.set("HOUND",mv);const lw=new ce("INSUL");lw.add({lineAngle:0,x:0,y:0,offsetX:6.35,offsetY:1.5875,dashLengthItems:[25.4,-12.7]}),lw.add({lineAngle:90,x:0,y:0,offsetX:-6.35,offsetY:1.5875,dashLengthItems:[25.4,-12.7]}),le.set("INSUL",lw);const gv=new ce("ACAD_ISO02W100");gv.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:9.525,dashLengthItems:[]}),gv.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:9.525,dashLengthItems:[3.175,-3.175]}),gv.add({lineAngle:0,x:0,y:6.35,offsetX:0,offsetY:9.525,dashLengthItems:[3.175,-3.175]}),le.set("ACAD_ISO02W100",gv);const TO=new ce("ACAD_ISO03W100");TO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3]}),le.set("ACAD_ISO03W100",TO);const CO=new ce("ACAD_ISO04W100");CO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-18]}),le.set("ACAD_ISO04W100",CO);const DO=new ce("ACAD_ISO05W100");DO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3]}),le.set("ACAD_ISO05W100",DO);const OO=new ce("ACAD_ISO06W100");OO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3,.5,-3]}),le.set("ACAD_ISO06W100",OO);const cw=new ce("ACAD_ISO07W100");cw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,.5,-3,.5,-6.5]}),cw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-34,.5,-3]}),le.set("ACAD_ISO07W100",cw);const RO=new ce("ACAD_ISO08W100");RO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[.5,-3]}),le.set("ACAD_ISO08W100",RO);const NO=new ce("ACAD_ISO09W100");NO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,6,-3]}),le.set("ACAD_ISO09W100",NO);const LO=new ce("ACAD_ISO10W100");LO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[24,-3,6,-3,6,-3]}),le.set("ACAD_ISO10W100",LO);const IO=new ce("ACAD_ISO11W100");IO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3]}),le.set("ACAD_ISO11W100",IO);const kO=new ce("ACAD_ISO12W100");kO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-3]}),le.set("ACAD_ISO12W100",kO);const MO=new ce("ACAD_ISO13W100");MO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3,.5,-3]}),le.set("ACAD_ISO13W100",MO);const uw=new ce("ACAD_ISO14W100");uw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-6.5]}),uw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-33.5,.5,-3]}),le.set("ACAD_ISO14W100",uw);const fw=new ce("ACAD_ISO15W100");fw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,.5,-3,.5,-6.5]}),fw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-22,.5,-3]}),le.set("ACAD_ISO15W100",fw);const dw=new ce("JIS_LC_20");dw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[12,-3,12,-3,.5,-10]}),dw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5,dashLengthItems:[-33.5,.5,-3,.5,-3]}),le.set("JIS_LC_20",dw);const hw=new ce("JIS_LC_20A");hw.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),hw.add({lineAngle:45,x:.4,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),le.set("JIS_LC_20A",hw);const pw=new ce("JIS_LC_8");pw.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),pw.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:20,dashLengthItems:[]}),le.set("JIS_LC_8",pw);const mw=new ce("JIS_LC_8A");mw.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),mw.add({lineAngle:45,x:.4,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),le.set("JIS_LC_8A",mw);const gw=new ce("JIS_RC_10");gw.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),gw.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:7.8,dashLengthItems:[]}),le.set("JIS_RC_10",gw);const vv=new ce("JIS_RC_15");vv.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),vv.add({lineAngle:45,x:.725,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),vv.add({lineAngle:45,x:1.45,y:0,offsetX:0,offsetY:10,dashLengthItems:[]}),le.set("JIS_RC_15",vv);const xv=new ce("JIS_RC_18");xv.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),xv.add({lineAngle:45,x:.725,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),xv.add({lineAngle:45,x:1.45,y:0,offsetX:0,offsetY:15,dashLengthItems:[]}),le.set("JIS_RC_18",xv);const yv=new ce("JIS_RC_30");yv.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),yv.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),yv.add({lineAngle:45,x:2,y:0,offsetX:0,offsetY:18,dashLengthItems:[]}),le.set("JIS_RC_30",yv);const _v=new ce("JIS_STN_1E");_v.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),_v.add({lineAngle:45,x:1,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),_v.add({lineAngle:45,x:2,y:0,offsetX:0,offsetY:30,dashLengthItems:[]}),le.set("JIS_STN_1E",_v);const vw=new ce("JIS_STN_2_5");vw.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:1,dashLengthItems:[]}),vw.add({lineAngle:45,x:.705,y:0,offsetX:0,offsetY:1,dashLengthItems:[1,-.5]}),le.set("JIS_STN_2_5",vw);const xw=new ce("JIS_WOOD");xw.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:2.5,dashLengthItems:[]}),xw.add({lineAngle:45,x:1.765,y:0,offsetX:0,offsetY:2.5,dashLengthItems:[1.2,-.5]}),le.set("JIS_WOOD",xw);const FO=new ce("LINE");FO.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:.70710678,dashLengthItems:[]}),le.set("LINE",FO);const PO=new ce("MUDST");PO.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),le.set("MUDST",PO);const BO=new ce("NET");BO.add({lineAngle:0,x:0,y:0,offsetX:12.7,offsetY:6.35,dashLengthItems:[6.35,-6.35,0,-6.35,0,-6.35]}),le.set("NET",BO);const yw=new ce("NET3");yw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),yw.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),le.set("NET3",yw);const bv=new ce("PLAST");bv.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),bv.add({lineAngle:60,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),bv.add({lineAngle:120,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),le.set("PLAST",bv);const wv=new ce("PLASTI");wv.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),wv.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:6.35,dashLengthItems:[]}),wv.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),le.set("PLASTI",wv);const Ep=new ce("SACNCR");Ep.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Ep.add({lineAngle:0,x:0,y:.79375,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Ep.add({lineAngle:0,x:0,y:1.5875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Ep.add({lineAngle:0,x:0,y:3.96875,offsetX:0,offsetY:6.35,dashLengthItems:[]}),le.set("SACNCR",Ep);const _w=new ce("SQUARE");_w.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:2.38125,dashLengthItems:[]}),_w.add({lineAngle:45,x:1.6838,y:0,offsetX:0,offsetY:2.38125,dashLengthItems:[0,-2.38125]}),le.set("SQUARE",_w);const bw=new ce("STARS");bw.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),bw.add({lineAngle:90,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[3.175,-3.175]}),le.set("STARS",bw);const Ev=new ce("STEEL");Ev.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),Ev.add({lineAngle:60,x:0,y:0,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),Ev.add({lineAngle:120,x:1.5875,y:2.7496306704,offsetX:0,offsetY:5.4992613154,dashLengthItems:[3.175,-3.175]}),le.set("STEEL",Ev);const ww=new ce("SWAMP");ww.add({lineAngle:45,x:0,y:0,offsetX:0,offsetY:3.175,dashLengthItems:[]}),ww.add({lineAngle:45,x:0,y:1.5875,offsetX:0,offsetY:3.175,dashLengthItems:[]}),le.set("SWAMP",ww);const au=new ce("TRANS");au.add({lineAngle:0,x:0,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[3.175,-22.225]}),au.add({lineAngle:90,x:1.5875,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.5875,-42.4065904724]}),au.add({lineAngle:90,x:1.984375,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.27,-42.7240904724]}),au.add({lineAngle:90,x:1.190625,y:0,offsetX:21.9970452362,offsetY:12.7,dashLengthItems:[1.27,-42.7240904724]}),au.add({lineAngle:60,x:2.38125,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[1.016,-24.384]}),au.add({lineAngle:120,x:.79375,y:0,offsetX:12.7,offsetY:21.9970452362,dashLengthItems:[1.016,-24.384]}),le.set("TRANS",au);const Ew=new ce("TRIANG");Ew.add({lineAngle:0,x:0,y:0,offsetX:0,offsetY:6.35,dashLengthItems:[]}),Ew.add({lineAngle:0,x:0,y:3.175,offsetX:0,offsetY:6.35,dashLengthItems:[3.175,-3.175]}),le.set("TRIANG",Ew);const Av=new ce("ZIGZAG");Av.add({lineAngle:60,x:0,y:0,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),Av.add({lineAngle:120,x:0,y:0,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),Av.add({lineAngle:0,x:-2.38125,y:4.1244459802,offsetX:4.7625,offsetY:8.2488919604,dashLengthItems:[4.7625,-4.7625]}),le.set("ZIGZAG",Av);class I1{static fromHex(t){return t.startsWith("#")&&(t=t.replace("#","")),parseInt(t,16)}static fromRGB(t,e,i){const r=[t,e,i].reduce((s,a)=>{const l=a.toString(16);return`${s}${l.length===1?"0"+l:l}`},"0x00");return I1.fromHex(r)}}class gi{constructor(t,e,i){this.type=t,this.subclassMarker=e,this.layerName=i?.layerName,this.handle=ds.next(),this.trueColor=i?.trueColor,this.inPaperSpace=!1,this.colorNumber=i?.colorNumber,this.visible=i?.visible,this.lineType=i?.lineType,this.lineTypeScale=i?.lineTypeScale,this.extrusion=i?.extrusion,this.xdatas=[]}boundingBox(){return $n.pointBBox(Ce())}addXData(t){const e=new jst(t);return this.xdatas.push(e),e}dxfy(t){var e,i,r;t.type(this.type),t.handle(this.handle),t.push(330,this.ownerBlockRecord),t.subclassMarker("AcDbEntity"),this.inPaperSpace&&t.push(67,Number(this.inPaperSpace)),t.push(420,this.trueColor),t.layerName(this.layerName||ad.layerZeroName),t.lineType(this.lineType),t.colorNumber(this.colorNumber),t.push(48,this.lineTypeScale),t.visibilty(this.visible),t.subclassMarker(this.subclassMarker),this.type!=="HATCH"&&(t.push(210,(e=this.extrusion)===null||e===void 0?void 0:e.x),t.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),t.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z)),this.dxfyChild(t),this.xdatas.forEach(s=>s.dxfy(t))}}var Al,wE,jO;(function(n){n[n.Default=0]="Default",n[n.Aligned=1]="Aligned",n[n.Angular=2]="Angular",n[n.Diameter=3]="Diameter",n[n.Radius=4]="Radius",n[n.Angular3Point=5]="Angular3Point",n[n.Ordinate=6]="Ordinate",n[n.ReferencedByThis=32]="ReferencedByThis",n[n.OrdinateType=64]="OrdinateType"})(Al||(Al={})),function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"}(wE||(wE={})),function(n){n[n.AtLeast=1]="AtLeast",n[n.Exact=2]="Exact"}(jO||(jO={}));class jd extends gi{constructor(t){super("DIMENSION","AcDbDimension",t),this.blockName=t?.blockName,this.definitionPoint=t?.definitionPoint,this.middlePoint=t?.middlePoint,this.dimensionType=Al.Default,this.attachmentPoint=t?.attachmentPoint||wE.MiddleCenter,this.textLineSpacingStyle=t?.textLineSpacingStyle,this.textLineSpacingFactor=t?.textLineSpacingFactor,this.ActualMeasurement=t?.ActualMeasurement,this.text=t?.text,this.rotation=t?.rotation,this.horizontalDirection=t?.horizontalDirection,this.styleName=t?.styleName}dxfyChild(t){t.push(2,this.blockName),t.point3d(this.definitionPoint),t.point3d(this.middlePoint,1),t.push(70,this.dimensionType),t.push(71,this.attachmentPoint),t.push(72,this.textLineSpacingStyle),t.push(41,this.textLineSpacingFactor),t.push(42,this.ActualMeasurement),t.push(1,this.text),t.push(53,this.rotation==="auto"?this.rotate():this.rotation),t.push(51,this.horizontalDirection),t.push(3,this.styleName)}}const k1=/[<>/\\":;?*|=`]/g;function kp(n){return n*Math.PI/180}function Ust(n,t){const e=function(i,r){return Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))}(n,t);return e===0?e:180*Math.asin(Math.abs(n.y-t.y)/e)/Math.PI}class zst extends jd{constructor(t,e,i){super(i),this.dimensionType=Al.Aligned,this.insertionPoint=i?.insertionPoint,this.fisrtPoint=t,this.secondPoint=e,this.offset(i?.offset)}offset(t){if(t==null)return;const[e,i]=function(s,a){const l=s.x-a.x;let u=0;return l!==0&&(u=(s.y-a.y)/l),[u,s.y-u*s.x]}(this.fisrtPoint,this.secondPoint),r=function(s,a){const[l,u]=a;return u-s*Math.sqrt(l*l+1)}(t,[e,i]);this.definitionPoint=function(s,a){const[l,u]=s,f=l??-1/l,d=a.y-f*a.x,p=f-l;let m=u-d;return p!==0&&(m=(u-d)/p),Ce(m,l*m+u,a.z)}([e,r],this.fisrtPoint)}rotate(){return Ust(this.fisrtPoint,this.secondPoint)}dxfyChild(t){super.dxfyChild(t),t.subclassMarker("AcDbAlignedDimension"),t.point3d(this.insertionPoint,2),t.point3d(this.fisrtPoint,3),t.point3d(this.secondPoint,4)}}class Hst extends jd{constructor(t,e,i,r){super(r),this.first=t,this.second=e,this.location=i,this.dimensionType=Al.Angular}rotate(){return 0}_update(){this.definitionPoint=this.second.end}dxfyChild(t){this._update(),super.dxfyChild(t),t.subclassMarker("AcDb2LineAngularDimension"),t.point3d(this.first.start,3),t.point3d(this.first.end,4),t.point3d(this.second.start,5),t.point3d(this.location,6)}}class $st extends jd{constructor(t,e,i,r){super(r),this.center=t,this.first=e,this.second=i,this.dimensionType=Al.Angular3Point}rotate(){return 0}dxfyChild(t){super.dxfyChild(t),t.subclassMarker("AcDb3PointAngularDimension"),t.point3d(this.first,3),t.point3d(this.second,4),t.point3d(this.center,5)}}class Gst extends jd{constructor(t,e,i){super(i),this.dimensionType=Al.Diameter,this.first=t,this.definitionPoint=e,this.leaderLength=i?.leaderLength}rotate(){return 0}dxfyChild(t){super.dxfyChild(t),t.subclassMarker("AcDbDiametricDimension"),t.point3d(this.first,5),t.push(40,this.leaderLength)}}class Vst extends jd{constructor(t,e,i){var r;super(i),this.dimensionType=Al.Default,this.insertionPoint=i?.insertionPoint,this.fisrtPoint=t,this.secondPoint=e,this.angle=(r=i?.angle)!==null&&r!==void 0?r:0,this.linearType=i?.linearType,this.offset(i?.offset)}offset(t){if(t==null)return;const e=kp(this.angle),i=this.fisrtPoint.x+t*Math.floor(Math.sin(e)),r=this.fisrtPoint.y+t*Math.floor(Math.cos(e));this.definitionPoint=Ce(i,r,0)}rotate(){return this.angle}dxfyChild(t){super.dxfyChild(t),t.subclassMarker("AcDbAlignedDimension"),t.point3d(this.insertionPoint,2),t.point3d(this.fisrtPoint,3),t.point3d(this.secondPoint,4),t.push(50,this.angle),t.push(52,this.linearType),t.subclassMarker("AcDbRotatedDimension")}}class Wst extends jd{constructor(t,e,i){super(i),this.dimensionType=Al.Radius,this.first=t,this.definitionPoint=e,this.leaderLength=i?.leaderLength}rotate(){return 0}dxfyChild(t){super.dxfyChild(t),t.subclassMarker("AcDbRadialDimension"),t.point3d(this.first,5),t.push(40,this.leaderLength)}}class Xst extends gi{get start(){return Ce(this.center.x+this.radius*Math.cos(kp(this.startAngle)),this.center.y+this.radius*Math.sin(kp(this.startAngle)))}get end(){return Ce(this.center.x+this.radius*Math.cos(kp(this.endAngle)),this.center.y+this.radius*Math.sin(kp(this.endAngle)))}constructor(t,e,i,r,s){super("ARC","AcDbCircle",s),this.center=t,this.radius=e,this.startAngle=i,this.endAngle=r}boundingBox(){return $n.centerRadiusBBox(this.center,this.radius)}dxfyChild(t){t.point3d(this.center),t.push(40,this.radius),t.subclassMarker("AcDbArc"),t.push(50,this.startAngle),t.push(51,this.endAngle)}}class Yst extends gi{constructor(t,e,i,r,s){super("ATTDEF","AcDbText",s),this.position=t,this.height=e,this.value=r,this.tag=i,this.textStyle="STANDARD",this.rotation=s?.rotation,this.obliqueAngle=s?.obliqueAngle,this.generationFlags=s?.generationFlags,this.horizontalAlignment=s?.horizontalAlignment,this.verticalAlignment=s?.verticalAlignment,this.secondAlignmentPoint=s?.secondAlignmentPoint,this.relativeXScaleFactor=s?.relativeXScaleFactor}boundingBox(){return $n.pointBBox(this.position)}dxfyChild(t){t.point3d(this.position),t.push(40,this.height),t.primaryText(this.value),t.push(50,this.rotation),t.push(41,this.relativeXScaleFactor),t.push(51,this.obliqueAngle),t.textStyle(this.textStyle),t.push(71,this.generationFlags),t.push(72,this.horizontalAlignment),this.secondAlignmentPoint&&(t.push(11,this.secondAlignmentPoint.x),t.push(21,this.secondAlignmentPoint.y),t.push(31,this.secondAlignmentPoint.z)),t.push(73,this.verticalAlignment),t.subclassMarker("AcDbAttributeDefinition"),t.push(280,0),t.push(3,""),t.push(2,this.tag),t.push(70,0)}}class qst extends gi{constructor(t,e,i,r,s){super("ATTRIB","AcDbText",s),this.position=t,this.height=e,this.value=r,this.tag=i,this.textStyle="STANDARD",this.rotation=s?.rotation,this.obliqueAngle=s?.obliqueAngle,this.generationFlags=s?.generationFlags,this.horizontalAlignment=s?.horizontalAlignment,this.verticalAlignment=s?.verticalAlignment,this.secondAlignmentPoint=s?.secondAlignmentPoint,this.relativeXScaleFactor=s?.relativeXScaleFactor}boundingBox(){return $n.pointBBox(this.position)}dxfyChild(t){t.point3d(this.position),t.push(40,this.height),t.primaryText(this.value),t.push(50,this.rotation),t.push(41,this.relativeXScaleFactor),t.push(51,this.obliqueAngle),t.textStyle(this.textStyle),t.push(71,this.generationFlags),t.push(72,this.horizontalAlignment),t.point3d(this.secondAlignmentPoint,1),t.push(73,this.verticalAlignment),t.subclassMarker("AcDbAttribute"),t.push(280,0),t.push(2,this.tag),t.push(70,0)}}class Kst extends gi{constructor(t,e,i){super("CIRCLE","AcDbCircle",i),this.center=t,this.radius=e}boundingBox(){return $n.centerRadiusBBox(this.center,this.radius)}dxfyChild(t){t.point3d(this.center),t.push(40,this.radius)}}class Zst extends gi{constructor(t,e,i,r,s,a){super("ELLIPSE","AcDbEllipse",a),this.center=t,this.endPointOfMajorAxis=e,this.ratioOfMinorAxisToMajorAxis=i,this.startParameter=r,this.endParameter=s}boundingBox(){const t=this.center.x,e=this.center.y,i=this.endPointOfMajorAxis.x,r=this.endPointOfMajorAxis.y,s=Math.sqrt(Math.pow(t-(t+i),2)+Math.pow(e-(e+r),2));return $n.centerRadiusBBox(this.center,s)}dxfyChild(t){t.point3d(this.center),t.point3d(this.endPointOfMajorAxis,1),t.push(40,this.ratioOfMinorAxisToMajorAxis),t.push(41,this.startParameter),t.push(42,this.endParameter)}}var na,w0,EE,os,Wp,AE,SE,TE,rl,M1,Xp,CE,DE,OE,RE,F1,UO,zO,HO,P1,NE,LE,IE,$O,GO,VO,WO,XO,cc,uc,kE,ME,B1,FE;(function(n){n[n.None=0]="None",n[n.First=1]="First",n[n.Second=2]="Second",n[n.Third=4]="Third",n[n.Fourth=8]="Fourth"})(na||(na={}));class Qst extends gi{constructor(t,e,i,r,s){super("3DFACE","AcDbFace",s),this.firstCorner=t,this.secondCorner=e,this.thirdCorner=i,this.fourthCorner=r,this.invisibleEdges=s?.invisibleEdges||na.None}setFirstEdgeVisible(t){this.setEdgeVisible(na.First,t)}setSecondEdgeVisible(t){this.setEdgeVisible(na.Second,t)}setThirdEdgeVisible(t){this.setEdgeVisible(na.Third,t)}setFourthEdgeVisible(t){this.setEdgeVisible(na.Fourth,t)}setEdgesVisible(t){this.invisibleEdges=t?na.None:na.First|na.Second|na.Third|na.Fourth}setEdgeVisible(t,e){e?this.invisibleEdges|=t:this.invisibleEdges===(this.invisibleEdges|t)&&(this.invisibleEdges^=t)}boundingBox(){return $n.verticesBBox([this.firstCorner,this.secondCorner,this.thirdCorner,this.fourthCorner])}dxfyChild(t){t.point3d(this.firstCorner),t.point3d(this.secondCorner,1),t.point3d(this.thirdCorner,2),t.point3d(this.fourthCorner,3),t.push(70,this.invisibleEdges)}}function ss(n,t,e){return e?{x:n,y:t,bulge:e}:{x:n,y:t}}(function(n){n.SOLID="SOLID",n.ANGLE="ANGLE",n.ANSI31="ANSI31",n.ANSI32="ANSI32",n.ANSI33="ANSI33",n.ANSI34="ANSI34",n.ANSI35="ANSI35",n.ANSI36="ANSI36",n.ANSI37="ANSI37",n.ANSI38="ANSI38",n.AR_B816="AR_B816",n.AR_B816C="AR_B816C",n.AR_B88="AR_B88",n.AR_BRELM="AR_BRELM",n.AR_BRSTD="AR_BRSTD",n.AR_CONC="AR_CONC",n.AR_HBONE="AR_HBONE",n.AR_PARQ1="AR_PARQ1",n.AR_RROOF="AR_RROOF",n.AR_RSHKE="AR_RSHKE",n.AR_SAND="AR_SAND",n.BOX="BOX",n.BRASS="BRASS",n.BRICK="BRICK",n.BRSTONE="BRSTONE",n.CLAY="CLAY",n.CORK="CORK",n.CROSS="CROSS",n.DASH="DASH",n.DOLMIT="DOLMIT",n.DOTS="DOTS",n.EARTH="EARTH",n.ESCHER="ESCHER",n.FLEX="FLEX",n.GOST_GLASS="GOST_GLASS",n.GOST_WOOD="GOST_WOOD",n.GOST_GROUND="GOST_GROUND",n.GRASS="GRASS",n.GRATE="GRATE",n.GRAVEL="GRAVEL",n.HEX="HEX",n.HONEY="HONEY",n.HOUND="HOUND",n.INSUL="INSUL",n.ACAD_ISO02W100="ACAD_ISO02W100",n.ACAD_ISO03W100="ACAD_ISO03W100",n.ACAD_ISO04W100="ACAD_ISO04W100",n.ACAD_ISO05W100="ACAD_ISO05W100",n.ACAD_ISO06W100="ACAD_ISO06W100",n.ACAD_ISO07W100="ACAD_ISO07W100",n.ACAD_ISO08W100="ACAD_ISO08W100",n.ACAD_ISO09W100="ACAD_ISO09W100",n.ACAD_ISO10W100="ACAD_ISO10W100",n.ACAD_ISO11W100="ACAD_ISO11W100",n.ACAD_ISO12W100="ACAD_ISO12W100",n.ACAD_ISO13W100="ACAD_ISO13W100",n.ACAD_ISO14W100="ACAD_ISO14W100",n.ACAD_ISO15W100="ACAD_ISO15W100",n.JIS_LC_20="JIS_LC_20",n.JIS_LC_20A="JIS_LC_20A",n.JIS_LC_8="JIS_LC_8",n.JIS_LC_8A="JIS_LC_8A",n.JIS_RC_10="JIS_RC_10",n.JIS_RC_15="JIS_RC_15",n.JIS_RC_18="JIS_RC_18",n.JIS_RC_30="JIS_RC_30",n.JIS_STN_1E="JIS_STN_1E",n.JIS_STN_2_5="JIS_STN_2_5",n.JIS_WOOD="JIS_WOOD",n.LINE="LINE",n.MUDST="MUDST",n.NET="NET",n.NET3="NET3",n.PLAST="PLAST",n.PLASTI="PLASTI",n.SACNCR="SACNCR",n.SQUARE="SQUARE",n.STARS="STARS",n.STEEL="STEEL",n.SWAMP="SWAMP",n.TRANS="TRANS",n.TRIANG="TRIANG",n.ZIGZAG="ZIGZAG"})(w0||(w0={})),function(n){n[n.UserDefined=0]="UserDefined",n[n.Predifined=1]="Predifined",n[n.Custom=2]="Custom"}(EE||(EE={}));class Aw{constructor(t){this.vertices=t||[]}add(t){this.vertices.push(t)}dxfy(t){const e=!!this.vertices.find(i=>i.bulge);t.push(72,Number(e)),t.push(73,1),t.push(93,this.vertices.length);for(const i of this.vertices)t.point2d(i),e&&t.push(42,i.bulge||0);t.push(97,0)}}(function(n){n[n.Default=0]="Default",n[n.External=1]="External",n[n.Polyline=2]="Polyline",n[n.Derived=4]="Derived",n[n.Textbox=8]="Textbox",n[n.Outermost=16]="Outermost"})(os||(os={}));class Sw{constructor(){this.pathTypeFlag=os.External|os.Derived,this.polylineBoundaries=[],this.edgesTypeDatas=[]}get length(){let t=0;return this.isPolyline()?t+=this.polylineBoundaries.length:this.isEdges()&&this.edgesTypeDatas.forEach(e=>{t+=e.edgesData.length}),t}addPolylineBoundary(t){(this.pathTypeFlag&os.Polyline)!==os.Polyline&&(this.pathTypeFlag|=os.Polyline),this.polylineBoundaries.push(t)}isPolyline(){return this.polylineBoundaries&&(this.pathTypeFlag&os.Polyline)===os.Polyline}isEdges(){return this.edgesTypeDatas&&(this.pathTypeFlag&os.Polyline)!==os.Polyline}addEdgesTypeData(t){(this.pathTypeFlag&os.Polyline)!==os.Polyline&&(this.pathTypeFlag^=os.Polyline),this.edgesTypeDatas.push(t)}dxfy(t){if(this.isPolyline())this.polylineBoundaries.forEach(e=>{t.push(92,this.pathTypeFlag),e.dxfy(t)});else{if(!this.isEdges())throw new Error("The boundary path is empty!");this.edgesTypeDatas.forEach(e=>{t.push(92,this.pathTypeFlag),e.dxfy(t)})}}}(function(n){n[n.SolidFill=1]="SolidFill",n[n.PatternFill=0]="PatternFill"})(Wp||(Wp={})),function(n){n[n.NonAssociative=0]="NonAssociative",n[n.Associative=1]="Associative"}(AE||(AE={})),function(n){n[n.Normal=0]="Normal",n[n.Outer=1]="Outer",n[n.Ignore=2]="Ignore"}(SE||(SE={})),function(n){n.LINEAR="LINEAR",n.CYLINDER="CYLINDER",n.INVCYLINDER="INVCYLINDER",n.SPHERICAL="SPHERICAL",n.HEMISPHERICAL="HEMISPHERICAL",n.CURVED="CURVED",n.INVSPHERICAL="SPHERICAL",n.INVHEMISPHERICAL="INVHEMISPHERICAL",n.INVCURVED="INVCURVED"}(TE||(TE={}));class Jst extends gi{get patternName(){let t=w0.SOLID;return this.isPattern(this.fill)&&(t=this.fill.name),t}get solidFillFlag(){return this.patternName===w0.SOLID?Wp.SolidFill:Wp.PatternFill}constructor(t,e,i){super("HATCH","AcDbHatch",i),this.fill=e,this.elevation=i?.elevation||0,this.extrusion=i?.extrusion||Ce(0,0,1),this.boundaryPath=t}pattern(t,e){var i;const r=e.name,s=(i=e.angle)!==null&&i!==void 0?i:0,a=e.scale||1,l=e.double||!1;t.push(52,s),t.push(41,a),t.push(77,Number(l));const u=le.get(r);u&&(u.scale=a,s!==0&&(u.angle=s),u.dxfy(t))}gradient(t,e){var i,r,s;const a=e.firstColor,l=(i=e.secondColor)!==null&&i!==void 0?i:7,u=(r=e.angle)!==null&&r!==void 0?r:0,f=e.definition||0,d=(s=e.tint)!==null&&s!==void 0?s:1,p=e.type||TE.LINEAR;t.push(450,1),t.push(451,0),t.push(460,u),t.push(461,f),t.push(452,e.secondColor?0:1),t.push(462,d),t.push(453,2),t.push(463,0),t.push(63,a),t.push(421,I1.fromHex(yO(a))),t.push(463,1),t.push(63,l),t.push(421,I1.fromHex(yO(l))),t.push(470,p)}isPattern(t){return"name"in t}boundingBox(){return $n.pointBBox(Ce(0,0))}dxfyChild(t){var e,i,r;t.point3d(Ce(0,0,this.elevation)),t.push(210,(e=this.extrusion)===null||e===void 0?void 0:e.x),t.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),t.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z),t.name(this.patternName),t.push(70,this.solidFillFlag),t.push(71,AE.NonAssociative),t.push(91,this.boundaryPath.length),this.boundaryPath.dxfy(t),t.push(75,SE.Outer),t.push(76,EE.Predifined),this.isPattern(this.fill)?(this.solidFillFlag===Wp.PatternFill&&this.pattern(t,this.fill),t.push(47,1),t.push(98,0)):(t.push(47,1),t.push(98,0),this.gradient(t,this.fill))}}(function(n){n[n.ShowImage=1]="ShowImage",n[n.ShowImageWhenNotAlignedWithScreen=2]="ShowImageWhenNotAlignedWithScreen",n[n.UseClippingBoundary=4]="UseClippingBoundary",n[n.TransparencyIsOn=8]="TransparencyIsOn"})(M1||(M1={})),function(n){n[n.Rectangular=1]="Rectangular",n[n.Polygonal=2]="Polygonal"}(Xp||(Xp={})),function(n){n[n.Off=0]="Off",n[n.On=1]="On"}(CE||(CE={})),function(n){n[n.Outside=0]="Outside",n[n.Inside=1]="Inside"}(DE||(DE={}));class tat extends gi{constructor(t,e){super("IMAGE","AcDbRasterImage",e),rl.set(this,void 0),this.width=t.width,this.height=t.height,this.scale=t.scale,this.rotation=t.rotation,this.insertionPoint=t.insertionPoint,this.ratio=this.scale/this.width,this.imageDefHandle=t.imageDefHandle,this.imageDisplayFlags=e?.imageDisplayFlags||M1.ShowImage|M1.ShowImageWhenNotAlignedWithScreen,this.clippingStateFlag=e?.clippingStateFlag||CE.On,this.clipModeFlag=e?.clipModeFlag||DE.Inside,this.clippingType=e?.clippingType||Xp.Rectangular,this.brightness=e?.brightness||50,this.contrast=e?.brightness||50,this.fade=e?.fade||0,Ip(this,rl,[]),this.classVersion=e?.classVersion||0,this.resetClipping()}setClipBoundaryVerticies(t,e){if(e===Xp.Rectangular){if(t.length!=2)throw new Error("The number of vertices should be 2 in rectangular clipping !");Ip(this,rl,t)}else{if(!(t.length>=3))throw new Error("The number of vertices should be >= 3 in polygonal clipping !");Ip(this,rl,t)}Ip(this,rl,[]),kn(this,rl,"f").push(...t)}resetClipping(){const t=[xn(-.5,-.5),xn(this.width-.5,this.height-.5)];this.setClipBoundaryVerticies(t,Xp.Rectangular)}_vector(){return xn(this.ratio*Math.cos(this.rotation*Math.PI/180),this.ratio*Math.sin(this.rotation*Math.PI/180))}_uVector(){const t=this._vector();return Ce(t.x,-t.y,0)}_vVector(){const t=this._vector();return Ce(t.y,t.x,0)}boundingBox(){const t=this.scale,e=this.width/this.height*this.scale,i=Math.sqrt(Math.pow(t,2)+Math.pow(e,2));return $n.centerRadiusBBox(this.insertionPoint,i)}dxfyChild(t){t.push(90,this.classVersion),t.point3d(this.insertionPoint),t.point3d(this._uVector(),1),t.point3d(this._vVector(),2),t.push(13,this.width),t.push(23,this.height),t.push(340,this.imageDefHandle),t.push(70,this.imageDisplayFlags),t.push(280,this.clippingStateFlag),t.push(281,this.brightness),t.push(282,this.contrast),t.push(283,this.fade),t.push(360,this.imageDefReactorHandle),t.push(71,this.clippingType),t.push(91,kn(this,rl,"f").length),kn(this,rl,"f").forEach(e=>t.point2d(e,4)),t.push(290,this.clipModeFlag)}}rl=new WeakMap;class eat extends gi{constructor(t,e,i){var r,s,a,l,u,f;super("INSERT","AcDbBlockReference",i),this.blockName=t,this.insertionPoint=e,this.scaleFactor=i?.scaleFactor||Ce(1,1,1),this.rotationAngle=(r=i?.rotationAngle)!==null&&r!==void 0?r:0,this.columnCount=(s=i?.columnCount)!==null&&s!==void 0?s:1,this.rowCount=(a=i?.rowCount)!==null&&a!==void 0?a:1,this.columnSpacing=(l=i?.columnSpacing)!==null&&l!==void 0?l:0,this.rowSpacing=(u=i?.rowSpacing)!==null&&u!==void 0?u:0,this.attributesFollowFlag=(f=i?.rowSpacing)!==null&&f!==void 0?f:0}boundingBox(){return $n.pointBBox(this.insertionPoint)}dxfyChild(t){t.name(this.blockName),t.point3d(this.insertionPoint),t.push(41,this.scaleFactor.x),t.push(42,this.scaleFactor.y),t.push(43,this.scaleFactor.z),t.push(50,this.rotationAngle),t.push(66,this.attributesFollowFlag),t.push(70,this.columnCount),t.push(71,this.rowCount),t.push(44,this.columnSpacing),t.push(45,this.rowSpacing)}}(function(n){n[n.Disabed=0]="Disabed",n[n.Enabled=1]="Enabled"})(OE||(OE={})),function(n){n[n.StraightLine=0]="StraightLine",n[n.Spline=1]="Spline"}(RE||(RE={}));class nat extends gi{constructor(t,e){var i,r;super("LEADER","AcDbLeader",e),this.vertices=t,this.flag=(i=e?.flag)!==null&&i!==void 0?i:OE.Enabled,this.leaderPathType=(r=e?.leaderPathType)!==null&&r!==void 0?r:RE.StraightLine,this.dimensionStyleName=e?.dimensionStyleName||"Standard"}boundingBox(){return $n.verticesBBox(this.vertices)}dxfyChild(t){t.push(3,this.dimensionStyleName),t.push(71,this.flag),t.push(72,this.leaderPathType),t.push(76,this.vertices.length),this.vertices.forEach(e=>t.point3d(e))}}class iat extends gi{constructor(t,e,i){super("LINE","AcDbLine",i),this.startPoint=t,this.endPoint=e}boundingBox(){return $n.lineBBox(this.startPoint,this.endPoint)}dxfyChild(t){t.point3d(this.startPoint),t.point3d(this.endPoint,1)}}(function(n){n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.Plinegen=128]="Plinegen"})(F1||(F1={}));class rat extends gi{constructor(t,e){super("LWPOLYLINE","AcDbPolyline",e),this.vertices=t,this.flags=e?.flags||F1.None,this.constantWidth=e?.constantWidth||0,this.elevation=e?.elevation||0,this.thickness=e?.thickness||0}boundingBox(){return $n.verticesBBox(this.vertices.map(t=>Ce(t.point.x,t.point.y,0)))}dxfyChild(t){var e,i,r;t.push(90,this.vertices.length),t.push(70,this.flags||0),this.vertices.find(s=>{var a,l;return((a=s.startingWidth)!==null&&a!==void 0?a:0)>0&&((l=s.endWidth)!==null&&l!==void 0?l:0)>0})||t.push(43,this.constantWidth),t.elevation(this.elevation),t.thickness(this.thickness);for(const s of this.vertices)t.point2d(s.point),t.push(40,s.startingWidth),t.push(41,s.endWidth),t.push(42,s.bulge);t.push(210,(e=this.extrusion)===null||e===void 0?void 0:e.x),t.push(220,(i=this.extrusion)===null||i===void 0?void 0:i.y),t.push(230,(r=this.extrusion)===null||r===void 0?void 0:r.z)}}(function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"})(UO||(UO={})),function(n){n[n.LeftToRight=1]="LeftToRight",n[n.TopToBottom=3]="TopToBottom",n[n.ByStyle=5]="ByStyle"}(zO||(zO={})),function(n){n[n.AtLeast=1]="AtLeast",n[n.Exact=2]="Exact"}(HO||(HO={}));class sat extends gi{constructor(t,e,i,r){super("MTEXT","AcDbMText",r),this.position=t,this.height=e,this.value=i,this.textStyle="STANDARD",this.rotation=r?.rotation,this.attachmentPoint=r?.attachmentPoint,this.drawingDirection=r?.drawingDirection,this.lineSpacingStyle=r?.lineSpacingStyle,this.width=r?.width}boundingBox(){return $n.pointBBox(this.position)}dxfyChild(t){t.point3d(this.position),t.push(40,this.height),t.push(41,this.width),t.push(71,this.attachmentPoint),t.push(72,this.drawingDirection),t.push(73,this.lineSpacingStyle),t.primaryText(this.value),t.push(50,this.rotation),t.textStyle(this.textStyle)}}class aat extends gi{constructor(t,e,i,r){super("POINT","AcDbPoint",r),this.x=t,this.y=e,this.z=i}boundingBox(){return $n.pointBBox(Ce(this.x,this.y,this.z))}dxfyChild(t){t.point3d(Ce(this.x,this.y,this.z))}}(function(n){n[n.None=0]="None",n[n.ExtraVertex=1]="ExtraVertex",n[n.CurveFit=2]="CurveFit",n[n.NotUsed=4]="NotUsed",n[n.SplineVertex=8]="SplineVertex",n[n.SplineFrame=16]="SplineFrame",n[n.Polyline3dVertex=32]="Polyline3dVertex",n[n.Polygon3dMesh=64]="Polygon3dMesh",n[n.PolyfaceMeshVertex=128]="PolyfaceMeshVertex"})(P1||(P1={}));class oat extends gi{constructor(t,e){var i;super("VERTEX","AcDbVertex",e),this.point=t,this.flags=(i=e?.flags)!==null&&i!==void 0?i:P1.None,e&&("startingWidth"in e&&(this.startingWidth=e.startingWidth),"endWidth"in e&&(this.endWidth=e.endWidth),"bulge"in e&&(this.bulge=e.bulge))}boundingBox(){return $n.pointBBox(this.point)}dxfyChild(t){t.subclassMarker("AcDb3dPolylineVertex"),t.point3d(this.point),t.push(40,this.startingWidth),t.push(41,this.endWidth),t.push(42,this.bulge),t.push(70,this.flags)}}class B6 extends gi{dxfyChild(t){}constructor(){super("SEQEND")}}(function(n){n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.CurveFit=2]="CurveFit",n[n.SplineFit=4]="SplineFit",n[n.Polyline3D=8]="Polyline3D",n[n.PolygonMesh3D=16]="PolygonMesh3D",n[n.PolygonMeshClosed=32]="PolygonMeshClosed",n[n.PolyfaceMesh=64]="PolyfaceMesh",n[n.LinetypeGenerated=128]="LinetypeGenerated"})(NE||(NE={})),function(n){n[n.NoSmooth=0]="NoSmooth",n[n.QuadraticBSpline=5]="QuadraticBSpline",n[n.CubicBSpline=6]="CubicBSpline",n[n.Bezier=8]="Bezier"}(LE||(LE={}));class lat extends gi{constructor(t,e){var i,r,s,a,l,u,f,d,p,m;super("POLYLINE","AcDb3dPolyline",e),this._seqend=new B6,this.vertices=[],this.thickness=(i=e?.thickness)!==null&&i!==void 0?i:0,this.elevation=(r=e?.elevation)!==null&&r!==void 0?r:0,this.flags=(s=e?.flags)!==null&&s!==void 0?s:NE.None,this.defaultStartWidth=(a=e?.defaultStartWidth)!==null&&a!==void 0?a:0,this.defaultEndWidth=(l=e?.defaultEndWidth)!==null&&l!==void 0?l:0,this.polygonMeshM=(u=e?.polygonMeshM)!==null&&u!==void 0?u:0,this.polygonMeshN=(f=e?.polygonMeshN)!==null&&f!==void 0?f:0,this.smoothSurfaceM=(d=e?.smoothSurfaceM)!==null&&d!==void 0?d:0,this.smoothSurfaceN=(p=e?.smoothSurfaceN)!==null&&p!==void 0?p:0,this.surfaceType=(m=e?.surfaceType)!==null&&m!==void 0?m:LE.NoSmooth,t.forEach(g=>this.vertices.push(new oat(g.point,{startingWidth:g.startingWidth,endWidth:g.endWidth,bulge:g.bulge,flags:P1.Polyline3dVertex})))}boundingBox(){return $n.verticesBBox(this.vertices.map(t=>t.point))}dxfyChild(t){t.push(66,1),t.point3d(Ce(0,0,this.elevation)),t.push(39,this.thickness),t.push(70,this.flags),t.push(40,this.defaultStartWidth),t.push(41,this.defaultEndWidth),t.push(71,this.polygonMeshM),t.push(72,this.polygonMeshN),t.push(73,this.smoothSurfaceM),t.push(74,this.smoothSurfaceN),t.push(75,this.surfaceType),this.vertices.forEach(e=>e.dxfy(t)),this._seqend.dxfy(t)}}(function(n){n[n.Closed=1]="Closed",n[n.Periodic=2]="Periodic",n[n.Rational=4]="Rational",n[n.Planar=8]="Planar",n[n.Linear=16]="Linear"})(IE||(IE={}));class cat extends gi{constructor(t,e){var i,r;super("SPLINE","AcDbSpline",e),this.controlPoints=t.controlPoints,this.degreeCurve=(i=t.degreeCurve)!==null&&i!==void 0?i:3,this.flags=(r=t.flags)!==null&&r!==void 0?r:IE.Planar,this.knots=t.knots||[],this.weights=t.weights||[],this.fitPoints=t.fitPoints||[];const s=this.controlPoints.length,a=this.degreeCurve,l=a+1,u=this.fitPoints.length;if(s<l)throw new Error(`Number of control points should be >= ${l}.`);if(u!==0&&u<2)throw new Error("Number of fit points should be >= 2.");const f=a+s+1;if(this.knots.length===0){let d=0;for(let p=0;p<f;p++)p<=a||p>=s+1?this.knots.push(d):this.knots.push(++d)}if(this.knots.length!==f)throw new Error(`Number of knots should be ${f}.`)}boundingBox(){return $n.verticesBBox([...this.controlPoints,...this.fitPoints])}dxfyChild(t){t.push(70,this.flags),t.push(71,this.degreeCurve),t.push(72,this.knots.length),t.push(73,this.controlPoints.length),t.push(74,this.fitPoints.length),t.push(42,"0.0000001"),t.push(43,"0.0000001"),t.push(42,"0.0000000001"),this.knots.forEach(e=>t.push(40,e)),this.weights.forEach(e=>t.push(41,e)),this.controlPoints.forEach(e=>t.point3d(e)),this.fitPoints.forEach(e=>t.point3d(e,1))}}(function(n){n[n.Text=1]="Text",n[n.Block=2]="Block"})($O||($O={})),function(n){n[n.False=0]="False",n[n.True=1]="True"}(GO||(GO={})),function(n){n[n.False=0]="False",n[n.True=1]="True"}(VO||(VO={})),function(n){n[n.TopLeft=1]="TopLeft",n[n.TopCenter=2]="TopCenter",n[n.TopRight=3]="TopRight",n[n.MiddleLeft=4]="MiddleLeft",n[n.MiddleCenter=5]="MiddleCenter",n[n.MiddleRight=6]="MiddleRight",n[n.BottomLeft=7]="BottomLeft",n[n.BottomCenter=8]="BottomCenter",n[n.BottomRight=9]="BottomRight"}(WO||(WO={}));class uat extends gi{constructor(t,e,i,r,s,a,l){super("ACAD_TABLE","AcDbBlockReference",l),this.blockName=t,this.position=e,this.numberOfRows=i,this.numberOfColumn=r,this.rowsHeight=s,this.columnsHeight=a,this.horizontalDirectionVector=l?.horizontalDirectionVector||Ce(1),this.cells=l?.cell}boundingBox(){return $n.pointBBox(this.position)}dxfyChild(t){var e,i,r,s;t.name(this.blockName),t.point3d(this.position),t.subclassMarker("AcDbTable"),t.point3d(this.horizontalDirectionVector,1),t.push(91,this.numberOfRows),t.push(92,this.numberOfColumn);for(let a=0;a<this.numberOfRows;a++)t.push(141,(i=(e=this.rowsHeight[a])!==null&&e!==void 0?e:this.rowsHeight[0])!==null&&i!==void 0?i:1);for(let a=0;a<this.numberOfColumn;a++)t.push(142,(s=(r=this.columnsHeight[a])!==null&&r!==void 0?r:this.columnsHeight[0])!==null&&s!==void 0?s:1);this.cells.forEach(a=>a.dxfy(t))}}(function(n){n[n.None=0]="None",n[n.Backward=2]="Backward",n[n.UpsideDown=4]="UpsideDown"})(XO||(XO={})),function(n){n[n.Left=0]="Left",n[n.Center=1]="Center",n[n.Right=2]="Right",n[n.Aligned=3]="Aligned",n[n.Middle=4]="Middle",n[n.Fit=5]="Fit"}(cc||(cc={})),function(n){n[n.BaseLine=0]="BaseLine",n[n.Bottom=1]="Bottom",n[n.Middle=2]="Middle",n[n.Top=3]="Top"}(uc||(uc={}));class fat extends gi{constructor(t,e,i,r){super("TEXT","AcDbText",r),this.position=t,this.height=e,this.value=i,this.textStyle="STANDARD",this.rotation=r?.rotation,this.obliqueAngle=r?.obliqueAngle,this.generationFlags=r?.generationFlags,this.horizontalAlignment=r?.horizontalAlignment,this.verticalAlignment=r?.verticalAlignment,this.secondAlignmentPoint=r?.secondAlignmentPoint,this.relativeXScaleFactor=r?.relativeXScaleFactor}boundingBox(){return $n.pointBBox(this.position)}dxfyChild(t){t.point3d(this.position),t.push(40,this.height),t.primaryText(this.value),t.push(50,this.rotation),t.push(41,this.relativeXScaleFactor),t.push(51,this.obliqueAngle),t.textStyle(this.textStyle),t.push(71,this.generationFlags),t.push(72,this.horizontalAlignment),t.point3d(this.secondAlignmentPoint,1),t.subclassMarker("AcDbText"),t.push(73,this.verticalAlignment)}}class dat{constructor(t,e,i){this.entities=[],this.handle=ds.next(),this.objects=t,this.blockRecord=e,this.layerName=i}dxfy(t){for(const e of this.entities)e.dxfy(t)}addHatch(t,e,i){const r=new Jst(t,e,i);return this.addEntity(r)}addEntity(t){return t.ownerBlockRecord=this.blockRecord.handle,this.blockRecord.isPaperSpace&&(t.inPaperSpace=!0),t.layerName==null&&(t.layerName=this.layerName),this.entities.push(t),t}addAttrib(t,e,i,r,s,a){s.attributesFollowFlag=1;const l=this.addEntity(new qst(t,e,i,r,a));return this.addEntity(new B6).ownerBlockRecord=s.handle,l}addAttdef(t,e,i,r,s){return this.addEntity(new Yst(t,e,i,r,s))}addAlignedDim(t,e,i){return this.addEntity(new zst(t,e,i))}addDiameterDim(t,e,i){return this.addEntity(new Gst(t,e,i))}addRadialDim(t,e,i){return this.addEntity(new Wst(t,e,i))}addLinearDim(t,e,i){return this.addEntity(new Vst(t,e,i))}addAngularLinesDim(t,e,i,r){return this.addEntity(new Hst(t,e,i,r))}addAngularPointsDim(t,e,i,r){return this.addEntity(new $st(t,e,i,r))}addLine(t,e,i){return this.addEntity(new iat(t,e,i))}addLeader(t,e){return this.addEntity(new nat(t,e))}addLWPolyline(t,e){return this.addEntity(new rat(t,e))}addRectangle(t,e,i){const r=[],s=t.x,a=t.y,l=e.x,u=e.y;if(i?.fillet!==void 0&&i?.chamfer!==void 0)throw new Error("You cannot define both fillet and chamfer!");if(i?.fillet!==void 0){const f=i?.fillet,d=kst(f);r.push({point:xn(s,a-f),bulge:d}),r.push({point:xn(s+f,a)}),r.push({point:xn(l-f,a),bulge:d}),r.push({point:xn(l,a-f)}),r.push({point:xn(l,u+f),bulge:d}),r.push({point:xn(l-f,u)}),r.push({point:xn(s+f,u),bulge:d}),r.push({point:xn(s,u+f)})}else if(i?.chamfer!==void 0){const f=i?.chamfer.first,d=i?.chamfer.second||f;r.push({point:xn(s,a-f)}),r.push({point:xn(s+d,a)}),r.push({point:xn(l-f,a)}),r.push({point:xn(l,a-d)}),r.push({point:xn(l,u+f)}),r.push({point:xn(l-d,u)}),r.push({point:xn(s+f,u)}),r.push({point:xn(s,u+d)})}else r.push({point:xn(s,a)}),r.push({point:xn(l,a)}),r.push({point:xn(l,u)}),r.push({point:xn(s,u)});return this.addLWPolyline(r,Object.assign(Object.assign({},i),{flags:F1.Closed}))}addImage(t,e,i,r,s,a,l,u){const f=this.objects.addImageDef(t);f.width=r,f.height=s;const d=new tat({height:s,width:r,scale:a,rotation:l,insertionPoint:i,imageDefHandle:f.handle},u),p=this.objects.addImageDefReactor(d.handle);d.imageDefReactorHandle=p.handle,this.addEntity(d);const m=this.objects.addDictionary();return m.addEntryObject(e,f.handle),f.ownerObjecthandle=m.handle,this.objects.root.addEntryObject("ACAD_IMAGE_DICT",m.handle),f.acadImageDictHandle=m.handle,f.addImageDefReactorHandle(p.handle),d}addPolyline3D(t,e){return this.addEntity(new lat(t,e))}addPoint(t,e,i,r){return this.addEntity(new aat(t,e,i,r))}addCircle(t,e,i){return this.addEntity(new Kst(t,e,i))}addArc(t,e,i,r,s){return this.addEntity(new Xst(t,e,i,r,s))}addSpline(t,e){return this.addEntity(new cat(t,e))}addEllipse(t,e,i,r,s,a){const l=new Zst(t,e,i,r,s,a);return this.addEntity(l),l}add3dFace(t,e,i,r,s){return this.addEntity(new Qst(t,e,i,r,s))}addText(t,e,i,r){return this.addEntity(new fat(t,e,i,r))}addMText(t,e,i,r){return this.addEntity(new sat(t,e,i,r))}addInsert(t,e,i){return this.addEntity(new eat(t,e,i||{}))}addTable(t,e,i,r,s,a,l){return this.addEntity(new uat(t,e,i,r,s,a,l))}boundingBox(){const t=[];for(let e=0;e<this.entities.length;e++)t.push(this.entities[e].boundingBox());return $n.boundingBox(t)}centerView(){return $n.boundingBoxCenter(this.boundingBox())}viewHeight(){return $n.boundingBoxHeight(this.boundingBox())}}(function(n){n[n.None=0]="None",n[n.AnonymousBlock=1]="AnonymousBlock",n[n.HasNonConstantAttribute=2]="HasNonConstantAttribute",n[n.XRef=4]="XRef",n[n.XRefOverlay=8]="XRefOverlay",n[n.ExternallyDependent=16]="ExternallyDependent",n[n.ResolvedXRef=32]="ResolvedXRef",n[n.ReferencedXRef=64]="ReferencedXRef"})(kE||(kE={}));class hat extends dat{get isPaperSpace(){return this.name.startsWith("*Paper_Space")}get isModelSpace(){return this.name.startsWith("*Model_Space")}get isModelOrPaperSpace(){return this.isModelSpace||this.isPaperSpace}constructor(t,e,i){super(i,e,"0"),this.name=t,this.flags=kE.None,this.endBlk=new Mst,this.ownerObjectHandle=e.handle,this.basePoint=Ce(0,0,0),this.xrefPathName=""}setLayerName(t){this.layerName=t}dxfy(t){t.type("BLOCK"),t.handle(this.handle),t.push(330,this.ownerObjectHandle),t.subclassMarker("AcDbEntity"),t.layerName(this.layerName),t.subclassMarker("AcDbBlockBegin"),t.name(this.name),t.push(70,this.flags),t.point3d(this.basePoint),t.name(this.name,3),t.push(1,this.xrefPathName),this.isModelSpace||this.name==="*Paper_Space"||super.dxfy(t),this.endBlk.dxfy(t)}}class pat{constructor(t,e){this.blocks=[],this.paperSpaceSeed=0,this.tables=t,this.objects=e,this.modelSpace=this.addBlock("*Model_Space",e,!1),this.paperSpace=this.addBlock("*Paper_Space",e,!1)}addBlock(t,e,i=!0){i&&(t=t.replace(k1,""));const r=this.tables.addBlockRecord(t),s=new hat(t,r,e);return this.blocks.push(s),s}addPaperSpace(){const t="*Paper_Space"+this.paperSpaceSeed++;return this.addBlock(t,this.objects,!1)}dxfy(t){t.start("BLOCKS"),this.blocks.forEach(e=>e.dxfy(t)),t.end()}}class mat{dxfy(t){t.start("CLASSES"),t.end()}}class gat{constructor(t){this.blocks=t,this.modelSpace=t.modelSpace,this.paperSpace=t.paperSpace}setLayerName(t){this.modelSpace.setLayerName(t)}dxfy(t){t.start("ENTITIES"),this.paperSpace.entities.forEach(e=>e.dxfy(t)),this.modelSpace.entities.forEach(e=>e.dxfy(t)),t.end()}}class vat{constructor(t,e){this.values=e,this.name=t}dxfy(t){t.variableName(this.name),Object.entries(this.values).forEach(e=>{const[i,r]=e;t.push(parseInt(i),r)})}}class xat{constructor(){this.variables=[]}setVariable(t,e){const i=this.variables.find(r=>r.name===t);i?i.values=e:this.variables.push(new vat(t,e))}dxfy(t){t.start("HEADER"),this.variables.forEach(e=>e.dxfy(t)),t.end()}}class MA{constructor(t){this.type=t,this.ownerObjecthandle="0",this.handle=ds.next()}dxfy(t){t.type(this.type),t.handle(this.handle),t.push(330,this.ownerObjecthandle)}}class YO extends MA{constructor(){super("DICTIONARY"),this.entries=[],this.duplicateRecordCloningFlag=0}addEntryObject(t,e){this.entries.push({name:t,entryObjectHandle:e})}dxfy(t){super.dxfy(t),t.subclassMarker("AcDbDictionary"),t.push(280,this.hardOwnerFlag),t.push(281,this.duplicateRecordCloningFlag);for(const e of this.entries)t.push(3,e.name),t.push(350,e.entryObjectHandle)}}(function(n){n[n.NoUnits=0]="NoUnits",n[n.Centimeters=2]="Centimeters",n[n.Inch=5]="Inch"})(ME||(ME={}));class yat extends MA{constructor(t){super("IMAGEDEF"),this.path=t,this.acadImageDictHandle="",this.imageReactorHandles=[],this.width=1,this.height=1,this.widthPixelSize=1,this.heightPixelSize=1,this.loaded=!0,this.resolutionUnits=ME.NoUnits}addImageDefReactorHandle(t){this.imageReactorHandles.push(t)}dxfy(t){super.dxfy(t);const e=new Pst("ACAD_REACTORS");e.add(330,this.acadImageDictHandle);for(const i of this.imageReactorHandles)e.add(330,i);e.dxfy(t),t.subclassMarker("AcDbRasterImageDef"),t.push(1,this.path),t.point2d(xn(this.width,this.height)),t.push(11,this.widthPixelSize),t.push(21,this.heightPixelSize),t.push(280,Number(this.loaded)),t.push(281,this.resolutionUnits)}}class _at extends MA{constructor(t){super("IMAGEDEF_REACTOR"),this.imageHandle=t,this.classVersion=2}dxfy(t){super.dxfy(t),t.subclassMarker("AcDbRasterImageDefReactor"),t.push(90,this.classVersion),t.push(330,this.imageHandle)}}class bat{constructor(){this.root=new YO,this.objects=[],this.root.duplicateRecordCloningFlag=1;const t=this.addDictionary();this.root.addEntryObject("ACAD_GROUP",t.handle)}addObject(t){return this.objects.push(t),t}addImageDef(t){return this.addObject(new yat(t))}addImageDefReactor(t){return this.addObject(new _at(t))}addDictionary(){const t=new YO;return t.ownerObjecthandle=this.root.handle,this.addObject(t),t}addEntryToRoot(t,e){this.root.addEntryObject(t,e)}dxfy(t){t.start("OBJECTS"),this.root.dxfy(t);for(const e of this.objects)e.dxfy(t);t.end(),t.type("EOF")}}class Cl{constructor(t){this.name=t,this.maxNumberEntries=0,this.ownerObjectHandle="0",this.handle=ds.next(),this.records=[]}dxfy(t){t.type("TABLE"),t.name(this.name),t.handle(this.handle),t.push(330,this.ownerObjectHandle),t.subclassMarker("AcDbSymbolTable"),t.push(70,this.records.length);for(const e of this.records)e.dxfy(t);t.type("ENDTAB")}}(function(n){n[n.None=0]="None",n[n.XRefDependent=16]="XRefDependent",n[n.XRefResolved=32]="XRefResolved"})(B1||(B1={}));class wat extends Oc{constructor(t,e){super("APPID"),this.name=t,this.flags=e??B1.None}dxfy(t){super.dxfy(t),t.subclassMarker("AcDbRegAppTableRecord"),t.name(this.name),t.push(70,this.flags)}}class Eat extends Oc{get isPaperSpace(){return this.name.startsWith("*Paper_Space")}constructor(t){super("BLOCK_RECORD"),this.name=t,this.insertionUnits=0,this.explodability=1,this.scalability=0}dxfy(t){super.dxfy(t),t.subclassMarker("AcDbBlockTableRecord"),t.name(this.name),t.push(340,this.layoutObject),t.push(70,this.insertionUnits),t.push(280,this.explodability),t.push(281,this.scalability)}}(function(n){n[n.None=0]="None",n[n.XRefDependent=16]="XRefDependent",n[n.XRefRefesolved=32]="XRefRefesolved"})(FE||(FE={}));class Aat{constructor(t,e){this.name=t,this.flags=e??FE.None,this.handle=ds.next(),this.type="DIMSTYLE"}dxfy(t){t.type(this.type),t.push(105,this.handle),t.push(330,this.ownerObjectHandle),t.subclassMarker("AcDbSymbolTableRecord"),t.subclassMarker("AcDbDimStyleTableRecord"),t.name(this.name),t.push(70,this.flags),t.push(3,this.DIMPOST),t.push(4,this.DIMAPOST),t.push(5,this.DIMBLK),t.push(6,this.DIMBLK1),t.push(7,this.DIMBLK2),t.push(40,this.DIMSCALE),t.push(41,this.DIMASZ),t.push(42,this.DIMEXO),t.push(43,this.DIMDLI),t.push(44,this.DIMEXE),t.push(45,this.DIMRND),t.push(46,this.DIMDLE),t.push(47,this.DIMTP),t.push(48,this.DIMTM),t.push(140,this.DIMTXT),t.push(141,this.DIMCEN),t.push(142,this.DIMTSZ),t.push(143,this.DIMALTF),t.push(144,this.DIMLFAC),t.push(145,this.DIMTVP),t.push(146,this.DIMTFAC),t.push(147,this.DIMGAP),t.push(148,this.DIMALTRND),t.push(71,this.DIMTOL),t.push(72,this.DIMLIM),t.push(73,this.DIMTIH),t.push(74,this.DIMTOH),t.push(75,this.DIMSE1),t.push(76,this.DIMSE2),t.push(77,this.DIMTAD),t.push(78,this.DIMZIN),t.push(79,this.DIMAZIN),t.push(170,this.DIMALT),t.push(171,this.DIMALTD),t.push(172,this.DIMTOFL),t.push(173,this.DIMSAH),t.push(174,this.DIMTIX),t.push(175,this.DIMSOXD),t.push(176,this.DIMCLRD),t.push(177,this.DIMCLRE),t.push(178,this.DIMCLRT),t.push(179,this.DIMADEC),t.push(271,this.DIMDEC),t.push(272,this.DIMTDEC),t.push(273,this.DIMALTU),t.push(274,this.DIMALTTD),t.push(275,this.DIMAUNIT),t.push(276,this.DIMFRAC),t.push(277,this.DIMLUNIT),t.push(278,this.DIMDSEP),t.push(279,this.DIMTMOVE),t.push(280,this.DIMJUST),t.push(281,this.DIMSD1),t.push(282,this.DIMSD2),t.push(283,this.DIMTOLJ),t.push(284,this.DIMTZIN),t.push(285,this.DIMALTZ),t.push(286,this.DIMALTTZ),t.push(287,this.DIMFIT),t.push(288,this.DIMUPT),t.push(289,this.DIMATFIT),t.push(340,this.DIMTXSTY),t.push(341,this.DIMLDRBLK),t.push(342,this.DIMBLK),t.push(343,this.DIMBLK1),t.push(344,this.DIMBLK2),t.push(371,this.DIMLWD),t.push(372,this.DIMLWE)}}class Sat extends Oc{constructor(t,e,i,r){super("LTYPE"),this.name=t,this.descriptive=e,this.elements=i,this.flags=r??0}dxfy(t){super.dxfy(t),t.subclassMarker("AcDbLinetypeTableRecord"),t.name(this.name),t.push(70,this.flags),t.push(3,this.descriptive),t.push(72,65),t.push(73,this.elements.length);let e=0;for(const i of this.elements)e+=Math.abs(i);t.push(40,e);for(const i of this.elements)t.push(49,i),t.push(74,0)}}class Tat extends Oc{constructor(t,e){super("STYLE"),this.fixedTextHeight=0,this.widthFactor=1,this.obliqueAngle=0,this.textGenerationFlag=0,this.lastHeightUsed=1,this.fontFileName="txt",this.bigFontFileName="",this.name=t,this.flags=e??_E.None}dxfy(t){super.dxfy(t),t.subclassMarker("AcDbTextStyleTableRecord"),t.name(this.name),t.push(70,this.flags),t.push(40,this.fixedTextHeight),t.push(41,this.widthFactor),t.push(50,this.obliqueAngle),t.push(71,this.textGenerationFlag),t.push(42,this.lastHeightUsed),t.push(3,this.fontFileName),t.push(4,this.bigFontFileName)}}class Cat extends Oc{constructor(t){super("UCS"),this.name=t}dxfy(t){super.dxfy(t)}}class Dat extends Oc{constructor(t){super("VPORT"),this.name=t,this.viewHeight=200,this.viewCenter=[0,0]}dxfy(t){super.dxfy(t);const[e,i]=this.viewCenter;t.subclassMarker("AcDbViewportTableRecord"),t.name(this.name),t.push(70,0),t.point2d({x:0,y:0}),t.push(11,1),t.push(21,1),t.push(12,e),t.push(22,i),t.push(13,0),t.push(23,0),t.push(14,10),t.push(24,10),t.push(15,10),t.push(25,10),t.push(16,0),t.push(26,0),t.push(36,1),t.push(17,0),t.push(27,0),t.push(37,0),t.push(40,this.viewHeight||200),t.push(41,2),t.push(42,50),t.push(43,0),t.push(44,0),t.push(50,0),t.push(51,0),t.push(71,0),t.push(72,100),t.push(73,1),t.push(74,3),t.push(75,0),t.push(76,1),t.push(77,0),t.push(78,0),t.push(281,0),t.push(65,1),t.push(110,0),t.push(120,0),t.push(130,0),t.push(111,1),t.push(121,0),t.push(131,0),t.push(112,0),t.push(122,1),t.push(132,0),t.push(79,0),t.push(146,0),t.push(348,10020),t.push(60,7),t.push(61,5),t.push(292,1),t.push(282,1),t.push(141,0),t.push(142,0),t.push(63,250),t.push(421,3358443)}}class Oat extends Oc{constructor(t){var e;super("VIEW"),this.name=t.name,this.flags=(e=t.flags)!==null&&e!==void 0?e:bE.None,this.viewHeight=t.viewHeight,this.viewCenter=t.viewCenter,this.viewWidth=t.viewWidth,this.viewDirection=t.viewDirection,this.targetPoint=t.targetPoint,this.lensLength=t.lensLength,this.frontClipping=t.frontClipping,this.backClipping=t.backClipping,this.twistAngle=t.twistAngle,this.viewMode=t.viewMode,this.renderMode=t.renderMode,this.isUCSAssociated=t.isUCSAssociated,this.isCameraPlottable=t.isCameraPlottable||!1,t.backgroundObjectHandle&&(this.backgroundObjectHandle=t.backgroundObjectHandle),t.liveSectionObjectHandle&&(this.liveSectionObjectHandle=t.liveSectionObjectHandle),t.visualStyleObjectHandle&&(this.visualStyleObjectHandle=t.visualStyleObjectHandle)}dxfy(t){super.dxfy(t),t.subclassMarker("AcDbViewTableRecord"),t.name(this.name),t.push(70,this.flags),t.push(40,this.viewHeight),t.point2d(this.viewCenter),t.push(41,this.viewWidth),t.push(11,this.viewDirection.x),t.push(21,this.viewDirection.y),t.push(31,this.viewDirection.z),t.push(12,this.targetPoint.x),t.push(22,this.targetPoint.y),t.push(32,this.targetPoint.z),t.push(42,this.lensLength),t.push(43,this.frontClipping),t.push(44,this.backClipping),t.push(50,this.twistAngle),t.push(71,this.viewMode),t.push(281,this.renderMode),t.push(72,this.isUCSAssociated?1:0),t.push(73,this.isCameraPlottable?1:void 0),t.push(332,this.backgroundObjectHandle),t.push(334,this.liveSectionObjectHandle),t.push(348,this.visualStyleObjectHandle)}}class Rat extends Cl{constructor(){super("APPID")}addAppId(t,e){const i=new wat(t,e);return i.ownerObjectHandle=this.handle,this.records.push(i),i}}class Nat extends Cl{constructor(){super("BLOCK_RECORD")}addBlockRecord(t){const e=new Eat(t);return e.ownerObjectHandle=this.handle,this.records.push(e),e}}class Lat extends Cl{constructor(){super("DIMSTYLE"),this.ownerObjectHandle="0"}addDimStyle(t,e){const i=new Aat(t,e);return i.ownerObjectHandle=this.handle,this.records.push(i),i}dxfy(t){t.type("TABLE"),t.name(this.name),t.handle(this.handle),t.push(330,this.ownerObjectHandle),t.subclassMarker("AcDbSymbolTable"),t.push(70,this.records.length),t.subclassMarker("AcDbDimStyleTable");for(const e of this.records)e.dxfy(t);t.type("ENDTAB")}}class Iat extends Cl{constructor(){super("LTYPE")}exist(t){return this.records.find(e=>e.name===t)!==void 0}ltype(t){return this.records.find(e=>e.name===t)}addLType(t,e,i,r){const s=this.ltype(t);if(s)return s;const a=new Sat(t,e,i,r);return a.ownerObjectHandle=this.handle,this.records.push(a),a}}class kat extends Cl{constructor(t){super("LAYER"),this.lTypeTable=t}addLayer(t,e,i,r){t=t.replace(k1,"");const s=this.layer(t);if(s)return s;this.lTypeTable.exist(i)||(i=L1.Continuous);const a=new ad(t,e,i,r);return a.ownerObjectHandle=this.handle,this.records.push(a),a}layer(t){return t=t.replace(k1,""),this.records.find(e=>e.name===t)}exist(t){return this.records.find(e=>e.name===t)!==void 0}}class Mat extends Cl{constructor(){super("STYLE")}addStyle(t,e){const i=new Tat(t,e);return i.ownerObjectHandle=this.handle,this.records.push(i),i}}class Fat extends Cl{constructor(){super("UCS")}addUcs(t){const e=new Cat(t);return e.ownerObjectHandle=this.handle,this.records.push(e),e}}class Pat extends Cl{constructor(){super("VPORT")}addViewPort(t){const e=new Dat(t);return e.ownerObjectHandle=this.handle,this.records.push(e),e}}class Bat extends Cl{constructor(){super("VIEW")}addView(t){const e=new Oat(t);return e.ownerObjectHandle=this.handle,this.records.push(e),e}}class jat{constructor(){this.vPortTable=new Pat,this.ltypeTable=new Iat,this.layerTable=new kat(this.ltypeTable),this.styleTable=new Mat,this.viewTable=new Bat,this.ucsTable=new Fat,this.appIdTable=new Rat,this.dimStyleTable=new Lat,this.blockRecordTable=new Nat}layer(t){return this.layerTable.layer(t)}addLType(t,e,i,r){return this.ltypeTable.addLType(t,e,i,r)}addBlockRecord(t){return this.blockRecordTable.addBlockRecord(t)}addLayer(t,e,i,r){return this.layerTable.addLayer(t,e,i,r)}addStyle(t){return this.styleTable.addStyle(t)}addView(t){return this.viewTable.addView(t)}addUcs(t){return this.ucsTable.addUcs(t)}addAppId(t,e){return this.appIdTable.addAppId(t,e)}addDimStyle(t,e){return this.dimStyleTable.addDimStyle(t,e)}addVPort(t){return this.vPortTable.addViewPort(t)}dxfy(t){t.start("TABLES"),this.vPortTable.dxfy(t),this.ltypeTable.dxfy(t),this.layerTable.dxfy(t),this.styleTable.dxfy(t),this.viewTable.dxfy(t),this.ucsTable.dxfy(t),this.appIdTable.dxfy(t),this.dimStyleTable.dxfy(t),this.blockRecordTable.dxfy(t),t.end()}}class Uat{constructor(){ds.clear(),this.header=new xat,this.classes=new mat,this.tables=new jat,this.objects=new bat,this.blocks=new pat(this.tables,this.objects),this.entities=new gat(this.blocks),this.currentLayerName=ad.layerZeroName,this.currentUnits=b0.Unitless,this.header.setVariable("$ACADVER",{1:"AC1021"}),this.header.setVariable("$LASTSAVEDBY",{1:"@tarikjabiri/dxf"}),this._handseed(),this.setUnits(b0.Unitless),this.tables.addLType("ByBlock","",[]),this.tables.addLType("ByLayer","",[]);const t=this.tables.addLType("Continuous","Solid line",[]);this.tables.addLayer(ad.layerZeroName,gr.White,t.name),this.styleStandard=this.tables.addStyle("Standard"),this.tables.addAppId("ACAD",B1.None),this.dimStyleStandard=this.tables.addDimStyle("Standard"),this.dimStyleStandard.DIMTXSTY=this.styleStandard.handle,this.activeVPort=this.tables.addVPort("*Active"),this.modelSpace=this.blocks.modelSpace,this.paperSpace=this.blocks.paperSpace,this.setZeroLayerAsCurrent()}dxfy(t){this.header.dxfy(t),this.classes.dxfy(t),this.tables.dxfy(t),this.blocks.dxfy(t),this.entities.dxfy(t),this.objects.dxfy(t)}addBlock(t){return this.blocks.addBlock(t,this.objects)}setZeroLayerAsCurrent(){this.setCurrentLayerName(ad.layerZeroName)}setCurrentLayerName(t){this.currentLayerName=t.replace(k1,""),this.entities.setLayerName(this.currentLayerName),this.setCLayerVariable()}_handseed(){this.header.setVariable("$HANDSEED",{5:ds.peek()})}setUnits(t){this.currentUnits=t,this.header.setVariable("$INSUNITS",{70:this.currentUnits})}setCLayerVariable(){this.header.setVariable("$CLAYER",{8:this.currentLayerName})}setViewCenter(t){this.header.setVariable("$VIEWCTR",{10:t.x,20:t.y}),this.activeVPort.viewCenter=[t.x,t.y]}stringify(){const t=new Bst;return this._handseed(),this.setViewCenter(this.modelSpace.centerView()),this.activeVPort.viewHeight=this.modelSpace.viewHeight(),this.dxfy(t),t.stringify()}}class zat{get header(){return this.document.header}get tables(){return this.document.tables}get blocks(){return this.document.blocks}get entities(){return this.document.entities}get currentLayer(){return this.document.currentLayerName}get units(){return this.document.currentUnits}get modelSpace(){return this.document.modelSpace}constructor(){this.document=new Uat}layer(t){return this.tables.layer(t)}setZeroLayerAsCurrent(){this.document.setZeroLayerAsCurrent()}addBlock(t){return this.blocks.addBlock(t,this.document.objects)}addPaperSpace(){return this.blocks.addPaperSpace()}setVariable(t,e){this.header.setVariable(t,e)}addLType(t,e,i){return this.tables.addLType(t,e,i)}addDimStyle(t){return this.tables.addDimStyle(t)}addAlignedDim(t,e,i){return this.modelSpace.addAlignedDim(t,e,i)}addDiameterDim(t,e,i){return this.modelSpace.addDiameterDim(t,e,i)}addRadialDim(t,e,i){return this.modelSpace.addRadialDim(t,e,i)}addLinearDim(t,e,i){return this.modelSpace.addLinearDim(t,e,i)}addAngularLinesDim(t,e,i,r){return this.modelSpace.addAngularLinesDim(t,e,i,r)}addHatch(t,e,i){return this.modelSpace.addHatch(t,e,i)}addLayer(t,e,i,r=N1.None){return i||(i=L1.Continuous),this.tables.addLayer(t,e,i,r)}setCurrentLayerName(t){this.document.setCurrentLayerName(t)}setUnits(t){this.document.setUnits(t)}addLine(t,e,i){return this.modelSpace.addLine(t,e,i)}addLeader(t,e){return this.modelSpace.addLeader(t,e)}addLWPolyline(t,e){return this.modelSpace.addLWPolyline(t,e)}addRectangle(t,e,i){return this.modelSpace.addRectangle(t,e,i)}addPolyline3D(t,e){return this.modelSpace.addPolyline3D(t,e)}addPoint(t,e,i,r){return this.modelSpace.addPoint(t,e,i,r)}addCircle(t,e,i){return this.modelSpace.addCircle(t,e,i)}addArc(t,e,i,r,s){return this.modelSpace.addArc(t,e,i,r,s)}addSpline(t,e){return this.modelSpace.addSpline(t,e)}addEllipse(t,e,i,r,s,a){return this.modelSpace.addEllipse(t,e,i,r,s,a)}addImage(t,e,i,r,s,a,l,u){return this.modelSpace.addImage(t,e,i,r,s,a,l,u)}add3dFace(t,e,i,r,s){return this.modelSpace.add3dFace(t,e,i,r,s)}addText(t,e,i,r){return this.modelSpace.addText(t,e,i,r)}addAttdef(t,e,i,r,s){return this.modelSpace.addAttdef(t,e,i,r,s)}addAttrib(t,e,i,r,s,a){return this.modelSpace.addAttrib(t,e,i,r,s,a)}addMText(t,e,i,r){return this.modelSpace.addMText(t,e,i,r)}addInsert(t,e,i){return this.modelSpace.addInsert(t,e,i)}addTable(t,e,i,r,s,a,l){return this.modelSpace.addTable(t,e,i,r,s,a,l)}stringify(){return this.document.stringify()}}const Hat=async n=>{const t=Ce(0,100),e=15,i=new zat;i.setUnits(b0.Meters);const r=i.tables.addLType("DASHED","__ __ __",[.25,-.125]),s=i.addLayer("scaleLayer",gr.Red,"Continuous"),a=i.addLayer("titlesLayer",gr.Yellow,"Continuous"),l=i.addLayer("finalDepthLayer",gr.Yellow,"Continuous"),u=i.addLayer("waterLevelShapeLayer",gr.Red,"Continuous"),f=i.addLayer("waterLevelTextLayer",gr.Yellow,"Continuous"),d=i.addLayer("depthsLineLayer",gr.Yellow,r.name),p=i.addLayer("descriptionTextLayer",gr.Yellow,"Continuous"),m=i.tables.addStyle("arialText");m.fontFileName="arial.ttf",m.widthFactor=1,m.fixedTextHeight=0;const g={attachmentPoint:3,width:8,layerName:p.name},y=i.addBlock("scaleBlock");y.layerName=s.name;const x=new Aw;x.add(ss(0,0)),x.add(ss(.2,0)),x.add(ss(.2,-1)),x.add(ss(0,-1)),x.add(ss(0,0));const _=new Sw;_.addPolylineBoundary(x);const b={name:w0.SOLID};y.addHatch(_,b,{colorNumber:gr.Red}),y.addLine(Ce(0,-1),Ce(.2,-1));const S=i.addBlock("depthLineBlock");S.layerName=d.name;const A=[{point:xn(0,0)},{point:xn(-2.72,0)}];S.addLWPolyline(A);const C=i.addBlock("waterLevelBlock");C.layerName=u.name;const O=new Aw;O.add(ss(0,0)),O.add(ss(-.2754,.4406)),O.add(ss(.2754,.4406)),O.add(ss(0,0));const N=new Sw;N.addPolylineBoundary(O),C.addHatch(N,b),C.addLine(Ce(-.2754,.4406),Ce(1.574,.4406));const D=[];n.forEach((I,z)=>{try{const j=Ce(t.x+e*z,t.y),B=I.depths[I.depths.length-1];i.addLine(Ce(j.x+.1,j.y),Ce(j.x+.1,j.y+2.45),{layerName:a.name}),i.addLine(Ce(j.x+.1,j.y+2.45),Ce(j.x-4.95,j.y+2.45),{layerName:a.name});const tt=i.addText(Ce(j.x-.18,j.y+2.67),.65,I.hole_id.toUpperCase(),{layerName:a.name,horizontalAlignment:cc.Right,verticalAlignment:uc.Bottom,secondAlignmentPoint:Ce(j.x-.18,j.y+2.67)});tt.textStyle="arialText";const k=i.addText(Ce(j.x-.18,j.y+1.6),.45,I.z?"COTA="+I.z.toFixed(2).replace(".",","):"COTA=0",{layerName:a.name,horizontalAlignment:cc.Right,verticalAlignment:uc.Bottom,secondAlignmentPoint:Ce(j.x-.18,j.y+1.6)});k.textStyle="arialText",i.addLine(j,Ce(j.x,j.y-B),{colorNumber:gr.Red}),i.addLine(Ce(j.x+.2,j.y),Ce(j.x+.2,j.y-B),{colorNumber:gr.Red});for(let Et=0;Et<B-1;Et+=2)i.addInsert(y.name,Ce(j.x,j.y-Et),{colorNumber:gr.Red});const et=Math.floor(B);if(et!==B&&!(et%2)){const Et=new Aw;Et.add(ss(j.x,j.y-et)),Et.add(ss(j.x+.2,j.y-et)),Et.add(ss(j.x+.2,j.y-B)),Et.add(ss(j.x,j.y-B)),Et.add(ss(j.x,j.y-et));const G=new Sw;G.addPolylineBoundary(Et),i.addHatch(G,b,{colorNumber:gr.Red})}i.addLine(Ce(j.x,j.y-B),Ce(j.x+.2,j.y-B),{colorNumber:gr.Red});const K=Gat(I);let q=0;K.forEach(Et=>{let G=Et.layerSizes[0].from||0;q=Et.layerSizes[0].from,Et.layers.forEach((lt,rt)=>{const ot=Et.layerSizes.find(Q=>Q.layerIndex===lt);if(!ot)return;const bt=q+ot.finalHeight/2,St=I.interp?.[lt]?.trim(),R=I.geology[lt]?.trim();if(!R){console.warn(`Geology vazia no layer ${lt}`);return}const mt=St?St.toUpperCase()+" - "+R.toUpperCase():R.toUpperCase(),ut=ot.to,J=Et.unchanged?void 0:G+=ot.finalHeight;Vat(i,Et.layerSizes[rt],j,ut,mt,g,d,m,bt,J),q+=ot.finalHeight})});let at=I.nspt.start_depth;I.nspt.values.forEach(Et=>{const G=i.addText(Ce(j.x+.57,j.y-at-.12),.35,Et,{layerName:d.name,horizontalAlignment:cc.Left,verticalAlignment:uc.Top,secondAlignmentPoint:Ce(j.x+.57,j.y-at-.12)});G.textStyle=m.name,at+=1});const P=I.water_level??B,X=I.water_level!=null?"NA="+I.water_level.toFixed(2).replace(".",","):"NA SECO";i.addInsert(C.name,Ce(j.x+2.9136,j.y-P));const V=Ce(I.water_level?j.x+2.86:j.x+2.76,j.y-P+.48),it=i.addText(V,.25,X,{layerName:f.name,horizontalAlignment:cc.Left,verticalAlignment:uc.Bottom,secondAlignmentPoint:V});it.textStyle=m.name;const ht="PROFUNDIDADE FINAL = "+B.toFixed(2).replace(".",",")+" m.",yt=Ce(j.x-5.72,j.y-.87-q),Rt=i.addText(yt,.35,ht,{horizontalAlignment:cc.Left,verticalAlignment:uc.Top,secondAlignmentPoint:yt,layerName:l.name});Rt.textStyle=m.name}catch(j){console.error(`Erro no palito ${I.hole_id} (índice ${z}):`,j),D.push(I.hole_id);return}});const L=i.stringify();return $at(L,"palitos.dxf"),{success:!0,processErrorNames:D,totalProcessed:n.length,successCount:n.length-D.length}},$at=(n,t)=>{const e=new Blob([n],{type:"application/dxf"}),i=URL.createObjectURL(e),r=document.createElement("a");r.href=i,r.download=t,r.click(),URL.revokeObjectURL(i)},Gat=n=>{const t=n.geology.filter((u,f)=>f<n.depths.length-1).map((u,f)=>{if(f>=n.depths.length)return{str:"",lines:"",estimatedHeight:0,from:0,to:0,layerThickness:0};const d=n.interp?.[f]?.trim(),p=d?d.toUpperCase()+" - "+u.trim().toUpperCase():u.trim().toUpperCase(),m=Math.ceil(p.length/35),g=m*.45-.1,y=n.depths[f]||0,x=n.depths[f+1]||n.depths[n.depths.length],_=x-y;return{str:p,lines:m,estimatedHeight:g,from:y,to:x,layerThickness:_}});t.length>=n.depths.length&&t.splice(n.depths.length-1);const e=t.map(u=>u.layerThickness),i=t.map(u=>u.estimatedHeight);let r=[];for(let u=0;u<e.length;u++){const f=i[u]>e[u],d=f?i[u]-e[u]:0;r.push({index:u,hasOverflow:f,overflow:d,availableSpace:e[u]-i[u]})}const s=r.filter(u=>u.hasOverflow);let a=[],l=new Set;s.forEach(u=>{if(l.has(u.index))return;let f={startIndex:u.index,endIndex:u.index,layers:[u.index],totalNeeded:u.overflow,totalAvailable:0,needsExtraSpace:0,unchanged:!1,layerSizes:[]};for(;f.totalAvailable<f.totalNeeded&&(f.startIndex>0&&!l.has(f.startIndex)||f.endIndex<r.length-1);){const g=f.startIndex===0?!0:f.endIndex>=r.length-1?!1:r[f.startIndex-1].availableSpace<r[f.endIndex+1].availableSpace;g||(f.startIndex--,f.layers.unshift(f.startIndex),f.totalAvailable+=Math.max(0,r[f.startIndex].availableSpace),l.add(f.startIndex)),g&&f.endIndex<r.length&&(f.endIndex++,f.layers.push(f.endIndex),f.totalAvailable+=Math.max(0,r[f.endIndex].availableSpace),l.add(f.endIndex))}f.totalAvailable<f.totalNeeded&&(f.needsExtraSpace=f.totalNeeded-f.totalAvailable);const d=f.layers.reduce((g,y)=>g+e[y],0),p=f.layers.reduce((g,y)=>g+i[y],0),m=d+f.needsExtraSpace;f.layerSizes=f.layers.map(g=>{const y=i[g],x=y/p,_=m*x;return{layerIndex:g,originalHeight:e[g],textHeight:i[g],finalHeight:Math.max(y+.1,_),from:t[g].from,to:t[g].to}}),l.add(u.index),a.push(f)});for(let u=0;u<r.length;u++)if(!l.has(u)){const f={startIndex:u,endIndex:u,layers:[u],totalNeeded:0,totalAvailable:r[u].availableSpace,needsExtraSpace:0,layerSizes:[{layerIndex:u,originalHeight:e[u],textHeight:i[u],finalHeight:e[u],from:t[u].from,to:t[u].to}],unchanged:!0};a.push(f)}return a.sort((u,f)=>u.startIndex-f.startIndex),a},Vat=(n,t,e,i,r,s,a,l,u,f)=>{f||(f=0);const g=f?[{point:xn(e.x,e.y-i)},{point:xn(e.x-1.35,e.y-i)},{point:xn(e.x-1.45,e.y-f)},{point:xn(e.x-2.72,e.y-f)}]:[{point:xn(e.x,e.y-i)},{point:xn(e.x-2.72,e.y-i)}];n.addLWPolyline(g,{layerName:a.name});const y=n.addText(Ce(e.x-.15,e.y-i-.07),.35,i.toFixed(2).replace(".",","),{layerName:a.name,horizontalAlignment:cc.Right,verticalAlignment:uc.Bottom,secondAlignmentPoint:Ce(e.x-.15,e.y-i-.07)});y.textStyle=l.name;const x=Ce(e.x-1.55,e.y-u+t.textHeight/2),_=n.addMText(x,.25,r,s);_.textStyle=l.name},Wat=({palitoData:n,onUpdatePalito:t})=>{const[e,i]=U.useState(0),[r,s]=U.useState(!1),[a,l]=U.useState(null),u=()=>{l(JSON.parse(JSON.stringify(p))),s(!0)},f=()=>{s(!1),a&&t(e,a),l(null)},d=()=>{l(null),s(!1)};if(n.length===0)return M.jsxs(sl,{className:"mt-2",children:[M.jsx(sl.Header,{children:M.jsx("h5",{className:"card-title",children:"Preview dos Dados"})}),M.jsx(sl.Body,{children:M.jsx("p",{className:"text-muted",children:"Nenhum dado disponível para preview"})})]});const p=n[e],m=()=>{i(y=>y>0?y-1:n.length-1)},g=()=>{i(y=>y<n.length-1?y+1:0)};return M.jsxs(sl,{className:"mt-2",children:[M.jsx(sl.Header,{children:M.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[M.jsx("h5",{className:"card-title mb-0",children:"Preview dos Dados"}),M.jsxs("div",{className:"d-flex align-items-center gap-2",children:[M.jsx(Ra,{variant:"outline-secondary",size:"sm",onClick:m,disabled:n.length<=1,children:M.jsx(nL,{size:16})}),M.jsx(As.Select,{size:"sm",style:{width:"200px"},value:e,onChange:y=>i(parseInt(y.target.value)),children:n.map((y,x)=>M.jsx("option",{value:x,children:y.hole_id||`Sondagem ${x+1}`},x))}),M.jsx(Ra,{variant:"outline-secondary",size:"sm",onClick:g,disabled:n.length<=1,children:M.jsx(iL,{size:16})})]})]})}),M.jsxs(sl.Body,{children:[M.jsxs(Na,{children:[M.jsx(ii,{xs:9,className:"mb-3",children:M.jsxs(Na,{className:"text-start g-0",children:[M.jsx(ii,{xs:7,className:"pb-1 pe-1",children:M.jsxs("div",{className:"d-flex align-items-centerjustify-content-start gap-1",children:[M.jsx("span",{className:"fw-bold",style:{width:"120px"},children:"Sondagem: "}),r?M.jsx(M.Fragment,{children:M.jsx(As.Control,{type:"text",size:"sm",value:a?.hole_id||"",style:{width:"100px"},onChange:y=>{l(x=>x?{...x,hole_id:y.target.value}:null)}})}):M.jsx("span",{children:p.hole_id})]})}),M.jsx(ii,{xs:5,className:"pb-1 pe-1",children:M.jsxs("div",{className:"d-flex align-items-centerjustify-content-start gap-1",children:[M.jsx("span",{className:"fw-bold",style:{width:"120px"},children:"Cota: "}),r?M.jsx(As.Control,{type:"number",size:"sm",value:a?.z||"0",style:{width:"100px"},onChange:y=>{l(x=>x?{...x,z:parseFloat(y.target.value)}:null)}}):M.jsxs("span",{children:[p.z??0,"m"]})]})}),M.jsx(ii,{xs:7,className:"pb-1 pe-1",children:M.jsxs("div",{className:"d-flex align-items-centerjustify-content-start gap-1",children:[M.jsx("span",{className:"fw-bold",style:{width:"120px"},children:"Nível d'água: "}),r?M.jsx(As.Control,{type:"number",size:"sm",value:a?.water_level||"SECO",style:{width:"100px"},onChange:y=>{l(x=>x?{...x,water_level:parseFloat(y.target.value)}:null)}}):M.jsx("span",{children:p.water_level?p.water_level.toString()+"m":"SECO"})]})}),M.jsx(ii,{xs:5,className:"pb-1 pe-1",children:M.jsxs("div",{className:"d-flex align-items-centerjustify-content-start gap-1",children:[M.jsx("span",{className:"fw-bold",style:{width:"120px"},children:"Prof. Total: "}),M.jsx("span",{children:r?M.jsx(As.Control,{style:{width:"100px"},type:"number",size:"sm",value:a?.depths[a?.depths.length-1]||"0",onChange:y=>{l(x=>{if(!x||!a)return null;const _=x.depths.map((b,S)=>S===a.depths.length-1?parseFloat(y.target.value)||0:b);return{...x,depths:_}})}}):p.depths[p.depths.length-1]+"m"})]})})]})}),M.jsx(ii,{xs:3,children:r?M.jsx(M.Fragment,{children:M.jsxs(yk,{children:[M.jsx(Ra,{variant:"success",onClick:f,children:M.jsx(eL,{size:16})}),M.jsx(Ra,{variant:"danger",onClick:d,children:M.jsx(ax,{size:16})})]})}):M.jsx(Ra,{onClick:u,children:"Editar"})})]}),M.jsx("hr",{}),M.jsxs(Na,{children:[M.jsxs(ii,{xs:10,children:[M.jsx("strong",{children:"Descrição Geológica:"}),M.jsx("div",{className:"mt-2",style:{maxHeight:"50vh",overflowY:"auto"},children:p.depths.map((y,x)=>{const _=p.depths[x+1],b=p.geology[x];return _?M.jsxs("div",{className:"border rounded mb-2 bg-light",children:[M.jsxs(Na,{className:"g-0 ps-3 mt-1",children:[M.jsx(ii,{sm:4,className:"text-start",children:M.jsxs("div",{className:"d-flex align-items-start",children:[M.jsx("span",{className:"pe-2",children:"Início: "}),r?M.jsx(As.Control,{style:{width:"50px",marginLeft:"10px"},type:"number",size:"sm",value:a?.depths[x]||"0",onChange:S=>{l(A=>{if(!A)return null;const C=A.depths.map((O,N)=>N===x?parseFloat(S.target.value)||0:O);return{...A,depths:C}})}}):M.jsxs("span",{className:"fw-bold",children:[y,"m"]})]})}),M.jsx(ii,{sm:4,className:"text-start",children:M.jsxs("div",{className:"d-flex align-items-start",children:[M.jsx("span",{className:"pe-2",children:"Fim: "}),r?M.jsx(As.Control,{style:{width:"50px",marginLeft:"10px"},type:"number",size:"sm",value:a?.depths[x+1]||"0",onChange:S=>{l(A=>{if(!A)return null;const C=A.depths.map((O,N)=>N===x+1?parseFloat(S.target.value)||0:O);return{...A,depths:C}})}}):M.jsxs("span",{className:"fw-bold",children:[_,"m"]})]})})]}),M.jsx(Na,{className:"g-0 ps-3",children:M.jsx(ii,{xs:12,className:"my-1 text-start text-muted small pe-2",children:r?M.jsx(As.Control,{type:"text",as:"textarea",size:"sm",value:a?.geology[x]||"0",onChange:S=>{l(A=>{if(!A)return null;const C=A.geology.map((O,N)=>N===x?S.target.value||"Sem descrição":O);return{...A,geology:C}})}}):b||"Sem descrição"})})]},x):null})})]}),M.jsxs(ii,{xs:2,children:[M.jsx("strong",{children:"NSPT:"}),M.jsx("div",{className:"mt-2 mb-3 p-2 border rounded bg-light",children:M.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[M.jsx("span",{className:"small",children:"Inicia em:"}),r?M.jsx(As.Control,{type:"number",size:"sm",style:{width:"60px"},value:a?.nspt.start_depth||p.nspt.start_depth,onChange:y=>{l(x=>x?{...x,nspt:{...x.nspt,start_depth:parseFloat(y.target.value)||0}}:null)}}):M.jsxs("span",{className:"fw-bold",children:[p.nspt.start_depth,"m"]})]})}),M.jsx("div",{style:{maxHeight:"50vh",overflowY:"auto"},children:p.nspt.values.map((y,x)=>{const _=p.nspt.start_depth+x*p.nspt.interval,b=p.depths[p.depths.length-1],S=_>b;return M.jsxs("div",{className:`border rounded mb-2 p-2 ${S?"bg-warning-subtle border-warning":"bg-light"}`,children:[M.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[M.jsxs("span",{className:`small ${S?"text-warning-emphasis":""}`,children:[_,"m:"]}),r?M.jsx(As.Control,{type:"text",size:"sm",style:{width:"60px"},value:a?.nspt.values[x]||y,onChange:A=>{l(C=>{if(!C)return null;const O=[...C.nspt.values];return O[x]=A.target.value,{...C,nspt:{...C.nspt,values:O}}})}}):M.jsx("span",{className:`fw-bold ${S?"text-warning-emphasis":""}`,children:y})]}),S&&M.jsx("small",{className:"text-warning-emphasis",children:"Fora da sondagem"})]},x)})})]})]})]})]})},Xat=({areas:n,extractedTexts:t})=>{const[e,i]=U.useState([]),[r,s]=U.useState(!1),[a,l]=U.useState(null),u=async()=>{try{s(!0);const y=await(await fetch("./test.json")).json();i(y),l({type:"success",text:"Dados de teste carregados com sucesso!"})}catch(g){l({type:"error",text:"Erro ao carregar dados de teste"}),console.error("Erro:",g)}finally{s(!1)}},f=async()=>{try{s(!0);const g=ik(n,t);i(g),l({type:"success",text:"Dados extraídos carregados com sucesso!"})}catch(g){l({type:"error",text:"Erro ao carregar dados de teste"}),console.error("Erro:",g)}finally{s(!1)}},d=g=>{const y=g.target.files?.[0];if(!y)return;const x=new FileReader;x.onload=_=>{try{const b=JSON.parse(_.target?.result);i(b),l({type:"success",text:"Arquivo JSON carregado com sucesso!"})}catch(b){l({type:"error",text:"Erro ao processar arquivo JSON"}),console.error("Erro:",b)}},x.readAsText(y)},p=async()=>{if(e.length===0){l({type:"error",text:"Nenhum dado carregado para gerar DXF"});return}try{s(!0);const g=await Hat(e);g.processErrorNames.length>0?l({type:"warning",text:`DXF gerado! ${g.successCount}/${g.totalProcessed} palitos processados. Falhas: ${g.processErrorNames.join(", ")}`}):l({type:"success",text:"DXF gerado com sucesso!"})}catch(g){l({type:"error",text:"Erro ao gerar DXF!"}),console.error("Erro:",g)}finally{s(!1)}},m=(g,y)=>{i(x=>x.map((_,b)=>g===b?y:_))};return M.jsx(Y0,{fluid:!0,children:M.jsxs(Na,{className:"justify-content-center",children:[M.jsx(ii,{md:6,lg:5,children:M.jsxs(sl,{children:[M.jsx(sl.Header,{children:M.jsx("h3",{className:"mb-0",children:"Gerador de Palitos DXF"})}),M.jsxs(sl.Body,{children:[a&&M.jsx(Jit,{variant:a.type==="success"?"success":a.type==="warning"?"warning":"danger",onClose:()=>l(null),dismissible:!0,children:a.text}),M.jsx("div",{className:"mb-4",children:M.jsxs(Na,{children:[M.jsx(ii,{md:4,children:M.jsx(Ra,{variant:"outline-primary",onClick:u,disabled:r,className:"w-100 mb-2",children:r?"Carregando...":"Usar Dados de Teste"})}),M.jsx(ii,{md:4,children:M.jsx(Ra,{variant:"outline-primary",onClick:f,disabled:r,className:"w-100 mb-2",children:r?"Carregando...":"Usar Dados Extraídos"})}),M.jsx(ii,{md:4,children:M.jsxs(As.Group,{children:[M.jsx(As.Label,{children:"Upload de JSON:"}),M.jsx(As.Control,{type:"file",accept:".json",onChange:d})]})})]})}),M.jsx("div",{className:"mb-4",children:M.jsx(Ra,{variant:"success",size:"lg",onClick:p,disabled:r||e.length===0,className:"w-100",children:r?"Gerando...":`Gerar DXF (${e.length} palito${e.length!==1?"s":""})`})})]})]})}),M.jsx(ii,{md:6,lg:7,children:M.jsx(Wat,{palitoData:e,onUpdatePalito:m})})]})})},Yat=({currentPage:n,onChangePage:t})=>M.jsx(Kf,{className:"border-bottom mb-2",children:M.jsxs(Y0,{fluid:!0,className:"px-4",children:[M.jsx(Kf.Brand,{className:"text-dark fw-bold",children:M.jsx("img",{src:"js_open_geo_logo.png",alt:"JS OpenGeo",style:{height:"40px"}})}),M.jsxs(ra,{className:"mx-auto",children:[M.jsx(ra.Link,{active:n==="extraction",onClick:n==="extraction"?void 0:()=>t("extraction"),style:{cursor:n==="extraction"?"default":"pointer"},className:`px-4 ${n==="extraction"&&"fw-bold"}`,children:"Extração de Dados"}),M.jsx(ra.Link,{active:n==="dxf",onClick:n==="dxf"?void 0:()=>t("dxf"),style:{cursor:n==="dxf"?"default":"pointer"},className:`px-4 ${n==="dxf"&&"fw-bold"}`,children:"Geração de Palitos"})]})]})});function qat(){const[n,t]=U.useState("extraction"),[e,i]=U.useState([]),[r,s]=U.useState(null),[a,l]=U.useState([]);return M.jsxs(Y0,{fluid:!0,className:"text-center px-xl-5",children:[M.jsx(Na,{className:"justify-content-center",children:M.jsx(ii,{children:M.jsx(Ist,{})})}),M.jsx(Na,{className:"justify-content-center",children:M.jsx(ii,{children:M.jsx(Yat,{currentPage:n,onChangePage:t})})}),n==="extraction"?M.jsx(Lst,{areas:e,setAreas:i,selectedFile:r,setSelectedFile:s,extractedTexts:a,setExtractedTexts:l}):M.jsx(Xat,{areas:e,extractedTexts:a})]})}t8.createRoot(document.getElementById("root")).render(M.jsx(U.StrictMode,{children:M.jsx(qat,{})}));
