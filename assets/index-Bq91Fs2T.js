var ow=n=>{throw TypeError(n)};var wv=(n,t,e)=>t.has(n)||ow("Cannot "+e);var Mn=(n,t,e)=>(wv(n,t,"read from private field"),e?e.call(n):t.get(n)),Sa=(n,t,e)=>t.has(n)?ow("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),Bi=(n,t,e,r)=>(wv(n,t,"write to private field"),r?r.call(n,e):t.set(n,e),e),Ta=(n,t,e)=>(wv(n,t,"access private method"),e);var lw=(n,t,e,r)=>({set _(i){Bi(n,t,i,e)},get _(){return Mn(n,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();var jp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function bN(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),e}var Av={exports:{}},Gh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cw;function xN(){if(cw)return Gh;cw=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(r,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var l in i)l!=="key"&&(s[l]=i[l])}else s=i;return i=s.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:s}}return Gh.Fragment=t,Gh.jsx=e,Gh.jsxs=e,Gh}var uw;function EN(){return uw||(uw=1,Av.exports=xN()),Av.exports}var ot=EN(),Sv={exports:{}},Ge={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fw;function wN(){if(fw)return Ge;fw=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function g(z){return z===null||typeof z!="object"?null:(z=p&&z[p]||z["@@iterator"],typeof z=="function"?z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,_={};function b(z,J,V){this.props=z,this.context=J,this.refs=_,this.updater=V||v}b.prototype.isReactComponent={},b.prototype.setState=function(z,J){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,J,"setState")},b.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function E(){}E.prototype=b.prototype;function S(z,J,V){this.props=z,this.context=J,this.refs=_,this.updater=V||v}var T=S.prototype=new E;T.constructor=S,y(T,b.prototype),T.isPureReactComponent=!0;var O=Array.isArray,R={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function C(z,J,V,ct,gt,_t){return V=_t.ref,{$$typeof:n,type:z,key:J,ref:V!==void 0?V:null,props:_t}}function I(z,J){return C(z.type,J,void 0,void 0,void 0,z.props)}function M(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function F(z){var J={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(V){return J[V]})}var H=/\/+/g;function P(z,J){return typeof z=="object"&&z!==null&&z.key!=null?F(""+z.key):J.toString(36)}function et(){}function L(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(et,et):(z.status="pending",z.then(function(J){z.status==="pending"&&(z.status="fulfilled",z.value=J)},function(J){z.status==="pending"&&(z.status="rejected",z.reason=J)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function st(z,J,V,ct,gt){var _t=typeof z;(_t==="undefined"||_t==="boolean")&&(z=null);var Bt=!1;if(z===null)Bt=!0;else switch(_t){case"bigint":case"string":case"number":Bt=!0;break;case"object":switch(z.$$typeof){case n:case t:Bt=!0;break;case d:return Bt=z._init,st(Bt(z._payload),J,V,ct,gt)}}if(Bt)return gt=gt(z),Bt=ct===""?"."+P(z,0):ct,O(gt)?(V="",Bt!=null&&(V=Bt.replace(H,"$&/")+"/"),st(gt,J,V,"",function(pt){return pt})):gt!=null&&(M(gt)&&(gt=I(gt,V+(gt.key==null||z&&z.key===gt.key?"":(""+gt.key).replace(H,"$&/")+"/")+Bt)),J.push(gt)),1;Bt=0;var Gt=ct===""?".":ct+":";if(O(z))for(var j=0;j<z.length;j++)ct=z[j],_t=Gt+P(ct,j),Bt+=st(ct,J,V,_t,gt);else if(j=g(z),typeof j=="function")for(z=j.call(z),j=0;!(ct=z.next()).done;)ct=ct.value,_t=Gt+P(ct,j++),Bt+=st(ct,J,V,_t,gt);else if(_t==="object"){if(typeof z.then=="function")return st(L(z),J,V,ct,gt);throw J=String(z),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Bt}function Q(z,J,V){if(z==null)return z;var ct=[],gt=0;return st(z,ct,"","",function(_t){return J.call(V,_t,gt++)}),ct}function Y(z){if(z._status===-1){var J=z._result;J=J(),J.then(function(V){(z._status===0||z._status===-1)&&(z._status=1,z._result=V)},function(V){(z._status===0||z._status===-1)&&(z._status=2,z._result=V)}),z._status===-1&&(z._status=0,z._result=J)}if(z._status===1)return z._result.default;throw z._result}var Ot=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)};function Et(){}return Ge.Children={map:Q,forEach:function(z,J,V){Q(z,function(){J.apply(this,arguments)},V)},count:function(z){var J=0;return Q(z,function(){J++}),J},toArray:function(z){return Q(z,function(J){return J})||[]},only:function(z){if(!M(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},Ge.Component=b,Ge.Fragment=e,Ge.Profiler=i,Ge.PureComponent=S,Ge.StrictMode=r,Ge.Suspense=u,Ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ge.__COMPILER_RUNTIME={__proto__:null,c:function(z){return R.H.useMemoCache(z)}},Ge.cache=function(z){return function(){return z.apply(null,arguments)}},Ge.cloneElement=function(z,J,V){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var ct=y({},z.props),gt=z.key,_t=void 0;if(J!=null)for(Bt in J.ref!==void 0&&(_t=void 0),J.key!==void 0&&(gt=""+J.key),J)!N.call(J,Bt)||Bt==="key"||Bt==="__self"||Bt==="__source"||Bt==="ref"&&J.ref===void 0||(ct[Bt]=J[Bt]);var Bt=arguments.length-2;if(Bt===1)ct.children=V;else if(1<Bt){for(var Gt=Array(Bt),j=0;j<Bt;j++)Gt[j]=arguments[j+2];ct.children=Gt}return C(z.type,gt,void 0,void 0,_t,ct)},Ge.createContext=function(z){return z={$$typeof:o,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:s,_context:z},z},Ge.createElement=function(z,J,V){var ct,gt={},_t=null;if(J!=null)for(ct in J.key!==void 0&&(_t=""+J.key),J)N.call(J,ct)&&ct!=="key"&&ct!=="__self"&&ct!=="__source"&&(gt[ct]=J[ct]);var Bt=arguments.length-2;if(Bt===1)gt.children=V;else if(1<Bt){for(var Gt=Array(Bt),j=0;j<Bt;j++)Gt[j]=arguments[j+2];gt.children=Gt}if(z&&z.defaultProps)for(ct in Bt=z.defaultProps,Bt)gt[ct]===void 0&&(gt[ct]=Bt[ct]);return C(z,_t,void 0,void 0,null,gt)},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(z){return{$$typeof:l,render:z}},Ge.isValidElement=M,Ge.lazy=function(z){return{$$typeof:d,_payload:{_status:-1,_result:z},_init:Y}},Ge.memo=function(z,J){return{$$typeof:h,type:z,compare:J===void 0?null:J}},Ge.startTransition=function(z){var J=R.T,V={};R.T=V;try{var ct=z(),gt=R.S;gt!==null&&gt(V,ct),typeof ct=="object"&&ct!==null&&typeof ct.then=="function"&&ct.then(Et,Ot)}catch(_t){Ot(_t)}finally{R.T=J}},Ge.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Ge.use=function(z){return R.H.use(z)},Ge.useActionState=function(z,J,V){return R.H.useActionState(z,J,V)},Ge.useCallback=function(z,J){return R.H.useCallback(z,J)},Ge.useContext=function(z){return R.H.useContext(z)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(z,J){return R.H.useDeferredValue(z,J)},Ge.useEffect=function(z,J,V){var ct=R.H;if(typeof V=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ct.useEffect(z,J)},Ge.useId=function(){return R.H.useId()},Ge.useImperativeHandle=function(z,J,V){return R.H.useImperativeHandle(z,J,V)},Ge.useInsertionEffect=function(z,J){return R.H.useInsertionEffect(z,J)},Ge.useLayoutEffect=function(z,J){return R.H.useLayoutEffect(z,J)},Ge.useMemo=function(z,J){return R.H.useMemo(z,J)},Ge.useOptimistic=function(z,J){return R.H.useOptimistic(z,J)},Ge.useReducer=function(z,J,V){return R.H.useReducer(z,J,V)},Ge.useRef=function(z){return R.H.useRef(z)},Ge.useState=function(z){return R.H.useState(z)},Ge.useSyncExternalStore=function(z,J,V){return R.H.useSyncExternalStore(z,J,V)},Ge.useTransition=function(){return R.H.useTransition()},Ge.version="19.1.0",Ge}var hw;function _m(){return hw||(hw=1,Sv.exports=wN()),Sv.exports}var At=_m();const Qn=vm(At);var Tv={exports:{}},Vh={},Cv={exports:{}},Dv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dw;function AN(){return dw||(dw=1,function(n){function t(Q,Y){var Ot=Q.length;Q.push(Y);t:for(;0<Ot;){var Et=Ot-1>>>1,z=Q[Et];if(0<i(z,Y))Q[Et]=Y,Q[Ot]=z,Ot=Et;else break t}}function e(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var Y=Q[0],Ot=Q.pop();if(Ot!==Y){Q[0]=Ot;t:for(var Et=0,z=Q.length,J=z>>>1;Et<J;){var V=2*(Et+1)-1,ct=Q[V],gt=V+1,_t=Q[gt];if(0>i(ct,Ot))gt<z&&0>i(_t,ct)?(Q[Et]=_t,Q[gt]=Ot,Et=gt):(Q[Et]=ct,Q[V]=Ot,Et=V);else if(gt<z&&0>i(_t,Ot))Q[Et]=_t,Q[gt]=Ot,Et=gt;else break t}}return Y}function i(Q,Y){var Ot=Q.sortIndex-Y.sortIndex;return Ot!==0?Ot:Q.id-Y.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var u=[],h=[],d=1,p=null,g=3,v=!1,y=!1,_=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function O(Q){for(var Y=e(h);Y!==null;){if(Y.callback===null)r(h);else if(Y.startTime<=Q)r(h),Y.sortIndex=Y.expirationTime,t(u,Y);else break;Y=e(h)}}function R(Q){if(_=!1,O(Q),!y)if(e(u)!==null)y=!0,N||(N=!0,P());else{var Y=e(h);Y!==null&&st(R,Y.startTime-Q)}}var N=!1,C=-1,I=5,M=-1;function F(){return b?!0:!(n.unstable_now()-M<I)}function H(){if(b=!1,N){var Q=n.unstable_now();M=Q;var Y=!0;try{t:{y=!1,_&&(_=!1,S(C),C=-1),v=!0;var Ot=g;try{e:{for(O(Q),p=e(u);p!==null&&!(p.expirationTime>Q&&F());){var Et=p.callback;if(typeof Et=="function"){p.callback=null,g=p.priorityLevel;var z=Et(p.expirationTime<=Q);if(Q=n.unstable_now(),typeof z=="function"){p.callback=z,O(Q),Y=!0;break e}p===e(u)&&r(u),O(Q)}else r(u);p=e(u)}if(p!==null)Y=!0;else{var J=e(h);J!==null&&st(R,J.startTime-Q),Y=!1}}break t}finally{p=null,g=Ot,v=!1}Y=void 0}}finally{Y?P():N=!1}}}var P;if(typeof T=="function")P=function(){T(H)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,L=et.port2;et.port1.onmessage=H,P=function(){L.postMessage(null)}}else P=function(){E(H,0)};function st(Q,Y){C=E(function(){Q(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_next=function(Q){switch(g){case 1:case 2:case 3:var Y=3;break;default:Y=g}var Ot=g;g=Y;try{return Q()}finally{g=Ot}},n.unstable_requestPaint=function(){b=!0},n.unstable_runWithPriority=function(Q,Y){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var Ot=g;g=Q;try{return Y()}finally{g=Ot}},n.unstable_scheduleCallback=function(Q,Y,Ot){var Et=n.unstable_now();switch(typeof Ot=="object"&&Ot!==null?(Ot=Ot.delay,Ot=typeof Ot=="number"&&0<Ot?Et+Ot:Et):Ot=Et,Q){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Ot+z,Q={id:d++,callback:Y,priorityLevel:Q,startTime:Ot,expirationTime:z,sortIndex:-1},Ot>Et?(Q.sortIndex=Ot,t(h,Q),e(u)===null&&Q===e(h)&&(_?(S(C),C=-1):_=!0,st(R,Ot-Et))):(Q.sortIndex=z,t(u,Q),y||v||(y=!0,N||(N=!0,P()))),Q},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(Q){var Y=g;return function(){var Ot=g;g=Y;try{return Q.apply(this,arguments)}finally{g=Ot}}}}(Dv)),Dv}var pw;function SN(){return pw||(pw=1,Cv.exports=AN()),Cv.exports}var Ov={exports:{}},Yr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gw;function TN(){if(gw)return Yr;gw=1;var n=_m();function t(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var r={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(u,h,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:h,implementation:d}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Yr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Yr.createPortal=function(u,h){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return s(u,h,null,d)},Yr.flushSync=function(u){var h=o.T,d=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=h,r.p=d,r.d.f()}},Yr.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(u,h))},Yr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Yr.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var d=h.as,p=l(d,h.crossOrigin),g=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;d==="style"?r.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:v}):d==="script"&&r.d.X(u,{crossOrigin:p,integrity:g,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Yr.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var d=l(h.as,h.crossOrigin);r.d.M(u,{crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(u)},Yr.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var d=h.as,p=l(d,h.crossOrigin);r.d.L(u,d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Yr.preloadModule=function(u,h){if(typeof u=="string")if(h){var d=l(h.as,h.crossOrigin);r.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(u)},Yr.requestFormReset=function(u){r.d.r(u)},Yr.unstable_batchedUpdates=function(u,h){return u(h)},Yr.useFormState=function(u,h,d){return o.H.useFormState(u,h,d)},Yr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Yr.version="19.1.0",Yr}var mw;function RS(){if(mw)return Ov.exports;mw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Ov.exports=TN(),Ov.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vw;function CN(){if(vw)return Vh;vw=1;var n=SN(),t=_m(),e=RS();function r(a){var c="https://react.dev/errors/"+a;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function s(a){var c=a,f=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,(c.flags&4098)!==0&&(f=c.return),a=c.return;while(a)}return c.tag===3?f:null}function o(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function l(a){if(s(a)!==a)throw Error(r(188))}function u(a){var c=a.alternate;if(!c){if(c=s(a),c===null)throw Error(r(188));return c!==a?null:a}for(var f=a,m=c;;){var x=f.return;if(x===null)break;var A=x.alternate;if(A===null){if(m=x.return,m!==null){f=m;continue}break}if(x.child===A.child){for(A=x.child;A;){if(A===f)return l(x),a;if(A===m)return l(x),c;A=A.sibling}throw Error(r(188))}if(f.return!==m.return)f=x,m=A;else{for(var B=!1,W=x.child;W;){if(W===f){B=!0,f=x,m=A;break}if(W===m){B=!0,m=x,f=A;break}W=W.sibling}if(!B){for(W=A.child;W;){if(W===f){B=!0,f=A,m=x;break}if(W===m){B=!0,m=A,f=x;break}W=W.sibling}if(!B)throw Error(r(189))}}if(f.alternate!==m)throw Error(r(190))}if(f.tag!==3)throw Error(r(188));return f.stateNode.current===f?a:c}function h(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a;for(a=a.child;a!==null;){if(c=h(a),c!==null)return c;a=a.sibling}return null}var d=Object.assign,p=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),S=Symbol.for("react.consumer"),T=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function P(a){return a===null||typeof a!="object"?null:(a=H&&a[H]||a["@@iterator"],typeof a=="function"?a:null)}var et=Symbol.for("react.client.reference");function L(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===et?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case y:return"Fragment";case b:return"Profiler";case _:return"StrictMode";case R:return"Suspense";case N:return"SuspenseList";case M:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case v:return"Portal";case T:return(a.displayName||"Context")+".Provider";case S:return(a._context.displayName||"Context")+".Consumer";case O:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case C:return c=a.displayName||null,c!==null?c:L(a.type)||"Memo";case I:c=a._payload,a=a._init;try{return L(a(c))}catch{}}return null}var st=Array.isArray,Q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ot={pending:!1,data:null,method:null,action:null},Et=[],z=-1;function J(a){return{current:a}}function V(a){0>z||(a.current=Et[z],Et[z]=null,z--)}function ct(a,c){z++,Et[z]=a.current,a.current=c}var gt=J(null),_t=J(null),Bt=J(null),Gt=J(null);function j(a,c){switch(ct(Bt,c),ct(_t,a),ct(gt,null),c.nodeType){case 9:case 11:a=(a=c.documentElement)&&(a=a.namespaceURI)?IE(a):0;break;default:if(a=c.tagName,c=c.namespaceURI)c=IE(c),a=PE(c,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}V(gt),ct(gt,a)}function pt(){V(gt),V(_t),V(Bt)}function lt(a){a.memoizedState!==null&&ct(Gt,a);var c=gt.current,f=PE(c,a.type);c!==f&&(ct(_t,a),ct(gt,f))}function ut(a){_t.current===a&&(V(gt),V(_t)),Gt.current===a&&(V(Gt),Uh._currentValue=Ot)}var Dt=Object.prototype.hasOwnProperty,Lt=n.unstable_scheduleCallback,D=n.unstable_cancelCallback,dt=n.unstable_shouldYield,it=n.unstable_requestPaint,q=n.unstable_now,X=n.unstable_getCurrentPriorityLevel,ft=n.unstable_ImmediatePriority,Pt=n.unstable_UserBlockingPriority,zt=n.unstable_NormalPriority,bt=n.unstable_LowPriority,Rt=n.unstable_IdlePriority,qt=n.log,xt=n.unstable_setDisableYieldValue,se=null,de=null;function ae(a){if(typeof qt=="function"&&xt(a),de&&typeof de.setStrictMode=="function")try{de.setStrictMode(se,a)}catch{}}var ze=Math.clz32?Math.clz32:_n,Cn=Math.log,Se=Math.LN2;function _n(a){return a>>>=0,a===0?32:31-(Cn(a)/Se|0)|0}var qe=256,yr=4194304;function Bn(a){var c=a&42;if(c!==0)return c;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function kn(a,c,f){var m=a.pendingLanes;if(m===0)return 0;var x=0,A=a.suspendedLanes,B=a.pingedLanes;a=a.warmLanes;var W=m&134217727;return W!==0?(m=W&~A,m!==0?x=Bn(m):(B&=W,B!==0?x=Bn(B):f||(f=W&~a,f!==0&&(x=Bn(f))))):(W=m&~A,W!==0?x=Bn(W):B!==0?x=Bn(B):f||(f=m&~a,f!==0&&(x=Bn(f)))),x===0?0:c!==0&&c!==x&&(c&A)===0&&(A=x&-x,f=c&-c,A>=f||A===32&&(f&4194048)!==0)?c:x}function ai(a,c){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&c)===0}function Fo(a,c){switch(a){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $a(){var a=qe;return qe<<=1,(qe&4194048)===0&&(qe=256),a}function Ga(){var a=yr;return yr<<=1,(yr&62914560)===0&&(yr=4194304),a}function zs(a){for(var c=[],f=0;31>f;f++)c.push(a);return c}function br(a,c){a.pendingLanes|=c,c!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Ci(a,c,f,m,x,A){var B=a.pendingLanes;a.pendingLanes=f,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=f,a.entangledLanes&=f,a.errorRecoveryDisabledLanes&=f,a.shellSuspendCounter=0;var W=a.entanglements,ht=a.expirationTimes,Mt=a.hiddenUpdates;for(f=B&~f;0<f;){var $t=31-ze(f),Kt=1<<$t;W[$t]=0,ht[$t]=-1;var Ft=Mt[$t];if(Ft!==null)for(Mt[$t]=null,$t=0;$t<Ft.length;$t++){var Ut=Ft[$t];Ut!==null&&(Ut.lane&=-536870913)}f&=~Kt}m!==0&&Pl(a,m,0),A!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=A&~(B&~c))}function Pl(a,c,f){a.pendingLanes|=c,a.suspendedLanes&=~c;var m=31-ze(c);a.entangledLanes|=c,a.entanglements[m]=a.entanglements[m]|1073741824|f&4194090}function Gc(a,c){var f=a.entangledLanes|=c;for(a=a.entanglements;f;){var m=31-ze(f),x=1<<m;x&c|a[m]&c&&(a[m]|=c),f&=~x}}function Fl(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Bl(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Vc(){var a=Y.p;return a!==0?a:(a=window.event,a===void 0?32:ew(a.type))}function aa(a,c){var f=Y.p;try{return Y.p=a,c()}finally{Y.p=f}}var Hr=Math.random().toString(36).slice(2),tr="__reactFiber$"+Hr,er="__reactProps$"+Hr,oa="__reactContainer$"+Hr,Ul="__reactEvents$"+Hr,Tf="__reactListeners$"+Hr,G="__reactHandles$"+Hr,rt="__reactResources$"+Hr,Z="__reactMarker$"+Hr;function tt(a){delete a[tr],delete a[er],delete a[Ul],delete a[Tf],delete a[G]}function nt(a){var c=a[tr];if(c)return c;for(var f=a.parentNode;f;){if(c=f[oa]||f[tr]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(a=zE(a);a!==null;){if(f=a[tr])return f;a=zE(a)}return c}a=f,f=a.parentNode}return null}function at(a){if(a=a[tr]||a[oa]){var c=a.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return a}return null}function kt(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a.stateNode;throw Error(r(33))}function Ht(a){var c=a[rt];return c||(c=a[rt]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function yt(a){a[Z]=!0}var Tt=new Set,Ct={};function Vt(a,c){te(a,c),te(a+"Capture",c)}function te(a,c){for(Ct[a]=c,a=0;a<c.length;a++)Tt.add(c[a])}var oe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qt={},ee={};function Le(a){return Dt.call(ee,a)?!0:Dt.call(Qt,a)?!1:oe.test(a)?ee[a]=!0:(Qt[a]=!0,!1)}function rn(a,c,f){if(Le(c))if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":a.removeAttribute(c);return;case"boolean":var m=c.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){a.removeAttribute(c);return}}a.setAttribute(c,""+f)}}function Ze(a,c,f){if(f===null)a.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttribute(c,""+f)}}function fn(a,c,f,m){if(m===null)a.removeAttribute(f);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(f);return}a.setAttributeNS(c,f,""+m)}}var Gi,ps;function oi(a){if(Gi===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);Gi=c&&c[1]||"",ps=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gi+a+ps}var Di=!1;function la(a,c){if(!a||Di)return"";Di=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(c){var Kt=function(){throw Error()};if(Object.defineProperty(Kt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Kt,[])}catch(Ut){var Ft=Ut}Reflect.construct(a,[],Kt)}else{try{Kt.call()}catch(Ut){Ft=Ut}a.call(Kt.prototype)}}else{try{throw Error()}catch(Ut){Ft=Ut}(Kt=a())&&typeof Kt.catch=="function"&&Kt.catch(function(){})}}catch(Ut){if(Ut&&Ft&&typeof Ut.stack=="string")return[Ut.stack,Ft.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=m.DetermineComponentFrameRoot(),B=A[0],W=A[1];if(B&&W){var ht=B.split(`
`),Mt=W.split(`
`);for(x=m=0;m<ht.length&&!ht[m].includes("DetermineComponentFrameRoot");)m++;for(;x<Mt.length&&!Mt[x].includes("DetermineComponentFrameRoot");)x++;if(m===ht.length||x===Mt.length)for(m=ht.length-1,x=Mt.length-1;1<=m&&0<=x&&ht[m]!==Mt[x];)x--;for(;1<=m&&0<=x;m--,x--)if(ht[m]!==Mt[x]){if(m!==1||x!==1)do if(m--,x--,0>x||ht[m]!==Mt[x]){var $t=`
`+ht[m].replace(" at new "," at ");return a.displayName&&$t.includes("<anonymous>")&&($t=$t.replace("<anonymous>",a.displayName)),$t}while(1<=m&&0<=x);break}}}finally{Di=!1,Error.prepareStackTrace=f}return(f=a?a.displayName||a.name:"")?oi(f):""}function Oi(a){switch(a.tag){case 26:case 27:case 5:return oi(a.type);case 16:return oi("Lazy");case 13:return oi("Suspense");case 19:return oi("SuspenseList");case 0:case 15:return la(a.type,!1);case 11:return la(a.type.render,!1);case 1:return la(a.type,!0);case 31:return oi("Activity");default:return""}}function Cf(a){try{var c="";do c+=Oi(a),a=a.return;while(a);return c}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}function li(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Df(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function f0(a){var c=Df(a)?"checked":"value",f=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),m=""+a[c];if(!a.hasOwnProperty(c)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,A=f.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return x.call(this)},set:function(B){m=""+B,A.call(this,B)}}),Object.defineProperty(a,c,{enumerable:f.enumerable}),{getValue:function(){return m},setValue:function(B){m=""+B},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function zl(a){a._valueTracker||(a._valueTracker=f0(a))}function Of(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var f=c.getValue(),m="";return a&&(m=Df(a)?a.checked?"true":"false":a.value),a=m,a!==f?(c.setValue(a),!0):!1}function ci(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var ui=/[\n"\\]/g;function nr(a){return a.replace(ui,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function jr(a,c,f,m,x,A,B,W){a.name="",B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?a.type=B:a.removeAttribute("type"),c!=null?B==="number"?(c===0&&a.value===""||a.value!=c)&&(a.value=""+li(c)):a.value!==""+li(c)&&(a.value=""+li(c)):B!=="submit"&&B!=="reset"||a.removeAttribute("value"),c!=null?Hl(a,B,li(c)):f!=null?Hl(a,B,li(f)):m!=null&&a.removeAttribute("value"),x==null&&A!=null&&(a.defaultChecked=!!A),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?a.name=""+li(W):a.removeAttribute("name")}function Wc(a,c,f,m,x,A,B,W){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(a.type=A),c!=null||f!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;f=f!=null?""+li(f):"",c=c!=null?""+li(c):f,W||c===a.value||(a.value=c),a.defaultValue=c}m=m??x,m=typeof m!="function"&&typeof m!="symbol"&&!!m,a.checked=W?a.checked:!!m,a.defaultChecked=!!m,B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(a.name=B)}function Hl(a,c,f){c==="number"&&ci(a.ownerDocument)===a||a.defaultValue===""+f||(a.defaultValue=""+f)}function Or(a,c,f,m){if(a=a.options,c){c={};for(var x=0;x<f.length;x++)c["$"+f[x]]=!0;for(f=0;f<a.length;f++)x=c.hasOwnProperty("$"+a[f].value),a[f].selected!==x&&(a[f].selected=x),x&&m&&(a[f].defaultSelected=!0)}else{for(f=""+li(f),c=null,x=0;x<a.length;x++){if(a[x].value===f){a[x].selected=!0,m&&(a[x].defaultSelected=!0);return}c!==null||a[x].disabled||(c=a[x])}c!==null&&(c.selected=!0)}}function ca(a,c,f){if(c!=null&&(c=""+li(c),c!==a.value&&(a.value=c),f==null)){a.defaultValue!==c&&(a.defaultValue=c);return}a.defaultValue=f!=null?""+li(f):""}function jl(a,c,f,m){if(c==null){if(m!=null){if(f!=null)throw Error(r(92));if(st(m)){if(1<m.length)throw Error(r(93));m=m[0]}f=m}f==null&&(f=""),c=f}f=li(c),a.defaultValue=f,m=a.textContent,m===f&&m!==""&&m!==null&&(a.value=m)}function Vi(a,c){if(c){var f=a.firstChild;if(f&&f===a.lastChild&&f.nodeType===3){f.nodeValue=c;return}}a.textContent=c}var Rf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nf(a,c,f){var m=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?m?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="":m?a.setProperty(c,f):typeof f!="number"||f===0||Rf.has(c)?c==="float"?a.cssFloat=f:a[c]=(""+f).trim():a[c]=f+"px"}function Va(a,c,f){if(c!=null&&typeof c!="object")throw Error(r(62));if(a=a.style,f!=null){for(var m in f)!f.hasOwnProperty(m)||c!=null&&c.hasOwnProperty(m)||(m.indexOf("--")===0?a.setProperty(m,""):m==="float"?a.cssFloat="":a[m]="");for(var x in c)m=c[x],c.hasOwnProperty(x)&&f[x]!==m&&Nf(a,x,m)}else for(var A in c)c.hasOwnProperty(A)&&Nf(a,A,c[A])}function $l(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var h0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xc(a){return Hs.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var gs=null;function Bo(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Wa=null,ms=null;function Yc(a){var c=at(a);if(c&&(a=c.stateNode)){var f=a[er]||null;t:switch(a=c.stateNode,c.type){case"input":if(jr(a,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=a;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+nr(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var m=f[c];if(m!==a&&m.form===a.form){var x=m[er]||null;if(!x)throw Error(r(90));jr(m,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(c=0;c<f.length;c++)m=f[c],m.form===a.form&&Of(m)}break t;case"textarea":ca(a,f.value,f.defaultValue);break t;case"select":c=f.value,c!=null&&Or(a,!!f.multiple,c,!1)}}}var Xa=!1;function kf(a,c,f){if(Xa)return a(c,f);Xa=!0;try{var m=a(c);return m}finally{if(Xa=!1,(Wa!==null||ms!==null)&&(xp(),Wa&&(c=Wa,a=ms,ms=Wa=null,Yc(c),a)))for(c=0;c<a.length;c++)Yc(a[c])}}function Uo(a,c){var f=a.stateNode;if(f===null)return null;var m=f[er]||null;if(m===null)return null;f=m[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(a=a.type,m=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!m;break t;default:a=!1}if(a)return null;if(f&&typeof f!="function")throw Error(r(231,c,typeof f));return f}var vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ua=!1;if(vs)try{var Gl={};Object.defineProperty(Gl,"passive",{get:function(){ua=!0}}),window.addEventListener("test",Gl,Gl),window.removeEventListener("test",Gl,Gl)}catch{ua=!1}var js=null,Vl=null,Ya=null;function qc(){if(Ya)return Ya;var a,c=Vl,f=c.length,m,x="value"in js?js.value:js.textContent,A=x.length;for(a=0;a<f&&c[a]===x[a];a++);var B=f-a;for(m=1;m<=B&&c[f-m]===x[A-m];m++);return Ya=x.slice(a,1<m?1-m:void 0)}function Kc(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function qa(){return!0}function d0(){return!1}function Rr(a){function c(f,m,x,A,B){this._reactName=f,this._targetInst=x,this.type=m,this.nativeEvent=A,this.target=B,this.currentTarget=null;for(var W in a)a.hasOwnProperty(W)&&(f=a[W],this[W]=f?f(A):A[W]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?qa:d0,this.isPropagationStopped=d0,this}return d(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=qa)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=qa)},persist:function(){},isPersistent:qa}),c}var $s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zo=Rr($s),Ka=d({},$s,{view:0,detail:0}),p0=Rr(Ka),Za,Wl,Ho,Xl=d({},Ka,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mf,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ho&&(Ho&&a.type==="mousemove"?(Za=a.screenX-Ho.screenX,Wl=a.screenY-Ho.screenY):Wl=Za=0,Ho=a),Za)},movementY:function(a){return"movementY"in a?a.movementY:Wl}}),Qa=Rr(Xl),e1=d({},Xl,{dataTransfer:0}),g0=Rr(e1),m0=d({},Ka,{relatedTarget:0}),Zc=Rr(m0),v0=d({},$s,{animationName:0,elapsedTime:0,pseudoElement:0}),_0=Rr(v0),Lf=d({},$s,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),y0=Rr(Lf),n1=d({},$s,{data:0}),b0=Rr(n1),x0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r1(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=Qc[a])?!!c[a]:!1}function Mf(){return r1}var If=d({},Ka,{key:function(a){if(a.key){var c=x0[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=Kc(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?E0[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mf,charCode:function(a){return a.type==="keypress"?Kc(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Kc(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),w0=Rr(If),A0=d({},Xl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fa=Rr(A0),Pf=d({},Ka,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mf}),i1=Rr(Pf),S0=d({},$s,{propertyName:0,elapsedTime:0,pseudoElement:0}),s1=Rr(S0),a1=d({},Xl,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),o1=Rr(a1),l1=d({},$s,{newState:0,oldState:0}),T0=Rr(l1),C0=[9,13,27,32],Ff=vs&&"CompositionEvent"in window,_s=null;vs&&"documentMode"in document&&(_s=document.documentMode);var Ja=vs&&"TextEvent"in window&&!_s,D0=vs&&(!Ff||_s&&8<_s&&11>=_s),Yl=" ",O0=!1;function R0(a,c){switch(a){case"keyup":return C0.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function N0(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var jo=!1;function c1(a,c){switch(a){case"compositionend":return N0(c);case"keypress":return c.which!==32?null:(O0=!0,Yl);case"textInput":return a=c.data,a===Yl&&O0?null:a;default:return null}}function u1(a,c){if(jo)return a==="compositionend"||!Ff&&R0(a,c)?(a=qc(),Ya=Vl=js=null,jo=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return D0&&c.locale!=="ko"?null:c.data;default:return null}}var f1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function k0(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!f1[a.type]:c==="textarea"}function Ri(a,c,f,m){Wa?ms?ms.push(m):ms=[m]:Wa=m,c=Cp(c,"onChange"),0<c.length&&(f=new zo("onChange","change",null,f,m),a.push({event:f,listeners:c}))}var $o=null,Go=null;function L0(a){RE(a,0)}function Jc(a){var c=kt(a);if(Of(c))return a}function M0(a,c){if(a==="change")return c}var Bf=!1;if(vs){var Vo;if(vs){var Uf="oninput"in document;if(!Uf){var I0=document.createElement("div");I0.setAttribute("oninput","return;"),Uf=typeof I0.oninput=="function"}Vo=Uf}else Vo=!1;Bf=Vo&&(!document.documentMode||9<document.documentMode)}function zf(){$o&&($o.detachEvent("onpropertychange",P0),Go=$o=null)}function P0(a){if(a.propertyName==="value"&&Jc(Go)){var c=[];Ri(c,Go,a,Bo(a)),kf(L0,c)}}function h1(a,c,f){a==="focusin"?(zf(),$o=c,Go=f,$o.attachEvent("onpropertychange",P0)):a==="focusout"&&zf()}function F0(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Jc(Go)}function B0(a,c){if(a==="click")return Jc(c)}function U0(a,c){if(a==="input"||a==="change")return Jc(c)}function tu(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var $r=typeof Object.is=="function"?Object.is:tu;function to(a,c){if($r(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var f=Object.keys(a),m=Object.keys(c);if(f.length!==m.length)return!1;for(m=0;m<f.length;m++){var x=f[m];if(!Dt.call(c,x)||!$r(a[x],c[x]))return!1}return!0}function fi(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function z0(a,c){var f=fi(a);a=0;for(var m;f;){if(f.nodeType===3){if(m=a+f.textContent.length,a<=c&&m>=c)return{node:f,offset:c-a};a=m}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=fi(f)}}function H0(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?H0(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function Hf(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var c=ci(a.document);c instanceof a.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)a=c.contentWindow;else break;c=ci(a.document)}return c}function eu(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}var d1=vs&&"documentMode"in document&&11>=document.documentMode,Wo=null,jf=null,ql=null,$f=!1;function j0(a,c,f){var m=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;$f||Wo==null||Wo!==ci(m)||(m=Wo,"selectionStart"in m&&eu(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),ql&&to(ql,m)||(ql=m,m=Cp(jf,"onSelect"),0<m.length&&(c=new zo("onSelect","select",null,c,f),a.push({event:c,listeners:m}),c.target=Wo)))}function ha(a,c){var f={};return f[a.toLowerCase()]=c.toLowerCase(),f["Webkit"+a]="webkit"+c,f["Moz"+a]="moz"+c,f}var eo={animationend:ha("Animation","AnimationEnd"),animationiteration:ha("Animation","AnimationIteration"),animationstart:ha("Animation","AnimationStart"),transitionrun:ha("Transition","TransitionRun"),transitionstart:ha("Transition","TransitionStart"),transitioncancel:ha("Transition","TransitionCancel"),transitionend:ha("Transition","TransitionEnd")},Kl={},$0={};vs&&($0=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function no(a){if(Kl[a])return Kl[a];if(!eo[a])return a;var c=eo[a],f;for(f in c)if(c.hasOwnProperty(f)&&f in $0)return Kl[a]=c[f];return a}var da=no("animationend"),ys=no("animationiteration"),Gf=no("animationstart"),p1=no("transitionrun"),G0=no("transitionstart"),V0=no("transitioncancel"),Vf=no("transitionend"),Wf=new Map,Xf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xf.push("scrollEnd");function Wi(a,c){Wf.set(a,c),Vt(c,[a])}var W0=new WeakMap;function hi(a,c){if(typeof a=="object"&&a!==null){var f=W0.get(a);return f!==void 0?f:(c={value:a,source:c,stack:Cf(c)},W0.set(a,c),c)}return{value:a,source:c,stack:Cf(c)}}var di=[],Xo=0,Yf=0;function nu(){for(var a=Xo,c=Yf=Xo=0;c<a;){var f=di[c];di[c++]=null;var m=di[c];di[c++]=null;var x=di[c];di[c++]=null;var A=di[c];if(di[c++]=null,m!==null&&x!==null){var B=m.pending;B===null?x.next=x:(x.next=B.next,B.next=x),m.pending=x}A!==0&&Kf(f,x,A)}}function ru(a,c,f,m){di[Xo++]=a,di[Xo++]=c,di[Xo++]=f,di[Xo++]=m,Yf|=m,a.lanes|=m,a=a.alternate,a!==null&&(a.lanes|=m)}function qf(a,c,f,m){return ru(a,c,f,m),iu(a)}function Gr(a,c){return ru(a,null,null,c),iu(a)}function Kf(a,c,f){a.lanes|=f;var m=a.alternate;m!==null&&(m.lanes|=f);for(var x=!1,A=a.return;A!==null;)A.childLanes|=f,m=A.alternate,m!==null&&(m.childLanes|=f),A.tag===22&&(a=A.stateNode,a===null||a._visibility&1||(x=!0)),a=A,A=A.return;return a.tag===3?(A=a.stateNode,x&&c!==null&&(x=31-ze(f),a=A.hiddenUpdates,m=a[x],m===null?a[x]=[c]:m.push(c),c.lane=f|536870912),A):null}function iu(a){if(50<Nh)throw Nh=0,X1=null,Error(r(185));for(var c=a.return;c!==null;)a=c,c=a.return;return a.tag===3?a.stateNode:null}var Yo={};function g1(a,c,f,m){this.tag=a,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pi(a,c,f,m){return new g1(a,c,f,m)}function Zf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Gs(a,c){var f=a.alternate;return f===null?(f=pi(a.tag,c,a.key,a.mode),f.elementType=a.elementType,f.type=a.type,f.stateNode=a.stateNode,f.alternate=a,a.alternate=f):(f.pendingProps=c,f.type=a.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=a.flags&65011712,f.childLanes=a.childLanes,f.lanes=a.lanes,f.child=a.child,f.memoizedProps=a.memoizedProps,f.memoizedState=a.memoizedState,f.updateQueue=a.updateQueue,c=a.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=a.sibling,f.index=a.index,f.ref=a.ref,f.refCleanup=a.refCleanup,f}function X0(a,c){a.flags&=65011714;var f=a.alternate;return f===null?(a.childLanes=0,a.lanes=c,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=f.childLanes,a.lanes=f.lanes,a.child=f.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=f.memoizedProps,a.memoizedState=f.memoizedState,a.updateQueue=f.updateQueue,a.type=f.type,c=f.dependencies,a.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),a}function su(a,c,f,m,x,A){var B=0;if(m=a,typeof a=="function")Zf(a)&&(B=1);else if(typeof a=="string")B=oN(a,f,gt.current)?26:a==="html"||a==="head"||a==="body"?27:5;else t:switch(a){case M:return a=pi(31,f,c,x),a.elementType=M,a.lanes=A,a;case y:return Vs(f.children,x,A,c);case _:B=8,x|=24;break;case b:return a=pi(12,f,c,x|2),a.elementType=b,a.lanes=A,a;case R:return a=pi(13,f,c,x),a.elementType=R,a.lanes=A,a;case N:return a=pi(19,f,c,x),a.elementType=N,a.lanes=A,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:case T:B=10;break t;case S:B=9;break t;case O:B=11;break t;case C:B=14;break t;case I:B=16,m=null;break t}B=29,f=Error(r(130,a===null?"null":typeof a,"")),m=null}return c=pi(B,f,c,x),c.elementType=a,c.type=m,c.lanes=A,c}function Vs(a,c,f,m){return a=pi(7,a,m,c),a.lanes=f,a}function qo(a,c,f){return a=pi(6,a,null,c),a.lanes=f,a}function Qf(a,c,f){return c=pi(4,a.children!==null?a.children:[],a.key,c),c.lanes=f,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}var ro=[],io=0,pa=null,Ko=0,Vr=[],Ni=0,so=null,Ws=1,Nr="";function ao(a,c){ro[io++]=Ko,ro[io++]=pa,pa=a,Ko=c}function Y0(a,c,f){Vr[Ni++]=Ws,Vr[Ni++]=Nr,Vr[Ni++]=so,so=a;var m=Ws;a=Nr;var x=32-ze(m)-1;m&=~(1<<x),f+=1;var A=32-ze(c)+x;if(30<A){var B=x-x%5;A=(m&(1<<B)-1).toString(32),m>>=B,x-=B,Ws=1<<32-ze(c)+x|f<<x|m,Nr=A+a}else Ws=1<<A|f<<x|m,Nr=a}function Jf(a){a.return!==null&&(ao(a,1),Y0(a,1,0))}function th(a){for(;a===pa;)pa=ro[--io],ro[io]=null,Ko=ro[--io],ro[io]=null;for(;a===so;)so=Vr[--Ni],Vr[Ni]=null,Nr=Vr[--Ni],Vr[Ni]=null,Ws=Vr[--Ni],Vr[Ni]=null}var rr=null,Dn=null,sn=!1,ga=null,bs=!1,ma=Error(r(519));function Xs(a){var c=Error(r(418,""));throw Xi(hi(c,a)),ma}function eh(a){var c=a.stateNode,f=a.type,m=a.memoizedProps;switch(c[tr]=a,c[er]=m,f){case"dialog":Xe("cancel",c),Xe("close",c);break;case"iframe":case"object":case"embed":Xe("load",c);break;case"video":case"audio":for(f=0;f<Lh.length;f++)Xe(Lh[f],c);break;case"source":Xe("error",c);break;case"img":case"image":case"link":Xe("error",c),Xe("load",c);break;case"details":Xe("toggle",c);break;case"input":Xe("invalid",c),Wc(c,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),zl(c);break;case"select":Xe("invalid",c);break;case"textarea":Xe("invalid",c),jl(c,m.value,m.defaultValue,m.children),zl(c)}f=m.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||m.suppressHydrationWarning===!0||ME(c.textContent,f)?(m.popover!=null&&(Xe("beforetoggle",c),Xe("toggle",c)),m.onScroll!=null&&Xe("scroll",c),m.onScrollEnd!=null&&Xe("scrollend",c),m.onClick!=null&&(c.onclick=Dp),c=!0):c=!1,c||Xs(a)}function q0(a){for(rr=a.return;rr;)switch(rr.tag){case 5:case 13:bs=!1;return;case 27:case 3:bs=!0;return;default:rr=rr.return}}function Zl(a){if(a!==rr)return!1;if(!sn)return q0(a),sn=!0,!1;var c=a.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=a.type,f=!(f!=="form"&&f!=="button")||cv(a.type,a.memoizedProps)),f=!f),f&&Dn&&Xs(a),q0(a),c===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));t:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8)if(f=a.data,f==="/$"){if(c===0){Dn=Zs(a.nextSibling);break t}c--}else f!=="$"&&f!=="$!"&&f!=="$?"||c++;a=a.nextSibling}Dn=null}}else c===27?(c=Dn,fl(a.type)?(a=dv,dv=null,Dn=a):Dn=c):Dn=rr?Zs(a.stateNode.nextSibling):null;return!0}function Ql(){Dn=rr=null,sn=!1}function Zo(){var a=ga;return a!==null&&(Fi===null?Fi=a:Fi.push.apply(Fi,a),ga=null),a}function Xi(a){ga===null?ga=[a]:ga.push(a)}var nh=J(null),oo=null,Ys=null;function va(a,c,f){ct(nh,c._currentValue),c._currentValue=f}function qs(a){a._currentValue=nh.current,V(nh)}function rh(a,c,f){for(;a!==null;){var m=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),a===f)break;a=a.return}}function ih(a,c,f,m){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var A=x.dependencies;if(A!==null){var B=x.child;A=A.firstContext;t:for(;A!==null;){var W=A;A=x;for(var ht=0;ht<c.length;ht++)if(W.context===c[ht]){A.lanes|=f,W=A.alternate,W!==null&&(W.lanes|=f),rh(A.return,f,a),m||(B=null);break t}A=W.next}}else if(x.tag===18){if(B=x.return,B===null)throw Error(r(341));B.lanes|=f,A=B.alternate,A!==null&&(A.lanes|=f),rh(B,f,a),B=null}else B=x.child;if(B!==null)B.return=x;else for(B=x;B!==null;){if(B===a){B=null;break}if(x=B.sibling,x!==null){x.return=B.return,B=x;break}B=B.return}x=B}}function Jl(a,c,f,m){a=null;for(var x=c,A=!1;x!==null;){if(!A){if((x.flags&524288)!==0)A=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var B=x.alternate;if(B===null)throw Error(r(387));if(B=B.memoizedProps,B!==null){var W=x.type;$r(x.pendingProps.value,B.value)||(a!==null?a.push(W):a=[W])}}else if(x===Gt.current){if(B=x.alternate,B===null)throw Error(r(387));B.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(Uh):a=[Uh])}x=x.return}a!==null&&ih(c,a,f,m),c.flags|=262144}function tc(a){for(a=a.firstContext;a!==null;){if(!$r(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function lo(a){oo=a,Ys=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function hr(a){return sh(oo,a)}function Qo(a,c){return oo===null&&lo(a),sh(a,c)}function sh(a,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},Ys===null){if(a===null)throw Error(r(308));Ys=c,a.dependencies={lanes:0,firstContext:c},a.flags|=524288}else Ys=Ys.next=c;return f}var co=typeof AbortController<"u"?AbortController:function(){var a=[],c=this.signal={aborted:!1,addEventListener:function(f,m){a.push(m)}};this.abort=function(){c.aborted=!0,a.forEach(function(f){return f()})}},K0=n.unstable_scheduleCallback,ah=n.unstable_NormalPriority,$n={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ec(){return{controller:new co,data:new Map,refCount:0}}function Jo(a){a.refCount--,a.refCount===0&&K0(ah,function(){a.controller.abort()})}var uo=null,oh=0,ki=0,gi=null;function m1(a,c){if(uo===null){var f=uo=[];oh=0,ki=tv(),gi={status:"pending",value:void 0,then:function(m){f.push(m)}}}return oh++,c.then(Z0,Z0),c}function Z0(){if(--oh===0&&uo!==null){gi!==null&&(gi.status="fulfilled");var a=uo;uo=null,ki=0,gi=null;for(var c=0;c<a.length;c++)(0,a[c])()}}function v1(a,c){var f=[],m={status:"pending",value:null,reason:null,then:function(x){f.push(x)}};return a.then(function(){m.status="fulfilled",m.value=c;for(var x=0;x<f.length;x++)(0,f[x])(c)},function(x){for(m.status="rejected",m.reason=x,x=0;x<f.length;x++)(0,f[x])(void 0)}),m}var Q0=Q.S;Q.S=function(a,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&m1(a,c),Q0!==null&&Q0(a,c)};var fo=J(null);function lh(){var a=fo.current;return a!==null?a:On.pooledCache}function au(a,c){c===null?ct(fo,fo.current):ct(fo,c.pool)}function J0(){var a=lh();return a===null?null:{parent:$n._currentValue,pool:a}}var tl=Error(r(460)),nc=Error(r(474)),ho=Error(r(542)),ch={then:function(){}};function tp(a){return a=a.status,a==="fulfilled"||a==="rejected"}function _a(){}function U(a,c,f){switch(f=a[f],f===void 0?a.push(c):f!==c&&(c.then(_a,_a),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,K(a),a;default:if(typeof c.status=="string")c.then(_a,_a);else{if(a=On,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=c,a.status="pending",a.then(function(m){if(c.status==="pending"){var x=c;x.status="fulfilled",x.value=m}},function(m){if(c.status==="pending"){var x=c;x.status="rejected",x.reason=m}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,K(a),a}throw w=c,tl}}var w=null;function k(){if(w===null)throw Error(r(459));var a=w;return w=null,a}function K(a){if(a===tl||a===ho)throw Error(r(483))}var vt=!1;function wt(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jt(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Wt(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function ne(a,c,f){var m=a.updateQueue;if(m===null)return null;if(m=m.shared,(pn&2)!==0){var x=m.pending;return x===null?c.next=c:(c.next=x.next,x.next=c),m.pending=c,c=iu(a),Kf(a,null,f),c}return ru(a,m,c,f),iu(a)}function ue(a,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var m=c.lanes;m&=a.pendingLanes,f|=m,c.lanes=f,Gc(a,f)}}function fe(a,c){var f=a.updateQueue,m=a.alternate;if(m!==null&&(m=m.updateQueue,f===m)){var x=null,A=null;if(f=f.firstBaseUpdate,f!==null){do{var B={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};A===null?x=A=B:A=A.next=B,f=f.next}while(f!==null);A===null?x=A=c:A=A.next=c}else x=A=c;f={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:A,shared:m.shared,callbacks:m.callbacks},a.updateQueue=f;return}a=f.lastBaseUpdate,a===null?f.firstBaseUpdate=c:a.next=c,f.lastBaseUpdate=c}var le=!1;function Ie(){if(le){var a=gi;if(a!==null)throw a}}function xe(a,c,f,m){le=!1;var x=a.updateQueue;vt=!1;var A=x.firstBaseUpdate,B=x.lastBaseUpdate,W=x.shared.pending;if(W!==null){x.shared.pending=null;var ht=W,Mt=ht.next;ht.next=null,B===null?A=Mt:B.next=Mt,B=ht;var $t=a.alternate;$t!==null&&($t=$t.updateQueue,W=$t.lastBaseUpdate,W!==B&&(W===null?$t.firstBaseUpdate=Mt:W.next=Mt,$t.lastBaseUpdate=ht))}if(A!==null){var Kt=x.baseState;B=0,$t=Mt=ht=null,W=A;do{var Ft=W.lane&-536870913,Ut=Ft!==W.lane;if(Ut?(tn&Ft)===Ft:(m&Ft)===Ft){Ft!==0&&Ft===ki&&(le=!0),$t!==null&&($t=$t.next={lane:0,tag:W.tag,payload:W.payload,callback:null,next:null});t:{var Me=a,Ce=W;Ft=c;var xn=f;switch(Ce.tag){case 1:if(Me=Ce.payload,typeof Me=="function"){Kt=Me.call(xn,Kt,Ft);break t}Kt=Me;break t;case 3:Me.flags=Me.flags&-65537|128;case 0:if(Me=Ce.payload,Ft=typeof Me=="function"?Me.call(xn,Kt,Ft):Me,Ft==null)break t;Kt=d({},Kt,Ft);break t;case 2:vt=!0}}Ft=W.callback,Ft!==null&&(a.flags|=64,Ut&&(a.flags|=8192),Ut=x.callbacks,Ut===null?x.callbacks=[Ft]:Ut.push(Ft))}else Ut={lane:Ft,tag:W.tag,payload:W.payload,callback:W.callback,next:null},$t===null?(Mt=$t=Ut,ht=Kt):$t=$t.next=Ut,B|=Ft;if(W=W.next,W===null){if(W=x.shared.pending,W===null)break;Ut=W,W=Ut.next,Ut.next=null,x.lastBaseUpdate=Ut,x.shared.pending=null}}while(!0);$t===null&&(ht=Kt),x.baseState=ht,x.firstBaseUpdate=Mt,x.lastBaseUpdate=$t,A===null&&(x.shared.lanes=0),ol|=B,a.lanes=B,a.memoizedState=Kt}}function Pe(a,c){if(typeof a!="function")throw Error(r(191,a));a.call(c)}function Re(a,c){var f=a.callbacks;if(f!==null)for(a.callbacks=null,a=0;a<f.length;a++)Pe(f[a],c)}var Te=J(null),an=J(0);function hn(a,c){a=bo,ct(an,a),ct(Te,c),bo=a|c.baseLanes}function He(){ct(an,bo),ct(Te,Te.current)}function Qe(){bo=an.current,V(Te),V(an)}var Ne=0,ce=null,ve=null,ke=null,Je=!1,yn=!1,Vn=!1,Wr=0,Wn=0,dr=null,Li=0;function Be(){throw Error(r(321))}function Mi(a,c){if(c===null)return!1;for(var f=0;f<c.length&&f<a.length;f++)if(!$r(a[f],c[f]))return!1;return!0}function Ii(a,c,f,m,x,A){return Ne=A,ce=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Q.H=a===null||a.memoizedState===null?px:gx,Vn=!1,A=f(m,x),Vn=!1,yn&&(A=Xn(c,f,m,x)),po(a),A}function po(a){Q.H=lp;var c=ve!==null&&ve.next!==null;if(Ne=0,ke=ve=ce=null,Je=!1,Wn=0,dr=null,c)throw Error(r(300));a===null||xr||(a=a.dependencies,a!==null&&tc(a)&&(xr=!0))}function Xn(a,c,f,m){ce=a;var x=0;do{if(yn&&(dr=null),Wn=0,yn=!1,25<=x)throw Error(r(301));if(x+=1,ke=ve=null,a.updateQueue!=null){var A=a.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}Q.H=_R,A=c(f,m)}while(yn);return A}function dn(){var a=Q.H,c=a.useState()[0];return c=typeof c.then=="function"?ya(c):c,a=a.useState()[0],(ve!==null?ve.memoizedState:null)!==a&&(ce.flags|=1024),c}function pr(){var a=Wr!==0;return Wr=0,a}function Xr(a,c,f){c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~f}function xs(a){if(Je){for(a=a.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Je=!1}Ne=0,ke=ve=ce=null,yn=!1,Wn=Wr=0,dr=null}function gr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ke===null?ce.memoizedState=ke=a:ke=ke.next=a,ke}function Un(){if(ve===null){var a=ce.alternate;a=a!==null?a.memoizedState:null}else a=ve.next;var c=ke===null?ce.memoizedState:ke.next;if(c!==null)ke=c,ve=a;else{if(a===null)throw ce.alternate===null?Error(r(467)):Error(r(310));ve=a,a={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},ke===null?ce.memoizedState=ke=a:ke=ke.next=a}return ke}function ou(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ya(a){var c=Wn;return Wn+=1,dr===null&&(dr=[]),a=U(dr,a,c),c=ce,(ke===null?c.memoizedState:ke.next)===null&&(c=c.alternate,Q.H=c===null||c.memoizedState===null?px:gx),a}function lu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return ya(a);if(a.$$typeof===T)return hr(a)}throw Error(r(438,String(a)))}function uh(a){var c=null,f=ce.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var m=ce.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(c={data:m.data.map(function(x){return x.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=ou(),ce.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(a),m=0;m<a;m++)f[m]=F;return c.index++,f}function Yi(a,c){return typeof c=="function"?c(a):c}function cu(a){var c=Un();return uu(c,ve,a)}function uu(a,c,f){var m=a.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=f;var x=a.baseQueue,A=m.pending;if(A!==null){if(x!==null){var B=x.next;x.next=A.next,A.next=B}c.baseQueue=x=A,m.pending=null}if(A=a.baseState,x===null)a.memoizedState=A;else{c=x.next;var W=B=null,ht=null,Mt=c,$t=!1;do{var Kt=Mt.lane&-536870913;if(Kt!==Mt.lane?(tn&Kt)===Kt:(Ne&Kt)===Kt){var Ft=Mt.revertLane;if(Ft===0)ht!==null&&(ht=ht.next={lane:0,revertLane:0,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null}),Kt===ki&&($t=!0);else if((Ne&Ft)===Ft){Mt=Mt.next,Ft===ki&&($t=!0);continue}else Kt={lane:0,revertLane:Mt.revertLane,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null},ht===null?(W=ht=Kt,B=A):ht=ht.next=Kt,ce.lanes|=Ft,ol|=Ft;Kt=Mt.action,Vn&&f(A,Kt),A=Mt.hasEagerState?Mt.eagerState:f(A,Kt)}else Ft={lane:Kt,revertLane:Mt.revertLane,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null},ht===null?(W=ht=Ft,B=A):ht=ht.next=Ft,ce.lanes|=Kt,ol|=Kt;Mt=Mt.next}while(Mt!==null&&Mt!==c);if(ht===null?B=A:ht.next=W,!$r(A,a.memoizedState)&&(xr=!0,$t&&(f=gi,f!==null)))throw f;a.memoizedState=A,a.baseState=B,a.baseQueue=ht,m.lastRenderedState=A}return x===null&&(m.lanes=0),[a.memoizedState,m.dispatch]}function fh(a){var c=Un(),f=c.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=a;var m=f.dispatch,x=f.pending,A=c.memoizedState;if(x!==null){f.pending=null;var B=x=x.next;do A=a(A,B.action),B=B.next;while(B!==x);$r(A,c.memoizedState)||(xr=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),f.lastRenderedState=A}return[A,m]}function hh(a,c,f){var m=ce,x=Un(),A=sn;if(A){if(f===void 0)throw Error(r(407));f=f()}else f=c();var B=!$r((ve||x).memoizedState,f);B&&(x.memoizedState=f,xr=!0),x=x.queue;var W=np.bind(null,m,x,a);if(bh(2048,8,W,[a]),x.getSnapshot!==c||B||ke!==null&&ke.memoizedState.tag&1){if(m.flags|=2048,pu(9,sp(),ep.bind(null,m,x,f,c),null),On===null)throw Error(r(349));A||(Ne&124)!==0||dh(m,c,f)}return f}function dh(a,c,f){a.flags|=16384,a={getSnapshot:c,value:f},c=ce.updateQueue,c===null?(c=ou(),ce.updateQueue=c,c.stores=[a]):(f=c.stores,f===null?c.stores=[a]:f.push(a))}function ep(a,c,f,m){c.value=f,c.getSnapshot=m,ba(c)&&rc(a)}function np(a,c,f){return f(function(){ba(c)&&rc(a)})}function ba(a){var c=a.getSnapshot;a=a.value;try{var f=c();return!$r(a,f)}catch{return!0}}function rc(a){var c=Gr(a,2);c!==null&&Ji(c,a,2)}function fu(a){var c=gr();if(typeof a=="function"){var f=a;if(a=f(),Vn){ae(!0);try{f()}finally{ae(!1)}}}return c.memoizedState=c.baseState=a,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:a},c}function ph(a,c,f,m){return a.baseState=f,uu(a,ve,typeof m=="function"?m:Yi)}function gh(a,c,f,m,x){if(op(a))throw Error(r(485));if(a=c.action,a!==null){var A={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(B){A.listeners.push(B)}};Q.T!==null?f(!0):A.isTransition=!1,m(A),f=c.pending,f===null?(A.next=c.pending=A,mh(c,A)):(A.next=f.next,c.pending=f.next=A)}}function mh(a,c){var f=c.action,m=c.payload,x=a.state;if(c.isTransition){var A=Q.T,B={};Q.T=B;try{var W=f(x,m),ht=Q.S;ht!==null&&ht(B,W),vh(a,c,W)}catch(Mt){hu(a,c,Mt)}finally{Q.T=A}}else try{A=f(x,m),vh(a,c,A)}catch(Mt){hu(a,c,Mt)}}function vh(a,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(m){_h(a,c,m)},function(m){return hu(a,c,m)}):_h(a,c,f)}function _h(a,c,f){c.status="fulfilled",c.value=f,rp(c),a.state=f,c=a.pending,c!==null&&(f=c.next,f===c?a.pending=null:(f=f.next,c.next=f,mh(a,f)))}function hu(a,c,f){var m=a.pending;if(a.pending=null,m!==null){m=m.next;do c.status="rejected",c.reason=f,rp(c),c=c.next;while(c!==m)}a.action=null}function rp(a){a=a.listeners;for(var c=0;c<a.length;c++)(0,a[c])()}function ip(a,c){return c}function du(a,c){if(sn){var f=On.formState;if(f!==null){t:{var m=ce;if(sn){if(Dn){e:{for(var x=Dn,A=bs;x.nodeType!==8;){if(!A){x=null;break e}if(x=Zs(x.nextSibling),x===null){x=null;break e}}A=x.data,x=A==="F!"||A==="F"?x:null}if(x){Dn=Zs(x.nextSibling),m=x.data==="F!";break t}}Xs(m)}m=!1}m&&(c=f[0])}}return f=gr(),f.memoizedState=f.baseState=c,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ip,lastRenderedState:c},f.queue=m,f=fx.bind(null,ce,m),m.dispatch=f,m=fu(!1),A=E1.bind(null,ce,!1,m.queue),m=gr(),x={state:c,dispatch:null,action:a,pending:null},m.queue=x,f=gh.bind(null,ce,x,A,f),x.dispatch=f,m.memoizedState=a,[c,f,!1]}function yh(a){var c=Un();return Yb(c,ve,a)}function Yb(a,c,f){if(c=uu(a,c,ip)[0],a=cu(Yi)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var m=ya(c)}catch(B){throw B===tl?ho:B}else m=c;c=Un();var x=c.queue,A=x.dispatch;return f!==c.memoizedState&&(ce.flags|=2048,pu(9,sp(),pR.bind(null,x,f),null)),[m,A,a]}function pR(a,c){a.action=c}function qb(a){var c=Un(),f=ve;if(f!==null)return Yb(c,f,a);Un(),c=c.memoizedState,f=Un();var m=f.queue.dispatch;return f.memoizedState=a,[c,m,!1]}function pu(a,c,f,m){return a={tag:a,create:f,deps:m,inst:c,next:null},c=ce.updateQueue,c===null&&(c=ou(),ce.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=a.next=a:(m=f.next,f.next=a,a.next=m,c.lastEffect=a),a}function sp(){return{destroy:void 0,resource:void 0}}function Kb(){return Un().memoizedState}function ap(a,c,f,m){var x=gr();m=m===void 0?null:m,ce.flags|=a,x.memoizedState=pu(1|c,sp(),f,m)}function bh(a,c,f,m){var x=Un();m=m===void 0?null:m;var A=x.memoizedState.inst;ve!==null&&m!==null&&Mi(m,ve.memoizedState.deps)?x.memoizedState=pu(c,A,f,m):(ce.flags|=a,x.memoizedState=pu(1|c,A,f,m))}function Zb(a,c){ap(8390656,8,a,c)}function Qb(a,c){bh(2048,8,a,c)}function Jb(a,c){return bh(4,2,a,c)}function tx(a,c){return bh(4,4,a,c)}function ex(a,c){if(typeof c=="function"){a=a();var f=c(a);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function nx(a,c,f){f=f!=null?f.concat([a]):null,bh(4,4,ex.bind(null,c,a),f)}function _1(){}function rx(a,c){var f=Un();c=c===void 0?null:c;var m=f.memoizedState;return c!==null&&Mi(c,m[1])?m[0]:(f.memoizedState=[a,c],a)}function ix(a,c){var f=Un();c=c===void 0?null:c;var m=f.memoizedState;if(c!==null&&Mi(c,m[1]))return m[0];if(m=a(),Vn){ae(!0);try{a()}finally{ae(!1)}}return f.memoizedState=[m,c],m}function y1(a,c,f){return f===void 0||(Ne&1073741824)!==0?a.memoizedState=c:(a.memoizedState=f,a=oE(),ce.lanes|=a,ol|=a,f)}function sx(a,c,f,m){return $r(f,c)?f:Te.current!==null?(a=y1(a,f,m),$r(a,c)||(xr=!0),a):(Ne&42)===0?(xr=!0,a.memoizedState=f):(a=oE(),ce.lanes|=a,ol|=a,c)}function ax(a,c,f,m,x){var A=Y.p;Y.p=A!==0&&8>A?A:8;var B=Q.T,W={};Q.T=W,E1(a,!1,c,f);try{var ht=x(),Mt=Q.S;if(Mt!==null&&Mt(W,ht),ht!==null&&typeof ht=="object"&&typeof ht.then=="function"){var $t=v1(ht,m);xh(a,c,$t,Qi(a))}else xh(a,c,m,Qi(a))}catch(Kt){xh(a,c,{then:function(){},status:"rejected",reason:Kt},Qi())}finally{Y.p=A,Q.T=B}}function gR(){}function b1(a,c,f,m){if(a.tag!==5)throw Error(r(476));var x=ox(a).queue;ax(a,x,c,Ot,f===null?gR:function(){return lx(a),f(m)})}function ox(a){var c=a.memoizedState;if(c!==null)return c;c={memoizedState:Ot,baseState:Ot,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:Ot},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yi,lastRenderedState:f},next:null},a.memoizedState=c,a=a.alternate,a!==null&&(a.memoizedState=c),c}function lx(a){var c=ox(a).next.queue;xh(a,c,{},Qi())}function x1(){return hr(Uh)}function cx(){return Un().memoizedState}function ux(){return Un().memoizedState}function mR(a){for(var c=a.return;c!==null;){switch(c.tag){case 24:case 3:var f=Qi();a=Wt(f);var m=ne(c,a,f);m!==null&&(Ji(m,c,f),ue(m,c,f)),c={cache:ec()},a.payload=c;return}c=c.return}}function vR(a,c,f){var m=Qi();f={lane:m,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null},op(a)?hx(c,f):(f=qf(a,c,f,m),f!==null&&(Ji(f,a,m),dx(f,c,m)))}function fx(a,c,f){var m=Qi();xh(a,c,f,m)}function xh(a,c,f,m){var x={lane:m,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null};if(op(a))hx(c,x);else{var A=a.alternate;if(a.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var B=c.lastRenderedState,W=A(B,f);if(x.hasEagerState=!0,x.eagerState=W,$r(W,B))return ru(a,c,x,0),On===null&&nu(),!1}catch{}finally{}if(f=qf(a,c,x,m),f!==null)return Ji(f,a,m),dx(f,c,m),!0}return!1}function E1(a,c,f,m){if(m={lane:2,revertLane:tv(),action:m,hasEagerState:!1,eagerState:null,next:null},op(a)){if(c)throw Error(r(479))}else c=qf(a,f,m,2),c!==null&&Ji(c,a,2)}function op(a){var c=a.alternate;return a===ce||c!==null&&c===ce}function hx(a,c){yn=Je=!0;var f=a.pending;f===null?c.next=c:(c.next=f.next,f.next=c),a.pending=c}function dx(a,c,f){if((f&4194048)!==0){var m=c.lanes;m&=a.pendingLanes,f|=m,c.lanes=f,Gc(a,f)}}var lp={readContext:hr,use:lu,useCallback:Be,useContext:Be,useEffect:Be,useImperativeHandle:Be,useLayoutEffect:Be,useInsertionEffect:Be,useMemo:Be,useReducer:Be,useRef:Be,useState:Be,useDebugValue:Be,useDeferredValue:Be,useTransition:Be,useSyncExternalStore:Be,useId:Be,useHostTransitionStatus:Be,useFormState:Be,useActionState:Be,useOptimistic:Be,useMemoCache:Be,useCacheRefresh:Be},px={readContext:hr,use:lu,useCallback:function(a,c){return gr().memoizedState=[a,c===void 0?null:c],a},useContext:hr,useEffect:Zb,useImperativeHandle:function(a,c,f){f=f!=null?f.concat([a]):null,ap(4194308,4,ex.bind(null,c,a),f)},useLayoutEffect:function(a,c){return ap(4194308,4,a,c)},useInsertionEffect:function(a,c){ap(4,2,a,c)},useMemo:function(a,c){var f=gr();c=c===void 0?null:c;var m=a();if(Vn){ae(!0);try{a()}finally{ae(!1)}}return f.memoizedState=[m,c],m},useReducer:function(a,c,f){var m=gr();if(f!==void 0){var x=f(c);if(Vn){ae(!0);try{f(c)}finally{ae(!1)}}}else x=c;return m.memoizedState=m.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},m.queue=a,a=a.dispatch=vR.bind(null,ce,a),[m.memoizedState,a]},useRef:function(a){var c=gr();return a={current:a},c.memoizedState=a},useState:function(a){a=fu(a);var c=a.queue,f=fx.bind(null,ce,c);return c.dispatch=f,[a.memoizedState,f]},useDebugValue:_1,useDeferredValue:function(a,c){var f=gr();return y1(f,a,c)},useTransition:function(){var a=fu(!1);return a=ax.bind(null,ce,a.queue,!0,!1),gr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,c,f){var m=ce,x=gr();if(sn){if(f===void 0)throw Error(r(407));f=f()}else{if(f=c(),On===null)throw Error(r(349));(tn&124)!==0||dh(m,c,f)}x.memoizedState=f;var A={value:f,getSnapshot:c};return x.queue=A,Zb(np.bind(null,m,A,a),[a]),m.flags|=2048,pu(9,sp(),ep.bind(null,m,A,f,c),null),f},useId:function(){var a=gr(),c=On.identifierPrefix;if(sn){var f=Nr,m=Ws;f=(m&~(1<<32-ze(m)-1)).toString(32)+f,c=""+c+"R"+f,f=Wr++,0<f&&(c+="H"+f.toString(32)),c+=""}else f=Li++,c=""+c+"r"+f.toString(32)+"";return a.memoizedState=c},useHostTransitionStatus:x1,useFormState:du,useActionState:du,useOptimistic:function(a){var c=gr();c.memoizedState=c.baseState=a;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=E1.bind(null,ce,!0,f),f.dispatch=c,[a,c]},useMemoCache:uh,useCacheRefresh:function(){return gr().memoizedState=mR.bind(null,ce)}},gx={readContext:hr,use:lu,useCallback:rx,useContext:hr,useEffect:Qb,useImperativeHandle:nx,useInsertionEffect:Jb,useLayoutEffect:tx,useMemo:ix,useReducer:cu,useRef:Kb,useState:function(){return cu(Yi)},useDebugValue:_1,useDeferredValue:function(a,c){var f=Un();return sx(f,ve.memoizedState,a,c)},useTransition:function(){var a=cu(Yi)[0],c=Un().memoizedState;return[typeof a=="boolean"?a:ya(a),c]},useSyncExternalStore:hh,useId:cx,useHostTransitionStatus:x1,useFormState:yh,useActionState:yh,useOptimistic:function(a,c){var f=Un();return ph(f,ve,a,c)},useMemoCache:uh,useCacheRefresh:ux},_R={readContext:hr,use:lu,useCallback:rx,useContext:hr,useEffect:Qb,useImperativeHandle:nx,useInsertionEffect:Jb,useLayoutEffect:tx,useMemo:ix,useReducer:fh,useRef:Kb,useState:function(){return fh(Yi)},useDebugValue:_1,useDeferredValue:function(a,c){var f=Un();return ve===null?y1(f,a,c):sx(f,ve.memoizedState,a,c)},useTransition:function(){var a=fh(Yi)[0],c=Un().memoizedState;return[typeof a=="boolean"?a:ya(a),c]},useSyncExternalStore:hh,useId:cx,useHostTransitionStatus:x1,useFormState:qb,useActionState:qb,useOptimistic:function(a,c){var f=Un();return ve!==null?ph(f,ve,a,c):(f.baseState=a,[a,f.queue.dispatch])},useMemoCache:uh,useCacheRefresh:ux},gu=null,Eh=0;function cp(a){var c=Eh;return Eh+=1,gu===null&&(gu=[]),U(gu,a,c)}function wh(a,c){c=c.props.ref,a.ref=c!==void 0?c:null}function up(a,c){throw c.$$typeof===p?Error(r(525)):(a=Object.prototype.toString.call(c),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a)))}function mx(a){var c=a._init;return c(a._payload)}function vx(a){function c(St,mt){if(a){var Nt=St.deletions;Nt===null?(St.deletions=[mt],St.flags|=16):Nt.push(mt)}}function f(St,mt){if(!a)return null;for(;mt!==null;)c(St,mt),mt=mt.sibling;return null}function m(St){for(var mt=new Map;St!==null;)St.key!==null?mt.set(St.key,St):mt.set(St.index,St),St=St.sibling;return mt}function x(St,mt){return St=Gs(St,mt),St.index=0,St.sibling=null,St}function A(St,mt,Nt){return St.index=Nt,a?(Nt=St.alternate,Nt!==null?(Nt=Nt.index,Nt<mt?(St.flags|=67108866,mt):Nt):(St.flags|=67108866,mt)):(St.flags|=1048576,mt)}function B(St){return a&&St.alternate===null&&(St.flags|=67108866),St}function W(St,mt,Nt,Xt){return mt===null||mt.tag!==6?(mt=qo(Nt,St.mode,Xt),mt.return=St,mt):(mt=x(mt,Nt),mt.return=St,mt)}function ht(St,mt,Nt,Xt){var pe=Nt.type;return pe===y?$t(St,mt,Nt.props.children,Xt,Nt.key):mt!==null&&(mt.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===I&&mx(pe)===mt.type)?(mt=x(mt,Nt.props),wh(mt,Nt),mt.return=St,mt):(mt=su(Nt.type,Nt.key,Nt.props,null,St.mode,Xt),wh(mt,Nt),mt.return=St,mt)}function Mt(St,mt,Nt,Xt){return mt===null||mt.tag!==4||mt.stateNode.containerInfo!==Nt.containerInfo||mt.stateNode.implementation!==Nt.implementation?(mt=Qf(Nt,St.mode,Xt),mt.return=St,mt):(mt=x(mt,Nt.children||[]),mt.return=St,mt)}function $t(St,mt,Nt,Xt,pe){return mt===null||mt.tag!==7?(mt=Vs(Nt,St.mode,Xt,pe),mt.return=St,mt):(mt=x(mt,Nt),mt.return=St,mt)}function Kt(St,mt,Nt){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return mt=qo(""+mt,St.mode,Nt),mt.return=St,mt;if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case g:return Nt=su(mt.type,mt.key,mt.props,null,St.mode,Nt),wh(Nt,mt),Nt.return=St,Nt;case v:return mt=Qf(mt,St.mode,Nt),mt.return=St,mt;case I:var Xt=mt._init;return mt=Xt(mt._payload),Kt(St,mt,Nt)}if(st(mt)||P(mt))return mt=Vs(mt,St.mode,Nt,null),mt.return=St,mt;if(typeof mt.then=="function")return Kt(St,cp(mt),Nt);if(mt.$$typeof===T)return Kt(St,Qo(St,mt),Nt);up(St,mt)}return null}function Ft(St,mt,Nt,Xt){var pe=mt!==null?mt.key:null;if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return pe!==null?null:W(St,mt,""+Nt,Xt);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case g:return Nt.key===pe?ht(St,mt,Nt,Xt):null;case v:return Nt.key===pe?Mt(St,mt,Nt,Xt):null;case I:return pe=Nt._init,Nt=pe(Nt._payload),Ft(St,mt,Nt,Xt)}if(st(Nt)||P(Nt))return pe!==null?null:$t(St,mt,Nt,Xt,null);if(typeof Nt.then=="function")return Ft(St,mt,cp(Nt),Xt);if(Nt.$$typeof===T)return Ft(St,mt,Qo(St,Nt),Xt);up(St,Nt)}return null}function Ut(St,mt,Nt,Xt,pe){if(typeof Xt=="string"&&Xt!==""||typeof Xt=="number"||typeof Xt=="bigint")return St=St.get(Nt)||null,W(mt,St,""+Xt,pe);if(typeof Xt=="object"&&Xt!==null){switch(Xt.$$typeof){case g:return St=St.get(Xt.key===null?Nt:Xt.key)||null,ht(mt,St,Xt,pe);case v:return St=St.get(Xt.key===null?Nt:Xt.key)||null,Mt(mt,St,Xt,pe);case I:var Ve=Xt._init;return Xt=Ve(Xt._payload),Ut(St,mt,Nt,Xt,pe)}if(st(Xt)||P(Xt))return St=St.get(Nt)||null,$t(mt,St,Xt,pe,null);if(typeof Xt.then=="function")return Ut(St,mt,Nt,cp(Xt),pe);if(Xt.$$typeof===T)return Ut(St,mt,Nt,Qo(mt,Xt),pe);up(mt,Xt)}return null}function Me(St,mt,Nt,Xt){for(var pe=null,Ve=null,_e=mt,De=mt=0,wr=null;_e!==null&&De<Nt.length;De++){_e.index>De?(wr=_e,_e=null):wr=_e.sibling;var on=Ft(St,_e,Nt[De],Xt);if(on===null){_e===null&&(_e=wr);break}a&&_e&&on.alternate===null&&c(St,_e),mt=A(on,mt,De),Ve===null?pe=on:Ve.sibling=on,Ve=on,_e=wr}if(De===Nt.length)return f(St,_e),sn&&ao(St,De),pe;if(_e===null){for(;De<Nt.length;De++)_e=Kt(St,Nt[De],Xt),_e!==null&&(mt=A(_e,mt,De),Ve===null?pe=_e:Ve.sibling=_e,Ve=_e);return sn&&ao(St,De),pe}for(_e=m(_e);De<Nt.length;De++)wr=Ut(_e,St,De,Nt[De],Xt),wr!==null&&(a&&wr.alternate!==null&&_e.delete(wr.key===null?De:wr.key),mt=A(wr,mt,De),Ve===null?pe=wr:Ve.sibling=wr,Ve=wr);return a&&_e.forEach(function(ml){return c(St,ml)}),sn&&ao(St,De),pe}function Ce(St,mt,Nt,Xt){if(Nt==null)throw Error(r(151));for(var pe=null,Ve=null,_e=mt,De=mt=0,wr=null,on=Nt.next();_e!==null&&!on.done;De++,on=Nt.next()){_e.index>De?(wr=_e,_e=null):wr=_e.sibling;var ml=Ft(St,_e,on.value,Xt);if(ml===null){_e===null&&(_e=wr);break}a&&_e&&ml.alternate===null&&c(St,_e),mt=A(ml,mt,De),Ve===null?pe=ml:Ve.sibling=ml,Ve=ml,_e=wr}if(on.done)return f(St,_e),sn&&ao(St,De),pe;if(_e===null){for(;!on.done;De++,on=Nt.next())on=Kt(St,on.value,Xt),on!==null&&(mt=A(on,mt,De),Ve===null?pe=on:Ve.sibling=on,Ve=on);return sn&&ao(St,De),pe}for(_e=m(_e);!on.done;De++,on=Nt.next())on=Ut(_e,St,De,on.value,Xt),on!==null&&(a&&on.alternate!==null&&_e.delete(on.key===null?De:on.key),mt=A(on,mt,De),Ve===null?pe=on:Ve.sibling=on,Ve=on);return a&&_e.forEach(function(yN){return c(St,yN)}),sn&&ao(St,De),pe}function xn(St,mt,Nt,Xt){if(typeof Nt=="object"&&Nt!==null&&Nt.type===y&&Nt.key===null&&(Nt=Nt.props.children),typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case g:t:{for(var pe=Nt.key;mt!==null;){if(mt.key===pe){if(pe=Nt.type,pe===y){if(mt.tag===7){f(St,mt.sibling),Xt=x(mt,Nt.props.children),Xt.return=St,St=Xt;break t}}else if(mt.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===I&&mx(pe)===mt.type){f(St,mt.sibling),Xt=x(mt,Nt.props),wh(Xt,Nt),Xt.return=St,St=Xt;break t}f(St,mt);break}else c(St,mt);mt=mt.sibling}Nt.type===y?(Xt=Vs(Nt.props.children,St.mode,Xt,Nt.key),Xt.return=St,St=Xt):(Xt=su(Nt.type,Nt.key,Nt.props,null,St.mode,Xt),wh(Xt,Nt),Xt.return=St,St=Xt)}return B(St);case v:t:{for(pe=Nt.key;mt!==null;){if(mt.key===pe)if(mt.tag===4&&mt.stateNode.containerInfo===Nt.containerInfo&&mt.stateNode.implementation===Nt.implementation){f(St,mt.sibling),Xt=x(mt,Nt.children||[]),Xt.return=St,St=Xt;break t}else{f(St,mt);break}else c(St,mt);mt=mt.sibling}Xt=Qf(Nt,St.mode,Xt),Xt.return=St,St=Xt}return B(St);case I:return pe=Nt._init,Nt=pe(Nt._payload),xn(St,mt,Nt,Xt)}if(st(Nt))return Me(St,mt,Nt,Xt);if(P(Nt)){if(pe=P(Nt),typeof pe!="function")throw Error(r(150));return Nt=pe.call(Nt),Ce(St,mt,Nt,Xt)}if(typeof Nt.then=="function")return xn(St,mt,cp(Nt),Xt);if(Nt.$$typeof===T)return xn(St,mt,Qo(St,Nt),Xt);up(St,Nt)}return typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint"?(Nt=""+Nt,mt!==null&&mt.tag===6?(f(St,mt.sibling),Xt=x(mt,Nt),Xt.return=St,St=Xt):(f(St,mt),Xt=qo(Nt,St.mode,Xt),Xt.return=St,St=Xt),B(St)):f(St,mt)}return function(St,mt,Nt,Xt){try{Eh=0;var pe=xn(St,mt,Nt,Xt);return gu=null,pe}catch(_e){if(_e===tl||_e===ho)throw _e;var Ve=pi(29,_e,null,St.mode);return Ve.lanes=Xt,Ve.return=St,Ve}finally{}}}var mu=vx(!0),_x=vx(!1),Es=J(null),xa=null;function el(a){var c=a.alternate;ct(mr,mr.current&1),ct(Es,a),xa===null&&(c===null||Te.current!==null||c.memoizedState!==null)&&(xa=a)}function yx(a){if(a.tag===22){if(ct(mr,mr.current),ct(Es,a),xa===null){var c=a.alternate;c!==null&&c.memoizedState!==null&&(xa=a)}}else nl()}function nl(){ct(mr,mr.current),ct(Es,Es.current)}function go(a){V(Es),xa===a&&(xa=null),V(mr)}var mr=J(0);function fp(a){for(var c=a;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||hv(f)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function w1(a,c,f,m){c=a.memoizedState,f=f(m,c),f=f==null?c:d({},c,f),a.memoizedState=f,a.lanes===0&&(a.updateQueue.baseState=f)}var A1={enqueueSetState:function(a,c,f){a=a._reactInternals;var m=Qi(),x=Wt(m);x.payload=c,f!=null&&(x.callback=f),c=ne(a,x,m),c!==null&&(Ji(c,a,m),ue(c,a,m))},enqueueReplaceState:function(a,c,f){a=a._reactInternals;var m=Qi(),x=Wt(m);x.tag=1,x.payload=c,f!=null&&(x.callback=f),c=ne(a,x,m),c!==null&&(Ji(c,a,m),ue(c,a,m))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var f=Qi(),m=Wt(f);m.tag=2,c!=null&&(m.callback=c),c=ne(a,m,f),c!==null&&(Ji(c,a,f),ue(c,a,f))}};function bx(a,c,f,m,x,A,B){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(m,A,B):c.prototype&&c.prototype.isPureReactComponent?!to(f,m)||!to(x,A):!0}function xx(a,c,f,m){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,m),c.state!==a&&A1.enqueueReplaceState(c,c.state,null)}function ic(a,c){var f=c;if("ref"in c){f={};for(var m in c)m!=="ref"&&(f[m]=c[m])}if(a=a.defaultProps){f===c&&(f=d({},f));for(var x in a)f[x]===void 0&&(f[x]=a[x])}return f}var hp=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function Ex(a){hp(a)}function wx(a){console.error(a)}function Ax(a){hp(a)}function dp(a,c){try{var f=a.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(m){setTimeout(function(){throw m})}}function Sx(a,c,f){try{var m=a.onCaughtError;m(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function S1(a,c,f){return f=Wt(f),f.tag=3,f.payload={element:null},f.callback=function(){dp(a,c)},f}function Tx(a){return a=Wt(a),a.tag=3,a}function Cx(a,c,f,m){var x=f.type.getDerivedStateFromError;if(typeof x=="function"){var A=m.value;a.payload=function(){return x(A)},a.callback=function(){Sx(c,f,m)}}var B=f.stateNode;B!==null&&typeof B.componentDidCatch=="function"&&(a.callback=function(){Sx(c,f,m),typeof x!="function"&&(ll===null?ll=new Set([this]):ll.add(this));var W=m.stack;this.componentDidCatch(m.value,{componentStack:W!==null?W:""})})}function yR(a,c,f,m,x){if(f.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(c=f.alternate,c!==null&&Jl(c,f,x,!0),f=Es.current,f!==null){switch(f.tag){case 13:return xa===null?q1():f.alternate===null&&Gn===0&&(Gn=3),f.flags&=-257,f.flags|=65536,f.lanes=x,m===ch?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([m]):c.add(m),Z1(a,m,x)),!1;case 22:return f.flags|=65536,m===ch?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([m])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([m]):f.add(m)),Z1(a,m,x)),!1}throw Error(r(435,f.tag))}return Z1(a,m,x),q1(),!1}if(sn)return c=Es.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=x,m!==ma&&(a=Error(r(422),{cause:m}),Xi(hi(a,f)))):(m!==ma&&(c=Error(r(423),{cause:m}),Xi(hi(c,f))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,m=hi(m,f),x=S1(a.stateNode,m,x),fe(a,x),Gn!==4&&(Gn=2)),!1;var A=Error(r(520),{cause:m});if(A=hi(A,f),Rh===null?Rh=[A]:Rh.push(A),Gn!==4&&(Gn=2),c===null)return!0;m=hi(m,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,a=x&-x,f.lanes|=a,a=S1(f.stateNode,m,a),fe(f,a),!1;case 1:if(c=f.type,A=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(ll===null||!ll.has(A))))return f.flags|=65536,x&=-x,f.lanes|=x,x=Tx(x),Cx(x,a,f,m),fe(f,x),!1}f=f.return}while(f!==null);return!1}var Dx=Error(r(461)),xr=!1;function kr(a,c,f,m){c.child=a===null?_x(c,null,f,m):mu(c,a.child,f,m)}function Ox(a,c,f,m,x){f=f.render;var A=c.ref;if("ref"in m){var B={};for(var W in m)W!=="ref"&&(B[W]=m[W])}else B=m;return lo(c),m=Ii(a,c,f,B,A,x),W=pr(),a!==null&&!xr?(Xr(a,c,x),mo(a,c,x)):(sn&&W&&Jf(c),c.flags|=1,kr(a,c,m,x),c.child)}function Rx(a,c,f,m,x){if(a===null){var A=f.type;return typeof A=="function"&&!Zf(A)&&A.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=A,Nx(a,c,A,m,x)):(a=su(f.type,null,m,c,c.mode,x),a.ref=c.ref,a.return=c,c.child=a)}if(A=a.child,!L1(a,x)){var B=A.memoizedProps;if(f=f.compare,f=f!==null?f:to,f(B,m)&&a.ref===c.ref)return mo(a,c,x)}return c.flags|=1,a=Gs(A,m),a.ref=c.ref,a.return=c,c.child=a}function Nx(a,c,f,m,x){if(a!==null){var A=a.memoizedProps;if(to(A,m)&&a.ref===c.ref)if(xr=!1,c.pendingProps=m=A,L1(a,x))(a.flags&131072)!==0&&(xr=!0);else return c.lanes=a.lanes,mo(a,c,x)}return T1(a,c,f,m,x)}function kx(a,c,f){var m=c.pendingProps,x=m.children,A=a!==null?a.memoizedState:null;if(m.mode==="hidden"){if((c.flags&128)!==0){if(m=A!==null?A.baseLanes|f:f,a!==null){for(x=c.child=a.child,A=0;x!==null;)A=A|x.lanes|x.childLanes,x=x.sibling;c.childLanes=A&~m}else c.childLanes=0,c.child=null;return Lx(a,c,m,f)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},a!==null&&au(c,A!==null?A.cachePool:null),A!==null?hn(c,A):He(),yx(c);else return c.lanes=c.childLanes=536870912,Lx(a,c,A!==null?A.baseLanes|f:f,f)}else A!==null?(au(c,A.cachePool),hn(c,A),nl(),c.memoizedState=null):(a!==null&&au(c,null),He(),nl());return kr(a,c,x,f),c.child}function Lx(a,c,f,m){var x=lh();return x=x===null?null:{parent:$n._currentValue,pool:x},c.memoizedState={baseLanes:f,cachePool:x},a!==null&&au(c,null),He(),yx(c),a!==null&&Jl(a,c,m,!0),null}function pp(a,c){var f=c.ref;if(f===null)a!==null&&a.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(r(284));(a===null||a.ref!==f)&&(c.flags|=4194816)}}function T1(a,c,f,m,x){return lo(c),f=Ii(a,c,f,m,void 0,x),m=pr(),a!==null&&!xr?(Xr(a,c,x),mo(a,c,x)):(sn&&m&&Jf(c),c.flags|=1,kr(a,c,f,x),c.child)}function Mx(a,c,f,m,x,A){return lo(c),c.updateQueue=null,f=Xn(c,m,f,x),po(a),m=pr(),a!==null&&!xr?(Xr(a,c,A),mo(a,c,A)):(sn&&m&&Jf(c),c.flags|=1,kr(a,c,f,A),c.child)}function Ix(a,c,f,m,x){if(lo(c),c.stateNode===null){var A=Yo,B=f.contextType;typeof B=="object"&&B!==null&&(A=hr(B)),A=new f(m,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=A1,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=m,A.state=c.memoizedState,A.refs={},wt(c),B=f.contextType,A.context=typeof B=="object"&&B!==null?hr(B):Yo,A.state=c.memoizedState,B=f.getDerivedStateFromProps,typeof B=="function"&&(w1(c,f,B,m),A.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(B=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),B!==A.state&&A1.enqueueReplaceState(A,A.state,null),xe(c,m,A,x),Ie(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),m=!0}else if(a===null){A=c.stateNode;var W=c.memoizedProps,ht=ic(f,W);A.props=ht;var Mt=A.context,$t=f.contextType;B=Yo,typeof $t=="object"&&$t!==null&&(B=hr($t));var Kt=f.getDerivedStateFromProps;$t=typeof Kt=="function"||typeof A.getSnapshotBeforeUpdate=="function",W=c.pendingProps!==W,$t||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(W||Mt!==B)&&xx(c,A,m,B),vt=!1;var Ft=c.memoizedState;A.state=Ft,xe(c,m,A,x),Ie(),Mt=c.memoizedState,W||Ft!==Mt||vt?(typeof Kt=="function"&&(w1(c,f,Kt,m),Mt=c.memoizedState),(ht=vt||bx(c,f,ht,m,Ft,Mt,B))?($t||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=Mt),A.props=m,A.state=Mt,A.context=B,m=ht):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{A=c.stateNode,jt(a,c),B=c.memoizedProps,$t=ic(f,B),A.props=$t,Kt=c.pendingProps,Ft=A.context,Mt=f.contextType,ht=Yo,typeof Mt=="object"&&Mt!==null&&(ht=hr(Mt)),W=f.getDerivedStateFromProps,(Mt=typeof W=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(B!==Kt||Ft!==ht)&&xx(c,A,m,ht),vt=!1,Ft=c.memoizedState,A.state=Ft,xe(c,m,A,x),Ie();var Ut=c.memoizedState;B!==Kt||Ft!==Ut||vt||a!==null&&a.dependencies!==null&&tc(a.dependencies)?(typeof W=="function"&&(w1(c,f,W,m),Ut=c.memoizedState),($t=vt||bx(c,f,$t,m,Ft,Ut,ht)||a!==null&&a.dependencies!==null&&tc(a.dependencies))?(Mt||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(m,Ut,ht),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(m,Ut,ht)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||B===a.memoizedProps&&Ft===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||B===a.memoizedProps&&Ft===a.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=Ut),A.props=m,A.state=Ut,A.context=ht,m=$t):(typeof A.componentDidUpdate!="function"||B===a.memoizedProps&&Ft===a.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||B===a.memoizedProps&&Ft===a.memoizedState||(c.flags|=1024),m=!1)}return A=m,pp(a,c),m=(c.flags&128)!==0,A||m?(A=c.stateNode,f=m&&typeof f.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,a!==null&&m?(c.child=mu(c,a.child,null,x),c.child=mu(c,null,f,x)):kr(a,c,f,x),c.memoizedState=A.state,a=c.child):a=mo(a,c,x),a}function Px(a,c,f,m){return Ql(),c.flags|=256,kr(a,c,f,m),c.child}var C1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function D1(a){return{baseLanes:a,cachePool:J0()}}function O1(a,c,f){return a=a!==null?a.childLanes&~f:0,c&&(a|=ws),a}function Fx(a,c,f){var m=c.pendingProps,x=!1,A=(c.flags&128)!==0,B;if((B=A)||(B=a!==null&&a.memoizedState===null?!1:(mr.current&2)!==0),B&&(x=!0,c.flags&=-129),B=(c.flags&32)!==0,c.flags&=-33,a===null){if(sn){if(x?el(c):nl(),sn){var W=Dn,ht;if(ht=W){t:{for(ht=W,W=bs;ht.nodeType!==8;){if(!W){W=null;break t}if(ht=Zs(ht.nextSibling),ht===null){W=null;break t}}W=ht}W!==null?(c.memoizedState={dehydrated:W,treeContext:so!==null?{id:Ws,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},ht=pi(18,null,null,0),ht.stateNode=W,ht.return=c,c.child=ht,rr=c,Dn=null,ht=!0):ht=!1}ht||Xs(c)}if(W=c.memoizedState,W!==null&&(W=W.dehydrated,W!==null))return hv(W)?c.lanes=32:c.lanes=536870912,null;go(c)}return W=m.children,m=m.fallback,x?(nl(),x=c.mode,W=gp({mode:"hidden",children:W},x),m=Vs(m,x,f,null),W.return=c,m.return=c,W.sibling=m,c.child=W,x=c.child,x.memoizedState=D1(f),x.childLanes=O1(a,B,f),c.memoizedState=C1,m):(el(c),R1(c,W))}if(ht=a.memoizedState,ht!==null&&(W=ht.dehydrated,W!==null)){if(A)c.flags&256?(el(c),c.flags&=-257,c=N1(a,c,f)):c.memoizedState!==null?(nl(),c.child=a.child,c.flags|=128,c=null):(nl(),x=m.fallback,W=c.mode,m=gp({mode:"visible",children:m.children},W),x=Vs(x,W,f,null),x.flags|=2,m.return=c,x.return=c,m.sibling=x,c.child=m,mu(c,a.child,null,f),m=c.child,m.memoizedState=D1(f),m.childLanes=O1(a,B,f),c.memoizedState=C1,c=x);else if(el(c),hv(W)){if(B=W.nextSibling&&W.nextSibling.dataset,B)var Mt=B.dgst;B=Mt,m=Error(r(419)),m.stack="",m.digest=B,Xi({value:m,source:null,stack:null}),c=N1(a,c,f)}else if(xr||Jl(a,c,f,!1),B=(f&a.childLanes)!==0,xr||B){if(B=On,B!==null&&(m=f&-f,m=(m&42)!==0?1:Fl(m),m=(m&(B.suspendedLanes|f))!==0?0:m,m!==0&&m!==ht.retryLane))throw ht.retryLane=m,Gr(a,m),Ji(B,a,m),Dx;W.data==="$?"||q1(),c=N1(a,c,f)}else W.data==="$?"?(c.flags|=192,c.child=a.child,c=null):(a=ht.treeContext,Dn=Zs(W.nextSibling),rr=c,sn=!0,ga=null,bs=!1,a!==null&&(Vr[Ni++]=Ws,Vr[Ni++]=Nr,Vr[Ni++]=so,Ws=a.id,Nr=a.overflow,so=c),c=R1(c,m.children),c.flags|=4096);return c}return x?(nl(),x=m.fallback,W=c.mode,ht=a.child,Mt=ht.sibling,m=Gs(ht,{mode:"hidden",children:m.children}),m.subtreeFlags=ht.subtreeFlags&65011712,Mt!==null?x=Gs(Mt,x):(x=Vs(x,W,f,null),x.flags|=2),x.return=c,m.return=c,m.sibling=x,c.child=m,m=x,x=c.child,W=a.child.memoizedState,W===null?W=D1(f):(ht=W.cachePool,ht!==null?(Mt=$n._currentValue,ht=ht.parent!==Mt?{parent:Mt,pool:Mt}:ht):ht=J0(),W={baseLanes:W.baseLanes|f,cachePool:ht}),x.memoizedState=W,x.childLanes=O1(a,B,f),c.memoizedState=C1,m):(el(c),f=a.child,a=f.sibling,f=Gs(f,{mode:"visible",children:m.children}),f.return=c,f.sibling=null,a!==null&&(B=c.deletions,B===null?(c.deletions=[a],c.flags|=16):B.push(a)),c.child=f,c.memoizedState=null,f)}function R1(a,c){return c=gp({mode:"visible",children:c},a.mode),c.return=a,a.child=c}function gp(a,c){return a=pi(22,a,null,c),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function N1(a,c,f){return mu(c,a.child,null,f),a=R1(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function Bx(a,c,f){a.lanes|=c;var m=a.alternate;m!==null&&(m.lanes|=c),rh(a.return,c,f)}function k1(a,c,f,m,x){var A=a.memoizedState;A===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:f,tailMode:x}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=m,A.tail=f,A.tailMode=x)}function Ux(a,c,f){var m=c.pendingProps,x=m.revealOrder,A=m.tail;if(kr(a,c,m.children,f),m=mr.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(a!==null&&(a.flags&128)!==0)t:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Bx(a,f,c);else if(a.tag===19)Bx(a,f,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break t;for(;a.sibling===null;){if(a.return===null||a.return===c)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}m&=1}switch(ct(mr,m),x){case"forwards":for(f=c.child,x=null;f!==null;)a=f.alternate,a!==null&&fp(a)===null&&(x=f),f=f.sibling;f=x,f===null?(x=c.child,c.child=null):(x=f.sibling,f.sibling=null),k1(c,!1,x,f,A);break;case"backwards":for(f=null,x=c.child,c.child=null;x!==null;){if(a=x.alternate,a!==null&&fp(a)===null){c.child=x;break}a=x.sibling,x.sibling=f,f=x,x=a}k1(c,!0,f,null,A);break;case"together":k1(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function mo(a,c,f){if(a!==null&&(c.dependencies=a.dependencies),ol|=c.lanes,(f&c.childLanes)===0)if(a!==null){if(Jl(a,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(a!==null&&c.child!==a.child)throw Error(r(153));if(c.child!==null){for(a=c.child,f=Gs(a,a.pendingProps),c.child=f,f.return=c;a.sibling!==null;)a=a.sibling,f=f.sibling=Gs(a,a.pendingProps),f.return=c;f.sibling=null}return c.child}function L1(a,c){return(a.lanes&c)!==0?!0:(a=a.dependencies,!!(a!==null&&tc(a)))}function bR(a,c,f){switch(c.tag){case 3:j(c,c.stateNode.containerInfo),va(c,$n,a.memoizedState.cache),Ql();break;case 27:case 5:lt(c);break;case 4:j(c,c.stateNode.containerInfo);break;case 10:va(c,c.type,c.memoizedProps.value);break;case 13:var m=c.memoizedState;if(m!==null)return m.dehydrated!==null?(el(c),c.flags|=128,null):(f&c.child.childLanes)!==0?Fx(a,c,f):(el(c),a=mo(a,c,f),a!==null?a.sibling:null);el(c);break;case 19:var x=(a.flags&128)!==0;if(m=(f&c.childLanes)!==0,m||(Jl(a,c,f,!1),m=(f&c.childLanes)!==0),x){if(m)return Ux(a,c,f);c.flags|=128}if(x=c.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ct(mr,mr.current),m)break;return null;case 22:case 23:return c.lanes=0,kx(a,c,f);case 24:va(c,$n,a.memoizedState.cache)}return mo(a,c,f)}function zx(a,c,f){if(a!==null)if(a.memoizedProps!==c.pendingProps)xr=!0;else{if(!L1(a,f)&&(c.flags&128)===0)return xr=!1,bR(a,c,f);xr=(a.flags&131072)!==0}else xr=!1,sn&&(c.flags&1048576)!==0&&Y0(c,Ko,c.index);switch(c.lanes=0,c.tag){case 16:t:{a=c.pendingProps;var m=c.elementType,x=m._init;if(m=x(m._payload),c.type=m,typeof m=="function")Zf(m)?(a=ic(m,a),c.tag=1,c=Ix(null,c,m,a,f)):(c.tag=0,c=T1(null,c,m,a,f));else{if(m!=null){if(x=m.$$typeof,x===O){c.tag=11,c=Ox(null,c,m,a,f);break t}else if(x===C){c.tag=14,c=Rx(null,c,m,a,f);break t}}throw c=L(m)||m,Error(r(306,c,""))}}return c;case 0:return T1(a,c,c.type,c.pendingProps,f);case 1:return m=c.type,x=ic(m,c.pendingProps),Ix(a,c,m,x,f);case 3:t:{if(j(c,c.stateNode.containerInfo),a===null)throw Error(r(387));m=c.pendingProps;var A=c.memoizedState;x=A.element,jt(a,c),xe(c,m,null,f);var B=c.memoizedState;if(m=B.cache,va(c,$n,m),m!==A.cache&&ih(c,[$n],f,!0),Ie(),m=B.element,A.isDehydrated)if(A={element:m,isDehydrated:!1,cache:B.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=Px(a,c,m,f);break t}else if(m!==x){x=hi(Error(r(424)),c),Xi(x),c=Px(a,c,m,f);break t}else{switch(a=c.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(Dn=Zs(a.firstChild),rr=c,sn=!0,ga=null,bs=!0,f=_x(c,null,m,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Ql(),m===x){c=mo(a,c,f);break t}kr(a,c,m,f)}c=c.child}return c;case 26:return pp(a,c),a===null?(f=GE(c.type,null,c.pendingProps,null))?c.memoizedState=f:sn||(f=c.type,a=c.pendingProps,m=Op(Bt.current).createElement(f),m[tr]=c,m[er]=a,Mr(m,f,a),yt(m),c.stateNode=m):c.memoizedState=GE(c.type,a.memoizedProps,c.pendingProps,a.memoizedState),null;case 27:return lt(c),a===null&&sn&&(m=c.stateNode=HE(c.type,c.pendingProps,Bt.current),rr=c,bs=!0,x=Dn,fl(c.type)?(dv=x,Dn=Zs(m.firstChild)):Dn=x),kr(a,c,c.pendingProps.children,f),pp(a,c),a===null&&(c.flags|=4194304),c.child;case 5:return a===null&&sn&&((x=m=Dn)&&(m=YR(m,c.type,c.pendingProps,bs),m!==null?(c.stateNode=m,rr=c,Dn=Zs(m.firstChild),bs=!1,x=!0):x=!1),x||Xs(c)),lt(c),x=c.type,A=c.pendingProps,B=a!==null?a.memoizedProps:null,m=A.children,cv(x,A)?m=null:B!==null&&cv(x,B)&&(c.flags|=32),c.memoizedState!==null&&(x=Ii(a,c,dn,null,null,f),Uh._currentValue=x),pp(a,c),kr(a,c,m,f),c.child;case 6:return a===null&&sn&&((a=f=Dn)&&(f=qR(f,c.pendingProps,bs),f!==null?(c.stateNode=f,rr=c,Dn=null,a=!0):a=!1),a||Xs(c)),null;case 13:return Fx(a,c,f);case 4:return j(c,c.stateNode.containerInfo),m=c.pendingProps,a===null?c.child=mu(c,null,m,f):kr(a,c,m,f),c.child;case 11:return Ox(a,c,c.type,c.pendingProps,f);case 7:return kr(a,c,c.pendingProps,f),c.child;case 8:return kr(a,c,c.pendingProps.children,f),c.child;case 12:return kr(a,c,c.pendingProps.children,f),c.child;case 10:return m=c.pendingProps,va(c,c.type,m.value),kr(a,c,m.children,f),c.child;case 9:return x=c.type._context,m=c.pendingProps.children,lo(c),x=hr(x),m=m(x),c.flags|=1,kr(a,c,m,f),c.child;case 14:return Rx(a,c,c.type,c.pendingProps,f);case 15:return Nx(a,c,c.type,c.pendingProps,f);case 19:return Ux(a,c,f);case 31:return m=c.pendingProps,f=c.mode,m={mode:m.mode,children:m.children},a===null?(f=gp(m,f),f.ref=c.ref,c.child=f,f.return=c,c=f):(f=Gs(a.child,m),f.ref=c.ref,c.child=f,f.return=c,c=f),c;case 22:return kx(a,c,f);case 24:return lo(c),m=hr($n),a===null?(x=lh(),x===null&&(x=On,A=ec(),x.pooledCache=A,A.refCount++,A!==null&&(x.pooledCacheLanes|=f),x=A),c.memoizedState={parent:m,cache:x},wt(c),va(c,$n,x)):((a.lanes&f)!==0&&(jt(a,c),xe(c,null,null,f),Ie()),x=a.memoizedState,A=c.memoizedState,x.parent!==m?(x={parent:m,cache:m},c.memoizedState=x,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=x),va(c,$n,m)):(m=A.cache,va(c,$n,m),m!==x.cache&&ih(c,[$n],f,!0))),kr(a,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function vo(a){a.flags|=4}function Hx(a,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!qE(c)){if(c=Es.current,c!==null&&((tn&4194048)===tn?xa!==null:(tn&62914560)!==tn&&(tn&536870912)===0||c!==xa))throw w=ch,nc;a.flags|=8192}}function mp(a,c){c!==null&&(a.flags|=4),a.flags&16384&&(c=a.tag!==22?Ga():536870912,a.lanes|=c,bu|=c)}function Ah(a,c){if(!sn)switch(a.tailMode){case"hidden":c=a.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?a.tail=null:f.sibling=null;break;case"collapsed":f=a.tail;for(var m=null;f!==null;)f.alternate!==null&&(m=f),f=f.sibling;m===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:m.sibling=null}}function zn(a){var c=a.alternate!==null&&a.alternate.child===a.child,f=0,m=0;if(c)for(var x=a.child;x!==null;)f|=x.lanes|x.childLanes,m|=x.subtreeFlags&65011712,m|=x.flags&65011712,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)f|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=m,a.childLanes=f,c}function xR(a,c,f){var m=c.pendingProps;switch(th(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(c),null;case 1:return zn(c),null;case 3:return f=c.stateNode,m=null,a!==null&&(m=a.memoizedState.cache),c.memoizedState.cache!==m&&(c.flags|=2048),qs($n),pt(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(a===null||a.child===null)&&(Zl(c)?vo(c):a===null||a.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Zo())),zn(c),null;case 26:return f=c.memoizedState,a===null?(vo(c),f!==null?(zn(c),Hx(c,f)):(zn(c),c.flags&=-16777217)):f?f!==a.memoizedState?(vo(c),zn(c),Hx(c,f)):(zn(c),c.flags&=-16777217):(a.memoizedProps!==m&&vo(c),zn(c),c.flags&=-16777217),null;case 27:ut(c),f=Bt.current;var x=c.type;if(a!==null&&c.stateNode!=null)a.memoizedProps!==m&&vo(c);else{if(!m){if(c.stateNode===null)throw Error(r(166));return zn(c),null}a=gt.current,Zl(c)?eh(c):(a=HE(x,m,f),c.stateNode=a,vo(c))}return zn(c),null;case 5:if(ut(c),f=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==m&&vo(c);else{if(!m){if(c.stateNode===null)throw Error(r(166));return zn(c),null}if(a=gt.current,Zl(c))eh(c);else{switch(x=Op(Bt.current),a){case 1:a=x.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:a=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":a=x.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":a=x.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":a=x.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof m.is=="string"?x.createElement("select",{is:m.is}):x.createElement("select"),m.multiple?a.multiple=!0:m.size&&(a.size=m.size);break;default:a=typeof m.is=="string"?x.createElement(f,{is:m.is}):x.createElement(f)}}a[tr]=c,a[er]=m;t:for(x=c.child;x!==null;){if(x.tag===5||x.tag===6)a.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===c)break t;for(;x.sibling===null;){if(x.return===null||x.return===c)break t;x=x.return}x.sibling.return=x.return,x=x.sibling}c.stateNode=a;t:switch(Mr(a,f,m),f){case"button":case"input":case"select":case"textarea":a=!!m.autoFocus;break t;case"img":a=!0;break t;default:a=!1}a&&vo(c)}}return zn(c),c.flags&=-16777217,null;case 6:if(a&&c.stateNode!=null)a.memoizedProps!==m&&vo(c);else{if(typeof m!="string"&&c.stateNode===null)throw Error(r(166));if(a=Bt.current,Zl(c)){if(a=c.stateNode,f=c.memoizedProps,m=null,x=rr,x!==null)switch(x.tag){case 27:case 5:m=x.memoizedProps}a[tr]=c,a=!!(a.nodeValue===f||m!==null&&m.suppressHydrationWarning===!0||ME(a.nodeValue,f)),a||Xs(c)}else a=Op(a).createTextNode(m),a[tr]=c,c.stateNode=a}return zn(c),null;case 13:if(m=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=Zl(c),m!==null&&m.dehydrated!==null){if(a===null){if(!x)throw Error(r(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[tr]=c}else Ql(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;zn(c),x=!1}else x=Zo(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=x),x=!0;if(!x)return c.flags&256?(go(c),c):(go(c),null)}if(go(c),(c.flags&128)!==0)return c.lanes=f,c;if(f=m!==null,a=a!==null&&a.memoizedState!==null,f){m=c.child,x=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(x=m.alternate.memoizedState.cachePool.pool);var A=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(A=m.memoizedState.cachePool.pool),A!==x&&(m.flags|=2048)}return f!==a&&f&&(c.child.flags|=8192),mp(c,c.updateQueue),zn(c),null;case 4:return pt(),a===null&&iv(c.stateNode.containerInfo),zn(c),null;case 10:return qs(c.type),zn(c),null;case 19:if(V(mr),x=c.memoizedState,x===null)return zn(c),null;if(m=(c.flags&128)!==0,A=x.rendering,A===null)if(m)Ah(x,!1);else{if(Gn!==0||a!==null&&(a.flags&128)!==0)for(a=c.child;a!==null;){if(A=fp(a),A!==null){for(c.flags|=128,Ah(x,!1),a=A.updateQueue,c.updateQueue=a,mp(c,a),c.subtreeFlags=0,a=f,f=c.child;f!==null;)X0(f,a),f=f.sibling;return ct(mr,mr.current&1|2),c.child}a=a.sibling}x.tail!==null&&q()>yp&&(c.flags|=128,m=!0,Ah(x,!1),c.lanes=4194304)}else{if(!m)if(a=fp(A),a!==null){if(c.flags|=128,m=!0,a=a.updateQueue,c.updateQueue=a,mp(c,a),Ah(x,!0),x.tail===null&&x.tailMode==="hidden"&&!A.alternate&&!sn)return zn(c),null}else 2*q()-x.renderingStartTime>yp&&f!==536870912&&(c.flags|=128,m=!0,Ah(x,!1),c.lanes=4194304);x.isBackwards?(A.sibling=c.child,c.child=A):(a=x.last,a!==null?a.sibling=A:c.child=A,x.last=A)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=q(),c.sibling=null,a=mr.current,ct(mr,m?a&1|2:a&1),c):(zn(c),null);case 22:case 23:return go(c),Qe(),m=c.memoizedState!==null,a!==null?a.memoizedState!==null!==m&&(c.flags|=8192):m&&(c.flags|=8192),m?(f&536870912)!==0&&(c.flags&128)===0&&(zn(c),c.subtreeFlags&6&&(c.flags|=8192)):zn(c),f=c.updateQueue,f!==null&&mp(c,f.retryQueue),f=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),m=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(m=c.memoizedState.cachePool.pool),m!==f&&(c.flags|=2048),a!==null&&V(fo),null;case 24:return f=null,a!==null&&(f=a.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),qs($n),zn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function ER(a,c){switch(th(c),c.tag){case 1:return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return qs($n),pt(),a=c.flags,(a&65536)!==0&&(a&128)===0?(c.flags=a&-65537|128,c):null;case 26:case 27:case 5:return ut(c),null;case 13:if(go(c),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Ql()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return V(mr),null;case 4:return pt(),null;case 10:return qs(c.type),null;case 22:case 23:return go(c),Qe(),a!==null&&V(fo),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 24:return qs($n),null;case 25:return null;default:return null}}function jx(a,c){switch(th(c),c.tag){case 3:qs($n),pt();break;case 26:case 27:case 5:ut(c);break;case 4:pt();break;case 13:go(c);break;case 19:V(mr);break;case 10:qs(c.type);break;case 22:case 23:go(c),Qe(),a!==null&&V(fo);break;case 24:qs($n)}}function Sh(a,c){try{var f=c.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var x=m.next;f=x;do{if((f.tag&a)===a){m=void 0;var A=f.create,B=f.inst;m=A(),B.destroy=m}f=f.next}while(f!==x)}}catch(W){Sn(c,c.return,W)}}function rl(a,c,f){try{var m=c.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var A=x.next;m=A;do{if((m.tag&a)===a){var B=m.inst,W=B.destroy;if(W!==void 0){B.destroy=void 0,x=c;var ht=f,Mt=W;try{Mt()}catch($t){Sn(x,ht,$t)}}}m=m.next}while(m!==A)}}catch($t){Sn(c,c.return,$t)}}function $x(a){var c=a.updateQueue;if(c!==null){var f=a.stateNode;try{Re(c,f)}catch(m){Sn(a,a.return,m)}}}function Gx(a,c,f){f.props=ic(a.type,a.memoizedProps),f.state=a.memoizedState;try{f.componentWillUnmount()}catch(m){Sn(a,c,m)}}function Th(a,c){try{var f=a.ref;if(f!==null){switch(a.tag){case 26:case 27:case 5:var m=a.stateNode;break;case 30:m=a.stateNode;break;default:m=a.stateNode}typeof f=="function"?a.refCleanup=f(m):f.current=m}}catch(x){Sn(a,c,x)}}function Ea(a,c){var f=a.ref,m=a.refCleanup;if(f!==null)if(typeof m=="function")try{m()}catch(x){Sn(a,c,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(x){Sn(a,c,x)}else f.current=null}function Vx(a){var c=a.type,f=a.memoizedProps,m=a.stateNode;try{t:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&m.focus();break t;case"img":f.src?m.src=f.src:f.srcSet&&(m.srcset=f.srcSet)}}catch(x){Sn(a,a.return,x)}}function M1(a,c,f){try{var m=a.stateNode;$R(m,a.type,f,c),m[er]=c}catch(x){Sn(a,a.return,x)}}function Wx(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&fl(a.type)||a.tag===4}function I1(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||Wx(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&fl(a.type)||a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function P1(a,c,f){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(a,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(a),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Dp));else if(m!==4&&(m===27&&fl(a.type)&&(f=a.stateNode,c=null),a=a.child,a!==null))for(P1(a,c,f),a=a.sibling;a!==null;)P1(a,c,f),a=a.sibling}function vp(a,c,f){var m=a.tag;if(m===5||m===6)a=a.stateNode,c?f.insertBefore(a,c):f.appendChild(a);else if(m!==4&&(m===27&&fl(a.type)&&(f=a.stateNode),a=a.child,a!==null))for(vp(a,c,f),a=a.sibling;a!==null;)vp(a,c,f),a=a.sibling}function Xx(a){var c=a.stateNode,f=a.memoizedProps;try{for(var m=a.type,x=c.attributes;x.length;)c.removeAttributeNode(x[0]);Mr(c,m,f),c[tr]=a,c[er]=f}catch(A){Sn(a,a.return,A)}}var _o=!1,Yn=!1,F1=!1,Yx=typeof WeakSet=="function"?WeakSet:Set,Er=null;function wR(a,c){if(a=a.containerInfo,ov=Ip,a=Hf(a),eu(a)){if("selectionStart"in a)var f={start:a.selectionStart,end:a.selectionEnd};else t:{f=(f=a.ownerDocument)&&f.defaultView||window;var m=f.getSelection&&f.getSelection();if(m&&m.rangeCount!==0){f=m.anchorNode;var x=m.anchorOffset,A=m.focusNode;m=m.focusOffset;try{f.nodeType,A.nodeType}catch{f=null;break t}var B=0,W=-1,ht=-1,Mt=0,$t=0,Kt=a,Ft=null;e:for(;;){for(var Ut;Kt!==f||x!==0&&Kt.nodeType!==3||(W=B+x),Kt!==A||m!==0&&Kt.nodeType!==3||(ht=B+m),Kt.nodeType===3&&(B+=Kt.nodeValue.length),(Ut=Kt.firstChild)!==null;)Ft=Kt,Kt=Ut;for(;;){if(Kt===a)break e;if(Ft===f&&++Mt===x&&(W=B),Ft===A&&++$t===m&&(ht=B),(Ut=Kt.nextSibling)!==null)break;Kt=Ft,Ft=Kt.parentNode}Kt=Ut}f=W===-1||ht===-1?null:{start:W,end:ht}}else f=null}f=f||{start:0,end:0}}else f=null;for(lv={focusedElem:a,selectionRange:f},Ip=!1,Er=c;Er!==null;)if(c=Er,a=c.child,(c.subtreeFlags&1024)!==0&&a!==null)a.return=c,Er=a;else for(;Er!==null;){switch(c=Er,A=c.alternate,a=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&A!==null){a=void 0,f=c,x=A.memoizedProps,A=A.memoizedState,m=f.stateNode;try{var Me=ic(f.type,x,f.elementType===f.type);a=m.getSnapshotBeforeUpdate(Me,A),m.__reactInternalSnapshotBeforeUpdate=a}catch(Ce){Sn(f,f.return,Ce)}}break;case 3:if((a&1024)!==0){if(a=c.stateNode.containerInfo,f=a.nodeType,f===9)fv(a);else if(f===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":fv(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(r(163))}if(a=c.sibling,a!==null){a.return=c.return,Er=a;break}Er=c.return}}function qx(a,c,f){var m=f.flags;switch(f.tag){case 0:case 11:case 15:il(a,f),m&4&&Sh(5,f);break;case 1:if(il(a,f),m&4)if(a=f.stateNode,c===null)try{a.componentDidMount()}catch(B){Sn(f,f.return,B)}else{var x=ic(f.type,c.memoizedProps);c=c.memoizedState;try{a.componentDidUpdate(x,c,a.__reactInternalSnapshotBeforeUpdate)}catch(B){Sn(f,f.return,B)}}m&64&&$x(f),m&512&&Th(f,f.return);break;case 3:if(il(a,f),m&64&&(a=f.updateQueue,a!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{Re(a,c)}catch(B){Sn(f,f.return,B)}}break;case 27:c===null&&m&4&&Xx(f);case 26:case 5:il(a,f),c===null&&m&4&&Vx(f),m&512&&Th(f,f.return);break;case 12:il(a,f);break;case 13:il(a,f),m&4&&Qx(a,f),m&64&&(a=f.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(f=kR.bind(null,f),KR(a,f))));break;case 22:if(m=f.memoizedState!==null||_o,!m){c=c!==null&&c.memoizedState!==null||Yn,x=_o;var A=Yn;_o=m,(Yn=c)&&!A?sl(a,f,(f.subtreeFlags&8772)!==0):il(a,f),_o=x,Yn=A}break;case 30:break;default:il(a,f)}}function Kx(a){var c=a.alternate;c!==null&&(a.alternate=null,Kx(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&tt(c)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Ln=null,Pi=!1;function yo(a,c,f){for(f=f.child;f!==null;)Zx(a,c,f),f=f.sibling}function Zx(a,c,f){if(de&&typeof de.onCommitFiberUnmount=="function")try{de.onCommitFiberUnmount(se,f)}catch{}switch(f.tag){case 26:Yn||Ea(f,c),yo(a,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Yn||Ea(f,c);var m=Ln,x=Pi;fl(f.type)&&(Ln=f.stateNode,Pi=!1),yo(a,c,f),Ih(f.stateNode),Ln=m,Pi=x;break;case 5:Yn||Ea(f,c);case 6:if(m=Ln,x=Pi,Ln=null,yo(a,c,f),Ln=m,Pi=x,Ln!==null)if(Pi)try{(Ln.nodeType===9?Ln.body:Ln.nodeName==="HTML"?Ln.ownerDocument.body:Ln).removeChild(f.stateNode)}catch(A){Sn(f,c,A)}else try{Ln.removeChild(f.stateNode)}catch(A){Sn(f,c,A)}break;case 18:Ln!==null&&(Pi?(a=Ln,UE(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,f.stateNode),$h(a)):UE(Ln,f.stateNode));break;case 4:m=Ln,x=Pi,Ln=f.stateNode.containerInfo,Pi=!0,yo(a,c,f),Ln=m,Pi=x;break;case 0:case 11:case 14:case 15:Yn||rl(2,f,c),Yn||rl(4,f,c),yo(a,c,f);break;case 1:Yn||(Ea(f,c),m=f.stateNode,typeof m.componentWillUnmount=="function"&&Gx(f,c,m)),yo(a,c,f);break;case 21:yo(a,c,f);break;case 22:Yn=(m=Yn)||f.memoizedState!==null,yo(a,c,f),Yn=m;break;default:yo(a,c,f)}}function Qx(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{$h(a)}catch(f){Sn(c,c.return,f)}}function AR(a){switch(a.tag){case 13:case 19:var c=a.stateNode;return c===null&&(c=a.stateNode=new Yx),c;case 22:return a=a.stateNode,c=a._retryCache,c===null&&(c=a._retryCache=new Yx),c;default:throw Error(r(435,a.tag))}}function B1(a,c){var f=AR(a);c.forEach(function(m){var x=LR.bind(null,a,m);f.has(m)||(f.add(m),m.then(x,x))})}function qi(a,c){var f=c.deletions;if(f!==null)for(var m=0;m<f.length;m++){var x=f[m],A=a,B=c,W=B;t:for(;W!==null;){switch(W.tag){case 27:if(fl(W.type)){Ln=W.stateNode,Pi=!1;break t}break;case 5:Ln=W.stateNode,Pi=!1;break t;case 3:case 4:Ln=W.stateNode.containerInfo,Pi=!0;break t}W=W.return}if(Ln===null)throw Error(r(160));Zx(A,B,x),Ln=null,Pi=!1,A=x.alternate,A!==null&&(A.return=null),x.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)Jx(c,a),c=c.sibling}var Ks=null;function Jx(a,c){var f=a.alternate,m=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:qi(c,a),Ki(a),m&4&&(rl(3,a,a.return),Sh(3,a),rl(5,a,a.return));break;case 1:qi(c,a),Ki(a),m&512&&(Yn||f===null||Ea(f,f.return)),m&64&&_o&&(a=a.updateQueue,a!==null&&(m=a.callbacks,m!==null&&(f=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=f===null?m:f.concat(m))));break;case 26:var x=Ks;if(qi(c,a),Ki(a),m&512&&(Yn||f===null||Ea(f,f.return)),m&4){var A=f!==null?f.memoizedState:null;if(m=a.memoizedState,f===null)if(m===null)if(a.stateNode===null){t:{m=a.type,f=a.memoizedProps,x=x.ownerDocument||x;e:switch(m){case"title":A=x.getElementsByTagName("title")[0],(!A||A[Z]||A[tr]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=x.createElement(m),x.head.insertBefore(A,x.querySelector("head > title"))),Mr(A,m,f),A[tr]=a,yt(A),m=A;break t;case"link":var B=XE("link","href",x).get(m+(f.href||""));if(B){for(var W=0;W<B.length;W++)if(A=B[W],A.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&A.getAttribute("rel")===(f.rel==null?null:f.rel)&&A.getAttribute("title")===(f.title==null?null:f.title)&&A.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){B.splice(W,1);break e}}A=x.createElement(m),Mr(A,m,f),x.head.appendChild(A);break;case"meta":if(B=XE("meta","content",x).get(m+(f.content||""))){for(W=0;W<B.length;W++)if(A=B[W],A.getAttribute("content")===(f.content==null?null:""+f.content)&&A.getAttribute("name")===(f.name==null?null:f.name)&&A.getAttribute("property")===(f.property==null?null:f.property)&&A.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&A.getAttribute("charset")===(f.charSet==null?null:f.charSet)){B.splice(W,1);break e}}A=x.createElement(m),Mr(A,m,f),x.head.appendChild(A);break;default:throw Error(r(468,m))}A[tr]=a,yt(A),m=A}a.stateNode=m}else YE(x,a.type,a.stateNode);else a.stateNode=WE(x,m,a.memoizedProps);else A!==m?(A===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):A.count--,m===null?YE(x,a.type,a.stateNode):WE(x,m,a.memoizedProps)):m===null&&a.stateNode!==null&&M1(a,a.memoizedProps,f.memoizedProps)}break;case 27:qi(c,a),Ki(a),m&512&&(Yn||f===null||Ea(f,f.return)),f!==null&&m&4&&M1(a,a.memoizedProps,f.memoizedProps);break;case 5:if(qi(c,a),Ki(a),m&512&&(Yn||f===null||Ea(f,f.return)),a.flags&32){x=a.stateNode;try{Vi(x,"")}catch(Ut){Sn(a,a.return,Ut)}}m&4&&a.stateNode!=null&&(x=a.memoizedProps,M1(a,x,f!==null?f.memoizedProps:x)),m&1024&&(F1=!0);break;case 6:if(qi(c,a),Ki(a),m&4){if(a.stateNode===null)throw Error(r(162));m=a.memoizedProps,f=a.stateNode;try{f.nodeValue=m}catch(Ut){Sn(a,a.return,Ut)}}break;case 3:if(kp=null,x=Ks,Ks=Rp(c.containerInfo),qi(c,a),Ks=x,Ki(a),m&4&&f!==null&&f.memoizedState.isDehydrated)try{$h(c.containerInfo)}catch(Ut){Sn(a,a.return,Ut)}F1&&(F1=!1,tE(a));break;case 4:m=Ks,Ks=Rp(a.stateNode.containerInfo),qi(c,a),Ki(a),Ks=m;break;case 12:qi(c,a),Ki(a);break;case 13:qi(c,a),Ki(a),a.child.flags&8192&&a.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(G1=q()),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,B1(a,m)));break;case 22:x=a.memoizedState!==null;var ht=f!==null&&f.memoizedState!==null,Mt=_o,$t=Yn;if(_o=Mt||x,Yn=$t||ht,qi(c,a),Yn=$t,_o=Mt,Ki(a),m&8192)t:for(c=a.stateNode,c._visibility=x?c._visibility&-2:c._visibility|1,x&&(f===null||ht||_o||Yn||sc(a)),f=null,c=a;;){if(c.tag===5||c.tag===26){if(f===null){ht=f=c;try{if(A=ht.stateNode,x)B=A.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none";else{W=ht.stateNode;var Kt=ht.memoizedProps.style,Ft=Kt!=null&&Kt.hasOwnProperty("display")?Kt.display:null;W.style.display=Ft==null||typeof Ft=="boolean"?"":(""+Ft).trim()}}catch(Ut){Sn(ht,ht.return,Ut)}}}else if(c.tag===6){if(f===null){ht=c;try{ht.stateNode.nodeValue=x?"":ht.memoizedProps}catch(Ut){Sn(ht,ht.return,Ut)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===a)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break t;for(;c.sibling===null;){if(c.return===null||c.return===a)break t;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}m&4&&(m=a.updateQueue,m!==null&&(f=m.retryQueue,f!==null&&(m.retryQueue=null,B1(a,f))));break;case 19:qi(c,a),Ki(a),m&4&&(m=a.updateQueue,m!==null&&(a.updateQueue=null,B1(a,m)));break;case 30:break;case 21:break;default:qi(c,a),Ki(a)}}function Ki(a){var c=a.flags;if(c&2){try{for(var f,m=a.return;m!==null;){if(Wx(m)){f=m;break}m=m.return}if(f==null)throw Error(r(160));switch(f.tag){case 27:var x=f.stateNode,A=I1(a);vp(a,A,x);break;case 5:var B=f.stateNode;f.flags&32&&(Vi(B,""),f.flags&=-33);var W=I1(a);vp(a,W,B);break;case 3:case 4:var ht=f.stateNode.containerInfo,Mt=I1(a);P1(a,Mt,ht);break;default:throw Error(r(161))}}catch($t){Sn(a,a.return,$t)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function tE(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var c=a;tE(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),a=a.sibling}}function il(a,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)qx(a,c.alternate,c),c=c.sibling}function sc(a){for(a=a.child;a!==null;){var c=a;switch(c.tag){case 0:case 11:case 14:case 15:rl(4,c,c.return),sc(c);break;case 1:Ea(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&Gx(c,c.return,f),sc(c);break;case 27:Ih(c.stateNode);case 26:case 5:Ea(c,c.return),sc(c);break;case 22:c.memoizedState===null&&sc(c);break;case 30:sc(c);break;default:sc(c)}a=a.sibling}}function sl(a,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var m=c.alternate,x=a,A=c,B=A.flags;switch(A.tag){case 0:case 11:case 15:sl(x,A,f),Sh(4,A);break;case 1:if(sl(x,A,f),m=A,x=m.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Mt){Sn(m,m.return,Mt)}if(m=A,x=m.updateQueue,x!==null){var W=m.stateNode;try{var ht=x.shared.hiddenCallbacks;if(ht!==null)for(x.shared.hiddenCallbacks=null,x=0;x<ht.length;x++)Pe(ht[x],W)}catch(Mt){Sn(m,m.return,Mt)}}f&&B&64&&$x(A),Th(A,A.return);break;case 27:Xx(A);case 26:case 5:sl(x,A,f),f&&m===null&&B&4&&Vx(A),Th(A,A.return);break;case 12:sl(x,A,f);break;case 13:sl(x,A,f),f&&B&4&&Qx(x,A);break;case 22:A.memoizedState===null&&sl(x,A,f),Th(A,A.return);break;case 30:break;default:sl(x,A,f)}c=c.sibling}}function U1(a,c){var f=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),a=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(a=c.memoizedState.cachePool.pool),a!==f&&(a!=null&&a.refCount++,f!=null&&Jo(f))}function z1(a,c){a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&Jo(a))}function wa(a,c,f,m){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)eE(a,c,f,m),c=c.sibling}function eE(a,c,f,m){var x=c.flags;switch(c.tag){case 0:case 11:case 15:wa(a,c,f,m),x&2048&&Sh(9,c);break;case 1:wa(a,c,f,m);break;case 3:wa(a,c,f,m),x&2048&&(a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&Jo(a)));break;case 12:if(x&2048){wa(a,c,f,m),a=c.stateNode;try{var A=c.memoizedProps,B=A.id,W=A.onPostCommit;typeof W=="function"&&W(B,c.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ht){Sn(c,c.return,ht)}}else wa(a,c,f,m);break;case 13:wa(a,c,f,m);break;case 23:break;case 22:A=c.stateNode,B=c.alternate,c.memoizedState!==null?A._visibility&2?wa(a,c,f,m):Ch(a,c):A._visibility&2?wa(a,c,f,m):(A._visibility|=2,vu(a,c,f,m,(c.subtreeFlags&10256)!==0)),x&2048&&U1(B,c);break;case 24:wa(a,c,f,m),x&2048&&z1(c.alternate,c);break;default:wa(a,c,f,m)}}function vu(a,c,f,m,x){for(x=x&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=a,B=c,W=f,ht=m,Mt=B.flags;switch(B.tag){case 0:case 11:case 15:vu(A,B,W,ht,x),Sh(8,B);break;case 23:break;case 22:var $t=B.stateNode;B.memoizedState!==null?$t._visibility&2?vu(A,B,W,ht,x):Ch(A,B):($t._visibility|=2,vu(A,B,W,ht,x)),x&&Mt&2048&&U1(B.alternate,B);break;case 24:vu(A,B,W,ht,x),x&&Mt&2048&&z1(B.alternate,B);break;default:vu(A,B,W,ht,x)}c=c.sibling}}function Ch(a,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=a,m=c,x=m.flags;switch(m.tag){case 22:Ch(f,m),x&2048&&U1(m.alternate,m);break;case 24:Ch(f,m),x&2048&&z1(m.alternate,m);break;default:Ch(f,m)}c=c.sibling}}var Dh=8192;function _u(a){if(a.subtreeFlags&Dh)for(a=a.child;a!==null;)nE(a),a=a.sibling}function nE(a){switch(a.tag){case 26:_u(a),a.flags&Dh&&a.memoizedState!==null&&cN(Ks,a.memoizedState,a.memoizedProps);break;case 5:_u(a);break;case 3:case 4:var c=Ks;Ks=Rp(a.stateNode.containerInfo),_u(a),Ks=c;break;case 22:a.memoizedState===null&&(c=a.alternate,c!==null&&c.memoizedState!==null?(c=Dh,Dh=16777216,_u(a),Dh=c):_u(a));break;default:_u(a)}}function rE(a){var c=a.alternate;if(c!==null&&(a=c.child,a!==null)){c.child=null;do c=a.sibling,a.sibling=null,a=c;while(a!==null)}}function Oh(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var m=c[f];Er=m,sE(m,a)}rE(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)iE(a),a=a.sibling}function iE(a){switch(a.tag){case 0:case 11:case 15:Oh(a),a.flags&2048&&rl(9,a,a.return);break;case 3:Oh(a);break;case 12:Oh(a);break;case 22:var c=a.stateNode;a.memoizedState!==null&&c._visibility&2&&(a.return===null||a.return.tag!==13)?(c._visibility&=-3,_p(a)):Oh(a);break;default:Oh(a)}}function _p(a){var c=a.deletions;if((a.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var m=c[f];Er=m,sE(m,a)}rE(a)}for(a=a.child;a!==null;){switch(c=a,c.tag){case 0:case 11:case 15:rl(8,c,c.return),_p(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,_p(c));break;default:_p(c)}a=a.sibling}}function sE(a,c){for(;Er!==null;){var f=Er;switch(f.tag){case 0:case 11:case 15:rl(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var m=f.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Jo(f.memoizedState.cache)}if(m=f.child,m!==null)m.return=f,Er=m;else t:for(f=a;Er!==null;){m=Er;var x=m.sibling,A=m.return;if(Kx(m),m===f){Er=null;break t}if(x!==null){x.return=A,Er=x;break t}Er=A}}}var SR={getCacheForType:function(a){var c=hr($n),f=c.data.get(a);return f===void 0&&(f=a(),c.data.set(a,f)),f}},TR=typeof WeakMap=="function"?WeakMap:Map,pn=0,On=null,We=null,tn=0,gn=0,Zi=null,al=!1,yu=!1,H1=!1,bo=0,Gn=0,ol=0,ac=0,j1=0,ws=0,bu=0,Rh=null,Fi=null,$1=!1,G1=0,yp=1/0,bp=null,ll=null,Lr=0,cl=null,xu=null,Eu=0,V1=0,W1=null,aE=null,Nh=0,X1=null;function Qi(){if((pn&2)!==0&&tn!==0)return tn&-tn;if(Q.T!==null){var a=ki;return a!==0?a:tv()}return Vc()}function oE(){ws===0&&(ws=(tn&536870912)===0||sn?$a():536870912);var a=Es.current;return a!==null&&(a.flags|=32),ws}function Ji(a,c,f){(a===On&&(gn===2||gn===9)||a.cancelPendingCommit!==null)&&(wu(a,0),ul(a,tn,ws,!1)),br(a,f),((pn&2)===0||a!==On)&&(a===On&&((pn&2)===0&&(ac|=f),Gn===4&&ul(a,tn,ws,!1)),Aa(a))}function lE(a,c,f){if((pn&6)!==0)throw Error(r(327));var m=!f&&(c&124)===0&&(c&a.expiredLanes)===0||ai(a,c),x=m?OR(a,c):K1(a,c,!0),A=m;do{if(x===0){yu&&!m&&ul(a,c,0,!1);break}else{if(f=a.current.alternate,A&&!CR(f)){x=K1(a,c,!1),A=!1;continue}if(x===2){if(A=c,a.errorRecoveryDisabledLanes&A)var B=0;else B=a.pendingLanes&-536870913,B=B!==0?B:B&536870912?536870912:0;if(B!==0){c=B;t:{var W=a;x=Rh;var ht=W.current.memoizedState.isDehydrated;if(ht&&(wu(W,B).flags|=256),B=K1(W,B,!1),B!==2){if(H1&&!ht){W.errorRecoveryDisabledLanes|=A,ac|=A,x=4;break t}A=Fi,Fi=x,A!==null&&(Fi===null?Fi=A:Fi.push.apply(Fi,A))}x=B}if(A=!1,x!==2)continue}}if(x===1){wu(a,0),ul(a,c,0,!0);break}t:{switch(m=a,A=x,A){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:ul(m,c,ws,!al);break t;case 2:Fi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(x=G1+300-q(),10<x)){if(ul(m,c,ws,!al),kn(m,0,!0)!==0)break t;m.timeoutHandle=FE(cE.bind(null,m,f,Fi,bp,$1,c,ws,ac,bu,al,A,2,-0,0),x);break t}cE(m,f,Fi,bp,$1,c,ws,ac,bu,al,A,0,-0,0)}}break}while(!0);Aa(a)}function cE(a,c,f,m,x,A,B,W,ht,Mt,$t,Kt,Ft,Ut){if(a.timeoutHandle=-1,Kt=c.subtreeFlags,(Kt&8192||(Kt&16785408)===16785408)&&(Bh={stylesheets:null,count:0,unsuspend:lN},nE(c),Kt=uN(),Kt!==null)){a.cancelPendingCommit=Kt(mE.bind(null,a,c,A,f,m,x,B,W,ht,$t,1,Ft,Ut)),ul(a,A,B,!Mt);return}mE(a,c,A,f,m,x,B,W,ht)}function CR(a){for(var c=a;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var m=0;m<f.length;m++){var x=f[m],A=x.getSnapshot;x=x.value;try{if(!$r(A(),x))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ul(a,c,f,m){c&=~j1,c&=~ac,a.suspendedLanes|=c,a.pingedLanes&=~c,m&&(a.warmLanes|=c),m=a.expirationTimes;for(var x=c;0<x;){var A=31-ze(x),B=1<<A;m[A]=-1,x&=~B}f!==0&&Pl(a,f,c)}function xp(){return(pn&6)===0?(kh(0),!1):!0}function Y1(){if(We!==null){if(gn===0)var a=We.return;else a=We,Ys=oo=null,xs(a),gu=null,Eh=0,a=We;for(;a!==null;)jx(a.alternate,a),a=a.return;We=null}}function wu(a,c){var f=a.timeoutHandle;f!==-1&&(a.timeoutHandle=-1,VR(f)),f=a.cancelPendingCommit,f!==null&&(a.cancelPendingCommit=null,f()),Y1(),On=a,We=f=Gs(a.current,null),tn=c,gn=0,Zi=null,al=!1,yu=ai(a,c),H1=!1,bu=ws=j1=ac=ol=Gn=0,Fi=Rh=null,$1=!1,(c&8)!==0&&(c|=c&32);var m=a.entangledLanes;if(m!==0)for(a=a.entanglements,m&=c;0<m;){var x=31-ze(m),A=1<<x;c|=a[x],m&=~A}return bo=c,nu(),f}function uE(a,c){ce=null,Q.H=lp,c===tl||c===ho?(c=k(),gn=3):c===nc?(c=k(),gn=4):gn=c===Dx?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,Zi=c,We===null&&(Gn=1,dp(a,hi(c,a.current)))}function fE(){var a=Q.H;return Q.H=lp,a===null?lp:a}function hE(){var a=Q.A;return Q.A=SR,a}function q1(){Gn=4,al||(tn&4194048)!==tn&&Es.current!==null||(yu=!0),(ol&134217727)===0&&(ac&134217727)===0||On===null||ul(On,tn,ws,!1)}function K1(a,c,f){var m=pn;pn|=2;var x=fE(),A=hE();(On!==a||tn!==c)&&(bp=null,wu(a,c)),c=!1;var B=Gn;t:do try{if(gn!==0&&We!==null){var W=We,ht=Zi;switch(gn){case 8:Y1(),B=6;break t;case 3:case 2:case 9:case 6:Es.current===null&&(c=!0);var Mt=gn;if(gn=0,Zi=null,Au(a,W,ht,Mt),f&&yu){B=0;break t}break;default:Mt=gn,gn=0,Zi=null,Au(a,W,ht,Mt)}}DR(),B=Gn;break}catch($t){uE(a,$t)}while(!0);return c&&a.shellSuspendCounter++,Ys=oo=null,pn=m,Q.H=x,Q.A=A,We===null&&(On=null,tn=0,nu()),B}function DR(){for(;We!==null;)dE(We)}function OR(a,c){var f=pn;pn|=2;var m=fE(),x=hE();On!==a||tn!==c?(bp=null,yp=q()+500,wu(a,c)):yu=ai(a,c);t:do try{if(gn!==0&&We!==null){c=We;var A=Zi;e:switch(gn){case 1:gn=0,Zi=null,Au(a,c,A,1);break;case 2:case 9:if(tp(A)){gn=0,Zi=null,pE(c);break}c=function(){gn!==2&&gn!==9||On!==a||(gn=7),Aa(a)},A.then(c,c);break t;case 3:gn=7;break t;case 4:gn=5;break t;case 7:tp(A)?(gn=0,Zi=null,pE(c)):(gn=0,Zi=null,Au(a,c,A,7));break;case 5:var B=null;switch(We.tag){case 26:B=We.memoizedState;case 5:case 27:var W=We;if(!B||qE(B)){gn=0,Zi=null;var ht=W.sibling;if(ht!==null)We=ht;else{var Mt=W.return;Mt!==null?(We=Mt,Ep(Mt)):We=null}break e}}gn=0,Zi=null,Au(a,c,A,5);break;case 6:gn=0,Zi=null,Au(a,c,A,6);break;case 8:Y1(),Gn=6;break t;default:throw Error(r(462))}}RR();break}catch($t){uE(a,$t)}while(!0);return Ys=oo=null,Q.H=m,Q.A=x,pn=f,We!==null?0:(On=null,tn=0,nu(),Gn)}function RR(){for(;We!==null&&!dt();)dE(We)}function dE(a){var c=zx(a.alternate,a,bo);a.memoizedProps=a.pendingProps,c===null?Ep(a):We=c}function pE(a){var c=a,f=c.alternate;switch(c.tag){case 15:case 0:c=Mx(f,c,c.pendingProps,c.type,void 0,tn);break;case 11:c=Mx(f,c,c.pendingProps,c.type.render,c.ref,tn);break;case 5:xs(c);default:jx(f,c),c=We=X0(c,bo),c=zx(f,c,bo)}a.memoizedProps=a.pendingProps,c===null?Ep(a):We=c}function Au(a,c,f,m){Ys=oo=null,xs(c),gu=null,Eh=0;var x=c.return;try{if(yR(a,x,c,f,tn)){Gn=1,dp(a,hi(f,a.current)),We=null;return}}catch(A){if(x!==null)throw We=x,A;Gn=1,dp(a,hi(f,a.current)),We=null;return}c.flags&32768?(sn||m===1?a=!0:yu||(tn&536870912)!==0?a=!1:(al=a=!0,(m===2||m===9||m===3||m===6)&&(m=Es.current,m!==null&&m.tag===13&&(m.flags|=16384))),gE(c,a)):Ep(c)}function Ep(a){var c=a;do{if((c.flags&32768)!==0){gE(c,al);return}a=c.return;var f=xR(c.alternate,c,bo);if(f!==null){We=f;return}if(c=c.sibling,c!==null){We=c;return}We=c=a}while(c!==null);Gn===0&&(Gn=5)}function gE(a,c){do{var f=ER(a.alternate,a);if(f!==null){f.flags&=32767,We=f;return}if(f=a.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(a=a.sibling,a!==null)){We=a;return}We=a=f}while(a!==null);Gn=6,We=null}function mE(a,c,f,m,x,A,B,W,ht){a.cancelPendingCommit=null;do wp();while(Lr!==0);if((pn&6)!==0)throw Error(r(327));if(c!==null){if(c===a.current)throw Error(r(177));if(A=c.lanes|c.childLanes,A|=Yf,Ci(a,f,A,B,W,ht),a===On&&(We=On=null,tn=0),xu=c,cl=a,Eu=f,V1=A,W1=x,aE=m,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,MR(zt,function(){return xE(),null})):(a.callbackNode=null,a.callbackPriority=0),m=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||m){m=Q.T,Q.T=null,x=Y.p,Y.p=2,B=pn,pn|=4;try{wR(a,c,f)}finally{pn=B,Y.p=x,Q.T=m}}Lr=1,vE(),_E(),yE()}}function vE(){if(Lr===1){Lr=0;var a=cl,c=xu,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=Q.T,Q.T=null;var m=Y.p;Y.p=2;var x=pn;pn|=4;try{Jx(c,a);var A=lv,B=Hf(a.containerInfo),W=A.focusedElem,ht=A.selectionRange;if(B!==W&&W&&W.ownerDocument&&H0(W.ownerDocument.documentElement,W)){if(ht!==null&&eu(W)){var Mt=ht.start,$t=ht.end;if($t===void 0&&($t=Mt),"selectionStart"in W)W.selectionStart=Mt,W.selectionEnd=Math.min($t,W.value.length);else{var Kt=W.ownerDocument||document,Ft=Kt&&Kt.defaultView||window;if(Ft.getSelection){var Ut=Ft.getSelection(),Me=W.textContent.length,Ce=Math.min(ht.start,Me),xn=ht.end===void 0?Ce:Math.min(ht.end,Me);!Ut.extend&&Ce>xn&&(B=xn,xn=Ce,Ce=B);var St=z0(W,Ce),mt=z0(W,xn);if(St&&mt&&(Ut.rangeCount!==1||Ut.anchorNode!==St.node||Ut.anchorOffset!==St.offset||Ut.focusNode!==mt.node||Ut.focusOffset!==mt.offset)){var Nt=Kt.createRange();Nt.setStart(St.node,St.offset),Ut.removeAllRanges(),Ce>xn?(Ut.addRange(Nt),Ut.extend(mt.node,mt.offset)):(Nt.setEnd(mt.node,mt.offset),Ut.addRange(Nt))}}}}for(Kt=[],Ut=W;Ut=Ut.parentNode;)Ut.nodeType===1&&Kt.push({element:Ut,left:Ut.scrollLeft,top:Ut.scrollTop});for(typeof W.focus=="function"&&W.focus(),W=0;W<Kt.length;W++){var Xt=Kt[W];Xt.element.scrollLeft=Xt.left,Xt.element.scrollTop=Xt.top}}Ip=!!ov,lv=ov=null}finally{pn=x,Y.p=m,Q.T=f}}a.current=c,Lr=2}}function _E(){if(Lr===2){Lr=0;var a=cl,c=xu,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=Q.T,Q.T=null;var m=Y.p;Y.p=2;var x=pn;pn|=4;try{qx(a,c.alternate,c)}finally{pn=x,Y.p=m,Q.T=f}}Lr=3}}function yE(){if(Lr===4||Lr===3){Lr=0,it();var a=cl,c=xu,f=Eu,m=aE;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Lr=5:(Lr=0,xu=cl=null,bE(a,a.pendingLanes));var x=a.pendingLanes;if(x===0&&(ll=null),Bl(f),c=c.stateNode,de&&typeof de.onCommitFiberRoot=="function")try{de.onCommitFiberRoot(se,c,void 0,(c.current.flags&128)===128)}catch{}if(m!==null){c=Q.T,x=Y.p,Y.p=2,Q.T=null;try{for(var A=a.onRecoverableError,B=0;B<m.length;B++){var W=m[B];A(W.value,{componentStack:W.stack})}}finally{Q.T=c,Y.p=x}}(Eu&3)!==0&&wp(),Aa(a),x=a.pendingLanes,(f&4194090)!==0&&(x&42)!==0?a===X1?Nh++:(Nh=0,X1=a):Nh=0,kh(0)}}function bE(a,c){(a.pooledCacheLanes&=c)===0&&(c=a.pooledCache,c!=null&&(a.pooledCache=null,Jo(c)))}function wp(a){return vE(),_E(),yE(),xE()}function xE(){if(Lr!==5)return!1;var a=cl,c=V1;V1=0;var f=Bl(Eu),m=Q.T,x=Y.p;try{Y.p=32>f?32:f,Q.T=null,f=W1,W1=null;var A=cl,B=Eu;if(Lr=0,xu=cl=null,Eu=0,(pn&6)!==0)throw Error(r(331));var W=pn;if(pn|=4,iE(A.current),eE(A,A.current,B,f),pn=W,kh(0,!1),de&&typeof de.onPostCommitFiberRoot=="function")try{de.onPostCommitFiberRoot(se,A)}catch{}return!0}finally{Y.p=x,Q.T=m,bE(a,c)}}function EE(a,c,f){c=hi(f,c),c=S1(a.stateNode,c,2),a=ne(a,c,2),a!==null&&(br(a,2),Aa(a))}function Sn(a,c,f){if(a.tag===3)EE(a,a,f);else for(;c!==null;){if(c.tag===3){EE(c,a,f);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ll===null||!ll.has(m))){a=hi(f,a),f=Tx(2),m=ne(c,f,2),m!==null&&(Cx(f,m,c,a),br(m,2),Aa(m));break}}c=c.return}}function Z1(a,c,f){var m=a.pingCache;if(m===null){m=a.pingCache=new TR;var x=new Set;m.set(c,x)}else x=m.get(c),x===void 0&&(x=new Set,m.set(c,x));x.has(f)||(H1=!0,x.add(f),a=NR.bind(null,a,c,f),c.then(a,a))}function NR(a,c,f){var m=a.pingCache;m!==null&&m.delete(c),a.pingedLanes|=a.suspendedLanes&f,a.warmLanes&=~f,On===a&&(tn&f)===f&&(Gn===4||Gn===3&&(tn&62914560)===tn&&300>q()-G1?(pn&2)===0&&wu(a,0):j1|=f,bu===tn&&(bu=0)),Aa(a)}function wE(a,c){c===0&&(c=Ga()),a=Gr(a,c),a!==null&&(br(a,c),Aa(a))}function kR(a){var c=a.memoizedState,f=0;c!==null&&(f=c.retryLane),wE(a,f)}function LR(a,c){var f=0;switch(a.tag){case 13:var m=a.stateNode,x=a.memoizedState;x!==null&&(f=x.retryLane);break;case 19:m=a.stateNode;break;case 22:m=a.stateNode._retryCache;break;default:throw Error(r(314))}m!==null&&m.delete(c),wE(a,f)}function MR(a,c){return Lt(a,c)}var Ap=null,Su=null,Q1=!1,Sp=!1,J1=!1,oc=0;function Aa(a){a!==Su&&a.next===null&&(Su===null?Ap=Su=a:Su=Su.next=a),Sp=!0,Q1||(Q1=!0,PR())}function kh(a,c){if(!J1&&Sp){J1=!0;do for(var f=!1,m=Ap;m!==null;){if(a!==0){var x=m.pendingLanes;if(x===0)var A=0;else{var B=m.suspendedLanes,W=m.pingedLanes;A=(1<<31-ze(42|a)+1)-1,A&=x&~(B&~W),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(f=!0,CE(m,A))}else A=tn,A=kn(m,m===On?A:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(A&3)===0||ai(m,A)||(f=!0,CE(m,A));m=m.next}while(f);J1=!1}}function IR(){AE()}function AE(){Sp=Q1=!1;var a=0;oc!==0&&(GR()&&(a=oc),oc=0);for(var c=q(),f=null,m=Ap;m!==null;){var x=m.next,A=SE(m,c);A===0?(m.next=null,f===null?Ap=x:f.next=x,x===null&&(Su=f)):(f=m,(a!==0||(A&3)!==0)&&(Sp=!0)),m=x}kh(a)}function SE(a,c){for(var f=a.suspendedLanes,m=a.pingedLanes,x=a.expirationTimes,A=a.pendingLanes&-62914561;0<A;){var B=31-ze(A),W=1<<B,ht=x[B];ht===-1?((W&f)===0||(W&m)!==0)&&(x[B]=Fo(W,c)):ht<=c&&(a.expiredLanes|=W),A&=~W}if(c=On,f=tn,f=kn(a,a===c?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m=a.callbackNode,f===0||a===c&&(gn===2||gn===9)||a.cancelPendingCommit!==null)return m!==null&&m!==null&&D(m),a.callbackNode=null,a.callbackPriority=0;if((f&3)===0||ai(a,f)){if(c=f&-f,c===a.callbackPriority)return c;switch(m!==null&&D(m),Bl(f)){case 2:case 8:f=Pt;break;case 32:f=zt;break;case 268435456:f=Rt;break;default:f=zt}return m=TE.bind(null,a),f=Lt(f,m),a.callbackPriority=c,a.callbackNode=f,c}return m!==null&&m!==null&&D(m),a.callbackPriority=2,a.callbackNode=null,2}function TE(a,c){if(Lr!==0&&Lr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var f=a.callbackNode;if(wp()&&a.callbackNode!==f)return null;var m=tn;return m=kn(a,a===On?m:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),m===0?null:(lE(a,m,c),SE(a,q()),a.callbackNode!=null&&a.callbackNode===f?TE.bind(null,a):null)}function CE(a,c){if(wp())return null;lE(a,c,!0)}function PR(){WR(function(){(pn&6)!==0?Lt(ft,IR):AE()})}function tv(){return oc===0&&(oc=$a()),oc}function DE(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Xc(""+a)}function OE(a,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,a.id&&f.setAttribute("form",a.id),c.parentNode.insertBefore(f,c),a=new FormData(a),f.parentNode.removeChild(f),a}function FR(a,c,f,m,x){if(c==="submit"&&f&&f.stateNode===x){var A=DE((x[er]||null).action),B=m.submitter;B&&(c=(c=B[er]||null)?DE(c.formAction):B.getAttribute("formAction"),c!==null&&(A=c,B=null));var W=new zo("action","action",null,m,x);a.push({event:W,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(oc!==0){var ht=B?OE(x,B):new FormData(x);b1(f,{pending:!0,data:ht,method:x.method,action:A},null,ht)}}else typeof A=="function"&&(W.preventDefault(),ht=B?OE(x,B):new FormData(x),b1(f,{pending:!0,data:ht,method:x.method,action:A},A,ht))},currentTarget:x}]})}}for(var ev=0;ev<Xf.length;ev++){var nv=Xf[ev],BR=nv.toLowerCase(),UR=nv[0].toUpperCase()+nv.slice(1);Wi(BR,"on"+UR)}Wi(da,"onAnimationEnd"),Wi(ys,"onAnimationIteration"),Wi(Gf,"onAnimationStart"),Wi("dblclick","onDoubleClick"),Wi("focusin","onFocus"),Wi("focusout","onBlur"),Wi(p1,"onTransitionRun"),Wi(G0,"onTransitionStart"),Wi(V0,"onTransitionCancel"),Wi(Vf,"onTransitionEnd"),te("onMouseEnter",["mouseout","mouseover"]),te("onMouseLeave",["mouseout","mouseover"]),te("onPointerEnter",["pointerout","pointerover"]),te("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lh));function RE(a,c){c=(c&4)!==0;for(var f=0;f<a.length;f++){var m=a[f],x=m.event;m=m.listeners;t:{var A=void 0;if(c)for(var B=m.length-1;0<=B;B--){var W=m[B],ht=W.instance,Mt=W.currentTarget;if(W=W.listener,ht!==A&&x.isPropagationStopped())break t;A=W,x.currentTarget=Mt;try{A(x)}catch($t){hp($t)}x.currentTarget=null,A=ht}else for(B=0;B<m.length;B++){if(W=m[B],ht=W.instance,Mt=W.currentTarget,W=W.listener,ht!==A&&x.isPropagationStopped())break t;A=W,x.currentTarget=Mt;try{A(x)}catch($t){hp($t)}x.currentTarget=null,A=ht}}}}function Xe(a,c){var f=c[Ul];f===void 0&&(f=c[Ul]=new Set);var m=a+"__bubble";f.has(m)||(NE(c,a,2,!1),f.add(m))}function rv(a,c,f){var m=0;c&&(m|=4),NE(f,a,m,c)}var Tp="_reactListening"+Math.random().toString(36).slice(2);function iv(a){if(!a[Tp]){a[Tp]=!0,Tt.forEach(function(f){f!=="selectionchange"&&(zR.has(f)||rv(f,!1,a),rv(f,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Tp]||(c[Tp]=!0,rv("selectionchange",!1,c))}}function NE(a,c,f,m){switch(ew(c)){case 2:var x=dN;break;case 8:x=pN;break;default:x=_v}f=x.bind(null,c,f,a),x=void 0,!ua||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(x=!0),m?x!==void 0?a.addEventListener(c,f,{capture:!0,passive:x}):a.addEventListener(c,f,!0):x!==void 0?a.addEventListener(c,f,{passive:x}):a.addEventListener(c,f,!1)}function sv(a,c,f,m,x){var A=m;if((c&1)===0&&(c&2)===0&&m!==null)t:for(;;){if(m===null)return;var B=m.tag;if(B===3||B===4){var W=m.stateNode.containerInfo;if(W===x)break;if(B===4)for(B=m.return;B!==null;){var ht=B.tag;if((ht===3||ht===4)&&B.stateNode.containerInfo===x)return;B=B.return}for(;W!==null;){if(B=nt(W),B===null)return;if(ht=B.tag,ht===5||ht===6||ht===26||ht===27){m=A=B;continue t}W=W.parentNode}}m=m.return}kf(function(){var Mt=A,$t=Bo(f),Kt=[];t:{var Ft=Wf.get(a);if(Ft!==void 0){var Ut=zo,Me=a;switch(a){case"keypress":if(Kc(f)===0)break t;case"keydown":case"keyup":Ut=w0;break;case"focusin":Me="focus",Ut=Zc;break;case"focusout":Me="blur",Ut=Zc;break;case"beforeblur":case"afterblur":Ut=Zc;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ut=Qa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ut=g0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ut=i1;break;case da:case ys:case Gf:Ut=_0;break;case Vf:Ut=s1;break;case"scroll":case"scrollend":Ut=p0;break;case"wheel":Ut=o1;break;case"copy":case"cut":case"paste":Ut=y0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ut=fa;break;case"toggle":case"beforetoggle":Ut=T0}var Ce=(c&4)!==0,xn=!Ce&&(a==="scroll"||a==="scrollend"),St=Ce?Ft!==null?Ft+"Capture":null:Ft;Ce=[];for(var mt=Mt,Nt;mt!==null;){var Xt=mt;if(Nt=Xt.stateNode,Xt=Xt.tag,Xt!==5&&Xt!==26&&Xt!==27||Nt===null||St===null||(Xt=Uo(mt,St),Xt!=null&&Ce.push(Mh(mt,Xt,Nt))),xn)break;mt=mt.return}0<Ce.length&&(Ft=new Ut(Ft,Me,null,f,$t),Kt.push({event:Ft,listeners:Ce}))}}if((c&7)===0){t:{if(Ft=a==="mouseover"||a==="pointerover",Ut=a==="mouseout"||a==="pointerout",Ft&&f!==gs&&(Me=f.relatedTarget||f.fromElement)&&(nt(Me)||Me[oa]))break t;if((Ut||Ft)&&(Ft=$t.window===$t?$t:(Ft=$t.ownerDocument)?Ft.defaultView||Ft.parentWindow:window,Ut?(Me=f.relatedTarget||f.toElement,Ut=Mt,Me=Me?nt(Me):null,Me!==null&&(xn=s(Me),Ce=Me.tag,Me!==xn||Ce!==5&&Ce!==27&&Ce!==6)&&(Me=null)):(Ut=null,Me=Mt),Ut!==Me)){if(Ce=Qa,Xt="onMouseLeave",St="onMouseEnter",mt="mouse",(a==="pointerout"||a==="pointerover")&&(Ce=fa,Xt="onPointerLeave",St="onPointerEnter",mt="pointer"),xn=Ut==null?Ft:kt(Ut),Nt=Me==null?Ft:kt(Me),Ft=new Ce(Xt,mt+"leave",Ut,f,$t),Ft.target=xn,Ft.relatedTarget=Nt,Xt=null,nt($t)===Mt&&(Ce=new Ce(St,mt+"enter",Me,f,$t),Ce.target=Nt,Ce.relatedTarget=xn,Xt=Ce),xn=Xt,Ut&&Me)e:{for(Ce=Ut,St=Me,mt=0,Nt=Ce;Nt;Nt=Tu(Nt))mt++;for(Nt=0,Xt=St;Xt;Xt=Tu(Xt))Nt++;for(;0<mt-Nt;)Ce=Tu(Ce),mt--;for(;0<Nt-mt;)St=Tu(St),Nt--;for(;mt--;){if(Ce===St||St!==null&&Ce===St.alternate)break e;Ce=Tu(Ce),St=Tu(St)}Ce=null}else Ce=null;Ut!==null&&kE(Kt,Ft,Ut,Ce,!1),Me!==null&&xn!==null&&kE(Kt,xn,Me,Ce,!0)}}t:{if(Ft=Mt?kt(Mt):window,Ut=Ft.nodeName&&Ft.nodeName.toLowerCase(),Ut==="select"||Ut==="input"&&Ft.type==="file")var pe=M0;else if(k0(Ft))if(Bf)pe=U0;else{pe=F0;var Ve=h1}else Ut=Ft.nodeName,!Ut||Ut.toLowerCase()!=="input"||Ft.type!=="checkbox"&&Ft.type!=="radio"?Mt&&$l(Mt.elementType)&&(pe=M0):pe=B0;if(pe&&(pe=pe(a,Mt))){Ri(Kt,pe,f,$t);break t}Ve&&Ve(a,Ft,Mt),a==="focusout"&&Mt&&Ft.type==="number"&&Mt.memoizedProps.value!=null&&Hl(Ft,"number",Ft.value)}switch(Ve=Mt?kt(Mt):window,a){case"focusin":(k0(Ve)||Ve.contentEditable==="true")&&(Wo=Ve,jf=Mt,ql=null);break;case"focusout":ql=jf=Wo=null;break;case"mousedown":$f=!0;break;case"contextmenu":case"mouseup":case"dragend":$f=!1,j0(Kt,f,$t);break;case"selectionchange":if(d1)break;case"keydown":case"keyup":j0(Kt,f,$t)}var _e;if(Ff)t:{switch(a){case"compositionstart":var De="onCompositionStart";break t;case"compositionend":De="onCompositionEnd";break t;case"compositionupdate":De="onCompositionUpdate";break t}De=void 0}else jo?R0(a,f)&&(De="onCompositionEnd"):a==="keydown"&&f.keyCode===229&&(De="onCompositionStart");De&&(D0&&f.locale!=="ko"&&(jo||De!=="onCompositionStart"?De==="onCompositionEnd"&&jo&&(_e=qc()):(js=$t,Vl="value"in js?js.value:js.textContent,jo=!0)),Ve=Cp(Mt,De),0<Ve.length&&(De=new b0(De,a,null,f,$t),Kt.push({event:De,listeners:Ve}),_e?De.data=_e:(_e=N0(f),_e!==null&&(De.data=_e)))),(_e=Ja?c1(a,f):u1(a,f))&&(De=Cp(Mt,"onBeforeInput"),0<De.length&&(Ve=new b0("onBeforeInput","beforeinput",null,f,$t),Kt.push({event:Ve,listeners:De}),Ve.data=_e)),FR(Kt,a,Mt,f,$t)}RE(Kt,c)})}function Mh(a,c,f){return{instance:a,listener:c,currentTarget:f}}function Cp(a,c){for(var f=c+"Capture",m=[];a!==null;){var x=a,A=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||A===null||(x=Uo(a,f),x!=null&&m.unshift(Mh(a,x,A)),x=Uo(a,c),x!=null&&m.push(Mh(a,x,A))),a.tag===3)return m;a=a.return}return[]}function Tu(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function kE(a,c,f,m,x){for(var A=c._reactName,B=[];f!==null&&f!==m;){var W=f,ht=W.alternate,Mt=W.stateNode;if(W=W.tag,ht!==null&&ht===m)break;W!==5&&W!==26&&W!==27||Mt===null||(ht=Mt,x?(Mt=Uo(f,A),Mt!=null&&B.unshift(Mh(f,Mt,ht))):x||(Mt=Uo(f,A),Mt!=null&&B.push(Mh(f,Mt,ht)))),f=f.return}B.length!==0&&a.push({event:c,listeners:B})}var HR=/\r\n?/g,jR=/\u0000|\uFFFD/g;function LE(a){return(typeof a=="string"?a:""+a).replace(HR,`
`).replace(jR,"")}function ME(a,c){return c=LE(c),LE(a)===c}function Dp(){}function bn(a,c,f,m,x,A){switch(f){case"children":typeof m=="string"?c==="body"||c==="textarea"&&m===""||Vi(a,m):(typeof m=="number"||typeof m=="bigint")&&c!=="body"&&Vi(a,""+m);break;case"className":Ze(a,"class",m);break;case"tabIndex":Ze(a,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Ze(a,f,m);break;case"style":Va(a,m,A);break;case"data":if(c!=="object"){Ze(a,"data",m);break}case"src":case"href":if(m===""&&(c!=="a"||f!=="href")){a.removeAttribute(f);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(f);break}m=Xc(""+m),a.setAttribute(f,m);break;case"action":case"formAction":if(typeof m=="function"){a.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(f==="formAction"?(c!=="input"&&bn(a,c,"name",x.name,x,null),bn(a,c,"formEncType",x.formEncType,x,null),bn(a,c,"formMethod",x.formMethod,x,null),bn(a,c,"formTarget",x.formTarget,x,null)):(bn(a,c,"encType",x.encType,x,null),bn(a,c,"method",x.method,x,null),bn(a,c,"target",x.target,x,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){a.removeAttribute(f);break}m=Xc(""+m),a.setAttribute(f,m);break;case"onClick":m!=null&&(a.onclick=Dp);break;case"onScroll":m!=null&&Xe("scroll",a);break;case"onScrollEnd":m!=null&&Xe("scrollend",a);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(f=m.__html,f!=null){if(x.children!=null)throw Error(r(60));a.innerHTML=f}}break;case"multiple":a.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":a.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){a.removeAttribute("xlink:href");break}f=Xc(""+m),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(f,""+m):a.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(f,""):a.removeAttribute(f);break;case"capture":case"download":m===!0?a.setAttribute(f,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?a.setAttribute(f,m):a.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?a.setAttribute(f,m):a.removeAttribute(f);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?a.removeAttribute(f):a.setAttribute(f,m);break;case"popover":Xe("beforetoggle",a),Xe("toggle",a),rn(a,"popover",m);break;case"xlinkActuate":fn(a,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":fn(a,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":fn(a,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":fn(a,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":fn(a,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":fn(a,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":fn(a,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":fn(a,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":fn(a,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":rn(a,"is",m);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=h0.get(f)||f,rn(a,f,m))}}function av(a,c,f,m,x,A){switch(f){case"style":Va(a,m,A);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(f=m.__html,f!=null){if(x.children!=null)throw Error(r(60));a.innerHTML=f}}break;case"children":typeof m=="string"?Vi(a,m):(typeof m=="number"||typeof m=="bigint")&&Vi(a,""+m);break;case"onScroll":m!=null&&Xe("scroll",a);break;case"onScrollEnd":m!=null&&Xe("scrollend",a);break;case"onClick":m!=null&&(a.onclick=Dp);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ct.hasOwnProperty(f))t:{if(f[0]==="o"&&f[1]==="n"&&(x=f.endsWith("Capture"),c=f.slice(2,x?f.length-7:void 0),A=a[er]||null,A=A!=null?A[f]:null,typeof A=="function"&&a.removeEventListener(c,A,x),typeof m=="function")){typeof A!="function"&&A!==null&&(f in a?a[f]=null:a.hasAttribute(f)&&a.removeAttribute(f)),a.addEventListener(c,m,x);break t}f in a?a[f]=m:m===!0?a.setAttribute(f,""):rn(a,f,m)}}}function Mr(a,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xe("error",a),Xe("load",a);var m=!1,x=!1,A;for(A in f)if(f.hasOwnProperty(A)){var B=f[A];if(B!=null)switch(A){case"src":m=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:bn(a,c,A,B,f,null)}}x&&bn(a,c,"srcSet",f.srcSet,f,null),m&&bn(a,c,"src",f.src,f,null);return;case"input":Xe("invalid",a);var W=A=B=x=null,ht=null,Mt=null;for(m in f)if(f.hasOwnProperty(m)){var $t=f[m];if($t!=null)switch(m){case"name":x=$t;break;case"type":B=$t;break;case"checked":ht=$t;break;case"defaultChecked":Mt=$t;break;case"value":A=$t;break;case"defaultValue":W=$t;break;case"children":case"dangerouslySetInnerHTML":if($t!=null)throw Error(r(137,c));break;default:bn(a,c,m,$t,f,null)}}Wc(a,A,W,ht,Mt,B,x,!1),zl(a);return;case"select":Xe("invalid",a),m=B=A=null;for(x in f)if(f.hasOwnProperty(x)&&(W=f[x],W!=null))switch(x){case"value":A=W;break;case"defaultValue":B=W;break;case"multiple":m=W;default:bn(a,c,x,W,f,null)}c=A,f=B,a.multiple=!!m,c!=null?Or(a,!!m,c,!1):f!=null&&Or(a,!!m,f,!0);return;case"textarea":Xe("invalid",a),A=x=m=null;for(B in f)if(f.hasOwnProperty(B)&&(W=f[B],W!=null))switch(B){case"value":m=W;break;case"defaultValue":x=W;break;case"children":A=W;break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(r(91));break;default:bn(a,c,B,W,f,null)}jl(a,m,x,A),zl(a);return;case"option":for(ht in f)if(f.hasOwnProperty(ht)&&(m=f[ht],m!=null))switch(ht){case"selected":a.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:bn(a,c,ht,m,f,null)}return;case"dialog":Xe("beforetoggle",a),Xe("toggle",a),Xe("cancel",a),Xe("close",a);break;case"iframe":case"object":Xe("load",a);break;case"video":case"audio":for(m=0;m<Lh.length;m++)Xe(Lh[m],a);break;case"image":Xe("error",a),Xe("load",a);break;case"details":Xe("toggle",a);break;case"embed":case"source":case"link":Xe("error",a),Xe("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Mt in f)if(f.hasOwnProperty(Mt)&&(m=f[Mt],m!=null))switch(Mt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:bn(a,c,Mt,m,f,null)}return;default:if($l(c)){for($t in f)f.hasOwnProperty($t)&&(m=f[$t],m!==void 0&&av(a,c,$t,m,f,void 0));return}}for(W in f)f.hasOwnProperty(W)&&(m=f[W],m!=null&&bn(a,c,W,m,f,null))}function $R(a,c,f,m){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,A=null,B=null,W=null,ht=null,Mt=null,$t=null;for(Ut in f){var Kt=f[Ut];if(f.hasOwnProperty(Ut)&&Kt!=null)switch(Ut){case"checked":break;case"value":break;case"defaultValue":ht=Kt;default:m.hasOwnProperty(Ut)||bn(a,c,Ut,null,m,Kt)}}for(var Ft in m){var Ut=m[Ft];if(Kt=f[Ft],m.hasOwnProperty(Ft)&&(Ut!=null||Kt!=null))switch(Ft){case"type":A=Ut;break;case"name":x=Ut;break;case"checked":Mt=Ut;break;case"defaultChecked":$t=Ut;break;case"value":B=Ut;break;case"defaultValue":W=Ut;break;case"children":case"dangerouslySetInnerHTML":if(Ut!=null)throw Error(r(137,c));break;default:Ut!==Kt&&bn(a,c,Ft,Ut,m,Kt)}}jr(a,B,W,ht,Mt,$t,A,x);return;case"select":Ut=B=W=Ft=null;for(A in f)if(ht=f[A],f.hasOwnProperty(A)&&ht!=null)switch(A){case"value":break;case"multiple":Ut=ht;default:m.hasOwnProperty(A)||bn(a,c,A,null,m,ht)}for(x in m)if(A=m[x],ht=f[x],m.hasOwnProperty(x)&&(A!=null||ht!=null))switch(x){case"value":Ft=A;break;case"defaultValue":W=A;break;case"multiple":B=A;default:A!==ht&&bn(a,c,x,A,m,ht)}c=W,f=B,m=Ut,Ft!=null?Or(a,!!f,Ft,!1):!!m!=!!f&&(c!=null?Or(a,!!f,c,!0):Or(a,!!f,f?[]:"",!1));return;case"textarea":Ut=Ft=null;for(W in f)if(x=f[W],f.hasOwnProperty(W)&&x!=null&&!m.hasOwnProperty(W))switch(W){case"value":break;case"children":break;default:bn(a,c,W,null,m,x)}for(B in m)if(x=m[B],A=f[B],m.hasOwnProperty(B)&&(x!=null||A!=null))switch(B){case"value":Ft=x;break;case"defaultValue":Ut=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==A&&bn(a,c,B,x,m,A)}ca(a,Ft,Ut);return;case"option":for(var Me in f)if(Ft=f[Me],f.hasOwnProperty(Me)&&Ft!=null&&!m.hasOwnProperty(Me))switch(Me){case"selected":a.selected=!1;break;default:bn(a,c,Me,null,m,Ft)}for(ht in m)if(Ft=m[ht],Ut=f[ht],m.hasOwnProperty(ht)&&Ft!==Ut&&(Ft!=null||Ut!=null))switch(ht){case"selected":a.selected=Ft&&typeof Ft!="function"&&typeof Ft!="symbol";break;default:bn(a,c,ht,Ft,m,Ut)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in f)Ft=f[Ce],f.hasOwnProperty(Ce)&&Ft!=null&&!m.hasOwnProperty(Ce)&&bn(a,c,Ce,null,m,Ft);for(Mt in m)if(Ft=m[Mt],Ut=f[Mt],m.hasOwnProperty(Mt)&&Ft!==Ut&&(Ft!=null||Ut!=null))switch(Mt){case"children":case"dangerouslySetInnerHTML":if(Ft!=null)throw Error(r(137,c));break;default:bn(a,c,Mt,Ft,m,Ut)}return;default:if($l(c)){for(var xn in f)Ft=f[xn],f.hasOwnProperty(xn)&&Ft!==void 0&&!m.hasOwnProperty(xn)&&av(a,c,xn,void 0,m,Ft);for($t in m)Ft=m[$t],Ut=f[$t],!m.hasOwnProperty($t)||Ft===Ut||Ft===void 0&&Ut===void 0||av(a,c,$t,Ft,m,Ut);return}}for(var St in f)Ft=f[St],f.hasOwnProperty(St)&&Ft!=null&&!m.hasOwnProperty(St)&&bn(a,c,St,null,m,Ft);for(Kt in m)Ft=m[Kt],Ut=f[Kt],!m.hasOwnProperty(Kt)||Ft===Ut||Ft==null&&Ut==null||bn(a,c,Kt,Ft,m,Ut)}var ov=null,lv=null;function Op(a){return a.nodeType===9?a:a.ownerDocument}function IE(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function PE(a,c){if(a===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&c==="foreignObject"?0:a}function cv(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var uv=null;function GR(){var a=window.event;return a&&a.type==="popstate"?a===uv?!1:(uv=a,!0):(uv=null,!1)}var FE=typeof setTimeout=="function"?setTimeout:void 0,VR=typeof clearTimeout=="function"?clearTimeout:void 0,BE=typeof Promise=="function"?Promise:void 0,WR=typeof queueMicrotask=="function"?queueMicrotask:typeof BE<"u"?function(a){return BE.resolve(null).then(a).catch(XR)}:FE;function XR(a){setTimeout(function(){throw a})}function fl(a){return a==="head"}function UE(a,c){var f=c,m=0,x=0;do{var A=f.nextSibling;if(a.removeChild(f),A&&A.nodeType===8)if(f=A.data,f==="/$"){if(0<m&&8>m){f=m;var B=a.ownerDocument;if(f&1&&Ih(B.documentElement),f&2&&Ih(B.body),f&4)for(f=B.head,Ih(f),B=f.firstChild;B;){var W=B.nextSibling,ht=B.nodeName;B[Z]||ht==="SCRIPT"||ht==="STYLE"||ht==="LINK"&&B.rel.toLowerCase()==="stylesheet"||f.removeChild(B),B=W}}if(x===0){a.removeChild(A),$h(c);return}x--}else f==="$"||f==="$?"||f==="$!"?x++:m=f.charCodeAt(0)-48;else m=0;f=A}while(f);$h(c)}function fv(a){var c=a.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":fv(f),tt(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}a.removeChild(f)}}function YR(a,c,f,m){for(;a.nodeType===1;){var x=f;if(a.nodeName.toLowerCase()!==c.toLowerCase()){if(!m&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(m){if(!a[Z])switch(c){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(A=a.getAttribute("rel"),A==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(A!==x.rel||a.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(A=a.getAttribute("src"),(A!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&A&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(c==="input"&&a.type==="hidden"){var A=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===A)return a}else return a;if(a=Zs(a.nextSibling),a===null)break}return null}function qR(a,c,f){if(c==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!f||(a=Zs(a.nextSibling),a===null))return null;return a}function hv(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function KR(a,c){var f=a.ownerDocument;if(a.data!=="$?"||f.readyState==="complete")c();else{var m=function(){c(),f.removeEventListener("DOMContentLoaded",m)};f.addEventListener("DOMContentLoaded",m),a._reactRetry=m}}function Zs(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return a}var dv=null;function zE(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var f=a.data;if(f==="$"||f==="$!"||f==="$?"){if(c===0)return a;c--}else f==="/$"&&c++}a=a.previousSibling}return null}function HE(a,c,f){switch(c=Op(f),a){case"html":if(a=c.documentElement,!a)throw Error(r(452));return a;case"head":if(a=c.head,!a)throw Error(r(453));return a;case"body":if(a=c.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}function Ih(a){for(var c=a.attributes;c.length;)a.removeAttributeNode(c[0]);tt(a)}var As=new Map,jE=new Set;function Rp(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var xo=Y.d;Y.d={f:ZR,r:QR,D:JR,C:tN,L:eN,m:nN,X:iN,S:rN,M:sN};function ZR(){var a=xo.f(),c=xp();return a||c}function QR(a){var c=at(a);c!==null&&c.tag===5&&c.type==="form"?lx(c):xo.r(a)}var Cu=typeof document>"u"?null:document;function $E(a,c,f){var m=Cu;if(m&&typeof c=="string"&&c){var x=nr(c);x='link[rel="'+a+'"][href="'+x+'"]',typeof f=="string"&&(x+='[crossorigin="'+f+'"]'),jE.has(x)||(jE.add(x),a={rel:a,crossOrigin:f,href:c},m.querySelector(x)===null&&(c=m.createElement("link"),Mr(c,"link",a),yt(c),m.head.appendChild(c)))}}function JR(a){xo.D(a),$E("dns-prefetch",a,null)}function tN(a,c){xo.C(a,c),$E("preconnect",a,c)}function eN(a,c,f){xo.L(a,c,f);var m=Cu;if(m&&a&&c){var x='link[rel="preload"][as="'+nr(c)+'"]';c==="image"&&f&&f.imageSrcSet?(x+='[imagesrcset="'+nr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(x+='[imagesizes="'+nr(f.imageSizes)+'"]')):x+='[href="'+nr(a)+'"]';var A=x;switch(c){case"style":A=Du(a);break;case"script":A=Ou(a)}As.has(A)||(a=d({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:a,as:c},f),As.set(A,a),m.querySelector(x)!==null||c==="style"&&m.querySelector(Ph(A))||c==="script"&&m.querySelector(Fh(A))||(c=m.createElement("link"),Mr(c,"link",a),yt(c),m.head.appendChild(c)))}}function nN(a,c){xo.m(a,c);var f=Cu;if(f&&a){var m=c&&typeof c.as=="string"?c.as:"script",x='link[rel="modulepreload"][as="'+nr(m)+'"][href="'+nr(a)+'"]',A=x;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Ou(a)}if(!As.has(A)&&(a=d({rel:"modulepreload",href:a},c),As.set(A,a),f.querySelector(x)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Fh(A)))return}m=f.createElement("link"),Mr(m,"link",a),yt(m),f.head.appendChild(m)}}}function rN(a,c,f){xo.S(a,c,f);var m=Cu;if(m&&a){var x=Ht(m).hoistableStyles,A=Du(a);c=c||"default";var B=x.get(A);if(!B){var W={loading:0,preload:null};if(B=m.querySelector(Ph(A)))W.loading=5;else{a=d({rel:"stylesheet",href:a,"data-precedence":c},f),(f=As.get(A))&&pv(a,f);var ht=B=m.createElement("link");yt(ht),Mr(ht,"link",a),ht._p=new Promise(function(Mt,$t){ht.onload=Mt,ht.onerror=$t}),ht.addEventListener("load",function(){W.loading|=1}),ht.addEventListener("error",function(){W.loading|=2}),W.loading|=4,Np(B,c,m)}B={type:"stylesheet",instance:B,count:1,state:W},x.set(A,B)}}}function iN(a,c){xo.X(a,c);var f=Cu;if(f&&a){var m=Ht(f).hoistableScripts,x=Ou(a),A=m.get(x);A||(A=f.querySelector(Fh(x)),A||(a=d({src:a,async:!0},c),(c=As.get(x))&&gv(a,c),A=f.createElement("script"),yt(A),Mr(A,"link",a),f.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},m.set(x,A))}}function sN(a,c){xo.M(a,c);var f=Cu;if(f&&a){var m=Ht(f).hoistableScripts,x=Ou(a),A=m.get(x);A||(A=f.querySelector(Fh(x)),A||(a=d({src:a,async:!0,type:"module"},c),(c=As.get(x))&&gv(a,c),A=f.createElement("script"),yt(A),Mr(A,"link",a),f.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},m.set(x,A))}}function GE(a,c,f,m){var x=(x=Bt.current)?Rp(x):null;if(!x)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=Du(f.href),f=Ht(x).hoistableStyles,m=f.get(c),m||(m={type:"style",instance:null,count:0,state:null},f.set(c,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){a=Du(f.href);var A=Ht(x).hoistableStyles,B=A.get(a);if(B||(x=x.ownerDocument||x,B={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(a,B),(A=x.querySelector(Ph(a)))&&!A._p&&(B.instance=A,B.state.loading=5),As.has(a)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},As.set(a,f),A||aN(x,a,f,B.state))),c&&m===null)throw Error(r(528,""));return B}if(c&&m!==null)throw Error(r(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Ou(f),f=Ht(x).hoistableScripts,m=f.get(c),m||(m={type:"script",instance:null,count:0,state:null},f.set(c,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function Du(a){return'href="'+nr(a)+'"'}function Ph(a){return'link[rel="stylesheet"]['+a+"]"}function VE(a){return d({},a,{"data-precedence":a.precedence,precedence:null})}function aN(a,c,f,m){a.querySelector('link[rel="preload"][as="style"]['+c+"]")?m.loading=1:(c=a.createElement("link"),m.preload=c,c.addEventListener("load",function(){return m.loading|=1}),c.addEventListener("error",function(){return m.loading|=2}),Mr(c,"link",f),yt(c),a.head.appendChild(c))}function Ou(a){return'[src="'+nr(a)+'"]'}function Fh(a){return"script[async]"+a}function WE(a,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var m=a.querySelector('style[data-href~="'+nr(f.href)+'"]');if(m)return c.instance=m,yt(m),m;var x=d({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return m=(a.ownerDocument||a).createElement("style"),yt(m),Mr(m,"style",x),Np(m,f.precedence,a),c.instance=m;case"stylesheet":x=Du(f.href);var A=a.querySelector(Ph(x));if(A)return c.state.loading|=4,c.instance=A,yt(A),A;m=VE(f),(x=As.get(x))&&pv(m,x),A=(a.ownerDocument||a).createElement("link"),yt(A);var B=A;return B._p=new Promise(function(W,ht){B.onload=W,B.onerror=ht}),Mr(A,"link",m),c.state.loading|=4,Np(A,f.precedence,a),c.instance=A;case"script":return A=Ou(f.src),(x=a.querySelector(Fh(A)))?(c.instance=x,yt(x),x):(m=f,(x=As.get(A))&&(m=d({},f),gv(m,x)),a=a.ownerDocument||a,x=a.createElement("script"),yt(x),Mr(x,"link",m),a.head.appendChild(x),c.instance=x);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(m=c.instance,c.state.loading|=4,Np(m,f.precedence,a));return c.instance}function Np(a,c,f){for(var m=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=m.length?m[m.length-1]:null,A=x,B=0;B<m.length;B++){var W=m[B];if(W.dataset.precedence===c)A=W;else if(A!==x)break}A?A.parentNode.insertBefore(a,A.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(a,c.firstChild))}function pv(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.title==null&&(a.title=c.title)}function gv(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.integrity==null&&(a.integrity=c.integrity)}var kp=null;function XE(a,c,f){if(kp===null){var m=new Map,x=kp=new Map;x.set(f,m)}else x=kp,m=x.get(f),m||(m=new Map,x.set(f,m));if(m.has(a))return m;for(m.set(a,null),f=f.getElementsByTagName(a),x=0;x<f.length;x++){var A=f[x];if(!(A[Z]||A[tr]||a==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var B=A.getAttribute(c)||"";B=a+B;var W=m.get(B);W?W.push(A):m.set(B,[A])}}return m}function YE(a,c,f){a=a.ownerDocument||a,a.head.insertBefore(f,c==="title"?a.querySelector("head > title"):null)}function oN(a,c,f){if(f===1||c.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return a=c.disabled,typeof c.precedence=="string"&&a==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function qE(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var Bh=null;function lN(){}function cN(a,c,f){if(Bh===null)throw Error(r(475));var m=Bh;if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var x=Du(f.href),A=a.querySelector(Ph(x));if(A){a=A._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(m.count++,m=Lp.bind(m),a.then(m,m)),c.state.loading|=4,c.instance=A,yt(A);return}A=a.ownerDocument||a,f=VE(f),(x=As.get(x))&&pv(f,x),A=A.createElement("link"),yt(A);var B=A;B._p=new Promise(function(W,ht){B.onload=W,B.onerror=ht}),Mr(A,"link",f),c.instance=A}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(m.count++,c=Lp.bind(m),a.addEventListener("load",c),a.addEventListener("error",c))}}function uN(){if(Bh===null)throw Error(r(475));var a=Bh;return a.stylesheets&&a.count===0&&mv(a,a.stylesheets),0<a.count?function(c){var f=setTimeout(function(){if(a.stylesheets&&mv(a,a.stylesheets),a.unsuspend){var m=a.unsuspend;a.unsuspend=null,m()}},6e4);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(f)}}:null}function Lp(){if(this.count--,this.count===0){if(this.stylesheets)mv(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Mp=null;function mv(a,c){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Mp=new Map,c.forEach(fN,a),Mp=null,Lp.call(a))}function fN(a,c){if(!(c.state.loading&4)){var f=Mp.get(a);if(f)var m=f.get(null);else{f=new Map,Mp.set(a,f);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<x.length;A++){var B=x[A];(B.nodeName==="LINK"||B.getAttribute("media")!=="not all")&&(f.set(B.dataset.precedence,B),m=B)}m&&f.set(null,m)}x=c.instance,B=x.getAttribute("data-precedence"),A=f.get(B)||m,A===m&&f.set(null,x),f.set(B,x),this.count++,m=Lp.bind(this),x.addEventListener("load",m),x.addEventListener("error",m),A?A.parentNode.insertBefore(x,A.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),c.state.loading|=4}}var Uh={$$typeof:T,Provider:null,Consumer:null,_currentValue:Ot,_currentValue2:Ot,_threadCount:0};function hN(a,c,f,m,x,A,B,W){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zs(0),this.hiddenUpdates=zs(null),this.identifierPrefix=m,this.onUncaughtError=x,this.onCaughtError=A,this.onRecoverableError=B,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function KE(a,c,f,m,x,A,B,W,ht,Mt,$t,Kt){return a=new hN(a,c,f,B,W,ht,Mt,Kt),c=1,A===!0&&(c|=24),A=pi(3,null,null,c),a.current=A,A.stateNode=a,c=ec(),c.refCount++,a.pooledCache=c,c.refCount++,A.memoizedState={element:m,isDehydrated:f,cache:c},wt(A),a}function ZE(a){return a?(a=Yo,a):Yo}function QE(a,c,f,m,x,A){x=ZE(x),m.context===null?m.context=x:m.pendingContext=x,m=Wt(c),m.payload={element:f},A=A===void 0?null:A,A!==null&&(m.callback=A),f=ne(a,m,c),f!==null&&(Ji(f,a,c),ue(f,a,c))}function JE(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var f=a.retryLane;a.retryLane=f!==0&&f<c?f:c}}function vv(a,c){JE(a,c),(a=a.alternate)&&JE(a,c)}function tw(a){if(a.tag===13){var c=Gr(a,67108864);c!==null&&Ji(c,a,67108864),vv(a,67108864)}}var Ip=!0;function dN(a,c,f,m){var x=Q.T;Q.T=null;var A=Y.p;try{Y.p=2,_v(a,c,f,m)}finally{Y.p=A,Q.T=x}}function pN(a,c,f,m){var x=Q.T;Q.T=null;var A=Y.p;try{Y.p=8,_v(a,c,f,m)}finally{Y.p=A,Q.T=x}}function _v(a,c,f,m){if(Ip){var x=yv(m);if(x===null)sv(a,c,m,Pp,f),nw(a,m);else if(mN(x,a,c,f,m))m.stopPropagation();else if(nw(a,m),c&4&&-1<gN.indexOf(a)){for(;x!==null;){var A=at(x);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var B=Bn(A.pendingLanes);if(B!==0){var W=A;for(W.pendingLanes|=2,W.entangledLanes|=2;B;){var ht=1<<31-ze(B);W.entanglements[1]|=ht,B&=~ht}Aa(A),(pn&6)===0&&(yp=q()+500,kh(0))}}break;case 13:W=Gr(A,2),W!==null&&Ji(W,A,2),xp(),vv(A,2)}if(A=yv(m),A===null&&sv(a,c,m,Pp,f),A===x)break;x=A}x!==null&&m.stopPropagation()}else sv(a,c,m,null,f)}}function yv(a){return a=Bo(a),bv(a)}var Pp=null;function bv(a){if(Pp=null,a=nt(a),a!==null){var c=s(a);if(c===null)a=null;else{var f=c.tag;if(f===13){if(a=o(c),a!==null)return a;a=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null)}}return Pp=a,null}function ew(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(X()){case ft:return 2;case Pt:return 8;case zt:case bt:return 32;case Rt:return 268435456;default:return 32}default:return 32}}var xv=!1,hl=null,dl=null,pl=null,zh=new Map,Hh=new Map,gl=[],gN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function nw(a,c){switch(a){case"focusin":case"focusout":hl=null;break;case"dragenter":case"dragleave":dl=null;break;case"mouseover":case"mouseout":pl=null;break;case"pointerover":case"pointerout":zh.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hh.delete(c.pointerId)}}function jh(a,c,f,m,x,A){return a===null||a.nativeEvent!==A?(a={blockedOn:c,domEventName:f,eventSystemFlags:m,nativeEvent:A,targetContainers:[x]},c!==null&&(c=at(c),c!==null&&tw(c)),a):(a.eventSystemFlags|=m,c=a.targetContainers,x!==null&&c.indexOf(x)===-1&&c.push(x),a)}function mN(a,c,f,m,x){switch(c){case"focusin":return hl=jh(hl,a,c,f,m,x),!0;case"dragenter":return dl=jh(dl,a,c,f,m,x),!0;case"mouseover":return pl=jh(pl,a,c,f,m,x),!0;case"pointerover":var A=x.pointerId;return zh.set(A,jh(zh.get(A)||null,a,c,f,m,x)),!0;case"gotpointercapture":return A=x.pointerId,Hh.set(A,jh(Hh.get(A)||null,a,c,f,m,x)),!0}return!1}function rw(a){var c=nt(a.target);if(c!==null){var f=s(c);if(f!==null){if(c=f.tag,c===13){if(c=o(f),c!==null){a.blockedOn=c,aa(a.priority,function(){if(f.tag===13){var m=Qi();m=Fl(m);var x=Gr(f,m);x!==null&&Ji(x,f,m),vv(f,m)}});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){a.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Fp(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var f=yv(a.nativeEvent);if(f===null){f=a.nativeEvent;var m=new f.constructor(f.type,f);gs=m,f.target.dispatchEvent(m),gs=null}else return c=at(f),c!==null&&tw(c),a.blockedOn=f,!1;c.shift()}return!0}function iw(a,c,f){Fp(a)&&f.delete(c)}function vN(){xv=!1,hl!==null&&Fp(hl)&&(hl=null),dl!==null&&Fp(dl)&&(dl=null),pl!==null&&Fp(pl)&&(pl=null),zh.forEach(iw),Hh.forEach(iw)}function Bp(a,c){a.blockedOn===c&&(a.blockedOn=null,xv||(xv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,vN)))}var Up=null;function sw(a){Up!==a&&(Up=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Up===a&&(Up=null);for(var c=0;c<a.length;c+=3){var f=a[c],m=a[c+1],x=a[c+2];if(typeof m!="function"){if(bv(m||f)===null)continue;break}var A=at(f);A!==null&&(a.splice(c,3),c-=3,b1(A,{pending:!0,data:x,method:f.method,action:m},m,x))}}))}function $h(a){function c(ht){return Bp(ht,a)}hl!==null&&Bp(hl,a),dl!==null&&Bp(dl,a),pl!==null&&Bp(pl,a),zh.forEach(c),Hh.forEach(c);for(var f=0;f<gl.length;f++){var m=gl[f];m.blockedOn===a&&(m.blockedOn=null)}for(;0<gl.length&&(f=gl[0],f.blockedOn===null);)rw(f),f.blockedOn===null&&gl.shift();if(f=(a.ownerDocument||a).$$reactFormReplay,f!=null)for(m=0;m<f.length;m+=3){var x=f[m],A=f[m+1],B=x[er]||null;if(typeof A=="function")B||sw(f);else if(B){var W=null;if(A&&A.hasAttribute("formAction")){if(x=A,B=A[er]||null)W=B.formAction;else if(bv(x)!==null)continue}else W=B.action;typeof W=="function"?f[m+1]=W:(f.splice(m,3),m-=3),sw(f)}}}function Ev(a){this._internalRoot=a}zp.prototype.render=Ev.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(r(409));var f=c.current,m=Qi();QE(f,m,a,c,null,null)},zp.prototype.unmount=Ev.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;QE(a.current,2,null,a,null,null),xp(),c[oa]=null}};function zp(a){this._internalRoot=a}zp.prototype.unstable_scheduleHydration=function(a){if(a){var c=Vc();a={blockedOn:null,target:a,priority:c};for(var f=0;f<gl.length&&c!==0&&c<gl[f].priority;f++);gl.splice(f,0,a),f===0&&rw(a)}};var aw=t.version;if(aw!=="19.1.0")throw Error(r(527,aw,"19.1.0"));Y.findDOMNode=function(a){var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=u(c),a=a!==null?h(a):null,a=a===null?null:a.stateNode,a};var _N={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hp.isDisabled&&Hp.supportsFiber)try{se=Hp.inject(_N),de=Hp}catch{}}return Vh.createRoot=function(a,c){if(!i(a))throw Error(r(299));var f=!1,m="",x=Ex,A=wx,B=Ax,W=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(B=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(W=c.unstable_transitionCallbacks)),c=KE(a,1,!1,null,null,f,m,x,A,B,W,null),a[oa]=c.current,iv(a),new Ev(c)},Vh.hydrateRoot=function(a,c,f){if(!i(a))throw Error(r(299));var m=!1,x="",A=Ex,B=wx,W=Ax,ht=null,Mt=null;return f!=null&&(f.unstable_strictMode===!0&&(m=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(A=f.onUncaughtError),f.onCaughtError!==void 0&&(B=f.onCaughtError),f.onRecoverableError!==void 0&&(W=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(ht=f.unstable_transitionCallbacks),f.formState!==void 0&&(Mt=f.formState)),c=KE(a,1,!0,c,f??null,m,x,A,B,W,ht,Mt),c.context=ZE(null),f=c.current,m=Qi(),m=Fl(m),x=Wt(m),x.callback=null,ne(f,x,m),f=m,c.current.lanes=f,br(c,f),Aa(c),a[oa]=c.current,iv(a),new zp(c)},Vh.version="19.1.0",Vh}var _w;function DN(){if(_w)return Tv.exports;_w=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Tv.exports=CN(),Tv.exports}var ON=DN(),_g={exports:{}},Ai="top",fs="bottom",hs="right",Si="left",ym="auto",pf=[Ai,fs,hs,Si],Ec="start",tf="end",NS="clippingParents",py="viewport",Mu="popper",kS="reference",P_=pf.reduce(function(n,t){return n.concat([t+"-"+Ec,t+"-"+tf])},[]),gy=[].concat(pf,[ym]).reduce(function(n,t){return n.concat([t,t+"-"+Ec,t+"-"+tf])},[]),LS="beforeRead",MS="read",IS="afterRead",PS="beforeMain",FS="main",BS="afterMain",US="beforeWrite",zS="write",HS="afterWrite",jS=[LS,MS,IS,PS,FS,BS,US,zS,HS];function za(n){return n?(n.nodeName||"").toLowerCase():null}function ds(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var t=n.ownerDocument;return t&&t.defaultView||window}return n}function wc(n){var t=ds(n).Element;return n instanceof t||n instanceof Element}function ks(n){var t=ds(n).HTMLElement;return n instanceof t||n instanceof HTMLElement}function my(n){if(typeof ShadowRoot>"u")return!1;var t=ds(n).ShadowRoot;return n instanceof t||n instanceof ShadowRoot}function RN(n){var t=n.state;Object.keys(t.elements).forEach(function(e){var r=t.styles[e]||{},i=t.attributes[e]||{},s=t.elements[e];!ks(s)||!za(s)||(Object.assign(s.style,r),Object.keys(i).forEach(function(o){var l=i[o];l===!1?s.removeAttribute(o):s.setAttribute(o,l===!0?"":l)}))})}function NN(n){var t=n.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(r){var i=t.elements[r],s=t.attributes[r]||{},o=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:e[r]),l=o.reduce(function(u,h){return u[h]="",u},{});!ks(i)||!za(i)||(Object.assign(i.style,l),Object.keys(s).forEach(function(u){i.removeAttribute(u)}))})}}const vy={name:"applyStyles",enabled:!0,phase:"write",fn:RN,effect:NN,requires:["computeStyles"]};function Ba(n){return n.split("-")[0]}var bc=Math.max,Ig=Math.min,ef=Math.round;function F_(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function $S(){return!/^((?!chrome|android).)*safari/i.test(F_())}function nf(n,t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var r=n.getBoundingClientRect(),i=1,s=1;t&&ks(n)&&(i=n.offsetWidth>0&&ef(r.width)/n.offsetWidth||1,s=n.offsetHeight>0&&ef(r.height)/n.offsetHeight||1);var o=wc(n)?ds(n):window,l=o.visualViewport,u=!$S()&&e,h=(r.left+(u&&l?l.offsetLeft:0))/i,d=(r.top+(u&&l?l.offsetTop:0))/s,p=r.width/i,g=r.height/s;return{width:p,height:g,top:d,right:h+p,bottom:d+g,left:h,x:h,y:d}}function _y(n){var t=nf(n),e=n.offsetWidth,r=n.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:n.offsetLeft,y:n.offsetTop,width:e,height:r}}function GS(n,t){var e=t.getRootNode&&t.getRootNode();if(n.contains(t))return!0;if(e&&my(e)){var r=t;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function No(n){return ds(n).getComputedStyle(n)}function kN(n){return["table","td","th"].indexOf(za(n))>=0}function kl(n){return((wc(n)?n.ownerDocument:n.document)||window.document).documentElement}function bm(n){return za(n)==="html"?n:n.assignedSlot||n.parentNode||(my(n)?n.host:null)||kl(n)}function yw(n){return!ks(n)||No(n).position==="fixed"?null:n.offsetParent}function LN(n){var t=/firefox/i.test(F_()),e=/Trident/i.test(F_());if(e&&ks(n)){var r=No(n);if(r.position==="fixed")return null}var i=bm(n);for(my(i)&&(i=i.host);ks(i)&&["html","body"].indexOf(za(i))<0;){var s=No(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function $d(n){for(var t=ds(n),e=yw(n);e&&kN(e)&&No(e).position==="static";)e=yw(e);return e&&(za(e)==="html"||za(e)==="body"&&No(e).position==="static")?t:e||LN(n)||t}function yy(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function ld(n,t,e){return bc(n,Ig(t,e))}function MN(n,t,e){var r=ld(n,t,e);return r>e?e:r}function VS(){return{top:0,right:0,bottom:0,left:0}}function WS(n){return Object.assign({},VS(),n)}function XS(n,t){return t.reduce(function(e,r){return e[r]=n,e},{})}var IN=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,WS(typeof t!="number"?t:XS(t,pf))};function PN(n){var t,e=n.state,r=n.name,i=n.options,s=e.elements.arrow,o=e.modifiersData.popperOffsets,l=Ba(e.placement),u=yy(l),h=[Si,hs].indexOf(l)>=0,d=h?"height":"width";if(!(!s||!o)){var p=IN(i.padding,e),g=_y(s),v=u==="y"?Ai:Si,y=u==="y"?fs:hs,_=e.rects.reference[d]+e.rects.reference[u]-o[u]-e.rects.popper[d],b=o[u]-e.rects.reference[u],E=$d(s),S=E?u==="y"?E.clientHeight||0:E.clientWidth||0:0,T=_/2-b/2,O=p[v],R=S-g[d]-p[y],N=S/2-g[d]/2+T,C=ld(O,N,R),I=u;e.modifiersData[r]=(t={},t[I]=C,t.centerOffset=C-N,t)}}function FN(n){var t=n.state,e=n.options,r=e.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=t.elements.popper.querySelector(i),!i)||GS(t.elements.popper,i)&&(t.elements.arrow=i))}const YS={name:"arrow",enabled:!0,phase:"main",fn:PN,effect:FN,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function rf(n){return n.split("-")[1]}var BN={top:"auto",right:"auto",bottom:"auto",left:"auto"};function UN(n,t){var e=n.x,r=n.y,i=t.devicePixelRatio||1;return{x:ef(e*i)/i||0,y:ef(r*i)/i||0}}function bw(n){var t,e=n.popper,r=n.popperRect,i=n.placement,s=n.variation,o=n.offsets,l=n.position,u=n.gpuAcceleration,h=n.adaptive,d=n.roundOffsets,p=n.isFixed,g=o.x,v=g===void 0?0:g,y=o.y,_=y===void 0?0:y,b=typeof d=="function"?d({x:v,y:_}):{x:v,y:_};v=b.x,_=b.y;var E=o.hasOwnProperty("x"),S=o.hasOwnProperty("y"),T=Si,O=Ai,R=window;if(h){var N=$d(e),C="clientHeight",I="clientWidth";if(N===ds(e)&&(N=kl(e),No(N).position!=="static"&&l==="absolute"&&(C="scrollHeight",I="scrollWidth")),N=N,i===Ai||(i===Si||i===hs)&&s===tf){O=fs;var M=p&&N===R&&R.visualViewport?R.visualViewport.height:N[C];_-=M-r.height,_*=u?1:-1}if(i===Si||(i===Ai||i===fs)&&s===tf){T=hs;var F=p&&N===R&&R.visualViewport?R.visualViewport.width:N[I];v-=F-r.width,v*=u?1:-1}}var H=Object.assign({position:l},h&&BN),P=d===!0?UN({x:v,y:_},ds(e)):{x:v,y:_};if(v=P.x,_=P.y,u){var et;return Object.assign({},H,(et={},et[O]=S?"0":"",et[T]=E?"0":"",et.transform=(R.devicePixelRatio||1)<=1?"translate("+v+"px, "+_+"px)":"translate3d("+v+"px, "+_+"px, 0)",et))}return Object.assign({},H,(t={},t[O]=S?_+"px":"",t[T]=E?v+"px":"",t.transform="",t))}function zN(n){var t=n.state,e=n.options,r=e.gpuAcceleration,i=r===void 0?!0:r,s=e.adaptive,o=s===void 0?!0:s,l=e.roundOffsets,u=l===void 0?!0:l,h={placement:Ba(t.placement),variation:rf(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,bw(Object.assign({},h,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:u})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,bw(Object.assign({},h,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const by={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:zN,data:{}};var $p={passive:!0};function HN(n){var t=n.state,e=n.instance,r=n.options,i=r.scroll,s=i===void 0?!0:i,o=r.resize,l=o===void 0?!0:o,u=ds(t.elements.popper),h=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&h.forEach(function(d){d.addEventListener("scroll",e.update,$p)}),l&&u.addEventListener("resize",e.update,$p),function(){s&&h.forEach(function(d){d.removeEventListener("scroll",e.update,$p)}),l&&u.removeEventListener("resize",e.update,$p)}}const xy={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:HN,data:{}};var jN={left:"right",right:"left",bottom:"top",top:"bottom"};function yg(n){return n.replace(/left|right|bottom|top/g,function(t){return jN[t]})}var $N={start:"end",end:"start"};function xw(n){return n.replace(/start|end/g,function(t){return $N[t]})}function Ey(n){var t=ds(n),e=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:e,scrollTop:r}}function wy(n){return nf(kl(n)).left+Ey(n).scrollLeft}function GN(n,t){var e=ds(n),r=kl(n),i=e.visualViewport,s=r.clientWidth,o=r.clientHeight,l=0,u=0;if(i){s=i.width,o=i.height;var h=$S();(h||!h&&t==="fixed")&&(l=i.offsetLeft,u=i.offsetTop)}return{width:s,height:o,x:l+wy(n),y:u}}function VN(n){var t,e=kl(n),r=Ey(n),i=(t=n.ownerDocument)==null?void 0:t.body,s=bc(e.scrollWidth,e.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=bc(e.scrollHeight,e.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+wy(n),u=-r.scrollTop;return No(i||e).direction==="rtl"&&(l+=bc(e.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:l,y:u}}function Ay(n){var t=No(n),e=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(e+i+r)}function qS(n){return["html","body","#document"].indexOf(za(n))>=0?n.ownerDocument.body:ks(n)&&Ay(n)?n:qS(bm(n))}function cd(n,t){var e;t===void 0&&(t=[]);var r=qS(n),i=r===((e=n.ownerDocument)==null?void 0:e.body),s=ds(r),o=i?[s].concat(s.visualViewport||[],Ay(r)?r:[]):r,l=t.concat(o);return i?l:l.concat(cd(bm(o)))}function B_(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function WN(n,t){var e=nf(n,!1,t==="fixed");return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}function Ew(n,t,e){return t===py?B_(GN(n,e)):wc(t)?WN(t,e):B_(VN(kl(n)))}function XN(n){var t=cd(bm(n)),e=["absolute","fixed"].indexOf(No(n).position)>=0,r=e&&ks(n)?$d(n):n;return wc(r)?t.filter(function(i){return wc(i)&&GS(i,r)&&za(i)!=="body"}):[]}function YN(n,t,e,r){var i=t==="clippingParents"?XN(n):[].concat(t),s=[].concat(i,[e]),o=s[0],l=s.reduce(function(u,h){var d=Ew(n,h,r);return u.top=bc(d.top,u.top),u.right=Ig(d.right,u.right),u.bottom=Ig(d.bottom,u.bottom),u.left=bc(d.left,u.left),u},Ew(n,o,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function KS(n){var t=n.reference,e=n.element,r=n.placement,i=r?Ba(r):null,s=r?rf(r):null,o=t.x+t.width/2-e.width/2,l=t.y+t.height/2-e.height/2,u;switch(i){case Ai:u={x:o,y:t.y-e.height};break;case fs:u={x:o,y:t.y+t.height};break;case hs:u={x:t.x+t.width,y:l};break;case Si:u={x:t.x-e.width,y:l};break;default:u={x:t.x,y:t.y}}var h=i?yy(i):null;if(h!=null){var d=h==="y"?"height":"width";switch(s){case Ec:u[h]=u[h]-(t[d]/2-e[d]/2);break;case tf:u[h]=u[h]+(t[d]/2-e[d]/2);break}}return u}function sf(n,t){t===void 0&&(t={});var e=t,r=e.placement,i=r===void 0?n.placement:r,s=e.strategy,o=s===void 0?n.strategy:s,l=e.boundary,u=l===void 0?NS:l,h=e.rootBoundary,d=h===void 0?py:h,p=e.elementContext,g=p===void 0?Mu:p,v=e.altBoundary,y=v===void 0?!1:v,_=e.padding,b=_===void 0?0:_,E=WS(typeof b!="number"?b:XS(b,pf)),S=g===Mu?kS:Mu,T=n.rects.popper,O=n.elements[y?S:g],R=YN(wc(O)?O:O.contextElement||kl(n.elements.popper),u,d,o),N=nf(n.elements.reference),C=KS({reference:N,element:T,placement:i}),I=B_(Object.assign({},T,C)),M=g===Mu?I:N,F={top:R.top-M.top+E.top,bottom:M.bottom-R.bottom+E.bottom,left:R.left-M.left+E.left,right:M.right-R.right+E.right},H=n.modifiersData.offset;if(g===Mu&&H){var P=H[i];Object.keys(F).forEach(function(et){var L=[hs,fs].indexOf(et)>=0?1:-1,st=[Ai,fs].indexOf(et)>=0?"y":"x";F[et]+=P[st]*L})}return F}function qN(n,t){t===void 0&&(t={});var e=t,r=e.placement,i=e.boundary,s=e.rootBoundary,o=e.padding,l=e.flipVariations,u=e.allowedAutoPlacements,h=u===void 0?gy:u,d=rf(r),p=d?l?P_:P_.filter(function(y){return rf(y)===d}):pf,g=p.filter(function(y){return h.indexOf(y)>=0});g.length===0&&(g=p);var v=g.reduce(function(y,_){return y[_]=sf(n,{placement:_,boundary:i,rootBoundary:s,padding:o})[Ba(_)],y},{});return Object.keys(v).sort(function(y,_){return v[y]-v[_]})}function KN(n){if(Ba(n)===ym)return[];var t=yg(n);return[xw(n),t,xw(t)]}function ZN(n){var t=n.state,e=n.options,r=n.name;if(!t.modifiersData[r]._skip){for(var i=e.mainAxis,s=i===void 0?!0:i,o=e.altAxis,l=o===void 0?!0:o,u=e.fallbackPlacements,h=e.padding,d=e.boundary,p=e.rootBoundary,g=e.altBoundary,v=e.flipVariations,y=v===void 0?!0:v,_=e.allowedAutoPlacements,b=t.options.placement,E=Ba(b),S=E===b,T=u||(S||!y?[yg(b)]:KN(b)),O=[b].concat(T).reduce(function(gt,_t){return gt.concat(Ba(_t)===ym?qN(t,{placement:_t,boundary:d,rootBoundary:p,padding:h,flipVariations:y,allowedAutoPlacements:_}):_t)},[]),R=t.rects.reference,N=t.rects.popper,C=new Map,I=!0,M=O[0],F=0;F<O.length;F++){var H=O[F],P=Ba(H),et=rf(H)===Ec,L=[Ai,fs].indexOf(P)>=0,st=L?"width":"height",Q=sf(t,{placement:H,boundary:d,rootBoundary:p,altBoundary:g,padding:h}),Y=L?et?hs:Si:et?fs:Ai;R[st]>N[st]&&(Y=yg(Y));var Ot=yg(Y),Et=[];if(s&&Et.push(Q[P]<=0),l&&Et.push(Q[Y]<=0,Q[Ot]<=0),Et.every(function(gt){return gt})){M=H,I=!1;break}C.set(H,Et)}if(I)for(var z=y?3:1,J=function(_t){var Bt=O.find(function(Gt){var j=C.get(Gt);if(j)return j.slice(0,_t).every(function(pt){return pt})});if(Bt)return M=Bt,"break"},V=z;V>0;V--){var ct=J(V);if(ct==="break")break}t.placement!==M&&(t.modifiersData[r]._skip=!0,t.placement=M,t.reset=!0)}}const ZS={name:"flip",enabled:!0,phase:"main",fn:ZN,requiresIfExists:["offset"],data:{_skip:!1}};function ww(n,t,e){return e===void 0&&(e={x:0,y:0}),{top:n.top-t.height-e.y,right:n.right-t.width+e.x,bottom:n.bottom-t.height+e.y,left:n.left-t.width-e.x}}function Aw(n){return[Ai,hs,fs,Si].some(function(t){return n[t]>=0})}function QN(n){var t=n.state,e=n.name,r=t.rects.reference,i=t.rects.popper,s=t.modifiersData.preventOverflow,o=sf(t,{elementContext:"reference"}),l=sf(t,{altBoundary:!0}),u=ww(o,r),h=ww(l,i,s),d=Aw(u),p=Aw(h);t.modifiersData[e]={referenceClippingOffsets:u,popperEscapeOffsets:h,isReferenceHidden:d,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":p})}const QS={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:QN};function JN(n,t,e){var r=Ba(n),i=[Si,Ai].indexOf(r)>=0?-1:1,s=typeof e=="function"?e(Object.assign({},t,{placement:n})):e,o=s[0],l=s[1];return o=o||0,l=(l||0)*i,[Si,hs].indexOf(r)>=0?{x:l,y:o}:{x:o,y:l}}function t4(n){var t=n.state,e=n.options,r=n.name,i=e.offset,s=i===void 0?[0,0]:i,o=gy.reduce(function(d,p){return d[p]=JN(p,t.rects,s),d},{}),l=o[t.placement],u=l.x,h=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=h),t.modifiersData[r]=o}const JS={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:t4};function e4(n){var t=n.state,e=n.name;t.modifiersData[e]=KS({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const Sy={name:"popperOffsets",enabled:!0,phase:"read",fn:e4,data:{}};function n4(n){return n==="x"?"y":"x"}function r4(n){var t=n.state,e=n.options,r=n.name,i=e.mainAxis,s=i===void 0?!0:i,o=e.altAxis,l=o===void 0?!1:o,u=e.boundary,h=e.rootBoundary,d=e.altBoundary,p=e.padding,g=e.tether,v=g===void 0?!0:g,y=e.tetherOffset,_=y===void 0?0:y,b=sf(t,{boundary:u,rootBoundary:h,padding:p,altBoundary:d}),E=Ba(t.placement),S=rf(t.placement),T=!S,O=yy(E),R=n4(O),N=t.modifiersData.popperOffsets,C=t.rects.reference,I=t.rects.popper,M=typeof _=="function"?_(Object.assign({},t.rects,{placement:t.placement})):_,F=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),H=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,P={x:0,y:0};if(N){if(s){var et,L=O==="y"?Ai:Si,st=O==="y"?fs:hs,Q=O==="y"?"height":"width",Y=N[O],Ot=Y+b[L],Et=Y-b[st],z=v?-I[Q]/2:0,J=S===Ec?C[Q]:I[Q],V=S===Ec?-I[Q]:-C[Q],ct=t.elements.arrow,gt=v&&ct?_y(ct):{width:0,height:0},_t=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:VS(),Bt=_t[L],Gt=_t[st],j=ld(0,C[Q],gt[Q]),pt=T?C[Q]/2-z-j-Bt-F.mainAxis:J-j-Bt-F.mainAxis,lt=T?-C[Q]/2+z+j+Gt+F.mainAxis:V+j+Gt+F.mainAxis,ut=t.elements.arrow&&$d(t.elements.arrow),Dt=ut?O==="y"?ut.clientTop||0:ut.clientLeft||0:0,Lt=(et=H?.[O])!=null?et:0,D=Y+pt-Lt-Dt,dt=Y+lt-Lt,it=ld(v?Ig(Ot,D):Ot,Y,v?bc(Et,dt):Et);N[O]=it,P[O]=it-Y}if(l){var q,X=O==="x"?Ai:Si,ft=O==="x"?fs:hs,Pt=N[R],zt=R==="y"?"height":"width",bt=Pt+b[X],Rt=Pt-b[ft],qt=[Ai,Si].indexOf(E)!==-1,xt=(q=H?.[R])!=null?q:0,se=qt?bt:Pt-C[zt]-I[zt]-xt+F.altAxis,de=qt?Pt+C[zt]+I[zt]-xt-F.altAxis:Rt,ae=v&&qt?MN(se,Pt,de):ld(v?se:bt,Pt,v?de:Rt);N[R]=ae,P[R]=ae-Pt}t.modifiersData[r]=P}}const tT={name:"preventOverflow",enabled:!0,phase:"main",fn:r4,requiresIfExists:["offset"]};function i4(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function s4(n){return n===ds(n)||!ks(n)?Ey(n):i4(n)}function a4(n){var t=n.getBoundingClientRect(),e=ef(t.width)/n.offsetWidth||1,r=ef(t.height)/n.offsetHeight||1;return e!==1||r!==1}function o4(n,t,e){e===void 0&&(e=!1);var r=ks(t),i=ks(t)&&a4(t),s=kl(t),o=nf(n,i,e),l={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(r||!r&&!e)&&((za(t)!=="body"||Ay(s))&&(l=s4(t)),ks(t)?(u=nf(t,!0),u.x+=t.clientLeft,u.y+=t.clientTop):s&&(u.x=wy(s))),{x:o.left+l.scrollLeft-u.x,y:o.top+l.scrollTop-u.y,width:o.width,height:o.height}}function l4(n){var t=new Map,e=new Set,r=[];n.forEach(function(s){t.set(s.name,s)});function i(s){e.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(l){if(!e.has(l)){var u=t.get(l);u&&i(u)}}),r.push(s)}return n.forEach(function(s){e.has(s.name)||i(s)}),r}function c4(n){var t=l4(n);return jS.reduce(function(e,r){return e.concat(t.filter(function(i){return i.phase===r}))},[])}function u4(n){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(n())})})),t}}function f4(n){var t=n.reduce(function(e,r){var i=e[r.name];return e[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,e},{});return Object.keys(t).map(function(e){return t[e]})}var Sw={placement:"bottom",modifiers:[],strategy:"absolute"};function Tw(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function xm(n){n===void 0&&(n={});var t=n,e=t.defaultModifiers,r=e===void 0?[]:e,i=t.defaultOptions,s=i===void 0?Sw:i;return function(l,u,h){h===void 0&&(h=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Sw,s),modifiersData:{},elements:{reference:l,popper:u},attributes:{},styles:{}},p=[],g=!1,v={state:d,setOptions:function(E){var S=typeof E=="function"?E(d.options):E;_(),d.options=Object.assign({},s,d.options,S),d.scrollParents={reference:wc(l)?cd(l):l.contextElement?cd(l.contextElement):[],popper:cd(u)};var T=c4(f4([].concat(r,d.options.modifiers)));return d.orderedModifiers=T.filter(function(O){return O.enabled}),y(),v.update()},forceUpdate:function(){if(!g){var E=d.elements,S=E.reference,T=E.popper;if(Tw(S,T)){d.rects={reference:o4(S,$d(T),d.options.strategy==="fixed"),popper:_y(T)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(F){return d.modifiersData[F.name]=Object.assign({},F.data)});for(var O=0;O<d.orderedModifiers.length;O++){if(d.reset===!0){d.reset=!1,O=-1;continue}var R=d.orderedModifiers[O],N=R.fn,C=R.options,I=C===void 0?{}:C,M=R.name;typeof N=="function"&&(d=N({state:d,options:I,name:M,instance:v})||d)}}}},update:u4(function(){return new Promise(function(b){v.forceUpdate(),b(d)})}),destroy:function(){_(),g=!0}};if(!Tw(l,u))return v;v.setOptions(h).then(function(b){!g&&h.onFirstUpdate&&h.onFirstUpdate(b)});function y(){d.orderedModifiers.forEach(function(b){var E=b.name,S=b.options,T=S===void 0?{}:S,O=b.effect;if(typeof O=="function"){var R=O({state:d,name:E,instance:v,options:T}),N=function(){};p.push(R||N)}})}function _(){p.forEach(function(b){return b()}),p=[]}return v}}var h4=xm(),d4=[xy,Sy,by,vy],p4=xm({defaultModifiers:d4}),g4=[xy,Sy,by,vy,JS,ZS,tT,YS,QS],Ty=xm({defaultModifiers:g4});const Cy=Object.freeze(Object.defineProperty({__proto__:null,afterMain:BS,afterRead:IS,afterWrite:HS,applyStyles:vy,arrow:YS,auto:ym,basePlacements:pf,beforeMain:PS,beforeRead:LS,beforeWrite:US,bottom:fs,clippingParents:NS,computeStyles:by,createPopper:Ty,createPopperBase:h4,createPopperLite:p4,detectOverflow:sf,end:tf,eventListeners:xy,flip:ZS,hide:QS,left:Si,main:FS,modifierPhases:jS,offset:JS,placements:gy,popper:Mu,popperGenerator:xm,popperOffsets:Sy,preventOverflow:tT,read:MS,reference:kS,right:hs,start:Ec,top:Ai,variationPlacements:P_,viewport:py,write:zS},Symbol.toStringTag,{value:"Module"})),eT=bN(Cy);var bg={exports:{}},xg={exports:{}};/*!
  * Bootstrap data.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var m4=xg.exports,Cw;function v4(){return Cw||(Cw=1,function(n,t){(function(e,r){n.exports=r()})(m4,function(){const e=new Map;return{set(i,s,o){e.has(i)||e.set(i,new Map);const l=e.get(i);if(!l.has(s)&&l.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(l.keys())[0]}.`);return}l.set(s,o)},get(i,s){return e.has(i)&&e.get(i).get(s)||null},remove(i,s){if(!e.has(i))return;const o=e.get(i);o.delete(s),o.size===0&&e.delete(i)}}})}(xg)),xg.exports}var Eg={exports:{}},nd={exports:{}};/*!
  * Bootstrap index.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var _4=nd.exports,Dw;function Ic(){return Dw||(Dw=1,function(n,t){(function(e,r){r(t)})(_4,function(e){const s="transitionend",o=F=>(F&&window.CSS&&window.CSS.escape&&(F=F.replace(/#([^\s"#']+)/g,(H,P)=>`#${CSS.escape(P)}`)),F),l=F=>F==null?`${F}`:Object.prototype.toString.call(F).match(/\s([a-z]+)/i)[1].toLowerCase(),u=F=>{do F+=Math.floor(Math.random()*1e6);while(document.getElementById(F));return F},h=F=>{if(!F)return 0;let{transitionDuration:H,transitionDelay:P}=window.getComputedStyle(F);const et=Number.parseFloat(H),L=Number.parseFloat(P);return!et&&!L?0:(H=H.split(",")[0],P=P.split(",")[0],(Number.parseFloat(H)+Number.parseFloat(P))*1e3)},d=F=>{F.dispatchEvent(new Event(s))},p=F=>!F||typeof F!="object"?!1:(typeof F.jquery<"u"&&(F=F[0]),typeof F.nodeType<"u"),g=F=>p(F)?F.jquery?F[0]:F:typeof F=="string"&&F.length>0?document.querySelector(o(F)):null,v=F=>{if(!p(F)||F.getClientRects().length===0)return!1;const H=getComputedStyle(F).getPropertyValue("visibility")==="visible",P=F.closest("details:not([open])");if(!P)return H;if(P!==F){const et=F.closest("summary");if(et&&et.parentNode!==P||et===null)return!1}return H},y=F=>!F||F.nodeType!==Node.ELEMENT_NODE||F.classList.contains("disabled")?!0:typeof F.disabled<"u"?F.disabled:F.hasAttribute("disabled")&&F.getAttribute("disabled")!=="false",_=F=>{if(!document.documentElement.attachShadow)return null;if(typeof F.getRootNode=="function"){const H=F.getRootNode();return H instanceof ShadowRoot?H:null}return F instanceof ShadowRoot?F:F.parentNode?_(F.parentNode):null},b=()=>{},E=F=>{F.offsetHeight},S=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,T=[],O=F=>{document.readyState==="loading"?(T.length||document.addEventListener("DOMContentLoaded",()=>{for(const H of T)H()}),T.push(F)):F()},R=()=>document.documentElement.dir==="rtl",N=F=>{O(()=>{const H=S();if(H){const P=F.NAME,et=H.fn[P];H.fn[P]=F.jQueryInterface,H.fn[P].Constructor=F,H.fn[P].noConflict=()=>(H.fn[P]=et,F.jQueryInterface)}})},C=(F,H=[],P=F)=>typeof F=="function"?F.call(...H):P,I=(F,H,P=!0)=>{if(!P){C(F);return}const L=h(H)+5;let st=!1;const Q=({target:Y})=>{Y===H&&(st=!0,H.removeEventListener(s,Q),C(F))};H.addEventListener(s,Q),setTimeout(()=>{st||d(H)},L)},M=(F,H,P,et)=>{const L=F.length;let st=F.indexOf(H);return st===-1?!P&&et?F[L-1]:F[0]:(st+=P?1:-1,et&&(st=(st+L)%L),F[Math.max(0,Math.min(st,L-1))])};e.defineJQueryPlugin=N,e.execute=C,e.executeAfterTransition=I,e.findShadowRoot=_,e.getElement=g,e.getNextActiveElement=M,e.getTransitionDurationFromElement=h,e.getUID=u,e.getjQuery=S,e.isDisabled=y,e.isElement=p,e.isRTL=R,e.isVisible=v,e.noop=b,e.onDOMContentLoaded=O,e.parseSelector=o,e.reflow=E,e.toType=l,e.triggerTransitionEnd=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})}(nd,nd.exports)),nd.exports}/*!
  * Bootstrap event-handler.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var y4=Eg.exports,Ow;function Dy(){return Ow||(Ow=1,function(n,t){(function(e,r){n.exports=r(Ic())})(y4,function(e){const r=/[^.]*(?=\..*)\.|.*/,i=/\..*/,s=/::\d+$/,o={};let l=1;const u={mouseenter:"mouseover",mouseleave:"mouseout"},h=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function d(N,C){return C&&`${C}::${l++}`||N.uidEvent||l++}function p(N){const C=d(N);return N.uidEvent=C,o[C]=o[C]||{},o[C]}function g(N,C){return function I(M){return R(M,{delegateTarget:N}),I.oneOff&&O.off(N,M.type,C),C.apply(N,[M])}}function v(N,C,I){return function M(F){const H=N.querySelectorAll(C);for(let{target:P}=F;P&&P!==this;P=P.parentNode)for(const et of H)if(et===P)return R(F,{delegateTarget:P}),M.oneOff&&O.off(N,F.type,C,I),I.apply(P,[F])}}function y(N,C,I=null){return Object.values(N).find(M=>M.callable===C&&M.delegationSelector===I)}function _(N,C,I){const M=typeof C=="string",F=M?I:C||I;let H=T(N);return h.has(H)||(H=N),[M,F,H]}function b(N,C,I,M,F){if(typeof C!="string"||!N)return;let[H,P,et]=_(C,I,M);C in u&&(P=(z=>function(J){if(!J.relatedTarget||J.relatedTarget!==J.delegateTarget&&!J.delegateTarget.contains(J.relatedTarget))return z.call(this,J)})(P));const L=p(N),st=L[et]||(L[et]={}),Q=y(st,P,H?I:null);if(Q){Q.oneOff=Q.oneOff&&F;return}const Y=d(P,C.replace(r,"")),Ot=H?v(N,I,P):g(N,P);Ot.delegationSelector=H?I:null,Ot.callable=P,Ot.oneOff=F,Ot.uidEvent=Y,st[Y]=Ot,N.addEventListener(et,Ot,H)}function E(N,C,I,M,F){const H=y(C[I],M,F);H&&(N.removeEventListener(I,H,!!F),delete C[I][H.uidEvent])}function S(N,C,I,M){const F=C[I]||{};for(const[H,P]of Object.entries(F))H.includes(M)&&E(N,C,I,P.callable,P.delegationSelector)}function T(N){return N=N.replace(i,""),u[N]||N}const O={on(N,C,I,M){b(N,C,I,M,!1)},one(N,C,I,M){b(N,C,I,M,!0)},off(N,C,I,M){if(typeof C!="string"||!N)return;const[F,H,P]=_(C,I,M),et=P!==C,L=p(N),st=L[P]||{},Q=C.startsWith(".");if(typeof H<"u"){if(!Object.keys(st).length)return;E(N,L,P,H,F?I:null);return}if(Q)for(const Y of Object.keys(L))S(N,L,Y,C.slice(1));for(const[Y,Ot]of Object.entries(st)){const Et=Y.replace(s,"");(!et||C.includes(Et))&&E(N,L,P,Ot.callable,Ot.delegationSelector)}},trigger(N,C,I){if(typeof C!="string"||!N)return null;const M=e.getjQuery(),F=T(C),H=C!==F;let P=null,et=!0,L=!0,st=!1;H&&M&&(P=M.Event(C,I),M(N).trigger(P),et=!P.isPropagationStopped(),L=!P.isImmediatePropagationStopped(),st=P.isDefaultPrevented());const Q=R(new Event(C,{bubbles:et,cancelable:!0}),I);return st&&Q.preventDefault(),L&&N.dispatchEvent(Q),Q.defaultPrevented&&P&&P.preventDefault(),Q}};function R(N,C={}){for(const[I,M]of Object.entries(C))try{N[I]=M}catch{Object.defineProperty(N,I,{configurable:!0,get(){return M}})}return N}return O})}(Eg)),Eg.exports}var wg={exports:{}},Ag={exports:{}};/*!
  * Bootstrap manipulator.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var b4=Ag.exports,Rw;function Oy(){return Rw||(Rw=1,function(n,t){(function(e,r){n.exports=r()})(b4,function(){function e(s){if(s==="true")return!0;if(s==="false")return!1;if(s===Number(s).toString())return Number(s);if(s===""||s==="null")return null;if(typeof s!="string")return s;try{return JSON.parse(decodeURIComponent(s))}catch{return s}}function r(s){return s.replace(/[A-Z]/g,o=>`-${o.toLowerCase()}`)}return{setDataAttribute(s,o,l){s.setAttribute(`data-bs-${r(o)}`,l)},removeDataAttribute(s,o){s.removeAttribute(`data-bs-${r(o)}`)},getDataAttributes(s){if(!s)return{};const o={},l=Object.keys(s.dataset).filter(u=>u.startsWith("bs")&&!u.startsWith("bsConfig"));for(const u of l){let h=u.replace(/^bs/,"");h=h.charAt(0).toLowerCase()+h.slice(1),o[h]=e(s.dataset[u])}return o},getDataAttribute(s,o){return e(s.getAttribute(`data-bs-${r(o)}`))}}})}(Ag)),Ag.exports}/*!
  * Bootstrap config.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var x4=wg.exports,Nw;function nT(){return Nw||(Nw=1,function(n,t){(function(e,r){n.exports=r(Oy(),Ic())})(x4,function(e,r){class i{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(o){return o=this._mergeConfigObj(o),o=this._configAfterMerge(o),this._typeCheckConfig(o),o}_configAfterMerge(o){return o}_mergeConfigObj(o,l){const u=r.isElement(l)?e.getDataAttribute(l,"config"):{};return{...this.constructor.Default,...typeof u=="object"?u:{},...r.isElement(l)?e.getDataAttributes(l):{},...typeof o=="object"?o:{}}}_typeCheckConfig(o,l=this.constructor.DefaultType){for(const[u,h]of Object.entries(l)){const d=o[u],p=r.isElement(d)?"element":r.toType(d);if(!new RegExp(h).test(p))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${u}" provided type "${p}" but expected type "${h}".`)}}}return i})}(wg)),wg.exports}/*!
  * Bootstrap base-component.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var E4=bg.exports,kw;function rT(){return kw||(kw=1,function(n,t){(function(e,r){n.exports=r(v4(),Dy(),nT(),Ic())})(E4,function(e,r,i,s){const o="5.3.7";class l extends i{constructor(h,d){super(),h=s.getElement(h),h&&(this._element=h,this._config=this._getConfig(d),e.set(this._element,this.constructor.DATA_KEY,this))}dispose(){e.remove(this._element,this.constructor.DATA_KEY),r.off(this._element,this.constructor.EVENT_KEY);for(const h of Object.getOwnPropertyNames(this))this[h]=null}_queueCallback(h,d,p=!0){s.executeAfterTransition(h,d,p)}_getConfig(h){return h=this._mergeConfigObj(h,this._element),h=this._configAfterMerge(h),this._typeCheckConfig(h),h}static getInstance(h){return e.get(s.getElement(h),this.DATA_KEY)}static getOrCreateInstance(h,d={}){return this.getInstance(h)||new this(h,typeof d=="object"?d:null)}static get VERSION(){return o}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(h){return`${h}${this.EVENT_KEY}`}}return l})}(bg)),bg.exports}var rd={exports:{}};/*!
  * Bootstrap sanitizer.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var w4=rd.exports,Lw;function iT(){return Lw||(Lw=1,function(n,t){(function(e,r){r(t)})(w4,function(e){const i={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},s=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),o=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,l=(h,d)=>{const p=h.nodeName.toLowerCase();return d.includes(p)?s.has(p)?!!o.test(h.nodeValue):!0:d.filter(g=>g instanceof RegExp).some(g=>g.test(p))};function u(h,d,p){if(!h.length)return h;if(p&&typeof p=="function")return p(h);const v=new window.DOMParser().parseFromString(h,"text/html"),y=[].concat(...v.body.querySelectorAll("*"));for(const _ of y){const b=_.nodeName.toLowerCase();if(!Object.keys(d).includes(b)){_.remove();continue}const E=[].concat(..._.attributes),S=[].concat(d["*"]||[],d[b]||[]);for(const T of E)l(T,S)||_.removeAttribute(T.nodeName)}return v.body.innerHTML}e.DefaultAllowlist=i,e.sanitizeHtml=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})}(rd,rd.exports)),rd.exports}var Sg={exports:{}},Tg={exports:{}};/*!
  * Bootstrap selector-engine.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var A4=Tg.exports,Mw;function sT(){return Mw||(Mw=1,function(n,t){(function(e,r){n.exports=r(Ic())})(A4,function(e){const r=s=>{let o=s.getAttribute("data-bs-target");if(!o||o==="#"){let l=s.getAttribute("href");if(!l||!l.includes("#")&&!l.startsWith("."))return null;l.includes("#")&&!l.startsWith("#")&&(l=`#${l.split("#")[1]}`),o=l&&l!=="#"?l.trim():null}return o?o.split(",").map(l=>e.parseSelector(l)).join(","):null},i={find(s,o=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(o,s))},findOne(s,o=document.documentElement){return Element.prototype.querySelector.call(o,s)},children(s,o){return[].concat(...s.children).filter(l=>l.matches(o))},parents(s,o){const l=[];let u=s.parentNode.closest(o);for(;u;)l.push(u),u=u.parentNode.closest(o);return l},prev(s,o){let l=s.previousElementSibling;for(;l;){if(l.matches(o))return[l];l=l.previousElementSibling}return[]},next(s,o){let l=s.nextElementSibling;for(;l;){if(l.matches(o))return[l];l=l.nextElementSibling}return[]},focusableChildren(s){const o=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(l=>`${l}:not([tabindex^="-"])`).join(",");return this.find(o,s).filter(l=>!e.isDisabled(l)&&e.isVisible(l))},getSelectorFromElement(s){const o=r(s);return o&&i.findOne(o)?o:null},getElementFromSelector(s){const o=r(s);return o?i.findOne(o):null},getMultipleElementsFromSelector(s){const o=r(s);return o?i.find(o):[]}};return i})}(Tg)),Tg.exports}/*!
  * Bootstrap template-factory.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var S4=Sg.exports,Iw;function T4(){return Iw||(Iw=1,function(n,t){(function(e,r){n.exports=r(sT(),nT(),iT(),Ic())})(S4,function(e,r,i,s){const o="TemplateFactory",l={allowList:i.DefaultAllowlist,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},u={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},h={entry:"(string|element|function|null)",selector:"(string|element)"};class d extends r{constructor(g){super(),this._config=this._getConfig(g)}static get Default(){return l}static get DefaultType(){return u}static get NAME(){return o}getContent(){return Object.values(this._config.content).map(g=>this._resolvePossibleFunction(g)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(g){return this._checkContent(g),this._config.content={...this._config.content,...g},this}toHtml(){const g=document.createElement("div");g.innerHTML=this._maybeSanitize(this._config.template);for(const[_,b]of Object.entries(this._config.content))this._setContent(g,b,_);const v=g.children[0],y=this._resolvePossibleFunction(this._config.extraClass);return y&&v.classList.add(...y.split(" ")),v}_typeCheckConfig(g){super._typeCheckConfig(g),this._checkContent(g.content)}_checkContent(g){for(const[v,y]of Object.entries(g))super._typeCheckConfig({selector:v,entry:y},h)}_setContent(g,v,y){const _=e.findOne(y,g);if(_){if(v=this._resolvePossibleFunction(v),!v){_.remove();return}if(s.isElement(v)){this._putElementInTemplate(s.getElement(v),_);return}if(this._config.html){_.innerHTML=this._maybeSanitize(v);return}_.textContent=v}}_maybeSanitize(g){return this._config.sanitize?i.sanitizeHtml(g,this._config.allowList,this._config.sanitizeFn):g}_resolvePossibleFunction(g){return s.execute(g,[void 0,this])}_putElementInTemplate(g,v){if(this._config.html){v.innerHTML="",v.append(g);return}v.textContent=g.textContent}}return d})}(Sg)),Sg.exports}/*!
  * Bootstrap tooltip.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var C4=_g.exports,Pw;function D4(){return Pw||(Pw=1,function(n,t){(function(e,r){n.exports=r(eT,rT(),Dy(),Oy(),Ic(),iT(),T4())})(C4,function(e,r,i,s,o,l,u){function h(J){const V=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(J){for(const ct in J)if(ct!=="default"){const gt=Object.getOwnPropertyDescriptor(J,ct);Object.defineProperty(V,ct,gt.get?gt:{enumerable:!0,get:()=>J[ct]})}}return V.default=J,Object.freeze(V)}const d=h(e),p="tooltip",g=new Set(["sanitize","allowList","sanitizeFn"]),v="fade",y="modal",_="show",b=".tooltip-inner",E=`.${y}`,S="hide.bs.modal",T="hover",O="focus",R="click",N="manual",C="hide",I="hidden",M="show",F="shown",H="inserted",P="click",et="focusin",L="focusout",st="mouseenter",Q="mouseleave",Y={AUTO:"auto",TOP:"top",RIGHT:o.isRTL()?"left":"right",BOTTOM:"bottom",LEFT:o.isRTL()?"right":"left"},Ot={allowList:l.DefaultAllowlist,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Et={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class z extends r{constructor(V,ct){if(typeof d>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(V,ct),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Ot}static get DefaultType(){return Et}static get NAME(){return p}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),i.off(this._element.closest(E),S,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const V=i.trigger(this._element,this.constructor.eventName(M)),gt=(o.findShadowRoot(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(V.defaultPrevented||!gt)return;this._disposePopper();const _t=this._getTipElement();this._element.setAttribute("aria-describedby",_t.getAttribute("id"));const{container:Bt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(Bt.append(_t),i.trigger(this._element,this.constructor.eventName(H))),this._popper=this._createPopper(_t),_t.classList.add(_),"ontouchstart"in document.documentElement)for(const j of[].concat(...document.body.children))i.on(j,"mouseover",o.noop);const Gt=()=>{i.trigger(this._element,this.constructor.eventName(F)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(Gt,this.tip,this._isAnimated())}hide(){if(!this._isShown()||i.trigger(this._element,this.constructor.eventName(C)).defaultPrevented)return;if(this._getTipElement().classList.remove(_),"ontouchstart"in document.documentElement)for(const _t of[].concat(...document.body.children))i.off(_t,"mouseover",o.noop);this._activeTrigger[R]=!1,this._activeTrigger[O]=!1,this._activeTrigger[T]=!1,this._isHovered=null;const gt=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),i.trigger(this._element,this.constructor.eventName(I)))};this._queueCallback(gt,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(V){const ct=this._getTemplateFactory(V).toHtml();if(!ct)return null;ct.classList.remove(v,_),ct.classList.add(`bs-${this.constructor.NAME}-auto`);const gt=o.getUID(this.constructor.NAME).toString();return ct.setAttribute("id",gt),this._isAnimated()&&ct.classList.add(v),ct}setContent(V){this._newContent=V,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(V){return this._templateFactory?this._templateFactory.changeContent(V):this._templateFactory=new u({...this._config,content:V,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[b]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(V){return this.constructor.getOrCreateInstance(V.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(v)}_isShown(){return this.tip&&this.tip.classList.contains(_)}_createPopper(V){const ct=o.execute(this._config.placement,[this,V,this._element]),gt=Y[ct.toUpperCase()];return d.createPopper(this._element,V,this._getPopperConfig(gt))}_getOffset(){const{offset:V}=this._config;return typeof V=="string"?V.split(",").map(ct=>Number.parseInt(ct,10)):typeof V=="function"?ct=>V(ct,this._element):V}_resolvePossibleFunction(V){return o.execute(V,[this._element,this._element])}_getPopperConfig(V){const ct={placement:V,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:gt=>{this._getTipElement().setAttribute("data-popper-placement",gt.state.placement)}}]};return{...ct,...o.execute(this._config.popperConfig,[void 0,ct])}}_setListeners(){const V=this._config.trigger.split(" ");for(const ct of V)if(ct==="click")i.on(this._element,this.constructor.eventName(P),this._config.selector,gt=>{const _t=this._initializeOnDelegatedTarget(gt);_t._activeTrigger[R]=!(_t._isShown()&&_t._activeTrigger[R]),_t.toggle()});else if(ct!==N){const gt=ct===T?this.constructor.eventName(st):this.constructor.eventName(et),_t=ct===T?this.constructor.eventName(Q):this.constructor.eventName(L);i.on(this._element,gt,this._config.selector,Bt=>{const Gt=this._initializeOnDelegatedTarget(Bt);Gt._activeTrigger[Bt.type==="focusin"?O:T]=!0,Gt._enter()}),i.on(this._element,_t,this._config.selector,Bt=>{const Gt=this._initializeOnDelegatedTarget(Bt);Gt._activeTrigger[Bt.type==="focusout"?O:T]=Gt._element.contains(Bt.relatedTarget),Gt._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},i.on(this._element.closest(E),S,this._hideModalHandler)}_fixTitle(){const V=this._element.getAttribute("title");V&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",V),this._element.setAttribute("data-bs-original-title",V),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(V,ct){clearTimeout(this._timeout),this._timeout=setTimeout(V,ct)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(V){const ct=s.getDataAttributes(this._element);for(const gt of Object.keys(ct))g.has(gt)&&delete ct[gt];return V={...ct,...typeof V=="object"&&V?V:{}},V=this._mergeConfigObj(V),V=this._configAfterMerge(V),this._typeCheckConfig(V),V}_configAfterMerge(V){return V.container=V.container===!1?document.body:o.getElement(V.container),typeof V.delay=="number"&&(V.delay={show:V.delay,hide:V.delay}),typeof V.title=="number"&&(V.title=V.title.toString()),typeof V.content=="number"&&(V.content=V.content.toString()),V}_getDelegateConfig(){const V={};for(const[ct,gt]of Object.entries(this._config))this.constructor.Default[ct]!==gt&&(V[ct]=gt);return V.selector=!1,V.trigger="manual",V}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(V){return this.each(function(){const ct=z.getOrCreateInstance(this,V);if(typeof V=="string"){if(typeof ct[V]>"u")throw new TypeError(`No method named "${V}"`);ct[V]()}})}}return o.defineJQueryPlugin(z),z})}(_g)),_g.exports}D4();var Cg={exports:{}};/*!
  * Bootstrap dropdown.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var O4=Cg.exports,Fw;function R4(){return Fw||(Fw=1,function(n,t){(function(e,r){n.exports=r(eT,rT(),Dy(),Oy(),sT(),Ic())})(O4,function(e,r,i,s,o,l){function u(Lt){const D=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(Lt){for(const dt in Lt)if(dt!=="default"){const it=Object.getOwnPropertyDescriptor(Lt,dt);Object.defineProperty(D,dt,it.get?it:{enumerable:!0,get:()=>Lt[dt]})}}return D.default=Lt,Object.freeze(D)}const h=u(e),d="dropdown",g=".bs.dropdown",v=".data-api",y="Escape",_="Tab",b="ArrowUp",E="ArrowDown",S=2,T=`hide${g}`,O=`hidden${g}`,R=`show${g}`,N=`shown${g}`,C=`click${g}${v}`,I=`keydown${g}${v}`,M=`keyup${g}${v}`,F="show",H="dropup",P="dropend",et="dropstart",L="dropup-center",st="dropdown-center",Q='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Y=`${Q}.${F}`,Ot=".dropdown-menu",Et=".navbar",z=".navbar-nav",J=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",V=l.isRTL()?"top-end":"top-start",ct=l.isRTL()?"top-start":"top-end",gt=l.isRTL()?"bottom-end":"bottom-start",_t=l.isRTL()?"bottom-start":"bottom-end",Bt=l.isRTL()?"left-start":"right-start",Gt=l.isRTL()?"right-start":"left-start",j="top",pt="bottom",lt={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},ut={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Dt extends r{constructor(D,dt){super(D,dt),this._popper=null,this._parent=this._element.parentNode,this._menu=o.next(this._element,Ot)[0]||o.prev(this._element,Ot)[0]||o.findOne(Ot,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return lt}static get DefaultType(){return ut}static get NAME(){return d}toggle(){return this._isShown()?this.hide():this.show()}show(){if(l.isDisabled(this._element)||this._isShown())return;const D={relatedTarget:this._element};if(!i.trigger(this._element,R,D).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(z))for(const it of[].concat(...document.body.children))i.on(it,"mouseover",l.noop);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(F),this._element.classList.add(F),i.trigger(this._element,N,D)}}hide(){if(l.isDisabled(this._element)||!this._isShown())return;const D={relatedTarget:this._element};this._completeHide(D)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(D){if(!i.trigger(this._element,T,D).defaultPrevented){if("ontouchstart"in document.documentElement)for(const it of[].concat(...document.body.children))i.off(it,"mouseover",l.noop);this._popper&&this._popper.destroy(),this._menu.classList.remove(F),this._element.classList.remove(F),this._element.setAttribute("aria-expanded","false"),s.removeDataAttribute(this._menu,"popper"),i.trigger(this._element,O,D),this._element.focus()}}_getConfig(D){if(D=super._getConfig(D),typeof D.reference=="object"&&!l.isElement(D.reference)&&typeof D.reference.getBoundingClientRect!="function")throw new TypeError(`${d.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return D}_createPopper(){if(typeof h>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let D=this._element;this._config.reference==="parent"?D=this._parent:l.isElement(this._config.reference)?D=l.getElement(this._config.reference):typeof this._config.reference=="object"&&(D=this._config.reference);const dt=this._getPopperConfig();this._popper=h.createPopper(D,this._menu,dt)}_isShown(){return this._menu.classList.contains(F)}_getPlacement(){const D=this._parent;if(D.classList.contains(P))return Bt;if(D.classList.contains(et))return Gt;if(D.classList.contains(L))return j;if(D.classList.contains(st))return pt;const dt=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return D.classList.contains(H)?dt?ct:V:dt?_t:gt}_detectNavbar(){return this._element.closest(Et)!==null}_getOffset(){const{offset:D}=this._config;return typeof D=="string"?D.split(",").map(dt=>Number.parseInt(dt,10)):typeof D=="function"?dt=>D(dt,this._element):D}_getPopperConfig(){const D={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(s.setDataAttribute(this._menu,"popper","static"),D.modifiers=[{name:"applyStyles",enabled:!1}]),{...D,...l.execute(this._config.popperConfig,[void 0,D])}}_selectMenuItem({key:D,target:dt}){const it=o.find(J,this._menu).filter(q=>l.isVisible(q));it.length&&l.getNextActiveElement(it,dt,D===E,!it.includes(dt)).focus()}static jQueryInterface(D){return this.each(function(){const dt=Dt.getOrCreateInstance(this,D);if(typeof D=="string"){if(typeof dt[D]>"u")throw new TypeError(`No method named "${D}"`);dt[D]()}})}static clearMenus(D){if(D.button===S||D.type==="keyup"&&D.key!==_)return;const dt=o.find(Y);for(const it of dt){const q=Dt.getInstance(it);if(!q||q._config.autoClose===!1)continue;const X=D.composedPath(),ft=X.includes(q._menu);if(X.includes(q._element)||q._config.autoClose==="inside"&&!ft||q._config.autoClose==="outside"&&ft||q._menu.contains(D.target)&&(D.type==="keyup"&&D.key===_||/input|select|option|textarea|form/i.test(D.target.tagName)))continue;const Pt={relatedTarget:q._element};D.type==="click"&&(Pt.clickEvent=D),q._completeHide(Pt)}}static dataApiKeydownHandler(D){const dt=/input|textarea/i.test(D.target.tagName),it=D.key===y,q=[b,E].includes(D.key);if(!q&&!it||dt&&!it)return;D.preventDefault();const X=this.matches(Q)?this:o.prev(this,Q)[0]||o.next(this,Q)[0]||o.findOne(Q,D.delegateTarget.parentNode),ft=Dt.getOrCreateInstance(X);if(q){D.stopPropagation(),ft.show(),ft._selectMenuItem(D);return}ft._isShown()&&(D.stopPropagation(),ft.hide(),X.focus())}}return i.on(document,I,Q,Dt.dataApiKeydownHandler),i.on(document,I,Ot,Dt.dataApiKeydownHandler),i.on(document,C,Dt.clearMenus),i.on(document,M,Dt.clearMenus),i.on(document,C,Q,function(Lt){Lt.preventDefault(),Dt.getOrCreateInstance(this).toggle()}),l.defineJQueryPlugin(Dt),Dt})}(Cg)),Cg.exports}R4();var Dg={exports:{}};/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var N4=Dg.exports,Bw;function k4(){return Bw||(Bw=1,function(n,t){(function(e,r){n.exports=r()})(N4,function(){const e=new Map,r={set(U,w,k){e.has(U)||e.set(U,new Map);const K=e.get(U);K.has(w)||K.size===0?K.set(w,k):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(K.keys())[0]}.`)},get:(U,w)=>e.has(U)&&e.get(U).get(w)||null,remove(U,w){if(!e.has(U))return;const k=e.get(U);k.delete(w),k.size===0&&e.delete(U)}},i="transitionend",s=U=>(U&&window.CSS&&window.CSS.escape&&(U=U.replace(/#([^\s"#']+)/g,(w,k)=>`#${CSS.escape(k)}`)),U),o=U=>{U.dispatchEvent(new Event(i))},l=U=>!(!U||typeof U!="object")&&(U.jquery!==void 0&&(U=U[0]),U.nodeType!==void 0),u=U=>l(U)?U.jquery?U[0]:U:typeof U=="string"&&U.length>0?document.querySelector(s(U)):null,h=U=>{if(!l(U)||U.getClientRects().length===0)return!1;const w=getComputedStyle(U).getPropertyValue("visibility")==="visible",k=U.closest("details:not([open])");if(!k)return w;if(k!==U){const K=U.closest("summary");if(K&&K.parentNode!==k||K===null)return!1}return w},d=U=>!U||U.nodeType!==Node.ELEMENT_NODE||!!U.classList.contains("disabled")||(U.disabled!==void 0?U.disabled:U.hasAttribute("disabled")&&U.getAttribute("disabled")!=="false"),p=U=>{if(!document.documentElement.attachShadow)return null;if(typeof U.getRootNode=="function"){const w=U.getRootNode();return w instanceof ShadowRoot?w:null}return U instanceof ShadowRoot?U:U.parentNode?p(U.parentNode):null},g=()=>{},v=U=>{U.offsetHeight},y=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_=[],b=()=>document.documentElement.dir==="rtl",E=U=>{var w;w=()=>{const k=y();if(k){const K=U.NAME,vt=k.fn[K];k.fn[K]=U.jQueryInterface,k.fn[K].Constructor=U,k.fn[K].noConflict=()=>(k.fn[K]=vt,U.jQueryInterface)}},document.readyState==="loading"?(_.length||document.addEventListener("DOMContentLoaded",()=>{for(const k of _)k()}),_.push(w)):w()},S=(U,w=[],k=U)=>typeof U=="function"?U.call(...w):k,T=(U,w,k=!0)=>{if(!k)return void S(U);const K=(jt=>{if(!jt)return 0;let{transitionDuration:Wt,transitionDelay:ne}=window.getComputedStyle(jt);const ue=Number.parseFloat(Wt),fe=Number.parseFloat(ne);return ue||fe?(Wt=Wt.split(",")[0],ne=ne.split(",")[0],1e3*(Number.parseFloat(Wt)+Number.parseFloat(ne))):0})(w)+5;let vt=!1;const wt=({target:jt})=>{jt===w&&(vt=!0,w.removeEventListener(i,wt),S(U))};w.addEventListener(i,wt),setTimeout(()=>{vt||o(w)},K)},O=(U,w,k,K)=>{const vt=U.length;let wt=U.indexOf(w);return wt===-1?!k&&K?U[vt-1]:U[0]:(wt+=k?1:-1,K&&(wt=(wt+vt)%vt),U[Math.max(0,Math.min(wt,vt-1))])},R=/[^.]*(?=\..*)\.|.*/,N=/\..*/,C=/::\d+$/,I={};let M=1;const F={mouseenter:"mouseover",mouseleave:"mouseout"},H=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function P(U,w){return w&&`${w}::${M++}`||U.uidEvent||M++}function et(U){const w=P(U);return U.uidEvent=w,I[w]=I[w]||{},I[w]}function L(U,w,k=null){return Object.values(U).find(K=>K.callable===w&&K.delegationSelector===k)}function st(U,w,k){const K=typeof w=="string",vt=K?k:w||k;let wt=Et(U);return H.has(wt)||(wt=U),[K,vt,wt]}function Q(U,w,k,K,vt){if(typeof w!="string"||!U)return;let[wt,jt,Wt]=st(w,k,K);w in F&&(jt=(Pe=>function(Re){if(!Re.relatedTarget||Re.relatedTarget!==Re.delegateTarget&&!Re.delegateTarget.contains(Re.relatedTarget))return Pe.call(this,Re)})(jt));const ne=et(U),ue=ne[Wt]||(ne[Wt]={}),fe=L(ue,jt,wt?k:null);if(fe)return void(fe.oneOff=fe.oneOff&&vt);const le=P(jt,w.replace(R,"")),Ie=wt?function(xe,Pe,Re){return function Te(an){const hn=xe.querySelectorAll(Pe);for(let{target:He}=an;He&&He!==this;He=He.parentNode)for(const Qe of hn)if(Qe===He)return J(an,{delegateTarget:He}),Te.oneOff&&z.off(xe,an.type,Pe,Re),Re.apply(He,[an])}}(U,k,jt):function(xe,Pe){return function Re(Te){return J(Te,{delegateTarget:xe}),Re.oneOff&&z.off(xe,Te.type,Pe),Pe.apply(xe,[Te])}}(U,jt);Ie.delegationSelector=wt?k:null,Ie.callable=jt,Ie.oneOff=vt,Ie.uidEvent=le,ue[le]=Ie,U.addEventListener(Wt,Ie,wt)}function Y(U,w,k,K,vt){const wt=L(w[k],K,vt);wt&&(U.removeEventListener(k,wt,!!vt),delete w[k][wt.uidEvent])}function Ot(U,w,k,K){const vt=w[k]||{};for(const[wt,jt]of Object.entries(vt))wt.includes(K)&&Y(U,w,k,jt.callable,jt.delegationSelector)}function Et(U){return U=U.replace(N,""),F[U]||U}const z={on(U,w,k,K){Q(U,w,k,K,!1)},one(U,w,k,K){Q(U,w,k,K,!0)},off(U,w,k,K){if(typeof w!="string"||!U)return;const[vt,wt,jt]=st(w,k,K),Wt=jt!==w,ne=et(U),ue=ne[jt]||{},fe=w.startsWith(".");if(wt===void 0){if(fe)for(const le of Object.keys(ne))Ot(U,ne,le,w.slice(1));for(const[le,Ie]of Object.entries(ue)){const xe=le.replace(C,"");Wt&&!w.includes(xe)||Y(U,ne,jt,Ie.callable,Ie.delegationSelector)}}else{if(!Object.keys(ue).length)return;Y(U,ne,jt,wt,vt?k:null)}},trigger(U,w,k){if(typeof w!="string"||!U)return null;const K=y();let vt=null,wt=!0,jt=!0,Wt=!1;w!==Et(w)&&K&&(vt=K.Event(w,k),K(U).trigger(vt),wt=!vt.isPropagationStopped(),jt=!vt.isImmediatePropagationStopped(),Wt=vt.isDefaultPrevented());const ne=J(new Event(w,{bubbles:wt,cancelable:!0}),k);return Wt&&ne.preventDefault(),jt&&U.dispatchEvent(ne),ne.defaultPrevented&&vt&&vt.preventDefault(),ne}};function J(U,w={}){for(const[k,K]of Object.entries(w))try{U[k]=K}catch{Object.defineProperty(U,k,{configurable:!0,get:()=>K})}return U}function V(U){if(U==="true")return!0;if(U==="false")return!1;if(U===Number(U).toString())return Number(U);if(U===""||U==="null")return null;if(typeof U!="string")return U;try{return JSON.parse(decodeURIComponent(U))}catch{return U}}function ct(U){return U.replace(/[A-Z]/g,w=>`-${w.toLowerCase()}`)}const gt={setDataAttribute(U,w,k){U.setAttribute(`data-bs-${ct(w)}`,k)},removeDataAttribute(U,w){U.removeAttribute(`data-bs-${ct(w)}`)},getDataAttributes(U){if(!U)return{};const w={},k=Object.keys(U.dataset).filter(K=>K.startsWith("bs")&&!K.startsWith("bsConfig"));for(const K of k){let vt=K.replace(/^bs/,"");vt=vt.charAt(0).toLowerCase()+vt.slice(1),w[vt]=V(U.dataset[K])}return w},getDataAttribute:(U,w)=>V(U.getAttribute(`data-bs-${ct(w)}`))};class _t{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(w){return w=this._mergeConfigObj(w),w=this._configAfterMerge(w),this._typeCheckConfig(w),w}_configAfterMerge(w){return w}_mergeConfigObj(w,k){const K=l(k)?gt.getDataAttribute(k,"config"):{};return{...this.constructor.Default,...typeof K=="object"?K:{},...l(k)?gt.getDataAttributes(k):{},...typeof w=="object"?w:{}}}_typeCheckConfig(w,k=this.constructor.DefaultType){for(const[vt,wt]of Object.entries(k)){const jt=w[vt],Wt=l(jt)?"element":(K=jt)==null?`${K}`:Object.prototype.toString.call(K).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(wt).test(Wt))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${vt}" provided type "${Wt}" but expected type "${wt}".`)}var K}}class Bt extends _t{constructor(w,k){super(),(w=u(w))&&(this._element=w,this._config=this._getConfig(k),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),z.off(this._element,this.constructor.EVENT_KEY);for(const w of Object.getOwnPropertyNames(this))this[w]=null}_queueCallback(w,k,K=!0){T(w,k,K)}_getConfig(w){return w=this._mergeConfigObj(w,this._element),w=this._configAfterMerge(w),this._typeCheckConfig(w),w}static getInstance(w){return r.get(u(w),this.DATA_KEY)}static getOrCreateInstance(w,k={}){return this.getInstance(w)||new this(w,typeof k=="object"?k:null)}static get VERSION(){return"5.3.7"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(w){return`${w}${this.EVENT_KEY}`}}const Gt=U=>{let w=U.getAttribute("data-bs-target");if(!w||w==="#"){let k=U.getAttribute("href");if(!k||!k.includes("#")&&!k.startsWith("."))return null;k.includes("#")&&!k.startsWith("#")&&(k=`#${k.split("#")[1]}`),w=k&&k!=="#"?k.trim():null}return w?w.split(",").map(k=>s(k)).join(","):null},j={find:(U,w=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(w,U)),findOne:(U,w=document.documentElement)=>Element.prototype.querySelector.call(w,U),children:(U,w)=>[].concat(...U.children).filter(k=>k.matches(w)),parents(U,w){const k=[];let K=U.parentNode.closest(w);for(;K;)k.push(K),K=K.parentNode.closest(w);return k},prev(U,w){let k=U.previousElementSibling;for(;k;){if(k.matches(w))return[k];k=k.previousElementSibling}return[]},next(U,w){let k=U.nextElementSibling;for(;k;){if(k.matches(w))return[k];k=k.nextElementSibling}return[]},focusableChildren(U){const w=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(k=>`${k}:not([tabindex^="-"])`).join(",");return this.find(w,U).filter(k=>!d(k)&&h(k))},getSelectorFromElement(U){const w=Gt(U);return w&&j.findOne(w)?w:null},getElementFromSelector(U){const w=Gt(U);return w?j.findOne(w):null},getMultipleElementsFromSelector(U){const w=Gt(U);return w?j.find(w):[]}},pt=(U,w="hide")=>{const k=`click.dismiss${U.EVENT_KEY}`,K=U.NAME;z.on(document,k,`[data-bs-dismiss="${K}"]`,function(vt){if(["A","AREA"].includes(this.tagName)&&vt.preventDefault(),d(this))return;const wt=j.getElementFromSelector(this)||this.closest(`.${K}`);U.getOrCreateInstance(wt)[w]()})},lt=".bs.alert",ut=`close${lt}`,Dt=`closed${lt}`;class Lt extends Bt{static get NAME(){return"alert"}close(){if(z.trigger(this._element,ut).defaultPrevented)return;this._element.classList.remove("show");const w=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,w)}_destroyElement(){this._element.remove(),z.trigger(this._element,Dt),this.dispose()}static jQueryInterface(w){return this.each(function(){const k=Lt.getOrCreateInstance(this);if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w](this)}})}}pt(Lt,"close"),E(Lt);const D='[data-bs-toggle="button"]';class dt extends Bt{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(w){return this.each(function(){const k=dt.getOrCreateInstance(this);w==="toggle"&&k[w]()})}}z.on(document,"click.bs.button.data-api",D,U=>{U.preventDefault();const w=U.target.closest(D);dt.getOrCreateInstance(w).toggle()}),E(dt);const it=".bs.swipe",q=`touchstart${it}`,X=`touchmove${it}`,ft=`touchend${it}`,Pt=`pointerdown${it}`,zt=`pointerup${it}`,bt={endCallback:null,leftCallback:null,rightCallback:null},Rt={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class qt extends _t{constructor(w,k){super(),this._element=w,w&&qt.isSupported()&&(this._config=this._getConfig(k),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return bt}static get DefaultType(){return Rt}static get NAME(){return"swipe"}dispose(){z.off(this._element,it)}_start(w){this._supportPointerEvents?this._eventIsPointerPenTouch(w)&&(this._deltaX=w.clientX):this._deltaX=w.touches[0].clientX}_end(w){this._eventIsPointerPenTouch(w)&&(this._deltaX=w.clientX-this._deltaX),this._handleSwipe(),S(this._config.endCallback)}_move(w){this._deltaX=w.touches&&w.touches.length>1?0:w.touches[0].clientX-this._deltaX}_handleSwipe(){const w=Math.abs(this._deltaX);if(w<=40)return;const k=w/this._deltaX;this._deltaX=0,k&&S(k>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(z.on(this._element,Pt,w=>this._start(w)),z.on(this._element,zt,w=>this._end(w)),this._element.classList.add("pointer-event")):(z.on(this._element,q,w=>this._start(w)),z.on(this._element,X,w=>this._move(w)),z.on(this._element,ft,w=>this._end(w)))}_eventIsPointerPenTouch(w){return this._supportPointerEvents&&(w.pointerType==="pen"||w.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const xt=".bs.carousel",se=".data-api",de="ArrowLeft",ae="ArrowRight",ze="next",Cn="prev",Se="left",_n="right",qe=`slide${xt}`,yr=`slid${xt}`,Bn=`keydown${xt}`,kn=`mouseenter${xt}`,ai=`mouseleave${xt}`,Fo=`dragstart${xt}`,$a=`load${xt}${se}`,Ga=`click${xt}${se}`,zs="carousel",br="active",Ci=".active",Pl=".carousel-item",Gc=Ci+Pl,Fl={[de]:_n,[ae]:Se},Bl={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Vc={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class aa extends Bt{constructor(w,k){super(w,k),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=j.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===zs&&this.cycle()}static get Default(){return Bl}static get DefaultType(){return Vc}static get NAME(){return"carousel"}next(){this._slide(ze)}nextWhenVisible(){!document.hidden&&h(this._element)&&this.next()}prev(){this._slide(Cn)}pause(){this._isSliding&&o(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?z.one(this._element,yr,()=>this.cycle()):this.cycle())}to(w){const k=this._getItems();if(w>k.length-1||w<0)return;if(this._isSliding)return void z.one(this._element,yr,()=>this.to(w));const K=this._getItemIndex(this._getActive());if(K===w)return;const vt=w>K?ze:Cn;this._slide(vt,k[w])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(w){return w.defaultInterval=w.interval,w}_addEventListeners(){this._config.keyboard&&z.on(this._element,Bn,w=>this._keydown(w)),this._config.pause==="hover"&&(z.on(this._element,kn,()=>this.pause()),z.on(this._element,ai,()=>this._maybeEnableCycle())),this._config.touch&&qt.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const k of j.find(".carousel-item img",this._element))z.on(k,Fo,K=>K.preventDefault());const w={leftCallback:()=>this._slide(this._directionToOrder(Se)),rightCallback:()=>this._slide(this._directionToOrder(_n)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new qt(this._element,w)}_keydown(w){if(/input|textarea/i.test(w.target.tagName))return;const k=Fl[w.key];k&&(w.preventDefault(),this._slide(this._directionToOrder(k)))}_getItemIndex(w){return this._getItems().indexOf(w)}_setActiveIndicatorElement(w){if(!this._indicatorsElement)return;const k=j.findOne(Ci,this._indicatorsElement);k.classList.remove(br),k.removeAttribute("aria-current");const K=j.findOne(`[data-bs-slide-to="${w}"]`,this._indicatorsElement);K&&(K.classList.add(br),K.setAttribute("aria-current","true"))}_updateInterval(){const w=this._activeElement||this._getActive();if(!w)return;const k=Number.parseInt(w.getAttribute("data-bs-interval"),10);this._config.interval=k||this._config.defaultInterval}_slide(w,k=null){if(this._isSliding)return;const K=this._getActive(),vt=w===ze,wt=k||O(this._getItems(),K,vt,this._config.wrap);if(wt===K)return;const jt=this._getItemIndex(wt),Wt=le=>z.trigger(this._element,le,{relatedTarget:wt,direction:this._orderToDirection(w),from:this._getItemIndex(K),to:jt});if(Wt(qe).defaultPrevented||!K||!wt)return;const ne=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(jt),this._activeElement=wt;const ue=vt?"carousel-item-start":"carousel-item-end",fe=vt?"carousel-item-next":"carousel-item-prev";wt.classList.add(fe),v(wt),K.classList.add(ue),wt.classList.add(ue),this._queueCallback(()=>{wt.classList.remove(ue,fe),wt.classList.add(br),K.classList.remove(br,fe,ue),this._isSliding=!1,Wt(yr)},K,this._isAnimated()),ne&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return j.findOne(Gc,this._element)}_getItems(){return j.find(Pl,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(w){return b()?w===Se?Cn:ze:w===Se?ze:Cn}_orderToDirection(w){return b()?w===Cn?Se:_n:w===Cn?_n:Se}static jQueryInterface(w){return this.each(function(){const k=aa.getOrCreateInstance(this,w);if(typeof w!="number"){if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w]()}}else k.to(w)})}}z.on(document,Ga,"[data-bs-slide], [data-bs-slide-to]",function(U){const w=j.getElementFromSelector(this);if(!w||!w.classList.contains(zs))return;U.preventDefault();const k=aa.getOrCreateInstance(w),K=this.getAttribute("data-bs-slide-to");return K?(k.to(K),void k._maybeEnableCycle()):gt.getDataAttribute(this,"slide")==="next"?(k.next(),void k._maybeEnableCycle()):(k.prev(),void k._maybeEnableCycle())}),z.on(window,$a,()=>{const U=j.find('[data-bs-ride="carousel"]');for(const w of U)aa.getOrCreateInstance(w)}),E(aa);const Hr=".bs.collapse",tr=`show${Hr}`,er=`shown${Hr}`,oa=`hide${Hr}`,Ul=`hidden${Hr}`,Tf=`click${Hr}.data-api`,G="show",rt="collapse",Z="collapsing",tt=`:scope .${rt} .${rt}`,nt='[data-bs-toggle="collapse"]',at={parent:null,toggle:!0},kt={parent:"(null|element)",toggle:"boolean"};class Ht extends Bt{constructor(w,k){super(w,k),this._isTransitioning=!1,this._triggerArray=[];const K=j.find(nt);for(const vt of K){const wt=j.getSelectorFromElement(vt),jt=j.find(wt).filter(Wt=>Wt===this._element);wt!==null&&jt.length&&this._triggerArray.push(vt)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return at}static get DefaultType(){return kt}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let w=[];if(this._config.parent&&(w=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(vt=>vt!==this._element).map(vt=>Ht.getOrCreateInstance(vt,{toggle:!1}))),w.length&&w[0]._isTransitioning||z.trigger(this._element,tr).defaultPrevented)return;for(const vt of w)vt.hide();const k=this._getDimension();this._element.classList.remove(rt),this._element.classList.add(Z),this._element.style[k]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const K=`scroll${k[0].toUpperCase()+k.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Z),this._element.classList.add(rt,G),this._element.style[k]="",z.trigger(this._element,er)},this._element,!0),this._element.style[k]=`${this._element[K]}px`}hide(){if(this._isTransitioning||!this._isShown()||z.trigger(this._element,oa).defaultPrevented)return;const w=this._getDimension();this._element.style[w]=`${this._element.getBoundingClientRect()[w]}px`,v(this._element),this._element.classList.add(Z),this._element.classList.remove(rt,G);for(const k of this._triggerArray){const K=j.getElementFromSelector(k);K&&!this._isShown(K)&&this._addAriaAndCollapsedClass([k],!1)}this._isTransitioning=!0,this._element.style[w]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Z),this._element.classList.add(rt),z.trigger(this._element,Ul)},this._element,!0)}_isShown(w=this._element){return w.classList.contains(G)}_configAfterMerge(w){return w.toggle=!!w.toggle,w.parent=u(w.parent),w}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const w=this._getFirstLevelChildren(nt);for(const k of w){const K=j.getElementFromSelector(k);K&&this._addAriaAndCollapsedClass([k],this._isShown(K))}}_getFirstLevelChildren(w){const k=j.find(tt,this._config.parent);return j.find(w,this._config.parent).filter(K=>!k.includes(K))}_addAriaAndCollapsedClass(w,k){if(w.length)for(const K of w)K.classList.toggle("collapsed",!k),K.setAttribute("aria-expanded",k)}static jQueryInterface(w){const k={};return typeof w=="string"&&/show|hide/.test(w)&&(k.toggle=!1),this.each(function(){const K=Ht.getOrCreateInstance(this,k);if(typeof w=="string"){if(K[w]===void 0)throw new TypeError(`No method named "${w}"`);K[w]()}})}}z.on(document,Tf,nt,function(U){(U.target.tagName==="A"||U.delegateTarget&&U.delegateTarget.tagName==="A")&&U.preventDefault();for(const w of j.getMultipleElementsFromSelector(this))Ht.getOrCreateInstance(w,{toggle:!1}).toggle()}),E(Ht);var yt="top",Tt="bottom",Ct="right",Vt="left",te="auto",oe=[yt,Tt,Ct,Vt],Qt="start",ee="end",Le="clippingParents",rn="viewport",Ze="popper",fn="reference",Gi=oe.reduce(function(U,w){return U.concat([w+"-"+Qt,w+"-"+ee])},[]),ps=[].concat(oe,[te]).reduce(function(U,w){return U.concat([w,w+"-"+Qt,w+"-"+ee])},[]),oi="beforeRead",Di="read",la="afterRead",Oi="beforeMain",Cf="main",li="afterMain",Df="beforeWrite",f0="write",zl="afterWrite",Of=[oi,Di,la,Oi,Cf,li,Df,f0,zl];function ci(U){return U?(U.nodeName||"").toLowerCase():null}function ui(U){if(U==null)return window;if(U.toString()!=="[object Window]"){var w=U.ownerDocument;return w&&w.defaultView||window}return U}function nr(U){return U instanceof ui(U).Element||U instanceof Element}function jr(U){return U instanceof ui(U).HTMLElement||U instanceof HTMLElement}function Wc(U){return typeof ShadowRoot<"u"&&(U instanceof ui(U).ShadowRoot||U instanceof ShadowRoot)}const Hl={name:"applyStyles",enabled:!0,phase:"write",fn:function(U){var w=U.state;Object.keys(w.elements).forEach(function(k){var K=w.styles[k]||{},vt=w.attributes[k]||{},wt=w.elements[k];jr(wt)&&ci(wt)&&(Object.assign(wt.style,K),Object.keys(vt).forEach(function(jt){var Wt=vt[jt];Wt===!1?wt.removeAttribute(jt):wt.setAttribute(jt,Wt===!0?"":Wt)}))})},effect:function(U){var w=U.state,k={popper:{position:w.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(w.elements.popper.style,k.popper),w.styles=k,w.elements.arrow&&Object.assign(w.elements.arrow.style,k.arrow),function(){Object.keys(w.elements).forEach(function(K){var vt=w.elements[K],wt=w.attributes[K]||{},jt=Object.keys(w.styles.hasOwnProperty(K)?w.styles[K]:k[K]).reduce(function(Wt,ne){return Wt[ne]="",Wt},{});jr(vt)&&ci(vt)&&(Object.assign(vt.style,jt),Object.keys(wt).forEach(function(Wt){vt.removeAttribute(Wt)}))})}},requires:["computeStyles"]};function Or(U){return U.split("-")[0]}var ca=Math.max,jl=Math.min,Vi=Math.round;function Rf(){var U=navigator.userAgentData;return U!=null&&U.brands&&Array.isArray(U.brands)?U.brands.map(function(w){return w.brand+"/"+w.version}).join(" "):navigator.userAgent}function Nf(){return!/^((?!chrome|android).)*safari/i.test(Rf())}function Va(U,w,k){w===void 0&&(w=!1),k===void 0&&(k=!1);var K=U.getBoundingClientRect(),vt=1,wt=1;w&&jr(U)&&(vt=U.offsetWidth>0&&Vi(K.width)/U.offsetWidth||1,wt=U.offsetHeight>0&&Vi(K.height)/U.offsetHeight||1);var jt=(nr(U)?ui(U):window).visualViewport,Wt=!Nf()&&k,ne=(K.left+(Wt&&jt?jt.offsetLeft:0))/vt,ue=(K.top+(Wt&&jt?jt.offsetTop:0))/wt,fe=K.width/vt,le=K.height/wt;return{width:fe,height:le,top:ue,right:ne+fe,bottom:ue+le,left:ne,x:ne,y:ue}}function $l(U){var w=Va(U),k=U.offsetWidth,K=U.offsetHeight;return Math.abs(w.width-k)<=1&&(k=w.width),Math.abs(w.height-K)<=1&&(K=w.height),{x:U.offsetLeft,y:U.offsetTop,width:k,height:K}}function h0(U,w){var k=w.getRootNode&&w.getRootNode();if(U.contains(w))return!0;if(k&&Wc(k)){var K=w;do{if(K&&U.isSameNode(K))return!0;K=K.parentNode||K.host}while(K)}return!1}function Hs(U){return ui(U).getComputedStyle(U)}function Xc(U){return["table","td","th"].indexOf(ci(U))>=0}function gs(U){return((nr(U)?U.ownerDocument:U.document)||window.document).documentElement}function Bo(U){return ci(U)==="html"?U:U.assignedSlot||U.parentNode||(Wc(U)?U.host:null)||gs(U)}function Wa(U){return jr(U)&&Hs(U).position!=="fixed"?U.offsetParent:null}function ms(U){for(var w=ui(U),k=Wa(U);k&&Xc(k)&&Hs(k).position==="static";)k=Wa(k);return k&&(ci(k)==="html"||ci(k)==="body"&&Hs(k).position==="static")?w:k||function(K){var vt=/firefox/i.test(Rf());if(/Trident/i.test(Rf())&&jr(K)&&Hs(K).position==="fixed")return null;var wt=Bo(K);for(Wc(wt)&&(wt=wt.host);jr(wt)&&["html","body"].indexOf(ci(wt))<0;){var jt=Hs(wt);if(jt.transform!=="none"||jt.perspective!=="none"||jt.contain==="paint"||["transform","perspective"].indexOf(jt.willChange)!==-1||vt&&jt.willChange==="filter"||vt&&jt.filter&&jt.filter!=="none")return wt;wt=wt.parentNode}return null}(U)||w}function Yc(U){return["top","bottom"].indexOf(U)>=0?"x":"y"}function Xa(U,w,k){return ca(U,jl(w,k))}function kf(U){return Object.assign({},{top:0,right:0,bottom:0,left:0},U)}function Uo(U,w){return w.reduce(function(k,K){return k[K]=U,k},{})}const vs={name:"arrow",enabled:!0,phase:"main",fn:function(U){var w,k=U.state,K=U.name,vt=U.options,wt=k.elements.arrow,jt=k.modifiersData.popperOffsets,Wt=Or(k.placement),ne=Yc(Wt),ue=[Vt,Ct].indexOf(Wt)>=0?"height":"width";if(wt&&jt){var fe=function(ke,Je){return kf(typeof(ke=typeof ke=="function"?ke(Object.assign({},Je.rects,{placement:Je.placement})):ke)!="number"?ke:Uo(ke,oe))}(vt.padding,k),le=$l(wt),Ie=ne==="y"?yt:Vt,xe=ne==="y"?Tt:Ct,Pe=k.rects.reference[ue]+k.rects.reference[ne]-jt[ne]-k.rects.popper[ue],Re=jt[ne]-k.rects.reference[ne],Te=ms(wt),an=Te?ne==="y"?Te.clientHeight||0:Te.clientWidth||0:0,hn=Pe/2-Re/2,He=fe[Ie],Qe=an-le[ue]-fe[xe],Ne=an/2-le[ue]/2+hn,ce=Xa(He,Ne,Qe),ve=ne;k.modifiersData[K]=((w={})[ve]=ce,w.centerOffset=ce-Ne,w)}},effect:function(U){var w=U.state,k=U.options.element,K=k===void 0?"[data-popper-arrow]":k;K!=null&&(typeof K!="string"||(K=w.elements.popper.querySelector(K)))&&h0(w.elements.popper,K)&&(w.elements.arrow=K)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ua(U){return U.split("-")[1]}var Gl={top:"auto",right:"auto",bottom:"auto",left:"auto"};function js(U){var w,k=U.popper,K=U.popperRect,vt=U.placement,wt=U.variation,jt=U.offsets,Wt=U.position,ne=U.gpuAcceleration,ue=U.adaptive,fe=U.roundOffsets,le=U.isFixed,Ie=jt.x,xe=Ie===void 0?0:Ie,Pe=jt.y,Re=Pe===void 0?0:Pe,Te=typeof fe=="function"?fe({x:xe,y:Re}):{x:xe,y:Re};xe=Te.x,Re=Te.y;var an=jt.hasOwnProperty("x"),hn=jt.hasOwnProperty("y"),He=Vt,Qe=yt,Ne=window;if(ue){var ce=ms(k),ve="clientHeight",ke="clientWidth";ce===ui(k)&&Hs(ce=gs(k)).position!=="static"&&Wt==="absolute"&&(ve="scrollHeight",ke="scrollWidth"),(vt===yt||(vt===Vt||vt===Ct)&&wt===ee)&&(Qe=Tt,Re-=(le&&ce===Ne&&Ne.visualViewport?Ne.visualViewport.height:ce[ve])-K.height,Re*=ne?1:-1),vt!==Vt&&(vt!==yt&&vt!==Tt||wt!==ee)||(He=Ct,xe-=(le&&ce===Ne&&Ne.visualViewport?Ne.visualViewport.width:ce[ke])-K.width,xe*=ne?1:-1)}var Je,yn=Object.assign({position:Wt},ue&&Gl),Vn=fe===!0?function(Wr,Wn){var dr=Wr.x,Li=Wr.y,Be=Wn.devicePixelRatio||1;return{x:Vi(dr*Be)/Be||0,y:Vi(Li*Be)/Be||0}}({x:xe,y:Re},ui(k)):{x:xe,y:Re};return xe=Vn.x,Re=Vn.y,ne?Object.assign({},yn,((Je={})[Qe]=hn?"0":"",Je[He]=an?"0":"",Je.transform=(Ne.devicePixelRatio||1)<=1?"translate("+xe+"px, "+Re+"px)":"translate3d("+xe+"px, "+Re+"px, 0)",Je)):Object.assign({},yn,((w={})[Qe]=hn?Re+"px":"",w[He]=an?xe+"px":"",w.transform="",w))}const Vl={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(U){var w=U.state,k=U.options,K=k.gpuAcceleration,vt=K===void 0||K,wt=k.adaptive,jt=wt===void 0||wt,Wt=k.roundOffsets,ne=Wt===void 0||Wt,ue={placement:Or(w.placement),variation:ua(w.placement),popper:w.elements.popper,popperRect:w.rects.popper,gpuAcceleration:vt,isFixed:w.options.strategy==="fixed"};w.modifiersData.popperOffsets!=null&&(w.styles.popper=Object.assign({},w.styles.popper,js(Object.assign({},ue,{offsets:w.modifiersData.popperOffsets,position:w.options.strategy,adaptive:jt,roundOffsets:ne})))),w.modifiersData.arrow!=null&&(w.styles.arrow=Object.assign({},w.styles.arrow,js(Object.assign({},ue,{offsets:w.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:ne})))),w.attributes.popper=Object.assign({},w.attributes.popper,{"data-popper-placement":w.placement})},data:{}};var Ya={passive:!0};const qc={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(U){var w=U.state,k=U.instance,K=U.options,vt=K.scroll,wt=vt===void 0||vt,jt=K.resize,Wt=jt===void 0||jt,ne=ui(w.elements.popper),ue=[].concat(w.scrollParents.reference,w.scrollParents.popper);return wt&&ue.forEach(function(fe){fe.addEventListener("scroll",k.update,Ya)}),Wt&&ne.addEventListener("resize",k.update,Ya),function(){wt&&ue.forEach(function(fe){fe.removeEventListener("scroll",k.update,Ya)}),Wt&&ne.removeEventListener("resize",k.update,Ya)}},data:{}};var Kc={left:"right",right:"left",bottom:"top",top:"bottom"};function qa(U){return U.replace(/left|right|bottom|top/g,function(w){return Kc[w]})}var d0={start:"end",end:"start"};function Rr(U){return U.replace(/start|end/g,function(w){return d0[w]})}function $s(U){var w=ui(U);return{scrollLeft:w.pageXOffset,scrollTop:w.pageYOffset}}function zo(U){return Va(gs(U)).left+$s(U).scrollLeft}function Ka(U){var w=Hs(U),k=w.overflow,K=w.overflowX,vt=w.overflowY;return/auto|scroll|overlay|hidden/.test(k+vt+K)}function p0(U){return["html","body","#document"].indexOf(ci(U))>=0?U.ownerDocument.body:jr(U)&&Ka(U)?U:p0(Bo(U))}function Za(U,w){var k;w===void 0&&(w=[]);var K=p0(U),vt=K===((k=U.ownerDocument)==null?void 0:k.body),wt=ui(K),jt=vt?[wt].concat(wt.visualViewport||[],Ka(K)?K:[]):K,Wt=w.concat(jt);return vt?Wt:Wt.concat(Za(Bo(jt)))}function Wl(U){return Object.assign({},U,{left:U.x,top:U.y,right:U.x+U.width,bottom:U.y+U.height})}function Ho(U,w,k){return w===rn?Wl(function(K,vt){var wt=ui(K),jt=gs(K),Wt=wt.visualViewport,ne=jt.clientWidth,ue=jt.clientHeight,fe=0,le=0;if(Wt){ne=Wt.width,ue=Wt.height;var Ie=Nf();(Ie||!Ie&&vt==="fixed")&&(fe=Wt.offsetLeft,le=Wt.offsetTop)}return{width:ne,height:ue,x:fe+zo(K),y:le}}(U,k)):nr(w)?function(K,vt){var wt=Va(K,!1,vt==="fixed");return wt.top=wt.top+K.clientTop,wt.left=wt.left+K.clientLeft,wt.bottom=wt.top+K.clientHeight,wt.right=wt.left+K.clientWidth,wt.width=K.clientWidth,wt.height=K.clientHeight,wt.x=wt.left,wt.y=wt.top,wt}(w,k):Wl(function(K){var vt,wt=gs(K),jt=$s(K),Wt=(vt=K.ownerDocument)==null?void 0:vt.body,ne=ca(wt.scrollWidth,wt.clientWidth,Wt?Wt.scrollWidth:0,Wt?Wt.clientWidth:0),ue=ca(wt.scrollHeight,wt.clientHeight,Wt?Wt.scrollHeight:0,Wt?Wt.clientHeight:0),fe=-jt.scrollLeft+zo(K),le=-jt.scrollTop;return Hs(Wt||wt).direction==="rtl"&&(fe+=ca(wt.clientWidth,Wt?Wt.clientWidth:0)-ne),{width:ne,height:ue,x:fe,y:le}}(gs(U)))}function Xl(U){var w,k=U.reference,K=U.element,vt=U.placement,wt=vt?Or(vt):null,jt=vt?ua(vt):null,Wt=k.x+k.width/2-K.width/2,ne=k.y+k.height/2-K.height/2;switch(wt){case yt:w={x:Wt,y:k.y-K.height};break;case Tt:w={x:Wt,y:k.y+k.height};break;case Ct:w={x:k.x+k.width,y:ne};break;case Vt:w={x:k.x-K.width,y:ne};break;default:w={x:k.x,y:k.y}}var ue=wt?Yc(wt):null;if(ue!=null){var fe=ue==="y"?"height":"width";switch(jt){case Qt:w[ue]=w[ue]-(k[fe]/2-K[fe]/2);break;case ee:w[ue]=w[ue]+(k[fe]/2-K[fe]/2)}}return w}function Qa(U,w){w===void 0&&(w={});var k=w,K=k.placement,vt=K===void 0?U.placement:K,wt=k.strategy,jt=wt===void 0?U.strategy:wt,Wt=k.boundary,ne=Wt===void 0?Le:Wt,ue=k.rootBoundary,fe=ue===void 0?rn:ue,le=k.elementContext,Ie=le===void 0?Ze:le,xe=k.altBoundary,Pe=xe!==void 0&&xe,Re=k.padding,Te=Re===void 0?0:Re,an=kf(typeof Te!="number"?Te:Uo(Te,oe)),hn=Ie===Ze?fn:Ze,He=U.rects.popper,Qe=U.elements[Pe?hn:Ie],Ne=function(Wn,dr,Li,Be){var Mi=dr==="clippingParents"?function(dn){var pr=Za(Bo(dn)),Xr=["absolute","fixed"].indexOf(Hs(dn).position)>=0&&jr(dn)?ms(dn):dn;return nr(Xr)?pr.filter(function(xs){return nr(xs)&&h0(xs,Xr)&&ci(xs)!=="body"}):[]}(Wn):[].concat(dr),Ii=[].concat(Mi,[Li]),po=Ii[0],Xn=Ii.reduce(function(dn,pr){var Xr=Ho(Wn,pr,Be);return dn.top=ca(Xr.top,dn.top),dn.right=jl(Xr.right,dn.right),dn.bottom=jl(Xr.bottom,dn.bottom),dn.left=ca(Xr.left,dn.left),dn},Ho(Wn,po,Be));return Xn.width=Xn.right-Xn.left,Xn.height=Xn.bottom-Xn.top,Xn.x=Xn.left,Xn.y=Xn.top,Xn}(nr(Qe)?Qe:Qe.contextElement||gs(U.elements.popper),ne,fe,jt),ce=Va(U.elements.reference),ve=Xl({reference:ce,element:He,placement:vt}),ke=Wl(Object.assign({},He,ve)),Je=Ie===Ze?ke:ce,yn={top:Ne.top-Je.top+an.top,bottom:Je.bottom-Ne.bottom+an.bottom,left:Ne.left-Je.left+an.left,right:Je.right-Ne.right+an.right},Vn=U.modifiersData.offset;if(Ie===Ze&&Vn){var Wr=Vn[vt];Object.keys(yn).forEach(function(Wn){var dr=[Ct,Tt].indexOf(Wn)>=0?1:-1,Li=[yt,Tt].indexOf(Wn)>=0?"y":"x";yn[Wn]+=Wr[Li]*dr})}return yn}function e1(U,w){w===void 0&&(w={});var k=w,K=k.placement,vt=k.boundary,wt=k.rootBoundary,jt=k.padding,Wt=k.flipVariations,ne=k.allowedAutoPlacements,ue=ne===void 0?ps:ne,fe=ua(K),le=fe?Wt?Gi:Gi.filter(function(Pe){return ua(Pe)===fe}):oe,Ie=le.filter(function(Pe){return ue.indexOf(Pe)>=0});Ie.length===0&&(Ie=le);var xe=Ie.reduce(function(Pe,Re){return Pe[Re]=Qa(U,{placement:Re,boundary:vt,rootBoundary:wt,padding:jt})[Or(Re)],Pe},{});return Object.keys(xe).sort(function(Pe,Re){return xe[Pe]-xe[Re]})}const g0={name:"flip",enabled:!0,phase:"main",fn:function(U){var w=U.state,k=U.options,K=U.name;if(!w.modifiersData[K]._skip){for(var vt=k.mainAxis,wt=vt===void 0||vt,jt=k.altAxis,Wt=jt===void 0||jt,ne=k.fallbackPlacements,ue=k.padding,fe=k.boundary,le=k.rootBoundary,Ie=k.altBoundary,xe=k.flipVariations,Pe=xe===void 0||xe,Re=k.allowedAutoPlacements,Te=w.options.placement,an=Or(Te),hn=ne||(an!==Te&&Pe?function(dn){if(Or(dn)===te)return[];var pr=qa(dn);return[Rr(dn),pr,Rr(pr)]}(Te):[qa(Te)]),He=[Te].concat(hn).reduce(function(dn,pr){return dn.concat(Or(pr)===te?e1(w,{placement:pr,boundary:fe,rootBoundary:le,padding:ue,flipVariations:Pe,allowedAutoPlacements:Re}):pr)},[]),Qe=w.rects.reference,Ne=w.rects.popper,ce=new Map,ve=!0,ke=He[0],Je=0;Je<He.length;Je++){var yn=He[Je],Vn=Or(yn),Wr=ua(yn)===Qt,Wn=[yt,Tt].indexOf(Vn)>=0,dr=Wn?"width":"height",Li=Qa(w,{placement:yn,boundary:fe,rootBoundary:le,altBoundary:Ie,padding:ue}),Be=Wn?Wr?Ct:Vt:Wr?Tt:yt;Qe[dr]>Ne[dr]&&(Be=qa(Be));var Mi=qa(Be),Ii=[];if(wt&&Ii.push(Li[Vn]<=0),Wt&&Ii.push(Li[Be]<=0,Li[Mi]<=0),Ii.every(function(dn){return dn})){ke=yn,ve=!1;break}ce.set(yn,Ii)}if(ve)for(var po=function(dn){var pr=He.find(function(Xr){var xs=ce.get(Xr);if(xs)return xs.slice(0,dn).every(function(gr){return gr})});if(pr)return ke=pr,"break"},Xn=Pe?3:1;Xn>0&&po(Xn)!=="break";Xn--);w.placement!==ke&&(w.modifiersData[K]._skip=!0,w.placement=ke,w.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function m0(U,w,k){return k===void 0&&(k={x:0,y:0}),{top:U.top-w.height-k.y,right:U.right-w.width+k.x,bottom:U.bottom-w.height+k.y,left:U.left-w.width-k.x}}function Zc(U){return[yt,Ct,Tt,Vt].some(function(w){return U[w]>=0})}const v0={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(U){var w=U.state,k=U.name,K=w.rects.reference,vt=w.rects.popper,wt=w.modifiersData.preventOverflow,jt=Qa(w,{elementContext:"reference"}),Wt=Qa(w,{altBoundary:!0}),ne=m0(jt,K),ue=m0(Wt,vt,wt),fe=Zc(ne),le=Zc(ue);w.modifiersData[k]={referenceClippingOffsets:ne,popperEscapeOffsets:ue,isReferenceHidden:fe,hasPopperEscaped:le},w.attributes.popper=Object.assign({},w.attributes.popper,{"data-popper-reference-hidden":fe,"data-popper-escaped":le})}},_0={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(U){var w=U.state,k=U.options,K=U.name,vt=k.offset,wt=vt===void 0?[0,0]:vt,jt=ps.reduce(function(fe,le){return fe[le]=function(Ie,xe,Pe){var Re=Or(Ie),Te=[Vt,yt].indexOf(Re)>=0?-1:1,an=typeof Pe=="function"?Pe(Object.assign({},xe,{placement:Ie})):Pe,hn=an[0],He=an[1];return hn=hn||0,He=(He||0)*Te,[Vt,Ct].indexOf(Re)>=0?{x:He,y:hn}:{x:hn,y:He}}(le,w.rects,wt),fe},{}),Wt=jt[w.placement],ne=Wt.x,ue=Wt.y;w.modifiersData.popperOffsets!=null&&(w.modifiersData.popperOffsets.x+=ne,w.modifiersData.popperOffsets.y+=ue),w.modifiersData[K]=jt}},Lf={name:"popperOffsets",enabled:!0,phase:"read",fn:function(U){var w=U.state,k=U.name;w.modifiersData[k]=Xl({reference:w.rects.reference,element:w.rects.popper,placement:w.placement})},data:{}},y0={name:"preventOverflow",enabled:!0,phase:"main",fn:function(U){var w=U.state,k=U.options,K=U.name,vt=k.mainAxis,wt=vt===void 0||vt,jt=k.altAxis,Wt=jt!==void 0&&jt,ne=k.boundary,ue=k.rootBoundary,fe=k.altBoundary,le=k.padding,Ie=k.tether,xe=Ie===void 0||Ie,Pe=k.tetherOffset,Re=Pe===void 0?0:Pe,Te=Qa(w,{boundary:ne,rootBoundary:ue,padding:le,altBoundary:fe}),an=Or(w.placement),hn=ua(w.placement),He=!hn,Qe=Yc(an),Ne=Qe==="x"?"y":"x",ce=w.modifiersData.popperOffsets,ve=w.rects.reference,ke=w.rects.popper,Je=typeof Re=="function"?Re(Object.assign({},w.rects,{placement:w.placement})):Re,yn=typeof Je=="number"?{mainAxis:Je,altAxis:Je}:Object.assign({mainAxis:0,altAxis:0},Je),Vn=w.modifiersData.offset?w.modifiersData.offset[w.placement]:null,Wr={x:0,y:0};if(ce){if(wt){var Wn,dr=Qe==="y"?yt:Vt,Li=Qe==="y"?Tt:Ct,Be=Qe==="y"?"height":"width",Mi=ce[Qe],Ii=Mi+Te[dr],po=Mi-Te[Li],Xn=xe?-ke[Be]/2:0,dn=hn===Qt?ve[Be]:ke[Be],pr=hn===Qt?-ke[Be]:-ve[Be],Xr=w.elements.arrow,xs=xe&&Xr?$l(Xr):{width:0,height:0},gr=w.modifiersData["arrow#persistent"]?w.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Un=gr[dr],ou=gr[Li],ya=Xa(0,ve[Be],xs[Be]),lu=He?ve[Be]/2-Xn-ya-Un-yn.mainAxis:dn-ya-Un-yn.mainAxis,uh=He?-ve[Be]/2+Xn+ya+ou+yn.mainAxis:pr+ya+ou+yn.mainAxis,Yi=w.elements.arrow&&ms(w.elements.arrow),cu=Yi?Qe==="y"?Yi.clientTop||0:Yi.clientLeft||0:0,uu=(Wn=Vn?.[Qe])!=null?Wn:0,fh=Mi+uh-uu,hh=Xa(xe?jl(Ii,Mi+lu-uu-cu):Ii,Mi,xe?ca(po,fh):po);ce[Qe]=hh,Wr[Qe]=hh-Mi}if(Wt){var dh,ep=Qe==="x"?yt:Vt,np=Qe==="x"?Tt:Ct,ba=ce[Ne],rc=Ne==="y"?"height":"width",fu=ba+Te[ep],ph=ba-Te[np],gh=[yt,Vt].indexOf(an)!==-1,mh=(dh=Vn?.[Ne])!=null?dh:0,vh=gh?fu:ba-ve[rc]-ke[rc]-mh+yn.altAxis,_h=gh?ba+ve[rc]+ke[rc]-mh-yn.altAxis:ph,hu=xe&&gh?function(rp,ip,du){var yh=Xa(rp,ip,du);return yh>du?du:yh}(vh,ba,_h):Xa(xe?vh:fu,ba,xe?_h:ph);ce[Ne]=hu,Wr[Ne]=hu-ba}w.modifiersData[K]=Wr}},requiresIfExists:["offset"]};function n1(U,w,k){k===void 0&&(k=!1);var K,vt,wt=jr(w),jt=jr(w)&&function(le){var Ie=le.getBoundingClientRect(),xe=Vi(Ie.width)/le.offsetWidth||1,Pe=Vi(Ie.height)/le.offsetHeight||1;return xe!==1||Pe!==1}(w),Wt=gs(w),ne=Va(U,jt,k),ue={scrollLeft:0,scrollTop:0},fe={x:0,y:0};return(wt||!wt&&!k)&&((ci(w)!=="body"||Ka(Wt))&&(ue=(K=w)!==ui(K)&&jr(K)?{scrollLeft:(vt=K).scrollLeft,scrollTop:vt.scrollTop}:$s(K)),jr(w)?((fe=Va(w,!0)).x+=w.clientLeft,fe.y+=w.clientTop):Wt&&(fe.x=zo(Wt))),{x:ne.left+ue.scrollLeft-fe.x,y:ne.top+ue.scrollTop-fe.y,width:ne.width,height:ne.height}}function b0(U){var w=new Map,k=new Set,K=[];function vt(wt){k.add(wt.name),[].concat(wt.requires||[],wt.requiresIfExists||[]).forEach(function(jt){if(!k.has(jt)){var Wt=w.get(jt);Wt&&vt(Wt)}}),K.push(wt)}return U.forEach(function(wt){w.set(wt.name,wt)}),U.forEach(function(wt){k.has(wt.name)||vt(wt)}),K}var x0={placement:"bottom",modifiers:[],strategy:"absolute"};function E0(){for(var U=arguments.length,w=new Array(U),k=0;k<U;k++)w[k]=arguments[k];return!w.some(function(K){return!(K&&typeof K.getBoundingClientRect=="function")})}function Qc(U){U===void 0&&(U={});var w=U,k=w.defaultModifiers,K=k===void 0?[]:k,vt=w.defaultOptions,wt=vt===void 0?x0:vt;return function(jt,Wt,ne){ne===void 0&&(ne=wt);var ue,fe,le={placement:"bottom",orderedModifiers:[],options:Object.assign({},x0,wt),modifiersData:{},elements:{reference:jt,popper:Wt},attributes:{},styles:{}},Ie=[],xe=!1,Pe={state:le,setOptions:function(Te){var an=typeof Te=="function"?Te(le.options):Te;Re(),le.options=Object.assign({},wt,le.options,an),le.scrollParents={reference:nr(jt)?Za(jt):jt.contextElement?Za(jt.contextElement):[],popper:Za(Wt)};var hn,He,Qe=function(Ne){var ce=b0(Ne);return Of.reduce(function(ve,ke){return ve.concat(ce.filter(function(Je){return Je.phase===ke}))},[])}((hn=[].concat(K,le.options.modifiers),He=hn.reduce(function(Ne,ce){var ve=Ne[ce.name];return Ne[ce.name]=ve?Object.assign({},ve,ce,{options:Object.assign({},ve.options,ce.options),data:Object.assign({},ve.data,ce.data)}):ce,Ne},{}),Object.keys(He).map(function(Ne){return He[Ne]})));return le.orderedModifiers=Qe.filter(function(Ne){return Ne.enabled}),le.orderedModifiers.forEach(function(Ne){var ce=Ne.name,ve=Ne.options,ke=ve===void 0?{}:ve,Je=Ne.effect;if(typeof Je=="function"){var yn=Je({state:le,name:ce,instance:Pe,options:ke});Ie.push(yn||function(){})}}),Pe.update()},forceUpdate:function(){if(!xe){var Te=le.elements,an=Te.reference,hn=Te.popper;if(E0(an,hn)){le.rects={reference:n1(an,ms(hn),le.options.strategy==="fixed"),popper:$l(hn)},le.reset=!1,le.placement=le.options.placement,le.orderedModifiers.forEach(function(Je){return le.modifiersData[Je.name]=Object.assign({},Je.data)});for(var He=0;He<le.orderedModifiers.length;He++)if(le.reset!==!0){var Qe=le.orderedModifiers[He],Ne=Qe.fn,ce=Qe.options,ve=ce===void 0?{}:ce,ke=Qe.name;typeof Ne=="function"&&(le=Ne({state:le,options:ve,name:ke,instance:Pe})||le)}else le.reset=!1,He=-1}}},update:(ue=function(){return new Promise(function(Te){Pe.forceUpdate(),Te(le)})},function(){return fe||(fe=new Promise(function(Te){Promise.resolve().then(function(){fe=void 0,Te(ue())})})),fe}),destroy:function(){Re(),xe=!0}};if(!E0(jt,Wt))return Pe;function Re(){Ie.forEach(function(Te){return Te()}),Ie=[]}return Pe.setOptions(ne).then(function(Te){!xe&&ne.onFirstUpdate&&ne.onFirstUpdate(Te)}),Pe}}var r1=Qc(),Mf=Qc({defaultModifiers:[qc,Lf,Vl,Hl]}),If=Qc({defaultModifiers:[qc,Lf,Vl,Hl,_0,g0,y0,vs,v0]});const w0=Object.freeze(Object.defineProperty({__proto__:null,afterMain:li,afterRead:la,afterWrite:zl,applyStyles:Hl,arrow:vs,auto:te,basePlacements:oe,beforeMain:Oi,beforeRead:oi,beforeWrite:Df,bottom:Tt,clippingParents:Le,computeStyles:Vl,createPopper:If,createPopperBase:r1,createPopperLite:Mf,detectOverflow:Qa,end:ee,eventListeners:qc,flip:g0,hide:v0,left:Vt,main:Cf,modifierPhases:Of,offset:_0,placements:ps,popper:Ze,popperGenerator:Qc,popperOffsets:Lf,preventOverflow:y0,read:Di,reference:fn,right:Ct,start:Qt,top:yt,variationPlacements:Gi,viewport:rn,write:f0},Symbol.toStringTag,{value:"Module"})),A0="dropdown",fa=".bs.dropdown",Pf=".data-api",i1="ArrowUp",S0="ArrowDown",s1=`hide${fa}`,a1=`hidden${fa}`,o1=`show${fa}`,l1=`shown${fa}`,T0=`click${fa}${Pf}`,C0=`keydown${fa}${Pf}`,Ff=`keyup${fa}${Pf}`,_s="show",Ja='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',D0=`${Ja}.${_s}`,Yl=".dropdown-menu",O0=b()?"top-end":"top-start",R0=b()?"top-start":"top-end",N0=b()?"bottom-end":"bottom-start",jo=b()?"bottom-start":"bottom-end",c1=b()?"left-start":"right-start",u1=b()?"right-start":"left-start",f1={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},k0={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ri extends Bt{constructor(w,k){super(w,k),this._popper=null,this._parent=this._element.parentNode,this._menu=j.next(this._element,Yl)[0]||j.prev(this._element,Yl)[0]||j.findOne(Yl,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return f1}static get DefaultType(){return k0}static get NAME(){return A0}toggle(){return this._isShown()?this.hide():this.show()}show(){if(d(this._element)||this._isShown())return;const w={relatedTarget:this._element};if(!z.trigger(this._element,o1,w).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const k of[].concat(...document.body.children))z.on(k,"mouseover",g);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(_s),this._element.classList.add(_s),z.trigger(this._element,l1,w)}}hide(){if(d(this._element)||!this._isShown())return;const w={relatedTarget:this._element};this._completeHide(w)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(w){if(!z.trigger(this._element,s1,w).defaultPrevented){if("ontouchstart"in document.documentElement)for(const k of[].concat(...document.body.children))z.off(k,"mouseover",g);this._popper&&this._popper.destroy(),this._menu.classList.remove(_s),this._element.classList.remove(_s),this._element.setAttribute("aria-expanded","false"),gt.removeDataAttribute(this._menu,"popper"),z.trigger(this._element,a1,w),this._element.focus()}}_getConfig(w){if(typeof(w=super._getConfig(w)).reference=="object"&&!l(w.reference)&&typeof w.reference.getBoundingClientRect!="function")throw new TypeError(`${A0.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return w}_createPopper(){if(w0===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let w=this._element;this._config.reference==="parent"?w=this._parent:l(this._config.reference)?w=u(this._config.reference):typeof this._config.reference=="object"&&(w=this._config.reference);const k=this._getPopperConfig();this._popper=If(w,this._menu,k)}_isShown(){return this._menu.classList.contains(_s)}_getPlacement(){const w=this._parent;if(w.classList.contains("dropend"))return c1;if(w.classList.contains("dropstart"))return u1;if(w.classList.contains("dropup-center"))return"top";if(w.classList.contains("dropdown-center"))return"bottom";const k=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return w.classList.contains("dropup")?k?R0:O0:k?jo:N0}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:w}=this._config;return typeof w=="string"?w.split(",").map(k=>Number.parseInt(k,10)):typeof w=="function"?k=>w(k,this._element):w}_getPopperConfig(){const w={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(gt.setDataAttribute(this._menu,"popper","static"),w.modifiers=[{name:"applyStyles",enabled:!1}]),{...w,...S(this._config.popperConfig,[void 0,w])}}_selectMenuItem({key:w,target:k}){const K=j.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(vt=>h(vt));K.length&&O(K,k,w===S0,!K.includes(k)).focus()}static jQueryInterface(w){return this.each(function(){const k=Ri.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0)throw new TypeError(`No method named "${w}"`);k[w]()}})}static clearMenus(w){if(w.button===2||w.type==="keyup"&&w.key!=="Tab")return;const k=j.find(D0);for(const K of k){const vt=Ri.getInstance(K);if(!vt||vt._config.autoClose===!1)continue;const wt=w.composedPath(),jt=wt.includes(vt._menu);if(wt.includes(vt._element)||vt._config.autoClose==="inside"&&!jt||vt._config.autoClose==="outside"&&jt||vt._menu.contains(w.target)&&(w.type==="keyup"&&w.key==="Tab"||/input|select|option|textarea|form/i.test(w.target.tagName)))continue;const Wt={relatedTarget:vt._element};w.type==="click"&&(Wt.clickEvent=w),vt._completeHide(Wt)}}static dataApiKeydownHandler(w){const k=/input|textarea/i.test(w.target.tagName),K=w.key==="Escape",vt=[i1,S0].includes(w.key);if(!vt&&!K||k&&!K)return;w.preventDefault();const wt=this.matches(Ja)?this:j.prev(this,Ja)[0]||j.next(this,Ja)[0]||j.findOne(Ja,w.delegateTarget.parentNode),jt=Ri.getOrCreateInstance(wt);if(vt)return w.stopPropagation(),jt.show(),void jt._selectMenuItem(w);jt._isShown()&&(w.stopPropagation(),jt.hide(),wt.focus())}}z.on(document,C0,Ja,Ri.dataApiKeydownHandler),z.on(document,C0,Yl,Ri.dataApiKeydownHandler),z.on(document,T0,Ri.clearMenus),z.on(document,Ff,Ri.clearMenus),z.on(document,T0,Ja,function(U){U.preventDefault(),Ri.getOrCreateInstance(this).toggle()}),E(Ri);const $o="backdrop",Go="show",L0=`mousedown.bs.${$o}`,Jc={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},M0={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Bf extends _t{constructor(w){super(),this._config=this._getConfig(w),this._isAppended=!1,this._element=null}static get Default(){return Jc}static get DefaultType(){return M0}static get NAME(){return $o}show(w){if(!this._config.isVisible)return void S(w);this._append();const k=this._getElement();this._config.isAnimated&&v(k),k.classList.add(Go),this._emulateAnimation(()=>{S(w)})}hide(w){this._config.isVisible?(this._getElement().classList.remove(Go),this._emulateAnimation(()=>{this.dispose(),S(w)})):S(w)}dispose(){this._isAppended&&(z.off(this._element,L0),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const w=document.createElement("div");w.className=this._config.className,this._config.isAnimated&&w.classList.add("fade"),this._element=w}return this._element}_configAfterMerge(w){return w.rootElement=u(w.rootElement),w}_append(){if(this._isAppended)return;const w=this._getElement();this._config.rootElement.append(w),z.on(w,L0,()=>{S(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(w){T(w,this._getElement(),this._config.isAnimated)}}const Vo=".bs.focustrap",Uf=`focusin${Vo}`,I0=`keydown.tab${Vo}`,zf="backward",P0={autofocus:!0,trapElement:null},h1={autofocus:"boolean",trapElement:"element"};class F0 extends _t{constructor(w){super(),this._config=this._getConfig(w),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return P0}static get DefaultType(){return h1}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),z.off(document,Vo),z.on(document,Uf,w=>this._handleFocusin(w)),z.on(document,I0,w=>this._handleKeydown(w)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,z.off(document,Vo))}_handleFocusin(w){const{trapElement:k}=this._config;if(w.target===document||w.target===k||k.contains(w.target))return;const K=j.focusableChildren(k);K.length===0?k.focus():this._lastTabNavDirection===zf?K[K.length-1].focus():K[0].focus()}_handleKeydown(w){w.key==="Tab"&&(this._lastTabNavDirection=w.shiftKey?zf:"forward")}}const B0=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",U0=".sticky-top",tu="padding-right",$r="margin-right";class to{constructor(){this._element=document.body}getWidth(){const w=document.documentElement.clientWidth;return Math.abs(window.innerWidth-w)}hide(){const w=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,tu,k=>k+w),this._setElementAttributes(B0,tu,k=>k+w),this._setElementAttributes(U0,$r,k=>k-w)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,tu),this._resetElementAttributes(B0,tu),this._resetElementAttributes(U0,$r)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(w,k,K){const vt=this.getWidth();this._applyManipulationCallback(w,wt=>{if(wt!==this._element&&window.innerWidth>wt.clientWidth+vt)return;this._saveInitialAttribute(wt,k);const jt=window.getComputedStyle(wt).getPropertyValue(k);wt.style.setProperty(k,`${K(Number.parseFloat(jt))}px`)})}_saveInitialAttribute(w,k){const K=w.style.getPropertyValue(k);K&&gt.setDataAttribute(w,k,K)}_resetElementAttributes(w,k){this._applyManipulationCallback(w,K=>{const vt=gt.getDataAttribute(K,k);vt!==null?(gt.removeDataAttribute(K,k),K.style.setProperty(k,vt)):K.style.removeProperty(k)})}_applyManipulationCallback(w,k){if(l(w))k(w);else for(const K of j.find(w,this._element))k(K)}}const fi=".bs.modal",z0=`hide${fi}`,H0=`hidePrevented${fi}`,Hf=`hidden${fi}`,eu=`show${fi}`,d1=`shown${fi}`,Wo=`resize${fi}`,jf=`click.dismiss${fi}`,ql=`mousedown.dismiss${fi}`,$f=`keydown.dismiss${fi}`,j0=`click${fi}.data-api`,ha="modal-open",eo="show",Kl="modal-static",$0={backdrop:!0,focus:!0,keyboard:!0},no={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class da extends Bt{constructor(w,k){super(w,k),this._dialog=j.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new to,this._addEventListeners()}static get Default(){return $0}static get DefaultType(){return no}static get NAME(){return"modal"}toggle(w){return this._isShown?this.hide():this.show(w)}show(w){this._isShown||this._isTransitioning||z.trigger(this._element,eu,{relatedTarget:w}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(ha),this._adjustDialog(),this._backdrop.show(()=>this._showElement(w)))}hide(){this._isShown&&!this._isTransitioning&&(z.trigger(this._element,z0).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(eo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){z.off(window,fi),z.off(this._dialog,fi),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Bf({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new F0({trapElement:this._element})}_showElement(w){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const k=j.findOne(".modal-body",this._dialog);k&&(k.scrollTop=0),v(this._element),this._element.classList.add(eo),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,z.trigger(this._element,d1,{relatedTarget:w})},this._dialog,this._isAnimated())}_addEventListeners(){z.on(this._element,$f,w=>{w.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),z.on(window,Wo,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),z.on(this._element,ql,w=>{z.one(this._element,jf,k=>{this._element===w.target&&this._element===k.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(ha),this._resetAdjustments(),this._scrollBar.reset(),z.trigger(this._element,Hf)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(z.trigger(this._element,H0).defaultPrevented)return;const w=this._element.scrollHeight>document.documentElement.clientHeight,k=this._element.style.overflowY;k==="hidden"||this._element.classList.contains(Kl)||(w||(this._element.style.overflowY="hidden"),this._element.classList.add(Kl),this._queueCallback(()=>{this._element.classList.remove(Kl),this._queueCallback(()=>{this._element.style.overflowY=k},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const w=this._element.scrollHeight>document.documentElement.clientHeight,k=this._scrollBar.getWidth(),K=k>0;if(K&&!w){const vt=b()?"paddingLeft":"paddingRight";this._element.style[vt]=`${k}px`}if(!K&&w){const vt=b()?"paddingRight":"paddingLeft";this._element.style[vt]=`${k}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(w,k){return this.each(function(){const K=da.getOrCreateInstance(this,w);if(typeof w=="string"){if(K[w]===void 0)throw new TypeError(`No method named "${w}"`);K[w](k)}})}}z.on(document,j0,'[data-bs-toggle="modal"]',function(U){const w=j.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&U.preventDefault(),z.one(w,eu,K=>{K.defaultPrevented||z.one(w,Hf,()=>{h(this)&&this.focus()})});const k=j.findOne(".modal.show");k&&da.getInstance(k).hide(),da.getOrCreateInstance(w).toggle(this)}),pt(da),E(da);const ys=".bs.offcanvas",Gf=".data-api",p1=`load${ys}${Gf}`,G0="show",V0="showing",Vf="hiding",Wf=".offcanvas.show",Xf=`show${ys}`,Wi=`shown${ys}`,W0=`hide${ys}`,hi=`hidePrevented${ys}`,di=`hidden${ys}`,Xo=`resize${ys}`,Yf=`click${ys}${Gf}`,nu=`keydown.dismiss${ys}`,ru={backdrop:!0,keyboard:!0,scroll:!1},qf={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Gr extends Bt{constructor(w,k){super(w,k),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return ru}static get DefaultType(){return qf}static get NAME(){return"offcanvas"}toggle(w){return this._isShown?this.hide():this.show(w)}show(w){this._isShown||z.trigger(this._element,Xf,{relatedTarget:w}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new to().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(V0),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(G0),this._element.classList.remove(V0),z.trigger(this._element,Wi,{relatedTarget:w})},this._element,!0))}hide(){this._isShown&&(z.trigger(this._element,W0).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Vf),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(G0,Vf),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new to().reset(),z.trigger(this._element,di)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const w=!!this._config.backdrop;return new Bf({className:"offcanvas-backdrop",isVisible:w,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:w?()=>{this._config.backdrop!=="static"?this.hide():z.trigger(this._element,hi)}:null})}_initializeFocusTrap(){return new F0({trapElement:this._element})}_addEventListeners(){z.on(this._element,nu,w=>{w.key==="Escape"&&(this._config.keyboard?this.hide():z.trigger(this._element,hi))})}static jQueryInterface(w){return this.each(function(){const k=Gr.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w](this)}})}}z.on(document,Yf,'[data-bs-toggle="offcanvas"]',function(U){const w=j.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&U.preventDefault(),d(this))return;z.one(w,di,()=>{h(this)&&this.focus()});const k=j.findOne(Wf);k&&k!==w&&Gr.getInstance(k).hide(),Gr.getOrCreateInstance(w).toggle(this)}),z.on(window,p1,()=>{for(const U of j.find(Wf))Gr.getOrCreateInstance(U).show()}),z.on(window,Xo,()=>{for(const U of j.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(U).position!=="fixed"&&Gr.getOrCreateInstance(U).hide()}),pt(Gr),E(Gr);const Kf={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},iu=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Yo=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,g1=(U,w)=>{const k=U.nodeName.toLowerCase();return w.includes(k)?!iu.has(k)||!!Yo.test(U.nodeValue):w.filter(K=>K instanceof RegExp).some(K=>K.test(k))},pi={allowList:Kf,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Zf={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Gs={entry:"(string|element|function|null)",selector:"(string|element)"};class X0 extends _t{constructor(w){super(),this._config=this._getConfig(w)}static get Default(){return pi}static get DefaultType(){return Zf}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(w=>this._resolvePossibleFunction(w)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(w){return this._checkContent(w),this._config.content={...this._config.content,...w},this}toHtml(){const w=document.createElement("div");w.innerHTML=this._maybeSanitize(this._config.template);for(const[vt,wt]of Object.entries(this._config.content))this._setContent(w,wt,vt);const k=w.children[0],K=this._resolvePossibleFunction(this._config.extraClass);return K&&k.classList.add(...K.split(" ")),k}_typeCheckConfig(w){super._typeCheckConfig(w),this._checkContent(w.content)}_checkContent(w){for(const[k,K]of Object.entries(w))super._typeCheckConfig({selector:k,entry:K},Gs)}_setContent(w,k,K){const vt=j.findOne(K,w);vt&&((k=this._resolvePossibleFunction(k))?l(k)?this._putElementInTemplate(u(k),vt):this._config.html?vt.innerHTML=this._maybeSanitize(k):vt.textContent=k:vt.remove())}_maybeSanitize(w){return this._config.sanitize?function(k,K,vt){if(!k.length)return k;if(vt&&typeof vt=="function")return vt(k);const wt=new window.DOMParser().parseFromString(k,"text/html"),jt=[].concat(...wt.body.querySelectorAll("*"));for(const Wt of jt){const ne=Wt.nodeName.toLowerCase();if(!Object.keys(K).includes(ne)){Wt.remove();continue}const ue=[].concat(...Wt.attributes),fe=[].concat(K["*"]||[],K[ne]||[]);for(const le of ue)g1(le,fe)||Wt.removeAttribute(le.nodeName)}return wt.body.innerHTML}(w,this._config.allowList,this._config.sanitizeFn):w}_resolvePossibleFunction(w){return S(w,[void 0,this])}_putElementInTemplate(w,k){if(this._config.html)return k.innerHTML="",void k.append(w);k.textContent=w.textContent}}const su=new Set(["sanitize","allowList","sanitizeFn"]),Vs="fade",qo="show",Qf=".tooltip-inner",ro=".modal",io="hide.bs.modal",pa="hover",Ko="focus",Vr="click",Ni={AUTO:"auto",TOP:"top",RIGHT:b()?"left":"right",BOTTOM:"bottom",LEFT:b()?"right":"left"},so={allowList:Kf,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Ws={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Nr extends Bt{constructor(w,k){if(w0===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(w,k),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return so}static get DefaultType(){return Ws}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),z.off(this._element.closest(ro),io,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const w=z.trigger(this._element,this.constructor.eventName("show")),k=(p(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(w.defaultPrevented||!k)return;this._disposePopper();const K=this._getTipElement();this._element.setAttribute("aria-describedby",K.getAttribute("id"));const{container:vt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(vt.append(K),z.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(K),K.classList.add(qo),"ontouchstart"in document.documentElement)for(const wt of[].concat(...document.body.children))z.on(wt,"mouseover",g);this._queueCallback(()=>{z.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!z.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(qo),"ontouchstart"in document.documentElement)for(const w of[].concat(...document.body.children))z.off(w,"mouseover",g);this._activeTrigger[Vr]=!1,this._activeTrigger[Ko]=!1,this._activeTrigger[pa]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),z.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(w){const k=this._getTemplateFactory(w).toHtml();if(!k)return null;k.classList.remove(Vs,qo),k.classList.add(`bs-${this.constructor.NAME}-auto`);const K=(vt=>{do vt+=Math.floor(1e6*Math.random());while(document.getElementById(vt));return vt})(this.constructor.NAME).toString();return k.setAttribute("id",K),this._isAnimated()&&k.classList.add(Vs),k}setContent(w){this._newContent=w,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(w){return this._templateFactory?this._templateFactory.changeContent(w):this._templateFactory=new X0({...this._config,content:w,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Qf]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(w){return this.constructor.getOrCreateInstance(w.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Vs)}_isShown(){return this.tip&&this.tip.classList.contains(qo)}_createPopper(w){const k=S(this._config.placement,[this,w,this._element]),K=Ni[k.toUpperCase()];return If(this._element,w,this._getPopperConfig(K))}_getOffset(){const{offset:w}=this._config;return typeof w=="string"?w.split(",").map(k=>Number.parseInt(k,10)):typeof w=="function"?k=>w(k,this._element):w}_resolvePossibleFunction(w){return S(w,[this._element,this._element])}_getPopperConfig(w){const k={placement:w,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:K=>{this._getTipElement().setAttribute("data-popper-placement",K.state.placement)}}]};return{...k,...S(this._config.popperConfig,[void 0,k])}}_setListeners(){const w=this._config.trigger.split(" ");for(const k of w)if(k==="click")z.on(this._element,this.constructor.eventName("click"),this._config.selector,K=>{const vt=this._initializeOnDelegatedTarget(K);vt._activeTrigger[Vr]=!(vt._isShown()&&vt._activeTrigger[Vr]),vt.toggle()});else if(k!=="manual"){const K=k===pa?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),vt=k===pa?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");z.on(this._element,K,this._config.selector,wt=>{const jt=this._initializeOnDelegatedTarget(wt);jt._activeTrigger[wt.type==="focusin"?Ko:pa]=!0,jt._enter()}),z.on(this._element,vt,this._config.selector,wt=>{const jt=this._initializeOnDelegatedTarget(wt);jt._activeTrigger[wt.type==="focusout"?Ko:pa]=jt._element.contains(wt.relatedTarget),jt._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},z.on(this._element.closest(ro),io,this._hideModalHandler)}_fixTitle(){const w=this._element.getAttribute("title");w&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",w),this._element.setAttribute("data-bs-original-title",w),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(w,k){clearTimeout(this._timeout),this._timeout=setTimeout(w,k)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(w){const k=gt.getDataAttributes(this._element);for(const K of Object.keys(k))su.has(K)&&delete k[K];return w={...k,...typeof w=="object"&&w?w:{}},w=this._mergeConfigObj(w),w=this._configAfterMerge(w),this._typeCheckConfig(w),w}_configAfterMerge(w){return w.container=w.container===!1?document.body:u(w.container),typeof w.delay=="number"&&(w.delay={show:w.delay,hide:w.delay}),typeof w.title=="number"&&(w.title=w.title.toString()),typeof w.content=="number"&&(w.content=w.content.toString()),w}_getDelegateConfig(){const w={};for(const[k,K]of Object.entries(this._config))this.constructor.Default[k]!==K&&(w[k]=K);return w.selector=!1,w.trigger="manual",w}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(w){return this.each(function(){const k=Nr.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0)throw new TypeError(`No method named "${w}"`);k[w]()}})}}E(Nr);const ao=".popover-header",Y0=".popover-body",Jf={...Nr.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},th={...Nr.DefaultType,content:"(null|string|element|function)"};class rr extends Nr{static get Default(){return Jf}static get DefaultType(){return th}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[ao]:this._getTitle(),[Y0]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(w){return this.each(function(){const k=rr.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0)throw new TypeError(`No method named "${w}"`);k[w]()}})}}E(rr);const Dn=".bs.scrollspy",sn=`activate${Dn}`,ga=`click${Dn}`,bs=`load${Dn}.data-api`,ma="active",Xs="[href]",eh=".nav-link",q0=`${eh}, .nav-item > ${eh}, .list-group-item`,Zl={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Ql={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Zo extends Bt{constructor(w,k){super(w,k),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Zl}static get DefaultType(){return Ql}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const w of this._observableSections.values())this._observer.observe(w)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(w){return w.target=u(w.target)||document.body,w.rootMargin=w.offset?`${w.offset}px 0px -30%`:w.rootMargin,typeof w.threshold=="string"&&(w.threshold=w.threshold.split(",").map(k=>Number.parseFloat(k))),w}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(z.off(this._config.target,ga),z.on(this._config.target,ga,Xs,w=>{const k=this._observableSections.get(w.target.hash);if(k){w.preventDefault();const K=this._rootElement||window,vt=k.offsetTop-this._element.offsetTop;if(K.scrollTo)return void K.scrollTo({top:vt,behavior:"smooth"});K.scrollTop=vt}}))}_getNewObserver(){const w={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(k=>this._observerCallback(k),w)}_observerCallback(w){const k=jt=>this._targetLinks.get(`#${jt.target.id}`),K=jt=>{this._previousScrollData.visibleEntryTop=jt.target.offsetTop,this._process(k(jt))},vt=(this._rootElement||document.documentElement).scrollTop,wt=vt>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=vt;for(const jt of w){if(!jt.isIntersecting){this._activeTarget=null,this._clearActiveClass(k(jt));continue}const Wt=jt.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(wt&&Wt){if(K(jt),!vt)return}else wt||Wt||K(jt)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const w=j.find(Xs,this._config.target);for(const k of w){if(!k.hash||d(k))continue;const K=j.findOne(decodeURI(k.hash),this._element);h(K)&&(this._targetLinks.set(decodeURI(k.hash),k),this._observableSections.set(k.hash,K))}}_process(w){this._activeTarget!==w&&(this._clearActiveClass(this._config.target),this._activeTarget=w,w.classList.add(ma),this._activateParents(w),z.trigger(this._element,sn,{relatedTarget:w}))}_activateParents(w){if(w.classList.contains("dropdown-item"))j.findOne(".dropdown-toggle",w.closest(".dropdown")).classList.add(ma);else for(const k of j.parents(w,".nav, .list-group"))for(const K of j.prev(k,q0))K.classList.add(ma)}_clearActiveClass(w){w.classList.remove(ma);const k=j.find(`${Xs}.${ma}`,w);for(const K of k)K.classList.remove(ma)}static jQueryInterface(w){return this.each(function(){const k=Zo.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w]()}})}}z.on(window,bs,()=>{for(const U of j.find('[data-bs-spy="scroll"]'))Zo.getOrCreateInstance(U)}),E(Zo);const Xi=".bs.tab",nh=`hide${Xi}`,oo=`hidden${Xi}`,Ys=`show${Xi}`,va=`shown${Xi}`,qs=`click${Xi}`,rh=`keydown${Xi}`,ih=`load${Xi}`,Jl="ArrowLeft",tc="ArrowRight",lo="ArrowUp",hr="ArrowDown",Qo="Home",sh="End",co="active",K0="fade",ah="show",$n=".dropdown-toggle",ec=`:not(${$n})`,Jo='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',uo=`.nav-link${ec}, .list-group-item${ec}, [role="tab"]${ec}, ${Jo}`,oh=`.${co}[data-bs-toggle="tab"], .${co}[data-bs-toggle="pill"], .${co}[data-bs-toggle="list"]`;class ki extends Bt{constructor(w){super(w),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),z.on(this._element,rh,k=>this._keydown(k)))}static get NAME(){return"tab"}show(){const w=this._element;if(this._elemIsActive(w))return;const k=this._getActiveElem(),K=k?z.trigger(k,nh,{relatedTarget:w}):null;z.trigger(w,Ys,{relatedTarget:k}).defaultPrevented||K&&K.defaultPrevented||(this._deactivate(k,w),this._activate(w,k))}_activate(w,k){w&&(w.classList.add(co),this._activate(j.getElementFromSelector(w)),this._queueCallback(()=>{w.getAttribute("role")==="tab"?(w.removeAttribute("tabindex"),w.setAttribute("aria-selected",!0),this._toggleDropDown(w,!0),z.trigger(w,va,{relatedTarget:k})):w.classList.add(ah)},w,w.classList.contains(K0)))}_deactivate(w,k){w&&(w.classList.remove(co),w.blur(),this._deactivate(j.getElementFromSelector(w)),this._queueCallback(()=>{w.getAttribute("role")==="tab"?(w.setAttribute("aria-selected",!1),w.setAttribute("tabindex","-1"),this._toggleDropDown(w,!1),z.trigger(w,oo,{relatedTarget:k})):w.classList.remove(ah)},w,w.classList.contains(K0)))}_keydown(w){if(![Jl,tc,lo,hr,Qo,sh].includes(w.key))return;w.stopPropagation(),w.preventDefault();const k=this._getChildren().filter(vt=>!d(vt));let K;if([Qo,sh].includes(w.key))K=k[w.key===Qo?0:k.length-1];else{const vt=[tc,hr].includes(w.key);K=O(k,w.target,vt,!0)}K&&(K.focus({preventScroll:!0}),ki.getOrCreateInstance(K).show())}_getChildren(){return j.find(uo,this._parent)}_getActiveElem(){return this._getChildren().find(w=>this._elemIsActive(w))||null}_setInitialAttributes(w,k){this._setAttributeIfNotExists(w,"role","tablist");for(const K of k)this._setInitialAttributesOnChild(K)}_setInitialAttributesOnChild(w){w=this._getInnerElement(w);const k=this._elemIsActive(w),K=this._getOuterElement(w);w.setAttribute("aria-selected",k),K!==w&&this._setAttributeIfNotExists(K,"role","presentation"),k||w.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(w,"role","tab"),this._setInitialAttributesOnTargetPanel(w)}_setInitialAttributesOnTargetPanel(w){const k=j.getElementFromSelector(w);k&&(this._setAttributeIfNotExists(k,"role","tabpanel"),w.id&&this._setAttributeIfNotExists(k,"aria-labelledby",`${w.id}`))}_toggleDropDown(w,k){const K=this._getOuterElement(w);if(!K.classList.contains("dropdown"))return;const vt=(wt,jt)=>{const Wt=j.findOne(wt,K);Wt&&Wt.classList.toggle(jt,k)};vt($n,co),vt(".dropdown-menu",ah),K.setAttribute("aria-expanded",k)}_setAttributeIfNotExists(w,k,K){w.hasAttribute(k)||w.setAttribute(k,K)}_elemIsActive(w){return w.classList.contains(co)}_getInnerElement(w){return w.matches(uo)?w:j.findOne(uo,w)}_getOuterElement(w){return w.closest(".nav-item, .list-group-item")||w}static jQueryInterface(w){return this.each(function(){const k=ki.getOrCreateInstance(this);if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w]()}})}}z.on(document,qs,Jo,function(U){["A","AREA"].includes(this.tagName)&&U.preventDefault(),d(this)||ki.getOrCreateInstance(this).show()}),z.on(window,ih,()=>{for(const U of j.find(oh))ki.getOrCreateInstance(U)}),E(ki);const gi=".bs.toast",m1=`mouseover${gi}`,Z0=`mouseout${gi}`,v1=`focusin${gi}`,Q0=`focusout${gi}`,fo=`hide${gi}`,lh=`hidden${gi}`,au=`show${gi}`,J0=`shown${gi}`,tl="hide",nc="show",ho="showing",ch={animation:"boolean",autohide:"boolean",delay:"number"},tp={animation:!0,autohide:!0,delay:5e3};class _a extends Bt{constructor(w,k){super(w,k),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return tp}static get DefaultType(){return ch}static get NAME(){return"toast"}show(){z.trigger(this._element,au).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(tl),v(this._element),this._element.classList.add(nc,ho),this._queueCallback(()=>{this._element.classList.remove(ho),z.trigger(this._element,J0),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(z.trigger(this._element,fo).defaultPrevented||(this._element.classList.add(ho),this._queueCallback(()=>{this._element.classList.add(tl),this._element.classList.remove(ho,nc),z.trigger(this._element,lh)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(nc),super.dispose()}isShown(){return this._element.classList.contains(nc)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(w,k){switch(w.type){case"mouseover":case"mouseout":this._hasMouseInteraction=k;break;case"focusin":case"focusout":this._hasKeyboardInteraction=k}if(k)return void this._clearTimeout();const K=w.relatedTarget;this._element===K||this._element.contains(K)||this._maybeScheduleHide()}_setListeners(){z.on(this._element,m1,w=>this._onInteraction(w,!0)),z.on(this._element,Z0,w=>this._onInteraction(w,!1)),z.on(this._element,v1,w=>this._onInteraction(w,!0)),z.on(this._element,Q0,w=>this._onInteraction(w,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(w){return this.each(function(){const k=_a.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0)throw new TypeError(`No method named "${w}"`);k[w](this)}})}}return pt(_a),E(_a),{Alert:Lt,Button:dt,Carousel:aa,Collapse:Ht,Dropdown:Ri,Modal:da,Offcanvas:Gr,Popover:rr,ScrollSpy:Zo,Tab:ki,Toast:_a,Tooltip:Nr}})}(Dg)),Dg.exports}k4();/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const vl=new Map,Rv={set(n,t,e){vl.has(n)||vl.set(n,new Map);const r=vl.get(n);if(!r.has(t)&&r.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`);return}r.set(t,e)},get(n,t){return vl.has(n)&&vl.get(n).get(t)||null},remove(n,t){if(!vl.has(n))return;const e=vl.get(n);e.delete(t),e.size===0&&vl.delete(n)}},L4=1e6,M4=1e3,U_="transitionend",aT=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(t,e)=>`#${CSS.escape(e)}`)),n),I4=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),P4=n=>{do n+=Math.floor(Math.random()*L4);while(document.getElementById(n));return n},F4=n=>{if(!n)return 0;let{transitionDuration:t,transitionDelay:e}=window.getComputedStyle(n);const r=Number.parseFloat(t),i=Number.parseFloat(e);return!r&&!i?0:(t=t.split(",")[0],e=e.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(e))*M4)},oT=n=>{n.dispatchEvent(new Event(U_))},To=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Al=n=>To(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(aT(n)):null,gf=n=>{if(!To(n)||n.getClientRects().length===0)return!1;const t=getComputedStyle(n).getPropertyValue("visibility")==="visible",e=n.closest("details:not([open])");if(!e)return t;if(e!==n){const r=n.closest("summary");if(r&&r.parentNode!==e||r===null)return!1}return t},Sl=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",lT=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const t=n.getRootNode();return t instanceof ShadowRoot?t:null}return n instanceof ShadowRoot?n:n.parentNode?lT(n.parentNode):null},Pg=()=>{},Gd=n=>{n.offsetHeight},cT=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Nv=[],B4=n=>{document.readyState==="loading"?(Nv.length||document.addEventListener("DOMContentLoaded",()=>{for(const t of Nv)t()}),Nv.push(n)):n()},Ms=()=>document.documentElement.dir==="rtl",Bs=n=>{B4(()=>{const t=cT();if(t){const e=n.NAME,r=t.fn[e];t.fn[e]=n.jQueryInterface,t.fn[e].Constructor=n,t.fn[e].noConflict=()=>(t.fn[e]=r,n.jQueryInterface)}})},ji=(n,t=[],e=n)=>typeof n=="function"?n.call(...t):e,uT=(n,t,e=!0)=>{if(!e){ji(n);return}const i=F4(t)+5;let s=!1;const o=({target:l})=>{l===t&&(s=!0,t.removeEventListener(U_,o),ji(n))};t.addEventListener(U_,o),setTimeout(()=>{s||oT(t)},i)},Ry=(n,t,e,r)=>{const i=n.length;let s=n.indexOf(t);return s===-1?!e&&r?n[i-1]:n[0]:(s+=e?1:-1,r&&(s=(s+i)%i),n[Math.max(0,Math.min(s,i-1))])},U4=/[^.]*(?=\..*)\.|.*/,z4=/\..*/,H4=/::\d+$/,kv={};let Uw=1;const fT={mouseenter:"mouseover",mouseleave:"mouseout"},j4=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function hT(n,t){return t&&`${t}::${Uw++}`||n.uidEvent||Uw++}function dT(n){const t=hT(n);return n.uidEvent=t,kv[t]=kv[t]||{},kv[t]}function $4(n,t){return function e(r){return Ny(r,{delegateTarget:n}),e.oneOff&&Jt.off(n,r.type,t),t.apply(n,[r])}}function G4(n,t,e){return function r(i){const s=n.querySelectorAll(t);for(let{target:o}=i;o&&o!==this;o=o.parentNode)for(const l of s)if(l===o)return Ny(i,{delegateTarget:o}),r.oneOff&&Jt.off(n,i.type,t,e),e.apply(o,[i])}}function pT(n,t,e=null){return Object.values(n).find(r=>r.callable===t&&r.delegationSelector===e)}function gT(n,t,e){const r=typeof t=="string",i=r?e:t||e;let s=mT(n);return j4.has(s)||(s=n),[r,i,s]}function zw(n,t,e,r,i){if(typeof t!="string"||!n)return;let[s,o,l]=gT(t,e,r);t in fT&&(o=(y=>function(_){if(!_.relatedTarget||_.relatedTarget!==_.delegateTarget&&!_.delegateTarget.contains(_.relatedTarget))return y.call(this,_)})(o));const u=dT(n),h=u[l]||(u[l]={}),d=pT(h,o,s?e:null);if(d){d.oneOff=d.oneOff&&i;return}const p=hT(o,t.replace(U4,"")),g=s?G4(n,e,o):$4(n,o);g.delegationSelector=s?e:null,g.callable=o,g.oneOff=i,g.uidEvent=p,h[p]=g,n.addEventListener(l,g,s)}function z_(n,t,e,r,i){const s=pT(t[e],r,i);s&&(n.removeEventListener(e,s,!!i),delete t[e][s.uidEvent])}function V4(n,t,e,r){const i=t[e]||{};for(const[s,o]of Object.entries(i))s.includes(r)&&z_(n,t,e,o.callable,o.delegationSelector)}function mT(n){return n=n.replace(z4,""),fT[n]||n}const Jt={on(n,t,e,r){zw(n,t,e,r,!1)},one(n,t,e,r){zw(n,t,e,r,!0)},off(n,t,e,r){if(typeof t!="string"||!n)return;const[i,s,o]=gT(t,e,r),l=o!==t,u=dT(n),h=u[o]||{},d=t.startsWith(".");if(typeof s<"u"){if(!Object.keys(h).length)return;z_(n,u,o,s,i?e:null);return}if(d)for(const p of Object.keys(u))V4(n,u,p,t.slice(1));for(const[p,g]of Object.entries(h)){const v=p.replace(H4,"");(!l||t.includes(v))&&z_(n,u,o,g.callable,g.delegationSelector)}},trigger(n,t,e){if(typeof t!="string"||!n)return null;const r=cT(),i=mT(t),s=t!==i;let o=null,l=!0,u=!0,h=!1;s&&r&&(o=r.Event(t,e),r(n).trigger(o),l=!o.isPropagationStopped(),u=!o.isImmediatePropagationStopped(),h=o.isDefaultPrevented());const d=Ny(new Event(t,{bubbles:l,cancelable:!0}),e);return h&&d.preventDefault(),u&&n.dispatchEvent(d),d.defaultPrevented&&o&&o.preventDefault(),d}};function Ny(n,t={}){for(const[e,r]of Object.entries(t))try{n[e]=r}catch{Object.defineProperty(n,e,{configurable:!0,get(){return r}})}return n}function Hw(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Lv(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}const Co={setDataAttribute(n,t,e){n.setAttribute(`data-bs-${Lv(t)}`,e)},removeDataAttribute(n,t){n.removeAttribute(`data-bs-${Lv(t)}`)},getDataAttributes(n){if(!n)return{};const t={},e=Object.keys(n.dataset).filter(r=>r.startsWith("bs")&&!r.startsWith("bsConfig"));for(const r of e){let i=r.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),t[i]=Hw(n.dataset[r])}return t},getDataAttribute(n,t){return Hw(n.getAttribute(`data-bs-${Lv(t)}`))}};class Vd{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const r=To(e)?Co.getDataAttribute(e,"config"):{};return{...this.constructor.Default,...typeof r=="object"?r:{},...To(e)?Co.getDataAttributes(e):{},...typeof t=="object"?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[r,i]of Object.entries(e)){const s=t[r],o=To(s)?"element":I4(s);if(!new RegExp(i).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${r}" provided type "${o}" but expected type "${i}".`)}}}const W4="5.3.7";class sa extends Vd{constructor(t,e){super(),t=Al(t),t&&(this._element=t,this._config=this._getConfig(e),Rv.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Rv.remove(this._element,this.constructor.DATA_KEY),Jt.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,r=!0){uT(t,e,r)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return Rv.get(Al(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,typeof e=="object"?e:null)}static get VERSION(){return W4}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const Mv=n=>{let t=n.getAttribute("data-bs-target");if(!t||t==="#"){let e=n.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),t=e&&e!=="#"?e.trim():null}return t?t.split(",").map(e=>aT(e)).join(","):null},we={find(n,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,n))},findOne(n,t=document.documentElement){return Element.prototype.querySelector.call(t,n)},children(n,t){return[].concat(...n.children).filter(e=>e.matches(t))},parents(n,t){const e=[];let r=n.parentNode.closest(t);for(;r;)e.push(r),r=r.parentNode.closest(t);return e},prev(n,t){let e=n.previousElementSibling;for(;e;){if(e.matches(t))return[e];e=e.previousElementSibling}return[]},next(n,t){let e=n.nextElementSibling;for(;e;){if(e.matches(t))return[e];e=e.nextElementSibling}return[]},focusableChildren(n){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>`${e}:not([tabindex^="-"])`).join(",");return this.find(t,n).filter(e=>!Sl(e)&&gf(e))},getSelectorFromElement(n){const t=Mv(n);return t&&we.findOne(t)?t:null},getElementFromSelector(n){const t=Mv(n);return t?we.findOne(t):null},getMultipleElementsFromSelector(n){const t=Mv(n);return t?we.find(t):[]}},Em=(n,t="hide")=>{const e=`click.dismiss${n.EVENT_KEY}`,r=n.NAME;Jt.on(document,e,`[data-bs-dismiss="${r}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Sl(this))return;const s=we.getElementFromSelector(this)||this.closest(`.${r}`);n.getOrCreateInstance(s)[t]()})},X4="alert",Y4="bs.alert",vT=`.${Y4}`,q4=`close${vT}`,K4=`closed${vT}`,Z4="fade",Q4="show";class wm extends sa{static get NAME(){return X4}close(){if(Jt.trigger(this._element,q4).defaultPrevented)return;this._element.classList.remove(Q4);const e=this._element.classList.contains(Z4);this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),Jt.trigger(this._element,K4),this.dispose()}static jQueryInterface(t){return this.each(function(){const e=wm.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Em(wm,"close");Bs(wm);const J4="button",tk="bs.button",ek=`.${tk}`,nk=".data-api",rk="active",jw='[data-bs-toggle="button"]',ik=`click${ek}${nk}`;class Am extends sa{static get NAME(){return J4}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(rk))}static jQueryInterface(t){return this.each(function(){const e=Am.getOrCreateInstance(this);t==="toggle"&&e[t]()})}}Jt.on(document,ik,jw,n=>{n.preventDefault();const t=n.target.closest(jw);Am.getOrCreateInstance(t).toggle()});Bs(Am);const sk="swipe",mf=".bs.swipe",ak=`touchstart${mf}`,ok=`touchmove${mf}`,lk=`touchend${mf}`,ck=`pointerdown${mf}`,uk=`pointerup${mf}`,fk="touch",hk="pen",dk="pointer-event",pk=40,gk={endCallback:null,leftCallback:null,rightCallback:null},mk={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Fg extends Vd{constructor(t,e){super(),this._element=t,!(!t||!Fg.isSupported())&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return gk}static get DefaultType(){return mk}static get NAME(){return sk}dispose(){Jt.off(this._element,mf)}_start(t){if(!this._supportPointerEvents){this._deltaX=t.touches[0].clientX;return}this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX)}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),ji(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=pk)return;const e=t/this._deltaX;this._deltaX=0,e&&ji(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Jt.on(this._element,ck,t=>this._start(t)),Jt.on(this._element,uk,t=>this._end(t)),this._element.classList.add(dk)):(Jt.on(this._element,ak,t=>this._start(t)),Jt.on(this._element,ok,t=>this._move(t)),Jt.on(this._element,lk,t=>this._end(t)))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&(t.pointerType===hk||t.pointerType===fk)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const vk="carousel",_k="bs.carousel",Ll=`.${_k}`,_T=".data-api",yk="ArrowLeft",bk="ArrowRight",xk=500,Wh="next",Ru="prev",Iu="left",Og="right",Ek=`slide${Ll}`,Iv=`slid${Ll}`,wk=`keydown${Ll}`,Ak=`mouseenter${Ll}`,Sk=`mouseleave${Ll}`,Tk=`dragstart${Ll}`,Ck=`load${Ll}${_T}`,Dk=`click${Ll}${_T}`,yT="carousel",Gp="active",Ok="slide",Rk="carousel-item-end",Nk="carousel-item-start",kk="carousel-item-next",Lk="carousel-item-prev",bT=".active",xT=".carousel-item",Mk=bT+xT,Ik=".carousel-item img",Pk=".carousel-indicators",Fk="[data-bs-slide], [data-bs-slide-to]",Bk='[data-bs-ride="carousel"]',Uk={[yk]:Og,[bk]:Iu},zk={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Hk={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Wd extends sa{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=we.findOne(Pk,this._element),this._addEventListeners(),this._config.ride===yT&&this.cycle()}static get Default(){return zk}static get DefaultType(){return Hk}static get NAME(){return vk}next(){this._slide(Wh)}nextWhenVisible(){!document.hidden&&gf(this._element)&&this.next()}prev(){this._slide(Ru)}pause(){this._isSliding&&oT(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Jt.one(this._element,Iv,()=>this.cycle());return}this.cycle()}}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding){Jt.one(this._element,Iv,()=>this.to(t));return}const r=this._getItemIndex(this._getActive());if(r===t)return;const i=t>r?Wh:Ru;this._slide(i,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&Jt.on(this._element,wk,t=>this._keydown(t)),this._config.pause==="hover"&&(Jt.on(this._element,Ak,()=>this.pause()),Jt.on(this._element,Sk,()=>this._maybeEnableCycle())),this._config.touch&&Fg.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const r of we.find(Ik,this._element))Jt.on(r,Tk,i=>i.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(Iu)),rightCallback:()=>this._slide(this._directionToOrder(Og)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),xk+this._config.interval))}};this._swipeHelper=new Fg(this._element,e)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=Uk[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=we.findOne(bT,this._indicatorsElement);e.classList.remove(Gp),e.removeAttribute("aria-current");const r=we.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);r&&(r.classList.add(Gp),r.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const r=this._getActive(),i=t===Wh,s=e||Ry(this._getItems(),r,i,this._config.wrap);if(s===r)return;const o=this._getItemIndex(s),l=v=>Jt.trigger(this._element,v,{relatedTarget:s,direction:this._orderToDirection(t),from:this._getItemIndex(r),to:o});if(l(Ek).defaultPrevented||!r||!s)return;const h=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=s;const d=i?Nk:Rk,p=i?kk:Lk;s.classList.add(p),Gd(s),r.classList.add(d),s.classList.add(d);const g=()=>{s.classList.remove(d,p),s.classList.add(Gp),r.classList.remove(Gp,p,d),this._isSliding=!1,l(Iv)};this._queueCallback(g,r,this._isAnimated()),h&&this.cycle()}_isAnimated(){return this._element.classList.contains(Ok)}_getActive(){return we.findOne(Mk,this._element)}_getItems(){return we.find(xT,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return Ms()?t===Iu?Ru:Wh:t===Iu?Wh:Ru}_orderToDirection(t){return Ms()?t===Ru?Iu:Og:t===Ru?Og:Iu}static jQueryInterface(t){return this.each(function(){const e=Wd.getOrCreateInstance(this,t);if(typeof t=="number"){e.to(t);return}if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(document,Dk,Fk,function(n){const t=we.getElementFromSelector(this);if(!t||!t.classList.contains(yT))return;n.preventDefault();const e=Wd.getOrCreateInstance(t),r=this.getAttribute("data-bs-slide-to");if(r){e.to(r),e._maybeEnableCycle();return}if(Co.getDataAttribute(this,"slide")==="next"){e.next(),e._maybeEnableCycle();return}e.prev(),e._maybeEnableCycle()});Jt.on(window,Ck,()=>{const n=we.find(Bk);for(const t of n)Wd.getOrCreateInstance(t)});Bs(Wd);const jk="collapse",$k="bs.collapse",Xd=`.${$k}`,Gk=".data-api",Vk=`show${Xd}`,Wk=`shown${Xd}`,Xk=`hide${Xd}`,Yk=`hidden${Xd}`,qk=`click${Xd}${Gk}`,Pv="show",zu="collapse",Vp="collapsing",Kk="collapsed",Zk=`:scope .${zu} .${zu}`,Qk="collapse-horizontal",Jk="width",tL="height",eL=".collapse.show, .collapse.collapsing",H_='[data-bs-toggle="collapse"]',nL={parent:null,toggle:!0},rL={parent:"(null|element)",toggle:"boolean"};class bd extends sa{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const r=we.find(H_);for(const i of r){const s=we.getSelectorFromElement(i),o=we.find(s).filter(l=>l===this._element);s!==null&&o.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return nL}static get DefaultType(){return rL}static get NAME(){return jk}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(eL).filter(l=>l!==this._element).map(l=>bd.getOrCreateInstance(l,{toggle:!1}))),t.length&&t[0]._isTransitioning||Jt.trigger(this._element,Vk).defaultPrevented)return;for(const l of t)l.hide();const r=this._getDimension();this._element.classList.remove(zu),this._element.classList.add(Vp),this._element.style[r]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Vp),this._element.classList.add(zu,Pv),this._element.style[r]="",Jt.trigger(this._element,Wk)},o=`scroll${r[0].toUpperCase()+r.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[r]=`${this._element[o]}px`}hide(){if(this._isTransitioning||!this._isShown()||Jt.trigger(this._element,Xk).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,Gd(this._element),this._element.classList.add(Vp),this._element.classList.remove(zu,Pv);for(const i of this._triggerArray){const s=we.getElementFromSelector(i);s&&!this._isShown(s)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const r=()=>{this._isTransitioning=!1,this._element.classList.remove(Vp),this._element.classList.add(zu),Jt.trigger(this._element,Yk)};this._element.style[e]="",this._queueCallback(r,this._element,!0)}_isShown(t=this._element){return t.classList.contains(Pv)}_configAfterMerge(t){return t.toggle=!!t.toggle,t.parent=Al(t.parent),t}_getDimension(){return this._element.classList.contains(Qk)?Jk:tL}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(H_);for(const e of t){const r=we.getElementFromSelector(e);r&&this._addAriaAndCollapsedClass([e],this._isShown(r))}}_getFirstLevelChildren(t){const e=we.find(Zk,this._config.parent);return we.find(t,this._config.parent).filter(r=>!e.includes(r))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const r of t)r.classList.toggle(Kk,!e),r.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return typeof t=="string"&&/show|hide/.test(t)&&(e.toggle=!1),this.each(function(){const r=bd.getOrCreateInstance(this,e);if(typeof t=="string"){if(typeof r[t]>"u")throw new TypeError(`No method named "${t}"`);r[t]()}})}}Jt.on(document,qk,H_,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const t of we.getMultipleElementsFromSelector(this))bd.getOrCreateInstance(t,{toggle:!1}).toggle()});Bs(bd);const $w="dropdown",iL="bs.dropdown",Pc=`.${iL}`,ky=".data-api",sL="Escape",Gw="Tab",aL="ArrowUp",Vw="ArrowDown",oL=2,lL=`hide${Pc}`,cL=`hidden${Pc}`,uL=`show${Pc}`,fL=`shown${Pc}`,ET=`click${Pc}${ky}`,wT=`keydown${Pc}${ky}`,hL=`keyup${Pc}${ky}`,Pu="show",dL="dropup",pL="dropend",gL="dropstart",mL="dropup-center",vL="dropdown-center",pc='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',_L=`${pc}.${Pu}`,Rg=".dropdown-menu",yL=".navbar",bL=".navbar-nav",xL=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",EL=Ms()?"top-end":"top-start",wL=Ms()?"top-start":"top-end",AL=Ms()?"bottom-end":"bottom-start",SL=Ms()?"bottom-start":"bottom-end",TL=Ms()?"left-start":"right-start",CL=Ms()?"right-start":"left-start",DL="top",OL="bottom",RL={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},NL={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ua extends sa{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=we.next(this._element,Rg)[0]||we.prev(this._element,Rg)[0]||we.findOne(Rg,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return RL}static get DefaultType(){return NL}static get NAME(){return $w}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Sl(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!Jt.trigger(this._element,uL,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(bL))for(const r of[].concat(...document.body.children))Jt.on(r,"mouseover",Pg);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Pu),this._element.classList.add(Pu),Jt.trigger(this._element,fL,t)}}hide(){if(Sl(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!Jt.trigger(this._element,lL,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))Jt.off(r,"mouseover",Pg);this._popper&&this._popper.destroy(),this._menu.classList.remove(Pu),this._element.classList.remove(Pu),this._element.setAttribute("aria-expanded","false"),Co.removeDataAttribute(this._menu,"popper"),Jt.trigger(this._element,cL,t),this._element.focus()}}_getConfig(t){if(t=super._getConfig(t),typeof t.reference=="object"&&!To(t.reference)&&typeof t.reference.getBoundingClientRect!="function")throw new TypeError(`${$w.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(typeof Cy>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let t=this._element;this._config.reference==="parent"?t=this._parent:To(this._config.reference)?t=Al(this._config.reference):typeof this._config.reference=="object"&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=Ty(t,this._menu,e)}_isShown(){return this._menu.classList.contains(Pu)}_getPlacement(){const t=this._parent;if(t.classList.contains(pL))return TL;if(t.classList.contains(gL))return CL;if(t.classList.contains(mL))return DL;if(t.classList.contains(vL))return OL;const e=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return t.classList.contains(dL)?e?wL:EL:e?SL:AL}_detectNavbar(){return this._element.closest(yL)!==null}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Co.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...ji(this._config.popperConfig,[void 0,t])}}_selectMenuItem({key:t,target:e}){const r=we.find(xL,this._menu).filter(i=>gf(i));r.length&&Ry(r,e,t===Vw,!r.includes(e)).focus()}static jQueryInterface(t){return this.each(function(){const e=Ua.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(t){if(t.button===oL||t.type==="keyup"&&t.key!==Gw)return;const e=we.find(_L);for(const r of e){const i=Ua.getInstance(r);if(!i||i._config.autoClose===!1)continue;const s=t.composedPath(),o=s.includes(i._menu);if(s.includes(i._element)||i._config.autoClose==="inside"&&!o||i._config.autoClose==="outside"&&o||i._menu.contains(t.target)&&(t.type==="keyup"&&t.key===Gw||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const l={relatedTarget:i._element};t.type==="click"&&(l.clickEvent=t),i._completeHide(l)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),r=t.key===sL,i=[aL,Vw].includes(t.key);if(!i&&!r||e&&!r)return;t.preventDefault();const s=this.matches(pc)?this:we.prev(this,pc)[0]||we.next(this,pc)[0]||we.findOne(pc,t.delegateTarget.parentNode),o=Ua.getOrCreateInstance(s);if(i){t.stopPropagation(),o.show(),o._selectMenuItem(t);return}o._isShown()&&(t.stopPropagation(),o.hide(),s.focus())}}Jt.on(document,wT,pc,Ua.dataApiKeydownHandler);Jt.on(document,wT,Rg,Ua.dataApiKeydownHandler);Jt.on(document,ET,Ua.clearMenus);Jt.on(document,hL,Ua.clearMenus);Jt.on(document,ET,pc,function(n){n.preventDefault(),Ua.getOrCreateInstance(this).toggle()});Bs(Ua);const AT="backdrop",kL="fade",Ww="show",Xw=`mousedown.bs.${AT}`,LL={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},ML={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ST extends Vd{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return LL}static get DefaultType(){return ML}static get NAME(){return AT}show(t){if(!this._config.isVisible){ji(t);return}this._append();const e=this._getElement();this._config.isAnimated&&Gd(e),e.classList.add(Ww),this._emulateAnimation(()=>{ji(t)})}hide(t){if(!this._config.isVisible){ji(t);return}this._getElement().classList.remove(Ww),this._emulateAnimation(()=>{this.dispose(),ji(t)})}dispose(){this._isAppended&&(Jt.off(this._element,Xw),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add(kL),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=Al(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),Jt.on(t,Xw,()=>{ji(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(t){uT(t,this._getElement(),this._config.isAnimated)}}const IL="focustrap",PL="bs.focustrap",Bg=`.${PL}`,FL=`focusin${Bg}`,BL=`keydown.tab${Bg}`,UL="Tab",zL="forward",Yw="backward",HL={autofocus:!0,trapElement:null},jL={autofocus:"boolean",trapElement:"element"};class TT extends Vd{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return HL}static get DefaultType(){return jL}static get NAME(){return IL}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Jt.off(document,Bg),Jt.on(document,FL,t=>this._handleFocusin(t)),Jt.on(document,BL,t=>this._handleKeydown(t)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Jt.off(document,Bg))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const r=we.focusableChildren(e);r.length===0?e.focus():this._lastTabNavDirection===Yw?r[r.length-1].focus():r[0].focus()}_handleKeydown(t){t.key===UL&&(this._lastTabNavDirection=t.shiftKey?Yw:zL)}}const qw=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Kw=".sticky-top",Wp="padding-right",Zw="margin-right";class j_{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Wp,e=>e+t),this._setElementAttributes(qw,Wp,e=>e+t),this._setElementAttributes(Kw,Zw,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Wp),this._resetElementAttributes(qw,Wp),this._resetElementAttributes(Kw,Zw)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,r){const i=this.getWidth(),s=o=>{if(o!==this._element&&window.innerWidth>o.clientWidth+i)return;this._saveInitialAttribute(o,e);const l=window.getComputedStyle(o).getPropertyValue(e);o.style.setProperty(e,`${r(Number.parseFloat(l))}px`)};this._applyManipulationCallback(t,s)}_saveInitialAttribute(t,e){const r=t.style.getPropertyValue(e);r&&Co.setDataAttribute(t,e,r)}_resetElementAttributes(t,e){const r=i=>{const s=Co.getDataAttribute(i,e);if(s===null){i.style.removeProperty(e);return}Co.removeDataAttribute(i,e),i.style.setProperty(e,s)};this._applyManipulationCallback(t,r)}_applyManipulationCallback(t,e){if(To(t)){e(t);return}for(const r of we.find(t,this._element))e(r)}}const $L="modal",GL="bs.modal",Is=`.${GL}`,VL=".data-api",WL="Escape",XL=`hide${Is}`,YL=`hidePrevented${Is}`,CT=`hidden${Is}`,DT=`show${Is}`,qL=`shown${Is}`,KL=`resize${Is}`,ZL=`click.dismiss${Is}`,QL=`mousedown.dismiss${Is}`,JL=`keydown.dismiss${Is}`,t3=`click${Is}${VL}`,Qw="modal-open",e3="fade",Jw="show",Fv="modal-static",n3=".modal.show",r3=".modal-dialog",i3=".modal-body",s3='[data-bs-toggle="modal"]',a3={backdrop:!0,focus:!0,keyboard:!0},o3={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Ac extends sa{constructor(t,e){super(t,e),this._dialog=we.findOne(r3,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new j_,this._addEventListeners()}static get Default(){return a3}static get DefaultType(){return o3}static get NAME(){return $L}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||Jt.trigger(this._element,DT,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Qw),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){!this._isShown||this._isTransitioning||Jt.trigger(this._element,XL).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Jw),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Jt.off(window,Is),Jt.off(this._dialog,Is),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ST({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new TT({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=we.findOne(i3,this._dialog);e&&(e.scrollTop=0),Gd(this._element),this._element.classList.add(Jw);const r=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Jt.trigger(this._element,qL,{relatedTarget:t})};this._queueCallback(r,this._dialog,this._isAnimated())}_addEventListeners(){Jt.on(this._element,JL,t=>{if(t.key===WL){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Jt.on(window,KL,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Jt.on(this._element,QL,t=>{Jt.one(this._element,ZL,e=>{if(!(this._element!==t.target||this._element!==e.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Qw),this._resetAdjustments(),this._scrollBar.reset(),Jt.trigger(this._element,CT)})}_isAnimated(){return this._element.classList.contains(e3)}_triggerBackdropTransition(){if(Jt.trigger(this._element,YL).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,r=this._element.style.overflowY;r==="hidden"||this._element.classList.contains(Fv)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(Fv),this._queueCallback(()=>{this._element.classList.remove(Fv),this._queueCallback(()=>{this._element.style.overflowY=r},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),r=e>0;if(r&&!t){const i=Ms()?"paddingLeft":"paddingRight";this._element.style[i]=`${e}px`}if(!r&&t){const i=Ms()?"paddingRight":"paddingLeft";this._element.style[i]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each(function(){const r=Ac.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof r[t]>"u")throw new TypeError(`No method named "${t}"`);r[t](e)}})}}Jt.on(document,t3,s3,function(n){const t=we.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Jt.one(t,DT,i=>{i.defaultPrevented||Jt.one(t,CT,()=>{gf(this)&&this.focus()})});const e=we.findOne(n3);e&&Ac.getInstance(e).hide(),Ac.getOrCreateInstance(t).toggle(this)});Em(Ac);Bs(Ac);const l3="offcanvas",c3="bs.offcanvas",Po=`.${c3}`,OT=".data-api",u3=`load${Po}${OT}`,f3="Escape",tA="show",eA="showing",nA="hiding",h3="offcanvas-backdrop",RT=".offcanvas.show",d3=`show${Po}`,p3=`shown${Po}`,g3=`hide${Po}`,rA=`hidePrevented${Po}`,NT=`hidden${Po}`,m3=`resize${Po}`,v3=`click${Po}${OT}`,_3=`keydown.dismiss${Po}`,y3='[data-bs-toggle="offcanvas"]',b3={backdrop:!0,keyboard:!0,scroll:!1},x3={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Tl extends sa{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return b3}static get DefaultType(){return x3}static get NAME(){return l3}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||Jt.trigger(this._element,d3,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new j_().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(eA);const r=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(tA),this._element.classList.remove(eA),Jt.trigger(this._element,p3,{relatedTarget:t})};this._queueCallback(r,this._element,!0)}hide(){if(!this._isShown||Jt.trigger(this._element,g3).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(nA),this._backdrop.hide();const e=()=>{this._element.classList.remove(tA,nA),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new j_().reset(),Jt.trigger(this._element,NT)};this._queueCallback(e,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=()=>{if(this._config.backdrop==="static"){Jt.trigger(this._element,rA);return}this.hide()},e=!!this._config.backdrop;return new ST({className:h3,isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?t:null})}_initializeFocusTrap(){return new TT({trapElement:this._element})}_addEventListeners(){Jt.on(this._element,_3,t=>{if(t.key===f3){if(this._config.keyboard){this.hide();return}Jt.trigger(this._element,rA)}})}static jQueryInterface(t){return this.each(function(){const e=Tl.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Jt.on(document,v3,y3,function(n){const t=we.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Sl(this))return;Jt.one(t,NT,()=>{gf(this)&&this.focus()});const e=we.findOne(RT);e&&e!==t&&Tl.getInstance(e).hide(),Tl.getOrCreateInstance(t).toggle(this)});Jt.on(window,u3,()=>{for(const n of we.find(RT))Tl.getOrCreateInstance(n).show()});Jt.on(window,m3,()=>{for(const n of we.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Tl.getOrCreateInstance(n).hide()});Em(Tl);Bs(Tl);const E3=/^aria-[\w-]*$/i,kT={"*":["class","dir","id","lang","role",E3],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},w3=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),A3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,S3=(n,t)=>{const e=n.nodeName.toLowerCase();return t.includes(e)?w3.has(e)?!!A3.test(n.nodeValue):!0:t.filter(r=>r instanceof RegExp).some(r=>r.test(e))};function T3(n,t,e){if(!n.length)return n;if(e&&typeof e=="function")return e(n);const i=new window.DOMParser().parseFromString(n,"text/html"),s=[].concat(...i.body.querySelectorAll("*"));for(const o of s){const l=o.nodeName.toLowerCase();if(!Object.keys(t).includes(l)){o.remove();continue}const u=[].concat(...o.attributes),h=[].concat(t["*"]||[],t[l]||[]);for(const d of u)S3(d,h)||o.removeAttribute(d.nodeName)}return i.body.innerHTML}const C3="TemplateFactory",D3={allowList:kT,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},O3={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},R3={entry:"(string|element|function|null)",selector:"(string|element)"};class N3 extends Vd{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return D3}static get DefaultType(){return O3}static get NAME(){return C3}getContent(){return Object.values(this._config.content).map(t=>this._resolvePossibleFunction(t)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[i,s]of Object.entries(this._config.content))this._setContent(t,s,i);const e=t.children[0],r=this._resolvePossibleFunction(this._config.extraClass);return r&&e.classList.add(...r.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,r]of Object.entries(t))super._typeCheckConfig({selector:e,entry:r},R3)}_setContent(t,e,r){const i=we.findOne(r,t);if(i){if(e=this._resolvePossibleFunction(e),!e){i.remove();return}if(To(e)){this._putElementInTemplate(Al(e),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(e);return}i.textContent=e}}_maybeSanitize(t){return this._config.sanitize?T3(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return ji(t,[void 0,this])}_putElementInTemplate(t,e){if(this._config.html){e.innerHTML="",e.append(t);return}e.textContent=t.textContent}}const k3="tooltip",L3=new Set(["sanitize","allowList","sanitizeFn"]),Bv="fade",M3="modal",Xp="show",I3=".tooltip-inner",iA=`.${M3}`,sA="hide.bs.modal",Xh="hover",Uv="focus",zv="click",P3="manual",F3="hide",B3="hidden",U3="show",z3="shown",H3="inserted",j3="click",$3="focusin",G3="focusout",V3="mouseenter",W3="mouseleave",X3={AUTO:"auto",TOP:"top",RIGHT:Ms()?"left":"right",BOTTOM:"bottom",LEFT:Ms()?"right":"left"},Y3={allowList:kT,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},q3={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Ps extends sa{constructor(t,e){if(typeof Cy>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Y3}static get DefaultType(){return q3}static get NAME(){return k3}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Jt.off(this._element.closest(iA),sA,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const t=Jt.trigger(this._element,this.constructor.eventName(U3)),r=(lT(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!r)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:s}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(s.append(i),Jt.trigger(this._element,this.constructor.eventName(H3))),this._popper=this._createPopper(i),i.classList.add(Xp),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))Jt.on(l,"mouseover",Pg);const o=()=>{Jt.trigger(this._element,this.constructor.eventName(z3)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(o,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Jt.trigger(this._element,this.constructor.eventName(F3)).defaultPrevented)return;if(this._getTipElement().classList.remove(Xp),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Jt.off(i,"mouseover",Pg);this._activeTrigger[zv]=!1,this._activeTrigger[Uv]=!1,this._activeTrigger[Xh]=!1,this._isHovered=null;const r=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Jt.trigger(this._element,this.constructor.eventName(B3)))};this._queueCallback(r,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(Bv,Xp),e.classList.add(`bs-${this.constructor.NAME}-auto`);const r=P4(this.constructor.NAME).toString();return e.setAttribute("id",r),this._isAnimated()&&e.classList.add(Bv),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new N3({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[I3]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Bv)}_isShown(){return this.tip&&this.tip.classList.contains(Xp)}_createPopper(t){const e=ji(this._config.placement,[this,t,this._element]),r=X3[e.toUpperCase()];return Ty(this._element,t,this._getPopperConfig(r))}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_resolvePossibleFunction(t){return ji(t,[this._element,this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:r=>{this._getTipElement().setAttribute("data-popper-placement",r.state.placement)}}]};return{...e,...ji(this._config.popperConfig,[void 0,e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if(e==="click")Jt.on(this._element,this.constructor.eventName(j3),this._config.selector,r=>{const i=this._initializeOnDelegatedTarget(r);i._activeTrigger[zv]=!(i._isShown()&&i._activeTrigger[zv]),i.toggle()});else if(e!==P3){const r=e===Xh?this.constructor.eventName(V3):this.constructor.eventName($3),i=e===Xh?this.constructor.eventName(W3):this.constructor.eventName(G3);Jt.on(this._element,r,this._config.selector,s=>{const o=this._initializeOnDelegatedTarget(s);o._activeTrigger[s.type==="focusin"?Uv:Xh]=!0,o._enter()}),Jt.on(this._element,i,this._config.selector,s=>{const o=this._initializeOnDelegatedTarget(s);o._activeTrigger[s.type==="focusout"?Uv:Xh]=o._element.contains(s.relatedTarget),o._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Jt.on(this._element.closest(iA),sA,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=Co.getDataAttributes(this._element);for(const r of Object.keys(e))L3.has(r)&&delete e[r];return t={...e,...typeof t=="object"&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=t.container===!1?document.body:Al(t.container),typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),typeof t.title=="number"&&(t.title=t.title.toString()),typeof t.content=="number"&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,r]of Object.entries(this._config))this.constructor.Default[e]!==r&&(t[e]=r);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){const e=Ps.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Bs(Ps);const K3="popover",Z3=".popover-header",Q3=".popover-body",J3={...Ps.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},tM={...Ps.DefaultType,content:"(null|string|element|function)"};class Ly extends Ps{static get Default(){return J3}static get DefaultType(){return tM}static get NAME(){return K3}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Z3]:this._getTitle(),[Q3]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){const e=Ly.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Bs(Ly);const eM="scrollspy",nM="bs.scrollspy",My=`.${nM}`,rM=".data-api",iM=`activate${My}`,aA=`click${My}`,sM=`load${My}${rM}`,aM="dropdown-item",Nu="active",oM='[data-bs-spy="scroll"]',Hv="[href]",lM=".nav, .list-group",oA=".nav-link",cM=".nav-item",uM=".list-group-item",fM=`${oA}, ${cM} > ${oA}, ${uM}`,hM=".dropdown",dM=".dropdown-toggle",pM={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},gM={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Sm extends sa{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return pM}static get DefaultType(){return gM}static get NAME(){return eM}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=Al(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,typeof t.threshold=="string"&&(t.threshold=t.threshold.split(",").map(e=>Number.parseFloat(e))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Jt.off(this._config.target,aA),Jt.on(this._config.target,aA,Hv,t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const r=this._rootElement||window,i=e.offsetTop-this._element.offsetTop;if(r.scrollTo){r.scrollTo({top:i,behavior:"smooth"});return}r.scrollTop=i}}))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),t)}_observerCallback(t){const e=o=>this._targetLinks.get(`#${o.target.id}`),r=o=>{this._previousScrollData.visibleEntryTop=o.target.offsetTop,this._process(e(o))},i=(this._rootElement||document.documentElement).scrollTop,s=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const o of t){if(!o.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(o));continue}const l=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&l){if(r(o),!i)return;continue}!s&&!l&&r(o)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=we.find(Hv,this._config.target);for(const e of t){if(!e.hash||Sl(e))continue;const r=we.findOne(decodeURI(e.hash),this._element);gf(r)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,r))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(Nu),this._activateParents(t),Jt.trigger(this._element,iM,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains(aM)){we.findOne(dM,t.closest(hM)).classList.add(Nu);return}for(const e of we.parents(t,lM))for(const r of we.prev(e,fM))r.classList.add(Nu)}_clearActiveClass(t){t.classList.remove(Nu);const e=we.find(`${Hv}.${Nu}`,t);for(const r of e)r.classList.remove(Nu)}static jQueryInterface(t){return this.each(function(){const e=Sm.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(window,sM,()=>{for(const n of we.find(oM))Sm.getOrCreateInstance(n)});Bs(Sm);const mM="tab",vM="bs.tab",Fc=`.${vM}`,_M=`hide${Fc}`,yM=`hidden${Fc}`,bM=`show${Fc}`,xM=`shown${Fc}`,EM=`click${Fc}`,wM=`keydown${Fc}`,AM=`load${Fc}`,SM="ArrowLeft",lA="ArrowRight",TM="ArrowUp",cA="ArrowDown",jv="Home",uA="End",gc="active",fA="fade",$v="show",CM="dropdown",LT=".dropdown-toggle",DM=".dropdown-menu",Gv=`:not(${LT})`,OM='.list-group, .nav, [role="tablist"]',RM=".nav-item, .list-group-item",NM=`.nav-link${Gv}, .list-group-item${Gv}, [role="tab"]${Gv}`,MT='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Vv=`${NM}, ${MT}`,kM=`.${gc}[data-bs-toggle="tab"], .${gc}[data-bs-toggle="pill"], .${gc}[data-bs-toggle="list"]`;class af extends sa{constructor(t){super(t),this._parent=this._element.closest(OM),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Jt.on(this._element,wM,e=>this._keydown(e)))}static get NAME(){return mM}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),r=e?Jt.trigger(e,_M,{relatedTarget:t}):null;Jt.trigger(t,bM,{relatedTarget:e}).defaultPrevented||r&&r.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){if(!t)return;t.classList.add(gc),this._activate(we.getElementFromSelector(t));const r=()=>{if(t.getAttribute("role")!=="tab"){t.classList.add($v);return}t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),Jt.trigger(t,xM,{relatedTarget:e})};this._queueCallback(r,t,t.classList.contains(fA))}_deactivate(t,e){if(!t)return;t.classList.remove(gc),t.blur(),this._deactivate(we.getElementFromSelector(t));const r=()=>{if(t.getAttribute("role")!=="tab"){t.classList.remove($v);return}t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),Jt.trigger(t,yM,{relatedTarget:e})};this._queueCallback(r,t,t.classList.contains(fA))}_keydown(t){if(![SM,lA,TM,cA,jv,uA].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=this._getChildren().filter(i=>!Sl(i));let r;if([jv,uA].includes(t.key))r=e[t.key===jv?0:e.length-1];else{const i=[lA,cA].includes(t.key);r=Ry(e,t.target,i,!0)}r&&(r.focus({preventScroll:!0}),af.getOrCreateInstance(r).show())}_getChildren(){return we.find(Vv,this._parent)}_getActiveElem(){return this._getChildren().find(t=>this._elemIsActive(t))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const r of e)this._setInitialAttributesOnChild(r)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),r=this._getOuterElement(t);t.setAttribute("aria-selected",e),r!==t&&this._setAttributeIfNotExists(r,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=we.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const r=this._getOuterElement(t);if(!r.classList.contains(CM))return;const i=(s,o)=>{const l=we.findOne(s,r);l&&l.classList.toggle(o,e)};i(LT,gc),i(DM,$v),r.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,r){t.hasAttribute(e)||t.setAttribute(e,r)}_elemIsActive(t){return t.classList.contains(gc)}_getInnerElement(t){return t.matches(Vv)?t:we.findOne(Vv,t)}_getOuterElement(t){return t.closest(RM)||t}static jQueryInterface(t){return this.each(function(){const e=af.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(document,EM,MT,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Sl(this)&&af.getOrCreateInstance(this).show()});Jt.on(window,AM,()=>{for(const n of we.find(kM))af.getOrCreateInstance(n)});Bs(af);const LM="toast",MM="bs.toast",Ml=`.${MM}`,IM=`mouseover${Ml}`,PM=`mouseout${Ml}`,FM=`focusin${Ml}`,BM=`focusout${Ml}`,UM=`hide${Ml}`,zM=`hidden${Ml}`,HM=`show${Ml}`,jM=`shown${Ml}`,$M="fade",hA="hide",Yp="show",qp="showing",GM={animation:"boolean",autohide:"boolean",delay:"number"},VM={animation:!0,autohide:!0,delay:5e3};class Tm extends sa{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return VM}static get DefaultType(){return GM}static get NAME(){return LM}show(){if(Jt.trigger(this._element,HM).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add($M);const e=()=>{this._element.classList.remove(qp),Jt.trigger(this._element,jM),this._maybeScheduleHide()};this._element.classList.remove(hA),Gd(this._element),this._element.classList.add(Yp,qp),this._queueCallback(e,this._element,this._config.animation)}hide(){if(!this.isShown()||Jt.trigger(this._element,UM).defaultPrevented)return;const e=()=>{this._element.classList.add(hA),this._element.classList.remove(qp,Yp),Jt.trigger(this._element,zM)};this._element.classList.add(qp),this._queueCallback(e,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Yp),super.dispose()}isShown(){return this._element.classList.contains(Yp)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=e;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=e;break}}if(e){this._clearTimeout();return}const r=t.relatedTarget;this._element===r||this._element.contains(r)||this._maybeScheduleHide()}_setListeners(){Jt.on(this._element,IM,t=>this._onInteraction(t,!0)),Jt.on(this._element,PM,t=>this._onInteraction(t,!1)),Jt.on(this._element,FM,t=>this._onInteraction(t,!0)),Jt.on(this._element,BM,t=>this._onInteraction(t,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const e=Tm.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Em(Tm);Bs(Tm);const _i=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),$_=[.001,0,0,.001,0,0],Wv=1.35,ts={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Pa={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},WM="pdfjs_internal_editor_",Fe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Ke={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},IT={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},qr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ud={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},qn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Fu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Yd={ERRORS:0,WARNINGS:1,INFOS:5},xd={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Kp={moveTo:0,lineTo:1,curveTo:2,closePath:3},PT={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Cm=Yd.WARNINGS;function XM(n){Number.isInteger(n)&&(Cm=n)}function YM(){return Cm}function Dm(n){Cm>=Yd.INFOS&&console.log(`Info: ${n}`)}function Ue(n){Cm>=Yd.WARNINGS&&console.log(`Warning: ${n}`)}function An(n){throw new Error(n)}function or(n,t){n||An(t)}function qM(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Iy(n,t=null,e=null){if(!n)return null;if(e&&typeof n=="string"&&(e.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),e.tryConvertEncoding))try{n=tI(n)}catch{}const r=t?URL.parse(n,t):URL.parse(n);return qM(r)?r:null}function Py(n,t,e=!1){const r=URL.parse(n);return r?(r.hash=t,r.href):e&&Iy(n,"http://example.com")?n.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Ye(n,t,e,r=!1){return Object.defineProperty(n,t,{value:e,enumerable:!r,configurable:!0,writable:!1}),e}const Bc=function(){function t(e,r){this.message=e,this.name=r}return t.prototype=new Error,t.constructor=t,t}();class dA extends Bc{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Xv extends Bc{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Ug extends Bc{constructor(t){super(t,"InvalidPDFException")}}class Ed extends Bc{constructor(t,e,r){super(t,"ResponseException"),this.status=e,this.missing=r}}class KM extends Bc{constructor(t){super(t,"FormatError")}}class ko extends Bc{constructor(t){super(t,"AbortException")}}function FT(n){(typeof n!="object"||n?.length===void 0)&&An("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const r=[];for(let i=0;i<t;i+=e){const s=Math.min(i+e,t),o=n.subarray(i,s);r.push(String.fromCharCode.apply(null,o))}return r.join("")}function qd(n){typeof n!="string"&&An("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let r=0;r<t;++r)e[r]=n.charCodeAt(r)&255;return e}function ZM(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function QM(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function JM(){try{return new Function(""),!0}catch{return!1}}class Tr{static get isLittleEndian(){return Ye(this,"isLittleEndian",QM())}static get isEvalSupported(){return Ye(this,"isEvalSupported",JM())}static get isOffscreenCanvasSupported(){return Ye(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ye(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Ye(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Ye(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Yv=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class be{static makeHexColor(t,e,r){return`#${Yv[t]}${Yv[e]}${Yv[r]}`}static scaleMinMax(t,e){let r;t[0]?(t[0]<0&&(r=e[0],e[0]=e[2],e[2]=r),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(r=e[1],e[1]=e[3],e[3]=r),e[1]*=t[3],e[3]*=t[3]):(r=e[0],e[0]=e[1],e[1]=r,r=e[2],e[2]=e[3],e[3]=r,t[1]<0&&(r=e[1],e[1]=e[3],e[3]=r),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(r=e[0],e[0]=e[2],e[2]=r),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e,r=0){const i=t[r],s=t[r+1];t[r]=i*e[0]+s*e[2]+e[4],t[r+1]=i*e[1]+s*e[3]+e[5]}static applyTransformToBezier(t,e,r=0){const i=e[0],s=e[1],o=e[2],l=e[3],u=e[4],h=e[5];for(let d=0;d<6;d+=2){const p=t[r+d],g=t[r+d+1];t[r+d]=p*i+g*o+u,t[r+d+1]=p*s+g*l+h}}static applyInverseTransform(t,e){const r=t[0],i=t[1],s=e[0]*e[3]-e[1]*e[2];t[0]=(r*e[3]-i*e[2]+e[2]*e[5]-e[4]*e[3])/s,t[1]=(-r*e[1]+i*e[0]+e[4]*e[1]-e[5]*e[0])/s}static axialAlignedBoundingBox(t,e,r){const i=e[0],s=e[1],o=e[2],l=e[3],u=e[4],h=e[5],d=t[0],p=t[1],g=t[2],v=t[3];let y=i*d+u,_=y,b=i*g+u,E=b,S=l*p+h,T=S,O=l*v+h,R=O;if(s!==0||o!==0){const N=s*d,C=s*g,I=o*p,M=o*v;y+=I,E+=I,b+=M,_+=M,S+=N,R+=N,O+=C,T+=C}r[0]=Math.min(r[0],y,b,_,E),r[1]=Math.min(r[1],S,O,T,R),r[2]=Math.max(r[2],y,b,_,E),r[3]=Math.max(r[3],S,O,T,R)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const r=t[0],i=t[1],s=t[2],o=t[3],l=r**2+i**2,u=r*s+i*o,h=s**2+o**2,d=(l+h)/2,p=Math.sqrt(d**2-(l*h-u**2));e[0]=Math.sqrt(d+p||1),e[1]=Math.sqrt(d-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const r=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(r>i)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>o?null:[r,s,i,o]}static pointBoundingBox(t,e,r){r[0]=Math.min(r[0],t),r[1]=Math.min(r[1],e),r[2]=Math.max(r[2],t),r[3]=Math.max(r[3],e)}static rectBoundingBox(t,e,r,i,s){s[0]=Math.min(s[0],t,r),s[1]=Math.min(s[1],e,i),s[2]=Math.max(s[2],t,r),s[3]=Math.max(s[3],e,i)}static#t(t,e,r,i,s,o,l,u,h,d){if(h<=0||h>=1)return;const p=1-h,g=h*h,v=g*h,y=p*(p*(p*t+3*h*e)+3*g*r)+v*i,_=p*(p*(p*s+3*h*o)+3*g*l)+v*u;d[0]=Math.min(d[0],y),d[1]=Math.min(d[1],_),d[2]=Math.max(d[2],y),d[3]=Math.max(d[3],_)}static#e(t,e,r,i,s,o,l,u,h,d,p,g){if(Math.abs(h)<1e-12){Math.abs(d)>=1e-12&&this.#t(t,e,r,i,s,o,l,u,-p/d,g);return}const v=d**2-4*p*h;if(v<0)return;const y=Math.sqrt(v),_=2*h;this.#t(t,e,r,i,s,o,l,u,(-d+y)/_,g),this.#t(t,e,r,i,s,o,l,u,(-d-y)/_,g)}static bezierBoundingBox(t,e,r,i,s,o,l,u,h){h[0]=Math.min(h[0],t,l),h[1]=Math.min(h[1],e,u),h[2]=Math.max(h[2],t,l),h[3]=Math.max(h[3],e,u),this.#e(t,r,s,l,e,i,o,u,3*(-t+3*(r-s)+l),6*(t-2*r+s),3*(r-t),h),this.#e(t,r,s,l,e,i,o,u,3*(-e+3*(i-o)+u),6*(e-2*i+o),3*(i-e),h)}}function tI(n){return decodeURIComponent(escape(n))}let qv=null,pA=null;function BT(n){return qv||(qv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,pA=new Map([["","t"]])),n.replaceAll(qv,(t,e,r)=>e?e.normalize("NFKC"):pA.get(r))}function Fy(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),FT(n)}const By="pdfjs_internal_id_";function eI(n,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[r,i,...s]=e;if(!n(r)&&!Number.isInteger(r)||!t(i))return!1;const o=s.length;let l=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;l=!1;break;default:return!1}for(const u of s)if(!(typeof u=="number"||l&&u===null))return!1;return!0}function Kr(n,t,e){return Math.min(Math.max(n,t),e)}function UT(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(FT(n))}function nI(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):qd(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((t,e)=>t+e,0)});const Eo="http://www.w3.org/2000/svg";class Sc{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function vf(n,t="text"){if(id(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,r)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class Kd{constructor({viewBox:t,userUnit:e,scale:r,rotation:i,offsetX:s=0,offsetY:o=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=o,r*=e;const u=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let d,p,g,v;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,p=0,g=0,v=1;break;case 90:d=0,p=1,g=1,v=0;break;case 270:d=0,p=-1,g=-1,v=0;break;case 0:d=1,p=0,g=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(g=-g,v=-v);let y,_,b,E;d===0?(y=Math.abs(h-t[1])*r+s,_=Math.abs(u-t[0])*r+o,b=(t[3]-t[1])*r,E=(t[2]-t[0])*r):(y=Math.abs(u-t[0])*r+s,_=Math.abs(h-t[1])*r+o,b=(t[2]-t[0])*r,E=(t[3]-t[1])*r),this.transform=[d*r,p*r,g*r,v*r,y-d*r*u-g*r*h,_-p*r*u-v*r*h],this.width=b,this.height=E}get rawDims(){const t=this.viewBox;return Ye(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new Kd({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(t,e){const r=[t,e];return be.applyTransform(r,this.transform),r}convertToViewportRectangle(t){const e=[t[0],t[1]];be.applyTransform(e,this.transform);const r=[t[2],t[3]];return be.applyTransform(r,this.transform),[e[0],e[1],r[0],r[1]]}convertToPdfPoint(t,e){const r=[t,e];return be.applyInverseTransform(r,this.transform),r}}class Om extends Bc{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Zd(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function Rm(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function zT(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function HT(n,t="document.pdf"){if(typeof n!="string")return t;if(Zd(n))return Ue('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=e.exec(n);let s=r.exec(i[1])||r.exec(i[2])||r.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=r.exec(decodeURIComponent(s))[0]}catch{}return s||t}class gA{started=Object.create(null);times=[];time(t){t in this.started&&Ue(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Ue(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:r}of this.times)e=Math.max(r.length,e);for(const{name:r,start:i,end:s}of this.times)t.push(`${r.padEnd(e)} ${s-i}ms
`);return t.join("")}}function id(n,t){const e=t?URL.parse(n,t):URL.parse(n);return e?.protocol==="http:"||e?.protocol==="https:"}function Fs(n){n.preventDefault()}function Zn(n){n.preventDefault(),n.stopPropagation()}function rI(n){console.log("Deprecated API usage: "+n)}class Uy{static#t;static toDateObject(t){if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const r=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let u=parseInt(e[6],10);u=u>=0&&u<=59?u:0;const h=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,h==="-"?(o+=d,l+=p):h==="+"&&(o-=d,l-=p),new Date(Date.UTC(r,i,s,o,l,u))}}function jT(n,{scale:t=1,rotation:e=0}){const{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new Kd({viewBox:s,userUnit:1,scale:t,rotation:e})}function zy(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Ue(`Not a valid color format: "${n}"`),[0,0,0])}function iI(n){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of n.keys()){t.style.color=e;const r=window.getComputedStyle(t).color;n.set(e,zy(r))}t.remove()}function Hn(n){const{a:t,b:e,c:r,d:i,e:s,f:o}=n.getTransform();return[t,e,r,i,s,o]}function Ca(n){const{a:t,b:e,c:r,d:i,e:s,f:o}=n.getTransform().invertSelf();return[t,e,r,i,s,o]}function Cl(n,t,e=!1,r=!0){if(t instanceof Kd){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:o}=n,l=Tr.isCSSRoundSupported,u=`var(--total-scale-factor) * ${i}px`,h=`var(--total-scale-factor) * ${s}px`,d=l?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,p=l?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!e||t.rotation%180===0?(o.width=d,o.height=p):(o.width=p,o.height=d)}r&&n.setAttribute("data-main-rotation",t.rotation)}class ia{constructor(){const{pixelRatio:t}=ia;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,r,i,s=-1){let o=1/0,l=1/0,u=1/0;r=ia.capPixels(r,s),r>0&&(o=Math.sqrt(r/(t*e))),i!==-1&&(l=i/t,u=i/e);const h=Math.min(o,l,u);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,r):r}return t}}const zg=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class fd{#t=null;#e=null;#n;#r=null;#s=null;#i=null;static#l=null;constructor(t){this.#n=t,fd.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;t.addEventListener("contextmenu",Fs,{signal:e}),t.addEventListener("pointerdown",fd.#o,{signal:e});const r=this.#r=document.createElement("div");r.className="buttons",t.append(r);const i=this.#n.toolbarPosition;if(i){const{style:s}=t,o=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*o}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),t}get div(){return this.#t}static#o(t){t.stopPropagation()}#f(t){this.#n._focusEventsAllowed=!1,Zn(t)}#c(t){this.#n._focusEventsAllowed=!0,Zn(t)}#h(t){const e=this.#n._uiManager._signal;t.addEventListener("focusin",this.#f.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Fs,{signal:e})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown()}#u(){const{editorType:t,_uiManager:e}=this.#n,r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",fd.#l[t]),this.#h(r),r.addEventListener("click",i=>{e.delete()},{signal:e._signal}),this.#r.append(r)}get#d(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#h(e),this.#r.prepend(e,this.#d),this.#s=t}addColorPicker(t){this.#e=t;const e=t.renderButton();this.#h(e),this.#r.prepend(e,this.#d)}async addEditSignatureButton(t){const e=this.#i=await t.renderEditButton(this.#n);this.#h(e),this.#r.prepend(e,this.#d)}updateEditSignatureButton(t){this.#i&&(this.#i.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class sI{#t=null;#e=null;#n;constructor(t){this.#n=t}#r(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Fs,{signal:this.#n._signal});const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#i(),t}#s(t,e){let r=0,i=0;for(const s of t){const o=s.y+s.height;if(o<r)continue;const l=s.x+(e?s.width:0);if(o>r){i=l,r=o;continue}e?l>i&&(i=l):l<i&&(i=l)}return[e?1-i:i,r]}show(t,e,r){const[i,s]=this.#s(e,r),{style:o}=this.#e||=this.#r();t.append(this.#e),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#i(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const r=this.#n._signal;t.addEventListener("contextmenu",Fs,{signal:r}),t.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:r}),this.#t.append(t)}}function $T(n,t,e){for(const r of e)t.addEventListener(r,n[r].bind(n))}class aI{#t=0;get id(){return`${WM}${this.#t++}`}}class Hy{#t=Fy();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Ye(this,"_isSVGFittingCanvas",s)}async#r(t,e){this.#n||=new Map;let r=this.#n.get(t);if(r===null)return null;if(r?.bitmap)return r.refCounter+=1,r;try{r||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let i;if(typeof e=="string"?(r.url=e,i=await vf(e,"blob")):e instanceof File?i=r.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const s=Hy._isSVGFittingCanvas,o=new FileReader,l=new Image,u=new Promise((h,d)=>{l.onload=()=>{r.bitmap=l,r.isSvg=!0,h()},o.onload=async()=>{const p=r.svgUrl=o.result;l.src=await s?`${p}#svgView(preserveAspectRatio(none))`:p},l.onerror=o.onerror=d});o.readAsDataURL(i),await u}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){Ue(i),r=null}return this.#n.set(t,r),r&&this.#n.set(r.id,r),r}async getFromFile(t){const{lastModified:e,name:r,size:i,type:s}=t;return this.#r(`${e}_${r}_${i}_${s}`,t)}async getFromUrl(t){return this.#r(t,t)}async getFromBlob(t,e){const r=await e;return this.#r(t,r)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:r}=e;return delete e.blobPromise,this.getFromBlob(e.id,r)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let r=this.#n.get(t);if(r?.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,r),this.#n.set(r.id,r),r}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:r}=e;if(!e.url&&!e.file){const i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),e.blobPromise=i.convertToBlob()}r.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class oI{#t=[];#e=!1;#n;#r=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:o=!1,keepUndo:l=!1}){if(i&&t(),this.#e)return;const u={cmd:t,undo:e,post:r,type:s};if(this.#r===-1){this.#t.length>0&&(this.#t.length=0),this.#r=0,this.#t.push(u);return}if(o&&this.#t[this.#r].type===s){l&&(u.undo=this.#t[this.#r].undo),this.#t[this.#r]=u;return}const h=this.#r+1;h===this.#n?this.#t.splice(0,1):(this.#r=h,h<this.#t.length&&this.#t.splice(h)),this.#t.push(u)}undo(){if(this.#r===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#r];t(),e?.(),this.#e=!1,this.#r-=1}redo(){if(this.#r<this.#t.length-1){this.#r+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#r];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#t.length-1}cleanType(t){if(this.#r!==-1){for(let e=this.#r;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#r-e),this.#r=e;return}this.#t.length=0,this.#r=-1}}destroy(){this.#t=null}}class Qd{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Tr.platform;for(const[r,i,s={}]of t)for(const o of r){const l=o.startsWith("mac+");e&&l?(this.callbacks.set(o.slice(4),{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1))):!e&&!l&&(this.callbacks.set(o,{callback:i,options:s}),this.allKeys.add(o.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const r=this.callbacks.get(this.#t(e));if(!r)return;const{callback:i,options:{bubbles:s=!1,args:o=[],checker:l=null}}=r;l&&!l(t,e)||(i.bind(t,...o,e)(),s||Zn(e))}}class jy{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return iI(t),Ye(this,"_colors",t)}convert(t){const e=zy(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[r,i]of this._colors)if(i.every((s,o)=>s===e[o]))return jy._colorsMapping.get(r);return e}getHexCode(t){const e=this._colors.get(t);return e?be.makeHexColor(...e):t}}class Lo{#t=new AbortController;#e=null;#n=new Map;#r=new Map;#s=null;#i=null;#l=null;#o=new oI;#f=null;#c=null;#h=0;#u=new Set;#d=null;#a=null;#p=new Set;_editorUndoBar=null;#m=!1;#g=!1;#v=!1;#_=null;#y=null;#x=null;#w=null;#S=!1;#C=null;#O=new aI;#E=!1;#D=!1;#T=null;#N=null;#k=null;#L=null;#z=null;#A=Fe.NONE;#b=new Set;#F=null;#B=null;#$=null;#G=null;#V={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#M=null;#I=null;#j=null;#P=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Lo.prototype,e=o=>o.#I.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),r=(o,{target:l})=>{if(l instanceof HTMLInputElement){const{type:u}=l;return u!=="text"&&u!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Ye(this,"_keyboardManager",new Qd([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],t.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:r}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&o.#I.contains(l)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:l})=>!(l instanceof HTMLButtonElement)&&o.#I.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}constructor(t,e,r,i,s,o,l,u,h,d,p,g,v,y){const _=this._signal=this.#t.signal;this.#I=t,this.#j=e,this.#s=r,this.#B=i,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:_}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),s._on("setpreference",this.onSetPreference.bind(this),{signal:_}),s._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:_}),this.#rt(),this.#ot(),this.#K(),this.#i=o.annotationStorage,this.#_=o.filterFactory,this.#$=l,this.#w=u||null,this.#m=h,this.#g=d,this.#v=p,this.#z=g||null,this.viewParameters={realScale:Sc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=y!==!1}destroy(){this.#P?.resolve(),this.#P=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#n.clear(),this.#p.clear(),this.#L?.clear(),this.#e=null,this.#b.clear(),this.#o.destroy(),this.#s?.destroy(),this.#B?.destroy(),this.#C?.hide(),this.#C=null,this.#k?.destroy(),this.#k=null,this.#y&&(clearTimeout(this.#y),this.#y=null),this.#M&&(clearTimeout(this.#M),this.#M=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#z}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Ye(this,"hcmFilter",this.#$?this.#_.addHCMFilter(this.#$.foreground,this.#$.background):"none")}get direction(){return Ye(this,"direction",getComputedStyle(this.#I).direction)}get highlightColors(){return Ye(this,"highlightColors",this.#w?new Map(this.#w.split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Ye(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#k=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}getSignature(t){this.#B?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#B}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=e;break}}onPageChanging({pageNumber:t}){this.#h=t-1}focusMainContainer(){this.#I.focus()}findParent(t,e){for(const r of this.#r.values()){const{x:i,y:s,width:o,height:l}=r.div.getBoundingClientRect();if(t>=i&&t<=i+o&&e>=s&&e<=s+l)return r}return null}disableUserSelect(t=!1){this.#j.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Sc.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#X({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#q(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const r of this.#r.values())if(r.hasTextLayer(t))return r;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}=e,l=e.toString(),h=this.#X(e).closest(".textLayer"),d=this.getSelectionBoxes(h);if(!d)return;e.empty();const p=this.#q(h),g=this.#A===Fe.NONE,v=()=>{p?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o,text:l}),g&&this.showAllEditors("highlight",!0,!0)};if(g){this.switchToMode(Fe.HIGHLIGHT,v);return}v()}#et(){const t=document.getSelection();if(!t||t.isCollapsed)return;const r=this.#X(t).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(this.#C||=new sI(this),this.#C.show(r,i,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#i&&!this.#i.has(t.id)&&this.#i.setValue(t.id,t)}#nt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#F&&(this.#C?.hide(),this.#F=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#F)return;const i=this.#X(t).closest(".textLayer");if(!i){this.#F&&(this.#C?.hide(),this.#F=null,this.#R({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#F=e,this.#R({hasSelectedText:!0}),!(this.#A!==Fe.HIGHLIGHT&&this.#A!==Fe.NONE)&&(this.#A===Fe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const s=this.#A===Fe.HIGHLIGHT?this.#q(i):null;s?.toggleDrawing();const o=new AbortController,l=this.combinedSignal(o),u=h=>{h.type==="pointerup"&&h.button!==0||(o.abort(),s?.toggleDrawing(!0),h.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",u,{signal:l}),window.addEventListener("blur",u,{signal:l})}}#Y(t=""){this.#A===Fe.HIGHLIGHT?this.highlightSelection(t):this.#m&&this.#et()}#rt(){document.addEventListener("selectionchange",this.#nt.bind(this),{signal:this._signal})}#it(){if(this.#x)return;this.#x=new AbortController;const t=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#st(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#b)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#K(){if(this.#T)return;this.#T=new AbortController;const t=this.combinedSignal(this.#T);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#at(){this.#T?.abort(),this.#T=null}#Z(){if(this.#f)return;this.#f=new AbortController;const t=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#Q(){this.#f?.abort(),this.#f=null}#ot(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#K(),this.#Z()}removeEditListeners(){this.#at(),this.#Q()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const r of this.#a)if(r.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const r of this.#a)if(r.isHandlingMimeForPasting(e.type)){r.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const r of this.#b){const i=r.serialize(!0);i&&e.push(i)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const o of this.#a)if(o.isHandlingMimeForPasting(s.type)){o.paste(s,this.currentLayer);return}let r=e.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){Ue(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const u of r){const h=await i.deserialize(u);if(!h)return;s.push(h)}const o=()=>{for(const u of s)this.#J(u);this.#tt(s)},l=()=>{for(const u of s)u.remove()};this.addCommands({cmd:o,undo:l,mustExec:!0})}catch(s){Ue(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==Fe.NONE&&!this.isEditorHandlingKeyboard&&Lo._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#R(t){Object.entries(t).some(([r,i])=>this.#V[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#V,t)}),this.#A===Fe.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#U([[Ke.HIGHLIGHT_FREE,!0]]))}#U(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#it(),this.#Z(),this.#R({isEditing:this.#A!==Fe.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#st(),this.#Q(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#a){this.#a=t;for(const e of this.#a)this.#U(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#r.get(this.#h)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#h}addLayer(t){this.#r.set(t.pageIndex,t),this.#E?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,e=null,r=!1){if(this.#A!==t&&!(this.#P&&(await this.#P.promise,!this.#P))){if(this.#P=Promise.withResolvers(),this.#c?.commitOrRemove(),this.#A=t,t===Fe.NONE){this.setEditingState(!1),this.#ct(),this._editorUndoBar?.hide(),this.#P.resolve();return}t===Fe.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#lt(),this.unselectAll();for(const i of this.#r.values())i.updateMode(t);if(!e){r&&this.addNewEditorFromKeyboard(),this.#P.resolve();return}for(const i of this.#n.values())i.annotationElementId===e||i.id===e?(this.setSelected(i),i.enterInEditMode()):i.unselect();this.#P.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#a){switch(t){case Ke.CREATE:this.currentLayer.addNewEditor(e);return;case Ke.HIGHLIGHT_DEFAULT_COLOR:this.#k?.updateColor(e);break;case Ke.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const r of this.#b)r.updateParams(t,e);for(const r of this.#a)r.updateDefaultParams(t,e)}}showAllEditors(t,e,r=!1){for(const s of this.#n.values())s.editorType===t&&s.show(e);(this.#G?.get(Ke.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#U([[Ke.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#D!==t){this.#D=t;for(const e of this.#r.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#lt(){if(!this.#E){this.#E=!0;const t=[];for(const e of this.#r.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#ct(){if(this.unselectAll(),this.#E){this.#E=!1;for(const t of this.#r.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const r of this.#n.values())r.pageIndex===t&&e.push(r);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.focusMainContainer(),this.#y=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#L?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#u.has(t.annotationElementId))&&this.#i?.remove(t.id)}addDeletedAnnotationElement(t){this.#u.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#u.has(t)}removeDeletedAnnotationElement(t){this.#u.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#J(t){const e=this.#r.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#U(t.propertiesToUpdate))}get#ut(){let t=null;for(t of this.#b);return t}updateUI(t){this.#ut===t&&this.#U(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#U(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#b.has(t)){this.#b.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#b.add(t),t.select(),this.#U(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.#c?.commitOrRemove();for(const e of this.#b)e!==t&&e.unselect();this.#b.clear(),this.#b.add(t),t.select(),this.#U(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#b.has(t)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(t){t.unselect(),this.#b.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#R({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#o.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#o.cleanType(t)}#W(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#b],r=()=>{this._editorUndoBar?.show(i,e.length===1?e[0].editorType:e.length);for(const s of e)s.remove()},i=()=>{for(const s of e)this.#J(s)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#tt(t){for(const e of this.#b)e.unselect();this.#b.clear();for(const e of t)e.isEmpty()||(this.#b.add(e),e.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#b)t.commit();this.#tt(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#A!==Fe.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const t of this.#b)t.unselect();this.#b.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[i,s]=this.#H,o=[...this.#b],l=1e3;this.#M&&clearTimeout(this.#M),this.#M=setTimeout(()=>{this.#M=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const u of o)this.#n.has(u.id)&&(u.translateInPage(i,s),u.translationDone())},undo:()=>{for(const u of o)this.#n.has(u.id)&&(u.translateInPage(-i,-s),u.translationDone())},mustExec:!1})},l);for(const u of o)u.translateInPage(t,e),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#d=new Map;for(const t of this.#b)this.#d.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#d)return!1;this.disableUserSelect(!1);const t=this.#d;this.#d=null;let e=!1;for(const[{x:i,y:s,pageIndex:o},l]of t)l.newX=i,l.newY=s,l.newPageIndex=o,e||=i!==l.savedX||s!==l.savedY||o!==l.savedPageIndex;if(!e)return!1;const r=(i,s,o,l)=>{if(this.#n.has(i.id)){const u=this.#r.get(l);u?i._setParentAndPosition(u,s,o):(i.pageIndex=l,i.x=s,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:o,newPageIndex:l}]of t)r(i,s,o,l)},undo:()=>{for(const[i,{savedX:s,savedY:o,savedPageIndex:l}]of t)r(i,s,o,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#d)for(const r of this.#d.keys())r.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#A}get imageManager(){return Ye(this,"imageManager",new Hy)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let h=0,d=e.rangeCount;h<d;h++)if(!t.contains(e.getRangeAt(h).commonAncestorContainer))return null;const{x:r,y:i,width:s,height:o}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(h,d,p,g)=>({x:(d-i)/o,y:1-(h+p-r)/s,width:g/o,height:p/s});break;case"180":l=(h,d,p,g)=>({x:1-(h+p-r)/s,y:1-(d+g-i)/o,width:p/s,height:g/o});break;case"270":l=(h,d,p,g)=>({x:1-(d+g-i)/o,y:(h-r)/s,width:g/o,height:p/s});break;default:l=(h,d,p,g)=>({x:(h-r)/s,y:(d-i)/o,width:p/s,height:g/o});break}const u=[];for(let h=0,d=e.rangeCount;h<d;h++){const p=e.getRangeAt(h);if(!p.collapsed)for(const{x:g,y:v,width:y,height:_}of p.getClientRects())y===0||_===0||u.push(l(g,v,y,_))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#l||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const e=this.#l?.get(t.data.id);if(!e)return;const r=this.#i.getRawValue(e);r&&(this.#A===Fe.NONE&&!r.hasBeenModified||r.renderAnnotationElement(t))}setMissingCanvas(t,e,r){const i=this.#L?.get(t);i&&(i.setCanvas(e,r),this.#L.delete(t))}addMissingCanvas(t,e){(this.#L||=new Map).set(t,e)}}class ka{#t=null;#e=!1;#n=null;#r=null;#s=null;#i=null;#l=!1;#o=null;#f=null;#c=null;#h=null;#u=!1;static#d=null;static _l10n=null;constructor(t){this.#f=t,this.#u=t._uiManager.useNewAltTextFlow,ka.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){ka._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#r=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",ka.#d.missing),e.setAttribute("data-l10n-id",ka.#d["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=this.#f._uiManager._signal;t.addEventListener("contextmenu",Fs,{signal:r}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),this.#f._uiManager.editAltText(this.#f),this.#u&&this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return t.addEventListener("click",i,{capture:!0,signal:r}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(this.#l=!0,i(s))},{signal:r}),await this.#p(),t}get#a(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#h=await ka._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#f.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#h),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#h}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:r,textWithDisclaimer:i,cancel:s=!1}){r&&(this.#c=r,this.#h=i),!(this.#t===t&&this.#e===e)&&(s||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#n.disabled=!t)}shown(){this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#n?.remove(),this.#n=null,this.#r=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",ka.#d[this.#a]),this.#r?.setAttribute("data-l10n-id",ka.#d[`${this.#a}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#f.id}`;const i=100,s=this.#f._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#s.classList.add("show"),this.#f._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:s}),t.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#s?.classList.remove("show")},{signal:s})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#f.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Jd{#t;#e=!1;#n=null;#r;#s;#i;#l;#o=null;#f;#c=null;#h;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:o=null,signal:l}){this.#t=t,this.#n=r,this.#r=e,this.#s=i,this.#i=s,this.#l=o,this.#h=new AbortController,this.#f=AbortSignal.any([l,this.#h.signal]),t.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#f})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ia.pixelRatio}#d(t){if(this.#r?.())return;if(t.touches.length===1){if(this.#o)return;const i=this.#o=new AbortController,s=AbortSignal.any([this.#f,i.signal]),o=this.#t,l={capture:!0,signal:s,passive:!1},u=h=>{h.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",h=>{h.pointerType==="touch"&&(Zn(h),u(h))},l),o.addEventListener("pointerup",u,l),o.addEventListener("pointercancel",u,l);return}if(!this.#u){this.#u=new AbortController;const i=AbortSignal.any([this.#f,this.#u.signal]),s=this.#t,o={signal:i,capture:!1,passive:!1};s.addEventListener("touchmove",this.#a.bind(this),o);const l=this.#p.bind(this);s.addEventListener("touchend",l,o),s.addEventListener("touchcancel",l,o),o.capture=!0,s.addEventListener("pointerdown",Zn,o),s.addEventListener("pointermove",Zn,o),s.addEventListener("pointercancel",Zn,o),s.addEventListener("pointerup",Zn,o),this.#s?.()}if(Zn(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,r]=t.touches;e.identifier>r.identifier&&([e,r]=[r,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:r.screenX,touch1Y:r.screenY}}#a(t){if(!this.#c||t.touches.length!==2)return;Zn(t);let[e,r]=t.touches;e.identifier>r.identifier&&([e,r]=[r,e]);const{screenX:i,screenY:s}=e,{screenX:o,screenY:l}=r,u=this.#c,{touch0X:h,touch0Y:d,touch1X:p,touch1Y:g}=u,v=p-h,y=g-d,_=o-i,b=l-s,E=Math.hypot(_,b)||1,S=Math.hypot(v,y)||1;if(!this.#e&&Math.abs(S-E)<=Jd.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=i,u.touch0Y=s,u.touch1X=o,u.touch1Y=l,!this.#e){this.#e=!0;return}const T=[(i+o)/2,(s+l)/2];this.#i?.(T,S,E)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#l?.()),this.#c&&(Zn(t),this.#c=null,this.#e=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class Ae{#t=null;#e=null;#n=null;#r=!1;#s=null;#i="";#l=!1;#o=null;#f=null;#c=null;#h=null;#u="";#d=!1;#a=null;#p=!1;#m=!1;#g=!1;#v=null;#_=0;#y=0;#x=null;#w=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#C=Ae._zIndex++;static _borderLineWidth=-1;static _colorManager=new jy;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Ae.prototype._resizeWithKeyboard,e=Lo.TRANSLATE_SMALL,r=Lo.TRANSLATE_BIG;return Ye(this,"_resizerKeyboardManager",new Qd([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,r]}],[["Escape","mac+Escape"],Ae.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,o];const[l,u]=this.parentDimensions;this.x=t.x/l,this.y=t.y/u,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Ye(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new lI({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Ae._l10n??=t,Ae._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Ae._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);Ae._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){An("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#j(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#d?this.#d=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,r,i){const[s,o]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(t+r)/s,this.y=(e+i)/o,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[r,i]=this.parentDimensions;this.setAt(t*r,e*i,this.width*r,this.height*i),this._onTranslated()}#O([t,e],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#O(this.parentDimensions,t,e)}translateInPage(t,e){this.#a||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#a||=[this.x,this.y,this.width,this.height];const{div:r,parentDimensions:[i,s]}=this;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:g}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,g)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:l}=this;const[u,h]=this.getBaseTranslation();o+=u,l+=h;const{style:d}=r;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*l).toFixed(2)}%`,this._onTranslating(o,l),r.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:r}=Ae,i=r/t,s=r/e;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[r,i]}=this;let{x:s,y:o,width:l,height:u}=this;if(l*=r,u*=i,s*=r,o*=i,this._mustFixPosition)switch(t){case 0:s=Kr(s,0,r-l),o=Kr(o,0,i-u);break;case 90:s=Kr(s,0,r-u),o=Kr(o,l,i);break;case 180:s=Kr(s,l,r),o=Kr(o,u,i);break;case 270:s=Kr(s,u,r),o=Kr(o,0,i-l);break}this.x=s/=r,this.y=o/=i;const[h,d]=this.getBaseTranslation();s+=h,o+=d,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#E(t,e,r){switch(r){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Ae.#E(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Ae.#E(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,r]=this.pageDimensions;return[0,-e/r,r/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,r]=this.pageDimensions;return[0,e/r,-r/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,r]}=this;return[e*t,r*t]}setDims(t,e){const[r,i]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*t/r).toFixed(2)}%`,this.#l||(s.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:r}=t,i=r.endsWith("%"),s=!this.#l&&e.endsWith("%");if(i&&s)return;const[o,l]=this.parentDimensions;i||(t.width=`${(100*parseFloat(r)/o).toFixed(2)}%`),!this.#l&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#T(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const r of t){const i=document.createElement("div");this.#o.append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",this.#N.bind(this,r),{signal:e}),i.addEventListener("contextmenu",Fs,{signal:e}),i.tabIndex=-1}this.div.prepend(this.#o)}#N(t,e){e.preventDefault();const{isMac:r}=Tr.platform;if(e.button!==0||e.ctrlKey&&r)return;this.#n?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#f=[e.screenX,e.screenY];const s=new AbortController,o=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#z.bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Zn,{passive:!1,signal:o}),window.addEventListener("contextmenu",Fs,{signal:o}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const l=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const h=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=u,this.#L()};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}#k(t,e,r,i){this.width=r,this.height=i,this.x=t,this.y=e;const[s,o]=this.parentDimensions;this.setDims(s*r,o*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#L(){if(!this.#c)return;const{savedX:t,savedY:e,savedWidth:r,savedHeight:i}=this.#c;this.#c=null;const s=this.x,o=this.y,l=this.width,u=this.height;s===t&&o===e&&l===r&&u===i||this.addCommands({cmd:this.#k.bind(this,s,o,l,u),undo:this.#k.bind(this,t,e,r,i),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#z(t,e){const[r,i]=this.parentDimensions,s=this.x,o=this.y,l=this.width,u=this.height,h=Ae.MIN_SIZE/r,d=Ae.MIN_SIZE/i,p=this.#D(this.rotation),g=(Q,Y)=>[p[0]*Q+p[2]*Y,p[1]*Q+p[3]*Y],v=this.#D(360-this.rotation),y=(Q,Y)=>[v[0]*Q+v[2]*Y,v[1]*Q+v[3]*Y];let _,b,E=!1,S=!1;switch(t){case"topLeft":E=!0,_=(Q,Y)=>[0,0],b=(Q,Y)=>[Q,Y];break;case"topMiddle":_=(Q,Y)=>[Q/2,0],b=(Q,Y)=>[Q/2,Y];break;case"topRight":E=!0,_=(Q,Y)=>[Q,0],b=(Q,Y)=>[0,Y];break;case"middleRight":S=!0,_=(Q,Y)=>[Q,Y/2],b=(Q,Y)=>[0,Y/2];break;case"bottomRight":E=!0,_=(Q,Y)=>[Q,Y],b=(Q,Y)=>[0,0];break;case"bottomMiddle":_=(Q,Y)=>[Q/2,Y],b=(Q,Y)=>[Q/2,0];break;case"bottomLeft":E=!0,_=(Q,Y)=>[0,Y],b=(Q,Y)=>[Q,0];break;case"middleLeft":S=!0,_=(Q,Y)=>[0,Y/2],b=(Q,Y)=>[Q,Y/2];break}const T=_(l,u),O=b(l,u);let R=g(...O);const N=Ae._round(s+R[0]),C=Ae._round(o+R[1]);let I=1,M=1,F,H;if(e.fromKeyboard)({deltaX:F,deltaY:H}=e);else{const{screenX:Q,screenY:Y}=e,[Ot,Et]=this.#f;[F,H]=this.screenToPageTranslation(Q-Ot,Y-Et),this.#f[0]=Q,this.#f[1]=Y}if([F,H]=y(F/r,H/i),E){const Q=Math.hypot(l,u);I=M=Math.max(Math.min(Math.hypot(O[0]-T[0]-F,O[1]-T[1]-H)/Q,1/l,1/u),h/l,d/u)}else S?I=Kr(Math.abs(O[0]-T[0]-F),h,1)/l:M=Kr(Math.abs(O[1]-T[1]-H),d,1)/u;const P=Ae._round(l*I),et=Ae._round(u*M);R=g(...b(P,et));const L=N-R[0],st=C-R[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=P,this.height=et,this.x=L,this.y=st,this.setDims(r*P,i*et),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#m?this._editToolbar:(this._editToolbar=new fd(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(ka.initialize(Ae._l10n),this.#n=new ka(this),this.#t&&(this.#n.data=this.#t,this.#t=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#G();const[e,r]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*r/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/r).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),$T(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#w||=new Jd({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#A.bind(this),onPinching:this.#b.bind(this),onPinchEnd:this.#F.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#A(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#b(t,e,r){let s=.7*(r/e)+1-.7;if(s===1)return;const o=this.#D(this.rotation),l=(N,C)=>[o[0]*N+o[2]*C,o[1]*N+o[3]*C],[u,h]=this.parentDimensions,d=this.x,p=this.y,g=this.width,v=this.height,y=Ae.MIN_SIZE/u,_=Ae.MIN_SIZE/h;s=Math.max(Math.min(s,1/g,1/v),y/g,_/v);const b=Ae._round(g*s),E=Ae._round(v*s);if(b===g&&E===v)return;this.#a||=[d,p,g,v];const S=l(g/2,v/2),T=Ae._round(d+S[0]),O=Ae._round(p+S[1]),R=l(b/2,E/2);this.x=T-R[0],this.y=O-R[1],this.width=b,this.height=E,this.setDims(u*b,h*E),this.fixAndSetPosition(),this._onResizing()}#F(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#L()}pointerdown(t){const{isMac:e}=Tr.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#d=!0,this._isDraggable){this.#$(t);return}this.#B(t)}#B(t){const{isMac:e}=Tr.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:s},l=h=>{i.abort(),this.#s=null,this.#d=!1,this._uiManager.endDragSession()||this.#B(h),r&&this._onStopDragging()};e&&(this.#_=t.clientX,this.#y=t.clientY,this.#s=t.pointerId,this.#i=t.pointerType,window.addEventListener("pointermove",h=>{r||(r=!0,this._onStartDragging());const{clientX:d,clientY:p,pointerId:g}=h;if(g!==this.#s){Zn(h);return}const[v,y]=this.screenToPageTranslation(d-this.#_,p-this.#y);this.#_=d,this.#y=p,this._uiManager.dragSelectedEditors(v,y)},o),window.addEventListener("touchmove",Zn,o),window.addEventListener("pointerdown",h=>{h.pointerType===this.#i&&(this.#w||h.isPrimary)&&l(h),Zn(h)},o));const u=h=>{if(!this.#s||this.#s===h.pointerId){l(h);return}Zn(h)};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,r){t.changeParent(this),this.x=e,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,r=this.rotation){const i=this.parentScale,[s,o]=this.pageDimensions,[l,u]=this.pageTranslation,h=t/i,d=e/i,p=this.x*s,g=this.y*o,v=this.width*s,y=this.height*o;switch(r){case 0:return[p+h+l,o-g-d-y+u,p+h+v+l,o-g-d+u];case 90:return[p+d+l,o-g+h+u,p+d+y+l,o-g+h+v+u];case 180:return[p-h-v+l,o-g+d+u,p-h+l,o-g+d+y+u];case 270:return[p-d-y+l,o-g-h-v+u,p-d+l,o-g-h+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[r,i,s,o]=t,l=s-r,u=o-i;switch(this.rotation){case 0:return[r,e-o,l,u];case 90:return[r,e-i,u,l];case 180:return[s,e-i,l,u];case 270:return[s,e-o,u,l];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:o}=window;return e<o&&i>0&&t<s&&r>0}#G(){if(this.#h||!this.div)return;this.#h=new AbortController;const t=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#G()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){An("An editor must be serializable")}static async deserialize(t,e,r){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:r});i.rotation=t.rotation,i.#t=t.accessibilityData,i._isCopy=t.isCopy||!1;const[s,o]=i.pageDimensions,[l,u,h,d]=i.getRectInCurrentCoords(t.rect,o);return i.x=l/s,i.y=u/o,i.width=h/s,i.height=d/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#j(),this.removeEditToolbar(),this.#x){for(const t of this.#x.values())clearTimeout(t);this.#x=null}this.parent=null,this.#w?.destroy(),this.#w=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#T(),this.#o.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#o.children;if(!this.#e){this.#e=Array.from(e);const o=this.#V.bind(this),l=this.#H.bind(this),u=this._uiManager._signal;for(const h of this.#e){const d=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",o,{signal:u}),h.addEventListener("blur",l,{signal:u}),h.addEventListener("focus",this.#M.bind(this,d),{signal:u}),h.setAttribute("data-l10n-id",Ae._l10nResizer[d])}}const r=this.#e[0];let i=0;for(const o of e){if(o===r)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(s!==i){if(s<i)for(let l=0;l<i-s;l++)this.#o.append(this.#o.firstChild);else if(s>i)for(let l=0;l<s-i;l++)this.#o.firstChild.before(this.#o.lastChild);let o=0;for(const l of e){const h=this.#e[o++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",Ae._l10nResizer[h])}}this.#I(0),this.#g=!0,this.#o.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#V(t){Ae._resizerKeyboardManager.exec(this,t)}#H(t){this.#g&&t.relatedTarget?.parentNode!==this.#o&&this.#j()}#M(t){this.#u=this.#g?t:""}#I(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#g&&this.#z(this.#u,{deltaX:t,deltaY:e,fromKeyboard:!0})}#j(){this.#g=!1,this.#I(-1),this.#L()}_stopResizingWithKeyboard(){this.#j(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#l=!0;const r=t/e,{style:i}=this.div;i.aspectRatio=r,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#x||=new Map;const{action:r}=t;let i=this.#x.get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),this.#x.delete(r),this.#x.size===0&&(this.#x=null)},Ae._telemetryTimeout),this.#x.set(r,i);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const r=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),r.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class lI extends Ae{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const mA=3285377520,Ss=4294901760,Da=65535;class GT{constructor(t){this.h1=t?t&4294967295:mA,this.h2=t?t&4294967295:mA}update(t){let e,r;if(typeof t=="string"){e=new Uint8Array(t.length*2),r=0;for(let _=0,b=t.length;_<b;_++){const E=t.charCodeAt(_);E<=255?e[r++]=E:(e[r++]=E>>>8,e[r++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),r=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,s=r-i*4,o=new Uint32Array(e.buffer,0,i);let l=0,u=0,h=this.h1,d=this.h2;const p=3432918353,g=461845907,v=p&Da,y=g&Da;for(let _=0;_<i;_++)_&1?(l=o[_],l=l*p&Ss|l*v&Da,l=l<<15|l>>>17,l=l*g&Ss|l*y&Da,h^=l,h=h<<13|h>>>19,h=h*5+3864292196):(u=o[_],u=u*p&Ss|u*v&Da,u=u<<15|u>>>17,u=u*g&Ss|u*y&Da,d^=u,d=d<<13|d>>>19,d=d*5+3864292196);switch(l=0,s){case 3:l^=e[i*4+2]<<16;case 2:l^=e[i*4+1]<<8;case 1:l^=e[i*4],l=l*p&Ss|l*v&Da,l=l<<15|l>>>17,l=l*g&Ss|l*y&Da,i&1?h^=l:d^=l}this.h1=h,this.h2=d}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Ss|t*36045&Da,e=e*4283543511&Ss|((e<<16|t>>>16)*2950163797&Ss)>>>16,t^=e>>>1,t=t*444984403&Ss|t*60499&Da,e=e*3301882366&Ss|((e<<16|t>>>16)*3120437893&Ss)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const G_=Object.freeze({map:null,hash:"",transfer:void 0});class $y{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const r=this.#n.get(t);return r===void 0?e:Object.assign(e,r)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof Ae)return;this.onAnnotationEditor(null)}}setValue(t,e){const r=this.#n.get(t);let i=!1;if(r!==void 0)for(const[s,o]of Object.entries(e))r[s]!==o&&(i=!0,r[s]=o);else i=!0,this.#n.set(t,e);i&&this.#r(),e instanceof Ae&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}get size(){return this.#n.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new VT(this)}get serializable(){if(this.#n.size===0)return G_;const t=new Map,e=new GT,r=[],i=Object.create(null);let s=!1;for(const[o,l]of this.#n){const u=l instanceof Ae?l.serialize(!1,i):l;u&&(t.set(o,u),e.update(`${o}:${JSON.stringify(u)}`),s||=!!u.bitmap)}if(s)for(const o of t.values())o.bitmap&&r.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:r}:G_}get editorStats(){let t=null;const e=new Map;for(const r of this.#n.values()){if(!(r instanceof Ae))continue;const i=r.telemetryFinalData;if(!i)continue;const{type:s}=i;e.has(s)||e.set(s,Object.getPrototypeOf(r).constructor),t||=Object.create(null);const o=t[s]||=new Map;for(const[l,u]of Object.entries(i)){if(l==="type")continue;let h=o.get(l);h||(h=new Map,o.set(l,h));const d=h.get(u)??0;h.set(u,d+1)}}for(const[r,i]of e)t[r]=i.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof Ae)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class VT extends $y{#t;constructor(t){super();const{map:e,hash:r,transfer:i}=t.serializable,s=structuredClone(e,i?{transfer:i}:null);this.#t={map:s,hash:r,transfer:i}}get print(){An("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Ye(this,"modifiedIds",{ids:new Set,hash:""})}}class cI{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:r}){if(!(!t||this.#t.has(t.loadedName))){if(or(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:o}=t,l=new FontFace(i,s,o);this.addNativeFontFace(l);try{await l.load(),this.#t.add(i),r?.(t)}catch{Ue(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}An("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const r=t.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw Ue(`Failed to load font '${r.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Ye(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Ye(this,"isSyncFontLoadingSupported",_i||Tr.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(or(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:e,callback:t};return r.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ye(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function r(O,R){return O.charCodeAt(R)<<24|O.charCodeAt(R+1)<<16|O.charCodeAt(R+2)<<8|O.charCodeAt(R+3)&255}function i(O,R,N,C){const I=O.substring(0,R),M=O.substring(R+N);return I+C+M}let s,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const u=l.getContext("2d");let h=0;function d(O,R){if(++h>30){Ue("Load test font never loaded."),R();return}if(u.font="30px "+O,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(d.bind(null,O,R))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=i(g,976,p.length,p);const y=16,_=1482184792;let b=r(g,y);for(s=0,o=p.length-3;s<o;s+=4)b=b-_+r(p,s)|0;s<p.length&&(b=b-_+r(p+"XXX",s)|0),g=i(g,y,4,ZM(b));const E=`url(data:font/opentype;base64,${btoa(g)});`,S=`@font-face {font-family:"${p}";src:${E}}`;this.insertRule(S);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const O of[t.loadedName,p]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=O,T.append(R)}this._document.body.append(T),d(p,()=>{T.remove(),e.complete()})}}class uI{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const r in t)this[r]=t[r];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${UT(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const r=this.loadedName+"_path_"+e;let i;try{i=t.get(r)}catch(o){Ue(`getPathGenerator - ignoring character: "${o}".`)}const s=new Path2D(i||"");return this.fontExtraProperties||t.delete(r),this.compiledGlyphs[e]=s}}function fI(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(_i)return n;const t=URL.parse(n,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function hI(n){if(_i&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return qd(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Zp(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const V_=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,dI=n=>typeof n=="object"&&typeof n?.name=="string",WT=eI.bind(null,V_,dI);class pI{#t=new Map;#e=Promise.resolve();postMessage(t,e){const r={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[i]of this.#t)i.call(this,r)})}addEventListener(t,e,r=null){let i=null;if(r?.signal instanceof AbortSignal){const{signal:s}=r;if(s.aborted){Ue("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);i=()=>s.removeEventListener("abort",o),s.addEventListener("abort",o)}this.#t.set(e,i)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Qp={DATA:1,ERROR:2},ir={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function vA(){}function Ui(n){if(n instanceof ko||n instanceof Ug||n instanceof dA||n instanceof Ed||n instanceof Xv)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||An('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new ko(n.message);case"InvalidPDFException":return new Ug(n.message);case"PasswordException":return new dA(n.message,n.code);case"ResponseException":return new Ed(n.message,n.status,n.missing);case"UnknownErrorException":return new Xv(n.message,n.details)}return new Xv(n.message,n.toString())}class sd{#t=new AbortController;constructor(t,e,r){this.sourceName=t,this.targetName=e,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#r(t);return}if(t.callback){const r=t.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],t.callback===Qp.DATA)i.resolve(t.data);else if(t.callback===Qp.ERROR)i.reject(Ui(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const r=this.sourceName,i=t.sourceName,s=this.comObj;Promise.try(e,t.data).then(function(o){s.postMessage({sourceName:r,targetName:i,callback:Qp.DATA,callbackId:t.callbackId,data:o})},function(o){s.postMessage({sourceName:r,targetName:i,callback:Qp.ERROR,callbackId:t.callbackId,reason:Ui(o)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const r=this.actionHandler;if(r[t])throw new Error(`There is already an actionName called "${t}"`);r[t]=e}send(t,e,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},r)}sendWithPromise(t,e,r){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},r)}catch(o){s.reject(o)}return s.promise}sendWithStream(t,e,r,i){const s=this.streamId++,o=this.sourceName,l=this.targetName,u=this.comObj;return new ReadableStream({start:h=>{const d=Promise.withResolvers();return this.streamControllers[s]={controller:h,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:o,targetName:l,action:t,streamId:s,data:e,desiredSize:h.desiredSize},i),d.promise},pull:h=>{const d=Promise.withResolvers();return this.streamControllers[s].pullCall=d,u.postMessage({sourceName:o,targetName:l,stream:ir.PULL,streamId:s,desiredSize:h.desiredSize}),d.promise},cancel:h=>{or(h instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[s].cancelCall=d,this.streamControllers[s].isClosed=!0,u.postMessage({sourceName:o,targetName:l,stream:ir.CANCEL,streamId:s,reason:Ui(h)}),d.promise}},r)}#n(t){const e=t.streamId,r=this.sourceName,i=t.sourceName,s=this.comObj,o=this,l=this.actionHandler[t.action],u={enqueue(h,d=1,p){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=d,g>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:ir.ENQUEUE,streamId:e,chunk:h},p)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:ir.CLOSE,streamId:e}),delete o.streamSinks[e])},error(h){or(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:ir.ERROR,streamId:e,reason:Ui(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[e]=u,Promise.try(l,t.data,u).then(function(){s.postMessage({sourceName:r,targetName:i,stream:ir.START_COMPLETE,streamId:e,success:!0})},function(h){s.postMessage({sourceName:r,targetName:i,stream:ir.START_COMPLETE,streamId:e,reason:Ui(h)})})}#r(t){const e=t.streamId,r=this.sourceName,i=t.sourceName,s=this.comObj,o=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case ir.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(Ui(t.reason));break;case ir.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(Ui(t.reason));break;case ir.PULL:if(!l){s.postMessage({sourceName:r,targetName:i,stream:ir.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||vA).then(function(){s.postMessage({sourceName:r,targetName:i,stream:ir.PULL_COMPLETE,streamId:e,success:!0})},function(h){s.postMessage({sourceName:r,targetName:i,stream:ir.PULL_COMPLETE,streamId:e,reason:Ui(h)})});break;case ir.ENQUEUE:if(or(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case ir.CLOSE:if(or(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#s(o,e);break;case ir.ERROR:or(o,"error should have stream controller"),o.controller.error(Ui(t.reason)),this.#s(o,e);break;case ir.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(Ui(t.reason)),this.#s(o,e);break;case ir.CANCEL:if(!l)break;const u=Ui(t.reason);Promise.try(l.onCancel||vA,u).then(function(){s.postMessage({sourceName:r,targetName:i,stream:ir.CANCEL_COMPLETE,streamId:e,success:!0})},function(h){s.postMessage({sourceName:r,targetName:i,stream:ir.CANCEL_COMPLETE,streamId:e,reason:Ui(h)})}),l.sinkCapability.reject(u),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class XT{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(t,e);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,r){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||r<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=r}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){An("Abstract method `_createCanvas` called.")}}class gI extends XT{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const r=this._document.createElement("canvas");return r.width=t,r.height=e,r}}class YT{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){An("Abstract method `_fetch` called.")}}class _A extends YT{async _fetch(t){const e=await vf(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):qd(e)}}class qT{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,r,i,s){return"none"}destroy(t=!1){}}class mI extends qT{#t;#e;#n;#r;#s;#i;#l=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#r=t,this.#s=e}get#o(){return this.#e||=new Map}get#f(){return this.#i||=new Map}get#c(){if(!this.#n){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const r=this.#s.createElementNS(Eo,"svg");r.setAttribute("width",0),r.setAttribute("height",0),this.#n=this.#s.createElementNS(Eo,"defs"),t.append(r),r.append(this.#n),this.#s.body.append(t)}return this.#n}#h(t){if(t.length===1){const u=t[0],h=new Array(256);for(let p=0;p<256;p++)h[p]=u[p]/255;const d=h.join(",");return[d,d,d]}const[e,r,i]=t,s=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)s[u]=e[u]/255,o[u]=r[u]/255,l[u]=i[u]/255;return[s.join(","),o.join(","),l.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(Zd(e)?Ue('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Py(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[r,i,s]=this.#h(t),o=t.length===1?r:`${r}${i}${s}`;if(e=this.#o.get(o),e)return this.#o.set(t,e),e;const l=`g_${this.#r}_transfer_map_${this.#l++}`,u=this.#u(l);this.#o.set(t,u),this.#o.set(o,u);const h=this.#p(l);return this.#g(r,i,s,h),u}addHCMFilter(t,e){const r=`${t}-${e}`,i="base";let s=this.#f.get(i);if(s?.key===r||(s?(s.filter?.remove(),s.key=r,s.url="none",s.filter=null):(s={key:r,url:"none",filter:null},this.#f.set(i,s)),!t||!e))return s.url;const o=this.#_(t);t=be.makeHexColor(...o);const l=this.#_(e);if(e=be.makeHexColor(...l),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return s.url;const u=new Array(256);for(let v=0;v<=255;v++){const y=v/255;u[v]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const h=u.join(","),d=`g_${this.#r}_hcm_filter`,p=s.filter=this.#p(d);this.#g(h,h,h,p),this.#a(p);const g=(v,y)=>{const _=o[v]/255,b=l[v]/255,E=new Array(y+1);for(let S=0;S<=y;S++)E[S]=_+S/y*(b-_);return E.join(",")};return this.#g(g(0,5),g(1,5),g(2,5),p),s.url=this.#u(d),s.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[r]=this.#h([t]),i=`alpha_${r}`;if(e=this.#o.get(i),e)return this.#o.set(t,e),e;const s=`g_${this.#r}_alpha_map_${this.#l++}`,o=this.#u(s);this.#o.set(t,o),this.#o.set(i,o);const l=this.#p(s);return this.#v(r,l),o}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let r,i;if(t?([r]=this.#h([t]),i=`luminosity_${r}`):i="luminosity",e=this.#o.get(i),e)return this.#o.set(t,e),e;const s=`g_${this.#r}_luminosity_map_${this.#l++}`,o=this.#u(s);this.#o.set(t,o),this.#o.set(i,o);const l=this.#p(s);return this.#d(l),t&&this.#v(r,l),o}addHighlightHCMFilter(t,e,r,i,s){const o=`${e}-${r}-${i}-${s}`;let l=this.#f.get(t);if(l?.key===o||(l?(l.filter?.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},this.#f.set(t,l)),!e||!r))return l.url;const[u,h]=[e,r].map(this.#_.bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,v]=[i,s].map(this.#_.bind(this));p<d&&([d,p,g,v]=[p,d,v,g]),this.#c.style.color="";const y=(E,S,T)=>{const O=new Array(256),R=(p-d)/T,N=E/255,C=(S-E)/(255*T);let I=0;for(let M=0;M<=T;M++){const F=Math.round(d+M*R),H=N+M*C;for(let P=I;P<=F;P++)O[P]=H;I=F+1}for(let M=I;M<256;M++)O[M]=O[I-1];return O.join(",")},_=`g_${this.#r}_hcm_${t}_filter`,b=l.filter=this.#p(_);return this.#a(b),this.#g(y(g[0],v[0],5),y(g[1],v[1],5),y(g[2],v[2],5),b),l.url=this.#u(_),l.url}destroy(t=!1){t&&this.#i?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#i?.clear(),this.#i=null,this.#l=0)}#d(t){const e=this.#s.createElementNS(Eo,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#a(t){const e=this.#s.createElementNS(Eo,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#s.createElementNS(Eo,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#m(t,e,r){const i=this.#s.createElementNS(Eo,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),t.append(i)}#g(t,e,r,i){const s=this.#s.createElementNS(Eo,"feComponentTransfer");i.append(s),this.#m(s,"feFuncR",t),this.#m(s,"feFuncG",e),this.#m(s,"feFuncB",r)}#v(t,e){const r=this.#s.createElementNS(Eo,"feComponentTransfer");e.append(r),this.#m(r,"feFuncA",t)}#_(t){return this.#c.style.color=t,zy(getComputedStyle(this.#c).getPropertyValue("color"))}}class KT{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(r=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){An("Abstract method `_fetch` called.")}}class yA extends KT{async _fetch(t){const e=await vf(t,"arraybuffer");return new Uint8Array(e)}}class ZT{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(r=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){An("Abstract method `_fetch` called.")}}class bA extends ZT{async _fetch(t){const e=await vf(t,"arraybuffer");return new Uint8Array(e)}}_i&&Ue("Please use the `legacy` build in Node.js environments.");async function Gy(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class vI extends qT{}class _I extends XT{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class yI extends YT{async _fetch(t){return Gy(t)}}class bI extends KT{async _fetch(t){return Gy(t)}}class xI extends ZT{async _fetch(t){return Gy(t)}}const Pr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function W_(n,t){if(!t)return;const e=t[2]-t[0],r=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,r),n.clip(i)}class Vy{isModifyingCurrentTransform(){return!1}getPattern(){An("Abstract method `getPattern` called.")}}class EI extends Vy{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)e.addColorStop(r[0],r[1]);return e}getPattern(t,e,r,i){let s;if(i===Pr.STROKE||i===Pr.FILL){const o=e.current.getClippedPathBoundingBox(i,Hn(t))||[0,0,0,0],l=Math.ceil(o[2]-o[0])||1,u=Math.ceil(o[3]-o[1])||1,h=e.cachedCanvases.getCanvas("pattern",l,u),d=h.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),r=be.transform(r,[1,0,0,1,o[0],o[1]]),d.transform(...e.baseTransform),this.matrix&&d.transform(...this.matrix),W_(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),s=t.createPattern(h.canvas,"no-repeat");const p=new DOMMatrix(r);s.setTransform(p)}else W_(t,this._bbox),s=this._createGradient(t);return s}}function Kv(n,t,e,r,i,s,o,l){const u=t.coords,h=t.colors,d=n.data,p=n.width*4;let g;u[e+1]>u[r+1]&&(g=e,e=r,r=g,g=s,s=o,o=g),u[r+1]>u[i+1]&&(g=r,r=i,i=g,g=o,o=l,l=g),u[e+1]>u[r+1]&&(g=e,e=r,r=g,g=s,s=o,o=g);const v=(u[e]+t.offsetX)*t.scaleX,y=(u[e+1]+t.offsetY)*t.scaleY,_=(u[r]+t.offsetX)*t.scaleX,b=(u[r+1]+t.offsetY)*t.scaleY,E=(u[i]+t.offsetX)*t.scaleX,S=(u[i+1]+t.offsetY)*t.scaleY;if(y>=S)return;const T=h[s],O=h[s+1],R=h[s+2],N=h[o],C=h[o+1],I=h[o+2],M=h[l],F=h[l+1],H=h[l+2],P=Math.round(y),et=Math.round(S);let L,st,Q,Y,Ot,Et,z,J;for(let V=P;V<=et;V++){if(V<b){const Gt=V<y?0:(y-V)/(y-b);L=v-(v-_)*Gt,st=T-(T-N)*Gt,Q=O-(O-C)*Gt,Y=R-(R-I)*Gt}else{let Gt;V>S?Gt=1:b===S?Gt=0:Gt=(b-V)/(b-S),L=_-(_-E)*Gt,st=N-(N-M)*Gt,Q=C-(C-F)*Gt,Y=I-(I-H)*Gt}let ct;V<y?ct=0:V>S?ct=1:ct=(y-V)/(y-S),Ot=v-(v-E)*ct,Et=T-(T-M)*ct,z=O-(O-F)*ct,J=R-(R-H)*ct;const gt=Math.round(Math.min(L,Ot)),_t=Math.round(Math.max(L,Ot));let Bt=p*V+gt*4;for(let Gt=gt;Gt<=_t;Gt++)ct=(L-Gt)/(L-Ot),ct<0?ct=0:ct>1&&(ct=1),d[Bt++]=st-(st-Et)*ct|0,d[Bt++]=Q-(Q-z)*ct|0,d[Bt++]=Y-(Y-J)*ct|0,d[Bt++]=255}}function wI(n,t,e){const r=t.coords,i=t.colors;let s,o;switch(t.type){case"lattice":const l=t.verticesPerRow,u=Math.floor(r.length/l)-1,h=l-1;for(s=0;s<u;s++){let d=s*l;for(let p=0;p<h;p++,d++)Kv(n,e,r[d],r[d+1],r[d+l],i[d],i[d+1],i[d+l]),Kv(n,e,r[d+l+1],r[d+1],r[d+l],i[d+l+1],i[d+1],i[d+l])}break;case"triangles":for(s=0,o=r.length;s<o;s+=3)Kv(n,e,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class AI extends Vy{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,r){const l=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-l,d=Math.ceil(this._bounds[3])-u,p=Math.min(Math.ceil(Math.abs(h*t[0]*1.1)),3e3),g=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),v=h/p,y=d/g,_={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-u,scaleX:1/v,scaleY:1/y},b=p+2*2,E=g+2*2,S=r.getCanvas("mesh",b,E),T=S.context,O=T.createImageData(p,g);if(e){const N=O.data;for(let C=0,I=N.length;C<I;C+=4)N[C]=e[0],N[C+1]=e[1],N[C+2]=e[2],N[C+3]=255}for(const N of this._figures)wI(O,N,_);return T.putImageData(O,2,2),{canvas:S.canvas,offsetX:l-2*v,offsetY:u-2*y,scaleX:v,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(t,e,r,i){W_(t,this._bbox);const s=new Float32Array(2);if(i===Pr.SHADING)be.singularValueDecompose2dScale(Hn(t),s);else if(this.matrix){be.singularValueDecompose2dScale(this.matrix,s);const[l,u]=s;be.singularValueDecompose2dScale(e.baseTransform,s),s[0]*=l,s[1]*=u}else be.singularValueDecompose2dScale(e.baseTransform,s);const o=this._createMeshCanvas(s,i===Pr.SHADING?null:this._background,e.cachedCanvases);return i!==Pr.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class SI extends Vy{getPattern(){return"hotpink"}}function TI(n){switch(n[0]){case"RadialAxial":return new EI(n);case"Mesh":return new AI(n);case"Dummy":return new SI}throw new Error(`Unknown IR type: ${n[0]}`)}const xA={COLORED:1,UNCOLORED:2};class Wy{static MAX_PATTERN_SIZE=3e3;constructor(t,e,r,i){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(t){const{bbox:e,operatorList:r,paintType:i,tilingType:s,color:o,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:h}=this;u=Math.abs(u),h=Math.abs(h),Dm("TilingType: "+s);const d=e[0],p=e[1],g=e[2],v=e[3],y=g-d,_=v-p,b=new Float32Array(2);be.singularValueDecompose2dScale(this.matrix,b);const[E,S]=b;be.singularValueDecompose2dScale(this.baseTransform,b);const T=E*b[0],O=S*b[1];let R=y,N=_,C=!1,I=!1;const M=Math.ceil(u*T),F=Math.ceil(h*O),H=Math.ceil(y*T),P=Math.ceil(_*O);M>=H?R=u:C=!0,F>=P?N=h:I=!0;const et=this.getSizeAndScale(R,this.ctx.canvas.width,T),L=this.getSizeAndScale(N,this.ctx.canvas.height,O),st=t.cachedCanvases.getCanvas("pattern",et.size,L.size),Q=st.context,Y=l.createCanvasGraphics(Q);if(Y.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Y,i,o),Q.translate(-et.scale*d,-L.scale*p),Y.transform(et.scale,0,0,L.scale,0,0),Q.save(),this.clipBbox(Y,d,p,g,v),Y.baseTransform=Hn(Y.ctx),Y.executeOperatorList(r),Y.endDrawing(),Q.restore(),C||I){const Ot=st.canvas;C&&(R=u),I&&(N=h);const Et=this.getSizeAndScale(R,this.ctx.canvas.width,T),z=this.getSizeAndScale(N,this.ctx.canvas.height,O),J=Et.size,V=z.size,ct=t.cachedCanvases.getCanvas("pattern-workaround",J,V),gt=ct.context,_t=C?Math.floor(y/u):0,Bt=I?Math.floor(_/h):0;for(let Gt=0;Gt<=_t;Gt++)for(let j=0;j<=Bt;j++)gt.drawImage(Ot,J*Gt,V*j,J,V,0,0,J,V);return{canvas:ct.canvas,scaleX:Et.scale,scaleY:z.scale,offsetX:d,offsetY:p}}return{canvas:st.canvas,scaleX:et.scale,scaleY:L.scale,offsetX:d,offsetY:p}}getSizeAndScale(t,e,r){const i=Math.max(Wy.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*r);return s>=i?s=i:r=s/t,{scale:r,size:s}}clipBbox(t,e,r,i,s){const o=i-e,l=s-r;t.ctx.rect(e,r,o,l),be.axialAlignedBoundingBox([e,r,i,s],Hn(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,r){const i=t.ctx,s=t.current;switch(e){case xA.COLORED:const{fillStyle:o,strokeStyle:l}=this.ctx;i.fillStyle=s.fillColor=o,i.strokeStyle=s.strokeColor=l;break;case xA.UNCOLORED:i.fillStyle=i.strokeStyle=r,s.fillColor=s.strokeColor=r;break;default:throw new KM(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,r,i){let s=r;i!==Pr.SHADING&&(s=be.transform(s,e.baseTransform),this.matrix&&(s=be.transform(s,this.matrix)));const o=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const u=t.createPattern(o.canvas,"repeat");return u.setTransform(l),u}}function CI({src:n,srcPos:t=0,dest:e,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:o=!1}){const l=Tr.isLittleEndian?4278190080:255,[u,h]=o?[s,l]:[l,s],d=r>>3,p=r&7,g=n.length;e=new Uint32Array(e.buffer);let v=0;for(let y=0;y<i;y++){for(const b=t+d;t<b;t++){const E=t<g?n[t]:255;e[v++]=E&128?h:u,e[v++]=E&64?h:u,e[v++]=E&32?h:u,e[v++]=E&16?h:u,e[v++]=E&8?h:u,e[v++]=E&4?h:u,e[v++]=E&2?h:u,e[v++]=E&1?h:u}if(p===0)continue;const _=t<g?n[t++]:255;for(let b=0;b<p;b++)e[v++]=_&1<<7-b?h:u}return{srcPos:t,destPos:v}}const EA=16,wA=100,DI=15,AA=10,Hi=16,Zv=new DOMMatrix,rs=new Float32Array(2),Hu=new Float32Array([1/0,1/0,-1/0,-1/0]);function OI(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(e,r){t.translate(e,r),this.__originalTranslate(e,r)},n.scale=function(e,r){t.scale(e,r),this.__originalScale(e,r)},n.transform=function(e,r,i,s,o,l){t.transform(e,r,i,s,o,l),this.__originalTransform(e,r,i,s,o,l)},n.setTransform=function(e,r,i,s,o,l){t.setTransform(e,r,i,s,o,l),this.__originalSetTransform(e,r,i,s,o,l)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(e){t.rotate(e),this.__originalRotate(e)},n.clip=function(e){t.clip(e),this.__originalClip(e)},n.moveTo=function(e,r){t.moveTo(e,r),this.__originalMoveTo(e,r)},n.lineTo=function(e,r){t.lineTo(e,r),this.__originalLineTo(e,r)},n.bezierCurveTo=function(e,r,i,s,o,l){t.bezierCurveTo(e,r,i,s,o,l),this.__originalBezierCurveTo(e,r,i,s,o,l)},n.rect=function(e,r,i,s){t.rect(e,r,i,s),this.__originalRect(e,r,i,s)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class RI{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,r){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,r)):(i=this.canvasFactory.create(e,r),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Jp(n,t,e,r,i,s,o,l,u,h){const[d,p,g,v,y,_]=Hn(n);if(p===0&&g===0){const S=o*d+y,T=Math.round(S),O=l*v+_,R=Math.round(O),N=(o+u)*d+y,C=Math.abs(Math.round(N)-T)||1,I=(l+h)*v+_,M=Math.abs(Math.round(I)-R)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(v),T,R),n.drawImage(t,e,r,i,s,0,0,C,M),n.setTransform(d,p,g,v,y,_),[C,M]}if(d===0&&v===0){const S=l*g+y,T=Math.round(S),O=o*p+_,R=Math.round(O),N=(l+h)*g+y,C=Math.abs(Math.round(N)-T)||1,I=(o+u)*p+_,M=Math.abs(Math.round(I)-R)||1;return n.setTransform(0,Math.sign(p),Math.sign(g),0,T,R),n.drawImage(t,e,r,i,s,0,0,M,C),n.setTransform(d,p,g,v,y,_),[M,C]}n.drawImage(t,e,r,i,s,o,l,u,h);const b=Math.hypot(d,p),E=Math.hypot(g,v);return[b*u,E*h]}class SA{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=$_;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=qr.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e){this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Hu.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Pr.FILL,e=null){const r=this.minMax.slice();if(t===Pr.STROKE){e||An("Stroke bounding box must include transform."),be.singularValueDecompose2dScale(e,rs);const i=rs[0]*this.lineWidth/2,s=rs[1]*this.lineWidth/2;r[0]-=i,r[1]-=s,r[2]+=i,r[3]+=s}return r}updateClipFromPath(){const t=be.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Hu,0)}getClippedPathBoundingBox(t=Pr.FILL,e=null){return be.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function TA(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,r=t.width,i=e%Hi,s=(e-i)/Hi,o=i===0?s:s+1,l=n.createImageData(r,Hi);let u=0,h;const d=t.data,p=l.data;let g,v,y,_;if(t.kind===ud.GRAYSCALE_1BPP){const b=d.byteLength,E=new Uint32Array(p.buffer,0,p.byteLength>>2),S=E.length,T=r+7>>3,O=4294967295,R=Tr.isLittleEndian?4278190080:255;for(g=0;g<o;g++){for(y=g<s?Hi:i,h=0,v=0;v<y;v++){const N=b-u;let C=0;const I=N>T?r:N*8-7,M=I&-8;let F=0,H=0;for(;C<M;C+=8)H=d[u++],E[h++]=H&128?O:R,E[h++]=H&64?O:R,E[h++]=H&32?O:R,E[h++]=H&16?O:R,E[h++]=H&8?O:R,E[h++]=H&4?O:R,E[h++]=H&2?O:R,E[h++]=H&1?O:R;for(;C<I;C++)F===0&&(H=d[u++],F=128),E[h++]=H&F?O:R,F>>=1}for(;h<S;)E[h++]=0;n.putImageData(l,0,g*Hi)}}else if(t.kind===ud.RGBA_32BPP){for(v=0,_=r*Hi*4,g=0;g<s;g++)p.set(d.subarray(u,u+_)),u+=_,n.putImageData(l,0,v),v+=Hi;g<o&&(_=r*i*4,p.set(d.subarray(u,u+_)),n.putImageData(l,0,v))}else if(t.kind===ud.RGB_24BPP)for(y=Hi,_=r*y,g=0;g<o;g++){for(g>=s&&(y=i,_=r*y),h=0,v=_;v--;)p[h++]=d[u++],p[h++]=d[u++],p[h++]=d[u++],p[h++]=255;n.putImageData(l,0,g*Hi)}else throw new Error(`bad image kind: ${t.kind}`)}function CA(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,r=t.width,i=e%Hi,s=(e-i)/Hi,o=i===0?s:s+1,l=n.createImageData(r,Hi);let u=0;const h=t.data,d=l.data;for(let p=0;p<o;p++){const g=p<s?Hi:i;({srcPos:u}=CI({src:h,srcPos:u,dest:d,width:r,height:g,nonBlackColor:0})),n.putImageData(l,0,p*Hi)}}function Yh(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of e)n[r]!==void 0&&(t[r]=n[r]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function tg(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}function DA(n,t){if(t)return!0;be.singularValueDecompose2dScale(n,rs);const e=Math.fround(ia.pixelRatio*Sc.PDF_TO_CSS_UNITS);return rs[0]<=e&&rs[1]<=e}const NI=["butt","round","square"],kI=["miter","round","bevel"],LI={},OA={};class $u{constructor(t,e,r,i,s,{optionalContentConfig:o,markedContentStack:l=null},u,h){this.ctx=t,this.current=new SA(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=o,this.cachedCanvases=new RI(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:r=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=l,r){const u=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...Hn(this.compositeCtx))}this.ctx.save(),tg(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Hn(this.ctx)}executeOperatorList(t,e,r,i){const s=t.argsArray,o=t.fnArray;let l=e||0;const u=s.length;if(u===l)return l;const h=u-l>AA&&typeof r=="function",d=h?Date.now()+DI:0;let p=0;const g=this.commonObjs,v=this.objs;let y;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,r),l;if(y=o[l],y!==xd.dependency)this[y].apply(this,s[l]);else for(const _ of s[l]){const b=_.startsWith("g_")?g:v;if(!b.has(_))return b.get(_,r),l}if(l++,l===u)return l;if(h&&++p>AA){if(Date.now()>d)return r(),l;p=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const r=t.width??t.displayWidth,i=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=r,u=i,h="prescale1",d,p;for(;s>2&&l>1||o>2&&u>1;){let g=l,v=u;s>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/g),o>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,o/=u/v),d=this.cachedCanvases.getCanvas(h,g,v),p=d.context,p.clearRect(0,0,g,v),p.drawImage(t,0,0,l,u,0,0,g,v),t=d.canvas,l=g,u=v,h=h==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:u}}_createMaskCanvas(t){const e=this.ctx,{width:r,height:i}=t,s=this.current.fillColor,o=this.current.patternFill,l=Hn(e);let u,h,d,p;if((t.bitmap||t.data)&&t.count>1){const M=t.bitmap||t.data.buffer;h=JSON.stringify(o?l:[l.slice(0,4),s]),u=this._cachedBitmapsMap.get(M),u||(u=new Map,this._cachedBitmapsMap.set(M,u));const F=u.get(h);if(F&&!o){const H=Math.round(Math.min(l[0],l[2])+l[4]),P=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:F,offsetX:H,offsetY:P}}d=F}d||(p=this.cachedCanvases.getCanvas("maskCanvas",r,i),CA(p.context,t));let g=be.transform(l,[1/r,0,0,-1/i,0,0]);g=be.transform(g,[1,0,0,1,0,-i]);const v=Hu.slice();be.axialAlignedBoundingBox([0,0,r,i],g,v);const[y,_,b,E]=v,S=Math.round(b-y)||1,T=Math.round(E-_)||1,O=this.cachedCanvases.getCanvas("fillCanvas",S,T),R=O.context,N=y,C=_;R.translate(-N,-C),R.transform(...g),d||(d=this._scaleImage(p.canvas,Ca(R)),d=d.img,u&&o&&u.set(h,d)),R.imageSmoothingEnabled=DA(Hn(R),t.interpolate),Jp(R,d,0,0,d.width,d.height,0,0,r,i),R.globalCompositeOperation="source-in";const I=be.transform(Ca(R),[1,0,0,1,-N,-C]);return R.fillStyle=o?s.getPattern(e,this,I,Pr.FILL):s,R.fillRect(0,0,r,i),u&&!o&&(this.cachedCanvases.delete("fillCanvas"),u.set(h,O.canvas)),{canvas:O.canvas,offsetX:Math.round(N),offsetY:Math.round(C)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=NI[t]}setLineJoin(t){this.ctx.lineJoin=kI[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,r]of t)switch(e){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,e);this.suspendedCtx=this.ctx;const s=this.ctx=i.context;s.setTransform(this.suspendedCtx.getTransform()),Yh(this.suspendedCtx,s),OI(s,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Yh(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,r,i){const s=i[0],o=i[1],l=i[2]-s,u=i[3]-o;l===0||u===0||(this.genericComposeSMask(e.context,r,l,u,e.subtype,e.backdrop,e.transferMap,s,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(r.canvas,0,0),t.restore())}genericComposeSMask(t,e,r,i,s,o,l,u,h,d,p){let g=t.canvas,v=u-d,y=h-p;if(o)if(v<0||y<0||v+r>g.width||y+i>g.height){const b=this.cachedCanvases.getCanvas("maskExtension",r,i),E=b.context;E.drawImage(g,-v,-y),E.globalCompositeOperation="destination-atop",E.fillStyle=o,E.fillRect(0,0,r,i),E.globalCompositeOperation="source-over",g=b.canvas,v=y=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(v,y,r,i),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=o,t.fillRect(v,y,r,i),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const _=new Path2D;_.rect(u,h,r,i),e.clip(_),e.globalCompositeOperation="destination-in",e.drawImage(g,v,y,r,i,u,h,r,i),e.restore()}save(){this.inSMaskMode&&Yh(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Yh(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,r,i,s,o){this.ctx.transform(t,e,r,i,s,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,r){let[i]=e;if(!r){i||=e[0]=new Path2D,this[t](i);return}if(!(i instanceof Path2D)){const s=e[0]=new Path2D;for(let o=0,l=i.length;o<l;)switch(i[o++]){case Kp.moveTo:s.moveTo(i[o++],i[o++]);break;case Kp.lineTo:s.lineTo(i[o++],i[o++]);break;case Kp.curveTo:s.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case Kp.closePath:s.closePath();break;default:Ue(`Unrecognized drawing path operator: ${i[o-1]}`);break}i=s}be.axialAlignedBoundingBox(r,Hn(this.ctx),this.current.minMax),this[t](i)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&i?.getPattern){const s=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=i.getPattern(r,this,Ca(r),Pr.STROKE),s){const o=new Path2D;o.addPath(t,r.getTransform().invertSelf().multiplySelf(s)),t=o}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(Pr.STROKE,Hn(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const r=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let o=!1;if(s){const u=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.fillStyle=i.getPattern(r,this,Ca(r),Pr.FILL),u){const h=new Path2D;h.addPath(t,r.getTransform().invertSelf().multiplySelf(u)),t=h}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),o&&r.restore(),e&&this.consumePath(t,l)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=LI}eoClip(){this.pendingClip=OA}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0)return;const r=new Path2D,i=e.getTransform().invertSelf();for(const{transform:s,x:o,y:l,fontSize:u,path:h}of t)r.addPath(h,new DOMMatrix(s).preMultiplySelf(i).translate(o,l).scale(u,-u));e.clip(r),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const r=this.commonObjs.get(t),i=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=r.fontMatrix||$_,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Ue("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=e,r.isType3Font)return;const s=r.loadedName||"sans-serif",o=r.systemFontInfo?.css||`"${s}", ${r.fallbackName}`;let l="normal";r.black?l="900":r.bold&&(l="bold");const u=r.italic?"italic":"normal";let h=e;e<EA?h=EA:e>wA&&(h=wA),this.current.fontSizeScale=e/h,this.ctx.font=`${u} ${l} ${h}px ${o}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(t,e,r){const i=new Path2D;return i.addPath(t,new DOMMatrix(r).invertSelf().multiplySelf(e)),i}paintChar(t,e,r,i,s){const o=this.ctx,l=this.current,u=l.font,h=l.textRenderingMode,d=l.fontSize/l.fontSizeScale,p=h&qr.FILL_STROKE_MASK,g=!!(h&qr.ADD_TO_PATH_FLAG),v=l.patternFill&&!u.missingFile,y=l.patternStroke&&!u.missingFile;let _;if((u.disableFontFace||g||v||y)&&(_=u.getPathGenerator(this.commonObjs,t)),u.disableFontFace||v||y){o.save(),o.translate(e,r),o.scale(d,-d);let b;if((p===qr.FILL||p===qr.FILL_STROKE)&&(i?(b=o.getTransform(),o.setTransform(...i),o.fill(this.#n(_,b,i))):o.fill(_)),p===qr.STROKE||p===qr.FILL_STROKE)if(s){b||=o.getTransform(),o.setTransform(...s);const{a:E,b:S,c:T,d:O}=b,R=be.inverseTransform(s),N=be.transform([E,S,T,O,0,0],R);be.singularValueDecompose2dScale(N,rs),o.lineWidth*=Math.max(rs[0],rs[1])/d,o.stroke(this.#n(_,b,s))}else o.lineWidth/=d,o.stroke(_);o.restore()}else(p===qr.FILL||p===qr.FILL_STROKE)&&o.fillText(t,e,r),(p===qr.STROKE||p===qr.FILL_STROKE)&&o.strokeText(t,e,r);g&&(this.pendingTextPaths||=[]).push({transform:Hn(o),x:e,y:r,fontSize:d,path:_})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){r=!0;break}return Ye(this,"isFontSubpixelAAEnabled",r)}showText(t){const e=this.current,r=e.font;if(r.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(i===0)return;const s=this.ctx,o=e.fontSizeScale,l=e.charSpacing,u=e.wordSpacing,h=e.fontDirection,d=e.textHScale*h,p=t.length,g=r.vertical,v=g?1:-1,y=r.defaultVMetrics,_=i*e.fontMatrix[0],b=e.textRenderingMode===qr.FILL&&!r.disableFontFace&&!e.patternFill;s.save(),e.textMatrix&&s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),h>0?s.scale(d,-1):s.scale(d,1);let E,S;if(e.patternFill){s.save();const C=e.fillColor.getPattern(s,this,Ca(s),Pr.FILL);E=Hn(s),s.restore(),s.fillStyle=C}if(e.patternStroke){s.save();const C=e.strokeColor.getPattern(s,this,Ca(s),Pr.STROKE);S=Hn(s),s.restore(),s.strokeStyle=C}let T=e.lineWidth;const O=e.textMatrixScale;if(O===0||T===0){const C=e.textRenderingMode&qr.FILL_STROKE_MASK;(C===qr.STROKE||C===qr.FILL_STROKE)&&(T=this.getSinglePixelWidth())}else T/=O;if(o!==1&&(s.scale(o,o),T/=o),s.lineWidth=T,r.isInvalidPDFjsFont){const C=[];let I=0;for(const M of t)C.push(M.unicode),I+=M.width;s.fillText(C.join(""),0,0),e.x+=I*_*d,s.restore(),this.compose();return}let R=0,N;for(N=0;N<p;++N){const C=t[N];if(typeof C=="number"){R+=v*C*i/1e3;continue}let I=!1;const M=(C.isSpace?u:0)+l,F=C.fontChar,H=C.accent;let P,et,L=C.width;if(g){const Q=C.vmetric||y,Y=-(C.vmetric?Q[1]:L*.5)*_,Ot=Q[2]*_;L=Q?-Q[0]:L,P=Y/o,et=(R+Ot)/o}else P=R/o,et=0;if(r.remeasure&&L>0){const Q=s.measureText(F).width*1e3/i*o;if(L<Q&&this.isFontSubpixelAAEnabled){const Y=L/Q;I=!0,s.save(),s.scale(Y,1),P/=Y}else L!==Q&&(P+=(L-Q)/2e3*i/o)}if(this.contentVisible&&(C.isInFont||r.missingFile)){if(b&&!H)s.fillText(F,P,et);else if(this.paintChar(F,P,et,E,S),H){const Q=P+i*H.offset.x/o,Y=et-i*H.offset.y/o;this.paintChar(H.fontChar,Q,Y,E,S)}}const st=g?L*_-M*h:L*_+M*h;R+=st,I&&s.restore()}g?e.y-=R:e.x+=R*d,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,r=this.current,i=r.font,s=r.fontSize,o=r.fontDirection,l=i.vertical?1:-1,u=r.charSpacing,h=r.wordSpacing,d=r.textHScale*o,p=r.fontMatrix||$_,g=t.length,v=r.textRenderingMode===qr.INVISIBLE;let y,_,b,E;if(!(v||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),r.textMatrix&&e.transform(...r.textMatrix),e.translate(r.x,r.y+r.textRise),e.scale(d,o),y=0;y<g;++y){if(_=t[y],typeof _=="number"){E=l*_*s/1e3,this.ctx.translate(E,0),r.x+=E*d;continue}const S=(_.isSpace?h:0)+u,T=i.charProcOperatorList[_.operatorListId];T?this.contentVisible&&(this.save(),e.scale(s,s),e.transform(...p),this.executeOperatorList(T),this.restore()):Ue(`Type3 character "${_.operatorListId}" is not available.`);const O=[_.width,0];be.applyTransform(O,p),b=O[0]*s+S,e.translate(b,0),r.x+=b*d}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,r,i,s,o){const l=new Path2D;l.rect(r,i,s-r,o-i),this.ctx.clip(l),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const r=this.baseTransform||Hn(this.ctx),i={createCanvasGraphics:s=>new $u(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Wy(t,this.ctx,i,r)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=TI(this.getObject(t)),this.cachedPatterns.set(t,r)),e&&(r.matrix=e),r}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const r=this._getPattern(t);e.fillStyle=r.getPattern(e,this,Ca(e),Pr.SHADING);const i=Ca(e);if(i){const{width:s,height:o}=e.canvas,l=Hu.slice();be.axialAlignedBoundingBox([0,0,s,o],i,l);const[u,h,d,p]=l;this.ctx.fillRect(u,h,d-u,p-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){An("Should not call beginInlineImage")}beginImageData(){An("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Hn(this.ctx),e)){be.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[r,i,s,o]=e,l=new Path2D;l.rect(r,i,s-r,o-i),this.ctx.clip(l),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Dm("TODO: Support non-isolated groups."),t.knockout&&Ue("Knockout groups not supported.");const r=Hn(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=Hu.slice();be.axialAlignedBoundingBox(t.bbox,Hn(e),i);const s=[0,0,e.canvas.width,e.canvas.height];i=be.intersect(i,s)||[0,0,0,0];const o=Math.floor(i[0]),l=Math.floor(i[1]),u=Math.max(Math.ceil(i[2])-o,1),h=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,h]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(d,u,h),g=p.context;g.translate(-o,-l),g.transform(...r);let v=new Path2D;const[y,_,b,E]=t.bbox;if(v.rect(y,_,b-y,E-_),t.matrix){const S=new Path2D;S.addPath(v,new DOMMatrix(t.matrix)),v=S}g.clip(v),t.smask?this.smaskStack.push({canvas:p.canvas,context:g,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(o,l),e.save()),Yh(e,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Hn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const s=Hu.slice();be.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],i,s),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,r,i,s){if(this.#t(),tg(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const o=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){r=r.slice(),r[4]-=e[0],r[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=o,e[3]=l,be.singularValueDecompose2dScale(Hn(this.ctx),rs);const{viewportScale:u}=this,h=Math.ceil(o*this.outputScaleX*u),d=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,d);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(rs[0],0,0,-rs[1],0,l*rs[1]),tg(this.ctx)}else{tg(this.ctx),this.endPath();const u=new Path2D;u.rect(e[0],e[1],o,l),this.ctx.clip(u)}}this.current=new SA(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const r=this.ctx,i=this._createMaskCanvas(t),s=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(s,i.offsetX,i.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,r=0,i=0,s,o){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const u=Hn(l);l.transform(e,r,i,s,0,0);const h=this._createMaskCanvas(t);l.setTransform(1,0,0,1,h.offsetX-u[4],h.offsetY-u[5]);for(let d=0,p=o.length;d<p;d+=2){const g=be.transform(u,[e,r,i,s,o[d],o[d+1]]);l.drawImage(h.canvas,g[4],g[5])}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,r=this.current.fillColor,i=this.current.patternFill;for(const s of t){const{data:o,width:l,height:u,transform:h}=s,d=this.cachedCanvases.getCanvas("maskCanvas",l,u),p=d.context;p.save();const g=this.getObject(o,s);CA(p,g),p.globalCompositeOperation="source-in",p.fillStyle=i?r.getPattern(p,this,Ca(e),Pr.FILL):r,p.fillRect(0,0,l,u),p.restore(),e.save(),e.transform(...h),e.scale(1,-1),Jp(e,d.canvas,0,0,l,u,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){Ue("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,r,i){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){Ue("Dependent image isn't ready yet");return}const o=s.width,l=s.height,u=[];for(let h=0,d=i.length;h<d;h+=2)u.push({transform:[e,0,0,r,i[h],i[h+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(s,u)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:r,height:i}=t,s=this.cachedCanvases.getCanvas("inlineImage",r,i),o=s.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,r=t.height,i=this.ctx;this.save();const{filter:s}=i;s!=="none"&&s!==""&&(i.filter="none"),i.scale(1/e,-1/r);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,r).context;TA(h,t),o=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(o,Ca(i));i.imageSmoothingEnabled=DA(Hn(i),t.interpolate),Jp(i,l.img,0,0,l.paintWidth,l.paintHeight,0,-r,e,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const r=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const s=t.width,o=t.height,u=this.cachedCanvases.getCanvas("inlineImage",s,o).context;TA(u,t),i=this.applyTransferMapsToCanvas(u)}for(const s of e)r.save(),r.transform(...s.transform),r.scale(1,-1),Jp(r,i,s.x,s.y,s.w,s.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(r||(this.pendingClip===OA?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Hn(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),r=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:r,c:i,d:s}=this.ctx.getTransform();let o,l;if(r===0&&i===0){const u=Math.abs(e),h=Math.abs(s);if(u===h)if(t===0)o=l=1/u;else{const d=u*t;o=l=d<1?1/d:1}else if(t===0)o=1/u,l=1/h;else{const d=u*t,p=h*t;o=d<1?1/d:1,l=p<1?1/p:1}}else{const u=Math.abs(e*s-r*i),h=Math.hypot(e,r),d=Math.hypot(i,s);if(t===0)o=d/u,l=h/u;else{const p=t*u;o=d>p?d/p:1,l=h>p?h/p:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:r,current:{lineWidth:i}}=this,[s,o]=this.getScaleForStroking();if(s===o){r.lineWidth=(i||1)*s,r.stroke(t);return}const l=r.getLineDash();e&&r.save(),r.scale(s,o),Zv.a=1/s,Zv.d=1/o;const u=new Path2D;if(u.addPath(t,Zv),l.length>0){const h=Math.max(s,o);r.setLineDash(l.map(d=>d/h)),r.lineDashOffset/=h}r.lineWidth=i||1,r.stroke(u),e&&r.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const n in xd)$u.prototype[n]!==void 0&&($u.prototype[xd[n]]=$u.prototype[n]);class bl{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class MI{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Bu=Symbol("INTERNAL");class II{#t=!1;#e=!1;#n=!1;#r=!0;constructor(t,{name:e,intent:r,usage:i,rbGroups:s}){this.#t=!!(t&ts.DISPLAY),this.#e=!!(t&ts.PRINT),this.name=e,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(this.#n)return this.#r;if(!this.#r)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,r=!1){t!==Bu&&An("Internal method `_setVisible` called."),this.#n=r,this.#r=e}}class PI{#t=null;#e=new Map;#n=null;#r=null;constructor(t,e=ts.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#r=t.order;for(const r of t.groups)this.#e.set(r.id,new II(e,r));if(t.baseState==="OFF")for(const r of this.#e.values())r._setVisible(Bu,!1);for(const r of t.on)this.#e.get(r)._setVisible(Bu,!0);for(const r of t.off)this.#e.get(r)._setVisible(Bu,!1);this.#n=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const r=t[0];for(let i=1;i<e;i++){const s=t[i];let o;if(Array.isArray(s))o=this.#s(s);else if(this.#e.has(s))o=this.#e.get(s).visible;else return Ue(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return r==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Dm("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Ue(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Ue(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Ue(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Ue(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Ue(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Ue(`Unknown optional content policy ${t.policy}.`),!0}return Ue(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,r=!0){const i=this.#e.get(t);if(!i){Ue(`Optional content group not found: ${t}`);return}if(r&&e&&i.rbGroups.length)for(const s of i.rbGroups)for(const o of s)o!==t&&this.#e.get(o)?._setVisible(Bu,!1,!0);i._setVisible(Bu,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let r;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const s=this.#e.get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!s.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#r?this.#r.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new GT;for(const[e,r]of this.#e)t.update(`${e}:${r.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class FI{constructor(t,{disableRange:e=!1,disableStream:r=!1}){or(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:o,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=l,s?.length>0){const u=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!r,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((u,h)=>{this._onReceiveData({begin:u,chunk:h})}),t.addProgressListener((u,h)=>{this._onProgress({loaded:u,total:h})}),t.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const r=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(r),!0)});or(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){or(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new BI(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new UI(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(r),r}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class BI{constructor(t,e,r=!1,i=null){this._stream=t,this._done=r||!1,this._filename=Rm(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class UI{constructor(t,e,r){this._stream=t,this._begin=e,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function zI(n){let t=!0,e=r("filename\\*","i").exec(n);if(e){e=e[1];let d=l(e);return d=unescape(d),d=u(d),d=h(d),s(d)}if(e=o(n),e){const d=h(e);return s(d)}if(e=r("filename","i").exec(n),e){e=e[1];let d=l(e);return d=h(d),s(d)}function r(d,p){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function i(d,p){if(d){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const g=new TextDecoder(d,{fatal:!0}),v=qd(p);p=g.decode(v),t=!1}catch{}}return p}function s(d){return t&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),t&&(d=i("iso-8859-1",d))),d}function o(d){const p=[];let g;const v=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(g=v.exec(d))!==null;){let[,_,b,E]=g;if(_=parseInt(_,10),_ in p){if(_===0)break;continue}p[_]=[b,E]}const y=[];for(let _=0;_<p.length&&_ in p;++_){let[b,E]=p[_];E=l(E),b&&(E=unescape(E),_===0&&(E=u(E))),y.push(E)}return y.join("")}function l(d){if(d.startsWith('"')){const p=d.slice(1).split('\\"');for(let g=0;g<p.length;++g){const v=p[g].indexOf('"');v!==-1&&(p[g]=p[g].slice(0,v),p.length=g+1),p[g]=p[g].replaceAll(/\\(.)/g,"$1")}d=p.join('"')}return d}function u(d){const p=d.indexOf("'");if(p===-1)return d;const g=d.slice(0,p),y=d.slice(p+1).replace(/^[^']*'/,"");return i(g,y)}function h(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,g,v,y){if(v==="q"||v==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,b){return String.fromCharCode(parseInt(b,16))}),i(g,y);try{y=atob(y)}catch{}return i(g,y)})}return""}function QT(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const r in t){const i=t[r];i!==void 0&&e.append(r,i)}return e}function Nm(n){return URL.parse(n)?.origin??null}function JT({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*e)||r||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function tC(n){const t=n.get("Content-Disposition");if(t){let e=zI(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Rm(e))return e}return null}function t0(n,t){return new Ed(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n,n===404||n===0&&t.startsWith("file:"))}function eC(n){return n===200||n===206}function nC(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function rC(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Ue(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class HI{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=QT(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return or(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new jI(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new $I(this,t,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class jI{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const r=new Headers(t.headers),i=e.url;fetch(i,nC(r,this._withCredentials,this._abortController)).then(s=>{if(t._responseOrigin=Nm(s.url),!eC(s.status))throw t0(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const o=s.headers,{allowRangeRequests:l,suggestedLength:u}=JT({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=u||this._contentLength,this._filename=tC(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ko("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:rC(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class $I{constructor(t,e,r){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${r-1}`);const o=i.url;fetch(o,nC(s,this._withCredentials,this._abortController)).then(l=>{const u=Nm(l.url);if(u!==t._responseOrigin)throw new Error(`Expected range response-origin "${u}" to match "${t._responseOrigin}".`);if(!eC(l.status))throw t0(l.status,o);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:rC(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Qv=200,Jv=206;function GI(n){const t=n.response;return typeof t!="string"?t:qd(t).buffer}class VI{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:r}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=QT(this.isHttp,e),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,o]of this.headers)e.setRequestHeader(s,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=Jv):i.expectedStatus=Qv,e.responseType="arraybuffer",or(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,r),e.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),r}onProgress(t,e){const r=this.pendingRequests[t];r&&r.onProgress?.(e)}onStateChange(t,e){const r=this.pendingRequests[t];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){r.onError(i.status);return}const s=i.status||Qv;if(!(s===Qv&&r.expectedStatus===Jv)&&s!==r.expectedStatus){r.onError(i.status);return}const l=GI(i);if(s===Jv){const u=i.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);h?r.onDone({begin:parseInt(h[1],10),chunk:l}):(Ue('Missing or invalid "Content-Range" header.'),r.onError(0))}else l?r.onDone({begin:0,chunk:l}):r.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class WI{constructor(t){this._source=t,this._manager=new VI(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return or(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new XI(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const r=new YI(this._manager,t,e);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class XI{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Nm(e.responseURL);const r=e.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[u,...h]=l.split(": ");return[u,h.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:o}=JT({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=tC(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=t0(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class YI{constructor(t,e,r){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Nm(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=t0(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const qI=/^[a-z][a-z0-9\-+.]+:/i;function KI(n){if(qI.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class ZI{constructor(t){this.source=t,this.url=KI(t.url),or(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return or(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new QI(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new JI(this,t,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class QI{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=t0(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ko("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class JI{constructor(t,e,r){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const qh=Symbol("INITIAL_DATA");class iC{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:qh}}get(t,e=null){if(e){const i=this.#e(t);return i.promise.then(()=>e(i.data)),null}const r=this.#t[t];if(!r||r.data===qh)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return r.data}has(t){const e=this.#t[t];return!!e&&e.data!==qh}delete(t){const e=this.#t[t];return!e||e.data===qh?!1:(delete this.#t[t],!0)}resolve(t,e=null){const r=this.#e(t);r.data=e,r.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==qh&&(yield[t,e])}}}const tP=1e5,RA=30;let wd=class Cs{#t=Promise.withResolvers();#e=null;#n=!1;#r=!!globalThis.FontInspector?.enabled;#s=null;#i=null;#l=0;#o=0;#f=null;#c=null;#h=0;#u=0;#d=Object.create(null);#a=[];#p=null;#m=[];#g=new WeakMap;#v=null;static#_=new Map;static#y=new Map;static#x=new WeakMap;static#w=null;static#S=new Set;constructor({textContentSource:t,container:e,viewport:r}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(u){u.enqueue(t),u.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=r.scale*ia.pixelRatio,this.#h=r.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:s,pageX:o,pageY:l}=r.rawDims;this.#v=[1,0,0,-1,-o,l+s],this.#o=i,this.#l=s,Cs.#N(),Cl(e,r),this.#t.promise.finally(()=>{Cs.#S.delete(this),this.#i=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Tr.platform;return Ye(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#f.read().then(({value:e,done:r})=>{if(r){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#d,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#f=this.#p.getReader(),Cs.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const r=t.scale*ia.pixelRatio,i=t.rotation;if(i!==this.#h&&(e?.(),this.#h=i,Cl(this.#c,{rotation:i})),r!==this.#u){e?.(),this.#u=r;const s={div:null,properties:null,ctx:Cs.#D(this.#s)};for(const o of this.#m)s.properties=this.#g.get(o),s.div=o,this.#E(s)}}cancel(){const t=new ko("TextLayer task cancelled.");this.#f?.cancel(t).catch(()=>{}),this.#f=null,this.#t.reject(t)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#a}#C(t){if(this.#n)return;this.#i.ctx??=Cs.#D(this.#s);const e=this.#m,r=this.#a;for(const i of t){if(e.length>tP){Ue("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const s=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),i.id!==null&&this.#e.setAttribute("id",`${i.id}`),s.append(this.#e)}else i.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}r.push(i.str),this.#O(i)}}#O(t){const e=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#m.push(e);const i=be.transform(this.#v,t.transform);let s=Math.atan2(i[1],i[0]);const o=this.#d[t.fontName];o.vertical&&(s+=Math.PI/2);let l=this.#r&&o.fontSubstitution||o.fontFamily;l=Cs.fontFamilyMap.get(l)||l;const u=Math.hypot(i[2],i[3]),h=u*Cs.#k(l,o,this.#s);let d,p;s===0?(d=i[4],p=i[5]-h):(d=i[4]+h*Math.sin(s),p=i[5]-h*Math.cos(s));const g="calc(var(--total-scale-factor) *",v=e.style;this.#e===this.#c?(v.left=`${(100*d/this.#o).toFixed(2)}%`,v.top=`${(100*p/this.#l).toFixed(2)}%`):(v.left=`${g}${d.toFixed(2)}px)`,v.top=`${g}${p.toFixed(2)}px)`),v.fontSize=`${g}${(Cs.#w*u).toFixed(2)}px)`,v.fontFamily=l,r.fontSize=u,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#r&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),s!==0&&(r.angle=s*(180/Math.PI));let y=!1;if(t.str.length>1)y=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),b=Math.abs(t.transform[3]);_!==b&&Math.max(_,b)/Math.min(_,b)>1.5&&(y=!0)}if(y&&(r.canvasWidth=o.vertical?t.height:t.width),this.#g.set(e,r),this.#i.div=e,this.#i.properties=r,this.#E(this.#i),r.hasText&&this.#e.append(e),r.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#E(t){const{div:e,properties:r,ctx:i}=t,{style:s}=e;let o="";if(Cs.#w>1&&(o=`scale(${1/Cs.#w})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=s,{canvasWidth:u,fontSize:h}=r;Cs.#T(i,h*this.#u,l);const{width:d}=i.measureText(e.textContent);d>0&&(o=`scaleX(${u*this.#u/d}) ${o}`)}r.angle!==0&&(o=`rotate(${r.angle}deg) ${o}`),o.length>0&&(s.transform=o)}static cleanup(){if(!(this.#S.size>0)){this.#_.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#D(t=null){let e=this.#y.get(t||="");if(!e){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=t,document.body.append(r),e=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#x.set(e,{size:0,family:""})}return e}static#T(t,e,r){const i=this.#x.get(t);e===i.size&&r===i.family||(t.font=`${e}px ${r}`,i.size=e,i.family=r)}static#N(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#k(t,e,r){const i=this.#_.get(t);if(i)return i;const s=this.#D(r);s.canvas.width=s.canvas.height=RA,this.#T(s,RA,t);const o=s.measureText(""),l=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let h=.8;return l?h=l/(l+u):(Tr.platform.isFirefox&&Ue("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?h=e.ascent:e.descent&&(h=1+e.descent)),this.#_.set(t,h),h}};class Ad{static textContent(t){const e=[],r={items:e,styles:Object.create(null)};function i(s){if(!s)return;let o=null;const l=s.name;if(l==="#text")o=s.value;else if(Ad.shouldBuildText(l))s?.attributes?.textContent?o=s.attributes.textContent:s.value&&(o=s.value);else return;if(o!==null&&e.push({str:o}),!!s.children)for(const u of s.children)i(u)}return i(t),r}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const eP=100;function Xy(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new Yy,{docId:e}=t,r=n.url?fI(n.url):null,i=n.data?hI(n.data):null,s=n.httpHeaders||null,o=n.withCredentials===!0,l=n.password??null,u=n.range instanceof qy?n.range:null,h=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof of?n.worker:null;const p=n.verbosity,g=typeof n.docBaseUrl=="string"&&!Zd(n.docBaseUrl)?n.docBaseUrl:null,v=Zp(n.cMapUrl),y=n.cMapPacked!==!1,_=n.CMapReaderFactory||(_i?yI:_A),b=Zp(n.iccUrl),E=Zp(n.standardFontDataUrl),S=n.StandardFontDataFactory||(_i?bI:yA),T=Zp(n.wasmUrl),O=n.WasmFactory||(_i?xI:bA),R=n.stopAtErrors!==!0,N=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,C=n.isEvalSupported!==!1,I=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!_i,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!_i&&(Tr.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,H=typeof n.disableFontFace=="boolean"?n.disableFontFace:_i,P=n.fontExtraProperties===!0,et=n.enableXfa===!0,L=n.ownerDocument||globalThis.document,st=n.disableRange===!0,Q=n.disableStream===!0,Y=n.disableAutoFetch===!0,Ot=n.pdfBug===!0,Et=n.CanvasFactory||(_i?_I:gI),z=n.FilterFactory||(_i?vI:mI),J=n.enableHWA===!0,V=n.useWasm!==!1,ct=u?u.length:n.length??NaN,gt=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!_i&&!H,_t=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(_===_A&&S===yA&&O===bA&&v&&E&&T&&id(v,document.baseURI)&&id(E,document.baseURI)&&id(T,document.baseURI)),Bt=null;XM(p);const Gt={canvasFactory:new Et({ownerDocument:L,enableHWA:J}),filterFactory:new z({docId:e,ownerDocument:L}),cMapReaderFactory:_t?null:new _({baseUrl:v,isCompressed:y}),standardFontDataFactory:_t?null:new S({baseUrl:E}),wasmFactory:_t?null:new O({baseUrl:T})};d||(d=of.create({verbosity:p,port:bl.workerPort}),t._worker=d);const j={docId:e,apiVersion:"5.3.31",data:i,password:l,disableAutoFetch:Y,rangeChunkSize:h,length:ct,docBaseUrl:g,enableXfa:et,evaluatorOptions:{maxImageSize:N,disableFontFace:H,ignoreErrors:R,isEvalSupported:C,isOffscreenCanvasSupported:I,isImageDecoderSupported:M,canvasMaxAreaInBytes:F,fontExtraProperties:P,useSystemFonts:gt,useWasm:V,useWorkerFetch:_t,cMapUrl:v,iccUrl:b,standardFontDataUrl:E,wasmUrl:T}},pt={ownerDocument:L,pdfBug:Ot,styleElement:Bt,loadingParams:{disableAutoFetch:Y,enableXfa:et}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const lt=d.messageHandler.sendWithPromise("GetDocRequest",j,i?[i.buffer]:null);let ut;if(u)ut=new FI(u,{disableRange:st,disableStream:Q});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");const Dt=id(r)?HI:_i?ZI:WI;ut=new Dt({url:r,length:ct,httpHeaders:s,withCredentials:o,rangeChunkSize:h,disableRange:st,disableStream:Q})}return lt.then(Dt=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Lt=new sd(e,Dt,d.port),D=new iP(Lt,t,ut,pt,Gt);t._transport=D,Lt.send("Ready",null)})}).catch(t._capability.reject),t}class Yy{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Yy.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let qy=class{#t=Promise.withResolvers();#e=[];#n=[];#r=[];#s=[];constructor(t,e,r=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=r,this.contentDispositionFilename=i}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#r.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const r of this.#s)r(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const r of this.#r)r(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){An("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class nP{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ye(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class rP{#t=!1;constructor(t,e,r,i=!1){this._pageIndex=t,this._pageInfo=e,this._transport=r,this._stats=i?new gA:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new iC,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new Kd({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ye(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:r="display",annotationMode:i=Pa.ENABLE,transform:s=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:d=null,isEditing:p=!1}){this._stats?.time("Overall");const g=this._transport.getRenderingIntent(r,i,d,p),{renderingIntent:v,cacheKey:y}=g;this.#t=!1,l||=this._transport.getOptionalContentConfig(v);let _=this._intentStates.get(y);_||(_=Object.create(null),this._intentStates.set(y,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const b=!!(v&ts.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(g));const E=O=>{_.renderTasks.delete(S),b&&(this.#t=!0),this.#e(),O?(S.capability.reject(O),this._abortOperatorList({intentState:_,reason:O instanceof Error?O:new Error(O)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new ju({callback:E,params:{canvasContext:t,viewport:e,transform:s,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:h});(_.renderTasks||=new Set).add(S);const T=S.task;return Promise.all([_.displayReadyCapability.promise,l]).then(([O,R])=>{if(this.destroyed){E();return}if(this._stats?.time("Rendering"),!(R.renderingIntent&v))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:O,optionalContentConfig:R}),S.operatorListChanged()}).catch(E),T}getOperatorList({intent:t="display",annotationMode:e=Pa.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){function s(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(u))}const o=this._transport.getRenderingIntent(t,e,r,i,!0);let l=this._intentStates.get(o.cacheKey);l||(l=Object.create(null),this._intentStates.set(o.cacheKey,l));let u;return l.opListReadCapability||(u=Object.create(null),u.operatorListChanged=s,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||=new Set).add(u),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Ad.textContent(r));const e=this.streamTextContent(t);return new Promise(function(r,i){function s(){o.read().then(function({value:u,done:h}){if(h){r(l);return}l.lang??=u.lang,Object.assign(l.styles,u.styles),l.items.push(...u.items),s()},i)}const o=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const r of e.renderTasks)t.push(r.completed),r.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new gA),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const r=this._intentStates.get(e);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let r=0,i=t.length;r<i;r++)e.operatorList.fnArray.push(t.fnArray[r]),e.operatorList.argsArray.push(t.argsArray[r]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const r of e.renderTasks)r.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:r,modifiedIds:i}){const{map:s,transfer:o}=r,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:i},o).getReader(),h=this._intentStates.get(e);h.streamReader=u;const d=()=>{u.read().then(({value:p,done:g})=>{if(g){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,h),d())},p=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const g of h.renderTasks)g.operatorListChanged();this.#e()}if(h.displayReadyCapability)h.displayReadyCapability.reject(p);else if(h.opListReadCapability)h.opListReadCapability.reject(p);else throw p}})};d()}_abortOperatorList({intentState:t,reason:e,force:r=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!r){if(t.renderTasks.size>0)return;if(e instanceof Om){let i=eP;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new ko(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var _l,Js,Ao,vc,mm,_c,yc,wi,Ng,sC,aC,ad,Ju,kg;const In=class In{constructor({name:t=null,port:e=null,verbosity:r=YM()}={}){Sa(this,wi);Sa(this,_l,Promise.withResolvers());Sa(this,Js,null);Sa(this,Ao,null);Sa(this,vc,null);if(this.name=t,this.destroyed=!1,this.verbosity=r,e){if(Mn(In,yc).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Mn(In,yc).set(e,this),Ta(this,wi,sC).call(this,e)}else Ta(this,wi,aC).call(this)}get promise(){return Mn(this,_l).promise}get port(){return Mn(this,Ao)}get messageHandler(){return Mn(this,Js)}destroy(){this.destroyed=!0,Mn(this,vc)?.terminate(),Bi(this,vc,null),Mn(In,yc).delete(Mn(this,Ao)),Bi(this,Ao,null),Mn(this,Js)?.destroy(),Bi(this,Js,null)}static create(t){const e=Mn(this,yc).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new In(t)}static get workerSrc(){if(bl.workerSrc)return bl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ye(this,"_setupFakeWorkerGlobal",(async()=>Mn(this,Ju,kg)?Mn(this,Ju,kg):(await import(this.workerSrc)).WorkerMessageHandler)())}};_l=new WeakMap,Js=new WeakMap,Ao=new WeakMap,vc=new WeakMap,mm=new WeakMap,_c=new WeakMap,yc=new WeakMap,wi=new WeakSet,Ng=function(){Mn(this,_l).resolve(),Mn(this,Js).send("configure",{verbosity:this.verbosity})},sC=function(t){Bi(this,Ao,t),Bi(this,Js,new sd("main","worker",t)),Mn(this,Js).on("ready",()=>{}),Ta(this,wi,Ng).call(this)},aC=function(){if(Mn(In,_c)||Mn(In,Ju,kg)){Ta(this,wi,ad).call(this);return}let{workerSrc:t}=In;try{In._isSameOrigin(window.location,t)||(t=In._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),r=new sd("main","worker",e),i=()=>{s.abort(),r.destroy(),e.terminate(),this.destroyed?Mn(this,_l).reject(new Error("Worker was destroyed")):Ta(this,wi,ad).call(this)},s=new AbortController;e.addEventListener("error",()=>{Mn(this,vc)||i()},{signal:s.signal}),r.on("test",l=>{if(s.abort(),this.destroyed||!l){i();return}Bi(this,Js,r),Bi(this,Ao,e),Bi(this,vc,e),Ta(this,wi,Ng).call(this)}),r.on("ready",l=>{if(s.abort(),this.destroyed){i();return}try{o()}catch{Ta(this,wi,ad).call(this)}});const o=()=>{const l=new Uint8Array;r.send("test",l,[l.buffer])};o();return}catch{Dm("The worker has been disabled.")}Ta(this,wi,ad).call(this)},ad=function(){Mn(In,_c)||(Ue("Setting up fake worker."),Bi(In,_c,!0)),In._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Mn(this,_l).reject(new Error("Worker was destroyed"));return}const e=new pI;Bi(this,Ao,e);const r=`fake${lw(In,mm)._++}`,i=new sd(r+"_worker",r,e);t.setup(i,e),Bi(this,Js,new sd(r,r+"_worker",e)),Ta(this,wi,Ng).call(this)}).catch(t=>{Mn(this,_l).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Ju=new WeakSet,kg=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Sa(In,Ju),Sa(In,mm,0),Sa(In,_c,!1),Sa(In,yc,new WeakMap),_i&&(Bi(In,_c,!0),bl.workerSrc||="./pdf.worker.mjs"),In._isSameOrigin=(t,e)=>{const r=URL.parse(t);if(!r?.origin||r.origin==="null")return!1;const i=new URL(e,r);return r.origin===i.origin},In._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},In.fromPort=t=>{if(rI("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return In.create(t)};let of=In;class iP{#t=new Map;#e=new Map;#n=new Map;#r=new Map;#s=null;constructor(t,e,r,i,s){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new iC,this.fontLoader=new cI({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#i(t,e=null){const r=this.#t.get(t);if(r)return r;const i=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,i),i}get annotationStorage(){return Ye(this,"annotationStorage",new $y)}getRenderingIntent(t,e=Pa.ENABLE,r=null,i=!1,s=!1){let o=ts.DISPLAY,l=G_;switch(t){case"any":o=ts.ANY;break;case"display":break;case"print":o=ts.PRINT;break;default:Ue(`getRenderingIntent - invalid intent: ${t}`)}const u=o&ts.PRINT&&r instanceof VT?r:this.annotationStorage;switch(e){case Pa.DISABLE:o+=ts.ANNOTATIONS_DISABLE;break;case Pa.ENABLE:break;case Pa.ENABLE_FORMS:o+=ts.ANNOTATIONS_FORMS;break;case Pa.ENABLE_STORAGE:o+=ts.ANNOTATIONS_STORAGE,l=u.serializable;break;default:Ue(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(o+=ts.IS_EDITING),s&&(o+=ts.OPLIST);const{ids:h,hash:d}=u.modifiedIds,p=[o,l.hash,d];return{renderingIntent:o,cacheKey:p.join("_"),annotationStorageSerializable:l,modifiedIds:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const r of this.#e.values())t.push(r._destroy());this.#e.clear(),this.#n.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),wd.cleanup(),this._networkStream?.cancelAllRequests(new ko("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(r,i)=>{or(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:o}){if(o){i.close();return}or(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async r=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:o}=this._fullReader;return(!i||!s)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=l=>{e.onProgress?.({loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:o}}),t.on("GetRangeReader",(r,i)=>{or(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:o,done:l}){if(l){i.close();return}or(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{s.cancel(o),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,e._capability.resolve(new nP(r,this))}),t.on("DocException",r=>{e._capability.reject(Ui(r))}),t.on("PasswordRequest",r=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw Ui(r);const i=s=>{s instanceof Error?this.#s.reject(s):this.#s.resolve({password:s})};e.onPassword(i,r.code)}catch(i){this.#s.reject(i)}return this.#s.promise}),t.on("DataLoaded",r=>{e.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),t.on("StartRenderPage",r=>{if(this.destroyed)return;this.#e.get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),t.on("commonobj",([r,i,s])=>{if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":if("error"in s){const h=s.error;Ue(`Error during font loading: ${h}`),this.commonObjs.resolve(r,h);break}const o=this._params.pdfBug&&globalThis.FontInspector?.enabled?(h,d)=>globalThis.FontInspector.fontAdded(h,d):null,l=new uI(s,o);this.fontLoader.bind(l).catch(()=>t.sendWithPromise("FontFallback",{id:r})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(r,l)});break;case"CopyLocalImage":const{imageRef:u}=s;or(u,"The imageRef must be defined.");for(const h of this.#e.values())for(const[,d]of h.objs)if(d?.ref===u)return d.dataLen?(this.commonObjs.resolve(r,structuredClone(d)),d.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([r,i,s,o])=>{if(this.destroyed)return;const l=this.#e.get(i);if(!l.objs.has(r)){if(l._intentStates.size===0){o?.bitmap?.close();return}switch(s){case"Image":case"Pattern":l.objs.resolve(r,o);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",r=>{this.destroyed||e.onProgress?.({loaded:r.loaded,total:r.total})}),t.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[r.type];if(!i)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ue("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,r=this.#n.get(e);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#r.set(s.refStr,t);const o=new rP(e,s,this,this._params.pdfBug);return this.#e.set(e,o),o});return this.#n.set(e,i),i}getPageIndex(t){return V_(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#i("GetOptionalContentConfig").then(e=>new PI(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const r=this.messageHandler.sendWithPromise(t,null).then(i=>({info:i[0],metadata:i[1]?new MI(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),wd.cleanup()}}cachedPageNumber(t){if(!V_(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#r.get(e)??null}}class sP{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class ju{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:o,pageIndex:l,canvasFactory:u,filterFactory:h,useRequestAnimationFrame:d=!1,pdfBug:p=!1,pageColors:g=null}){this.callback=t,this.params=e,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=l,this.canvasFactory=u,this.filterFactory=h,this._pdfBug=p,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new sP(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(ju.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ju.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:i,transform:s,background:o}=this.params;this.gfx=new $u(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),ju.#e.delete(this._canvas),t||=new Om(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ju.#e.delete(this._canvas),this.callback())))}}const oC="5.3.31",lC="47ad820d9";function NA(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Kh(n){return Math.max(0,Math.min(255,255*n))}class kA{static CMYK_G([t,e,r,i]){return["G",1-Math.min(1,.3*t+.59*r+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Kh(t),[t,t,t]}static G_HTML([t]){const e=NA(t);return`#${e}${e}${e}`}static RGB_G([t,e,r]){return["G",.3*t+.59*e+.11*r]}static RGB_rgb(t){return t.map(Kh)}static RGB_HTML(t){return`#${t.map(NA).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,r,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,r+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,r,i]){return[Kh(1-Math.min(1,t+i)),Kh(1-Math.min(1,r+i)),Kh(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,r]){const i=1-t,s=1-e,o=1-r,l=Math.min(i,s,o);return["CMYK",i,s,o,l]}}class aP{create(t,e,r=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){An("Abstract method `_createSVG` called.")}}class Sd extends aP{_createSVG(t){return document.createElementNS(Eo,t)}}class Ky{static setupStorage(t,e,r,i,s){const o=i.getValue(e,{value:null});switch(r.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(o.value===r.attributes.xfaOn?t.setAttribute("checked",!0):o.value===r.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{i.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const l of r.children)l.attributes.value===o.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const u=l.target.options,h=u.selectedIndex===-1?"":u[u.selectedIndex].value;i.setValue(e,{value:h})});break}}static setAttributes({html:t,element:e,storage:r=null,intent:i,linkService:s}){const{attributes:o}=e,l=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[u,h]of Object.entries(o))if(h!=null)switch(u){case"class":h.length&&t.setAttribute(u,h.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",h);break;case"style":Object.assign(t.style,h);break;case"textContent":t.textContent=h;break;default:(!l||u!=="href"&&u!=="newWindow")&&t.setAttribute(u,h)}l&&s.addLinkAttributes(t,o.href,o.newWindow),r&&o.dataId&&this.setupStorage(t,o.dataId,e,r)}static render(t){const e=t.annotationStorage,r=t.linkService,i=t.xfaHtml,s=t.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:s,linkService:r});const l=s!=="richText",u=t.div;if(u.append(o),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;u.style.transform=p}l&&u.setAttribute("class","xfaLayer xfaFont");const h=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);o.append(p),l&&Ad.shouldBuildText(i.name)&&h.push(p)}return{textDivs:h}}const d=[[i,-1,o]];for(;d.length>0;){const[p,g,v]=d.at(-1);if(g+1===p.children.length){d.pop();continue}const y=p.children[++d.at(-1)[1]];if(y===null)continue;const{name:_}=y;if(_==="#text"){const E=document.createTextNode(y.value);h.push(E),v.append(E);continue}const b=y?.attributes?.xmlns?document.createElementNS(y.attributes.xmlns,_):document.createElement(_);if(v.append(b),y.attributes&&this.setAttributes({html:b,element:y,storage:e,intent:s,linkService:r}),y.children?.length>0)d.push([y,-1,b]);else if(y.value){const E=document.createTextNode(y.value);l&&Ad.shouldBuildText(_)&&h.push(E),b.append(E)}}for(const p of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:h}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const e0=1e3,oP=9,Tc=new WeakSet;class LA{static create(t){switch(t.data.annotationType){case qn.LINK:return new cC(t);case qn.TEXT:return new lP(t);case qn.WIDGET:switch(t.data.fieldType){case"Tx":return new cP(t);case"Btn":return t.data.radioButton?new uC(t):t.data.checkBox?new fP(t):new hP(t);case"Ch":return new dP(t);case"Sig":return new uP(t)}return new Uc(t);case qn.POPUP:return new X_(t);case qn.FREETEXT:return new fC(t);case qn.LINE:return new gP(t);case qn.SQUARE:return new mP(t);case qn.CIRCLE:return new vP(t);case qn.POLYLINE:return new hC(t);case qn.CARET:return new yP(t);case qn.INK:return new Zy(t);case qn.POLYGON:return new _P(t);case qn.HIGHLIGHT:return new dC(t);case qn.UNDERLINE:return new bP(t);case qn.SQUIGGLY:return new xP(t);case qn.STRIKEOUT:return new EP(t);case qn.STAMP:return new pC(t);case qn.FILEATTACHMENT:return new wP(t);default:return new Jn(t)}}}class Jn{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:r}){return!!(t?.str||e?.str||r?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Jn._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#r(e),this.#n?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#r(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#r(t){const{container:{style:e},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:u}}}}=this;r?.splice(0,4,...t),e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(o-t[3]+u)/o}%`,i===0?(e.width=`${100*(t[2]-t[0])/s}%`,e.height=`${100*(t[3]-t[1])/o}%`):this.setRotation(i)}_createContainer(t){const{data:e,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof Uc||(s.tabIndex=e0);const{style:o}=s;if(o.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof X_){const{rotation:_}=e;return!e.hasOwnCanvas&&_!==0&&this.setRotation(_,s),s}const{width:l,height:u}=this;if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const _=e.borderStyle.horizontalCornerRadius,b=e.borderStyle.verticalCornerRadius;if(_>0||b>0){const S=`calc(${_}px * var(--total-scale-factor)) / calc(${b}px * var(--total-scale-factor))`;o.borderRadius=S}else if(this instanceof uC){const S=`calc(${l}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;o.borderRadius=S}switch(e.borderStyle.style){case Fu.SOLID:o.borderStyle="solid";break;case Fu.DASHED:o.borderStyle="dashed";break;case Fu.BEVELED:Ue("Unimplemented border style: beveled");break;case Fu.INSET:Ue("Unimplemented border style: inset");break;case Fu.UNDERLINE:o.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,o.borderColor=be.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):o.borderWidth=0}const h=be.normalizeRect([e.rect[0],r.view[3]-e.rect[1]+r.view[1],e.rect[2],r.view[3]-e.rect[3]+r.view[1]]),{pageWidth:d,pageHeight:p,pageX:g,pageY:v}=i.rawDims;o.left=`${100*(h[0]-g)/d}%`,o.top=`${100*(h[1]-v)/p}%`;const{rotation:y}=e;return e.hasOwnCanvas||y===0?(o.width=`${100*l/d}%`,o.height=`${100*u/p}%`):this.setRotation(y,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:o}=this;t%180!==0&&([s,o]=[o,s]),e.style.width=`${100*s/r}%`,e.style.height=`${100*o/i}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,r,i)=>{const s=i.detail[e],o=s[0],l=s.slice(1);i.target.style[r]=kA[`${o}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[r]:kA[`${o}_rgb`](l)})};return Ye(this,"_commonActions",{display:e=>{const{display:r}=e.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:r}=e.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const r=e.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(t,e){const r=this._commonActions;for(const i of Object.keys(e.detail))(t[i]||r[i])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const r=this._commonActions;for(const[i,s]of Object.entries(e)){const o=r[i];if(o){const l={detail:{[i]:s},target:t};o(l),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,r,i,s]=this.data.rect.map(_=>Math.fround(_));if(t.length===8){const[_,b,E,S]=t.subarray(2,6);if(i===_&&s===b&&e===E&&r===S)return}const{style:o}=this.container;let l;if(this.#e){const{borderColor:_,borderWidth:b}=o;o.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const u=i-e,h=s-r,{svgFactory:d}=this,p=d.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0);const g=d.createElement("defs");p.append(g);const v=d.createElement("clipPath"),y=`clippath_${this.data.id}`;v.setAttribute("id",y),v.setAttribute("clipPathUnits","objectBoundingBox"),g.append(v);for(let _=2,b=t.length;_<b;_+=8){const E=t[_],S=t[_+1],T=t[_+2],O=t[_+3],R=d.createElement("rect"),N=(T-e)/u,C=(s-S)/h,I=(E-T)/u,M=(S-O)/h;R.setAttribute("x",N),R.setAttribute("y",C),R.setAttribute("width",I),R.setAttribute("height",M),v.append(R),l?.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${C}" width="${I}" height="${M}"/>`)}this.#e&&(l.push("</g></svg>')"),o.backgroundImage=l.join("")),this.container.append(p),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:t}=this,e=this.#n=new X_({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){An("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:s,id:o,exportValues:l}of i){if(s===-1||o===e)continue;const u=typeof l=="string"?l:null,h=document.querySelector(`[data-element-id="${o}"]`);if(h&&!Tc.has(h)){Ue(`_getElementsByName - element not allowed: ${o}`);continue}r.push({id:o,exportValue:u,domElement:h})}return r}for(const i of document.getElementsByName(t)){const{exportValue:s}=i,o=i.getAttribute("data-element-id");o!==e&&Tc.has(i)&&r.push({id:o,exportValue:s,domElement:i})}return r}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class cC extends Jn{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let i=!1;return t.url?(e.addLinkAttributes(r,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(r,t.action),i=!0):t.attachment?(this.#e(r,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(this.#n(r,t.setOCGState),i=!0):t.dest?(this._bindLink(r,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),i=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(r),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#t()}#e(t,e,r=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,r),!1),this.#t()}#n(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(e.actions)){const s=r.get(i);s&&(t[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:i}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Ue('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{r?.();const{fields:i,refs:s,include:o}=e,l=[];if(i.length!==0||s.length!==0){const d=new Set(s);for(const p of i){const g=this._fieldObjects[p]||[];for(const{id:v}of g)d.add(v)}for(const p of Object.values(this._fieldObjects))for(const g of p)d.has(g.id)===o&&l.push(g)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const u=this.annotationStorage,h=[];for(const d of l){const{id:p}=d;switch(h.push(p),d.type){case"text":{const v=d.defaultValue||"";u.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=d.defaultValue===d.exportValues;u.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=d.defaultValue||"";u.setValue(p,{value:v});break}default:continue}const g=document.querySelector(`[data-element-id="${p}"]`);if(g){if(!Tc.has(g)){Ue(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}}),!1}}}class lP extends Jn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Uc extends Jn{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Tr.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,r,i,s){r.includes("mouse")?t.addEventListener(r,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(r,o=>{if(r==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(r==="focus"){if(e.focused)return;e.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(o)}})})}_setEventListeners(t,e,r,i){for(const[s,o]of r)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,s,o,i),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":be.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||oP,s=t.style;let o;const l=2,u=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-l),d=Math.round(h/(Wv*i))||1,p=h/d;o=Math.min(i,u(p/Wv))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-l);o=Math.min(i,u(h/Wv))}s.fontSize=`calc(${o}px * var(--total-scale-factor))`,s.color=be.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class cP extends Uc{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,r,i){const s=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=r),s.setValue(o.id,{[i]:r})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const i=t.getValue(e,{value:this.data.fieldValue});let s=i.value||"";const o=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;o&&s.length>o&&(s=s.slice(0,o));let l=i.formattedValue||this.data.textContent?.join(`
`)||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const u={userValue:s,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=l??s,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",l??s),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Tc.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=e0,this._setRequired(r,this.data.required),o&&(r.maxLength=o),r.addEventListener("input",d=>{t.setValue(e,{value:d.target.value}),this.setPropertyOnSiblings(r,"value",d.target.value,"value"),u.formattedValue=null}),r.addEventListener("resetform",d=>{const p=this.data.defaultFieldValue??"";r.value=u.userValue=p,u.formattedValue=null});let h=d=>{const{formattedValue:p}=u;p!=null&&(d.target.value=p),d.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",p=>{if(u.focused)return;const{target:g}=p;u.userValue&&(g.value=u.userValue),u.lastCommittedValue=g.value,u.commitKey=1,this.data.actions?.Focus||(u.focused=!0)}),r.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const g={value(v){u.userValue=v.detail.value??"",t.setValue(e,{value:u.userValue.toString()}),v.target.value=u.userValue},formattedValue(v){const{formattedValue:y}=v.detail;u.formattedValue=y,y!=null&&v.target!==document.activeElement&&(v.target.value=y),t.setValue(e,{formattedValue:y})},selRange(v){v.target.setSelectionRange(...v.detail.selRange)},charLimit:v=>{const{charLimit:y}=v.detail,{target:_}=v;if(y===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",y);let b=u.userValue;!b||b.length<=y||(b=b.slice(0,y),_.value=u.userValue=b,t.setValue(e,{value:b}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(g,p)}),r.addEventListener("keydown",p=>{u.commitKey=1;let g=-1;if(p.key==="Escape"?g=0:p.key==="Enter"&&!this.data.multiLine?g=2:p.key==="Tab"&&(u.commitKey=3),g===-1)return;const{value:v}=p.target;u.lastCommittedValue!==v&&(u.lastCommittedValue=v,u.userValue=v,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:v,willCommit:!0,commitKey:g,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const d=h;h=null,r.addEventListener("blur",p=>{if(!u.focused||!p.relatedTarget)return;this.data.actions?.Blur||(u.focused=!1);const{value:g}=p.target;u.userValue=g,u.lastCommittedValue!==g&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:g,willCommit:!0,commitKey:u.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}),d(p)}),this.data.actions?.Keystroke&&r.addEventListener("beforeinput",p=>{u.lastCommittedValue=null;const{data:g,target:v}=p,{value:y,selectionStart:_,selectionEnd:b}=v;let E=_,S=b;switch(p.inputType){case"deleteWordBackward":{const T=y.substring(0,_).match(/\w*[^\w]*$/);T&&(E-=T[0].length);break}case"deleteWordForward":{const T=y.substring(_).match(/^[^\w]*\w*/);T&&(S+=T[0].length);break}case"deleteContentBackward":_===b&&(E-=1);break;case"deleteContentForward":_===b&&(S+=1);break}p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,change:g||"",willCommit:!1,selStart:E,selEnd:S}})}),this._setEventListeners(r,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(h&&r.addEventListener("blur",h),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/o;r.classList.add("comb"),r.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class uP extends Uc{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class fP extends Uc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,r=e.id;let i=t.getValue(r,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Tc.add(s),s.setAttribute("data-element-id",r),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=e0,s.addEventListener("change",o=>{const{name:l,checked:u}=o.target;for(const h of this._getElementsByName(l,r)){const d=u&&h.exportValue===e.exportValue;h.domElement&&(h.domElement.checked=d),t.setValue(h.id,{value:d})}t.setValue(r,{value:u})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue||"Off";o.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",o=>{const l={value(u){u.target.checked=u.detail.value!=="Off",t.setValue(r,{value:u.target.checked})}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class uC extends Uc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,r=e.id;let i=t.getValue(r,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(r,{value:i})),i)for(const o of this._getElementsByName(e.fieldName,r))t.setValue(o.id,{value:!1});const s=document.createElement("input");if(Tc.add(s),s.setAttribute("data-element-id",r),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=e0,s.addEventListener("change",o=>{const{name:l,checked:u}=o.target;for(const h of this._getElementsByName(l,r))t.setValue(h.id,{value:!1});t.setValue(r,{value:u})}),s.addEventListener("resetform",o=>{const l=e.defaultFieldValue;o.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const u={value:h=>{const d=o===h.detail.value;for(const p of this._getElementsByName(h.target.name)){const g=d&&p.id===r;p.domElement&&(p.domElement.checked=g),t.setValue(p.id,{value:g})}}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class hP extends cC{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),t}}class dP extends Uc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,r=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");Tc.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=e0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const p=this.data.defaultFieldValue;for(const g of i.options)g.selected=g.value===p});for(const d of this.data.options){const p=document.createElement("option");p.textContent=d.displayValue,p.value=d.exportValue,r.value.includes(d.exportValue)&&(p.setAttribute("selected",!0),s=!1),i.append(p)}let o=null;if(s){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),o=()=>{d.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const l=d=>{const p=d?"value":"textContent",{options:g,multiple:v}=i;return v?Array.prototype.filter.call(g,y=>y.selected).map(y=>y[p]):g.selectedIndex===-1?null:g[g.selectedIndex][p]};let u=l(!1);const h=d=>{const p=d.target.options;return Array.prototype.map.call(p,g=>({displayValue:g.textContent,exportValue:g.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const p={value(g){o?.();const v=g.detail.value,y=new Set(Array.isArray(v)?v:[v]);for(const _ of i.options)_.selected=y.has(_.value);t.setValue(e,{value:l(!0)}),u=l(!1)},multipleSelection(g){i.multiple=!0},remove(g){const v=i.options,y=g.detail.remove;v[y].selected=!1,i.remove(y),v.length>0&&Array.prototype.findIndex.call(v,b=>b.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:l(!0),items:h(g)}),u=l(!1)},clear(g){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),u=l(!1)},insert(g){const{index:v,displayValue:y,exportValue:_}=g.detail.insert,b=i.children[v],E=document.createElement("option");E.textContent=y,E.value=_,b?b.before(E):i.append(E),t.setValue(e,{value:l(!0),items:h(g)}),u=l(!1)},items(g){const{items:v}=g.detail;for(;i.length!==0;)i.remove(0);for(const y of v){const{displayValue:_,exportValue:b}=y,E=document.createElement("option");E.textContent=_,E.value=b,i.append(E)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:l(!0),items:h(g)}),u=l(!1)},indices(g){const v=new Set(g.detail.indices);for(const y of g.target.options)y.selected=v.has(y.index);t.setValue(e,{value:l(!0)}),u=l(!1)},editable(g){g.target.disabled=!g.detail.editable}};this._dispatchEventFromSandbox(p,d)}),i.addEventListener("input",d=>{const p=l(!0),g=l(!1);t.setValue(e,{value:p}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:u,change:g,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class X_ extends Jn{constructor(t){const{data:e,elements:r}=t;super(t,{isRenderable:Jn._hasPopupData(e)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new pP({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",e.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(r=>`${By}${r}`).join(",")),this.container}}class pP{#t=this.#C.bind(this);#e=this.#T.bind(this);#n=this.#D.bind(this);#r=this.#E.bind(this);#s=null;#i=null;#l=null;#o=null;#f=null;#c=null;#h=null;#u=!1;#d=null;#a=null;#p=null;#m=null;#g=null;#v=null;#_=!1;constructor({container:t,color:e,elements:r,titleObj:i,modificationDate:s,contentsObj:o,richText:l,parent:u,rect:h,parentRect:d,open:p}){this.#i=t,this.#g=i,this.#l=o,this.#m=l,this.#c=u,this.#s=e,this.#p=h,this.#h=d,this.#f=r,this.#o=Uy.toDateObject(s),this.trigger=r.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",this.#r),g.addEventListener("mouseenter",this.#n),g.addEventListener("mouseleave",this.#e),g.classList.add("popupTriggerArea");for(const g of r)g.container?.addEventListener("keydown",this.#t);this.#i.hidden=!0,p&&this.#E()}render(){if(this.#d)return;const t=this.#d=document.createElement("div");if(t.className="popup",this.#s){const s=t.style.outlineColor=be.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");e.className="header";const r=document.createElement("h1");if(e.append(r),{dir:r.dir,str:r.textContent}=this.#g,t.append(e),this.#o){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),e.append(s)}const i=this.#y;if(i)Ky.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#l);t.append(s)}this.#i.append(t)}get#y(){const t=this.#m,e=this.#l;return t?.str&&(!e?.str||e.str===t.str)&&this.#m.html||null}get#x(){return this.#y?.attributes?.style?.fontSize||0}get#w(){return this.#y?.attributes?.style?.color||null}#S(t){const e=[],r={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:this.#w,fontSize:this.#x?`calc(${this.#x}px * var(--total-scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:i});return r}_formatContents({str:t,dir:e}){const r=document.createElement("p");r.classList.add("popupContent"),r.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let s=0,o=i.length;s<o;++s){const l=i[s];r.append(document.createTextNode(l)),s<o-1&&r.append(document.createElement("br"))}return r}#C(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#u)&&this.#E()}updateEdited({rect:t,popupContent:e}){this.#v||={contentsObj:this.#l,richText:this.#m},t&&(this.#a=null),e&&(this.#m=this.#S(e),this.#l=null),this.#d?.remove(),this.#d=null}resetEdited(){this.#v&&({contentsObj:this.#l,richText:this.#m}=this.#v,this.#v=null,this.#d?.remove(),this.#d=null,this.#a=null)}#O(){if(this.#a!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:r,pageX:i,pageY:s}}}=this.#c;let o=!!this.#h,l=o?this.#h:this.#p;for(const y of this.#f)if(!l||be.intersect(y.data.rect,l)!==null){l=y.data.rect,o=!0;break}const u=be.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),d=o?l[2]-l[0]+5:0,p=u[0]+d,g=u[1];this.#a=[100*(p-i)/e,100*(g-s)/r];const{style:v}=this.#i;v.left=`${this.#a[0]}%`,v.top=`${this.#a[1]}%`}#E(){this.#u=!this.#u,this.#u?(this.#D(),this.#i.addEventListener("click",this.#r),this.#i.addEventListener("keydown",this.#t)):(this.#T(),this.#i.removeEventListener("click",this.#r),this.#i.removeEventListener("keydown",this.#t))}#D(){this.#d||this.render(),this.isVisible?this.#u&&this.#i.classList.add("focused"):(this.#O(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#T(){this.#i.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#i.hidden=!0)}maybeShow(){this.#_&&(this.#d||this.#D(),this.#_=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class fC extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Fe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const r=document.createElement("span");r.textContent=e,t.append(r)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class gP extends Jn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:r}=this,i=this.svgFactory.create(e,r,!0),s=this.#t=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class mP extends Jn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:r}=this,i=this.svgFactory.create(e,r,!0),s=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",s/2),o.setAttribute("y",s/2),o.setAttribute("width",e-s),o.setAttribute("height",r-s),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class vP extends Jn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:r}=this,i=this.svgFactory.create(e,r,!0),s=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",e/2),o.setAttribute("cy",r/2),o.setAttribute("rx",e/2-s/2),o.setAttribute("ry",r/2-s/2),o.setAttribute("stroke-width",s||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class hC extends Jn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:r,popupRef:i},width:s,height:o}=this;if(!e)return this.container;const l=this.svgFactory.create(s,o,!0);let u=[];for(let d=0,p=e.length;d<p;d+=2){const g=e[d]-t[0],v=t[3]-e[d+1];u.push(`${g},${v}`)}u=u.join(" ");const h=this.#t=this.svgFactory.createElement(this.svgElementName);return h.setAttribute("points",u),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class _P extends hC{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class yP extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Zy extends Jn{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Fe.HIGHLIGHT:Fe.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:r,borderStyle:i,popupRef:s}}=this,{transform:o,width:l,height:u}=this.#n(e,t),h=this.svgFactory.create(l,u,!0),d=this.#t=this.svgFactory.createElement("svg:g");h.append(d),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let p=0,g=r.length;p<g;p++){const v=this.svgFactory.createElement(this.svgElementName);this.#e.push(v),v.setAttribute("points",r[p].join(",")),d.append(v)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:r,rect:i}=t,s=this.#t;if(e>=0&&s.setAttribute("stroke-width",e||1),r)for(let o=0,l=this.#e.length;o<l;o++)this.#e[o].setAttribute("points",r[o].join(","));if(i){const{transform:o,width:l,height:u}=this.#n(this.data.rotation,i);s.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),s.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class dC extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Fe.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class bP extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class xP extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class EP extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class pC extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Fe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class wP extends Jn{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let r;e.hasAppearance||e.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),r.addEventListener("dblclick",this.#e.bind(this)),this.#t=r;const{isMac:i}=Tr.platform;return t.addEventListener("keydown",s=>{s.key==="Enter"&&(i?s.metaKey:s.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let Qy=class gC{#t=null;#e=null;#n=new Map;#r=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:o,structTreeLayer:l}){this.div=t,this.#t=e,this.#e=r,this.#r=l||null,this.page=s,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#n.size>0}async#s(t,e){const r=t.firstChild||t,i=r.id=`${By}${e}`,s=await this.#r?.getAriaAttributes(i);if(s)for(const[o,l]of s)r.setAttribute(o,l);this.div.append(t),this.#t?.moveElementInDOM(this.div,t,r,!1)}async render(t){const{annotations:e}=t,r=this.div;Cl(r,this.viewport);const i=new Map,s={data:null,layer:r,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Sd,annotationStorage:t.annotationStorage||new $y,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const o of e){if(o.noHTML)continue;const l=o.annotationType===qn.POPUP;if(l){const d=i.get(o.id);if(!d)continue;s.elements=d}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;s.data=o;const u=LA.create(s);if(!u.isRenderable)continue;if(!l&&o.popupRef){const d=i.get(o.popupRef);d?d.push(u):i.set(o.popupRef,[u])}const h=u.render();o.hidden&&(h.style.visibility="hidden"),await this.#s(h,o.id),u._isEditable&&(this.#n.set(u.data.id,u),this._annotationEditorUIManager?.renderAnnotationElement(u))}this.#i()}async addLinkAnnotations(t,e){const r={data:null,layer:this.div,linkService:e,svgFactory:new Sd,parent:this};for(const i of t){i.borderStyle||=gC._defaultBorderStyle,r.data=i;const s=LA.create(r);if(!s.isRenderable)continue;const o=s.render();await this.#s(o,i.id)}}update({viewport:t}){const e=this.div;this.viewport=t,Cl(e,{rotation:t.rotation}),this.#i(),e.hidden=!1}#i(){if(!this.#e)return;const t=this.div;for(const[e,r]of this.#e){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;r.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(r):s.classList.contains("annotationContent")?s.after(r):s.before(r):i.append(r);const o=this.#n.get(e);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,i.id,r),o._hasNoCanvas=!1):o.canvas=r)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}static get _defaultBorderStyle(){return Ye(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Fu.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const eg=/\r\n?|\n/g;class vr extends Ae{#t;#e="";#n=`${this.id}-editor`;#r=null;#s;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=vr.prototype,e=s=>s.isEmpty(),r=Lo.TRANSLATE_SMALL,i=Lo.TRANSLATE_BIG;return Ye(this,"_keyboardManager",new Qd([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}]]))}static _type="freetext";static _editorType=Fe.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||vr._defaultColor||Ae._defaultLineColor,this.#s=t.fontSize||vr._defaultFontSize}static initialize(t,e){Ae.initialize(t,e);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Ke.FREETEXT_SIZE:vr._defaultFontSize=e;break;case Ke.FREETEXT_COLOR:vr._defaultColor=e;break}}updateParams(t,e){switch(t){case Ke.FREETEXT_SIZE:this.#i(e);break;case Ke.FREETEXT_COLOR:this.#l(e);break}}static get defaultPropertiesToUpdate(){return[[Ke.FREETEXT_SIZE,vr._defaultFontSize],[Ke.FREETEXT_COLOR,vr._defaultColor||Ae._defaultLineColor]]}get propertiesToUpdate(){return[[Ke.FREETEXT_SIZE,this.#s],[Ke.FREETEXT_COLOR,this.#t]]}#i(t){const e=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#s)*this.parentScale),this.#s=i,this.#f()},r=this.#s;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(t){const e=i=>{this.#t=this.editorDiv.style.color=i},r=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-vr._internalPadding*t,-(vr._internalPadding+this.#s)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#r=new AbortController;const t=this._uiManager.combinedSignal(this.#r);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#r?.abort(),this.#r=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const r of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(vr.#c(r)),e=r);return t.join(`
`)}#f(){const[t,e]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:i,div:s}=this,o=s.style.display,l=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",i.div.append(this.div),r=s.getBoundingClientRect(),s.remove(),s.style.display=o,s.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/e):(this.width=r.height/t,this.height=r.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const r=i=>{if(this.#e=i,!i){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#f()};this.addCommands({cmd:()=>{r(e)},undo:()=>{r(t)},mustExec:!1}),this.#f()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){vr._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,r.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,s]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[h,d]=this.pageDimensions,[p,g]=this.pageTranslation;let v,y;switch(this.rotation){case 0:v=t+(o[0]-p)/h,y=e+this.height-(o[1]-g)/d;break;case 90:v=t+(o[0]-p)/h,y=e-(o[1]-g)/d,[l,u]=[u,-l];break;case 180:v=t-this.width+(o[0]-p)/h,y=e-(o[1]-g)/d,[l,u]=[-l,-u];break;case 270:v=t+(o[0]-p-this.height*d)/h,y=e+(o[1]-g-this.width*h)/d,[l,u]=[-u,l];break}this.setAt(v*i,y*s,l,u)}else this._moveAfterPaste(t,e);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(eg,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:r}=e;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const i=vr.#d(e.getData("text")||"").replaceAll(eg,`
`);if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const o=s.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:l,startOffset:u}=o,h=[],d=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(d.push(l.nodeValue.slice(u).replaceAll(eg,"")),v!==this.editorDiv){let y=h;for(const _ of this.editorDiv.childNodes){if(_===v){y=d;continue}y.push(vr.#c(_))}}h.push(l.nodeValue.slice(0,u).replaceAll(eg,""))}else if(l===this.editorDiv){let v=h,y=0;for(const _ of this.editorDiv.childNodes)y++===u&&(v=d),v.push(vr.#c(_))}this.#e=`${h.join(`
`)}${i}${d.join(`
`)}`,this.#h();const p=new Range;let g=Math.sumPrecise(h.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const y=v.nodeValue.length;if(g<=y){p.setStart(v,g),p.setEnd(v,g);break}g-=y}s.removeAllRanges(),s.addRange(p)}#h(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(""," ")}static#d(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,r){let i=null;if(t instanceof fC){const{data:{defaultAppearanceData:{fontSize:o,fontColor:l},rect:u,rotation:h,id:d,popupRef:p},textContent:g,textPosition:v,parent:{page:{pageNumber:y}}}=t;if(!g||g.length===0)return null;i=t={annotationType:Fe.FREETEXT,color:Array.from(l),fontSize:o,value:g.join(`
`),position:v,pageIndex:y-1,rect:u.slice(0),rotation:h,id:d,deleted:!1,popupRef:p}}const s=await super.deserialize(t,e,r);return s.#s=t.fontSize,s.#t=be.makeHexColor(...t.color),s.#e=vr.#d(t.value),s.annotationElementId=t.id||null,s._initialData=i,s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=vr._internalPadding*this.parentScale,r=this.getRect(e,e),i=Ae._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),s={annotationType:Fe.FREETEXT,color:i,fontSize:this.#s,value:this.#u(),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(s.isCopy=!0,s):this.annotationElementId&&!this.#a(s)?null:(s.id=this.annotationElementId,s)}#a(t){const{value:e,fontSize:r,color:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==r||t.color.some((o,l)=>o!==i[l])||t.pageIndex!==s}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:r}=e;r.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,r.color=this.#t,e.replaceChildren();for(const s of this.#e.split(`
`)){const o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),e.append(o)}const i=vr._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:this.#e}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class he{static PRECISION=1e-4;toSVGPath(){An("Abstract method `toSVGPath` must be implemented.")}get box(){An("Abstract getter `box` must be implemented.")}serialize(t,e){An("Abstract method `serialize` must be implemented.")}static _rescale(t,e,r,i,s,o){o||=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l+=2)o[l]=e+t[l]*i,o[l+1]=r+t[l+1]*s;return o}static _rescaleAndSwap(t,e,r,i,s,o){o||=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l+=2)o[l]=e+t[l+1]*i,o[l+1]=r+t[l]*s;return o}static _translate(t,e,r,i){i||=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s+=2)i[s]=e+t[s],i[s+1]=r+t[s+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,r,i,s){switch(s){case 90:return[1-e/r,t/i];case 180:return[1-t/r,1-e/i];case 270:return[e/r,1-t/i];default:return[t/r,e/i]}}static _normalizePagePoint(t,e,r){switch(r){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,r,i,s,o){return[(t+5*r)/6,(e+5*i)/6,(5*r+s)/6,(5*i+o)/6,(r+s)/2,(i+o)/2]}}class mc{#t;#e=[];#n;#r;#s=[];#i=new Float32Array(18);#l;#o;#f;#c;#h;#u;#d=[];static#a=8;static#p=2;static#m=mc.#a+mc.#p;constructor({x:t,y:e},r,i,s,o,l=0){this.#t=r,this.#u=s*i,this.#r=o,this.#i.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=l,this.#c=mc.#a*i,this.#f=mc.#m*i,this.#h=i,this.#d.push(t,e)}isEmpty(){return isNaN(this.#i[8])}#g(){const t=this.#i.subarray(4,6),e=this.#i.subarray(16,18),[r,i,s,o]=this.#t;return[(this.#l+(t[0]-e[0])/2-r)/s,(this.#o+(t[1]-e[1])/2-i)/o,(this.#l+(e[0]-t[0])/2-r)/s,(this.#o+(e[1]-t[1])/2-i)/o]}add({x:t,y:e}){this.#l=t,this.#o=e;const[r,i,s,o]=this.#t;let[l,u,h,d]=this.#i.subarray(8,12);const p=t-h,g=e-d,v=Math.hypot(p,g);if(v<this.#f)return!1;const y=v-this.#c,_=y/v,b=_*p,E=_*g;let S=l,T=u;l=h,u=d,h+=b,d+=E,this.#d?.push(t,e);const O=-E/y,R=b/y,N=O*this.#u,C=R*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([h+N,d+C],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([h-N,d-C],16),isNaN(this.#i[6])?(this.#s.length===0&&(this.#i.set([l+N,u+C],2),this.#s.push(NaN,NaN,NaN,NaN,(l+N-r)/s,(u+C-i)/o),this.#i.set([l-N,u-C],14),this.#e.push(NaN,NaN,NaN,NaN,(l-N-r)/s,(u-C-i)/o)),this.#i.set([S,T,l,u,h,d],6),!this.isEmpty()):(this.#i.set([S,T,l,u,h,d],6),Math.abs(Math.atan2(T-u,S-l)-Math.atan2(E,b))<Math.PI/2?([l,u,h,d]=this.#i.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((l+h)/2-r)/s,((u+d)/2-i)/o),[l,u,S,T]=this.#i.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((S+l)/2-r)/s,((T+u)/2-i)/o),!0):([S,T,l,u,h,d]=this.#i.subarray(0,6),this.#s.push(((S+5*l)/6-r)/s,((T+5*u)/6-i)/o,((5*l+h)/6-r)/s,((5*u+d)/6-i)/o,((l+h)/2-r)/s,((u+d)/2-i)/o),[h,d,l,u,S,T]=this.#i.subarray(12,18),this.#e.push(((S+5*l)/6-r)/s,((T+5*u)/6-i)/o,((5*l+h)/6-r)/s,((5*u+d)/6-i)/o,((l+h)/2-r)/s,((u+d)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#v();const r=[];r.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);this.#y(r);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return this.#_(r),r.join(" ")}#v(){const[t,e,r,i]=this.#t,[s,o,l,u]=this.#g();return`M${(this.#i[2]-t)/r} ${(this.#i[3]-e)/i} L${(this.#i[4]-t)/r} ${(this.#i[5]-e)/i} L${s} ${o} L${l} ${u} L${(this.#i[16]-t)/r} ${(this.#i[17]-e)/i} L${(this.#i[14]-t)/r} ${(this.#i[15]-e)/i} Z`}#_(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,r,i,s]=this.#t,o=this.#i.subarray(4,6),l=this.#i.subarray(16,18),[u,h,d,p]=this.#g();t.push(`L${(o[0]-e)/i} ${(o[1]-r)/s} L${u} ${h} L${d} ${p} L${(l[0]-e)/i} ${(l[1]-r)/s}`)}newFreeDrawOutline(t,e,r,i,s,o){return new mC(t,e,r,i,s,o)}getOutlines(){const t=this.#s,e=this.#e,r=this.#i,[i,s,o,l]=this.#t,u=new Float32Array((this.#d?.length??0)+2);for(let p=0,g=u.length-2;p<g;p+=2)u[p]=(this.#d[p]-i)/o,u[p+1]=(this.#d[p+1]-s)/l;if(u[u.length-2]=(this.#l-i)/o,u[u.length-1]=(this.#o-s)/l,isNaN(r[6])&&!this.isEmpty())return this.#x(u);const h=new Float32Array(this.#s.length+24+this.#e.length);let d=t.length;for(let p=0;p<d;p+=2){if(isNaN(t[p])){h[p]=h[p+1]=NaN;continue}h[p]=t[p],h[p+1]=t[p+1]}d=this.#S(h,d);for(let p=e.length-6;p>=6;p-=6)for(let g=0;g<6;g+=2){if(isNaN(e[p+g])){h[d]=h[d+1]=NaN,d+=2;continue}h[d]=e[p+g],h[d+1]=e[p+g+1],d+=2}return this.#w(h,d),this.newFreeDrawOutline(h,u,this.#t,this.#h,this.#n,this.#r)}#x(t){const e=this.#i,[r,i,s,o]=this.#t,[l,u,h,d]=this.#g(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-r)/s,(e[3]-i)/o,NaN,NaN,NaN,NaN,(e[4]-r)/s,(e[5]-i)/o,NaN,NaN,NaN,NaN,l,u,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(e[16]-r)/s,(e[17]-i)/o,NaN,NaN,NaN,NaN,(e[14]-r)/s,(e[15]-i)/o],0),this.newFreeDrawOutline(p,t,this.#t,this.#h,this.#n,this.#r)}#w(t,e){const r=this.#e;return t.set([NaN,NaN,NaN,NaN,r[4],r[5]],e),e+=6}#S(t,e){const r=this.#i.subarray(4,6),i=this.#i.subarray(16,18),[s,o,l,u]=this.#t,[h,d,p,g]=this.#g();return t.set([NaN,NaN,NaN,NaN,(r[0]-s)/l,(r[1]-o)/u,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,p,g,NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-o)/u],e),e+=24}}class mC extends he{#t;#e=new Float32Array(4);#n;#r;#s;#i;#l;constructor(t,e,r,i,s,o){super(),this.#l=t,this.#s=e,this.#t=r,this.#i=i,this.#n=s,this.#r=o,this.lastPoint=[NaN,NaN],this.#o(o);const[l,u,h,d]=this.#e;for(let p=0,g=t.length;p<g;p+=2)t[p]=(t[p]-l)/h,t[p+1]=(t[p+1]-u)/d;for(let p=0,g=e.length;p<g;p+=2)e[p]=(e[p]-l)/h,e[p+1]=(e[p+1]-u)/d}toSVGPath(){const t=[`M${this.#l[4]} ${this.#l[5]}`];for(let e=6,r=this.#l.length;e<r;e+=6){if(isNaN(this.#l[e])){t.push(`L${this.#l[e+4]} ${this.#l[e+5]}`);continue}t.push(`C${this.#l[e]} ${this.#l[e+1]} ${this.#l[e+2]} ${this.#l[e+3]} ${this.#l[e+4]} ${this.#l[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,r,i],s){const o=r-t,l=i-e;let u,h;switch(s){case 0:u=he._rescale(this.#l,t,i,o,-l),h=he._rescale(this.#s,t,i,o,-l);break;case 90:u=he._rescaleAndSwap(this.#l,t,e,o,l),h=he._rescaleAndSwap(this.#s,t,e,o,l);break;case 180:u=he._rescale(this.#l,r,e,-o,l),h=he._rescale(this.#s,r,e,-o,l);break;case 270:u=he._rescaleAndSwap(this.#l,r,i,-o,-l),h=he._rescaleAndSwap(this.#s,r,i,-o,-l);break}return{outline:Array.from(u),points:[Array.from(h)]}}#o(t){const e=this.#l;let r=e[4],i=e[5];const s=[r,i,r,i];let o=r,l=i;const u=t?Math.max:Math.min;for(let d=6,p=e.length;d<p;d+=6){const g=e[d+4],v=e[d+5];if(isNaN(e[d]))be.pointBoundingBox(g,v,s),l<v?(o=g,l=v):l===v&&(o=u(o,g));else{const y=[1/0,1/0,-1/0,-1/0];be.bezierBoundingBox(r,i,...e.slice(d,d+6),y),be.rectBoundingBox(...y,s),l<y[3]?(o=y[2],l=y[3]):l===y[3]&&(o=u(o,y[2]))}r=g,i=v}const h=this.#e;h[0]=s[0]-this.#n,h[1]=s[1]-this.#n,h[2]=s[2]-s[0]+2*this.#n,h[3]=s[3]-s[1]+2*this.#n,this.lastPoint=[o,l]}get box(){return this.#e}newOutliner(t,e,r,i,s,o=0){return new mc(t,e,r,i,s,o)}getNewOutline(t,e){const[r,i,s,o]=this.#e,[l,u,h,d]=this.#t,p=s*h,g=o*d,v=r*h+l,y=i*d+u,_=this.newOutliner({x:this.#s[0]*p+v,y:this.#s[1]*g+y},this.#t,this.#i,t,this.#r,e??this.#n);for(let b=2;b<this.#s.length;b+=2)_.add({x:this.#s[b]*p+v,y:this.#s[b+1]*g+y});return _.getOutlines()}}class Y_{#t;#e;#n=[];#r=[];constructor(t,e=0,r=0,i=!0){const s=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:v,y,width:_,height:b}of t){const E=Math.floor((v-e)/o)*o,S=Math.ceil((v+_+e)/o)*o,T=Math.floor((y-e)/o)*o,O=Math.ceil((y+b+e)/o)*o,R=[E,T,O,!0],N=[S,T,O,!1];this.#n.push(R,N),be.rectBoundingBox(E,T,S,O,s)}const l=s[2]-s[0]+2*r,u=s[3]-s[1]+2*r,h=s[0]-r,d=s[1]-r,p=this.#n.at(i?-1:-2),g=[p[0],p[2]];for(const v of this.#n){const[y,_,b]=v;v[0]=(y-h)/l,v[1]=(_-d)/u,v[2]=(b-d)/u}this.#t=new Float32Array([h,d,l,u]),this.#e=g}getOutlines(){this.#n.sort((e,r)=>e[0]-r[0]||e[1]-r[1]||e[2]-r[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#f(e)),this.#l(e)):(this.#o(e),t.push(...this.#f(e)));return this.#s(t)}#s(t){const e=[],r=new Set;for(const o of t){const[l,u,h]=o;e.push([l,u,o],[l,h,o])}e.sort((o,l)=>o[1]-l[1]||o[0]-l[0]);for(let o=0,l=e.length;o<l;o+=2){const u=e[o][2],h=e[o+1][2];u.push(h),h.push(u),r.add(u),r.add(h)}const i=[];let s;for(;r.size>0;){const o=r.values().next().value;let[l,u,h,d,p]=o;r.delete(o);let g=l,v=u;for(s=[l,h],i.push(s);;){let y;if(r.has(d))y=d;else if(r.has(p))y=p;else break;r.delete(y),[l,u,h,d,p]=y,g!==l&&(s.push(g,v,l,v===u?u:h),g=l),v=v===u?h:u}s.push(g,v)}return new AP(i,this.#t,this.#e)}#i(t){const e=this.#r;let r=0,i=e.length-1;for(;r<=i;){const s=r+i>>1,o=e[s][0];if(o===t)return s;o<t?r=s+1:i=s-1}return i+1}#l([,t,e]){const r=this.#i(t);this.#r.splice(r,0,[t,e])}#o([,t,e]){const r=this.#i(t);for(let i=r;i<this.#r.length;i++){const[s,o]=this.#r[i];if(s!==t)break;if(s===t&&o===e){this.#r.splice(i,1);return}}for(let i=r-1;i>=0;i--){const[s,o]=this.#r[i];if(s!==t)break;if(s===t&&o===e){this.#r.splice(i,1);return}}}#f(t){const[e,r,i]=t,s=[[e,r,i]],o=this.#i(i);for(let l=0;l<o;l++){const[u,h]=this.#r[l];for(let d=0,p=s.length;d<p;d++){const[,g,v]=s[d];if(!(h<=g||v<=u)){if(g>=u){if(v>h)s[d][1]=h;else{if(p===1)return[];s.splice(d,1),d--,p--}continue}s[d][2]=u,v>h&&s.push([e,h,v])}}}return s}}class AP extends he{#t;#e;constructor(t,e,r){super(),this.#e=t,this.#t=e,this.lastPoint=r}toSVGPath(){const t=[];for(const e of this.#e){let[r,i]=e;t.push(`M${r} ${i}`);for(let s=2;s<e.length;s+=2){const o=e[s],l=e[s+1];o===r?(t.push(`V${l}`),i=l):l===i&&(t.push(`H${o}`),r=o)}t.push("Z")}return t.join(" ")}serialize([t,e,r,i],s){const o=[],l=r-t,u=i-e;for(const h of this.#e){const d=new Array(h.length);for(let p=0;p<h.length;p+=2)d[p]=t+h[p]*l,d[p+1]=i-h[p+1]*u;o.push(d)}return o}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class q_ extends mc{newFreeDrawOutline(t,e,r,i,s,o){return new SP(t,e,r,i,s,o)}}class SP extends mC{newOutliner(t,e,r,i,s,o=0){return new q_(t,e,r,i,s,o)}}class es{#t=null;#e=null;#n;#r=null;#s=!1;#i=!1;#l=null;#o;#f=null;#c=null;#h;static#u=null;static get _keyboardManager(){return Ye(this,"_keyboardManager",new Qd([[["Escape","mac+Escape"],es.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],es.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],es.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],es.prototype._moveToPrevious],[["Home","mac+Home"],es.prototype._moveToBeginning],[["End","mac+End"],es.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#i=!1,this.#h=Ke.HIGHLIGHT_COLOR,this.#l=t):(this.#i=!0,this.#h=Ke.HIGHLIGHT_DEFAULT_COLOR),this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",es.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#c._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#p.bind(this),{signal:e});const r=this.#e=document.createElement("span");return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=this.#n,t.append(r),t}renderMainDropdown(){const t=this.#r=this.#d();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#d(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",Fs,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[r,i]of this.#c.highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",es.#u[r]);const o=document.createElement("span");s.append(o),o.className="swatch",o.style.backgroundColor=i,s.setAttribute("aria-selected",i===this.#n),s.addEventListener("click",this.#a.bind(this,i),{signal:e}),t.append(s)}return t.addEventListener("keydown",this.#p.bind(this),{signal:e}),t}#a(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#a(e,t)}_moveToNext(t){if(!this.#v){this.#m(t);return}if(t.target===this.#t){this.#r.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#r?.firstChild||t.target===this.#t){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#v){this.#m(t);return}this.#r.firstChild?.focus()}_moveToEnd(t){if(!this.#v){this.#m(t);return}this.#r.lastChild?.focus()}#p(t){es._keyboardManager.exec(this,t)}#m(t){if(this.#v){this.hideDropdown();return}if(this.#s=t.detail===0,this.#f||(this.#f=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#c.combinedSignal(this.#f)})),this.#r){this.#r.classList.remove("hidden");return}const e=this.#r=this.#d();this.#t.append(e)}#g(t){this.#r?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#r?.classList.add("hidden"),this.#f?.abort(),this.#f=null}get#v(){return this.#r&&!this.#r.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#v){this.#l?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#r)return;const e=this.#c.highlightColors.values();for(const r of this.#r.children)r.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#r?.remove(),this.#r=null}}class Kn extends Ae{#t=null;#e=0;#n;#r=null;#s=null;#i=null;#l=null;#o=0;#f=null;#c=null;#h=null;#u=!1;#d=null;#a;#p=null;#m="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Fe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Kn.prototype;return Ye(this,"_keyboardManager",new Qd([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Kn._defaultColor,this.#g=t.thickness||Kn._defaultThickness,this.#a=t.opacity||Kn._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#m=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#y(t),this.#O()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#l=t.focusNode,this.#o=t.focusOffset,this.#_(),this.#O(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#_(){const t=new Y_(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new Y_(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#i=e.getOutlines();const{lastPoint:r}=this.#i;this.#d=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:r}){this.#c=t;const i=1.5;if(this.#i=t.getNewOutline(this.#g/2+i,.0025),e>=0)this.#h=e,this.#r=r,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const d=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:Kn.#E(this.#c.box,(d-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Kn.#E(this.#i.box,d),path:{d:this.#i.toSVGPath()}})}const[s,o,l,u]=t.box;switch(this.rotation){case 0:this.x=s,this.y=o,this.width=l,this.height=u;break;case 90:{const[d,p]=this.parentDimensions;this.x=o,this.y=1-s,this.width=l*p/d,this.height=u*d/p;break}case 180:this.x=1-s,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[d,p]=this.parentDimensions;this.x=1-o,this.y=s,this.width=l*p/d,this.height=u*d/p;break}}const{lastPoint:h}=this.#i;this.#d=[(h[0]-s)/l,(h[1]-o)/u]}static initialize(t,e){Ae.initialize(t,e),Kn._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Ke.HIGHLIGHT_DEFAULT_COLOR:Kn._defaultColor=e;break;case Ke.HIGHLIGHT_THICKNESS:Kn._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#d}updateParams(t,e){switch(t){case Ke.HIGHLIGHT_COLOR:this.#x(e);break;case Ke.HIGHLIGHT_THICKNESS:this.#w(e);break}}static get defaultPropertiesToUpdate(){return[[Ke.HIGHLIGHT_DEFAULT_COLOR,Kn._defaultColor],[Ke.HIGHLIGHT_THICKNESS,Kn._defaultThickness]]}get propertiesToUpdate(){return[[Ke.HIGHLIGHT_COLOR,this.color||Kn._defaultColor],[Ke.HIGHLIGHT_THICKNESS,this.#g||Kn._defaultThickness],[Ke.HIGHLIGHT_FREE,this.#u]]}#x(t){const e=(s,o)=>{this.color=s,this.#a=o,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:s,"fill-opacity":o}}),this.#s?.updateColor(s)},r=this.color,i=this.#a;this.addCommands({cmd:e.bind(this,t,Kn._defaultOpacity),undo:e.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#w(t){const e=this.#g,r=i=>{this.#g=i,this.#S(i)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#s=new es({editor:this}),t.addColorPicker(this.#s)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#N())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#O(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#O(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#S(t){if(!this.#u)return;this.#y({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,r]=this.parentDimensions;this.setDims(this.width*e,this.height*r)}#C(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#O(t=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#r}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#u),this.#f&&(this.#f.style.clipPath=this.#r))}static#E([t,e,r,i],s){switch(s){case 90:return[1-e-i,t,i,r];case 180:return[1-t-r,1-e-i,r,i];case 270:return[e,1-t-r,i,r]}return[t,e,r,i]}rotate(t){const{drawLayer:e}=this.parent;let r;this.#u?(t=(t-this.rotation+360)%360,r=Kn.#E(this.#c.box,t)):r=Kn.#E([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#h,{bbox:r,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:Kn.#E(this.#i.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#m&&(t.setAttribute("aria-label",this.#m),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#f=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#r;const[r,i]=this.parentDimensions;return this.setDims(this.width*r,this.height*i),$T(this,this.#f,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#D(t){Kn._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#T(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#N(){return this.#u?this.rotation:0}#k(){if(this.#u)return null;const[t,e]=this.pageDimensions,[r,i]=this.pageTranslation,s=this.#n,o=new Float32Array(s.length*8);let l=0;for(const{x:u,y:h,width:d,height:p}of s){const g=u*t+r,v=(1-h)*e+i;o[l]=o[l+4]=g,o[l+1]=o[l+3]=v,o[l+2]=o[l+6]=g+d*t,o[l+5]=o[l+7]=v-p*e,l+=8}return o}#L(t){return this.#c.serialize(t,this.#N())}static startHighlighting(t,e,{target:r,x:i,y:s}){const{x:o,y:l,width:u,height:h}=r.getBoundingClientRect(),d=new AbortController,p=t.combinedSignal(d),g=v=>{d.abort(),this.#A(t,v)};window.addEventListener("blur",g,{signal:p}),window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("pointerdown",Zn,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Fs,{signal:p}),r.addEventListener("pointermove",this.#z.bind(this,t),{signal:p}),this._freeHighlight=new q_({x:i,y:s},[o,l,u,h],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#z(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#A(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,r){let i=null;if(t instanceof dC){const{data:{quadPoints:y,rect:_,rotation:b,id:E,color:S,opacity:T,popupRef:O},parent:{page:{pageNumber:R}}}=t;i=t={annotationType:Fe.HIGHLIGHT,color:Array.from(S),opacity:T,quadPoints:y,boxes:null,pageIndex:R-1,rect:_.slice(0),rotation:b,id:E,deleted:!1,popupRef:O}}else if(t instanceof Zy){const{data:{inkLists:y,rect:_,rotation:b,id:E,color:S,borderStyle:{rawWidth:T},popupRef:O},parent:{page:{pageNumber:R}}}=t;i=t={annotationType:Fe.HIGHLIGHT,color:Array.from(S),thickness:T,inkLists:y,boxes:null,pageIndex:R-1,rect:_.slice(0),rotation:b,id:E,deleted:!1,popupRef:O}}const{color:s,quadPoints:o,inkLists:l,opacity:u}=t,h=await super.deserialize(t,e,r);h.color=be.makeHexColor(...s),h.#a=u||1,l&&(h.#g=t.thickness),h.annotationElementId=t.id||null,h._initialData=i;const[d,p]=h.pageDimensions,[g,v]=h.pageTranslation;if(o){const y=h.#n=[];for(let _=0;_<o.length;_+=8)y.push({x:(o[_]-g)/d,y:1-(o[_+1]-v)/p,width:(o[_+2]-o[_])/d,height:(o[_+1]-o[_+5])/p});h.#_(),h.#O(),h.rotate(h.rotation)}else if(l){h.#u=!0;const y=l[0],_={x:y[0]-g,y:p-(y[1]-v)},b=new q_(_,[0,0,d,p],1,h.#g/2,!0,.001);for(let T=0,O=y.length;T<O;T+=2)_.x=y[T]-g,_.y=p-(y[T+1]-v),b.add(_);const{id:E,clipPathId:S}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:b.toSVGPath()}},!0,!0);h.#y({highlightOutlines:b.getOutlines(),highlightId:E,clipPathId:S}),h.#O(),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),r=Ae._colorManager.convert(this.color),i={annotationType:Fe.HIGHLIGHT,color:r,opacity:this.#a,thickness:this.#g,quadPoints:this.#k(),outlines:this.#L(e),pageIndex:this.pageIndex,rect:e,rotation:this.#N(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#b(i)?null:(i.id=this.annotationElementId,i)}#b(t){const{color:e}=this._initialData;return t.color.some((r,i)=>r!==e[i])}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class vC{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,r]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,r)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){An("Not implemented")}}class Oe extends Ae{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#r=null;static#s=null;static#i=NaN;static#l=null;static#o=null;static#f=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#d())}#c({drawOutlines:t,drawId:e,drawingOptions:r}){this.#t=t,this._drawingOptions||=r,e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#h(t,this.parent),this.#m(t.box)}#h(t,e){const{id:r}=e.drawLayer.draw(Oe._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r}static _mergeSVGProperties(t,e){const r=new Set(Object.keys(t));for(const[i,s]of Object.entries(e))r.has(i)?Object.assign(t[i],s):t[i]=s;return t}static getDefaultDrawingOptions(t){An("Not implemented")}static get typesMap(){An("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,e),this._currentParent&&(Oe.#n.updateProperty(r,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[r,i]of this.typesMap)t.push([r,e[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[r,i]of this.constructor.typesMap)t.push([r,e[i]]);return t}_updateProperty(t,e,r){const i=this._drawingOptions,s=i[e],o=l=>{i.updateProperty(e,l);const u=this.#t.updateProperty(e,l);u&&this.#m(u),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:o.bind(this,r),undo:o.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#d(),this.#m(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#d(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#d(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#t,t)}}#a([t,e,r,i]){const{parentDimensions:[s,o],rotation:l}=this;switch(l){case 90:return[e,1-t,r*(o/s),i*(s/o)];case 180:return[1-t,1-e,r,i];case 270:return[1-e,t,r*(o/s),i*(s/o)];default:return[t,e,r,i]}}#p(){const{x:t,y:e,width:r,height:i,parentDimensions:[s,o],rotation:l}=this;switch(l){case 90:return[1-e,t,r*(s/o),i*(o/s)];case 180:return[1-t,1-e,r,i];case 270:return[e,1-t,r*(s/o),i*(o/s)];default:return[t,e,r,i]}}#m(t){if([this.x,this.y,this.width,this.height]=this.#a(t),this.div){this.fixAndSetPosition();const[e,r]=this.parentDimensions;this.setDims(this.width*e,this.height*r)}this._onResized()}#g(){const{x:t,y:e,width:r,height:i,rotation:s,parentRotation:o,parentDimensions:[l,u]}=this;switch((s*4+o)/90){case 1:return[1-e-i,t,i,r];case 2:return[1-t-r,1-e-i,r,i];case 3:return[e,1-t-r,i,r];case 4:return[t,e-r*(l/u),i*(u/l),r*(l/u)];case 5:return[1-e,t,r*(l/u),i*(u/l)];case 6:return[1-t-i*(u/l),1-e,i*(u/l),r*(l/u)];case 7:return[e-r*(l/u),1-t-i*(u/l),r*(l/u),i*(u/l)];case 8:return[t-r,e-i,r,i];case 9:return[1-e,t-r,i,r];case 10:return[1-t,1-e,r,i];case 11:return[e-i,1-t,i,r];case 12:return[t-i*(u/l),e,i*(u/l),r*(l/u)];case 13:return[1-e-r*(l/u),t-i*(u/l),r*(l/u),i*(u/l)];case 14:return[1-t,1-e-r*(l/u),i*(u/l),r*(l/u)];case 15:return[e,1-t,r*(l/u),i*(u/l)];default:return[t,e,r,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#m(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const r=super.render();r.classList.add("draw");const i=document.createElement("div");r.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,o]=this.parentDimensions;return this.setDims(this.width*s,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),r}static createDrawerInstance(t,e,r,i,s){An("Not implemented")}static startDrawing(t,e,r,i){const{target:s,offsetX:o,offsetY:l,pointerId:u,pointerType:h}=i;if(Oe.#l&&Oe.#l!==h)return;const{viewport:{rotation:d}}=t,{width:p,height:g}=s.getBoundingClientRect(),v=Oe.#r=new AbortController,y=t.combinedSignal(v);if(Oe.#i||=u,Oe.#l??=h,window.addEventListener("pointerup",_=>{Oe.#i===_.pointerId?this._endDraw(_):Oe.#o?.delete(_.pointerId)},{signal:y}),window.addEventListener("pointercancel",_=>{Oe.#i===_.pointerId?this._currentParent.endDrawingSession():Oe.#o?.delete(_.pointerId)},{signal:y}),window.addEventListener("pointerdown",_=>{Oe.#l===_.pointerType&&((Oe.#o||=new Set).add(_.pointerId),Oe.#n.isCancellable()&&(Oe.#n.removeLastElement(),Oe.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Fs,{signal:y}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),s.addEventListener("touchmove",_=>{_.timeStamp===Oe.#f&&Zn(_)},{signal:y}),t.toggleDrawing(),e._editorUndoBar?.hide(),Oe.#n){t.drawLayer.updateProperties(this._currentDrawId,Oe.#n.startNew(o,l,p,g,d));return}e.updateUIForDefaultProperties(this),Oe.#n=this.createDrawerInstance(o,l,p,g,d),Oe.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Oe.#s.toSVGProperties(),Oe.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Oe.#f=-1,!Oe.#n)return;const{offsetX:e,offsetY:r,pointerId:i}=t;if(Oe.#i===i){if(Oe.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Oe.#n.add(e,r)),Oe.#f=t.timeStamp,Zn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Oe.#n=null,Oe.#s=null,Oe.#l=null,Oe.#f=NaN),Oe.#r&&(Oe.#r.abort(),Oe.#r=null,Oe.#i=NaN,Oe.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Oe.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=Oe.#n,i=this._currentDrawId,s=r.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(i,r.setLastElement(s))},undo:()=>{e.drawLayer.updateProperties(i,r.removeLastElement())},mustExec:!1,type:Ke.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Ke.DRAW_STEP),!Oe.#n.isEmpty()){const{pageDimensions:[r,i],scale:s}=e,o=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Oe.#n.getOutlines(r*s,i*s,s,this._INNER_MARGIN),drawingOptions:Oe.#s,mustBeCommitted:!t});return this._cleanup(!0),o}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,r,i,s,o){An("Not implemented")}static async deserialize(t,e,r){const{rawDims:{pageWidth:i,pageHeight:s,pageX:o,pageY:l}}=e.viewport,u=this.deserializeDraw(o,l,i,s,this._INNER_MARGIN,t),h=await super.deserialize(t,e,r);return h.createDrawingOptions(t),h.#c({drawOutlines:u}),h.#d(),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[e,r]=this.pageTranslation,[i,s]=this.pageDimensions;return this.#t.serialize([e,r,i,s],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class TP{#t=new Float64Array(6);#e;#n;#r;#s;#i;#l="";#o=0;#f=new n0;#c;#h;constructor(t,e,r,i,s,o){this.#c=r,this.#h=i,this.#r=s,this.#s=o,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#i=[t,e],this.#n=[{line:l,points:this.#i}],this.#t.set(l,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#u(t,e){return he._normalizePoint(t,e,this.#c,this.#h,this.#r)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#i.length<=10}add(t,e){[t,e]=this.#u(t,e);const[r,i,s,o]=this.#t.subarray(2,6),l=t-s,u=e-o;return Math.hypot(this.#c*l,this.#h*u)<=2?null:(this.#i.push(t,e),isNaN(r)?(this.#t.set([s,o,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([r,i,s,o,t,e],0),this.#e.push(...he.createBezierPoints(r,i,s,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const r=this.add(t,e);return r||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,r,i,s){this.#c=r,this.#h=i,this.#r=s,[t,e]=this.#u(t,e);const o=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#i=[t,e];const l=this.#n.at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),this.#n.push({line:o,points:this.#i}),this.#t.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#i=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#f.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#f.removeLastElement();this.#n.pop(),this.#l="";for(let t=0,e=this.#n.length;t<e;t++){const{line:r,points:i}=this.#n[t];this.#e=r,this.#i=i,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const t=he.svgRound(this.#e[4]),e=he.svgRound(this.#e[5]);if(this.#i.length===2)return this.#l=`${this.#l} M ${t} ${e} Z`,this.#l;if(this.#i.length<=6){const i=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,i)} M ${t} ${e}`,this.#o=6}if(this.#i.length===4){const i=he.svgRound(this.#e[10]),s=he.svgRound(this.#e[11]);return this.#l=`${this.#l} L ${i} ${s}`,this.#o=12,this.#l}const r=[];this.#o===0&&(r.push(`M ${t} ${e}`),this.#o=6);for(let i=this.#o,s=this.#e.length;i<s;i+=6){const[o,l,u,h,d,p]=this.#e.slice(i,i+6).map(he.svgRound);r.push(`C${o} ${l} ${u} ${h} ${d} ${p}`)}return this.#l+=r.join(" "),this.#o=this.#e.length,this.#l}getOutlines(t,e,r,i){const s=this.#n.at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),this.#f.build(this.#n,t,e,r,this.#r,this.#s,i),this.#t=null,this.#e=null,this.#n=null,this.#l=null,this.#f}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class n0 extends he{#t;#e=0;#n;#r;#s;#i;#l;#o;#f;build(t,e,r,i,s,o,l){this.#s=e,this.#i=r,this.#l=i,this.#o=s,this.#f=o,this.#n=l??0,this.#r=t,this.#u()}get thickness(){return this.#f}setLastElement(t){return this.#r.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#r.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#r){if(t.push(`M${he.svgRound(e[4])} ${he.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${he.svgRound(e[10])} ${he.svgRound(e[11])}`);continue}for(let r=6,i=e.length;r<i;r+=6){const[s,o,l,u,h,d]=e.subarray(r,r+6).map(he.svgRound);t.push(`C${s} ${o} ${l} ${u} ${h} ${d}`)}}return t.join("")}serialize([t,e,r,i],s){const o=[],l=[],[u,h,d,p]=this.#h();let g,v,y,_,b,E,S,T,O;switch(this.#o){case 0:O=he._rescale,g=t,v=e+i,y=r,_=-i,b=t+u*r,E=e+(1-h-p)*i,S=t+(u+d)*r,T=e+(1-h)*i;break;case 90:O=he._rescaleAndSwap,g=t,v=e,y=r,_=i,b=t+h*r,E=e+u*i,S=t+(h+p)*r,T=e+(u+d)*i;break;case 180:O=he._rescale,g=t+r,v=e,y=-r,_=i,b=t+(1-u-d)*r,E=e+h*i,S=t+(1-u)*r,T=e+(h+p)*i;break;case 270:O=he._rescaleAndSwap,g=t+r,v=e+i,y=-r,_=-i,b=t+(1-h-p)*r,E=e+(1-u-d)*i,S=t+(1-h)*r,T=e+(1-u)*i;break}for(const{line:R,points:N}of this.#r)o.push(O(R,g,v,y,_,s?new Array(R.length):null)),l.push(O(N,g,v,y,_,s?new Array(N.length):null));return{lines:o,points:l,rect:[b,E,S,T]}}static deserialize(t,e,r,i,s,{paths:{lines:o,points:l},rotation:u,thickness:h}){const d=[];let p,g,v,y,_;switch(u){case 0:_=he._rescale,p=-t/r,g=e/i+1,v=1/r,y=-1/i;break;case 90:_=he._rescaleAndSwap,p=-e/i,g=-t/r,v=1/i,y=1/r;break;case 180:_=he._rescale,p=t/r+1,g=-e/i,v=-1/r,y=1/i;break;case 270:_=he._rescaleAndSwap,p=e/i+1,g=t/r+1,v=-1/i,y=-1/r;break}if(!o){o=[];for(const E of l){const S=E.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const T=new Float32Array(3*(S-2));o.push(T);let[O,R,N,C]=E.subarray(0,4);T.set([NaN,NaN,NaN,NaN,O,R],0);for(let I=4;I<S;I+=2){const M=E[I],F=E[I+1];T.set(he.createBezierPoints(O,R,N,C,M,F),(I-2)*3),[O,R,N,C]=[N,C,M,F]}}}for(let E=0,S=o.length;E<S;E++)d.push({line:_(o[E].map(T=>T??NaN),p,g,v,y),points:_(l[E].map(T=>T??NaN),p,g,v,y)});const b=new this.prototype.constructor;return b.build(d,r,i,1,u,h,s),b}#c(t=this.#f){const e=this.#n+t/2*this.#l;return this.#o%180===0?[e/this.#s,e/this.#i]:[e/this.#i,e/this.#s]}#h(){const[t,e,r,i]=this.#t,[s,o]=this.#c(0);return[t+s,e+o,r-2*s,i-2*o]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#r){if(i.length<=12){for(let l=4,u=i.length;l<u;l+=6)be.pointBoundingBox(i[l],i[l+1],t);continue}let s=i[4],o=i[5];for(let l=6,u=i.length;l<u;l+=6){const[h,d,p,g,v,y]=i.subarray(l,l+6);be.bezierBoundingBox(s,o,h,d,p,g,v,y,t),s=v,o=y}}const[e,r]=this.#c();t[0]=Kr(t[0]-e,0,1),t[1]=Kr(t[1]-r,0,1),t[2]=Kr(t[2]+e,0,1),t[3]=Kr(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#d(e):null}#d(t){const[e,r]=this.#c();this.#f=t;const[i,s]=this.#c(),[o,l]=[i-e,s-r],u=this.#t;return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u}updateParentDimensions([t,e],r){const[i,s]=this.#c();this.#s=t,this.#i=e,this.#l=r;const[o,l]=this.#c(),u=o-i,h=l-s,d=this.#t;return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(he.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${he.svgRound(t)} ${he.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let r=0,i=0,s=0,o=0,l=0,u=0;switch(this.#e){case 90:i=e/t,s=-t/e,l=t;break;case 180:r=-1,o=-1,l=t,u=e;break;case 270:i=-e/t,s=t/e,u=e;break;default:return""}return`matrix(${r} ${i} ${s} ${o} ${he.svgRound(l)} ${he.svgRound(u)})`}getPathResizingSVGProperties([t,e,r,i]){const[s,o]=this.#c(),[l,u,h,d]=this.#t;if(Math.abs(h-s)<=he.PRECISION||Math.abs(d-o)<=he.PRECISION){const _=t+r/2-(l+h/2),b=e+i/2-(u+d/2);return{path:{"transform-origin":`${he.svgRound(t)} ${he.svgRound(e)}`,transform:`${this.rotationTransform} translate(${_} ${b})`}}}const p=(r-2*s)/(h-2*s),g=(i-2*o)/(d-2*o),v=h/r,y=d/i;return{path:{"transform-origin":`${he.svgRound(l)} ${he.svgRound(u)}`,transform:`${this.rotationTransform} scale(${v} ${y}) translate(${he.svgRound(s)} ${he.svgRound(o)}) scale(${p} ${g}) translate(${he.svgRound(-s)} ${he.svgRound(-o)})`}}}getPathResizedSVGProperties([t,e,r,i]){const[s,o]=this.#c(),l=this.#t,[u,h,d,p]=l;if(l[0]=t,l[1]=e,l[2]=r,l[3]=i,Math.abs(d-s)<=he.PRECISION||Math.abs(p-o)<=he.PRECISION){const b=t+r/2-(u+d/2),E=e+i/2-(h+p/2);for(const{line:S,points:T}of this.#r)he._translate(S,b,E,S),he._translate(T,b,E,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${he.svgRound(t)} ${he.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(r-2*s)/(d-2*s),v=(i-2*o)/(p-2*o),y=-g*(u+s)+t+s,_=-v*(h+o)+e+o;if(g!==1||v!==1||y!==0||_!==0)for(const{line:b,points:E}of this.#r)he._rescale(b,y,_,g,v,b),he._rescale(E,y,_,g,v,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${he.svgRound(t)} ${he.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],r){const[i,s]=r,o=this.#t,l=t-o[0],u=e-o[1];if(this.#s===i&&this.#i===s)for(const{line:h,points:d}of this.#r)he._translate(h,l,u,h),he._translate(d,l,u,d);else{const h=this.#s/i,d=this.#i/s;this.#s=i,this.#i=s;for(const{line:p,points:g}of this.#r)he._rescale(p,l,u,h,d,p),he._rescale(g,l,u,h,d,g);o[2]*=h,o[3]*=d}return o[0]=t,o[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${he.svgRound(t)} ${he.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${he.svgRound(t[0])} ${he.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class km extends vC{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Ae._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new km(this._viewParameters);return t.updateAll(this),t}}class Jy extends Oe{static _type="ink";static _editorType=Fe.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Ae.initialize(t,e),this._defaultDrawingOptions=new km(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ye(this,"typesMap",new Map([[Ke.INK_THICKNESS,"stroke-width"],[Ke.INK_COLOR,"stroke"],[Ke.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,r,i,s){return new TP(t,e,r,i,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,r,i,s,o){return n0.deserialize(t,e,r,i,s,o)}static async deserialize(t,e,r){let i=null;if(t instanceof Zy){const{data:{inkLists:o,rect:l,rotation:u,id:h,color:d,opacity:p,borderStyle:{rawWidth:g},popupRef:v},parent:{page:{pageNumber:y}}}=t;i=t={annotationType:Fe.INK,color:Array.from(d),thickness:g,opacity:p,paths:{points:o},boxes:null,pageIndex:y-1,rect:l.slice(0),rotation:u,id:h,deleted:!1,popupRef:v}}const s=await super.deserialize(t,e,r);return s.annotationElementId=t.id||null,s._initialData=i,s}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:r}=this;e.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:r}){this._drawingOptions=Jy.getDefaultDrawingOptions({stroke:be.makeHexColor(...t),"stroke-width":e,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:r,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":l}}=this,u={annotationType:Fe.INK,color:Ae._colorManager.convert(s),opacity:o,thickness:l,paths:{lines:e,points:r},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:r,opacity:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==e[l])||t.thickness!==r||t.opacity!==i||t.pageIndex!==s}renderAnnotationElement(t){const{points:e,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:e}),null}}class K_ extends n0{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const ng=8,Zh=3;class hc{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,r,i){return r-=t,i-=e,r===0?i>0?0:4:r===1?i+6:2-i}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#r(t,e,r,i,s,o,l){const u=this.#e(r,i,s,o);for(let h=0;h<8;h++){const d=(-h+u-l+16)%8,p=this.#n[2*d],g=this.#n[2*d+1];if(t[(r+p)*e+(i+g)]!==0)return d}return-1}static#s(t,e,r,i,s,o,l){const u=this.#e(r,i,s,o);for(let h=0;h<8;h++){const d=(h+u+l+16)%8,p=this.#n[2*d],g=this.#n[2*d+1];if(t[(r+p)*e+(i+g)]!==0)return d}return-1}static#i(t,e,r,i){const s=t.length,o=new Int32Array(s);for(let d=0;d<s;d++)o[d]=t[d]<=i?1:0;for(let d=1;d<r-1;d++)o[d*e]=o[d*e+e-1]=0;for(let d=0;d<e;d++)o[d]=o[e*r-1-d]=0;let l=1,u;const h=[];for(let d=1;d<r-1;d++){u=1;for(let p=1;p<e-1;p++){const g=d*e+p,v=o[g];if(v===0)continue;let y=d,_=p;if(v===1&&o[g-1]===0)l+=1,_-=1;else if(v>=1&&o[g+1]===0)l+=1,_+=1,v>1&&(u=v);else{v!==1&&(u=Math.abs(v));continue}const b=[p,d],E=_===p+1,S={isHole:E,points:b,id:l,parent:0};h.push(S);let T;for(const H of h)if(H.id===u){T=H;break}T?T.isHole?S.parent=E?T.parent:u:S.parent=E?u:T.parent:S.parent=E?u:0;const O=this.#r(o,e,d,p,y,_,0);if(O===-1){o[g]=-l,o[g]!==1&&(u=Math.abs(o[g]));continue}let R=this.#n[2*O],N=this.#n[2*O+1];const C=d+R,I=p+N;y=C,_=I;let M=d,F=p;for(;;){const H=this.#s(o,e,M,F,y,_,1);R=this.#n[2*H],N=this.#n[2*H+1];const P=M+R,et=F+N;b.push(et,P);const L=M*e+F;if(o[L+1]===0?o[L]=-l:o[L]===1&&(o[L]=l),P===d&&et===p&&M===C&&F===I){o[g]!==1&&(u=Math.abs(o[g]));break}else y=M,_=F,M=P,F=et}}}return h}static#l(t,e,r,i){if(r-e<=4){for(let C=e;C<r-2;C+=2)i.push(t[C],t[C+1]);return}const s=t[e],o=t[e+1],l=t[r-4]-s,u=t[r-3]-o,h=Math.hypot(l,u),d=l/h,p=u/h,g=d*o-p*s,v=u/l,y=1/h,_=Math.atan(v),b=Math.cos(_),E=Math.sin(_),S=y*(Math.abs(b)+Math.abs(E)),T=y*(1-S+S**2),O=Math.max(Math.atan(Math.abs(E+b)*T),Math.atan(Math.abs(E-b)*T));let R=0,N=e;for(let C=e+2;C<r-2;C+=2){const I=Math.abs(g-d*t[C+1]+p*t[C]);I>R&&(N=C,R=I)}R>(h*O)**2?(this.#l(t,e,N+2,i),this.#l(t,N,r,i)):i.push(s,o)}static#o(t){const e=[],r=t.length;return this.#l(t,0,r,e),e.push(t[r-2],t[r-1]),e.length<=4?null:e}static#f(t,e,r,i,s,o){const l=new Float32Array(o**2),u=-2*i**2,h=o>>1;for(let _=0;_<o;_++){const b=(_-h)**2;for(let E=0;E<o;E++)l[_*o+E]=Math.exp((b+(E-h)**2)/u)}const d=new Float32Array(256),p=-2*s**2;for(let _=0;_<256;_++)d[_]=Math.exp(_**2/p);const g=t.length,v=new Uint8Array(g),y=new Uint32Array(256);for(let _=0;_<r;_++)for(let b=0;b<e;b++){const E=_*e+b,S=t[E];let T=0,O=0;for(let N=0;N<o;N++){const C=_+N-h;if(!(C<0||C>=r))for(let I=0;I<o;I++){const M=b+I-h;if(M<0||M>=e)continue;const F=t[C*e+M],H=l[N*o+I]*d[Math.abs(F-S)];T+=F*H,O+=H}}const R=v[E]=Math.round(T/O);y[R]++}return[v,y]}static#c(t){const e=new Uint32Array(256);for(const r of t)e[r]++;return e}static#h(t){const e=t.length,r=new Uint8ClampedArray(e>>2);let i=-1/0,s=1/0;for(let l=0,u=r.length;l<u;l++){if(t[(l<<2)+3]===0){i=r[l]=255;continue}const d=r[l]=t[l<<2];d>i&&(i=d),d<s&&(s=d)}const o=255/(i-s);for(let l=0;l<e;l++)r[l]=(r[l]-s)*o;return r}static#u(t){let e,r=-1/0,i=-1/0;const s=t.findIndex(u=>u!==0);let o=s,l=s;for(e=s;e<256;e++){const u=t[e];u>r&&(e-o>i&&(i=e-o,l=e-1),r=u,o=e)}for(e=l-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#d(t){const e=t,{width:r,height:i}=t,{maxDim:s}=this.#t;let o=r,l=i;if(r>s||i>s){let g=r,v=i,y=Math.log2(Math.max(r,i)/s);const _=Math.floor(y);y=y===_?_-1:_;for(let E=0;E<y;E++){o=Math.ceil(g/2),l=Math.ceil(v/2);const S=new OffscreenCanvas(o,l);S.getContext("2d").drawImage(t,0,0,g,v,0,0,o,l),g=o,v=l,t!==e&&t.close(),t=S.transferToImageBitmap()}const b=Math.min(s/o,s/l);o=Math.round(o*b),l=Math.round(l*b)}const h=new OffscreenCanvas(o,l).getContext("2d",{willReadFrequently:!0});h.filter="grayscale(1)",h.drawImage(t,0,0,t.width,t.height,0,0,o,l);const d=h.getImageData(0,0,o,l).data;return[this.#h(d),o,l]}static extractContoursFromText(t,{fontFamily:e,fontStyle:r,fontWeight:i},s,o,l,u){let h=new OffscreenCanvas(1,1),d=h.getContext("2d",{alpha:!1});const p=200,g=d.font=`${r} ${i} ${p}px ${e}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:y,actualBoundingBoxAscent:_,actualBoundingBoxDescent:b,fontBoundingBoxAscent:E,fontBoundingBoxDescent:S,width:T}=d.measureText(t),O=1.5,R=Math.ceil(Math.max(Math.abs(v)+Math.abs(y)||0,T)*O),N=Math.ceil(Math.max(Math.abs(_)+Math.abs(b)||p,Math.abs(E)+Math.abs(S)||p)*O);h=new OffscreenCanvas(R,N),d=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=g,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,R,N),d.fillStyle="black",d.fillText(t,R*(O-1)/2,N*(3-O)/2);const C=this.#h(d.getImageData(0,0,R,N).data),I=this.#c(C),M=this.#u(I),F=this.#i(C,R,N,M);return this.processDrawnLines({lines:{curves:F,width:R,height:N},pageWidth:s,pageHeight:o,rotation:l,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(t,e,r,i,s){const[o,l,u]=this.#d(t),[h,d]=this.#f(o,l,u,Math.hypot(l,u)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#u(d),g=this.#i(h,l,u,p);return this.processDrawnLines({lines:{curves:g,width:l,height:u},pageWidth:e,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:o,areContours:l}){i%180!==0&&([e,r]=[r,e]);const{curves:u,width:h,height:d}=t,p=t.thickness??0,g=[],v=Math.min(e/h,r/d),y=v/e,_=v/r,b=[];for(const{points:S}of u){const T=o?this.#o(S):S;if(!T)continue;b.push(T);const O=T.length,R=new Float32Array(O),N=new Float32Array(3*(O===2?2:O-2));if(g.push({line:N,points:R}),O===2){R[0]=T[0]*y,R[1]=T[1]*_,N.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[C,I,M,F]=T;C*=y,I*=_,M*=y,F*=_,R.set([C,I,M,F],0),N.set([NaN,NaN,NaN,NaN,C,I],0);for(let H=4;H<O;H+=2){const P=R[H]=T[H]*y,et=R[H+1]=T[H+1]*_;N.set(he.createBezierPoints(C,I,M,F,P,et),(H-2)*3),[C,I,M,F]=[M,F,P,et]}}if(g.length===0)return null;const E=l?new K_:new n0;return E.build(g,e,r,1,i,l?0:p,s),{outline:E,newCurves:b,areContours:l,thickness:p,width:h,height:d}}static async compressSignature({outlines:t,areContours:e,thickness:r,width:i,height:s}){let o=1/0,l=-1/0,u=0;for(const T of t){u+=T.length;for(let O=2,R=T.length;O<R;O++){const N=T[O]-T[O-2];o=Math.min(o,N),l=Math.max(l,N)}}let h;o>=-128&&l<=127?h=Int8Array:o>=-32768&&l<=32767?h=Int16Array:h=Int32Array;const d=t.length,p=ng+Zh*d,g=new Uint32Array(p);let v=0;g[v++]=p*Uint32Array.BYTES_PER_ELEMENT+(u-2*d)*h.BYTES_PER_ELEMENT,g[v++]=0,g[v++]=i,g[v++]=s,g[v++]=e?0:1,g[v++]=Math.max(0,Math.floor(r??0)),g[v++]=d,g[v++]=h.BYTES_PER_ELEMENT;for(const T of t)g[v++]=T.length-2,g[v++]=T[0],g[v++]=T[1];const y=new CompressionStream("deflate-raw"),_=y.writable.getWriter();await _.ready,_.write(g);const b=h.prototype.constructor;for(const T of t){const O=new b(T.length-2);for(let R=2,N=T.length;R<N;R++)O[R-2]=T[R]-T[R-2];_.write(O)}_.close();const E=await new Response(y.readable).arrayBuffer(),S=new Uint8Array(E);return UT(S)}static async decompressSignature(t){try{const e=nI(t),{readable:r,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(e).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let o=null,l=0;for await(const T of r)o||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),o.set(T,l),l+=T.length;const u=new Uint32Array(o.buffer,0,o.length>>2),h=u[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const d=u[2],p=u[3],g=u[4]===0,v=u[5],y=u[6],_=u[7],b=[],E=(ng+Zh*y)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(_){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(o.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(o.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(o.buffer,E);break}l=0;for(let T=0;T<y;T++){const O=u[Zh*T+ng],R=new Float32Array(O+2);b.push(R);for(let N=0;N<Zh-1;N++)R[N]=u[Zh*T+ng+N+1];for(let N=0;N<O;N++)R[N+2]=R[N]+S[l++]}return{areContours:g,thickness:v,outlines:b,width:d,height:p}}catch(e){return Ue(`decompressSignature: ${e}`),null}}}class tb extends vC{constructor(){super(),super.updateProperties({fill:Ae._defaultLineColor,"stroke-width":0})}clone(){const t=new tb;return t.updateAll(this),t}}class eb extends km{constructor(t){super(t),super.updateProperties({stroke:Ae._defaultLineColor,"stroke-width":1})}clone(){const t=new eb(this._viewParameters);return t.updateAll(this),t}}class Na extends Oe{#t=!1;#e=null;#n=null;#r=null;static _type="signature";static _editorType=Fe.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Ae.initialize(t,e),this._defaultDrawingOptions=new tb,this._defaultDrawnSignatureOptions=new eb(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ye(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:i,mustSmooth:s,areContours:o,description:l,uuid:u,heightInPage:h}=this.#n,{rawDims:{pageWidth:d,pageHeight:p},rotation:g}=this.parent.viewport,v=hc.processDrawnLines({lines:i,pageWidth:d,pageHeight:p,rotation:g,innerMargin:Na._INNER_MARGIN,mustSmooth:s,areContours:o});this.addSignature(v,h,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return r&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#r=t,this.addEditToolbar()}getUuid(){return this.#r}get description(){return this.#e}set description(t){this.#e=t,super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:r,width:i,height:s}=this.#n,o=Math.max(i,s),l=hc.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:r,width:i,height:s},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:l.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&this.#e!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,this.#r,this.#e),t.show()),t):null}addSignature(t,e,r,i){const{x:s,y:o}=this,{outline:l}=this.#n=t;this.#t=l instanceof K_,this.#e=r,this.div.setAttribute("data-l10n-args",JSON.stringify({description:r}));let u;this.#t?u=Na.getDefaultDrawingOptions():(u=Na._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[h,d]=this.parentDimensions,[,p]=this.pageDimensions;let g=e/p;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(h*this.width,d*this.height),this.x=s,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:r},rotation:i}=this.parent.viewport;return hc.process(t,e,r,i,Na._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return hc.extractContoursFromText(t,e,r,i,s,Na._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:r},rotation:i}=this.parent.viewport;return hc.processDrawnLines({lines:t,pageWidth:e,pageHeight:r,rotation:i,innerMargin:Na._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Na.getDefaultDrawingOptions():(this._drawingOptions=Na._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:r,rect:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,o={annotationType:Fe.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.paths={lines:e,points:r},o.uuid=this.#r,o.isCopy=!0):o.lines=e,this.#e&&(o.accessibilityData={type:"Figure",alt:this.#e}),o}static deserializeDraw(t,e,r,i,s,o){return o.areContours?K_.deserialize(t,e,r,i,s,o):n0.deserialize(t,e,r,i,s,o)}static async deserialize(t,e,r){const i=await super.deserialize(t,e,r);return i.#t=t.areContours,i.#e=t.accessibilityData?.alt||"",i.#r=t.uuid,i}}class CP extends Ae{#t=null;#e=null;#n=null;#r=null;#s=null;#i="";#l=null;#o=!1;#f=null;#c=!1;#h=!1;static _type="stamp";static _editorType=Fe.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#r=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Ae.initialize(t,e)}static isHandlingMimeForPasting(t){return zg.includes(t)}static paste(t,e){e.pasteEditor({mode:Fe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#i=t.file.name),this.#p()}#d(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await r.guess({name:"altText",request:{data:i,width:s,height:o,channels:i.length/(s*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),e&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}#a(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(r=>this.#u(r,!0)).finally(()=>this.#d());return}if(this.#r){const r=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(r).then(i=>this.#u(i)).finally(()=>this.#d());return}if(this.#s){const r=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(r).then(i=>this.#u(i)).finally(()=>this.#d());return}const t=document.createElement("input");t.type="file",t.accept=zg.join(",");const e=this._uiManager._signal;this.#n=new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(i)}r()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:e})}).finally(()=>this.#d()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#l?.remove(),this.#l=null,this.#f&&(clearTimeout(this.#f),this.#f=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#a();return}super.rebuild(),this.div!==null&&(this.#e&&this.#l===null&&this.#a(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#r||this.#s||this.#e||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#o||(this.#t?this.#p():this.#a()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:r,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(this.#e=r,i&&(this.#t=i),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#f!==null&&clearTimeout(this.#f);const t=200;this.#f=setTimeout(()=>{this.#f=null,this.#g()},t)}#p(){const{div:t}=this;let{width:e,height:r}=this.#t;const[i,s]=this.pageDimensions,o=.75;if(this.width)e=this.width*i,r=this.height*s;else if(e>o*i||r>o*s){const d=Math.min(o*i/e,o*s/r);e*=d,r*=d}const[l,u]=this.parentDimensions;this.setDims(e*l/i,r*u/s),this._uiManager.enableWaiting(!1);const h=this.#l=document.createElement("canvas");h.setAttribute("role","img"),this.addContainer(h),this.width=e/i,this.height=r/s,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#g(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&this.div.setAttribute("aria-description",this.#i)}copyCanvas(t,e,r=!1){t||(t=224);const{width:i,height:s}=this.#t,o=new ia;let l=this.#t,u=i,h=s,d=null;if(e){if(i>e||s>e){const N=Math.min(e/i,e/s);u=Math.floor(i*N),h=Math.floor(s*N)}d=document.createElement("canvas");const g=d.width=Math.ceil(u*o.sx),v=d.height=Math.ceil(h*o.sy);this.#c||(l=this.#m(g,v));const y=d.getContext("2d");y.filter=this._uiManager.hcmFilter;let _="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(_="#8f8f9d",b="#42414d");const E=15,S=E*o.sx,T=E*o.sy,O=new OffscreenCanvas(S*2,T*2),R=O.getContext("2d");R.fillStyle=_,R.fillRect(0,0,S*2,T*2),R.fillStyle=b,R.fillRect(0,0,S,T),R.fillRect(S,T,S,T),y.fillStyle=y.createPattern(O,"repeat"),y.fillRect(0,0,g,v),y.drawImage(l,0,0,l.width,l.height,0,0,g,v)}let p=null;if(r){let g,v;if(o.symmetric&&l.width<t&&l.height<t)g=l.width,v=l.height;else if(l=this.#t,i>t||s>t){const b=Math.min(t/i,t/s);g=Math.floor(i*b),v=Math.floor(s*b),this.#c||(l=this.#m(g,v))}const _=new OffscreenCanvas(g,v).getContext("2d",{willReadFrequently:!0});_.drawImage(l,0,0,l.width,l.height,0,0,g,v),p={width:g,height:v,data:_.getImageData(0,0,g,v).data}}return{canvas:d,width:u,height:h,imageData:p}}#m(t,e){const{width:r,height:i}=this.#t;let s=r,o=i,l=this.#t;for(;s>2*t||o>2*e;){const u=s,h=o;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(s,o);d.getContext("2d").drawImage(l,0,0,u,h,0,0,s,o),l=d.transferToImageBitmap()}return l}#g(){const[t,e]=this.parentDimensions,{width:r,height:i}=this,s=new ia,o=Math.ceil(r*t*s.sx),l=Math.ceil(i*e*s.sy),u=this.#l;if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const h=this.#c?this.#t:this.#m(o,l),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,o,l)}#v(t){if(t){if(this.#c){const i=this._uiManager.imageManager.getSvgUrl(this.#e);if(i)return i}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,r]=this.pageDimensions,i=Math.round(this.width*e*Sc.PDF_TO_CSS_UNITS),s=Math.round(this.height*r*Sc.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,s);return o.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,i,s),o.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,r){let i=null,s=!1;if(t instanceof pC){const{data:{rect:_,rotation:b,id:E,structParent:S,popupRef:T},container:O,parent:{page:{pageNumber:R}},canvas:N}=t;let C,I;N?(delete t.canvas,{id:C,bitmap:I}=r.imageManager.getFromCanvas(O.id,N),N.remove()):(s=!0,t._hasNoCanvas=!0);const M=(await e._structTree.getAriaAttributes(`${By}${E}`))?.get("aria-label")||"";i=t={annotationType:Fe.STAMP,bitmapId:C,bitmap:I,pageIndex:R-1,rect:_.slice(0),rotation:b,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:M},isSvg:!1,structParent:S,popupRef:T}}const o=await super.deserialize(t,e,r),{rect:l,bitmap:u,bitmapUrl:h,bitmapId:d,isSvg:p,accessibilityData:g}=t;s?(r.addMissingCanvas(t.id,o),o.#o=!0):d&&r.imageManager.isValidId(d)?(o.#e=d,u&&(o.#t=u)):o.#r=h,o.#c=p;const[v,y]=o.pageDimensions;return o.width=(l[2]-l[0])/v,o.height=(l[3]-l[1])/y,o.annotationElementId=t.id||null,g&&(o.altTextData=g),o._initialData=i,o.#h=!!i,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r={annotationType:Fe.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(t)return r.bitmapUrl=this.#v(!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(r.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const l=this.#_(r);if(l.isSame)return null;l.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,e===null)return r;e.stamps||=new Map;const o=this.#c?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:o,serialized:r}),r.bitmap=this.#v(!1);else if(this.#c){const l=e.stamps.get(this.#e);o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=this.#v(!1))}return r}#_(t){const{pageIndex:e,accessibilityData:{altText:r}}=this._initialData,i=t.pageIndex===e,s=(t.accessibilityData?.alt||"")===r;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&s,isSameAltText:s}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class La{#t;#e=!1;#n=null;#r=null;#s=null;#i=new Map;#l=!1;#o=!1;#f=!1;#c=null;#h=null;#u=null;#d=null;#a;static _initialized=!1;static#p=new Map([vr,Jy,CP,Kn,Na].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:r,structTreeLayer:i,accessibilityManager:s,annotationLayer:o,drawLayer:l,textLayer:u,viewport:h,l10n:d}){const p=[...La.#p.values()];if(!La._initialized){La._initialized=!0;for(const g of p)g.initialize(d,t)}t.registerEditorTypes(p),this.#a=t,this.pageIndex=e,this.div=r,this.#t=s,this.#n=o,this.viewport=h,this.#u=u,this.drawLayer=l,this._structTree=i,this.#a.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===Fe.NONE}updateToolbar(t){this.#a.updateToolbar(t)}updateMode(t=this.#a.getMode()){switch(this.#y(),t){case Fe.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Fe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Fe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const r of La.#p.values())e.toggle(`${r._type}Editing`,t===r._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#a.setEditingState(t)}addCommands(t){this.#a.addCommands(t)}cleanUndoStack(t){this.#a.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#f=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const r of this.#i.values())r.enableEditing(),r.show(!0),r.annotationElementId&&(this.#a.removeChangedExistingAnnotation(r),t.add(r.annotationElementId));if(!this.#n){this.#f=!1;return}const e=this.#n.getEditableAnnotations();for(const r of e){if(r.hide(),this.#a.isDeletedAnnotationElement(r.data.id)||t.has(r.data.id))continue;const i=await this.deserialize(r);i&&(this.addOrRebuild(i),i.enableEditing())}this.#f=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const i of this.#i.values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){t.set(i.annotationElementId,i);continue}else e.set(i.annotationElementId,i);this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()}if(this.#n){const i=this.#n.getEditableAnnotations();for(const s of i){const{id:o}=s.data;if(this.#a.isDeletedAnnotationElement(o))continue;let l=e.get(o);if(l){l.resetAnnotationElement(s),l.show(!1),s.show();continue}l=t.get(o),l&&(this.#a.addChangedExistingAnnotation(l),l.renderAnnotationElement(s)&&l.show(!1)),s.show()}}this.#y(),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const i of La.#p.values())r.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#a.getActive()!==t&&this.#a.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#d){this.#d=new AbortController;const t=this.#a.combinedSignal(this.#d);this.#u.div.addEventListener("pointerdown",this.#m.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#u.div.classList.remove("highlighting"))}#m(t){this.#a.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:r}=Tr.platform;if(t.button!==0||t.ctrlKey&&r)return;this.#a.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Kn.startHighlighting(this,this.#a.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),t.preventDefault()}}enableClick(){if(this.#r)return;this.#r=new AbortController;const t=this.#a.combinedSignal(this.#r);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#r?.abort(),this.#r=null}attach(t){this.#i.set(t.id,t);const{annotationElementId:e}=t;e&&this.#a.isDeletedAnnotationElement(e)&&this.#a.removeDeletedAnnotationElement(t)}detach(t){this.#i.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#a.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#a.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#a.addDeletedAnnotationElement(t.annotationElementId),Ae.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#a.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#f),this.#a.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),r=()=>{t.remove()};this.addCommands({cmd:e,undo:r,mustExec:!1})}getNextId(){return this.#a.getId()}get#g(){return La.#p.get(this.#a.getMode())}combinedSignal(t){return this.#a.combinedSignal(t)}#v(t){const e=this.#g;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#g?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#a.updateMode(t.mode);const{offsetX:r,offsetY:i}=this.#_(),s=this.getNextId(),o=this.#v({parent:this,id:s,x:r,y:i,uiManager:this.#a,isCentered:!0,...e});o&&this.add(o)}async deserialize(t){return await La.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#a)||null}createAndAddNewEditor(t,e,r={}){const i=this.getNextId(),s=this.#v({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:this.#a,isCentered:e,...r});return s&&this.add(s),s}#_(){const{x:t,y:e,width:r,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,t),o=Math.max(0,e),l=Math.min(window.innerWidth,t+r),u=Math.min(window.innerHeight,e+i),h=(s+l)/2-t,d=(o+u)/2-e,[p,g]=this.viewport.rotation%180===0?[h,d]:[d,h];return{offsetX:p,offsetY:g}}addNewEditor(t={}){this.createAndAddNewEditor(this.#_(),!0,t)}setSelected(t){this.#a.setSelected(t)}toggleSelected(t){this.#a.toggleSelected(t)}unselect(t){this.#a.unselect(t)}pointerup(t){const{isMac:e}=Tr.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#l||(this.#l=!1,this.#g?.isDrawer&&this.#g.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const r=this.#a.getMode();if(r===Fe.STAMP||r===Fe.SIGNATURE){this.#a.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#a.getMode()===Fe.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:e}=Tr.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#l=!0,this.#g?.isDrawer){this.startDrawingSession(t);return}const r=this.#a.getActive();this.#e=!r||r.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#g.startDrawing(this,this.#a,!1,t);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(this.#h=null,this.commitOrRemove())},{signal:e}),this.#g.startDrawing(this,this.#a,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#h=e);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(t=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#h=null,this.#g.endDrawing(t)):null}findNewParent(t,e,r){const i=this.#a.findParent(e,r);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#g.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#i.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#i.clear(),this.#a.removeLayer(this)}#y(){for(const t of this.#i.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Cl(this.div,t);for(const e of this.#a.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#a.commitOrRemove(),this.#y();const e=this.viewport.rotation,r=t.rotation;if(this.viewport=t,Cl(this.div,{rotation:r}),e!==r)for(const i of this.#i.values())i.rotate(r)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#a.viewParameters.realScale}}class Ar{#t=null;#e=new Map;#n=new Map;static#r=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Ye(this,"_svgFactory",new Sd)}static#s(t,[e,r,i,s]){const{style:o}=t;o.top=`${100*r}%`,o.left=`${100*e}%`,o.width=`${100*i}%`,o.height=`${100*s}%`}#i(){const t=Ar._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#l(t,e){const r=Ar._svgFactory.createElement("clipPath");t.append(r);const i=`clip_${e}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const s=Ar._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),i}#o(t,e){for(const[r,i]of Object.entries(e))i===null?t.removeAttribute(r):t.setAttribute(r,i)}draw(t,e=!1,r=!1){const i=Ar.#r++,s=this.#i(),o=Ar._svgFactory.createElement("defs");s.append(o);const l=Ar._svgFactory.createElement("path");o.append(l);const u=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(i,l);const h=r?this.#l(o,u):null,d=Ar._svgFactory.createElement("use");return s.append(d),d.setAttribute("href",`#${u}`),this.updateProperties(s,t),this.#e.set(i,s),{id:i,clipPathId:`url(#${h})`}}drawOutline(t,e){const r=Ar.#r++,i=this.#i(),s=Ar._svgFactory.createElement("defs");i.append(s);const o=Ar._svgFactory.createElement("path");s.append(o);const l=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke");let u;if(e){const p=Ar._svgFactory.createElement("mask");s.append(p),u=`mask_p${this.pageIndex}_${r}`,p.setAttribute("id",u),p.setAttribute("maskUnits","objectBoundingBox");const g=Ar._svgFactory.createElement("rect");p.append(g),g.setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","white");const v=Ar._svgFactory.createElement("use");p.append(v),v.setAttribute("href",`#${l}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const h=Ar._svgFactory.createElement("use");i.append(h),h.setAttribute("href",`#${l}`),u&&h.setAttribute("mask",`url(#${u})`);const d=h.cloneNode();return i.append(d),h.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,t),this.#e.set(r,i),r}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:r,bbox:i,rootClass:s,path:o}=e,l=typeof t=="number"?this.#e.get(t):t;if(l){if(r&&this.#o(l,r),i&&Ar.#s(l,i),s){const{classList:u}=l;for(const[h,d]of Object.entries(s))u.toggle(h,d)}if(o){const h=l.firstChild.firstChild;this.#o(h,o)}}}updateParent(t,e){if(e===this)return;const r=this.#e.get(t);r&&(e.#t.append(r),this.#e.delete(t),e.#e.set(t,r))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Y_};globalThis.pdfjsLib={AbortException:ko,AnnotationEditorLayer:La,AnnotationEditorParamsType:Ke,AnnotationEditorType:Fe,AnnotationEditorUIManager:Lo,AnnotationLayer:Qy,AnnotationMode:Pa,AnnotationType:qn,build:lC,ColorPicker:es,createValidAbsoluteUrl:Iy,DOMSVGFactory:Sd,DrawLayer:Ar,FeatureTest:Tr,fetchData:vf,getDocument:Xy,getFilenameFromUrl:zT,getPdfFilenameFromUrl:HT,getUuid:Fy,getXfaPageViewport:jT,GlobalWorkerOptions:bl,ImageKind:ud,InvalidPDFException:Ug,isDataScheme:Zd,isPdfFile:Rm,isValidExplicitDest:WT,MathClamp:Kr,noContextMenu:Fs,normalizeUnicode:BT,OPS:xd,OutputScale:ia,PasswordResponses:PT,PDFDataRangeTransport:qy,PDFDateString:Uy,PDFWorker:of,PermissionFlag:IT,PixelsPerInch:Sc,RenderingCancelledException:Om,ResponseException:Ed,setLayerDimensions:Cl,shadow:Ye,SignatureExtractor:hc,stopEvent:Zn,SupportedImageMimeTypes:zg,TextLayer:wd,TouchManager:Jd,updateUrlHash:Py,Util:be,VerbosityLevel:Yd,version:oC,XfaLayer:Ky};const DP=Object.freeze(Object.defineProperty({__proto__:null,AbortException:ko,AnnotationEditorLayer:La,AnnotationEditorParamsType:Ke,AnnotationEditorType:Fe,AnnotationEditorUIManager:Lo,AnnotationLayer:Qy,AnnotationMode:Pa,AnnotationType:qn,ColorPicker:es,DOMSVGFactory:Sd,DrawLayer:Ar,FeatureTest:Tr,GlobalWorkerOptions:bl,ImageKind:ud,InvalidPDFException:Ug,MathClamp:Kr,OPS:xd,OutputScale:ia,PDFDataRangeTransport:qy,PDFDateString:Uy,PDFWorker:of,PasswordResponses:PT,PermissionFlag:IT,PixelsPerInch:Sc,RenderingCancelledException:Om,ResponseException:Ed,SignatureExtractor:hc,SupportedImageMimeTypes:zg,TextLayer:wd,TouchManager:Jd,Util:be,VerbosityLevel:Yd,XfaLayer:Ky,build:lC,createValidAbsoluteUrl:Iy,fetchData:vf,getDocument:Xy,getFilenameFromUrl:zT,getPdfFilenameFromUrl:HT,getUuid:Fy,getXfaPageViewport:jT,isDataScheme:Zd,isPdfFile:Rm,isValidExplicitDest:WT,noContextMenu:Fs,normalizeUnicode:BT,setLayerDimensions:Cl,shadow:Ye,stopEvent:Zn,updateUrlHash:Py,version:oC},Symbol.toStringTag,{value:"Module"})),OP=["onCopy","onCut","onPaste"],RP=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],NP=["onFocus","onBlur"],kP=["onInput","onInvalid","onReset","onSubmit"],LP=["onLoad","onError"],MP=["onKeyDown","onKeyPress","onKeyUp"],IP=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],PP=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],FP=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],BP=["onSelect"],UP=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],zP=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],HP=["onScroll"],jP=["onWheel"],$P=["onAnimationStart","onAnimationEnd","onAnimationIteration"],GP=["onTransitionEnd"],VP=["onToggle"],WP=["onChange"],XP=[...OP,...RP,...NP,...kP,...LP,...MP,...IP,...PP,...FP,...BP,...UP,...zP,...HP,...jP,...$P,...GP,...WP,...VP];function _C(n,t){const e={};for(const r of XP){const i=n[r];i&&(t?e[r]=s=>i(s,t(r)):e[r]=i)}return e}function r0(n){let t=!1;return{promise:new Promise((r,i)=>{n.then(s=>!t&&r(s)).catch(s=>!t&&i(s))}),cancel(){t=!0}}}function yC(n){var t,e,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(e=yC(n[t]))&&(r&&(r+=" "),r+=e)}else for(e in n)n[e]&&(r&&(r+=" "),r+=e);return r}function Lm(){for(var n,t,e=0,r="",i=arguments.length;e<i;e++)(n=arguments[e])&&(t=yC(n))&&(r&&(r+=" "),r+=t);return r}var YP="Invariant failed";function En(n,t){if(!n)throw new Error(YP)}var t_,MA;function qP(){if(MA)return t_;MA=1;var n=function(){};return t_=n,t_}var KP=qP();const ti=vm(KP);var IA=Object.prototype.hasOwnProperty;function PA(n,t,e){for(e of n.keys())if(Gu(e,t))return e}function Gu(n,t){var e,r,i;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((r=n.length)===t.length)for(;r--&&Gu(n[r],t[r]););return r===-1}if(e===Set){if(n.size!==t.size)return!1;for(r of n)if(i=r,i&&typeof i=="object"&&(i=PA(t,i),!i)||!t.has(i))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(r of n)if(i=r[0],i&&typeof i=="object"&&(i=PA(t,i),!i)||!Gu(r[1],t.get(i)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((r=n.byteLength)===t.byteLength)for(;r--&&n.getInt8(r)===t.getInt8(r););return r===-1}if(ArrayBuffer.isView(n)){if((r=n.byteLength)===t.byteLength)for(;r--&&n[r]===t[r];);return r===-1}if(!e||typeof n=="object"){r=0;for(e in n)if(IA.call(n,e)&&++r&&!IA.call(t,e)||!(e in t)||!Gu(n[e],t[e]))return!1;return Object.keys(t).length===r}}return n!==n&&t!==t}const bC=At.createContext(null);function Vu({children:n,type:t}){return ot.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:n})}const ZP="noopener noreferrer nofollow";class QP{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return En(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){En(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{En(this.pdfDocument),En(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{En(Array.isArray(e));const r=e[0];new Promise(i=>{En(this.pdfDocument),r instanceof Object?this.pdfDocument.getPageIndex(r).then(s=>{i(s)}).catch(()=>{En(!1)}):typeof r=="number"?i(r):En(!1)}).then(i=>{const s=i+1;En(this.pdfViewer),En(s>=1&&s<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:i,pageNumber:s})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;En(this.pdfViewer),En(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,r){t.href=e,t.rel=this.externalLinkRel||ZP,t.target=r?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const FA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Mm=typeof window<"u",xC=Mm&&window.location.protocol==="file:";function JP(n){return typeof n<"u"}function lc(n){return JP(n)&&n!==null}function tF(n){return typeof n=="string"}function eF(n){return n instanceof ArrayBuffer}function nF(n){return En(Mm),n instanceof Blob}function Z_(n){return tF(n)&&/^data:/.test(n)}function BA(n){En(Z_(n));const[t="",e=""]=n.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function rF(){return Mm&&window.devicePixelRatio||1}const EC="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function UA(){ti(!xC,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${EC}`)}function iF(){ti(!xC,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${EC}`)}function Cc(n){n?.cancel&&n.cancel()}function Q_(n,t){return Object.defineProperty(n,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function sF(n){return n.name==="RenderingCancelledException"}function aF(n){return new Promise((t,e)=>{const r=new FileReader;r.onload=()=>{if(!r.result)return e(new Error("Error while reading a file."));t(r.result)},r.onerror=i=>{if(!i.target)return e(new Error("Error while reading a file."));const{error:s}=i.target;if(!s)return e(new Error("Error while reading a file."));switch(s.code){case s.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case s.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case s.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},r.readAsArrayBuffer(n)})}function oF(n,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function lf(){return At.useReducer(oF,{value:void 0,error:void 0})}var zA=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const{PDFDataRangeTransport:lF}=DP,cF=(n,t)=>{switch(t){case FA.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");n(e);break}case FA.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");n(e);break}}};function HA(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const uF=At.forwardRef(function(t,e){var{children:r,className:i,error:s="Failed to load PDF file.",externalLinkRel:o,externalLinkTarget:l,file:u,inputRef:h,imageResourcesPath:d,loading:p="Loading PDF",noData:g="No PDF file specified.",onItemClick:v,onLoadError:y,onLoadProgress:_,onLoadSuccess:b,onPassword:E=cF,onSourceError:S,onSourceSuccess:T,options:O,renderMode:R,rotate:N,scale:C}=t,I=zA(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[M,F]=lf(),{value:H,error:P}=M,[et,L]=lf(),{value:st,error:Q}=et,Y=At.useRef(new QP),Ot=At.useRef([]),Et=At.useRef(void 0),z=At.useRef(void 0);u&&u!==Et.current&&HA(u)&&(ti(!Gu(u,Et.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),Et.current=u),O&&O!==z.current&&(ti(!Gu(O,z.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),z.current=O);const J=At.useRef({scrollPageIntoView:D=>{const{dest:dt,pageNumber:it,pageIndex:q=it-1}=D;if(v){v({dest:dt,pageIndex:q,pageNumber:it});return}const X=Ot.current[q];if(X){X.scrollIntoView();return}ti(!1,`An internal link leading to page ${it} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});At.useImperativeHandle(e,()=>({linkService:Y,pages:Ot,viewer:J}),[]);function V(){T&&T()}function ct(){P&&(ti(!1,P.toString()),S&&S(P))}function gt(){F({type:"RESET"})}At.useEffect(gt,[u,F]);const _t=At.useCallback(async()=>{if(!u)return null;if(typeof u=="string")return Z_(u)?{data:BA(u)}:(UA(),{url:u});if(u instanceof lF)return{range:u};if(eF(u))return{data:u};if(Mm&&nF(u))return{data:await aF(u)};if(En(typeof u=="object"),En(HA(u)),"url"in u&&typeof u.url=="string"){if(Z_(u.url)){const{url:D}=u,dt=zA(u,["url"]),it=BA(D);return Object.assign({data:it},dt)}UA()}return u},[u]);At.useEffect(()=>{const D=r0(_t());return D.promise.then(dt=>{F({type:"RESOLVE",value:dt})}).catch(dt=>{F({type:"REJECT",error:dt})}),()=>{Cc(D)}},[_t,F]),At.useEffect(()=>{if(!(typeof H>"u")){if(H===!1){ct();return}V()}},[H]);function Bt(){st&&(b&&b(st),Ot.current=new Array(st.numPages),Y.current.setDocument(st))}function Gt(){Q&&(ti(!1,Q.toString()),y&&y(Q))}At.useEffect(function(){L({type:"RESET"})},[L,H]),At.useEffect(function(){if(!H)return;const dt=O?Object.assign(Object.assign({},H),O):H,it=Xy(dt);_&&(it.onProgress=_),E&&(it.onPassword=E);const q=it,X=q.promise.then(ft=>{L({type:"RESOLVE",value:ft})}).catch(ft=>{q.destroyed||L({type:"REJECT",error:ft})});return()=>{X.finally(()=>q.destroy())}},[O,L,H]),At.useEffect(()=>{if(!(typeof st>"u")){if(st===!1){Gt();return}Bt()}},[st]),At.useEffect(function(){Y.current.setViewer(J.current),Y.current.setExternalLinkRel(o),Y.current.setExternalLinkTarget(l)},[o,l]);const j=At.useCallback((D,dt)=>{Ot.current[D]=dt},[]),pt=At.useCallback(D=>{delete Ot.current[D]},[]),lt=At.useMemo(()=>({imageResourcesPath:d,linkService:Y.current,onItemClick:v,pdf:st,registerPage:j,renderMode:R,rotate:N,scale:C,unregisterPage:pt}),[d,v,st,j,R,N,C,pt]),ut=At.useMemo(()=>_C(I,()=>st),[I,st]);function Dt(){return ot.jsx(bC.Provider,{value:lt,children:r})}function Lt(){return u?st==null?ot.jsx(Vu,{type:"loading",children:typeof p=="function"?p():p}):st===!1?ot.jsx(Vu,{type:"error",children:typeof s=="function"?s():s}):Dt():ot.jsx(Vu,{type:"no-data",children:typeof g=="function"?g():g})}return ot.jsx("div",Object.assign({className:Lm("react-pdf__Document",i),ref:h},ut,{children:Lt()}))});function wC(){return At.useContext(bC)}function AC(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n.filter(Boolean);if(e.length<=1){var r=e[0];return r||null}return function(s){for(var o=0,l=e;o<l.length;o++){var u=l[o];typeof u=="function"?u(s):u&&(u.current=s)}}}const SC=At.createContext(null),TC={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},fF=/^H(\d+)$/;function hF(n){return n in TC}function Im(n){return"children"in n}function CC(n){return Im(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function dF(n){const t={};if(Im(n)){const{role:e}=n,r=e.match(fF);if(r)t.role="heading",t["aria-level"]=Number(r[1]);else if(hF(e)){const i=TC[e];i&&(t.role=i)}}return t}function DC(n){const t={};if(Im(n)){if(n.alt!==void 0&&(t["aria-label"]=n.alt),n.lang!==void 0&&(t.lang=n.lang),CC(n)){const[e]=n.children;if(e){const r=DC(e);return Object.assign(Object.assign({},t),r)}}}else"id"in n&&(t["aria-owns"]=n.id);return t}function pF(n){return n?Object.assign(Object.assign({},dF(n)),DC(n)):null}function OC({className:n,node:t}){const e=At.useMemo(()=>pF(t),[t]),r=At.useMemo(()=>!Im(t)||CC(t)?null:t.children.map((i,s)=>ot.jsx(OC,{node:i},s)),[t]);return ot.jsx("span",Object.assign({className:n},e,{children:r}))}function Pm(){return At.useContext(SC)}function gF(){const n=Pm();En(n);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=n,[r,i]=lf(),{value:s,error:o}=r,{customTextRenderer:l,page:u}=n;function h(){s&&e&&e(s)}function d(){o&&(ti(!1,o.toString()),t&&t(o))}return At.useEffect(function(){i({type:"RESET"})},[i,u]),At.useEffect(function(){if(l||!u)return;const g=r0(u.getStructTree()),v=g;return g.promise.then(y=>{i({type:"RESOLVE",value:y})}).catch(y=>{i({type:"REJECT",error:y})}),()=>Cc(v)},[l,u,i]),At.useEffect(()=>{if(s!==void 0){if(s===!1){d();return}h()}},[s]),s?ot.jsx(OC,{className:"react-pdf__Page__structTree structTree",node:s}):null}const jA=Pa;function mF(n){const t=Pm();En(t);const e=Object.assign(Object.assign({},t),n),{_className:r,canvasBackground:i,devicePixelRatio:s=rF(),onRenderError:o,onRenderSuccess:l,page:u,renderForms:h,renderTextLayer:d,rotate:p,scale:g}=e,{canvasRef:v}=n;En(u);const y=At.useRef(null);function _(){u&&l&&l(Q_(u,g))}function b(O){sF(O)||(ti(!1,O.toString()),o&&o(O))}const E=At.useMemo(()=>u.getViewport({scale:g*s,rotation:p}),[s,u,p,g]),S=At.useMemo(()=>u.getViewport({scale:g,rotation:p}),[u,p,g]);At.useEffect(function(){if(!u)return;u.cleanup();const{current:R}=y;if(!R)return;R.width=E.width,R.height=E.height,R.style.width=`${Math.floor(S.width)}px`,R.style.height=`${Math.floor(S.height)}px`,R.style.visibility="hidden";const N={annotationMode:h?jA.ENABLE_FORMS:jA.ENABLE,canvasContext:R.getContext("2d",{alpha:!1}),viewport:E};i&&(N.background=i);const C=u.render(N),I=C;return C.promise.then(()=>{R.style.visibility="",_()}).catch(b),()=>Cc(I)},[i,u,h,E,S]);const T=At.useCallback(()=>{const{current:O}=y;O&&(O.width=0,O.height=0)},[]);return At.useEffect(()=>T,[T]),ot.jsx("canvas",{className:`${r}__canvas`,dir:"ltr",ref:AC(v,y),style:{display:"block",userSelect:"none"},children:d?ot.jsx(gF,{}):null})}function vF(n){return"str"in n}function _F(){const n=Pm();En(n);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:r,onRenderTextLayerError:i,onRenderTextLayerSuccess:s,page:o,pageIndex:l,pageNumber:u,rotate:h,scale:d}=n;En(o);const[p,g]=lf(),{value:v,error:y}=p,_=At.useRef(null);ti(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function b(){v&&r&&r(v)}function E(){y&&(ti(!1,y.toString()),e&&e(y))}At.useEffect(function(){g({type:"RESET"})},[o,g]),At.useEffect(function(){if(!o)return;const I=r0(o.getTextContent()),M=I;return I.promise.then(F=>{g({type:"RESOLVE",value:F})}).catch(F=>{g({type:"REJECT",error:F})}),()=>Cc(M)},[o,g]),At.useEffect(()=>{if(v!==void 0){if(v===!1){E();return}b()}},[v]);const S=At.useCallback(()=>{s&&s()},[s]),T=At.useCallback(C=>{ti(!1,C.toString()),i&&i(C)},[i]);function O(){const C=_.current;C&&C.classList.add("selecting")}function R(){const C=_.current;C&&C.classList.remove("selecting")}const N=At.useMemo(()=>o.getViewport({scale:d,rotation:h}),[o,h,d]);return At.useLayoutEffect(function(){if(!o||!v)return;const{current:I}=_;if(!I)return;I.innerHTML="";const M=o.streamTextContent({includeMarkedContent:!0}),F={container:I,textContentSource:M,viewport:N},H=new wd(F),P=H;return H.render().then(()=>{const et=document.createElement("div");et.className="endOfContent",I.append(et);const L=I.querySelectorAll('[role="presentation"]');if(t){let st=0;v.items.forEach((Q,Y)=>{if(!vF(Q))return;const Ot=L[st];if(!Ot)return;const Et=t(Object.assign({pageIndex:l,pageNumber:u,itemIndex:Y},Q));Ot.innerHTML=Et,st+=Q.str&&Q.hasEOL?2:1})}S()}).catch(T),()=>Cc(P)},[t,T,S,o,l,u,v,N]),ot.jsx("div",{className:Lm("react-pdf__Page__textContent","textLayer"),onMouseUp:R,onMouseDown:O,ref:_})}function yF(){const n=wC(),t=Pm();En(t);const e=Object.assign(Object.assign({},n),t),{imageResourcesPath:r,linkService:i,onGetAnnotationsError:s,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:u,page:h,pdf:d,renderForms:p,rotate:g,scale:v=1}=e;En(d),En(h),En(i);const[y,_]=lf(),{value:b,error:E}=y,S=At.useRef(null);ti(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function T(){b&&o&&o(b)}function O(){E&&(ti(!1,E.toString()),s&&s(E))}At.useEffect(function(){_({type:"RESET"})},[_,h]),At.useEffect(function(){if(!h)return;const M=r0(h.getAnnotations()),F=M;return M.promise.then(H=>{_({type:"RESOLVE",value:H})}).catch(H=>{_({type:"REJECT",error:H})}),()=>{Cc(F)}},[_,h]),At.useEffect(()=>{if(b!==void 0){if(b===!1){O();return}T()}},[b]);function R(){u&&u()}function N(I){ti(!1,`${I}`),l&&l(I)}const C=At.useMemo(()=>h.getViewport({scale:v,rotation:g}),[h,g,v]);return At.useEffect(function(){if(!d||!h||!i||!b)return;const{current:M}=S;if(!M)return;const F=C.clone({dontFlip:!0}),H={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:M,l10n:null,page:h,structTreeLayer:null,viewport:F},P={annotations:b,annotationStorage:d.annotationStorage,div:M,imageResourcesPath:r,linkService:i,page:h,renderForms:p,viewport:F};M.innerHTML="";try{new Qy(H).render(P),R()}catch(et){N(et)}return()=>{}},[b,r,i,h,d,p,C]),ot.jsx("div",{className:Lm("react-pdf__Page__annotations","annotationLayer"),ref:S})}var bF=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const $A=1;function xF(n){const t=wC(),e=Object.assign(Object.assign({},t),n),{_className:r="react-pdf__Page",_enableRegisterUnregisterPage:i=!0,canvasBackground:s,canvasRef:o,children:l,className:u,customRenderer:h,customTextRenderer:d,devicePixelRatio:p,error:g="Failed to load the page.",height:v,inputRef:y,loading:_="Loading page",noData:b="No page specified.",onGetAnnotationsError:E,onGetAnnotationsSuccess:S,onGetStructTreeError:T,onGetStructTreeSuccess:O,onGetTextError:R,onGetTextSuccess:N,onLoadError:C,onLoadSuccess:I,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:F,onRenderError:H,onRenderSuccess:P,onRenderTextLayerError:et,onRenderTextLayerSuccess:L,pageIndex:st,pageNumber:Q,pdf:Y,registerPage:Ot,renderAnnotationLayer:Et=!0,renderForms:z=!1,renderMode:J="canvas",renderTextLayer:V=!0,rotate:ct,scale:gt=$A,unregisterPage:_t,width:Bt}=e,Gt=bF(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[j,pt]=lf(),{value:lt,error:ut}=j,Dt=At.useRef(null);En(Y);const Lt=lc(Q)?Q-1:st??null,D=Q??(lc(st)?st+1:null),dt=ct??(lt?lt.rotate:null),it=At.useMemo(()=>{if(!lt)return null;let de=1;const ae=gt??$A;if(Bt||v){const ze=lt.getViewport({scale:1,rotation:dt});Bt?de=Bt/ze.width:v&&(de=v/ze.height)}return ae*de},[v,lt,dt,gt,Bt]);At.useEffect(function(){return()=>{lc(Lt)&&i&&_t&&_t(Lt)}},[i,Y,Lt,_t]);function q(){if(I){if(!lt||!it)return;I(Q_(lt,it))}if(i&&Ot){if(!lc(Lt)||!Dt.current)return;Ot(Lt,Dt.current)}}function X(){ut&&(ti(!1,ut.toString()),C&&C(ut))}At.useEffect(function(){pt({type:"RESET"})},[pt,Y,Lt]),At.useEffect(function(){if(!Y||!D)return;const ae=r0(Y.getPage(D)),ze=ae;return ae.promise.then(Cn=>{pt({type:"RESOLVE",value:Cn})}).catch(Cn=>{pt({type:"REJECT",error:Cn})}),()=>Cc(ze)},[pt,Y,D]),At.useEffect(()=>{if(lt!==void 0){if(lt===!1){X();return}q()}},[lt,it]);const ft=At.useMemo(()=>lt&&lc(Lt)&&D&&lc(dt)&&lc(it)?{_className:r,canvasBackground:s,customTextRenderer:d,devicePixelRatio:p,onGetAnnotationsError:E,onGetAnnotationsSuccess:S,onGetStructTreeError:T,onGetStructTreeSuccess:O,onGetTextError:R,onGetTextSuccess:N,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:F,onRenderError:H,onRenderSuccess:P,onRenderTextLayerError:et,onRenderTextLayerSuccess:L,page:lt,pageIndex:Lt,pageNumber:D,renderForms:z,renderTextLayer:V,rotate:dt,scale:it}:null,[r,s,d,p,E,S,T,O,R,N,M,F,H,P,et,L,lt,Lt,D,z,V,dt,it]),Pt=At.useMemo(()=>_C(Gt,()=>lt&&(it?Q_(lt,it):void 0)),[Gt,lt,it]),zt=`${Lt}@${it}/${dt}`;function bt(){switch(J){case"custom":return En(h),ot.jsx(h,{},`${zt}_custom`);case"none":return null;case"canvas":default:return ot.jsx(mF,{canvasRef:o},`${zt}_canvas`)}}function Rt(){return V?ot.jsx(_F,{},`${zt}_text`):null}function qt(){return Et?ot.jsx(yF,{},`${zt}_annotations`):null}function xt(){return ot.jsxs(SC.Provider,{value:ft,children:[bt(),Rt(),qt(),l]})}function se(){return D?Y===null||lt===void 0||lt===null?ot.jsx(Vu,{type:"loading",children:typeof _=="function"?_():_}):Y===!1||lt===!1?ot.jsx(Vu,{type:"error",children:typeof g=="function"?g():g}):xt():ot.jsx(Vu,{type:"no-data",children:typeof b=="function"?b():b})}return ot.jsx("div",Object.assign({className:Lm(r,u),"data-page-number":D,ref:AC(y,Dt),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${it}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Pt,{children:se()}))}iF();bl.workerSrc="pdf.worker.mjs";const rg=3,e_=(n,t,e,r)=>({x:n.x*e/t,width:n.width*e/t,y:r.height-n.y*e/t-n.height*e/t,height:n.height*e/t}),n_=(n,t)=>n.items.filter(e=>{const r=e.transform[4],i=e.transform[5],s=e.transform[4]+e.width,o=e.transform[5]+e.height;return r>=t.x-rg&&s<=t.x+t.width+rg&&i>=t.y-rg&&o<=t.y+t.height+rg}),GA=n=>{const t=n.filter(l=>{const u=l.str.trim();return Hg(u)||u==="-"});if(t.length===0)return[];const e=t.filter(l=>Hg(l.str.trim()));if(e.length<2)return t.map(l=>l.str.trim());const r=[];for(let l=0;l+1<e.length;l++)r.push(Math.abs(e[l].transform[5]-e[l+1].transform[5]));r.sort((l,u)=>l-u);const i=e.length<4?e[0].height*1.2:r[r.length-1]-r[0]<=r[0]*1.2?0:r[0]*1.1,s=[],o=[];return t.forEach((l,u)=>{if(o.length>0){o.push(l.str.trim()),s.push(o.join("/")),o.length=0;return}if(l.str.trim()==="-"){s.push(l.str.trim());return}if(u+1<t.length&&Math.abs(l.transform[5]-t[u+1].transform[5])<=i){o.push(l.str.trim());return}s.push(l.str.trim())}),o.length>0&&s.push(o.join("/")),s},r_=(n,t)=>{const e=Array(),r=Array();let i=!1;return n.forEach((s,o)=>{if(s.str.trim()=="")return;const l=s.height*1.5;if(i){e.push(s.str.trim());const u=e.join("/");r.push(u),e.length=0,i=!1;return}if(o<n.length-1){const u={x:s.transform[4]+s.width/5,y:s.transform[5]-s.height/2,width:s.width*.6,height:Math.min(Math.abs(s.transform[5]-n[o+1].transform[5]),s.height/2)},h={x:s.transform[4]+s.width/5,width:s.width*(3/5),y:s.transform[5]-s.height,height:s.height};if(Math.abs(s.transform[5]-n[o+1].transform[5])<=l&&!VA(u,t))e.push(s.str.trim());else if(VA(h,t,!0)&&Hg(s.str.trim())&&EF(n,o)&&Math.abs(s.transform[5]-n[o+1].transform[5])<=l&&e.length<1)e.push(s.str.trim()),i=!0;else if(e.length>0){e.push(s.str.trim());const d=e.join(" ");r.push(d),e.length=0}else r.push(s.str.trim())}else{e.push(s.str.trim());const u=e.join(" ");r.push(u),e.length=0}}),e.length>0&&r.push(e.join(" ")),r},i_=(n,t,e)=>Math.max(Math.min(n,e),t),VA=(n,t,e=!1)=>{const r=n.x,i=n.x+n.width,s=n.y,o=n.y+n.height;return t.some(l=>l.x1<=i&&l.x2>=r&&l.y>=s&&l.y<=o&&(Math.abs(l.x2-l.x1)<=15||!e))},Hg=n=>/^\d+(\.\d+)?$/.test(n.trim()),EF=(n,t)=>{for(let e=t+1;e<n.length;e++){const r=n[e].str.trim();if(r.trim())return Hg(r)}return!1},xl=(n,t=0)=>{if(!n)return 0;const e=n.trim().replaceAll(".","").replace(",",".");return parseFloat(e)||t},i0=n=>{const t=new Map;return n.forEach(e=>{e.dataType&&t.set(e.dataType,e.name)}),t},ta=(n,t,e)=>{const r=t.get(e);return!r||!n[r]?e==="z"?"0":"":n[r][0]},Td=(n,t,e)=>{const r=t.get(e);return!r||!n[r]?[]:n[r]},nb=(n,t)=>{const e=t.get("depth");if(e&&n[e])return xl(n[e][0]);const r=t.get("depth_from_to");if(r&&n[r]){const i=n[r];return Math.max(...i.map(s=>xl(s)))}return 0},wF=({areas:n,zoomScale:t,activeAreaId:e})=>ot.jsx(ot.Fragment,{children:n.map(r=>!r.coordinates||r.id===e?null:ot.jsx("div",{className:"position-absolute border",style:{left:r.coordinates.x*t,top:r.coordinates.y*t,width:r.coordinates.width*t,height:r.coordinates.height*t,backgroundColor:`${r.color}20`,borderColor:r.color,borderWidth:"2px",zIndex:10},title:r.name},`selected-${r.id}`))});/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),SF=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,r)=>r?r.toUpperCase():e.toLowerCase()),WA=n=>{const t=SF(n);return t.charAt(0).toUpperCase()+t.slice(1)},RC=(...n)=>n.filter((t,e,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===e).join(" ").trim(),TF=n=>{for(const t in n)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var CF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=At.forwardRef(({color:n="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...l},u)=>At.createElement("svg",{ref:u,...CF,width:t,height:t,stroke:n,strokeWidth:r?Number(e)*24/Number(t):e,className:RC("lucide",i),...!s&&!TF(l)&&{"aria-hidden":"true"},...l},[...o.map(([h,d])=>At.createElement(h,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=(n,t)=>{const e=At.forwardRef(({className:r,...i},s)=>At.createElement(DF,{ref:s,iconNode:t,className:RC(`lucide-${AF(WA(n))}`,`lucide-${n}`,r),...i}));return e.displayName=WA(n),e};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],RF=si("check",OF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NF=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],kF=si("chevron-left",NF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],MF=si("chevron-right",LF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],PF=si("circle-question-mark",IF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],hd=si("download",FF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],UF=si("eraser",BF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],HF=si("folder",zF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jF=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],$F=si("play",jF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],VF=si("plus",GF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],XF=si("save",WF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=[["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 14v1",key:"169vum"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M7 16h6",key:"1vyc9m"}],["path",{d:"M7 8h8",key:"1jbsf9"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M9 3h1",key:"1yesri"}]],qF=si("text-select",YF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ZF=si("trash-2",KF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],JF=si("trash",QF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],rb=si("x",t6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],n6=si("zoom-in",e6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],i6=si("zoom-out",r6);bl.workerSrc=new URL("/extrator-dados-PDF/assets/pdf.worker.min-BFAMBS4k.mjs",import.meta.url).toString();const s_=.5,a_=3,s6=At.forwardRef(({file:n,isSelectingActive:t,activeAreaId:e,onFinishSelection:r,areas:i},s)=>{const o=At.useRef(null),[l,u]=At.useState(),[h,d]=At.useState(1),[p,g]=At.useState(!1),[v,y]=At.useState(h),[_,b]=At.useState(!1),[E,S]=At.useState(null),[T,O]=At.useState(null),R=At.useRef(null),N=At.useRef(null),[C,I]=At.useState(1),[M,F]=At.useState(null),H=()=>{I(Lt=>Math.min(Lt+.25,a_)),Dt(0,0)},P=()=>{Dt(0,0),I(Lt=>Math.max(Lt-.25,s_))},[et,L]=At.useState({x:0,y:0}),[st,Q]=At.useState(null),[Y,Ot]=At.useState(!1);function Et(Lt){d(D=>D+Lt)}function z(){Et(-1)}function J(){Et(1)}const V=()=>{y(h),g(!0)},ct=()=>{v>=1&&v<=(l||1)&&d(v),g(!1)},gt=()=>{y(h),g(!1)},_t=Lt=>{Lt.key==="Enter"&&ct(),Lt.key==="Escape"&&gt()};At.useEffect(()=>{p&&R.current&&(R.current.focus(),R.current.select())},[p]);const Bt=Lt=>{if(N.current){if(_&&T&&T.x>=10&&T.y>=10)b(!1),O(null),r(T);else if(!_){const D=N.current.getBoundingClientRect(),dt=(Lt.clientX-D.left)/C,it=(Lt.clientY-D.top)/C;S({x:dt,y:it}),b(!0),O(null)}}},Gt=Lt=>{if(!N.current)return;const D=N.current.getBoundingClientRect();Q({x:Lt.clientX-D.left,y:Lt.clientY-D.top}),Ot(!0)},j=At.useCallback(Lt=>{N.current&&(Lt.currentTarget.setPointerCapture(Lt.pointerId),t?Bt(Lt):Gt(Lt))},[_,T,C,t]),pt=At.useCallback(Lt=>{if(!N.current)return;const D=N.current.getBoundingClientRect();if(Y){if(Y&&st){const X=Lt.clientX-D.left-st.x,ft=Lt.clientY-D.top-st.y;Dt(X,ft)}return}if(!_||!E)return;const dt=(Lt.clientX-D.left)/C,it=(Lt.clientY-D.top)/C,q={x:Math.min(E.x,dt),y:Math.min(E.y,it),width:Math.abs(E.x-dt),height:Math.abs(E.y-it)};O(q)},[_,E,Y,st]),lt=At.useCallback(Lt=>{Lt.currentTarget.releasePointerCapture(Lt.pointerId),Y&&Ot(!1)},[Y,Gt]);At.useEffect(()=>{t||ut()},[t]);const ut=()=>{b(!1),O(null),S(null)},Dt=At.useCallback((Lt,D)=>{const dt=document.querySelector(".pdf-container"),it=dt?.getBoundingClientRect().width||600,q=dt?parseInt(getComputedStyle(dt).height):800,X=N.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().width||it,ft=N.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().height||q,Pt=document.querySelector(".pdf-nav")?.getBoundingClientRect().height||40,zt=X>=it,bt=ft>=q-Pt,Rt=Math.max(0,X-it),qt=Math.max(0,ft-q+Pt);L(xt=>({x:zt?i_(xt.x+Lt,-Rt,0):0,y:bt?i_(xt.y+D,-qt,0):0}))},[]);return At.useEffect(()=>{if(!n)return;const Lt=document.querySelector(".pdf-container");if(!Lt)return;const D=dt=>{dt.preventDefault();const it=Lt.getBoundingClientRect(),q=(dt.clientX-it.left)/it.width,X=(dt.clientY-it.top)/it.height,ft=.1;I(Pt=>{const zt=dt.deltaY>0?-ft:ft,bt=i_(Pt+zt,s_,a_),Rt=N.current?.querySelector(".react-pdf__Page"),qt=Rt?.getBoundingClientRect().width||0,xt=Rt?.getBoundingClientRect().height||0,se=bt-Pt,de=qt*se,ae=xt*se,ze=de*q,Cn=ae*X;return F({x:-ze,y:-Cn}),bt})};return Lt.addEventListener("wheel",D,{passive:!1}),()=>{Lt.removeEventListener("wheel",D)}},[n,C]),At.useEffect(()=>{M&&(Dt(M.x,M.y),F(null))},[C]),At.useImperativeHandle(s,()=>({getDocument:()=>o.current})),n?ot.jsx(ot.Fragment,{children:ot.jsxs("div",{className:"pdf-container",style:{height:"min(800px, 90vh)",overflow:"hidden",position:"relative",border:"2px solid black",marginTop:"30px",marginBottom:"15px"},children:[ot.jsxs("div",{ref:N,className:`position-relative d-inline-block ${t?"pdf-cursor-crosshair":Y?"pdf-cursor-grabbing":"pdf-cursor-grab"}`,onPointerDown:j,onPointerMove:pt,onPointerUp:lt,style:{userSelect:"none",transform:`translate(${et.x}px, ${et.y}px)`},children:[ot.jsx(uF,{file:n,onLoadSuccess:Lt=>{u(Lt.numPages),d(1),I(1),o.current=Lt},children:ot.jsx(xF,{pageNumber:h,renderTextLayer:!1,renderAnnotationLayer:!1,scale:C})}),ot.jsx(wF,{areas:i,zoomScale:C,activeAreaId:e}),T&&ot.jsx("div",{className:"position-absolute border border-secondary",style:{left:T.x*C,top:T.y*C,width:T.width*C,height:T.height*C,backgroundColor:"rgba(134, 142, 135, 0.2)",zIndex:10}})]}),ot.jsxs("div",{className:"pdf-nav position-absolute bottom-0 start-0 end-0 d-flex align-items-center",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",padding:"4px 12px"},children:[ot.jsx("div",{className:"flex-grow-1 d-flex justify-content-center",children:p?ot.jsxs("div",{className:"d-flex align-items-center gap-1",children:[ot.jsx("input",{ref:R,type:"number",className:"form-control form-control-sm text-center",style:{width:"40px",fontSize:"12px",backgroundColor:"rgba(108, 108, 108, 0.8)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"2px",color:"white"},value:v,min:1,max:l||1,onChange:Lt=>y(parseInt(Lt.target.value)||1),onKeyDown:_t,onBlur:gt,autoFocus:!0}),ot.jsxs("span",{className:"text-white small",children:["de ",l||1]})]}):ot.jsxs("span",{onClick:V,className:"text-white small",title:"Selecionar pgina",style:{cursor:"pointer"},children:["Pgina ",h||1," ",l&&`de ${l}`]})}),ot.jsxs("div",{className:"d-flex gap-1",children:[ot.jsx("button",{className:"pdf-nav-button",title:"Pgina anterior",onClick:z,disabled:h<=1,children:ot.jsx(kF,{size:24,color:"#d0d0d0"})}),ot.jsx("button",{className:"pdf-nav-button",title:"Prxima pgina",onClick:J,disabled:h>=(l??0),children:ot.jsx(MF,{size:24,color:"#d0d0d0"})}),ot.jsx("button",{className:"pdf-nav-button",onClick:P,disabled:C<=s_,children:ot.jsx(i6,{size:24,color:"#d0d0d0"})}),ot.jsx("button",{className:"pdf-nav-button",onClick:H,disabled:C>=a_,children:ot.jsx(n6,{size:24,color:"#d0d0d0"})})]})]})]})}):ot.jsx(ot.Fragment,{children:ot.jsx("div",{className:"row",children:ot.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",style:{minHeight:"50vh"},children:ot.jsx("p",{className:"text-muted",children:"Carregue um pdf para ser exibido aqui"})})})})}),a6=["default","hole_id","x","y","z","depth","date","depth_from_to","water_level","geology","nspt","campaign","interp","generic_info"],Dc={default:"Padro",hole_id:"ID da Sondagem",x:"Coordenada X",y:"Coordenada Y",z:"Cota",depth:"Profundidade Total",date:"Data",depth_from_to:"Profundidades",water_level:"Nvel d'gua",geology:"Descrio Geolgica",nspt:"NSPT",campaign:"Campanha",interp:"Interpretao Geolgica",generic_info:"Outras Informaes"},NC=["hole_id","x","y","z","depth","date","water_level","campaign"],kC=["hole_id"],o6=["hole_id","x","y","z","depth"],o_=["hole_id","x","y","z","depth","depth_from_to","geology","nspt","water_level","interp"],ig=["collar","nspt","na","geology","interp"],l6={collar:"Collar",nspt:"NSPT",na:"NA",geology:"Geologia",interp:"Interpretao"},c6={collar:["hole_id","x","y"],nspt:["hole_id","nspt"],na:["hole_id","water_level"],geology:["hole_id","geology","depth_from_to"],interp:["hole_id","interp","depth_from_to"]},u6=({hasFile:n,area:t,areas:e,onStartSelection:r,onClearArea:i,onDeleteArea:s,onRenameArea:o,onToggleMandatory:l,onToggleRepeat:u,onChangeAreaType:h})=>{const[d,p]=At.useState(!1),[g,v]=At.useState(t.name),y=At.useRef(null);At.useEffect(()=>{const N=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));return N.forEach(C=>new Ps(C)),()=>{N.forEach(C=>{const I=Ps.getInstance(C);I&&I.dispose()})}},[t]),At.useEffect(()=>{d&&y.current&&(y.current.focus(),y.current.select())},[d]);const _=()=>{r(t.id)},b=()=>{s(t.id)},E=()=>{i(t.id)},S=()=>{v(t.name),p(!0)},T=N=>{N.key==="Enter"&&O(),N.key==="Escape"&&R()},O=()=>{g.trim()&&g.trim()!==t.name?(o(t.id,g.trim()),p(!1)):R()},R=()=>{v(t.name),p(!1)};return ot.jsx(ot.Fragment,{children:ot.jsxs("div",{className:"border rounded mb-1",children:[ot.jsxs("div",{className:"d-flex align-items-center gap-1 pt-2 px-2 pb-1",children:[ot.jsx("div",{className:"drag-handle",style:{cursor:"grab"},children:""}),ot.jsx("div",{className:"d-flex align-items-center",children:ot.jsxs("span",{className:"badge me-2",style:{backgroundColor:t.color,color:"white"},children:["#",t.order]})}),d?ot.jsxs("div",{className:"d-flex align-items-center flex-grow-1",children:[ot.jsx("input",{ref:y,type:"text",className:"form-control form-control-sm me-2",value:g,onChange:N=>v(N.target.value),onKeyDown:T,onBlur:O}),ot.jsxs("div",{className:"d-flex gap-2",children:[ot.jsx("button",{className:"menu-btn menu-btn-cta",title:"Confirmar",onClick:O,children:ot.jsx(RF,{size:16})}),ot.jsx("button",{className:"menu-btn menu-btn-warning",title:"Cancelar",onClick:R,children:ot.jsx(rb,{size:16})})]})]}):ot.jsxs(ot.Fragment,{children:[ot.jsx("div",{className:"flex-grow-1 text-start area-name-section",style:{minWidth:0},children:ot.jsx("span",{onClick:S,style:{width:"calc(100% - 10px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},title:t.name,children:t.name})}),ot.jsx("button",{className:"menu-btn menu-btn-cta",disabled:!n,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Selecionar rea",onClick:_,children:ot.jsx(qF,{size:16})}),t.coordinates&&ot.jsx("button",{className:"menu-btn menu-btn-alert",onClick:E,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Limpar seleo",children:ot.jsx(UF,{size:16})}),ot.jsx("button",{className:"menu-btn menu-btn-warning area-delete",onClick:b,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Excluir rea",children:ot.jsx(JF,{size:14})})]})]}),ot.jsxs("div",{className:"d-flex align-items-center gap-2 px-2 pb-2 justify-content-between",children:[ot.jsx("div",{className:"flex-grow-1 me-2",children:ot.jsxs("select",{className:"form-select form-select-sm w-100",value:t.dataType||"",onChange:N=>h(t.id,N.target.value),children:[ot.jsx("option",{value:"default",children:"Tipo padro"}),a6.filter(N=>N!=="default"&&(!o6.includes(N)||!e.find(C=>C.dataType===N&&C.id!==t.id))).map(N=>ot.jsx("option",{value:N,children:Dc[N]},N))]})}),ot.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Pular pginas sem texto nesta rea",children:[ot.jsx("input",{className:"form-check-input",type:"checkbox",id:`mandatory-${t.id}`,checked:t.isMandatory,onChange:N=>l(t.id,N.target.checked)}),ot.jsx("label",{className:"form-check-label small",children:"Obrigatrio"})]}),ot.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":e.find(N=>N.dataType==="hole_id")?"Usar um nico valor por sondagem":"Adicione uma rea como ID da Sondagem para utilizar essa opo",children:[ot.jsx("input",{className:"form-check-input",type:"checkbox",id:`repeat-${t.id}`,checked:t.repeatInPages,onChange:N=>u(t.id,N.target.checked),disabled:!e.find(N=>N.dataType==="hole_id")}),ot.jsx("label",{className:"form-check-label small",children:"nico"})]})]})]})})},f6=100*1024*1024;function h6({onFileSelect:n}){const t=e=>{if(e.target.files){const r=e.target.files[0];if(r.size>f6){alert(`Arquivo muito grande! Limite mximo: 100MB. Seu arquivo: ${(r.size/1024/1024).toFixed(1)}MB`),e.target.value="";return}n(r)}};return ot.jsx("div",{children:ot.jsx("input",{className:"form-control mb-2",type:"file",id:"pdf-file",name:"pdf-file",accept:".pdf",onChange:t})})}const XA="extrator-dados-pdf-presets",d6=({isOpen:n,onClose:t,currentAreas:e,onLoadPreset:r})=>{const[i,s]=At.useState(""),[o,l]=At.useState([]);At.useEffect(()=>{u()},[]);const u=()=>{try{const _=localStorage.getItem(XA);if(_){const b=JSON.parse(_);l(b)}}catch(_){console.error("Erro ao carregar presets:",_)}},h=_=>{try{localStorage.setItem(XA,JSON.stringify(_))}catch(b){console.error("Erro ao salvar presets:",b)}},d=()=>{if(!i.trim())return;if(e.length<=0){alert("No  possvel salvar um preset sem reas");return}const _={name:i.trim(),areas:e},b=[...o,_];l(b),h(b),s("")},p=_=>{confirm("Isso vai substituir todas as reas atuais. Continuar?")&&(r(_.areas),t())},g=_=>{if(!confirm("Tem certeza que deseja excluir este preset?"))return;const b=o.filter((E,S)=>S!==_);l(b),h(b)},v=_=>{const b=JSON.stringify(_,null,2),E=new Blob([b],{type:"application/json"}),S=URL.createObjectURL(E),T=document.createElement("a");T.href=S,T.download=`${_.name}.json`,T.click(),URL.revokeObjectURL(S)},y=_=>{const b=_.target.files?.[0];if(!b)return;const E=new FileReader;E.onload=S=>{try{const T=S.target?.result,O=JSON.parse(T);if(!O.name||!Array.isArray(O.areas)){alert("Arquivo JSON invlido!");return}const R=[...o,O];l(R),h(R),_.target.value="",alert(`Preset "${O.name}" importado com sucesso!`)}catch(T){alert("Erro ao ler arquivo JSON!"),console.error(T)}},E.readAsText(b)};return n?ot.jsxs(ot.Fragment,{children:[ot.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50",style:{zIndex:1050},onClick:t}),ot.jsxs("div",{className:"position-fixed top-50 start-50 translate-middle bg-white rounded shadow-lg p-4",style:{zIndex:1051,width:"500px",maxHeight:"80vh",overflowY:"auto"},children:[ot.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[ot.jsx("h5",{className:"mb-0",children:"Gerenciar Presets"}),ot.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:t,children:ot.jsx(rb,{size:16})})]}),ot.jsxs("div",{className:"mb-4 p-3 border rounded",children:[ot.jsx("h6",{children:"Salvar Preset Atual"}),ot.jsxs("div",{className:"d-flex gap-2",children:[ot.jsx("input",{type:"text",className:"form-control",placeholder:"Nome do preset...",value:i,onChange:_=>s(_.target.value),onKeyDown:_=>_.key==="Enter"&&d()}),ot.jsxs("button",{className:"btn btn-success",onClick:d,disabled:!i.trim()||e.length===0,children:[ot.jsx(XF,{size:16,className:"me-1"}),"Salvar"]})]}),ot.jsx("small",{className:"text-muted",children:e.length===0?"Nenhuma rea para salvar":e.length===1?"1 rea ser salva":`${e.length} reas sero salvas`})]}),ot.jsxs("div",{className:"mb-4",children:[ot.jsx("h6",{children:"Presets Salvos"}),o.length===0?ot.jsx("p",{className:"text-muted",children:"Nenhum preset salvo ainda."}):o.map((_,b)=>ot.jsxs("div",{className:"d-flex justify-content-between align-items-center p-2 border rounded mb-2",children:[ot.jsxs("div",{children:[ot.jsx("strong",{children:_.name}),ot.jsx("br",{}),ot.jsxs("small",{className:"text-muted",children:[_.areas.length," rea(s)"]})]}),ot.jsxs("div",{className:"d-flex gap-1",children:[ot.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>p(_),title:"Carregar preset",children:ot.jsx($F,{size:14})}),ot.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>v(_),title:"Download JSON",children:ot.jsx(hd,{size:14})}),ot.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>g(b),title:"Excluir preset",children:ot.jsx(ZF,{size:14})})]})]},b))]}),ot.jsxs("div",{className:"p-3 border rounded",children:[ot.jsx("h6",{children:"Importar Preset"}),ot.jsx("input",{type:"file",className:"form-control",accept:".json",onChange:_=>{y(_)}})]})]})]}):null};var ib=RS();const p6=vm(ib);function vi(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var g6=typeof Symbol=="function"&&Symbol.observable||"@@observable",YA=g6,qA=()=>Math.random().toString(36).substring(7).split("").join("."),m6={INIT:`@@redux/INIT${qA()}`,REPLACE:`@@redux/REPLACE${qA()}`},KA=m6;function v6(n){if(typeof n!="object"||n===null)return!1;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t||Object.getPrototypeOf(n)===null}function LC(n,t,e){if(typeof n!="function")throw new Error(vi(2));if(typeof t=="function"&&typeof e=="function"||typeof e=="function"&&typeof arguments[3]=="function")throw new Error(vi(0));if(typeof t=="function"&&typeof e>"u"&&(e=t,t=void 0),typeof e<"u"){if(typeof e!="function")throw new Error(vi(1));return e(LC)(n,t)}let r=n,i=t,s=new Map,o=s,l=0,u=!1;function h(){o===s&&(o=new Map,s.forEach((b,E)=>{o.set(E,b)}))}function d(){if(u)throw new Error(vi(3));return i}function p(b){if(typeof b!="function")throw new Error(vi(4));if(u)throw new Error(vi(5));let E=!0;h();const S=l++;return o.set(S,b),function(){if(E){if(u)throw new Error(vi(6));E=!1,h(),o.delete(S),s=null}}}function g(b){if(!v6(b))throw new Error(vi(7));if(typeof b.type>"u")throw new Error(vi(8));if(typeof b.type!="string")throw new Error(vi(17));if(u)throw new Error(vi(9));try{u=!0,i=r(i,b)}finally{u=!1}return(s=o).forEach(S=>{S()}),b}function v(b){if(typeof b!="function")throw new Error(vi(10));r=b,g({type:KA.REPLACE})}function y(){const b=p;return{subscribe(E){if(typeof E!="object"||E===null)throw new Error(vi(11));function S(){const O=E;O.next&&O.next(d())}return S(),{unsubscribe:b(S)}},[YA](){return this}}}return g({type:KA.INIT}),{dispatch:g,subscribe:p,getState:d,replaceReducer:v,[YA]:y}}function ZA(n,t){return function(...e){return t(n.apply(this,e))}}function QA(n,t){if(typeof n=="function")return ZA(n,t);if(typeof n!="object"||n===null)throw new Error(vi(16));const e={};for(const r in n){const i=n[r];typeof i=="function"&&(e[r]=ZA(i,t))}return e}function MC(...n){return n.length===0?t=>t:n.length===1?n[0]:n.reduce((t,e)=>(...r)=>t(e(...r)))}function _6(...n){return t=>(e,r)=>{const i=t(e,r);let s=()=>{throw new Error(vi(15))};const o={getState:i.getState,dispatch:(u,...h)=>s(u,...h)},l=n.map(u=>u(o));return s=MC(...l)(i.dispatch),{...i,dispatch:s}}}var l_={exports:{}},c_={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JA;function y6(){if(JA)return c_;JA=1;var n=_m();function t(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var e=typeof Object.is=="function"?Object.is:t,r=n.useSyncExternalStore,i=n.useRef,s=n.useEffect,o=n.useMemo,l=n.useDebugValue;return c_.useSyncExternalStoreWithSelector=function(u,h,d,p,g){var v=i(null);if(v.current===null){var y={hasValue:!1,value:null};v.current=y}else y=v.current;v=o(function(){function b(R){if(!E){if(E=!0,S=R,R=p(R),g!==void 0&&y.hasValue){var N=y.value;if(g(N,R))return T=N}return T=R}if(N=T,e(S,R))return N;var C=p(R);return g!==void 0&&g(N,C)?(S=R,N):(S=R,T=C)}var E=!1,S,T,O=d===void 0?null:d;return[function(){return b(h())},O===null?void 0:function(){return b(O())}]},[h,d,p,g]);var _=r(u,v[0],v[1]);return s(function(){y.hasValue=!0,y.value=_},[_]),l(_),_},c_}var t2;function b6(){return t2||(t2=1,l_.exports=y6()),l_.exports}b6();var x6=At.version.startsWith("19"),E6=Symbol.for(x6?"react.transitional.element":"react.element"),w6=Symbol.for("react.portal"),A6=Symbol.for("react.fragment"),S6=Symbol.for("react.strict_mode"),T6=Symbol.for("react.profiler"),C6=Symbol.for("react.consumer"),D6=Symbol.for("react.context"),IC=Symbol.for("react.forward_ref"),O6=Symbol.for("react.suspense"),R6=Symbol.for("react.suspense_list"),sb=Symbol.for("react.memo"),N6=Symbol.for("react.lazy"),k6=IC,L6=sb;function M6(n){if(typeof n=="object"&&n!==null){const{$$typeof:t}=n;switch(t){case E6:switch(n=n.type,n){case A6:case T6:case S6:case O6:case R6:return n;default:switch(n=n&&n.$$typeof,n){case D6:case IC:case N6:case sb:return n;case C6:return n;default:return t}}case w6:return t}}}function I6(n){return M6(n)===sb}function P6(n,t,e,r,{areStatesEqual:i,areOwnPropsEqual:s,areStatePropsEqual:o}){let l=!1,u,h,d,p,g;function v(S,T){return u=S,h=T,d=n(u,h),p=t(r,h),g=e(d,p,h),l=!0,g}function y(){return d=n(u,h),t.dependsOnOwnProps&&(p=t(r,h)),g=e(d,p,h),g}function _(){return n.dependsOnOwnProps&&(d=n(u,h)),t.dependsOnOwnProps&&(p=t(r,h)),g=e(d,p,h),g}function b(){const S=n(u,h),T=!o(S,d);return d=S,T&&(g=e(d,p,h)),g}function E(S,T){const O=!s(T,h),R=!i(S,u,T,h);return u=S,h=T,O&&R?y():O?_():R?b():g}return function(T,O){return l?E(T,O):v(T,O)}}function F6(n,{initMapStateToProps:t,initMapDispatchToProps:e,initMergeProps:r,...i}){const s=t(n,i),o=e(n,i),l=r(n,i);return P6(s,o,l,n,i)}function B6(n,t){const e={};for(const r in n){const i=n[r];typeof i=="function"&&(e[r]=(...s)=>t(i(...s)))}return e}function J_(n){return function(e){const r=n(e);function i(){return r}return i.dependsOnOwnProps=!1,i}}function e2(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function PC(n,t){return function(r,{displayName:i}){const s=function(l,u){return s.dependsOnOwnProps?s.mapToProps(l,u):s.mapToProps(l,void 0)};return s.dependsOnOwnProps=!0,s.mapToProps=function(l,u){s.mapToProps=n,s.dependsOnOwnProps=e2(n);let h=s(l,u);return typeof h=="function"&&(s.mapToProps=h,s.dependsOnOwnProps=e2(h),h=s(l,u)),h},s}}function ab(n,t){return(e,r)=>{throw new Error(`Invalid value of type ${typeof n} for ${t} argument when connecting component ${r.wrappedComponentName}.`)}}function U6(n){return n&&typeof n=="object"?J_(t=>B6(n,t)):n?typeof n=="function"?PC(n):ab(n,"mapDispatchToProps"):J_(t=>({dispatch:t}))}function z6(n){return n?typeof n=="function"?PC(n):ab(n,"mapStateToProps"):J_(()=>({}))}function H6(n,t,e){return{...e,...n,...t}}function j6(n){return function(e,{displayName:r,areMergedPropsEqual:i}){let s=!1,o;return function(u,h,d){const p=n(u,h,d);return s?i(p,o)||(o=p):(s=!0,o=p),o}}}function $6(n){return n?typeof n=="function"?j6(n):ab(n,"mergeProps"):()=>H6}function G6(n){n()}function V6(){let n=null,t=null;return{clear(){n=null,t=null},notify(){G6(()=>{let e=n;for(;e;)e.callback(),e=e.next})},get(){const e=[];let r=n;for(;r;)e.push(r),r=r.next;return e},subscribe(e){let r=!0;const i=t={callback:e,next:null,prev:t};return i.prev?i.prev.next=i:n=i,function(){!r||n===null||(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:n=i.next)}}}}var n2={notify(){},get:()=>[]};function FC(n,t){let e,r=n2,i=0,s=!1;function o(_){d();const b=r.subscribe(_);let E=!1;return()=>{E||(E=!0,b(),p())}}function l(){r.notify()}function u(){y.onStateChange&&y.onStateChange()}function h(){return s}function d(){i++,e||(e=t?t.addNestedSub(u):n.subscribe(u),r=V6())}function p(){i--,e&&i===0&&(e(),e=void 0,r.clear(),r=n2)}function g(){s||(s=!0,d())}function v(){s&&(s=!1,p())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:u,isSubscribed:h,trySubscribe:g,tryUnsubscribe:v,getListeners:()=>r};return y}var W6=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",X6=W6(),Y6=()=>typeof navigator<"u"&&navigator.product==="ReactNative",q6=Y6(),K6=()=>X6||q6?At.useLayoutEffect:At.useEffect,jg=K6();function r2(n,t){return n===t?n!==0||t!==0||1/n===1/t:n!==n&&t!==t}function u_(n,t){if(r2(n,t))return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null)return!1;const e=Object.keys(n),r=Object.keys(t);if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++)if(!Object.prototype.hasOwnProperty.call(t,e[i])||!r2(n[e[i]],t[e[i]]))return!1;return!0}var Z6={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Q6={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},J6={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},BC={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},t5={[k6]:J6,[L6]:BC};function i2(n){return I6(n)?BC:t5[n.$$typeof]||Z6}var e5=Object.defineProperty,n5=Object.getOwnPropertyNames,s2=Object.getOwnPropertySymbols,r5=Object.getOwnPropertyDescriptor,i5=Object.getPrototypeOf,a2=Object.prototype;function ty(n,t){if(typeof t!="string"){if(a2){const s=i5(t);s&&s!==a2&&ty(n,s)}let e=n5(t);s2&&(e=e.concat(s2(t)));const r=i2(n),i=i2(t);for(let s=0;s<e.length;++s){const o=e[s];if(!Q6[o]&&!(i&&i[o])&&!(r&&r[o])){const l=r5(t,o);try{e5(n,o,l)}catch{}}}}return n}var s5=Symbol.for("react-redux-context"),a5=typeof globalThis<"u"?globalThis:{};function o5(){if(!At.createContext)return{};const n=a5[s5]??=new Map;let t=n.get(At.createContext);return t||(t=At.createContext(null),n.set(At.createContext,t)),t}var UC=o5(),l5=[null,null];function c5(n,t,e){jg(()=>n(...t),e)}function u5(n,t,e,r,i,s){n.current=r,e.current=!1,i.current&&(i.current=null,s())}function f5(n,t,e,r,i,s,o,l,u,h,d){if(!n)return()=>{};let p=!1,g=null;const v=()=>{if(p||!l.current)return;const _=t.getState();let b,E;try{b=r(_,i.current)}catch(S){E=S,g=S}E||(g=null),b===s.current?o.current||h():(s.current=b,u.current=b,o.current=!0,d())};return e.onStateChange=v,e.trySubscribe(),v(),()=>{if(p=!0,e.tryUnsubscribe(),e.onStateChange=null,g)throw g}}function h5(n,t){return n===t}function d5(n,t,e,{pure:r,areStatesEqual:i=h5,areOwnPropsEqual:s=u_,areStatePropsEqual:o=u_,areMergedPropsEqual:l=u_,forwardRef:u=!1,context:h=UC}={}){const d=h,p=z6(n),g=U6(t),v=$6(e),y=!!n;return b=>{const E=b.displayName||b.name||"Component",S=`Connect(${E})`,T={shouldHandleStateChanges:y,displayName:S,wrappedComponentName:E,WrappedComponent:b,initMapStateToProps:p,initMapDispatchToProps:g,initMergeProps:v,areStatesEqual:i,areStatePropsEqual:o,areOwnPropsEqual:s,areMergedPropsEqual:l};function O(C){const[I,M,F]=At.useMemo(()=>{const{reactReduxForwardedRef:Dt,...Lt}=C;return[C.context,Dt,Lt]},[C]),H=At.useMemo(()=>{let Dt=d;return I?.Consumer,Dt},[I,d]),P=At.useContext(H),et=!!C.store&&!!C.store.getState&&!!C.store.dispatch,L=!!P&&!!P.store,st=et?C.store:P.store,Q=L?P.getServerState:st.getState,Y=At.useMemo(()=>F6(st.dispatch,T),[st]),[Ot,Et]=At.useMemo(()=>{if(!y)return l5;const Dt=FC(st,et?void 0:P.subscription),Lt=Dt.notifyNestedSubs.bind(Dt);return[Dt,Lt]},[st,et,P]),z=At.useMemo(()=>et?P:{...P,subscription:Ot},[et,P,Ot]),J=At.useRef(void 0),V=At.useRef(F),ct=At.useRef(void 0),gt=At.useRef(!1),_t=At.useRef(!1),Bt=At.useRef(void 0);jg(()=>(_t.current=!0,()=>{_t.current=!1}),[]);const Gt=At.useMemo(()=>()=>ct.current&&F===V.current?ct.current:Y(st.getState(),F),[st,F]),j=At.useMemo(()=>Lt=>Ot?f5(y,st,Ot,Y,V,J,gt,_t,ct,Et,Lt):()=>{},[Ot]);c5(u5,[V,J,gt,F,ct,Et]);let pt;try{pt=At.useSyncExternalStore(j,Gt,Q?()=>Y(Q(),F):Gt)}catch(Dt){throw Bt.current&&(Dt.message+=`
The error may be correlated with this previous error:
${Bt.current.stack}

`),Dt}jg(()=>{Bt.current=void 0,ct.current=void 0,J.current=pt});const lt=At.useMemo(()=>At.createElement(b,{...pt,ref:M}),[M,b,pt]);return At.useMemo(()=>y?At.createElement(H.Provider,{value:z},lt):lt,[H,lt,z])}const N=At.memo(O);if(N.WrappedComponent=b,N.displayName=O.displayName=S,u){const I=At.forwardRef(function(F,H){return At.createElement(N,{...F,reactReduxForwardedRef:H})});return I.displayName=S,I.WrappedComponent=b,ty(I,b)}return ty(N,b)}}var zC=d5;function p5(n){const{children:t,context:e,serverState:r,store:i}=n,s=At.useMemo(()=>{const u=FC(i);return{store:i,subscription:u,getServerState:r?()=>r:void 0}},[i,r]),o=At.useMemo(()=>i.getState(),[i]);jg(()=>{const{subscription:u}=s;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),o!==i.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[s,o]);const l=e||UC;return At.createElement(l.Provider,{value:s},t)}var g5=p5,ea=function(t){var e=t.top,r=t.right,i=t.bottom,s=t.left,o=r-s,l=i-e,u={top:e,right:r,bottom:i,left:s,width:o,height:l,x:s,y:e,center:{x:(r+s)/2,y:(i+e)/2}};return u},ob=function(t,e){return{top:t.top-e.top,left:t.left-e.left,bottom:t.bottom+e.bottom,right:t.right+e.right}},o2=function(t,e){return{top:t.top+e.top,left:t.left+e.left,bottom:t.bottom-e.bottom,right:t.right-e.right}},m5=function(t,e){return{top:t.top+e.y,left:t.left+e.x,bottom:t.bottom+e.y,right:t.right+e.x}},f_={top:0,right:0,bottom:0,left:0},lb=function(t){var e=t.borderBox,r=t.margin,i=r===void 0?f_:r,s=t.border,o=s===void 0?f_:s,l=t.padding,u=l===void 0?f_:l,h=ea(ob(e,i)),d=ea(o2(e,o)),p=ea(o2(d,u));return{marginBox:h,borderBox:ea(e),paddingBox:d,contentBox:p,margin:i,border:o,padding:u}},Ts=function(t){var e=t.slice(0,-2),r=t.slice(-2);if(r!=="px")return 0;var i=Number(e);return isNaN(i)&&En(!1),i},v5=function(){return{x:window.pageXOffset,y:window.pageYOffset}},$g=function(t,e){var r=t.borderBox,i=t.border,s=t.margin,o=t.padding,l=m5(r,e);return lb({borderBox:l,border:i,margin:s,padding:o})},Gg=function(t,e){return e===void 0&&(e=v5()),$g(t,e)},HC=function(t,e){var r={top:Ts(e.marginTop),right:Ts(e.marginRight),bottom:Ts(e.marginBottom),left:Ts(e.marginLeft)},i={top:Ts(e.paddingTop),right:Ts(e.paddingRight),bottom:Ts(e.paddingBottom),left:Ts(e.paddingLeft)},s={top:Ts(e.borderTopWidth),right:Ts(e.borderRightWidth),bottom:Ts(e.borderBottomWidth),left:Ts(e.borderLeftWidth)};return lb({borderBox:t,margin:r,padding:i,border:s})},jC=function(t){var e=t.getBoundingClientRect(),r=window.getComputedStyle(t);return HC(e,r)},Cd=function(t){var e=[],r=null,i=function(){for(var o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];e=l,!r&&(r=requestAnimationFrame(function(){r=null,t.apply(void 0,e)}))};return i.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},i};function Vg(){return Vg=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},Vg.apply(null,arguments)}function $C(n,t){}$C.bind(null,"warn");$C.bind(null,"error");function El(){}function _5(n,t){return{...n,...t}}function Ns(n,t,e){const r=t.map(i=>{const s=_5(e,i.options);return n.addEventListener(i.eventName,i.fn,s),function(){n.removeEventListener(i.eventName,i.fn,s)}});return function(){r.forEach(s=>{s()})}}const y5="Invariant failed";class Wg extends Error{}Wg.prototype.toString=function(){return this.message};function ie(n,t){throw new Wg(y5)}class b5 extends Qn.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=El,this.onWindowError=e=>{const r=this.getCallbacks();r.isDragging()&&r.tryAbort(),e.error instanceof Wg&&e.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=e=>{this.callbacks=e}}componentDidMount(){this.unbind=Ns(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof Wg){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const x5=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,Xg=n=>n+1,E5=n=>`
  You have lifted an item in position ${Xg(n.source.index)}
`,GC=(n,t)=>{const e=n.droppableId===t.droppableId,r=Xg(n.index),i=Xg(t.index);return e?`
      You have moved the item from position ${r}
      to position ${i}
    `:`
    You have moved the item from position ${r}
    in list ${n.droppableId}
    to list ${t.droppableId}
    in position ${i}
  `},VC=(n,t,e)=>t.droppableId===e.droppableId?`
      The item ${n}
      has been combined with ${e.draggableId}`:`
      The item ${n}
      in list ${t.droppableId}
      has been combined with ${e.draggableId}
      in list ${e.droppableId}
    `,w5=n=>{const t=n.destination;if(t)return GC(n.source,t);const e=n.combine;return e?VC(n.draggableId,n.source,e):"You are over an area that cannot be dropped on"},l2=n=>`
  The item has returned to its starting position
  of ${Xg(n.index)}
`,A5=n=>{if(n.reason==="CANCEL")return`
      Movement cancelled.
      ${l2(n.source)}
    `;const t=n.destination,e=n.combine;return t?`
      You have dropped the item.
      ${GC(n.source,t)}
    `:e?`
      You have dropped the item.
      ${VC(n.draggableId,n.source,e)}
    `:`
    The item has been dropped while not over a drop area.
    ${l2(n.source)}
  `},Lg={dragHandleUsageInstructions:x5,onDragStart:E5,onDragUpdate:w5,onDragEnd:A5};function S5(n,t){return!!(n===t||Number.isNaN(n)&&Number.isNaN(t))}function WC(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!S5(n[e],t[e]))return!1;return!0}function nn(n,t){const e=At.useState(()=>({inputs:t,result:n()}))[0],r=At.useRef(!0),i=At.useRef(e),o=r.current||!!(t&&i.current.inputs&&WC(t,i.current.inputs))?i.current:{inputs:t,result:n()};return At.useEffect(()=>{r.current=!1,i.current=o},[o]),o.result}function ye(n,t){return nn(()=>n,t)}const Dr={x:0,y:0},Br=(n,t)=>({x:n.x+t.x,y:n.y+t.y}),os=(n,t)=>({x:n.x-t.x,y:n.y-t.y}),wl=(n,t)=>n.x===t.x&&n.y===t.y,_f=n=>({x:n.x!==0?-n.x:0,y:n.y!==0?-n.y:0}),Oc=(n,t,e=0)=>n==="x"?{x:t,y:e}:{x:e,y:t},Dd=(n,t)=>Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2),c2=(n,t)=>Math.min(...t.map(e=>Dd(n,e))),XC=n=>t=>({x:n(t.x),y:n(t.y)});var T5=(n,t)=>{const e=ea({top:Math.max(t.top,n.top),right:Math.min(t.right,n.right),bottom:Math.min(t.bottom,n.bottom),left:Math.max(t.left,n.left)});return e.width<=0||e.height<=0?null:e};const s0=(n,t)=>({top:n.top+t.y,left:n.left+t.x,bottom:n.bottom+t.y,right:n.right+t.x}),u2=n=>[{x:n.left,y:n.top},{x:n.right,y:n.top},{x:n.left,y:n.bottom},{x:n.right,y:n.bottom}],C5={top:0,right:0,bottom:0,left:0},D5=(n,t)=>t?s0(n,t.scroll.diff.displacement):n,O5=(n,t,e)=>e&&e.increasedBy?{...n,[t.end]:n[t.end]+e.increasedBy[t.line]}:n,R5=(n,t)=>t&&t.shouldClipSubject?T5(t.pageMarginBox,n):ea(n);var cf=({page:n,withPlaceholder:t,axis:e,frame:r})=>{const i=D5(n.marginBox,r),s=O5(i,e,t),o=R5(s,r);return{page:n,withPlaceholder:t,active:o}},cb=(n,t)=>{n.frame||ie();const e=n.frame,r=os(t,e.scroll.initial),i=_f(r),s={...e,scroll:{initial:e.scroll.initial,current:t,diff:{value:r,displacement:i},max:e.scroll.max}},o=cf({page:n.subject.page,withPlaceholder:n.subject.withPlaceholder,axis:n.axis,frame:s});return{...n,frame:s,subject:o}};function Cr(n,t=WC){let e=null;function r(...i){if(e&&e.lastThis===this&&t(i,e.lastArgs))return e.lastResult;const s=n.apply(this,i);return e={lastResult:s,lastArgs:i,lastThis:this},s}return r.clear=function(){e=null},r}const YC=Cr(n=>n.reduce((t,e)=>(t[e.descriptor.id]=e,t),{})),qC=Cr(n=>n.reduce((t,e)=>(t[e.descriptor.id]=e,t),{})),Fm=Cr(n=>Object.values(n)),N5=Cr(n=>Object.values(n));var yf=Cr((n,t)=>N5(t).filter(r=>n===r.descriptor.droppableId).sort((r,i)=>r.descriptor.index-i.descriptor.index));function ub(n){return n.at&&n.at.type==="REORDER"?n.at.destination:null}function Bm(n){return n.at&&n.at.type==="COMBINE"?n.at.combine:null}var Um=Cr((n,t)=>t.filter(e=>e.descriptor.id!==n.descriptor.id)),k5=({isMovingForward:n,draggable:t,destination:e,insideDestination:r,previousImpact:i})=>{if(!e.isCombineEnabled||!ub(i))return null;function o(v){const y={type:"COMBINE",combine:{draggableId:v,droppableId:e.descriptor.id}};return{...i,at:y}}const l=i.displaced.all,u=l.length?l[0]:null;if(n)return u?o(u):null;const h=Um(t,r);if(!u){if(!h.length)return null;const v=h[h.length-1];return o(v.descriptor.id)}const d=h.findIndex(v=>v.descriptor.id===u);d===-1&&ie();const p=d-1;if(p<0)return null;const g=h[p];return o(g.descriptor.id)},bf=(n,t)=>n.descriptor.droppableId===t.descriptor.id;const KC={point:Dr,value:0},Od={invisible:{},visible:{},all:[]},L5={displaced:Od,displacedBy:KC,at:null};var Ls=(n,t)=>e=>n<=e&&e<=t,ZC=n=>{const t=Ls(n.top,n.bottom),e=Ls(n.left,n.right);return r=>{if(t(r.top)&&t(r.bottom)&&e(r.left)&&e(r.right))return!0;const s=t(r.top)||t(r.bottom),o=e(r.left)||e(r.right);if(s&&o)return!0;const u=r.top<n.top&&r.bottom>n.bottom,h=r.left<n.left&&r.right>n.right;return u&&h?!0:u&&o||h&&s}},M5=n=>{const t=Ls(n.top,n.bottom),e=Ls(n.left,n.right);return r=>t(r.top)&&t(r.bottom)&&e(r.left)&&e(r.right)};const fb={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},QC={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var I5=n=>t=>{const e=Ls(t.top,t.bottom),r=Ls(t.left,t.right);return i=>n===fb?e(i.top)&&e(i.bottom):r(i.left)&&r(i.right)};const P5=(n,t)=>{const e=t.frame?t.frame.scroll.diff.displacement:Dr;return s0(n,e)},F5=(n,t,e)=>t.subject.active?e(t.subject.active)(n):!1,B5=(n,t,e)=>e(t)(n),hb=({target:n,destination:t,viewport:e,withDroppableDisplacement:r,isVisibleThroughFrameFn:i})=>{const s=r?P5(n,t):n;return F5(s,t,i)&&B5(s,e,i)},U5=n=>hb({...n,isVisibleThroughFrameFn:ZC}),JC=n=>hb({...n,isVisibleThroughFrameFn:M5}),z5=n=>hb({...n,isVisibleThroughFrameFn:I5(n.destination.axis)}),H5=(n,t,e)=>{if(typeof e=="boolean")return e;if(!t)return!0;const{invisible:r,visible:i}=t;if(r[n])return!1;const s=i[n];return s?s.shouldAnimate:!0};function j5(n,t){const e=n.page.marginBox,r={top:t.point.y,right:0,bottom:0,left:t.point.x};return ea(ob(e,r))}function Rd({afterDragging:n,destination:t,displacedBy:e,viewport:r,forceShouldAnimate:i,last:s}){return n.reduce(function(l,u){const h=j5(u,e),d=u.descriptor.id;if(l.all.push(d),!U5({target:h,destination:t,viewport:r,withDroppableDisplacement:!0}))return l.invisible[u.descriptor.id]=!0,l;const g=H5(d,s,i),v={draggableId:d,shouldAnimate:g};return l.visible[d]=v,l},{all:[],visible:{},invisible:{}})}function $5(n,t){if(!n.length)return 0;const e=n[n.length-1].descriptor.index;return t.inHomeList?e:e+1}function f2({insideDestination:n,inHomeList:t,displacedBy:e,destination:r}){const i=$5(n,{inHomeList:t});return{displaced:Od,displacedBy:e,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:i}}}}function Yg({draggable:n,insideDestination:t,destination:e,viewport:r,displacedBy:i,last:s,index:o,forceShouldAnimate:l}){const u=bf(n,e);if(o==null)return f2({insideDestination:t,inHomeList:u,displacedBy:i,destination:e});const h=t.find(y=>y.descriptor.index===o);if(!h)return f2({insideDestination:t,inHomeList:u,displacedBy:i,destination:e});const d=Um(n,t),p=t.indexOf(h),g=d.slice(p);return{displaced:Rd({afterDragging:g,destination:e,displacedBy:i,last:s,viewport:r.frame,forceShouldAnimate:l}),displacedBy:i,at:{type:"REORDER",destination:{droppableId:e.descriptor.id,index:o}}}}function Dl(n,t){return!!t.effected[n]}var G5=({isMovingForward:n,destination:t,draggables:e,combine:r,afterCritical:i})=>{if(!t.isCombineEnabled)return null;const s=r.draggableId,l=e[s].descriptor.index;return Dl(s,i)?n?l:l-1:n?l+1:l},V5=({isMovingForward:n,isInHomeList:t,insideDestination:e,location:r})=>{if(!e.length)return null;const i=r.index,s=n?i+1:i-1,o=e[0].descriptor.index,l=e[e.length-1].descriptor.index,u=t?l:l+1;return s<o||s>u?null:s},W5=({isMovingForward:n,isInHomeList:t,draggable:e,draggables:r,destination:i,insideDestination:s,previousImpact:o,viewport:l,afterCritical:u})=>{const h=o.at;if(h||ie(),h.type==="REORDER"){const p=V5({isMovingForward:n,isInHomeList:t,location:h.destination,insideDestination:s});return p==null?null:Yg({draggable:e,insideDestination:s,destination:i,viewport:l,last:o.displaced,displacedBy:o.displacedBy,index:p})}const d=G5({isMovingForward:n,destination:i,displaced:o.displaced,draggables:r,combine:h.combine,afterCritical:u});return d==null?null:Yg({draggable:e,insideDestination:s,destination:i,viewport:l,last:o.displaced,displacedBy:o.displacedBy,index:d})},X5=({displaced:n,afterCritical:t,combineWith:e,displacedBy:r})=>{const i=!!(n.visible[e]||n.invisible[e]);return Dl(e,t)?i?Dr:_f(r.point):i?r.point:Dr},Y5=({afterCritical:n,impact:t,draggables:e})=>{const r=Bm(t);r||ie();const i=r.draggableId,s=e[i].page.borderBox.center,o=X5({displaced:t.displaced,afterCritical:n,combineWith:i,displacedBy:t.displacedBy});return Br(s,o)};const tD=(n,t)=>t.margin[n.start]+t.borderBox[n.size]/2,q5=(n,t)=>t.margin[n.end]+t.borderBox[n.size]/2,db=(n,t,e)=>t[n.crossAxisStart]+e.margin[n.crossAxisStart]+e.borderBox[n.crossAxisSize]/2,h2=({axis:n,moveRelativeTo:t,isMoving:e})=>Oc(n.line,t.marginBox[n.end]+tD(n,e),db(n,t.marginBox,e)),d2=({axis:n,moveRelativeTo:t,isMoving:e})=>Oc(n.line,t.marginBox[n.start]-q5(n,e),db(n,t.marginBox,e)),K5=({axis:n,moveInto:t,isMoving:e})=>Oc(n.line,t.contentBox[n.start]+tD(n,e),db(n,t.contentBox,e));var Z5=({impact:n,draggable:t,draggables:e,droppable:r,afterCritical:i})=>{const s=yf(r.descriptor.id,e),o=t.page,l=r.axis;if(!s.length)return K5({axis:l,moveInto:r.page,isMoving:o});const{displaced:u,displacedBy:h}=n,d=u.all[0];if(d){const g=e[d];if(Dl(d,i))return d2({axis:l,moveRelativeTo:g.page,isMoving:o});const v=$g(g.page,h.point);return d2({axis:l,moveRelativeTo:v,isMoving:o})}const p=s[s.length-1];if(p.descriptor.id===t.descriptor.id)return o.borderBox.center;if(Dl(p.descriptor.id,i)){const g=$g(p.page,_f(i.displacedBy.point));return h2({axis:l,moveRelativeTo:g,isMoving:o})}return h2({axis:l,moveRelativeTo:p.page,isMoving:o})},ey=(n,t)=>{const e=n.frame;return e?Br(t,e.scroll.diff.displacement):t};const Q5=({impact:n,draggable:t,droppable:e,draggables:r,afterCritical:i})=>{const s=t.page.borderBox.center,o=n.at;return!e||!o?s:o.type==="REORDER"?Z5({impact:n,draggable:t,draggables:r,droppable:e,afterCritical:i}):Y5({impact:n,draggables:r,afterCritical:i})};var zm=n=>{const t=Q5(n),e=n.droppable;return e?ey(e,t):t},eD=(n,t)=>{const e=os(t,n.scroll.initial),r=_f(e);return{frame:ea({top:t.y,bottom:t.y+n.frame.height,left:t.x,right:t.x+n.frame.width}),scroll:{initial:n.scroll.initial,max:n.scroll.max,current:t,diff:{value:e,displacement:r}}}};function p2(n,t){return n.map(e=>t[e])}function J5(n,t){for(let e=0;e<t.length;e++){const r=t[e].visible[n];if(r)return r}return null}var t8=({impact:n,viewport:t,destination:e,draggables:r,maxScrollChange:i})=>{const s=eD(t,Br(t.scroll.current,i)),o=e.frame?cb(e,Br(e.frame.scroll.current,i)):e,l=n.displaced,u=Rd({afterDragging:p2(l.all,r),destination:e,displacedBy:n.displacedBy,viewport:s.frame,last:l,forceShouldAnimate:!1}),h=Rd({afterDragging:p2(l.all,r),destination:o,displacedBy:n.displacedBy,viewport:t.frame,last:l,forceShouldAnimate:!1}),d={},p={},g=[l,u,h];return l.all.forEach(y=>{const _=J5(y,g);if(_){p[y]=_;return}d[y]=!0}),{...n,displaced:{all:l.all,invisible:d,visible:p}}},e8=(n,t)=>Br(n.scroll.diff.displacement,t),pb=({pageBorderBoxCenter:n,draggable:t,viewport:e})=>{const r=e8(e,n),i=os(r,t.page.borderBox.center);return Br(t.client.borderBox.center,i)},nD=({draggable:n,destination:t,newPageBorderBoxCenter:e,viewport:r,withDroppableDisplacement:i,onlyOnMainAxis:s=!1})=>{const o=os(e,n.page.borderBox.center),u={target:s0(n.page.borderBox,o),destination:t,withDroppableDisplacement:i,viewport:r};return s?z5(u):JC(u)},n8=({isMovingForward:n,draggable:t,destination:e,draggables:r,previousImpact:i,viewport:s,previousPageBorderBoxCenter:o,previousClientSelection:l,afterCritical:u})=>{if(!e.isEnabled)return null;const h=yf(e.descriptor.id,r),d=bf(t,e),p=k5({isMovingForward:n,draggable:t,destination:e,insideDestination:h,previousImpact:i})||W5({isMovingForward:n,isInHomeList:d,draggable:t,draggables:r,destination:e,insideDestination:h,previousImpact:i,viewport:s,afterCritical:u});if(!p)return null;const g=zm({impact:p,draggable:t,droppable:e,draggables:r,afterCritical:u});if(nD({draggable:t,destination:e,newPageBorderBoxCenter:g,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:pb({pageBorderBoxCenter:g,draggable:t,viewport:s}),impact:p,scrollJumpRequest:null};const y=os(g,o),_=t8({impact:p,viewport:s,destination:e,draggables:r,maxScrollChange:y});return{clientSelection:l,impact:_,scrollJumpRequest:y}};const mi=n=>{const t=n.subject.active;return t||ie(),t};var r8=({isMovingForward:n,pageBorderBoxCenter:t,source:e,droppables:r,viewport:i})=>{const s=e.subject.active;if(!s)return null;const o=e.axis,l=Ls(s[o.start],s[o.end]),u=Fm(r).filter(d=>d!==e).filter(d=>d.isEnabled).filter(d=>!!d.subject.active).filter(d=>ZC(i.frame)(mi(d))).filter(d=>{const p=mi(d);return n?s[o.crossAxisEnd]<p[o.crossAxisEnd]:p[o.crossAxisStart]<s[o.crossAxisStart]}).filter(d=>{const p=mi(d),g=Ls(p[o.start],p[o.end]);return l(p[o.start])||l(p[o.end])||g(s[o.start])||g(s[o.end])}).sort((d,p)=>{const g=mi(d)[o.crossAxisStart],v=mi(p)[o.crossAxisStart];return n?g-v:v-g}).filter((d,p,g)=>mi(d)[o.crossAxisStart]===mi(g[0])[o.crossAxisStart]);if(!u.length)return null;if(u.length===1)return u[0];const h=u.filter(d=>Ls(mi(d)[o.start],mi(d)[o.end])(t[o.line]));return h.length===1?h[0]:h.length>1?h.sort((d,p)=>mi(d)[o.start]-mi(p)[o.start])[0]:u.sort((d,p)=>{const g=c2(t,u2(mi(d))),v=c2(t,u2(mi(p)));return g!==v?g-v:mi(d)[o.start]-mi(p)[o.start]})[0]};const g2=(n,t)=>{const e=n.page.borderBox.center;return Dl(n.descriptor.id,t)?os(e,t.displacedBy.point):e},i8=(n,t)=>{const e=n.page.borderBox;return Dl(n.descriptor.id,t)?s0(e,_f(t.displacedBy.point)):e};var s8=({pageBorderBoxCenter:n,viewport:t,destination:e,insideDestination:r,afterCritical:i})=>r.filter(o=>JC({target:i8(o,i),destination:e,viewport:t.frame,withDroppableDisplacement:!0})).sort((o,l)=>{const u=Dd(n,ey(e,g2(o,i))),h=Dd(n,ey(e,g2(l,i)));return u<h?-1:h<u?1:o.descriptor.index-l.descriptor.index})[0]||null,a0=Cr(function(t,e){const r=e[t.line];return{value:r,point:Oc(t.line,r)}});const a8=(n,t,e)=>{const r=n.axis;if(n.descriptor.mode==="virtual")return Oc(r.line,t[r.line]);const i=n.subject.page.contentBox[r.size],u=yf(n.descriptor.id,e).reduce((h,d)=>h+d.client.marginBox[r.size],0)+t[r.line]-i;return u<=0?null:Oc(r.line,u)},rD=(n,t)=>({...n,scroll:{...n.scroll,max:t}}),iD=(n,t,e)=>{const r=n.frame;bf(t,n)&&ie(),n.subject.withPlaceholder&&ie();const i=a0(n.axis,t.displaceBy).point,s=a8(n,i,e),o={placeholderSize:i,increasedBy:s,oldFrameMaxScroll:n.frame?n.frame.scroll.max:null};if(!r){const d=cf({page:n.subject.page,withPlaceholder:o,axis:n.axis,frame:n.frame});return{...n,subject:d}}const l=s?Br(r.scroll.max,s):r.scroll.max,u=rD(r,l),h=cf({page:n.subject.page,withPlaceholder:o,axis:n.axis,frame:u});return{...n,subject:h,frame:u}},o8=n=>{const t=n.subject.withPlaceholder;t||ie();const e=n.frame;if(!e){const o=cf({page:n.subject.page,axis:n.axis,frame:null,withPlaceholder:null});return{...n,subject:o}}const r=t.oldFrameMaxScroll;r||ie();const i=rD(e,r),s=cf({page:n.subject.page,axis:n.axis,frame:i,withPlaceholder:null});return{...n,subject:s,frame:i}};var l8=({previousPageBorderBoxCenter:n,moveRelativeTo:t,insideDestination:e,draggable:r,draggables:i,destination:s,viewport:o,afterCritical:l})=>{if(!t){if(e.length)return null;const p={displaced:Od,displacedBy:KC,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:0}}},g=zm({impact:p,draggable:r,droppable:s,draggables:i,afterCritical:l}),v=bf(r,s)?s:iD(s,r,i);return nD({draggable:r,destination:v,newPageBorderBoxCenter:g,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?p:null}const u=n[s.axis.line]<=t.page.borderBox.center[s.axis.line],h=(()=>{const p=t.descriptor.index;return t.descriptor.id===r.descriptor.id||u?p:p+1})(),d=a0(s.axis,r.displaceBy);return Yg({draggable:r,insideDestination:e,destination:s,viewport:o,displacedBy:d,last:Od,index:h})},c8=({isMovingForward:n,previousPageBorderBoxCenter:t,draggable:e,isOver:r,draggables:i,droppables:s,viewport:o,afterCritical:l})=>{const u=r8({isMovingForward:n,pageBorderBoxCenter:t,source:r,droppables:s,viewport:o});if(!u)return null;const h=yf(u.descriptor.id,i),d=s8({pageBorderBoxCenter:t,viewport:o,destination:u,insideDestination:h,afterCritical:l}),p=l8({previousPageBorderBoxCenter:t,destination:u,draggable:e,draggables:i,moveRelativeTo:d,insideDestination:h,viewport:o,afterCritical:l});if(!p)return null;const g=zm({impact:p,draggable:e,droppable:u,draggables:i,afterCritical:l});return{clientSelection:pb({pageBorderBoxCenter:g,draggable:e,viewport:o}),impact:p,scrollJumpRequest:null}},cs=n=>{const t=n.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const u8=(n,t)=>{const e=cs(n);return e?t[e]:null};var f8=({state:n,type:t})=>{const e=u8(n.impact,n.dimensions.droppables),r=!!e,i=n.dimensions.droppables[n.critical.droppable.id],s=e||i,o=s.axis.direction,l=o==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||o==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(l&&!r)return null;const u=t==="MOVE_DOWN"||t==="MOVE_RIGHT",h=n.dimensions.draggables[n.critical.draggable.id],d=n.current.page.borderBoxCenter,{draggables:p,droppables:g}=n.dimensions;return l?n8({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:h,destination:s,draggables:p,viewport:n.viewport,previousClientSelection:n.current.client.selection,previousImpact:n.impact,afterCritical:n.afterCritical}):c8({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:h,isOver:s,draggables:p,droppables:g,viewport:n.viewport,afterCritical:n.afterCritical})};function fc(n){return n.phase==="DRAGGING"||n.phase==="COLLECTING"}function sD(n){const t=Ls(n.top,n.bottom),e=Ls(n.left,n.right);return function(i){return t(i.y)&&e(i.x)}}function h8(n,t){return n.left<t.right&&n.right>t.left&&n.top<t.bottom&&n.bottom>t.top}function d8({pageBorderBox:n,draggable:t,candidates:e}){const r=t.page.borderBox.center,i=e.map(s=>{const o=s.axis,l=Oc(s.axis.line,n.center[o.line],s.page.borderBox.center[o.crossAxisLine]);return{id:s.descriptor.id,distance:Dd(r,l)}}).sort((s,o)=>o.distance-s.distance);return i[0]?i[0].id:null}function p8({pageBorderBox:n,draggable:t,droppables:e}){const r=Fm(e).filter(i=>{if(!i.isEnabled)return!1;const s=i.subject.active;if(!s||!h8(n,s))return!1;if(sD(s)(n.center))return!0;const o=i.axis,l=s.center[o.crossAxisLine],u=n[o.crossAxisStart],h=n[o.crossAxisEnd],d=Ls(s[o.crossAxisStart],s[o.crossAxisEnd]),p=d(u),g=d(h);return!p&&!g?!0:p?u<l:h>l});return r.length?r.length===1?r[0].descriptor.id:d8({pageBorderBox:n,draggable:t,candidates:r}):null}const aD=(n,t)=>ea(s0(n,t));var g8=(n,t)=>{const e=n.frame;return e?aD(t,e.scroll.diff.value):t};function oD({displaced:n,id:t}){return!!(n.visible[t]||n.invisible[t])}function m8({draggable:n,closest:t,inHomeList:e}){return t?e&&t.descriptor.index>n.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var v8=({pageBorderBoxWithDroppableScroll:n,draggable:t,destination:e,insideDestination:r,last:i,viewport:s,afterCritical:o})=>{const l=e.axis,u=a0(e.axis,t.displaceBy),h=u.value,d=n[l.start],p=n[l.end],v=Um(t,r).find(_=>{const b=_.descriptor.id,E=_.page.borderBox.center[l.line],S=Dl(b,o),T=oD({displaced:i,id:b});return S?T?p<=E:d<E-h:T?p<=E+h:d<E})||null,y=m8({draggable:t,closest:v,inHomeList:bf(t,e)});return Yg({draggable:t,insideDestination:r,destination:e,viewport:s,last:i,displacedBy:u,index:y})};const _8=4;var y8=({draggable:n,pageBorderBoxWithDroppableScroll:t,previousImpact:e,destination:r,insideDestination:i,afterCritical:s})=>{if(!r.isCombineEnabled)return null;const o=r.axis,l=a0(r.axis,n.displaceBy),u=l.value,h=t[o.start],d=t[o.end],g=Um(n,i).find(y=>{const _=y.descriptor.id,b=y.page.borderBox,S=b[o.size]/_8,T=Dl(_,s),O=oD({displaced:e.displaced,id:_});return T?O?d>b[o.start]+S&&d<b[o.end]-S:h>b[o.start]-u+S&&h<b[o.end]-u-S:O?d>b[o.start]+u+S&&d<b[o.end]+u-S:h>b[o.start]+S&&h<b[o.end]-S});return g?{displacedBy:l,displaced:e.displaced,at:{type:"COMBINE",combine:{draggableId:g.descriptor.id,droppableId:r.descriptor.id}}}:null},lD=({pageOffset:n,draggable:t,draggables:e,droppables:r,previousImpact:i,viewport:s,afterCritical:o})=>{const l=aD(t.page.borderBox,n),u=p8({pageBorderBox:l,draggable:t,droppables:r});if(!u)return L5;const h=r[u],d=yf(h.descriptor.id,e),p=g8(h,l);return y8({pageBorderBoxWithDroppableScroll:p,draggable:t,previousImpact:i,destination:h,insideDestination:d,afterCritical:o})||v8({pageBorderBoxWithDroppableScroll:p,draggable:t,destination:h,insideDestination:d,last:i.displaced,viewport:s,afterCritical:o})},gb=(n,t)=>({...n,[t.descriptor.id]:t});const b8=({previousImpact:n,impact:t,droppables:e})=>{const r=cs(n),i=cs(t);if(!r||r===i)return e;const s=e[r];if(!s.subject.withPlaceholder)return e;const o=o8(s);return gb(e,o)};var x8=({draggable:n,draggables:t,droppables:e,previousImpact:r,impact:i})=>{const s=b8({previousImpact:r,impact:i,droppables:e}),o=cs(i);if(!o)return s;const l=e[o];if(bf(n,l)||l.subject.withPlaceholder)return s;const u=iD(l,n,t);return gb(s,u)},dd=({state:n,clientSelection:t,dimensions:e,viewport:r,impact:i,scrollJumpRequest:s})=>{const o=r||n.viewport,l=e||n.dimensions,u=t||n.current.client.selection,h=os(u,n.initial.client.selection),d={offset:h,selection:u,borderBoxCenter:Br(n.initial.client.borderBoxCenter,h)},p={selection:Br(d.selection,o.scroll.current),borderBoxCenter:Br(d.borderBoxCenter,o.scroll.current),offset:Br(d.offset,o.scroll.diff.value)},g={client:d,page:p};if(n.phase==="COLLECTING")return{...n,dimensions:l,viewport:o,current:g};const v=l.draggables[n.critical.draggable.id],y=i||lD({pageOffset:p.offset,draggable:v,draggables:l.draggables,droppables:l.droppables,previousImpact:n.impact,viewport:o,afterCritical:n.afterCritical}),_=x8({draggable:v,impact:y,previousImpact:n.impact,draggables:l.draggables,droppables:l.droppables});return{...n,current:g,dimensions:{draggables:l.draggables,droppables:_},impact:y,viewport:o,scrollJumpRequest:s||null,forceShouldAnimate:s?!1:null}};function E8(n,t){return n.map(e=>t[e])}var cD=({impact:n,viewport:t,draggables:e,destination:r,forceShouldAnimate:i})=>{const s=n.displaced,o=E8(s.all,e),l=Rd({afterDragging:o,destination:r,displacedBy:n.displacedBy,viewport:t.frame,forceShouldAnimate:i,last:s});return{...n,displaced:l}},uD=({impact:n,draggable:t,droppable:e,draggables:r,viewport:i,afterCritical:s})=>{const o=zm({impact:n,draggable:t,draggables:r,droppable:e,afterCritical:s});return pb({pageBorderBoxCenter:o,draggable:t,viewport:i})},fD=({state:n,dimensions:t,viewport:e})=>{n.movementMode!=="SNAP"&&ie();const r=n.impact,i=e||n.viewport,s=t||n.dimensions,{draggables:o,droppables:l}=s,u=o[n.critical.draggable.id],h=cs(r);h||ie();const d=l[h],p=cD({impact:r,viewport:i,destination:d,draggables:o}),g=uD({impact:p,draggable:u,droppable:d,draggables:o,viewport:i,afterCritical:n.afterCritical});return dd({impact:p,clientSelection:g,state:n,dimensions:s,viewport:i})},w8=n=>({index:n.index,droppableId:n.droppableId}),hD=({draggable:n,home:t,draggables:e,viewport:r})=>{const i=a0(t.axis,n.displaceBy),s=yf(t.descriptor.id,e),o=s.indexOf(n);o===-1&&ie();const l=s.slice(o+1),u=l.reduce((g,v)=>(g[v.descriptor.id]=!0,g),{}),h={inVirtualList:t.descriptor.mode==="virtual",displacedBy:i,effected:u};return{impact:{displaced:Rd({afterDragging:l,destination:t,displacedBy:i,last:null,viewport:r.frame,forceShouldAnimate:!1}),displacedBy:i,at:{type:"REORDER",destination:w8(n.descriptor)}},afterCritical:h}},A8=(n,t)=>({draggables:n.draggables,droppables:gb(n.droppables,t)}),S8=({draggable:n,offset:t,initialWindowScroll:e})=>{const r=$g(n.client,t),i=Gg(r,e);return{...n,placeholder:{...n.placeholder,client:r},client:r,page:i}},T8=n=>{const t=n.frame;return t||ie(),t},C8=({additions:n,updatedDroppables:t,viewport:e})=>{const r=e.scroll.diff.value;return n.map(i=>{const s=i.descriptor.droppableId,o=t[s],u=T8(o).scroll.diff.value,h=Br(r,u);return S8({draggable:i,offset:h,initialWindowScroll:e.scroll.initial})})},D8=({state:n,published:t})=>{const e=t.modified.map(E=>{const S=n.dimensions.droppables[E.droppableId];return cb(S,E.scroll)}),r={...n.dimensions.droppables,...YC(e)},i=qC(C8({additions:t.additions,updatedDroppables:r,viewport:n.viewport})),s={...n.dimensions.draggables,...i};t.removals.forEach(E=>{delete s[E]});const o={droppables:r,draggables:s},l=cs(n.impact),u=l?o.droppables[l]:null,h=o.draggables[n.critical.draggable.id],d=o.droppables[n.critical.droppable.id],{impact:p,afterCritical:g}=hD({draggable:h,home:d,draggables:s,viewport:n.viewport}),v=u&&u.isCombineEnabled?n.impact:p,y=lD({pageOffset:n.current.page.offset,draggable:o.draggables[n.critical.draggable.id],draggables:o.draggables,droppables:o.droppables,previousImpact:v,viewport:n.viewport,afterCritical:g}),_={...n,phase:"DRAGGING",impact:y,onLiftImpact:p,dimensions:o,afterCritical:g,forceShouldAnimate:!1};return n.phase==="COLLECTING"?_:{..._,phase:"DROP_PENDING",reason:n.reason,isWaiting:!1}};const ny=n=>n.movementMode==="SNAP",h_=(n,t,e)=>{const r=A8(n.dimensions,t);return!ny(n)||e?dd({state:n,dimensions:r}):fD({state:n,dimensions:r})};function d_(n){return n.isDragging&&n.movementMode==="SNAP"?{...n,scrollJumpRequest:null}:n}const m2={phase:"IDLE",completed:null,shouldFlush:!1};var O8=(n=m2,t)=>{if(t.type==="FLUSH")return{...m2,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){n.phase!=="IDLE"&&ie();const{critical:e,clientSelection:r,viewport:i,dimensions:s,movementMode:o}=t.payload,l=s.draggables[e.draggable.id],u=s.droppables[e.droppable.id],h={selection:r,borderBoxCenter:l.client.borderBox.center,offset:Dr},d={client:h,page:{selection:Br(h.selection,i.scroll.initial),borderBoxCenter:Br(h.selection,i.scroll.initial),offset:Br(h.selection,i.scroll.diff.value)}},p=Fm(s.droppables).every(_=>!_.isFixedOnPage),{impact:g,afterCritical:v}=hD({draggable:l,home:u,draggables:s.draggables,viewport:i});return{phase:"DRAGGING",isDragging:!0,critical:e,movementMode:o,dimensions:s,initial:d,current:d,isWindowScrollAllowed:p,impact:g,afterCritical:v,onLiftImpact:g,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"?n:(n.phase!=="DRAGGING"&&ie(),{...n,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"||ie(),D8({state:n,published:t.payload});if(t.type==="MOVE"){if(n.phase==="DROP_PENDING")return n;fc(n)||ie();const{client:e}=t.payload;return wl(e,n.current.client.selection)?n:dd({state:n,clientSelection:e,impact:ny(n)?n.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="COLLECTING")return d_(n);fc(n)||ie();const{id:e,newScroll:r}=t.payload,i=n.dimensions.droppables[e];if(!i)return n;const s=cb(i,r);return h_(n,s,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(n.phase==="DROP_PENDING")return n;fc(n)||ie();const{id:e,isEnabled:r}=t.payload,i=n.dimensions.droppables[e];i||ie(),i.isEnabled===r&&ie();const s={...i,isEnabled:r};return h_(n,s,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(n.phase==="DROP_PENDING")return n;fc(n)||ie();const{id:e,isCombineEnabled:r}=t.payload,i=n.dimensions.droppables[e];i||ie(),i.isCombineEnabled===r&&ie();const s={...i,isCombineEnabled:r};return h_(n,s,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="DROP_ANIMATING")return n;fc(n)||ie(),n.isWindowScrollAllowed||ie();const e=t.payload.newScroll;if(wl(n.viewport.scroll.current,e))return d_(n);const r=eD(n.viewport,e);return ny(n)?fD({state:n,viewport:r}):dd({state:n,viewport:r})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!fc(n))return n;const e=t.payload.maxScroll;if(wl(e,n.viewport.scroll.max))return n;const r={...n.viewport,scroll:{...n.viewport.scroll,max:e}};return{...n,viewport:r}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(n.phase==="COLLECTING"||n.phase==="DROP_PENDING")return n;n.phase!=="DRAGGING"&&ie();const e=f8({state:n,type:t.type});return e?dd({state:n,impact:e.impact,clientSelection:e.clientSelection,scrollJumpRequest:e.scrollJumpRequest}):n}if(t.type==="DROP_PENDING"){const e=t.payload.reason;return n.phase!=="COLLECTING"&&ie(),{...n,phase:"DROP_PENDING",isWaiting:!0,reason:e}}if(t.type==="DROP_ANIMATE"){const{completed:e,dropDuration:r,newHomeClientOffset:i}=t.payload;return n.phase==="DRAGGING"||n.phase==="DROP_PENDING"||ie(),{phase:"DROP_ANIMATING",completed:e,dropDuration:r,newHomeClientOffset:i,dimensions:n.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:e}=t.payload;return{phase:"IDLE",completed:e,shouldFlush:!1}}return n};function un(n,t){return n instanceof Object&&"type"in n&&n.type===t}const R8=n=>({type:"BEFORE_INITIAL_CAPTURE",payload:n}),N8=n=>({type:"LIFT",payload:n}),k8=n=>({type:"INITIAL_PUBLISH",payload:n}),L8=n=>({type:"PUBLISH_WHILE_DRAGGING",payload:n}),M8=()=>({type:"COLLECTION_STARTING",payload:null}),I8=n=>({type:"UPDATE_DROPPABLE_SCROLL",payload:n}),P8=n=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:n}),F8=n=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:n}),dD=n=>({type:"MOVE",payload:n}),B8=n=>({type:"MOVE_BY_WINDOW_SCROLL",payload:n}),U8=n=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:n}),z8=()=>({type:"MOVE_UP",payload:null}),H8=()=>({type:"MOVE_DOWN",payload:null}),j8=()=>({type:"MOVE_RIGHT",payload:null}),$8=()=>({type:"MOVE_LEFT",payload:null}),mb=()=>({type:"FLUSH",payload:null}),G8=n=>({type:"DROP_ANIMATE",payload:n}),vb=n=>({type:"DROP_COMPLETE",payload:n}),pD=n=>({type:"DROP",payload:n}),V8=n=>({type:"DROP_PENDING",payload:n}),gD=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var W8=n=>({getState:t,dispatch:e})=>r=>i=>{if(!un(i,"LIFT")){r(i);return}const{id:s,clientSelection:o,movementMode:l}=i.payload,u=t();u.phase==="DROP_ANIMATING"&&e(vb({completed:u.completed})),t().phase!=="IDLE"&&ie(),e(mb()),e(R8({draggableId:s,movementMode:l}));const d={draggableId:s,scrollOptions:{shouldPublishImmediately:l==="SNAP"}},{critical:p,dimensions:g,viewport:v}=n.startPublishing(d);e(k8({critical:p,dimensions:g,clientSelection:o,movementMode:l,viewport:v}))},X8=n=>()=>t=>e=>{un(e,"INITIAL_PUBLISH")&&n.dragging(),un(e,"DROP_ANIMATE")&&n.dropping(e.payload.completed.result.reason),(un(e,"FLUSH")||un(e,"DROP_COMPLETE"))&&n.resting(),t(e)};const _b={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},Nd={opacity:{drop:0,combining:.7},scale:{drop:.75}},mD={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},cc=`${mD.outOfTheWay}s ${_b.outOfTheWay}`,pd={fluid:`opacity ${cc}`,snap:`transform ${cc}, opacity ${cc}`,drop:n=>{const t=`${n}s ${_b.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${cc}`,placeholder:`height ${cc}, width ${cc}, margin ${cc}`},v2=n=>wl(n,Dr)?void 0:`translate(${n.x}px, ${n.y}px)`,ry={moveTo:v2,drop:(n,t)=>{const e=v2(n);if(e)return t?`${e} scale(${Nd.scale.drop})`:e}},{minDropTime:iy,maxDropTime:vD}=mD,Y8=vD-iy,_2=1500,q8=.6;var K8=({current:n,destination:t,reason:e})=>{const r=Dd(n,t);if(r<=0)return iy;if(r>=_2)return vD;const i=r/_2,s=iy+Y8*i,o=e==="CANCEL"?s*q8:s;return Number(o.toFixed(2))},Z8=({impact:n,draggable:t,dimensions:e,viewport:r,afterCritical:i})=>{const{draggables:s,droppables:o}=e,l=cs(n),u=l?o[l]:null,h=o[t.descriptor.droppableId],d=uD({impact:n,draggable:t,draggables:s,afterCritical:i,droppable:u||h,viewport:r});return os(d,t.client.borderBox.center)},Q8=({draggables:n,reason:t,lastImpact:e,home:r,viewport:i,onLiftImpact:s})=>!e.at||t!=="DROP"?{impact:cD({draggables:n,impact:s,destination:r,viewport:i,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:e.at.type==="REORDER"?{impact:e,didDropInsideDroppable:!0}:{impact:{...e,displaced:Od},didDropInsideDroppable:!0};const J8=({getState:n,dispatch:t})=>e=>r=>{if(!un(r,"DROP")){e(r);return}const i=n(),s=r.payload.reason;if(i.phase==="COLLECTING"){t(V8({reason:s}));return}if(i.phase==="IDLE")return;i.phase==="DROP_PENDING"&&i.isWaiting&&ie(),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||ie();const l=i.critical,u=i.dimensions,h=u.draggables[i.critical.draggable.id],{impact:d,didDropInsideDroppable:p}=Q8({reason:s,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),g=p?ub(d):null,v=p?Bm(d):null,y={index:l.draggable.index,droppableId:l.droppable.id},_={draggableId:h.descriptor.id,type:h.descriptor.type,source:y,reason:s,mode:i.movementMode,destination:g,combine:v},b=Z8({impact:d,draggable:h,dimensions:u,viewport:i.viewport,afterCritical:i.afterCritical}),E={critical:i.critical,afterCritical:i.afterCritical,result:_,impact:d};if(!(!wl(i.current.client.offset,b)||!!_.combine)){t(vb({completed:E}));return}const T=K8({current:i.current.client.offset,destination:b,reason:s});t(G8({newHomeClientOffset:b,dropDuration:T,completed:E}))};var _D=()=>({x:window.pageXOffset,y:window.pageYOffset});function tB(n){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||n()}}}function eB({onWindowScroll:n}){function t(){n(_D())}const e=Cd(t),r=tB(e);let i=El;function s(){return i!==El}function o(){s()&&ie(),i=Ns(window,[r])}function l(){s()||ie(),e.cancel(),i(),i=El}return{start:o,stop:l,isActive:s}}const nB=n=>un(n,"DROP_COMPLETE")||un(n,"DROP_ANIMATE")||un(n,"FLUSH"),rB=n=>{const t=eB({onWindowScroll:e=>{n.dispatch(B8({newScroll:e}))}});return e=>r=>{!t.isActive()&&un(r,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&nB(r)&&t.stop(),e(r)}};var iB=n=>{let t=!1,e=!1;const r=setTimeout(()=>{e=!0}),i=s=>{t||e||(t=!0,n(s),clearTimeout(r))};return i.wasCalled=()=>t,i},sB=()=>{const n=[],t=i=>{const s=n.findIndex(l=>l.timerId===i);s===-1&&ie();const[o]=n.splice(s,1);o.callback()};return{add:i=>{const s=setTimeout(()=>t(s)),o={timerId:s,callback:i};n.push(o)},flush:()=>{if(!n.length)return;const i=[...n];n.length=0,i.forEach(s=>{clearTimeout(s.timerId),s.callback()})}}};const aB=(n,t)=>n==null&&t==null?!0:n==null||t==null?!1:n.droppableId===t.droppableId&&n.index===t.index,oB=(n,t)=>n==null&&t==null?!0:n==null||t==null?!1:n.draggableId===t.draggableId&&n.droppableId===t.droppableId,lB=(n,t)=>{if(n===t)return!0;const e=n.draggable.id===t.draggable.id&&n.draggable.droppableId===t.draggable.droppableId&&n.draggable.type===t.draggable.type&&n.draggable.index===t.draggable.index,r=n.droppable.id===t.droppable.id&&n.droppable.type===t.droppable.type;return e&&r},Qh=(n,t)=>{t()},sg=(n,t)=>({draggableId:n.draggable.id,type:n.droppable.type,source:{droppableId:n.droppable.id,index:n.draggable.index},mode:t});function p_(n,t,e,r){if(!n){e(r(t));return}const i=iB(e);n(t,{announce:i}),i.wasCalled()||e(r(t))}var cB=(n,t)=>{const e=sB();let r=null;const i=(p,g)=>{r&&ie(),Qh("onBeforeCapture",()=>{const v=n().onBeforeCapture;v&&v({draggableId:p,mode:g})})},s=(p,g)=>{r&&ie(),Qh("onBeforeDragStart",()=>{const v=n().onBeforeDragStart;v&&v(sg(p,g))})},o=(p,g)=>{r&&ie();const v=sg(p,g);r={mode:g,lastCritical:p,lastLocation:v.source,lastCombine:null},e.add(()=>{Qh("onDragStart",()=>p_(n().onDragStart,v,t,Lg.onDragStart))})},l=(p,g)=>{const v=ub(g),y=Bm(g);r||ie();const _=!lB(p,r.lastCritical);_&&(r.lastCritical=p);const b=!aB(r.lastLocation,v);b&&(r.lastLocation=v);const E=!oB(r.lastCombine,y);if(E&&(r.lastCombine=y),!_&&!b&&!E)return;const S={...sg(p,r.mode),combine:y,destination:v};e.add(()=>{Qh("onDragUpdate",()=>p_(n().onDragUpdate,S,t,Lg.onDragUpdate))})},u=()=>{r||ie(),e.flush()},h=p=>{r||ie(),r=null,Qh("onDragEnd",()=>p_(n().onDragEnd,p,t,Lg.onDragEnd))};return{beforeCapture:i,beforeStart:s,start:o,update:l,flush:u,drop:h,abort:()=>{if(!r)return;const p={...sg(r.lastCritical,r.mode),combine:null,destination:null,reason:"CANCEL"};h(p)}}},uB=(n,t)=>{const e=cB(n,t);return r=>i=>s=>{if(un(s,"BEFORE_INITIAL_CAPTURE")){e.beforeCapture(s.payload.draggableId,s.payload.movementMode);return}if(un(s,"INITIAL_PUBLISH")){const l=s.payload.critical;e.beforeStart(l,s.payload.movementMode),i(s),e.start(l,s.payload.movementMode);return}if(un(s,"DROP_COMPLETE")){const l=s.payload.completed.result;e.flush(),i(s),e.drop(l);return}if(i(s),un(s,"FLUSH")){e.abort();return}const o=r.getState();o.phase==="DRAGGING"&&e.update(o.critical,o.impact)}};const fB=n=>t=>e=>{if(!un(e,"DROP_ANIMATION_FINISHED")){t(e);return}const r=n.getState();r.phase!=="DROP_ANIMATING"&&ie(),n.dispatch(vb({completed:r.completed}))},hB=n=>{let t=null,e=null;function r(){e&&(cancelAnimationFrame(e),e=null),t&&(t(),t=null)}return i=>s=>{if((un(s,"FLUSH")||un(s,"DROP_COMPLETE")||un(s,"DROP_ANIMATION_FINISHED"))&&r(),i(s),!un(s,"DROP_ANIMATE"))return;const o={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){n.getState().phase==="DROP_ANIMATING"&&n.dispatch(gD())}};e=requestAnimationFrame(()=>{e=null,t=Ns(window,[o])})}};var dB=n=>()=>t=>e=>{(un(e,"DROP_COMPLETE")||un(e,"FLUSH")||un(e,"DROP_ANIMATE"))&&n.stopPublishing(),t(e)},pB=n=>{let t=!1;return()=>e=>r=>{if(un(r,"INITIAL_PUBLISH")){t=!0,n.tryRecordFocus(r.payload.critical.draggable.id),e(r),n.tryRestoreFocusRecorded();return}if(e(r),!!t){if(un(r,"FLUSH")){t=!1,n.tryRestoreFocusRecorded();return}if(un(r,"DROP_COMPLETE")){t=!1;const i=r.payload.completed.result;i.combine&&n.tryShiftRecord(i.draggableId,i.combine.draggableId),n.tryRestoreFocusRecorded()}}}};const gB=n=>un(n,"DROP_COMPLETE")||un(n,"DROP_ANIMATE")||un(n,"FLUSH");var mB=n=>t=>e=>r=>{if(gB(r)){n.stop(),e(r);return}if(un(r,"INITIAL_PUBLISH")){e(r);const i=t.getState();i.phase!=="DRAGGING"&&ie(),n.start(i);return}e(r),n.scroll(t.getState())};const vB=n=>t=>e=>{if(t(e),!un(e,"PUBLISH_WHILE_DRAGGING"))return;const r=n.getState();r.phase==="DROP_PENDING"&&(r.isWaiting||n.dispatch(pD({reason:r.reason})))},_B=MC;var yB=({dimensionMarshal:n,focusMarshal:t,styleMarshal:e,getResponders:r,announce:i,autoScroller:s})=>LC(O8,_B(_6(X8(e),dB(n),W8(n),J8,fB,hB,vB,mB(s),rB,pB(t),uB(r,i))));const g_=()=>({additions:{},removals:{},modified:{}});function bB({registry:n,callbacks:t}){let e=g_(),r=null;const i=()=>{r||(t.collectionStarting(),r=requestAnimationFrame(()=>{r=null;const{additions:u,removals:h,modified:d}=e,p=Object.keys(u).map(y=>n.draggable.getById(y).getDimension(Dr)).sort((y,_)=>y.descriptor.index-_.descriptor.index),g=Object.keys(d).map(y=>{const b=n.droppable.getById(y).callbacks.getScrollWhileDragging();return{droppableId:y,scroll:b}}),v={additions:p,removals:Object.keys(h),modified:g};e=g_(),t.publish(v)}))};return{add:u=>{const h=u.descriptor.id;e.additions[h]=u,e.modified[u.descriptor.droppableId]=!0,e.removals[h]&&delete e.removals[h],i()},remove:u=>{const h=u.descriptor;e.removals[h.id]=!0,e.modified[h.droppableId]=!0,e.additions[h.id]&&delete e.additions[h.id],i()},stop:()=>{r&&(cancelAnimationFrame(r),r=null,e=g_())}}}var yD=({scrollHeight:n,scrollWidth:t,height:e,width:r})=>{const i=os({x:t,y:n},{x:r,y:e});return{x:Math.max(0,i.x),y:Math.max(0,i.y)}},bD=()=>{const n=document.documentElement;return n||ie(),n},xD=()=>{const n=bD();return yD({scrollHeight:n.scrollHeight,scrollWidth:n.scrollWidth,width:n.clientWidth,height:n.clientHeight})},xB=()=>{const n=_D(),t=xD(),e=n.y,r=n.x,i=bD(),s=i.clientWidth,o=i.clientHeight,l=r+s,u=e+o;return{frame:ea({top:e,left:r,right:l,bottom:u}),scroll:{initial:n,current:n,max:t,diff:{value:Dr,displacement:Dr}}}},EB=({critical:n,scrollOptions:t,registry:e})=>{const r=xB(),i=r.scroll.current,s=n.droppable,o=e.droppable.getAllByType(s.type).map(d=>d.callbacks.getDimensionAndWatchScroll(i,t)),l=e.draggable.getAllByType(n.draggable.type).map(d=>d.getDimension(i));return{dimensions:{draggables:qC(l),droppables:YC(o)},critical:n,viewport:r}};function y2(n,t,e){return!(e.descriptor.id===t.id||e.descriptor.type!==t.type||n.droppable.getById(e.descriptor.droppableId).descriptor.mode!=="virtual")}var wB=(n,t)=>{let e=null;const r=bB({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:n}),i=(g,v)=>{n.droppable.exists(g)||ie(),e&&t.updateDroppableIsEnabled({id:g,isEnabled:v})},s=(g,v)=>{e&&(n.droppable.exists(g)||ie(),t.updateDroppableIsCombineEnabled({id:g,isCombineEnabled:v}))},o=(g,v)=>{e&&(n.droppable.exists(g)||ie(),t.updateDroppableScroll({id:g,newScroll:v}))},l=(g,v)=>{e&&n.droppable.getById(g).callbacks.scroll(v)},u=()=>{if(!e)return;r.stop();const g=e.critical.droppable;n.droppable.getAllByType(g.type).forEach(v=>v.callbacks.dragStopped()),e.unsubscribe(),e=null},h=g=>{e||ie();const v=e.critical.draggable;g.type==="ADDITION"&&y2(n,v,g.value)&&r.add(g.value),g.type==="REMOVAL"&&y2(n,v,g.value)&&r.remove(g.value)};return{updateDroppableIsEnabled:i,updateDroppableIsCombineEnabled:s,scrollDroppable:l,updateDroppableScroll:o,startPublishing:g=>{e&&ie();const v=n.draggable.getById(g.draggableId),y=n.droppable.getById(v.descriptor.droppableId),_={draggable:v.descriptor,droppable:y.descriptor},b=n.subscribe(h);return e={critical:_,unsubscribe:b},EB({critical:_,registry:n,scrollOptions:g.scrollOptions})},stopPublishing:u}},ED=(n,t)=>n.phase==="IDLE"?!0:n.phase!=="DROP_ANIMATING"||n.completed.result.draggableId===t?!1:n.completed.result.reason==="DROP",AB=n=>{window.scrollBy(n.x,n.y)};const SB=Cr(n=>Fm(n).filter(t=>!(!t.isEnabled||!t.frame))),TB=(n,t)=>SB(t).find(r=>(r.frame||ie(),sD(r.frame.pageMarginBox)(n)))||null;var CB=({center:n,destination:t,droppables:e})=>{if(t){const i=e[t];return i.frame?i:null}return TB(n,e)};const kd={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:n=>n**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var DB=(n,t,e=()=>kd)=>{const r=e(),i=n[t.size]*r.startFromPercentage,s=n[t.size]*r.maxScrollAtPercentage;return{startScrollingFrom:i,maxScrollValueAt:s}},wD=({startOfRange:n,endOfRange:t,current:e})=>{const r=t-n;return r===0?0:(e-n)/r},yb=1,OB=(n,t,e=()=>kd)=>{const r=e();if(n>t.startScrollingFrom)return 0;if(n<=t.maxScrollValueAt)return r.maxPixelScroll;if(n===t.startScrollingFrom)return yb;const s=1-wD({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:n}),o=r.maxPixelScroll*r.ease(s);return Math.ceil(o)},RB=(n,t,e)=>{const r=e(),i=r.durationDampening.accelerateAt,s=r.durationDampening.stopDampeningAt,o=t,l=s,h=Date.now()-o;if(h>=s)return n;if(h<i)return yb;const d=wD({startOfRange:i,endOfRange:l,current:h}),p=n*r.ease(d);return Math.ceil(p)},b2=({distanceToEdge:n,thresholds:t,dragStartTime:e,shouldUseTimeDampening:r,getAutoScrollerOptions:i})=>{const s=OB(n,t,i);return s===0?0:r?Math.max(RB(s,e,i),yb):s},x2=({container:n,distanceToEdges:t,dragStartTime:e,axis:r,shouldUseTimeDampening:i,getAutoScrollerOptions:s})=>{const o=DB(n,r,s);return t[r.end]<t[r.start]?b2({distanceToEdge:t[r.end],thresholds:o,dragStartTime:e,shouldUseTimeDampening:i,getAutoScrollerOptions:s}):-1*b2({distanceToEdge:t[r.start],thresholds:o,dragStartTime:e,shouldUseTimeDampening:i,getAutoScrollerOptions:s})},NB=({container:n,subject:t,proposedScroll:e})=>{const r=t.height>n.height,i=t.width>n.width;return!i&&!r?e:i&&r?null:{x:i?0:e.x,y:r?0:e.y}};const kB=XC(n=>n===0?0:n);var AD=({dragStartTime:n,container:t,subject:e,center:r,shouldUseTimeDampening:i,getAutoScrollerOptions:s})=>{const o={top:r.y-t.top,right:t.right-r.x,bottom:t.bottom-r.y,left:r.x-t.left},l=x2({container:t,distanceToEdges:o,dragStartTime:n,axis:fb,shouldUseTimeDampening:i,getAutoScrollerOptions:s}),u=x2({container:t,distanceToEdges:o,dragStartTime:n,axis:QC,shouldUseTimeDampening:i,getAutoScrollerOptions:s}),h=kB({x:u,y:l});if(wl(h,Dr))return null;const d=NB({container:t,subject:e,proposedScroll:h});return d?wl(d,Dr)?null:d:null};const LB=XC(n=>n===0?0:n>0?1:-1),bb=(()=>{const n=(t,e)=>t<0?t:t>e?t-e:0;return({current:t,max:e,change:r})=>{const i=Br(t,r),s={x:n(i.x,e.x),y:n(i.y,e.y)};return wl(s,Dr)?null:s}})(),SD=({max:n,current:t,change:e})=>{const r={x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)},i=LB(e),s=bb({max:r,current:t,change:i});return!s||i.x!==0&&s.x===0||i.y!==0&&s.y===0},xb=(n,t)=>SD({current:n.scroll.current,max:n.scroll.max,change:t}),MB=(n,t)=>{if(!xb(n,t))return null;const e=n.scroll.max,r=n.scroll.current;return bb({current:r,max:e,change:t})},Eb=(n,t)=>{const e=n.frame;return e?SD({current:e.scroll.current,max:e.scroll.max,change:t}):!1},IB=(n,t)=>{const e=n.frame;return!e||!Eb(n,t)?null:bb({current:e.scroll.current,max:e.scroll.max,change:t})};var PB=({viewport:n,subject:t,center:e,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:s})=>{const o=AD({dragStartTime:r,container:n.frame,subject:t,center:e,shouldUseTimeDampening:i,getAutoScrollerOptions:s});return o&&xb(n,o)?o:null},FB=({droppable:n,subject:t,center:e,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:s})=>{const o=n.frame;if(!o)return null;const l=AD({dragStartTime:r,container:o.pageMarginBox,subject:t,center:e,shouldUseTimeDampening:i,getAutoScrollerOptions:s});return l&&Eb(n,l)?l:null},E2=({state:n,dragStartTime:t,shouldUseTimeDampening:e,scrollWindow:r,scrollDroppable:i,getAutoScrollerOptions:s})=>{const o=n.current.page.borderBoxCenter,u=n.dimensions.draggables[n.critical.draggable.id].page.marginBox;if(n.isWindowScrollAllowed){const p=n.viewport,g=PB({dragStartTime:t,viewport:p,subject:u,center:o,shouldUseTimeDampening:e,getAutoScrollerOptions:s});if(g){r(g);return}}const h=CB({center:o,destination:cs(n.impact),droppables:n.dimensions.droppables});if(!h)return;const d=FB({dragStartTime:t,droppable:h,subject:u,center:o,shouldUseTimeDampening:e,getAutoScrollerOptions:s});d&&i(h.descriptor.id,d)},BB=({scrollWindow:n,scrollDroppable:t,getAutoScrollerOptions:e=()=>kd})=>{const r=Cd(n),i=Cd(t);let s=null;const o=h=>{s||ie();const{shouldUseTimeDampening:d,dragStartTime:p}=s;E2({state:h,scrollWindow:r,scrollDroppable:i,dragStartTime:p,shouldUseTimeDampening:d,getAutoScrollerOptions:e})};return{start:h=>{s&&ie();const d=Date.now();let p=!1;const g=()=>{p=!0};E2({state:h,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:g,scrollDroppable:g,getAutoScrollerOptions:e}),s={dragStartTime:d,shouldUseTimeDampening:p},p&&o(h)},stop:()=>{s&&(r.cancel(),i.cancel(),s=null)},scroll:o}},UB=({move:n,scrollDroppable:t,scrollWindow:e})=>{const r=(l,u)=>{const h=Br(l.current.client.selection,u);n({client:h})},i=(l,u)=>{if(!Eb(l,u))return u;const h=IB(l,u);if(!h)return t(l.descriptor.id,u),null;const d=os(u,h);return t(l.descriptor.id,d),os(u,d)},s=(l,u,h)=>{if(!l||!xb(u,h))return h;const d=MB(u,h);if(!d)return e(h),null;const p=os(h,d);return e(p),os(h,p)};return l=>{const u=l.scrollJumpRequest;if(!u)return;const h=cs(l.impact);h||ie();const d=i(l.dimensions.droppables[h],u);if(!d)return;const p=l.viewport,g=s(l.isWindowScrollAllowed,p,d);g&&r(l,g)}},zB=({scrollDroppable:n,scrollWindow:t,move:e,getAutoScrollerOptions:r})=>{const i=BB({scrollWindow:t,scrollDroppable:n,getAutoScrollerOptions:r}),s=UB({move:e,scrollWindow:t,scrollDroppable:n});return{scroll:u=>{if(!(r().disabled||u.phase!=="DRAGGING")){if(u.movementMode==="FLUID"){i.scroll(u);return}u.scrollJumpRequest&&s(u)}},start:i.start,stop:i.stop}};const uf="data-rfd",ff=(()=>{const n=`${uf}-drag-handle`;return{base:n,draggableId:`${n}-draggable-id`,contextId:`${n}-context-id`}})(),sy=(()=>{const n=`${uf}-draggable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),HB=(()=>{const n=`${uf}-droppable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),w2={contextId:`${uf}-scroll-container-context-id`},jB=n=>t=>`[${t}="${n}"]`,Jh=(n,t)=>n.map(e=>{const r=e.styles[t];return r?`${e.selector} { ${r} }`:""}).join(" "),$B="pointer-events: none;";var GB=n=>{const t=jB(n),e=(()=>{const l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(ff.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:$B,dropAnimating:l}}})(),r=(()=>{const l=`
      transition: ${pd.outOfTheWay};
    `;return{selector:t(sy.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}})(),i={selector:t(HB.contextId),styles:{always:"overflow-anchor: none;"}},o=[r,e,i,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:Jh(o,"always"),resting:Jh(o,"resting"),dragging:Jh(o,"dragging"),dropAnimating:Jh(o,"dropAnimating"),userCancel:Jh(o,"userCancel")}};const us=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?At.useLayoutEffect:At.useEffect,m_=()=>{const n=document.querySelector("head");return n||ie(),n},A2=n=>{const t=document.createElement("style");return n&&t.setAttribute("nonce",n),t.type="text/css",t};function VB(n,t){const e=nn(()=>GB(n),[n]),r=At.useRef(null),i=At.useRef(null),s=ye(Cr(p=>{const g=i.current;g||ie(),g.textContent=p}),[]),o=ye(p=>{const g=r.current;g||ie(),g.textContent=p},[]);us(()=>{!r.current&&!i.current||ie();const p=A2(t),g=A2(t);return r.current=p,i.current=g,p.setAttribute(`${uf}-always`,n),g.setAttribute(`${uf}-dynamic`,n),m_().appendChild(p),m_().appendChild(g),o(e.always),s(e.resting),()=>{const v=y=>{const _=y.current;_||ie(),m_().removeChild(_),y.current=null};v(r),v(i)}},[t,o,s,e.always,e.resting,n]);const l=ye(()=>s(e.dragging),[s,e.dragging]),u=ye(p=>{if(p==="DROP"){s(e.dropAnimating);return}s(e.userCancel)},[s,e.dropAnimating,e.userCancel]),h=ye(()=>{i.current&&s(e.resting)},[s,e.resting]);return nn(()=>({dragging:l,dropping:u,resting:h}),[l,u,h])}function TD(n,t){return Array.from(n.querySelectorAll(t))}var CD=n=>n&&n.ownerDocument&&n.ownerDocument.defaultView?n.ownerDocument.defaultView:window;function Hm(n){return n instanceof CD(n).HTMLElement}function WB(n,t){const e=`[${ff.contextId}="${n}"]`,r=TD(document,e);if(!r.length)return null;const i=r.find(s=>s.getAttribute(ff.draggableId)===t);return!i||!Hm(i)?null:i}function XB(n){const t=At.useRef({}),e=At.useRef(null),r=At.useRef(null),i=At.useRef(!1),s=ye(function(g,v){const y={id:g,focus:v};return t.current[g]=y,function(){const b=t.current;b[g]!==y&&delete b[g]}},[]),o=ye(function(g){const v=WB(n,g);v&&v!==document.activeElement&&v.focus()},[n]),l=ye(function(g,v){e.current===g&&(e.current=v)},[]),u=ye(function(){r.current||i.current&&(r.current=requestAnimationFrame(()=>{r.current=null;const g=e.current;g&&o(g)}))},[o]),h=ye(function(g){e.current=null;const v=document.activeElement;v&&v.getAttribute(ff.draggableId)===g&&(e.current=g)},[]);return us(()=>(i.current=!0,function(){i.current=!1;const g=r.current;g&&cancelAnimationFrame(g)}),[]),nn(()=>({register:s,tryRecordFocus:h,tryRestoreFocusRecorded:u,tryShiftRecord:l}),[s,h,u,l])}function YB(){const n={draggables:{},droppables:{}},t=[];function e(p){return t.push(p),function(){const v=t.indexOf(p);v!==-1&&t.splice(v,1)}}function r(p){t.length&&t.forEach(g=>g(p))}function i(p){return n.draggables[p]||null}function s(p){const g=i(p);return g||ie(),g}const o={register:p=>{n.draggables[p.descriptor.id]=p,r({type:"ADDITION",value:p})},update:(p,g)=>{const v=n.draggables[g.descriptor.id];v&&v.uniqueId===p.uniqueId&&(delete n.draggables[g.descriptor.id],n.draggables[p.descriptor.id]=p)},unregister:p=>{const g=p.descriptor.id,v=i(g);v&&p.uniqueId===v.uniqueId&&(delete n.draggables[g],n.droppables[p.descriptor.droppableId]&&r({type:"REMOVAL",value:p}))},getById:s,findById:i,exists:p=>!!i(p),getAllByType:p=>Object.values(n.draggables).filter(g=>g.descriptor.type===p)};function l(p){return n.droppables[p]||null}function u(p){const g=l(p);return g||ie(),g}const h={register:p=>{n.droppables[p.descriptor.id]=p},unregister:p=>{const g=l(p.descriptor.id);g&&p.uniqueId===g.uniqueId&&delete n.droppables[p.descriptor.id]},getById:u,findById:l,exists:p=>!!l(p),getAllByType:p=>Object.values(n.droppables).filter(g=>g.descriptor.type===p)};function d(){n.draggables={},n.droppables={},t.length=0}return{draggable:o,droppable:h,subscribe:e,clean:d}}function qB(){const n=nn(YB,[]);return At.useEffect(()=>function(){n.clean()},[n]),n}var wb=Qn.createContext(null),qg=()=>{const n=document.body;return n||ie(),n};const KB={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},ZB=n=>`rfd-announcement-${n}`;function QB(n){const t=nn(()=>ZB(n),[n]),e=At.useRef(null);return At.useEffect(function(){const s=document.createElement("div");return e.current=s,s.id=t,s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true"),Vg(s.style,KB),qg().appendChild(s),function(){setTimeout(function(){const u=qg();u.contains(s)&&u.removeChild(s),s===e.current&&(e.current=null)})}},[t]),ye(i=>{const s=e.current;if(s){s.textContent=i;return}},[])}const JB={separator:"::"};function Ab(n,t=JB){const e=Qn.useId();return nn(()=>`${n}${t.separator}${e}`,[t.separator,n,e])}function tU({contextId:n,uniqueId:t}){return`rfd-hidden-text-${n}-${t}`}function eU({contextId:n,text:t}){const e=Ab("hidden-text",{separator:"-"}),r=nn(()=>tU({contextId:n,uniqueId:e}),[e,n]);return At.useEffect(function(){const s=document.createElement("div");return s.id=r,s.textContent=t,s.style.display="none",qg().appendChild(s),function(){const l=qg();l.contains(s)&&l.removeChild(s)}},[r,t]),r}var jm=Qn.createContext(null);function DD(n){const t=At.useRef(n);return At.useEffect(()=>{t.current=n}),t}function nU(){let n=null;function t(){return!!n}function e(o){return o===n}function r(o){n&&ie();const l={abandon:o};return n=l,l}function i(){n||ie(),n=null}function s(){n&&(n.abandon(),i())}return{isClaimed:t,isActive:e,claim:r,release:i,tryAbandon:s}}function Ld(n){return n.phase==="IDLE"||n.phase==="DROP_ANIMATING"?!1:n.isDragging}const rU=9,iU=13,Sb=27,OD=32,sU=33,aU=34,oU=35,lU=36,cU=37,uU=38,fU=39,hU=40,dU={[iU]:!0,[rU]:!0};var RD=n=>{dU[n.keyCode]&&n.preventDefault()};const $m=(()=>{const n="visibilitychange";return typeof document>"u"?n:[n,`ms${n}`,`webkit${n}`,`moz${n}`,`o${n}`].find(r=>`on${r}`in document)||n})(),ND=0,S2=5;function pU(n,t){return Math.abs(t.x-n.x)>=S2||Math.abs(t.y-n.y)>=S2}const T2={type:"IDLE"};function gU({cancel:n,completed:t,getPhase:e,setPhase:r}){return[{eventName:"mousemove",fn:i=>{const{button:s,clientX:o,clientY:l}=i;if(s!==ND)return;const u={x:o,y:l},h=e();if(h.type==="DRAGGING"){i.preventDefault(),h.actions.move(u);return}h.type!=="PENDING"&&ie();const d=h.point;if(!pU(d,u))return;i.preventDefault();const p=h.actions.fluidLift(u);r({type:"DRAGGING",actions:p})}},{eventName:"mouseup",fn:i=>{const s=e();if(s.type!=="DRAGGING"){n();return}i.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:i=>{e().type==="DRAGGING"&&i.preventDefault(),n()}},{eventName:"keydown",fn:i=>{if(e().type==="PENDING"){n();return}if(i.keyCode===Sb){i.preventDefault(),n();return}RD(i)}},{eventName:"resize",fn:n},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{e().type==="PENDING"&&n()}},{eventName:"webkitmouseforcedown",fn:i=>{const s=e();if(s.type==="IDLE"&&ie(),s.actions.shouldRespectForcePress()){n();return}i.preventDefault()}},{eventName:$m,fn:n}]}function mU(n){const t=At.useRef(T2),e=At.useRef(El),r=nn(()=>({eventName:"mousedown",fn:function(p){if(p.defaultPrevented||p.button!==ND||p.ctrlKey||p.metaKey||p.shiftKey||p.altKey)return;const g=n.findClosestDraggableId(p);if(!g)return;const v=n.tryGetLock(g,o,{sourceEvent:p});if(!v)return;p.preventDefault();const y={x:p.clientX,y:p.clientY};e.current(),h(v,y)}}),[n]),i=nn(()=>({eventName:"webkitmouseforcewillbegin",fn:d=>{if(d.defaultPrevented)return;const p=n.findClosestDraggableId(d);if(!p)return;const g=n.findOptionsForDraggable(p);g&&(g.shouldRespectForcePress||n.canGetLock(p)&&d.preventDefault())}}),[n]),s=ye(function(){const p={passive:!1,capture:!0};e.current=Ns(window,[i,r],p)},[i,r]),o=ye(()=>{t.current.type!=="IDLE"&&(t.current=T2,e.current(),s())},[s]),l=ye(()=>{const d=t.current;o(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[o]),u=ye(function(){const p={capture:!0,passive:!1},g=gU({cancel:l,completed:o,getPhase:()=>t.current,setPhase:v=>{t.current=v}});e.current=Ns(window,g,p)},[l,o]),h=ye(function(p,g){t.current.type!=="IDLE"&&ie(),t.current={type:"PENDING",point:g,actions:p},u()},[u]);us(function(){return s(),function(){e.current()}},[s])}function vU(){}const _U={[aU]:!0,[sU]:!0,[lU]:!0,[oU]:!0};function yU(n,t){function e(){t(),n.cancel()}function r(){t(),n.drop()}return[{eventName:"keydown",fn:i=>{if(i.keyCode===Sb){i.preventDefault(),e();return}if(i.keyCode===OD){i.preventDefault(),r();return}if(i.keyCode===hU){i.preventDefault(),n.moveDown();return}if(i.keyCode===uU){i.preventDefault(),n.moveUp();return}if(i.keyCode===fU){i.preventDefault(),n.moveRight();return}if(i.keyCode===cU){i.preventDefault(),n.moveLeft();return}if(_U[i.keyCode]){i.preventDefault();return}RD(i)}},{eventName:"mousedown",fn:e},{eventName:"mouseup",fn:e},{eventName:"click",fn:e},{eventName:"touchstart",fn:e},{eventName:"resize",fn:e},{eventName:"wheel",fn:e,options:{passive:!0}},{eventName:$m,fn:e}]}function bU(n){const t=At.useRef(vU),e=nn(()=>({eventName:"keydown",fn:function(s){if(s.defaultPrevented||s.keyCode!==OD)return;const o=n.findClosestDraggableId(s);if(!o)return;const l=n.tryGetLock(o,d,{sourceEvent:s});if(!l)return;s.preventDefault();let u=!0;const h=l.snapLift();t.current();function d(){u||ie(),u=!1,t.current(),r()}t.current=Ns(window,yU(h,d),{capture:!0,passive:!1})}}),[n]),r=ye(function(){const s={passive:!1,capture:!0};t.current=Ns(window,[e],s)},[e]);us(function(){return r(),function(){t.current()}},[r])}const v_={type:"IDLE"},xU=120,EU=.15;function wU({cancel:n,getPhase:t}){return[{eventName:"orientationchange",fn:n},{eventName:"resize",fn:n},{eventName:"contextmenu",fn:e=>{e.preventDefault()}},{eventName:"keydown",fn:e=>{if(t().type!=="DRAGGING"){n();return}e.keyCode===Sb&&e.preventDefault(),n()}},{eventName:$m,fn:n}]}function AU({cancel:n,completed:t,getPhase:e}){return[{eventName:"touchmove",options:{capture:!1},fn:r=>{const i=e();if(i.type!=="DRAGGING"){n();return}i.hasMoved=!0;const{clientX:s,clientY:o}=r.touches[0],l={x:s,y:o};r.preventDefault(),i.actions.move(l)}},{eventName:"touchend",fn:r=>{const i=e();if(i.type!=="DRAGGING"){n();return}r.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:r=>{if(e().type!=="DRAGGING"){n();return}r.preventDefault(),n()}},{eventName:"touchforcechange",fn:r=>{const i=e();i.type==="IDLE"&&ie();const s=r.touches[0];if(!s||!(s.force>=EU))return;const l=i.actions.shouldRespectForcePress();if(i.type==="PENDING"){l&&n();return}if(l){if(i.hasMoved){r.preventDefault();return}n();return}r.preventDefault()}},{eventName:$m,fn:n}]}function SU(n){const t=At.useRef(v_),e=At.useRef(El),r=ye(function(){return t.current},[]),i=ye(function(v){t.current=v},[]),s=nn(()=>({eventName:"touchstart",fn:function(v){if(v.defaultPrevented)return;const y=n.findClosestDraggableId(v);if(!y)return;const _=n.tryGetLock(y,l,{sourceEvent:v});if(!_)return;const b=v.touches[0],{clientX:E,clientY:S}=b,T={x:E,y:S};e.current(),p(_,T)}}),[n]),o=ye(function(){const v={capture:!0,passive:!1};e.current=Ns(window,[s],v)},[s]),l=ye(()=>{const g=t.current;g.type!=="IDLE"&&(g.type==="PENDING"&&clearTimeout(g.longPressTimerId),i(v_),e.current(),o())},[o,i]),u=ye(()=>{const g=t.current;l(),g.type==="DRAGGING"&&g.actions.cancel({shouldBlockNextClick:!0}),g.type==="PENDING"&&g.actions.abort()},[l]),h=ye(function(){const v={capture:!0,passive:!1},y={cancel:u,completed:l,getPhase:r},_=Ns(window,AU(y),v),b=Ns(window,wU(y),v);e.current=function(){_(),b()}},[u,r,l]),d=ye(function(){const v=r();v.type!=="PENDING"&&ie();const y=v.actions.fluidLift(v.point);i({type:"DRAGGING",actions:y,hasMoved:!1})},[r,i]),p=ye(function(v,y){r().type!=="IDLE"&&ie();const _=setTimeout(d,xU);i({type:"PENDING",point:y,actions:v,longPressTimerId:_}),h()},[h,r,i,d]);us(function(){return o(),function(){e.current();const y=r();y.type==="PENDING"&&(clearTimeout(y.longPressTimerId),i(v_))}},[r,o,i]),us(function(){return Ns(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const TU=["input","button","textarea","select","option","optgroup","video","audio"];function kD(n,t){if(t==null)return!1;if(TU.includes(t.tagName.toLowerCase()))return!0;const r=t.getAttribute("contenteditable");return r==="true"||r===""?!0:t===n?!1:kD(n,t.parentElement)}function CU(n,t){const e=t.target;return Hm(e)?kD(n,e):!1}var DU=n=>ea(n.getBoundingClientRect()).center;function OU(n){return n instanceof CD(n).Element}const RU=(()=>{const n="matches";return typeof document>"u"?n:[n,"msMatchesSelector","webkitMatchesSelector"].find(r=>r in Element.prototype)||n})();function LD(n,t){return n==null?null:n[RU](t)?n:LD(n.parentElement,t)}function NU(n,t){return n.closest?n.closest(t):LD(n,t)}function kU(n){return`[${ff.contextId}="${n}"]`}function LU(n,t){const e=t.target;if(!OU(e))return null;const r=kU(n),i=NU(e,r);return!i||!Hm(i)?null:i}function MU(n,t){const e=LU(n,t);return e?e.getAttribute(ff.draggableId):null}function IU(n,t){const e=`[${sy.contextId}="${n}"]`,i=TD(document,e).find(s=>s.getAttribute(sy.id)===t);return!i||!Hm(i)?null:i}function PU(n){n.preventDefault()}function ag({expected:n,phase:t,isLockActive:e,shouldWarn:r}){return!(!e()||n!==t)}function MD({lockAPI:n,store:t,registry:e,draggableId:r}){if(n.isClaimed())return!1;const i=e.draggable.findById(r);return!(!i||!i.options.isEnabled||!ED(t.getState(),r))}function FU({lockAPI:n,contextId:t,store:e,registry:r,draggableId:i,forceSensorStop:s,sourceEvent:o}){if(!MD({lockAPI:n,store:e,registry:r,draggableId:i}))return null;const u=r.draggable.getById(i),h=IU(t,u.descriptor.id);if(!h||o&&!u.options.canDragInteractiveElements&&CU(h,o))return null;const d=n.claim(s||El);let p="PRE_DRAG";function g(){return u.options.shouldRespectForcePress}function v(){return n.isActive(d)}function y(R,N){ag({expected:R,phase:p,isLockActive:v,shouldWarn:!0})&&e.dispatch(N())}const _=y.bind(null,"DRAGGING");function b(R){function N(){n.release(),p="COMPLETED"}p!=="PRE_DRAG"&&(N(),ie()),e.dispatch(N8(R.liftActionArgs)),p="DRAGGING";function C(I,M={shouldBlockNextClick:!1}){if(R.cleanup(),M.shouldBlockNextClick){const F=Ns(window,[{eventName:"click",fn:PU,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(F)}N(),e.dispatch(pD({reason:I}))}return{isActive:()=>ag({expected:"DRAGGING",phase:p,isLockActive:v,shouldWarn:!1}),shouldRespectForcePress:g,drop:I=>C("DROP",I),cancel:I=>C("CANCEL",I),...R.actions}}function E(R){const N=Cd(I=>{_(()=>dD({client:I}))});return{...b({liftActionArgs:{id:i,clientSelection:R,movementMode:"FLUID"},cleanup:()=>N.cancel(),actions:{move:N}}),move:N}}function S(){const R={moveUp:()=>_(z8),moveRight:()=>_(j8),moveDown:()=>_(H8),moveLeft:()=>_($8)};return b({liftActionArgs:{id:i,clientSelection:DU(h),movementMode:"SNAP"},cleanup:El,actions:R})}function T(){ag({expected:"PRE_DRAG",phase:p,isLockActive:v,shouldWarn:!0})&&n.release()}return{isActive:()=>ag({expected:"PRE_DRAG",phase:p,isLockActive:v,shouldWarn:!1}),shouldRespectForcePress:g,fluidLift:E,snapLift:S,abort:T}}const BU=[mU,bU,SU];function UU({contextId:n,store:t,registry:e,customSensors:r,enableDefaultSensors:i}){const s=[...i?BU:[],...r||[]],o=At.useState(()=>nU())[0],l=ye(function(b,E){Ld(b)&&!Ld(E)&&o.tryAbandon()},[o]);us(function(){let b=t.getState();return t.subscribe(()=>{const S=t.getState();l(b,S),b=S})},[o,t,l]),us(()=>o.tryAbandon,[o.tryAbandon]);const u=ye(_=>MD({lockAPI:o,registry:e,store:t,draggableId:_}),[o,e,t]),h=ye((_,b,E)=>FU({lockAPI:o,registry:e,contextId:n,store:t,draggableId:_,forceSensorStop:b||null,sourceEvent:E&&E.sourceEvent?E.sourceEvent:null}),[n,o,e,t]),d=ye(_=>MU(n,_),[n]),p=ye(_=>{const b=e.draggable.findById(_);return b?b.options:null},[e.draggable]),g=ye(function(){o.isClaimed()&&(o.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(mb()))},[o,t]),v=ye(()=>o.isClaimed(),[o]),y=nn(()=>({canGetLock:u,tryGetLock:h,findClosestDraggableId:d,findOptionsForDraggable:p,tryReleaseLock:g,isLockClaimed:v}),[u,h,d,p,g,v]);for(let _=0;_<s.length;_++)s[_](y)}const zU=n=>({onBeforeCapture:t=>{const e=()=>{n.onBeforeCapture&&n.onBeforeCapture(t)};ib.flushSync(e)},onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd,onDragUpdate:n.onDragUpdate}),HU=n=>({...kd,...n.autoScrollerOptions,durationDampening:{...kd.durationDampening,...n.autoScrollerOptions}});function td(n){return n.current||ie(),n.current}function jU(n){const{contextId:t,setCallbacks:e,sensors:r,nonce:i,dragHandleUsageInstructions:s}=n,o=At.useRef(null),l=DD(n),u=ye(()=>zU(l.current),[l]),h=ye(()=>HU(l.current),[l]),d=QB(t),p=eU({contextId:t,text:s}),g=VB(t,i),v=ye(F=>{td(o).dispatch(F)},[]),y=nn(()=>QA({publishWhileDragging:L8,updateDroppableScroll:I8,updateDroppableIsEnabled:P8,updateDroppableIsCombineEnabled:F8,collectionStarting:M8},v),[v]),_=qB(),b=nn(()=>wB(_,y),[_,y]),E=nn(()=>zB({scrollWindow:AB,scrollDroppable:b.scrollDroppable,getAutoScrollerOptions:h,...QA({move:dD},v)}),[b.scrollDroppable,v,h]),S=XB(t),T=nn(()=>yB({announce:d,autoScroller:E,dimensionMarshal:b,focusMarshal:S,getResponders:u,styleMarshal:g}),[d,E,b,S,u,g]);o.current=T;const O=ye(()=>{const F=td(o);F.getState().phase!=="IDLE"&&F.dispatch(mb())},[]),R=ye(()=>{const F=td(o).getState();return F.phase==="DROP_ANIMATING"?!0:F.phase==="IDLE"?!1:F.isDragging},[]),N=nn(()=>({isDragging:R,tryAbort:O}),[R,O]);e(N);const C=ye(F=>ED(td(o).getState(),F),[]),I=ye(()=>fc(td(o).getState()),[]),M=nn(()=>({marshal:b,focus:S,contextId:t,canLift:C,isMovementAllowed:I,dragHandleUsageInstructionsId:p,registry:_}),[t,b,p,S,C,I,_]);return UU({contextId:t,store:T,registry:_,customSensors:r||null,enableDefaultSensors:n.enableDefaultSensors!==!1}),At.useEffect(()=>O,[O]),Qn.createElement(jm.Provider,{value:M},Qn.createElement(g5,{context:wb,store:T},n.children))}function $U(){return Qn.useId()}function GU(n){const t=$U(),e=n.dragHandleUsageInstructions||Lg.dragHandleUsageInstructions;return Qn.createElement(b5,null,r=>Qn.createElement(jU,{nonce:n.nonce,contextId:t,setCallbacks:r,dragHandleUsageInstructions:e,enableDefaultSensors:n.enableDefaultSensors,sensors:n.sensors,onBeforeCapture:n.onBeforeCapture,onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragUpdate:n.onDragUpdate,onDragEnd:n.onDragEnd,autoScrollerOptions:n.autoScrollerOptions},n.children))}const C2={dragging:5e3,dropAnimating:4500},VU=(n,t)=>t?pd.drop(t.duration):n?pd.snap:pd.fluid,WU=(n,t)=>{if(n)return t?Nd.opacity.drop:Nd.opacity.combining},XU=n=>n.forceShouldAnimate!=null?n.forceShouldAnimate:n.mode==="SNAP";function YU(n){const e=n.dimension.client,{offset:r,combineWith:i,dropping:s}=n,o=!!i,l=XU(n),u=!!s,h=u?ry.drop(r,o):ry.moveTo(r);return{position:"fixed",top:e.marginBox.top,left:e.marginBox.left,boxSizing:"border-box",width:e.borderBox.width,height:e.borderBox.height,transition:VU(l,s),transform:h,opacity:WU(o,u),zIndex:u?C2.dropAnimating:C2.dragging,pointerEvents:"none"}}function qU(n){return{transform:ry.moveTo(n.offset),transition:n.shouldAnimateDisplacement?void 0:"none"}}function KU(n){return n.type==="DRAGGING"?YU(n):qU(n)}function ZU(n,t,e=Dr){const r=window.getComputedStyle(t),i=t.getBoundingClientRect(),s=HC(i,r),o=Gg(s,e),l={client:s,tagName:t.tagName.toLowerCase(),display:r.display},u={x:s.marginBox.width,y:s.marginBox.height};return{descriptor:n,placeholder:l,displaceBy:u,client:s,page:o}}function QU(n){const t=Ab("draggable"),{descriptor:e,registry:r,getDraggableRef:i,canDragInteractiveElements:s,shouldRespectForcePress:o,isEnabled:l}=n,u=nn(()=>({canDragInteractiveElements:s,shouldRespectForcePress:o,isEnabled:l}),[s,l,o]),h=ye(v=>{const y=i();return y||ie(),ZU(e,y,v)},[e,i]),d=nn(()=>({uniqueId:t,descriptor:e,options:u,getDimension:h}),[e,h,u,t]),p=At.useRef(d),g=At.useRef(!0);us(()=>(r.draggable.register(p.current),()=>r.draggable.unregister(p.current)),[r.draggable]),us(()=>{if(g.current){g.current=!1;return}const v=p.current;p.current=d,r.draggable.update(d,v)},[d,r.draggable])}var Tb=Qn.createContext(null);function Kg(n){const t=At.useContext(n);return t||ie(),t}function JU(n){n.preventDefault()}const t7=n=>{const t=At.useRef(null),e=ye((N=null)=>{t.current=N},[]),r=ye(()=>t.current,[]),{contextId:i,dragHandleUsageInstructionsId:s,registry:o}=Kg(jm),{type:l,droppableId:u}=Kg(Tb),h=nn(()=>({id:n.draggableId,index:n.index,type:l,droppableId:u}),[n.draggableId,n.index,l,u]),{children:d,draggableId:p,isEnabled:g,shouldRespectForcePress:v,canDragInteractiveElements:y,isClone:_,mapped:b,dropAnimationFinished:E}=n;if(!_){const N=nn(()=>({descriptor:h,registry:o,getDraggableRef:r,canDragInteractiveElements:y,shouldRespectForcePress:v,isEnabled:g}),[h,o,r,y,v,g]);QU(N)}const S=nn(()=>g?{tabIndex:0,role:"button","aria-describedby":s,"data-rfd-drag-handle-draggable-id":p,"data-rfd-drag-handle-context-id":i,draggable:!1,onDragStart:JU}:null,[i,s,p,g]),T=ye(N=>{b.type==="DRAGGING"&&b.dropping&&N.propertyName==="transform"&&ib.flushSync(E)},[E,b]),O=nn(()=>{const N=KU(b),C=b.type==="DRAGGING"&&b.dropping?T:void 0;return{innerRef:e,draggableProps:{"data-rfd-draggable-context-id":i,"data-rfd-draggable-id":p,style:N,onTransitionEnd:C},dragHandleProps:S}},[i,S,p,b,T,e]),R=nn(()=>({draggableId:h.id,type:h.type,source:{index:h.index,droppableId:h.droppableId}}),[h.droppableId,h.id,h.index,h.type]);return Qn.createElement(Qn.Fragment,null,d(O,b.snapshot,R))};var ID=(n,t)=>n===t,PD=n=>{const{combine:t,destination:e}=n;return e?e.droppableId:t?t.droppableId:null};const e7=n=>n.combine?n.combine.draggableId:null,n7=n=>n.at&&n.at.type==="COMBINE"?n.at.combine.draggableId:null;function r7(){const n=Cr((i,s)=>({x:i,y:s})),t=Cr((i,s,o=null,l=null,u=null)=>({isDragging:!0,isClone:s,isDropAnimating:!!u,dropAnimation:u,mode:i,draggingOver:o,combineWith:l,combineTargetFor:null})),e=Cr((i,s,o,l,u=null,h=null,d=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:u,combineWith:h,mode:s,offset:i,dimension:o,forceShouldAnimate:d,snapshot:t(s,l,u,h,null)}}));return(i,s)=>{if(Ld(i)){if(i.critical.draggable.id!==s.draggableId)return null;const o=i.current.client.offset,l=i.dimensions.draggables[s.draggableId],u=cs(i.impact),h=n7(i.impact),d=i.forceShouldAnimate;return e(n(o.x,o.y),i.movementMode,l,s.isClone,u,h,d)}if(i.phase==="DROP_ANIMATING"){const o=i.completed;if(o.result.draggableId!==s.draggableId)return null;const l=s.isClone,u=i.dimensions.draggables[s.draggableId],h=o.result,d=h.mode,p=PD(h),g=e7(h),y={duration:i.dropDuration,curve:_b.drop,moveTo:i.newHomeClientOffset,opacity:g?Nd.opacity.drop:null,scale:g?Nd.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:u,dropping:y,draggingOver:p,combineWith:g,mode:d,forceShouldAnimate:null,snapshot:t(d,l,p,g,y)}}}return null}}function FD(n=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:n,combineWith:null}}const i7={mapped:{type:"SECONDARY",offset:Dr,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:FD(null)}};function s7(){const n=Cr((o,l)=>({x:o,y:l})),t=Cr(FD),e=Cr((o,l=null,u)=>({mapped:{type:"SECONDARY",offset:o,combineTargetFor:l,shouldAnimateDisplacement:u,snapshot:t(l)}})),r=o=>o?e(Dr,o,!0):null,i=(o,l,u,h)=>{const d=u.displaced.visible[o],p=!!(h.inVirtualList&&h.effected[o]),g=Bm(u),v=g&&g.draggableId===o?l:null;if(!d){if(!p)return r(v);if(u.displaced.invisible[o])return null;const b=_f(h.displacedBy.point),E=n(b.x,b.y);return e(E,v,!0)}if(p)return r(v);const y=u.displacedBy.point,_=n(y.x,y.y);return e(_,v,d.shouldAnimate)};return(o,l)=>{if(Ld(o))return o.critical.draggable.id===l.draggableId?null:i(l.draggableId,o.critical.draggable.id,o.impact,o.afterCritical);if(o.phase==="DROP_ANIMATING"){const u=o.completed;return u.result.draggableId===l.draggableId?null:i(l.draggableId,u.result.draggableId,u.impact,u.afterCritical)}return null}}const a7=()=>{const n=r7(),t=s7();return(r,i)=>n(r,i)||t(r,i)||i7},o7={dropAnimationFinished:gD},l7=zC(a7,o7,null,{context:wb,areStatePropsEqual:ID})(t7);function BD(n){return Kg(Tb).isUsingCloneFor===n.draggableId&&!n.isClone?null:Qn.createElement(l7,n)}function c7(n){const t=typeof n.isDragDisabled=="boolean"?!n.isDragDisabled:!0,e=!!n.disableInteractiveElementBlocking,r=!!n.shouldRespectForcePress;return Qn.createElement(BD,Vg({},n,{isClone:!1,isEnabled:t,canDragInteractiveElements:e,shouldRespectForcePress:r}))}const UD=n=>t=>n===t,u7=UD("scroll"),f7=UD("auto"),D2=(n,t)=>t(n.overflowX)||t(n.overflowY),h7=n=>{const t=window.getComputedStyle(n),e={overflowX:t.overflowX,overflowY:t.overflowY};return D2(e,u7)||D2(e,f7)},d7=()=>!1,zD=n=>n==null?null:n===document.body?d7()?n:null:n===document.documentElement?null:h7(n)?n:zD(n.parentElement);var ay=n=>({x:n.scrollLeft,y:n.scrollTop});const HD=n=>n?window.getComputedStyle(n).position==="fixed"?!0:HD(n.parentElement):!1;var p7=n=>{const t=zD(n),e=HD(n);return{closestScrollable:t,isFixedOnPage:e}},g7=({descriptor:n,isEnabled:t,isCombineEnabled:e,isFixedOnPage:r,direction:i,client:s,page:o,closest:l})=>{const u=(()=>{if(!l)return null;const{scrollSize:g,client:v}=l,y=yD({scrollHeight:g.scrollHeight,scrollWidth:g.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:v,scrollSize:g,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:y,diff:{value:Dr,displacement:Dr}}}})(),h=i==="vertical"?fb:QC,d=cf({page:o,withPlaceholder:null,axis:h,frame:u});return{descriptor:n,isCombineEnabled:e,isFixedOnPage:r,axis:h,isEnabled:t,client:s,page:o,frame:u,subject:d}};const m7=(n,t)=>{const e=jC(n);if(!t||n!==t)return e;const r=e.paddingBox.top-t.scrollTop,i=e.paddingBox.left-t.scrollLeft,s=r+t.scrollHeight,o=i+t.scrollWidth,u=ob({top:r,right:o,bottom:s,left:i},e.border);return lb({borderBox:u,margin:e.margin,border:e.border,padding:e.padding})};var v7=({ref:n,descriptor:t,env:e,windowScroll:r,direction:i,isDropDisabled:s,isCombineEnabled:o,shouldClipSubject:l})=>{const u=e.closestScrollable,h=m7(n,u),d=Gg(h,r),p=(()=>{if(!u)return null;const v=jC(u),y={scrollHeight:u.scrollHeight,scrollWidth:u.scrollWidth};return{client:v,page:Gg(v,r),scroll:ay(u),scrollSize:y,shouldClipSubject:l}})();return g7({descriptor:t,isEnabled:!s,isCombineEnabled:o,isFixedOnPage:e.isFixedOnPage,direction:i,client:h,page:d,closest:p})};const _7={passive:!1},y7={passive:!0};var O2=n=>n.shouldPublishImmediately?_7:y7;const og=n=>n&&n.env.closestScrollable||null;function b7(n){const t=At.useRef(null),e=Kg(jm),r=Ab("droppable"),{registry:i,marshal:s}=e,o=DD(n),l=nn(()=>({id:n.droppableId,type:n.type,mode:n.mode}),[n.droppableId,n.mode,n.type]),u=At.useRef(l),h=nn(()=>Cr((O,R)=>{t.current||ie();const N={x:O,y:R};s.updateDroppableScroll(l.id,N)}),[l.id,s]),d=ye(()=>{const O=t.current;return!O||!O.env.closestScrollable?Dr:ay(O.env.closestScrollable)},[]),p=ye(()=>{const O=d();h(O.x,O.y)},[d,h]),g=nn(()=>Cd(p),[p]),v=ye(()=>{const O=t.current,R=og(O);if(O&&R||ie(),O.scrollOptions.shouldPublishImmediately){p();return}g()},[g,p]),y=ye((O,R)=>{t.current&&ie();const N=o.current,C=N.getDroppableRef();C||ie();const I=p7(C),M={ref:C,descriptor:l,env:I,scrollOptions:R};t.current=M;const F=v7({ref:C,descriptor:l,env:I,windowScroll:O,direction:N.direction,isDropDisabled:N.isDropDisabled,isCombineEnabled:N.isCombineEnabled,shouldClipSubject:!N.ignoreContainerClipping}),H=I.closestScrollable;return H&&(H.setAttribute(w2.contextId,e.contextId),H.addEventListener("scroll",v,O2(M.scrollOptions))),F},[e.contextId,l,v,o]),_=ye(()=>{const O=t.current,R=og(O);return O&&R||ie(),ay(R)},[]),b=ye(()=>{const O=t.current;O||ie();const R=og(O);t.current=null,R&&(g.cancel(),R.removeAttribute(w2.contextId),R.removeEventListener("scroll",v,O2(O.scrollOptions)))},[v,g]),E=ye(O=>{const R=t.current;R||ie();const N=og(R);N||ie(),N.scrollTop+=O.y,N.scrollLeft+=O.x},[]),S=nn(()=>({getDimensionAndWatchScroll:y,getScrollWhileDragging:_,dragStopped:b,scroll:E}),[b,y,_,E]),T=nn(()=>({uniqueId:r,descriptor:l,callbacks:S}),[S,l,r]);us(()=>(u.current=T.descriptor,i.droppable.register(T),()=>{t.current&&b(),i.droppable.unregister(T)}),[S,l,b,T,s,i.droppable]),us(()=>{t.current&&s.updateDroppableIsEnabled(u.current.id,!n.isDropDisabled)},[n.isDropDisabled,s]),us(()=>{t.current&&s.updateDroppableIsCombineEnabled(u.current.id,n.isCombineEnabled)},[n.isCombineEnabled,s])}function __(){}const R2={width:0,height:0,margin:C5},x7=({isAnimatingOpenOnMount:n,placeholder:t,animate:e})=>n||e==="close"?R2:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},E7=({isAnimatingOpenOnMount:n,placeholder:t,animate:e})=>{const r=x7({isAnimatingOpenOnMount:n,placeholder:t,animate:e});return{display:t.display,boxSizing:"border-box",width:r.width,height:r.height,marginTop:r.margin.top,marginRight:r.margin.right,marginBottom:r.margin.bottom,marginLeft:r.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:e!=="none"?pd.placeholder:null}},w7=n=>{const t=At.useRef(null),e=ye(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:r,onTransitionEnd:i,onClose:s,contextId:o}=n,[l,u]=At.useState(n.animate==="open");At.useEffect(()=>l?r!=="open"?(e(),u(!1),__):t.current?__:(t.current=setTimeout(()=>{t.current=null,u(!1)}),e):__,[r,l,e]);const h=ye(p=>{p.propertyName==="height"&&(i(),r==="close"&&s())},[r,s,i]),d=E7({isAnimatingOpenOnMount:l,animate:n.animate,placeholder:n.placeholder});return Qn.createElement(n.placeholder.tagName,{style:d,"data-rfd-placeholder-context-id":o,onTransitionEnd:h,ref:n.innerRef})};var A7=Qn.memo(w7);class S7 extends Qn.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,e){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:e.isVisible?{isVisible:!0,data:e.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const T7=n=>{const t=At.useContext(jm);t||ie();const{contextId:e,isMovementAllowed:r}=t,i=At.useRef(null),s=At.useRef(null),{children:o,droppableId:l,type:u,mode:h,direction:d,ignoreContainerClipping:p,isDropDisabled:g,isCombineEnabled:v,snapshot:y,useClone:_,updateViewportMaxScroll:b,getContainerForClone:E}=n,S=ye(()=>i.current,[]),T=ye((H=null)=>{i.current=H},[]);ye(()=>s.current,[]);const O=ye((H=null)=>{s.current=H},[]),R=ye(()=>{r()&&b({maxScroll:xD()})},[r,b]);b7({droppableId:l,type:u,mode:h,direction:d,isDropDisabled:g,isCombineEnabled:v,ignoreContainerClipping:p,getDroppableRef:S});const N=nn(()=>Qn.createElement(S7,{on:n.placeholder,shouldAnimate:n.shouldAnimatePlaceholder},({onClose:H,data:P,animate:et})=>Qn.createElement(A7,{placeholder:P,onClose:H,innerRef:O,animate:et,contextId:e,onTransitionEnd:R})),[e,R,n.placeholder,n.shouldAnimatePlaceholder,O]),C=nn(()=>({innerRef:T,placeholder:N,droppableProps:{"data-rfd-droppable-id":l,"data-rfd-droppable-context-id":e}}),[e,l,N,T]),I=_?_.dragging.draggableId:null,M=nn(()=>({droppableId:l,type:u,isUsingCloneFor:I}),[l,I,u]);function F(){if(!_)return null;const{dragging:H,render:P}=_,et=Qn.createElement(BD,{draggableId:H.draggableId,index:H.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(L,st)=>P(L,st,H));return p6.createPortal(et,E())}return Qn.createElement(Tb.Provider,{value:M},o(C,y),F())};function C7(){return document.body||ie(),document.body}const N2={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:C7},jD=n=>{let t={...n},e;for(e in N2)n[e]===void 0&&(t={...t,[e]:N2[e]});return t},y_=(n,t)=>n===t.droppable.type,k2=(n,t)=>t.draggables[n.draggable.id],D7=()=>{const n={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...n,shouldAnimatePlaceholder:!1},e=Cr(s=>({draggableId:s.id,type:s.type,source:{index:s.index,droppableId:s.droppableId}})),r=Cr((s,o,l,u,h,d)=>{const p=h.descriptor.id;if(h.descriptor.droppableId===s){const y=d?{render:d,dragging:e(h.descriptor)}:null,_={isDraggingOver:l,draggingOverWith:l?p:null,draggingFromThisWith:p,isUsingPlaceholder:!0};return{placeholder:h.placeholder,shouldAnimatePlaceholder:!1,snapshot:_,useClone:y}}if(!o)return t;if(!u)return n;const v={isDraggingOver:l,draggingOverWith:p,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:h.placeholder,shouldAnimatePlaceholder:!0,snapshot:v,useClone:null}});return(s,o)=>{const l=jD(o),u=l.droppableId,h=l.type,d=!l.isDropDisabled,p=l.renderClone;if(Ld(s)){const g=s.critical;if(!y_(h,g))return t;const v=k2(g,s.dimensions),y=cs(s.impact)===u;return r(u,d,y,y,v,p)}if(s.phase==="DROP_ANIMATING"){const g=s.completed;if(!y_(h,g.critical))return t;const v=k2(g.critical,s.dimensions);return r(u,d,PD(g.result)===u,cs(g.impact)===u,v,p)}if(s.phase==="IDLE"&&s.completed&&!s.shouldFlush){const g=s.completed;if(!y_(h,g.critical))return t;const v=cs(g.impact)===u,y=!!(g.impact.at&&g.impact.at.type==="COMBINE"),_=g.critical.droppable.id===u;return v?y?n:t:_?n:t}return t}},O7={updateViewportMaxScroll:U8},R7=zC(D7,O7,(n,t,e)=>({...jD(e),...n,...t}),{context:wb,areStatePropsEqual:ID})(T7),N7=({showOnLoad:n,onToggleShowOnLoad:t})=>ot.jsx(ot.Fragment,{children:ot.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:ot.jsxs("div",{className:"modal-content",children:[ot.jsxs("div",{className:"modal-header",children:[ot.jsx("img",{src:"js_logo_simbolo.png",alt:"JS Geologia Aplicada",style:{maxWidth:"50px"}}),ot.jsx("h5",{className:"modal-title flex-grow-1 text-center",children:"Extrator de dados de PDFs"}),ot.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),ot.jsxs("div",{className:"modal-body text-start",children:[ot.jsx("p",{className:"lead text-muted mb-3",children:"O Extrator de Dados de PDF da JS Geologia Aplicada  uma ferramenta desenvolvida para automatizar a extrao de informaes de relatrios de sondagem e outros documentos tcnicos, facilitando a organizao e anlise de dados geolgicos."}),ot.jsxs("div",{className:"mt-3 px-3 text-start",children:[ot.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Como usar"}),ot.jsxs("ol",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[ot.jsxs("li",{className:"mb-1 text-start",children:[ot.jsx("strong",{children:"Carregue um PDF"}),' clicando em "Escolher arquivo"']}),ot.jsxs("li",{className:"mb-1 text-start",children:[ot.jsx("strong",{children:"Adicione reas"})," para marcar regies que deseja extrair texto"]}),ot.jsxs("li",{className:"mb-1 text-start",children:[ot.jsx("strong",{children:"Renomeie as reas"})," clicando no nome para facilitar identificao"]}),ot.jsxs("li",{className:"mb-1 text-start",children:[ot.jsx("strong",{children:"Selecione as reas"})," clicando no cone de seleo e arrastando no PDF"]}),ot.jsxs("li",{className:"mb-1 text-start",children:[ot.jsx("strong",{children:"Extraia os dados"})," e exporte em JSON, CSV ou Excel"]})]})]}),ot.jsxs("div",{className:"mt-3 px-3 text-start",children:[ot.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Recursos disponveis"}),ot.jsxs("ul",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[ot.jsxs("li",{className:"mb-1 text-start",children:[ot.jsx("strong",{children:"At 10 reas"})," de extrao com cores diferentes"]}),ot.jsxs("li",{className:"mb-1 text-start",children:[ot.jsx("strong",{children:"Sistema de presets"})," para salvar configuraes"]}),ot.jsxs("li",{className:"mb-1 text-start",children:[ot.jsx("strong",{children:"Campos obrigatrios"})," para ignorar pginas que no contenham dados essenciais"]})]})]}),ot.jsx("div",{className:"alert alert-warning mt-3 mb-0 text-start",role:"alert",children:ot.jsx("p",{className:"mb-0 text-start",children:"A JS Geologia Aplicada no se responsabiliza por eventuais erros na leitura automtica dos dados."})})]}),ot.jsxs("div",{className:"modal-footer d-flex justify-content-between",children:[ot.jsxs("div",{className:"form-check form-switch",children:[ot.jsx("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:n,onChange:e=>{t(e.target.checked)}}),ot.jsx("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Mostrar ao abrir"})]}),ot.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Fechar"})]})]})})});function k7({onFileSelect:n,onExtractTexts:t,onStartAreaSelection:e,onDeleteArea:r,onRenameArea:i,onClearArea:s,onAddNewArea:o,onLoadPreset:l,onDragEnd:u,onToggleMandatory:h,onToggleRepeat:d,onChangeAreaType:p,areas:g,hasFile:v}){At.useEffect(()=>{const N=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));return N.forEach(C=>new Ps(C)),()=>{N.forEach(C=>{const I=Ps.getInstance(C);I&&I.dispose()})}},[g.length]);const[y,_]=At.useState(!1),b=()=>{_(!0)},[E,S]=At.useState(()=>localStorage.getItem("showHelpOnLoad")!=="false");At.useEffect(()=>{const N=()=>{new Ac("#helpModal").show()};if(E)if(document.readyState==="complete")N();else return window.addEventListener("load",N),()=>window.removeEventListener("load",N)},[]);const T=N=>{S(N),localStorage.setItem("showHelpOnLoad",N.toString())},O=()=>{confirm("Deseja remover todas as reas?")&&g.forEach(N=>{r(N.id)})},R=()=>{o_.forEach(N=>{g.find(C=>C.dataType===N)||o(N)})};return ot.jsxs(ot.Fragment,{children:[ot.jsx(h6,{onFileSelect:n}),ot.jsx("div",{className:"modal fade",id:"helpModal",tabIndex:-1,children:ot.jsx(N7,{showOnLoad:E,onToggleShowOnLoad:T})}),ot.jsxs("div",{className:"d-flex justify-content-end gap-2 my-3",children:[g.length>0&&ot.jsx("button",{"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Excluir todas as reas",className:"menu-btn menu-btn-warning",onClick:O,children:ot.jsx(rb,{size:24})}),ot.jsx("span",{"data-bs-placement":"top","data-bs-toggle":"tooltip","data-bs-title":"Ajuda",children:ot.jsx("button",{className:"menu-btn","data-bs-toggle":"modal","data-bs-target":"#helpModal",children:ot.jsx(PF,{size:24})})}),ot.jsx("button",{"data-bs-title":"Presets","data-bs-toggle":"tooltip","data-bs-target":"tooltip",className:"menu-btn",onClick:b,children:ot.jsx(HF,{size:24})}),ot.jsxs("div",{className:"btn-group",children:[ot.jsx("button",{type:"button","data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-trigger":"hover","data-bs-title":"Adicionar rea",className:"menu-btn",onClick:()=>o(),children:ot.jsx(VF,{size:24})}),ot.jsx("button",{className:"menu-btn dropdown-toggle dropdown-toggle-split",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:ot.jsx("span",{className:"visually-hidden",children:"Toggle Dropdown"})}),ot.jsxs("ul",{className:"dropdown-menu",id:"add-area-dropdown",style:{zIndex:1001},children:[o_.filter(N=>!g.find(C=>C.dataType===N)).map((N,C)=>ot.jsx("li",{children:ot.jsx("button",{className:"dropdown-item",type:"button","data-bs-dismiss":"dropdown",onClick:()=>o(N),children:Dc[N]})},`list-item${C}`)),ot.jsx("div",{className:"dropdown-divider"}),ot.jsx("li",{children:ot.jsx("button",{className:"dropdown-item",onClick:R,disabled:o_.some(N=>g.find(C=>C.dataType===N)),children:"Criar todos ausentes"})})]})]}),ot.jsx("button",{"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-title":"Extrair texto",className:"menu-btn menu-btn-cta",disabled:!(g.length>0&&v&&g.some(N=>N.coordinates)),onClick:t,children:ot.jsx(hd,{size:24})})]}),g.length===0&&ot.jsx("p",{className:"text-muted",children:"Adicione uma rea para comear!"}),ot.jsx(GU,{onDragEnd:u,children:ot.jsx(R7,{droppableId:"areas",children:N=>ot.jsxs("div",{className:"areas-container",...N.droppableProps,ref:N.innerRef,children:[g.map((C,I)=>ot.jsx(c7,{draggableId:C.id,index:I,children:M=>ot.jsx("div",{ref:M.innerRef,...M.draggableProps,...M.dragHandleProps,children:ot.jsx(u6,{area:C,areas:g,hasFile:v,onStartSelection:e,onClearArea:s,onDeleteArea:r,onRenameArea:i,onToggleMandatory:h,onToggleRepeat:d,onChangeAreaType:p},C.id)})},C.id)),N.placeholder]})})}),ot.jsx(d6,{isOpen:y,onClose:()=>_(!1),currentAreas:g,onLoadPreset:l})]})}const L7=(n,t)=>{const r={id:`area-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,name:Md(t?Dc[t]:"Nova rea",n),order:n.length+1,color:U7(n),coordinates:null,isMandatory:t?kC.includes(t):!1,repeatInPages:t?NC.includes(t):!1,dataType:t};return[...n,r]},M7=(n,t)=>n.filter(e=>e.id!==t).map((e,r)=>({...e,order:r+1})),I7=(n,t,e)=>{if(e.trim().toLowerCase()==="pagenumber")return alert('Nome "pageNumber"  reservado. Use outro nome.'),n;const r=Md(e,n);return n.map(i=>i.id===t?{...i,name:r}:i)},P7=(n,t)=>n.map(e=>e.id===t?{...e,coordinates:null}:e),L2=n=>Object.values(Dc).includes(n)||/^Nova rea( \(\d+\))?$/.test(n),F7=(n,t,e)=>n.map(r=>r.id===t?{...r,coordinates:e}:r),Md=(n,t)=>{let e=2,r=n;for(;t.some(i=>i.name===r);)r=`${n} (${e})`,e++;return r},B7=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F97316","#84CC16","#6B7280","#DC2626","#059669","#7C3AED","#BE123C","#0369A1"],U7=n=>{const t=n.map(e=>e.color);return B7.find(e=>!t.includes(e))??"#000000"},z7=({children:n})=>ot.jsxs("div",{className:"card mt-5",children:[ot.jsx("div",{className:"card-header",children:ot.jsx("img",{src:"js_logo_horizontal.png",alt:"JS Geologia Aplicada",style:{maxWidth:"200px"}})}),ot.jsxs("div",{className:"card-body",children:[ot.jsx("h4",{className:"card-title",children:"Extrator de dados de PDF"}),ot.jsx("p",{className:"card-text",children:"Selecione reas, extraia dados"}),n]})]}),H7=async(n,t)=>{const e=[],r=t.numPages,i=n.find(o=>o.dataType==="hole_id"),s=n.filter(o=>!o.repeatInPages&&o.dataType!=="hole_id");if(i&&i.coordinates){const o=i.name;for(let u=1;u<=r;u++){const h=await t.getPage(u),d=await h.getTextContent(),p=h.getViewport({scale:1}),g=e_(i.coordinates,1,1,p),v=n_(d,g);v.sort((_,b)=>b.transform[5]-_.transform[5]);const y=r_(v,[]).join(" ").trim();if(y){const _=e.find(b=>b[o]&&Array.isArray(b[o])&&b[o][0]===y);_?_.pageNumber.push(u):e.push({pageNumber:[u],[o]:[y]})}}const l=n.filter(u=>u.repeatInPages);if(l.length>0)for(const u of e){const h=u.pageNumber[0],d=await t.getPage(h),p=await d.getOperatorList(),g=await d.getTextContent(),v=d.getViewport({scale:1}),y=M2(p);l.forEach(_=>{if(_.coordinates){const b=e_(_.coordinates,1,1,v),E=n_(g,b);E.sort((T,O)=>O.transform[5]-T.transform[5]);const S=_.dataType==="nspt"?GA(E):r_(E,y);u[_.name]=S}})}}else for(let o=1;o<=r;o++)e.push({pageNumber:[o]});if(s.length>0)for(const o of e)for(const l of o.pageNumber){const u=await t.getPage(l),h=await u.getOperatorList(),d=await u.getTextContent(),p=u.getViewport({scale:1}),g=M2(h);s.forEach(v=>{if(v.coordinates){const y=e_(v.coordinates,1,1,p),_=n_(d,y);_.sort((E,S)=>S.transform[5]-E.transform[5]);const b=v.dataType==="nspt"?GA(_):r_(_,g);o[v.name]||(o[v.name]=[]),o[v.name].push(...b)}})}return e},M2=n=>{const t=[];for(let e=0;e<n.fnArray.length;e++)if(n.fnArray[e]===91){const r=n.argsArray[e][1][0];for(let i=0;i<r.length;i++)if(r[i]===1&&i>=2){const s=r[i-2],o=r[i-1],l=r[i+1],u=r[i+2];Math.abs(o-u)<2&&t.push({x1:Math.min(s,l),x2:Math.max(s,l),y:o})}}return t};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Zg={};Zg.version="0.20.3";var So=1200,Id=function(n){So=n};function j7(){Id(1200)}var lg=function(t){return String.fromCharCode(t)},I2=function(t){return String.fromCharCode(t)},ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qg(n){for(var t="",e=0,r=0,i=0,s=0,o=0,l=0,u=0,h=0;h<n.length;)e=n.charCodeAt(h++),s=e>>2,r=n.charCodeAt(h++),o=(e&3)<<4|r>>4,i=n.charCodeAt(h++),l=(r&15)<<2|i>>6,u=i&63,isNaN(r)?l=u=64:isNaN(i)&&(u=64),t+=ei.charAt(s)+ei.charAt(o)+ei.charAt(l)+ei.charAt(u);return t}function $7(n){for(var t="",e=0,r=0,i=0,s=0,o=0,l=0,u=0,h=0;h<n.length;)e=n.charCodeAt(h++),e>255&&(e=95),s=e>>2,r=n.charCodeAt(h++),r>255&&(r=95),o=(e&3)<<4|r>>4,i=n.charCodeAt(h++),i>255&&(i=95),l=(r&15)<<2|i>>6,u=i&63,isNaN(r)?l=u=64:isNaN(i)&&(u=64),t+=ei.charAt(s)+ei.charAt(o)+ei.charAt(l)+ei.charAt(u);return t}function G7(n){for(var t="",e=0,r=0,i=0,s=0,o=0,l=0,u=0,h=0;h<n.length;)e=n[h++],s=e>>2,r=n[h++],o=(e&3)<<4|r>>4,i=n[h++],l=(r&15)<<2|i>>6,u=i&63,isNaN(r)?l=u=64:isNaN(i)&&(u=64),t+=ei.charAt(s)+ei.charAt(o)+ei.charAt(l)+ei.charAt(u);return t}function Ol(n){var t="",e=0,r=0,i=0,s=0,o=0,l=0,u=0;if(n.slice(0,5)=="data:"){var h=n.slice(0,1024).indexOf(";base64,");h>-1&&(n=n.slice(h+8))}n=n.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<n.length;)s=ei.indexOf(n.charAt(h++)),o=ei.indexOf(n.charAt(h++)),e=s<<2|o>>4,t+=String.fromCharCode(e),l=ei.indexOf(n.charAt(h++)),r=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(r)),u=ei.indexOf(n.charAt(h++)),i=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var cn=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ja=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}(),Jg=function(){if(typeof Buffer>"u")return!1;var n=ja([65,0]);if(!n)return!1;var t=n.toString("utf16le");return t.length==1}();function Rc(n){return cn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function P2(n){return cn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var is=function(t){return cn?ja(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function Gm(n){if(typeof ArrayBuffer>"u")return is(n);for(var t=new ArrayBuffer(n.length),e=new Uint8Array(t),r=0;r!=n.length;++r)e[r]=n.charCodeAt(r)&255;return t}function Nc(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],e=0;e<n.length;++e)t[e]=String.fromCharCode(n[e]);return t.join("")}function V7(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var lr=cn?function(n){return Buffer.concat(n.map(function(t){return Buffer.isBuffer(t)?t:ja(t)}))}:function(n){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<n.length;++t)e+=n[t].length;var r=new Uint8Array(e),i=0;for(t=0,e=0;t<n.length;e+=i,++t)i=n[t].length,n[t]instanceof Uint8Array?r.set(n[t],e):typeof n[t]=="string"?r.set(new Uint8Array(is(n[t])),e):r.set(new Uint8Array(n[t]),e);return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function W7(n){for(var t=[],e=0,r=n.length+250,i=Rc(n.length+255),s=0;s<n.length;++s){var o=n.charCodeAt(s);if(o<128)i[e++]=o;else if(o<2048)i[e++]=192|o>>6&31,i[e++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=n.charCodeAt(++s)&1023;i[e++]=240|o>>8&7,i[e++]=128|o>>2&63,i[e++]=128|l>>6&15|(o&3)<<4,i[e++]=128|l&63}else i[e++]=224|o>>12&15,i[e++]=128|o>>6&63,i[e++]=128|o&63;e>r&&(t.push(i.slice(0,e)),e=0,i=Rc(65535),r=65530)}return t.push(i.slice(0,e)),lr(t)}var gd=/\u0000/g,cg=/[\u0001-\u0006]/g;function Wu(n){for(var t="",e=n.length-1;e>=0;)t+=n.charAt(e--);return t}function na(n,t){var e=""+n;return e.length>=t?e:Pn("0",t-e.length)+e}function Cb(n,t){var e=""+n;return e.length>=t?e:Pn(" ",t-e.length)+e}function tm(n,t){var e=""+n;return e.length>=t?e:e+Pn(" ",t-e.length)}function X7(n,t){var e=""+Math.round(n);return e.length>=t?e:Pn("0",t-e.length)+e}function Y7(n,t){var e=""+n;return e.length>=t?e:Pn("0",t-e.length)+e}var F2=Math.pow(2,32);function ku(n,t){if(n>F2||n<-F2)return X7(n,t);var e=Math.round(n);return Y7(e,t)}function em(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var B2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],b_=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function q7(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Rn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},U2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},K7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function nm(n,t,e){for(var r=n<0?-1:1,i=n*r,s=0,o=1,l=0,u=1,h=0,d=0,p=Math.floor(i);h<t&&(p=Math.floor(i),l=p*o+s,d=p*h+u,!(i-p<5e-8));)i=1/(i-p),s=o,o=l,u=h,h=d;if(d>t&&(h>t?(d=u,l=s):(d=h,l=o)),!e)return[0,r*l,d];var g=Math.floor(r*l/d);return[g,r*l-g*d,d]}function Z7(n){var t=n.toPrecision(16);if(t.indexOf("e")>-1){var e=t.slice(0,t.indexOf("e"));return e=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+Pn("0",e.length-15),e+t.slice(t.indexOf("e"))}var r=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Pn("0",t.length-15);return Number(r)}function Lu(n,t,e){if(n>2958465||n<0)return null;n=Z7(n);var r=n|0,i=Math.floor(86400*(n-r)),s=0,o=[],l={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(r+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++r,++l.D)),r===60)o=e?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=e?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),r<60&&(s=(s+6)%7),e&&(s=n9(u,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}function Db(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Q7(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function J7(n){var t=n<0?12:11,e=Db(n.toFixed(12));return e.length<=t||(e=n.toPrecision(10),e.length<=t)?e:n.toExponential(5)}function t9(n){var t=Db(n.toFixed(11));return t.length>(n<0?12:11)||t==="0"||t==="-0"?n.toPrecision(6):t}function e9(n){if(!isFinite(n))return isNaN(n)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),e;return t>=-4&&t<=-1?e=n.toPrecision(10+t):Math.abs(t)<=9?e=J7(n):t===10?e=n.toFixed(10).substr(0,12):e=t9(n),Db(Q7(e.toUpperCase()))}function oy(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):e9(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Mo(14,zr(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}function n9(n,t){t[0]-=581;var e=n.getDay();return n<60&&(e=(e+6)%7),e}function r9(n,t,e,r){var i="",s=0,o=0,l=e.y,u,h=0;switch(n){case 98:l=e.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,h=2;break;default:u=l%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:u=e.m,h=t.length;break;case 3:return b_[e.m-1][1];case 5:return b_[e.m-1][0];default:return b_[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=e.d,h=t.length;break;case 3:return B2[e.q][0];default:return B2[e.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(e.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=e.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=e.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?na(e.S,t.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(e.S+e.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=na(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=e.D*24+e.H;break;case"[m]":case"[mm]":u=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":u=((e.D*24+e.H)*60+e.M)*60+(r==0?Math.round(e.S+e.u):e.S);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:u=l,h=1;break}var d=h>0?na(u,h):"";return d}function yl(n){var t=3;if(n.length<=t)return n;for(var e=n.length%t,r=n.substr(0,e);e!=n.length;e+=t)r+=(r.length>0?",":"")+n.substr(e,t);return r}var $D=/%/g;function i9(n,t,e){var r=t.replace($D,""),i=t.length-r.length;return Do(n,r,e*Math.pow(10,2*i))+Pn("%",i)}function s9(n,t,e){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Do(n,t.substr(0,r),e/Math.pow(10,3*(t.length-r)))}function GD(n,t){var e,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+GD(n,-t);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),e=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),e.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+s):e+="E+"+(o-s);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,h,d){return u+h+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else e=t.toExponential(r);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var VD=/# (\?+)( ?)\/( ?)(\d+)/;function a9(n,t,e){var r=parseInt(n[4],10),i=Math.round(t*r),s=Math.floor(i/r),o=i-s*r,l=r;return e+(s===0?"":""+s)+" "+(o===0?Pn(" ",n[1].length+1+n[4].length):Cb(o,n[1].length)+n[2]+"/"+n[3]+na(l,n[4].length))}function o9(n,t,e){return e+(t===0?"":""+t)+Pn(" ",n[1].length+2+n[4].length)}var WD=/^#*0*\.([0#]+)/,XD=/\)[^)]*[0#]/,YD=/\(###\) ###\\?-####/;function bi(n){for(var t="",e,r=0;r!=n.length;++r)switch(e=n.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function z2(n,t){var e=Math.pow(10,t);return""+Math.round(n*e)/e}function H2(n,t){var e=n-Math.floor(n),r=Math.pow(10,t);return t<(""+Math.round(e*r)).length?0:Math.round(e*r)}function l9(n,t){return t<(""+Math.round((n-Math.floor(n))*Math.pow(10,t))).length?1:0}function c9(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ds(n,t,e){if(n.charCodeAt(0)===40&&!t.match(XD)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ds("n",r,e):"("+Ds("n",r,-e)+")"}if(t.charCodeAt(t.length-1)===44)return s9(n,t,e);if(t.indexOf("%")!==-1)return i9(n,t,e);if(t.indexOf("E")!==-1)return GD(t,e);if(t.charCodeAt(0)===36)return"$"+Ds(n,t.substr(t.charAt(1)==" "?2:1),e);var i,s,o,l,u=Math.abs(e),h=e<0?"-":"";if(t.match(/^00+$/))return h+ku(u,t.length);if(t.match(/^[#?]+$/))return i=ku(e,0),i==="0"&&(i=""),i.length>t.length?i:bi(t.substr(0,t.length-i.length))+i;if(s=t.match(VD))return a9(s,u,h);if(t.match(/^#+0+$/))return h+ku(u,t.length-t.indexOf("0"));if(s=t.match(WD))return i=z2(e,s[1].length).replace(/^([^\.]+)$/,"$1."+bi(s[1])).replace(/\.$/,"."+bi(s[1])).replace(/\.(\d*)$/,function(y,_){return"."+_+Pn("0",bi(s[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+z2(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+yl(ku(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ds(n,t,-e):yl(""+(Math.floor(e)+l9(e,s[1].length)))+"."+na(H2(e,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ds(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Wu(Ds(n,t.replace(/[\\-]/g,""),e)),o=0,Wu(Wu(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(t.match(YD))return i=Ds(n,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=nm(u,Math.pow(10,o)-1,!1),i=""+h,d=Do("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=tm(l[2],o),d.length<s[4].length&&(d=bi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=nm(u,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Cb(l[1],o)+s[2]+"/"+s[3]+tm(l[2],o):Pn(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=ku(e,0),t.length<=i.length?i:bi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=t.indexOf(".")-o,g=t.length-i.length-p;return bi(t.substr(0,p)+i+t.substr(t.length-g))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=H2(e,s[1].length),e<0?"-"+Ds(n,t,-e):yl(c9(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?na(0,3-y.length):"")+y})+"."+na(o,s[1].length);switch(t){case"###,##0.00":return Ds(n,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var v=yl(ku(u,0));return v!=="0"?h+v:"";case"###,###.00":return Ds(n,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Ds(n,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function u9(n,t,e){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Do(n,t.substr(0,r),e/Math.pow(10,3*(t.length-r)))}function f9(n,t,e){var r=t.replace($D,""),i=t.length-r.length;return Do(n,r,e*Math.pow(10,2*i))+Pn("%",i)}function qD(n,t){var e,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qD(n,-t);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),e=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!e.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+s):e+="E+"+(o-s),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,h,d){return u+h+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else e=t.toExponential(r);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Oa(n,t,e){if(n.charCodeAt(0)===40&&!t.match(XD)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Oa("n",r,e):"("+Oa("n",r,-e)+")"}if(t.charCodeAt(t.length-1)===44)return u9(n,t,e);if(t.indexOf("%")!==-1)return f9(n,t,e);if(t.indexOf("E")!==-1)return qD(t,e);if(t.charCodeAt(0)===36)return"$"+Oa(n,t.substr(t.charAt(1)==" "?2:1),e);var i,s,o,l,u=Math.abs(e),h=e<0?"-":"";if(t.match(/^00+$/))return h+na(u,t.length);if(t.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>t.length?i:bi(t.substr(0,t.length-i.length))+i;if(s=t.match(VD))return o9(s,u,h);if(t.match(/^#+0+$/))return h+na(u,t.length-t.indexOf("0"));if(s=t.match(WD))return i=(""+e).replace(/^([^\.]+)$/,"$1."+bi(s[1])).replace(/\.$/,"."+bi(s[1])),i=i.replace(/\.(\d*)$/,function(y,_){return"."+_+Pn("0",bi(s[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+yl(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Oa(n,t,-e):yl(""+e)+"."+Pn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Oa(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Wu(Oa(n,t.replace(/[\\-]/g,""),e)),o=0,Wu(Wu(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(t.match(YD))return i=Oa(n,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=nm(u,Math.pow(10,o)-1,!1),i=""+h,d=Do("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=tm(l[2],o),d.length<s[4].length&&(d=bi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=nm(u,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Cb(l[1],o)+s[2]+"/"+s[3]+tm(l[2],o):Pn(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+e,t.length<=i.length?i:bi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var p=t.indexOf(".")-o,g=t.length-i.length-p;return bi(t.substr(0,p)+i+t.substr(t.length-g))}if(s=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Oa(n,t,-e):yl(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?na(0,3-y.length):"")+y})+"."+na(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=yl(""+u);return v!=="0"?h+v:"";default:if(t.match(/\.[0#?]*$/))return Oa(n,t.slice(0,t.lastIndexOf(".")),e)+bi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Do(n,t,e){return(e|0)===e?Oa(n,t,e):Ds(n,t,e)}function h9(n){for(var t=[],e=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:e=!e;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=n.substr(i,r-i),i=r+1}if(t[t.length]=n.substr(i),e===!0)throw new Error("Format |"+n+"| unterminated string ");return t}var KD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function kc(n){for(var t=0,e="",r="";t<n.length;)switch(e=n.charAt(t)){case"G":em(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=e;n.charAt(t++)!=="]"&&t<n.length;)r+=n.charAt(t);if(r.match(KD))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(e=n.charAt(++t))>-1||e=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===e;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function d9(n,t,e,r){for(var i=[],s="",o=0,l="",u="t",h,d,p,g="H";o<n.length;)switch(l=n.charAt(o)){case"G":if(!em(n,o))throw new Error("unrecognized character "+l+" in "+n);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(p=n.charCodeAt(++o))!==34&&o<n.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++o;break;case"\\":var v=n.charAt(++o),y=v==="("||v===")"?v:"t";i[i.length]={t:y,v},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(n.charAt(o+1)==="1"||n.charAt(o+1)==="2"){if(h==null&&(h=Lu(t,e,n.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:n.substr(o,2)},u=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Lu(t,e),h==null))return"";for(s=l;++o<n.length&&n.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=g),i[i.length]={t:l,v:s},u=l;break;case"A":case"a":case"":var _={t:l,v:l};if(h==null&&(h=Lu(t,e)),n.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(_.v=h.H>=12?n.charAt(o+2):l),_.t="T",g="h",o+=3):n.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(_.v=h.H>=12?"PM":"AM"),_.t="T",o+=5,g="h"):n.substr(o,5).toUpperCase()==="/"?(h!=null&&(_.v=h.H>=12?"":""),_.t="T",o+=5,g="h"):(_.t="t",++o),h==null&&_.t==="T")return"";i[i.length]=_,u=l;break;case"[":for(s=l;n.charAt(o++)!=="]"&&o<n.length;)s+=n.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(KD)){if(h==null&&(h=Lu(t,e),h==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",kc(n)||(i[i.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=l;++o<n.length&&(l=n.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<n.length&&"0#?.,E+-%".indexOf(l=n.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;n.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},u=l;break;case"*":++o,(n.charAt(o)==" "||n.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;)s+=n.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+n);i[i.length]={t:"t",v:l},++o;break}var b=0,E=0,S;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=g,u="h",b<1&&(b=1);break;case"s":(S=i[o].v.match(/\.0+$/))&&(E=Math.max(E,S[0].length-1),b=4),b<3&&(b=3);case"d":case"y":case"e":u=i[o].t;break;case"M":u=i[o].t,b<2&&(b=2);break;case"m":u==="s"&&(i[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[o].v.match(/[Hh]/)&&(b=1),b<2&&i[o].v.match(/[Mm]/)&&(b=2),b<3&&i[o].v.match(/[Ss]/)&&(b=3)}var T;switch(b){case 0:break;case 1:case 2:case 3:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,T=Lu(h.D),T.u=h.u,T.S=h.S,T.M=h.M,T.H=h.H,h=T);break;case 4:switch(E){case 1:h.u=Math.round(h.u*10)/10;break;case 2:h.u=Math.round(h.u*100)/100;break;case 3:h.u=Math.round(h.u*1e3)/1e3;break}h.u>=1&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,T=Lu(h.D),T.u=h.u,T.S=h.S,T.M=h.M,T.H=h.H,h=T);break}var O="",R;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=r9(i[o].t.charCodeAt(0),i[o].v,h,E),i[o].t="t";break;case"n":case"?":for(R=o+1;i[R]!=null&&((l=i[R].t)==="?"||l==="D"||(l===" "||l==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[o].v+=i[R].v,i[R]={v:"",t:";"},++R;O+=i[o].v,o=R-1;break;case"G":i[o].t="t",i[o].v=oy(t,e);break}var N="",C,I;if(O.length>0){O.charCodeAt(0)==40?(C=t<0&&O.charCodeAt(0)===45?-t:t,I=Do("n",O,C)):(C=t<0&&r>1?-t:t,I=Do("n",O,C),C<0&&i[0]&&i[0].t=="t"&&(I=I.substr(1),i[0].v="-"+i[0].v)),R=I.length-1;var M=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){M=o;break}var F=i.length;if(M===i.length&&I.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(R>=i[o].v.length-1?(R-=i[o].v.length,i[o].v=I.substr(R+1,i[o].v.length)):R<0?i[o].v="":(i[o].v=I.substr(0,R+1),R=-1),i[o].t="t",F=o);R>=0&&F<i.length&&(i[F].v=I.substr(0,R+1)+i[F].v)}else if(M!==i.length&&I.indexOf("E")===-1){for(R=I.indexOf(".")-1,o=M;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===M?i[o].v.indexOf(".")-1:i[o].v.length-1,N=i[o].v.substr(d+1);d>=0;--d)R>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(N=I.charAt(R--)+N);i[o].v=N,i[o].t="t",F=o}for(R>=0&&F<i.length&&(i[F].v=I.substr(0,R+1)+i[F].v),R=I.indexOf(".")+1,o=M;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==M)){for(d=i[o].v.indexOf(".")>-1&&o===M?i[o].v.indexOf(".")+1:0,N=i[o].v.substr(0,d);d<i[o].v.length;++d)R<I.length&&(N+=I.charAt(R++));i[o].v=N,i[o].t="t",F=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(C=r>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Do(i[o].t,i[o].v,C),i[o].t="t");var H="";for(o=0;o!==i.length;++o)i[o]!=null&&(H+=i[o].v);return H}var j2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $2(n,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(n==e)return!0;break;case">":if(n>e)return!0;break;case"<":if(n<e)return!0;break;case"<>":if(n!=e)return!0;break;case">=":if(n>=e)return!0;break;case"<=":if(n<=e)return!0;break}return!1}function p9(n,t){var e=h9(n),r=e.length,i=e[r-1].indexOf("@");if(r<4&&i>-1&&--r,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var s=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[r,s];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var o=e[0].match(j2),l=e[1].match(j2);return $2(t,o)?[r,e[0]]:$2(t,l)?[r,e[1]]:[r,e[o!=null&&l!=null?2:1]]}return[r,s]}function Mo(n,t,e){e==null&&(e={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&e.dateNF?r=e.dateNF:r=n;break;case"number":n==14&&e.dateNF?r=e.dateNF:r=(e.table!=null?e.table:Rn)[n],r==null&&(r=e.table&&e.table[U2[n]]||Rn[U2[n]]),r==null&&(r=K7[n]||"General");break}if(em(r,0))return oy(t,e);t instanceof Date&&(t=zr(t,e.date1904));var i=p9(r,t);if(em(i[1]))return oy(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return d9(i[1],t,e,i[0])}function ZD(n,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(Rn[e]==null){t<0&&(t=e);continue}if(Rn[e]==n){t=e;break}}t<0&&(t=391)}return Rn[t]=n,t}function Vm(n){for(var t=0;t!=392;++t)n[t]!==void 0&&ZD(n[t],t)}function Wm(){Rn=q7()}var rm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function g9(n){var t=typeof n=="number"?Rn[n]:n;return t=t.replace(rm,"(\\d+)"),rm.lastIndex=0,new RegExp("^"+t+"$")}function m9(n,t,e){var r=-1,i=-1,s=-1,o=-1,l=-1,u=-1;(t.match(rm)||[]).forEach(function(p,g){var v=parseInt(e[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":r=v;break;case"d":s=v;break;case"h":o=v;break;case"s":u=v;break;case"m":o>=0?l=v:i=v;break}}),rm.lastIndex=0,u>=0&&l==-1&&i>=0&&(l=i,i=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&l==-1&&u==-1?h:r==-1&&i==-1&&s==-1?d:h+"T"+d}var v9={"d.m":"d\\.m"};function _9(n,t){return ZD(v9[n]||n,t)}var G2=function(){var n={};n.version="1.2.0";function t(){for(var C=0,I=new Array(256),M=0;M!=256;++M)C=M,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,I[M]=C;return typeof Int32Array<"u"?new Int32Array(I):I}var e=t();function r(C){var I=0,M=0,F=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)H[F]=C[F];for(F=0;F!=256;++F)for(M=C[F],I=256+F;I<4096;I+=256)M=H[I]=M>>>8^C[M&255];var P=[];for(F=1;F!=16;++F)P[F-1]=typeof Int32Array<"u"&&typeof H.subarray=="function"?H.subarray(F*256,F*256+256):H.slice(F*256,F*256+256);return P}var i=r(e),s=i[0],o=i[1],l=i[2],u=i[3],h=i[4],d=i[5],p=i[6],g=i[7],v=i[8],y=i[9],_=i[10],b=i[11],E=i[12],S=i[13],T=i[14];function O(C,I){for(var M=I^-1,F=0,H=C.length;F<H;)M=M>>>8^e[(M^C.charCodeAt(F++))&255];return~M}function R(C,I){for(var M=I^-1,F=C.length-15,H=0;H<F;)M=T[C[H++]^M&255]^S[C[H++]^M>>8&255]^E[C[H++]^M>>16&255]^b[C[H++]^M>>>24]^_[C[H++]]^y[C[H++]]^v[C[H++]]^g[C[H++]]^p[C[H++]]^d[C[H++]]^h[C[H++]]^u[C[H++]]^l[C[H++]]^o[C[H++]]^s[C[H++]]^e[C[H++]];for(F+=15;H<F;)M=M>>>8^e[(M^C[H++])&255];return~M}function N(C,I){for(var M=I^-1,F=0,H=C.length,P=0,et=0;F<H;)P=C.charCodeAt(F++),P<128?M=M>>>8^e[(M^P)&255]:P<2048?(M=M>>>8^e[(M^(192|P>>6&31))&255],M=M>>>8^e[(M^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,et=C.charCodeAt(F++)&1023,M=M>>>8^e[(M^(240|P>>8&7))&255],M=M>>>8^e[(M^(128|P>>2&63))&255],M=M>>>8^e[(M^(128|et>>6&15|(P&3)<<4))&255],M=M>>>8^e[(M^(128|et&63))&255]):(M=M>>>8^e[(M^(224|P>>12&15))&255],M=M>>>8^e[(M^(128|P>>6&63))&255],M=M>>>8^e[(M^(128|P&63))&255]);return~M}return n.table=e,n.bstr=O,n.buf=R,n.str=N,n}(),Tn=function(){var t={};t.version="1.2.2";function e(G,rt){for(var Z=G.split("/"),tt=rt.split("/"),nt=0,at=0,kt=Math.min(Z.length,tt.length);nt<kt;++nt){if(at=Z[nt].length-tt[nt].length)return at;if(Z[nt]!=tt[nt])return Z[nt]<tt[nt]?-1:1}return Z.length-tt.length}function r(G){if(G.charAt(G.length-1)=="/")return G.slice(0,-1).indexOf("/")===-1?G:r(G.slice(0,-1));var rt=G.lastIndexOf("/");return rt===-1?G:G.slice(0,rt+1)}function i(G){if(G.charAt(G.length-1)=="/")return i(G.slice(0,-1));var rt=G.lastIndexOf("/");return rt===-1?G:G.slice(rt+1)}function s(G,rt){typeof rt=="string"&&(rt=new Date(rt));var Z=rt.getHours();Z=Z<<6|rt.getMinutes(),Z=Z<<5|rt.getSeconds()>>>1,G.write_shift(2,Z);var tt=rt.getFullYear()-1980;tt=tt<<4|rt.getMonth()+1,tt=tt<<5|rt.getDate(),G.write_shift(2,tt)}function o(G){var rt=G.read_shift(2)&65535,Z=G.read_shift(2)&65535,tt=new Date,nt=Z&31;Z>>>=5;var at=Z&15;Z>>>=4,tt.setMilliseconds(0),tt.setFullYear(Z+1980),tt.setMonth(at-1),tt.setDate(nt);var kt=rt&31;rt>>>=5;var Ht=rt&63;return rt>>>=6,tt.setHours(rt),tt.setMinutes(Ht),tt.setSeconds(kt<<1),tt}function l(G){xi(G,0);for(var rt={},Z=0;G.l<=G.length-4;){var tt=G.read_shift(2),nt=G.read_shift(2),at=G.l+nt,kt={};switch(tt){case 21589:Z=G.read_shift(1),Z&1&&(kt.mtime=G.read_shift(4)),nt>5&&(Z&2&&(kt.atime=G.read_shift(4)),Z&4&&(kt.ctime=G.read_shift(4))),kt.mtime&&(kt.mt=new Date(kt.mtime*1e3));break;case 1:{var Ht=G.read_shift(4),yt=G.read_shift(4);kt.usz=yt*Math.pow(2,32)+Ht,Ht=G.read_shift(4),yt=G.read_shift(4),kt.csz=yt*Math.pow(2,32)+Ht}break}G.l=at,rt[tt]=kt}return rt}var u;function h(){return u||(u=y9)}function d(G,rt){if(G[0]==80&&G[1]==75)return Ga(G,rt);if((G[0]|32)==109&&(G[1]|32)==105)return aa(G,rt);if(G.length<512)throw new Error("CFB file size "+G.length+" < 512");var Z=3,tt=512,nt=0,at=0,kt=0,Ht=0,yt=0,Tt=[],Ct=G.slice(0,512);xi(Ct,0);var Vt=p(Ct);switch(Z=Vt[0],Z){case 3:tt=512;break;case 4:tt=4096;break;case 0:if(Vt[1]==0)return Ga(G,rt);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}tt!==512&&(Ct=G.slice(0,tt),xi(Ct,28));var te=G.slice(0,tt);g(Ct,Z);var oe=Ct.read_shift(4,"i");if(Z===3&&oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+oe);Ct.l+=4,kt=Ct.read_shift(4,"i"),Ct.l+=4,Ct.chk("00100000","Mini Stream Cutoff Size: "),Ht=Ct.read_shift(4,"i"),nt=Ct.read_shift(4,"i"),yt=Ct.read_shift(4,"i"),at=Ct.read_shift(4,"i");for(var Qt=-1,ee=0;ee<109&&(Qt=Ct.read_shift(4,"i"),!(Qt<0));++ee)Tt[ee]=Qt;var Le=v(G,tt);b(yt,at,Le,tt,Tt);var rn=S(Le,kt,Tt,tt);kt<rn.length&&(rn[kt].name="!Directory"),nt>0&&Ht!==et&&(rn[Ht].name="!MiniFAT"),rn[Tt[0]].name="!FAT",rn.fat_addrs=Tt,rn.ssz=tt;var Ze={},fn=[],Gi=[],ps=[];T(kt,rn,Le,fn,nt,Ze,Gi,Ht),y(Gi,ps,fn),fn.shift();var oi={FileIndex:Gi,FullPaths:ps};return rt&&rt.raw&&(oi.raw={header:te,sectors:Le}),oi}function p(G){if(G[G.l]==80&&G[G.l+1]==75)return[0,0];G.chk(L,"Header Signature: "),G.l+=16;var rt=G.read_shift(2,"u");return[G.read_shift(2,"u"),rt]}function g(G,rt){var Z=9;switch(G.l+=2,Z=G.read_shift(2)){case 9:if(rt!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(rt!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}G.chk("0600","Mini Sector Shift: "),G.chk("000000000000","Reserved: ")}function v(G,rt){for(var Z=Math.ceil(G.length/rt)-1,tt=[],nt=1;nt<Z;++nt)tt[nt-1]=G.slice(nt*rt,(nt+1)*rt);return tt[Z-1]=G.slice(Z*rt),tt}function y(G,rt,Z){for(var tt=0,nt=0,at=0,kt=0,Ht=0,yt=Z.length,Tt=[],Ct=[];tt<yt;++tt)Tt[tt]=Ct[tt]=tt,rt[tt]=Z[tt];for(;Ht<Ct.length;++Ht)tt=Ct[Ht],nt=G[tt].L,at=G[tt].R,kt=G[tt].C,Tt[tt]===tt&&(nt!==-1&&Tt[nt]!==nt&&(Tt[tt]=Tt[nt]),at!==-1&&Tt[at]!==at&&(Tt[tt]=Tt[at])),kt!==-1&&(Tt[kt]=tt),nt!==-1&&tt!=Tt[tt]&&(Tt[nt]=Tt[tt],Ct.lastIndexOf(nt)<Ht&&Ct.push(nt)),at!==-1&&tt!=Tt[tt]&&(Tt[at]=Tt[tt],Ct.lastIndexOf(at)<Ht&&Ct.push(at));for(tt=1;tt<yt;++tt)Tt[tt]===tt&&(at!==-1&&Tt[at]!==at?Tt[tt]=Tt[at]:nt!==-1&&Tt[nt]!==nt&&(Tt[tt]=Tt[nt]));for(tt=1;tt<yt;++tt)if(G[tt].type!==0){if(Ht=tt,Ht!=Tt[Ht])do Ht=Tt[Ht],rt[tt]=rt[Ht]+"/"+rt[tt];while(Ht!==0&&Tt[Ht]!==-1&&Ht!=Tt[Ht]);Tt[tt]=-1}for(rt[0]+="/",tt=1;tt<yt;++tt)G[tt].type!==2&&(rt[tt]+="/")}function _(G,rt,Z){for(var tt=G.start,nt=G.size,at=[],kt=tt;Z&&nt>0&&kt>=0;)at.push(rt.slice(kt*P,kt*P+P)),nt-=P,kt=dc(Z,kt*4);return at.length===0?It(0):lr(at).slice(0,G.size)}function b(G,rt,Z,tt,nt){var at=et;if(G===et){if(rt!==0)throw new Error("DIFAT chain shorter than expected")}else if(G!==-1){var kt=Z[G],Ht=(tt>>>2)-1;if(!kt)return;for(var yt=0;yt<Ht&&(at=dc(kt,yt*4))!==et;++yt)nt.push(at);rt>=1&&b(dc(kt,tt-4),rt-1,Z,tt,nt)}}function E(G,rt,Z,tt,nt){var at=[],kt=[];nt||(nt=[]);var Ht=tt-1,yt=0,Tt=0;for(yt=rt;yt>=0;){nt[yt]=!0,at[at.length]=yt,kt.push(G[yt]);var Ct=Z[Math.floor(yt*4/tt)];if(Tt=yt*4&Ht,tt<4+Tt)throw new Error("FAT boundary crossed: "+yt+" 4 "+tt);if(!G[Ct])break;yt=dc(G[Ct],Tt)}return{nodes:at,data:Z2([kt])}}function S(G,rt,Z,tt){var nt=G.length,at=[],kt=[],Ht=[],yt=[],Tt=tt-1,Ct=0,Vt=0,te=0,oe=0;for(Ct=0;Ct<nt;++Ct)if(Ht=[],te=Ct+rt,te>=nt&&(te-=nt),!kt[te]){yt=[];var Qt=[];for(Vt=te;Vt>=0;){Qt[Vt]=!0,kt[Vt]=!0,Ht[Ht.length]=Vt,yt.push(G[Vt]);var ee=Z[Math.floor(Vt*4/tt)];if(oe=Vt*4&Tt,tt<4+oe)throw new Error("FAT boundary crossed: "+Vt+" 4 "+tt);if(!G[ee]||(Vt=dc(G[ee],oe),Qt[Vt]))break}at[te]={nodes:Ht,data:Z2([yt])}}return at}function T(G,rt,Z,tt,nt,at,kt,Ht){for(var yt=0,Tt=tt.length?2:0,Ct=rt[G].data,Vt=0,te=0,oe;Vt<Ct.length;Vt+=128){var Qt=Ct.slice(Vt,Vt+128);xi(Qt,64),te=Qt.read_shift(2),oe=Mb(Qt,0,te-Tt),tt.push(oe);var ee={name:oe,type:Qt.read_shift(1),color:Qt.read_shift(1),L:Qt.read_shift(4,"i"),R:Qt.read_shift(4,"i"),C:Qt.read_shift(4,"i"),clsid:Qt.read_shift(16),state:Qt.read_shift(4,"i"),start:0,size:0},Le=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);Le!==0&&(ee.ct=O(Qt,Qt.l-8));var rn=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);rn!==0&&(ee.mt=O(Qt,Qt.l-8)),ee.start=Qt.read_shift(4,"i"),ee.size=Qt.read_shift(4,"i"),ee.size<0&&ee.start<0&&(ee.size=ee.type=0,ee.start=et,ee.name=""),ee.type===5?(yt=ee.start,nt>0&&yt!==et&&(rt[yt].name="!StreamData")):ee.size>=4096?(ee.storage="fat",rt[ee.start]===void 0&&(rt[ee.start]=E(Z,ee.start,rt.fat_addrs,rt.ssz)),rt[ee.start].name=ee.name,ee.content=rt[ee.start].data.slice(0,ee.size)):(ee.storage="minifat",ee.size<0?ee.size=0:yt!==et&&ee.start!==et&&rt[yt]&&(ee.content=_(ee,rt[yt].data,(rt[Ht]||{}).data))),ee.content&&xi(ee.content,0),at[oe]=ee,kt.push(ee)}}function O(G,rt){return new Date((as(G,rt+4)/1e7*Math.pow(2,32)+as(G,rt)/1e7-11644473600)*1e3)}function R(G,rt){return h(),d(u.readFileSync(G),rt)}function N(G,rt){var Z=rt&&rt.type;switch(Z||cn&&Buffer.isBuffer(G)&&(Z="buffer"),Z||"base64"){case"file":return R(G,rt);case"base64":return d(is(Ol(G)),rt);case"binary":return d(is(G),rt)}return d(G,rt)}function C(G,rt){var Z=rt||{},tt=Z.root||"Root Entry";if(G.FullPaths||(G.FullPaths=[]),G.FileIndex||(G.FileIndex=[]),G.FullPaths.length!==G.FileIndex.length)throw new Error("inconsistent CFB structure");G.FullPaths.length===0&&(G.FullPaths[0]=tt+"/",G.FileIndex[0]={name:tt,type:5}),Z.CLSID&&(G.FileIndex[0].clsid=Z.CLSID),I(G)}function I(G){var rt="Sh33tJ5";if(!Tn.find(G,"/"+rt)){var Z=It(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,G.FileIndex.push({name:rt,type:2,content:Z,size:4,L:69,R:69,C:69}),G.FullPaths.push(G.FullPaths[0]+rt),M(G)}}function M(G,rt){C(G);for(var Z=!1,tt=!1,nt=G.FullPaths.length-1;nt>=0;--nt){var at=G.FileIndex[nt];switch(at.type){case 0:tt?Z=!0:(G.FileIndex.pop(),G.FullPaths.pop());break;case 1:case 2:case 5:tt=!0,isNaN(at.R*at.L*at.C)&&(Z=!0),at.R>-1&&at.L>-1&&at.R==at.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!rt)){var kt=new Date(1987,1,19),Ht=0,yt=Object.create?Object.create(null):{},Tt=[];for(nt=0;nt<G.FullPaths.length;++nt)yt[G.FullPaths[nt]]=!0,G.FileIndex[nt].type!==0&&Tt.push([G.FullPaths[nt],G.FileIndex[nt]]);for(nt=0;nt<Tt.length;++nt){var Ct=r(Tt[nt][0]);for(tt=yt[Ct];!tt;){for(;r(Ct)&&!yt[r(Ct)];)Ct=r(Ct);Tt.push([Ct,{name:i(Ct).replace("/",""),type:1,clsid:Q,ct:kt,mt:kt,content:null}]),yt[Ct]=!0,Ct=r(Tt[nt][0]),tt=yt[Ct]}}for(Tt.sort(function(oe,Qt){return e(oe[0],Qt[0])}),G.FullPaths=[],G.FileIndex=[],nt=0;nt<Tt.length;++nt)G.FullPaths[nt]=Tt[nt][0],G.FileIndex[nt]=Tt[nt][1];for(nt=0;nt<Tt.length;++nt){var Vt=G.FileIndex[nt],te=G.FullPaths[nt];if(Vt.name=i(te).replace("/",""),Vt.L=Vt.R=Vt.C=-(Vt.color=1),Vt.size=Vt.content?Vt.content.length:0,Vt.start=0,Vt.clsid=Vt.clsid||Q,nt===0)Vt.C=Tt.length>1?1:-1,Vt.size=0,Vt.type=5;else if(te.slice(-1)=="/"){for(Ht=nt+1;Ht<Tt.length&&r(G.FullPaths[Ht])!=te;++Ht);for(Vt.C=Ht>=Tt.length?-1:Ht,Ht=nt+1;Ht<Tt.length&&r(G.FullPaths[Ht])!=r(te);++Ht);Vt.R=Ht>=Tt.length?-1:Ht,Vt.type=1}else r(G.FullPaths[nt+1]||"")==r(te)&&(Vt.R=nt+1),Vt.type=2}}}function F(G,rt){var Z=rt||{};if(Z.fileType=="mad")return Hr(G,Z);switch(M(G),Z.fileType){case"zip":return br(G,Z)}var tt=function(oe){for(var Qt=0,ee=0,Le=0;Le<oe.FileIndex.length;++Le){var rn=oe.FileIndex[Le];if(rn.content){var Ze=rn.content.length;Ze>0&&(Ze<4096?Qt+=Ze+63>>6:ee+=Ze+511>>9)}}for(var fn=oe.FullPaths.length+3>>2,Gi=Qt+7>>3,ps=Qt+127>>7,oi=Gi+ee+fn+ps,Di=oi+127>>7,la=Di<=109?0:Math.ceil((Di-109)/127);oi+Di+la+127>>7>Di;)la=++Di<=109?0:Math.ceil((Di-109)/127);var Oi=[1,la,Di,ps,fn,ee,Qt,0];return oe.FileIndex[0].size=Qt<<6,Oi[7]=(oe.FileIndex[0].start=Oi[0]+Oi[1]+Oi[2]+Oi[3]+Oi[4]+Oi[5])+(Oi[6]+7>>3),Oi}(G),nt=It(tt[7]<<9),at=0,kt=0;{for(at=0;at<8;++at)nt.write_shift(1,st[at]);for(at=0;at<8;++at)nt.write_shift(2,0);for(nt.write_shift(2,62),nt.write_shift(2,3),nt.write_shift(2,65534),nt.write_shift(2,9),nt.write_shift(2,6),at=0;at<3;++at)nt.write_shift(2,0);for(nt.write_shift(4,0),nt.write_shift(4,tt[2]),nt.write_shift(4,tt[0]+tt[1]+tt[2]+tt[3]-1),nt.write_shift(4,0),nt.write_shift(4,4096),nt.write_shift(4,tt[3]?tt[0]+tt[1]+tt[2]-1:et),nt.write_shift(4,tt[3]),nt.write_shift(-4,tt[1]?tt[0]-1:et),nt.write_shift(4,tt[1]),at=0;at<109;++at)nt.write_shift(-4,at<tt[2]?tt[1]+at:-1)}if(tt[1])for(kt=0;kt<tt[1];++kt){for(;at<236+kt*127;++at)nt.write_shift(-4,at<tt[2]?tt[1]+at:-1);nt.write_shift(-4,kt===tt[1]-1?et:kt+1)}var Ht=function(oe){for(kt+=oe;at<kt-1;++at)nt.write_shift(-4,at+1);oe&&(++at,nt.write_shift(-4,et))};for(kt=at=0,kt+=tt[1];at<kt;++at)nt.write_shift(-4,Y.DIFSECT);for(kt+=tt[2];at<kt;++at)nt.write_shift(-4,Y.FATSECT);Ht(tt[3]),Ht(tt[4]);for(var yt=0,Tt=0,Ct=G.FileIndex[0];yt<G.FileIndex.length;++yt)Ct=G.FileIndex[yt],Ct.content&&(Tt=Ct.content.length,!(Tt<4096)&&(Ct.start=kt,Ht(Tt+511>>9)));for(Ht(tt[6]+7>>3);nt.l&511;)nt.write_shift(-4,Y.ENDOFCHAIN);for(kt=at=0,yt=0;yt<G.FileIndex.length;++yt)Ct=G.FileIndex[yt],Ct.content&&(Tt=Ct.content.length,!(!Tt||Tt>=4096)&&(Ct.start=kt,Ht(Tt+63>>6)));for(;nt.l&511;)nt.write_shift(-4,Y.ENDOFCHAIN);for(at=0;at<tt[4]<<2;++at){var Vt=G.FullPaths[at];if(!Vt||Vt.length===0){for(yt=0;yt<17;++yt)nt.write_shift(4,0);for(yt=0;yt<3;++yt)nt.write_shift(4,-1);for(yt=0;yt<12;++yt)nt.write_shift(4,0);continue}Ct=G.FileIndex[at],at===0&&(Ct.start=Ct.size?Ct.start-1:et);var te=at===0&&Z.root||Ct.name;if(te.length>31&&(console.error("Name "+te+" will be truncated to "+te.slice(0,31)),te=te.slice(0,31)),Tt=2*(te.length+1),nt.write_shift(64,te,"utf16le"),nt.write_shift(2,Tt),nt.write_shift(1,Ct.type),nt.write_shift(1,Ct.color),nt.write_shift(-4,Ct.L),nt.write_shift(-4,Ct.R),nt.write_shift(-4,Ct.C),Ct.clsid)nt.write_shift(16,Ct.clsid,"hex");else for(yt=0;yt<4;++yt)nt.write_shift(4,0);nt.write_shift(4,Ct.state||0),nt.write_shift(4,0),nt.write_shift(4,0),nt.write_shift(4,0),nt.write_shift(4,0),nt.write_shift(4,Ct.start),nt.write_shift(4,Ct.size),nt.write_shift(4,0)}for(at=1;at<G.FileIndex.length;++at)if(Ct=G.FileIndex[at],Ct.size>=4096)if(nt.l=Ct.start+1<<9,cn&&Buffer.isBuffer(Ct.content))Ct.content.copy(nt,nt.l,0,Ct.size),nt.l+=Ct.size+511&-512;else{for(yt=0;yt<Ct.size;++yt)nt.write_shift(1,Ct.content[yt]);for(;yt&511;++yt)nt.write_shift(1,0)}for(at=1;at<G.FileIndex.length;++at)if(Ct=G.FileIndex[at],Ct.size>0&&Ct.size<4096)if(cn&&Buffer.isBuffer(Ct.content))Ct.content.copy(nt,nt.l,0,Ct.size),nt.l+=Ct.size+63&-64;else{for(yt=0;yt<Ct.size;++yt)nt.write_shift(1,Ct.content[yt]);for(;yt&63;++yt)nt.write_shift(1,0)}if(cn)nt.l=nt.length;else for(;nt.l<nt.length;)nt.write_shift(1,0);return nt}function H(G,rt){var Z=G.FullPaths.map(function(yt){return yt.toUpperCase()}),tt=Z.map(function(yt){var Tt=yt.split("/");return Tt[Tt.length-(yt.slice(-1)=="/"?2:1)]}),nt=!1;rt.charCodeAt(0)===47?(nt=!0,rt=Z[0].slice(0,-1)+rt):nt=rt.indexOf("/")!==-1;var at=rt.toUpperCase(),kt=nt===!0?Z.indexOf(at):tt.indexOf(at);if(kt!==-1)return G.FileIndex[kt];var Ht=!at.match(cg);for(at=at.replace(gd,""),Ht&&(at=at.replace(cg,"!")),kt=0;kt<Z.length;++kt)if((Ht?Z[kt].replace(cg,"!"):Z[kt]).replace(gd,"")==at||(Ht?tt[kt].replace(cg,"!"):tt[kt]).replace(gd,"")==at)return G.FileIndex[kt];return null}var P=64,et=-2,L="d0cf11e0a1b11ae1",st=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:et,FREESECT:-1,HEADER_SIGNATURE:L,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ot(G,rt,Z){h();var tt=F(G,Z);u.writeFileSync(rt,tt)}function Et(G){for(var rt=new Array(G.length),Z=0;Z<G.length;++Z)rt[Z]=String.fromCharCode(G[Z]);return rt.join("")}function z(G,rt){var Z=F(G,rt);switch(rt&&rt.type||"buffer"){case"file":return h(),u.writeFileSync(rt.filename,Z),Z;case"binary":return typeof Z=="string"?Z:Et(Z);case"base64":return Qg(typeof Z=="string"?Z:Et(Z));case"buffer":if(cn)return Buffer.isBuffer(Z)?Z:ja(Z);case"array":return typeof Z=="string"?is(Z):Z}return Z}var J;function V(G){try{var rt=G.InflateRaw,Z=new rt;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)J=G;else throw new Error("zlib does not expose bytesRead")}catch(tt){console.error("cannot use native zlib: "+(tt.message||tt))}}function ct(G,rt){if(!J)return Fo(G,rt);var Z=J.InflateRaw,tt=new Z,nt=tt._processChunk(G.slice(G.l),tt._finishFlushFlag);return G.l+=tt.bytesRead,nt}function gt(G){return J?J.deflateRawSync(G):Cn(G)}var _t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Bt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Gt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function j(G){var rt=(G<<1|G<<11)&139536|(G<<5|G<<15)&558144;return(rt>>16|rt>>8|rt)&255}for(var pt=typeof Uint8Array<"u",lt=pt?new Uint8Array(256):[],ut=0;ut<256;++ut)lt[ut]=j(ut);function Dt(G,rt){var Z=lt[G&255];return rt<=8?Z>>>8-rt:(Z=Z<<8|lt[G>>8&255],rt<=16?Z>>>16-rt:(Z=Z<<8|lt[G>>16&255],Z>>>24-rt))}function Lt(G,rt){var Z=rt&7,tt=rt>>>3;return(G[tt]|(Z<=6?0:G[tt+1]<<8))>>>Z&3}function D(G,rt){var Z=rt&7,tt=rt>>>3;return(G[tt]|(Z<=5?0:G[tt+1]<<8))>>>Z&7}function dt(G,rt){var Z=rt&7,tt=rt>>>3;return(G[tt]|(Z<=4?0:G[tt+1]<<8))>>>Z&15}function it(G,rt){var Z=rt&7,tt=rt>>>3;return(G[tt]|(Z<=3?0:G[tt+1]<<8))>>>Z&31}function q(G,rt){var Z=rt&7,tt=rt>>>3;return(G[tt]|(Z<=1?0:G[tt+1]<<8))>>>Z&127}function X(G,rt,Z){var tt=rt&7,nt=rt>>>3,at=(1<<Z)-1,kt=G[nt]>>>tt;return Z<8-tt||(kt|=G[nt+1]<<8-tt,Z<16-tt)||(kt|=G[nt+2]<<16-tt,Z<24-tt)||(kt|=G[nt+3]<<24-tt),kt&at}function ft(G,rt,Z){var tt=rt&7,nt=rt>>>3;return tt<=5?G[nt]|=(Z&7)<<tt:(G[nt]|=Z<<tt&255,G[nt+1]=(Z&7)>>8-tt),rt+3}function Pt(G,rt,Z){var tt=rt&7,nt=rt>>>3;return Z=(Z&1)<<tt,G[nt]|=Z,rt+1}function zt(G,rt,Z){var tt=rt&7,nt=rt>>>3;return Z<<=tt,G[nt]|=Z&255,Z>>>=8,G[nt+1]=Z,rt+8}function bt(G,rt,Z){var tt=rt&7,nt=rt>>>3;return Z<<=tt,G[nt]|=Z&255,Z>>>=8,G[nt+1]=Z&255,G[nt+2]=Z>>>8,rt+16}function Rt(G,rt){var Z=G.length,tt=2*Z>rt?2*Z:rt+5,nt=0;if(Z>=rt)return G;if(cn){var at=P2(tt);if(G.copy)G.copy(at);else for(;nt<G.length;++nt)at[nt]=G[nt];return at}else if(pt){var kt=new Uint8Array(tt);if(kt.set)kt.set(G);else for(;nt<Z;++nt)kt[nt]=G[nt];return kt}return G.length=tt,G}function qt(G){for(var rt=new Array(G),Z=0;Z<G;++Z)rt[Z]=0;return rt}function xt(G,rt,Z){var tt=1,nt=0,at=0,kt=0,Ht=0,yt=G.length,Tt=pt?new Uint16Array(32):qt(32);for(at=0;at<32;++at)Tt[at]=0;for(at=yt;at<Z;++at)G[at]=0;yt=G.length;var Ct=pt?new Uint16Array(yt):qt(yt);for(at=0;at<yt;++at)Tt[nt=G[at]]++,tt<nt&&(tt=nt),Ct[at]=0;for(Tt[0]=0,at=1;at<=tt;++at)Tt[at+16]=Ht=Ht+Tt[at-1]<<1;for(at=0;at<yt;++at)Ht=G[at],Ht!=0&&(Ct[at]=Tt[Ht+16]++);var Vt=0;for(at=0;at<yt;++at)if(Vt=G[at],Vt!=0)for(Ht=Dt(Ct[at],tt)>>tt-Vt,kt=(1<<tt+4-Vt)-1;kt>=0;--kt)rt[Ht|kt<<Vt]=Vt&15|at<<4;return tt}var se=pt?new Uint16Array(512):qt(512),de=pt?new Uint16Array(32):qt(32);if(!pt){for(var ae=0;ae<512;++ae)se[ae]=0;for(ae=0;ae<32;++ae)de[ae]=0}(function(){for(var G=[],rt=0;rt<32;rt++)G.push(5);xt(G,de,32);var Z=[];for(rt=0;rt<=143;rt++)Z.push(8);for(;rt<=255;rt++)Z.push(9);for(;rt<=279;rt++)Z.push(7);for(;rt<=287;rt++)Z.push(8);xt(Z,se,288)})();var ze=function(){for(var rt=pt?new Uint8Array(32768):[],Z=0,tt=0;Z<Gt.length-1;++Z)for(;tt<Gt[Z+1];++tt)rt[tt]=Z;for(;tt<32768;++tt)rt[tt]=29;var nt=pt?new Uint8Array(259):[];for(Z=0,tt=0;Z<Bt.length-1;++Z)for(;tt<Bt[Z+1];++tt)nt[tt]=Z;function at(Ht,yt){for(var Tt=0;Tt<Ht.length;){var Ct=Math.min(65535,Ht.length-Tt),Vt=Tt+Ct==Ht.length;for(yt.write_shift(1,+Vt),yt.write_shift(2,Ct),yt.write_shift(2,~Ct&65535);Ct-- >0;)yt[yt.l++]=Ht[Tt++]}return yt.l}function kt(Ht,yt){for(var Tt=0,Ct=0,Vt=pt?new Uint16Array(32768):[];Ct<Ht.length;){var te=Math.min(65535,Ht.length-Ct);if(te<10){for(Tt=ft(yt,Tt,+(Ct+te==Ht.length)),Tt&7&&(Tt+=8-(Tt&7)),yt.l=Tt/8|0,yt.write_shift(2,te),yt.write_shift(2,~te&65535);te-- >0;)yt[yt.l++]=Ht[Ct++];Tt=yt.l*8;continue}Tt=ft(yt,Tt,+(Ct+te==Ht.length)+2);for(var oe=0;te-- >0;){var Qt=Ht[Ct];oe=(oe<<5^Qt)&32767;var ee=-1,Le=0;if((ee=Vt[oe])&&(ee|=Ct&-32768,ee>Ct&&(ee-=32768),ee<Ct))for(;Ht[ee+Le]==Ht[Ct+Le]&&Le<250;)++Le;if(Le>2){Qt=nt[Le],Qt<=22?Tt=zt(yt,Tt,lt[Qt+1]>>1)-1:(zt(yt,Tt,3),Tt+=5,zt(yt,Tt,lt[Qt-23]>>5),Tt+=3);var rn=Qt<8?0:Qt-4>>2;rn>0&&(bt(yt,Tt,Le-Bt[Qt]),Tt+=rn),Qt=rt[Ct-ee],Tt=zt(yt,Tt,lt[Qt]>>3),Tt-=3;var Ze=Qt<4?0:Qt-2>>1;Ze>0&&(bt(yt,Tt,Ct-ee-Gt[Qt]),Tt+=Ze);for(var fn=0;fn<Le;++fn)Vt[oe]=Ct&32767,oe=(oe<<5^Ht[Ct])&32767,++Ct;te-=Le-1}else Qt<=143?Qt=Qt+48:Tt=Pt(yt,Tt,1),Tt=zt(yt,Tt,lt[Qt]),Vt[oe]=Ct&32767,++Ct}Tt=zt(yt,Tt,0)-1}return yt.l=(Tt+7)/8|0,yt.l}return function(yt,Tt){return yt.length<8?at(yt,Tt):kt(yt,Tt)}}();function Cn(G){var rt=It(50+Math.floor(G.length*1.1)),Z=ze(G,rt);return rt.slice(0,Z)}var Se=pt?new Uint16Array(32768):qt(32768),_n=pt?new Uint16Array(32768):qt(32768),qe=pt?new Uint16Array(128):qt(128),yr=1,Bn=1;function kn(G,rt){var Z=it(G,rt)+257;rt+=5;var tt=it(G,rt)+1;rt+=5;var nt=dt(G,rt)+4;rt+=4;for(var at=0,kt=pt?new Uint8Array(19):qt(19),Ht=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],yt=1,Tt=pt?new Uint8Array(8):qt(8),Ct=pt?new Uint8Array(8):qt(8),Vt=kt.length,te=0;te<nt;++te)kt[_t[te]]=at=D(G,rt),yt<at&&(yt=at),Tt[at]++,rt+=3;var oe=0;for(Tt[0]=0,te=1;te<=yt;++te)Ct[te]=oe=oe+Tt[te-1]<<1;for(te=0;te<Vt;++te)(oe=kt[te])!=0&&(Ht[te]=Ct[oe]++);var Qt=0;for(te=0;te<Vt;++te)if(Qt=kt[te],Qt!=0){oe=lt[Ht[te]]>>8-Qt;for(var ee=(1<<7-Qt)-1;ee>=0;--ee)qe[oe|ee<<Qt]=Qt&7|te<<3}var Le=[];for(yt=1;Le.length<Z+tt;)switch(oe=qe[q(G,rt)],rt+=oe&7,oe>>>=3){case 16:for(at=3+Lt(G,rt),rt+=2,oe=Le[Le.length-1];at-- >0;)Le.push(oe);break;case 17:for(at=3+D(G,rt),rt+=3;at-- >0;)Le.push(0);break;case 18:for(at=11+q(G,rt),rt+=7;at-- >0;)Le.push(0);break;default:Le.push(oe),yt<oe&&(yt=oe);break}var rn=Le.slice(0,Z),Ze=Le.slice(Z);for(te=Z;te<286;++te)rn[te]=0;for(te=tt;te<30;++te)Ze[te]=0;return yr=xt(rn,Se,286),Bn=xt(Ze,_n,30),rt}function ai(G,rt){if(G[0]==3&&!(G[1]&3))return[Rc(rt),2];for(var Z=0,tt=0,nt=P2(rt||1<<18),at=0,kt=nt.length>>>0,Ht=0,yt=0;(tt&1)==0;){if(tt=D(G,Z),Z+=3,tt>>>1)tt>>1==1?(Ht=9,yt=5):(Z=kn(G,Z),Ht=yr,yt=Bn);else{Z&7&&(Z+=8-(Z&7));var Tt=G[Z>>>3]|G[(Z>>>3)+1]<<8;if(Z+=32,Tt>0)for(!rt&&kt<at+Tt&&(nt=Rt(nt,at+Tt),kt=nt.length);Tt-- >0;)nt[at++]=G[Z>>>3],Z+=8;continue}for(;;){!rt&&kt<at+32767&&(nt=Rt(nt,at+32767),kt=nt.length);var Ct=X(G,Z,Ht),Vt=tt>>>1==1?se[Ct]:Se[Ct];if(Z+=Vt&15,Vt>>>=4,(Vt>>>8&255)===0)nt[at++]=Vt;else{if(Vt==256)break;Vt-=257;var te=Vt<8?0:Vt-4>>2;te>5&&(te=0);var oe=at+Bt[Vt];te>0&&(oe+=X(G,Z,te),Z+=te),Ct=X(G,Z,yt),Vt=tt>>>1==1?de[Ct]:_n[Ct],Z+=Vt&15,Vt>>>=4;var Qt=Vt<4?0:Vt-2>>1,ee=Gt[Vt];for(Qt>0&&(ee+=X(G,Z,Qt),Z+=Qt),!rt&&kt<oe&&(nt=Rt(nt,oe+100),kt=nt.length);at<oe;)nt[at]=nt[at-ee],++at}}}return rt?[nt,Z+7>>>3]:[nt.slice(0,at),Z+7>>>3]}function Fo(G,rt){var Z=G.slice(G.l||0),tt=ai(Z,rt);return G.l+=tt[1],tt[0]}function $a(G,rt){if(G)typeof console<"u"&&console.error(rt);else throw new Error(rt)}function Ga(G,rt){var Z=G;xi(Z,0);var tt=[],nt=[],at={FileIndex:tt,FullPaths:nt};C(at,{root:rt.root});for(var kt=Z.length-4;(Z[kt]!=80||Z[kt+1]!=75||Z[kt+2]!=5||Z[kt+3]!=6)&&kt>=0;)--kt;Z.l=kt+4,Z.l+=4;var Ht=Z.read_shift(2);Z.l+=6;var yt=Z.read_shift(4);for(Z.l=yt,kt=0;kt<Ht;++kt){Z.l+=20;var Tt=Z.read_shift(4),Ct=Z.read_shift(4),Vt=Z.read_shift(2),te=Z.read_shift(2),oe=Z.read_shift(2);Z.l+=8;var Qt=Z.read_shift(4),ee=l(Z.slice(Z.l+Vt,Z.l+Vt+te));Z.l+=Vt+te+oe;var Le=Z.l;Z.l=Qt+4,ee&&ee[1]&&((ee[1]||{}).usz&&(Ct=ee[1].usz),(ee[1]||{}).csz&&(Tt=ee[1].csz)),zs(Z,Tt,Ct,at,ee),Z.l=Le}return at}function zs(G,rt,Z,tt,nt){G.l+=2;var at=G.read_shift(2),kt=G.read_shift(2),Ht=o(G);if(at&8257)throw new Error("Unsupported ZIP encryption");for(var yt=G.read_shift(4),Tt=G.read_shift(4),Ct=G.read_shift(4),Vt=G.read_shift(2),te=G.read_shift(2),oe="",Qt=0;Qt<Vt;++Qt)oe+=String.fromCharCode(G[G.l++]);if(te){var ee=l(G.slice(G.l,G.l+te));(ee[21589]||{}).mt&&(Ht=ee[21589].mt),(ee[1]||{}).usz&&(Ct=ee[1].usz),(ee[1]||{}).csz&&(Tt=ee[1].csz),nt&&((nt[21589]||{}).mt&&(Ht=nt[21589].mt),(nt[1]||{}).usz&&(Ct=nt[1].usz),(nt[1]||{}).csz&&(Tt=nt[1].csz))}G.l+=te;var Le=G.slice(G.l,G.l+Tt);switch(kt){case 8:Le=ct(G,Ct);break;case 0:G.l+=Tt;break;default:throw new Error("Unsupported ZIP Compression method "+kt)}var rn=!1;at&8&&(yt=G.read_shift(4),yt==134695760&&(yt=G.read_shift(4),rn=!0),Tt=G.read_shift(4),Ct=G.read_shift(4)),Tt!=rt&&$a(rn,"Bad compressed size: "+rt+" != "+Tt),Ct!=Z&&$a(rn,"Bad uncompressed size: "+Z+" != "+Ct),er(tt,oe,Le,{unsafe:!0,mt:Ht})}function br(G,rt){var Z=rt||{},tt=[],nt=[],at=It(1),kt=Z.compression?8:0,Ht=0,yt=0,Tt=0,Ct=0,Vt=0,te=G.FullPaths[0],oe=te,Qt=G.FileIndex[0],ee=[],Le=0;for(yt=1;yt<G.FullPaths.length;++yt)if(oe=G.FullPaths[yt].slice(te.length),Qt=G.FileIndex[yt],!(!Qt.size||!Qt.content||Array.isArray(Qt.content)&&Qt.content.length==0||oe=="Sh33tJ5")){var rn=Ct,Ze=It(oe.length);for(Tt=0;Tt<oe.length;++Tt)Ze.write_shift(1,oe.charCodeAt(Tt)&127);Ze=Ze.slice(0,Ze.l),ee[Vt]=typeof Qt.content=="string"?G2.bstr(Qt.content,0):G2.buf(Qt.content,0);var fn=typeof Qt.content=="string"?is(Qt.content):Qt.content;kt==8&&(fn=gt(fn)),at=It(30),at.write_shift(4,67324752),at.write_shift(2,20),at.write_shift(2,Ht),at.write_shift(2,kt),Qt.mt?s(at,Qt.mt):at.write_shift(4,0),at.write_shift(-4,ee[Vt]),at.write_shift(4,fn.length),at.write_shift(4,Qt.content.length),at.write_shift(2,Ze.length),at.write_shift(2,0),Ct+=at.length,tt.push(at),Ct+=Ze.length,tt.push(Ze),Ct+=fn.length,tt.push(fn),at=It(46),at.write_shift(4,33639248),at.write_shift(2,0),at.write_shift(2,20),at.write_shift(2,Ht),at.write_shift(2,kt),at.write_shift(4,0),at.write_shift(-4,ee[Vt]),at.write_shift(4,fn.length),at.write_shift(4,Qt.content.length),at.write_shift(2,Ze.length),at.write_shift(2,0),at.write_shift(2,0),at.write_shift(2,0),at.write_shift(2,0),at.write_shift(4,0),at.write_shift(4,rn),Le+=at.l,nt.push(at),Le+=Ze.length,nt.push(Ze),++Vt}return at=It(22),at.write_shift(4,101010256),at.write_shift(2,0),at.write_shift(2,0),at.write_shift(2,Vt),at.write_shift(2,Vt),at.write_shift(4,Le),at.write_shift(4,Ct),at.write_shift(2,0),lr([lr(tt),lr(nt),at])}var Ci={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Pl(G,rt){if(G.ctype)return G.ctype;var Z=G.name||"",tt=Z.match(/\.([^\.]+)$/);return tt&&Ci[tt[1]]||rt&&(tt=(Z=rt).match(/[\.\\]([^\.\\])+$/),tt&&Ci[tt[1]])?Ci[tt[1]]:"application/octet-stream"}function Gc(G){for(var rt=Qg(G),Z=[],tt=0;tt<rt.length;tt+=76)Z.push(rt.slice(tt,tt+76));return Z.join(`\r
`)+`\r
`}function Fl(G){var rt=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Tt){var Ct=Tt.charCodeAt(0).toString(16).toUpperCase();return"="+(Ct.length==1?"0"+Ct:Ct)});rt=rt.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),rt.charAt(0)==`
`&&(rt="=0D"+rt.slice(1)),rt=rt.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],tt=rt.split(`\r
`),nt=0;nt<tt.length;++nt){var at=tt[nt];if(at.length==0){Z.push("");continue}for(var kt=0;kt<at.length;){var Ht=76,yt=at.slice(kt,kt+Ht);yt.charAt(Ht-1)=="="?Ht--:yt.charAt(Ht-2)=="="?Ht-=2:yt.charAt(Ht-3)=="="&&(Ht-=3),yt=at.slice(kt,kt+Ht),kt+=Ht,kt<at.length&&(yt+="="),Z.push(yt)}}return Z.join(`\r
`)}function Bl(G){for(var rt=[],Z=0;Z<G.length;++Z){for(var tt=G[Z];Z<=G.length&&tt.charAt(tt.length-1)=="=";)tt=tt.slice(0,tt.length-1)+G[++Z];rt.push(tt)}for(var nt=0;nt<rt.length;++nt)rt[nt]=rt[nt].replace(/[=][0-9A-Fa-f]{2}/g,function(at){return String.fromCharCode(parseInt(at.slice(1),16))});return is(rt.join(`\r
`))}function Vc(G,rt,Z){for(var tt="",nt="",at="",kt,Ht=0;Ht<10;++Ht){var yt=rt[Ht];if(!yt||yt.match(/^\s*$/))break;var Tt=yt.match(/^([^:]*?):\s*([^\s].*)$/);if(Tt)switch(Tt[1].toLowerCase()){case"content-location":tt=Tt[2].trim();break;case"content-type":at=Tt[2].trim();break;case"content-transfer-encoding":nt=Tt[2].trim();break}}switch(++Ht,nt.toLowerCase()){case"base64":kt=is(Ol(rt.slice(Ht).join("")));break;case"quoted-printable":kt=Bl(rt.slice(Ht));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+nt)}var Ct=er(G,tt.slice(Z.length),kt,{unsafe:!0});at&&(Ct.ctype=at)}function aa(G,rt){if(Et(G.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=rt&&rt.root||"",tt=(cn&&Buffer.isBuffer(G)?G.toString("binary"):Et(G)).split(`\r
`),nt=0,at="";for(nt=0;nt<tt.length;++nt)if(at=tt[nt],!!/^Content-Location:/i.test(at)&&(at=at.slice(at.indexOf("file")),Z||(Z=at.slice(0,at.lastIndexOf("/")+1)),at.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),at.slice(0,Z.length)!=Z););var kt=(tt[1]||"").match(/boundary="(.*?)"/);if(!kt)throw new Error("MAD cannot find boundary");var Ht="--"+(kt[1]||""),yt=[],Tt=[],Ct={FileIndex:yt,FullPaths:Tt};C(Ct);var Vt,te=0;for(nt=0;nt<tt.length;++nt){var oe=tt[nt];oe!==Ht&&oe!==Ht+"--"||(te++&&Vc(Ct,tt.slice(Vt,nt),Z),Vt=nt)}return Ct}function Hr(G,rt){var Z=rt||{},tt=Z.boundary||"SheetJS";tt="------="+tt;for(var nt=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+tt.slice(2)+'"',"","",""],at=G.FullPaths[0],kt=at,Ht=G.FileIndex[0],yt=1;yt<G.FullPaths.length;++yt)if(kt=G.FullPaths[yt].slice(at.length),Ht=G.FileIndex[yt],!(!Ht.size||!Ht.content||kt=="Sh33tJ5")){kt=kt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var Tt=Ht.content,Ct=cn&&Buffer.isBuffer(Tt)?Tt.toString("binary"):Et(Tt),Vt=0,te=Math.min(1024,Ct.length),oe=0,Qt=0;Qt<=te;++Qt)(oe=Ct.charCodeAt(Qt))>=32&&oe<128&&++Vt;var ee=Vt>=te*4/5;nt.push(tt),nt.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+kt),nt.push("Content-Transfer-Encoding: "+(ee?"quoted-printable":"base64")),nt.push("Content-Type: "+Pl(Ht,kt)),nt.push(""),nt.push(ee?Fl(Ct):Gc(Ct))}return nt.push(tt+`--\r
`),nt.join(`\r
`)}function tr(G){var rt={};return C(rt,G),rt}function er(G,rt,Z,tt){var nt=tt&&tt.unsafe;nt||C(G);var at=!nt&&Tn.find(G,rt);if(!at){var kt=G.FullPaths[0];rt.slice(0,kt.length)==kt?kt=rt:(kt.slice(-1)!="/"&&(kt+="/"),kt=(kt+rt).replace("//","/")),at={name:i(rt),type:2},G.FileIndex.push(at),G.FullPaths.push(kt),nt||Tn.utils.cfb_gc(G)}return at.content=Z,at.size=Z?Z.length:0,tt&&(tt.CLSID&&(at.clsid=tt.CLSID),tt.mt&&(at.mt=tt.mt),tt.ct&&(at.ct=tt.ct)),at}function oa(G,rt){C(G);var Z=Tn.find(G,rt);if(Z){for(var tt=0;tt<G.FileIndex.length;++tt)if(G.FileIndex[tt]==Z)return G.FileIndex.splice(tt,1),G.FullPaths.splice(tt,1),!0}return!1}function Ul(G,rt,Z){C(G);var tt=Tn.find(G,rt);if(tt){for(var nt=0;nt<G.FileIndex.length;++nt)if(G.FileIndex[nt]==tt)return G.FileIndex[nt].name=i(Z),G.FullPaths[nt]=Z,!0}return!1}function Tf(G){M(G,!0)}return t.find=H,t.read=N,t.parse=d,t.write=z,t.writeFile=Ot,t.utils={cfb_new:tr,cfb_add:er,cfb_del:oa,cfb_mov:Ul,cfb_gc:Tf,ReadShift:md,CheckField:pO,prep_blob:xi,bconcat:lr,use_zlib:V,_deflateRaw:Cn,_inflateRaw:Fo,consts:Y},t}(),y9;function V2(n){return typeof n=="string"?Gm(n):Array.isArray(n)?V7(n):n}function o0(n,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=Gm(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(n,t)}var r=e=="utf8"?Pd(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([V2(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=n,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+G7(new Uint8Array(V2(r)));return chrome.downloads.download({url:l,filename:n,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(n);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Nc(t)),u.write(t),u.close(),t}catch(h){if(!h.message||h.message.indexOf("onstruct")==-1)throw h}throw new Error("cannot save file "+n)}function cr(n){for(var t=Object.keys(n),e=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(n,t[r])&&e.push(t[r]);return e}function W2(n,t){for(var e=[],r=cr(n),i=0;i!==r.length;++i)e[n[r[i]][t]]==null&&(e[n[r[i]][t]]=r[i]);return e}function Ob(n){for(var t=[],e=cr(n),r=0;r!==e.length;++r)t[n[e[r]]]=e[r];return t}function Xm(n){for(var t=[],e=cr(n),r=0;r!==e.length;++r)t[n[e[r]]]=parseInt(e[r],10);return t}function b9(n){for(var t=[],e=cr(n),r=0;r!==e.length;++r)t[n[e[r]]]==null&&(t[n[e[r]]]=[]),t[n[e[r]]].push(e[r]);return t}var QD=Date.UTC(1899,11,30,0,0,0),x9=Date.UTC(1899,11,31,0,0,0),E9=Date.UTC(1904,0,1,0,0,0);function zr(n,t){var e=n.getTime(),r=(e-QD)/(24*60*60*1e3);return t?(r-=1462,r<-1402?r-1:r):r<60?r-1:r}function Xu(n){if(n>=60&&n<61)return n;var t=new Date;return t.setTime((n>60?n:n+1)*24*60*60*1e3+QD),t}var w9=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,A9=/^(\d+)-(\d+)-(\d+)$/,JD=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function $i(n,t){if(n instanceof Date)return n;var e=n.match(w9);if(e)return new Date((t?E9:x9)+((parseInt(e[1],10)*60+parseInt(e[2],10))*60+(e[3]?parseInt(e[3].slice(1),10):0))*1e3+(e[4]?parseInt((e[4]+"000").slice(1,4),10):0));if(e=n.match(A9),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],0,0,0,0));if(e=n.match(JD),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5],e[6]&&parseInt(e[6].slice(1),10)||0,e[7]&&parseInt((e[7]+"0000").slice(1,4),10)||0));var r=new Date(n);return r}function Rb(n,t){if(cn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return e[s]||s})}catch{}var r=[],i=0;try{for(i=0;i<n.length-65536;i+=65536)r.push(String.fromCharCode.apply(0,n.slice(i,i+65536)));r.push(String.fromCharCode.apply(0,n.slice(i)))}catch{try{for(;i<n.length-16384;i+=16384)r.push(String.fromCharCode.apply(0,n.slice(i,i+16384)));r.push(String.fromCharCode.apply(0,n.slice(i)))}catch{for(;i!=n.length;++i)r.push(String.fromCharCode(n[i]))}}return r.join("")}function ii(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var t={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=ii(n[e]));return t}function Pn(n,t){for(var e="";e.length<t;)e+=n;return e}function Oo(n){var t=Number(n);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(n))return t;var e=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(]([^()]*)[)]/,function(i,s){return e=-e,s}),!isNaN(t=Number(r)))?t/e:t}var S9=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,T9=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,C9=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,D9=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function O9(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,n[7]=="p"?12:0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),0,0,0))}function R9(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1],+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1],0,0,0))}var N9=["january","february","march","april","may","june","july","august","september","october","november","december"];function im(n){if(C9.test(n))return n.indexOf("Z")==-1?Ym(new Date(n)):new Date(n);var t=n.toLowerCase(),e=t.replace(/\s+/g," ").trim(),r=e.match(S9);if(r)return O9(r);if(r=e.match(T9),r)return R9(r);if(r=e.match(JD),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var i=new Date(D9&&n.indexOf("UTC")==-1?n+" UTC":n),s=new Date(NaN),o=i.getYear();i.getMonth();var l=i.getDate();if(isNaN(l))return s;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&N9.indexOf(t)==-1)return s}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return s;return o<0||o>8099||n.match(/[^-0-9:,\/\\\ ]/)?s:i}function hf(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds())}function Ym(n){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()))}function je(n,t,e){if(n.FullPaths){if(Array.isArray(e)&&typeof e[0]=="string"&&(e=e.join("")),typeof e=="string"){var r;return cn?r=ja(e):r=W7(e),Tn.utils.cfb_add(n,t,r)}Tn.utils.cfb_add(n,t,e)}else n.file(t,e)}function Nb(){return Tn.utils.cfb_new()}var fr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,k9={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kb=Ob(k9),Lb=/[&<>'"]/g,L9=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function $e(n){var t=n+"";return t.replace(Lb,function(e){return kb[e]}).replace(L9,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function X2(n){return $e(n).replace(/ /g,"_x0020_")}var tO=/[\u0000-\u001f]/g;function x_(n){var t=n+"";return t.replace(Lb,function(e){return kb[e]}).replace(/\n/g,"<br/>").replace(tO,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function M9(n){var t=n+"";return t.replace(Lb,function(e){return kb[e]}).replace(tO,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function I9(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function P9(n){switch(n){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function E_(n){for(var t="",e=0,r=0,i=0,s=0,o=0,l=0;e<n.length;){if(r=n.charCodeAt(e++),r<128){t+=String.fromCharCode(r);continue}if(i=n.charCodeAt(e++),r>191&&r<224){o=(r&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=n.charCodeAt(e++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=n.charCodeAt(e++),l=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Y2(n){var t=Rc(2*n.length),e,r,i=1,s=0,o=0,l;for(r=0;r<n.length;r+=i)i=1,(l=n.charCodeAt(r))<128?e=l:l<224?(e=(l&31)*64+(n.charCodeAt(r+1)&63),i=2):l<240?(e=(l&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,e=(l&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),e-=65536,o=55296+(e>>>10&1023),e=56320+(e&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=e%256,t[s++]=e>>>8;return t.slice(0,s).toString("ucs2")}function q2(n){return ja(n,"binary").toString("utf8")}var ug="foo bar baz",Yu=cn&&(q2(ug)==E_(ug)&&q2||Y2(ug)==E_(ug)&&Y2)||E_,Pd=cn?function(n){return ja(n,"utf8").toString("binary")}:function(n){for(var t=[],e=0,r=0,i=0;e<n.length;)switch(r=n.charCodeAt(e++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(e++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},F9=function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var r=e.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}}(),eO=/(^\s|\s$|\n)/;function Fr(n,t){return"<"+n+(t.match(eO)?' xml:space="preserve"':"")+">"+t+"</"+n+">"}function Fd(n){return cr(n).map(function(t){return" "+t+'="'+n[t]+'"'}).join("")}function re(n,t,e){return"<"+n+(e!=null?Fd(e):"")+(t!=null?(t.match(eO)?' xml:space="preserve"':"")+">"+t+"</"+n:"/")+">"}function ly(n,t){try{return n.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function B9(n,t){switch(typeof n){case"string":var e=re("vt:lpwstr",$e(n));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return re((n|0)==n?"vt:i4":"vt:r8",$e(String(n)));case"boolean":return re("vt:bool",n?"true":"false")}if(n instanceof Date)return re("vt:filetime",ly(n));throw new Error("Unable to serialize "+n)}var Sr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ss={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function U9(n,t){for(var e=1-2*(n[t+7]>>>7),r=((n[t+7]&127)<<4)+(n[t+6]>>>4&15),i=n[t+6]&15,s=5;s>=0;--s)i=i*256+n[t+s];return r==2047?i==0?e*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),e*Math.pow(2,r-52)*i)}function z9(n,t,e){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=r?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)n[e+l]=s&255;n[e+6]=(i&15)<<4|s&15,n[e+7]=i>>4|r}var K2=function(n){for(var t=[],e=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=e)t.push.apply(t,n[0][r].slice(i,i+e));return t},Z2=cn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(t){return Buffer.isBuffer(t)?t:ja(t)})):K2(n)}:K2,Q2=function(n,t,e){for(var r=[],i=t;i<e;i+=2)r.push(String.fromCharCode(od(n,i)));return r.join("").replace(gd,"")},Mb=cn?function(n,t,e){return!Buffer.isBuffer(n)||!Jg?Q2(n,t,e):n.toString("utf16le",t,e).replace(gd,"")}:Q2,J2=function(n,t,e){for(var r=[],i=t;i<t+e;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},nO=cn?function(n,t,e){return Buffer.isBuffer(n)?n.toString("hex",t,t+e):J2(n,t,e)}:J2,tS=function(n,t,e){for(var r=[],i=t;i<e;i++)r.push(String.fromCharCode(Uu(n,i)));return r.join("")},l0=cn?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf8",e,r):tS(t,e,r)}:tS,rO=function(n,t){var e=as(n,t);return e>0?l0(n,t+4,t+4+e-1):""},iO=rO,sO=function(n,t){var e=as(n,t);return e>0?l0(n,t+4,t+4+e-1):""},aO=sO,oO=function(n,t){var e=2*as(n,t);return e>0?l0(n,t+4,t+4+e-1):""},lO=oO,cO=function(t,e){var r=as(t,e);return r>0?Mb(t,e+4,e+4+r):""},uO=cO,fO=function(n,t){var e=as(n,t);return e>0?l0(n,t+4,t+4+e):""},hO=fO,dO=function(n,t){return U9(n,t)},sm=dO,Ib=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};cn&&(iO=function(t,e){if(!Buffer.isBuffer(t))return rO(t,e);var r=t.readUInt32LE(e);return r>0?t.toString("utf8",e+4,e+4+r-1):""},aO=function(t,e){if(!Buffer.isBuffer(t))return sO(t,e);var r=t.readUInt32LE(e);return r>0?t.toString("utf8",e+4,e+4+r-1):""},lO=function(t,e){if(!Buffer.isBuffer(t)||!Jg)return oO(t,e);var r=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+r-1)},uO=function(t,e){if(!Buffer.isBuffer(t)||!Jg)return cO(t,e);var r=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+r)},hO=function(t,e){if(!Buffer.isBuffer(t))return fO(t,e);var r=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+r)},sm=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):dO(t,e)},Ib=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Uu=function(n,t){return n[t]},od=function(n,t){return n[t+1]*256+n[t]},H9=function(n,t){var e=n[t+1]*256+n[t];return e<32768?e:(65535-e+1)*-1},as=function(n,t){return n[t+3]*(1<<24)+(n[t+2]<<16)+(n[t+1]<<8)+n[t]},dc=function(n,t){return n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]},j9=function(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]};function md(n,t){var e="",r,i,s=[],o,l,u,h;switch(t){case"dbcs":if(h=this.l,cn&&Buffer.isBuffer(this)&&Jg)e=this.slice(this.l,this.l+2*n).toString("utf16le");else for(u=0;u<n;++u)e+=String.fromCharCode(od(this,h)),h+=2;n*=2;break;case"utf8":e=l0(this,this.l,this.l+n);break;case"utf16le":n*=2,e=Mb(this,this.l,this.l+n);break;case"wstr":return md.call(this,n,"dbcs");case"lpstr-ansi":e=iO(this,this.l),n=4+as(this,this.l);break;case"lpstr-cp":e=aO(this,this.l),n=4+as(this,this.l);break;case"lpwstr":e=lO(this,this.l),n=4+2*as(this,this.l);break;case"lpp4":n=4+as(this,this.l),e=uO(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+as(this,this.l),e=hO(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,e="";(o=Uu(this,this.l+n++))!==0;)s.push(lg(o));e=s.join("");break;case"_wstr":for(n=0,e="";(o=od(this,this.l+n))!==0;)s.push(lg(o)),n+=2;n+=2,e=s.join("");break;case"dbcs-cont":for(e="",h=this.l,u=0;u<n;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Uu(this,h),this.l=h+1,l=md.call(this,n-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(lg(od(this,h))),h+=2}e=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(e="",h=this.l,u=0;u!=n;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Uu(this,h),this.l=h+1,l=md.call(this,n-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(lg(Uu(this,h))),h+=1}e=s.join("");break;default:switch(n){case 1:return r=Uu(this,this.l),this.l++,r;case 2:return r=(t==="i"?H9:od)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(n>0?dc:j9)(this,this.l),this.l+=4,r):(i=as(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return n==8?i=sm(this,this.l):i=sm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:e=nO(this,this.l,n);break}}return this.l+=n,e}var $9=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},G9=function(n,t,e){n[e]=t&255,n[e+1]=t>>8&255,n[e+2]=t>>16&255,n[e+3]=t>>24&255},V9=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255};function W9(n,t,e){var r=0,i=0;if(e==="dbcs"){for(i=0;i!=t.length;++i)V9(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(e==="sbcs"||e=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(e==="hex"){for(;i<n;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(t.length,n);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,$9(this,t,this.l);break;case 8:if(r=8,e==="f"){z9(this,t,this.l);break}case 16:break;case-4:r=4,G9(this,t,this.l);break}return this.l+=r,this}function pO(n,t){var e=nO(this,this.l,n.length>>1);if(e!==n)throw new Error(t+"Expected "+n+" saw "+e);this.l+=n.length>>1}function xi(n,t){n.l=t,n.read_shift=md,n.chk=pO,n.write_shift=W9}function Ha(n,t){n.l+=t}function It(n){var t=Rc(n);return xi(t,0),t}function ni(){var n=[],t=cn?16384:2048;cn&&It(t).copy;var e=function(d){var p=It(d);return xi(p,0),p},r=e(t),i=function(){r&&(r.l&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r)),r=null)},s=function(d){return r&&d<r.length-r.l?r:(i(),r=e(Math.max(d+1,t)))},o=function(){return i(),lr(n)},l=function(){return i(),n},u=function(d){i(),r=d,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:u,end:o,_bufs:n,end2:l}}function Yt(n,t,e,r){var i=+t,s;if(!isNaN(i)){r||(r=JV[i].p||(e||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=n.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&Ib(e)&&n.push(e)}}function vd(n,t,e){var r=ii(n);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!e||e.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function eS(n,t,e){var r=ii(n);return r.s=vd(r.s,t.s,e),r.e=vd(r.e,t.s,e),r}function _d(n,t){if(n.cRel&&n.c<0)for(n=ii(n);n.c<0;)n.c+=t>8?16384:256;if(n.rRel&&n.r<0)for(n=ii(n);n.r<0;)n.r+=t>8?1048576:t>5?65536:16384;var e=jn(n);return!n.cRel&&n.cRel!=null&&(e=q9(e)),!n.rRel&&n.rRel!=null&&(e=X9(e)),e}function w_(n,t){return n.s.r==0&&!n.s.rRel&&n.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+vn(n.s.c)+":"+(n.e.cRel?"":"$")+vn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(t.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+wn(n.s.r)+":"+(n.e.rRel?"":"$")+wn(n.e.r):_d(n.s,t.biff)+":"+_d(n.e,t.biff)}function Pb(n){return parseInt(Y9(n),10)-1}function wn(n){return""+(n+1)}function X9(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Y9(n){return n.replace(/\$(\d+)$/,"$1")}function Fb(n){for(var t=K9(n),e=0,r=0;r!==t.length;++r)e=26*e+t.charCodeAt(r)-64;return e-1}function vn(n){if(n<0)throw new Error("invalid column "+n);var t="";for(++n;n;n=Math.floor((n-1)/26))t=String.fromCharCode((n-1)%26+65)+t;return t}function q9(n){return n.replace(/^([A-Z])/,"$$$1")}function K9(n){return n.replace(/^\$([A-Z])/,"$1")}function Z9(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Fn(n){for(var t=0,e=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:t-1}}function jn(n){for(var t=n.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(n.r+1)}function Ur(n){var t=n.indexOf(":");return t==-1?{s:Fn(n),e:Fn(n)}:{s:Fn(n.slice(0,t)),e:Fn(n.slice(t+1))}}function ur(n,t){return typeof t>"u"||typeof t=="number"?ur(n.s,n.e):(typeof n!="string"&&(n=jn(n)),typeof t!="string"&&(t=jn(t)),n==t?n:n+":"+t)}function Bd(n){var t=Ur(n);return"$"+vn(t.s.c)+"$"+wn(t.s.r)+":$"+vn(t.e.c)+"$"+wn(t.e.r)}function Ud(n,t){if(!n&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n.replace(/'/g,"''")+"'":n}function Nn(n){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,r=0,i=0,s=n.length;for(e=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)e=26*e+i;for(t.s.c=--e,e=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)e=10*e+i;if(t.s.r=--e,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,e=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)e=26*e+i;for(t.e.c=--e,e=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)e=10*e+i;return t.e.r=--e,t}function nS(n,t){var e=n.t=="d"&&t instanceof Date;if(n.z!=null)try{return n.w=Mo(n.z,e?zr(t):t)}catch{}try{return n.w=Mo((n.XF||{}).numFmtId||(e?14:0),e?zr(t):t)}catch{return""+t}}function Io(n,t,e){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&e&&e.dateNF&&(n.z=e.dateNF),n.t=="e"?Ti[n.v]||n.v:t==null?nS(n,n.v):nS(n,t))}function Ef(n,t){var e=t&&t.sheet?t.sheet:"Sheet1",r={};return r[e]=n,{SheetNames:[e],Sheets:r}}function Q9(n){var t={},e=n||{};return e.dense&&(t["!data"]=[]),t}function gO(n,t,e){var r=e||{},i=n?n["!data"]!=null:r.dense,s=n||(i?{"!data":[]}:{});i&&!s["!data"]&&(s["!data"]=[]);var o=0,l=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var u=typeof r.origin=="string"?Fn(r.origin):r.origin;o=u.r,l=u.c}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Nn(s["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=s["!ref"]?d.e.r+1:0)}else h.s.c=h.e.c=h.s.r=h.e.r=0;for(var p=[],g=!1,v=0;v!=t.length;++v)if(t[v]){if(!Array.isArray(t[v]))throw new Error("aoa_to_sheet expects an array of arrays");var y=o+v;i&&(s["!data"][y]||(s["!data"][y]=[]),p=s["!data"][y]);for(var _=t[v],b=0;b!=_.length;++b)if(!(typeof _[b]>"u")){var E={v:_[b],t:""},S=l+b;if(h.s.r>y&&(h.s.r=y),h.s.c>S&&(h.s.c=S),h.e.r<y&&(h.e.r=y),h.e.c<S&&(h.e.c=S),g=!0,_[b]&&typeof _[b]=="object"&&!Array.isArray(_[b])&&!(_[b]instanceof Date))E=_[b];else if(Array.isArray(E.v)&&(E.f=_[b][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(r.nullError)E.t="e",E.v=0;else if(r.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?isFinite(E.v)?E.t="n":isNaN(E.v)?(E.t="e",E.v=15):(E.t="e",E.v=7):typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=r.dateNF||Rn[14],r.UTC||(E.v=Ym(E.v)),r.cellDates?(E.t="d",E.w=Mo(E.z,zr(E.v,r.date1904))):(E.t="n",E.v=zr(E.v,r.date1904),E.w=Mo(E.z,E.v))):E.t="s";if(i)p[S]&&p[S].z&&(E.z=p[S].z),p[S]=E;else{var T=vn(S)+(y+1);s[T]&&s[T].z&&(E.z=s[T].z),s[T]=E}}}return g&&h.s.c<104e5&&(s["!ref"]=ur(h)),s}function wf(n,t){return gO(null,n,t)}function J9(n){return n.read_shift(4,"i")}function ra(n,t){return t||(t=It(4)),t.write_shift(4,n),t}function ri(n){var t=n.read_shift(4);return t===0?"":n.read_shift(t,"dbcs")}function _r(n,t){var e=!1;return t==null&&(e=!0,t=It(4+2*n.length)),t.write_shift(4,n.length),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}function tz(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function ez(n,t){return t||(t=It(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Bb(n,t){var e=n.l,r=n.read_shift(1),i=ri(n),s=[],o={t:i,h:i};if((r&1)!==0){for(var l=n.read_shift(4),u=0;u!=l;++u)s.push(tz(n));o.r=s}else o.r=[{ich:0,ifnt:0}];return n.l=e+t,o}function nz(n,t){var e=!1;return t==null&&(e=!0,t=It(15+4*n.t.length)),t.write_shift(1,0),_r(n.t,t),e?t.slice(0,t.l):t}var rz=Bb;function iz(n,t){var e=!1;return t==null&&(e=!0,t=It(23+4*n.t.length)),t.write_shift(1,1),_r(n.t,t),t.write_shift(4,1),ez({},t),e?t.slice(0,t.l):t}function Us(n){var t=n.read_shift(4),e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:t,iStyleRef:e}}function zc(n,t){return t==null&&(t=It(8)),t.write_shift(-4,n.c),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}function Hc(n){var t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:t}}function jc(n,t){return t==null&&(t=It(4)),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}var sz=ri,mO=_r;function qm(n){var t=n.read_shift(4);return t===0||t===4294967295?"":n.read_shift(t,"dbcs")}function zd(n,t){var e=!1;return t==null&&(e=!0,t=It(127)),t.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}var az=ri,cy=qm,Ub=zd;function zb(n){var t=n.slice(n.l,n.l+4),e=t[0]&1,r=t[0]&2;n.l+=4;var i=r===0?sm([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):dc(t,0)>>2;return e?i/100:i}function vO(n,t){t==null&&(t=It(4));var e=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,e=1),r)t.write_shift(-4,((e?i:n)<<2)+(e+2));else throw new Error("unsupported RkNumber "+n)}function _O(n){var t={s:{},e:{}};return t.s.r=n.read_shift(4),t.e.r=n.read_shift(4),t.s.c=n.read_shift(4),t.e.c=n.read_shift(4),t}function oz(n,t){return t||(t=It(16)),t.write_shift(4,n.s.r),t.write_shift(4,n.e.r),t.write_shift(4,n.s.c),t.write_shift(4,n.e.c),t}var $c=_O,Af=oz;function Sf(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Lc(n,t){return(t||It(8)).write_shift(8,n,"f")}function lz(n){var t={},e=n.read_shift(1),r=e>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),o=n.read_shift(1),l=n.read_shift(1),u=n.read_shift(1);switch(n.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var h=vz[i];h&&(t.rgb=pS(h));break;case 2:t.rgb=pS([o,l,u]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function am(n,t){if(t||(t=It(8)),!n||n.auto)return t.write_shift(4,0),t.write_shift(4,0),t;n.index!=null?(t.write_shift(1,2),t.write_shift(1,n.index)):n.theme!=null?(t.write_shift(1,6),t.write_shift(1,n.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=n.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!n.rgb||n.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function cz(n){var t=n.read_shift(1);n.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function uz(n,t){t||(t=It(2));var e=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var yO=2,ns=3,fg=11,om=19,hg=64,fz=65,hz=71,dz=4108,pz=4126,Ir=80,rS={1:{n:"CodePage",t:yO},2:{n:"Category",t:Ir},3:{n:"PresentationFormat",t:Ir},4:{n:"ByteCount",t:ns},5:{n:"LineCount",t:ns},6:{n:"ParagraphCount",t:ns},7:{n:"SlideCount",t:ns},8:{n:"NoteCount",t:ns},9:{n:"HiddenCount",t:ns},10:{n:"MultimediaClipCount",t:ns},11:{n:"ScaleCrop",t:fg},12:{n:"HeadingPairs",t:dz},13:{n:"TitlesOfParts",t:pz},14:{n:"Manager",t:Ir},15:{n:"Company",t:Ir},16:{n:"LinksUpToDate",t:fg},17:{n:"CharacterCount",t:ns},19:{n:"SharedDoc",t:fg},22:{n:"HyperlinksChanged",t:fg},23:{n:"AppVersion",t:ns,p:"version"},24:{n:"DigSig",t:fz},26:{n:"ContentType",t:Ir},27:{n:"ContentStatus",t:Ir},28:{n:"Language",t:Ir},29:{n:"Version",t:Ir},255:{},2147483648:{n:"Locale",t:om},2147483651:{n:"Behavior",t:om},1919054434:{}},iS={1:{n:"CodePage",t:yO},2:{n:"Title",t:Ir},3:{n:"Subject",t:Ir},4:{n:"Author",t:Ir},5:{n:"Keywords",t:Ir},6:{n:"Comments",t:Ir},7:{n:"Template",t:Ir},8:{n:"LastAuthor",t:Ir},9:{n:"RevNumber",t:Ir},10:{n:"EditTime",t:hg},11:{n:"LastPrinted",t:hg},12:{n:"CreatedDate",t:hg},13:{n:"ModifiedDate",t:hg},14:{n:"PageCount",t:ns},15:{n:"WordCount",t:ns},16:{n:"CharCount",t:ns},17:{n:"Thumbnail",t:hz},18:{n:"Application",t:Ir},19:{n:"DocSecurity",t:ns},255:{},2147483648:{n:"Locale",t:om},2147483651:{n:"Behavior",t:om},1919054434:{}};function gz(n){return n.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var mz=gz([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),vz=ii(mz),Ti={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Fa={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},_z=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],yz={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},dg={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function bO(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xO(n,t,e){var r=b9(yz),i=[],s;i[i.length]=fr,i[i.length]=re("Types",null,{xmlns:Sr.CT,"xmlns:xsd":Sr.xsd,"xmlns:xsi":Sr.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return re("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){n[h]&&n[h].length>0&&(s=n[h][0],i[i.length]=re("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:dg[h][t.bookType]||dg[h].xlsx}))},l=function(h){(n[h]||[]).forEach(function(d){i[i.length]=re("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:dg[h][t.bookType]||dg[h].xlsx})})},u=function(h){(n[h]||[]).forEach(function(d){i[i.length]=re("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var en={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function EO(n){var t=n.lastIndexOf("/");return n.slice(0,t+1)+"_rels/"+n.slice(t+1)+".rels"}function qu(n){var t=[fr,re("Relationships",null,{xmlns:Sr.RELS})];return cr(n["!id"]).forEach(function(e){t[t.length]=re("Relationship",null,n["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ln(n,t,e,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),t<0)for(t=n["!idx"];n["!id"]["rId"+t];++t);if(n["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=e,[en.HLINK,en.XPATH,en.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,t}function bz(n){var t=[fr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<n.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+n[e][0]+'" manifest:media-type="'+n[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function sS(n,t,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function xz(n,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Ez(n){var t=[fr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=n.length;++e)t.push(sS(n[e][0],n[e][1])),t.push(xz("",n[e][0]));return t.push(sS("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function wO(n,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Zg.version+"</meta:generator></office:meta></office:document-meta>"}var xc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function A_(n,t,e,r,i){i[n]!=null||t==null||t===""||(i[n]=t,t=$e(t),r[r.length]=e?re(n,t,e):Fr(n,t))}function AO(n,t){var e=t||{},r=[fr,re("cp:coreProperties",null,{"xmlns:cp":Sr.CORE_PROPS,"xmlns:dc":Sr.dc,"xmlns:dcterms":Sr.dcterms,"xmlns:dcmitype":Sr.dcmitype,"xmlns:xsi":Sr.xsi})],i={};if(!n&&!e.Props)return r.join("");n&&(n.CreatedDate!=null&&A_("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:ly(n.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&A_("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:ly(n.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=xc.length;++s){var o=xc[s],l=e.Props&&e.Props[o[1]]!=null?e.Props[o[1]]:n?n[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&A_(o[0],l,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ku=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],SO=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function TO(n){var t=[],e=re;return n||(n={}),n.Application="SheetJS",t[t.length]=fr,t[t.length]=re("Properties",null,{xmlns:Sr.EXT_PROPS,"xmlns:vt":Sr.vt}),Ku.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=$e(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=e(r[0],i))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+$e(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function CO(n){var t=[fr,re("Properties",null,{xmlns:Sr.CUST_PROPS,"xmlns:vt":Sr.vt})];if(!n)return t.join("");var e=1;return cr(n).forEach(function(i){++e,t[t.length]=re("property",B9(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:$e(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var aS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function wz(n,t){var e=[];return cr(aS).map(function(r){for(var i=0;i<xc.length;++i)if(xc[i][1]==r)return xc[i];for(i=0;i<Ku.length;++i)if(Ku[i][1]==r)return Ku[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),e.push(Fr(aS[r[1]]||r[1],i))}}),re("DocumentProperties",e.join(""),{xmlns:ss.o})}function Az(n,t){var e=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&cr(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var o=0;o<xc.length;++o)if(s==xc[o][1])return;for(o=0;o<Ku.length;++o)if(s==Ku[o][1])return;for(o=0;o<e.length;++o)if(s==e[o])return;var l=n[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l=String(l),i.push(re(X2(s),l,{"dt:dt":u}))}}),t&&cr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(re(X2(s),o,{"dt:dt":l}))}}),"<"+r+' xmlns="'+ss.o+'">'+i.join("")+"</"+r+">"}function Sz(n){var t=typeof n=="string"?new Date(Date.parse(n)):n,e=t.getTime()/1e3+11644473600,r=e%Math.pow(2,32),i=(e-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=It(8);return o.write_shift(4,r),o.write_shift(4,i),o}function oS(n,t){var e=It(4),r=It(4);switch(e.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,t);break;case 5:r=It(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=Sz(t);break;case 31:case 80:for(r=It(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+t)}return lr([e,r])}var DO=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Tz(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function lS(n,t,e){var r=It(8),i=[],s=[],o=8,l=0,u=It(8),h=It(8);if(u.write_shift(4,2),u.write_shift(4,1200),h.write_shift(4,1),s.push(u),i.push(h),o+=8+u.length,!t){h=It(8),h.write_shift(4,0),i.unshift(h);var d=[It(4)];for(d[0].write_shift(4,n.length),l=0;l<n.length;++l){var p=n[l][0];for(u=It(8+2*(p.length+1)+(p.length%2?0:2)),u.write_shift(4,l+2),u.write_shift(4,p.length+1),u.write_shift(0,p,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=lr(d),s.unshift(u),o+=8+u.length}for(l=0;l<n.length;++l)if(!(t&&!t[n[l][0]])&&!(DO.indexOf(n[l][0])>-1||SO.indexOf(n[l][0])>-1)&&n[l][1]!=null){var g=n[l][1],v=0;if(t){v=+t[n[l][0]];var y=e[v];if(y.p=="version"&&typeof g=="string"){var _=g.split(".");g=(+_[0]<<16)+(+_[1]||0)}u=oS(y.t,g)}else{var b=Tz(g);b==-1&&(b=31,g=String(g)),u=oS(b,g)}s.push(u),h=It(8),h.write_shift(4,t?v:2+l),i.push(h),o+=8+u.length}var E=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,E),E+=s[l].length;return r.write_shift(4,o),r.write_shift(4,s.length),lr([r].concat(i).concat(s))}function cS(n,t,e,r,i,s){var o=It(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Tn.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var u=lS(n,e,r);if(l.push(u),i){var h=lS(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+u.length),l.push(h)}return lr(l)}function Cz(n,t){t||(t=It(n));for(var e=0;e<n;++e)t.write_shift(1,0);return t}function Dz(n,t){return n.read_shift(t)===1}function Jr(n,t){return t||(t=It(2)),t.write_shift(2,+!!n),t}function Mg(n){return n.read_shift(2,"u")}function Rs(n,t){return t||(t=It(2)),t.write_shift(2,n),t}function OO(n,t,e){return e||(e=It(2)),e.write_shift(1,t=="e"?+n:+!!n),e.write_shift(1,t=="e"?1:0),e}function RO(n,t,e){var r=n.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont",s=So;if(e&&e.biff>=8&&(So=1200),!e||e.biff==8){var o=n.read_shift(1);o&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var l=r?n.read_shift(r,i):"";return So=s,l}function Oz(n){var t=n.t||"",e=It(3);e.write_shift(2,t.length),e.write_shift(1,1);var r=It(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[e,r];return lr(i)}function Rz(n,t,e){var r;if(e){if(e.biff>=2&&e.biff<=5)return n.read_shift(t,"cpstr");if(e.biff>=12)return n.read_shift(t,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(t,"sbcs-cont"):r=n.read_shift(t,"dbcs-cont"),r}function Nz(n,t,e){var r=n.read_shift(e&&e.biff==2?1:2);return r===0?(n.l++,""):Rz(n,r,e)}function kz(n,t,e){if(e.biff>5)return Nz(n,t,e);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,e.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function NO(n,t,e){return e||(e=It(3+2*n.length)),e.write_shift(2,n.length),e.write_shift(1,1),e.write_shift(31,n,"utf16le"),e}function uS(n,t){t||(t=It(6+n.length*2)),t.write_shift(4,1+n.length);for(var e=0;e<n.length;++e)t.write_shift(2,n.charCodeAt(e));return t.write_shift(2,0),t}function Lz(n){var t=It(512),e=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(e=0;e<o.length;++e)t.write_shift(4,o[e]);if(s==28)r=r.slice(1),uS(r,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<o.length;++e)t.write_shift(1,parseInt(o[e],16));var l=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)t.write_shift(2,l.charCodeAt(e));t.write_shift(2,0),s&8&&uS(i>-1?r.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<o.length;++e)t.write_shift(1,parseInt(o[e],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,r.length-3*u+1),e=0;e<r.length-3*u;++e)t.write_shift(1,r.charCodeAt(e+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function Mc(n,t,e,r){return r||(r=It(6)),r.write_shift(2,n),r.write_shift(2,t),r.write_shift(2,e||0),r}function Mz(n,t,e){var r=e.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),o=n.read_shift(r,"i");return[i,s,o]}function Iz(n){var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:e}}}function kO(n,t){return t||(t=It(8)),t.write_shift(2,n.s.r),t.write_shift(2,n.e.r),t.write_shift(2,n.s.c),t.write_shift(2,n.e.c),t}function Hb(n,t,e){var r=1536,i=16;switch(e.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=It(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Pz(n,t){var e=!t||t.biff==8,r=It(e?112:54);for(r.write_shift(t.biff==8?2:1,7),e&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(e?0:536870912));r.l<r.length;)r.write_shift(1,e?0:32);return r}function Fz(n,t){var e=!t||t.biff>=8?2:1,r=It(8+e*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(e*n.name.length,n.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function Bz(n,t){var e=It(8);e.write_shift(4,n.Count),e.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=Oz(n[i]);var s=lr([e].concat(r));return s.parts=[e.length].concat(r.map(function(o){return o.length})),s}function Uz(){var n=It(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function zz(n){var t=It(18),e=1718;return n&&n.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Hz(n,t){var e=n.name||"Arial",r=t&&t.biff==5,i=r?15+e.length:16+2*e.length,s=It(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,e.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*e.length,e,r?"sbcs":"utf16le"),s}function jz(n,t,e,r){var i=It(10);return Mc(n,t,r,i),i.write_shift(4,e),i}function $z(n,t,e,r,i){var s=!i||i.biff==8,o=It(8+ +s+(1+s)*e.length);return Mc(n,t,r,o),o.write_shift(2,e.length),s&&o.write_shift(1,1),o.write_shift((1+s)*e.length,e,s?"utf16le":"sbcs"),o}function Gz(n,t,e,r){var i=e&&e.biff==5;r||(r=It(i?3+t.length:5+2*t.length)),r.write_shift(2,n),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function Vz(n){var t=It(1+n.length);return t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t}function Wz(n){var t=It(3+n.length);return t.l+=2,t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t}function Xz(n,t){var e=t.biff==8||!t.biff?4:2,r=It(2*e+6);return r.write_shift(e,n.s.r),r.write_shift(e,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function fS(n,t,e,r){var i=e&&e.biff==5;r||(r=It(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,t<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function Yz(n){var t=It(4);return t.l+=2,t.write_shift(1,n.numFmtId),t.l++,t}function LO(n){var t=It(12);return t.l++,t.write_shift(1,n.numFmtId),t.l+=10,t}var qz=LO;function Kz(n){var t=It(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function S_(n,t,e,r,i,s){var o=It(8);return Mc(n,t,r,o),OO(e,s,o),o}function Zz(n,t,e,r){var i=It(14);return Mc(n,t,r,i),Lc(e,i),i}function Qz(n,t,e){if(e.biff<8||!(e.biff>8)&&t==n[n.l]+(n[n.l+1]==3?1:0)+1)return hS(n,t,e);for(var r=[],i=n.l+t,s=n.read_shift(e.biff>8?4:2);s--!==0;)r.push(Mz(n,e.biff>8?12:6,e));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function hS(n,t,e){n[n.l+1]==3&&n[n.l]++;var r=RO(n,t,e);return r.charCodeAt(0)==3?r.slice(1):r}function T_(n,t,e,r){var i=It(6+(r||n.length));return i.write_shift(2,t),i.write_shift(2,e),i.write_shift(2,r||n.length),i.write_shift(n.length,n,"sbcs"),i}function Jz(n){var t=It(2+n.length*8);t.write_shift(2,n.length);for(var e=0;e<n.length;++e)kO(n[e],t);return t}function tH(n){var t=It(24),e=Fn(n[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return lr([t,Lz(n[1])])}function eH(n){var t=n[1].Tooltip,e=It(10+2*(t.length+1));e.write_shift(2,2048);var r=Fn(n[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var i=0;i<t.length;++i)e.write_shift(2,t.charCodeAt(i));return e.write_shift(2,0),e}function nH(n){return n||(n=It(4)),n.write_shift(2,1),n.write_shift(2,1),n}function rH(n,t,e){if(!e.cellStyles)return Ha(n,t);var r=e&&e.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),o=n.read_shift(r),l=n.read_shift(r),u=n.read_shift(2);r==2&&(n.l+=2);var h={s:i,e:s,w:o,ixfe:l,flags:u};return(e.biff>=5||!e.biff)&&(h.level=u>>8&7),h}function iH(n,t){var e=It(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,n.width*256),e.write_shift(2,0);var r=0;return n.hidden&&(r|=1),e.write_shift(1,r),r=n.level||0,e.write_shift(1,r),e.write_shift(2,0),e}function sH(n){for(var t=It(2*n),e=0;e<n;++e)t.write_shift(2,e+1);return t}function c0(n,t,e,r,i){return n||(n=It(7)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,r||0),n.write_shift(1,i||0),n.write_shift(1,0),n}function aH(n,t,e,r,i){var s=It(15);return c0(s,n,t,r||0,i||0),s.write_shift(8,e,"f"),s}function oH(n,t,e,r,i){var s=It(9);return c0(s,n,t,r||0,i||0),s.write_shift(2,e),s}var lH=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ob({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,u){var h=[],d=Rc(1);switch(u.type){case"base64":d=is(Ol(l));break;case"binary":d=is(l);break;case"buffer":case"array":d=l;break}xi(d,0);var p=d.read_shift(1),g=!!(p&136),v=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var _=0,b=521;p==2&&(_=d.read_shift(2)),d.l+=3,p!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),p!=2&&(b=d.read_shift(2));var E=d.read_shift(2);u.codepage,p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&n[d[d.l]],d.l+=1,d.l+=2),y&&(d.l+=36);for(var S=[],T={},O=Math.min(d.length,p==2?521:b-10-(v?264:0)),R=y?32:11;d.l<O&&d[d.l]!=13;)switch(T={},T.name=Nc(d.slice(d.l,d.l+R)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=R,T.type=String.fromCharCode(d.read_shift(1)),p!=2&&!y&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),p==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&S.push(T),p!=2&&(d.l+=y?13:14),T.type){case"B":(!v||T.len!=8)&&u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=b-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=b;var N=0,C=0;for(h[0]=[],C=0;C!=S.length;++C)h[0][C]=S[C].name;for(;_-- >0;){if(d[d.l]===42){d.l+=E;continue}for(++d.l,h[++N]=[],C=0,C=0;C!=S.length;++C){var I=d.slice(d.l,d.l+S[C].len);d.l+=S[C].len,xi(I,0);var M=Nc(I);switch(S[C].type){case"C":M.trim().length&&(h[N][C]=M.replace(/([^\s])\s+$/,"$1"));break;case"D":M.length===8?(h[N][C]=new Date(Date.UTC(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8),0,0,0,0)),u&&u.UTC||(h[N][C]=hf(h[N][C]))):h[N][C]=M;break;case"F":h[N][C]=parseFloat(M.trim());break;case"+":case"I":h[N][C]=y?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":h[N][C]=!0;break;case"N":case"F":h[N][C]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));h[N][C]="##MEMO##"+(y?parseInt(M.trim(),10):I.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(h[N][C]=+M||0);break;case"@":h[N][C]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":{var F=I.read_shift(4),H=I.read_shift(4);if(F==0&&H==0)break;h[N][C]=new Date((F-2440588)*864e5+H),u&&u.UTC||(h[N][C]=hf(h[N][C]))}break;case"Y":h[N][C]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[N][C]=-I.read_shift(-8,"f");break;case"B":if(v&&S[C].len==8){h[N][C]=I.read_shift(8,"f");break}case"G":case"P":I.l+=S[C].len;break;case"0":if(S[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[C].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=S,h}function r(l,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var d=wf(e(l,h),h);return d["!cols"]=h.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete h.DBF,d}function i(l,u){try{var h=Ef(r(l,u),u);return h.bookType="dbf",h}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,u){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var h=u||{},d=So;if(+h.codepage>=0&&Id(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=ni(),g=dy(l,{header:1,raw:!0,cellDates:!0}),v=g[0],y=g.slice(1),_=l["!cols"]||[],b=0,E=0,S=0,T=1;for(b=0;b<v.length;++b){if(((_[b]||{}).DBF||{}).name){v[b]=_[b].DBF.name,++S;continue}if(v[b]!=null){if(++S,typeof v[b]=="number"&&(v[b]=v[b].toString(10)),typeof v[b]!="string")throw new Error("DBF Invalid column name "+v[b]+" |"+typeof v[b]+"|");if(v.indexOf(v[b])!==b){for(E=0;E<1024;++E)if(v.indexOf(v[b]+"_"+E)==-1){v[b]+="_"+E;break}}}}var O=Nn(l["!ref"]),R=[],N=[],C=[];for(b=0;b<=O.e.c-O.s.c;++b){var I="",M="",F=0,H=[];for(E=0;E<y.length;++E)y[E][b]!=null&&H.push(y[E][b]);if(H.length==0||v[b]==null){R[b]="?";continue}for(E=0;E<H.length;++E){switch(typeof H[E]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=H[E]instanceof Date?"D":"C";break;default:M="C"}F=Math.max(F,String(H[E]).length),I=I&&I!=M?"C":M}F>250&&(F=250),M=((_[b]||{}).DBF||{}).type,M=="C"&&_[b].DBF.len>F&&(F=_[b].DBF.len),I=="B"&&M=="N"&&(I="N",C[b]=_[b].DBF.dec,F=_[b].DBF.len),N[b]=I=="C"||M=="N"?F:s[I]||0,T+=N[b],R[b]=I}var P=p.next(32);for(P.write_shift(4,318902576),P.write_shift(4,y.length),P.write_shift(2,296+32*S),P.write_shift(2,T),b=0;b<4;++b)P.write_shift(4,0);var et=+t[So]||3;for(P.write_shift(4,0|et<<8),n[et]!=+h.codepage&&(h.codepage&&console.error("DBF Unsupported codepage "+So+", using 1252"),So=1252),b=0,E=0;b<v.length;++b)if(v[b]!=null){var L=p.next(32),st=(v[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,st,"sbcs"),L.write_shift(1,R[b]=="?"?"C":R[b],"sbcs"),L.write_shift(4,E),L.write_shift(1,N[b]||s[R[b]]||0),L.write_shift(1,C[b]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),E+=N[b]||s[R[b]]||0}var Q=p.next(264);for(Q.write_shift(4,13),b=0;b<65;++b)Q.write_shift(4,0);for(b=0;b<y.length;++b){var Y=p.next(T);for(Y.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(R[E]){case"L":Y.write_shift(1,y[b][E]==null?63:y[b][E]?84:70);break;case"B":Y.write_shift(8,y[b][E]||0,"f");break;case"N":var Ot="0";for(typeof y[b][E]=="number"&&(Ot=y[b][E].toFixed(C[E]||0)),Ot.length>N[E]&&(Ot=Ot.slice(0,N[E])),S=0;S<N[E]-Ot.length;++S)Y.write_shift(1,32);Y.write_shift(1,Ot,"sbcs");break;case"D":y[b][E]?(Y.write_shift(4,("0000"+y[b][E].getFullYear()).slice(-4),"sbcs"),Y.write_shift(2,("00"+(y[b][E].getMonth()+1)).slice(-2),"sbcs"),Y.write_shift(2,("00"+y[b][E].getDate()).slice(-2),"sbcs")):Y.write_shift(8,"00000000","sbcs");break;case"C":var Et=Y.l,z=String(y[b][E]!=null?y[b][E]:"").slice(0,N[E]);for(Y.write_shift(1,z,"cpstr"),Et+=N[E]-Y.l,S=0;S<Et;++S)Y.write_shift(1,32);break}}return So=d,p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),cH=function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+cr(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+cr(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var e=function(v,y){var _=n[y];return typeof _=="number"?I2(_):_},r=function(v,y,_){var b=y.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return b==59?v:I2(b)};n["|"]=254;var i=function(v){return v.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function s(v,y){switch(y.type){case"base64":return o(Ol(v),y);case"binary":return o(v,y);case"buffer":return o(cn&&Buffer.isBuffer(v)?v.toString("binary"):Nc(v),y);case"array":return o(Rb(v),y)}throw new Error("Unrecognized type "+y.type)}function o(v,y){var _=v.split(/[\n\r]+/),b=-1,E=-1,S=0,T=0,O=[],R=[],N=null,C={},I=[],M=[],F=[],H=0,P,et={Workbook:{WBProps:{},Names:[]}};for(+y.codepage>=0&&Id(+y.codepage);S!==_.length;++S){H=0;var L=_[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,e),st=L.replace(/;;/g,"\0").split(";").map(function(ut){return ut.replace(/\u0000/g,";")}),Q=st[0],Y;if(L.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":for(T=1;T<st.length;++T)switch(st[T].charAt(0)){case"V":{var Ot=parseInt(st[T].slice(1),10);Ot>=1&&Ot<=4&&(et.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(st[1].charAt(0)){case"P":R.push(L.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Et={Sheet:0};for(T=1;T<st.length;++T)switch(st[T].charAt(0)){case"N":Et.Name=st[T].slice(1);break;case"E":Et.Ref=(y&&y.sheet||"Sheet1")+"!"+vS(st[T].slice(1));break}et.Workbook.Names.push(Et)}break;case"C":var z=!1,J=!1,V=!1,ct=!1,gt=-1,_t=-1,Bt="",Gt="z",j="";for(T=1;T<st.length;++T)switch(st[T].charAt(0)){case"A":j=st[T].slice(1);break;case"X":E=parseInt(st[T].slice(1),10)-1,J=!0;break;case"Y":for(b=parseInt(st[T].slice(1),10)-1,J||(E=0),P=O.length;P<=b;++P)O[P]=[];break;case"K":Y=st[T].slice(1),Y.charAt(0)==='"'?(Y=Y.slice(1,Y.length-1),Gt="s"):Y==="TRUE"||Y==="FALSE"?(Y=Y==="TRUE",Gt="b"):Y.charAt(0)=="#"&&Fa[Y]!=null?(Gt="e",Y=Fa[Y]):isNaN(Oo(Y))||(Y=Oo(Y),Gt="n",N!==null&&kc(N)&&y.cellDates&&(Y=Xu(et.Workbook.WBProps.date1904?Y+1462:Y),Gt=typeof Y=="number"?"n":"d")),z=!0;break;case"E":ct=!0,Bt=vS(st[T].slice(1),{r:b,c:E});break;case"S":V=!0;break;case"G":break;case"R":gt=parseInt(st[T].slice(1),10)-1;break;case"C":_t=parseInt(st[T].slice(1),10)-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+L)}if(z&&(O[b][E]?(O[b][E].t=Gt,O[b][E].v=Y):O[b][E]={t:Gt,v:Y},N&&(O[b][E].z=N),y.cellText!==!1&&N&&(O[b][E].w=Mo(O[b][E].z,O[b][E].v,{date1904:et.Workbook.WBProps.date1904})),N=null),V){if(ct)throw new Error("SYLK shared formula cannot have own formula");var pt=gt>-1&&O[gt][_t];if(!pt||!pt[1])throw new Error("SYLK shared formula cannot find base");Bt=uj(pt[1],{r:b-gt,c:E-_t})}Bt&&(O[b][E]?O[b][E].f=Bt:O[b][E]={t:"n",f:Bt}),j&&(O[b][E]||(O[b][E]={t:"z"}),O[b][E].c=[{a:"SheetJSYLK",t:j}]);break;case"F":var lt=0;for(T=1;T<st.length;++T)switch(st[T].charAt(0)){case"X":E=parseInt(st[T].slice(1),10)-1,++lt;break;case"Y":for(b=parseInt(st[T].slice(1),10)-1,P=O.length;P<=b;++P)O[P]=[];break;case"M":H=parseInt(st[T].slice(1),10)/20;break;case"F":break;case"G":break;case"P":N=R[parseInt(st[T].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(F=st[T].slice(1).split(" "),P=parseInt(F[0],10);P<=parseInt(F[1],10);++P)H=parseInt(F[2],10),M[P-1]=H===0?{hidden:!0}:{wch:H};break;case"C":E=parseInt(st[T].slice(1),10)-1,M[E]||(M[E]={});break;case"R":b=parseInt(st[T].slice(1),10)-1,I[b]||(I[b]={}),H>0?(I[b].hpt=H,I[b].hpx=FO(H)):H===0&&(I[b].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+L)}lt<1&&(N=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+L)}}return I.length>0&&(C["!rows"]=I),M.length>0&&(C["!cols"]=M),M.forEach(function(ut){jb(ut)}),y&&y.sheetRows&&(O=O.slice(0,y.sheetRows)),[O,C,et]}function l(v,y){var _=s(v,y),b=_[0],E=_[1],S=_[2],T=ii(y);T.date1904=(((S||{}).Workbook||{}).WBProps||{}).date1904;var O=wf(b,T);cr(E).forEach(function(N){O[N]=E[N]});var R=Ef(O,y);return cr(S).forEach(function(N){R[N]=S[N]}),R.bookType="sylk",R}function u(v,y,_,b,E,S){var T="C;Y"+(_+1)+";X"+(b+1)+";K";switch(v.t){case"n":T+=isFinite(v.v)?v.v||0:Ti[isNaN(v.v)?36:7],v.f&&!v.F&&(T+=";E"+Zm(v.f,{r:_,c:b}));break;case"b":T+=v.v?"TRUE":"FALSE";break;case"e":T+=v.w||Ti[v.v]||v.v;break;case"d":T+=zr($i(v.v,S),S);break;case"s":T+='"'+(v.v==null?"":String(v.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function h(v,y,_){var b="C;Y"+(y+1)+";X"+(_+1)+";A";return b+=i(v.map(function(E){return E.t}).join("")),b}function d(v,y){y.forEach(function(_,b){var E="F;W"+(b+1)+" "+(b+1)+" ";_.hidden?E+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=lm(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=cm(_.wpx)),typeof _.wch=="number"&&(E+=Math.round(_.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function p(v,y){y.forEach(function(_,b){var E="F;";_.hidden?E+="M0;":_.hpt?E+="M"+20*_.hpt+";":_.hpx&&(E+="M"+20*um(_.hpx)+";"),E.length>2&&v.push(E+"R"+(b+1))})}function g(v,y,_){y||(y={}),y._formats=["General"];var b=["ID;PSheetJS;N;E"],E=[],S=Nn(v["!ref"]||"A1"),T,O=v["!data"]!=null,R=`\r
`,N=(((_||{}).Workbook||{}).WBProps||{}).date1904,C="General";b.push("P;PGeneral");var I=S.s.r,M=S.s.c,F=[];if(v["!ref"]){for(I=S.s.r;I<=S.e.r;++I)if(!(O&&!v["!data"][I])){for(F=[],M=S.s.c;M<=S.e.c;++M)T=O?v["!data"][I][M]:v[vn(M)+wn(I)],!(!T||!T.c)&&F.push(h(T.c,I,M));F.length&&E.push(F.join(R))}}if(v["!ref"]){for(I=S.s.r;I<=S.e.r;++I)if(!(O&&!v["!data"][I])){for(F=[],M=S.s.c;M<=S.e.c;++M)if(T=O?v["!data"][I][M]:v[vn(M)+wn(I)],!(!T||T.v==null&&(!T.f||T.F))){if((T.z||(T.t=="d"?Rn[14]:"General"))!=C){var H=y._formats.indexOf(T.z);H==-1&&(y._formats.push(T.z),H=y._formats.length-1,b.push("P;P"+T.z.replace(/;/g,";;"))),F.push("F;P"+H+";Y"+(I+1)+";X"+(M+1))}F.push(u(T,v,I,M,y,N))}E.push(F.join(R))}}return b.push("F;P0;DG0G8;M255"),v["!cols"]&&d(b,v["!cols"]),v["!rows"]&&p(b,v["!rows"]),v["!ref"]&&b.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" ")),b.push("O;L;D;B"+(N?";V4":"")+";K47;G100 0.001"),delete y._formats,b.join(R)+R+E.join(R)+R+"E"+R}return{to_workbook:l,from_sheet:g}}(),uH=function(){function n(l,u){switch(u.type){case"base64":return t(Ol(l),u);case"binary":return t(l,u);case"buffer":return t(cn&&Buffer.isBuffer(l)?l.toString("binary"):Nc(l),u);case"array":return t(Rb(l),u)}throw new Error("Unrecognized type "+u.type)}function t(l,u){for(var h=l.split(`
`),d=-1,p=-1,g=0,v=[];g!==h.length;++g){if(h[g].trim()==="BOT"){v[++d]=[],p=0;continue}if(!(d<0)){var y=h[g].trim().split(","),_=y[0],b=y[1];++g;for(var E=h[g]||"";(E.match(/["]/g)||[]).length&1&&g<h.length-1;)E+=`
`+h[++g];switch(E=E.trim(),+_){case-1:if(E==="BOT"){v[++d]=[],p=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?v[d][p]=!0:E==="FALSE"?v[d][p]=!1:isNaN(Oo(b))?isNaN(im(b).getDate())?v[d][p]=b:(v[d][p]=$i(b),u&&u.UTC||(v[d][p]=hf(v[d][p]))):v[d][p]=Oo(b),++p;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),v[d][p++]=E!==""?E:null;break}if(E==="EOD")break}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function e(l,u){return wf(n(l,u),u)}function r(l,u){var h=Ef(e(l,u),u);return h.bookType="dif",h}function i(l,u){return"0,"+String(l)+`\r
`+u}function s(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function o(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var u=Nn(l["!ref"]),h=l["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(u.e.r-u.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(u.e.c-u.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],p=u.s.r;p<=u.e.r;++p){for(var g=h?l["!data"][p]:[],v=`-1,0\r
BOT\r
`,y=u.s.c;y<=u.e.c;++y){var _=h?g&&g[y]:l[jn({r:p,c:y})];if(_==null){v+=`1,0\r
""\r
`;continue}switch(_.t){case"n":_.w!=null?v+="0,"+_.w+`\r
V`:_.v!=null?v+=i(_.v,"V"):_.f!=null&&!_.F?v+=s("="+_.f):v+=`1,0\r
""`;break;case"b":v+=_.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":v+=s(isNaN(+_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=Mo(_.z||Rn[14],zr($i(_.v)))),v+=i(_.w,"V");break;default:v+=`1,0\r
""`}v+=`\r
`}d.push(v)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:r,to_sheet:e,from_sheet:o}}(),MO=function(){function n(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,g){for(var v=p.split(`
`),y=-1,_=-1,b=0,E=[];b!==v.length;++b){var S=v[b].trim().split(":");if(S[0]==="cell"){var T=Fn(S[1]);if(E.length<=T.r)for(y=E.length;y<=T.r;++y)E[y]||(E[y]=[]);switch(y=T.r,_=T.c,S[2]){case"t":E[y][_]=n(S[3]);break;case"v":E[y][_]=+S[3];break;case"vtf":var O=S[S.length-1];case"vtc":switch(S[3]){case"nl":E[y][_]=!!+S[4];break;default:E[y][_]=S[S.length-1].charAt(0)=="#"?{t:"e",v:Fa[S[S.length-1]]}:+S[4];break}S[2]=="vtf"&&(E[y][_]=[E[y][_],O])}}}return g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),E}function r(p,g){return wf(e(p,g),g)}function i(p,g){return Ef(r(p,g),g)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(p){if(!p||!p["!ref"])return"";for(var g=[],v=[],y,_="",b=Ur(p["!ref"]),E=p["!data"]!=null,S=b.s.r;S<=b.e.r;++S)for(var T=b.s.c;T<=b.e.c;++T)if(_=jn({r:S,c:T}),y=E?(p["!data"][S]||[])[T]:p[_],!(!y||y.v==null||y.t==="z")){switch(v=["cell",_,"t"],y.t){case"s":v.push(t(y.v));break;case"b":v[2]="vt"+(y.f?"f":"c"),v[3]="nl",v[4]=y.v?"1":"0",v[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var O=zr($i(y.v));v[2]="vtc",v[3]="nd",v[4]=""+O,v[5]=y.w||Mo(y.z||Rn[14],O);break;case"n":isFinite(y.v)?y.f?(v[2]="vtf",v[3]="n",v[4]=y.v,v[5]=t(y.f)):(v[2]="v",v[3]=y.v):(v[2]="vt"+(y.f?"f":"c"),v[3]="e"+Ti[isNaN(y.v)?36:7],v[4]="0",v[5]=y.f||v[3].slice(1),v[6]="e",v[7]=v[3].slice(1));break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(p){return[s,o,l,o,h(p),u].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:d}}(),fH=function(){function n(d,p,g,v,y){y.raw?p[g][v]=d:d===""||(d==="TRUE"?p[g][v]=!0:d==="FALSE"?p[g][v]=!1:isNaN(Oo(d))?isNaN(im(d).getDate())?d.charCodeAt(0)==35&&Fa[d]!=null?p[g][v]={t:"e",v:Fa[d],w:d}:p[g][v]=d:p[g][v]=$i(d):p[g][v]=Oo(d))}function t(d,p){var g=p||{},v=[];if(!d||d.length===0)return v;for(var y=d.split(/[\r\n]/),_=y.length-1;_>=0&&y[_].length===0;)--_;for(var b=10,E=0,S=0;S<=_;++S)E=y[S].indexOf(" "),E==-1?E=y[S].length:E++,b=Math.max(b,E);for(S=0;S<=_;++S){v[S]=[];var T=0;for(n(y[S].slice(0,b).trim(),v,S,T,g),T=1;T<=(y[S].length-b)/10+1;++T)n(y[S].slice(b+(T-1)*10,b+T*10).trim(),v,S,T,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var e={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(d){for(var p={},g=!1,v=0,y=0;v<d.length;++v)(y=d.charCodeAt(v))==34?g=!g:!g&&y in e&&(p[y]=(p[y]||0)+1);y=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&y.push([p[v],v]);if(!y.length){p=r;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&y.push([p[v],v])}return y.sort(function(_,b){return _[0]-b[0]||r[_[1]]-r[b[1]]}),e[y.pop()[1]]||44}function s(d,p){var g=p||{},v="",y={};g.dense&&(y["!data"]=[]);var _={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):g&&g.FS?v=g.FS:v=i(d.slice(0,1024));var b=0,E=0,S=0,T=0,O=0,R=v.charCodeAt(0),N=!1,C=0,I=d.charCodeAt(0),M=g.dateNF!=null?g9(g.dateNF):null;function F(){var H=d.slice(T,O);H.slice(-1)=="\r"&&(H=H.slice(0,-1));var P={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),g.cellText!==!1&&(P.w=H),H.length===0)P.t="z";else if(g.raw)P.t="s",P.v=H;else if(H.trim().length===0)P.t="s",P.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(P.t="s",P.v=H.slice(2,-1).replace(/""/g,'"')):fj(H)?(P.t="s",P.f=H.slice(1),P.v=H):(P.t="s",P.v=H);else if(H=="TRUE")P.t="b",P.v=!0;else if(H=="FALSE")P.t="b",P.v=!1;else if(!isNaN(S=Oo(H)))P.t="n",P.v=S;else if(!isNaN((S=im(H)).getDate())||M&&H.match(M)){if(P.z=g.dateNF||Rn[14],M&&H.match(M)){var et=m9(H,g.dateNF,H.match(M)||[]);S=$i(et),g&&g.UTC===!1&&(S=hf(S))}else g&&g.UTC===!1?S=hf(S):g.cellText!==!1&&g.dateNF&&(P.w=Mo(P.z,S));g.cellDates?(P.t="d",P.v=S):(P.t="n",P.v=zr(S)),g.cellNF||delete P.z}else H.charCodeAt(0)==35&&Fa[H]!=null?(P.t="e",P.w=H,P.v=Fa[H]):(P.t="s",P.v=H);if(P.t=="z"||(g.dense?(y["!data"][b]||(y["!data"][b]=[]),y["!data"][b][E]=P):y[jn({c:E,r:b})]=P),T=O+1,I=d.charCodeAt(T),_.e.c<E&&(_.e.c=E),_.e.r<b&&(_.e.r=b),C==R)++E;else if(E=0,++b,g.sheetRows&&g.sheetRows<=b)return!0}t:for(;O<d.length;++O)switch(C=d.charCodeAt(O)){case 34:I===34&&(N=!N);break;case 13:if(N)break;d.charCodeAt(O+1)==10&&++O;case R:case 10:if(!N&&F())break t;break}return O-T>0&&F(),y["!ref"]=ur(_),y}function o(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,p):wf(t(d,p),p)}function l(d,p){var g="",v=p.type=="string"?[0,0,0,0]:BW(d,p);switch(p.type){case"base64":g=Ol(d);break;case"binary":g=d;break;case"buffer":p.codepage==65001?g=d.toString("utf8"):(p.codepage,g=cn&&Buffer.isBuffer(d)?d.toString("binary"):Nc(d));break;case"array":g=Rb(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=Yu(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=Yu(g):p.type=="binary",g.slice(0,19)=="socialcalc:version:"?MO.to_sheet(p.type=="string"?g:Yu(g),p):o(g,p)}function u(d,p){return Ef(l(d,p),p)}function h(d){var p=[];if(!d["!ref"])return"";for(var g=Nn(d["!ref"]),v,y=d["!data"]!=null,_=g.s.r;_<=g.e.r;++_){for(var b=[],E=g.s.c;E<=g.e.c;++E){var S=jn({r:_,c:E});if(v=y?(d["!data"][_]||[])[E]:d[S],!v||v.v==null){b.push("          ");continue}for(var T=(v.w||(Io(v),v.w)||"").slice(0,10);T.length<10;)T+=" ";b.push(T+(E===0?" ":""))}p.push(b.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:h}}(),dS=function(){function n(j,pt,lt){if(j){xi(j,j.l||0);for(var ut=lt.Enum||ct;j.l<j.length;){var Dt=j.read_shift(2),Lt=ut[Dt]||ut[65535],D=j.read_shift(2),dt=j.l+D,it=Lt.f&&Lt.f(j,D,lt);if(j.l=dt,pt(it,Lt,Dt))return}}}function t(j,pt){switch(pt.type){case"base64":return r(is(Ol(j)),pt);case"binary":return r(is(j),pt);case"buffer":case"array":return r(j,pt)}throw"Unsupported type "+pt.type}var e=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function r(j,pt){if(!j)return j;var lt=pt||{},ut={},Dt="Sheet1",Lt="",D=0,dt={},it=[],q=[],X=[];lt.dense&&(X=ut["!data"]=[]);var ft={s:{r:0,c:0},e:{r:0,c:0}},Pt=lt.sheetRows||0,zt={};if(j[4]==81&&j[5]==80&&j[6]==87)return Gt(j,pt);if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)lt.Enum=ct,n(j,function(xt,se,de){switch(de){case 0:lt.vers=xt,xt>=4096&&(lt.qpro=!0);break;case 255:lt.vers=xt,lt.works=!0;break;case 6:ft=xt;break;case 204:xt&&(Lt=xt);break;case 222:Lt=xt;break;case 15:case 51:(!lt.qpro&&!lt.works||de==51)&&xt[1].v.charCodeAt(0)<48&&(xt[1].v=xt[1].v.slice(1)),(lt.works||lt.works2)&&(xt[1].v=xt[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(xt[2]&112)==112&&(xt[2]&15)>1&&(xt[2]&15)<15&&(xt[1].z=lt.dateNF||e[(xt[2]&15)-1]||Rn[14],lt.cellDates&&(xt[1].v=Xu(xt[1].v),xt[1].t=typeof xt[1].v=="number"?"n":"d")),lt.qpro&&xt[3]>D&&(ut["!ref"]=ur(ft),dt[Dt]=ut,it.push(Dt),ut={},lt.dense&&(X=ut["!data"]=[]),ft={s:{r:0,c:0},e:{r:0,c:0}},D=xt[3],Dt=Lt||"Sheet"+(D+1),Lt="");var ae=lt.dense?(X[xt[0].r]||[])[xt[0].c]:ut[jn(xt[0])];if(ae){ae.t=xt[1].t,ae.v=xt[1].v,xt[1].z!=null&&(ae.z=xt[1].z),xt[1].f!=null&&(ae.f=xt[1].f),zt=ae;break}lt.dense?(X[xt[0].r]||(X[xt[0].r]=[]),X[xt[0].r][xt[0].c]=xt[1]):ut[jn(xt[0])]=xt[1],zt=xt[1];break;case 21509:lt.works2=!0;break;case 21506:xt==5281&&(zt.z="hh:mm:ss",lt.cellDates&&zt.t=="n"&&(zt.v=Xu(zt.v),zt.t=typeof zt.v=="number"?"n":"d"));break}},lt);else if(j[2]==26||j[2]==14)lt.Enum=gt,j[2]==14&&(lt.qpro=!0,j.l=0),n(j,function(xt,se,de){switch(de){case 204:Dt=xt;break;case 22:xt[1].v.charCodeAt(0)<48&&(xt[1].v=xt[1].v.slice(1)),xt[1].v=xt[1].v.replace(/\x0F./g,function(ae){return String.fromCharCode(ae.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(xt[3]>D&&(ut["!ref"]=ur(ft),dt[Dt]=ut,it.push(Dt),ut={},lt.dense&&(X=ut["!data"]=[]),ft={s:{r:0,c:0},e:{r:0,c:0}},D=xt[3],Dt="Sheet"+(D+1)),Pt>0&&xt[0].r>=Pt)break;lt.dense?(X[xt[0].r]||(X[xt[0].r]=[]),X[xt[0].r][xt[0].c]=xt[1]):ut[jn(xt[0])]=xt[1],ft.e.c<xt[0].c&&(ft.e.c=xt[0].c),ft.e.r<xt[0].r&&(ft.e.r=xt[0].r);break;case 27:xt[14e3]&&(q[xt[14e3][0]]=xt[14e3][1]);break;case 1537:q[xt[0]]=xt[1],xt[0]==D&&(Dt=xt[1]);break}},lt);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(ut["!ref"]=ur(ft),dt[Lt||Dt]=ut,it.push(Lt||Dt),!q.length)return{SheetNames:it,Sheets:dt};for(var bt={},Rt=[],qt=0;qt<q.length;++qt)dt[it[qt]]?(Rt.push(q[qt]||it[qt]),bt[q[qt]]=dt[q[qt]]||dt[it[qt]]):(Rt.push(q[qt]),bt[q[qt]]={"!ref":"A1"});return{SheetNames:Rt,Sheets:bt}}function i(j,pt){var lt=pt||{};if(+lt.codepage>=0&&Id(+lt.codepage),lt.type=="string")throw new Error("Cannot write WK1 to JS string");var ut=ni();if(!j["!ref"])throw new Error("Cannot export empty sheet to WK1");var Dt=Nn(j["!ref"]),Lt=j["!data"]!=null,D=[];Zt(ut,0,o(1030)),Zt(ut,6,h(Dt));for(var dt=Math.min(Dt.e.r,8191),it=Dt.s.c;it<=Dt.e.c;++it)D[it]=vn(it);for(var q=Dt.s.r;q<=dt;++q){var X=wn(q);for(it=Dt.s.c;it<=Dt.e.c;++it){var ft=Lt?(j["!data"][q]||[])[it]:j[D[it]+X];if(!(!ft||ft.t=="z"))switch(ft.t){case"n":(ft.v|0)==ft.v&&ft.v>=-32768&&ft.v<=32767?Zt(ut,13,b(q,it,ft)):Zt(ut,14,S(q,it,ft));break;case"d":var Pt=zr(ft.v);(Pt|0)==Pt&&Pt>=-32768&&Pt<=32767?Zt(ut,13,b(q,it,{v:Pt,z:ft.z||Rn[14]})):Zt(ut,14,S(q,it,{v:Pt,z:ft.z||Rn[14]}));break;default:var zt=Io(ft);Zt(ut,15,v(q,it,zt.slice(0,239)))}}}return Zt(ut,1),ut.end()}function s(j,pt){var lt=pt||{};if(+lt.codepage>=0&&Id(+lt.codepage),lt.type=="string")throw new Error("Cannot write WK3 to JS string");var ut=ni();Zt(ut,0,l(j));for(var Dt=0,Lt=0;Dt<j.SheetNames.length;++Dt)(j.Sheets[j.SheetNames[Dt]]||{})["!ref"]&&Zt(ut,27,V(j.SheetNames[Dt],Lt++));var D=0;for(Dt=0;Dt<j.SheetNames.length;++Dt){var dt=j.Sheets[j.SheetNames[Dt]];if(!(!dt||!dt["!ref"])){for(var it=Nn(dt["!ref"]),q=dt["!data"]!=null,X=[],ft=Math.min(it.e.r,8191),Pt=it.s.r;Pt<=ft;++Pt)for(var zt=wn(Pt),bt=it.s.c;bt<=it.e.c;++bt){Pt===it.s.r&&(X[bt]=vn(bt));var Rt=X[bt]+zt,qt=q?(dt["!data"][Pt]||[])[bt]:dt[Rt];if(!(!qt||qt.t=="z"))if(qt.t=="n")Zt(ut,23,et(Pt,bt,D,qt.v));else{var xt=Io(qt);Zt(ut,22,F(Pt,bt,D,xt.slice(0,239)))}}++D}}return Zt(ut,1),ut.end()}function o(j){var pt=It(2);return pt.write_shift(2,j),pt}function l(j){var pt=It(26);pt.write_shift(2,4096),pt.write_shift(2,4),pt.write_shift(4,0);for(var lt=0,ut=0,Dt=0,Lt=0;Lt<j.SheetNames.length;++Lt){var D=j.SheetNames[Lt],dt=j.Sheets[D];if(!(!dt||!dt["!ref"])){++Dt;var it=Ur(dt["!ref"]);lt<it.e.r&&(lt=it.e.r),ut<it.e.c&&(ut=it.e.c)}}return lt>8191&&(lt=8191),pt.write_shift(2,lt),pt.write_shift(1,Dt),pt.write_shift(1,ut),pt.write_shift(2,0),pt.write_shift(2,0),pt.write_shift(1,1),pt.write_shift(1,2),pt.write_shift(4,0),pt.write_shift(4,0),pt}function u(j,pt,lt){var ut={s:{c:0,r:0},e:{c:0,r:0}};return pt==8&&lt.qpro?(ut.s.c=j.read_shift(1),j.l++,ut.s.r=j.read_shift(2),ut.e.c=j.read_shift(1),j.l++,ut.e.r=j.read_shift(2),ut):(ut.s.c=j.read_shift(2),ut.s.r=j.read_shift(2),pt==12&&lt.qpro&&(j.l+=2),ut.e.c=j.read_shift(2),ut.e.r=j.read_shift(2),pt==12&&lt.qpro&&(j.l+=2),ut.s.c==65535&&(ut.s.c=ut.e.c=ut.s.r=ut.e.r=0),ut)}function h(j){var pt=It(8);return pt.write_shift(2,j.s.c),pt.write_shift(2,j.s.r),pt.write_shift(2,j.e.c),pt.write_shift(2,j.e.r),pt}function d(j,pt,lt){var ut=[{c:0,r:0},{t:"n",v:0},0,0];return lt.qpro&&lt.vers!=20768?(ut[0].c=j.read_shift(1),ut[3]=j.read_shift(1),ut[0].r=j.read_shift(2),j.l+=2):lt.works?(ut[0].c=j.read_shift(2),ut[0].r=j.read_shift(2),ut[2]=j.read_shift(2)):(ut[2]=j.read_shift(1),ut[0].c=j.read_shift(2),ut[0].r=j.read_shift(2)),ut}function p(j){return j.z&&kc(j.z)?240|(e.indexOf(j.z)+1||2):255}function g(j,pt,lt){var ut=j.l+pt,Dt=d(j,pt,lt);if(Dt[1].t="s",(lt.vers&65534)==20768){j.l++;var Lt=j.read_shift(1);return Dt[1].v=j.read_shift(Lt,"utf8"),Dt}return lt.qpro&&j.l++,Dt[1].v=j.read_shift(ut-j.l,"cstr"),Dt}function v(j,pt,lt){var ut=It(7+lt.length);ut.write_shift(1,255),ut.write_shift(2,pt),ut.write_shift(2,j),ut.write_shift(1,39);for(var Dt=0;Dt<ut.length;++Dt){var Lt=lt.charCodeAt(Dt);ut.write_shift(1,Lt>=128?95:Lt)}return ut.write_shift(1,0),ut}function y(j,pt,lt){var ut=j.l+pt,Dt=d(j,pt,lt);if(Dt[1].t="s",lt.vers==20768){var Lt=j.read_shift(1);return Dt[1].v=j.read_shift(Lt,"utf8"),Dt}return Dt[1].v=j.read_shift(ut-j.l,"cstr"),Dt}function _(j,pt,lt){var ut=d(j,pt,lt);return ut[1].v=j.read_shift(2,"i"),ut}function b(j,pt,lt){var ut=It(7);return ut.write_shift(1,p(lt)),ut.write_shift(2,pt),ut.write_shift(2,j),ut.write_shift(2,lt.v,"i"),ut}function E(j,pt,lt){var ut=d(j,pt,lt);return ut[1].v=j.read_shift(8,"f"),ut}function S(j,pt,lt){var ut=It(13);return ut.write_shift(1,p(lt)),ut.write_shift(2,pt),ut.write_shift(2,j),ut.write_shift(8,lt.v,"f"),ut}function T(j,pt,lt){var ut=j.l+pt,Dt=d(j,pt,lt);if(Dt[1].v=j.read_shift(8,"f"),lt.qpro)j.l=ut;else{var Lt=j.read_shift(2);C(j.slice(j.l,j.l+Lt),Dt),j.l+=Lt}return Dt}function O(j,pt,lt){var ut=pt&32768;return pt&=-32769,pt=(ut?j:0)+(pt>=8192?pt-16384:pt),(ut?"":"$")+(lt?vn(pt):wn(pt))}var R={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(j,pt){xi(j,0);for(var lt=[],ut=0,Dt="",Lt="",D="",dt="";j.l<j.length;){var it=j[j.l++];switch(it){case 0:lt.push(j.read_shift(8,"f"));break;case 1:Lt=O(pt[0].c,j.read_shift(2),!0),Dt=O(pt[0].r,j.read_shift(2),!1),lt.push(Lt+Dt);break;case 2:{var q=O(pt[0].c,j.read_shift(2),!0),X=O(pt[0].r,j.read_shift(2),!1);Lt=O(pt[0].c,j.read_shift(2),!0),Dt=O(pt[0].r,j.read_shift(2),!1),lt.push(q+X+":"+Lt+Dt)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:lt.push("("+lt.pop()+")");break;case 5:lt.push(j.read_shift(2));break;case 6:{for(var ft="";it=j[j.l++];)ft+=String.fromCharCode(it);lt.push('"'+ft.replace(/"/g,'""')+'"')}break;case 8:lt.push("-"+lt.pop());break;case 23:lt.push("+"+lt.pop());break;case 22:lt.push("NOT("+lt.pop()+")");break;case 20:case 21:dt=lt.pop(),D=lt.pop(),lt.push(["AND","OR"][it-20]+"("+D+","+dt+")");break;default:if(it<32&&N[it])dt=lt.pop(),D=lt.pop(),lt.push(D+N[it]+dt);else if(R[it]){if(ut=R[it][1],ut==69&&(ut=j[j.l++]),ut>lt.length){console.error("WK1 bad formula parse 0x"+it.toString(16)+":|"+lt.join("|")+"|");return}var Pt=lt.slice(-ut);lt.length-=ut,lt.push(R[it][0]+"("+Pt.join(",")+")")}else return it<=7?console.error("WK1 invalid opcode "+it.toString(16)):it<=24?console.error("WK1 unsupported op "+it.toString(16)):it<=30?console.error("WK1 invalid opcode "+it.toString(16)):it<=115?console.error("WK1 unsupported function opcode "+it.toString(16)):console.error("WK1 unrecognized opcode "+it.toString(16))}}lt.length==1?pt[1].f=""+lt[0]:console.error("WK1 bad formula parse |"+lt.join("|")+"|")}function I(j){var pt=[{c:0,r:0},{t:"n",v:0},0];return pt[0].r=j.read_shift(2),pt[3]=j[j.l++],pt[0].c=j[j.l++],pt}function M(j,pt){var lt=I(j);return lt[1].t="s",lt[1].v=j.read_shift(pt-4,"cstr"),lt}function F(j,pt,lt,ut){var Dt=It(6+ut.length);Dt.write_shift(2,j),Dt.write_shift(1,lt),Dt.write_shift(1,pt),Dt.write_shift(1,39);for(var Lt=0;Lt<ut.length;++Lt){var D=ut.charCodeAt(Lt);Dt.write_shift(1,D>=128?95:D)}return Dt.write_shift(1,0),Dt}function H(j,pt){var lt=I(j);lt[1].v=j.read_shift(2);var ut=lt[1].v>>1;if(lt[1].v&1)switch(ut&7){case 0:ut=(ut>>3)*5e3;break;case 1:ut=(ut>>3)*500;break;case 2:ut=(ut>>3)/20;break;case 3:ut=(ut>>3)/200;break;case 4:ut=(ut>>3)/2e3;break;case 5:ut=(ut>>3)/2e4;break;case 6:ut=(ut>>3)/16;break;case 7:ut=(ut>>3)/64;break}return lt[1].v=ut,lt}function P(j,pt){var lt=I(j),ut=j.read_shift(4),Dt=j.read_shift(4),Lt=j.read_shift(2);if(Lt==65535)return ut===0&&Dt===3221225472?(lt[1].t="e",lt[1].v=15):ut===0&&Dt===3489660928?(lt[1].t="e",lt[1].v=42):lt[1].v=0,lt;var D=Lt&32768;return Lt=(Lt&32767)-16446,lt[1].v=(1-D*2)*(Dt*Math.pow(2,Lt+32)+ut*Math.pow(2,Lt)),lt}function et(j,pt,lt,ut){var Dt=It(14);if(Dt.write_shift(2,j),Dt.write_shift(1,lt),Dt.write_shift(1,pt),ut==0)return Dt.write_shift(4,0),Dt.write_shift(4,0),Dt.write_shift(2,65535),Dt;var Lt=0,D=0,dt=0,it=0;return ut<0&&(Lt=1,ut=-ut),D=Math.log2(ut)|0,ut/=Math.pow(2,D-31),it=ut>>>0,(it&2147483648)==0&&(ut/=2,++D,it=ut>>>0),ut-=it,it|=2147483648,it>>>=0,ut*=Math.pow(2,32),dt=ut>>>0,Dt.write_shift(4,dt),Dt.write_shift(4,it),D+=16383+(Lt?32768:0),Dt.write_shift(2,D),Dt}function L(j,pt){var lt=P(j);return j.l+=pt-14,lt}function st(j,pt){var lt=I(j),ut=j.read_shift(4);return lt[1].v=ut>>6,lt}function Q(j,pt){var lt=I(j),ut=j.read_shift(8,"f");return lt[1].v=ut,lt}function Y(j,pt){var lt=Q(j);return j.l+=pt-12,lt}function Ot(j,pt){return j[j.l+pt-1]==0?j.read_shift(pt,"cstr"):""}function Et(j,pt){var lt=j[j.l++];lt>pt-1&&(lt=pt-1);for(var ut="";ut.length<lt;)ut+=String.fromCharCode(j[j.l++]);return ut}function z(j,pt,lt){if(!(!lt.qpro||pt<21)){var ut=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var Dt=j.read_shift(pt-21,"cstr");return[ut,Dt]}}function J(j,pt){for(var lt={},ut=j.l+pt;j.l<ut;){var Dt=j.read_shift(2);if(Dt==14e3){for(lt[Dt]=[0,""],lt[Dt][0]=j.read_shift(2);j[j.l];)lt[Dt][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return lt}function V(j,pt){var lt=It(5+j.length);lt.write_shift(2,14e3),lt.write_shift(2,pt);for(var ut=0;ut<j.length;++ut){var Dt=j.charCodeAt(ut);lt[lt.l++]=Dt>127?95:Dt}return lt[lt.l++]=0,lt}var ct={0:{n:"BOF",f:Mg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:y},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ot},222:{n:"SHEETNAMELP",f:Et},255:{n:"BOF",f:Mg},21506:{n:"WKSNF",f:Mg},65535:{n:""}},gt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:st},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ot},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},_t={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Bt(j){var pt=j.read_shift(2),lt=j.read_shift(1);if(lt!=0)throw"unsupported QPW string type "+lt.toString(16);return j.read_shift(pt,"sbcs-cont")}function Gt(j,pt){xi(j,0);var lt=pt||{},ut={};lt.dense&&(ut["!data"]=[]);var Dt=[],Lt="",D={s:{r:-1,c:-1},e:{r:-1,c:-1}},dt=0,it=0,q=0,X=0,ft={SheetNames:[],Sheets:{}},Pt=[];t:for(;j.l<j.length;){var zt=j.read_shift(2),bt=j.read_shift(2),Rt=j.slice(j.l,j.l+bt);switch(xi(Rt,0),zt){case 1:if(Rt.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break t;case 8:break;case 10:for(var qt=Rt.read_shift(4),xt=(Rt.length-Rt.l)/qt|0,se=0;se<qt;++se){var de=Rt.l+xt,ae={};Rt.l+=2,ae.numFmtId=Rt.read_shift(2),_t[ae.numFmtId]&&(ae.z=_t[ae.numFmtId]),Rt.l=de,Pt.push(ae)}break;case 1025:break;case 1026:break;case 1031:for(Rt.l+=12;Rt.l<Rt.length;)dt=Rt.read_shift(2),it=Rt.read_shift(1),Dt.push(Rt.read_shift(dt,"cstr"));break;case 1032:break;case 1537:{var ze=Rt.read_shift(2);ut={},lt.dense&&(ut["!data"]=[]),D.s.c=Rt.read_shift(2),D.e.c=Rt.read_shift(2),D.s.r=Rt.read_shift(4),D.e.r=Rt.read_shift(4),Rt.l+=4,Rt.l+2<Rt.length&&(dt=Rt.read_shift(2),it=Rt.read_shift(1),Lt=dt==0?"":Rt.read_shift(dt,"cstr")),Lt||(Lt=vn(ze))}break;case 1538:{if(D.s.c>255||D.s.r>999999)break;D.e.c<D.s.c&&(D.e.c=D.s.c),D.e.r<D.s.r&&(D.e.r=D.s.r),ut["!ref"]=ur(D),Xb(ft,ut,Lt)}break;case 2561:q=Rt.read_shift(2),D.e.c<q&&(D.e.c=q),D.s.c>q&&(D.s.c=q),X=Rt.read_shift(4),D.s.r>X&&(D.s.r=X),X=Rt.read_shift(4),D.e.r<X&&(D.e.r=X);break;case 3073:{X=Rt.read_shift(4),dt=Rt.read_shift(4),D.s.r>X&&(D.s.r=X),D.e.r<X+dt-1&&(D.e.r=X+dt-1);for(var Cn=vn(q);Rt.l<Rt.length;){var Se={t:"z"},_n=Rt.read_shift(1),qe=-1;_n&128&&(qe=Rt.read_shift(2));var yr=_n&64?Rt.read_shift(2)-1:0;switch(_n&31){case 0:break;case 1:break;case 2:Se={t:"n",v:Rt.read_shift(2)};break;case 3:Se={t:"n",v:Rt.read_shift(2,"i")};break;case 4:Se={t:"n",v:zb(Rt)};break;case 5:Se={t:"n",v:Rt.read_shift(8,"f")};break;case 7:Se={t:"s",v:Dt[it=Rt.read_shift(4)-1]};break;case 8:Se={t:"n",v:Rt.read_shift(8,"f")},Rt.l+=2,Rt.l+=4,isNaN(Se.v)&&(Se={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(_n&31)}qe!=-1&&(Pt[qe-1]||{}).z&&(Se.z=Pt[qe-1].z);var Bn=0;if(_n&32)switch(_n&31){case 2:Bn=Rt.read_shift(2);break;case 3:Bn=Rt.read_shift(2,"i");break;case 7:Bn=Rt.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(_n&31)}if(!(!lt.sheetStubs&&Se.t=="z")){var kn=ii(Se);Se.t=="n"&&Se.z&&kc(Se.z)&&lt.cellDates&&(kn.v=Xu(Se.v),kn.t=typeof kn.v=="number"?"n":"d"),ut["!data"]!=null?(ut["!data"][X]||(ut["!data"][X]=[]),ut["!data"][X][q]=kn):ut[Cn+wn(X)]=kn}for(++X,--dt;yr-- >0&&dt>=0;){if(_n&32)switch(_n&31){case 2:Se={t:"n",v:Se.v+Bn&65535};break;case 3:Se={t:"n",v:Se.v+Bn&65535},Se.v>32767&&(Se.v-=65536);break;case 7:Se={t:"s",v:Dt[it=it+Bn>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(_n&31)}else switch(_n&31){case 1:Se={t:"z"};break;case 2:Se={t:"n",v:Rt.read_shift(2)};break;case 7:Se={t:"s",v:Dt[it=Rt.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(_n&31)}!lt.sheetStubs&&Se.t=="z"||(ut["!data"]!=null?(ut["!data"][X]||(ut["!data"][X]=[]),ut["!data"][X][q]=Se):ut[Cn+wn(X)]=Se),++X,--dt}}}break;case 3074:{q=Rt.read_shift(2),X=Rt.read_shift(4);var ai=Bt(Rt);ut["!data"]!=null?(ut["!data"][X]||(ut["!data"][X]=[]),ut["!data"][X][q]={t:"s",v:ai}):ut[vn(q)+wn(X)]={t:"s",v:ai}}break}j.l+=bt}return ft}return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:t}}(),hH=/^\s|\s$|[\t\n\r]/;function dH(n,t){if(!t.bookSST)return"";var e=[fr];e[e.length]=re("sst",null,{xmlns:xf[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),typeof i.t!="string"&&(i.t=String(i.t)),i.t.match(hH)&&(s+=' xml:space="preserve"'),s+=">"+$e(i.t)+"</t>"),s+="</si>",e[e.length]=s}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function pH(n){return[n.read_shift(4),n.read_shift(4)]}function gH(n,t){return t||(t=It(8)),t.write_shift(4,n.Count),t.write_shift(4,n.Unique),t}var mH=nz;function vH(n){var t=ni();Yt(t,159,gH(n));for(var e=0;e<n.length;++e)Yt(t,19,mH(n[e]));return Yt(t,160),t.end()}function _H(n){for(var t=[],e=n.split(""),r=0;r<e.length;++r)t[r]=e[r].charCodeAt(0);return t}function IO(n){var t=0,e,r=_H(n),i=r.length+1,s,o,l,u,h;for(e=Rc(i),e[0]=r.length,s=1;s!=i;++s)e[s]=r[s-1];for(s=i-1;s>=0;--s)o=e[s],l=(t&16384)===0?0:1,u=t<<1&32767,h=l|u,t=h^o;return t^52811}function yH(n,t){var e=["{\\rtf1\\ansi"];if(!n["!ref"])return e[0]+"}";for(var r=Nn(n["!ref"]),i,s=n["!data"]!=null,o=[],l=r.s.r;l<=r.e.r;++l){e.push("\\trowd\\trautofit1");for(var u=r.s.c;u<=r.e.c;++u)e.push("\\cellx"+(u+1));for(e.push("\\pard\\intbl"),s&&(o=n["!data"][l]||[]),u=r.s.c;u<=r.e.c;++u){var h=jn({r:l,c:u});if(i=s?o[u]:n[h],!i||i.v==null&&(!i.f||i.F)){e.push(" \\cell");continue}e.push(" "+(i.w||(Io(i),i.w)||"").replace(/[\r\n]/g,"\\par ")),e.push("\\cell")}e.push("\\pard\\intbl\\row")}return e.join("")+"}"}function pS(n){for(var t=0,e=1;t!=3;++t)e=e*256+(n[t]>255?255:n[t]<0?0:n[t]);return e.toString(16).toUpperCase().slice(1)}var bH=6,Ro=bH;function lm(n){return Math.floor((n+Math.round(128/Ro)/256)*Ro)}function cm(n){return Math.floor((n-5)/Ro*100+.5)/100}function uy(n){return Math.round((n*Ro+5)/Ro*256)/256}function jb(n){n.width?(n.wpx=lm(n.width),n.wch=cm(n.wpx),n.MDW=Ro):n.wpx?(n.wch=cm(n.wpx),n.width=uy(n.wch),n.MDW=Ro):typeof n.wch=="number"&&(n.width=uy(n.wch),n.wpx=lm(n.width),n.MDW=Ro),n.customWidth&&delete n.customWidth}var xH=96,PO=xH;function um(n){return n*96/PO}function FO(n){return n*PO/96}function EH(n){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)n[r]!=null&&(t[t.length]=re("numFmt",null,{numFmtId:r,formatCode:$e(n[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=re("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function wH(n){var t=[];return t[t.length]=re("cellXfs",null),n.forEach(function(e){t[t.length]=re("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=re("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function AH(n,t){var e=[fr,re("styleSheet",null,{xmlns:xf[0],"xmlns:vt":Sr.vt})],r;return n.SSF&&(r=EH(n.SSF))!=null&&(e[e.length]=r),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=wH(t.cellXfs))&&(e[e.length]=r),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function SH(n,t){var e=n.read_shift(2),r=ri(n);return[e,r]}function TH(n,t,e){e||(e=It(6+4*t.length)),e.write_shift(2,n),_r(t,e);var r=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),r}function CH(n,t,e){var r={};r.sz=n.read_shift(2)/20;var i=cz(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=n.read_shift(1);o!=0&&(r.underline=o);var l=n.read_shift(1);l>0&&(r.family=l);var u=n.read_shift(1);switch(u>0&&(r.charset=u),n.l++,r.color=lz(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ri(n),r}function DH(n,t){t||(t=It(25+4*32)),t.write_shift(2,n.sz*20),uz(n,t),t.write_shift(2,n.bold?700:400);var e=0;n.vertAlign=="superscript"?e=1:n.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,n.underline||0),t.write_shift(1,n.family||0),t.write_shift(1,n.charset||0),t.write_shift(1,0),am(n.color,t);var r=0;return r=2,t.write_shift(1,r),_r(n.name,t),t.length>t.l?t.slice(0,t.l):t}var OH=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],C_,RH=Ha;function gS(n,t){t||(t=It(4*3+8*7+16*1)),C_||(C_=Ob(OH));var e=C_[n.patternType];e==null&&(e=40),t.write_shift(4,e);var r=0;if(e!=40)for(am({auto:1},t),am({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function NH(n,t){var e=n.l+t,r=n.read_shift(2),i=n.read_shift(2);return n.l=e,{ixfe:r,numFmtId:i}}function BO(n,t,e){e||(e=It(16)),e.write_shift(2,t||0),e.write_shift(2,n.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var r=0;return e.write_shift(1,r),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function ed(n,t){return t||(t=It(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var kH=Ha;function LH(n,t){return t||(t=It(51)),t.write_shift(1,0),ed(null,t),ed(null,t),ed(null,t),ed(null,t),ed(null,t),t.length>t.l?t.slice(0,t.l):t}function MH(n,t){return t||(t=It(12+4*10)),t.write_shift(4,n.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),zd(n.name||"",t),t.length>t.l?t.slice(0,t.l):t}function IH(n,t,e){var r=It(2052);return r.write_shift(4,n),zd(t,r),zd(e,r),r.length>r.l?r.slice(0,r.l):r}function PH(n,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++e}),e!=0&&(Yt(n,615,ra(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Yt(n,44,TH(i,t[i]))}),Yt(n,616))}}function FH(n){var t=1;Yt(n,611,ra(t)),Yt(n,43,DH({sz:12,color:{theme:1},name:"Calibri",family:2})),Yt(n,612)}function BH(n){var t=2;Yt(n,603,ra(t)),Yt(n,45,gS({patternType:"none"})),Yt(n,45,gS({patternType:"gray125"})),Yt(n,604)}function UH(n){var t=1;Yt(n,613,ra(t)),Yt(n,46,LH()),Yt(n,614)}function zH(n){var t=1;Yt(n,626,ra(t)),Yt(n,47,BO({numFmtId:0},65535)),Yt(n,627)}function HH(n,t){Yt(n,617,ra(t.length)),t.forEach(function(e){Yt(n,47,BO(e,0))}),Yt(n,618)}function jH(n){var t=1;Yt(n,619,ra(t)),Yt(n,48,MH({xfId:0,name:"Normal"})),Yt(n,620)}function $H(n){var t=0;Yt(n,505,ra(t)),Yt(n,506)}function GH(n){var t=0;Yt(n,508,IH(t,"TableStyleMedium9","PivotStyleMedium4")),Yt(n,509)}function VH(n,t){var e=ni();return Yt(e,278),PH(e,n.SSF),FH(e),BH(e),UH(e),zH(e),HH(e,t.cellXfs),jH(e),$H(e),GH(e),Yt(e,279),e.end()}function UO(n,t){if(t&&t.themeXLSX)return t.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var e=[fr];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function WH(n,t){return{flags:n.read_shift(4),version:n.read_shift(4),name:ri(n)}}function XH(n){var t=It(12+2*n.name.length);return t.write_shift(4,n.flags),t.write_shift(4,n.version),_r(n.name,t),t.slice(0,t.l)}function YH(n){for(var t=[],e=n.read_shift(4);e-- >0;)t.push([n.read_shift(4),n.read_shift(4)]);return t}function qH(n){var t=It(4+8*n.length);t.write_shift(4,n.length);for(var e=0;e<n.length;++e)t.write_shift(4,n[e][0]),t.write_shift(4,n[e][1]);return t}function KH(n,t){var e=It(8+2*t.length);return e.write_shift(4,n),_r(t,e),e.slice(0,e.l)}function ZH(n){return n.l+=4,n.read_shift(4)!=0}function QH(n,t){var e=It(8);return e.write_shift(4,n),e.write_shift(4,1),e}function JH(){var n=ni();return Yt(n,332),Yt(n,334,ra(1)),Yt(n,335,XH({name:"XLDAPR",version:12e4,flags:3496657072})),Yt(n,336),Yt(n,339,KH(1,"XLDAPR")),Yt(n,52),Yt(n,35,ra(514)),Yt(n,4096,ra(0)),Yt(n,4097,Rs(1)),Yt(n,36),Yt(n,53),Yt(n,340),Yt(n,337,QH(1)),Yt(n,51,qH([[1,0]])),Yt(n,338),Yt(n,333),n.end()}function tj(){var n=[fr];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function ej(n){var t={};t.i=n.read_shift(4);var e={};e.r=n.read_shift(4),e.c=n.read_shift(4),t.r=jn(e);var r=n.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function zO(n,t,e){var r=[21600,21600],i=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[re("xml",null,{"xmlns:v":ss.v,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:mv":ss.mv}).replace(/\/>/,">"),re("o:shapelayout",re("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"})],o=65536*n,l=t||[];return l.length>0&&s.push(re("v:shapetype",[re("v:stroke",null,{joinstyle:"miter"}),re("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:r.join(","),"o:spt":202,path:i})),l.forEach(function(u){++o,s.push(nj(u,o))}),s.push("</xml>"),s.join("")}function nj(n,t,e){var r=Fn(n[0]),i={color2:"#BEFF82",type:"gradient"};i.type=="gradient"&&(i.angle="-180");var s=i.type=="gradient"?re("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=re("v:fill",s,i),l={on:"t",obscured:"t"};return["<v:shape"+Fd({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,re("v:shadow",null,l),re("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Fr("x:Anchor",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(",")),Fr("x:AutoFill","False"),Fr("x:Row",String(r.r)),Fr("x:Column",String(r.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function rj(n){var t=[fr,re("comments",null,{xmlns:xf[0]})],e=[];return t.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=$e(i.a);e.indexOf(s)==-1&&(e.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),n.forEach(function(r){var i=0,s=[],o=0;if(r[1][0]&&r[1][0].T&&r[1][0].ID&&(i=e.indexOf("tc="+r[1][0].ID)),r[1].forEach(function(h){h.a&&(i=e.indexOf($e(h.a))),h.T&&++o,s.push(h.t==null?"":$e(h.t))}),o===0)r[1].forEach(function(h){t.push('<comment ref="'+r[0]+'" authorId="'+e.indexOf($e(h.a))+'"><text>'),t.push(Fr("t",h.t==null?"":$e(h.t))),t.push("</text></comment>")});else{r[1][0]&&r[1][0].T&&r[1][0].ID&&(i=e.indexOf("tc="+r[1][0].ID)),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>');for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;t.push(Fr("t",$e(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function HO(n,t,e){var r=[fr,re("ThreadedComments",null,{xmlns:Sr.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var u={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};l==0?s=u.id:u.parentId=s,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(re("threadedComment",Fr("text",o.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function jO(n){var t=[fr,re("personList",null,{xmlns:Sr.TCMNT,"xmlns:x":xf[0]}).replace(/[\/]>/,">")];return n.forEach(function(e,r){t.push(re("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function ij(n){var t={};t.iauthor=n.read_shift(4);var e=$c(n);return t.rfx=e.s,t.ref=jn(e.s),n.l+=16,t}function sj(n,t){return t==null&&(t=It(36)),t.write_shift(4,n[1].iauthor),Af(n[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var aj=ri;function mS(n){return _r(n.slice(0,54))}function oj(n){var t=ni(),e=[];return Yt(t,628),Yt(t,630),n.forEach(function(r){r[1].forEach(function(i){e.indexOf(i.a)>-1||(e.push(i.a.slice(0,54)),Yt(t,632,mS(i.a)),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),Yt(t,632,mS("tc="+i.ID))))})}),Yt(t,631),Yt(t,633),n.forEach(function(r){r[1].forEach(function(i){var s=-1;i.ID&&(s=e.indexOf("tc="+i.ID)),s==-1&&r[1][0].T&&r[1][0].ID&&(s=e.indexOf("tc="+r[1][0].ID)),s==-1&&(s=e.indexOf(i.a)),i.iauthor=s;var o={s:Fn(r[0]),e:Fn(r[0])};Yt(t,635,sj([o,i])),i.t&&i.t.length>0&&Yt(t,637,iz(i)),Yt(t,636),delete i.iauthor})}),Yt(t,634),Yt(t,629),t.end()}function lj(n,t){t.FullPaths.forEach(function(e,r){if(r!=0){var i=e.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Tn.utils.cfb_add(n,i,t.FileIndex[r].content)}})}var cj=["xlsb","xlsm","xlam","biff8","xla"],vS=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(r,i,s,o){var l=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,u?h+=t.r:--h,i+(l?"":"$")+vn(d)+(u?"":"$")+wn(h)}return function(i,s){return t=s,i.replace(n,e)}}(),Km=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{Km=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var Zm=function(){return function(t,e){return t.replace(Km,function(r,i,s,o,l,u){var h=Fb(o)-(s?0:e.c),d=Pb(u)-(l?0:e.r),p=l=="$"?d+1:d==0?"":"["+d+"]",g=s=="$"?h+1:h==0?"":"["+h+"]";return i+"R"+p+"C"+g})}}();function uj(n,t){return n.replace(Km,function(e,r,i,s,o,l){return r+(i=="$"?i+s:vn(Fb(s)+t.c))+(o=="$"?o+l:wn(Pb(l)+t.r))})}function fj(n){return n.length!=1}function sr(n){n.l+=1}function Rl(n,t){var e=n.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function $O(n,t,e){var r=2;if(e){if(e.biff>=2&&e.biff<=5)return GO(n);e.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),o=Rl(n),l=Rl(n);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function GO(n){var t=Rl(n),e=Rl(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function hj(n,t,e){if(e.biff<8)return GO(n);var r=n.read_shift(e.biff==12?4:2),i=n.read_shift(e.biff==12?4:2),s=Rl(n),o=Rl(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function VO(n,t,e){if(e&&e.biff>=2&&e.biff<=5)return dj(n);var r=n.read_shift(e&&e.biff==12?4:2),i=Rl(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function dj(n){var t=Rl(n),e=n.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function pj(n){var t=n.read_shift(2),e=n.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function gj(n,t,e){var r=e&&e.biff?e.biff:8;if(r>=2&&r<=5)return mj(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function mj(n){var t=n.read_shift(2),e=n.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:i,rRel:r}}function vj(n,t,e){var r=(n[n.l++]&96)>>5,i=$O(n,e.biff>=2&&e.biff<=5?6:8,e);return[r,i]}function _j(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var o=$O(n,s,e);return[r,i,o]}function yj(n,t,e){var r=(n[n.l++]&96)>>5;return n.l+=e&&e.biff>8?12:e.biff<8?6:8,[r]}function bj(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function xj(n,t,e){var r=(n[n.l++]&96)>>5,i=hj(n,t-1,e);return[r,i]}function Ej(n,t,e){var r=(n[n.l++]&96)>>5;return n.l+=e.biff==2?6:e.biff==12?14:7,[r]}function _S(n){var t=n[n.l+1]&1,e=1;return n.l+=4,[t,e]}function wj(n,t,e){n.l+=2;for(var r=n.read_shift(e&&e.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(e&&e.biff==2?1:2));return i}function Aj(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(e&&e.biff==2?1:2)]}function Sj(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(e&&e.biff==2?1:2)]}function Tj(n){var t=n[n.l+1]&255?1:0;return n.l+=2,[t,n.read_shift(2)]}function Cj(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=e&&e.biff==2?3:4,[r]}function WO(n){var t=n.read_shift(1),e=n.read_shift(1);return[t,e]}function Dj(n){return n.read_shift(2),WO(n)}function Oj(n){return n.read_shift(2),WO(n)}function Rj(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=VO(n,0,e);return[r,i]}function Nj(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=gj(n,0,e);return[r,i]}function kj(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);e&&e.biff==5&&(n.l+=12);var s=VO(n,0,e);return[r,i,s]}function Lj(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(e&&e.biff<=3?1:2);return[G$[i],qO[i],r]}function Mj(n,t,e){var r=n[n.l++],i=n.read_shift(1),s=e&&e.biff<=3?[r==88?-1:0,n.read_shift(1)]:Ij(n);return[i,(s[0]===0?qO:$$)[s[1]]]}function Ij(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function Pj(n,t,e){n.l+=e&&e.biff==2?3:4}function Fj(n,t,e){if(n.l++,e&&e.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function Bj(n){return n.l++,Ti[n.read_shift(1)]}function Uj(n){return n.l++,n.read_shift(2)}function zj(n){return n.l++,n.read_shift(1)!==0}function Hj(n){return n.l++,Sf(n)}function jj(n,t,e){return n.l++,RO(n,t-1,e)}function $j(n,t){var e=[n.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Dz(n,1)?"TRUE":"FALSE",t!=12&&(n.l+=7);break;case 37:case 16:e[1]=Ti[n[n.l]],n.l+=t==12?4:8;break;case 0:n.l+=8;break;case 1:e[1]=Sf(n);break;case 2:e[1]=kz(n,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function Gj(n,t,e){for(var r=n.read_shift(e.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((e.biff==12?$c:Iz)(n));return i}function Vj(n,t,e){var r=0,i=0;e.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),e.biff>=2&&e.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=$j(n,e.biff);return o}function Wj(n,t,e){var r=n.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,s=n.read_shift(i);switch(e.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function Xj(n,t,e){if(e.biff==5)return Yj(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function Yj(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[t,e,r]}function qj(n,t,e){var r=n.read_shift(1)>>>5&3;n.l+=e&&e.biff==2?3:4;var i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function Kj(n,t,e){var r=n.read_shift(1)>>>5&3,i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function Zj(n,t,e){var r=n.read_shift(1)>>>5&3;return n.l+=4,e.biff<8&&n.l--,e.biff==12&&(n.l+=2),[r]}function Qj(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(e)switch(e.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var Jj=Ha,t$=Ha,e$=Ha;function u0(n,t,e){return n.l+=2,[pj(n)]}function $b(n){return n.l+=6,[]}var n$=u0,r$=$b,i$=$b,s$=u0;function XO(n){return n.l+=2,[Mg(n),n.read_shift(2)&1]}var a$=u0,o$=XO,l$=$b,c$=u0,u$=u0,f$=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function h$(n){n.l+=2;var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),o=f$[e>>2&31];return{ixti:t,coltype:e&3,rt:o,idx:r,c:i,C:s}}function d$(n){return n.l+=2,[n.read_shift(4)]}function p$(n,t,e){return n.l+=5,n.l+=2,n.l+=e.biff==2?1:4,["PTGSHEET"]}function g$(n,t,e){return n.l+=e.biff==2?4:5,["PTGENDSHEET"]}function m$(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function v$(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function _$(n){return n.l+=4,[0,0]}var yS={1:{n:"PtgExp",f:Fj},2:{n:"PtgTbl",f:e$},3:{n:"PtgAdd",f:sr},4:{n:"PtgSub",f:sr},5:{n:"PtgMul",f:sr},6:{n:"PtgDiv",f:sr},7:{n:"PtgPower",f:sr},8:{n:"PtgConcat",f:sr},9:{n:"PtgLt",f:sr},10:{n:"PtgLe",f:sr},11:{n:"PtgEq",f:sr},12:{n:"PtgGe",f:sr},13:{n:"PtgGt",f:sr},14:{n:"PtgNe",f:sr},15:{n:"PtgIsect",f:sr},16:{n:"PtgUnion",f:sr},17:{n:"PtgRange",f:sr},18:{n:"PtgUplus",f:sr},19:{n:"PtgUminus",f:sr},20:{n:"PtgPercent",f:sr},21:{n:"PtgParen",f:sr},22:{n:"PtgMissArg",f:sr},23:{n:"PtgStr",f:jj},26:{n:"PtgSheet",f:p$},27:{n:"PtgEndSheet",f:g$},28:{n:"PtgErr",f:Bj},29:{n:"PtgBool",f:zj},30:{n:"PtgInt",f:Uj},31:{n:"PtgNum",f:Hj},32:{n:"PtgArray",f:Ej},33:{n:"PtgFunc",f:Lj},34:{n:"PtgFuncVar",f:Mj},35:{n:"PtgName",f:Wj},36:{n:"PtgRef",f:Rj},37:{n:"PtgArea",f:vj},38:{n:"PtgMemArea",f:qj},39:{n:"PtgMemErr",f:Jj},40:{n:"PtgMemNoMem",f:t$},41:{n:"PtgMemFunc",f:Kj},42:{n:"PtgRefErr",f:Zj},43:{n:"PtgAreaErr",f:yj},44:{n:"PtgRefN",f:Nj},45:{n:"PtgAreaN",f:xj},46:{n:"PtgMemAreaN",f:m$},47:{n:"PtgMemNoMemN",f:v$},57:{n:"PtgNameX",f:Xj},58:{n:"PtgRef3d",f:kj},59:{n:"PtgArea3d",f:_j},60:{n:"PtgRefErr3d",f:Qj},61:{n:"PtgAreaErr3d",f:bj},255:{}},y$={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},b$={1:{n:"PtgElfLel",f:XO},2:{n:"PtgElfRw",f:c$},3:{n:"PtgElfCol",f:n$},6:{n:"PtgElfRwV",f:u$},7:{n:"PtgElfColV",f:s$},10:{n:"PtgElfRadical",f:a$},11:{n:"PtgElfRadicalS",f:l$},13:{n:"PtgElfColS",f:r$},15:{n:"PtgElfColSV",f:i$},16:{n:"PtgElfRadicalLel",f:o$},25:{n:"PtgList",f:h$},29:{n:"PtgSxName",f:d$},255:{}},x$={0:{n:"PtgAttrNoop",f:_$},1:{n:"PtgAttrSemi",f:Cj},2:{n:"PtgAttrIf",f:Sj},4:{n:"PtgAttrChoose",f:wj},8:{n:"PtgAttrGoto",f:Aj},16:{n:"PtgAttrSum",f:Pj},32:{n:"PtgAttrBaxcel",f:_S},33:{n:"PtgAttrBaxcel",f:_S},64:{n:"PtgAttrSpace",f:Dj},65:{n:"PtgAttrSpaceSemi",f:Oj},128:{n:"PtgAttrIfError",f:Tj},255:{}};function E$(n,t,e,r){if(r.biff<8)return Ha(n,t);for(var i=n.l+t,s=[],o=0;o!==e.length;++o)switch(e[o][0]){case"PtgArray":e[o][1]=Vj(n,0,r),s.push(e[o][1]);break;case"PtgMemArea":e[o][2]=Gj(n,e[o][1],r),s.push(e[o][2]);break;case"PtgExp":r&&r.biff==12&&(e[o][1][1]=n.read_shift(4),s.push(e[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[o][0]}return t=i-n.l,t!==0&&s.push(Ha(n,t)),s}function w$(n,t,e){for(var r=n.l+t,i,s,o=[];r!=n.l;)t=r-n.l,s=n[n.l],i=yS[s]||yS[y$[s]],(s===24||s===25)&&(i=(s===24?b$:x$)[n[n.l+1]]),!i||!i.f?Ha(n,t):o.push([i.n,i.f(n,t,e)]);return o}function A$(n){for(var t=[],e=0;e<n.length;++e){for(var r=n[e],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var S$={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function T$(n,t){var e=n.lastIndexOf("!"),r=t.lastIndexOf("!");return e==-1&&r==-1?n+":"+t:e>0&&r>0&&n.slice(0,e).toLowerCase()==t.slice(0,r).toLowerCase()?n+":"+t.slice(r+1):(console.error("Cannot hydrate range",n,t),n+":"+t)}function YO(n,t,e){if(!n)return"SH33TJSERR0";if(e.biff>8&&(!n.XTI||!n.XTI[t]))return n.SheetNames[t];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":n.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(e.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return e.SID!=null?n.SheetNames[e.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function bS(n,t,e){var r=YO(n,t,e);return r=="#REF"?r:Ud(r,e)}function df(n,t,e,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],u,h,d,p=0,g=0,v,y="";if(!n[0]||!n[0][0])return"";for(var _=-1,b="",E=0,S=n[0].length;E<S;++E){var T=n[0][E];switch(T[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),h=l.pop(),_>=0){switch(n[0][_][1][0]){case 0:b=Pn(" ",n[0][_][1][1]);break;case 1:b=Pn("\r",n[0][_][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}h=h+b,_=-1}l.push(h+S$[T[0]]+u);break;case"PtgIsect":u=l.pop(),h=l.pop(),l.push(h+" "+u);break;case"PtgUnion":u=l.pop(),h=l.pop(),l.push(h+","+u);break;case"PtgRange":u=l.pop(),h=l.pop(),l.push(T$(h,u));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=vd(T[1][1],o,i),l.push(_d(d,s));break;case"PtgRefN":d=e?vd(T[1][1],e,i):T[1][1],l.push(_d(d,s));break;case"PtgRef3d":p=T[1][1],d=vd(T[1][2],o,i),y=bS(r,p,i),l.push(y+"!"+_d(d,s));break;case"PtgFunc":case"PtgFuncVar":var O=T[1][0],R=T[1][1];O||(O=0),O&=127;var N=O==0?[]:l.slice(-O);l.length-=O,R==="User"&&(R=N.shift()),l.push(R+"("+N.join(",")+")");break;case"PtgBool":l.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(T[1]);break;case"PtgNum":l.push(String(T[1]));break;case"PtgStr":l.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(T[1]);break;case"PtgAreaN":v=eS(T[1][1],e?{s:e}:o,i),l.push(w_(v,i));break;case"PtgArea":v=eS(T[1][1],o,i),l.push(w_(v,i));break;case"PtgArea3d":p=T[1][1],v=T[1][2],y=bS(r,p,i),l.push(y+"!"+w_(v,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=T[1][2];var C=(r.names||[])[g-1]||(r[0]||[])[g],I=C?C.Name:"SH33TJSNAME"+String(g);I&&I.slice(0,6)=="_xlfn."&&!i.xlfn&&(I=I.slice(6)),l.push(I);break;case"PtgNameX":var M=T[1][1];g=T[1][2];var F;if(i.biff<=5)M<0&&(M=-M),r[M]&&(F=r[M][g]);else{var H="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][g]&&r[M][g].itab>0&&(H=r.SheetNames[r[M][g].itab-1]+"!"):H=r.SheetNames[g-1]+"!"),r[M]&&r[M][g])H+=r[M][g].Name;else if(r[0]&&r[0][g])H+=r[0][g].Name;else{var P=(YO(r,M,i)||"").split(";;");P[g-1]?H=P[g-1]:H+="SH33TJSERRX"}l.push(H);break}F||(F={Name:"SH33TJSERRY"}),l.push(F.Name);break;case"PtgParen":var et="(",L=")";if(_>=0){switch(b="",n[0][_][1][0]){case 2:et=Pn(" ",n[0][_][1][1])+et;break;case 3:et=Pn("\r",n[0][_][1][1])+et;break;case 4:L=Pn(" ",n[0][_][1][1])+L;break;case 5:L=Pn("\r",n[0][_][1][1])+L;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}l.push(et+l.pop()+L);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:T[1][1],r:T[1][0]};var st={c:e.c,r:e.r};if(r.sharedf[jn(d)]){var Q=r.sharedf[jn(d)];l.push(df(Q,o,st,r,i))}else{var Y=!1;for(u=0;u!=r.arrayf.length;++u)if(h=r.arrayf[u],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){l.push(df(h[1],o,st,r,i)),Y=!0;break}Y||l.push(T[1])}break;case"PtgArray":l.push("{"+A$(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var Ot=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&Ot.indexOf(n[0][E][0])==-1){T=n[0][_];var Et=!0;switch(T[1][0]){case 4:Et=!1;case 0:b=Pn(" ",T[1][1]);break;case 5:Et=!1;case 1:b=Pn("\r",T[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}l.push((Et?b:"")+l.pop()+(Et?"":b)),_=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function C$(n){if(n==null){var t=It(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof n=="number")return Lc(n);return Lc(0)}function D$(n,t,e,r,i){var s=Mc(t,e,i),o=C$(n.v),l=It(6),u=33;l.write_shift(2,u),l.write_shift(4,0);for(var h=It(n.bf.length),d=0;d<n.bf.length;++d)h[d]=n.bf[d];var p=lr([s,o,l,h]);return p}function Qm(n,t,e){var r=n.read_shift(4),i=w$(n,r,e),s=n.read_shift(4),o=s>0?E$(n,s,i,e):null;return[i,o]}var O$=Qm,Jm=Qm,R$=Qm,N$=Qm;function xS(n){if((n|0)==n&&n<Math.pow(2,16)&&n>=0){var t=It(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,n),t.write_shift(4,0),t}var e=It(17);return e.write_shift(4,11),e.write_shift(1,31),e.write_shift(8,n),e.write_shift(4,0),e}function k$(n){var t=It(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,n),t.write_shift(4,0),t}function L$(n){var t=It(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,n?1:0),t.write_shift(4,0),t}function M$(n){var t=It(7);t.write_shift(4,3+2*n.length),t.write_shift(1,23),t.write_shift(2,n.length);var e=It(2*n.length);e.write_shift(2*n.length,n,"utf16le");var r=It(4);return r.write_shift(4,0),lr([t,e,r])}function I$(n){var t=Fn(n),e=It(15);return e.write_shift(4,7),e.write_shift(1,36),e.write_shift(4,t.r),e.write_shift(2,t.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),e.write_shift(4,0),e}function P$(n,t){var e=n.lastIndexOf("!"),r=n.slice(0,e);n=n.slice(e+1);var i=Fn(n);r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var s=It(17);return s.write_shift(4,9),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(r.toLowerCase())),s.write_shift(4,i.r),s.write_shift(2,i.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s}function F$(n,t){var e=n.lastIndexOf("!"),r=n.slice(0,e);n=n.slice(e+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=It(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(r.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}function B$(n){var t=n.split(":"),e=t[0],r=It(23);r.write_shift(4,15),e=t[0];var i=Fn(e);return r.write_shift(1,36),r.write_shift(4,i.r),r.write_shift(2,i.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),e=t[1],i=Fn(e),r.write_shift(1,36),r.write_shift(4,i.r),r.write_shift(2,i.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r.write_shift(1,17),r.write_shift(4,0),r}function U$(n,t){var e=n.lastIndexOf("!"),r=n.slice(0,e);n=n.slice(e+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=n.split(":"),s=It(27);s.write_shift(4,19);var o=i[0],l=Fn(o);return s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(u){return u.toLowerCase()}).indexOf(r.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|(o.charAt(0)=="$"?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),o=i[1],l=Fn(o),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(u){return u.toLowerCase()}).indexOf(r.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|(o.charAt(0)=="$"?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),s.write_shift(1,17),s.write_shift(4,0),s}function z$(n,t){var e=n.lastIndexOf("!"),r=n.slice(0,e);n=n.slice(e+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=Ur(n),s=It(23);return s.write_shift(4,15),s.write_shift(1,59),s.write_shift(2,2+t.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(r.toLowerCase())),s.write_shift(4,i.s.r),s.write_shift(4,i.e.r),s.write_shift(2,i.s.c),s.write_shift(2,i.e.c),s.write_shift(4,0),s}function H$(n,t){if(typeof n=="number")return xS(n);if(typeof n=="boolean")return L$(n);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(n))return k$(+Fa[n]);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return I$(n);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return B$(n);if(n.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return z$(n,t);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return P$(n,t);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return U$(n,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(n))return F$(n,t);if(/^".*"$/.test(n))return M$(n);if(/^[+-]\d+$/.test(n))return xS(parseInt(n,10));throw"Formula |"+n+"| not supported for XLSB"}var j$=H$,$$={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},qO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},G$={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function V$(n){var t="of:="+n.replace(Km,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function KO(n){return n.replace(/!/,".").replace(/:/,":.")}var yd=typeof Map<"u";function Gb(n,t,e){var r=0,i=n.length;if(e){if(yd?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var s=yd?e.get(t):e[t];r<s.length;++r)if(n[s[r]].t===t)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===t)return n.Count++,r;return n[i]={t},n.Count++,n.Unique++,e&&(yd?(e.has(t)||e.set(t,[]),e.get(t).push(i)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(i))),i}function t1(n,t){var e={min:n+1,max:n+1},r=-1;return t.MDW&&(Ro=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?r=cm(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(e.width=uy(r),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function ZO(n,t){if(n){var e=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=e[0]),n.right==null&&(n.right=e[1]),n.top==null&&(n.top=e[2]),n.bottom==null&&(n.bottom=e[3]),n.header==null&&(n.header=e[4]),n.footer==null&&(n.footer=e[5])}}function Il(n,t,e){var r=e.revssf[t.z!=null?t.z:"General"],i=60,s=n.length;if(r==null&&e.ssf){for(;i<392;++i)if(e.ssf[i]==null){_9(t.z,i),e.ssf[i]=t.z,e.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function W$(n,t,e){if(n&&n["!ref"]){var r=Nn(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+e+"): "+n["!ref"])}}function X$(n){if(n.length===0)return"";for(var t='<mergeCells count="'+n.length+'">',e=0;e!=n.length;++e)t+='<mergeCell ref="'+ur(n[e])+'"/>';return t+"</mergeCells>"}function Y$(n,t,e,r,i){var s=!1,o={},l=null;if(r.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[e];try{t.Workbook&&(u=t.Workbook.Sheets[e].CodeName||u)}catch{}s=!0,o.codeName=Pd($e(u))}if(n&&n["!outline"]){var h={summaryBelow:1,summaryRight:1};n["!outline"].above&&(h.summaryBelow=0),n["!outline"].left&&(h.summaryRight=0),l=(l||"")+re("outlinePr",null,h)}!s&&!l||(i[i.length]=re("sheetPr",l,o))}var q$=["objects","scenarios","selectLockedCells","selectUnlockedCells"],K$=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Z$(n){var t={sheet:1};return q$.forEach(function(e){n[e]!=null&&n[e]&&(t[e]="1")}),K$.forEach(function(e){n[e]!=null&&!n[e]&&(t[e]="0")}),n.password&&(t.password=IO(n.password).toString(16).toUpperCase()),re("sheetProtection",null,t)}function Q$(n){return ZO(n),re("pageMargins",null,n)}function J$(n,t){for(var e=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(e[e.length]=re("col",null,t1(i,r)));return e[e.length]="</cols>",e.join("")}function tG(n,t,e,r){var i=typeof n.ref=="string"?n.ref:ur(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,o=Ur(i);o.s.r==o.e.r&&(o.e.r=Ur(t["!ref"]).e.r,i=ur(o));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref=Ud(e.SheetNames[r])+"!"+Bd(i);break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+e.SheetNames[r]+"'!"+i}),re("autoFilter",null,{ref:i})}function eG(n,t,e,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),re("sheetViews",re("sheetView",null,i),{})}function nG(n,t,e,r,i,s,o){if(n.c&&e["!comments"].push([t,n.c]),(n.v===void 0||n.t==="z"&&!(r||{}).sheetStubs)&&typeof n.f!="string"&&typeof n.z>"u")return"";var l="",u=n.t,h=n.v;if(n.t!=="z")switch(n.t){case"b":l=n.v?"1":"0";break;case"n":isNaN(n.v)?(n.t="e",l=Ti[n.v=36]):isFinite(n.v)?l=""+n.v:(n.t="e",l=Ti[n.v=7]);break;case"e":l=Ti[n.v];break;case"d":if(r&&r.cellDates){var d=$i(n.v,o);l=d.toISOString(),d.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else n=ii(n),n.t="n",l=""+(n.v=zr($i(n.v,o),o));typeof n.z>"u"&&(n.z=Rn[14]);break;default:l=n.v;break}var p=n.t=="z"||n.v==null?"":Fr("v",$e(l)),g={r:t},v=Il(r.cellXfs,n,r);switch(v!==0&&(g.s=v),n.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){p=Fr("v",""+Gb(r.Strings,n.v,r.revStrings)),g.t="s";break}else g.t="str";break}if(n.t!=u&&(n.t=u,n.v=h),typeof n.f=="string"&&n.f){var y=n.F&&n.F.slice(0,t.length)==t?{t:"array",ref:n.F}:null;p=re("f",$e(n.f),y)+(n.v!=null?p:"")}return n.l&&(n.l.display=$e(l),e["!links"].push([t,n.l])),n.D&&(g.cm=1),re("c",p,g)}function rG(n,t,e,r){var i=[],s=[],o=Nn(n["!ref"]),l="",u,h="",d=[],p=0,g=0,v=n["!rows"],y=n["!data"]!=null,_=y?n["!data"]:[],b={r:h},E,S=-1,T=(((r||{}).Workbook||{}).WBProps||{}).date1904;for(g=o.s.c;g<=o.e.c;++g)d[g]=vn(g);for(p=o.s.r;p<=o.e.r;++p){s=[],h=wn(p);var O=y?_[p]:[];for(g=o.s.c;g<=o.e.c;++g){u=d[g]+h;var R=y?O[g]:n[u];R!==void 0&&(l=nG(R,u,n,t,e,r,T))!=null&&s.push(l)}(s.length>0||v&&v[p])&&(b={r:h},v&&v[p]&&(E=v[p],E.hidden&&(b.hidden=1),S=-1,E.hpx?S=um(E.hpx):E.hpt&&(S=E.hpt),S>-1&&(b.ht=S,b.customHeight=1),E.level&&(b.outlineLevel=E.level)),i[i.length]=re("row",s.join(""),b))}if(v)for(;p<v.length;++p)v&&v[p]&&(b={r:p+1},E=v[p],E.hidden&&(b.hidden=1),S=-1,E.hpx?S=um(E.hpx):E.hpt&&(S=E.hpt),S>-1&&(b.ht=S,b.customHeight=1),E.level&&(b.outlineLevel=E.level),i[i.length]=re("row","",b));return i.join("")}function iG(n,t,e,r){var i=[fr,re("worksheet",null,{xmlns:xf[0],"xmlns:r":Sr.r})],s=e.SheetNames[n],o=0,l="",u=e.Sheets[s];u==null&&(u={});var h=u["!ref"]||"A1",d=Nn(h);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=ur(d)}r||(r={}),u["!comments"]=[];var p=[];Y$(u,e,n,t,i),i[i.length]=re("dimension",null,{ref:h}),i[i.length]=eG(u,t,n,e),t.sheetFormat&&(i[i.length]=re("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(i[i.length]=J$(u,u["!cols"])),i[o=i.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(l=rG(u,t,n,e),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),u["!protect"]&&(i[i.length]=Z$(u["!protect"])),u["!autofilter"]!=null&&(i[i.length]=tG(u["!autofilter"],u,e,n)),u["!merges"]!=null&&u["!merges"].length>0&&(i[i.length]=X$(u["!merges"]));var g=-1,v,y=-1;return u["!links"].length>0&&(i[i.length]="<hyperlinks>",u["!links"].forEach(function(_){_[1].Target&&(v={ref:_[0]},_[1].Target.charAt(0)!="#"&&(y=ln(r,-1,$e(_[1].Target).replace(/#[\s\S]*$/,""),en.HLINK),v["r:id"]="rId"+y),(g=_[1].Target.indexOf("#"))>-1&&(v.location=$e(_[1].Target.slice(g+1))),_[1].Tooltip&&(v.tooltip=$e(_[1].Tooltip)),v.display=_[1].display,i[i.length]=re("hyperlink",null,v))}),i[i.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(i[i.length]=Q$(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Fr("ignoredErrors",re("ignoredError",null,{numberStoredAsText:1,sqref:h}))),p.length>0&&(y=ln(r,-1,"../drawings/drawing"+(n+1)+".xml",en.DRAW),i[i.length]=re("drawing",null,{"r:id":"rId"+y}),u["!drawing"]=p),u["!comments"].length>0&&(y=ln(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",en.VML),i[i.length]=re("legacyDrawing",null,{"r:id":"rId"+y}),u["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function sG(n,t){var e={},r=n.l+t;e.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(e.level=s&7),s&16&&(e.hidden=!0),s&32&&(e.hpt=i/20),e}function aG(n,t,e){var r=It(145),i=(e["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=um(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var l=0,u=r.l;r.l+=4;for(var h={r:n,c:0},d=e["!data"]!=null,p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var g=-1,v=-1,y=p<<10;y<p+1<<10;++y){h.c=y;var _=d?(e["!data"][h.r]||[])[h.c]:e[jn(h)];_&&(g<0&&(g=y),v=y)}g<0||(++l,r.write_shift(4,g),r.write_shift(4,v))}var b=r.l;return r.l=u,r.write_shift(4,l),r.l=b,r.length>r.l?r.slice(0,r.l):r}function oG(n,t,e,r){var i=aG(r,e,t);(i.length>17||(t["!rows"]||[])[r])&&Yt(n,0,i)}var lG=$c,cG=Af;function uG(){}function fG(n,t){var e={},r=n[n.l];return++n.l,e.above=!(r&64),e.left=!(r&128),n.l+=18,e.name=sz(n),e}function hG(n,t,e){e==null&&(e=It(84+4*n.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),e.write_shift(1,r);for(var i=1;i<3;++i)e.write_shift(1,0);return am({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),mO(n,e),e.slice(0,e.l)}function dG(n){var t=Us(n);return[t]}function pG(n,t,e){return e==null&&(e=It(8)),zc(t,e)}function gG(n){var t=Hc(n);return[t]}function mG(n,t,e){return e==null&&(e=It(4)),jc(t,e)}function vG(n){var t=Us(n),e=n.read_shift(1);return[t,e,"b"]}function _G(n,t,e){return e==null&&(e=It(9)),zc(t,e),e.write_shift(1,n.v?1:0),e}function yG(n){var t=Hc(n),e=n.read_shift(1);return[t,e,"b"]}function bG(n,t,e){return e==null&&(e=It(5)),jc(t,e),e.write_shift(1,n.v?1:0),e}function xG(n){var t=Us(n),e=n.read_shift(1);return[t,e,"e"]}function D_(n,t,e){return e==null&&(e=It(9)),zc(t,e),e.write_shift(1,n.v),e}function EG(n){var t=Hc(n),e=n.read_shift(1);return[t,e,"e"]}function O_(n,t,e){return e==null&&(e=It(8)),jc(t,e),e.write_shift(1,n.v),e.write_shift(2,0),e.write_shift(1,0),e}function wG(n){var t=Us(n),e=n.read_shift(4);return[t,e,"s"]}function AG(n,t,e){return e==null&&(e=It(12)),zc(t,e),e.write_shift(4,t.v),e}function SG(n){var t=Hc(n),e=n.read_shift(4);return[t,e,"s"]}function TG(n,t,e){return e==null&&(e=It(8)),jc(t,e),e.write_shift(4,t.v),e}function CG(n){var t=Us(n),e=Sf(n);return[t,e,"n"]}function DG(n,t,e){return e==null&&(e=It(16)),zc(t,e),Lc(n.v,e),e}function OG(n){var t=Hc(n),e=Sf(n);return[t,e,"n"]}function RG(n,t,e){return e==null&&(e=It(12)),jc(t,e),Lc(n.v,e),e}function NG(n){var t=Us(n),e=zb(n);return[t,e,"n"]}function kG(n,t,e){return e==null&&(e=It(12)),zc(t,e),vO(n.v,e),e}function LG(n){var t=Hc(n),e=zb(n);return[t,e,"n"]}function MG(n,t,e){return e==null&&(e=It(8)),jc(t,e),vO(n.v,e),e}function IG(n){var t=Us(n),e=Bb(n);return[t,e,"is"]}function PG(n){var t=Us(n),e=ri(n);return[t,e,"str"]}function FG(n,t,e){var r=n.v==null?"":String(n.v);return e==null&&(e=It(12+4*n.v.length)),zc(t,e),_r(r,e),e.length>e.l?e.slice(0,e.l):e}function BG(n){var t=Hc(n),e=ri(n);return[t,e,"str"]}function UG(n,t,e){var r=n.v==null?"":String(n.v);return e==null&&(e=It(8+4*r.length)),jc(t,e),_r(r,e),e.length>e.l?e.slice(0,e.l):e}function zG(n,t,e){var r=n.l+t,i=Us(n);i.r=e["!row"];var s=n.read_shift(1),o=[i,s,"b"];if(e.cellFormula){n.l+=2;var l=Jm(n,r-n.l,e);o[3]=df(l,null,i,e.supbooks,e)}else n.l=r;return o}function HG(n,t,e){var r=n.l+t,i=Us(n);i.r=e["!row"];var s=n.read_shift(1),o=[i,s,"e"];if(e.cellFormula){n.l+=2;var l=Jm(n,r-n.l,e);o[3]=df(l,null,i,e.supbooks,e)}else n.l=r;return o}function jG(n,t,e){var r=n.l+t,i=Us(n);i.r=e["!row"];var s=Sf(n),o=[i,s,"n"];if(e.cellFormula){n.l+=2;var l=Jm(n,r-n.l,e);o[3]=df(l,null,i,e.supbooks,e)}else n.l=r;return o}function $G(n,t,e){var r=n.l+t,i=Us(n);i.r=e["!row"];var s=ri(n),o=[i,s,"str"];if(e.cellFormula){n.l+=2;var l=Jm(n,r-n.l,e);o[3]=df(l,null,i,e.supbooks,e)}else n.l=r;return o}var GG=$c,VG=Af;function WG(n,t){return t==null&&(t=It(4)),t.write_shift(4,n),t}function XG(n,t){var e=n.l+t,r=$c(n),i=qm(n),s=ri(n),o=ri(n),l=ri(n);n.l=e;var u={rfx:r,relId:i,loc:s,display:l};return o&&(u.Tooltip=o),u}function YG(n,t){var e=It(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Af({s:Fn(n[0]),e:Fn(n[0])},e),Ub("rId"+t,e);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return _r(i||"",e),_r(n[1].Tooltip||"",e),_r("",e),e.slice(0,e.l)}function qG(){}function KG(n,t,e){var r=n.l+t,i=_O(n),s=n.read_shift(1),o=[i];if(o[2]=s,e.cellFormula){var l=O$(n,r-n.l,e);o[1]=l}else n.l=r;return o}function ZG(n,t,e){var r=n.l+t,i=$c(n),s=[i];if(e.cellFormula){var o=N$(n,r-n.l,e);s[1]=o,n.l=r}else n.l=r;return s}function QG(n,t,e){e==null&&(e=It(18));var r=t1(n,t);e.write_shift(-4,n),e.write_shift(-4,n),e.write_shift(4,(r.width||10)*256),e.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),e.write_shift(2,i),e}var QO=["left","right","top","bottom","header","footer"];function JG(n){var t={};return QO.forEach(function(e){t[e]=Sf(n)}),t}function tV(n,t){return t==null&&(t=It(6*8)),ZO(n),QO.forEach(function(e){Lc(n[e],t)}),t}function eV(n){var t=n.read_shift(2);return n.l+=28,{RTL:t&32}}function nV(n,t,e){e==null&&(e=It(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function rV(n){var t=It(24);return t.write_shift(4,4),t.write_shift(4,1),Af(n,t),t}function iV(n,t){return t==null&&(t=It(16*4+2)),t.write_shift(2,n.password?IO(n.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,n[e[0]]!=null&&!n[e[0]]?1:0):t.write_shift(4,n[e[0]]!=null&&n[e[0]]?0:1)}),t}function sV(){}function aV(){}function oV(n,t,e,r,i,s,o,l){var u={r:e,c:r};if(t.c&&s["!comments"].push([jn(u),t.c]),t.v===void 0)return!1;var h="";switch(t.t){case"b":h=t.v?"1":"0";break;case"d":t=ii(t),t.z=t.z||Rn[14],t.v=zr($i(t.v,l),l),t.t="n";break;case"n":case"e":h=""+t.v;break;default:h=t.v;break}switch(u.s=Il(i.cellXfs,t,i),t.l&&s["!links"].push([jn(u),t.l]),t.t){case"s":case"str":return i.bookSST?(h=Gb(i.Strings,t.v==null?"":String(t.v),i.revStrings),u.t="s",u.v=h,o?Yt(n,18,TG(t,u)):Yt(n,7,AG(t,u))):(u.t="str",o?Yt(n,17,UG(t,u)):Yt(n,6,FG(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Yt(n,13,MG(t,u)):Yt(n,2,kG(t,u)):isFinite(t.v)?o?Yt(n,16,RG(t,u)):Yt(n,5,DG(t,u)):(u.t="e",isNaN(t.v)?o?Yt(n,14,O_({v:36},u)):Yt(n,3,D_({v:36},u)):o?Yt(n,14,O_({v:7},u)):Yt(n,3,D_({v:7},u))),!0;case"b":return u.t="b",o?Yt(n,15,bG(t,u)):Yt(n,4,_G(t,u)),!0;case"e":return u.t="e",o?Yt(n,14,O_(t,u)):Yt(n,3,D_(t,u)),!0}return o?Yt(n,12,mG(t,u)):Yt(n,1,pG(t,u)),!0}function lV(n,t,e,r,i){var s=Nn(t["!ref"]||"A1"),o="",l=[],u=(((i||{}).Workbook||{}).WBProps||{}).date1904;Yt(n,145);var h=t["!data"]!=null,d=h?t["!data"][s.s.r]:[],p=s.e.r;t["!rows"]&&(p=Math.max(s.e.r,t["!rows"].length-1));for(var g=s.s.r;g<=p;++g)if(o=wn(g),h&&(d=t["!data"][g]),oG(n,t,s,g),!(h&&!d)){var v=!1;if(g<=s.e.r)for(var y=s.s.c;y<=s.e.c;++y){g===s.s.r&&(l[y]=vn(y));var _=h?d[y]:t[l[y]+o];if(!_){v=!1;continue}v=oV(n,_,g,y,r,t,v,u)}}Yt(n,146)}function cV(n,t){!t||!t["!merges"]||(Yt(n,177,WG(t["!merges"].length)),t["!merges"].forEach(function(e){Yt(n,176,VG(e))}),Yt(n,178))}function uV(n,t){!t||!t["!cols"]||(Yt(n,390),t["!cols"].forEach(function(e,r){e&&Yt(n,60,QG(r,e))}),Yt(n,391))}function fV(n,t){!t||!t["!ref"]||(Yt(n,648),Yt(n,649,rV(Nn(t["!ref"]))),Yt(n,650))}function hV(n,t,e){t["!links"].forEach(function(r){if(r[1].Target){var i=ln(e,-1,r[1].Target.replace(/#[\s\S]*$/,""),en.HLINK);Yt(n,494,YG(r,i))}}),delete t["!links"]}function dV(n,t,e,r){if(t["!comments"].length>0){var i=ln(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",en.VML);Yt(n,551,Ub("rId"+i)),t["!legacy"]=i}}function pV(n,t,e,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:ur(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,l=Ur(s);l.s.r==l.e.r&&(l.e.r=Ur(t["!ref"]).e.r,s=ur(l));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==r){h.Ref=Ud(e.SheetNames[r])+"!"+Bd(s);break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:Ud(e.SheetNames[r])+"!"+Bd(s)}),Yt(n,161,Af(Nn(s))),Yt(n,162)}}function gV(n,t,e){Yt(n,133),Yt(n,137,nV(t,e)),Yt(n,138),Yt(n,134)}function mV(n,t){t["!protect"]&&Yt(n,535,iV(t["!protect"]))}function vV(n,t,e,r){var i=ni(),s=e.SheetNames[n],o=e.Sheets[s]||{},l=s;try{e&&e.Workbook&&(l=e.Workbook.Sheets[n].CodeName||l)}catch{}var u=Nn(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Yt(i,129),(e.vbaraw||o["!outline"])&&Yt(i,147,hG(l,o["!outline"])),Yt(i,148,cG(u)),gV(i,o,e.Workbook),uV(i,o),lV(i,o,n,t,e),mV(i,o),pV(i,o,e,n),cV(i,o),hV(i,o,r),o["!margins"]&&Yt(i,476,tV(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&fV(i,o),dV(i,o,n,r),Yt(i,130),i.end()}function _V(n,t){n.l+=10;var e=ri(n);return{name:e}}var yV=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function bV(n){return!n.Workbook||!n.Workbook.WBProps?"false":P9(n.Workbook.WBProps.date1904)?"true":"false"}var xV=":][*?/\\".split("");function JO(n,t){try{if(n=="")throw new Error("Sheet name cannot be blank");if(n.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(n.charCodeAt(0)==39||n.charCodeAt(n.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(n.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");xV.forEach(function(e){if(n.indexOf(e)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(e){throw e}return!0}function EV(n,t,e){n.forEach(function(r,i){JO(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(e){var o=t&&t[i]&&t[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function wV(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var t=n.Workbook&&n.Workbook.Sheets||[];EV(n.SheetNames,t,!!n.vbaraw);for(var e=0;e<n.SheetNames.length;++e)W$(n.Sheets[n.SheetNames[e]],n.SheetNames[e],e);n.SheetNames.forEach(function(r,i){var s=n.Sheets[r];if(!(!s||!s["!autofilter"])){var o;n.Workbook||(n.Workbook={}),n.Workbook.Names||(n.Workbook.Names=[]),n.Workbook.Names.forEach(function(u){u.Name=="_xlnm._FilterDatabase"&&u.Sheet==i&&(o=u)});var l=Ud(r)+"!"+Bd(s["!autofilter"].ref);o?o.Ref=l:n.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:l})}})}function AV(n){var t=[fr];t[t.length]=re("workbook",null,{xmlns:xf[0],"xmlns:r":Sr.r});var e=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(yV.forEach(function(l){n.Workbook.WBProps[l[0]]!=null&&n.Workbook.WBProps[l[0]]!=l[1]&&(r[l[0]]=n.Workbook.WBProps[l[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=re("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var o={name:$e(n.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=re("sheet",null,o)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(l){var u={name:l.Name};l.Comment&&(u.comment=l.Comment),l.Sheet!=null&&(u.localSheetId=""+l.Sheet),l.Hidden&&(u.hidden="1"),l.Ref&&(t[t.length]=re("definedName",$e(l.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function SV(n,t){var e={};return e.Hidden=n.read_shift(4),e.iTabID=n.read_shift(4),e.strRelID=cy(n),e.name=ri(n),e}function TV(n,t){return t||(t=It(127)),t.write_shift(4,n.Hidden),t.write_shift(4,n.iTabID),Ub(n.strRelID,t),_r(n.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function CV(n,t){var e={},r=n.read_shift(4);e.defaultThemeVersion=n.read_shift(4);var i=t>8?ri(n):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(r&65536),e.backupFile=!!(r&64),e.checkCompatibility=!!(r&4096),e.date1904=!!(r&1),e.filterPrivacy=!!(r&8),e.hidePivotFieldList=!!(r&1024),e.promptedSolutions=!!(r&16),e.publishItems=!!(r&2048),e.refreshAllConnections=!!(r&262144),e.saveExternalLinkValues=!!(r&128),e.showBorderUnselectedTables=!!(r&4),e.showInkAnnotation=!!(r&32),e.showObjects=["all","placeholders","none"][r>>13&3],e.showPivotChartFilter=!!(r&32768),e.updateLinks=["userSet","never","always"][r>>8&3],e}function DV(n,t){t||(t=It(72));var e=0;return n&&(n.date1904&&(e|=1),n.filterPrivacy&&(e|=8)),t.write_shift(4,e),t.write_shift(4,0),mO(n&&n.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function OV(n,t,e){var r=n.l+t,i=n.read_shift(4);n.l+=1;var s=n.read_shift(4),o=az(n),l,u="";try{l=R$(n,0,e);try{u=qm(n)}catch{}}catch{console.error("Could not parse defined name "+o)}i&32&&(o="_xlnm."+o),n.l=r;var h={Name:o,Ptg:l,Flags:i};return s<268435455&&(h.Sheet=s),u&&(h.Comment=u),h}function RV(n,t){var e=It(9),r=0,i=n.Name;_z.indexOf(i)>-1&&(r|=32,i=i.slice(6)),e.write_shift(4,r),e.write_shift(1,0),e.write_shift(4,n.Sheet==null?4294967295:n.Sheet);var s=[e,_r(i),j$(n.Ref,t)];if(n.Comment)s.push(zd(n.Comment));else{var o=It(4);o.write_shift(4,4294967295),s.push(o)}return lr(s)}function NV(n,t){Yt(n,143);for(var e=0;e!=t.SheetNames.length;++e){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,i={Hidden:r,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};Yt(n,156,TV(i))}Yt(n,144)}function kV(n,t){t||(t=It(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return _r("SheetJS",t),_r(Zg.version,t),_r(Zg.version,t),_r("7262",t),t.length>t.l?t.slice(0,t.l):t}function LV(n,t){t||(t=It(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,n),t.write_shift(4,n);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function MV(n,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,r=0,i=-1,s=-1;r<e.length;++r)!e[r]||!e[r].Hidden&&i==-1?i=r:e[r].Hidden==1&&s==-1&&(s=r);s>i||(Yt(n,135),Yt(n,158,LV(i)),Yt(n,136))}}function IV(n,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(e){try{if(e.Flags&14)return;Yt(n,39,RV(e,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(e))}})}function PV(n){var t=n.SheetNames.length,e=It(12*t+28);e.write_shift(4,t+2),e.write_shift(4,0),e.write_shift(4,-2),e.write_shift(4,-2),e.write_shift(4,0),e.write_shift(4,-1),e.write_shift(4,-1);for(var r=0;r<t;++r)e.write_shift(4,0),e.write_shift(4,r),e.write_shift(4,r);return e}function FV(n,t){Yt(n,353),Yt(n,357),Yt(n,362,PV(t)),Yt(n,354)}function BV(n,t){var e=ni();return Yt(e,131),Yt(e,128,kV()),Yt(e,153,DV(n.Workbook&&n.Workbook.WBProps||null)),MV(e,n),NV(e,n),FV(e,n),(n.Workbook||{}).Names&&IV(e,n),Yt(e,132),e.end()}function UV(n,t){var e=[];return n.Props&&e.push(wz(n.Props,t)),n.Custprops&&e.push(Az(n.Props,n.Custprops)),e.join("")}function zV(n){return(((n||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function HV(n,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(re("NumberFormat",null,{"ss:Format":$e(Rn[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};e.push(re("Style",s.join(""),o))}),re("Styles",e.join(""))}function tR(n){return re("NamedRange",null,{"ss:Name":n.Name.slice(0,6)=="_xlnm."?n.Name.slice(6):n.Name,"ss:RefersTo":"="+Zm(n.Ref,{r:0,c:0})})}function jV(n){if(!((n||{}).Workbook||{}).Names)return"";for(var t=n.Workbook.Names,e=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||e.push(tR(i)))}return re("Names",e.join(""))}function $V(n,t,e,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||s.push(tR(l)))}return s.join("")}function GV(n,t,e,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(re("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(re("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(re("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e])if(r.Workbook.Sheets[e].Hidden)i.push(re("Visible",r.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<e&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==e&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Fr("ProtectContents","True")),n["!protect"].objects&&i.push(Fr("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Fr("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Fr("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Fr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){n["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":re("WorksheetOptions",i.join(""),{xmlns:ss.x})}function VV(n){return n.map(function(t){var e=I9(t.t||""),r=re("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"}),i={};return t.a&&(i["ss:Author"]=t.a),n.hidden||(i["ss:ShowAlways"]="1"),re("Comment",r,i)}).join("")}function WV(n,t,e,r,i,s,o){if(!n||n.v==null&&n.f==null)return"";var l={};if(n.f&&(l["ss:Formula"]="="+$e(Zm(n.f,o))),n.F&&n.F.slice(0,t.length)==t){var u=Fn(n.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(n.l&&n.l.Target&&(l["ss:HRef"]=$e(n.l.Target),n.l.Tooltip&&(l["x:HRefScreenTip"]=$e(n.l.Tooltip))),e["!merges"])for(var h=e["!merges"],d=0;d!=h.length;++d)h[d].s.c!=o.c||h[d].s.r!=o.r||(h[d].e.c>h[d].s.c&&(l["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(l["ss:MergeDown"]=h[d].e.r-h[d].s.r));var p="",g="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":isFinite(n.v)?(p="Number",g=String(n.v)):(p="Error",g=Ti[isNaN(n.v)?36:7]);break;case"b":p="Boolean",g=n.v?"1":"0";break;case"e":p="Error",g=Ti[n.v];break;case"d":p="DateTime",g=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Rn[14]);break;case"s":p="String",g=M9(n.v||"");break}var v=Il(r.cellXfs,n,r);l["ss:StyleID"]="s"+(21+v),l["ss:Index"]=o.c+1;var y=n.v!=null?g:"",_=n.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(n.c||[]).length>0&&(_+=VV(n.c)),re("Cell",_,l)}function XV(n,t){var e='<Row ss:Index="'+(n+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=FO(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function YV(n,t,e,r){if(!n["!ref"])return"";var i=Nn(n["!ref"]),s=n["!merges"]||[],o=0,l=[];n["!cols"]&&n["!cols"].forEach(function(b,E){jb(b);var S=!!b.width,T=t1(E,b),O={"ss:Index":E+1};S&&(O["ss:Width"]=lm(T.width)),b.hidden&&(O["ss:Hidden"]="1"),l.push(re("Column",null,O))});for(var u=n["!data"]!=null,h={r:0,c:0},d=i.s.r;d<=i.e.r;++d){var p=[XV(d,(n["!rows"]||[])[d])];h.r=d;for(var g=i.s.c;g<=i.e.c;++g){h.c=g;var v=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>g)&&!(s[o].s.r>d)&&!(s[o].e.c<g)&&!(s[o].e.r<d)){(s[o].s.c!=g||s[o].s.r!=d)&&(v=!0);break}if(!v){var y=vn(g)+wn(d),_=u?(n["!data"][d]||[])[g]:n[y];p.push(WV(_,y,n,t,e,r,h))}}p.push("</Row>"),p.length>2&&l.push(p.join(""))}return l.join("")}function qV(n,t,e){var r=[],i=e.SheetNames[n],s=e.Sheets[i],o=s?$V(s,t,n,e):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?YV(s,t,n,e):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(GV(s,t,n,e)),s&&s["!autofilter"]&&r.push('<AutoFilter x:Range="'+Zm(Bd(s["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),r.join("")}function KV(n,t){t||(t={}),n.SSF||(n.SSF=ii(Rn)),n.SSF&&(Wm(),Vm(n.SSF),t.revssf=Xm(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF,t.cellXfs=[],Il(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(UV(n,t)),e.push(zV(n)),e.push(""),e.push(jV(n));for(var r=0;r<n.SheetNames.length;++r)e.push(re("Worksheet",qV(r,t,n),{"ss:Name":$e(n.SheetNames[r])}));return e[2]=HV(n,t),fr+re("Workbook",e.join(""),{xmlns:ss.ss,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:ss":ss.ss,"xmlns:dt":ss.dt,"xmlns:html":ss.html})}var R_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ZV(n,t){var e=[],r=[],i=[],s=0,o,l=W2(rS,"n"),u=W2(iS,"n");if(n.Props)for(o=cr(n.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?e:Object.prototype.hasOwnProperty.call(u,o[s])?r:i).push([o[s],n.Props[o[s]]]);if(n.Custprops)for(o=cr(n.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?e:Object.prototype.hasOwnProperty.call(u,o[s])?r:i).push([o[s],n.Custprops[o[s]]]);var h=[];for(s=0;s<i.length;++s)DO.indexOf(i[s][0])>-1||SO.indexOf(i[s][0])>-1||i[s][1]!=null&&h.push(i[s]);r.length&&Tn.utils.cfb_add(t,"/SummaryInformation",cS(r,R_.SI,u,iS)),(e.length||h.length)&&Tn.utils.cfb_add(t,"/DocumentSummaryInformation",cS(e,R_.DSI,l,rS,h.length?h:null,R_.UDI))}function QV(n,t){var e=t||{},r=Tn.utils.cfb_new({root:"R"}),i="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":i="/Workbook",e.biff=8;break;case"biff5":i="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Tn.utils.cfb_add(r,i,nR(n,e)),e.biff==8&&(n.Props||n.Custprops)&&ZV(n,r),e.biff==8&&n.vbaraw&&lj(r,Tn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var JV={0:{f:sG},1:{f:dG},2:{f:NG},3:{f:xG},4:{f:vG},5:{f:CG},6:{f:PG},7:{f:wG},8:{f:$G},9:{f:jG},10:{f:zG},11:{f:HG},12:{f:gG},13:{f:LG},14:{f:EG},15:{f:yG},16:{f:OG},17:{f:BG},18:{f:SG},19:{f:Bb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:OV},40:{},42:{},43:{f:CH},44:{f:SH},45:{f:RH},46:{f:kH},47:{f:NH},48:{},49:{f:J9},50:{},51:{f:YH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rH},62:{f:IG},63:{f:ej},64:{f:sV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ha,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:eV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:fG},148:{f:lG,p:16},151:{f:qG},152:{},153:{f:CV},154:{},155:{},156:{f:SV},157:{},158:{},159:{T:1,f:pH},160:{T:-1},161:{T:1,f:$c},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GG},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:WH},336:{T:-1},337:{f:ZH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cy},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Qz},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KG},427:{f:ZG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uG},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:XG},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cy},551:{f:qm},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:aj},633:{T:1},634:{T:-1},635:{T:1,f:ij},636:{T:-1},637:{f:rz},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_V},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:aV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Zt(n,t,e,r){var i=t;if(!isNaN(i)){var s=r||(e||[]).length||0,o=n.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Ib(e)&&n.push(e)}}function tW(n,t,e,r){var i=(e||[]).length||0;if(i<=8224)return Zt(n,t,e,i);var s=t;if(!isNaN(s)){for(var o=e.parts||[],l=0,u=0,h=0;h+(o[l]||8224)<=8224;)h+=o[l]||8224,l++;var d=n.next(4);for(d.write_shift(2,s),d.write_shift(2,h),n.push(e.slice(u,u+h)),u+=h;u<i;){for(d=n.next(4),d.write_shift(2,60),h=0;h+(o[l]||8224)<=8224;)h+=o[l]||8224,l++;d.write_shift(2,h),n.push(e.slice(u,u+h)),u+=h}}}function N_(n,t,e,r){var i=It(9);return c0(i,n,t),OO(e,r||"b",i),i}function eW(n,t,e){var r=It(8+2*e.length);return c0(r,n,t),r.write_shift(1,e.length),r.write_shift(e.length,e,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function eR(n,t){t.forEach(function(e){var r=e[0].map(function(s){return s.t}).join("");if(r.length<=2048)return Zt(n,28,T_(r,e[1],e[2]));Zt(n,28,T_(r.slice(0,2048),e[1],e[2],r.length));for(var i=2048;i<r.length;i+=2048)Zt(n,28,T_(r.slice(i,Math.min(i+2048,r.length)),-1,-1,Math.min(2048,r.length-i)))})}function nW(n,t,e,r,i,s){var o=0;t.z!=null&&(o=i._BIFF2FmtTable.indexOf(t.z),o==-1&&(i._BIFF2FmtTable.push(t.z),o=i._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<i.cellXfs.length&&i.cellXfs[l].numFmtId!=o;++l);l==i.cellXfs.length&&i.cellXfs.push({numFmtId:o})}if(t.v!=null)switch(t.t){case"d":case"n":var u=t.t=="d"?zr($i(t.v,s),s):t.v;i.biff==2&&u==(u|0)&&u>=0&&u<65536?Zt(n,2,oH(e,r,u,l,o)):isNaN(u)?Zt(n,5,N_(e,r,36,"e")):isFinite(u)?Zt(n,3,aH(e,r,u,l,o)):Zt(n,5,N_(e,r,7,"e"));return;case"b":case"e":Zt(n,5,N_(e,r,t.v,t.t));return;case"s":case"str":Zt(n,4,eW(e,r,t.v==null?"":String(t.v).slice(0,255)));return}Zt(n,1,c0(null,e,r))}function rW(n,t,e,r,i){var s=t["!data"]!=null,o=Nn(t["!ref"]||"A1"),l="",u=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.r,16383)}for(var h=(((i||{}).Workbook||{}).WBProps||{}).date1904,d=[],p=[],g=o.s.c;g<=o.e.c;++g)u[g]=vn(g);for(var v=o.s.r;v<=o.e.r;++v)for(s&&(d=t["!data"][v]||[]),l=wn(v),g=o.s.c;g<=o.e.c;++g){var y=s?d[g]:t[u[g]+l];y&&(nW(n,y,v,g,r,h),y.c&&p.push([y.c,v,g]))}eR(n,p)}function iW(n,t){for(var e=t||{},r=ni(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==e.sheet&&(i=s);if(i==0&&e.sheet&&n.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);Zt(r,e.biff==4?1033:e.biff==3?521:9,Hb(n,16,e)),((n.Workbook||{}).WBProps||{}).date1904&&Zt(r,34,Jr(!0)),e.cellXfs=[{numFmtId:0}],e._BIFF2FmtTable=["General"],e._Fonts=[];var o=ni();return rW(o,n.Sheets[n.SheetNames[i]],i,e,n),e._BIFF2FmtTable.forEach(function(l){e.biff<=3?Zt(r,30,Vz(l)):Zt(r,1054,Wz(l))}),e.cellXfs.forEach(function(l){switch(e.biff){case 2:Zt(r,67,Yz(l));break;case 3:Zt(r,579,LO(l));break;case 4:Zt(r,1091,qz(l));break}}),delete e._BIFF2FmtTable,delete e.cellXfs,delete e._Fonts,r.push(o.end()),Zt(r,10),r.end()}var Qs=1,Os=[];function sW(){var n=It(82+8*Os.length);n.write_shift(2,15),n.write_shift(2,61440),n.write_shift(4,74+8*Os.length);{n.write_shift(2,0),n.write_shift(2,61446),n.write_shift(4,16+8*Os.length);{n.write_shift(4,Qs),n.write_shift(4,Os.length+1);for(var t=0,e=0;e<Os.length;++e)t+=Os[e]&&Os[e][1]||0;n.write_shift(4,t),n.write_shift(4,Os.length)}Os.forEach(function(r){n.write_shift(4,r[0]),n.write_shift(4,r[2])})}return n.write_shift(2,51),n.write_shift(2,61451),n.write_shift(4,18),n.write_shift(2,191),n.write_shift(4,524296),n.write_shift(2,385),n.write_shift(4,134217793),n.write_shift(2,448),n.write_shift(4,134217792),n.write_shift(2,64),n.write_shift(2,61726),n.write_shift(4,16),n.write_shift(4,134217741),n.write_shift(4,134217740),n.write_shift(4,134217751),n.write_shift(4,268435703),n}function aW(n,t){var e=[],r=0,i=ni(),s=Qs,o;t.forEach(function(u,h){var d="",p=u[0].map(function(T){return T.a&&!d&&(d=T.a),T.t}).join("");++Qs;{var g=It(150);g.write_shift(2,15),g.write_shift(2,61444),g.write_shift(4,150),g.write_shift(2,3234),g.write_shift(2,61450),g.write_shift(4,8),g.write_shift(4,Qs),g.write_shift(4,2560),g.write_shift(2,227),g.write_shift(2,61451),g.write_shift(4,84),g.write_shift(2,128),g.write_shift(4,0),g.write_shift(2,139),g.write_shift(4,2),g.write_shift(2,191),g.write_shift(4,524296),g.write_shift(2,344),g.l+=4,g.write_shift(2,385),g.write_shift(4,134217808),g.write_shift(2,387),g.write_shift(4,134217808),g.write_shift(2,389),g.write_shift(4,268435700),g.write_shift(2,447),g.write_shift(4,1048592),g.write_shift(2,448),g.write_shift(4,134217809),g.write_shift(2,451),g.write_shift(4,268435700),g.write_shift(2,513),g.write_shift(4,134217809),g.write_shift(2,515),g.write_shift(4,268435700),g.write_shift(2,575),g.write_shift(4,196609),g.write_shift(2,959),g.write_shift(4,131072|(u[0].hidden?2:0)),g.l+=2,g.write_shift(2,61456),g.write_shift(4,18),g.write_shift(2,3),g.write_shift(2,u[2]+2),g.l+=2,g.write_shift(2,u[1]+1),g.l+=2,g.write_shift(2,u[2]+4),g.l+=2,g.write_shift(2,u[1]+5),g.l+=2,g.l+=2,g.write_shift(2,61457),g.l+=4,g.l=150,h==0?o=g:Zt(i,236,g)}r+=150;{var v=It(52);v.write_shift(2,21),v.write_shift(2,18),v.write_shift(2,25),v.write_shift(2,Qs),v.write_shift(2,0),v.l=22,v.write_shift(2,13),v.write_shift(2,22),v.write_shift(4,1651663474),v.write_shift(4,2503426821),v.write_shift(4,2150634280),v.write_shift(4,1768515844+Qs*256),v.write_shift(2,0),v.write_shift(4,0),v.l+=4,Zt(i,93,v)}{var y=It(8);y.l+=2,y.write_shift(2,61453),y.l+=4,Zt(i,236,y)}r+=8;{var _=It(18);_.write_shift(2,18),_.l+=8,_.write_shift(2,p.length),_.write_shift(2,16),_.l+=4,Zt(i,438,_);{var b=It(1+p.length);b.write_shift(1,0),b.write_shift(p.length,p,"sbcs"),Zt(i,60,b)}{var E=It(16);E.l+=8,E.write_shift(2,p.length),E.l+=6,Zt(i,60,E)}}{var S=It(12+d.length);S.write_shift(2,u[1]),S.write_shift(2,u[2]),S.write_shift(2,0|(u[0].hidden?0:2)),S.write_shift(2,Qs),S.write_shift(2,d.length),S.write_shift(1,0),S.write_shift(d.length,d,"sbcs"),S.l++,e.push(S)}});{var l=It(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,r+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,Qs),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,r+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,s),l.write_shift(4,5),Zt(n,236,o?lr([l,o]):l)}n.push(i.end()),e.forEach(function(u){Zt(n,28,u)}),Os.push([s,t.length+1,Qs]),++Qs}function oW(n,t,e){Zt(n,49,Hz({sz:12,name:"Arial"},e))}function lW(n,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Zt(n,1054,Gz(i,t[i],e))})}function cW(n,t){var e=It(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Zt(n,2151,e),e=It(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),kO(Nn(t["!ref"]||"A1"),e),e.write_shift(4,4),Zt(n,2152,e)}function uW(n,t){for(var e=0;e<16;++e)Zt(n,224,fS({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){Zt(n,224,fS(r,0,t))})}function fW(n,t){for(var e=0;e<t["!links"].length;++e){var r=t["!links"][e];Zt(n,440,tH(r)),r[1].Tooltip&&Zt(n,2048,eH(r))}delete t["!links"]}function hW(n,t){if(t){var e=0;t.forEach(function(r,i){++e<=256&&r&&Zt(n,125,iH(t1(i,r),i))})}}function dW(n,t,e,r,i,s){var o=16+Il(i.cellXfs,t,i);if(t.v==null&&!t.bf){Zt(n,513,Mc(e,r,o));return}if(t.bf)Zt(n,6,D$(t,e,r,i,o));else switch(t.t){case"d":case"n":var l=t.t=="d"?zr($i(t.v,s),s):t.v;isNaN(l)?Zt(n,517,S_(e,r,36,o,i,"e")):isFinite(l)?Zt(n,515,Zz(e,r,l,o)):Zt(n,517,S_(e,r,7,o,i,"e"));break;case"b":case"e":Zt(n,517,S_(e,r,t.v,o,i,t.t));break;case"s":case"str":if(i.bookSST){var u=Gb(i.Strings,t.v==null?"":String(t.v),i.revStrings);Zt(n,253,jz(e,r,u,o))}else Zt(n,516,$z(e,r,(t.v==null?"":String(t.v)).slice(0,255),o,i));break;default:Zt(n,513,Mc(e,r,o))}}function pW(n,t,e){var r=ni(),i=e.SheetNames[n],s=e.Sheets[i]||{},o=(e||{}).Workbook||{},l=(o.Sheets||[])[n]||{},u=s["!data"]!=null,h=t.biff==8,d="",p=[],g=Nn(s["!ref"]||"A1"),v=h?65536:16384;if(g.e.c>255||g.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV"+v);g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.r,v-1)}Zt(r,2057,Hb(e,16,t)),Zt(r,13,Rs(1)),Zt(r,12,Rs(100)),Zt(r,15,Jr(!0)),Zt(r,17,Jr(!1)),Zt(r,16,Lc(.001)),Zt(r,95,Jr(!0)),Zt(r,42,Jr(!1)),Zt(r,43,Jr(!1)),Zt(r,130,Rs(1)),Zt(r,128,Kz()),Zt(r,131,Jr(!1)),Zt(r,132,Jr(!1)),h&&hW(r,s["!cols"]),Zt(r,512,Xz(g,t));var y=(((e||{}).Workbook||{}).WBProps||{}).date1904;h&&(s["!links"]=[]);for(var _=g.s.c;_<=g.e.c;++_)p[_]=vn(_);for(var b=[],E=[],S=g.s.r;S<=g.e.r;++S)for(u&&(E=s["!data"][S]||[]),d=wn(S),_=g.s.c;_<=g.e.c;++_){var T=u?E[_]:s[p[_]+d];T&&(dW(r,T,S,_,t,y),h&&T.l&&s["!links"].push([p[_]+d,T.l]),T.c&&b.push([T.c,S,_]))}var O=l.CodeName||l.name||i;return h?aW(r,b):eR(r,b),h&&Zt(r,574,zz((o.Views||[])[0])),h&&(s["!merges"]||[]).length&&Zt(r,229,Jz(s["!merges"])),h&&fW(r,s),Zt(r,442,NO(O)),h&&cW(r,s),Zt(r,10),r.end()}function gW(n,t,e){var r=ni(),i=(n||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},l=e.biff==8,u=e.biff==5;if(Zt(r,2057,Hb(n,5,e)),e.bookType=="xla"&&Zt(r,135),Zt(r,225,l?Rs(1200):null),Zt(r,193,Cz(2)),u&&Zt(r,191),u&&Zt(r,192),Zt(r,226),Zt(r,92,Pz("SheetJS",e)),Zt(r,66,Rs(l?1200:1252)),l&&Zt(r,353,Rs(0)),l&&Zt(r,448),Zt(r,317,sH(n.SheetNames.length)),l&&n.vbaraw&&Zt(r,211),l&&n.vbaraw){var h=o.CodeName||"ThisWorkbook";Zt(r,442,NO(h))}Zt(r,156,Rs(17)),Zt(r,25,Jr(!1)),Zt(r,18,Jr(!1)),Zt(r,19,Rs(0)),l&&Zt(r,431,Jr(!1)),l&&Zt(r,444,Rs(0)),Zt(r,61,Uz()),Zt(r,64,Jr(!1)),Zt(r,141,Rs(0)),Zt(r,34,Jr(bV(n)=="true")),Zt(r,14,Jr(!0)),l&&Zt(r,439,Jr(!1)),Zt(r,218,Rs(0)),oW(r,n,e),lW(r,n.SSF,e),uW(r,e),l&&Zt(r,352,Jr(!1));var d=r.end(),p=ni();l&&Zt(p,140,nH()),l&&Os.length&&Zt(p,235,sW()),l&&e.Strings&&tW(p,252,Bz(e.Strings)),Zt(p,10);var g=p.end(),v=ni(),y=0,_=0;for(_=0;_<n.SheetNames.length;++_)y+=(l?12:11)+(l?2:1)*n.SheetNames[_].length;var b=d.length+y+g.length;for(_=0;_<n.SheetNames.length;++_){var E=s[_]||{};Zt(v,133,Fz({pos:b,hs:E.Hidden||0,dt:0,name:n.SheetNames[_]},e)),b+=t[_].length}var S=v.end();if(y!=S.length)throw new Error("BS8 "+y+" != "+S.length);var T=[];return d.length&&T.push(d),S.length&&T.push(S),g.length&&T.push(g),lr(T)}function mW(n,t){var e=t||{},r=[];n&&!n.SSF&&(n.SSF=ii(Rn)),n&&n.SSF&&(Wm(),Vm(n.SSF),e.revssf=Xm(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),Qs=1,Os=[],e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Vb(e),e.cellXfs=[],Il(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=pW(i,e,n);return r.unshift(gW(n,r,e)),lr(r)}function nR(n,t){for(var e=0;e<=n.SheetNames.length;++e){var r=n.Sheets[n.SheetNames[e]];if(!(!r||!r["!ref"])){var i=Ur(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost."),i.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond row 65536.  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return mW(n,t);case 4:case 3:case 2:return iW(n,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function vW(n,t,e,r){for(var i=n["!merges"]||[],s=[],o={},l=n["!data"]!=null,u=t.s.c;u<=t.e.c;++u){for(var h=0,d=0,p=0;p<i.length;++p)if(!(i[p].s.r>e||i[p].s.c>u)&&!(i[p].e.r<e||i[p].e.c<u)){if(i[p].s.r<e||i[p].s.c<u){h=-1;break}h=i[p].e.r-i[p].s.r+1,d=i[p].e.c-i[p].s.c+1;break}if(!(h<0)){var g=vn(u)+wn(e),v=l?(n["!data"][e]||[])[u]:n[g];v&&v.t=="n"&&v.v!=null&&!isFinite(v.v)&&(isNaN(v.v)?v={t:"e",v:36,w:Ti[36]}:v={t:"e",v:7,w:Ti[7]});var y=v&&v.v!=null&&(v.h||x_(v.w||(Io(v),v.w)||""))||"";o={},h>1&&(o.rowspan=h),d>1&&(o.colspan=d),r.editable?y='<span contenteditable="true">'+y+"</span>":v&&(o["data-t"]=v&&v.t||"z",v.v!=null&&(o["data-v"]=x_(v.v instanceof Date?v.v.toISOString():v.v)),v.z!=null&&(o["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x_(v.l.Target)+'">'+y+"</a>")),o.id=(r.id||"sjs")+"-"+g,s.push(re("td",y,o))}}var _="<tr>";return _+s.join("")+"</tr>"}var _W='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',yW="</body></html>";function bW(n,t,e){var r=[];return r.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function rR(n,t){var e=t||{},r=e.header!=null?e.header:_W,i=e.footer!=null?e.footer:yW,s=[r],o=Ur(n["!ref"]||"A1");if(s.push(bW(n,o,e)),n["!ref"])for(var l=o.s.r;l<=o.e.r;++l)s.push(vW(n,o,l,e));return s.push("</table>"+i),s.join("")}function iR(n,t,e){var r=t.rows;if(!r)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var i=e||{},s=n["!data"]!=null,o=0,l=0;if(i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var u=typeof i.origin=="string"?Fn(i.origin):i.origin;o=u.r,l=u.c}var h=Math.min(i.sheetRows||1e7,r.length),d={s:{r:0,c:0},e:{r:o,c:l}};if(n["!ref"]){var p=Ur(n["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),o==-1&&(d.e.r=o=p.e.r+1)}var g=[],v=0,y=n["!rows"]||(n["!rows"]=[]),_=0,b=0,E=0,S=0,T=0,O=0;for(n["!cols"]||(n["!cols"]=[]);_<r.length&&b<h;++_){var R=r[_];if(ES(R)){if(i.display)continue;y[b]={hidden:!0}}var N=R.cells;for(E=S=0;E<N.length;++E){var C=N[E];if(!(i.display&&ES(C))){var I=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):F9(C.innerHTML),M=C.getAttribute("data-z")||C.getAttribute("z");for(v=0;v<g.length;++v){var F=g[v];F.s.c==S+l&&F.s.r<b+o&&b+o<=F.e.r&&(S=F.e.c+1-l,v=-1)}O=+C.getAttribute("colspan")||1,((T=+C.getAttribute("rowspan")||1)>1||O>1)&&g.push({s:{r:b+o,c:S+l},e:{r:b+o+(T||1)-1,c:S+l+(O||1)-1}});var H={t:"s",v:I},P=C.getAttribute("data-t")||C.getAttribute("t")||"";I!=null&&(I.length==0?H.t=P||"z":i.raw||I.trim().length==0||P=="s"||(P=="e"&&Ti[+I]?H={t:"e",v:+I,w:Ti[+I]}:I==="TRUE"?H={t:"b",v:!0}:I==="FALSE"?H={t:"b",v:!1}:isNaN(Oo(I))?isNaN(im(I).getDate())?I.charCodeAt(0)==35&&Fa[I]!=null&&(H={t:"e",v:Fa[I],w:I}):(H={t:"d",v:$i(I)},i.UTC&&(H.v=Ym(H.v)),i.cellDates||(H={t:"n",v:zr(H.v)}),H.z=i.dateNF||Rn[14]):H={t:"n",v:Oo(I)})),H.z===void 0&&M!=null&&(H.z=M);var et="",L=C.getElementsByTagName("A");if(L&&L.length)for(var st=0;st<L.length&&!(L[st].hasAttribute("href")&&(et=L[st].getAttribute("href"),et.charAt(0)!="#"));++st);et&&et.charAt(0)!="#"&&et.slice(0,11).toLowerCase()!="javascript:"&&(H.l={Target:et}),s?(n["!data"][b+o]||(n["!data"][b+o]=[]),n["!data"][b+o][S+l]=H):n[jn({c:S+l,r:b+o})]=H,d.e.c<S+l&&(d.e.c=S+l),S+=O}}++b}return g.length&&(n["!merges"]=(n["!merges"]||[]).concat(g)),d.e.r=Math.max(d.e.r,b-1+o),n["!ref"]=ur(d),b>=h&&(n["!fullref"]=ur((d.e.r=r.length-_+b-1+o,d))),n}function sR(n,t){var e=t||{},r={};return e.dense&&(r["!data"]=[]),iR(r,n,t)}function xW(n,t){var e=Ef(sR(n,t),t);return e}function ES(n){var t="",e=EW(n);return e&&(t=e(n).getPropertyValue("display")),t||(t=n.style&&n.style.display),t==="none"}function EW(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var wW=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Fd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return fr+t}}();function AW(n,t){var e="number",r="",i={"style:name":t},s="",o=0;n=n.replace(/"[$]"/g,"$");t:{if(n.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+n),n=n.slice(0,n.indexOf(";"))),n=="@"){e="text",r="<number:text-content/>";break t}if(n.indexOf(/\$/)>-1&&(e="currency"),n[o]=='"'){for(s="";n[++o]!='"'||n[++o]=='"';)s+=n[o];--o,n[o+1]=="*"?(o++,r+="<number:fill-character>"+$e(s.replace(/""/g,'"'))+"</number:fill-character>"):r+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>",n=n.slice(o+1),o=0}var l=n.match(/# (\?+)\/(\?+)/);if(l){r+=re("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break t}if(l=n.match(/# (\?+)\/(\d+)/)){r+=re("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break t}if(l=n.match(/\b(\d+)(|\.\d+)%/)){e="percentage",r+=re("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break t}var u=!1;if(["y","m","d"].indexOf(n[0])>-1){e="date";e:for(;o<n.length;++o)switch(s=n[o].toLowerCase()){case"h":case"s":u=!0,--o;break e;case"m":n:for(var h=o+1;h<n.length;++h)switch(n[h]){case"y":case"d":break n;case"h":case"s":u=!0,--o;break e}case"y":case"d":for(;(n[++o]||"").toLowerCase()==s[0];)s+=s[0];switch(--o,s){case"y":case"yy":r+="<number:year/>";break;case"yyy":case"yyyy":r+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":r+='<number:month number:style="'+(s.length%2?"short":"long")+'" number:textual="'+(s.length>=3?"true":"false")+'"/>';break;case"d":case"dd":r+='<number:day number:style="'+(s.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":r+='<number:day-of-week number:style="'+(s.length%2?"short":"long")+'"/>';break}break;case'"':for(;n[++o]!='"'||n[++o]=='"';)s+=n[o];--o,r+="<number:text>"+$e(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":s=n[++o],r+="<number:text>"+$e(s)+"</number:text>";break;case"/":case":":r+="<number:text>"+$e(s)+"</number:text>";break;default:console.error("unrecognized character "+s+" in ODF format "+n)}if(!u)break t;n=n.slice(o+1),o=0}if(n.match(/^\[?[hms]/)){for(e=="number"&&(e="time"),n.match(/\[/)&&(n=n.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");o<n.length;++o)switch(s=n[o].toLowerCase()){case"h":case"m":case"s":for(;(n[++o]||"").toLowerCase()==s[0];)s+=s[0];switch(--o,s){case"h":case"hh":r+='<number:hours number:style="'+(s.length%2?"short":"long")+'"/>';break;case"m":case"mm":r+='<number:minutes number:style="'+(s.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(n[o+1]==".")do s+=n[o+1],++o;while(n[o+1]=="0");r+='<number:seconds number:style="'+(s.match("ss")?"long":"short")+'"'+(s.match(/\./)?' number:decimal-places="'+(s.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;n[++o]!='"'||n[++o]=='"';)s+=n[o];--o,r+="<number:text>"+$e(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":r+="<number:text>"+$e(s)+"</number:text>";break;case"a":if(n.slice(o,o+3).toLowerCase()=="a/p"){r+="<number:am-pm/>",o+=2;break}if(n.slice(o,o+5).toLowerCase()=="am/pm"){r+="<number:am-pm/>",o+=4;break}default:console.error("unrecognized character "+s+" in ODF format "+n)}break t}if(n.indexOf(/\$/)>-1&&(e="currency"),n[0]=="$"&&(r+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',n=n.slice(1),o=0),o=0,n[o]=='"'){for(;n[++o]!='"'||n[++o]=='"';)s+=n[o];--o,n[o+1]=="*"?(o++,r+="<number:fill-character>"+$e(s.replace(/""/g,'"'))+"</number:fill-character>"):r+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>",n=n.slice(o+1),o=0}var d=n.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+n);else{var p=d[1].replace(/,/g,"");r+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(p.indexOf("0")==-1?"0":p.length-p.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",o=d.index+d[0].length}if(n[o]=='"'){for(s="";n[++o]!='"'||n[++o]=='"';)s+=n[o];--o,r+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>"}}return r?re("number:"+e+"-style",r,i):(console.error("Could not generate ODS number format for |"+n+"|"),"")}function wS(n,t,e){for(var r=[],i=0;i<n.length;++i){var s=n[i];s&&s.Sheet==(e==-1?null:e)&&r.push(s)}return r.length?`      <table:named-expressions>
`+r.map(function(o){var l=(e==-1?"$":"")+KO(o.Ref);return"        "+re("table:named-range",null,{"table:name":o.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var AS=function(){var n=function(i,s){return $e(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=function(i,s,o,l,u,h){var d=[];d.push('      <table:table table:name="'+$e(s.SheetNames[o])+`" table:style-name="ta1">
`);var p=0,g=0,v=Ur(i["!ref"]||"A1"),y=i["!merges"]||[],_=0,b=i["!data"]!=null;if(i["!cols"])for(g=0;g<=v.e.c;++g)d.push("        <table:table-column"+(i["!cols"][g]?' table:style-name="co'+i["!cols"][g].ods+'"':"")+`></table:table-column>
`);var E="",S=i["!rows"]||[];for(p=0;p<v.s.r;++p)E=S[p]?' table:style-name="ro'+S[p].ods+'"':"",d.push("        <table:table-row"+E+`></table:table-row>
`);for(;p<=v.e.r;++p){for(E=S[p]?' table:style-name="ro'+S[p].ods+'"':"",d.push("        <table:table-row"+E+`>
`),g=0;g<v.s.c;++g)d.push(t);for(;g<=v.e.c;++g){var T=!1,O={},R="";for(_=0;_!=y.length;++_)if(!(y[_].s.c>g)&&!(y[_].s.r>p)&&!(y[_].e.c<g)&&!(y[_].e.r<p)){(y[_].s.c!=g||y[_].s.r!=p)&&(T=!0),O["table:number-columns-spanned"]=y[_].e.c-y[_].s.c+1,O["table:number-rows-spanned"]=y[_].e.r-y[_].s.r+1;break}if(T){d.push(`          <table:covered-table-cell/>
`);continue}var N=jn({r:p,c:g}),C=b?(i["!data"][p]||[])[g]:i[N];if(C&&C.f&&(O["table:formula"]=$e(V$(C.f)),C.F&&C.F.slice(0,N.length)==N)){var I=Ur(C.F);O["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,O["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!C){d.push(t);continue}switch(C.t){case"b":R=C.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=C.v?"true":"false";break;case"n":isFinite(C.v)?(R=C.w||String(C.v||0),O["office:value-type"]="float",O["office:value"]=C.v||0):(isNaN(C.v)?(R="#NUM!",O["table:formula"]="of:=#NUM!"):(R="#DIV/0!",O["table:formula"]="of:="+(C.v<0?"-":"")+"1/0"),O["office:string-value"]="",O["office:value-type"]="string",O["calcext:value-type"]="error");break;case"s":case"str":R=C.v==null?"":C.v,O["office:value-type"]="string";break;case"d":R=C.w||$i(C.v,h).toISOString(),O["office:value-type"]="date",O["office:date-value"]=$i(C.v,h).toISOString(),O["table:style-name"]="ce1";break;default:d.push(t);continue}var M=n(R);if(C.l&&C.l.Target){var F=C.l.Target;F=F.charAt(0)=="#"?"#"+KO(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),M=re("text:a",M,{"xlink:href":F.replace(/&/g,"&amp;")})}u[C.z]&&(O["table:style-name"]="ce"+u[C.z].slice(1));var H=re("text:p",M,{});if(C.c){for(var P="",et="",L={},st=0;st<C.c.length;++st)!P&&C.c[st].a&&(P=C.c[st].a),et+="<text:p>"+n(C.c[st].t)+"</text:p>";C.c.hidden||(L["office:display"]=!0),H=re("office:annotation",et,L)+H}d.push("          "+re("table:table-cell",H,O)+`
`)}d.push(`        </table:table-row>
`)}return(s.Workbook||{}).Names&&d.push(wS(s.Workbook.Names,s.SheetNames,o)),d.push(`      </table:table>
`),d.join("")},r=function(i,s){i.push(` <office:automatic-styles>
`);var o=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var g=d["!cols"][p];if(g.width==null&&g.wpx==null&&g.wch==null)continue;jb(g),g.ods=o;var v=d["!cols"][p].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=l;var g=d["!rows"][p].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u={},h=69;return s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d){var p=d["!data"]!=null;if(d["!ref"])for(var g=Ur(d["!ref"]),v=0;v<=g.e.r;++v)for(var y=0;y<=g.e.c;++y){var _=p?(d["!data"][v]||[])[y]:d[jn({r:v,c:y})];if(!(!_||!_.z||_.z.toLowerCase()=="general")&&!u[_.z]){var b=AW(_.z,"N"+h);b&&(u[_.z]="N"+h,++h,i.push(b+`
`))}}}}),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),cr(u).forEach(function(d){i.push('<style:style style:name="ce'+u[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+u[d]+`"/>
`)}),i.push(` </office:automatic-styles>
`),u};return function(s,o){var l=[fr],u=Fd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Fd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+h+`>
`),l.push(wO().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+u+`>
`);var d=r(l,s);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((s.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var p=0;p!=s.SheetNames.length;++p)l.push(e(s.Sheets[s.SheetNames[p]],s,p,o,d,((s.Workbook||{}).WBProps||{}).date1904));return(s.Workbook||{}).Names&&l.push(wS(s.Workbook.Names,s.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function aR(n,t){if(t.bookType=="fods")return AS(n,t);var e=Nb(),r="",i=[],s=[];return r="mimetype",je(e,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",je(e,r,AS(n,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",je(e,r,wW(n,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",je(e,r,fr+wO()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",je(e,r,Ez(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",je(e,r,bz(i)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var Ei=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function fm(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function Hd(n){return typeof TextDecoder<"u"?new TextDecoder().decode(n):Yu(Nc(n))}function yi(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):is(Pd(n))}function Nl(n){for(var t=0,e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0;e<n.length;++e){var s=n[e],o=s.length;if(o<250)for(var l=0;l<o;++l)r[i++]=s[l];else r.set(s,i),i+=o}return r}function SW(n,t,e){var r=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-16,i=e/Math.pow(10,r-6176);n[t+15]|=r>>7,n[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[t+s]=i&255;n[t+15]|=e>=0?0:128}function jd(n,t){var e=t.l,r=n[e]&127;t:if(n[e++]>=128&&(r|=(n[e]&127)<<7,n[e++]<128||(r|=(n[e]&127)<<14,n[e++]<128)||(r|=(n[e]&127)<<21,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,28),++e,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,35),++e,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,42),++e,n[e++]<128)))break t;return t.l=e,r}function ge(n){var t=new Uint8Array(7);t[0]=n&127;var e=1;t:if(n>127){if(t[e-1]|=128,t[e]=n>>7&127,++e,n<=16383||(t[e-1]|=128,t[e]=n>>14&127,++e,n<=2097151)||(t[e-1]|=128,t[e]=n>>21&127,++e,n<=268435455)||(t[e-1]|=128,t[e]=n/256>>>21&127,++e,n<=34359738367)||(t[e-1]|=128,t[e]=n/65536>>>21&127,++e,n<=4398046511103))break t;t[e-1]|=128,t[e]=n/16777216>>>21&127,++e}return t[Ei](0,e)}function oR(n){for(var t={l:0},e=[];t.l<n.length;)e.push(jd(n,t));return e}function lR(n){return Nl(n.map(function(t){return ge(t)}))}function ls(n){var t=0,e=n[t]&127;return n[t++]<128||(e|=(n[t]&127)<<7,n[t++]<128)||(e|=(n[t]&127)<<14,n[t++]<128)||(e|=(n[t]&127)<<21,n[t++]<128)||(e|=(n[t]&15)<<28),e}function Ee(n){for(var t=[],e={l:0};e.l<n.length;){var r=e.l,i=jd(n,e),s=i&7;i=i/8|0;var o,l=e.l;switch(s){case 0:{for(;n[l++]>=128;);o=n[Ei](e.l,l),e.l=l}break;case 1:o=n[Ei](l,l+8),e.l=l+8;break;case 2:{var u=jd(n,e);o=n[Ei](e.l,e.l+u),e.l+=u}break;case 5:o=n[Ei](l,l+4),e.l=l+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var h={data:o,type:s};t[i]==null&&(t[i]=[]),t[i].push(h)}return t}function me(n){var t=[];return n.forEach(function(e,r){r!=0&&e.forEach(function(i){i.data&&(t.push(ge(r*8+i.type)),i.type==2&&t.push(ge(i.data.length)),t.push(i.data))})}),Nl(t)}function hm(n,t){return n?.map(function(e){return t(e.data)})||[]}function dm(n){for(var t,e=[],r={l:0};r.l<n.length;){var i=jd(n,r),s=Ee(n[Ei](r.l,r.l+i));r.l+=i;var o={id:ls(s[1][0].data),messages:[]};s[2].forEach(function(l){var u=Ee(l.data),h=ls(u[3][0].data);o.messages.push({meta:u,data:n[Ei](r.l,r.l+h)}),r.l+=h}),(t=s[3])!=null&&t[0]&&(o.merge=ls(s[3][0].data)>>>0>0),e.push(o)}return e}function Zu(n){var t=[];return n.forEach(function(e){var r=[[],[{data:ge(e.id),type:0}],[]];e.merge!=null&&(r[3]=[{data:ge(+!!e.merge),type:0}]);var i=[];e.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:ge(o.data.length)}],r[2].push({data:me(o.meta),type:2})});var s=me(r);t.push(ge(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),Nl(t)}function TW(n,t){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var e={l:0},r=jd(t,e),i=[],s=e.l;s<t.length;){var o=t[s]&3;if(o==0){var l=t[s++]>>2;if(l<60)++l;else{var u=l-59;l=t[s],u>1&&(l|=t[s+1]<<8),u>2&&(l|=t[s+2]<<16),u>3&&(l|=t[s+3]<<24),l>>>=0,l++,s+=u}i.push(t[Ei](s,s+l)),s+=l;continue}else{var h=0,d=0;if(o==1?(d=(t[s]>>2&7)+4,h=(t[s++]&224)<<3,h|=t[s++]):(d=(t[s++]>>2)+1,o==2?(h=t[s]|t[s+1]<<8,s+=2):(h=(t[s]|t[s+1]<<8|t[s+2]<<16|t[s+3]<<24)>>>0,s+=4)),h==0)throw new Error("Invalid offset 0");for(var p=i.length-1,g=h;p>=0&&g>=i[p].length;)g-=i[p].length,--p;if(p<0)if(g==0)g=i[p=0].length;else throw new Error("Invalid offset beyond length");if(d<g)i.push(i[p][Ei](i[p].length-g,i[p].length-g+d));else{for(g>0&&(i.push(i[p][Ei](i[p].length-g)),d-=g),++p;d>=i[p].length;)i.push(i[p]),d-=i[p].length,++p;d&&i.push(i[p][Ei](0,d))}i.length>25&&(i=[Nl(i)])}}for(var v=0,y=0;y<i.length;++y)v+=i[y].length;if(v!=r)throw new Error("Unexpected length: ".concat(v," != ").concat(r));return i}function pm(n){Array.isArray(n)&&(n=new Uint8Array(n));for(var t=[],e=0;e<n.length;){var r=n[e++],i=n[e]|n[e+1]<<8|n[e+2]<<16;e+=3,t.push.apply(t,TW(r,n[Ei](e,e+i))),e+=i}if(e!==n.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:Nl(t)}function Qu(n){for(var t=[],e=0;e<n.length;){var r=Math.min(n.length-e,268435455),i=new Uint8Array(4);t.push(i);var s=ge(r),o=s.length;t.push(s),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(n[Ei](e,e+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,e+=r}return Nl(t)}function k_(n,t){var e=new Uint8Array(32),r=fm(e),i=12,s=0;switch(e[0]=5,n.t){case"n":if(n.z&&kc(n.z)){e[1]=5,r.setFloat64(i,(Xu(n.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,i+=8;break}else e[1]=2,SW(e,i,n.v),s|=1,i+=16;break;case"b":e[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":{var o=n.v==null?"":String(n.v);if(n.l){var l=t.rsst.findIndex(function(h){var d;return h.v==o&&h.l==((d=n.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:o,l:n.l.Target}),e[1]=9,r.setUint32(i,l,!0),s|=16,i+=4}else{var u=t.sst.indexOf(o);u==-1&&(t.sst[u=t.sst.length]=o),e[1]=3,r.setUint32(i,u,!0),s|=8,i+=4}}break;case"d":e[1]=5,r.setFloat64(i,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,i+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+n.t}return n.c&&(t.cmnt.push(CW(n.c)),r.setUint32(i,t.cmnt.length-1,!0),s|=524288,i+=4),r.setUint32(8,s,!0),e[Ei](0,i)}function L_(n,t){var e=new Uint8Array(32),r=fm(e),i=12,s=0,o="";switch(e[0]=4,n.t){case"n":break;case"b":break;case"s":if(o=n.v==null?"":String(n.v),n.l){var l=t.rsst.findIndex(function(h){var d;return h.v==o&&h.l==((d=n.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:o,l:n.l.Target}),e[1]=9,r.setUint32(i,l,!0),s|=512,i+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+n.t}switch(n.c&&(r.setUint32(i,t.cmnt.length-1,!0),s|=4096,i+=4),n.t){case"n":e[1]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":e[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(o=n.v==null?"":String(n.v),!n.l){var u=t.sst.indexOf(o);u==-1&&(t.sst[u=t.sst.length]=o),e[1]=3,r.setUint32(i,u,!0),s|=16,i+=4}break;case"d":e[1]=5,r.setFloat64(i,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=64,i+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),e[Ei](0,i)}function ar(n){var t=Ee(n);return ls(t[1][0].data)}function Qr(n){return me([[],[{type:0,data:ge(n)}]])}function Zr(n,t){var e,r=(e=n.messages[0].meta[5])!=null&&e[0]?oR(n.messages[0].meta[5][0].data):[],i=r.indexOf(t);i==-1&&(r.push(t),n.messages[0].meta[5]=[{type:2,data:lR(r)}])}function wo(n,t){var e,r=(e=n.messages[0].meta[5])!=null&&e[0]?oR(n.messages[0].meta[5][0].data):[];n.messages[0].meta[5]=[{type:2,data:lR(r.filter(function(i){return i!=t}))}]}function CW(n){for(var t={a:"",t:"",replies:[]},e=0;e<n.length;++e)e==0?(t.a=n[e].a,t.t=n[e].t):t.replies.push({a:n[e].a,t:n[e].t});return t}function DW(n,t,e){var r,i,s,o=[[],[{type:0,data:ge(0)}],[{type:0,data:ge(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ge(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ge(1)}]];if(!((r=o[6])!=null&&r[0])||!((i=o[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(o[7][0].data.length<2*n.length){var u=new Uint8Array(2*n.length);u.set(o[7][0].data),o[7][0].data=u}if(o[4][0].data.length<2*n.length){var h=new Uint8Array(2*n.length);h.set(o[4][0].data),o[4][0].data=h}for(var d=fm(o[7][0].data),p=0,g=[],v=fm(o[4][0].data),y=0,_=[],b=4,E=0;E<n.length;++E){if(n[E]==null||n[E].t=="z"&&!((s=n[E].c)!=null&&s.length)||n[E].t=="e"){d.setUint16(E*2,65535,!0),v.setUint16(E*2,65535);continue}d.setUint16(E*2,p/b,!0),v.setUint16(E*2,y/b,!0);var S,T;switch(n[E].t){case"d":if(n[E].v instanceof Date){S=k_(n[E],t),T=L_(n[E],t);break}S=k_(n[E],t),T=L_(n[E],t);break;case"s":case"n":case"b":case"z":S=k_(n[E],t),T=L_(n[E],t);break;default:throw new Error("Unsupported value "+n[E])}g.push(S),p+=S.length,_.push(T),y+=T.length,++l}for(o[2][0].data=ge(l),o[5][0].data=ge(5);E<o[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),v.setUint16(E*2,65535,!0);return o[6][0].data=Nl(g),o[3][0].data=Nl(_),o[8]=[{type:0,data:ge(1)}],o}function fy(n,t){return{meta:[[],[{type:0,data:ge(n)}]],data:t}}function Ma(n,t){t.last||(t.last=927262);for(var e=t.last;e<2e6;++e)if(!t[e])return t[t.last=e]=n,e;throw new Error("Too many messages")}function OW(n){var t={},e=[];return n.FileIndex.map(function(r,i){return[r,n.FullPaths[i]]}).forEach(function(r){var i=r[0],s=r[1];i.type==2&&i.name.match(/\.iwa/)&&i.content[0]==0&&dm(pm(i.content)).forEach(function(o){e.push(o.id),t[o.id]={deps:[],location:s,type:ls(o.messages[0].meta[1][0].data)}})}),n.FileIndex.forEach(function(r){r.name.match(/\.iwa/)&&r.content[0]==0&&dm(pm(r.content)).forEach(function(i){i.messages.forEach(function(s){[5,6].forEach(function(o){s.meta[o]&&s.meta[o].forEach(function(l){t[i.id].deps.push(ls(l.data))})})})})}),t}function pg(n,t,e){return me([[],[{type:0,data:ge(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([n/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:ge(1)}]])}function SS(n){switch(n){case 0:return pg(99,222,171);case 1:return pg(162,197,240);case 2:return pg(255,189,189)}return pg(Math.random()*255,Math.random()*255,Math.random()*255)}function RW(n,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=Tn.read(t.numbers,{type:"base64"}),r=OW(e),i=Ia(e,r,1);if(i==null)throw"Could not find message ".concat(1," in Numbers template");var s=hm(Ee(i.messages[0].data)[1],ar);if(s.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return n.SheetNames.forEach(function(o,l){l>=1&&(kW(e,r,l+1),i=Ia(e,r,1),s=hm(Ee(i.messages[0].data)[1],ar)),LW(e,r,n.Sheets[o],o,l,s[l])}),e}function mn(n,t,e,r){var i=Tn.find(n,t[e].location);if(!i)throw"Could not find ".concat(t[e].location," in Numbers template");var s=dm(pm(i.content)),o=s.find(function(l){return l.id==e});r(o,s),i.content=Qu(Zu(s)),i.size=i.content.length}function Ia(n,t,e){var r=Tn.find(n,t[e].location);if(!r)throw"Could not find ".concat(t[e].location," in Numbers template");var i=dm(pm(r.content)),s=i.find(function(o){return o.id==e});return s}function hy(n,t,e){n[3].push({type:2,data:me([[],[{type:0,data:ge(t)}],[{type:2,data:yi(e.replace(/-[\s\S]*$/,""))}],[{type:2,data:yi(e)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ge(0)}],[],[{type:0,data:ge(0)}]])}),n[1]=[{type:0,data:ge(Math.max(t+1,ls(n[1][0].data)))}]}function uc(n,t,e,r,i,s){s||(s=Ma({deps:[],location:"",type:t},i));var o="".concat(r,"-").concat(s,".iwa");i[s].location="Root Entry"+o,Tn.utils.cfb_add(n,o,Qu(Zu([{id:s,messages:[fy(t,me(e))]}])));var l=o.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return mn(n,i,2,function(u){var h=Ee(u.messages[0].data);hy(h,s||0,l),u.messages[0].data=me(h)}),s}function zi(n,t,e,r){var i=t[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=n[3].findIndex(function(l){var u,h,d=Ee(l.data);return(u=d[3])!=null&&u[0]?Hd(d[3][0].data)==i:!!((h=d[2])!=null&&h[0]&&Hd(d[2][0].data)==i)}),o=Ee(n[3][s].data);o[6]||(o[6]=[]),(Array.isArray(r)?r:[r]).forEach(function(l){o[6].push({type:2,data:me([[],[{type:0,data:ge(l)}]])})}),n[3][s].data=me(o)}function NW(n,t,e,r){var i=t[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=n[3].findIndex(function(l){var u,h,d=Ee(l.data);return(u=d[3])!=null&&u[0]?Hd(d[3][0].data)==i:!!((h=d[2])!=null&&h[0]&&Hd(d[2][0].data)==i)}),o=Ee(n[3][s].data);o[6]||(o[6]=[]),o[6]=o[6].filter(function(l){return ls(Ee(l.data)[1][0].data)!=r}),n[3][s].data=me(o)}function kW(n,t,e){var r=-1,i=-1,s={};mn(n,t,1,function(u,h){var d=Ee(u.messages[0].data);r=ar(Ee(u.messages[0].data)[1][0].data),i=Ma({deps:[1],location:t[r].location,type:2},t),s[r]=i,Zr(u,i),d[1].push({type:2,data:Qr(i)});var p=Ia(n,t,r);p.id=i,t[1].location==t[i].location?h.push(p):mn(n,t,i,function(g,v){return v.push(p)}),u.messages[0].data=me(d)});var o=-1;mn(n,t,i,function(u,h){for(var d=Ee(u.messages[0].data),p=3;p<=69;++p)delete d[p];var g=hm(d[2],ar);g.forEach(function(y){return wo(u,y)}),o=Ma({deps:[i],location:t[g[0]].location,type:t[g[0]].type},t),Zr(u,o),s[g[0]]=o,d[2]=[{type:2,data:Qr(o)}];var v=Ia(n,t,g[0]);v.id=o,t[g[0]].location==t[i].location?h.push(v):(mn(n,t,2,function(y){var _=Ee(y.messages[0].data);zi(_,t,i,o),y.messages[0].data=me(_)}),mn(n,t,o,function(y,_){return _.push(v)})),u.messages[0].data=me(d)});var l=-1;mn(n,t,o,function(u,h){for(var d=Ee(u.messages[0].data),p=Ee(d[1][0].data),g=3;g<=69;++g)delete p[g];var v=ar(p[2][0].data);p[2][0].data=Qr(s[v]),d[1][0].data=me(p);var y=ar(d[2][0].data);wo(u,y),l=Ma({deps:[o],location:t[y].location,type:t[y].type},t),Zr(u,l),s[y]=l,d[2][0].data=Qr(l);var _=Ia(n,t,y);_.id=l,t[o].location==t[l].location?h.push(_):mn(n,t,l,function(b,E){return E.push(_)}),u.messages[0].data=me(d)}),mn(n,t,l,function(u,h){var d,p,g=Ee(u.messages[0].data),v=Hd(g[1][0].data),y=v.replace(/-[A-Z0-9]*/,"-".concat(("0000"+e.toString(16)).slice(-4)));if(g[1][0].data=yi(y),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(R){return delete g[R]}),g[45]){var _=Ee(g[45][0].data),b=ar(_[1][0].data);wo(u,b),delete g[45]}if(g[70]){var E=Ee(g[70][0].data);(d=E[2])==null||d.forEach(function(R){var N=Ee(R.data);[2,3].map(function(C){return N[C][0]}).forEach(function(C){var I=Ee(C.data);if(I[8]){var M=ar(I[8][0].data);wo(u,M)}})}),delete g[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(R){if(g[R]){var N=ar(g[R][0].data);delete g[R],wo(u,N)}});var S=Ee(g[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(R){var N;if((N=S[R])!=null&&N[0]){var C=ar(S[R][0].data),I=Ma({deps:[l],location:t[C].location,type:t[C].type},t);wo(u,C),Zr(u,I),s[C]=I;var M=Ia(n,t,C);if(M.id=I,t[C].location==t[l].location)h.push(M);else{t[I].location=t[C].location.replace(C.toString(),I.toString()),t[I].location==t[C].location&&(t[I].location=t[I].location.replace(/\.iwa/,"-".concat(I,".iwa"))),Tn.utils.cfb_add(n,t[I].location,Qu(Zu([M])));var F=t[I].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");mn(n,t,2,function(H){var P=Ee(H.messages[0].data);hy(P,I,F),zi(P,t,l,I),H.messages[0].data=me(P)})}S[R][0].data=Qr(I)}});var T=Ee(S[1][0].data);(p=T[2])==null||p.forEach(function(R){var N=ar(R.data),C=Ma({deps:[l],location:t[N].location,type:t[N].type},t);wo(u,N),Zr(u,C),s[N]=C;var I=Ia(n,t,N);if(I.id=C,t[N].location==t[l].location)h.push(I);else{t[C].location=t[N].location.replace(N.toString(),C.toString()),t[C].location==t[N].location&&(t[C].location=t[C].location.replace(/\.iwa/,"-".concat(C,".iwa"))),Tn.utils.cfb_add(n,t[C].location,Qu(Zu([I])));var M=t[C].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");mn(n,t,2,function(F){var H=Ee(F.messages[0].data);hy(H,C,M),zi(H,t,l,C),F.messages[0].data=me(H)})}R.data=Qr(C)}),S[1][0].data=me(T);var O=Ee(S[3][0].data);O[1].forEach(function(R){var N=Ee(R.data),C=ar(N[2][0].data),I=s[C];if(!s[C]){I=Ma({deps:[l],location:"",type:t[C].type},t),t[I].location="Root Entry/Index/Tables/Tile-".concat(I,".iwa"),s[C]=I;var M=Ia(n,t,C);M.id=I,wo(u,C),Zr(u,I),Tn.utils.cfb_add(n,"/Index/Tables/Tile-".concat(I,".iwa"),Qu(Zu([M]))),mn(n,t,2,function(F){var H=Ee(F.messages[0].data);H[3].push({type:2,data:me([[],[{type:0,data:ge(I)}],[{type:2,data:yi("Tables/Tile")}],[{type:2,data:yi("Tables/Tile-".concat(I))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ge(0)}],[],[{type:0,data:ge(0)}]])}),H[1]=[{type:0,data:ge(Math.max(I+1,ls(H[1][0].data)))}],zi(H,t,l,I),F.messages[0].data=me(H)})}N[2][0].data=Qr(I),R.data=me(N)}),S[3][0].data=me(O)}g[4][0].data=me(S),u.messages[0].data=me(g)})}function LW(n,t,e,r,i,s){var o=[];mn(n,t,s,function(h){var d=Ee(h.messages[0].data);d[1]=[{type:2,data:yi(r)}],o=hm(d[2],ar),h.messages[0].data=me(d)});var l=Ia(n,t,o[0]),u=ar(Ee(l.messages[0].data)[2][0].data);mn(n,t,u,function(h,d){return MW(n,t,e,h,d,u)})}function MW(n,t,e,r,i,s){if(!e["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var o=Ur(e["!ref"]);o.s.r=o.s.c=0;var l=!1;o.e.c>999&&(l=!0,o.e.c=999),o.e.r>999999&&(l=!0,o.e.r=999999),l&&console.error("Truncating to ".concat(ur(o)));var u=[];if(e["!data"])u=e["!data"];else{for(var h=[],d=0;d<=o.e.c;++d)h[d]=vn(d);for(var p=0;p<=o.e.r;++p){u[p]=[];var g=""+(p+1);for(d=0;d<=o.e.c;++d){var v=e[h[d]+g];v&&(u[p][d]=v)}}}var y={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},_=Ee(r.messages[0].data);{_[6][0].data=ge(o.e.r+1),_[7][0].data=ge(o.e.c+1),delete _[46];var b=Ee(_[4][0].data);{var E=ar(Ee(b[1][0].data)[2][0].data);mn(n,t,E,function(V,ct){var gt,_t=Ee(V.messages[0].data);if((gt=_t?.[2])!=null&&gt[0])for(var Bt=0;Bt<u.length;++Bt){var Gt=Ee(_t[2][0].data);Gt[1][0].data=ge(Bt),Gt[4][0].data=ge(u[Bt].length),_t[2][Bt]={type:_t[2][0].type,data:me(Gt)}}V.messages[0].data=me(_t)});var S=ar(b[2][0].data);mn(n,t,S,function(V,ct){for(var gt=Ee(V.messages[0].data),_t=0;_t<=o.e.c;++_t){var Bt=Ee(gt[2][0].data);Bt[1][0].data=ge(_t),Bt[4][0].data=ge(o.e.r+1),gt[2][_t]={type:gt[2][0].type,data:me(Bt)}}V.messages[0].data=me(gt)});var T=Ee(b[9][0].data);T[1]=[];var O=Ee(b[3][0].data);{var R=256;O[2]=[{type:0,data:ge(R)}];var N=ar(Ee(O[1][0].data)[2][0].data),C=function(){var V=Ia(n,t,2),ct=Ee(V.messages[0].data),gt=ct[3].filter(function(_t){return ls(Ee(_t.data)[1][0].data)==N});return gt?.length?ls(Ee(gt[0].data)[12][0].data):0}();Tn.utils.cfb_del(n,t[N].location),mn(n,t,2,function(V){var ct=Ee(V.messages[0].data);ct[3]=ct[3].filter(function(gt){return ls(Ee(gt.data)[1][0].data)!=N}),NW(ct,t,s,N),V.messages[0].data=me(ct)}),wo(r,N),O[1]=[];for(var I=Math.ceil((o.e.r+1)/R),M=0;M<I;++M){var F=Ma({deps:[],location:"",type:6002},t);t[F].location="Root Entry/Index/Tables/Tile-".concat(F,".iwa");for(var H=[[],[{type:0,data:ge(0)}],[{type:0,data:ge(Math.min(o.e.r+1,(M+1)*R))}],[{type:0,data:ge(0)}],[{type:0,data:ge(Math.min((M+1)*R,o.e.r+1)-M*R)}],[],[{type:0,data:ge(5)}],[{type:0,data:ge(1)}],[{type:0,data:ge(1)}]],P=M*R;P<=Math.min(o.e.r,(M+1)*R-1);++P){var et=DW(u[P],y);et[1][0].data=ge(P-M*R),H[5].push({data:me(et),type:2})}O[1].push({type:2,data:me([[],[{type:0,data:ge(M)}],[{type:2,data:Qr(F)}]])});var L={id:F,messages:[fy(6002,me(H))]},st=Qu(Zu([L]));Tn.utils.cfb_add(n,"/Index/Tables/Tile-".concat(F,".iwa"),st),mn(n,t,2,function(V){var ct=Ee(V.messages[0].data);ct[3].push({type:2,data:me([[],[{type:0,data:ge(F)}],[{type:2,data:yi("Tables/Tile")}],[{type:2,data:yi("Tables/Tile-".concat(F))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ge(0)}],[],[{type:0,data:ge(C)}]])}),ct[1]=[{type:0,data:ge(Math.max(F+1,ls(ct[1][0].data)))}],zi(ct,t,s,F),V.messages[0].data=me(ct)}),Zr(r,F),T[1].push({type:2,data:me([[],[{type:0,data:ge(M*R)}],[{type:0,data:ge(M)}]])})}}if(b[3][0].data=me(O),b[9][0].data=me(T),b[10]=[{type:2,data:new Uint8Array([])}],e["!merges"]){var Q=Ma({type:6144,deps:[s],location:t[s].location},t);i.push({id:Q,messages:[fy(6144,me([[],e["!merges"].map(function(V){return{type:2,data:me([[],[{type:2,data:me([[],[{type:5,data:new Uint8Array(new Uint16Array([V.s.r,V.s.c]).buffer)}]])}],[{type:2,data:me([[],[{type:5,data:new Uint8Array(new Uint16Array([V.e.r-V.s.r+1,V.e.c-V.s.c+1]).buffer)}]])}]])}})]))]}),b[13]=[{type:2,data:Qr(Q)}],mn(n,t,2,function(V){var ct=Ee(V.messages[0].data);zi(ct,t,s,Q),V.messages[0].data=me(ct)}),Zr(r,Q)}else delete b[13];var Y=ar(b[4][0].data);mn(n,t,Y,function(V){var ct=Ee(V.messages[0].data);ct[3]=[],y.sst.forEach(function(gt,_t){_t!=0&&ct[3].push({type:2,data:me([[],[{type:0,data:ge(_t)}],[{type:0,data:ge(1)}],[{type:2,data:yi(gt)}]])})}),V.messages[0].data=me(ct)});var Ot=ar(b[17][0].data);if(mn(n,t,Ot,function(V){var ct=Ee(V.messages[0].data);ct[3]=[];var gt=[904980,903835,903815,903845];y.rsst.forEach(function(_t,Bt){if(Bt!=0){var Gt=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:yi(_t.v)}]];Gt[10]=[{type:0,data:new Uint8Array([1])}],Gt[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Gt[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Gt[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Gt[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Gt[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Gt[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Gt[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Gt[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var j=Ma({deps:[],location:"",type:2001},t),pt=[];if(_t.l){var lt=uc(n,2032,[[],[],[{type:2,data:yi(_t.l)}]],"/Index/Tables/DataList",t);Gt[11]=[];var ut=[[],[]];ut[1]||(ut[1]=[]),ut[1].push({type:2,data:me([[],[{type:0,data:ge(0)}],[{type:2,data:Qr(lt)}]])}),Gt[11][0]={type:2,data:me(ut)},pt.push(lt)}uc(n,2001,Gt,"/Index/Tables/DataList",t,j),mn(n,t,j,function(Lt){gt.forEach(function(D){return Zr(Lt,D)}),pt.forEach(function(D){return Zr(Lt,D)})});var Dt=uc(n,6218,[[],[{type:2,data:Qr(j)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);mn(n,t,Dt,function(Lt){return Zr(Lt,j)}),ct[3].push({type:2,data:me([[],[{type:0,data:ge(Bt)}],[{type:0,data:ge(1)}],[],[],[],[],[],[],[{type:2,data:Qr(Dt)}]])}),Zr(V,Dt),mn(n,t,2,function(Lt){var D=Ee(Lt.messages[0].data);zi(D,t,Ot,Dt),zi(D,t,Dt,j),zi(D,t,j,pt),zi(D,t,j,gt),Lt.messages[0].data=me(D)})}}),V.messages[0].data=me(ct)}),y.cmnt.length>1){var Et=ar(b[19][0].data),z={},J=0;mn(n,t,Et,function(V){var ct=Ee(V.messages[0].data);ct[3]=[],y.cmnt.forEach(function(gt,_t){if(_t!=0){var Bt=[];gt.replies&&gt.replies.forEach(function(pt){z[pt.a||""]||(z[pt.a||""]=uc(n,212,[[],[{type:2,data:yi(pt.a||"")}],[{type:2,data:SS(++J)}],[],[{type:0,data:ge(0)}]],"/Index/Tables/DataList",t));var lt=z[pt.a||""],ut=uc(n,3056,[[],[{type:2,data:yi(pt.t||"")}],[{type:2,data:me([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Qr(lt)}]],"/Index/Tables/DataList",t);mn(n,t,ut,function(Dt){return Zr(Dt,lt)}),Bt.push(ut),mn(n,t,2,function(Dt){var Lt=Ee(Dt.messages[0].data);zi(Lt,t,ut,lt),Dt.messages[0].data=me(Lt)})}),z[gt.a||""]||(z[gt.a||""]=uc(n,212,[[],[{type:2,data:yi(gt.a||"")}],[{type:2,data:SS(++J)}],[],[{type:0,data:ge(0)}]],"/Index/Tables/DataList",t));var Gt=z[gt.a||""],j=uc(n,3056,[[],[{type:2,data:yi(gt.t||"")}],[{type:2,data:me([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Qr(Gt)}],Bt.map(function(pt){return{type:2,data:Qr(pt)}}),[{type:2,data:me([[],[{type:0,data:ge(_t)}],[{type:0,data:ge(0)}]])}]],"/Index/Tables/DataList",t);mn(n,t,j,function(pt){Zr(pt,Gt),Bt.forEach(function(lt){return Zr(pt,lt)})}),ct[3].push({type:2,data:me([[],[{type:0,data:ge(_t)}],[{type:0,data:ge(1)}],[],[],[],[],[],[],[],[{type:2,data:Qr(j)}]])}),Zr(V,j),mn(n,t,2,function(pt){var lt=Ee(pt.messages[0].data);zi(lt,t,Et,j),zi(lt,t,j,Gt),Bt.length&&zi(lt,t,j,Bt),pt.messages[0].data=me(lt)})}}),ct[2][0].data=ge(y.cmnt.length+1),V.messages[0].data=me(ct)})}}_[4][0].data=me(b)}r.messages[0].data=me(_)}function IW(n){return function(e){for(var r=0;r!=n.length;++r){var i=n[r];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function Vb(n){IW([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function PW(n,t){n&&!n.SSF&&(n.SSF=ii(Rn)),n&&n.SSF&&(Wm(),Vm(n.SSF),t.revssf=Xm(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,yd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="bin",r=!0,i=bO();Vb(t=t||{});var s=Nb(),o="",l=0;if(t.cellXfs=[],Il(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",je(s,o,AO(n.Props,t)),i.coreprops.push(o),ln(t.rels,2,o,en.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var u=[],h=0;h<n.SheetNames.length;++h)(n.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(n.SheetNames[h]);n.Props.SheetNames=u}n.Props.Worksheets=n.Props.SheetNames.length,je(s,o,TO(n.Props)),i.extprops.push(o),ln(t.rels,3,o,en.EXT_PROPS),n.Custprops!==n.Props&&cr(n.Custprops||{}).length>0&&(o="docProps/custom.xml",je(s,o,CO(n.Custprops)),i.custprops.push(o),ln(t.rels,4,o,en.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=n.SheetNames.length;++l){var p={"!id":{}},g=n.Sheets[n.SheetNames[l-1]],v=(g||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+l+"."+e,je(s,o,vV(l-1,t,n,p)),i.sheets.push(o),ln(t.wbrels,-1,"worksheets/sheet"+l+"."+e,en.WS[0])}if(g){var y=g["!comments"],_=!1,b="";if(y&&y.length>0){var E=!1;y.forEach(function(T){T[1].forEach(function(O){O.T==!0&&(E=!0)})}),E&&(b="xl/threadedComments/threadedComment"+l+".xml",je(s,b,HO(y,d,t)),i.threadedcomments.push(b),ln(p,-1,"../threadedComments/threadedComment"+l+".xml",en.TCMNT)),b="xl/comments"+l+"."+e,je(s,b,oj(y)),i.comments.push(b),ln(p,-1,"../comments"+l+"."+e,en.CMNT),_=!0}g["!legacy"]&&_&&je(s,"xl/drawings/vmlDrawing"+l+".vml",zO(l,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&je(s,EO(o),qu(p))}t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+e,je(s,o,vH(t.Strings)),i.strs.push(o),ln(t.wbrels,-1,"sharedStrings."+e,en.SST)),o="xl/workbook."+e,je(s,o,BV(n)),i.workbooks.push(o),ln(t.rels,1,o,en.WB),o="xl/theme/theme1.xml";var S=UO(n.Themes,t);return je(s,o,S),i.themes.push(o),ln(t.wbrels,-1,"theme/theme1.xml",en.THEME),o="xl/styles."+e,je(s,o,VH(n,t)),i.styles.push(o),ln(t.wbrels,-1,"styles."+e,en.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",je(s,o,n.vbaraw),i.vba.push(o),ln(t.wbrels,-1,"vbaProject.bin",en.VBA)),o="xl/metadata."+e,je(s,o,JH()),i.metadata.push(o),ln(t.wbrels,-1,"metadata."+e,en.XLMETA),d.length>1&&(o="xl/persons/person.xml",je(s,o,jO(d)),i.people.push(o),ln(t.wbrels,-1,"persons/person.xml",en.PEOPLE)),je(s,"[Content_Types].xml",xO(i,t)),je(s,"_rels/.rels",qu(t.rels)),je(s,"xl/_rels/workbook."+e+".rels",qu(t.wbrels)),delete t.revssf,delete t.ssf,s}function FW(n,t){n&&!n.SSF&&(n.SSF=ii(Rn)),n&&n.SSF&&(Wm(),Vm(n.SSF),t.revssf=Xm(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,yd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",r=cj.indexOf(t.bookType)>-1,i=bO();Vb(t=t||{});var s=Nb(),o="",l=0;if(t.cellXfs=[],Il(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",je(s,o,AO(n.Props,t)),i.coreprops.push(o),ln(t.rels,2,o,en.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var u=[],h=0;h<n.SheetNames.length;++h)(n.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(n.SheetNames[h]);n.Props.SheetNames=u}n.Props.Worksheets=n.Props.SheetNames.length,je(s,o,TO(n.Props)),i.extprops.push(o),ln(t.rels,3,o,en.EXT_PROPS),n.Custprops!==n.Props&&cr(n.Custprops||{}).length>0&&(o="docProps/custom.xml",je(s,o,CO(n.Custprops)),i.custprops.push(o),ln(t.rels,4,o,en.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=n.SheetNames.length;++l){var p={"!id":{}},g=n.Sheets[n.SheetNames[l-1]],v=(g||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+l+"."+e,je(s,o,iG(l-1,t,n,p)),i.sheets.push(o),ln(t.wbrels,-1,"worksheets/sheet"+l+"."+e,en.WS[0])}if(g){var y=g["!comments"],_=!1,b="";if(y&&y.length>0){var E=!1;y.forEach(function(S){S[1].forEach(function(T){T.T==!0&&(E=!0)})}),E&&(b="xl/threadedComments/threadedComment"+l+".xml",je(s,b,HO(y,d,t)),i.threadedcomments.push(b),ln(p,-1,"../threadedComments/threadedComment"+l+".xml",en.TCMNT)),b="xl/comments"+l+"."+e,je(s,b,rj(y)),i.comments.push(b),ln(p,-1,"../comments"+l+"."+e,en.CMNT),_=!0}g["!legacy"]&&_&&je(s,"xl/drawings/vmlDrawing"+l+".vml",zO(l,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&je(s,EO(o),qu(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+e,je(s,o,dH(t.Strings,t)),i.strs.push(o),ln(t.wbrels,-1,"sharedStrings."+e,en.SST)),o="xl/workbook."+e,je(s,o,AV(n)),i.workbooks.push(o),ln(t.rels,1,o,en.WB),o="xl/theme/theme1.xml",je(s,o,UO(n.Themes,t)),i.themes.push(o),ln(t.wbrels,-1,"theme/theme1.xml",en.THEME),o="xl/styles."+e,je(s,o,AH(n,t)),i.styles.push(o),ln(t.wbrels,-1,"styles."+e,en.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",je(s,o,n.vbaraw),i.vba.push(o),ln(t.wbrels,-1,"vbaProject.bin",en.VBA)),o="xl/metadata."+e,je(s,o,tj()),i.metadata.push(o),ln(t.wbrels,-1,"metadata."+e,en.XLMETA),d.length>1&&(o="xl/persons/person.xml",je(s,o,jO(d)),i.people.push(o),ln(t.wbrels,-1,"persons/person.xml",en.PEOPLE)),je(s,"[Content_Types].xml",xO(i,t)),je(s,"_rels/.rels",qu(t.rels)),je(s,"xl/_rels/workbook."+e+".rels",qu(t.wbrels)),delete t.revssf,delete t.ssf,s}function BW(n,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":e=Ol(n.slice(0,12));break;case"binary":e=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function cR(n,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return o0(t.file,Tn.write(n,{type:cn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Tn.write(n,t)}function UW(n,t){switch(t.bookType){case"ods":return aR(n,t);case"numbers":return RW(n,t);case"xlsb":return PW(n,t);default:return FW(n,t)}}function zW(n,t){var e=ii(t||{}),r=UW(n,e);return HW(r,e)}function HW(n,t){var e={},r=cn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=r;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=n.FullPaths?Tn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):n.generate(e);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Gm(i))}return t.password&&typeof encrypt_agile<"u"?cR(encrypt_agile(i,t.password),t):t.type==="file"?o0(t.file,i):t.type=="string"?Yu(i):i}function jW(n,t){var e=t||{},r=QV(n,e);return cR(r,e)}function Ra(n,t,e){e||(e="");var r=e+n;switch(t.type){case"base64":return Qg(Pd(r));case"binary":return Pd(r);case"string":return n;case"file":return o0(t.file,r,"utf8");case"buffer":return cn?ja(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ra(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $W(n,t){switch(t.type){case"base64":return $7(n);case"binary":return n;case"string":return n;case"file":return o0(t.file,n,"binary");case"buffer":return cn?ja(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function gg(n,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",r=0;r<n.length;++r)e+=String.fromCharCode(n[r]);return t.type=="base64"?Qg(e):t.type=="string"?Yu(e):e;case"file":return o0(t.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+t.type)}}function uR(n,t){j7(),wV(n);var e=ii(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var r=uR(n,e);return e.type="array",Gm(r)}var i=0;if(e.sheet&&(typeof e.sheet=="number"?i=e.sheet:i=n.SheetNames.indexOf(e.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Ra(KV(n,e),e);case"slk":case"sylk":return Ra(cH.from_sheet(n.Sheets[n.SheetNames[i]],e,n),e);case"htm":case"html":return Ra(rR(n.Sheets[n.SheetNames[i]],e),e);case"txt":return $W(fR(n.Sheets[n.SheetNames[i]],e),e);case"csv":return Ra(Wb(n.Sheets[n.SheetNames[i]],e),e,"\uFEFF");case"dif":return Ra(uH.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"dbf":return gg(lH.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"prn":return Ra(fH.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"rtf":return Ra(yH(n.Sheets[n.SheetNames[i]]),e);case"eth":return Ra(MO.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"fods":return Ra(aR(n,e),e);case"wk1":return gg(dS.sheet_to_wk1(n.Sheets[n.SheetNames[i]],e),e);case"wk3":return gg(dS.book_to_wk3(n,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),gg(nR(n,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),jW(n,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return zW(n,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function GW(n){if(!n.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(n.bookType=e.slice(1)),n.bookType=t[n.bookType]||n.bookType}}function VW(n,t,e){var r=e||{};return r.type="file",r.file=t,GW(r),uR(n,r)}function WW(n,t,e,r,i,s,o){var l=wn(e),u=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=n["!data"]!=null,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:e,enumerable:!1})}catch{g.__rowNum__=e}else g.__rowNum__=e;if(!p||n["!data"][e])for(var v=t.s.c;v<=t.e.c;++v){var y=p?(n["!data"][e]||[])[v]:n[r[v]+l];if(y==null||y.t===void 0){if(u===void 0)continue;s[v]!=null&&(g[s[v]]=u);continue}var _=y.v;switch(y.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"b":case"n":if(!y.z||!kc(y.z)||(_=Xu(_),typeof _=="number"))break;case"d":o&&(o.UTC||o.raw===!1)||(_=hf(new Date(_)));break;default:throw new Error("unrecognized type "+y.t)}if(s[v]!=null){if(_==null)if(y.t=="e"&&_===null)g[s[v]]=null;else if(u!==void 0)g[s[v]]=u;else if(h&&_===null)g[s[v]]=null;else continue;else g[s[v]]=(y.t==="n"&&typeof o.rawNumbers=="boolean"?o.rawNumbers:h)?_:Io(y,_,o);_!=null&&(d=!1)}}return{row:g,isempty:d}}function dy(n,t){if(n==null||n["!ref"]==null)return[];var e={t:"n",v:0},r=0,i=1,s=[],o=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},d=h.range!=null?h.range:n["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof d){case"string":u=Nn(d);break;case"number":u=Nn(n["!ref"]),u.s.r=d;break;default:u=d}r>0&&(i=0);var p=wn(u.s.r),g=[],v=[],y=0,_=0,b=n["!data"]!=null,E=u.s.r,S=0,T={};b&&!n["!data"][E]&&(n["!data"][E]=[]);var O=h.skipHidden&&n["!cols"]||[],R=h.skipHidden&&n["!rows"]||[];for(S=u.s.c;S<=u.e.c;++S)if(!(O[S]||{}).hidden)switch(g[S]=vn(S),e=b?n["!data"][E][S]:n[g[S]+p],r){case 1:s[S]=S-u.s.c;break;case 2:s[S]=g[S];break;case 3:s[S]=h.header[S-u.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=o=Io(e,null,h),_=T[o]||0,!_)T[o]=1;else{do l=o+"_"+_++;while(T[l]);T[o]=_,T[l]=1}s[S]=l}for(E=u.s.r+i;E<=u.e.r;++E)if(!(R[E]||{}).hidden){var N=WW(n,u,E,g,r,s,h);(N.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(v[y++]=N.row)}return v.length=y,v}var TS=/"/g;function XW(n,t,e,r,i,s,o,l,u){for(var h=!0,d=[],p="",g=wn(e),v=n["!data"]!=null,y=v&&n["!data"][e]||[],_=t.s.c;_<=t.e.c;++_)if(r[_]){var b=v?y[_]:n[r[_]+g];if(b==null)p="";else if(b.v!=null){h=!1,p=""+(u.rawNumbers&&b.t=="n"?b.v:Io(b,null,u));for(var E=0,S=0;E!==p.length;++E)if((S=p.charCodeAt(E))===i||S===s||S===34||u.forceQuotes){p='"'+p.replace(TS,'""')+'"';break}p=="ID"&&l==0&&d.length==0&&(p='"ID"')}else b.f!=null&&!b.F?(h=!1,p="="+b.f,p.indexOf(",")>=0&&(p='"'+p.replace(TS,'""')+'"')):p="";d.push(p)}if(u.strip)for(;d[d.length-1]==="";)--d.length;return u.blankrows===!1&&h?null:d.join(o)}function Wb(n,t){var e=[],r=t??{};if(n==null||n["!ref"]==null)return"";for(var i=Nn(n["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),l=r.RS!==void 0?r.RS:`
`,u=l.charCodeAt(0),h="",d=[],p=r.skipHidden&&n["!cols"]||[],g=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(d[v]=vn(v));for(var y=0,_=i.s.r;_<=i.e.r;++_)(g[_]||{}).hidden||(h=XW(n,i,_,d,o,u,s,y,r),h!=null&&(h||r.blankrows!==!1)&&e.push((y++?l:"")+h));return e.join("")}function fR(n,t){t||(t={}),t.FS="	",t.RS=`
`;var e=Wb(n,t);return e}function YW(n,t){var e="",r,i="";if(n==null||n["!ref"]==null)return[];var s=Nn(n["!ref"]),o="",l=[],u,h=[],d=n["!data"]!=null;for(u=s.s.c;u<=s.e.c;++u)l[u]=vn(u);for(var p=s.s.r;p<=s.e.r;++p)for(o=wn(p),u=s.s.c;u<=s.e.c;++u)if(e=l[u]+o,r=d?(n["!data"][p]||[])[u]:n[e],i="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;i=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)i=r.f;else{if(t&&t.values===!1)continue;if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)i=""+r.v;else if(r.t=="b")i=r.v?"TRUE":"FALSE";else if(r.w!==void 0)i="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?i="'"+r.v:i=""+r.v}}h[h.length]=e+"="+i}return h}function hR(n,t,e){var r=e||{},i=n?n["!data"]!=null:r.dense,s=+!r.skipHeader,o=n||{};!n&&i&&(o["!data"]=[]);var l=0,u=0;if(o&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var h=typeof r.origin=="string"?Fn(r.origin):r.origin;l=h.r,u=h.c}var d={s:{c:0,r:0},e:{c:u,r:l+t.length-1+s}};if(o["!ref"]){var p=Nn(o["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),l==-1&&(l=p.e.r+1,d.e.r=l+t.length-1+s)}else l==-1&&(l=0,d.e.r=t.length-1+s);var g=r.header||[],v=0,y=[];t.forEach(function(b,E){i&&!o["!data"][l+E+s]&&(o["!data"][l+E+s]=[]),i&&(y=o["!data"][l+E+s]),cr(b).forEach(function(S){(v=g.indexOf(S))==-1&&(g[v=g.length]=S);var T=b[S],O="z",R="",N=i?"":vn(u+v)+wn(l+E+s),C=i?y[u+v]:o[N];T&&typeof T=="object"&&!(T instanceof Date)?i?y[u+v]=T:o[N]=T:(typeof T=="number"?O="n":typeof T=="boolean"?O="b":typeof T=="string"?O="s":T instanceof Date?(O="d",r.UTC||(T=Ym(T)),r.cellDates||(O="n",T=zr(T)),R=C!=null&&C.z&&kc(C.z)?C.z:r.dateNF||Rn[14]):T===null&&r.nullError&&(O="e",T=0),C?(C.t=O,C.v=T,delete C.w,delete C.R,R&&(C.z=R)):i?y[u+v]=C={t:O,v:T}:o[N]=C={t:O,v:T},R&&(C.z=R))})}),d.e.c=Math.max(d.e.c,u+g.length-1);var _=wn(l);if(i&&!o["!data"][l]&&(o["!data"][l]=[]),s)for(v=0;v<g.length;++v)i?o["!data"][l][v+u]={t:"s",v:g[v]}:o[vn(v+u)+_]={t:"s",v:g[v]};return o["!ref"]=ur(d),o}function qW(n,t){return hR(null,n,t)}function gm(n,t,e){if(typeof t=="string"){if(n["!data"]!=null){var r=Fn(t);return n["!data"][r.r]||(n["!data"][r.r]=[]),n["!data"][r.r][r.c]||(n["!data"][r.r][r.c]={t:"z"})}return n[t]||(n[t]={t:"z"})}return typeof t!="number"?gm(n,jn(t)):gm(n,vn(e||0)+wn(t))}function KW(n,t){if(typeof t=="number"){if(t>=0&&n.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=n.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ZW(n,t){var e={SheetNames:[],Sheets:{}};return n&&Xb(e,n,t||"Sheet1"),e}function Xb(n,t,e,r){var i=1;if(!e)for(;i<=65535&&n.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(e)>=0&&e.length<32){var s=e.match(/\d+$/);i=s&&+s[0]||0;var o=s&&e.slice(0,s.index)||e;for(++i;i<=65535&&n.SheetNames.indexOf(e=o+i)!=-1;++i);}if(JO(e),n.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return n.SheetNames.push(e),n.Sheets[e]=t,e}function QW(n,t,e){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=KW(n,t);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}n.Workbook.Sheets[r].Hidden=e}function JW(n,t){return n.z=t,n}function dR(n,t,e){return t?(n.l={Target:t},e&&(n.l.Tooltip=e)):delete n.l,n}function tX(n,t,e){return dR(n,"#"+t,e)}function eX(n,t,e){n.c||(n.c=[]),n.c.push({t,a:e||"SheetJS"})}function nX(n,t,e,r){for(var i=typeof t!="string"?t:Nn(t),s=typeof t=="string"?t:ur(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var u=gm(n,o,l);u.t="n",u.F=s,delete u.v,o==i.s.r&&l==i.s.c&&(u.f=e,r&&(u.D=!0))}var h=Ur(n["!ref"]);return h.s.r>i.s.r&&(h.s.r=i.s.r),h.s.c>i.s.c&&(h.s.c=i.s.c),h.e.r<i.e.r&&(h.e.r=i.e.r),h.e.c<i.e.c&&(h.e.c=i.e.c),n["!ref"]=ur(h),n}var M_={encode_col:vn,encode_row:wn,encode_cell:jn,encode_range:ur,decode_col:Fb,decode_row:Pb,split_cell:Z9,decode_cell:Fn,decode_range:Ur,format_cell:Io,sheet_new:Q9,sheet_add_aoa:gO,sheet_add_json:hR,sheet_add_dom:iR,aoa_to_sheet:wf,json_to_sheet:qW,table_to_sheet:sR,table_to_book:xW,sheet_to_csv:Wb,sheet_to_txt:fR,sheet_to_json:dy,sheet_to_html:rR,sheet_to_formulae:YW,sheet_to_row_object_array:dy,sheet_get_cell:gm,book_new:ZW,book_append_sheet:Xb,book_set_sheet_visibility:QW,cell_set_number_format:JW,cell_set_hyperlink:dR,cell_set_internal_link:tX,cell_add_comment:eX,sheet_set_array_formula:nX,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const rX=(n,t)=>{const e=i0(t),r=[];return n.forEach(i=>{const s=ta(i,e,"date"),o=ta(i,e,"campaign");r.push({"HOLE ID":ta(i,e,"hole_id"),X:xl(ta(i,e,"x")),Y:xl(ta(i,e,"y")),Z:xl(ta(i,e,"z")),DEPTH:nb(i,e),...s&&{DATA:s},...o&&{CAMPANHA:o}})}),r},iX=(n,t)=>{const e=i0(t),r=[];return n.forEach(i=>{const s=ta(i,e,"hole_id"),o=Td(i,e,"nspt"),l=nb(i,e),u=Math.ceil(l)-o.length+1;let h=0;o.forEach((d,p)=>{const g=p===0?u:p===o.length-1?l:h+1;r.push({"HOLE ID":s,from:h,to:g,NSPT:d}),h=g})}),r},sX=(n,t)=>{const e=i0(t),r=[];return n.forEach(i=>{const s=ta(i,e,"hole_id"),o=nb(i,e),l=ta(i,e,"water_level"),u=xl(l,-1);u&&u>=0?u!==0?r.push({"HOLE ID":s,from:0,to:u,cond:"SECO"},{"HOLE ID":s,from:u,to:o,cond:"GUA"}):r.push({"HOLE ID":s,from:0,to:o,cond:"GUA"}):r.push({"HOLE ID":s,from:0,to:o,cond:"SECO"})}),r},aX=(n,t)=>{const e=i0(t),r=[];return n.forEach(i=>{const s=ta(i,e,"hole_id"),l=Td(i,e,"depth_from_to").map(h=>xl(h)).sort((h,d)=>h-d);l[0]!==0&&l.unshift(0);const u=Td(i,e,"geology");for(let h=0;h<l.length-1;h++)console.log("NMERO DE DESCRIES CORRETO? ",r.length===l.length),r.push({"HOLE ID":s,from:l[h],to:l[h+1],Descrio:u[h]||""})}),r},oX=(n,t)=>{const e=i0(t),r=[];return n.forEach(i=>{const s=ta(i,e,"hole_id"),l=Td(i,e,"depth_from_to").map(d=>xl(d)).sort((d,p)=>d-p);l[0]!==0&&l.unshift(0);const u=Td(i,e,"interp"),h=[];for(let d=l.length-2;d>=0;d--)h.push({"HOLE ID":s,from:l[d],to:l[d+1],"interp. geol":u[d+d]||""});h.reverse(),r.push(...h)}),r},CS=(n,t)=>[t.join(";"),...n.map(r=>t.map(i=>`"${r[i]??""}"`).join(";"))].join(`
`),DS=(n,t,e)=>{switch(e){case"collar":const r=["HOLE ID","X","Y","Z","DEPTH"];return t.find(i=>i.dataType==="date")&&r.push("DATA"),t.find(i=>i.dataType==="campaign")&&r.push("CAMPANHA"),{data:rX(n,t),headers:r,filename:"collar.csv"};case"nspt":return{data:iX(n,t),headers:["HOLE ID","from","to","NSPT"],filename:"nspt.csv"};case"na":return{data:sX(n,t),headers:["HOLE ID","from","to","cond"],filename:"na.csv"};case"geology":return{data:aX(n,t),headers:["HOLE ID","from","to","Descrio"],filename:"geology.csv"};case"interp":return{data:oX(n,t),headers:["HOLE ID","from","to","interp. geol"],filename:"interp.csv"};default:return}},mg=(n,t)=>{const e=c6[t];if(!e)return{isValid:!1,missingFields:[],errorMessage:`Tipo de exportao '${t}' no reconhecido`};const r=[],i=n.filter(s=>s.dataType&&s.coordinates).map(s=>s.dataType);if(e.forEach(s=>{i.includes(s)||r.push(s)}),t==="nspt"||t==="collar"||t==="na"){const s=i.includes("depth"),o=i.includes("depth_from_to");!s&&!o&&r.unshift("depth")}return{isValid:r.length===0,missingFields:r,errorMessage:r.length>0?`Campos obrigatrios ausentes: ${r.join(", ")}`:void 0}};function vg(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var I_={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var OS;function lX(){return OS||(OS=1,function(n,t){(function(e){n.exports=e()})(function(){return function e(r,i,s){function o(h,d){if(!i[h]){if(!r[h]){var p=typeof vg=="function"&&vg;if(!d&&p)return p(h,!0);if(l)return l(h,!0);var g=new Error("Cannot find module '"+h+"'");throw g.code="MODULE_NOT_FOUND",g}var v=i[h]={exports:{}};r[h][0].call(v.exports,function(y){var _=r[h][1][y];return o(_||y)},v,v.exports,e,r,i,s)}return i[h].exports}for(var l=typeof vg=="function"&&vg,u=0;u<s.length;u++)o(s[u]);return o}({1:[function(e,r,i){var s=e("./utils"),o=e("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(u){for(var h,d,p,g,v,y,_,b=[],E=0,S=u.length,T=S,O=s.getTypeOf(u)!=="string";E<u.length;)T=S-E,p=O?(h=u[E++],d=E<S?u[E++]:0,E<S?u[E++]:0):(h=u.charCodeAt(E++),d=E<S?u.charCodeAt(E++):0,E<S?u.charCodeAt(E++):0),g=h>>2,v=(3&h)<<4|d>>4,y=1<T?(15&d)<<2|p>>6:64,_=2<T?63&p:64,b.push(l.charAt(g)+l.charAt(v)+l.charAt(y)+l.charAt(_));return b.join("")},i.decode=function(u){var h,d,p,g,v,y,_=0,b=0,E="data:";if(u.substr(0,E.length)===E)throw new Error("Invalid base64 input, it looks like a data url.");var S,T=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===l.charAt(64)&&T--,u.charAt(u.length-2)===l.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=o.uint8array?new Uint8Array(0|T):new Array(0|T);_<u.length;)h=l.indexOf(u.charAt(_++))<<2|(g=l.indexOf(u.charAt(_++)))>>4,d=(15&g)<<4|(v=l.indexOf(u.charAt(_++)))>>2,p=(3&v)<<6|(y=l.indexOf(u.charAt(_++))),S[b++]=h,v!==64&&(S[b++]=d),y!==64&&(S[b++]=p);return S}},{"./support":30,"./utils":32}],2:[function(e,r,i){var s=e("./external"),o=e("./stream/DataWorker"),l=e("./stream/Crc32Probe"),u=e("./stream/DataLengthProbe");function h(d,p,g,v,y){this.compressedSize=d,this.uncompressedSize=p,this.crc32=g,this.compression=v,this.compressedContent=y}h.prototype={getContentWorker:function(){var d=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},h.createWorkerFrom=function(d,p,g){return d.pipe(new l).pipe(new u("uncompressedSize")).pipe(p.compressWorker(g)).pipe(new u("compressedSize")).withStreamInfo("compression",p)},r.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,i){var s=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,i){var s=e("./utils"),o=function(){for(var l,u=[],h=0;h<256;h++){l=h;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;u[h]=l}return u}();r.exports=function(l,u){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(h,d,p,g){var v=o,y=g+p;h^=-1;for(var _=g;_<y;_++)h=h>>>8^v[255&(h^d[_])];return-1^h}(0|u,l,l.length,0):function(h,d,p,g){var v=o,y=g+p;h^=-1;for(var _=g;_<y;_++)h=h>>>8^v[255&(h^d.charCodeAt(_))];return-1^h}(0|u,l,l.length,0):0}},{"./utils":32}],5:[function(e,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,r,i){var s=null;s=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:s}},{lie:37}],7:[function(e,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),l=e("./utils"),u=e("./stream/GenericWorker"),h=s?"uint8array":"array";function d(p,g){u.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=g,this.meta={}}i.magic="\b\0",l.inherits(d,u),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(h,p.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(g){p.push({data:g,meta:p.meta})}},i.compressWorker=function(p){return new d("Deflate",p)},i.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,i){function s(v,y){var _,b="";for(_=0;_<y;_++)b+=String.fromCharCode(255&v),v>>>=8;return b}function o(v,y,_,b,E,S){var T,O,R=v.file,N=v.compression,C=S!==h.utf8encode,I=l.transformTo("string",S(R.name)),M=l.transformTo("string",h.utf8encode(R.name)),F=R.comment,H=l.transformTo("string",S(F)),P=l.transformTo("string",h.utf8encode(F)),et=M.length!==R.name.length,L=P.length!==F.length,st="",Q="",Y="",Ot=R.dir,Et=R.date,z={crc32:0,compressedSize:0,uncompressedSize:0};y&&!_||(z.crc32=v.crc32,z.compressedSize=v.compressedSize,z.uncompressedSize=v.uncompressedSize);var J=0;y&&(J|=8),C||!et&&!L||(J|=2048);var V=0,ct=0;Ot&&(V|=16),E==="UNIX"?(ct=798,V|=function(_t,Bt){var Gt=_t;return _t||(Gt=Bt?16893:33204),(65535&Gt)<<16}(R.unixPermissions,Ot)):(ct=20,V|=function(_t){return 63&(_t||0)}(R.dosPermissions)),T=Et.getUTCHours(),T<<=6,T|=Et.getUTCMinutes(),T<<=5,T|=Et.getUTCSeconds()/2,O=Et.getUTCFullYear()-1980,O<<=4,O|=Et.getUTCMonth()+1,O<<=5,O|=Et.getUTCDate(),et&&(Q=s(1,1)+s(d(I),4)+M,st+="up"+s(Q.length,2)+Q),L&&(Y=s(1,1)+s(d(H),4)+P,st+="uc"+s(Y.length,2)+Y);var gt="";return gt+=`
\0`,gt+=s(J,2),gt+=N.magic,gt+=s(T,2),gt+=s(O,2),gt+=s(z.crc32,4),gt+=s(z.compressedSize,4),gt+=s(z.uncompressedSize,4),gt+=s(I.length,2),gt+=s(st.length,2),{fileRecord:p.LOCAL_FILE_HEADER+gt+I+st,dirRecord:p.CENTRAL_FILE_HEADER+s(ct,2)+gt+s(H.length,2)+"\0\0\0\0"+s(V,4)+s(b,4)+I+st+H}}var l=e("../utils"),u=e("../stream/GenericWorker"),h=e("../utf8"),d=e("../crc32"),p=e("../signature");function g(v,y,_,b){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=_,this.encodeFileName=b,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(g,u),g.prototype.push=function(v){var y=v.meta.percent||0,_=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,u.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:_?(y+100*(_-b-1))/_:100}}))},g.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var y=this.streamFiles&&!v.file.dir;if(y){var _=o(v,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(v){this.accumulate=!1;var y=this.streamFiles&&!v.file.dir,_=o(v,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),y)this.push({data:function(b){return p.DATA_DESCRIPTOR+s(b.crc32,4)+s(b.compressedSize,4)+s(b.uncompressedSize,4)}(v),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var v=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var _=this.bytesWritten-v,b=function(E,S,T,O,R){var N=l.transformTo("string",R(O));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(E,2)+s(E,2)+s(S,4)+s(T,4)+s(N.length,2)+N}(this.dirRecords.length,_,v,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(v){this._sources.push(v);var y=this;return v.on("data",function(_){y.processChunk(_)}),v.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),v.on("error",function(_){y.error(_)}),this},g.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(v){var y=this._sources;if(!u.prototype.error.call(this,v))return!1;for(var _=0;_<y.length;_++)try{y[_].error(v)}catch{}return!0},g.prototype.lock=function(){u.prototype.lock.call(this);for(var v=this._sources,y=0;y<v.length;y++)v[y].lock()},r.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,i){var s=e("../compressions"),o=e("./ZipFileWorker");i.generateWorker=function(l,u,h){var d=new o(u.streamFiles,h,u.platform,u.encodeFileName),p=0;try{l.forEach(function(g,v){p++;var y=function(S,T){var O=S||T,R=s[O];if(!R)throw new Error(O+" is not a valid compression method !");return R}(v.options.compression,u.compression),_=v.options.compressionOptions||u.compressionOptions||{},b=v.dir,E=v.date;v._compressWorker(y,_).withStreamInfo("file",{name:g,dir:b,date:E,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(d)}),d.entriesCount=p}catch(g){d.error(g)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(o,l){return new s().loadAsync(o,l)},s.external=e("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,i){var s=e("./utils"),o=e("./external"),l=e("./utf8"),u=e("./zipEntries"),h=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function p(g){return new o.Promise(function(v,y){var _=g.decompressed.getContentWorker().pipe(new h);_.on("error",function(b){y(b)}).on("end",function(){_.streamInfo.crc32!==g.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):v()}).resume()})}r.exports=function(g,v){var y=this;return v=s.extend(v||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(g)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",g,!0,v.optimizedBinaryString,v.base64).then(function(_){var b=new u(v);return b.load(_),b}).then(function(_){var b=[o.Promise.resolve(_)],E=_.files;if(v.checkCRC32)for(var S=0;S<E.length;S++)b.push(p(E[S]));return o.Promise.all(b)}).then(function(_){for(var b=_.shift(),E=b.files,S=0;S<E.length;S++){var T=E[S],O=T.fileNameStr,R=s.resolve(T.fileNameStr);y.file(R,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:v.createFolders}),T.dir||(y.file(R).unsafeOriginalName=O)}return b.zipComment.length&&(y.comment=b.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,i){var s=e("../utils"),o=e("../stream/GenericWorker");function l(u,h){o.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(h)}s.inherits(l,o),l.prototype._bindStream=function(u){var h=this;(this._stream=u).pause(),u.on("data",function(d){h.push({data:d,meta:{percent:0}})}).on("error",function(d){h.isPaused?this.generatedError=d:h.error(d)}).on("end",function(){h.isPaused?h._upstreamEnded=!0:h.end()})},l.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,i){var s=e("readable-stream").Readable;function o(l,u,h){s.call(this,u),this._helper=l;var d=this;l.on("data",function(p,g){d.push(p)||d._helper.pause(),h&&h(g)}).on("error",function(p){d.emit("error",p)}).on("end",function(){d.push(null)})}e("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,r,i){function s(R,N,C){var I,M=l.getTypeOf(N),F=l.extend(C||{},d);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(R=E(R)),F.createFolders&&(I=b(R))&&S.call(this,I,!0);var H=M==="string"&&F.binary===!1&&F.base64===!1;C&&C.binary!==void 0||(F.binary=!H),(N instanceof p&&N.uncompressedSize===0||F.dir||!N||N.length===0)&&(F.base64=!1,F.binary=!0,N="",F.compression="STORE",M="string");var P=null;P=N instanceof p||N instanceof u?N:y.isNode&&y.isStream(N)?new _(R,N):l.prepareContent(R,N,F.binary,F.optimizedBinaryString,F.base64);var et=new g(R,P,F);this.files[R]=et}var o=e("./utf8"),l=e("./utils"),u=e("./stream/GenericWorker"),h=e("./stream/StreamHelper"),d=e("./defaults"),p=e("./compressedObject"),g=e("./zipObject"),v=e("./generate"),y=e("./nodejsUtils"),_=e("./nodejs/NodejsStreamInputAdapter"),b=function(R){R.slice(-1)==="/"&&(R=R.substring(0,R.length-1));var N=R.lastIndexOf("/");return 0<N?R.substring(0,N):""},E=function(R){return R.slice(-1)!=="/"&&(R+="/"),R},S=function(R,N){return N=N!==void 0?N:d.createFolders,R=E(R),this.files[R]||s.call(this,R,null,{dir:!0,createFolders:N}),this.files[R]};function T(R){return Object.prototype.toString.call(R)==="[object RegExp]"}var O={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(R){var N,C,I;for(N in this.files)I=this.files[N],(C=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&R(C,I)},filter:function(R){var N=[];return this.forEach(function(C,I){R(C,I)&&N.push(I)}),N},file:function(R,N,C){if(arguments.length!==1)return R=this.root+R,s.call(this,R,N,C),this;if(T(R)){var I=R;return this.filter(function(F,H){return!H.dir&&I.test(F)})}var M=this.files[this.root+R];return M&&!M.dir?M:null},folder:function(R){if(!R)return this;if(T(R))return this.filter(function(M,F){return F.dir&&R.test(M)});var N=this.root+R,C=S.call(this,N),I=this.clone();return I.root=C.name,I},remove:function(R){R=this.root+R;var N=this.files[R];if(N||(R.slice(-1)!=="/"&&(R+="/"),N=this.files[R]),N&&!N.dir)delete this.files[R];else for(var C=this.filter(function(M,F){return F.name.slice(0,R.length)===R}),I=0;I<C.length;I++)delete this.files[C[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(R){var N,C={};try{if((C=l.extend(R||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),C.type==="binarystring"&&(C.type="string"),!C.type)throw new Error("No output type specified.");l.checkSupport(C.type),C.platform!=="darwin"&&C.platform!=="freebsd"&&C.platform!=="linux"&&C.platform!=="sunos"||(C.platform="UNIX"),C.platform==="win32"&&(C.platform="DOS");var I=C.comment||this.comment||"";N=v.generateWorker(this,C,I)}catch(M){(N=new u("error")).error(M)}return new h(N,C.type||"string",C.mimeType)},generateAsync:function(R,N){return this.generateInternalStream(R).accumulate(N)},generateNodeStream:function(R,N){return(R=R||{}).type||(R.type="nodebuffer"),this.generateInternalStream(R).toNodejsStream(N)}};r.exports=O},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,i){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,i){var s=e("./DataReader");function o(l){s.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=255&l[u]}e("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),h=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===u&&this.data[g+1]===h&&this.data[g+2]===d&&this.data[g+3]===p)return g-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),h=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),g=this.readData(4);return u===g[0]&&h===g[1]&&d===g[2]&&p===g[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,r,i){var s=e("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var u,h=0;for(this.checkOffset(l),u=this.index+l-1;u>=this.index;u--)h=(h<<8)+this.byteAt(u);return this.index+=l,h},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=o},{"../utils":32}],19:[function(e,r,i){var s=e("./Uint8ArrayReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,i){var s=e("./DataReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,r,i){var s=e("./ArrayReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,i){var s=e("../utils"),o=e("../support"),l=e("./ArrayReader"),u=e("./StringReader"),h=e("./NodeBufferReader"),d=e("./Uint8ArrayReader");r.exports=function(p){var g=s.getTypeOf(p);return s.checkSupport(g),g!=="string"||o.uint8array?g==="nodebuffer"?new h(p):o.uint8array?new d(s.transformTo("uint8array",p)):new l(s.transformTo("array",p)):new u(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,i){var s=e("./GenericWorker"),o=e("../utils");function l(u){s.call(this,"ConvertWorker to "+u),this.destType=u}o.inherits(l,s),l.prototype.processChunk=function(u){this.push({data:o.transformTo(this.destType,u.data),meta:u.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,i){var s=e("./GenericWorker"),o=e("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,s),l.prototype.processChunk=function(u){this.streamInfo.crc32=o(u.data,this.streamInfo.crc32||0),this.push(u)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,i){var s=e("../utils"),o=e("./GenericWorker");function l(u){o.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}s.inherits(l,o),l.prototype.processChunk=function(u){if(u){var h=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=h+u.data.length}o.prototype.processChunk.call(this,u)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,i){var s=e("../utils"),o=e("./GenericWorker");function l(u){o.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){h.dataIsReady=!0,h.data=d,h.max=d&&d.length||0,h.type=s.getTypeOf(d),h.isPaused||h._tickAndRepeat()},function(d){h.error(d)})}s.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,h=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,h);break;case"uint8array":u=this.data.subarray(this.index,h);break;case"array":case"nodebuffer":u=this.data.slice(this.index,h)}return this.index=h,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var u=0;u<this._listeners[o].length;u++)this._listeners[o][u].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(u){l.processChunk(u)}),o.on("end",function(){l.end()}),o.on("error",function(u){l.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=s},{}],29:[function(e,r,i){var s=e("../utils"),o=e("./ConvertWorker"),l=e("./GenericWorker"),u=e("../base64"),h=e("../support"),d=e("../external"),p=null;if(h.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(y,_){return new d.Promise(function(b,E){var S=[],T=y._internalType,O=y._outputType,R=y._mimeType;y.on("data",function(N,C){S.push(N),_&&_(C)}).on("error",function(N){S=[],E(N)}).on("end",function(){try{var N=function(C,I,M){switch(C){case"blob":return s.newBlob(s.transformTo("arraybuffer",I),M);case"base64":return u.encode(I);default:return s.transformTo(C,I)}}(O,function(C,I){var M,F=0,H=null,P=0;for(M=0;M<I.length;M++)P+=I[M].length;switch(C){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(H=new Uint8Array(P),M=0;M<I.length;M++)H.set(I[M],F),F+=I[M].length;return H;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+C+"'")}}(T,S),R);b(N)}catch(C){E(C)}S=[]}).resume()})}function v(y,_,b){var E=_;switch(_){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string"}try{this._internalType=E,this._outputType=_,this._mimeType=b,s.checkSupport(E),this._worker=y.pipe(new o(E)),y.lock()}catch(S){this._worker=new l("error"),this._worker.error(S)}}v.prototype={accumulate:function(y){return g(this,y)},on:function(y,_){var b=this;return y==="data"?this._worker.on(y,function(E){_.call(b,E.data,E.meta)}):this._worker.on(y,function(){s.delay(_,arguments,b)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,i){for(var s=e("./utils"),o=e("./support"),l=e("./nodejsUtils"),u=e("./stream/GenericWorker"),h=new Array(256),d=0;d<256;d++)h[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;h[254]=h[254]=1;function p(){u.call(this,"utf-8 decode"),this.leftOver=null}function g(){u.call(this,"utf-8 encode")}i.utf8encode=function(v){return o.nodebuffer?l.newBufferFrom(v,"utf-8"):function(y){var _,b,E,S,T,O=y.length,R=0;for(S=0;S<O;S++)(64512&(b=y.charCodeAt(S)))==55296&&S+1<O&&(64512&(E=y.charCodeAt(S+1)))==56320&&(b=65536+(b-55296<<10)+(E-56320),S++),R+=b<128?1:b<2048?2:b<65536?3:4;for(_=o.uint8array?new Uint8Array(R):new Array(R),S=T=0;T<R;S++)(64512&(b=y.charCodeAt(S)))==55296&&S+1<O&&(64512&(E=y.charCodeAt(S+1)))==56320&&(b=65536+(b-55296<<10)+(E-56320),S++),b<128?_[T++]=b:(b<2048?_[T++]=192|b>>>6:(b<65536?_[T++]=224|b>>>12:(_[T++]=240|b>>>18,_[T++]=128|b>>>12&63),_[T++]=128|b>>>6&63),_[T++]=128|63&b);return _}(v)},i.utf8decode=function(v){return o.nodebuffer?s.transformTo("nodebuffer",v).toString("utf-8"):function(y){var _,b,E,S,T=y.length,O=new Array(2*T);for(_=b=0;_<T;)if((E=y[_++])<128)O[b++]=E;else if(4<(S=h[E]))O[b++]=65533,_+=S-1;else{for(E&=S===2?31:S===3?15:7;1<S&&_<T;)E=E<<6|63&y[_++],S--;1<S?O[b++]=65533:E<65536?O[b++]=E:(E-=65536,O[b++]=55296|E>>10&1023,O[b++]=56320|1023&E)}return O.length!==b&&(O.subarray?O=O.subarray(0,b):O.length=b),s.applyFromCharCode(O)}(v=s.transformTo(o.uint8array?"uint8array":"array",v))},s.inherits(p,u),p.prototype.processChunk=function(v){var y=s.transformTo(o.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var _=y;(y=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),y.set(_,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var b=function(S,T){var O;for((T=T||S.length)>S.length&&(T=S.length),O=T-1;0<=O&&(192&S[O])==128;)O--;return O<0||O===0?T:O+h[S[O]]>T?O:T}(y),E=y;b!==y.length&&(o.uint8array?(E=y.subarray(0,b),this.leftOver=y.subarray(b,y.length)):(E=y.slice(0,b),this.leftOver=y.slice(b,y.length))),this.push({data:i.utf8decode(E),meta:v.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=p,s.inherits(g,u),g.prototype.processChunk=function(v){this.push({data:i.utf8encode(v.data),meta:v.meta})},i.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,i){var s=e("./support"),o=e("./base64"),l=e("./nodejsUtils"),u=e("./external");function h(_){return _}function d(_,b){for(var E=0;E<_.length;++E)b[E]=255&_.charCodeAt(E);return b}e("setimmediate"),i.newBlob=function(_,b){i.checkSupport("blob");try{return new Blob([_],{type:b})}catch{try{var E=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return E.append(_),E.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(_,b,E){var S=[],T=0,O=_.length;if(O<=E)return String.fromCharCode.apply(null,_);for(;T<O;)b==="array"||b==="nodebuffer"?S.push(String.fromCharCode.apply(null,_.slice(T,Math.min(T+E,O)))):S.push(String.fromCharCode.apply(null,_.subarray(T,Math.min(T+E,O)))),T+=E;return S.join("")},stringifyByChar:function(_){for(var b="",E=0;E<_.length;E++)b+=String.fromCharCode(_[E]);return b},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function g(_){var b=65536,E=i.getTypeOf(_),S=!0;if(E==="uint8array"?S=p.applyCanBeUsed.uint8array:E==="nodebuffer"&&(S=p.applyCanBeUsed.nodebuffer),S)for(;1<b;)try{return p.stringifyByChunk(_,E,b)}catch{b=Math.floor(b/2)}return p.stringifyByChar(_)}function v(_,b){for(var E=0;E<_.length;E++)b[E]=_[E];return b}i.applyFromCharCode=g;var y={};y.string={string:h,array:function(_){return d(_,new Array(_.length))},arraybuffer:function(_){return y.string.uint8array(_).buffer},uint8array:function(_){return d(_,new Uint8Array(_.length))},nodebuffer:function(_){return d(_,l.allocBuffer(_.length))}},y.array={string:g,array:h,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return l.newBufferFrom(_)}},y.arraybuffer={string:function(_){return g(new Uint8Array(_))},array:function(_){return v(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:h,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return l.newBufferFrom(new Uint8Array(_))}},y.uint8array={string:g,array:function(_){return v(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:h,nodebuffer:function(_){return l.newBufferFrom(_)}},y.nodebuffer={string:g,array:function(_){return v(_,new Array(_.length))},arraybuffer:function(_){return y.nodebuffer.uint8array(_).buffer},uint8array:function(_){return v(_,new Uint8Array(_.length))},nodebuffer:h},i.transformTo=function(_,b){if(b=b||"",!_)return b;i.checkSupport(_);var E=i.getTypeOf(b);return y[E][_](b)},i.resolve=function(_){for(var b=_.split("/"),E=[],S=0;S<b.length;S++){var T=b[S];T==="."||T===""&&S!==0&&S!==b.length-1||(T===".."?E.pop():E.push(T))}return E.join("/")},i.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(_)?"nodebuffer":s.uint8array&&_ instanceof Uint8Array?"uint8array":s.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(_){if(!s[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(_){var b,E,S="";for(E=0;E<(_||"").length;E++)S+="\\x"+((b=_.charCodeAt(E))<16?"0":"")+b.toString(16).toUpperCase();return S},i.delay=function(_,b,E){setImmediate(function(){_.apply(E||null,b||[])})},i.inherits=function(_,b){function E(){}E.prototype=b.prototype,_.prototype=new E},i.extend=function(){var _,b,E={};for(_=0;_<arguments.length;_++)for(b in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],b)&&E[b]===void 0&&(E[b]=arguments[_][b]);return E},i.prepareContent=function(_,b,E,S,T){return u.Promise.resolve(b).then(function(O){return s.blob&&(O instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(O))!==-1)&&typeof FileReader<"u"?new u.Promise(function(R,N){var C=new FileReader;C.onload=function(I){R(I.target.result)},C.onerror=function(I){N(I.target.error)},C.readAsArrayBuffer(O)}):O}).then(function(O){var R=i.getTypeOf(O);return R?(R==="arraybuffer"?O=i.transformTo("uint8array",O):R==="string"&&(T?O=o.decode(O):E&&S!==!0&&(O=function(N){return d(N,s.uint8array?new Uint8Array(N.length):new Array(N.length))}(O))),O):u.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,i){var s=e("./reader/readerFor"),o=e("./utils"),l=e("./signature"),u=e("./zipEntry"),h=e("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(g)+", expected "+o.pretty(p)+")")}},isSignature:function(p,g){var v=this.reader.index;this.reader.setIndex(p);var y=this.reader.readString(4)===g;return this.reader.setIndex(v),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),g=h.uint8array?"uint8array":"array",v=o.transformTo(g,p);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,g,v,y=this.zip64EndOfCentralSize-44;0<y;)p=this.reader.readInt(2),g=this.reader.readInt(4),v=this.reader.readData(g),this.zip64ExtensibleData[p]={id:p,length:g,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,g;for(p=0;p<this.files.length;p++)g=this.files[p],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var g=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var y=g-v;if(0<y)this.isSignature(g,l.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,i){var s=e("./reader/readerFor"),o=e("./utils"),l=e("./compressedObject"),u=e("./crc32"),h=e("./utf8"),d=e("./compressions"),p=e("./support");function g(v,y){this.options=v,this.loadOptions=y}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(v){var y,_;if(v.skip(22),this.fileNameLength=v.readInt(2),_=v.readInt(2),this.fileName=v.readData(this.fileNameLength),v.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(b){for(var E in d)if(Object.prototype.hasOwnProperty.call(d,E)&&d[E].magic===b)return d[E];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,y,v.readData(this.compressedSize))},readCentralPart:function(v){this.versionMadeBy=v.readInt(2),v.skip(2),this.bitFlag=v.readInt(2),this.compressionMethod=v.readString(2),this.date=v.readDate(),this.crc32=v.readInt(4),this.compressedSize=v.readInt(4),this.uncompressedSize=v.readInt(4);var y=v.readInt(2);if(this.extraFieldsLength=v.readInt(2),this.fileCommentLength=v.readInt(2),this.diskNumberStart=v.readInt(2),this.internalFileAttributes=v.readInt(2),this.externalFileAttributes=v.readInt(4),this.localHeaderOffset=v.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");v.skip(y),this.readExtraFields(v),this.parseZIP64ExtraField(v),this.fileComment=v.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var v=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),v==0&&(this.dosPermissions=63&this.externalFileAttributes),v==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var v=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(v){var y,_,b,E=v.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});v.index+4<E;)y=v.readInt(2),_=v.readInt(2),b=v.readData(_),this.extraFields[y]={id:y,length:_,value:b};v.setIndex(E)},handleUTF8:function(){var v=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=h.utf8decode(this.fileName),this.fileCommentStr=h.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var _=o.transformTo(v,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var E=o.transformTo(v,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(E)}}},findExtraFieldUnicodePath:function(){var v=this.extraFields[28789];if(v){var y=s(v.value);return y.readInt(1)!==1||u(this.fileName)!==y.readInt(4)?null:h.utf8decode(y.readData(v.length-5))}return null},findExtraFieldUnicodeComment:function(){var v=this.extraFields[25461];if(v){var y=s(v.value);return y.readInt(1)!==1||u(this.fileComment)!==y.readInt(4)?null:h.utf8decode(y.readData(v.length-5))}return null}},r.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,i){function s(y,_,b){this.name=y,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=_,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var o=e("./stream/StreamHelper"),l=e("./stream/DataWorker"),u=e("./utf8"),h=e("./compressedObject"),d=e("./stream/GenericWorker");s.prototype={internalStream:function(y){var _=null,b="string";try{if(!y)throw new Error("No output type specified.");var E=(b=y.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),_=this._decompressWorker();var S=!this._dataBinary;S&&!E&&(_=_.pipe(new u.Utf8EncodeWorker)),!S&&E&&(_=_.pipe(new u.Utf8DecodeWorker))}catch(T){(_=new d("error")).error(T)}return new o(_,b,"")},async:function(y,_){return this.internalStream(y).accumulate(_)},nodeStream:function(y,_){return this.internalStream(y||"nodebuffer").toNodejsStream(_)},_compressWorker:function(y,_){if(this._data instanceof h&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new u.Utf8EncodeWorker)),h.createWorkerFrom(b,y,_)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},v=0;v<p.length;v++)s.prototype[p[v]]=g;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,i){(function(s){var o,l,u=s.MutationObserver||s.WebKitMutationObserver;if(u){var h=0,d=new u(y),p=s.document.createTextNode("");d.observe(p,{characterData:!0}),o=function(){p.data=h=++h%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var _=s.document.createElement("script");_.onreadystatechange=function(){y(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},s.document.documentElement.appendChild(_)}:function(){setTimeout(y,0)};else{var g=new s.MessageChannel;g.port1.onmessage=y,o=function(){g.port2.postMessage(0)}}var v=[];function y(){var _,b;l=!0;for(var E=v.length;E;){for(b=v,v=[],_=-1;++_<E;)b[_]();E=v.length}l=!1}r.exports=function(_){v.push(_)!==1||l||o()}}).call(this,typeof jp<"u"?jp:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,i){var s=e("immediate");function o(){}var l={},u=["REJECTED"],h=["FULFILLED"],d=["PENDING"];function p(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,E!==o&&_(this,E)}function g(E,S,T){this.promise=E,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function v(E,S,T){s(function(){var O;try{O=S(T)}catch(R){return l.reject(E,R)}O===E?l.reject(E,new TypeError("Cannot resolve promise with itself")):l.resolve(E,O)})}function y(E){var S=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof S=="function")return function(){S.apply(E,arguments)}}function _(E,S){var T=!1;function O(C){T||(T=!0,l.reject(E,C))}function R(C){T||(T=!0,l.resolve(E,C))}var N=b(function(){S(R,O)});N.status==="error"&&O(N.value)}function b(E,S){var T={};try{T.value=E(S),T.status="success"}catch(O){T.status="error",T.value=O}return T}(r.exports=p).prototype.finally=function(E){if(typeof E!="function")return this;var S=this.constructor;return this.then(function(T){return S.resolve(E()).then(function(){return T})},function(T){return S.resolve(E()).then(function(){throw T})})},p.prototype.catch=function(E){return this.then(null,E)},p.prototype.then=function(E,S){if(typeof E!="function"&&this.state===h||typeof S!="function"&&this.state===u)return this;var T=new this.constructor(o);return this.state!==d?v(T,this.state===h?E:S,this.outcome):this.queue.push(new g(T,E,S)),T},g.prototype.callFulfilled=function(E){l.resolve(this.promise,E)},g.prototype.otherCallFulfilled=function(E){v(this.promise,this.onFulfilled,E)},g.prototype.callRejected=function(E){l.reject(this.promise,E)},g.prototype.otherCallRejected=function(E){v(this.promise,this.onRejected,E)},l.resolve=function(E,S){var T=b(y,S);if(T.status==="error")return l.reject(E,T.value);var O=T.value;if(O)_(E,O);else{E.state=h,E.outcome=S;for(var R=-1,N=E.queue.length;++R<N;)E.queue[R].callFulfilled(S)}return E},l.reject=function(E,S){E.state=u,E.outcome=S;for(var T=-1,O=E.queue.length;++T<O;)E.queue[T].callRejected(S);return E},p.resolve=function(E){return E instanceof this?E:l.resolve(new this(o),E)},p.reject=function(E){var S=new this(o);return l.reject(S,E)},p.all=function(E){var S=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=E.length,O=!1;if(!T)return this.resolve([]);for(var R=new Array(T),N=0,C=-1,I=new this(o);++C<T;)M(E[C],C);return I;function M(F,H){S.resolve(F).then(function(P){R[H]=P,++N!==T||O||(O=!0,l.resolve(I,R))},function(P){O||(O=!0,l.reject(I,P))})}},p.race=function(E){var S=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=E.length,O=!1;if(!T)return this.resolve([]);for(var R=-1,N=new this(o);++R<T;)C=E[R],S.resolve(C).then(function(I){O||(O=!0,l.resolve(N,I))},function(I){O||(O=!0,l.reject(N,I))});var C;return N}},{immediate:36}],38:[function(e,r,i){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,i){var s=e("./zlib/deflate"),o=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/messages"),h=e("./zlib/zstream"),d=Object.prototype.toString,p=0,g=-1,v=0,y=8;function _(E){if(!(this instanceof _))return new _(E);this.options=o.assign({level:g,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},E||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var T=s.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(T!==p)throw new Error(u[T]);if(S.header&&s.deflateSetHeader(this.strm,S.header),S.dictionary){var O;if(O=typeof S.dictionary=="string"?l.string2buf(S.dictionary):d.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(T=s.deflateSetDictionary(this.strm,O))!==p)throw new Error(u[T]);this._dict_set=!0}}function b(E,S){var T=new _(S);if(T.push(E,!0),T.err)throw T.msg||u[T.err];return T.result}_.prototype.push=function(E,S){var T,O,R=this.strm,N=this.options.chunkSize;if(this.ended)return!1;O=S===~~S?S:S===!0?4:0,typeof E=="string"?R.input=l.string2buf(E):d.call(E)==="[object ArrayBuffer]"?R.input=new Uint8Array(E):R.input=E,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new o.Buf8(N),R.next_out=0,R.avail_out=N),(T=s.deflate(R,O))!==1&&T!==p)return this.onEnd(T),!(this.ended=!0);R.avail_out!==0&&(R.avail_in!==0||O!==4&&O!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(R.output,R.next_out))):this.onData(o.shrinkBuf(R.output,R.next_out)))}while((0<R.avail_in||R.avail_out===0)&&T!==1);return O===4?(T=s.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===p):O!==2||(this.onEnd(p),!(R.avail_out=0))},_.prototype.onData=function(E){this.chunks.push(E)},_.prototype.onEnd=function(E){E===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},i.Deflate=_,i.deflate=b,i.deflateRaw=function(E,S){return(S=S||{}).raw=!0,b(E,S)},i.gzip=function(E,S){return(S=S||{}).gzip=!0,b(E,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,i){var s=e("./zlib/inflate"),o=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/constants"),h=e("./zlib/messages"),d=e("./zlib/zstream"),p=e("./zlib/gzheader"),g=Object.prototype.toString;function v(_){if(!(this instanceof v))return new v(_);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},_||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||_&&_.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&(15&b.windowBits)==0&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var E=s.inflateInit2(this.strm,b.windowBits);if(E!==u.Z_OK)throw new Error(h[E]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function y(_,b){var E=new v(b);if(E.push(_,!0),E.err)throw E.msg||h[E.err];return E.result}v.prototype.push=function(_,b){var E,S,T,O,R,N,C=this.strm,I=this.options.chunkSize,M=this.options.dictionary,F=!1;if(this.ended)return!1;S=b===~~b?b:b===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof _=="string"?C.input=l.binstring2buf(_):g.call(_)==="[object ArrayBuffer]"?C.input=new Uint8Array(_):C.input=_,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new o.Buf8(I),C.next_out=0,C.avail_out=I),(E=s.inflate(C,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&M&&(N=typeof M=="string"?l.string2buf(M):g.call(M)==="[object ArrayBuffer]"?new Uint8Array(M):M,E=s.inflateSetDictionary(this.strm,N)),E===u.Z_BUF_ERROR&&F===!0&&(E=u.Z_OK,F=!1),E!==u.Z_STREAM_END&&E!==u.Z_OK)return this.onEnd(E),!(this.ended=!0);C.next_out&&(C.avail_out!==0&&E!==u.Z_STREAM_END&&(C.avail_in!==0||S!==u.Z_FINISH&&S!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(T=l.utf8border(C.output,C.next_out),O=C.next_out-T,R=l.buf2string(C.output,T),C.next_out=O,C.avail_out=I-O,O&&o.arraySet(C.output,C.output,T,O,0),this.onData(R)):this.onData(o.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(F=!0)}while((0<C.avail_in||C.avail_out===0)&&E!==u.Z_STREAM_END);return E===u.Z_STREAM_END&&(S=u.Z_FINISH),S===u.Z_FINISH?(E=s.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===u.Z_OK):S!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(C.avail_out=0))},v.prototype.onData=function(_){this.chunks.push(_)},v.prototype.onEnd=function(_){_===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},i.Inflate=v,i.inflate=y,i.inflateRaw=function(_,b){return(b=b||{}).raw=!0,y(_,b)},i.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(u){for(var h=Array.prototype.slice.call(arguments,1);h.length;){var d=h.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(u[p]=d[p])}}return u},i.shrinkBuf=function(u,h){return u.length===h?u:u.subarray?u.subarray(0,h):(u.length=h,u)};var o={arraySet:function(u,h,d,p,g){if(h.subarray&&u.subarray)u.set(h.subarray(d,d+p),g);else for(var v=0;v<p;v++)u[g+v]=h[d+v]},flattenChunks:function(u){var h,d,p,g,v,y;for(h=p=0,d=u.length;h<d;h++)p+=u[h].length;for(y=new Uint8Array(p),h=g=0,d=u.length;h<d;h++)v=u[h],y.set(v,g),g+=v.length;return y}},l={arraySet:function(u,h,d,p,g){for(var v=0;v<p;v++)u[g+v]=h[d+v]},flattenChunks:function(u){return[].concat.apply([],u)}};i.setTyped=function(u){u?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(s)},{}],42:[function(e,r,i){var s=e("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var u=new s.Buf8(256),h=0;h<256;h++)u[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;function d(p,g){if(g<65537&&(p.subarray&&l||!p.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(p,g));for(var v="",y=0;y<g;y++)v+=String.fromCharCode(p[y]);return v}u[254]=u[254]=1,i.string2buf=function(p){var g,v,y,_,b,E=p.length,S=0;for(_=0;_<E;_++)(64512&(v=p.charCodeAt(_)))==55296&&_+1<E&&(64512&(y=p.charCodeAt(_+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),_++),S+=v<128?1:v<2048?2:v<65536?3:4;for(g=new s.Buf8(S),_=b=0;b<S;_++)(64512&(v=p.charCodeAt(_)))==55296&&_+1<E&&(64512&(y=p.charCodeAt(_+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),_++),v<128?g[b++]=v:(v<2048?g[b++]=192|v>>>6:(v<65536?g[b++]=224|v>>>12:(g[b++]=240|v>>>18,g[b++]=128|v>>>12&63),g[b++]=128|v>>>6&63),g[b++]=128|63&v);return g},i.buf2binstring=function(p){return d(p,p.length)},i.binstring2buf=function(p){for(var g=new s.Buf8(p.length),v=0,y=g.length;v<y;v++)g[v]=p.charCodeAt(v);return g},i.buf2string=function(p,g){var v,y,_,b,E=g||p.length,S=new Array(2*E);for(v=y=0;v<E;)if((_=p[v++])<128)S[y++]=_;else if(4<(b=u[_]))S[y++]=65533,v+=b-1;else{for(_&=b===2?31:b===3?15:7;1<b&&v<E;)_=_<<6|63&p[v++],b--;1<b?S[y++]=65533:_<65536?S[y++]=_:(_-=65536,S[y++]=55296|_>>10&1023,S[y++]=56320|1023&_)}return d(S,y)},i.utf8border=function(p,g){var v;for((g=g||p.length)>p.length&&(g=p.length),v=g-1;0<=v&&(192&p[v])==128;)v--;return v<0||v===0?g:v+u[p[v]]>g?v:g}},{"./common":41}],43:[function(e,r,i){r.exports=function(s,o,l,u){for(var h=65535&s|0,d=s>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;d=d+(h=h+o[u++]|0)|0,--p;);h%=65521,d%=65521}return h|d<<16|0}},{}],44:[function(e,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,i){var s=function(){for(var o,l=[],u=0;u<256;u++){o=u;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;l[u]=o}return l}();r.exports=function(o,l,u,h){var d=s,p=h+u;o^=-1;for(var g=h;g<p;g++)o=o>>>8^d[255&(o^l[g])];return-1^o}},{}],46:[function(e,r,i){var s,o=e("../utils/common"),l=e("./trees"),u=e("./adler32"),h=e("./crc32"),d=e("./messages"),p=0,g=4,v=0,y=-2,_=-1,b=4,E=2,S=8,T=9,O=286,R=30,N=19,C=2*O+1,I=15,M=3,F=258,H=F+M+1,P=42,et=113,L=1,st=2,Q=3,Y=4;function Ot(D,dt){return D.msg=d[dt],dt}function Et(D){return(D<<1)-(4<D?9:0)}function z(D){for(var dt=D.length;0<=--dt;)D[dt]=0}function J(D){var dt=D.state,it=dt.pending;it>D.avail_out&&(it=D.avail_out),it!==0&&(o.arraySet(D.output,dt.pending_buf,dt.pending_out,it,D.next_out),D.next_out+=it,dt.pending_out+=it,D.total_out+=it,D.avail_out-=it,dt.pending-=it,dt.pending===0&&(dt.pending_out=0))}function V(D,dt){l._tr_flush_block(D,0<=D.block_start?D.block_start:-1,D.strstart-D.block_start,dt),D.block_start=D.strstart,J(D.strm)}function ct(D,dt){D.pending_buf[D.pending++]=dt}function gt(D,dt){D.pending_buf[D.pending++]=dt>>>8&255,D.pending_buf[D.pending++]=255&dt}function _t(D,dt){var it,q,X=D.max_chain_length,ft=D.strstart,Pt=D.prev_length,zt=D.nice_match,bt=D.strstart>D.w_size-H?D.strstart-(D.w_size-H):0,Rt=D.window,qt=D.w_mask,xt=D.prev,se=D.strstart+F,de=Rt[ft+Pt-1],ae=Rt[ft+Pt];D.prev_length>=D.good_match&&(X>>=2),zt>D.lookahead&&(zt=D.lookahead);do if(Rt[(it=dt)+Pt]===ae&&Rt[it+Pt-1]===de&&Rt[it]===Rt[ft]&&Rt[++it]===Rt[ft+1]){ft+=2,it++;do;while(Rt[++ft]===Rt[++it]&&Rt[++ft]===Rt[++it]&&Rt[++ft]===Rt[++it]&&Rt[++ft]===Rt[++it]&&Rt[++ft]===Rt[++it]&&Rt[++ft]===Rt[++it]&&Rt[++ft]===Rt[++it]&&Rt[++ft]===Rt[++it]&&ft<se);if(q=F-(se-ft),ft=se-F,Pt<q){if(D.match_start=dt,zt<=(Pt=q))break;de=Rt[ft+Pt-1],ae=Rt[ft+Pt]}}while((dt=xt[dt&qt])>bt&&--X!=0);return Pt<=D.lookahead?Pt:D.lookahead}function Bt(D){var dt,it,q,X,ft,Pt,zt,bt,Rt,qt,xt=D.w_size;do{if(X=D.window_size-D.lookahead-D.strstart,D.strstart>=xt+(xt-H)){for(o.arraySet(D.window,D.window,xt,xt,0),D.match_start-=xt,D.strstart-=xt,D.block_start-=xt,dt=it=D.hash_size;q=D.head[--dt],D.head[dt]=xt<=q?q-xt:0,--it;);for(dt=it=xt;q=D.prev[--dt],D.prev[dt]=xt<=q?q-xt:0,--it;);X+=xt}if(D.strm.avail_in===0)break;if(Pt=D.strm,zt=D.window,bt=D.strstart+D.lookahead,Rt=X,qt=void 0,qt=Pt.avail_in,Rt<qt&&(qt=Rt),it=qt===0?0:(Pt.avail_in-=qt,o.arraySet(zt,Pt.input,Pt.next_in,qt,bt),Pt.state.wrap===1?Pt.adler=u(Pt.adler,zt,qt,bt):Pt.state.wrap===2&&(Pt.adler=h(Pt.adler,zt,qt,bt)),Pt.next_in+=qt,Pt.total_in+=qt,qt),D.lookahead+=it,D.lookahead+D.insert>=M)for(ft=D.strstart-D.insert,D.ins_h=D.window[ft],D.ins_h=(D.ins_h<<D.hash_shift^D.window[ft+1])&D.hash_mask;D.insert&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[ft+M-1])&D.hash_mask,D.prev[ft&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=ft,ft++,D.insert--,!(D.lookahead+D.insert<M)););}while(D.lookahead<H&&D.strm.avail_in!==0)}function Gt(D,dt){for(var it,q;;){if(D.lookahead<H){if(Bt(D),D.lookahead<H&&dt===p)return L;if(D.lookahead===0)break}if(it=0,D.lookahead>=M&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+M-1])&D.hash_mask,it=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),it!==0&&D.strstart-it<=D.w_size-H&&(D.match_length=_t(D,it)),D.match_length>=M)if(q=l._tr_tally(D,D.strstart-D.match_start,D.match_length-M),D.lookahead-=D.match_length,D.match_length<=D.max_lazy_match&&D.lookahead>=M){for(D.match_length--;D.strstart++,D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+M-1])&D.hash_mask,it=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart,--D.match_length!=0;);D.strstart++}else D.strstart+=D.match_length,D.match_length=0,D.ins_h=D.window[D.strstart],D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+1])&D.hash_mask;else q=l._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++;if(q&&(V(D,!1),D.strm.avail_out===0))return L}return D.insert=D.strstart<M-1?D.strstart:M-1,dt===g?(V(D,!0),D.strm.avail_out===0?Q:Y):D.last_lit&&(V(D,!1),D.strm.avail_out===0)?L:st}function j(D,dt){for(var it,q,X;;){if(D.lookahead<H){if(Bt(D),D.lookahead<H&&dt===p)return L;if(D.lookahead===0)break}if(it=0,D.lookahead>=M&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+M-1])&D.hash_mask,it=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),D.prev_length=D.match_length,D.prev_match=D.match_start,D.match_length=M-1,it!==0&&D.prev_length<D.max_lazy_match&&D.strstart-it<=D.w_size-H&&(D.match_length=_t(D,it),D.match_length<=5&&(D.strategy===1||D.match_length===M&&4096<D.strstart-D.match_start)&&(D.match_length=M-1)),D.prev_length>=M&&D.match_length<=D.prev_length){for(X=D.strstart+D.lookahead-M,q=l._tr_tally(D,D.strstart-1-D.prev_match,D.prev_length-M),D.lookahead-=D.prev_length-1,D.prev_length-=2;++D.strstart<=X&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+M-1])&D.hash_mask,it=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),--D.prev_length!=0;);if(D.match_available=0,D.match_length=M-1,D.strstart++,q&&(V(D,!1),D.strm.avail_out===0))return L}else if(D.match_available){if((q=l._tr_tally(D,0,D.window[D.strstart-1]))&&V(D,!1),D.strstart++,D.lookahead--,D.strm.avail_out===0)return L}else D.match_available=1,D.strstart++,D.lookahead--}return D.match_available&&(q=l._tr_tally(D,0,D.window[D.strstart-1]),D.match_available=0),D.insert=D.strstart<M-1?D.strstart:M-1,dt===g?(V(D,!0),D.strm.avail_out===0?Q:Y):D.last_lit&&(V(D,!1),D.strm.avail_out===0)?L:st}function pt(D,dt,it,q,X){this.good_length=D,this.max_lazy=dt,this.nice_length=it,this.max_chain=q,this.func=X}function lt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*C),this.dyn_dtree=new o.Buf16(2*(2*R+1)),this.bl_tree=new o.Buf16(2*(2*N+1)),z(this.dyn_ltree),z(this.dyn_dtree),z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(I+1),this.heap=new o.Buf16(2*O+1),z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*O+1),z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ut(D){var dt;return D&&D.state?(D.total_in=D.total_out=0,D.data_type=E,(dt=D.state).pending=0,dt.pending_out=0,dt.wrap<0&&(dt.wrap=-dt.wrap),dt.status=dt.wrap?P:et,D.adler=dt.wrap===2?0:1,dt.last_flush=p,l._tr_init(dt),v):Ot(D,y)}function Dt(D){var dt=ut(D);return dt===v&&function(it){it.window_size=2*it.w_size,z(it.head),it.max_lazy_match=s[it.level].max_lazy,it.good_match=s[it.level].good_length,it.nice_match=s[it.level].nice_length,it.max_chain_length=s[it.level].max_chain,it.strstart=0,it.block_start=0,it.lookahead=0,it.insert=0,it.match_length=it.prev_length=M-1,it.match_available=0,it.ins_h=0}(D.state),dt}function Lt(D,dt,it,q,X,ft){if(!D)return y;var Pt=1;if(dt===_&&(dt=6),q<0?(Pt=0,q=-q):15<q&&(Pt=2,q-=16),X<1||T<X||it!==S||q<8||15<q||dt<0||9<dt||ft<0||b<ft)return Ot(D,y);q===8&&(q=9);var zt=new lt;return(D.state=zt).strm=D,zt.wrap=Pt,zt.gzhead=null,zt.w_bits=q,zt.w_size=1<<zt.w_bits,zt.w_mask=zt.w_size-1,zt.hash_bits=X+7,zt.hash_size=1<<zt.hash_bits,zt.hash_mask=zt.hash_size-1,zt.hash_shift=~~((zt.hash_bits+M-1)/M),zt.window=new o.Buf8(2*zt.w_size),zt.head=new o.Buf16(zt.hash_size),zt.prev=new o.Buf16(zt.w_size),zt.lit_bufsize=1<<X+6,zt.pending_buf_size=4*zt.lit_bufsize,zt.pending_buf=new o.Buf8(zt.pending_buf_size),zt.d_buf=1*zt.lit_bufsize,zt.l_buf=3*zt.lit_bufsize,zt.level=dt,zt.strategy=ft,zt.method=it,Dt(D)}s=[new pt(0,0,0,0,function(D,dt){var it=65535;for(it>D.pending_buf_size-5&&(it=D.pending_buf_size-5);;){if(D.lookahead<=1){if(Bt(D),D.lookahead===0&&dt===p)return L;if(D.lookahead===0)break}D.strstart+=D.lookahead,D.lookahead=0;var q=D.block_start+it;if((D.strstart===0||D.strstart>=q)&&(D.lookahead=D.strstart-q,D.strstart=q,V(D,!1),D.strm.avail_out===0)||D.strstart-D.block_start>=D.w_size-H&&(V(D,!1),D.strm.avail_out===0))return L}return D.insert=0,dt===g?(V(D,!0),D.strm.avail_out===0?Q:Y):(D.strstart>D.block_start&&(V(D,!1),D.strm.avail_out),L)}),new pt(4,4,8,4,Gt),new pt(4,5,16,8,Gt),new pt(4,6,32,32,Gt),new pt(4,4,16,16,j),new pt(8,16,32,32,j),new pt(8,16,128,128,j),new pt(8,32,128,256,j),new pt(32,128,258,1024,j),new pt(32,258,258,4096,j)],i.deflateInit=function(D,dt){return Lt(D,dt,S,15,8,0)},i.deflateInit2=Lt,i.deflateReset=Dt,i.deflateResetKeep=ut,i.deflateSetHeader=function(D,dt){return D&&D.state?D.state.wrap!==2?y:(D.state.gzhead=dt,v):y},i.deflate=function(D,dt){var it,q,X,ft;if(!D||!D.state||5<dt||dt<0)return D?Ot(D,y):y;if(q=D.state,!D.output||!D.input&&D.avail_in!==0||q.status===666&&dt!==g)return Ot(D,D.avail_out===0?-5:y);if(q.strm=D,it=q.last_flush,q.last_flush=dt,q.status===P)if(q.wrap===2)D.adler=0,ct(q,31),ct(q,139),ct(q,8),q.gzhead?(ct(q,(q.gzhead.text?1:0)+(q.gzhead.hcrc?2:0)+(q.gzhead.extra?4:0)+(q.gzhead.name?8:0)+(q.gzhead.comment?16:0)),ct(q,255&q.gzhead.time),ct(q,q.gzhead.time>>8&255),ct(q,q.gzhead.time>>16&255),ct(q,q.gzhead.time>>24&255),ct(q,q.level===9?2:2<=q.strategy||q.level<2?4:0),ct(q,255&q.gzhead.os),q.gzhead.extra&&q.gzhead.extra.length&&(ct(q,255&q.gzhead.extra.length),ct(q,q.gzhead.extra.length>>8&255)),q.gzhead.hcrc&&(D.adler=h(D.adler,q.pending_buf,q.pending,0)),q.gzindex=0,q.status=69):(ct(q,0),ct(q,0),ct(q,0),ct(q,0),ct(q,0),ct(q,q.level===9?2:2<=q.strategy||q.level<2?4:0),ct(q,3),q.status=et);else{var Pt=S+(q.w_bits-8<<4)<<8;Pt|=(2<=q.strategy||q.level<2?0:q.level<6?1:q.level===6?2:3)<<6,q.strstart!==0&&(Pt|=32),Pt+=31-Pt%31,q.status=et,gt(q,Pt),q.strstart!==0&&(gt(q,D.adler>>>16),gt(q,65535&D.adler)),D.adler=1}if(q.status===69)if(q.gzhead.extra){for(X=q.pending;q.gzindex<(65535&q.gzhead.extra.length)&&(q.pending!==q.pending_buf_size||(q.gzhead.hcrc&&q.pending>X&&(D.adler=h(D.adler,q.pending_buf,q.pending-X,X)),J(D),X=q.pending,q.pending!==q.pending_buf_size));)ct(q,255&q.gzhead.extra[q.gzindex]),q.gzindex++;q.gzhead.hcrc&&q.pending>X&&(D.adler=h(D.adler,q.pending_buf,q.pending-X,X)),q.gzindex===q.gzhead.extra.length&&(q.gzindex=0,q.status=73)}else q.status=73;if(q.status===73)if(q.gzhead.name){X=q.pending;do{if(q.pending===q.pending_buf_size&&(q.gzhead.hcrc&&q.pending>X&&(D.adler=h(D.adler,q.pending_buf,q.pending-X,X)),J(D),X=q.pending,q.pending===q.pending_buf_size)){ft=1;break}ft=q.gzindex<q.gzhead.name.length?255&q.gzhead.name.charCodeAt(q.gzindex++):0,ct(q,ft)}while(ft!==0);q.gzhead.hcrc&&q.pending>X&&(D.adler=h(D.adler,q.pending_buf,q.pending-X,X)),ft===0&&(q.gzindex=0,q.status=91)}else q.status=91;if(q.status===91)if(q.gzhead.comment){X=q.pending;do{if(q.pending===q.pending_buf_size&&(q.gzhead.hcrc&&q.pending>X&&(D.adler=h(D.adler,q.pending_buf,q.pending-X,X)),J(D),X=q.pending,q.pending===q.pending_buf_size)){ft=1;break}ft=q.gzindex<q.gzhead.comment.length?255&q.gzhead.comment.charCodeAt(q.gzindex++):0,ct(q,ft)}while(ft!==0);q.gzhead.hcrc&&q.pending>X&&(D.adler=h(D.adler,q.pending_buf,q.pending-X,X)),ft===0&&(q.status=103)}else q.status=103;if(q.status===103&&(q.gzhead.hcrc?(q.pending+2>q.pending_buf_size&&J(D),q.pending+2<=q.pending_buf_size&&(ct(q,255&D.adler),ct(q,D.adler>>8&255),D.adler=0,q.status=et)):q.status=et),q.pending!==0){if(J(D),D.avail_out===0)return q.last_flush=-1,v}else if(D.avail_in===0&&Et(dt)<=Et(it)&&dt!==g)return Ot(D,-5);if(q.status===666&&D.avail_in!==0)return Ot(D,-5);if(D.avail_in!==0||q.lookahead!==0||dt!==p&&q.status!==666){var zt=q.strategy===2?function(bt,Rt){for(var qt;;){if(bt.lookahead===0&&(Bt(bt),bt.lookahead===0)){if(Rt===p)return L;break}if(bt.match_length=0,qt=l._tr_tally(bt,0,bt.window[bt.strstart]),bt.lookahead--,bt.strstart++,qt&&(V(bt,!1),bt.strm.avail_out===0))return L}return bt.insert=0,Rt===g?(V(bt,!0),bt.strm.avail_out===0?Q:Y):bt.last_lit&&(V(bt,!1),bt.strm.avail_out===0)?L:st}(q,dt):q.strategy===3?function(bt,Rt){for(var qt,xt,se,de,ae=bt.window;;){if(bt.lookahead<=F){if(Bt(bt),bt.lookahead<=F&&Rt===p)return L;if(bt.lookahead===0)break}if(bt.match_length=0,bt.lookahead>=M&&0<bt.strstart&&(xt=ae[se=bt.strstart-1])===ae[++se]&&xt===ae[++se]&&xt===ae[++se]){de=bt.strstart+F;do;while(xt===ae[++se]&&xt===ae[++se]&&xt===ae[++se]&&xt===ae[++se]&&xt===ae[++se]&&xt===ae[++se]&&xt===ae[++se]&&xt===ae[++se]&&se<de);bt.match_length=F-(de-se),bt.match_length>bt.lookahead&&(bt.match_length=bt.lookahead)}if(bt.match_length>=M?(qt=l._tr_tally(bt,1,bt.match_length-M),bt.lookahead-=bt.match_length,bt.strstart+=bt.match_length,bt.match_length=0):(qt=l._tr_tally(bt,0,bt.window[bt.strstart]),bt.lookahead--,bt.strstart++),qt&&(V(bt,!1),bt.strm.avail_out===0))return L}return bt.insert=0,Rt===g?(V(bt,!0),bt.strm.avail_out===0?Q:Y):bt.last_lit&&(V(bt,!1),bt.strm.avail_out===0)?L:st}(q,dt):s[q.level].func(q,dt);if(zt!==Q&&zt!==Y||(q.status=666),zt===L||zt===Q)return D.avail_out===0&&(q.last_flush=-1),v;if(zt===st&&(dt===1?l._tr_align(q):dt!==5&&(l._tr_stored_block(q,0,0,!1),dt===3&&(z(q.head),q.lookahead===0&&(q.strstart=0,q.block_start=0,q.insert=0))),J(D),D.avail_out===0))return q.last_flush=-1,v}return dt!==g?v:q.wrap<=0?1:(q.wrap===2?(ct(q,255&D.adler),ct(q,D.adler>>8&255),ct(q,D.adler>>16&255),ct(q,D.adler>>24&255),ct(q,255&D.total_in),ct(q,D.total_in>>8&255),ct(q,D.total_in>>16&255),ct(q,D.total_in>>24&255)):(gt(q,D.adler>>>16),gt(q,65535&D.adler)),J(D),0<q.wrap&&(q.wrap=-q.wrap),q.pending!==0?v:1)},i.deflateEnd=function(D){var dt;return D&&D.state?(dt=D.state.status)!==P&&dt!==69&&dt!==73&&dt!==91&&dt!==103&&dt!==et&&dt!==666?Ot(D,y):(D.state=null,dt===et?Ot(D,-3):v):y},i.deflateSetDictionary=function(D,dt){var it,q,X,ft,Pt,zt,bt,Rt,qt=dt.length;if(!D||!D.state||(ft=(it=D.state).wrap)===2||ft===1&&it.status!==P||it.lookahead)return y;for(ft===1&&(D.adler=u(D.adler,dt,qt,0)),it.wrap=0,qt>=it.w_size&&(ft===0&&(z(it.head),it.strstart=0,it.block_start=0,it.insert=0),Rt=new o.Buf8(it.w_size),o.arraySet(Rt,dt,qt-it.w_size,it.w_size,0),dt=Rt,qt=it.w_size),Pt=D.avail_in,zt=D.next_in,bt=D.input,D.avail_in=qt,D.next_in=0,D.input=dt,Bt(it);it.lookahead>=M;){for(q=it.strstart,X=it.lookahead-(M-1);it.ins_h=(it.ins_h<<it.hash_shift^it.window[q+M-1])&it.hash_mask,it.prev[q&it.w_mask]=it.head[it.ins_h],it.head[it.ins_h]=q,q++,--X;);it.strstart=q,it.lookahead=M-1,Bt(it)}return it.strstart+=it.lookahead,it.block_start=it.strstart,it.insert=it.lookahead,it.lookahead=0,it.match_length=it.prev_length=M-1,it.match_available=0,D.next_in=zt,D.input=bt,D.avail_in=Pt,it.wrap=ft,v},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,i){r.exports=function(s,o){var l,u,h,d,p,g,v,y,_,b,E,S,T,O,R,N,C,I,M,F,H,P,et,L,st;l=s.state,u=s.next_in,L=s.input,h=u+(s.avail_in-5),d=s.next_out,st=s.output,p=d-(o-s.avail_out),g=d+(s.avail_out-257),v=l.dmax,y=l.wsize,_=l.whave,b=l.wnext,E=l.window,S=l.hold,T=l.bits,O=l.lencode,R=l.distcode,N=(1<<l.lenbits)-1,C=(1<<l.distbits)-1;t:do{T<15&&(S+=L[u++]<<T,T+=8,S+=L[u++]<<T,T+=8),I=O[S&N];e:for(;;){if(S>>>=M=I>>>24,T-=M,(M=I>>>16&255)===0)st[d++]=65535&I;else{if(!(16&M)){if((64&M)==0){I=O[(65535&I)+(S&(1<<M)-1)];continue e}if(32&M){l.mode=12;break t}s.msg="invalid literal/length code",l.mode=30;break t}F=65535&I,(M&=15)&&(T<M&&(S+=L[u++]<<T,T+=8),F+=S&(1<<M)-1,S>>>=M,T-=M),T<15&&(S+=L[u++]<<T,T+=8,S+=L[u++]<<T,T+=8),I=R[S&C];n:for(;;){if(S>>>=M=I>>>24,T-=M,!(16&(M=I>>>16&255))){if((64&M)==0){I=R[(65535&I)+(S&(1<<M)-1)];continue n}s.msg="invalid distance code",l.mode=30;break t}if(H=65535&I,T<(M&=15)&&(S+=L[u++]<<T,(T+=8)<M&&(S+=L[u++]<<T,T+=8)),v<(H+=S&(1<<M)-1)){s.msg="invalid distance too far back",l.mode=30;break t}if(S>>>=M,T-=M,(M=d-p)<H){if(_<(M=H-M)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break t}if(et=E,(P=0)===b){if(P+=y-M,M<F){for(F-=M;st[d++]=E[P++],--M;);P=d-H,et=st}}else if(b<M){if(P+=y+b-M,(M-=b)<F){for(F-=M;st[d++]=E[P++],--M;);if(P=0,b<F){for(F-=M=b;st[d++]=E[P++],--M;);P=d-H,et=st}}}else if(P+=b-M,M<F){for(F-=M;st[d++]=E[P++],--M;);P=d-H,et=st}for(;2<F;)st[d++]=et[P++],st[d++]=et[P++],st[d++]=et[P++],F-=3;F&&(st[d++]=et[P++],1<F&&(st[d++]=et[P++]))}else{for(P=d-H;st[d++]=st[P++],st[d++]=st[P++],st[d++]=st[P++],2<(F-=3););F&&(st[d++]=st[P++],1<F&&(st[d++]=st[P++]))}break}}break}}while(u<h&&d<g);u-=F=T>>3,S&=(1<<(T-=F<<3))-1,s.next_in=u,s.next_out=d,s.avail_in=u<h?h-u+5:5-(u-h),s.avail_out=d<g?g-d+257:257-(d-g),l.hold=S,l.bits=T}},{}],49:[function(e,r,i){var s=e("../utils/common"),o=e("./adler32"),l=e("./crc32"),u=e("./inffast"),h=e("./inftrees"),d=1,p=2,g=0,v=-2,y=1,_=852,b=592;function E(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(P){var et;return P&&P.state?(et=P.state,P.total_in=P.total_out=et.total=0,P.msg="",et.wrap&&(P.adler=1&et.wrap),et.mode=y,et.last=0,et.havedict=0,et.dmax=32768,et.head=null,et.hold=0,et.bits=0,et.lencode=et.lendyn=new s.Buf32(_),et.distcode=et.distdyn=new s.Buf32(b),et.sane=1,et.back=-1,g):v}function O(P){var et;return P&&P.state?((et=P.state).wsize=0,et.whave=0,et.wnext=0,T(P)):v}function R(P,et){var L,st;return P&&P.state?(st=P.state,et<0?(L=0,et=-et):(L=1+(et>>4),et<48&&(et&=15)),et&&(et<8||15<et)?v:(st.window!==null&&st.wbits!==et&&(st.window=null),st.wrap=L,st.wbits=et,O(P))):v}function N(P,et){var L,st;return P?(st=new S,(P.state=st).window=null,(L=R(P,et))!==g&&(P.state=null),L):v}var C,I,M=!0;function F(P){if(M){var et;for(C=new s.Buf32(512),I=new s.Buf32(32),et=0;et<144;)P.lens[et++]=8;for(;et<256;)P.lens[et++]=9;for(;et<280;)P.lens[et++]=7;for(;et<288;)P.lens[et++]=8;for(h(d,P.lens,0,288,C,0,P.work,{bits:9}),et=0;et<32;)P.lens[et++]=5;h(p,P.lens,0,32,I,0,P.work,{bits:5}),M=!1}P.lencode=C,P.lenbits=9,P.distcode=I,P.distbits=5}function H(P,et,L,st){var Q,Y=P.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new s.Buf8(Y.wsize)),st>=Y.wsize?(s.arraySet(Y.window,et,L-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(st<(Q=Y.wsize-Y.wnext)&&(Q=st),s.arraySet(Y.window,et,L-st,Q,Y.wnext),(st-=Q)?(s.arraySet(Y.window,et,L-st,st,0),Y.wnext=st,Y.whave=Y.wsize):(Y.wnext+=Q,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=Q))),0}i.inflateReset=O,i.inflateReset2=R,i.inflateResetKeep=T,i.inflateInit=function(P){return N(P,15)},i.inflateInit2=N,i.inflate=function(P,et){var L,st,Q,Y,Ot,Et,z,J,V,ct,gt,_t,Bt,Gt,j,pt,lt,ut,Dt,Lt,D,dt,it,q,X=0,ft=new s.Buf8(4),Pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return v;(L=P.state).mode===12&&(L.mode=13),Ot=P.next_out,Q=P.output,z=P.avail_out,Y=P.next_in,st=P.input,Et=P.avail_in,J=L.hold,V=L.bits,ct=Et,gt=z,dt=g;t:for(;;)switch(L.mode){case y:if(L.wrap===0){L.mode=13;break}for(;V<16;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if(2&L.wrap&&J===35615){ft[L.check=0]=255&J,ft[1]=J>>>8&255,L.check=l(L.check,ft,2,0),V=J=0,L.mode=2;break}if(L.flags=0,L.head&&(L.head.done=!1),!(1&L.wrap)||(((255&J)<<8)+(J>>8))%31){P.msg="incorrect header check",L.mode=30;break}if((15&J)!=8){P.msg="unknown compression method",L.mode=30;break}if(V-=4,D=8+(15&(J>>>=4)),L.wbits===0)L.wbits=D;else if(D>L.wbits){P.msg="invalid window size",L.mode=30;break}L.dmax=1<<D,P.adler=L.check=1,L.mode=512&J?10:12,V=J=0;break;case 2:for(;V<16;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if(L.flags=J,(255&L.flags)!=8){P.msg="unknown compression method",L.mode=30;break}if(57344&L.flags){P.msg="unknown header flags set",L.mode=30;break}L.head&&(L.head.text=J>>8&1),512&L.flags&&(ft[0]=255&J,ft[1]=J>>>8&255,L.check=l(L.check,ft,2,0)),V=J=0,L.mode=3;case 3:for(;V<32;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}L.head&&(L.head.time=J),512&L.flags&&(ft[0]=255&J,ft[1]=J>>>8&255,ft[2]=J>>>16&255,ft[3]=J>>>24&255,L.check=l(L.check,ft,4,0)),V=J=0,L.mode=4;case 4:for(;V<16;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}L.head&&(L.head.xflags=255&J,L.head.os=J>>8),512&L.flags&&(ft[0]=255&J,ft[1]=J>>>8&255,L.check=l(L.check,ft,2,0)),V=J=0,L.mode=5;case 5:if(1024&L.flags){for(;V<16;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}L.length=J,L.head&&(L.head.extra_len=J),512&L.flags&&(ft[0]=255&J,ft[1]=J>>>8&255,L.check=l(L.check,ft,2,0)),V=J=0}else L.head&&(L.head.extra=null);L.mode=6;case 6:if(1024&L.flags&&(Et<(_t=L.length)&&(_t=Et),_t&&(L.head&&(D=L.head.extra_len-L.length,L.head.extra||(L.head.extra=new Array(L.head.extra_len)),s.arraySet(L.head.extra,st,Y,_t,D)),512&L.flags&&(L.check=l(L.check,st,_t,Y)),Et-=_t,Y+=_t,L.length-=_t),L.length))break t;L.length=0,L.mode=7;case 7:if(2048&L.flags){if(Et===0)break t;for(_t=0;D=st[Y+_t++],L.head&&D&&L.length<65536&&(L.head.name+=String.fromCharCode(D)),D&&_t<Et;);if(512&L.flags&&(L.check=l(L.check,st,_t,Y)),Et-=_t,Y+=_t,D)break t}else L.head&&(L.head.name=null);L.length=0,L.mode=8;case 8:if(4096&L.flags){if(Et===0)break t;for(_t=0;D=st[Y+_t++],L.head&&D&&L.length<65536&&(L.head.comment+=String.fromCharCode(D)),D&&_t<Et;);if(512&L.flags&&(L.check=l(L.check,st,_t,Y)),Et-=_t,Y+=_t,D)break t}else L.head&&(L.head.comment=null);L.mode=9;case 9:if(512&L.flags){for(;V<16;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if(J!==(65535&L.check)){P.msg="header crc mismatch",L.mode=30;break}V=J=0}L.head&&(L.head.hcrc=L.flags>>9&1,L.head.done=!0),P.adler=L.check=0,L.mode=12;break;case 10:for(;V<32;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}P.adler=L.check=E(J),V=J=0,L.mode=11;case 11:if(L.havedict===0)return P.next_out=Ot,P.avail_out=z,P.next_in=Y,P.avail_in=Et,L.hold=J,L.bits=V,2;P.adler=L.check=1,L.mode=12;case 12:if(et===5||et===6)break t;case 13:if(L.last){J>>>=7&V,V-=7&V,L.mode=27;break}for(;V<3;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}switch(L.last=1&J,V-=1,3&(J>>>=1)){case 0:L.mode=14;break;case 1:if(F(L),L.mode=20,et!==6)break;J>>>=2,V-=2;break t;case 2:L.mode=17;break;case 3:P.msg="invalid block type",L.mode=30}J>>>=2,V-=2;break;case 14:for(J>>>=7&V,V-=7&V;V<32;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if((65535&J)!=(J>>>16^65535)){P.msg="invalid stored block lengths",L.mode=30;break}if(L.length=65535&J,V=J=0,L.mode=15,et===6)break t;case 15:L.mode=16;case 16:if(_t=L.length){if(Et<_t&&(_t=Et),z<_t&&(_t=z),_t===0)break t;s.arraySet(Q,st,Y,_t,Ot),Et-=_t,Y+=_t,z-=_t,Ot+=_t,L.length-=_t;break}L.mode=12;break;case 17:for(;V<14;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if(L.nlen=257+(31&J),J>>>=5,V-=5,L.ndist=1+(31&J),J>>>=5,V-=5,L.ncode=4+(15&J),J>>>=4,V-=4,286<L.nlen||30<L.ndist){P.msg="too many length or distance symbols",L.mode=30;break}L.have=0,L.mode=18;case 18:for(;L.have<L.ncode;){for(;V<3;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}L.lens[Pt[L.have++]]=7&J,J>>>=3,V-=3}for(;L.have<19;)L.lens[Pt[L.have++]]=0;if(L.lencode=L.lendyn,L.lenbits=7,it={bits:L.lenbits},dt=h(0,L.lens,0,19,L.lencode,0,L.work,it),L.lenbits=it.bits,dt){P.msg="invalid code lengths set",L.mode=30;break}L.have=0,L.mode=19;case 19:for(;L.have<L.nlen+L.ndist;){for(;pt=(X=L.lencode[J&(1<<L.lenbits)-1])>>>16&255,lt=65535&X,!((j=X>>>24)<=V);){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if(lt<16)J>>>=j,V-=j,L.lens[L.have++]=lt;else{if(lt===16){for(q=j+2;V<q;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if(J>>>=j,V-=j,L.have===0){P.msg="invalid bit length repeat",L.mode=30;break}D=L.lens[L.have-1],_t=3+(3&J),J>>>=2,V-=2}else if(lt===17){for(q=j+3;V<q;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}V-=j,D=0,_t=3+(7&(J>>>=j)),J>>>=3,V-=3}else{for(q=j+7;V<q;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}V-=j,D=0,_t=11+(127&(J>>>=j)),J>>>=7,V-=7}if(L.have+_t>L.nlen+L.ndist){P.msg="invalid bit length repeat",L.mode=30;break}for(;_t--;)L.lens[L.have++]=D}}if(L.mode===30)break;if(L.lens[256]===0){P.msg="invalid code -- missing end-of-block",L.mode=30;break}if(L.lenbits=9,it={bits:L.lenbits},dt=h(d,L.lens,0,L.nlen,L.lencode,0,L.work,it),L.lenbits=it.bits,dt){P.msg="invalid literal/lengths set",L.mode=30;break}if(L.distbits=6,L.distcode=L.distdyn,it={bits:L.distbits},dt=h(p,L.lens,L.nlen,L.ndist,L.distcode,0,L.work,it),L.distbits=it.bits,dt){P.msg="invalid distances set",L.mode=30;break}if(L.mode=20,et===6)break t;case 20:L.mode=21;case 21:if(6<=Et&&258<=z){P.next_out=Ot,P.avail_out=z,P.next_in=Y,P.avail_in=Et,L.hold=J,L.bits=V,u(P,gt),Ot=P.next_out,Q=P.output,z=P.avail_out,Y=P.next_in,st=P.input,Et=P.avail_in,J=L.hold,V=L.bits,L.mode===12&&(L.back=-1);break}for(L.back=0;pt=(X=L.lencode[J&(1<<L.lenbits)-1])>>>16&255,lt=65535&X,!((j=X>>>24)<=V);){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if(pt&&(240&pt)==0){for(ut=j,Dt=pt,Lt=lt;pt=(X=L.lencode[Lt+((J&(1<<ut+Dt)-1)>>ut)])>>>16&255,lt=65535&X,!(ut+(j=X>>>24)<=V);){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}J>>>=ut,V-=ut,L.back+=ut}if(J>>>=j,V-=j,L.back+=j,L.length=lt,pt===0){L.mode=26;break}if(32&pt){L.back=-1,L.mode=12;break}if(64&pt){P.msg="invalid literal/length code",L.mode=30;break}L.extra=15&pt,L.mode=22;case 22:if(L.extra){for(q=L.extra;V<q;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}L.length+=J&(1<<L.extra)-1,J>>>=L.extra,V-=L.extra,L.back+=L.extra}L.was=L.length,L.mode=23;case 23:for(;pt=(X=L.distcode[J&(1<<L.distbits)-1])>>>16&255,lt=65535&X,!((j=X>>>24)<=V);){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if((240&pt)==0){for(ut=j,Dt=pt,Lt=lt;pt=(X=L.distcode[Lt+((J&(1<<ut+Dt)-1)>>ut)])>>>16&255,lt=65535&X,!(ut+(j=X>>>24)<=V);){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}J>>>=ut,V-=ut,L.back+=ut}if(J>>>=j,V-=j,L.back+=j,64&pt){P.msg="invalid distance code",L.mode=30;break}L.offset=lt,L.extra=15&pt,L.mode=24;case 24:if(L.extra){for(q=L.extra;V<q;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}L.offset+=J&(1<<L.extra)-1,J>>>=L.extra,V-=L.extra,L.back+=L.extra}if(L.offset>L.dmax){P.msg="invalid distance too far back",L.mode=30;break}L.mode=25;case 25:if(z===0)break t;if(_t=gt-z,L.offset>_t){if((_t=L.offset-_t)>L.whave&&L.sane){P.msg="invalid distance too far back",L.mode=30;break}Bt=_t>L.wnext?(_t-=L.wnext,L.wsize-_t):L.wnext-_t,_t>L.length&&(_t=L.length),Gt=L.window}else Gt=Q,Bt=Ot-L.offset,_t=L.length;for(z<_t&&(_t=z),z-=_t,L.length-=_t;Q[Ot++]=Gt[Bt++],--_t;);L.length===0&&(L.mode=21);break;case 26:if(z===0)break t;Q[Ot++]=L.length,z--,L.mode=21;break;case 27:if(L.wrap){for(;V<32;){if(Et===0)break t;Et--,J|=st[Y++]<<V,V+=8}if(gt-=z,P.total_out+=gt,L.total+=gt,gt&&(P.adler=L.check=L.flags?l(L.check,Q,gt,Ot-gt):o(L.check,Q,gt,Ot-gt)),gt=z,(L.flags?J:E(J))!==L.check){P.msg="incorrect data check",L.mode=30;break}V=J=0}L.mode=28;case 28:if(L.wrap&&L.flags){for(;V<32;){if(Et===0)break t;Et--,J+=st[Y++]<<V,V+=8}if(J!==(4294967295&L.total)){P.msg="incorrect length check",L.mode=30;break}V=J=0}L.mode=29;case 29:dt=1;break t;case 30:dt=-3;break t;case 31:return-4;case 32:default:return v}return P.next_out=Ot,P.avail_out=z,P.next_in=Y,P.avail_in=Et,L.hold=J,L.bits=V,(L.wsize||gt!==P.avail_out&&L.mode<30&&(L.mode<27||et!==4))&&H(P,P.output,P.next_out,gt-P.avail_out)?(L.mode=31,-4):(ct-=P.avail_in,gt-=P.avail_out,P.total_in+=ct,P.total_out+=gt,L.total+=gt,L.wrap&&gt&&(P.adler=L.check=L.flags?l(L.check,Q,gt,P.next_out-gt):o(L.check,Q,gt,P.next_out-gt)),P.data_type=L.bits+(L.last?64:0)+(L.mode===12?128:0)+(L.mode===20||L.mode===15?256:0),(ct==0&&gt===0||et===4)&&dt===g&&(dt=-5),dt)},i.inflateEnd=function(P){if(!P||!P.state)return v;var et=P.state;return et.window&&(et.window=null),P.state=null,g},i.inflateGetHeader=function(P,et){var L;return P&&P.state?(2&(L=P.state).wrap)==0?v:((L.head=et).done=!1,g):v},i.inflateSetDictionary=function(P,et){var L,st=et.length;return P&&P.state?(L=P.state).wrap!==0&&L.mode!==11?v:L.mode===11&&o(1,et,st,0)!==L.check?-3:H(P,et,st,st)?(L.mode=31,-4):(L.havedict=1,g):v},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,i){var s=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(d,p,g,v,y,_,b,E){var S,T,O,R,N,C,I,M,F,H=E.bits,P=0,et=0,L=0,st=0,Q=0,Y=0,Ot=0,Et=0,z=0,J=0,V=null,ct=0,gt=new s.Buf16(16),_t=new s.Buf16(16),Bt=null,Gt=0;for(P=0;P<=15;P++)gt[P]=0;for(et=0;et<v;et++)gt[p[g+et]]++;for(Q=H,st=15;1<=st&&gt[st]===0;st--);if(st<Q&&(Q=st),st===0)return y[_++]=20971520,y[_++]=20971520,E.bits=1,0;for(L=1;L<st&&gt[L]===0;L++);for(Q<L&&(Q=L),P=Et=1;P<=15;P++)if(Et<<=1,(Et-=gt[P])<0)return-1;if(0<Et&&(d===0||st!==1))return-1;for(_t[1]=0,P=1;P<15;P++)_t[P+1]=_t[P]+gt[P];for(et=0;et<v;et++)p[g+et]!==0&&(b[_t[p[g+et]]++]=et);if(C=d===0?(V=Bt=b,19):d===1?(V=o,ct-=257,Bt=l,Gt-=257,256):(V=u,Bt=h,-1),P=L,N=_,Ot=et=J=0,O=-1,R=(z=1<<(Y=Q))-1,d===1&&852<z||d===2&&592<z)return 1;for(;;){for(I=P-Ot,F=b[et]<C?(M=0,b[et]):b[et]>C?(M=Bt[Gt+b[et]],V[ct+b[et]]):(M=96,0),S=1<<P-Ot,L=T=1<<Y;y[N+(J>>Ot)+(T-=S)]=I<<24|M<<16|F|0,T!==0;);for(S=1<<P-1;J&S;)S>>=1;if(S!==0?(J&=S-1,J+=S):J=0,et++,--gt[P]==0){if(P===st)break;P=p[g+b[et]]}if(Q<P&&(J&R)!==O){for(Ot===0&&(Ot=Q),N+=L,Et=1<<(Y=P-Ot);Y+Ot<st&&!((Et-=gt[Y+Ot])<=0);)Y++,Et<<=1;if(z+=1<<Y,d===1&&852<z||d===2&&592<z)return 1;y[O=J&R]=Q<<24|Y<<16|N-_|0}}return J!==0&&(y[N+J]=P-Ot<<24|64<<16|0),E.bits=Q,0}},{"../utils/common":41}],51:[function(e,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,i){var s=e("../utils/common"),o=0,l=1;function u(X){for(var ft=X.length;0<=--ft;)X[ft]=0}var h=0,d=29,p=256,g=p+1+d,v=30,y=19,_=2*g+1,b=15,E=16,S=7,T=256,O=16,R=17,N=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(g+2));u(H);var P=new Array(2*v);u(P);var et=new Array(512);u(et);var L=new Array(256);u(L);var st=new Array(d);u(st);var Q,Y,Ot,Et=new Array(v);function z(X,ft,Pt,zt,bt){this.static_tree=X,this.extra_bits=ft,this.extra_base=Pt,this.elems=zt,this.max_length=bt,this.has_stree=X&&X.length}function J(X,ft){this.dyn_tree=X,this.max_code=0,this.stat_desc=ft}function V(X){return X<256?et[X]:et[256+(X>>>7)]}function ct(X,ft){X.pending_buf[X.pending++]=255&ft,X.pending_buf[X.pending++]=ft>>>8&255}function gt(X,ft,Pt){X.bi_valid>E-Pt?(X.bi_buf|=ft<<X.bi_valid&65535,ct(X,X.bi_buf),X.bi_buf=ft>>E-X.bi_valid,X.bi_valid+=Pt-E):(X.bi_buf|=ft<<X.bi_valid&65535,X.bi_valid+=Pt)}function _t(X,ft,Pt){gt(X,Pt[2*ft],Pt[2*ft+1])}function Bt(X,ft){for(var Pt=0;Pt|=1&X,X>>>=1,Pt<<=1,0<--ft;);return Pt>>>1}function Gt(X,ft,Pt){var zt,bt,Rt=new Array(b+1),qt=0;for(zt=1;zt<=b;zt++)Rt[zt]=qt=qt+Pt[zt-1]<<1;for(bt=0;bt<=ft;bt++){var xt=X[2*bt+1];xt!==0&&(X[2*bt]=Bt(Rt[xt]++,xt))}}function j(X){var ft;for(ft=0;ft<g;ft++)X.dyn_ltree[2*ft]=0;for(ft=0;ft<v;ft++)X.dyn_dtree[2*ft]=0;for(ft=0;ft<y;ft++)X.bl_tree[2*ft]=0;X.dyn_ltree[2*T]=1,X.opt_len=X.static_len=0,X.last_lit=X.matches=0}function pt(X){8<X.bi_valid?ct(X,X.bi_buf):0<X.bi_valid&&(X.pending_buf[X.pending++]=X.bi_buf),X.bi_buf=0,X.bi_valid=0}function lt(X,ft,Pt,zt){var bt=2*ft,Rt=2*Pt;return X[bt]<X[Rt]||X[bt]===X[Rt]&&zt[ft]<=zt[Pt]}function ut(X,ft,Pt){for(var zt=X.heap[Pt],bt=Pt<<1;bt<=X.heap_len&&(bt<X.heap_len&&lt(ft,X.heap[bt+1],X.heap[bt],X.depth)&&bt++,!lt(ft,zt,X.heap[bt],X.depth));)X.heap[Pt]=X.heap[bt],Pt=bt,bt<<=1;X.heap[Pt]=zt}function Dt(X,ft,Pt){var zt,bt,Rt,qt,xt=0;if(X.last_lit!==0)for(;zt=X.pending_buf[X.d_buf+2*xt]<<8|X.pending_buf[X.d_buf+2*xt+1],bt=X.pending_buf[X.l_buf+xt],xt++,zt===0?_t(X,bt,ft):(_t(X,(Rt=L[bt])+p+1,ft),(qt=C[Rt])!==0&&gt(X,bt-=st[Rt],qt),_t(X,Rt=V(--zt),Pt),(qt=I[Rt])!==0&&gt(X,zt-=Et[Rt],qt)),xt<X.last_lit;);_t(X,T,ft)}function Lt(X,ft){var Pt,zt,bt,Rt=ft.dyn_tree,qt=ft.stat_desc.static_tree,xt=ft.stat_desc.has_stree,se=ft.stat_desc.elems,de=-1;for(X.heap_len=0,X.heap_max=_,Pt=0;Pt<se;Pt++)Rt[2*Pt]!==0?(X.heap[++X.heap_len]=de=Pt,X.depth[Pt]=0):Rt[2*Pt+1]=0;for(;X.heap_len<2;)Rt[2*(bt=X.heap[++X.heap_len]=de<2?++de:0)]=1,X.depth[bt]=0,X.opt_len--,xt&&(X.static_len-=qt[2*bt+1]);for(ft.max_code=de,Pt=X.heap_len>>1;1<=Pt;Pt--)ut(X,Rt,Pt);for(bt=se;Pt=X.heap[1],X.heap[1]=X.heap[X.heap_len--],ut(X,Rt,1),zt=X.heap[1],X.heap[--X.heap_max]=Pt,X.heap[--X.heap_max]=zt,Rt[2*bt]=Rt[2*Pt]+Rt[2*zt],X.depth[bt]=(X.depth[Pt]>=X.depth[zt]?X.depth[Pt]:X.depth[zt])+1,Rt[2*Pt+1]=Rt[2*zt+1]=bt,X.heap[1]=bt++,ut(X,Rt,1),2<=X.heap_len;);X.heap[--X.heap_max]=X.heap[1],function(ae,ze){var Cn,Se,_n,qe,yr,Bn,kn=ze.dyn_tree,ai=ze.max_code,Fo=ze.stat_desc.static_tree,$a=ze.stat_desc.has_stree,Ga=ze.stat_desc.extra_bits,zs=ze.stat_desc.extra_base,br=ze.stat_desc.max_length,Ci=0;for(qe=0;qe<=b;qe++)ae.bl_count[qe]=0;for(kn[2*ae.heap[ae.heap_max]+1]=0,Cn=ae.heap_max+1;Cn<_;Cn++)br<(qe=kn[2*kn[2*(Se=ae.heap[Cn])+1]+1]+1)&&(qe=br,Ci++),kn[2*Se+1]=qe,ai<Se||(ae.bl_count[qe]++,yr=0,zs<=Se&&(yr=Ga[Se-zs]),Bn=kn[2*Se],ae.opt_len+=Bn*(qe+yr),$a&&(ae.static_len+=Bn*(Fo[2*Se+1]+yr)));if(Ci!==0){do{for(qe=br-1;ae.bl_count[qe]===0;)qe--;ae.bl_count[qe]--,ae.bl_count[qe+1]+=2,ae.bl_count[br]--,Ci-=2}while(0<Ci);for(qe=br;qe!==0;qe--)for(Se=ae.bl_count[qe];Se!==0;)ai<(_n=ae.heap[--Cn])||(kn[2*_n+1]!==qe&&(ae.opt_len+=(qe-kn[2*_n+1])*kn[2*_n],kn[2*_n+1]=qe),Se--)}}(X,ft),Gt(Rt,de,X.bl_count)}function D(X,ft,Pt){var zt,bt,Rt=-1,qt=ft[1],xt=0,se=7,de=4;for(qt===0&&(se=138,de=3),ft[2*(Pt+1)+1]=65535,zt=0;zt<=Pt;zt++)bt=qt,qt=ft[2*(zt+1)+1],++xt<se&&bt===qt||(xt<de?X.bl_tree[2*bt]+=xt:bt!==0?(bt!==Rt&&X.bl_tree[2*bt]++,X.bl_tree[2*O]++):xt<=10?X.bl_tree[2*R]++:X.bl_tree[2*N]++,Rt=bt,de=(xt=0)===qt?(se=138,3):bt===qt?(se=6,3):(se=7,4))}function dt(X,ft,Pt){var zt,bt,Rt=-1,qt=ft[1],xt=0,se=7,de=4;for(qt===0&&(se=138,de=3),zt=0;zt<=Pt;zt++)if(bt=qt,qt=ft[2*(zt+1)+1],!(++xt<se&&bt===qt)){if(xt<de)for(;_t(X,bt,X.bl_tree),--xt!=0;);else bt!==0?(bt!==Rt&&(_t(X,bt,X.bl_tree),xt--),_t(X,O,X.bl_tree),gt(X,xt-3,2)):xt<=10?(_t(X,R,X.bl_tree),gt(X,xt-3,3)):(_t(X,N,X.bl_tree),gt(X,xt-11,7));Rt=bt,de=(xt=0)===qt?(se=138,3):bt===qt?(se=6,3):(se=7,4)}}u(Et);var it=!1;function q(X,ft,Pt,zt){gt(X,(h<<1)+(zt?1:0),3),function(bt,Rt,qt,xt){pt(bt),ct(bt,qt),ct(bt,~qt),s.arraySet(bt.pending_buf,bt.window,Rt,qt,bt.pending),bt.pending+=qt}(X,ft,Pt)}i._tr_init=function(X){it||(function(){var ft,Pt,zt,bt,Rt,qt=new Array(b+1);for(bt=zt=0;bt<d-1;bt++)for(st[bt]=zt,ft=0;ft<1<<C[bt];ft++)L[zt++]=bt;for(L[zt-1]=bt,bt=Rt=0;bt<16;bt++)for(Et[bt]=Rt,ft=0;ft<1<<I[bt];ft++)et[Rt++]=bt;for(Rt>>=7;bt<v;bt++)for(Et[bt]=Rt<<7,ft=0;ft<1<<I[bt]-7;ft++)et[256+Rt++]=bt;for(Pt=0;Pt<=b;Pt++)qt[Pt]=0;for(ft=0;ft<=143;)H[2*ft+1]=8,ft++,qt[8]++;for(;ft<=255;)H[2*ft+1]=9,ft++,qt[9]++;for(;ft<=279;)H[2*ft+1]=7,ft++,qt[7]++;for(;ft<=287;)H[2*ft+1]=8,ft++,qt[8]++;for(Gt(H,g+1,qt),ft=0;ft<v;ft++)P[2*ft+1]=5,P[2*ft]=Bt(ft,5);Q=new z(H,C,p+1,g,b),Y=new z(P,I,0,v,b),Ot=new z(new Array(0),M,0,y,S)}(),it=!0),X.l_desc=new J(X.dyn_ltree,Q),X.d_desc=new J(X.dyn_dtree,Y),X.bl_desc=new J(X.bl_tree,Ot),X.bi_buf=0,X.bi_valid=0,j(X)},i._tr_stored_block=q,i._tr_flush_block=function(X,ft,Pt,zt){var bt,Rt,qt=0;0<X.level?(X.strm.data_type===2&&(X.strm.data_type=function(xt){var se,de=4093624447;for(se=0;se<=31;se++,de>>>=1)if(1&de&&xt.dyn_ltree[2*se]!==0)return o;if(xt.dyn_ltree[18]!==0||xt.dyn_ltree[20]!==0||xt.dyn_ltree[26]!==0)return l;for(se=32;se<p;se++)if(xt.dyn_ltree[2*se]!==0)return l;return o}(X)),Lt(X,X.l_desc),Lt(X,X.d_desc),qt=function(xt){var se;for(D(xt,xt.dyn_ltree,xt.l_desc.max_code),D(xt,xt.dyn_dtree,xt.d_desc.max_code),Lt(xt,xt.bl_desc),se=y-1;3<=se&&xt.bl_tree[2*F[se]+1]===0;se--);return xt.opt_len+=3*(se+1)+5+5+4,se}(X),bt=X.opt_len+3+7>>>3,(Rt=X.static_len+3+7>>>3)<=bt&&(bt=Rt)):bt=Rt=Pt+5,Pt+4<=bt&&ft!==-1?q(X,ft,Pt,zt):X.strategy===4||Rt===bt?(gt(X,2+(zt?1:0),3),Dt(X,H,P)):(gt(X,4+(zt?1:0),3),function(xt,se,de,ae){var ze;for(gt(xt,se-257,5),gt(xt,de-1,5),gt(xt,ae-4,4),ze=0;ze<ae;ze++)gt(xt,xt.bl_tree[2*F[ze]+1],3);dt(xt,xt.dyn_ltree,se-1),dt(xt,xt.dyn_dtree,de-1)}(X,X.l_desc.max_code+1,X.d_desc.max_code+1,qt+1),Dt(X,X.dyn_ltree,X.dyn_dtree)),j(X),zt&&pt(X)},i._tr_tally=function(X,ft,Pt){return X.pending_buf[X.d_buf+2*X.last_lit]=ft>>>8&255,X.pending_buf[X.d_buf+2*X.last_lit+1]=255&ft,X.pending_buf[X.l_buf+X.last_lit]=255&Pt,X.last_lit++,ft===0?X.dyn_ltree[2*Pt]++:(X.matches++,ft--,X.dyn_ltree[2*(L[Pt]+p+1)]++,X.dyn_dtree[2*V(ft)]++),X.last_lit===X.lit_bufsize-1},i._tr_align=function(X){gt(X,2,3),_t(X,T,H),function(ft){ft.bi_valid===16?(ct(ft,ft.bi_buf),ft.bi_buf=0,ft.bi_valid=0):8<=ft.bi_valid&&(ft.pending_buf[ft.pending++]=255&ft.bi_buf,ft.bi_buf>>=8,ft.bi_valid-=8)}(X)}},{"../utils/common":41}],53:[function(e,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,i){(function(s){(function(o,l){if(!o.setImmediate){var u,h,d,p,g=1,v={},y=!1,_=o.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(o);b=b&&b.setTimeout?b:o,u={}.toString.call(o.process)==="[object process]"?function(O){process.nextTick(function(){S(O)})}:function(){if(o.postMessage&&!o.importScripts){var O=!0,R=o.onmessage;return o.onmessage=function(){O=!1},o.postMessage("","*"),o.onmessage=R,O}}()?(p="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",T,!1):o.attachEvent("onmessage",T),function(O){o.postMessage(p+O,"*")}):o.MessageChannel?((d=new MessageChannel).port1.onmessage=function(O){S(O.data)},function(O){d.port2.postMessage(O)}):_&&"onreadystatechange"in _.createElement("script")?(h=_.documentElement,function(O){var R=_.createElement("script");R.onreadystatechange=function(){S(O),R.onreadystatechange=null,h.removeChild(R),R=null},h.appendChild(R)}):function(O){setTimeout(S,0,O)},b.setImmediate=function(O){typeof O!="function"&&(O=new Function(""+O));for(var R=new Array(arguments.length-1),N=0;N<R.length;N++)R[N]=arguments[N+1];var C={callback:O,args:R};return v[g]=C,u(g),g++},b.clearImmediate=E}function E(O){delete v[O]}function S(O){if(y)setTimeout(S,0,O);else{var R=v[O];if(R){y=!0;try{(function(N){var C=N.callback,I=N.args;switch(I.length){case 0:C();break;case 1:C(I[0]);break;case 2:C(I[0],I[1]);break;case 3:C(I[0],I[1],I[2]);break;default:C.apply(l,I)}})(R)}finally{E(O),y=!1}}}}function T(O){O.source===o&&typeof O.data=="string"&&O.data.indexOf(p)===0&&S(+O.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof jp<"u"?jp:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(I_)),I_.exports}var cX=lX();const uX=vm(cX),fX=({extractedTexts:n,areas:t})=>{const[e,r]=At.useState(!1),i=n.length>0?Object.keys(n[0]).filter(v=>v!=="pageNumber"):[];At.useEffect(()=>{document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(y=>{const _=Ps.getInstance(y);_&&_.dispose(),new Ps(y)})},[n,e]);const s=()=>{const v=JSON.stringify(n,null,2),y=new Blob([v],{type:"application/json"}),_=URL.createObjectURL(y),b=document.createElement("a");b.href=_,b.download="dados-extraidos.json",b.click(),URL.revokeObjectURL(_)},o=()=>{const v=["Pgina",...i],y=n.map(R=>{const N=[R.pageNumber.join(", ")];return i.forEach(C=>{const I=R[C];Array.isArray(I)?N.push(I.join("; ")):N.push(I||"")}),N}),E="\uFEFF"+[v,...y].map(R=>R.map(N=>`"${N}"`).join(",")).join(`
`),S=new Blob([E],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(S),O=document.createElement("a");O.href=T,O.download="dados-extraidos.csv",O.click(),URL.revokeObjectURL(T)},l=()=>{const v=n.map(b=>{const E={Pgina:b.pageNumber};return i.forEach(S=>{const T=b[S];Array.isArray(T)?E[S]=T.join("; "):E[S]=T||""}),E});var y=M_.json_to_sheet(v),_=M_.book_new();M_.book_append_sheet(_,y,"Dados extrados"),VW(_,"dados-pdf.xlsx")},u=v=>{const y=DS(n,t,v);if(!y){alert("No existem todas as reas necessrias para gerar esse arquivo");return}const b="\uFEFF"+CS(y.data,y.headers),E=new Blob([b],{type:"text/csv"}),S=URL.createObjectURL(E),T=document.createElement("a");T.href=S,T.download=y.filename,T.click(),URL.revokeObjectURL(S)},h=async()=>{const v=new uX,y="\uFEFF";["collar","nspt","na","geology","interp"].forEach(T=>{if(mg(t,T).isValid||e){const O=DS(n,t,T);if(O){const R=y+CS(O.data,O.headers);v.file(O.filename,R)}}});const b=await v.generateAsync({type:"blob"}),E=URL.createObjectURL(b),S=document.createElement("a");S.href=E,S.download="leapfrog-data.zip",S.click(),URL.revokeObjectURL(E)},d=v=>`dropdown-item${mg(t,v).isValid||e?"":" disabled"}`,g=(()=>{const v=ig.filter(y=>mg(t,y).isValid);return{validExports:v,nonValidExports:ig.filter(y=>!v.includes(y)),someValid:v.length>0,allValid:v.length===ig.length}})();return ot.jsx("div",{className:"data-panel mt-5",children:!n||n.length<=0?ot.jsx("div",{children:ot.jsx("p",{className:"text-muted",children:"Os dados extrados sero exibidos aqui"})}):ot.jsxs(ot.Fragment,{children:[ot.jsx("h5",{className:"mb-3 pb-2 border-bottom",children:"Dados Extrados"}),ot.jsx("div",{className:"data-table mb-3",style:{maxHeight:"65vh",overflowY:"auto"},children:ot.jsxs("table",{className:"table table-hover",children:[ot.jsx("thead",{children:ot.jsxs("tr",{children:[ot.jsx("th",{scope:"col",style:{minWidth:"100px"},children:"#"}),i.map((v,y)=>ot.jsx("th",{scope:"col",style:{minWidth:"100px"},children:v.toString()},`coluna${y}`))]})}),ot.jsx("tbody",{children:n.map((v,y)=>ot.jsxs("tr",{children:[ot.jsx("th",{scope:"row",children:v.pageNumber}),i.map((_,b)=>{const E=v[_];return ot.jsx("td",{children:Array.isArray(E)?E.join(", "):"-"},`area-${b}`)})]},`coluna-pag-${y}`))})]})}),ot.jsx("hr",{className:"mt-3"}),ot.jsxs("div",{className:"d-flex gap-3 mb-2",children:[ot.jsxs("div",{className:"border rounded p-3 flex-grow-1",children:[ot.jsx("h6",{children:"Exportar todos os dados"}),ot.jsxs("div",{className:"d-flex gap-1 mt-3",children:[ot.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:s,children:[ot.jsx(hd,{className:"me-1",size:16}),"JSON"]}),ot.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:o,children:[ot.jsx(hd,{className:"me-1",size:16}),"CSV"]}),ot.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:l,children:[ot.jsx(hd,{className:"me-1",size:16}),"Excel"]})]})]}),ot.jsxs("div",{className:"border rounded p-3 flex-grow-1",children:[ot.jsx("h6",{children:"Exportar formato Leapfrog"}),ot.jsx("div",{children:ot.jsxs("div",{className:"btn-group dropup",children:[ot.jsx("button",{className:"btn btn-secondary",type:"button",onClick:h,disabled:!g.someValid,"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"top","data-bs-title":g.allValid?"Exportar todos os arquivos":e&&g.someValid?`Exportar ${g.validExports.join(", ")} completo(s) e ${g.nonValidExports.join(", ")} incompleto(s)`:e?"Exportar todos incompletos":g.someValid?`Exportar ${g.validExports.join(", ")}`:"Dados insuficientes para gerar arquivos",children:"Exportar todos"}),ot.jsx("button",{type:"button",className:"btn  btn-secondary dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:ot.jsx("span",{className:"sr-only"})}),ot.jsx("ul",{className:"dropdown-menu",children:ig.map(v=>{const y=mg(t,v);return ot.jsx("li",{"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"left","data-bs-title":y.isValid?`Exportar ${v}.csv`:e?`Exportar ${v}.csv incompleto (dados ausentes: ${y.missingFields.map(_=>_==="depth"?"Profundidades ou Profundidade Total":Dc[_]).join(", ")})`:`Campos faltantes: ${y.missingFields.map(_=>_==="depth"?"Profundidades ou Profundidade Total":Dc[_]).join(", ")}`,children:ot.jsx("button",{className:d(v),onClick:()=>u(v),children:l6[v]})},`export-leapfrog-${v}`)})})]})}),ot.jsxs("div",{className:"form-check form-switch mt-2",children:[ot.jsx("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"switchCheckDefault",checked:e,onChange:v=>r(v.target.checked)}),ot.jsx("label",{className:"form-check-label small text-align-start",htmlFor:"switchCheckDefault",children:"Aceitar dados incompletos"})]})]})]})]})})};function hX(){const n=At.useRef(null),[t,e]=At.useState(null),[r,i]=At.useState([]),[s,o]=At.useState([]),[l,u]=At.useState(!1),[h,d]=At.useState(null),p=I=>{if(s.length>=15){alert("Limite de 15 reas atingido");return}o(M=>L7(M,I))},g=I=>{o(M=>M7(M,I))},v=(I,M)=>{o(F=>I7(F,I,M))},y=I=>{o(M=>P7(M,I))},_=I=>{d(I),u(!0)},b=I=>{h&&o(M=>F7(M,h,I)),u(!1),d(null)},E=async()=>{const I=n.current?.getDocument(),M=s.some(et=>et.repeatInPages),F=s.find(et=>et.dataType==="hole_id"),H=s.filter(et=>!et.coordinates).map(et=>et.name);if(H.length>0&&!confirm(`A(s) seguinte(s) rea(s) no possue(m) coordenadas:
`+H.join(", ")+`
Deseja continuar mesmo assim?`)||!F&&M&&!confirm("Algumas reas esto configuradas como 'nico' mas no h uma rea de ID da Sondagem. A funo no vai funcionar corretamente. Deseja continuar mesmo assim?")||!I)return;const P=await H7(s,I);i(P)},S=I=>{o(I)},T=()=>{u(!1),d(null)};At.useEffect(()=>{const I=F=>{F.key==="Escape"&&l&&T()},M=F=>{const H=document.querySelector(".pdf-container");l&&!H?.contains(F.target)&&T()};return document.addEventListener("keydown",I),document.addEventListener("mousedown",M),()=>{document.removeEventListener("keydown",I),document.removeEventListener("mousedown",M)}},[l]);const O=I=>{if(!I.destination)return;const M=I.source.index,F=I.destination.index;if(M===F)return;const H=Array.from(s),[P]=H.splice(M,1);H.splice(F,0,P);const et=H.map((L,st)=>({...L,order:st+1}));o(et)},R=(I,M)=>{o(F=>F.map(H=>H.id===I?{...H,isMandatory:M}:H))},N=(I,M)=>{o(F=>F.map(H=>H.id===I?{...H,repeatInPages:M}:H))},C=(I,M)=>{const F=NC.includes(M),H=kC.includes(M);o(P=>P.map(et=>et.id===I?{...et,dataType:M,repeatInPages:F,isMandatory:H,name:L2(et.name)&&M==="default"?Md("Nova rea",P):L2(et.name)?Md(Dc[M],P):et.name}:et))};return ot.jsxs(ot.Fragment,{children:[l&&ot.jsx("div",{className:"selection-mode-overlay"}),ot.jsx("div",{className:"container-fluid text-center px-xl-5",children:ot.jsxs("div",{className:"row justify-content-center",children:[ot.jsx("div",{className:"col-12 col-lg-6 col-xxl-3 col-xxxl-4",style:{maxWidth:"450px",minWidth:"300px"},children:ot.jsx(z7,{children:ot.jsx(k7,{onFileSelect:e,onExtractTexts:E,onStartAreaSelection:_,onClearArea:y,onDeleteArea:g,onRenameArea:v,onAddNewArea:p,onLoadPreset:S,onDragEnd:O,onToggleMandatory:R,onToggleRepeat:N,onChangeAreaType:C,areas:s,hasFile:!!t})})}),ot.jsx("div",{className:"col-12 col-lg-6 col-xxl-5 col-xxxl-4",children:ot.jsx(s6,{ref:n,file:t,isSelectingActive:l,activeAreaId:h,onFinishSelection:b,areas:s})}),ot.jsx("div",{className:"col-12 col-lg-6 col-xxl-4 col-xxxl-4",children:ot.jsx(fX,{extractedTexts:r,areas:s})})]})})]})}function dX(){return ot.jsx("div",{children:ot.jsx(hX,{})})}ON.createRoot(document.getElementById("root")).render(ot.jsx(At.StrictMode,{children:ot.jsx(dX,{})}));
