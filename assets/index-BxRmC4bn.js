var Rw=n=>{throw TypeError(n)};var B1=(n,t,e)=>t.has(n)||Rw("Cannot "+e);var Pn=(n,t,e)=>(B1(n,t,"read from private field"),e?e.call(n):t.get(n)),Ra=(n,t,e)=>t.has(n)?Rw("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),zr=(n,t,e,i)=>(B1(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),Na=(n,t,e)=>(B1(n,t,"access private method"),e);var Nw=(n,t,e,i)=>({set _(r){zr(n,t,r,e)},get _(){return Pn(n,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();var K0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function mk(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function i(){var r=!1;try{r=this instanceof i}catch{}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),e}var U1={exports:{}},Jh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kw;function gk(){if(kw)return Jh;kw=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,r,s){var a=null;if(s!==void 0&&(a=""+s),r.key!==void 0&&(a=""+r.key),"key"in r){s={};for(var l in r)l!=="key"&&(s[l]=r[l])}else s=r;return r=s.ref,{$$typeof:n,type:i,key:a,ref:r!==void 0?r:null,props:s}}return Jh.Fragment=t,Jh.jsx=e,Jh.jsxs=e,Jh}var Lw;function vk(){return Lw||(Lw=1,U1.exports=gk()),U1.exports}var at=vk(),z1={exports:{}},Ge={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iw;function _k(){if(Iw)return Ge;Iw=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function m(j){return j===null||typeof j!="object"?null:(j=p&&j[p]||j["@@iterator"],typeof j=="function"?j:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,_={};function b(j,J,G){this.props=j,this.context=J,this.refs=_,this.updater=G||v}b.prototype.isReactComponent={},b.prototype.setState=function(j,J){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,J,"setState")},b.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function E(){}E.prototype=b.prototype;function T(j,J,G){this.props=j,this.context=J,this.refs=_,this.updater=G||v}var S=T.prototype=new E;S.constructor=T,x(S,b.prototype),S.isPureReactComponent=!0;var O=Array.isArray,R={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function C(j,J,G,ut,gt,_t){return G=_t.ref,{$$typeof:n,type:j,key:J,ref:G!==void 0?G:null,props:_t}}function M(j,J){return C(j.type,J,void 0,void 0,void 0,j.props)}function I(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function F(j){var J={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(G){return J[G]})}var z=/\/+/g;function P(j,J){return typeof j=="object"&&j!==null&&j.key!=null?F(""+j.key):J.toString(36)}function tt(){}function L(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(tt,tt):(j.status="pending",j.then(function(J){j.status==="pending"&&(j.status="fulfilled",j.value=J)},function(J){j.status==="pending"&&(j.status="rejected",j.reason=J)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function nt(j,J,G,ut,gt){var _t=typeof j;(_t==="undefined"||_t==="boolean")&&(j=null);var Bt=!1;if(j===null)Bt=!0;else switch(_t){case"bigint":case"string":case"number":Bt=!0;break;case"object":switch(j.$$typeof){case n:case t:Bt=!0;break;case d:return Bt=j._init,nt(Bt(j._payload),J,G,ut,gt)}}if(Bt)return gt=gt(j),Bt=ut===""?"."+P(j,0):ut,O(gt)?(G="",Bt!=null&&(G=Bt.replace(z,"$&/")+"/"),nt(gt,J,G,"",function(mt){return mt})):gt!=null&&(I(gt)&&(gt=M(gt,G+(gt.key==null||j&&j.key===gt.key?"":(""+gt.key).replace(z,"$&/")+"/")+Bt)),J.push(gt)),1;Bt=0;var Gt=ut===""?".":ut+":";if(O(j))for(var H=0;H<j.length;H++)ut=j[H],_t=Gt+P(ut,H),Bt+=nt(ut,J,G,_t,gt);else if(H=m(j),typeof H=="function")for(j=H.call(j),H=0;!(ut=j.next()).done;)ut=ut.value,_t=Gt+P(ut,H++),Bt+=nt(ut,J,G,_t,gt);else if(_t==="object"){if(typeof j.then=="function")return nt(L(j),J,G,ut,gt);throw J=String(j),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Bt}function Q(j,J,G){if(j==null)return j;var ut=[],gt=0;return nt(j,ut,"","",function(_t){return J.call(G,_t,gt++)}),ut}function X(j){if(j._status===-1){var J=j._result;J=J(),J.then(function(G){(j._status===0||j._status===-1)&&(j._status=1,j._result=G)},function(G){(j._status===0||j._status===-1)&&(j._status=2,j._result=G)}),j._status===-1&&(j._status=0,j._result=J)}if(j._status===1)return j._result.default;throw j._result}var Rt=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)};function yt(){}return Ge.Children={map:Q,forEach:function(j,J,G){Q(j,function(){J.apply(this,arguments)},G)},count:function(j){var J=0;return Q(j,function(){J++}),J},toArray:function(j){return Q(j,function(J){return J})||[]},only:function(j){if(!I(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},Ge.Component=b,Ge.Fragment=e,Ge.Profiler=r,Ge.PureComponent=T,Ge.StrictMode=i,Ge.Suspense=u,Ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ge.__COMPILER_RUNTIME={__proto__:null,c:function(j){return R.H.useMemoCache(j)}},Ge.cache=function(j){return function(){return j.apply(null,arguments)}},Ge.cloneElement=function(j,J,G){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var ut=x({},j.props),gt=j.key,_t=void 0;if(J!=null)for(Bt in J.ref!==void 0&&(_t=void 0),J.key!==void 0&&(gt=""+J.key),J)!N.call(J,Bt)||Bt==="key"||Bt==="__self"||Bt==="__source"||Bt==="ref"&&J.ref===void 0||(ut[Bt]=J[Bt]);var Bt=arguments.length-2;if(Bt===1)ut.children=G;else if(1<Bt){for(var Gt=Array(Bt),H=0;H<Bt;H++)Gt[H]=arguments[H+2];ut.children=Gt}return C(j.type,gt,void 0,void 0,_t,ut)},Ge.createContext=function(j){return j={$$typeof:a,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:s,_context:j},j},Ge.createElement=function(j,J,G){var ut,gt={},_t=null;if(J!=null)for(ut in J.key!==void 0&&(_t=""+J.key),J)N.call(J,ut)&&ut!=="key"&&ut!=="__self"&&ut!=="__source"&&(gt[ut]=J[ut]);var Bt=arguments.length-2;if(Bt===1)gt.children=G;else if(1<Bt){for(var Gt=Array(Bt),H=0;H<Bt;H++)Gt[H]=arguments[H+2];gt.children=Gt}if(j&&j.defaultProps)for(ut in Bt=j.defaultProps,Bt)gt[ut]===void 0&&(gt[ut]=Bt[ut]);return C(j,_t,void 0,void 0,null,gt)},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(j){return{$$typeof:l,render:j}},Ge.isValidElement=I,Ge.lazy=function(j){return{$$typeof:d,_payload:{_status:-1,_result:j},_init:X}},Ge.memo=function(j,J){return{$$typeof:f,type:j,compare:J===void 0?null:J}},Ge.startTransition=function(j){var J=R.T,G={};R.T=G;try{var ut=j(),gt=R.S;gt!==null&&gt(G,ut),typeof ut=="object"&&ut!==null&&typeof ut.then=="function"&&ut.then(yt,Rt)}catch(_t){Rt(_t)}finally{R.T=J}},Ge.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Ge.use=function(j){return R.H.use(j)},Ge.useActionState=function(j,J,G){return R.H.useActionState(j,J,G)},Ge.useCallback=function(j,J){return R.H.useCallback(j,J)},Ge.useContext=function(j){return R.H.useContext(j)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(j,J){return R.H.useDeferredValue(j,J)},Ge.useEffect=function(j,J,G){var ut=R.H;if(typeof G=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ut.useEffect(j,J)},Ge.useId=function(){return R.H.useId()},Ge.useImperativeHandle=function(j,J,G){return R.H.useImperativeHandle(j,J,G)},Ge.useInsertionEffect=function(j,J){return R.H.useInsertionEffect(j,J)},Ge.useLayoutEffect=function(j,J){return R.H.useLayoutEffect(j,J)},Ge.useMemo=function(j,J){return R.H.useMemo(j,J)},Ge.useOptimistic=function(j,J){return R.H.useOptimistic(j,J)},Ge.useReducer=function(j,J,G){return R.H.useReducer(j,J,G)},Ge.useRef=function(j){return R.H.useRef(j)},Ge.useState=function(j){return R.H.useState(j)},Ge.useSyncExternalStore=function(j,J,G){return R.H.useSyncExternalStore(j,J,G)},Ge.useTransition=function(){return R.H.useTransition()},Ge.version="19.1.0",Ge}var Mw;function kg(){return Mw||(Mw=1,z1.exports=_k()),z1.exports}var vt=kg();const Yn=yf(vt);var j1={exports:{}},td={},H1={exports:{}},$1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pw;function xk(){return Pw||(Pw=1,function(n){function t(Q,X){var Rt=Q.length;Q.push(X);t:for(;0<Rt;){var yt=Rt-1>>>1,j=Q[yt];if(0<r(j,X))Q[yt]=X,Q[Rt]=j,Rt=yt;else break t}}function e(Q){return Q.length===0?null:Q[0]}function i(Q){if(Q.length===0)return null;var X=Q[0],Rt=Q.pop();if(Rt!==X){Q[0]=Rt;t:for(var yt=0,j=Q.length,J=j>>>1;yt<J;){var G=2*(yt+1)-1,ut=Q[G],gt=G+1,_t=Q[gt];if(0>r(ut,Rt))gt<j&&0>r(_t,ut)?(Q[yt]=_t,Q[gt]=Rt,yt=gt):(Q[yt]=ut,Q[G]=Rt,yt=G);else if(gt<j&&0>r(_t,Rt))Q[yt]=_t,Q[gt]=Rt,yt=gt;else break t}}return X}function r(Q,X){var Rt=Q.sortIndex-X.sortIndex;return Rt!==0?Rt:Q.id-X.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var u=[],f=[],d=1,p=null,m=3,v=!1,x=!1,_=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function O(Q){for(var X=e(f);X!==null;){if(X.callback===null)i(f);else if(X.startTime<=Q)i(f),X.sortIndex=X.expirationTime,t(u,X);else break;X=e(f)}}function R(Q){if(_=!1,O(Q),!x)if(e(u)!==null)x=!0,N||(N=!0,P());else{var X=e(f);X!==null&&nt(R,X.startTime-Q)}}var N=!1,C=-1,M=5,I=-1;function F(){return b?!0:!(n.unstable_now()-I<M)}function z(){if(b=!1,N){var Q=n.unstable_now();I=Q;var X=!0;try{t:{x=!1,_&&(_=!1,T(C),C=-1),v=!0;var Rt=m;try{e:{for(O(Q),p=e(u);p!==null&&!(p.expirationTime>Q&&F());){var yt=p.callback;if(typeof yt=="function"){p.callback=null,m=p.priorityLevel;var j=yt(p.expirationTime<=Q);if(Q=n.unstable_now(),typeof j=="function"){p.callback=j,O(Q),X=!0;break e}p===e(u)&&i(u),O(Q)}else i(u);p=e(u)}if(p!==null)X=!0;else{var J=e(f);J!==null&&nt(R,J.startTime-Q),X=!1}}break t}finally{p=null,m=Rt,v=!1}X=void 0}}finally{X?P():N=!1}}}var P;if(typeof S=="function")P=function(){S(z)};else if(typeof MessageChannel<"u"){var tt=new MessageChannel,L=tt.port2;tt.port1.onmessage=z,P=function(){L.postMessage(null)}}else P=function(){E(z,0)};function nt(Q,X){C=E(function(){Q(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Q){Q.callback=null},n.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<Q?Math.floor(1e3/Q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(Q){switch(m){case 1:case 2:case 3:var X=3;break;default:X=m}var Rt=m;m=X;try{return Q()}finally{m=Rt}},n.unstable_requestPaint=function(){b=!0},n.unstable_runWithPriority=function(Q,X){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var Rt=m;m=Q;try{return X()}finally{m=Rt}},n.unstable_scheduleCallback=function(Q,X,Rt){var yt=n.unstable_now();switch(typeof Rt=="object"&&Rt!==null?(Rt=Rt.delay,Rt=typeof Rt=="number"&&0<Rt?yt+Rt:yt):Rt=yt,Q){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=Rt+j,Q={id:d++,callback:X,priorityLevel:Q,startTime:Rt,expirationTime:j,sortIndex:-1},Rt>yt?(Q.sortIndex=Rt,t(f,Q),e(u)===null&&Q===e(f)&&(_?(T(C),C=-1):_=!0,nt(R,Rt-yt))):(Q.sortIndex=j,t(u,Q),x||v||(x=!0,N||(N=!0,P()))),Q},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(Q){var X=m;return function(){var Rt=m;m=X;try{return Q.apply(this,arguments)}finally{m=Rt}}}}($1)),$1}var Fw;function bk(){return Fw||(Fw=1,H1.exports=xk()),H1.exports}var G1={exports:{}},Zi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bw;function yk(){if(Bw)return Zi;Bw=1;var n=kg();function t(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(u,f,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:u,containerInfo:f,implementation:d}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Zi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Zi.createPortal=function(u,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return s(u,f,null,d)},Zi.flushSync=function(u){var f=a.T,d=i.p;try{if(a.T=null,i.p=2,u)return u()}finally{a.T=f,i.p=d,i.d.f()}},Zi.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(u,f))},Zi.prefetchDNS=function(u){typeof u=="string"&&i.d.D(u)},Zi.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?i.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:v}):d==="script"&&i.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Zi.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);i.d.M(u,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(u)},Zi.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin);i.d.L(u,d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Zi.preloadModule=function(u,f){if(typeof u=="string")if(f){var d=l(f.as,f.crossOrigin);i.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(u)},Zi.requestFormReset=function(u){i.d.r(u)},Zi.unstable_batchedUpdates=function(u,f){return u(f)},Zi.useFormState=function(u,f,d){return a.H.useFormState(u,f,d)},Zi.useFormStatus=function(){return a.H.useHostTransitionStatus()},Zi.version="19.1.0",Zi}var Uw;function pT(){if(Uw)return G1.exports;Uw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),G1.exports=yk(),G1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zw;function Ek(){if(zw)return td;zw=1;var n=bk(),t=kg(),e=pT();function i(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var c=o,h=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(h=c.return),o=c.return;while(o)}return c.tag===3?h:null}function a(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function l(o){if(s(o)!==o)throw Error(i(188))}function u(o){var c=o.alternate;if(!c){if(c=s(o),c===null)throw Error(i(188));return c!==o?null:o}for(var h=o,g=c;;){var y=h.return;if(y===null)break;var A=y.alternate;if(A===null){if(g=y.return,g!==null){h=g;continue}break}if(y.child===A.child){for(A=y.child;A;){if(A===h)return l(y),o;if(A===g)return l(y),c;A=A.sibling}throw Error(i(188))}if(h.return!==g.return)h=y,g=A;else{for(var B=!1,W=y.child;W;){if(W===h){B=!0,h=y,g=A;break}if(W===g){B=!0,g=y,h=A;break}W=W.sibling}if(!B){for(W=A.child;W;){if(W===h){B=!0,h=A,g=y;break}if(W===g){B=!0,g=A,h=y;break}W=W.sibling}if(!B)throw Error(i(189))}}if(h.alternate!==g)throw Error(i(190))}if(h.tag!==3)throw Error(i(188));return h.stateNode.current===h?o:c}function f(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=f(o),c!==null)return c;o=o.sibling}return null}var d=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),T=Symbol.for("react.consumer"),S=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function P(o){return o===null||typeof o!="object"?null:(o=z&&o[z]||o["@@iterator"],typeof o=="function"?o:null)}var tt=Symbol.for("react.client.reference");function L(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===tt?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case x:return"Fragment";case b:return"Profiler";case _:return"StrictMode";case R:return"Suspense";case N:return"SuspenseList";case I:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case v:return"Portal";case S:return(o.displayName||"Context")+".Provider";case T:return(o._context.displayName||"Context")+".Consumer";case O:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case C:return c=o.displayName||null,c!==null?c:L(o.type)||"Memo";case M:c=o._payload,o=o._init;try{return L(o(c))}catch{}}return null}var nt=Array.isArray,Q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Rt={pending:!1,data:null,method:null,action:null},yt=[],j=-1;function J(o){return{current:o}}function G(o){0>j||(o.current=yt[j],yt[j]=null,j--)}function ut(o,c){j++,yt[j]=o.current,o.current=c}var gt=J(null),_t=J(null),Bt=J(null),Gt=J(null);function H(o,c){switch(ut(Bt,c),ut(_t,o),ut(gt,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?rw(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=rw(c),o=sw(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}G(gt),ut(gt,o)}function mt(){G(gt),G(_t),G(Bt)}function lt(o){o.memoizedState!==null&&ut(Gt,o);var c=gt.current,h=sw(c,o.type);c!==h&&(ut(_t,o),ut(gt,h))}function ct(o){_t.current===o&&(G(gt),G(_t)),Gt.current===o&&(G(Gt),Yh._currentValue=Rt)}var Ct=Object.prototype.hasOwnProperty,Lt=n.unstable_scheduleCallback,D=n.unstable_cancelCallback,dt=n.unstable_shouldYield,st=n.unstable_requestPaint,Y=n.unstable_now,q=n.unstable_getCurrentPriorityLevel,ft=n.unstable_ImmediatePriority,Pt=n.unstable_UserBlockingPriority,jt=n.unstable_NormalPriority,wt=n.unstable_LowPriority,Nt=n.unstable_IdlePriority,At=n.log,pt=n.unstable_setDisableYieldValue,te=null,ae=null;function ne(o){if(typeof At=="function"&&pt(o),ae&&typeof ae.setStrictMode=="function")try{ae.setStrictMode(te,o)}catch{}}var Re=Math.clz32?Math.clz32:ln,rn=Math.log,ye=Math.LN2;function ln(o){return o>>>=0,o===0?32:31-(rn(o)/ye|0)|0}var Ve=256,zn=4194304;function Cn(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function bn(o,c,h){var g=o.pendingLanes;if(g===0)return 0;var y=0,A=o.suspendedLanes,B=o.pingedLanes;o=o.warmLanes;var W=g&134217727;return W!==0?(g=W&~A,g!==0?y=Cn(g):(B&=W,B!==0?y=Cn(B):h||(h=W&~o,h!==0&&(y=Cn(h))))):(W=g&~A,W!==0?y=Cn(W):B!==0?y=Cn(B):h||(h=g&~o,h!==0&&(y=Cn(h)))),y===0?0:c!==0&&c!==y&&(c&A)===0&&(A=y&-y,h=c&-c,A>=h||A===32&&(h&4194048)!==0)?c:y}function mi(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function vs(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gs(){var o=Ve;return Ve<<=1,(Ve&4194048)===0&&(Ve=256),o}function Xa(){var o=zn;return zn<<=1,(zn&62914560)===0&&(zn=4194304),o}function Vs(o){for(var c=[],h=0;31>h;h++)c.push(o);return c}function wi(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Or(o,c,h,g,y,A){var B=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var W=o.entanglements,ht=o.expirationTimes,Mt=o.hiddenUpdates;for(h=B&~h;0<h;){var Vt=31-Re(h),Kt=1<<Vt;W[Vt]=0,ht[Vt]=-1;var Ut=Mt[Vt];if(Ut!==null)for(Mt[Vt]=null,Vt=0;Vt<Ut.length;Vt++){var zt=Ut[Vt];zt!==null&&(zt.lane&=-536870913)}h&=~Kt}g!==0&&zl(o,g,0),A!==0&&y===0&&o.tag!==0&&(o.suspendedLanes|=A&~(B&~c))}function zl(o,c,h){o.pendingLanes|=c,o.suspendedLanes&=~c;var g=31-Re(c);o.entangledLanes|=c,o.entanglements[g]=o.entanglements[g]|1073741824|h&4194090}function Kc(o,c){var h=o.entangledLanes|=c;for(o=o.entanglements;h;){var g=31-Re(h),y=1<<g;y&c|o[g]&c&&(o[g]|=c),h&=~y}}function jl(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Hl(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Zc(){var o=X.p;return o!==0?o:(o=window.event,o===void 0?32:Aw(o.type))}function fa(o,c){var h=X.p;try{return X.p=o,c()}finally{X.p=h}}var Gi=Math.random().toString(36).slice(2),ii="__reactFiber$"+Gi,ri="__reactProps$"+Gi,ha="__reactContainer$"+Gi,$l="__reactEvents$"+Gi,Mf="__reactListeners$"+Gi,V="__reactHandles$"+Gi,rt="__reactResources$"+Gi,Z="__reactMarker$"+Gi;function et(o){delete o[ii],delete o[ri],delete o[$l],delete o[Mf],delete o[V]}function it(o){var c=o[ii];if(c)return c;for(var h=o.parentNode;h;){if(c=h[ha]||h[ii]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(o=cw(o);o!==null;){if(h=o[ii])return h;o=cw(o)}return c}o=h,h=o.parentNode}return null}function ot(o){if(o=o[ii]||o[ha]){var c=o.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return o}return null}function It(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(i(33))}function Ht(o){var c=o[rt];return c||(c=o[rt]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Et(o){o[Z]=!0}var Dt=new Set,Ot={};function Wt(o,c){ee(o,c),ee(o+"Capture",c)}function ee(o,c){for(Ot[o]=c,o=0;o<c.length;o++)Dt.add(c[o])}var le=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qt={},ie={};function Ie(o){return Ct.call(ie,o)?!0:Ct.call(Qt,o)?!1:le.test(o)?ie[o]=!0:(Qt[o]=!0,!1)}function sn(o,c,h){if(Ie(c))if(h===null)o.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var g=c.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+h)}}function Ze(o,c,h){if(h===null)o.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+h)}}function dn(o,c,h,g){if(g===null)o.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(c,h,""+g)}}var qr,_s;function cr(o){if(qr===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);qr=c&&c[1]||"",_s=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qr+o+_s}var Rr=!1;function da(o,c){if(!o||Rr)return"";Rr=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(c){var Kt=function(){throw Error()};if(Object.defineProperty(Kt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Kt,[])}catch(zt){var Ut=zt}Reflect.construct(o,[],Kt)}else{try{Kt.call()}catch(zt){Ut=zt}o.call(Kt.prototype)}}else{try{throw Error()}catch(zt){Ut=zt}(Kt=o())&&typeof Kt.catch=="function"&&Kt.catch(function(){})}}catch(zt){if(zt&&Ut&&typeof zt.stack=="string")return[zt.stack,Ut.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=g.DetermineComponentFrameRoot(),B=A[0],W=A[1];if(B&&W){var ht=B.split(`
`),Mt=W.split(`
`);for(y=g=0;g<ht.length&&!ht[g].includes("DetermineComponentFrameRoot");)g++;for(;y<Mt.length&&!Mt[y].includes("DetermineComponentFrameRoot");)y++;if(g===ht.length||y===Mt.length)for(g=ht.length-1,y=Mt.length-1;1<=g&&0<=y&&ht[g]!==Mt[y];)y--;for(;1<=g&&0<=y;g--,y--)if(ht[g]!==Mt[y]){if(g!==1||y!==1)do if(g--,y--,0>y||ht[g]!==Mt[y]){var Vt=`
`+ht[g].replace(" at new "," at ");return o.displayName&&Vt.includes("<anonymous>")&&(Vt=Vt.replace("<anonymous>",o.displayName)),Vt}while(1<=g&&0<=y);break}}}finally{Rr=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?cr(h):""}function Nr(o){switch(o.tag){case 26:case 27:case 5:return cr(o.type);case 16:return cr("Lazy");case 13:return cr("Suspense");case 19:return cr("SuspenseList");case 0:case 15:return da(o.type,!1);case 11:return da(o.type.render,!1);case 1:return da(o.type,!0);case 31:return cr("Activity");default:return""}}function Pf(o){try{var c="";do c+=Nr(o),o=o.return;while(o);return c}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function ur(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Ff(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function xp(o){var c=Ff(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),g=""+o[c];if(!o.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var y=h.get,A=h.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return y.call(this)},set:function(B){g=""+B,A.call(this,B)}}),Object.defineProperty(o,c,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(B){g=""+B},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Gl(o){o._valueTracker||(o._valueTracker=xp(o))}function Bf(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var h=c.getValue(),g="";return o&&(g=Ff(o)?o.checked?"true":"false":o.value),o=g,o!==h?(c.setValue(o),!0):!1}function fr(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var hr=/[\n"\\]/g;function si(o){return o.replace(hr,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Vi(o,c,h,g,y,A,B,W){o.name="",B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?o.type=B:o.removeAttribute("type"),c!=null?B==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+ur(c)):o.value!==""+ur(c)&&(o.value=""+ur(c)):B!=="submit"&&B!=="reset"||o.removeAttribute("value"),c!=null?Vl(o,B,ur(c)):h!=null?Vl(o,B,ur(h)):g!=null&&o.removeAttribute("value"),y==null&&A!=null&&(o.defaultChecked=!!A),y!=null&&(o.checked=y&&typeof y!="function"&&typeof y!="symbol"),W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?o.name=""+ur(W):o.removeAttribute("name")}function Qc(o,c,h,g,y,A,B,W){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(o.type=A),c!=null||h!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;h=h!=null?""+ur(h):"",c=c!=null?""+ur(c):h,W||c===o.value||(o.value=c),o.defaultValue=c}g=g??y,g=typeof g!="function"&&typeof g!="symbol"&&!!g,o.checked=W?o.checked:!!g,o.defaultChecked=!!g,B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(o.name=B)}function Vl(o,c,h){c==="number"&&fr(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function ki(o,c,h,g){if(o=o.options,c){c={};for(var y=0;y<h.length;y++)c["$"+h[y]]=!0;for(h=0;h<o.length;h++)y=c.hasOwnProperty("$"+o[h].value),o[h].selected!==y&&(o[h].selected=y),y&&g&&(o[h].defaultSelected=!0)}else{for(h=""+ur(h),c=null,y=0;y<o.length;y++){if(o[y].value===h){o[y].selected=!0,g&&(o[y].defaultSelected=!0);return}c!==null||o[y].disabled||(c=o[y])}c!==null&&(c.selected=!0)}}function pa(o,c,h){if(c!=null&&(c=""+ur(c),c!==o.value&&(o.value=c),h==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=h!=null?""+ur(h):""}function Wl(o,c,h,g){if(c==null){if(g!=null){if(h!=null)throw Error(i(92));if(nt(g)){if(1<g.length)throw Error(i(93));g=g[0]}h=g}h==null&&(h=""),c=h}h=ur(c),o.defaultValue=h,g=o.textContent,g===h&&g!==""&&g!==null&&(o.value=g)}function Yr(o,c){if(c){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=c;return}}o.textContent=c}var Uf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zf(o,c,h){var g=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?g?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":g?o.setProperty(c,h):typeof h!="number"||h===0||Uf.has(c)?c==="float"?o.cssFloat=h:o[c]=(""+h).trim():o[c]=h+"px"}function Ka(o,c,h){if(c!=null&&typeof c!="object")throw Error(i(62));if(o=o.style,h!=null){for(var g in h)!h.hasOwnProperty(g)||c!=null&&c.hasOwnProperty(g)||(g.indexOf("--")===0?o.setProperty(g,""):g==="float"?o.cssFloat="":o[g]="");for(var y in c)g=c[y],c.hasOwnProperty(y)&&h[y]!==g&&zf(o,y,g)}else for(var A in c)c.hasOwnProperty(A)&&zf(o,A,c[A])}function ql(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ws=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jc(o){return Ws.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var xs=null;function $o(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Za=null,bs=null;function tu(o){var c=ot(o);if(c&&(o=c.stateNode)){var h=o[ri]||null;t:switch(o=c.stateNode,c.type){case"input":if(Vi(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+si(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var g=h[c];if(g!==o&&g.form===o.form){var y=g[ri]||null;if(!y)throw Error(i(90));Vi(g,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(c=0;c<h.length;c++)g=h[c],g.form===o.form&&Bf(g)}break t;case"textarea":pa(o,h.value,h.defaultValue);break t;case"select":c=h.value,c!=null&&ki(o,!!h.multiple,c,!1)}}}var Qa=!1;function jf(o,c,h){if(Qa)return o(c,h);Qa=!0;try{var g=o(c);return g}finally{if(Qa=!1,(Za!==null||bs!==null)&&(O0(),Za&&(c=Za,o=bs,bs=Za=null,tu(c),o)))for(c=0;c<o.length;c++)tu(o[c])}}function Go(o,c){var h=o.stateNode;if(h===null)return null;var g=h[ri]||null;if(g===null)return null;h=g[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break t;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(i(231,c,typeof h));return h}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ma=!1;if(ys)try{var Yl={};Object.defineProperty(Yl,"passive",{get:function(){ma=!0}}),window.addEventListener("test",Yl,Yl),window.removeEventListener("test",Yl,Yl)}catch{ma=!1}var qs=null,Xl=null,Ja=null;function eu(){if(Ja)return Ja;var o,c=Xl,h=c.length,g,y="value"in qs?qs.value:qs.textContent,A=y.length;for(o=0;o<h&&c[o]===y[o];o++);var B=h-o;for(g=1;g<=B&&c[h-g]===y[A-g];g++);return Ja=y.slice(o,1<g?1-g:void 0)}function nu(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function to(){return!0}function yp(){return!1}function Li(o){function c(h,g,y,A,B){this._reactName=h,this._targetInst=y,this.type=g,this.nativeEvent=A,this.target=B,this.currentTarget=null;for(var W in o)o.hasOwnProperty(W)&&(h=o[W],this[W]=h?h(A):A[W]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?to:yp,this.isPropagationStopped=yp,this}return d(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=to)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=to)},persist:function(){},isPersistent:to}),c}var Ys={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vo=Li(Ys),eo=d({},Ys,{view:0,detail:0}),Ep=Li(eo),no,Kl,Wo,Zl=d({},eo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$f,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Wo&&(Wo&&o.type==="mousemove"?(no=o.screenX-Wo.screenX,Kl=o.screenY-Wo.screenY):Kl=no=0,Wo=o),no)},movementY:function(o){return"movementY"in o?o.movementY:Kl}}),io=Li(Zl),gv=d({},Zl,{dataTransfer:0}),wp=Li(gv),Ap=d({},eo,{relatedTarget:0}),iu=Li(Ap),Sp=d({},Ys,{animationName:0,elapsedTime:0,pseudoElement:0}),Tp=Li(Sp),Hf=d({},Ys,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Cp=Li(Hf),vv=d({},Ys,{data:0}),Dp=Li(vv),Op={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ru={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _v(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=ru[o])?!!c[o]:!1}function $f(){return _v}var Gf=d({},eo,{key:function(o){if(o.key){var c=Op[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=nu(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Rp[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$f,charCode:function(o){return o.type==="keypress"?nu(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?nu(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Np=Li(Gf),kp=d({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ga=Li(kp),Vf=d({},eo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$f}),xv=Li(Vf),Lp=d({},Ys,{propertyName:0,elapsedTime:0,pseudoElement:0}),bv=Li(Lp),yv=d({},Zl,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Ev=Li(yv),wv=d({},Ys,{newState:0,oldState:0}),Ip=Li(wv),Mp=[9,13,27,32],Wf=ys&&"CompositionEvent"in window,Es=null;ys&&"documentMode"in document&&(Es=document.documentMode);var ro=ys&&"TextEvent"in window&&!Es,Pp=ys&&(!Wf||Es&&8<Es&&11>=Es),Ql=" ",Fp=!1;function Bp(o,c){switch(o){case"keyup":return Mp.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Up(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var qo=!1;function Av(o,c){switch(o){case"compositionend":return Up(c);case"keypress":return c.which!==32?null:(Fp=!0,Ql);case"textInput":return o=c.data,o===Ql&&Fp?null:o;default:return null}}function Sv(o,c){if(qo)return o==="compositionend"||!Wf&&Bp(o,c)?(o=eu(),Ja=Xl=qs=null,qo=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Pp&&c.locale!=="ko"?null:c.data;default:return null}}var Tv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zp(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!Tv[o.type]:c==="textarea"}function kr(o,c,h,g){Za?bs?bs.push(g):bs=[g]:Za=g,c=M0(c,"onChange"),0<c.length&&(h=new Vo("onChange","change",null,h,g),o.push({event:h,listeners:c}))}var Yo=null,Xo=null;function jp(o){JE(o,0)}function su(o){var c=It(o);if(Bf(c))return o}function Hp(o,c){if(o==="change")return c}var qf=!1;if(ys){var Ko;if(ys){var Yf="oninput"in document;if(!Yf){var $p=document.createElement("div");$p.setAttribute("oninput","return;"),Yf=typeof $p.oninput=="function"}Ko=Yf}else Ko=!1;qf=Ko&&(!document.documentMode||9<document.documentMode)}function Xf(){Yo&&(Yo.detachEvent("onpropertychange",Gp),Xo=Yo=null)}function Gp(o){if(o.propertyName==="value"&&su(Xo)){var c=[];kr(c,Xo,o,$o(o)),jf(jp,c)}}function Cv(o,c,h){o==="focusin"?(Xf(),Yo=c,Xo=h,Yo.attachEvent("onpropertychange",Gp)):o==="focusout"&&Xf()}function Vp(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return su(Xo)}function Wp(o,c){if(o==="click")return su(c)}function qp(o,c){if(o==="input"||o==="change")return su(c)}function au(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Wi=typeof Object.is=="function"?Object.is:au;function so(o,c){if(Wi(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var h=Object.keys(o),g=Object.keys(c);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var y=h[g];if(!Ct.call(c,y)||!Wi(o[y],c[y]))return!1}return!0}function dr(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Yp(o,c){var h=dr(o);o=0;for(var g;h;){if(h.nodeType===3){if(g=o+h.textContent.length,o<=c&&g>=c)return{node:h,offset:c-o};o=g}t:{for(;h;){if(h.nextSibling){h=h.nextSibling;break t}h=h.parentNode}h=void 0}h=dr(h)}}function Xp(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?Xp(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function Kf(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=fr(o.document);c instanceof o.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)o=c.contentWindow;else break;c=fr(o.document)}return c}function ou(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var Dv=ys&&"documentMode"in document&&11>=document.documentMode,Zo=null,Zf=null,Jl=null,Qf=!1;function Kp(o,c,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Qf||Zo==null||Zo!==fr(g)||(g=Zo,"selectionStart"in g&&ou(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Jl&&so(Jl,g)||(Jl=g,g=M0(Zf,"onSelect"),0<g.length&&(c=new Vo("onSelect","select",null,c,h),o.push({event:c,listeners:g}),c.target=Zo)))}function va(o,c){var h={};return h[o.toLowerCase()]=c.toLowerCase(),h["Webkit"+o]="webkit"+c,h["Moz"+o]="moz"+c,h}var ao={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionrun:va("Transition","TransitionRun"),transitionstart:va("Transition","TransitionStart"),transitioncancel:va("Transition","TransitionCancel"),transitionend:va("Transition","TransitionEnd")},tc={},Zp={};ys&&(Zp=document.createElement("div").style,"AnimationEvent"in window||(delete ao.animationend.animation,delete ao.animationiteration.animation,delete ao.animationstart.animation),"TransitionEvent"in window||delete ao.transitionend.transition);function oo(o){if(tc[o])return tc[o];if(!ao[o])return o;var c=ao[o],h;for(h in c)if(c.hasOwnProperty(h)&&h in Zp)return tc[o]=c[h];return o}var _a=oo("animationend"),ws=oo("animationiteration"),Jf=oo("animationstart"),Ov=oo("transitionrun"),Qp=oo("transitionstart"),Jp=oo("transitioncancel"),th=oo("transitionend"),eh=new Map,nh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nh.push("scrollEnd");function Xr(o,c){eh.set(o,c),Wt(c,[o])}var t0=new WeakMap;function pr(o,c){if(typeof o=="object"&&o!==null){var h=t0.get(o);return h!==void 0?h:(c={value:o,source:c,stack:Pf(c)},t0.set(o,c),c)}return{value:o,source:c,stack:Pf(c)}}var mr=[],Qo=0,ih=0;function lu(){for(var o=Qo,c=ih=Qo=0;c<o;){var h=mr[c];mr[c++]=null;var g=mr[c];mr[c++]=null;var y=mr[c];mr[c++]=null;var A=mr[c];if(mr[c++]=null,g!==null&&y!==null){var B=g.pending;B===null?y.next=y:(y.next=B.next,B.next=y),g.pending=y}A!==0&&sh(h,y,A)}}function cu(o,c,h,g){mr[Qo++]=o,mr[Qo++]=c,mr[Qo++]=h,mr[Qo++]=g,ih|=g,o.lanes|=g,o=o.alternate,o!==null&&(o.lanes|=g)}function rh(o,c,h,g){return cu(o,c,h,g),uu(o)}function qi(o,c){return cu(o,null,null,c),uu(o)}function sh(o,c,h){o.lanes|=h;var g=o.alternate;g!==null&&(g.lanes|=h);for(var y=!1,A=o.return;A!==null;)A.childLanes|=h,g=A.alternate,g!==null&&(g.childLanes|=h),A.tag===22&&(o=A.stateNode,o===null||o._visibility&1||(y=!0)),o=A,A=A.return;return o.tag===3?(A=o.stateNode,y&&c!==null&&(y=31-Re(h),o=A.hiddenUpdates,g=o[y],g===null?o[y]=[c]:g.push(c),c.lane=h|536870912),A):null}function uu(o){if(50<zh)throw zh=0,l1=null,Error(i(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var Jo={};function Rv(o,c,h,g){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gr(o,c,h,g){return new Rv(o,c,h,g)}function ah(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Xs(o,c){var h=o.alternate;return h===null?(h=gr(o.tag,c,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=c,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,c=o.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function e0(o,c){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,c=h.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function fu(o,c,h,g,y,A){var B=0;if(g=o,typeof o=="function")ah(o)&&(B=1);else if(typeof o=="string")B=nk(o,h,gt.current)?26:o==="html"||o==="head"||o==="body"?27:5;else t:switch(o){case I:return o=gr(31,h,c,y),o.elementType=I,o.lanes=A,o;case x:return Ks(h.children,y,A,c);case _:B=8,y|=24;break;case b:return o=gr(12,h,c,y|2),o.elementType=b,o.lanes=A,o;case R:return o=gr(13,h,c,y),o.elementType=R,o.lanes=A,o;case N:return o=gr(19,h,c,y),o.elementType=N,o.lanes=A,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case E:case S:B=10;break t;case T:B=9;break t;case O:B=11;break t;case C:B=14;break t;case M:B=16,g=null;break t}B=29,h=Error(i(130,o===null?"null":typeof o,"")),g=null}return c=gr(B,h,c,y),c.elementType=o,c.type=g,c.lanes=A,c}function Ks(o,c,h,g){return o=gr(7,o,g,c),o.lanes=h,o}function tl(o,c,h){return o=gr(6,o,null,c),o.lanes=h,o}function oh(o,c,h){return c=gr(4,o.children!==null?o.children:[],o.key,c),c.lanes=h,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var lo=[],co=0,xa=null,el=0,Yi=[],Lr=0,uo=null,Zs=1,Ii="";function fo(o,c){lo[co++]=el,lo[co++]=xa,xa=o,el=c}function n0(o,c,h){Yi[Lr++]=Zs,Yi[Lr++]=Ii,Yi[Lr++]=uo,uo=o;var g=Zs;o=Ii;var y=32-Re(g)-1;g&=~(1<<y),h+=1;var A=32-Re(c)+y;if(30<A){var B=y-y%5;A=(g&(1<<B)-1).toString(32),g>>=B,y-=B,Zs=1<<32-Re(c)+y|h<<y|g,Ii=A+o}else Zs=1<<A|h<<y|g,Ii=o}function lh(o){o.return!==null&&(fo(o,1),n0(o,1,0))}function ch(o){for(;o===xa;)xa=lo[--co],lo[co]=null,el=lo[--co],lo[co]=null;for(;o===uo;)uo=Yi[--Lr],Yi[Lr]=null,Ii=Yi[--Lr],Yi[Lr]=null,Zs=Yi[--Lr],Yi[Lr]=null}var ai=null,Nn=null,an=!1,ba=null,As=!1,ya=Error(i(519));function Qs(o){var c=Error(i(418,""));throw Kr(pr(c,o)),ya}function uh(o){var c=o.stateNode,h=o.type,g=o.memoizedProps;switch(c[ii]=o,c[ri]=g,h){case"dialog":Ye("cancel",c),Ye("close",c);break;case"iframe":case"object":case"embed":Ye("load",c);break;case"video":case"audio":for(h=0;h<Hh.length;h++)Ye(Hh[h],c);break;case"source":Ye("error",c);break;case"img":case"image":case"link":Ye("error",c),Ye("load",c);break;case"details":Ye("toggle",c);break;case"input":Ye("invalid",c),Qc(c,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0),Gl(c);break;case"select":Ye("invalid",c);break;case"textarea":Ye("invalid",c),Wl(c,g.value,g.defaultValue,g.children),Gl(c)}h=g.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||g.suppressHydrationWarning===!0||iw(c.textContent,h)?(g.popover!=null&&(Ye("beforetoggle",c),Ye("toggle",c)),g.onScroll!=null&&Ye("scroll",c),g.onScrollEnd!=null&&Ye("scrollend",c),g.onClick!=null&&(c.onclick=P0),c=!0):c=!1,c||Qs(o)}function i0(o){for(ai=o.return;ai;)switch(ai.tag){case 5:case 13:As=!1;return;case 27:case 3:As=!0;return;default:ai=ai.return}}function ec(o){if(o!==ai)return!1;if(!an)return i0(o),an=!0,!1;var c=o.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||A1(o.type,o.memoizedProps)),h=!h),h&&Nn&&Qs(o),i0(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(i(317));t:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8)if(h=o.data,h==="/$"){if(c===0){Nn=na(o.nextSibling);break t}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++;o=o.nextSibling}Nn=null}}else c===27?(c=Nn,gl(o.type)?(o=D1,D1=null,Nn=o):Nn=c):Nn=ai?na(o.stateNode.nextSibling):null;return!0}function nc(){Nn=ai=null,an=!1}function nl(){var o=ba;return o!==null&&(Ur===null?Ur=o:Ur.push.apply(Ur,o),ba=null),o}function Kr(o){ba===null?ba=[o]:ba.push(o)}var fh=J(null),ho=null,Js=null;function Ea(o,c,h){ut(fh,c._currentValue),c._currentValue=h}function ta(o){o._currentValue=fh.current,G(fh)}function hh(o,c,h){for(;o!==null;){var g=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,g!==null&&(g.childLanes|=c)):g!==null&&(g.childLanes&c)!==c&&(g.childLanes|=c),o===h)break;o=o.return}}function dh(o,c,h,g){var y=o.child;for(y!==null&&(y.return=o);y!==null;){var A=y.dependencies;if(A!==null){var B=y.child;A=A.firstContext;t:for(;A!==null;){var W=A;A=y;for(var ht=0;ht<c.length;ht++)if(W.context===c[ht]){A.lanes|=h,W=A.alternate,W!==null&&(W.lanes|=h),hh(A.return,h,o),g||(B=null);break t}A=W.next}}else if(y.tag===18){if(B=y.return,B===null)throw Error(i(341));B.lanes|=h,A=B.alternate,A!==null&&(A.lanes|=h),hh(B,h,o),B=null}else B=y.child;if(B!==null)B.return=y;else for(B=y;B!==null;){if(B===o){B=null;break}if(y=B.sibling,y!==null){y.return=B.return,B=y;break}B=B.return}y=B}}function ic(o,c,h,g){o=null;for(var y=c,A=!1;y!==null;){if(!A){if((y.flags&524288)!==0)A=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var B=y.alternate;if(B===null)throw Error(i(387));if(B=B.memoizedProps,B!==null){var W=y.type;Wi(y.pendingProps.value,B.value)||(o!==null?o.push(W):o=[W])}}else if(y===Gt.current){if(B=y.alternate,B===null)throw Error(i(387));B.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(o!==null?o.push(Yh):o=[Yh])}y=y.return}o!==null&&dh(c,o,h,g),c.flags|=262144}function rc(o){for(o=o.firstContext;o!==null;){if(!Wi(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function po(o){ho=o,Js=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function gi(o){return ph(ho,o)}function il(o,c){return ho===null&&po(o),ph(o,c)}function ph(o,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},Js===null){if(o===null)throw Error(i(308));Js=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else Js=Js.next=c;return h}var mo=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(h,g){o.push(g)}};this.abort=function(){c.aborted=!0,o.forEach(function(h){return h()})}},r0=n.unstable_scheduleCallback,mh=n.unstable_NormalPriority,Wn={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sc(){return{controller:new mo,data:new Map,refCount:0}}function rl(o){o.refCount--,o.refCount===0&&r0(mh,function(){o.controller.abort()})}var go=null,gh=0,Ir=0,vr=null;function Nv(o,c){if(go===null){var h=go=[];gh=0,Ir=m1(),vr={status:"pending",value:void 0,then:function(g){h.push(g)}}}return gh++,c.then(s0,s0),c}function s0(){if(--gh===0&&go!==null){vr!==null&&(vr.status="fulfilled");var o=go;go=null,Ir=0,vr=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function kv(o,c){var h=[],g={status:"pending",value:null,reason:null,then:function(y){h.push(y)}};return o.then(function(){g.status="fulfilled",g.value=c;for(var y=0;y<h.length;y++)(0,h[y])(c)},function(y){for(g.status="rejected",g.reason=y,y=0;y<h.length;y++)(0,h[y])(void 0)}),g}var a0=Q.S;Q.S=function(o,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Nv(o,c),a0!==null&&a0(o,c)};var vo=J(null);function vh(){var o=vo.current;return o!==null?o:kn.pooledCache}function hu(o,c){c===null?ut(vo,vo.current):ut(vo,c.pool)}function o0(){var o=vh();return o===null?null:{parent:Wn._currentValue,pool:o}}var sl=Error(i(460)),ac=Error(i(474)),_o=Error(i(542)),_h={then:function(){}};function l0(o){return o=o.status,o==="fulfilled"||o==="rejected"}function wa(){}function U(o,c,h){switch(h=o[h],h===void 0?o.push(c):h!==c&&(c.then(wa,wa),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,K(o),o;default:if(typeof c.status=="string")c.then(wa,wa);else{if(o=kn,o!==null&&100<o.shellSuspendCounter)throw Error(i(482));o=c,o.status="pending",o.then(function(g){if(c.status==="pending"){var y=c;y.status="fulfilled",y.value=g}},function(g){if(c.status==="pending"){var y=c;y.status="rejected",y.reason=g}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,K(o),o}throw w=c,sl}}var w=null;function k(){if(w===null)throw Error(i(459));var o=w;return w=null,o}function K(o){if(o===sl||o===_o)throw Error(i(483))}var bt=!1;function St(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $t(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function qt(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function re(o,c,h){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(gn&2)!==0){var y=g.pending;return y===null?c.next=c:(c.next=y.next,y.next=c),g.pending=c,c=uu(o),sh(o,null,h),c}return cu(o,g,c,h),uu(o)}function fe(o,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var g=c.lanes;g&=o.pendingLanes,h|=g,c.lanes=h,Kc(o,h)}}function he(o,c){var h=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var y=null,A=null;if(h=h.firstBaseUpdate,h!==null){do{var B={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};A===null?y=A=B:A=A.next=B,h=h.next}while(h!==null);A===null?y=A=c:A=A.next=c}else y=A=c;h={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:A,shared:g.shared,callbacks:g.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=c}var ce=!1;function Pe(){if(ce){var o=vr;if(o!==null)throw o}}function Ee(o,c,h,g){ce=!1;var y=o.updateQueue;bt=!1;var A=y.firstBaseUpdate,B=y.lastBaseUpdate,W=y.shared.pending;if(W!==null){y.shared.pending=null;var ht=W,Mt=ht.next;ht.next=null,B===null?A=Mt:B.next=Mt,B=ht;var Vt=o.alternate;Vt!==null&&(Vt=Vt.updateQueue,W=Vt.lastBaseUpdate,W!==B&&(W===null?Vt.firstBaseUpdate=Mt:W.next=Mt,Vt.lastBaseUpdate=ht))}if(A!==null){var Kt=y.baseState;B=0,Vt=Mt=ht=null,W=A;do{var Ut=W.lane&-536870913,zt=Ut!==W.lane;if(zt?(tn&Ut)===Ut:(g&Ut)===Ut){Ut!==0&&Ut===Ir&&(ce=!0),Vt!==null&&(Vt=Vt.next={lane:0,tag:W.tag,payload:W.payload,callback:null,next:null});t:{var Me=o,Ce=W;Ut=c;var wn=h;switch(Ce.tag){case 1:if(Me=Ce.payload,typeof Me=="function"){Kt=Me.call(wn,Kt,Ut);break t}Kt=Me;break t;case 3:Me.flags=Me.flags&-65537|128;case 0:if(Me=Ce.payload,Ut=typeof Me=="function"?Me.call(wn,Kt,Ut):Me,Ut==null)break t;Kt=d({},Kt,Ut);break t;case 2:bt=!0}}Ut=W.callback,Ut!==null&&(o.flags|=64,zt&&(o.flags|=8192),zt=y.callbacks,zt===null?y.callbacks=[Ut]:zt.push(Ut))}else zt={lane:Ut,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Vt===null?(Mt=Vt=zt,ht=Kt):Vt=Vt.next=zt,B|=Ut;if(W=W.next,W===null){if(W=y.shared.pending,W===null)break;zt=W,W=zt.next,zt.next=null,y.lastBaseUpdate=zt,y.shared.pending=null}}while(!0);Vt===null&&(ht=Kt),y.baseState=ht,y.firstBaseUpdate=Mt,y.lastBaseUpdate=Vt,A===null&&(y.shared.lanes=0),hl|=B,o.lanes=B,o.memoizedState=Kt}}function Fe(o,c){if(typeof o!="function")throw Error(i(191,o));o.call(c)}function Ne(o,c){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)Fe(h[o],c)}var Te=J(null),on=J(0);function pn(o,c){o=So,ut(on,o),ut(Te,c),So=o|c.baseLanes}function je(){ut(on,So),ut(Te,Te.current)}function Qe(){So=on.current,G(Te),G(on)}var ke=0,ue=null,ve=null,Le=null,Je=!1,yn=!1,Xn=!1,Xi=0,Kn=0,vi=null,Mr=0;function Ue(){throw Error(i(321))}function Pr(o,c){if(c===null)return!1;for(var h=0;h<c.length&&h<o.length;h++)if(!Wi(o[h],c[h]))return!1;return!0}function Fr(o,c,h,g,y,A){return ke=A,ue=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Q.H=o===null||o.memoizedState===null?Fy:By,Xn=!1,A=h(g,y),Xn=!1,yn&&(A=Zn(c,h,g,y)),xo(o),A}function xo(o){Q.H=g0;var c=ve!==null&&ve.next!==null;if(ke=0,Le=ve=ue=null,Je=!1,Kn=0,vi=null,c)throw Error(i(300));o===null||Ai||(o=o.dependencies,o!==null&&rc(o)&&(Ai=!0))}function Zn(o,c,h,g){ue=o;var y=0;do{if(yn&&(vi=null),Kn=0,yn=!1,25<=y)throw Error(i(301));if(y+=1,Le=ve=null,o.updateQueue!=null){var A=o.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}Q.H=dN,A=c(h,g)}while(yn);return A}function mn(){var o=Q.H,c=o.useState()[0];return c=typeof c.then=="function"?Aa(c):c,o=o.useState()[0],(ve!==null?ve.memoizedState:null)!==o&&(ue.flags|=1024),c}function _i(){var o=Xi!==0;return Xi=0,o}function Ki(o,c,h){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~h}function Ss(o){if(Je){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}Je=!1}ke=0,Le=ve=ue=null,yn=!1,Kn=Xi=0,vi=null}function xi(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Le===null?ue.memoizedState=Le=o:Le=Le.next=o,Le}function jn(){if(ve===null){var o=ue.alternate;o=o!==null?o.memoizedState:null}else o=ve.next;var c=Le===null?ue.memoizedState:Le.next;if(c!==null)Le=c,ve=o;else{if(o===null)throw ue.alternate===null?Error(i(467)):Error(i(310));ve=o,o={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},Le===null?ue.memoizedState=Le=o:Le=Le.next=o}return Le}function du(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Aa(o){var c=Kn;return Kn+=1,vi===null&&(vi=[]),o=U(vi,o,c),c=ue,(Le===null?c.memoizedState:Le.next)===null&&(c=c.alternate,Q.H=c===null||c.memoizedState===null?Fy:By),o}function pu(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Aa(o);if(o.$$typeof===S)return gi(o)}throw Error(i(438,String(o)))}function xh(o){var c=null,h=ue.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var g=ue.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(c={data:g.data.map(function(y){return y.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=du(),ue.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(o),g=0;g<o;g++)h[g]=F;return c.index++,h}function Zr(o,c){return typeof c=="function"?c(o):c}function mu(o){var c=jn();return gu(c,ve,o)}function gu(o,c,h){var g=o.queue;if(g===null)throw Error(i(311));g.lastRenderedReducer=h;var y=o.baseQueue,A=g.pending;if(A!==null){if(y!==null){var B=y.next;y.next=A.next,A.next=B}c.baseQueue=y=A,g.pending=null}if(A=o.baseState,y===null)o.memoizedState=A;else{c=y.next;var W=B=null,ht=null,Mt=c,Vt=!1;do{var Kt=Mt.lane&-536870913;if(Kt!==Mt.lane?(tn&Kt)===Kt:(ke&Kt)===Kt){var Ut=Mt.revertLane;if(Ut===0)ht!==null&&(ht=ht.next={lane:0,revertLane:0,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null}),Kt===Ir&&(Vt=!0);else if((ke&Ut)===Ut){Mt=Mt.next,Ut===Ir&&(Vt=!0);continue}else Kt={lane:0,revertLane:Mt.revertLane,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null},ht===null?(W=ht=Kt,B=A):ht=ht.next=Kt,ue.lanes|=Ut,hl|=Ut;Kt=Mt.action,Xn&&h(A,Kt),A=Mt.hasEagerState?Mt.eagerState:h(A,Kt)}else Ut={lane:Kt,revertLane:Mt.revertLane,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null},ht===null?(W=ht=Ut,B=A):ht=ht.next=Ut,ue.lanes|=Kt,hl|=Kt;Mt=Mt.next}while(Mt!==null&&Mt!==c);if(ht===null?B=A:ht.next=W,!Wi(A,o.memoizedState)&&(Ai=!0,Vt&&(h=vr,h!==null)))throw h;o.memoizedState=A,o.baseState=B,o.baseQueue=ht,g.lastRenderedState=A}return y===null&&(g.lanes=0),[o.memoizedState,g.dispatch]}function bh(o){var c=jn(),h=c.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=o;var g=h.dispatch,y=h.pending,A=c.memoizedState;if(y!==null){h.pending=null;var B=y=y.next;do A=o(A,B.action),B=B.next;while(B!==y);Wi(A,c.memoizedState)||(Ai=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),h.lastRenderedState=A}return[A,g]}function yh(o,c,h){var g=ue,y=jn(),A=an;if(A){if(h===void 0)throw Error(i(407));h=h()}else h=c();var B=!Wi((ve||y).memoizedState,h);B&&(y.memoizedState=h,Ai=!0),y=y.queue;var W=u0.bind(null,g,y,o);if(Oh(2048,8,W,[o]),y.getSnapshot!==c||B||Le!==null&&Le.memoizedState.tag&1){if(g.flags|=2048,bu(9,d0(),c0.bind(null,g,y,h,c),null),kn===null)throw Error(i(349));A||(ke&124)!==0||Eh(g,c,h)}return h}function Eh(o,c,h){o.flags|=16384,o={getSnapshot:c,value:h},c=ue.updateQueue,c===null?(c=du(),ue.updateQueue=c,c.stores=[o]):(h=c.stores,h===null?c.stores=[o]:h.push(o))}function c0(o,c,h,g){c.value=h,c.getSnapshot=g,Sa(c)&&oc(o)}function u0(o,c,h){return h(function(){Sa(c)&&oc(o)})}function Sa(o){var c=o.getSnapshot;o=o.value;try{var h=c();return!Wi(o,h)}catch{return!0}}function oc(o){var c=qi(o,2);c!==null&&ns(c,o,2)}function vu(o){var c=xi();if(typeof o=="function"){var h=o;if(o=h(),Xn){ne(!0);try{h()}finally{ne(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zr,lastRenderedState:o},c}function wh(o,c,h,g){return o.baseState=h,gu(o,ve,typeof g=="function"?g:Zr)}function Ah(o,c,h,g,y){if(m0(o))throw Error(i(485));if(o=c.action,o!==null){var A={payload:y,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(B){A.listeners.push(B)}};Q.T!==null?h(!0):A.isTransition=!1,g(A),h=c.pending,h===null?(A.next=c.pending=A,Sh(c,A)):(A.next=h.next,c.pending=h.next=A)}}function Sh(o,c){var h=c.action,g=c.payload,y=o.state;if(c.isTransition){var A=Q.T,B={};Q.T=B;try{var W=h(y,g),ht=Q.S;ht!==null&&ht(B,W),Th(o,c,W)}catch(Mt){_u(o,c,Mt)}finally{Q.T=A}}else try{A=h(y,g),Th(o,c,A)}catch(Mt){_u(o,c,Mt)}}function Th(o,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(g){Ch(o,c,g)},function(g){return _u(o,c,g)}):Ch(o,c,h)}function Ch(o,c,h){c.status="fulfilled",c.value=h,f0(c),o.state=h,c=o.pending,c!==null&&(h=c.next,h===c?o.pending=null:(h=h.next,c.next=h,Sh(o,h)))}function _u(o,c,h){var g=o.pending;if(o.pending=null,g!==null){g=g.next;do c.status="rejected",c.reason=h,f0(c),c=c.next;while(c!==g)}o.action=null}function f0(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function h0(o,c){return c}function xu(o,c){if(an){var h=kn.formState;if(h!==null){t:{var g=ue;if(an){if(Nn){e:{for(var y=Nn,A=As;y.nodeType!==8;){if(!A){y=null;break e}if(y=na(y.nextSibling),y===null){y=null;break e}}A=y.data,y=A==="F!"||A==="F"?y:null}if(y){Nn=na(y.nextSibling),g=y.data==="F!";break t}}Qs(g)}g=!1}g&&(c=h[0])}}return h=xi(),h.memoizedState=h.baseState=c,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h0,lastRenderedState:c},h.queue=g,h=Iy.bind(null,ue,g),g.dispatch=h,g=vu(!1),A=Fv.bind(null,ue,!1,g.queue),g=xi(),y={state:c,dispatch:null,action:o,pending:null},g.queue=y,h=Ah.bind(null,ue,y,A,h),y.dispatch=h,g.memoizedState=o,[c,h,!1]}function Dh(o){var c=jn();return vy(c,ve,o)}function vy(o,c,h){if(c=gu(o,c,h0)[0],o=mu(Zr)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var g=Aa(c)}catch(B){throw B===sl?_o:B}else g=c;c=jn();var y=c.queue,A=y.dispatch;return h!==c.memoizedState&&(ue.flags|=2048,bu(9,d0(),cN.bind(null,y,h),null)),[g,A,o]}function cN(o,c){o.action=c}function _y(o){var c=jn(),h=ve;if(h!==null)return vy(c,h,o);jn(),c=c.memoizedState,h=jn();var g=h.queue.dispatch;return h.memoizedState=o,[c,g,!1]}function bu(o,c,h,g){return o={tag:o,create:h,deps:g,inst:c,next:null},c=ue.updateQueue,c===null&&(c=du(),ue.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=o.next=o:(g=h.next,h.next=o,o.next=g,c.lastEffect=o),o}function d0(){return{destroy:void 0,resource:void 0}}function xy(){return jn().memoizedState}function p0(o,c,h,g){var y=xi();g=g===void 0?null:g,ue.flags|=o,y.memoizedState=bu(1|c,d0(),h,g)}function Oh(o,c,h,g){var y=jn();g=g===void 0?null:g;var A=y.memoizedState.inst;ve!==null&&g!==null&&Pr(g,ve.memoizedState.deps)?y.memoizedState=bu(c,A,h,g):(ue.flags|=o,y.memoizedState=bu(1|c,A,h,g))}function by(o,c){p0(8390656,8,o,c)}function yy(o,c){Oh(2048,8,o,c)}function Ey(o,c){return Oh(4,2,o,c)}function wy(o,c){return Oh(4,4,o,c)}function Ay(o,c){if(typeof c=="function"){o=o();var h=c(o);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function Sy(o,c,h){h=h!=null?h.concat([o]):null,Oh(4,4,Ay.bind(null,c,o),h)}function Lv(){}function Ty(o,c){var h=jn();c=c===void 0?null:c;var g=h.memoizedState;return c!==null&&Pr(c,g[1])?g[0]:(h.memoizedState=[o,c],o)}function Cy(o,c){var h=jn();c=c===void 0?null:c;var g=h.memoizedState;if(c!==null&&Pr(c,g[1]))return g[0];if(g=o(),Xn){ne(!0);try{o()}finally{ne(!1)}}return h.memoizedState=[g,c],g}function Iv(o,c,h){return h===void 0||(ke&1073741824)!==0?o.memoizedState=c:(o.memoizedState=h,o=RE(),ue.lanes|=o,hl|=o,h)}function Dy(o,c,h,g){return Wi(h,c)?h:Te.current!==null?(o=Iv(o,h,g),Wi(o,c)||(Ai=!0),o):(ke&42)===0?(Ai=!0,o.memoizedState=h):(o=RE(),ue.lanes|=o,hl|=o,c)}function Oy(o,c,h,g,y){var A=X.p;X.p=A!==0&&8>A?A:8;var B=Q.T,W={};Q.T=W,Fv(o,!1,c,h);try{var ht=y(),Mt=Q.S;if(Mt!==null&&Mt(W,ht),ht!==null&&typeof ht=="object"&&typeof ht.then=="function"){var Vt=kv(ht,g);Rh(o,c,Vt,es(o))}else Rh(o,c,g,es(o))}catch(Kt){Rh(o,c,{then:function(){},status:"rejected",reason:Kt},es())}finally{X.p=A,Q.T=B}}function uN(){}function Mv(o,c,h,g){if(o.tag!==5)throw Error(i(476));var y=Ry(o).queue;Oy(o,y,c,Rt,h===null?uN:function(){return Ny(o),h(g)})}function Ry(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:Rt,baseState:Rt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zr,lastRenderedState:Rt},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zr,lastRenderedState:h},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function Ny(o){var c=Ry(o).next.queue;Rh(o,c,{},es())}function Pv(){return gi(Yh)}function ky(){return jn().memoizedState}function Ly(){return jn().memoizedState}function fN(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var h=es();o=qt(h);var g=re(c,o,h);g!==null&&(ns(g,c,h),fe(g,c,h)),c={cache:sc()},o.payload=c;return}c=c.return}}function hN(o,c,h){var g=es();h={lane:g,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},m0(o)?My(c,h):(h=rh(o,c,h,g),h!==null&&(ns(h,o,g),Py(h,c,g)))}function Iy(o,c,h){var g=es();Rh(o,c,h,g)}function Rh(o,c,h,g){var y={lane:g,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(m0(o))My(c,y);else{var A=o.alternate;if(o.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var B=c.lastRenderedState,W=A(B,h);if(y.hasEagerState=!0,y.eagerState=W,Wi(W,B))return cu(o,c,y,0),kn===null&&lu(),!1}catch{}finally{}if(h=rh(o,c,y,g),h!==null)return ns(h,o,g),Py(h,c,g),!0}return!1}function Fv(o,c,h,g){if(g={lane:2,revertLane:m1(),action:g,hasEagerState:!1,eagerState:null,next:null},m0(o)){if(c)throw Error(i(479))}else c=rh(o,h,g,2),c!==null&&ns(c,o,2)}function m0(o){var c=o.alternate;return o===ue||c!==null&&c===ue}function My(o,c){yn=Je=!0;var h=o.pending;h===null?c.next=c:(c.next=h.next,h.next=c),o.pending=c}function Py(o,c,h){if((h&4194048)!==0){var g=c.lanes;g&=o.pendingLanes,h|=g,c.lanes=h,Kc(o,h)}}var g0={readContext:gi,use:pu,useCallback:Ue,useContext:Ue,useEffect:Ue,useImperativeHandle:Ue,useLayoutEffect:Ue,useInsertionEffect:Ue,useMemo:Ue,useReducer:Ue,useRef:Ue,useState:Ue,useDebugValue:Ue,useDeferredValue:Ue,useTransition:Ue,useSyncExternalStore:Ue,useId:Ue,useHostTransitionStatus:Ue,useFormState:Ue,useActionState:Ue,useOptimistic:Ue,useMemoCache:Ue,useCacheRefresh:Ue},Fy={readContext:gi,use:pu,useCallback:function(o,c){return xi().memoizedState=[o,c===void 0?null:c],o},useContext:gi,useEffect:by,useImperativeHandle:function(o,c,h){h=h!=null?h.concat([o]):null,p0(4194308,4,Ay.bind(null,c,o),h)},useLayoutEffect:function(o,c){return p0(4194308,4,o,c)},useInsertionEffect:function(o,c){p0(4,2,o,c)},useMemo:function(o,c){var h=xi();c=c===void 0?null:c;var g=o();if(Xn){ne(!0);try{o()}finally{ne(!1)}}return h.memoizedState=[g,c],g},useReducer:function(o,c,h){var g=xi();if(h!==void 0){var y=h(c);if(Xn){ne(!0);try{h(c)}finally{ne(!1)}}}else y=c;return g.memoizedState=g.baseState=y,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:y},g.queue=o,o=o.dispatch=hN.bind(null,ue,o),[g.memoizedState,o]},useRef:function(o){var c=xi();return o={current:o},c.memoizedState=o},useState:function(o){o=vu(o);var c=o.queue,h=Iy.bind(null,ue,c);return c.dispatch=h,[o.memoizedState,h]},useDebugValue:Lv,useDeferredValue:function(o,c){var h=xi();return Iv(h,o,c)},useTransition:function(){var o=vu(!1);return o=Oy.bind(null,ue,o.queue,!0,!1),xi().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,h){var g=ue,y=xi();if(an){if(h===void 0)throw Error(i(407));h=h()}else{if(h=c(),kn===null)throw Error(i(349));(tn&124)!==0||Eh(g,c,h)}y.memoizedState=h;var A={value:h,getSnapshot:c};return y.queue=A,by(u0.bind(null,g,A,o),[o]),g.flags|=2048,bu(9,d0(),c0.bind(null,g,A,h,c),null),h},useId:function(){var o=xi(),c=kn.identifierPrefix;if(an){var h=Ii,g=Zs;h=(g&~(1<<32-Re(g)-1)).toString(32)+h,c="«"+c+"R"+h,h=Xi++,0<h&&(c+="H"+h.toString(32)),c+="»"}else h=Mr++,c="«"+c+"r"+h.toString(32)+"»";return o.memoizedState=c},useHostTransitionStatus:Pv,useFormState:xu,useActionState:xu,useOptimistic:function(o){var c=xi();c.memoizedState=c.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=Fv.bind(null,ue,!0,h),h.dispatch=c,[o,c]},useMemoCache:xh,useCacheRefresh:function(){return xi().memoizedState=fN.bind(null,ue)}},By={readContext:gi,use:pu,useCallback:Ty,useContext:gi,useEffect:yy,useImperativeHandle:Sy,useInsertionEffect:Ey,useLayoutEffect:wy,useMemo:Cy,useReducer:mu,useRef:xy,useState:function(){return mu(Zr)},useDebugValue:Lv,useDeferredValue:function(o,c){var h=jn();return Dy(h,ve.memoizedState,o,c)},useTransition:function(){var o=mu(Zr)[0],c=jn().memoizedState;return[typeof o=="boolean"?o:Aa(o),c]},useSyncExternalStore:yh,useId:ky,useHostTransitionStatus:Pv,useFormState:Dh,useActionState:Dh,useOptimistic:function(o,c){var h=jn();return wh(h,ve,o,c)},useMemoCache:xh,useCacheRefresh:Ly},dN={readContext:gi,use:pu,useCallback:Ty,useContext:gi,useEffect:yy,useImperativeHandle:Sy,useInsertionEffect:Ey,useLayoutEffect:wy,useMemo:Cy,useReducer:bh,useRef:xy,useState:function(){return bh(Zr)},useDebugValue:Lv,useDeferredValue:function(o,c){var h=jn();return ve===null?Iv(h,o,c):Dy(h,ve.memoizedState,o,c)},useTransition:function(){var o=bh(Zr)[0],c=jn().memoizedState;return[typeof o=="boolean"?o:Aa(o),c]},useSyncExternalStore:yh,useId:ky,useHostTransitionStatus:Pv,useFormState:_y,useActionState:_y,useOptimistic:function(o,c){var h=jn();return ve!==null?wh(h,ve,o,c):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:xh,useCacheRefresh:Ly},yu=null,Nh=0;function v0(o){var c=Nh;return Nh+=1,yu===null&&(yu=[]),U(yu,o,c)}function kh(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function _0(o,c){throw c.$$typeof===p?Error(i(525)):(o=Object.prototype.toString.call(c),Error(i(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function Uy(o){var c=o._init;return c(o._payload)}function zy(o){function c(Tt,xt){if(o){var kt=Tt.deletions;kt===null?(Tt.deletions=[xt],Tt.flags|=16):kt.push(xt)}}function h(Tt,xt){if(!o)return null;for(;xt!==null;)c(Tt,xt),xt=xt.sibling;return null}function g(Tt){for(var xt=new Map;Tt!==null;)Tt.key!==null?xt.set(Tt.key,Tt):xt.set(Tt.index,Tt),Tt=Tt.sibling;return xt}function y(Tt,xt){return Tt=Xs(Tt,xt),Tt.index=0,Tt.sibling=null,Tt}function A(Tt,xt,kt){return Tt.index=kt,o?(kt=Tt.alternate,kt!==null?(kt=kt.index,kt<xt?(Tt.flags|=67108866,xt):kt):(Tt.flags|=67108866,xt)):(Tt.flags|=1048576,xt)}function B(Tt){return o&&Tt.alternate===null&&(Tt.flags|=67108866),Tt}function W(Tt,xt,kt,Yt){return xt===null||xt.tag!==6?(xt=tl(kt,Tt.mode,Yt),xt.return=Tt,xt):(xt=y(xt,kt),xt.return=Tt,xt)}function ht(Tt,xt,kt,Yt){var pe=kt.type;return pe===x?Vt(Tt,xt,kt.props.children,Yt,kt.key):xt!==null&&(xt.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===M&&Uy(pe)===xt.type)?(xt=y(xt,kt.props),kh(xt,kt),xt.return=Tt,xt):(xt=fu(kt.type,kt.key,kt.props,null,Tt.mode,Yt),kh(xt,kt),xt.return=Tt,xt)}function Mt(Tt,xt,kt,Yt){return xt===null||xt.tag!==4||xt.stateNode.containerInfo!==kt.containerInfo||xt.stateNode.implementation!==kt.implementation?(xt=oh(kt,Tt.mode,Yt),xt.return=Tt,xt):(xt=y(xt,kt.children||[]),xt.return=Tt,xt)}function Vt(Tt,xt,kt,Yt,pe){return xt===null||xt.tag!==7?(xt=Ks(kt,Tt.mode,Yt,pe),xt.return=Tt,xt):(xt=y(xt,kt),xt.return=Tt,xt)}function Kt(Tt,xt,kt){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return xt=tl(""+xt,Tt.mode,kt),xt.return=Tt,xt;if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case m:return kt=fu(xt.type,xt.key,xt.props,null,Tt.mode,kt),kh(kt,xt),kt.return=Tt,kt;case v:return xt=oh(xt,Tt.mode,kt),xt.return=Tt,xt;case M:var Yt=xt._init;return xt=Yt(xt._payload),Kt(Tt,xt,kt)}if(nt(xt)||P(xt))return xt=Ks(xt,Tt.mode,kt,null),xt.return=Tt,xt;if(typeof xt.then=="function")return Kt(Tt,v0(xt),kt);if(xt.$$typeof===S)return Kt(Tt,il(Tt,xt),kt);_0(Tt,xt)}return null}function Ut(Tt,xt,kt,Yt){var pe=xt!==null?xt.key:null;if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return pe!==null?null:W(Tt,xt,""+kt,Yt);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case m:return kt.key===pe?ht(Tt,xt,kt,Yt):null;case v:return kt.key===pe?Mt(Tt,xt,kt,Yt):null;case M:return pe=kt._init,kt=pe(kt._payload),Ut(Tt,xt,kt,Yt)}if(nt(kt)||P(kt))return pe!==null?null:Vt(Tt,xt,kt,Yt,null);if(typeof kt.then=="function")return Ut(Tt,xt,v0(kt),Yt);if(kt.$$typeof===S)return Ut(Tt,xt,il(Tt,kt),Yt);_0(Tt,kt)}return null}function zt(Tt,xt,kt,Yt,pe){if(typeof Yt=="string"&&Yt!==""||typeof Yt=="number"||typeof Yt=="bigint")return Tt=Tt.get(kt)||null,W(xt,Tt,""+Yt,pe);if(typeof Yt=="object"&&Yt!==null){switch(Yt.$$typeof){case m:return Tt=Tt.get(Yt.key===null?kt:Yt.key)||null,ht(xt,Tt,Yt,pe);case v:return Tt=Tt.get(Yt.key===null?kt:Yt.key)||null,Mt(xt,Tt,Yt,pe);case M:var We=Yt._init;return Yt=We(Yt._payload),zt(Tt,xt,kt,Yt,pe)}if(nt(Yt)||P(Yt))return Tt=Tt.get(kt)||null,Vt(xt,Tt,Yt,pe,null);if(typeof Yt.then=="function")return zt(Tt,xt,kt,v0(Yt),pe);if(Yt.$$typeof===S)return zt(Tt,xt,kt,il(xt,Yt),pe);_0(xt,Yt)}return null}function Me(Tt,xt,kt,Yt){for(var pe=null,We=null,_e=xt,De=xt=0,Ti=null;_e!==null&&De<kt.length;De++){_e.index>De?(Ti=_e,_e=null):Ti=_e.sibling;var cn=Ut(Tt,_e,kt[De],Yt);if(cn===null){_e===null&&(_e=Ti);break}o&&_e&&cn.alternate===null&&c(Tt,_e),xt=A(cn,xt,De),We===null?pe=cn:We.sibling=cn,We=cn,_e=Ti}if(De===kt.length)return h(Tt,_e),an&&fo(Tt,De),pe;if(_e===null){for(;De<kt.length;De++)_e=Kt(Tt,kt[De],Yt),_e!==null&&(xt=A(_e,xt,De),We===null?pe=_e:We.sibling=_e,We=_e);return an&&fo(Tt,De),pe}for(_e=g(_e);De<kt.length;De++)Ti=zt(_e,Tt,De,kt[De],Yt),Ti!==null&&(o&&Ti.alternate!==null&&_e.delete(Ti.key===null?De:Ti.key),xt=A(Ti,xt,De),We===null?pe=Ti:We.sibling=Ti,We=Ti);return o&&_e.forEach(function(yl){return c(Tt,yl)}),an&&fo(Tt,De),pe}function Ce(Tt,xt,kt,Yt){if(kt==null)throw Error(i(151));for(var pe=null,We=null,_e=xt,De=xt=0,Ti=null,cn=kt.next();_e!==null&&!cn.done;De++,cn=kt.next()){_e.index>De?(Ti=_e,_e=null):Ti=_e.sibling;var yl=Ut(Tt,_e,cn.value,Yt);if(yl===null){_e===null&&(_e=Ti);break}o&&_e&&yl.alternate===null&&c(Tt,_e),xt=A(yl,xt,De),We===null?pe=yl:We.sibling=yl,We=yl,_e=Ti}if(cn.done)return h(Tt,_e),an&&fo(Tt,De),pe;if(_e===null){for(;!cn.done;De++,cn=kt.next())cn=Kt(Tt,cn.value,Yt),cn!==null&&(xt=A(cn,xt,De),We===null?pe=cn:We.sibling=cn,We=cn);return an&&fo(Tt,De),pe}for(_e=g(_e);!cn.done;De++,cn=kt.next())cn=zt(_e,Tt,De,cn.value,Yt),cn!==null&&(o&&cn.alternate!==null&&_e.delete(cn.key===null?De:cn.key),xt=A(cn,xt,De),We===null?pe=cn:We.sibling=cn,We=cn);return o&&_e.forEach(function(pk){return c(Tt,pk)}),an&&fo(Tt,De),pe}function wn(Tt,xt,kt,Yt){if(typeof kt=="object"&&kt!==null&&kt.type===x&&kt.key===null&&(kt=kt.props.children),typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case m:t:{for(var pe=kt.key;xt!==null;){if(xt.key===pe){if(pe=kt.type,pe===x){if(xt.tag===7){h(Tt,xt.sibling),Yt=y(xt,kt.props.children),Yt.return=Tt,Tt=Yt;break t}}else if(xt.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===M&&Uy(pe)===xt.type){h(Tt,xt.sibling),Yt=y(xt,kt.props),kh(Yt,kt),Yt.return=Tt,Tt=Yt;break t}h(Tt,xt);break}else c(Tt,xt);xt=xt.sibling}kt.type===x?(Yt=Ks(kt.props.children,Tt.mode,Yt,kt.key),Yt.return=Tt,Tt=Yt):(Yt=fu(kt.type,kt.key,kt.props,null,Tt.mode,Yt),kh(Yt,kt),Yt.return=Tt,Tt=Yt)}return B(Tt);case v:t:{for(pe=kt.key;xt!==null;){if(xt.key===pe)if(xt.tag===4&&xt.stateNode.containerInfo===kt.containerInfo&&xt.stateNode.implementation===kt.implementation){h(Tt,xt.sibling),Yt=y(xt,kt.children||[]),Yt.return=Tt,Tt=Yt;break t}else{h(Tt,xt);break}else c(Tt,xt);xt=xt.sibling}Yt=oh(kt,Tt.mode,Yt),Yt.return=Tt,Tt=Yt}return B(Tt);case M:return pe=kt._init,kt=pe(kt._payload),wn(Tt,xt,kt,Yt)}if(nt(kt))return Me(Tt,xt,kt,Yt);if(P(kt)){if(pe=P(kt),typeof pe!="function")throw Error(i(150));return kt=pe.call(kt),Ce(Tt,xt,kt,Yt)}if(typeof kt.then=="function")return wn(Tt,xt,v0(kt),Yt);if(kt.$$typeof===S)return wn(Tt,xt,il(Tt,kt),Yt);_0(Tt,kt)}return typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint"?(kt=""+kt,xt!==null&&xt.tag===6?(h(Tt,xt.sibling),Yt=y(xt,kt),Yt.return=Tt,Tt=Yt):(h(Tt,xt),Yt=tl(kt,Tt.mode,Yt),Yt.return=Tt,Tt=Yt),B(Tt)):h(Tt,xt)}return function(Tt,xt,kt,Yt){try{Nh=0;var pe=wn(Tt,xt,kt,Yt);return yu=null,pe}catch(_e){if(_e===sl||_e===_o)throw _e;var We=gr(29,_e,null,Tt.mode);return We.lanes=Yt,We.return=Tt,We}finally{}}}var Eu=zy(!0),jy=zy(!1),Ts=J(null),Ta=null;function al(o){var c=o.alternate;ut(bi,bi.current&1),ut(Ts,o),Ta===null&&(c===null||Te.current!==null||c.memoizedState!==null)&&(Ta=o)}function Hy(o){if(o.tag===22){if(ut(bi,bi.current),ut(Ts,o),Ta===null){var c=o.alternate;c!==null&&c.memoizedState!==null&&(Ta=o)}}else ol()}function ol(){ut(bi,bi.current),ut(Ts,Ts.current)}function bo(o){G(Ts),Ta===o&&(Ta=null),G(bi)}var bi=J(0);function x0(o){for(var c=o;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||C1(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function Bv(o,c,h,g){c=o.memoizedState,h=h(g,c),h=h==null?c:d({},c,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var Uv={enqueueSetState:function(o,c,h){o=o._reactInternals;var g=es(),y=qt(g);y.payload=c,h!=null&&(y.callback=h),c=re(o,y,g),c!==null&&(ns(c,o,g),fe(c,o,g))},enqueueReplaceState:function(o,c,h){o=o._reactInternals;var g=es(),y=qt(g);y.tag=1,y.payload=c,h!=null&&(y.callback=h),c=re(o,y,g),c!==null&&(ns(c,o,g),fe(c,o,g))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var h=es(),g=qt(h);g.tag=2,c!=null&&(g.callback=c),c=re(o,g,h),c!==null&&(ns(c,o,h),fe(c,o,h))}};function $y(o,c,h,g,y,A,B){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,A,B):c.prototype&&c.prototype.isPureReactComponent?!so(h,g)||!so(y,A):!0}function Gy(o,c,h,g){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,g),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,g),c.state!==o&&Uv.enqueueReplaceState(c,c.state,null)}function lc(o,c){var h=c;if("ref"in c){h={};for(var g in c)g!=="ref"&&(h[g]=c[g])}if(o=o.defaultProps){h===c&&(h=d({},h));for(var y in o)h[y]===void 0&&(h[y]=o[y])}return h}var b0=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function Vy(o){b0(o)}function Wy(o){console.error(o)}function qy(o){b0(o)}function y0(o,c){try{var h=o.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(g){setTimeout(function(){throw g})}}function Yy(o,c,h){try{var g=o.onCaughtError;g(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function zv(o,c,h){return h=qt(h),h.tag=3,h.payload={element:null},h.callback=function(){y0(o,c)},h}function Xy(o){return o=qt(o),o.tag=3,o}function Ky(o,c,h,g){var y=h.type.getDerivedStateFromError;if(typeof y=="function"){var A=g.value;o.payload=function(){return y(A)},o.callback=function(){Yy(c,h,g)}}var B=h.stateNode;B!==null&&typeof B.componentDidCatch=="function"&&(o.callback=function(){Yy(c,h,g),typeof y!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var W=g.stack;this.componentDidCatch(g.value,{componentStack:W!==null?W:""})})}function pN(o,c,h,g,y){if(h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(c=h.alternate,c!==null&&ic(c,h,y,!0),h=Ts.current,h!==null){switch(h.tag){case 13:return Ta===null?u1():h.alternate===null&&qn===0&&(qn=3),h.flags&=-257,h.flags|=65536,h.lanes=y,g===_h?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([g]):c.add(g),h1(o,g,y)),!1;case 22:return h.flags|=65536,g===_h?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([g])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([g]):h.add(g)),h1(o,g,y)),!1}throw Error(i(435,h.tag))}return h1(o,g,y),u1(),!1}if(an)return c=Ts.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=y,g!==ya&&(o=Error(i(422),{cause:g}),Kr(pr(o,h)))):(g!==ya&&(c=Error(i(423),{cause:g}),Kr(pr(c,h))),o=o.current.alternate,o.flags|=65536,y&=-y,o.lanes|=y,g=pr(g,h),y=zv(o.stateNode,g,y),he(o,y),qn!==4&&(qn=2)),!1;var A=Error(i(520),{cause:g});if(A=pr(A,h),Uh===null?Uh=[A]:Uh.push(A),qn!==4&&(qn=2),c===null)return!0;g=pr(g,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,o=y&-y,h.lanes|=o,o=zv(h.stateNode,g,o),he(h,o),!1;case 1:if(c=h.type,A=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(dl===null||!dl.has(A))))return h.flags|=65536,y&=-y,h.lanes|=y,y=Xy(y),Ky(y,o,h,g),he(h,y),!1}h=h.return}while(h!==null);return!1}var Zy=Error(i(461)),Ai=!1;function Mi(o,c,h,g){c.child=o===null?jy(c,null,h,g):Eu(c,o.child,h,g)}function Qy(o,c,h,g,y){h=h.render;var A=c.ref;if("ref"in g){var B={};for(var W in g)W!=="ref"&&(B[W]=g[W])}else B=g;return po(c),g=Fr(o,c,h,B,A,y),W=_i(),o!==null&&!Ai?(Ki(o,c,y),yo(o,c,y)):(an&&W&&lh(c),c.flags|=1,Mi(o,c,g,y),c.child)}function Jy(o,c,h,g,y){if(o===null){var A=h.type;return typeof A=="function"&&!ah(A)&&A.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=A,tE(o,c,A,g,y)):(o=fu(h.type,null,g,c,c.mode,y),o.ref=c.ref,o.return=c,c.child=o)}if(A=o.child,!Yv(o,y)){var B=A.memoizedProps;if(h=h.compare,h=h!==null?h:so,h(B,g)&&o.ref===c.ref)return yo(o,c,y)}return c.flags|=1,o=Xs(A,g),o.ref=c.ref,o.return=c,c.child=o}function tE(o,c,h,g,y){if(o!==null){var A=o.memoizedProps;if(so(A,g)&&o.ref===c.ref)if(Ai=!1,c.pendingProps=g=A,Yv(o,y))(o.flags&131072)!==0&&(Ai=!0);else return c.lanes=o.lanes,yo(o,c,y)}return jv(o,c,h,g,y)}function eE(o,c,h){var g=c.pendingProps,y=g.children,A=o!==null?o.memoizedState:null;if(g.mode==="hidden"){if((c.flags&128)!==0){if(g=A!==null?A.baseLanes|h:h,o!==null){for(y=c.child=o.child,A=0;y!==null;)A=A|y.lanes|y.childLanes,y=y.sibling;c.childLanes=A&~g}else c.childLanes=0,c.child=null;return nE(o,c,g,h)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&hu(c,A!==null?A.cachePool:null),A!==null?pn(c,A):je(),Hy(c);else return c.lanes=c.childLanes=536870912,nE(o,c,A!==null?A.baseLanes|h:h,h)}else A!==null?(hu(c,A.cachePool),pn(c,A),ol(),c.memoizedState=null):(o!==null&&hu(c,null),je(),ol());return Mi(o,c,y,h),c.child}function nE(o,c,h,g){var y=vh();return y=y===null?null:{parent:Wn._currentValue,pool:y},c.memoizedState={baseLanes:h,cachePool:y},o!==null&&hu(c,null),je(),Hy(c),o!==null&&ic(o,c,g,!0),null}function E0(o,c){var h=c.ref;if(h===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(i(284));(o===null||o.ref!==h)&&(c.flags|=4194816)}}function jv(o,c,h,g,y){return po(c),h=Fr(o,c,h,g,void 0,y),g=_i(),o!==null&&!Ai?(Ki(o,c,y),yo(o,c,y)):(an&&g&&lh(c),c.flags|=1,Mi(o,c,h,y),c.child)}function iE(o,c,h,g,y,A){return po(c),c.updateQueue=null,h=Zn(c,g,h,y),xo(o),g=_i(),o!==null&&!Ai?(Ki(o,c,A),yo(o,c,A)):(an&&g&&lh(c),c.flags|=1,Mi(o,c,h,A),c.child)}function rE(o,c,h,g,y){if(po(c),c.stateNode===null){var A=Jo,B=h.contextType;typeof B=="object"&&B!==null&&(A=gi(B)),A=new h(g,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=Uv,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=g,A.state=c.memoizedState,A.refs={},St(c),B=h.contextType,A.context=typeof B=="object"&&B!==null?gi(B):Jo,A.state=c.memoizedState,B=h.getDerivedStateFromProps,typeof B=="function"&&(Bv(c,h,B,g),A.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(B=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),B!==A.state&&Uv.enqueueReplaceState(A,A.state,null),Ee(c,g,A,y),Pe(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),g=!0}else if(o===null){A=c.stateNode;var W=c.memoizedProps,ht=lc(h,W);A.props=ht;var Mt=A.context,Vt=h.contextType;B=Jo,typeof Vt=="object"&&Vt!==null&&(B=gi(Vt));var Kt=h.getDerivedStateFromProps;Vt=typeof Kt=="function"||typeof A.getSnapshotBeforeUpdate=="function",W=c.pendingProps!==W,Vt||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(W||Mt!==B)&&Gy(c,A,g,B),bt=!1;var Ut=c.memoizedState;A.state=Ut,Ee(c,g,A,y),Pe(),Mt=c.memoizedState,W||Ut!==Mt||bt?(typeof Kt=="function"&&(Bv(c,h,Kt,g),Mt=c.memoizedState),(ht=bt||$y(c,h,ht,g,Ut,Mt,B))?(Vt||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=g,c.memoizedState=Mt),A.props=g,A.state=Mt,A.context=B,g=ht):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),g=!1)}else{A=c.stateNode,$t(o,c),B=c.memoizedProps,Vt=lc(h,B),A.props=Vt,Kt=c.pendingProps,Ut=A.context,Mt=h.contextType,ht=Jo,typeof Mt=="object"&&Mt!==null&&(ht=gi(Mt)),W=h.getDerivedStateFromProps,(Mt=typeof W=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(B!==Kt||Ut!==ht)&&Gy(c,A,g,ht),bt=!1,Ut=c.memoizedState,A.state=Ut,Ee(c,g,A,y),Pe();var zt=c.memoizedState;B!==Kt||Ut!==zt||bt||o!==null&&o.dependencies!==null&&rc(o.dependencies)?(typeof W=="function"&&(Bv(c,h,W,g),zt=c.memoizedState),(Vt=bt||$y(c,h,Vt,g,Ut,zt,ht)||o!==null&&o.dependencies!==null&&rc(o.dependencies))?(Mt||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(g,zt,ht),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(g,zt,ht)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||B===o.memoizedProps&&Ut===o.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||B===o.memoizedProps&&Ut===o.memoizedState||(c.flags|=1024),c.memoizedProps=g,c.memoizedState=zt),A.props=g,A.state=zt,A.context=ht,g=Vt):(typeof A.componentDidUpdate!="function"||B===o.memoizedProps&&Ut===o.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||B===o.memoizedProps&&Ut===o.memoizedState||(c.flags|=1024),g=!1)}return A=g,E0(o,c),g=(c.flags&128)!==0,A||g?(A=c.stateNode,h=g&&typeof h.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,o!==null&&g?(c.child=Eu(c,o.child,null,y),c.child=Eu(c,null,h,y)):Mi(o,c,h,y),c.memoizedState=A.state,o=c.child):o=yo(o,c,y),o}function sE(o,c,h,g){return nc(),c.flags|=256,Mi(o,c,h,g),c.child}var Hv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $v(o){return{baseLanes:o,cachePool:o0()}}function Gv(o,c,h){return o=o!==null?o.childLanes&~h:0,c&&(o|=Cs),o}function aE(o,c,h){var g=c.pendingProps,y=!1,A=(c.flags&128)!==0,B;if((B=A)||(B=o!==null&&o.memoizedState===null?!1:(bi.current&2)!==0),B&&(y=!0,c.flags&=-129),B=(c.flags&32)!==0,c.flags&=-33,o===null){if(an){if(y?al(c):ol(),an){var W=Nn,ht;if(ht=W){t:{for(ht=W,W=As;ht.nodeType!==8;){if(!W){W=null;break t}if(ht=na(ht.nextSibling),ht===null){W=null;break t}}W=ht}W!==null?(c.memoizedState={dehydrated:W,treeContext:uo!==null?{id:Zs,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},ht=gr(18,null,null,0),ht.stateNode=W,ht.return=c,c.child=ht,ai=c,Nn=null,ht=!0):ht=!1}ht||Qs(c)}if(W=c.memoizedState,W!==null&&(W=W.dehydrated,W!==null))return C1(W)?c.lanes=32:c.lanes=536870912,null;bo(c)}return W=g.children,g=g.fallback,y?(ol(),y=c.mode,W=w0({mode:"hidden",children:W},y),g=Ks(g,y,h,null),W.return=c,g.return=c,W.sibling=g,c.child=W,y=c.child,y.memoizedState=$v(h),y.childLanes=Gv(o,B,h),c.memoizedState=Hv,g):(al(c),Vv(c,W))}if(ht=o.memoizedState,ht!==null&&(W=ht.dehydrated,W!==null)){if(A)c.flags&256?(al(c),c.flags&=-257,c=Wv(o,c,h)):c.memoizedState!==null?(ol(),c.child=o.child,c.flags|=128,c=null):(ol(),y=g.fallback,W=c.mode,g=w0({mode:"visible",children:g.children},W),y=Ks(y,W,h,null),y.flags|=2,g.return=c,y.return=c,g.sibling=y,c.child=g,Eu(c,o.child,null,h),g=c.child,g.memoizedState=$v(h),g.childLanes=Gv(o,B,h),c.memoizedState=Hv,c=y);else if(al(c),C1(W)){if(B=W.nextSibling&&W.nextSibling.dataset,B)var Mt=B.dgst;B=Mt,g=Error(i(419)),g.stack="",g.digest=B,Kr({value:g,source:null,stack:null}),c=Wv(o,c,h)}else if(Ai||ic(o,c,h,!1),B=(h&o.childLanes)!==0,Ai||B){if(B=kn,B!==null&&(g=h&-h,g=(g&42)!==0?1:jl(g),g=(g&(B.suspendedLanes|h))!==0?0:g,g!==0&&g!==ht.retryLane))throw ht.retryLane=g,qi(o,g),ns(B,o,g),Zy;W.data==="$?"||u1(),c=Wv(o,c,h)}else W.data==="$?"?(c.flags|=192,c.child=o.child,c=null):(o=ht.treeContext,Nn=na(W.nextSibling),ai=c,an=!0,ba=null,As=!1,o!==null&&(Yi[Lr++]=Zs,Yi[Lr++]=Ii,Yi[Lr++]=uo,Zs=o.id,Ii=o.overflow,uo=c),c=Vv(c,g.children),c.flags|=4096);return c}return y?(ol(),y=g.fallback,W=c.mode,ht=o.child,Mt=ht.sibling,g=Xs(ht,{mode:"hidden",children:g.children}),g.subtreeFlags=ht.subtreeFlags&65011712,Mt!==null?y=Xs(Mt,y):(y=Ks(y,W,h,null),y.flags|=2),y.return=c,g.return=c,g.sibling=y,c.child=g,g=y,y=c.child,W=o.child.memoizedState,W===null?W=$v(h):(ht=W.cachePool,ht!==null?(Mt=Wn._currentValue,ht=ht.parent!==Mt?{parent:Mt,pool:Mt}:ht):ht=o0(),W={baseLanes:W.baseLanes|h,cachePool:ht}),y.memoizedState=W,y.childLanes=Gv(o,B,h),c.memoizedState=Hv,g):(al(c),h=o.child,o=h.sibling,h=Xs(h,{mode:"visible",children:g.children}),h.return=c,h.sibling=null,o!==null&&(B=c.deletions,B===null?(c.deletions=[o],c.flags|=16):B.push(o)),c.child=h,c.memoizedState=null,h)}function Vv(o,c){return c=w0({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function w0(o,c){return o=gr(22,o,null,c),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function Wv(o,c,h){return Eu(c,o.child,null,h),o=Vv(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function oE(o,c,h){o.lanes|=c;var g=o.alternate;g!==null&&(g.lanes|=c),hh(o.return,c,h)}function qv(o,c,h,g,y){var A=o.memoizedState;A===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:y}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=g,A.tail=h,A.tailMode=y)}function lE(o,c,h){var g=c.pendingProps,y=g.revealOrder,A=g.tail;if(Mi(o,c,g.children,h),g=bi.current,(g&2)!==0)g=g&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)t:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&oE(o,h,c);else if(o.tag===19)oE(o,h,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break t;for(;o.sibling===null;){if(o.return===null||o.return===c)break t;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}switch(ut(bi,g),y){case"forwards":for(h=c.child,y=null;h!==null;)o=h.alternate,o!==null&&x0(o)===null&&(y=h),h=h.sibling;h=y,h===null?(y=c.child,c.child=null):(y=h.sibling,h.sibling=null),qv(c,!1,y,h,A);break;case"backwards":for(h=null,y=c.child,c.child=null;y!==null;){if(o=y.alternate,o!==null&&x0(o)===null){c.child=y;break}o=y.sibling,y.sibling=h,h=y,y=o}qv(c,!0,h,null,A);break;case"together":qv(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function yo(o,c,h){if(o!==null&&(c.dependencies=o.dependencies),hl|=c.lanes,(h&c.childLanes)===0)if(o!==null){if(ic(o,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(i(153));if(c.child!==null){for(o=c.child,h=Xs(o,o.pendingProps),c.child=h,h.return=c;o.sibling!==null;)o=o.sibling,h=h.sibling=Xs(o,o.pendingProps),h.return=c;h.sibling=null}return c.child}function Yv(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&rc(o)))}function mN(o,c,h){switch(c.tag){case 3:H(c,c.stateNode.containerInfo),Ea(c,Wn,o.memoizedState.cache),nc();break;case 27:case 5:lt(c);break;case 4:H(c,c.stateNode.containerInfo);break;case 10:Ea(c,c.type,c.memoizedProps.value);break;case 13:var g=c.memoizedState;if(g!==null)return g.dehydrated!==null?(al(c),c.flags|=128,null):(h&c.child.childLanes)!==0?aE(o,c,h):(al(c),o=yo(o,c,h),o!==null?o.sibling:null);al(c);break;case 19:var y=(o.flags&128)!==0;if(g=(h&c.childLanes)!==0,g||(ic(o,c,h,!1),g=(h&c.childLanes)!==0),y){if(g)return lE(o,c,h);c.flags|=128}if(y=c.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ut(bi,bi.current),g)break;return null;case 22:case 23:return c.lanes=0,eE(o,c,h);case 24:Ea(c,Wn,o.memoizedState.cache)}return yo(o,c,h)}function cE(o,c,h){if(o!==null)if(o.memoizedProps!==c.pendingProps)Ai=!0;else{if(!Yv(o,h)&&(c.flags&128)===0)return Ai=!1,mN(o,c,h);Ai=(o.flags&131072)!==0}else Ai=!1,an&&(c.flags&1048576)!==0&&n0(c,el,c.index);switch(c.lanes=0,c.tag){case 16:t:{o=c.pendingProps;var g=c.elementType,y=g._init;if(g=y(g._payload),c.type=g,typeof g=="function")ah(g)?(o=lc(g,o),c.tag=1,c=rE(null,c,g,o,h)):(c.tag=0,c=jv(null,c,g,o,h));else{if(g!=null){if(y=g.$$typeof,y===O){c.tag=11,c=Qy(null,c,g,o,h);break t}else if(y===C){c.tag=14,c=Jy(null,c,g,o,h);break t}}throw c=L(g)||g,Error(i(306,c,""))}}return c;case 0:return jv(o,c,c.type,c.pendingProps,h);case 1:return g=c.type,y=lc(g,c.pendingProps),rE(o,c,g,y,h);case 3:t:{if(H(c,c.stateNode.containerInfo),o===null)throw Error(i(387));g=c.pendingProps;var A=c.memoizedState;y=A.element,$t(o,c),Ee(c,g,null,h);var B=c.memoizedState;if(g=B.cache,Ea(c,Wn,g),g!==A.cache&&dh(c,[Wn],h,!0),Pe(),g=B.element,A.isDehydrated)if(A={element:g,isDehydrated:!1,cache:B.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=sE(o,c,g,h);break t}else if(g!==y){y=pr(Error(i(424)),c),Kr(y),c=sE(o,c,g,h);break t}else{switch(o=c.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Nn=na(o.firstChild),ai=c,an=!0,ba=null,As=!0,h=jy(c,null,g,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(nc(),g===y){c=yo(o,c,h);break t}Mi(o,c,g,h)}c=c.child}return c;case 26:return E0(o,c),o===null?(h=dw(c.type,null,c.pendingProps,null))?c.memoizedState=h:an||(h=c.type,o=c.pendingProps,g=F0(Bt.current).createElement(h),g[ii]=c,g[ri]=o,Fi(g,h,o),Et(g),c.stateNode=g):c.memoizedState=dw(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return lt(c),o===null&&an&&(g=c.stateNode=uw(c.type,c.pendingProps,Bt.current),ai=c,As=!0,y=Nn,gl(c.type)?(D1=y,Nn=na(g.firstChild)):Nn=y),Mi(o,c,c.pendingProps.children,h),E0(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&an&&((y=g=Nn)&&(g=$N(g,c.type,c.pendingProps,As),g!==null?(c.stateNode=g,ai=c,Nn=na(g.firstChild),As=!1,y=!0):y=!1),y||Qs(c)),lt(c),y=c.type,A=c.pendingProps,B=o!==null?o.memoizedProps:null,g=A.children,A1(y,A)?g=null:B!==null&&A1(y,B)&&(c.flags|=32),c.memoizedState!==null&&(y=Fr(o,c,mn,null,null,h),Yh._currentValue=y),E0(o,c),Mi(o,c,g,h),c.child;case 6:return o===null&&an&&((o=h=Nn)&&(h=GN(h,c.pendingProps,As),h!==null?(c.stateNode=h,ai=c,Nn=null,o=!0):o=!1),o||Qs(c)),null;case 13:return aE(o,c,h);case 4:return H(c,c.stateNode.containerInfo),g=c.pendingProps,o===null?c.child=Eu(c,null,g,h):Mi(o,c,g,h),c.child;case 11:return Qy(o,c,c.type,c.pendingProps,h);case 7:return Mi(o,c,c.pendingProps,h),c.child;case 8:return Mi(o,c,c.pendingProps.children,h),c.child;case 12:return Mi(o,c,c.pendingProps.children,h),c.child;case 10:return g=c.pendingProps,Ea(c,c.type,g.value),Mi(o,c,g.children,h),c.child;case 9:return y=c.type._context,g=c.pendingProps.children,po(c),y=gi(y),g=g(y),c.flags|=1,Mi(o,c,g,h),c.child;case 14:return Jy(o,c,c.type,c.pendingProps,h);case 15:return tE(o,c,c.type,c.pendingProps,h);case 19:return lE(o,c,h);case 31:return g=c.pendingProps,h=c.mode,g={mode:g.mode,children:g.children},o===null?(h=w0(g,h),h.ref=c.ref,c.child=h,h.return=c,c=h):(h=Xs(o.child,g),h.ref=c.ref,c.child=h,h.return=c,c=h),c;case 22:return eE(o,c,h);case 24:return po(c),g=gi(Wn),o===null?(y=vh(),y===null&&(y=kn,A=sc(),y.pooledCache=A,A.refCount++,A!==null&&(y.pooledCacheLanes|=h),y=A),c.memoizedState={parent:g,cache:y},St(c),Ea(c,Wn,y)):((o.lanes&h)!==0&&($t(o,c),Ee(c,null,null,h),Pe()),y=o.memoizedState,A=c.memoizedState,y.parent!==g?(y={parent:g,cache:g},c.memoizedState=y,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=y),Ea(c,Wn,g)):(g=A.cache,Ea(c,Wn,g),g!==y.cache&&dh(c,[Wn],h,!0))),Mi(o,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(i(156,c.tag))}function Eo(o){o.flags|=4}function uE(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!_w(c)){if(c=Ts.current,c!==null&&((tn&4194048)===tn?Ta!==null:(tn&62914560)!==tn&&(tn&536870912)===0||c!==Ta))throw w=_h,ac;o.flags|=8192}}function A0(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?Xa():536870912,o.lanes|=c,Tu|=c)}function Lh(o,c){if(!an)switch(o.tailMode){case"hidden":c=o.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Hn(o){var c=o.alternate!==null&&o.alternate.child===o.child,h=0,g=0;if(c)for(var y=o.child;y!==null;)h|=y.lanes|y.childLanes,g|=y.subtreeFlags&65011712,g|=y.flags&65011712,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)h|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=g,o.childLanes=h,c}function gN(o,c,h){var g=c.pendingProps;switch(ch(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(c),null;case 1:return Hn(c),null;case 3:return h=c.stateNode,g=null,o!==null&&(g=o.memoizedState.cache),c.memoizedState.cache!==g&&(c.flags|=2048),ta(Wn),mt(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(ec(c)?Eo(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,nl())),Hn(c),null;case 26:return h=c.memoizedState,o===null?(Eo(c),h!==null?(Hn(c),uE(c,h)):(Hn(c),c.flags&=-16777217)):h?h!==o.memoizedState?(Eo(c),Hn(c),uE(c,h)):(Hn(c),c.flags&=-16777217):(o.memoizedProps!==g&&Eo(c),Hn(c),c.flags&=-16777217),null;case 27:ct(c),h=Bt.current;var y=c.type;if(o!==null&&c.stateNode!=null)o.memoizedProps!==g&&Eo(c);else{if(!g){if(c.stateNode===null)throw Error(i(166));return Hn(c),null}o=gt.current,ec(c)?uh(c):(o=uw(y,g,h),c.stateNode=o,Eo(c))}return Hn(c),null;case 5:if(ct(c),h=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==g&&Eo(c);else{if(!g){if(c.stateNode===null)throw Error(i(166));return Hn(c),null}if(o=gt.current,ec(c))uh(c);else{switch(y=F0(Bt.current),o){case 1:o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":o=y.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":o=y.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":o=y.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof g.is=="string"?y.createElement("select",{is:g.is}):y.createElement("select"),g.multiple?o.multiple=!0:g.size&&(o.size=g.size);break;default:o=typeof g.is=="string"?y.createElement(h,{is:g.is}):y.createElement(h)}}o[ii]=c,o[ri]=g;t:for(y=c.child;y!==null;){if(y.tag===5||y.tag===6)o.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===c)break t;for(;y.sibling===null;){if(y.return===null||y.return===c)break t;y=y.return}y.sibling.return=y.return,y=y.sibling}c.stateNode=o;t:switch(Fi(o,h,g),h){case"button":case"input":case"select":case"textarea":o=!!g.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&Eo(c)}}return Hn(c),c.flags&=-16777217,null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==g&&Eo(c);else{if(typeof g!="string"&&c.stateNode===null)throw Error(i(166));if(o=Bt.current,ec(c)){if(o=c.stateNode,h=c.memoizedProps,g=null,y=ai,y!==null)switch(y.tag){case 27:case 5:g=y.memoizedProps}o[ii]=c,o=!!(o.nodeValue===h||g!==null&&g.suppressHydrationWarning===!0||iw(o.nodeValue,h)),o||Qs(c)}else o=F0(o).createTextNode(g),o[ii]=c,c.stateNode=o}return Hn(c),null;case 13:if(g=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(y=ec(c),g!==null&&g.dehydrated!==null){if(o===null){if(!y)throw Error(i(318));if(y=c.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[ii]=c}else nc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Hn(c),y=!1}else y=nl(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=y),y=!0;if(!y)return c.flags&256?(bo(c),c):(bo(c),null)}if(bo(c),(c.flags&128)!==0)return c.lanes=h,c;if(h=g!==null,o=o!==null&&o.memoizedState!==null,h){g=c.child,y=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(y=g.alternate.memoizedState.cachePool.pool);var A=null;g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(A=g.memoizedState.cachePool.pool),A!==y&&(g.flags|=2048)}return h!==o&&h&&(c.child.flags|=8192),A0(c,c.updateQueue),Hn(c),null;case 4:return mt(),o===null&&x1(c.stateNode.containerInfo),Hn(c),null;case 10:return ta(c.type),Hn(c),null;case 19:if(G(bi),y=c.memoizedState,y===null)return Hn(c),null;if(g=(c.flags&128)!==0,A=y.rendering,A===null)if(g)Lh(y,!1);else{if(qn!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(A=x0(o),A!==null){for(c.flags|=128,Lh(y,!1),o=A.updateQueue,c.updateQueue=o,A0(c,o),c.subtreeFlags=0,o=h,h=c.child;h!==null;)e0(h,o),h=h.sibling;return ut(bi,bi.current&1|2),c.child}o=o.sibling}y.tail!==null&&Y()>C0&&(c.flags|=128,g=!0,Lh(y,!1),c.lanes=4194304)}else{if(!g)if(o=x0(A),o!==null){if(c.flags|=128,g=!0,o=o.updateQueue,c.updateQueue=o,A0(c,o),Lh(y,!0),y.tail===null&&y.tailMode==="hidden"&&!A.alternate&&!an)return Hn(c),null}else 2*Y()-y.renderingStartTime>C0&&h!==536870912&&(c.flags|=128,g=!0,Lh(y,!1),c.lanes=4194304);y.isBackwards?(A.sibling=c.child,c.child=A):(o=y.last,o!==null?o.sibling=A:c.child=A,y.last=A)}return y.tail!==null?(c=y.tail,y.rendering=c,y.tail=c.sibling,y.renderingStartTime=Y(),c.sibling=null,o=bi.current,ut(bi,g?o&1|2:o&1),c):(Hn(c),null);case 22:case 23:return bo(c),Qe(),g=c.memoizedState!==null,o!==null?o.memoizedState!==null!==g&&(c.flags|=8192):g&&(c.flags|=8192),g?(h&536870912)!==0&&(c.flags&128)===0&&(Hn(c),c.subtreeFlags&6&&(c.flags|=8192)):Hn(c),h=c.updateQueue,h!==null&&A0(c,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==h&&(c.flags|=2048),o!==null&&G(vo),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),ta(Wn),Hn(c),null;case 25:return null;case 30:return null}throw Error(i(156,c.tag))}function vN(o,c){switch(ch(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return ta(Wn),mt(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return ct(c),null;case 13:if(bo(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(i(340));nc()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return G(bi),null;case 4:return mt(),null;case 10:return ta(c.type),null;case 22:case 23:return bo(c),Qe(),o!==null&&G(vo),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return ta(Wn),null;case 25:return null;default:return null}}function fE(o,c){switch(ch(c),c.tag){case 3:ta(Wn),mt();break;case 26:case 27:case 5:ct(c);break;case 4:mt();break;case 13:bo(c);break;case 19:G(bi);break;case 10:ta(c.type);break;case 22:case 23:bo(c),Qe(),o!==null&&G(vo);break;case 24:ta(Wn)}}function Ih(o,c){try{var h=c.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var y=g.next;h=y;do{if((h.tag&o)===o){g=void 0;var A=h.create,B=h.inst;g=A(),B.destroy=g}h=h.next}while(h!==y)}}catch(W){Dn(c,c.return,W)}}function ll(o,c,h){try{var g=c.updateQueue,y=g!==null?g.lastEffect:null;if(y!==null){var A=y.next;g=A;do{if((g.tag&o)===o){var B=g.inst,W=B.destroy;if(W!==void 0){B.destroy=void 0,y=c;var ht=h,Mt=W;try{Mt()}catch(Vt){Dn(y,ht,Vt)}}}g=g.next}while(g!==A)}}catch(Vt){Dn(c,c.return,Vt)}}function hE(o){var c=o.updateQueue;if(c!==null){var h=o.stateNode;try{Ne(c,h)}catch(g){Dn(o,o.return,g)}}}function dE(o,c,h){h.props=lc(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(g){Dn(o,c,g)}}function Mh(o,c){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var g=o.stateNode;break;case 30:g=o.stateNode;break;default:g=o.stateNode}typeof h=="function"?o.refCleanup=h(g):h.current=g}}catch(y){Dn(o,c,y)}}function Ca(o,c){var h=o.ref,g=o.refCleanup;if(h!==null)if(typeof g=="function")try{g()}catch(y){Dn(o,c,y)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(y){Dn(o,c,y)}else h.current=null}function pE(o){var c=o.type,h=o.memoizedProps,g=o.stateNode;try{t:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&g.focus();break t;case"img":h.src?g.src=h.src:h.srcSet&&(g.srcset=h.srcSet)}}catch(y){Dn(o,o.return,y)}}function Xv(o,c,h){try{var g=o.stateNode;BN(g,o.type,h,c),g[ri]=c}catch(y){Dn(o,o.return,y)}}function mE(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&gl(o.type)||o.tag===4}function Kv(o){t:for(;;){for(;o.sibling===null;){if(o.return===null||mE(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&gl(o.type)||o.flags&2||o.child===null||o.tag===4)continue t;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Zv(o,c,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(o),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=P0));else if(g!==4&&(g===27&&gl(o.type)&&(h=o.stateNode,c=null),o=o.child,o!==null))for(Zv(o,c,h),o=o.sibling;o!==null;)Zv(o,c,h),o=o.sibling}function S0(o,c,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?h.insertBefore(o,c):h.appendChild(o);else if(g!==4&&(g===27&&gl(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(S0(o,c,h),o=o.sibling;o!==null;)S0(o,c,h),o=o.sibling}function gE(o){var c=o.stateNode,h=o.memoizedProps;try{for(var g=o.type,y=c.attributes;y.length;)c.removeAttributeNode(y[0]);Fi(c,g,h),c[ii]=o,c[ri]=h}catch(A){Dn(o,o.return,A)}}var wo=!1,Qn=!1,Qv=!1,vE=typeof WeakSet=="function"?WeakSet:Set,Si=null;function _N(o,c){if(o=o.containerInfo,E1=$0,o=Kf(o),ou(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else t:{h=(h=o.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var y=g.anchorOffset,A=g.focusNode;g=g.focusOffset;try{h.nodeType,A.nodeType}catch{h=null;break t}var B=0,W=-1,ht=-1,Mt=0,Vt=0,Kt=o,Ut=null;e:for(;;){for(var zt;Kt!==h||y!==0&&Kt.nodeType!==3||(W=B+y),Kt!==A||g!==0&&Kt.nodeType!==3||(ht=B+g),Kt.nodeType===3&&(B+=Kt.nodeValue.length),(zt=Kt.firstChild)!==null;)Ut=Kt,Kt=zt;for(;;){if(Kt===o)break e;if(Ut===h&&++Mt===y&&(W=B),Ut===A&&++Vt===g&&(ht=B),(zt=Kt.nextSibling)!==null)break;Kt=Ut,Ut=Kt.parentNode}Kt=zt}h=W===-1||ht===-1?null:{start:W,end:ht}}else h=null}h=h||{start:0,end:0}}else h=null;for(w1={focusedElem:o,selectionRange:h},$0=!1,Si=c;Si!==null;)if(c=Si,o=c.child,(c.subtreeFlags&1024)!==0&&o!==null)o.return=c,Si=o;else for(;Si!==null;){switch(c=Si,A=c.alternate,o=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&A!==null){o=void 0,h=c,y=A.memoizedProps,A=A.memoizedState,g=h.stateNode;try{var Me=lc(h.type,y,h.elementType===h.type);o=g.getSnapshotBeforeUpdate(Me,A),g.__reactInternalSnapshotBeforeUpdate=o}catch(Ce){Dn(h,h.return,Ce)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,h=o.nodeType,h===9)T1(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":T1(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(i(163))}if(o=c.sibling,o!==null){o.return=c.return,Si=o;break}Si=c.return}}function _E(o,c,h){var g=h.flags;switch(h.tag){case 0:case 11:case 15:cl(o,h),g&4&&Ih(5,h);break;case 1:if(cl(o,h),g&4)if(o=h.stateNode,c===null)try{o.componentDidMount()}catch(B){Dn(h,h.return,B)}else{var y=lc(h.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(y,c,o.__reactInternalSnapshotBeforeUpdate)}catch(B){Dn(h,h.return,B)}}g&64&&hE(h),g&512&&Mh(h,h.return);break;case 3:if(cl(o,h),g&64&&(o=h.updateQueue,o!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{Ne(o,c)}catch(B){Dn(h,h.return,B)}}break;case 27:c===null&&g&4&&gE(h);case 26:case 5:cl(o,h),c===null&&g&4&&pE(h),g&512&&Mh(h,h.return);break;case 12:cl(o,h);break;case 13:cl(o,h),g&4&&yE(o,h),g&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=CN.bind(null,h),VN(o,h))));break;case 22:if(g=h.memoizedState!==null||wo,!g){c=c!==null&&c.memoizedState!==null||Qn,y=wo;var A=Qn;wo=g,(Qn=c)&&!A?ul(o,h,(h.subtreeFlags&8772)!==0):cl(o,h),wo=y,Qn=A}break;case 30:break;default:cl(o,h)}}function xE(o){var c=o.alternate;c!==null&&(o.alternate=null,xE(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&et(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Mn=null,Br=!1;function Ao(o,c,h){for(h=h.child;h!==null;)bE(o,c,h),h=h.sibling}function bE(o,c,h){if(ae&&typeof ae.onCommitFiberUnmount=="function")try{ae.onCommitFiberUnmount(te,h)}catch{}switch(h.tag){case 26:Qn||Ca(h,c),Ao(o,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Qn||Ca(h,c);var g=Mn,y=Br;gl(h.type)&&(Mn=h.stateNode,Br=!1),Ao(o,c,h),Gh(h.stateNode),Mn=g,Br=y;break;case 5:Qn||Ca(h,c);case 6:if(g=Mn,y=Br,Mn=null,Ao(o,c,h),Mn=g,Br=y,Mn!==null)if(Br)try{(Mn.nodeType===9?Mn.body:Mn.nodeName==="HTML"?Mn.ownerDocument.body:Mn).removeChild(h.stateNode)}catch(A){Dn(h,c,A)}else try{Mn.removeChild(h.stateNode)}catch(A){Dn(h,c,A)}break;case 18:Mn!==null&&(Br?(o=Mn,lw(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),Qh(o)):lw(Mn,h.stateNode));break;case 4:g=Mn,y=Br,Mn=h.stateNode.containerInfo,Br=!0,Ao(o,c,h),Mn=g,Br=y;break;case 0:case 11:case 14:case 15:Qn||ll(2,h,c),Qn||ll(4,h,c),Ao(o,c,h);break;case 1:Qn||(Ca(h,c),g=h.stateNode,typeof g.componentWillUnmount=="function"&&dE(h,c,g)),Ao(o,c,h);break;case 21:Ao(o,c,h);break;case 22:Qn=(g=Qn)||h.memoizedState!==null,Ao(o,c,h),Qn=g;break;default:Ao(o,c,h)}}function yE(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Qh(o)}catch(h){Dn(c,c.return,h)}}function xN(o){switch(o.tag){case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new vE),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new vE),c;default:throw Error(i(435,o.tag))}}function Jv(o,c){var h=xN(o);c.forEach(function(g){var y=DN.bind(null,o,g);h.has(g)||(h.add(g),g.then(y,y))})}function Qr(o,c){var h=c.deletions;if(h!==null)for(var g=0;g<h.length;g++){var y=h[g],A=o,B=c,W=B;t:for(;W!==null;){switch(W.tag){case 27:if(gl(W.type)){Mn=W.stateNode,Br=!1;break t}break;case 5:Mn=W.stateNode,Br=!1;break t;case 3:case 4:Mn=W.stateNode.containerInfo,Br=!0;break t}W=W.return}if(Mn===null)throw Error(i(160));bE(A,B,y),Mn=null,Br=!1,A=y.alternate,A!==null&&(A.return=null),y.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)EE(c,o),c=c.sibling}var ea=null;function EE(o,c){var h=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Qr(c,o),Jr(o),g&4&&(ll(3,o,o.return),Ih(3,o),ll(5,o,o.return));break;case 1:Qr(c,o),Jr(o),g&512&&(Qn||h===null||Ca(h,h.return)),g&64&&wo&&(o=o.updateQueue,o!==null&&(g=o.callbacks,g!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?g:h.concat(g))));break;case 26:var y=ea;if(Qr(c,o),Jr(o),g&512&&(Qn||h===null||Ca(h,h.return)),g&4){var A=h!==null?h.memoizedState:null;if(g=o.memoizedState,h===null)if(g===null)if(o.stateNode===null){t:{g=o.type,h=o.memoizedProps,y=y.ownerDocument||y;e:switch(g){case"title":A=y.getElementsByTagName("title")[0],(!A||A[Z]||A[ii]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=y.createElement(g),y.head.insertBefore(A,y.querySelector("head > title"))),Fi(A,g,h),A[ii]=o,Et(A),g=A;break t;case"link":var B=gw("link","href",y).get(g+(h.href||""));if(B){for(var W=0;W<B.length;W++)if(A=B[W],A.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&A.getAttribute("rel")===(h.rel==null?null:h.rel)&&A.getAttribute("title")===(h.title==null?null:h.title)&&A.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){B.splice(W,1);break e}}A=y.createElement(g),Fi(A,g,h),y.head.appendChild(A);break;case"meta":if(B=gw("meta","content",y).get(g+(h.content||""))){for(W=0;W<B.length;W++)if(A=B[W],A.getAttribute("content")===(h.content==null?null:""+h.content)&&A.getAttribute("name")===(h.name==null?null:h.name)&&A.getAttribute("property")===(h.property==null?null:h.property)&&A.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&A.getAttribute("charset")===(h.charSet==null?null:h.charSet)){B.splice(W,1);break e}}A=y.createElement(g),Fi(A,g,h),y.head.appendChild(A);break;default:throw Error(i(468,g))}A[ii]=o,Et(A),g=A}o.stateNode=g}else vw(y,o.type,o.stateNode);else o.stateNode=mw(y,g,o.memoizedProps);else A!==g?(A===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):A.count--,g===null?vw(y,o.type,o.stateNode):mw(y,g,o.memoizedProps)):g===null&&o.stateNode!==null&&Xv(o,o.memoizedProps,h.memoizedProps)}break;case 27:Qr(c,o),Jr(o),g&512&&(Qn||h===null||Ca(h,h.return)),h!==null&&g&4&&Xv(o,o.memoizedProps,h.memoizedProps);break;case 5:if(Qr(c,o),Jr(o),g&512&&(Qn||h===null||Ca(h,h.return)),o.flags&32){y=o.stateNode;try{Yr(y,"")}catch(zt){Dn(o,o.return,zt)}}g&4&&o.stateNode!=null&&(y=o.memoizedProps,Xv(o,y,h!==null?h.memoizedProps:y)),g&1024&&(Qv=!0);break;case 6:if(Qr(c,o),Jr(o),g&4){if(o.stateNode===null)throw Error(i(162));g=o.memoizedProps,h=o.stateNode;try{h.nodeValue=g}catch(zt){Dn(o,o.return,zt)}}break;case 3:if(z0=null,y=ea,ea=B0(c.containerInfo),Qr(c,o),ea=y,Jr(o),g&4&&h!==null&&h.memoizedState.isDehydrated)try{Qh(c.containerInfo)}catch(zt){Dn(o,o.return,zt)}Qv&&(Qv=!1,wE(o));break;case 4:g=ea,ea=B0(o.stateNode.containerInfo),Qr(c,o),Jr(o),ea=g;break;case 12:Qr(c,o),Jr(o);break;case 13:Qr(c,o),Jr(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(s1=Y()),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,Jv(o,g)));break;case 22:y=o.memoizedState!==null;var ht=h!==null&&h.memoizedState!==null,Mt=wo,Vt=Qn;if(wo=Mt||y,Qn=Vt||ht,Qr(c,o),Qn=Vt,wo=Mt,Jr(o),g&8192)t:for(c=o.stateNode,c._visibility=y?c._visibility&-2:c._visibility|1,y&&(h===null||ht||wo||Qn||cc(o)),h=null,c=o;;){if(c.tag===5||c.tag===26){if(h===null){ht=h=c;try{if(A=ht.stateNode,y)B=A.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none";else{W=ht.stateNode;var Kt=ht.memoizedProps.style,Ut=Kt!=null&&Kt.hasOwnProperty("display")?Kt.display:null;W.style.display=Ut==null||typeof Ut=="boolean"?"":(""+Ut).trim()}}catch(zt){Dn(ht,ht.return,zt)}}}else if(c.tag===6){if(h===null){ht=c;try{ht.stateNode.nodeValue=y?"":ht.memoizedProps}catch(zt){Dn(ht,ht.return,zt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break t;for(;c.sibling===null;){if(c.return===null||c.return===o)break t;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}g&4&&(g=o.updateQueue,g!==null&&(h=g.retryQueue,h!==null&&(g.retryQueue=null,Jv(o,h))));break;case 19:Qr(c,o),Jr(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,Jv(o,g)));break;case 30:break;case 21:break;default:Qr(c,o),Jr(o)}}function Jr(o){var c=o.flags;if(c&2){try{for(var h,g=o.return;g!==null;){if(mE(g)){h=g;break}g=g.return}if(h==null)throw Error(i(160));switch(h.tag){case 27:var y=h.stateNode,A=Kv(o);S0(o,A,y);break;case 5:var B=h.stateNode;h.flags&32&&(Yr(B,""),h.flags&=-33);var W=Kv(o);S0(o,W,B);break;case 3:case 4:var ht=h.stateNode.containerInfo,Mt=Kv(o);Zv(o,Mt,ht);break;default:throw Error(i(161))}}catch(Vt){Dn(o,o.return,Vt)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function wE(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;wE(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function cl(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)_E(o,c.alternate,c),c=c.sibling}function cc(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:ll(4,c,c.return),cc(c);break;case 1:Ca(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&dE(c,c.return,h),cc(c);break;case 27:Gh(c.stateNode);case 26:case 5:Ca(c,c.return),cc(c);break;case 22:c.memoizedState===null&&cc(c);break;case 30:cc(c);break;default:cc(c)}o=o.sibling}}function ul(o,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var g=c.alternate,y=o,A=c,B=A.flags;switch(A.tag){case 0:case 11:case 15:ul(y,A,h),Ih(4,A);break;case 1:if(ul(y,A,h),g=A,y=g.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Mt){Dn(g,g.return,Mt)}if(g=A,y=g.updateQueue,y!==null){var W=g.stateNode;try{var ht=y.shared.hiddenCallbacks;if(ht!==null)for(y.shared.hiddenCallbacks=null,y=0;y<ht.length;y++)Fe(ht[y],W)}catch(Mt){Dn(g,g.return,Mt)}}h&&B&64&&hE(A),Mh(A,A.return);break;case 27:gE(A);case 26:case 5:ul(y,A,h),h&&g===null&&B&4&&pE(A),Mh(A,A.return);break;case 12:ul(y,A,h);break;case 13:ul(y,A,h),h&&B&4&&yE(y,A);break;case 22:A.memoizedState===null&&ul(y,A,h),Mh(A,A.return);break;case 30:break;default:ul(y,A,h)}c=c.sibling}}function t1(o,c){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&rl(h))}function e1(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&rl(o))}function Da(o,c,h,g){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)AE(o,c,h,g),c=c.sibling}function AE(o,c,h,g){var y=c.flags;switch(c.tag){case 0:case 11:case 15:Da(o,c,h,g),y&2048&&Ih(9,c);break;case 1:Da(o,c,h,g);break;case 3:Da(o,c,h,g),y&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&rl(o)));break;case 12:if(y&2048){Da(o,c,h,g),o=c.stateNode;try{var A=c.memoizedProps,B=A.id,W=A.onPostCommit;typeof W=="function"&&W(B,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(ht){Dn(c,c.return,ht)}}else Da(o,c,h,g);break;case 13:Da(o,c,h,g);break;case 23:break;case 22:A=c.stateNode,B=c.alternate,c.memoizedState!==null?A._visibility&2?Da(o,c,h,g):Ph(o,c):A._visibility&2?Da(o,c,h,g):(A._visibility|=2,wu(o,c,h,g,(c.subtreeFlags&10256)!==0)),y&2048&&t1(B,c);break;case 24:Da(o,c,h,g),y&2048&&e1(c.alternate,c);break;default:Da(o,c,h,g)}}function wu(o,c,h,g,y){for(y=y&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=o,B=c,W=h,ht=g,Mt=B.flags;switch(B.tag){case 0:case 11:case 15:wu(A,B,W,ht,y),Ih(8,B);break;case 23:break;case 22:var Vt=B.stateNode;B.memoizedState!==null?Vt._visibility&2?wu(A,B,W,ht,y):Ph(A,B):(Vt._visibility|=2,wu(A,B,W,ht,y)),y&&Mt&2048&&t1(B.alternate,B);break;case 24:wu(A,B,W,ht,y),y&&Mt&2048&&e1(B.alternate,B);break;default:wu(A,B,W,ht,y)}c=c.sibling}}function Ph(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=o,g=c,y=g.flags;switch(g.tag){case 22:Ph(h,g),y&2048&&t1(g.alternate,g);break;case 24:Ph(h,g),y&2048&&e1(g.alternate,g);break;default:Ph(h,g)}c=c.sibling}}var Fh=8192;function Au(o){if(o.subtreeFlags&Fh)for(o=o.child;o!==null;)SE(o),o=o.sibling}function SE(o){switch(o.tag){case 26:Au(o),o.flags&Fh&&o.memoizedState!==null&&rk(ea,o.memoizedState,o.memoizedProps);break;case 5:Au(o);break;case 3:case 4:var c=ea;ea=B0(o.stateNode.containerInfo),Au(o),ea=c;break;case 22:o.memoizedState===null&&(c=o.alternate,c!==null&&c.memoizedState!==null?(c=Fh,Fh=16777216,Au(o),Fh=c):Au(o));break;default:Au(o)}}function TE(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function Bh(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var g=c[h];Si=g,DE(g,o)}TE(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)CE(o),o=o.sibling}function CE(o){switch(o.tag){case 0:case 11:case 15:Bh(o),o.flags&2048&&ll(9,o,o.return);break;case 3:Bh(o);break;case 12:Bh(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,T0(o)):Bh(o);break;default:Bh(o)}}function T0(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var g=c[h];Si=g,DE(g,o)}TE(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:ll(8,c,c.return),T0(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,T0(c));break;default:T0(c)}o=o.sibling}}function DE(o,c){for(;Si!==null;){var h=Si;switch(h.tag){case 0:case 11:case 15:ll(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var g=h.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:rl(h.memoizedState.cache)}if(g=h.child,g!==null)g.return=h,Si=g;else t:for(h=o;Si!==null;){g=Si;var y=g.sibling,A=g.return;if(xE(g),g===h){Si=null;break t}if(y!==null){y.return=A,Si=y;break t}Si=A}}}var bN={getCacheForType:function(o){var c=gi(Wn),h=c.data.get(o);return h===void 0&&(h=o(),c.data.set(o,h)),h}},yN=typeof WeakMap=="function"?WeakMap:Map,gn=0,kn=null,qe=null,tn=0,vn=0,ts=null,fl=!1,Su=!1,n1=!1,So=0,qn=0,hl=0,uc=0,i1=0,Cs=0,Tu=0,Uh=null,Ur=null,r1=!1,s1=0,C0=1/0,D0=null,dl=null,Pi=0,pl=null,Cu=null,Du=0,a1=0,o1=null,OE=null,zh=0,l1=null;function es(){if((gn&2)!==0&&tn!==0)return tn&-tn;if(Q.T!==null){var o=Ir;return o!==0?o:m1()}return Zc()}function RE(){Cs===0&&(Cs=(tn&536870912)===0||an?Gs():536870912);var o=Ts.current;return o!==null&&(o.flags|=32),Cs}function ns(o,c,h){(o===kn&&(vn===2||vn===9)||o.cancelPendingCommit!==null)&&(Ou(o,0),ml(o,tn,Cs,!1)),wi(o,h),((gn&2)===0||o!==kn)&&(o===kn&&((gn&2)===0&&(uc|=h),qn===4&&ml(o,tn,Cs,!1)),Oa(o))}function NE(o,c,h){if((gn&6)!==0)throw Error(i(327));var g=!h&&(c&124)===0&&(c&o.expiredLanes)===0||mi(o,c),y=g?AN(o,c):f1(o,c,!0),A=g;do{if(y===0){Su&&!g&&ml(o,c,0,!1);break}else{if(h=o.current.alternate,A&&!EN(h)){y=f1(o,c,!1),A=!1;continue}if(y===2){if(A=c,o.errorRecoveryDisabledLanes&A)var B=0;else B=o.pendingLanes&-536870913,B=B!==0?B:B&536870912?536870912:0;if(B!==0){c=B;t:{var W=o;y=Uh;var ht=W.current.memoizedState.isDehydrated;if(ht&&(Ou(W,B).flags|=256),B=f1(W,B,!1),B!==2){if(n1&&!ht){W.errorRecoveryDisabledLanes|=A,uc|=A,y=4;break t}A=Ur,Ur=y,A!==null&&(Ur===null?Ur=A:Ur.push.apply(Ur,A))}y=B}if(A=!1,y!==2)continue}}if(y===1){Ou(o,0),ml(o,c,0,!0);break}t:{switch(g=o,A=y,A){case 0:case 1:throw Error(i(345));case 4:if((c&4194048)!==c)break;case 6:ml(g,c,Cs,!fl);break t;case 2:Ur=null;break;case 3:case 5:break;default:throw Error(i(329))}if((c&62914560)===c&&(y=s1+300-Y(),10<y)){if(ml(g,c,Cs,!fl),bn(g,0,!0)!==0)break t;g.timeoutHandle=aw(kE.bind(null,g,h,Ur,D0,r1,c,Cs,uc,Tu,fl,A,2,-0,0),y);break t}kE(g,h,Ur,D0,r1,c,Cs,uc,Tu,fl,A,0,-0,0)}}break}while(!0);Oa(o)}function kE(o,c,h,g,y,A,B,W,ht,Mt,Vt,Kt,Ut,zt){if(o.timeoutHandle=-1,Kt=c.subtreeFlags,(Kt&8192||(Kt&16785408)===16785408)&&(qh={stylesheets:null,count:0,unsuspend:ik},SE(c),Kt=sk(),Kt!==null)){o.cancelPendingCommit=Kt(UE.bind(null,o,c,A,h,g,y,B,W,ht,Vt,1,Ut,zt)),ml(o,A,B,!Mt);return}UE(o,c,A,h,g,y,B,W,ht)}function EN(o){for(var c=o;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var g=0;g<h.length;g++){var y=h[g],A=y.getSnapshot;y=y.value;try{if(!Wi(A(),y))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ml(o,c,h,g){c&=~i1,c&=~uc,o.suspendedLanes|=c,o.pingedLanes&=~c,g&&(o.warmLanes|=c),g=o.expirationTimes;for(var y=c;0<y;){var A=31-Re(y),B=1<<A;g[A]=-1,y&=~B}h!==0&&zl(o,h,c)}function O0(){return(gn&6)===0?(jh(0),!1):!0}function c1(){if(qe!==null){if(vn===0)var o=qe.return;else o=qe,Js=ho=null,Ss(o),yu=null,Nh=0,o=qe;for(;o!==null;)fE(o.alternate,o),o=o.return;qe=null}}function Ou(o,c){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,zN(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),c1(),kn=o,qe=h=Xs(o.current,null),tn=c,vn=0,ts=null,fl=!1,Su=mi(o,c),n1=!1,Tu=Cs=i1=uc=hl=qn=0,Ur=Uh=null,r1=!1,(c&8)!==0&&(c|=c&32);var g=o.entangledLanes;if(g!==0)for(o=o.entanglements,g&=c;0<g;){var y=31-Re(g),A=1<<y;c|=o[y],g&=~A}return So=c,lu(),h}function LE(o,c){ue=null,Q.H=g0,c===sl||c===_o?(c=k(),vn=3):c===ac?(c=k(),vn=4):vn=c===Zy?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,ts=c,qe===null&&(qn=1,y0(o,pr(c,o.current)))}function IE(){var o=Q.H;return Q.H=g0,o===null?g0:o}function ME(){var o=Q.A;return Q.A=bN,o}function u1(){qn=4,fl||(tn&4194048)!==tn&&Ts.current!==null||(Su=!0),(hl&134217727)===0&&(uc&134217727)===0||kn===null||ml(kn,tn,Cs,!1)}function f1(o,c,h){var g=gn;gn|=2;var y=IE(),A=ME();(kn!==o||tn!==c)&&(D0=null,Ou(o,c)),c=!1;var B=qn;t:do try{if(vn!==0&&qe!==null){var W=qe,ht=ts;switch(vn){case 8:c1(),B=6;break t;case 3:case 2:case 9:case 6:Ts.current===null&&(c=!0);var Mt=vn;if(vn=0,ts=null,Ru(o,W,ht,Mt),h&&Su){B=0;break t}break;default:Mt=vn,vn=0,ts=null,Ru(o,W,ht,Mt)}}wN(),B=qn;break}catch(Vt){LE(o,Vt)}while(!0);return c&&o.shellSuspendCounter++,Js=ho=null,gn=g,Q.H=y,Q.A=A,qe===null&&(kn=null,tn=0,lu()),B}function wN(){for(;qe!==null;)PE(qe)}function AN(o,c){var h=gn;gn|=2;var g=IE(),y=ME();kn!==o||tn!==c?(D0=null,C0=Y()+500,Ou(o,c)):Su=mi(o,c);t:do try{if(vn!==0&&qe!==null){c=qe;var A=ts;e:switch(vn){case 1:vn=0,ts=null,Ru(o,c,A,1);break;case 2:case 9:if(l0(A)){vn=0,ts=null,FE(c);break}c=function(){vn!==2&&vn!==9||kn!==o||(vn=7),Oa(o)},A.then(c,c);break t;case 3:vn=7;break t;case 4:vn=5;break t;case 7:l0(A)?(vn=0,ts=null,FE(c)):(vn=0,ts=null,Ru(o,c,A,7));break;case 5:var B=null;switch(qe.tag){case 26:B=qe.memoizedState;case 5:case 27:var W=qe;if(!B||_w(B)){vn=0,ts=null;var ht=W.sibling;if(ht!==null)qe=ht;else{var Mt=W.return;Mt!==null?(qe=Mt,R0(Mt)):qe=null}break e}}vn=0,ts=null,Ru(o,c,A,5);break;case 6:vn=0,ts=null,Ru(o,c,A,6);break;case 8:c1(),qn=6;break t;default:throw Error(i(462))}}SN();break}catch(Vt){LE(o,Vt)}while(!0);return Js=ho=null,Q.H=g,Q.A=y,gn=h,qe!==null?0:(kn=null,tn=0,lu(),qn)}function SN(){for(;qe!==null&&!dt();)PE(qe)}function PE(o){var c=cE(o.alternate,o,So);o.memoizedProps=o.pendingProps,c===null?R0(o):qe=c}function FE(o){var c=o,h=c.alternate;switch(c.tag){case 15:case 0:c=iE(h,c,c.pendingProps,c.type,void 0,tn);break;case 11:c=iE(h,c,c.pendingProps,c.type.render,c.ref,tn);break;case 5:Ss(c);default:fE(h,c),c=qe=e0(c,So),c=cE(h,c,So)}o.memoizedProps=o.pendingProps,c===null?R0(o):qe=c}function Ru(o,c,h,g){Js=ho=null,Ss(c),yu=null,Nh=0;var y=c.return;try{if(pN(o,y,c,h,tn)){qn=1,y0(o,pr(h,o.current)),qe=null;return}}catch(A){if(y!==null)throw qe=y,A;qn=1,y0(o,pr(h,o.current)),qe=null;return}c.flags&32768?(an||g===1?o=!0:Su||(tn&536870912)!==0?o=!1:(fl=o=!0,(g===2||g===9||g===3||g===6)&&(g=Ts.current,g!==null&&g.tag===13&&(g.flags|=16384))),BE(c,o)):R0(c)}function R0(o){var c=o;do{if((c.flags&32768)!==0){BE(c,fl);return}o=c.return;var h=gN(c.alternate,c,So);if(h!==null){qe=h;return}if(c=c.sibling,c!==null){qe=c;return}qe=c=o}while(c!==null);qn===0&&(qn=5)}function BE(o,c){do{var h=vN(o.alternate,o);if(h!==null){h.flags&=32767,qe=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(o=o.sibling,o!==null)){qe=o;return}qe=o=h}while(o!==null);qn=6,qe=null}function UE(o,c,h,g,y,A,B,W,ht){o.cancelPendingCommit=null;do N0();while(Pi!==0);if((gn&6)!==0)throw Error(i(327));if(c!==null){if(c===o.current)throw Error(i(177));if(A=c.lanes|c.childLanes,A|=ih,Or(o,h,A,B,W,ht),o===kn&&(qe=kn=null,tn=0),Cu=c,pl=o,Du=h,a1=A,o1=y,OE=g,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,ON(jt,function(){return GE(),null})):(o.callbackNode=null,o.callbackPriority=0),g=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||g){g=Q.T,Q.T=null,y=X.p,X.p=2,B=gn,gn|=4;try{_N(o,c,h)}finally{gn=B,X.p=y,Q.T=g}}Pi=1,zE(),jE(),HE()}}function zE(){if(Pi===1){Pi=0;var o=pl,c=Cu,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=Q.T,Q.T=null;var g=X.p;X.p=2;var y=gn;gn|=4;try{EE(c,o);var A=w1,B=Kf(o.containerInfo),W=A.focusedElem,ht=A.selectionRange;if(B!==W&&W&&W.ownerDocument&&Xp(W.ownerDocument.documentElement,W)){if(ht!==null&&ou(W)){var Mt=ht.start,Vt=ht.end;if(Vt===void 0&&(Vt=Mt),"selectionStart"in W)W.selectionStart=Mt,W.selectionEnd=Math.min(Vt,W.value.length);else{var Kt=W.ownerDocument||document,Ut=Kt&&Kt.defaultView||window;if(Ut.getSelection){var zt=Ut.getSelection(),Me=W.textContent.length,Ce=Math.min(ht.start,Me),wn=ht.end===void 0?Ce:Math.min(ht.end,Me);!zt.extend&&Ce>wn&&(B=wn,wn=Ce,Ce=B);var Tt=Yp(W,Ce),xt=Yp(W,wn);if(Tt&&xt&&(zt.rangeCount!==1||zt.anchorNode!==Tt.node||zt.anchorOffset!==Tt.offset||zt.focusNode!==xt.node||zt.focusOffset!==xt.offset)){var kt=Kt.createRange();kt.setStart(Tt.node,Tt.offset),zt.removeAllRanges(),Ce>wn?(zt.addRange(kt),zt.extend(xt.node,xt.offset)):(kt.setEnd(xt.node,xt.offset),zt.addRange(kt))}}}}for(Kt=[],zt=W;zt=zt.parentNode;)zt.nodeType===1&&Kt.push({element:zt,left:zt.scrollLeft,top:zt.scrollTop});for(typeof W.focus=="function"&&W.focus(),W=0;W<Kt.length;W++){var Yt=Kt[W];Yt.element.scrollLeft=Yt.left,Yt.element.scrollTop=Yt.top}}$0=!!E1,w1=E1=null}finally{gn=y,X.p=g,Q.T=h}}o.current=c,Pi=2}}function jE(){if(Pi===2){Pi=0;var o=pl,c=Cu,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=Q.T,Q.T=null;var g=X.p;X.p=2;var y=gn;gn|=4;try{_E(o,c.alternate,c)}finally{gn=y,X.p=g,Q.T=h}}Pi=3}}function HE(){if(Pi===4||Pi===3){Pi=0,st();var o=pl,c=Cu,h=Du,g=OE;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Pi=5:(Pi=0,Cu=pl=null,$E(o,o.pendingLanes));var y=o.pendingLanes;if(y===0&&(dl=null),Hl(h),c=c.stateNode,ae&&typeof ae.onCommitFiberRoot=="function")try{ae.onCommitFiberRoot(te,c,void 0,(c.current.flags&128)===128)}catch{}if(g!==null){c=Q.T,y=X.p,X.p=2,Q.T=null;try{for(var A=o.onRecoverableError,B=0;B<g.length;B++){var W=g[B];A(W.value,{componentStack:W.stack})}}finally{Q.T=c,X.p=y}}(Du&3)!==0&&N0(),Oa(o),y=o.pendingLanes,(h&4194090)!==0&&(y&42)!==0?o===l1?zh++:(zh=0,l1=o):zh=0,jh(0)}}function $E(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,rl(c)))}function N0(o){return zE(),jE(),HE(),GE()}function GE(){if(Pi!==5)return!1;var o=pl,c=a1;a1=0;var h=Hl(Du),g=Q.T,y=X.p;try{X.p=32>h?32:h,Q.T=null,h=o1,o1=null;var A=pl,B=Du;if(Pi=0,Cu=pl=null,Du=0,(gn&6)!==0)throw Error(i(331));var W=gn;if(gn|=4,CE(A.current),AE(A,A.current,B,h),gn=W,jh(0,!1),ae&&typeof ae.onPostCommitFiberRoot=="function")try{ae.onPostCommitFiberRoot(te,A)}catch{}return!0}finally{X.p=y,Q.T=g,$E(o,c)}}function VE(o,c,h){c=pr(h,c),c=zv(o.stateNode,c,2),o=re(o,c,2),o!==null&&(wi(o,2),Oa(o))}function Dn(o,c,h){if(o.tag===3)VE(o,o,h);else for(;c!==null;){if(c.tag===3){VE(c,o,h);break}else if(c.tag===1){var g=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(dl===null||!dl.has(g))){o=pr(h,o),h=Xy(2),g=re(c,h,2),g!==null&&(Ky(h,g,c,o),wi(g,2),Oa(g));break}}c=c.return}}function h1(o,c,h){var g=o.pingCache;if(g===null){g=o.pingCache=new yN;var y=new Set;g.set(c,y)}else y=g.get(c),y===void 0&&(y=new Set,g.set(c,y));y.has(h)||(n1=!0,y.add(h),o=TN.bind(null,o,c,h),c.then(o,o))}function TN(o,c,h){var g=o.pingCache;g!==null&&g.delete(c),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,kn===o&&(tn&h)===h&&(qn===4||qn===3&&(tn&62914560)===tn&&300>Y()-s1?(gn&2)===0&&Ou(o,0):i1|=h,Tu===tn&&(Tu=0)),Oa(o)}function WE(o,c){c===0&&(c=Xa()),o=qi(o,c),o!==null&&(wi(o,c),Oa(o))}function CN(o){var c=o.memoizedState,h=0;c!==null&&(h=c.retryLane),WE(o,h)}function DN(o,c){var h=0;switch(o.tag){case 13:var g=o.stateNode,y=o.memoizedState;y!==null&&(h=y.retryLane);break;case 19:g=o.stateNode;break;case 22:g=o.stateNode._retryCache;break;default:throw Error(i(314))}g!==null&&g.delete(c),WE(o,h)}function ON(o,c){return Lt(o,c)}var k0=null,Nu=null,d1=!1,L0=!1,p1=!1,fc=0;function Oa(o){o!==Nu&&o.next===null&&(Nu===null?k0=Nu=o:Nu=Nu.next=o),L0=!0,d1||(d1=!0,NN())}function jh(o,c){if(!p1&&L0){p1=!0;do for(var h=!1,g=k0;g!==null;){if(o!==0){var y=g.pendingLanes;if(y===0)var A=0;else{var B=g.suspendedLanes,W=g.pingedLanes;A=(1<<31-Re(42|o)+1)-1,A&=y&~(B&~W),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(h=!0,KE(g,A))}else A=tn,A=bn(g,g===kn?A:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(A&3)===0||mi(g,A)||(h=!0,KE(g,A));g=g.next}while(h);p1=!1}}function RN(){qE()}function qE(){L0=d1=!1;var o=0;fc!==0&&(UN()&&(o=fc),fc=0);for(var c=Y(),h=null,g=k0;g!==null;){var y=g.next,A=YE(g,c);A===0?(g.next=null,h===null?k0=y:h.next=y,y===null&&(Nu=h)):(h=g,(o!==0||(A&3)!==0)&&(L0=!0)),g=y}jh(o)}function YE(o,c){for(var h=o.suspendedLanes,g=o.pingedLanes,y=o.expirationTimes,A=o.pendingLanes&-62914561;0<A;){var B=31-Re(A),W=1<<B,ht=y[B];ht===-1?((W&h)===0||(W&g)!==0)&&(y[B]=vs(W,c)):ht<=c&&(o.expiredLanes|=W),A&=~W}if(c=kn,h=tn,h=bn(o,o===c?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g=o.callbackNode,h===0||o===c&&(vn===2||vn===9)||o.cancelPendingCommit!==null)return g!==null&&g!==null&&D(g),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||mi(o,h)){if(c=h&-h,c===o.callbackPriority)return c;switch(g!==null&&D(g),Hl(h)){case 2:case 8:h=Pt;break;case 32:h=jt;break;case 268435456:h=Nt;break;default:h=jt}return g=XE.bind(null,o),h=Lt(h,g),o.callbackPriority=c,o.callbackNode=h,c}return g!==null&&g!==null&&D(g),o.callbackPriority=2,o.callbackNode=null,2}function XE(o,c){if(Pi!==0&&Pi!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(N0()&&o.callbackNode!==h)return null;var g=tn;return g=bn(o,o===kn?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g===0?null:(NE(o,g,c),YE(o,Y()),o.callbackNode!=null&&o.callbackNode===h?XE.bind(null,o):null)}function KE(o,c){if(N0())return null;NE(o,c,!0)}function NN(){jN(function(){(gn&6)!==0?Lt(ft,RN):qE()})}function m1(){return fc===0&&(fc=Gs()),fc}function ZE(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Jc(""+o)}function QE(o,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,o.id&&h.setAttribute("form",o.id),c.parentNode.insertBefore(h,c),o=new FormData(o),h.parentNode.removeChild(h),o}function kN(o,c,h,g,y){if(c==="submit"&&h&&h.stateNode===y){var A=ZE((y[ri]||null).action),B=g.submitter;B&&(c=(c=B[ri]||null)?ZE(c.formAction):B.getAttribute("formAction"),c!==null&&(A=c,B=null));var W=new Vo("action","action",null,g,y);o.push({event:W,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(fc!==0){var ht=B?QE(y,B):new FormData(y);Mv(h,{pending:!0,data:ht,method:y.method,action:A},null,ht)}}else typeof A=="function"&&(W.preventDefault(),ht=B?QE(y,B):new FormData(y),Mv(h,{pending:!0,data:ht,method:y.method,action:A},A,ht))},currentTarget:y}]})}}for(var g1=0;g1<nh.length;g1++){var v1=nh[g1],LN=v1.toLowerCase(),IN=v1[0].toUpperCase()+v1.slice(1);Xr(LN,"on"+IN)}Xr(_a,"onAnimationEnd"),Xr(ws,"onAnimationIteration"),Xr(Jf,"onAnimationStart"),Xr("dblclick","onDoubleClick"),Xr("focusin","onFocus"),Xr("focusout","onBlur"),Xr(Ov,"onTransitionRun"),Xr(Qp,"onTransitionStart"),Xr(Jp,"onTransitionCancel"),Xr(th,"onTransitionEnd"),ee("onMouseEnter",["mouseout","mouseover"]),ee("onMouseLeave",["mouseout","mouseover"]),ee("onPointerEnter",["pointerout","pointerover"]),ee("onPointerLeave",["pointerout","pointerover"]),Wt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Hh));function JE(o,c){c=(c&4)!==0;for(var h=0;h<o.length;h++){var g=o[h],y=g.event;g=g.listeners;t:{var A=void 0;if(c)for(var B=g.length-1;0<=B;B--){var W=g[B],ht=W.instance,Mt=W.currentTarget;if(W=W.listener,ht!==A&&y.isPropagationStopped())break t;A=W,y.currentTarget=Mt;try{A(y)}catch(Vt){b0(Vt)}y.currentTarget=null,A=ht}else for(B=0;B<g.length;B++){if(W=g[B],ht=W.instance,Mt=W.currentTarget,W=W.listener,ht!==A&&y.isPropagationStopped())break t;A=W,y.currentTarget=Mt;try{A(y)}catch(Vt){b0(Vt)}y.currentTarget=null,A=ht}}}}function Ye(o,c){var h=c[$l];h===void 0&&(h=c[$l]=new Set);var g=o+"__bubble";h.has(g)||(tw(c,o,2,!1),h.add(g))}function _1(o,c,h){var g=0;c&&(g|=4),tw(h,o,g,c)}var I0="_reactListening"+Math.random().toString(36).slice(2);function x1(o){if(!o[I0]){o[I0]=!0,Dt.forEach(function(h){h!=="selectionchange"&&(MN.has(h)||_1(h,!1,o),_1(h,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[I0]||(c[I0]=!0,_1("selectionchange",!1,c))}}function tw(o,c,h,g){switch(Aw(c)){case 2:var y=lk;break;case 8:y=ck;break;default:y=L1}h=y.bind(null,c,h,o),y=void 0,!ma||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(y=!0),g?y!==void 0?o.addEventListener(c,h,{capture:!0,passive:y}):o.addEventListener(c,h,!0):y!==void 0?o.addEventListener(c,h,{passive:y}):o.addEventListener(c,h,!1)}function b1(o,c,h,g,y){var A=g;if((c&1)===0&&(c&2)===0&&g!==null)t:for(;;){if(g===null)return;var B=g.tag;if(B===3||B===4){var W=g.stateNode.containerInfo;if(W===y)break;if(B===4)for(B=g.return;B!==null;){var ht=B.tag;if((ht===3||ht===4)&&B.stateNode.containerInfo===y)return;B=B.return}for(;W!==null;){if(B=it(W),B===null)return;if(ht=B.tag,ht===5||ht===6||ht===26||ht===27){g=A=B;continue t}W=W.parentNode}}g=g.return}jf(function(){var Mt=A,Vt=$o(h),Kt=[];t:{var Ut=eh.get(o);if(Ut!==void 0){var zt=Vo,Me=o;switch(o){case"keypress":if(nu(h)===0)break t;case"keydown":case"keyup":zt=Np;break;case"focusin":Me="focus",zt=iu;break;case"focusout":Me="blur",zt=iu;break;case"beforeblur":case"afterblur":zt=iu;break;case"click":if(h.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":zt=io;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":zt=wp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":zt=xv;break;case _a:case ws:case Jf:zt=Tp;break;case th:zt=bv;break;case"scroll":case"scrollend":zt=Ep;break;case"wheel":zt=Ev;break;case"copy":case"cut":case"paste":zt=Cp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":zt=ga;break;case"toggle":case"beforetoggle":zt=Ip}var Ce=(c&4)!==0,wn=!Ce&&(o==="scroll"||o==="scrollend"),Tt=Ce?Ut!==null?Ut+"Capture":null:Ut;Ce=[];for(var xt=Mt,kt;xt!==null;){var Yt=xt;if(kt=Yt.stateNode,Yt=Yt.tag,Yt!==5&&Yt!==26&&Yt!==27||kt===null||Tt===null||(Yt=Go(xt,Tt),Yt!=null&&Ce.push($h(xt,Yt,kt))),wn)break;xt=xt.return}0<Ce.length&&(Ut=new zt(Ut,Me,null,h,Vt),Kt.push({event:Ut,listeners:Ce}))}}if((c&7)===0){t:{if(Ut=o==="mouseover"||o==="pointerover",zt=o==="mouseout"||o==="pointerout",Ut&&h!==xs&&(Me=h.relatedTarget||h.fromElement)&&(it(Me)||Me[ha]))break t;if((zt||Ut)&&(Ut=Vt.window===Vt?Vt:(Ut=Vt.ownerDocument)?Ut.defaultView||Ut.parentWindow:window,zt?(Me=h.relatedTarget||h.toElement,zt=Mt,Me=Me?it(Me):null,Me!==null&&(wn=s(Me),Ce=Me.tag,Me!==wn||Ce!==5&&Ce!==27&&Ce!==6)&&(Me=null)):(zt=null,Me=Mt),zt!==Me)){if(Ce=io,Yt="onMouseLeave",Tt="onMouseEnter",xt="mouse",(o==="pointerout"||o==="pointerover")&&(Ce=ga,Yt="onPointerLeave",Tt="onPointerEnter",xt="pointer"),wn=zt==null?Ut:It(zt),kt=Me==null?Ut:It(Me),Ut=new Ce(Yt,xt+"leave",zt,h,Vt),Ut.target=wn,Ut.relatedTarget=kt,Yt=null,it(Vt)===Mt&&(Ce=new Ce(Tt,xt+"enter",Me,h,Vt),Ce.target=kt,Ce.relatedTarget=wn,Yt=Ce),wn=Yt,zt&&Me)e:{for(Ce=zt,Tt=Me,xt=0,kt=Ce;kt;kt=ku(kt))xt++;for(kt=0,Yt=Tt;Yt;Yt=ku(Yt))kt++;for(;0<xt-kt;)Ce=ku(Ce),xt--;for(;0<kt-xt;)Tt=ku(Tt),kt--;for(;xt--;){if(Ce===Tt||Tt!==null&&Ce===Tt.alternate)break e;Ce=ku(Ce),Tt=ku(Tt)}Ce=null}else Ce=null;zt!==null&&ew(Kt,Ut,zt,Ce,!1),Me!==null&&wn!==null&&ew(Kt,wn,Me,Ce,!0)}}t:{if(Ut=Mt?It(Mt):window,zt=Ut.nodeName&&Ut.nodeName.toLowerCase(),zt==="select"||zt==="input"&&Ut.type==="file")var pe=Hp;else if(zp(Ut))if(qf)pe=qp;else{pe=Vp;var We=Cv}else zt=Ut.nodeName,!zt||zt.toLowerCase()!=="input"||Ut.type!=="checkbox"&&Ut.type!=="radio"?Mt&&ql(Mt.elementType)&&(pe=Hp):pe=Wp;if(pe&&(pe=pe(o,Mt))){kr(Kt,pe,h,Vt);break t}We&&We(o,Ut,Mt),o==="focusout"&&Mt&&Ut.type==="number"&&Mt.memoizedProps.value!=null&&Vl(Ut,"number",Ut.value)}switch(We=Mt?It(Mt):window,o){case"focusin":(zp(We)||We.contentEditable==="true")&&(Zo=We,Zf=Mt,Jl=null);break;case"focusout":Jl=Zf=Zo=null;break;case"mousedown":Qf=!0;break;case"contextmenu":case"mouseup":case"dragend":Qf=!1,Kp(Kt,h,Vt);break;case"selectionchange":if(Dv)break;case"keydown":case"keyup":Kp(Kt,h,Vt)}var _e;if(Wf)t:{switch(o){case"compositionstart":var De="onCompositionStart";break t;case"compositionend":De="onCompositionEnd";break t;case"compositionupdate":De="onCompositionUpdate";break t}De=void 0}else qo?Bp(o,h)&&(De="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(De="onCompositionStart");De&&(Pp&&h.locale!=="ko"&&(qo||De!=="onCompositionStart"?De==="onCompositionEnd"&&qo&&(_e=eu()):(qs=Vt,Xl="value"in qs?qs.value:qs.textContent,qo=!0)),We=M0(Mt,De),0<We.length&&(De=new Dp(De,o,null,h,Vt),Kt.push({event:De,listeners:We}),_e?De.data=_e:(_e=Up(h),_e!==null&&(De.data=_e)))),(_e=ro?Av(o,h):Sv(o,h))&&(De=M0(Mt,"onBeforeInput"),0<De.length&&(We=new Dp("onBeforeInput","beforeinput",null,h,Vt),Kt.push({event:We,listeners:De}),We.data=_e)),kN(Kt,o,Mt,h,Vt)}JE(Kt,c)})}function $h(o,c,h){return{instance:o,listener:c,currentTarget:h}}function M0(o,c){for(var h=c+"Capture",g=[];o!==null;){var y=o,A=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||A===null||(y=Go(o,h),y!=null&&g.unshift($h(o,y,A)),y=Go(o,c),y!=null&&g.push($h(o,y,A))),o.tag===3)return g;o=o.return}return[]}function ku(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function ew(o,c,h,g,y){for(var A=c._reactName,B=[];h!==null&&h!==g;){var W=h,ht=W.alternate,Mt=W.stateNode;if(W=W.tag,ht!==null&&ht===g)break;W!==5&&W!==26&&W!==27||Mt===null||(ht=Mt,y?(Mt=Go(h,A),Mt!=null&&B.unshift($h(h,Mt,ht))):y||(Mt=Go(h,A),Mt!=null&&B.push($h(h,Mt,ht)))),h=h.return}B.length!==0&&o.push({event:c,listeners:B})}var PN=/\r\n?/g,FN=/\u0000|\uFFFD/g;function nw(o){return(typeof o=="string"?o:""+o).replace(PN,`
`).replace(FN,"")}function iw(o,c){return c=nw(c),nw(o)===c}function P0(){}function En(o,c,h,g,y,A){switch(h){case"children":typeof g=="string"?c==="body"||c==="textarea"&&g===""||Yr(o,g):(typeof g=="number"||typeof g=="bigint")&&c!=="body"&&Yr(o,""+g);break;case"className":Ze(o,"class",g);break;case"tabIndex":Ze(o,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Ze(o,h,g);break;case"style":Ka(o,g,A);break;case"data":if(c!=="object"){Ze(o,"data",g);break}case"src":case"href":if(g===""&&(c!=="a"||h!=="href")){o.removeAttribute(h);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(h);break}g=Jc(""+g),o.setAttribute(h,g);break;case"action":case"formAction":if(typeof g=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(h==="formAction"?(c!=="input"&&En(o,c,"name",y.name,y,null),En(o,c,"formEncType",y.formEncType,y,null),En(o,c,"formMethod",y.formMethod,y,null),En(o,c,"formTarget",y.formTarget,y,null)):(En(o,c,"encType",y.encType,y,null),En(o,c,"method",y.method,y,null),En(o,c,"target",y.target,y,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(h);break}g=Jc(""+g),o.setAttribute(h,g);break;case"onClick":g!=null&&(o.onclick=P0);break;case"onScroll":g!=null&&Ye("scroll",o);break;case"onScrollEnd":g!=null&&Ye("scrollend",o);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(i(61));if(h=g.__html,h!=null){if(y.children!=null)throw Error(i(60));o.innerHTML=h}}break;case"multiple":o.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":o.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){o.removeAttribute("xlink:href");break}h=Jc(""+g),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,""+g):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":g===!0?o.setAttribute(h,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,g):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?o.setAttribute(h,g):o.removeAttribute(h);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?o.removeAttribute(h):o.setAttribute(h,g);break;case"popover":Ye("beforetoggle",o),Ye("toggle",o),sn(o,"popover",g);break;case"xlinkActuate":dn(o,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":dn(o,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":dn(o,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":dn(o,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":dn(o,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":dn(o,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":dn(o,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":dn(o,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":dn(o,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":sn(o,"is",g);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=bp.get(h)||h,sn(o,h,g))}}function y1(o,c,h,g,y,A){switch(h){case"style":Ka(o,g,A);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(i(61));if(h=g.__html,h!=null){if(y.children!=null)throw Error(i(60));o.innerHTML=h}}break;case"children":typeof g=="string"?Yr(o,g):(typeof g=="number"||typeof g=="bigint")&&Yr(o,""+g);break;case"onScroll":g!=null&&Ye("scroll",o);break;case"onScrollEnd":g!=null&&Ye("scrollend",o);break;case"onClick":g!=null&&(o.onclick=P0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ot.hasOwnProperty(h))t:{if(h[0]==="o"&&h[1]==="n"&&(y=h.endsWith("Capture"),c=h.slice(2,y?h.length-7:void 0),A=o[ri]||null,A=A!=null?A[h]:null,typeof A=="function"&&o.removeEventListener(c,A,y),typeof g=="function")){typeof A!="function"&&A!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(c,g,y);break t}h in o?o[h]=g:g===!0?o.setAttribute(h,""):sn(o,h,g)}}}function Fi(o,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ye("error",o),Ye("load",o);var g=!1,y=!1,A;for(A in h)if(h.hasOwnProperty(A)){var B=h[A];if(B!=null)switch(A){case"src":g=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:En(o,c,A,B,h,null)}}y&&En(o,c,"srcSet",h.srcSet,h,null),g&&En(o,c,"src",h.src,h,null);return;case"input":Ye("invalid",o);var W=A=B=y=null,ht=null,Mt=null;for(g in h)if(h.hasOwnProperty(g)){var Vt=h[g];if(Vt!=null)switch(g){case"name":y=Vt;break;case"type":B=Vt;break;case"checked":ht=Vt;break;case"defaultChecked":Mt=Vt;break;case"value":A=Vt;break;case"defaultValue":W=Vt;break;case"children":case"dangerouslySetInnerHTML":if(Vt!=null)throw Error(i(137,c));break;default:En(o,c,g,Vt,h,null)}}Qc(o,A,W,ht,Mt,B,y,!1),Gl(o);return;case"select":Ye("invalid",o),g=B=A=null;for(y in h)if(h.hasOwnProperty(y)&&(W=h[y],W!=null))switch(y){case"value":A=W;break;case"defaultValue":B=W;break;case"multiple":g=W;default:En(o,c,y,W,h,null)}c=A,h=B,o.multiple=!!g,c!=null?ki(o,!!g,c,!1):h!=null&&ki(o,!!g,h,!0);return;case"textarea":Ye("invalid",o),A=y=g=null;for(B in h)if(h.hasOwnProperty(B)&&(W=h[B],W!=null))switch(B){case"value":g=W;break;case"defaultValue":y=W;break;case"children":A=W;break;case"dangerouslySetInnerHTML":if(W!=null)throw Error(i(91));break;default:En(o,c,B,W,h,null)}Wl(o,g,y,A),Gl(o);return;case"option":for(ht in h)if(h.hasOwnProperty(ht)&&(g=h[ht],g!=null))switch(ht){case"selected":o.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:En(o,c,ht,g,h,null)}return;case"dialog":Ye("beforetoggle",o),Ye("toggle",o),Ye("cancel",o),Ye("close",o);break;case"iframe":case"object":Ye("load",o);break;case"video":case"audio":for(g=0;g<Hh.length;g++)Ye(Hh[g],o);break;case"image":Ye("error",o),Ye("load",o);break;case"details":Ye("toggle",o);break;case"embed":case"source":case"link":Ye("error",o),Ye("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Mt in h)if(h.hasOwnProperty(Mt)&&(g=h[Mt],g!=null))switch(Mt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,c));default:En(o,c,Mt,g,h,null)}return;default:if(ql(c)){for(Vt in h)h.hasOwnProperty(Vt)&&(g=h[Vt],g!==void 0&&y1(o,c,Vt,g,h,void 0));return}}for(W in h)h.hasOwnProperty(W)&&(g=h[W],g!=null&&En(o,c,W,g,h,null))}function BN(o,c,h,g){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,A=null,B=null,W=null,ht=null,Mt=null,Vt=null;for(zt in h){var Kt=h[zt];if(h.hasOwnProperty(zt)&&Kt!=null)switch(zt){case"checked":break;case"value":break;case"defaultValue":ht=Kt;default:g.hasOwnProperty(zt)||En(o,c,zt,null,g,Kt)}}for(var Ut in g){var zt=g[Ut];if(Kt=h[Ut],g.hasOwnProperty(Ut)&&(zt!=null||Kt!=null))switch(Ut){case"type":A=zt;break;case"name":y=zt;break;case"checked":Mt=zt;break;case"defaultChecked":Vt=zt;break;case"value":B=zt;break;case"defaultValue":W=zt;break;case"children":case"dangerouslySetInnerHTML":if(zt!=null)throw Error(i(137,c));break;default:zt!==Kt&&En(o,c,Ut,zt,g,Kt)}}Vi(o,B,W,ht,Mt,Vt,A,y);return;case"select":zt=B=W=Ut=null;for(A in h)if(ht=h[A],h.hasOwnProperty(A)&&ht!=null)switch(A){case"value":break;case"multiple":zt=ht;default:g.hasOwnProperty(A)||En(o,c,A,null,g,ht)}for(y in g)if(A=g[y],ht=h[y],g.hasOwnProperty(y)&&(A!=null||ht!=null))switch(y){case"value":Ut=A;break;case"defaultValue":W=A;break;case"multiple":B=A;default:A!==ht&&En(o,c,y,A,g,ht)}c=W,h=B,g=zt,Ut!=null?ki(o,!!h,Ut,!1):!!g!=!!h&&(c!=null?ki(o,!!h,c,!0):ki(o,!!h,h?[]:"",!1));return;case"textarea":zt=Ut=null;for(W in h)if(y=h[W],h.hasOwnProperty(W)&&y!=null&&!g.hasOwnProperty(W))switch(W){case"value":break;case"children":break;default:En(o,c,W,null,g,y)}for(B in g)if(y=g[B],A=h[B],g.hasOwnProperty(B)&&(y!=null||A!=null))switch(B){case"value":Ut=y;break;case"defaultValue":zt=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==A&&En(o,c,B,y,g,A)}pa(o,Ut,zt);return;case"option":for(var Me in h)if(Ut=h[Me],h.hasOwnProperty(Me)&&Ut!=null&&!g.hasOwnProperty(Me))switch(Me){case"selected":o.selected=!1;break;default:En(o,c,Me,null,g,Ut)}for(ht in g)if(Ut=g[ht],zt=h[ht],g.hasOwnProperty(ht)&&Ut!==zt&&(Ut!=null||zt!=null))switch(ht){case"selected":o.selected=Ut&&typeof Ut!="function"&&typeof Ut!="symbol";break;default:En(o,c,ht,Ut,g,zt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in h)Ut=h[Ce],h.hasOwnProperty(Ce)&&Ut!=null&&!g.hasOwnProperty(Ce)&&En(o,c,Ce,null,g,Ut);for(Mt in g)if(Ut=g[Mt],zt=h[Mt],g.hasOwnProperty(Mt)&&Ut!==zt&&(Ut!=null||zt!=null))switch(Mt){case"children":case"dangerouslySetInnerHTML":if(Ut!=null)throw Error(i(137,c));break;default:En(o,c,Mt,Ut,g,zt)}return;default:if(ql(c)){for(var wn in h)Ut=h[wn],h.hasOwnProperty(wn)&&Ut!==void 0&&!g.hasOwnProperty(wn)&&y1(o,c,wn,void 0,g,Ut);for(Vt in g)Ut=g[Vt],zt=h[Vt],!g.hasOwnProperty(Vt)||Ut===zt||Ut===void 0&&zt===void 0||y1(o,c,Vt,Ut,g,zt);return}}for(var Tt in h)Ut=h[Tt],h.hasOwnProperty(Tt)&&Ut!=null&&!g.hasOwnProperty(Tt)&&En(o,c,Tt,null,g,Ut);for(Kt in g)Ut=g[Kt],zt=h[Kt],!g.hasOwnProperty(Kt)||Ut===zt||Ut==null&&zt==null||En(o,c,Kt,Ut,g,zt)}var E1=null,w1=null;function F0(o){return o.nodeType===9?o:o.ownerDocument}function rw(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sw(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function A1(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var S1=null;function UN(){var o=window.event;return o&&o.type==="popstate"?o===S1?!1:(S1=o,!0):(S1=null,!1)}var aw=typeof setTimeout=="function"?setTimeout:void 0,zN=typeof clearTimeout=="function"?clearTimeout:void 0,ow=typeof Promise=="function"?Promise:void 0,jN=typeof queueMicrotask=="function"?queueMicrotask:typeof ow<"u"?function(o){return ow.resolve(null).then(o).catch(HN)}:aw;function HN(o){setTimeout(function(){throw o})}function gl(o){return o==="head"}function lw(o,c){var h=c,g=0,y=0;do{var A=h.nextSibling;if(o.removeChild(h),A&&A.nodeType===8)if(h=A.data,h==="/$"){if(0<g&&8>g){h=g;var B=o.ownerDocument;if(h&1&&Gh(B.documentElement),h&2&&Gh(B.body),h&4)for(h=B.head,Gh(h),B=h.firstChild;B;){var W=B.nextSibling,ht=B.nodeName;B[Z]||ht==="SCRIPT"||ht==="STYLE"||ht==="LINK"&&B.rel.toLowerCase()==="stylesheet"||h.removeChild(B),B=W}}if(y===0){o.removeChild(A),Qh(c);return}y--}else h==="$"||h==="$?"||h==="$!"?y++:g=h.charCodeAt(0)-48;else g=0;h=A}while(h);Qh(c)}function T1(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":T1(h),et(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function $N(o,c,h,g){for(;o.nodeType===1;){var y=h;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!g&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(g){if(!o[Z])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(A=o.getAttribute("rel"),A==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(A!==y.rel||o.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||o.getAttribute("title")!==(y.title==null?null:y.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(A=o.getAttribute("src"),(A!==(y.src==null?null:y.src)||o.getAttribute("type")!==(y.type==null?null:y.type)||o.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&A&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var A=y.name==null?null:""+y.name;if(y.type==="hidden"&&o.getAttribute("name")===A)return o}else return o;if(o=na(o.nextSibling),o===null)break}return null}function GN(o,c,h){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=na(o.nextSibling),o===null))return null;return o}function C1(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function VN(o,c){var h=o.ownerDocument;if(o.data!=="$?"||h.readyState==="complete")c();else{var g=function(){c(),h.removeEventListener("DOMContentLoaded",g)};h.addEventListener("DOMContentLoaded",g),o._reactRetry=g}}function na(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return o}var D1=null;function cw(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return o;c--}else h==="/$"&&c++}o=o.previousSibling}return null}function uw(o,c,h){switch(c=F0(h),o){case"html":if(o=c.documentElement,!o)throw Error(i(452));return o;case"head":if(o=c.head,!o)throw Error(i(453));return o;case"body":if(o=c.body,!o)throw Error(i(454));return o;default:throw Error(i(451))}}function Gh(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);et(o)}var Ds=new Map,fw=new Set;function B0(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var To=X.d;X.d={f:WN,r:qN,D:YN,C:XN,L:KN,m:ZN,X:JN,S:QN,M:tk};function WN(){var o=To.f(),c=O0();return o||c}function qN(o){var c=ot(o);c!==null&&c.tag===5&&c.type==="form"?Ny(c):To.r(o)}var Lu=typeof document>"u"?null:document;function hw(o,c,h){var g=Lu;if(g&&typeof c=="string"&&c){var y=si(c);y='link[rel="'+o+'"][href="'+y+'"]',typeof h=="string"&&(y+='[crossorigin="'+h+'"]'),fw.has(y)||(fw.add(y),o={rel:o,crossOrigin:h,href:c},g.querySelector(y)===null&&(c=g.createElement("link"),Fi(c,"link",o),Et(c),g.head.appendChild(c)))}}function YN(o){To.D(o),hw("dns-prefetch",o,null)}function XN(o,c){To.C(o,c),hw("preconnect",o,c)}function KN(o,c,h){To.L(o,c,h);var g=Lu;if(g&&o&&c){var y='link[rel="preload"][as="'+si(c)+'"]';c==="image"&&h&&h.imageSrcSet?(y+='[imagesrcset="'+si(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(y+='[imagesizes="'+si(h.imageSizes)+'"]')):y+='[href="'+si(o)+'"]';var A=y;switch(c){case"style":A=Iu(o);break;case"script":A=Mu(o)}Ds.has(A)||(o=d({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:o,as:c},h),Ds.set(A,o),g.querySelector(y)!==null||c==="style"&&g.querySelector(Vh(A))||c==="script"&&g.querySelector(Wh(A))||(c=g.createElement("link"),Fi(c,"link",o),Et(c),g.head.appendChild(c)))}}function ZN(o,c){To.m(o,c);var h=Lu;if(h&&o){var g=c&&typeof c.as=="string"?c.as:"script",y='link[rel="modulepreload"][as="'+si(g)+'"][href="'+si(o)+'"]',A=y;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Mu(o)}if(!Ds.has(A)&&(o=d({rel:"modulepreload",href:o},c),Ds.set(A,o),h.querySelector(y)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Wh(A)))return}g=h.createElement("link"),Fi(g,"link",o),Et(g),h.head.appendChild(g)}}}function QN(o,c,h){To.S(o,c,h);var g=Lu;if(g&&o){var y=Ht(g).hoistableStyles,A=Iu(o);c=c||"default";var B=y.get(A);if(!B){var W={loading:0,preload:null};if(B=g.querySelector(Vh(A)))W.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":c},h),(h=Ds.get(A))&&O1(o,h);var ht=B=g.createElement("link");Et(ht),Fi(ht,"link",o),ht._p=new Promise(function(Mt,Vt){ht.onload=Mt,ht.onerror=Vt}),ht.addEventListener("load",function(){W.loading|=1}),ht.addEventListener("error",function(){W.loading|=2}),W.loading|=4,U0(B,c,g)}B={type:"stylesheet",instance:B,count:1,state:W},y.set(A,B)}}}function JN(o,c){To.X(o,c);var h=Lu;if(h&&o){var g=Ht(h).hoistableScripts,y=Mu(o),A=g.get(y);A||(A=h.querySelector(Wh(y)),A||(o=d({src:o,async:!0},c),(c=Ds.get(y))&&R1(o,c),A=h.createElement("script"),Et(A),Fi(A,"link",o),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},g.set(y,A))}}function tk(o,c){To.M(o,c);var h=Lu;if(h&&o){var g=Ht(h).hoistableScripts,y=Mu(o),A=g.get(y);A||(A=h.querySelector(Wh(y)),A||(o=d({src:o,async:!0,type:"module"},c),(c=Ds.get(y))&&R1(o,c),A=h.createElement("script"),Et(A),Fi(A,"link",o),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},g.set(y,A))}}function dw(o,c,h,g){var y=(y=Bt.current)?B0(y):null;if(!y)throw Error(i(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=Iu(h.href),h=Ht(y).hoistableStyles,g=h.get(c),g||(g={type:"style",instance:null,count:0,state:null},h.set(c,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=Iu(h.href);var A=Ht(y).hoistableStyles,B=A.get(o);if(B||(y=y.ownerDocument||y,B={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(o,B),(A=y.querySelector(Vh(o)))&&!A._p&&(B.instance=A,B.state.loading=5),Ds.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Ds.set(o,h),A||ek(y,o,h,B.state))),c&&g===null)throw Error(i(528,""));return B}if(c&&g!==null)throw Error(i(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Mu(h),h=Ht(y).hoistableScripts,g=h.get(c),g||(g={type:"script",instance:null,count:0,state:null},h.set(c,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,o))}}function Iu(o){return'href="'+si(o)+'"'}function Vh(o){return'link[rel="stylesheet"]['+o+"]"}function pw(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function ek(o,c,h,g){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?g.loading=1:(c=o.createElement("link"),g.preload=c,c.addEventListener("load",function(){return g.loading|=1}),c.addEventListener("error",function(){return g.loading|=2}),Fi(c,"link",h),Et(c),o.head.appendChild(c))}function Mu(o){return'[src="'+si(o)+'"]'}function Wh(o){return"script[async]"+o}function mw(o,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var g=o.querySelector('style[data-href~="'+si(h.href)+'"]');if(g)return c.instance=g,Et(g),g;var y=d({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return g=(o.ownerDocument||o).createElement("style"),Et(g),Fi(g,"style",y),U0(g,h.precedence,o),c.instance=g;case"stylesheet":y=Iu(h.href);var A=o.querySelector(Vh(y));if(A)return c.state.loading|=4,c.instance=A,Et(A),A;g=pw(h),(y=Ds.get(y))&&O1(g,y),A=(o.ownerDocument||o).createElement("link"),Et(A);var B=A;return B._p=new Promise(function(W,ht){B.onload=W,B.onerror=ht}),Fi(A,"link",g),c.state.loading|=4,U0(A,h.precedence,o),c.instance=A;case"script":return A=Mu(h.src),(y=o.querySelector(Wh(A)))?(c.instance=y,Et(y),y):(g=h,(y=Ds.get(A))&&(g=d({},h),R1(g,y)),o=o.ownerDocument||o,y=o.createElement("script"),Et(y),Fi(y,"link",g),o.head.appendChild(y),c.instance=y);case"void":return null;default:throw Error(i(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(g=c.instance,c.state.loading|=4,U0(g,h.precedence,o));return c.instance}function U0(o,c,h){for(var g=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=g.length?g[g.length-1]:null,A=y,B=0;B<g.length;B++){var W=g[B];if(W.dataset.precedence===c)A=W;else if(A!==y)break}A?A.parentNode.insertBefore(o,A.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(o,c.firstChild))}function O1(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function R1(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var z0=null;function gw(o,c,h){if(z0===null){var g=new Map,y=z0=new Map;y.set(h,g)}else y=z0,g=y.get(h),g||(g=new Map,y.set(h,g));if(g.has(o))return g;for(g.set(o,null),h=h.getElementsByTagName(o),y=0;y<h.length;y++){var A=h[y];if(!(A[Z]||A[ii]||o==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var B=A.getAttribute(c)||"";B=o+B;var W=g.get(B);W?W.push(A):g.set(B,[A])}}return g}function vw(o,c,h){o=o.ownerDocument||o,o.head.insertBefore(h,c==="title"?o.querySelector("head > title"):null)}function nk(o,c,h){if(h===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return o=c.disabled,typeof c.precedence=="string"&&o==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function _w(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var qh=null;function ik(){}function rk(o,c,h){if(qh===null)throw Error(i(475));var g=qh;if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var y=Iu(h.href),A=o.querySelector(Vh(y));if(A){o=A._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(g.count++,g=j0.bind(g),o.then(g,g)),c.state.loading|=4,c.instance=A,Et(A);return}A=o.ownerDocument||o,h=pw(h),(y=Ds.get(y))&&O1(h,y),A=A.createElement("link"),Et(A);var B=A;B._p=new Promise(function(W,ht){B.onload=W,B.onerror=ht}),Fi(A,"link",h),c.instance=A}g.stylesheets===null&&(g.stylesheets=new Map),g.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(g.count++,c=j0.bind(g),o.addEventListener("load",c),o.addEventListener("error",c))}}function sk(){if(qh===null)throw Error(i(475));var o=qh;return o.stylesheets&&o.count===0&&N1(o,o.stylesheets),0<o.count?function(c){var h=setTimeout(function(){if(o.stylesheets&&N1(o,o.stylesheets),o.unsuspend){var g=o.unsuspend;o.unsuspend=null,g()}},6e4);return o.unsuspend=c,function(){o.unsuspend=null,clearTimeout(h)}}:null}function j0(){if(this.count--,this.count===0){if(this.stylesheets)N1(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var H0=null;function N1(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,H0=new Map,c.forEach(ak,o),H0=null,j0.call(o))}function ak(o,c){if(!(c.state.loading&4)){var h=H0.get(o);if(h)var g=h.get(null);else{h=new Map,H0.set(o,h);for(var y=o.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<y.length;A++){var B=y[A];(B.nodeName==="LINK"||B.getAttribute("media")!=="not all")&&(h.set(B.dataset.precedence,B),g=B)}g&&h.set(null,g)}y=c.instance,B=y.getAttribute("data-precedence"),A=h.get(B)||g,A===g&&h.set(null,y),h.set(B,y),this.count++,g=j0.bind(this),y.addEventListener("load",g),y.addEventListener("error",g),A?A.parentNode.insertBefore(y,A.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(y,o.firstChild)),c.state.loading|=4}}var Yh={$$typeof:S,Provider:null,Consumer:null,_currentValue:Rt,_currentValue2:Rt,_threadCount:0};function ok(o,c,h,g,y,A,B,W){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Vs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vs(0),this.hiddenUpdates=Vs(null),this.identifierPrefix=g,this.onUncaughtError=y,this.onCaughtError=A,this.onRecoverableError=B,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function xw(o,c,h,g,y,A,B,W,ht,Mt,Vt,Kt){return o=new ok(o,c,h,B,W,ht,Mt,Kt),c=1,A===!0&&(c|=24),A=gr(3,null,null,c),o.current=A,A.stateNode=o,c=sc(),c.refCount++,o.pooledCache=c,c.refCount++,A.memoizedState={element:g,isDehydrated:h,cache:c},St(A),o}function bw(o){return o?(o=Jo,o):Jo}function yw(o,c,h,g,y,A){y=bw(y),g.context===null?g.context=y:g.pendingContext=y,g=qt(c),g.payload={element:h},A=A===void 0?null:A,A!==null&&(g.callback=A),h=re(o,g,c),h!==null&&(ns(h,o,c),fe(h,o,c))}function Ew(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<c?h:c}}function k1(o,c){Ew(o,c),(o=o.alternate)&&Ew(o,c)}function ww(o){if(o.tag===13){var c=qi(o,67108864);c!==null&&ns(c,o,67108864),k1(o,67108864)}}var $0=!0;function lk(o,c,h,g){var y=Q.T;Q.T=null;var A=X.p;try{X.p=2,L1(o,c,h,g)}finally{X.p=A,Q.T=y}}function ck(o,c,h,g){var y=Q.T;Q.T=null;var A=X.p;try{X.p=8,L1(o,c,h,g)}finally{X.p=A,Q.T=y}}function L1(o,c,h,g){if($0){var y=I1(g);if(y===null)b1(o,c,g,G0,h),Sw(o,g);else if(fk(y,o,c,h,g))g.stopPropagation();else if(Sw(o,g),c&4&&-1<uk.indexOf(o)){for(;y!==null;){var A=ot(y);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var B=Cn(A.pendingLanes);if(B!==0){var W=A;for(W.pendingLanes|=2,W.entangledLanes|=2;B;){var ht=1<<31-Re(B);W.entanglements[1]|=ht,B&=~ht}Oa(A),(gn&6)===0&&(C0=Y()+500,jh(0))}}break;case 13:W=qi(A,2),W!==null&&ns(W,A,2),O0(),k1(A,2)}if(A=I1(g),A===null&&b1(o,c,g,G0,h),A===y)break;y=A}y!==null&&g.stopPropagation()}else b1(o,c,g,null,h)}}function I1(o){return o=$o(o),M1(o)}var G0=null;function M1(o){if(G0=null,o=it(o),o!==null){var c=s(o);if(c===null)o=null;else{var h=c.tag;if(h===13){if(o=a(c),o!==null)return o;o=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return G0=o,null}function Aw(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(q()){case ft:return 2;case Pt:return 8;case jt:case wt:return 32;case Nt:return 268435456;default:return 32}default:return 32}}var P1=!1,vl=null,_l=null,xl=null,Xh=new Map,Kh=new Map,bl=[],uk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Sw(o,c){switch(o){case"focusin":case"focusout":vl=null;break;case"dragenter":case"dragleave":_l=null;break;case"mouseover":case"mouseout":xl=null;break;case"pointerover":case"pointerout":Xh.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kh.delete(c.pointerId)}}function Zh(o,c,h,g,y,A){return o===null||o.nativeEvent!==A?(o={blockedOn:c,domEventName:h,eventSystemFlags:g,nativeEvent:A,targetContainers:[y]},c!==null&&(c=ot(c),c!==null&&ww(c)),o):(o.eventSystemFlags|=g,c=o.targetContainers,y!==null&&c.indexOf(y)===-1&&c.push(y),o)}function fk(o,c,h,g,y){switch(c){case"focusin":return vl=Zh(vl,o,c,h,g,y),!0;case"dragenter":return _l=Zh(_l,o,c,h,g,y),!0;case"mouseover":return xl=Zh(xl,o,c,h,g,y),!0;case"pointerover":var A=y.pointerId;return Xh.set(A,Zh(Xh.get(A)||null,o,c,h,g,y)),!0;case"gotpointercapture":return A=y.pointerId,Kh.set(A,Zh(Kh.get(A)||null,o,c,h,g,y)),!0}return!1}function Tw(o){var c=it(o.target);if(c!==null){var h=s(c);if(h!==null){if(c=h.tag,c===13){if(c=a(h),c!==null){o.blockedOn=c,fa(o.priority,function(){if(h.tag===13){var g=es();g=jl(g);var y=qi(h,g);y!==null&&ns(y,h,g),k1(h,g)}});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function V0(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var h=I1(o.nativeEvent);if(h===null){h=o.nativeEvent;var g=new h.constructor(h.type,h);xs=g,h.target.dispatchEvent(g),xs=null}else return c=ot(h),c!==null&&ww(c),o.blockedOn=h,!1;c.shift()}return!0}function Cw(o,c,h){V0(o)&&h.delete(c)}function hk(){P1=!1,vl!==null&&V0(vl)&&(vl=null),_l!==null&&V0(_l)&&(_l=null),xl!==null&&V0(xl)&&(xl=null),Xh.forEach(Cw),Kh.forEach(Cw)}function W0(o,c){o.blockedOn===c&&(o.blockedOn=null,P1||(P1=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,hk)))}var q0=null;function Dw(o){q0!==o&&(q0=o,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){q0===o&&(q0=null);for(var c=0;c<o.length;c+=3){var h=o[c],g=o[c+1],y=o[c+2];if(typeof g!="function"){if(M1(g||h)===null)continue;break}var A=ot(h);A!==null&&(o.splice(c,3),c-=3,Mv(A,{pending:!0,data:y,method:h.method,action:g},g,y))}}))}function Qh(o){function c(ht){return W0(ht,o)}vl!==null&&W0(vl,o),_l!==null&&W0(_l,o),xl!==null&&W0(xl,o),Xh.forEach(c),Kh.forEach(c);for(var h=0;h<bl.length;h++){var g=bl[h];g.blockedOn===o&&(g.blockedOn=null)}for(;0<bl.length&&(h=bl[0],h.blockedOn===null);)Tw(h),h.blockedOn===null&&bl.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(g=0;g<h.length;g+=3){var y=h[g],A=h[g+1],B=y[ri]||null;if(typeof A=="function")B||Dw(h);else if(B){var W=null;if(A&&A.hasAttribute("formAction")){if(y=A,B=A[ri]||null)W=B.formAction;else if(M1(y)!==null)continue}else W=B.action;typeof W=="function"?h[g+1]=W:(h.splice(g,3),g-=3),Dw(h)}}}function F1(o){this._internalRoot=o}Y0.prototype.render=F1.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(i(409));var h=c.current,g=es();yw(h,g,o,c,null,null)},Y0.prototype.unmount=F1.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;yw(o.current,2,null,o,null,null),O0(),c[ha]=null}};function Y0(o){this._internalRoot=o}Y0.prototype.unstable_scheduleHydration=function(o){if(o){var c=Zc();o={blockedOn:null,target:o,priority:c};for(var h=0;h<bl.length&&c!==0&&c<bl[h].priority;h++);bl.splice(h,0,o),h===0&&Tw(o)}};var Ow=t.version;if(Ow!=="19.1.0")throw Error(i(527,Ow,"19.1.0"));X.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(i(188)):(o=Object.keys(o).join(","),Error(i(268,o)));return o=u(c),o=o!==null?f(o):null,o=o===null?null:o.stateNode,o};var dk={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var X0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!X0.isDisabled&&X0.supportsFiber)try{te=X0.inject(dk),ae=X0}catch{}}return td.createRoot=function(o,c){if(!r(o))throw Error(i(299));var h=!1,g="",y=Vy,A=Wy,B=qy,W=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(B=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(W=c.unstable_transitionCallbacks)),c=xw(o,1,!1,null,null,h,g,y,A,B,W,null),o[ha]=c.current,x1(o),new F1(c)},td.hydrateRoot=function(o,c,h){if(!r(o))throw Error(i(299));var g=!1,y="",A=Vy,B=Wy,W=qy,ht=null,Mt=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(y=h.identifierPrefix),h.onUncaughtError!==void 0&&(A=h.onUncaughtError),h.onCaughtError!==void 0&&(B=h.onCaughtError),h.onRecoverableError!==void 0&&(W=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ht=h.unstable_transitionCallbacks),h.formState!==void 0&&(Mt=h.formState)),c=xw(o,1,!0,c,h??null,g,y,A,B,W,ht,Mt),c.context=bw(null),h=c.current,g=es(),g=jl(g),y=qt(g),y.callback=null,re(h,y,g),h=g,c.current.lanes=h,wi(c,h),Oa(c),o[ha]=c.current,x1(o),new Y0(c)},td.version="19.1.0",td}var jw;function wk(){if(jw)return j1.exports;jw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),j1.exports=Ek(),j1.exports}var Ak=wk(),Nm={exports:{}},Tr="top",ps="bottom",ms="right",Cr="left",Lg="auto",Ef=[Tr,ps,ms,Cr],Cc="start",of="end",mT="clippingParents",Px="viewport",zu="popper",gT="reference",J_=Ef.reduce(function(n,t){return n.concat([t+"-"+Cc,t+"-"+of])},[]),Fx=[].concat(Ef,[Lg]).reduce(function(n,t){return n.concat([t,t+"-"+Cc,t+"-"+of])},[]),vT="beforeRead",_T="read",xT="afterRead",bT="beforeMain",yT="main",ET="afterMain",wT="beforeWrite",AT="write",ST="afterWrite",TT=[vT,_T,xT,bT,yT,ET,wT,AT,ST];function Wa(n){return n?(n.nodeName||"").toLowerCase():null}function gs(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var t=n.ownerDocument;return t&&t.defaultView||window}return n}function Dc(n){var t=gs(n).Element;return n instanceof t||n instanceof Element}function Ps(n){var t=gs(n).HTMLElement;return n instanceof t||n instanceof HTMLElement}function Bx(n){if(typeof ShadowRoot>"u")return!1;var t=gs(n).ShadowRoot;return n instanceof t||n instanceof ShadowRoot}function Sk(n){var t=n.state;Object.keys(t.elements).forEach(function(e){var i=t.styles[e]||{},r=t.attributes[e]||{},s=t.elements[e];!Ps(s)||!Wa(s)||(Object.assign(s.style,i),Object.keys(r).forEach(function(a){var l=r[a];l===!1?s.removeAttribute(a):s.setAttribute(a,l===!0?"":l)}))})}function Tk(n){var t=n.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],s=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:e[i]),l=a.reduce(function(u,f){return u[f]="",u},{});!Ps(r)||!Wa(r)||(Object.assign(r.style,l),Object.keys(s).forEach(function(u){r.removeAttribute(u)}))})}}const Ux={name:"applyStyles",enabled:!0,phase:"write",fn:Sk,effect:Tk,requires:["computeStyles"]};function Ga(n){return n.split("-")[0]}var Sc=Math.max,Ym=Math.min,lf=Math.round;function tx(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function CT(){return!/^((?!chrome|android).)*safari/i.test(tx())}function cf(n,t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var i=n.getBoundingClientRect(),r=1,s=1;t&&Ps(n)&&(r=n.offsetWidth>0&&lf(i.width)/n.offsetWidth||1,s=n.offsetHeight>0&&lf(i.height)/n.offsetHeight||1);var a=Dc(n)?gs(n):window,l=a.visualViewport,u=!CT()&&e,f=(i.left+(u&&l?l.offsetLeft:0))/r,d=(i.top+(u&&l?l.offsetTop:0))/s,p=i.width/r,m=i.height/s;return{width:p,height:m,top:d,right:f+p,bottom:d+m,left:f,x:f,y:d}}function zx(n){var t=cf(n),e=n.offsetWidth,i=n.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:n.offsetLeft,y:n.offsetTop,width:e,height:i}}function DT(n,t){var e=t.getRootNode&&t.getRootNode();if(n.contains(t))return!0;if(e&&Bx(e)){var i=t;do{if(i&&n.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Fo(n){return gs(n).getComputedStyle(n)}function Ck(n){return["table","td","th"].indexOf(Wa(n))>=0}function Pl(n){return((Dc(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ig(n){return Wa(n)==="html"?n:n.assignedSlot||n.parentNode||(Bx(n)?n.host:null)||Pl(n)}function Hw(n){return!Ps(n)||Fo(n).position==="fixed"?null:n.offsetParent}function Dk(n){var t=/firefox/i.test(tx()),e=/Trident/i.test(tx());if(e&&Ps(n)){var i=Fo(n);if(i.position==="fixed")return null}var r=Ig(n);for(Bx(r)&&(r=r.host);Ps(r)&&["html","body"].indexOf(Wa(r))<0;){var s=Fo(r);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return r;r=r.parentNode}return null}function Qd(n){for(var t=gs(n),e=Hw(n);e&&Ck(e)&&Fo(e).position==="static";)e=Hw(e);return e&&(Wa(e)==="html"||Wa(e)==="body"&&Fo(e).position==="static")?t:e||Dk(n)||t}function jx(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function vd(n,t,e){return Sc(n,Ym(t,e))}function Ok(n,t,e){var i=vd(n,t,e);return i>e?e:i}function OT(){return{top:0,right:0,bottom:0,left:0}}function RT(n){return Object.assign({},OT(),n)}function NT(n,t){return t.reduce(function(e,i){return e[i]=n,e},{})}var Rk=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,RT(typeof t!="number"?t:NT(t,Ef))};function Nk(n){var t,e=n.state,i=n.name,r=n.options,s=e.elements.arrow,a=e.modifiersData.popperOffsets,l=Ga(e.placement),u=jx(l),f=[Cr,ms].indexOf(l)>=0,d=f?"height":"width";if(!(!s||!a)){var p=Rk(r.padding,e),m=zx(s),v=u==="y"?Tr:Cr,x=u==="y"?ps:ms,_=e.rects.reference[d]+e.rects.reference[u]-a[u]-e.rects.popper[d],b=a[u]-e.rects.reference[u],E=Qd(s),T=E?u==="y"?E.clientHeight||0:E.clientWidth||0:0,S=_/2-b/2,O=p[v],R=T-m[d]-p[x],N=T/2-m[d]/2+S,C=vd(O,N,R),M=u;e.modifiersData[i]=(t={},t[M]=C,t.centerOffset=C-N,t)}}function kk(n){var t=n.state,e=n.options,i=e.element,r=i===void 0?"[data-popper-arrow]":i;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||DT(t.elements.popper,r)&&(t.elements.arrow=r))}const kT={name:"arrow",enabled:!0,phase:"main",fn:Nk,effect:kk,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function uf(n){return n.split("-")[1]}var Lk={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ik(n,t){var e=n.x,i=n.y,r=t.devicePixelRatio||1;return{x:lf(e*r)/r||0,y:lf(i*r)/r||0}}function $w(n){var t,e=n.popper,i=n.popperRect,r=n.placement,s=n.variation,a=n.offsets,l=n.position,u=n.gpuAcceleration,f=n.adaptive,d=n.roundOffsets,p=n.isFixed,m=a.x,v=m===void 0?0:m,x=a.y,_=x===void 0?0:x,b=typeof d=="function"?d({x:v,y:_}):{x:v,y:_};v=b.x,_=b.y;var E=a.hasOwnProperty("x"),T=a.hasOwnProperty("y"),S=Cr,O=Tr,R=window;if(f){var N=Qd(e),C="clientHeight",M="clientWidth";if(N===gs(e)&&(N=Pl(e),Fo(N).position!=="static"&&l==="absolute"&&(C="scrollHeight",M="scrollWidth")),N=N,r===Tr||(r===Cr||r===ms)&&s===of){O=ps;var I=p&&N===R&&R.visualViewport?R.visualViewport.height:N[C];_-=I-i.height,_*=u?1:-1}if(r===Cr||(r===Tr||r===ps)&&s===of){S=ms;var F=p&&N===R&&R.visualViewport?R.visualViewport.width:N[M];v-=F-i.width,v*=u?1:-1}}var z=Object.assign({position:l},f&&Lk),P=d===!0?Ik({x:v,y:_},gs(e)):{x:v,y:_};if(v=P.x,_=P.y,u){var tt;return Object.assign({},z,(tt={},tt[O]=T?"0":"",tt[S]=E?"0":"",tt.transform=(R.devicePixelRatio||1)<=1?"translate("+v+"px, "+_+"px)":"translate3d("+v+"px, "+_+"px, 0)",tt))}return Object.assign({},z,(t={},t[O]=T?_+"px":"",t[S]=E?v+"px":"",t.transform="",t))}function Mk(n){var t=n.state,e=n.options,i=e.gpuAcceleration,r=i===void 0?!0:i,s=e.adaptive,a=s===void 0?!0:s,l=e.roundOffsets,u=l===void 0?!0:l,f={placement:Ga(t.placement),variation:uf(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,$w(Object.assign({},f,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,$w(Object.assign({},f,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const Hx={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Mk,data:{}};var Z0={passive:!0};function Pk(n){var t=n.state,e=n.instance,i=n.options,r=i.scroll,s=r===void 0?!0:r,a=i.resize,l=a===void 0?!0:a,u=gs(t.elements.popper),f=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&f.forEach(function(d){d.addEventListener("scroll",e.update,Z0)}),l&&u.addEventListener("resize",e.update,Z0),function(){s&&f.forEach(function(d){d.removeEventListener("scroll",e.update,Z0)}),l&&u.removeEventListener("resize",e.update,Z0)}}const $x={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Pk,data:{}};var Fk={left:"right",right:"left",bottom:"top",top:"bottom"};function km(n){return n.replace(/left|right|bottom|top/g,function(t){return Fk[t]})}var Bk={start:"end",end:"start"};function Gw(n){return n.replace(/start|end/g,function(t){return Bk[t]})}function Gx(n){var t=gs(n),e=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:e,scrollTop:i}}function Vx(n){return cf(Pl(n)).left+Gx(n).scrollLeft}function Uk(n,t){var e=gs(n),i=Pl(n),r=e.visualViewport,s=i.clientWidth,a=i.clientHeight,l=0,u=0;if(r){s=r.width,a=r.height;var f=CT();(f||!f&&t==="fixed")&&(l=r.offsetLeft,u=r.offsetTop)}return{width:s,height:a,x:l+Vx(n),y:u}}function zk(n){var t,e=Pl(n),i=Gx(n),r=(t=n.ownerDocument)==null?void 0:t.body,s=Sc(e.scrollWidth,e.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=Sc(e.scrollHeight,e.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),l=-i.scrollLeft+Vx(n),u=-i.scrollTop;return Fo(r||e).direction==="rtl"&&(l+=Sc(e.clientWidth,r?r.clientWidth:0)-s),{width:s,height:a,x:l,y:u}}function Wx(n){var t=Fo(n),e=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(e+r+i)}function LT(n){return["html","body","#document"].indexOf(Wa(n))>=0?n.ownerDocument.body:Ps(n)&&Wx(n)?n:LT(Ig(n))}function _d(n,t){var e;t===void 0&&(t=[]);var i=LT(n),r=i===((e=n.ownerDocument)==null?void 0:e.body),s=gs(i),a=r?[s].concat(s.visualViewport||[],Wx(i)?i:[]):i,l=t.concat(a);return r?l:l.concat(_d(Ig(a)))}function ex(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function jk(n,t){var e=cf(n,!1,t==="fixed");return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}function Vw(n,t,e){return t===Px?ex(Uk(n,e)):Dc(t)?jk(t,e):ex(zk(Pl(n)))}function Hk(n){var t=_d(Ig(n)),e=["absolute","fixed"].indexOf(Fo(n).position)>=0,i=e&&Ps(n)?Qd(n):n;return Dc(i)?t.filter(function(r){return Dc(r)&&DT(r,i)&&Wa(r)!=="body"}):[]}function $k(n,t,e,i){var r=t==="clippingParents"?Hk(n):[].concat(t),s=[].concat(r,[e]),a=s[0],l=s.reduce(function(u,f){var d=Vw(n,f,i);return u.top=Sc(d.top,u.top),u.right=Ym(d.right,u.right),u.bottom=Ym(d.bottom,u.bottom),u.left=Sc(d.left,u.left),u},Vw(n,a,i));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function IT(n){var t=n.reference,e=n.element,i=n.placement,r=i?Ga(i):null,s=i?uf(i):null,a=t.x+t.width/2-e.width/2,l=t.y+t.height/2-e.height/2,u;switch(r){case Tr:u={x:a,y:t.y-e.height};break;case ps:u={x:a,y:t.y+t.height};break;case ms:u={x:t.x+t.width,y:l};break;case Cr:u={x:t.x-e.width,y:l};break;default:u={x:t.x,y:t.y}}var f=r?jx(r):null;if(f!=null){var d=f==="y"?"height":"width";switch(s){case Cc:u[f]=u[f]-(t[d]/2-e[d]/2);break;case of:u[f]=u[f]+(t[d]/2-e[d]/2);break}}return u}function ff(n,t){t===void 0&&(t={});var e=t,i=e.placement,r=i===void 0?n.placement:i,s=e.strategy,a=s===void 0?n.strategy:s,l=e.boundary,u=l===void 0?mT:l,f=e.rootBoundary,d=f===void 0?Px:f,p=e.elementContext,m=p===void 0?zu:p,v=e.altBoundary,x=v===void 0?!1:v,_=e.padding,b=_===void 0?0:_,E=RT(typeof b!="number"?b:NT(b,Ef)),T=m===zu?gT:zu,S=n.rects.popper,O=n.elements[x?T:m],R=$k(Dc(O)?O:O.contextElement||Pl(n.elements.popper),u,d,a),N=cf(n.elements.reference),C=IT({reference:N,element:S,placement:r}),M=ex(Object.assign({},S,C)),I=m===zu?M:N,F={top:R.top-I.top+E.top,bottom:I.bottom-R.bottom+E.bottom,left:R.left-I.left+E.left,right:I.right-R.right+E.right},z=n.modifiersData.offset;if(m===zu&&z){var P=z[r];Object.keys(F).forEach(function(tt){var L=[ms,ps].indexOf(tt)>=0?1:-1,nt=[Tr,ps].indexOf(tt)>=0?"y":"x";F[tt]+=P[nt]*L})}return F}function Gk(n,t){t===void 0&&(t={});var e=t,i=e.placement,r=e.boundary,s=e.rootBoundary,a=e.padding,l=e.flipVariations,u=e.allowedAutoPlacements,f=u===void 0?Fx:u,d=uf(i),p=d?l?J_:J_.filter(function(x){return uf(x)===d}):Ef,m=p.filter(function(x){return f.indexOf(x)>=0});m.length===0&&(m=p);var v=m.reduce(function(x,_){return x[_]=ff(n,{placement:_,boundary:r,rootBoundary:s,padding:a})[Ga(_)],x},{});return Object.keys(v).sort(function(x,_){return v[x]-v[_]})}function Vk(n){if(Ga(n)===Lg)return[];var t=km(n);return[Gw(n),t,Gw(t)]}function Wk(n){var t=n.state,e=n.options,i=n.name;if(!t.modifiersData[i]._skip){for(var r=e.mainAxis,s=r===void 0?!0:r,a=e.altAxis,l=a===void 0?!0:a,u=e.fallbackPlacements,f=e.padding,d=e.boundary,p=e.rootBoundary,m=e.altBoundary,v=e.flipVariations,x=v===void 0?!0:v,_=e.allowedAutoPlacements,b=t.options.placement,E=Ga(b),T=E===b,S=u||(T||!x?[km(b)]:Vk(b)),O=[b].concat(S).reduce(function(gt,_t){return gt.concat(Ga(_t)===Lg?Gk(t,{placement:_t,boundary:d,rootBoundary:p,padding:f,flipVariations:x,allowedAutoPlacements:_}):_t)},[]),R=t.rects.reference,N=t.rects.popper,C=new Map,M=!0,I=O[0],F=0;F<O.length;F++){var z=O[F],P=Ga(z),tt=uf(z)===Cc,L=[Tr,ps].indexOf(P)>=0,nt=L?"width":"height",Q=ff(t,{placement:z,boundary:d,rootBoundary:p,altBoundary:m,padding:f}),X=L?tt?ms:Cr:tt?ps:Tr;R[nt]>N[nt]&&(X=km(X));var Rt=km(X),yt=[];if(s&&yt.push(Q[P]<=0),l&&yt.push(Q[X]<=0,Q[Rt]<=0),yt.every(function(gt){return gt})){I=z,M=!1;break}C.set(z,yt)}if(M)for(var j=x?3:1,J=function(_t){var Bt=O.find(function(Gt){var H=C.get(Gt);if(H)return H.slice(0,_t).every(function(mt){return mt})});if(Bt)return I=Bt,"break"},G=j;G>0;G--){var ut=J(G);if(ut==="break")break}t.placement!==I&&(t.modifiersData[i]._skip=!0,t.placement=I,t.reset=!0)}}const MT={name:"flip",enabled:!0,phase:"main",fn:Wk,requiresIfExists:["offset"],data:{_skip:!1}};function Ww(n,t,e){return e===void 0&&(e={x:0,y:0}),{top:n.top-t.height-e.y,right:n.right-t.width+e.x,bottom:n.bottom-t.height+e.y,left:n.left-t.width-e.x}}function qw(n){return[Tr,ms,ps,Cr].some(function(t){return n[t]>=0})}function qk(n){var t=n.state,e=n.name,i=t.rects.reference,r=t.rects.popper,s=t.modifiersData.preventOverflow,a=ff(t,{elementContext:"reference"}),l=ff(t,{altBoundary:!0}),u=Ww(a,i),f=Ww(l,r,s),d=qw(u),p=qw(f);t.modifiersData[e]={referenceClippingOffsets:u,popperEscapeOffsets:f,isReferenceHidden:d,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":p})}const PT={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:qk};function Yk(n,t,e){var i=Ga(n),r=[Cr,Tr].indexOf(i)>=0?-1:1,s=typeof e=="function"?e(Object.assign({},t,{placement:n})):e,a=s[0],l=s[1];return a=a||0,l=(l||0)*r,[Cr,ms].indexOf(i)>=0?{x:l,y:a}:{x:a,y:l}}function Xk(n){var t=n.state,e=n.options,i=n.name,r=e.offset,s=r===void 0?[0,0]:r,a=Fx.reduce(function(d,p){return d[p]=Yk(p,t.rects,s),d},{}),l=a[t.placement],u=l.x,f=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=f),t.modifiersData[i]=a}const FT={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Xk};function Kk(n){var t=n.state,e=n.name;t.modifiersData[e]=IT({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const qx={name:"popperOffsets",enabled:!0,phase:"read",fn:Kk,data:{}};function Zk(n){return n==="x"?"y":"x"}function Qk(n){var t=n.state,e=n.options,i=n.name,r=e.mainAxis,s=r===void 0?!0:r,a=e.altAxis,l=a===void 0?!1:a,u=e.boundary,f=e.rootBoundary,d=e.altBoundary,p=e.padding,m=e.tether,v=m===void 0?!0:m,x=e.tetherOffset,_=x===void 0?0:x,b=ff(t,{boundary:u,rootBoundary:f,padding:p,altBoundary:d}),E=Ga(t.placement),T=uf(t.placement),S=!T,O=jx(E),R=Zk(O),N=t.modifiersData.popperOffsets,C=t.rects.reference,M=t.rects.popper,I=typeof _=="function"?_(Object.assign({},t.rects,{placement:t.placement})):_,F=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),z=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,P={x:0,y:0};if(N){if(s){var tt,L=O==="y"?Tr:Cr,nt=O==="y"?ps:ms,Q=O==="y"?"height":"width",X=N[O],Rt=X+b[L],yt=X-b[nt],j=v?-M[Q]/2:0,J=T===Cc?C[Q]:M[Q],G=T===Cc?-M[Q]:-C[Q],ut=t.elements.arrow,gt=v&&ut?zx(ut):{width:0,height:0},_t=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:OT(),Bt=_t[L],Gt=_t[nt],H=vd(0,C[Q],gt[Q]),mt=S?C[Q]/2-j-H-Bt-F.mainAxis:J-H-Bt-F.mainAxis,lt=S?-C[Q]/2+j+H+Gt+F.mainAxis:G+H+Gt+F.mainAxis,ct=t.elements.arrow&&Qd(t.elements.arrow),Ct=ct?O==="y"?ct.clientTop||0:ct.clientLeft||0:0,Lt=(tt=z?.[O])!=null?tt:0,D=X+mt-Lt-Ct,dt=X+lt-Lt,st=vd(v?Ym(Rt,D):Rt,X,v?Sc(yt,dt):yt);N[O]=st,P[O]=st-X}if(l){var Y,q=O==="x"?Tr:Cr,ft=O==="x"?ps:ms,Pt=N[R],jt=R==="y"?"height":"width",wt=Pt+b[q],Nt=Pt-b[ft],At=[Tr,Cr].indexOf(E)!==-1,pt=(Y=z?.[R])!=null?Y:0,te=At?wt:Pt-C[jt]-M[jt]-pt+F.altAxis,ae=At?Pt+C[jt]+M[jt]-pt-F.altAxis:Nt,ne=v&&At?Ok(te,Pt,ae):vd(v?te:wt,Pt,v?ae:Nt);N[R]=ne,P[R]=ne-Pt}t.modifiersData[i]=P}}const BT={name:"preventOverflow",enabled:!0,phase:"main",fn:Qk,requiresIfExists:["offset"]};function Jk(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function t4(n){return n===gs(n)||!Ps(n)?Gx(n):Jk(n)}function e4(n){var t=n.getBoundingClientRect(),e=lf(t.width)/n.offsetWidth||1,i=lf(t.height)/n.offsetHeight||1;return e!==1||i!==1}function n4(n,t,e){e===void 0&&(e=!1);var i=Ps(t),r=Ps(t)&&e4(t),s=Pl(t),a=cf(n,r,e),l={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!e)&&((Wa(t)!=="body"||Wx(s))&&(l=t4(t)),Ps(t)?(u=cf(t,!0),u.x+=t.clientLeft,u.y+=t.clientTop):s&&(u.x=Vx(s))),{x:a.left+l.scrollLeft-u.x,y:a.top+l.scrollTop-u.y,width:a.width,height:a.height}}function i4(n){var t=new Map,e=new Set,i=[];n.forEach(function(s){t.set(s.name,s)});function r(s){e.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(l){if(!e.has(l)){var u=t.get(l);u&&r(u)}}),i.push(s)}return n.forEach(function(s){e.has(s.name)||r(s)}),i}function r4(n){var t=i4(n);return TT.reduce(function(e,i){return e.concat(t.filter(function(r){return r.phase===i}))},[])}function s4(n){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(n())})})),t}}function a4(n){var t=n.reduce(function(e,i){var r=e[i.name];return e[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,e},{});return Object.keys(t).map(function(e){return t[e]})}var Yw={placement:"bottom",modifiers:[],strategy:"absolute"};function Xw(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function Mg(n){n===void 0&&(n={});var t=n,e=t.defaultModifiers,i=e===void 0?[]:e,r=t.defaultOptions,s=r===void 0?Yw:r;return function(l,u,f){f===void 0&&(f=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Yw,s),modifiersData:{},elements:{reference:l,popper:u},attributes:{},styles:{}},p=[],m=!1,v={state:d,setOptions:function(E){var T=typeof E=="function"?E(d.options):E;_(),d.options=Object.assign({},s,d.options,T),d.scrollParents={reference:Dc(l)?_d(l):l.contextElement?_d(l.contextElement):[],popper:_d(u)};var S=r4(a4([].concat(i,d.options.modifiers)));return d.orderedModifiers=S.filter(function(O){return O.enabled}),x(),v.update()},forceUpdate:function(){if(!m){var E=d.elements,T=E.reference,S=E.popper;if(Xw(T,S)){d.rects={reference:n4(T,Qd(S),d.options.strategy==="fixed"),popper:zx(S)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(F){return d.modifiersData[F.name]=Object.assign({},F.data)});for(var O=0;O<d.orderedModifiers.length;O++){if(d.reset===!0){d.reset=!1,O=-1;continue}var R=d.orderedModifiers[O],N=R.fn,C=R.options,M=C===void 0?{}:C,I=R.name;typeof N=="function"&&(d=N({state:d,options:M,name:I,instance:v})||d)}}}},update:s4(function(){return new Promise(function(b){v.forceUpdate(),b(d)})}),destroy:function(){_(),m=!0}};if(!Xw(l,u))return v;v.setOptions(f).then(function(b){!m&&f.onFirstUpdate&&f.onFirstUpdate(b)});function x(){d.orderedModifiers.forEach(function(b){var E=b.name,T=b.options,S=T===void 0?{}:T,O=b.effect;if(typeof O=="function"){var R=O({state:d,name:E,instance:v,options:S}),N=function(){};p.push(R||N)}})}function _(){p.forEach(function(b){return b()}),p=[]}return v}}var o4=Mg(),l4=[$x,qx,Hx,Ux],c4=Mg({defaultModifiers:l4}),u4=[$x,qx,Hx,Ux,FT,MT,BT,kT,PT],Yx=Mg({defaultModifiers:u4});const Xx=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ET,afterRead:xT,afterWrite:ST,applyStyles:Ux,arrow:kT,auto:Lg,basePlacements:Ef,beforeMain:bT,beforeRead:vT,beforeWrite:wT,bottom:ps,clippingParents:mT,computeStyles:Hx,createPopper:Yx,createPopperBase:o4,createPopperLite:c4,detectOverflow:ff,end:of,eventListeners:$x,flip:MT,hide:PT,left:Cr,main:yT,modifierPhases:TT,offset:FT,placements:Fx,popper:zu,popperGenerator:Mg,popperOffsets:qx,preventOverflow:BT,read:_T,reference:gT,right:ms,start:Cc,top:Tr,variationPlacements:J_,viewport:Px,write:AT},Symbol.toStringTag,{value:"Module"})),UT=mk(Xx);var Lm={exports:{}},Im={exports:{}};/*!
  * Bootstrap data.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var f4=Im.exports,Kw;function h4(){return Kw||(Kw=1,function(n,t){(function(e,i){n.exports=i()})(f4,function(){const e=new Map;return{set(r,s,a){e.has(r)||e.set(r,new Map);const l=e.get(r);if(!l.has(s)&&l.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(l.keys())[0]}.`);return}l.set(s,a)},get(r,s){return e.has(r)&&e.get(r).get(s)||null},remove(r,s){if(!e.has(r))return;const a=e.get(r);a.delete(s),a.size===0&&e.delete(r)}}})}(Im)),Im.exports}var Mm={exports:{}},fd={exports:{}};/*!
  * Bootstrap index.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var d4=fd.exports,Zw;function zc(){return Zw||(Zw=1,function(n,t){(function(e,i){i(t)})(d4,function(e){const s="transitionend",a=F=>(F&&window.CSS&&window.CSS.escape&&(F=F.replace(/#([^\s"#']+)/g,(z,P)=>`#${CSS.escape(P)}`)),F),l=F=>F==null?`${F}`:Object.prototype.toString.call(F).match(/\s([a-z]+)/i)[1].toLowerCase(),u=F=>{do F+=Math.floor(Math.random()*1e6);while(document.getElementById(F));return F},f=F=>{if(!F)return 0;let{transitionDuration:z,transitionDelay:P}=window.getComputedStyle(F);const tt=Number.parseFloat(z),L=Number.parseFloat(P);return!tt&&!L?0:(z=z.split(",")[0],P=P.split(",")[0],(Number.parseFloat(z)+Number.parseFloat(P))*1e3)},d=F=>{F.dispatchEvent(new Event(s))},p=F=>!F||typeof F!="object"?!1:(typeof F.jquery<"u"&&(F=F[0]),typeof F.nodeType<"u"),m=F=>p(F)?F.jquery?F[0]:F:typeof F=="string"&&F.length>0?document.querySelector(a(F)):null,v=F=>{if(!p(F)||F.getClientRects().length===0)return!1;const z=getComputedStyle(F).getPropertyValue("visibility")==="visible",P=F.closest("details:not([open])");if(!P)return z;if(P!==F){const tt=F.closest("summary");if(tt&&tt.parentNode!==P||tt===null)return!1}return z},x=F=>!F||F.nodeType!==Node.ELEMENT_NODE||F.classList.contains("disabled")?!0:typeof F.disabled<"u"?F.disabled:F.hasAttribute("disabled")&&F.getAttribute("disabled")!=="false",_=F=>{if(!document.documentElement.attachShadow)return null;if(typeof F.getRootNode=="function"){const z=F.getRootNode();return z instanceof ShadowRoot?z:null}return F instanceof ShadowRoot?F:F.parentNode?_(F.parentNode):null},b=()=>{},E=F=>{F.offsetHeight},T=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,S=[],O=F=>{document.readyState==="loading"?(S.length||document.addEventListener("DOMContentLoaded",()=>{for(const z of S)z()}),S.push(F)):F()},R=()=>document.documentElement.dir==="rtl",N=F=>{O(()=>{const z=T();if(z){const P=F.NAME,tt=z.fn[P];z.fn[P]=F.jQueryInterface,z.fn[P].Constructor=F,z.fn[P].noConflict=()=>(z.fn[P]=tt,F.jQueryInterface)}})},C=(F,z=[],P=F)=>typeof F=="function"?F.call(...z):P,M=(F,z,P=!0)=>{if(!P){C(F);return}const L=f(z)+5;let nt=!1;const Q=({target:X})=>{X===z&&(nt=!0,z.removeEventListener(s,Q),C(F))};z.addEventListener(s,Q),setTimeout(()=>{nt||d(z)},L)},I=(F,z,P,tt)=>{const L=F.length;let nt=F.indexOf(z);return nt===-1?!P&&tt?F[L-1]:F[0]:(nt+=P?1:-1,tt&&(nt=(nt+L)%L),F[Math.max(0,Math.min(nt,L-1))])};e.defineJQueryPlugin=N,e.execute=C,e.executeAfterTransition=M,e.findShadowRoot=_,e.getElement=m,e.getNextActiveElement=I,e.getTransitionDurationFromElement=f,e.getUID=u,e.getjQuery=T,e.isDisabled=x,e.isElement=p,e.isRTL=R,e.isVisible=v,e.noop=b,e.onDOMContentLoaded=O,e.parseSelector=a,e.reflow=E,e.toType=l,e.triggerTransitionEnd=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})}(fd,fd.exports)),fd.exports}/*!
  * Bootstrap event-handler.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var p4=Mm.exports,Qw;function Kx(){return Qw||(Qw=1,function(n,t){(function(e,i){n.exports=i(zc())})(p4,function(e){const i=/[^.]*(?=\..*)\.|.*/,r=/\..*/,s=/::\d+$/,a={};let l=1;const u={mouseenter:"mouseover",mouseleave:"mouseout"},f=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function d(N,C){return C&&`${C}::${l++}`||N.uidEvent||l++}function p(N){const C=d(N);return N.uidEvent=C,a[C]=a[C]||{},a[C]}function m(N,C){return function M(I){return R(I,{delegateTarget:N}),M.oneOff&&O.off(N,I.type,C),C.apply(N,[I])}}function v(N,C,M){return function I(F){const z=N.querySelectorAll(C);for(let{target:P}=F;P&&P!==this;P=P.parentNode)for(const tt of z)if(tt===P)return R(F,{delegateTarget:P}),I.oneOff&&O.off(N,F.type,C,M),M.apply(P,[F])}}function x(N,C,M=null){return Object.values(N).find(I=>I.callable===C&&I.delegationSelector===M)}function _(N,C,M){const I=typeof C=="string",F=I?M:C||M;let z=S(N);return f.has(z)||(z=N),[I,F,z]}function b(N,C,M,I,F){if(typeof C!="string"||!N)return;let[z,P,tt]=_(C,M,I);C in u&&(P=(j=>function(J){if(!J.relatedTarget||J.relatedTarget!==J.delegateTarget&&!J.delegateTarget.contains(J.relatedTarget))return j.call(this,J)})(P));const L=p(N),nt=L[tt]||(L[tt]={}),Q=x(nt,P,z?M:null);if(Q){Q.oneOff=Q.oneOff&&F;return}const X=d(P,C.replace(i,"")),Rt=z?v(N,M,P):m(N,P);Rt.delegationSelector=z?M:null,Rt.callable=P,Rt.oneOff=F,Rt.uidEvent=X,nt[X]=Rt,N.addEventListener(tt,Rt,z)}function E(N,C,M,I,F){const z=x(C[M],I,F);z&&(N.removeEventListener(M,z,!!F),delete C[M][z.uidEvent])}function T(N,C,M,I){const F=C[M]||{};for(const[z,P]of Object.entries(F))z.includes(I)&&E(N,C,M,P.callable,P.delegationSelector)}function S(N){return N=N.replace(r,""),u[N]||N}const O={on(N,C,M,I){b(N,C,M,I,!1)},one(N,C,M,I){b(N,C,M,I,!0)},off(N,C,M,I){if(typeof C!="string"||!N)return;const[F,z,P]=_(C,M,I),tt=P!==C,L=p(N),nt=L[P]||{},Q=C.startsWith(".");if(typeof z<"u"){if(!Object.keys(nt).length)return;E(N,L,P,z,F?M:null);return}if(Q)for(const X of Object.keys(L))T(N,L,X,C.slice(1));for(const[X,Rt]of Object.entries(nt)){const yt=X.replace(s,"");(!tt||C.includes(yt))&&E(N,L,P,Rt.callable,Rt.delegationSelector)}},trigger(N,C,M){if(typeof C!="string"||!N)return null;const I=e.getjQuery(),F=S(C),z=C!==F;let P=null,tt=!0,L=!0,nt=!1;z&&I&&(P=I.Event(C,M),I(N).trigger(P),tt=!P.isPropagationStopped(),L=!P.isImmediatePropagationStopped(),nt=P.isDefaultPrevented());const Q=R(new Event(C,{bubbles:tt,cancelable:!0}),M);return nt&&Q.preventDefault(),L&&N.dispatchEvent(Q),Q.defaultPrevented&&P&&P.preventDefault(),Q}};function R(N,C={}){for(const[M,I]of Object.entries(C))try{N[M]=I}catch{Object.defineProperty(N,M,{configurable:!0,get(){return I}})}return N}return O})}(Mm)),Mm.exports}var Pm={exports:{}},Fm={exports:{}};/*!
  * Bootstrap manipulator.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var m4=Fm.exports,Jw;function Zx(){return Jw||(Jw=1,function(n,t){(function(e,i){n.exports=i()})(m4,function(){function e(s){if(s==="true")return!0;if(s==="false")return!1;if(s===Number(s).toString())return Number(s);if(s===""||s==="null")return null;if(typeof s!="string")return s;try{return JSON.parse(decodeURIComponent(s))}catch{return s}}function i(s){return s.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)}return{setDataAttribute(s,a,l){s.setAttribute(`data-bs-${i(a)}`,l)},removeDataAttribute(s,a){s.removeAttribute(`data-bs-${i(a)}`)},getDataAttributes(s){if(!s)return{};const a={},l=Object.keys(s.dataset).filter(u=>u.startsWith("bs")&&!u.startsWith("bsConfig"));for(const u of l){let f=u.replace(/^bs/,"");f=f.charAt(0).toLowerCase()+f.slice(1),a[f]=e(s.dataset[u])}return a},getDataAttribute(s,a){return e(s.getAttribute(`data-bs-${i(a)}`))}}})}(Fm)),Fm.exports}/*!
  * Bootstrap config.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var g4=Pm.exports,tA;function zT(){return tA||(tA=1,function(n,t){(function(e,i){n.exports=i(Zx(),zc())})(g4,function(e,i){class r{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(a){return a=this._mergeConfigObj(a),a=this._configAfterMerge(a),this._typeCheckConfig(a),a}_configAfterMerge(a){return a}_mergeConfigObj(a,l){const u=i.isElement(l)?e.getDataAttribute(l,"config"):{};return{...this.constructor.Default,...typeof u=="object"?u:{},...i.isElement(l)?e.getDataAttributes(l):{},...typeof a=="object"?a:{}}}_typeCheckConfig(a,l=this.constructor.DefaultType){for(const[u,f]of Object.entries(l)){const d=a[u],p=i.isElement(d)?"element":i.toType(d);if(!new RegExp(f).test(p))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${u}" provided type "${p}" but expected type "${f}".`)}}}return r})}(Pm)),Pm.exports}/*!
  * Bootstrap base-component.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var v4=Lm.exports,eA;function jT(){return eA||(eA=1,function(n,t){(function(e,i){n.exports=i(h4(),Kx(),zT(),zc())})(v4,function(e,i,r,s){const a="5.3.7";class l extends r{constructor(f,d){super(),f=s.getElement(f),f&&(this._element=f,this._config=this._getConfig(d),e.set(this._element,this.constructor.DATA_KEY,this))}dispose(){e.remove(this._element,this.constructor.DATA_KEY),i.off(this._element,this.constructor.EVENT_KEY);for(const f of Object.getOwnPropertyNames(this))this[f]=null}_queueCallback(f,d,p=!0){s.executeAfterTransition(f,d,p)}_getConfig(f){return f=this._mergeConfigObj(f,this._element),f=this._configAfterMerge(f),this._typeCheckConfig(f),f}static getInstance(f){return e.get(s.getElement(f),this.DATA_KEY)}static getOrCreateInstance(f,d={}){return this.getInstance(f)||new this(f,typeof d=="object"?d:null)}static get VERSION(){return a}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(f){return`${f}${this.EVENT_KEY}`}}return l})}(Lm)),Lm.exports}var hd={exports:{}};/*!
  * Bootstrap sanitizer.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var _4=hd.exports,nA;function HT(){return nA||(nA=1,function(n,t){(function(e,i){i(t)})(_4,function(e){const r={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},s=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),a=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,l=(f,d)=>{const p=f.nodeName.toLowerCase();return d.includes(p)?s.has(p)?!!a.test(f.nodeValue):!0:d.filter(m=>m instanceof RegExp).some(m=>m.test(p))};function u(f,d,p){if(!f.length)return f;if(p&&typeof p=="function")return p(f);const v=new window.DOMParser().parseFromString(f,"text/html"),x=[].concat(...v.body.querySelectorAll("*"));for(const _ of x){const b=_.nodeName.toLowerCase();if(!Object.keys(d).includes(b)){_.remove();continue}const E=[].concat(..._.attributes),T=[].concat(d["*"]||[],d[b]||[]);for(const S of E)l(S,T)||_.removeAttribute(S.nodeName)}return v.body.innerHTML}e.DefaultAllowlist=r,e.sanitizeHtml=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})}(hd,hd.exports)),hd.exports}var Bm={exports:{}},Um={exports:{}};/*!
  * Bootstrap selector-engine.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var x4=Um.exports,iA;function $T(){return iA||(iA=1,function(n,t){(function(e,i){n.exports=i(zc())})(x4,function(e){const i=s=>{let a=s.getAttribute("data-bs-target");if(!a||a==="#"){let l=s.getAttribute("href");if(!l||!l.includes("#")&&!l.startsWith("."))return null;l.includes("#")&&!l.startsWith("#")&&(l=`#${l.split("#")[1]}`),a=l&&l!=="#"?l.trim():null}return a?a.split(",").map(l=>e.parseSelector(l)).join(","):null},r={find(s,a=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(a,s))},findOne(s,a=document.documentElement){return Element.prototype.querySelector.call(a,s)},children(s,a){return[].concat(...s.children).filter(l=>l.matches(a))},parents(s,a){const l=[];let u=s.parentNode.closest(a);for(;u;)l.push(u),u=u.parentNode.closest(a);return l},prev(s,a){let l=s.previousElementSibling;for(;l;){if(l.matches(a))return[l];l=l.previousElementSibling}return[]},next(s,a){let l=s.nextElementSibling;for(;l;){if(l.matches(a))return[l];l=l.nextElementSibling}return[]},focusableChildren(s){const a=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(l=>`${l}:not([tabindex^="-"])`).join(",");return this.find(a,s).filter(l=>!e.isDisabled(l)&&e.isVisible(l))},getSelectorFromElement(s){const a=i(s);return a&&r.findOne(a)?a:null},getElementFromSelector(s){const a=i(s);return a?r.findOne(a):null},getMultipleElementsFromSelector(s){const a=i(s);return a?r.find(a):[]}};return r})}(Um)),Um.exports}/*!
  * Bootstrap template-factory.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var b4=Bm.exports,rA;function y4(){return rA||(rA=1,function(n,t){(function(e,i){n.exports=i($T(),zT(),HT(),zc())})(b4,function(e,i,r,s){const a="TemplateFactory",l={allowList:r.DefaultAllowlist,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},u={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},f={entry:"(string|element|function|null)",selector:"(string|element)"};class d extends i{constructor(m){super(),this._config=this._getConfig(m)}static get Default(){return l}static get DefaultType(){return u}static get NAME(){return a}getContent(){return Object.values(this._config.content).map(m=>this._resolvePossibleFunction(m)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(m){return this._checkContent(m),this._config.content={...this._config.content,...m},this}toHtml(){const m=document.createElement("div");m.innerHTML=this._maybeSanitize(this._config.template);for(const[_,b]of Object.entries(this._config.content))this._setContent(m,b,_);const v=m.children[0],x=this._resolvePossibleFunction(this._config.extraClass);return x&&v.classList.add(...x.split(" ")),v}_typeCheckConfig(m){super._typeCheckConfig(m),this._checkContent(m.content)}_checkContent(m){for(const[v,x]of Object.entries(m))super._typeCheckConfig({selector:v,entry:x},f)}_setContent(m,v,x){const _=e.findOne(x,m);if(_){if(v=this._resolvePossibleFunction(v),!v){_.remove();return}if(s.isElement(v)){this._putElementInTemplate(s.getElement(v),_);return}if(this._config.html){_.innerHTML=this._maybeSanitize(v);return}_.textContent=v}}_maybeSanitize(m){return this._config.sanitize?r.sanitizeHtml(m,this._config.allowList,this._config.sanitizeFn):m}_resolvePossibleFunction(m){return s.execute(m,[void 0,this])}_putElementInTemplate(m,v){if(this._config.html){v.innerHTML="",v.append(m);return}v.textContent=m.textContent}}return d})}(Bm)),Bm.exports}/*!
  * Bootstrap tooltip.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var E4=Nm.exports,sA;function w4(){return sA||(sA=1,function(n,t){(function(e,i){n.exports=i(UT,jT(),Kx(),Zx(),zc(),HT(),y4())})(E4,function(e,i,r,s,a,l,u){function f(J){const G=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(J){for(const ut in J)if(ut!=="default"){const gt=Object.getOwnPropertyDescriptor(J,ut);Object.defineProperty(G,ut,gt.get?gt:{enumerable:!0,get:()=>J[ut]})}}return G.default=J,Object.freeze(G)}const d=f(e),p="tooltip",m=new Set(["sanitize","allowList","sanitizeFn"]),v="fade",x="modal",_="show",b=".tooltip-inner",E=`.${x}`,T="hide.bs.modal",S="hover",O="focus",R="click",N="manual",C="hide",M="hidden",I="show",F="shown",z="inserted",P="click",tt="focusin",L="focusout",nt="mouseenter",Q="mouseleave",X={AUTO:"auto",TOP:"top",RIGHT:a.isRTL()?"left":"right",BOTTOM:"bottom",LEFT:a.isRTL()?"right":"left"},Rt={allowList:l.DefaultAllowlist,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},yt={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class j extends i{constructor(G,ut){if(typeof d>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(G,ut),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Rt}static get DefaultType(){return yt}static get NAME(){return p}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),r.off(this._element.closest(E),T,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const G=r.trigger(this._element,this.constructor.eventName(I)),gt=(a.findShadowRoot(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(G.defaultPrevented||!gt)return;this._disposePopper();const _t=this._getTipElement();this._element.setAttribute("aria-describedby",_t.getAttribute("id"));const{container:Bt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(Bt.append(_t),r.trigger(this._element,this.constructor.eventName(z))),this._popper=this._createPopper(_t),_t.classList.add(_),"ontouchstart"in document.documentElement)for(const H of[].concat(...document.body.children))r.on(H,"mouseover",a.noop);const Gt=()=>{r.trigger(this._element,this.constructor.eventName(F)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(Gt,this.tip,this._isAnimated())}hide(){if(!this._isShown()||r.trigger(this._element,this.constructor.eventName(C)).defaultPrevented)return;if(this._getTipElement().classList.remove(_),"ontouchstart"in document.documentElement)for(const _t of[].concat(...document.body.children))r.off(_t,"mouseover",a.noop);this._activeTrigger[R]=!1,this._activeTrigger[O]=!1,this._activeTrigger[S]=!1,this._isHovered=null;const gt=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),r.trigger(this._element,this.constructor.eventName(M)))};this._queueCallback(gt,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(G){const ut=this._getTemplateFactory(G).toHtml();if(!ut)return null;ut.classList.remove(v,_),ut.classList.add(`bs-${this.constructor.NAME}-auto`);const gt=a.getUID(this.constructor.NAME).toString();return ut.setAttribute("id",gt),this._isAnimated()&&ut.classList.add(v),ut}setContent(G){this._newContent=G,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(G){return this._templateFactory?this._templateFactory.changeContent(G):this._templateFactory=new u({...this._config,content:G,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[b]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(G){return this.constructor.getOrCreateInstance(G.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(v)}_isShown(){return this.tip&&this.tip.classList.contains(_)}_createPopper(G){const ut=a.execute(this._config.placement,[this,G,this._element]),gt=X[ut.toUpperCase()];return d.createPopper(this._element,G,this._getPopperConfig(gt))}_getOffset(){const{offset:G}=this._config;return typeof G=="string"?G.split(",").map(ut=>Number.parseInt(ut,10)):typeof G=="function"?ut=>G(ut,this._element):G}_resolvePossibleFunction(G){return a.execute(G,[this._element,this._element])}_getPopperConfig(G){const ut={placement:G,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:gt=>{this._getTipElement().setAttribute("data-popper-placement",gt.state.placement)}}]};return{...ut,...a.execute(this._config.popperConfig,[void 0,ut])}}_setListeners(){const G=this._config.trigger.split(" ");for(const ut of G)if(ut==="click")r.on(this._element,this.constructor.eventName(P),this._config.selector,gt=>{const _t=this._initializeOnDelegatedTarget(gt);_t._activeTrigger[R]=!(_t._isShown()&&_t._activeTrigger[R]),_t.toggle()});else if(ut!==N){const gt=ut===S?this.constructor.eventName(nt):this.constructor.eventName(tt),_t=ut===S?this.constructor.eventName(Q):this.constructor.eventName(L);r.on(this._element,gt,this._config.selector,Bt=>{const Gt=this._initializeOnDelegatedTarget(Bt);Gt._activeTrigger[Bt.type==="focusin"?O:S]=!0,Gt._enter()}),r.on(this._element,_t,this._config.selector,Bt=>{const Gt=this._initializeOnDelegatedTarget(Bt);Gt._activeTrigger[Bt.type==="focusout"?O:S]=Gt._element.contains(Bt.relatedTarget),Gt._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},r.on(this._element.closest(E),T,this._hideModalHandler)}_fixTitle(){const G=this._element.getAttribute("title");G&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",G),this._element.setAttribute("data-bs-original-title",G),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(G,ut){clearTimeout(this._timeout),this._timeout=setTimeout(G,ut)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(G){const ut=s.getDataAttributes(this._element);for(const gt of Object.keys(ut))m.has(gt)&&delete ut[gt];return G={...ut,...typeof G=="object"&&G?G:{}},G=this._mergeConfigObj(G),G=this._configAfterMerge(G),this._typeCheckConfig(G),G}_configAfterMerge(G){return G.container=G.container===!1?document.body:a.getElement(G.container),typeof G.delay=="number"&&(G.delay={show:G.delay,hide:G.delay}),typeof G.title=="number"&&(G.title=G.title.toString()),typeof G.content=="number"&&(G.content=G.content.toString()),G}_getDelegateConfig(){const G={};for(const[ut,gt]of Object.entries(this._config))this.constructor.Default[ut]!==gt&&(G[ut]=gt);return G.selector=!1,G.trigger="manual",G}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(G){return this.each(function(){const ut=j.getOrCreateInstance(this,G);if(typeof G=="string"){if(typeof ut[G]>"u")throw new TypeError(`No method named "${G}"`);ut[G]()}})}}return a.defineJQueryPlugin(j),j})}(Nm)),Nm.exports}w4();var zm={exports:{}};/*!
  * Bootstrap dropdown.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var A4=zm.exports,aA;function S4(){return aA||(aA=1,function(n,t){(function(e,i){n.exports=i(UT,jT(),Kx(),Zx(),$T(),zc())})(A4,function(e,i,r,s,a,l){function u(Lt){const D=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(Lt){for(const dt in Lt)if(dt!=="default"){const st=Object.getOwnPropertyDescriptor(Lt,dt);Object.defineProperty(D,dt,st.get?st:{enumerable:!0,get:()=>Lt[dt]})}}return D.default=Lt,Object.freeze(D)}const f=u(e),d="dropdown",m=".bs.dropdown",v=".data-api",x="Escape",_="Tab",b="ArrowUp",E="ArrowDown",T=2,S=`hide${m}`,O=`hidden${m}`,R=`show${m}`,N=`shown${m}`,C=`click${m}${v}`,M=`keydown${m}${v}`,I=`keyup${m}${v}`,F="show",z="dropup",P="dropend",tt="dropstart",L="dropup-center",nt="dropdown-center",Q='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',X=`${Q}.${F}`,Rt=".dropdown-menu",yt=".navbar",j=".navbar-nav",J=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",G=l.isRTL()?"top-end":"top-start",ut=l.isRTL()?"top-start":"top-end",gt=l.isRTL()?"bottom-end":"bottom-start",_t=l.isRTL()?"bottom-start":"bottom-end",Bt=l.isRTL()?"left-start":"right-start",Gt=l.isRTL()?"right-start":"left-start",H="top",mt="bottom",lt={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},ct={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ct extends i{constructor(D,dt){super(D,dt),this._popper=null,this._parent=this._element.parentNode,this._menu=a.next(this._element,Rt)[0]||a.prev(this._element,Rt)[0]||a.findOne(Rt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return lt}static get DefaultType(){return ct}static get NAME(){return d}toggle(){return this._isShown()?this.hide():this.show()}show(){if(l.isDisabled(this._element)||this._isShown())return;const D={relatedTarget:this._element};if(!r.trigger(this._element,R,D).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(j))for(const st of[].concat(...document.body.children))r.on(st,"mouseover",l.noop);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(F),this._element.classList.add(F),r.trigger(this._element,N,D)}}hide(){if(l.isDisabled(this._element)||!this._isShown())return;const D={relatedTarget:this._element};this._completeHide(D)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(D){if(!r.trigger(this._element,S,D).defaultPrevented){if("ontouchstart"in document.documentElement)for(const st of[].concat(...document.body.children))r.off(st,"mouseover",l.noop);this._popper&&this._popper.destroy(),this._menu.classList.remove(F),this._element.classList.remove(F),this._element.setAttribute("aria-expanded","false"),s.removeDataAttribute(this._menu,"popper"),r.trigger(this._element,O,D),this._element.focus()}}_getConfig(D){if(D=super._getConfig(D),typeof D.reference=="object"&&!l.isElement(D.reference)&&typeof D.reference.getBoundingClientRect!="function")throw new TypeError(`${d.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return D}_createPopper(){if(typeof f>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let D=this._element;this._config.reference==="parent"?D=this._parent:l.isElement(this._config.reference)?D=l.getElement(this._config.reference):typeof this._config.reference=="object"&&(D=this._config.reference);const dt=this._getPopperConfig();this._popper=f.createPopper(D,this._menu,dt)}_isShown(){return this._menu.classList.contains(F)}_getPlacement(){const D=this._parent;if(D.classList.contains(P))return Bt;if(D.classList.contains(tt))return Gt;if(D.classList.contains(L))return H;if(D.classList.contains(nt))return mt;const dt=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return D.classList.contains(z)?dt?ut:G:dt?_t:gt}_detectNavbar(){return this._element.closest(yt)!==null}_getOffset(){const{offset:D}=this._config;return typeof D=="string"?D.split(",").map(dt=>Number.parseInt(dt,10)):typeof D=="function"?dt=>D(dt,this._element):D}_getPopperConfig(){const D={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(s.setDataAttribute(this._menu,"popper","static"),D.modifiers=[{name:"applyStyles",enabled:!1}]),{...D,...l.execute(this._config.popperConfig,[void 0,D])}}_selectMenuItem({key:D,target:dt}){const st=a.find(J,this._menu).filter(Y=>l.isVisible(Y));st.length&&l.getNextActiveElement(st,dt,D===E,!st.includes(dt)).focus()}static jQueryInterface(D){return this.each(function(){const dt=Ct.getOrCreateInstance(this,D);if(typeof D=="string"){if(typeof dt[D]>"u")throw new TypeError(`No method named "${D}"`);dt[D]()}})}static clearMenus(D){if(D.button===T||D.type==="keyup"&&D.key!==_)return;const dt=a.find(X);for(const st of dt){const Y=Ct.getInstance(st);if(!Y||Y._config.autoClose===!1)continue;const q=D.composedPath(),ft=q.includes(Y._menu);if(q.includes(Y._element)||Y._config.autoClose==="inside"&&!ft||Y._config.autoClose==="outside"&&ft||Y._menu.contains(D.target)&&(D.type==="keyup"&&D.key===_||/input|select|option|textarea|form/i.test(D.target.tagName)))continue;const Pt={relatedTarget:Y._element};D.type==="click"&&(Pt.clickEvent=D),Y._completeHide(Pt)}}static dataApiKeydownHandler(D){const dt=/input|textarea/i.test(D.target.tagName),st=D.key===x,Y=[b,E].includes(D.key);if(!Y&&!st||dt&&!st)return;D.preventDefault();const q=this.matches(Q)?this:a.prev(this,Q)[0]||a.next(this,Q)[0]||a.findOne(Q,D.delegateTarget.parentNode),ft=Ct.getOrCreateInstance(q);if(Y){D.stopPropagation(),ft.show(),ft._selectMenuItem(D);return}ft._isShown()&&(D.stopPropagation(),ft.hide(),q.focus())}}return r.on(document,M,Q,Ct.dataApiKeydownHandler),r.on(document,M,Rt,Ct.dataApiKeydownHandler),r.on(document,C,Ct.clearMenus),r.on(document,I,Ct.clearMenus),r.on(document,C,Q,function(Lt){Lt.preventDefault(),Ct.getOrCreateInstance(this).toggle()}),l.defineJQueryPlugin(Ct),Ct})}(zm)),zm.exports}S4();var jm={exports:{}};/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var T4=jm.exports,oA;function C4(){return oA||(oA=1,function(n,t){(function(e,i){n.exports=i()})(T4,function(){const e=new Map,i={set(U,w,k){e.has(U)||e.set(U,new Map);const K=e.get(U);K.has(w)||K.size===0?K.set(w,k):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(K.keys())[0]}.`)},get:(U,w)=>e.has(U)&&e.get(U).get(w)||null,remove(U,w){if(!e.has(U))return;const k=e.get(U);k.delete(w),k.size===0&&e.delete(U)}},r="transitionend",s=U=>(U&&window.CSS&&window.CSS.escape&&(U=U.replace(/#([^\s"#']+)/g,(w,k)=>`#${CSS.escape(k)}`)),U),a=U=>{U.dispatchEvent(new Event(r))},l=U=>!(!U||typeof U!="object")&&(U.jquery!==void 0&&(U=U[0]),U.nodeType!==void 0),u=U=>l(U)?U.jquery?U[0]:U:typeof U=="string"&&U.length>0?document.querySelector(s(U)):null,f=U=>{if(!l(U)||U.getClientRects().length===0)return!1;const w=getComputedStyle(U).getPropertyValue("visibility")==="visible",k=U.closest("details:not([open])");if(!k)return w;if(k!==U){const K=U.closest("summary");if(K&&K.parentNode!==k||K===null)return!1}return w},d=U=>!U||U.nodeType!==Node.ELEMENT_NODE||!!U.classList.contains("disabled")||(U.disabled!==void 0?U.disabled:U.hasAttribute("disabled")&&U.getAttribute("disabled")!=="false"),p=U=>{if(!document.documentElement.attachShadow)return null;if(typeof U.getRootNode=="function"){const w=U.getRootNode();return w instanceof ShadowRoot?w:null}return U instanceof ShadowRoot?U:U.parentNode?p(U.parentNode):null},m=()=>{},v=U=>{U.offsetHeight},x=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_=[],b=()=>document.documentElement.dir==="rtl",E=U=>{var w;w=()=>{const k=x();if(k){const K=U.NAME,bt=k.fn[K];k.fn[K]=U.jQueryInterface,k.fn[K].Constructor=U,k.fn[K].noConflict=()=>(k.fn[K]=bt,U.jQueryInterface)}},document.readyState==="loading"?(_.length||document.addEventListener("DOMContentLoaded",()=>{for(const k of _)k()}),_.push(w)):w()},T=(U,w=[],k=U)=>typeof U=="function"?U.call(...w):k,S=(U,w,k=!0)=>{if(!k)return void T(U);const K=($t=>{if(!$t)return 0;let{transitionDuration:qt,transitionDelay:re}=window.getComputedStyle($t);const fe=Number.parseFloat(qt),he=Number.parseFloat(re);return fe||he?(qt=qt.split(",")[0],re=re.split(",")[0],1e3*(Number.parseFloat(qt)+Number.parseFloat(re))):0})(w)+5;let bt=!1;const St=({target:$t})=>{$t===w&&(bt=!0,w.removeEventListener(r,St),T(U))};w.addEventListener(r,St),setTimeout(()=>{bt||a(w)},K)},O=(U,w,k,K)=>{const bt=U.length;let St=U.indexOf(w);return St===-1?!k&&K?U[bt-1]:U[0]:(St+=k?1:-1,K&&(St=(St+bt)%bt),U[Math.max(0,Math.min(St,bt-1))])},R=/[^.]*(?=\..*)\.|.*/,N=/\..*/,C=/::\d+$/,M={};let I=1;const F={mouseenter:"mouseover",mouseleave:"mouseout"},z=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function P(U,w){return w&&`${w}::${I++}`||U.uidEvent||I++}function tt(U){const w=P(U);return U.uidEvent=w,M[w]=M[w]||{},M[w]}function L(U,w,k=null){return Object.values(U).find(K=>K.callable===w&&K.delegationSelector===k)}function nt(U,w,k){const K=typeof w=="string",bt=K?k:w||k;let St=yt(U);return z.has(St)||(St=U),[K,bt,St]}function Q(U,w,k,K,bt){if(typeof w!="string"||!U)return;let[St,$t,qt]=nt(w,k,K);w in F&&($t=(Fe=>function(Ne){if(!Ne.relatedTarget||Ne.relatedTarget!==Ne.delegateTarget&&!Ne.delegateTarget.contains(Ne.relatedTarget))return Fe.call(this,Ne)})($t));const re=tt(U),fe=re[qt]||(re[qt]={}),he=L(fe,$t,St?k:null);if(he)return void(he.oneOff=he.oneOff&&bt);const ce=P($t,w.replace(R,"")),Pe=St?function(Ee,Fe,Ne){return function Te(on){const pn=Ee.querySelectorAll(Fe);for(let{target:je}=on;je&&je!==this;je=je.parentNode)for(const Qe of pn)if(Qe===je)return J(on,{delegateTarget:je}),Te.oneOff&&j.off(Ee,on.type,Fe,Ne),Ne.apply(je,[on])}}(U,k,$t):function(Ee,Fe){return function Ne(Te){return J(Te,{delegateTarget:Ee}),Ne.oneOff&&j.off(Ee,Te.type,Fe),Fe.apply(Ee,[Te])}}(U,$t);Pe.delegationSelector=St?k:null,Pe.callable=$t,Pe.oneOff=bt,Pe.uidEvent=ce,fe[ce]=Pe,U.addEventListener(qt,Pe,St)}function X(U,w,k,K,bt){const St=L(w[k],K,bt);St&&(U.removeEventListener(k,St,!!bt),delete w[k][St.uidEvent])}function Rt(U,w,k,K){const bt=w[k]||{};for(const[St,$t]of Object.entries(bt))St.includes(K)&&X(U,w,k,$t.callable,$t.delegationSelector)}function yt(U){return U=U.replace(N,""),F[U]||U}const j={on(U,w,k,K){Q(U,w,k,K,!1)},one(U,w,k,K){Q(U,w,k,K,!0)},off(U,w,k,K){if(typeof w!="string"||!U)return;const[bt,St,$t]=nt(w,k,K),qt=$t!==w,re=tt(U),fe=re[$t]||{},he=w.startsWith(".");if(St===void 0){if(he)for(const ce of Object.keys(re))Rt(U,re,ce,w.slice(1));for(const[ce,Pe]of Object.entries(fe)){const Ee=ce.replace(C,"");qt&&!w.includes(Ee)||X(U,re,$t,Pe.callable,Pe.delegationSelector)}}else{if(!Object.keys(fe).length)return;X(U,re,$t,St,bt?k:null)}},trigger(U,w,k){if(typeof w!="string"||!U)return null;const K=x();let bt=null,St=!0,$t=!0,qt=!1;w!==yt(w)&&K&&(bt=K.Event(w,k),K(U).trigger(bt),St=!bt.isPropagationStopped(),$t=!bt.isImmediatePropagationStopped(),qt=bt.isDefaultPrevented());const re=J(new Event(w,{bubbles:St,cancelable:!0}),k);return qt&&re.preventDefault(),$t&&U.dispatchEvent(re),re.defaultPrevented&&bt&&bt.preventDefault(),re}};function J(U,w={}){for(const[k,K]of Object.entries(w))try{U[k]=K}catch{Object.defineProperty(U,k,{configurable:!0,get:()=>K})}return U}function G(U){if(U==="true")return!0;if(U==="false")return!1;if(U===Number(U).toString())return Number(U);if(U===""||U==="null")return null;if(typeof U!="string")return U;try{return JSON.parse(decodeURIComponent(U))}catch{return U}}function ut(U){return U.replace(/[A-Z]/g,w=>`-${w.toLowerCase()}`)}const gt={setDataAttribute(U,w,k){U.setAttribute(`data-bs-${ut(w)}`,k)},removeDataAttribute(U,w){U.removeAttribute(`data-bs-${ut(w)}`)},getDataAttributes(U){if(!U)return{};const w={},k=Object.keys(U.dataset).filter(K=>K.startsWith("bs")&&!K.startsWith("bsConfig"));for(const K of k){let bt=K.replace(/^bs/,"");bt=bt.charAt(0).toLowerCase()+bt.slice(1),w[bt]=G(U.dataset[K])}return w},getDataAttribute:(U,w)=>G(U.getAttribute(`data-bs-${ut(w)}`))};class _t{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(w){return w=this._mergeConfigObj(w),w=this._configAfterMerge(w),this._typeCheckConfig(w),w}_configAfterMerge(w){return w}_mergeConfigObj(w,k){const K=l(k)?gt.getDataAttribute(k,"config"):{};return{...this.constructor.Default,...typeof K=="object"?K:{},...l(k)?gt.getDataAttributes(k):{},...typeof w=="object"?w:{}}}_typeCheckConfig(w,k=this.constructor.DefaultType){for(const[bt,St]of Object.entries(k)){const $t=w[bt],qt=l($t)?"element":(K=$t)==null?`${K}`:Object.prototype.toString.call(K).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(St).test(qt))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${bt}" provided type "${qt}" but expected type "${St}".`)}var K}}class Bt extends _t{constructor(w,k){super(),(w=u(w))&&(this._element=w,this._config=this._getConfig(k),i.set(this._element,this.constructor.DATA_KEY,this))}dispose(){i.remove(this._element,this.constructor.DATA_KEY),j.off(this._element,this.constructor.EVENT_KEY);for(const w of Object.getOwnPropertyNames(this))this[w]=null}_queueCallback(w,k,K=!0){S(w,k,K)}_getConfig(w){return w=this._mergeConfigObj(w,this._element),w=this._configAfterMerge(w),this._typeCheckConfig(w),w}static getInstance(w){return i.get(u(w),this.DATA_KEY)}static getOrCreateInstance(w,k={}){return this.getInstance(w)||new this(w,typeof k=="object"?k:null)}static get VERSION(){return"5.3.7"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(w){return`${w}${this.EVENT_KEY}`}}const Gt=U=>{let w=U.getAttribute("data-bs-target");if(!w||w==="#"){let k=U.getAttribute("href");if(!k||!k.includes("#")&&!k.startsWith("."))return null;k.includes("#")&&!k.startsWith("#")&&(k=`#${k.split("#")[1]}`),w=k&&k!=="#"?k.trim():null}return w?w.split(",").map(k=>s(k)).join(","):null},H={find:(U,w=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(w,U)),findOne:(U,w=document.documentElement)=>Element.prototype.querySelector.call(w,U),children:(U,w)=>[].concat(...U.children).filter(k=>k.matches(w)),parents(U,w){const k=[];let K=U.parentNode.closest(w);for(;K;)k.push(K),K=K.parentNode.closest(w);return k},prev(U,w){let k=U.previousElementSibling;for(;k;){if(k.matches(w))return[k];k=k.previousElementSibling}return[]},next(U,w){let k=U.nextElementSibling;for(;k;){if(k.matches(w))return[k];k=k.nextElementSibling}return[]},focusableChildren(U){const w=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(k=>`${k}:not([tabindex^="-"])`).join(",");return this.find(w,U).filter(k=>!d(k)&&f(k))},getSelectorFromElement(U){const w=Gt(U);return w&&H.findOne(w)?w:null},getElementFromSelector(U){const w=Gt(U);return w?H.findOne(w):null},getMultipleElementsFromSelector(U){const w=Gt(U);return w?H.find(w):[]}},mt=(U,w="hide")=>{const k=`click.dismiss${U.EVENT_KEY}`,K=U.NAME;j.on(document,k,`[data-bs-dismiss="${K}"]`,function(bt){if(["A","AREA"].includes(this.tagName)&&bt.preventDefault(),d(this))return;const St=H.getElementFromSelector(this)||this.closest(`.${K}`);U.getOrCreateInstance(St)[w]()})},lt=".bs.alert",ct=`close${lt}`,Ct=`closed${lt}`;class Lt extends Bt{static get NAME(){return"alert"}close(){if(j.trigger(this._element,ct).defaultPrevented)return;this._element.classList.remove("show");const w=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,w)}_destroyElement(){this._element.remove(),j.trigger(this._element,Ct),this.dispose()}static jQueryInterface(w){return this.each(function(){const k=Lt.getOrCreateInstance(this);if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w](this)}})}}mt(Lt,"close"),E(Lt);const D='[data-bs-toggle="button"]';class dt extends Bt{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(w){return this.each(function(){const k=dt.getOrCreateInstance(this);w==="toggle"&&k[w]()})}}j.on(document,"click.bs.button.data-api",D,U=>{U.preventDefault();const w=U.target.closest(D);dt.getOrCreateInstance(w).toggle()}),E(dt);const st=".bs.swipe",Y=`touchstart${st}`,q=`touchmove${st}`,ft=`touchend${st}`,Pt=`pointerdown${st}`,jt=`pointerup${st}`,wt={endCallback:null,leftCallback:null,rightCallback:null},Nt={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class At extends _t{constructor(w,k){super(),this._element=w,w&&At.isSupported()&&(this._config=this._getConfig(k),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return wt}static get DefaultType(){return Nt}static get NAME(){return"swipe"}dispose(){j.off(this._element,st)}_start(w){this._supportPointerEvents?this._eventIsPointerPenTouch(w)&&(this._deltaX=w.clientX):this._deltaX=w.touches[0].clientX}_end(w){this._eventIsPointerPenTouch(w)&&(this._deltaX=w.clientX-this._deltaX),this._handleSwipe(),T(this._config.endCallback)}_move(w){this._deltaX=w.touches&&w.touches.length>1?0:w.touches[0].clientX-this._deltaX}_handleSwipe(){const w=Math.abs(this._deltaX);if(w<=40)return;const k=w/this._deltaX;this._deltaX=0,k&&T(k>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(j.on(this._element,Pt,w=>this._start(w)),j.on(this._element,jt,w=>this._end(w)),this._element.classList.add("pointer-event")):(j.on(this._element,Y,w=>this._start(w)),j.on(this._element,q,w=>this._move(w)),j.on(this._element,ft,w=>this._end(w)))}_eventIsPointerPenTouch(w){return this._supportPointerEvents&&(w.pointerType==="pen"||w.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const pt=".bs.carousel",te=".data-api",ae="ArrowLeft",ne="ArrowRight",Re="next",rn="prev",ye="left",ln="right",Ve=`slide${pt}`,zn=`slid${pt}`,Cn=`keydown${pt}`,bn=`mouseenter${pt}`,mi=`mouseleave${pt}`,vs=`dragstart${pt}`,Gs=`load${pt}${te}`,Xa=`click${pt}${te}`,Vs="carousel",wi="active",Or=".active",zl=".carousel-item",Kc=Or+zl,jl={[ae]:ln,[ne]:ye},Hl={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Zc={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class fa extends Bt{constructor(w,k){super(w,k),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=H.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Vs&&this.cycle()}static get Default(){return Hl}static get DefaultType(){return Zc}static get NAME(){return"carousel"}next(){this._slide(Re)}nextWhenVisible(){!document.hidden&&f(this._element)&&this.next()}prev(){this._slide(rn)}pause(){this._isSliding&&a(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?j.one(this._element,zn,()=>this.cycle()):this.cycle())}to(w){const k=this._getItems();if(w>k.length-1||w<0)return;if(this._isSliding)return void j.one(this._element,zn,()=>this.to(w));const K=this._getItemIndex(this._getActive());if(K===w)return;const bt=w>K?Re:rn;this._slide(bt,k[w])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(w){return w.defaultInterval=w.interval,w}_addEventListeners(){this._config.keyboard&&j.on(this._element,Cn,w=>this._keydown(w)),this._config.pause==="hover"&&(j.on(this._element,bn,()=>this.pause()),j.on(this._element,mi,()=>this._maybeEnableCycle())),this._config.touch&&At.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const k of H.find(".carousel-item img",this._element))j.on(k,vs,K=>K.preventDefault());const w={leftCallback:()=>this._slide(this._directionToOrder(ye)),rightCallback:()=>this._slide(this._directionToOrder(ln)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new At(this._element,w)}_keydown(w){if(/input|textarea/i.test(w.target.tagName))return;const k=jl[w.key];k&&(w.preventDefault(),this._slide(this._directionToOrder(k)))}_getItemIndex(w){return this._getItems().indexOf(w)}_setActiveIndicatorElement(w){if(!this._indicatorsElement)return;const k=H.findOne(Or,this._indicatorsElement);k.classList.remove(wi),k.removeAttribute("aria-current");const K=H.findOne(`[data-bs-slide-to="${w}"]`,this._indicatorsElement);K&&(K.classList.add(wi),K.setAttribute("aria-current","true"))}_updateInterval(){const w=this._activeElement||this._getActive();if(!w)return;const k=Number.parseInt(w.getAttribute("data-bs-interval"),10);this._config.interval=k||this._config.defaultInterval}_slide(w,k=null){if(this._isSliding)return;const K=this._getActive(),bt=w===Re,St=k||O(this._getItems(),K,bt,this._config.wrap);if(St===K)return;const $t=this._getItemIndex(St),qt=ce=>j.trigger(this._element,ce,{relatedTarget:St,direction:this._orderToDirection(w),from:this._getItemIndex(K),to:$t});if(qt(Ve).defaultPrevented||!K||!St)return;const re=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement($t),this._activeElement=St;const fe=bt?"carousel-item-start":"carousel-item-end",he=bt?"carousel-item-next":"carousel-item-prev";St.classList.add(he),v(St),K.classList.add(fe),St.classList.add(fe),this._queueCallback(()=>{St.classList.remove(fe,he),St.classList.add(wi),K.classList.remove(wi,he,fe),this._isSliding=!1,qt(zn)},K,this._isAnimated()),re&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return H.findOne(Kc,this._element)}_getItems(){return H.find(zl,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(w){return b()?w===ye?rn:Re:w===ye?Re:rn}_orderToDirection(w){return b()?w===rn?ye:ln:w===rn?ln:ye}static jQueryInterface(w){return this.each(function(){const k=fa.getOrCreateInstance(this,w);if(typeof w!="number"){if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w]()}}else k.to(w)})}}j.on(document,Xa,"[data-bs-slide], [data-bs-slide-to]",function(U){const w=H.getElementFromSelector(this);if(!w||!w.classList.contains(Vs))return;U.preventDefault();const k=fa.getOrCreateInstance(w),K=this.getAttribute("data-bs-slide-to");return K?(k.to(K),void k._maybeEnableCycle()):gt.getDataAttribute(this,"slide")==="next"?(k.next(),void k._maybeEnableCycle()):(k.prev(),void k._maybeEnableCycle())}),j.on(window,Gs,()=>{const U=H.find('[data-bs-ride="carousel"]');for(const w of U)fa.getOrCreateInstance(w)}),E(fa);const Gi=".bs.collapse",ii=`show${Gi}`,ri=`shown${Gi}`,ha=`hide${Gi}`,$l=`hidden${Gi}`,Mf=`click${Gi}.data-api`,V="show",rt="collapse",Z="collapsing",et=`:scope .${rt} .${rt}`,it='[data-bs-toggle="collapse"]',ot={parent:null,toggle:!0},It={parent:"(null|element)",toggle:"boolean"};class Ht extends Bt{constructor(w,k){super(w,k),this._isTransitioning=!1,this._triggerArray=[];const K=H.find(it);for(const bt of K){const St=H.getSelectorFromElement(bt),$t=H.find(St).filter(qt=>qt===this._element);St!==null&&$t.length&&this._triggerArray.push(bt)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ot}static get DefaultType(){return It}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let w=[];if(this._config.parent&&(w=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(bt=>bt!==this._element).map(bt=>Ht.getOrCreateInstance(bt,{toggle:!1}))),w.length&&w[0]._isTransitioning||j.trigger(this._element,ii).defaultPrevented)return;for(const bt of w)bt.hide();const k=this._getDimension();this._element.classList.remove(rt),this._element.classList.add(Z),this._element.style[k]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const K=`scroll${k[0].toUpperCase()+k.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Z),this._element.classList.add(rt,V),this._element.style[k]="",j.trigger(this._element,ri)},this._element,!0),this._element.style[k]=`${this._element[K]}px`}hide(){if(this._isTransitioning||!this._isShown()||j.trigger(this._element,ha).defaultPrevented)return;const w=this._getDimension();this._element.style[w]=`${this._element.getBoundingClientRect()[w]}px`,v(this._element),this._element.classList.add(Z),this._element.classList.remove(rt,V);for(const k of this._triggerArray){const K=H.getElementFromSelector(k);K&&!this._isShown(K)&&this._addAriaAndCollapsedClass([k],!1)}this._isTransitioning=!0,this._element.style[w]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Z),this._element.classList.add(rt),j.trigger(this._element,$l)},this._element,!0)}_isShown(w=this._element){return w.classList.contains(V)}_configAfterMerge(w){return w.toggle=!!w.toggle,w.parent=u(w.parent),w}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const w=this._getFirstLevelChildren(it);for(const k of w){const K=H.getElementFromSelector(k);K&&this._addAriaAndCollapsedClass([k],this._isShown(K))}}_getFirstLevelChildren(w){const k=H.find(et,this._config.parent);return H.find(w,this._config.parent).filter(K=>!k.includes(K))}_addAriaAndCollapsedClass(w,k){if(w.length)for(const K of w)K.classList.toggle("collapsed",!k),K.setAttribute("aria-expanded",k)}static jQueryInterface(w){const k={};return typeof w=="string"&&/show|hide/.test(w)&&(k.toggle=!1),this.each(function(){const K=Ht.getOrCreateInstance(this,k);if(typeof w=="string"){if(K[w]===void 0)throw new TypeError(`No method named "${w}"`);K[w]()}})}}j.on(document,Mf,it,function(U){(U.target.tagName==="A"||U.delegateTarget&&U.delegateTarget.tagName==="A")&&U.preventDefault();for(const w of H.getMultipleElementsFromSelector(this))Ht.getOrCreateInstance(w,{toggle:!1}).toggle()}),E(Ht);var Et="top",Dt="bottom",Ot="right",Wt="left",ee="auto",le=[Et,Dt,Ot,Wt],Qt="start",ie="end",Ie="clippingParents",sn="viewport",Ze="popper",dn="reference",qr=le.reduce(function(U,w){return U.concat([w+"-"+Qt,w+"-"+ie])},[]),_s=[].concat(le,[ee]).reduce(function(U,w){return U.concat([w,w+"-"+Qt,w+"-"+ie])},[]),cr="beforeRead",Rr="read",da="afterRead",Nr="beforeMain",Pf="main",ur="afterMain",Ff="beforeWrite",xp="write",Gl="afterWrite",Bf=[cr,Rr,da,Nr,Pf,ur,Ff,xp,Gl];function fr(U){return U?(U.nodeName||"").toLowerCase():null}function hr(U){if(U==null)return window;if(U.toString()!=="[object Window]"){var w=U.ownerDocument;return w&&w.defaultView||window}return U}function si(U){return U instanceof hr(U).Element||U instanceof Element}function Vi(U){return U instanceof hr(U).HTMLElement||U instanceof HTMLElement}function Qc(U){return typeof ShadowRoot<"u"&&(U instanceof hr(U).ShadowRoot||U instanceof ShadowRoot)}const Vl={name:"applyStyles",enabled:!0,phase:"write",fn:function(U){var w=U.state;Object.keys(w.elements).forEach(function(k){var K=w.styles[k]||{},bt=w.attributes[k]||{},St=w.elements[k];Vi(St)&&fr(St)&&(Object.assign(St.style,K),Object.keys(bt).forEach(function($t){var qt=bt[$t];qt===!1?St.removeAttribute($t):St.setAttribute($t,qt===!0?"":qt)}))})},effect:function(U){var w=U.state,k={popper:{position:w.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(w.elements.popper.style,k.popper),w.styles=k,w.elements.arrow&&Object.assign(w.elements.arrow.style,k.arrow),function(){Object.keys(w.elements).forEach(function(K){var bt=w.elements[K],St=w.attributes[K]||{},$t=Object.keys(w.styles.hasOwnProperty(K)?w.styles[K]:k[K]).reduce(function(qt,re){return qt[re]="",qt},{});Vi(bt)&&fr(bt)&&(Object.assign(bt.style,$t),Object.keys(St).forEach(function(qt){bt.removeAttribute(qt)}))})}},requires:["computeStyles"]};function ki(U){return U.split("-")[0]}var pa=Math.max,Wl=Math.min,Yr=Math.round;function Uf(){var U=navigator.userAgentData;return U!=null&&U.brands&&Array.isArray(U.brands)?U.brands.map(function(w){return w.brand+"/"+w.version}).join(" "):navigator.userAgent}function zf(){return!/^((?!chrome|android).)*safari/i.test(Uf())}function Ka(U,w,k){w===void 0&&(w=!1),k===void 0&&(k=!1);var K=U.getBoundingClientRect(),bt=1,St=1;w&&Vi(U)&&(bt=U.offsetWidth>0&&Yr(K.width)/U.offsetWidth||1,St=U.offsetHeight>0&&Yr(K.height)/U.offsetHeight||1);var $t=(si(U)?hr(U):window).visualViewport,qt=!zf()&&k,re=(K.left+(qt&&$t?$t.offsetLeft:0))/bt,fe=(K.top+(qt&&$t?$t.offsetTop:0))/St,he=K.width/bt,ce=K.height/St;return{width:he,height:ce,top:fe,right:re+he,bottom:fe+ce,left:re,x:re,y:fe}}function ql(U){var w=Ka(U),k=U.offsetWidth,K=U.offsetHeight;return Math.abs(w.width-k)<=1&&(k=w.width),Math.abs(w.height-K)<=1&&(K=w.height),{x:U.offsetLeft,y:U.offsetTop,width:k,height:K}}function bp(U,w){var k=w.getRootNode&&w.getRootNode();if(U.contains(w))return!0;if(k&&Qc(k)){var K=w;do{if(K&&U.isSameNode(K))return!0;K=K.parentNode||K.host}while(K)}return!1}function Ws(U){return hr(U).getComputedStyle(U)}function Jc(U){return["table","td","th"].indexOf(fr(U))>=0}function xs(U){return((si(U)?U.ownerDocument:U.document)||window.document).documentElement}function $o(U){return fr(U)==="html"?U:U.assignedSlot||U.parentNode||(Qc(U)?U.host:null)||xs(U)}function Za(U){return Vi(U)&&Ws(U).position!=="fixed"?U.offsetParent:null}function bs(U){for(var w=hr(U),k=Za(U);k&&Jc(k)&&Ws(k).position==="static";)k=Za(k);return k&&(fr(k)==="html"||fr(k)==="body"&&Ws(k).position==="static")?w:k||function(K){var bt=/firefox/i.test(Uf());if(/Trident/i.test(Uf())&&Vi(K)&&Ws(K).position==="fixed")return null;var St=$o(K);for(Qc(St)&&(St=St.host);Vi(St)&&["html","body"].indexOf(fr(St))<0;){var $t=Ws(St);if($t.transform!=="none"||$t.perspective!=="none"||$t.contain==="paint"||["transform","perspective"].indexOf($t.willChange)!==-1||bt&&$t.willChange==="filter"||bt&&$t.filter&&$t.filter!=="none")return St;St=St.parentNode}return null}(U)||w}function tu(U){return["top","bottom"].indexOf(U)>=0?"x":"y"}function Qa(U,w,k){return pa(U,Wl(w,k))}function jf(U){return Object.assign({},{top:0,right:0,bottom:0,left:0},U)}function Go(U,w){return w.reduce(function(k,K){return k[K]=U,k},{})}const ys={name:"arrow",enabled:!0,phase:"main",fn:function(U){var w,k=U.state,K=U.name,bt=U.options,St=k.elements.arrow,$t=k.modifiersData.popperOffsets,qt=ki(k.placement),re=tu(qt),fe=[Wt,Ot].indexOf(qt)>=0?"height":"width";if(St&&$t){var he=function(Le,Je){return jf(typeof(Le=typeof Le=="function"?Le(Object.assign({},Je.rects,{placement:Je.placement})):Le)!="number"?Le:Go(Le,le))}(bt.padding,k),ce=ql(St),Pe=re==="y"?Et:Wt,Ee=re==="y"?Dt:Ot,Fe=k.rects.reference[fe]+k.rects.reference[re]-$t[re]-k.rects.popper[fe],Ne=$t[re]-k.rects.reference[re],Te=bs(St),on=Te?re==="y"?Te.clientHeight||0:Te.clientWidth||0:0,pn=Fe/2-Ne/2,je=he[Pe],Qe=on-ce[fe]-he[Ee],ke=on/2-ce[fe]/2+pn,ue=Qa(je,ke,Qe),ve=re;k.modifiersData[K]=((w={})[ve]=ue,w.centerOffset=ue-ke,w)}},effect:function(U){var w=U.state,k=U.options.element,K=k===void 0?"[data-popper-arrow]":k;K!=null&&(typeof K!="string"||(K=w.elements.popper.querySelector(K)))&&bp(w.elements.popper,K)&&(w.elements.arrow=K)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ma(U){return U.split("-")[1]}var Yl={top:"auto",right:"auto",bottom:"auto",left:"auto"};function qs(U){var w,k=U.popper,K=U.popperRect,bt=U.placement,St=U.variation,$t=U.offsets,qt=U.position,re=U.gpuAcceleration,fe=U.adaptive,he=U.roundOffsets,ce=U.isFixed,Pe=$t.x,Ee=Pe===void 0?0:Pe,Fe=$t.y,Ne=Fe===void 0?0:Fe,Te=typeof he=="function"?he({x:Ee,y:Ne}):{x:Ee,y:Ne};Ee=Te.x,Ne=Te.y;var on=$t.hasOwnProperty("x"),pn=$t.hasOwnProperty("y"),je=Wt,Qe=Et,ke=window;if(fe){var ue=bs(k),ve="clientHeight",Le="clientWidth";ue===hr(k)&&Ws(ue=xs(k)).position!=="static"&&qt==="absolute"&&(ve="scrollHeight",Le="scrollWidth"),(bt===Et||(bt===Wt||bt===Ot)&&St===ie)&&(Qe=Dt,Ne-=(ce&&ue===ke&&ke.visualViewport?ke.visualViewport.height:ue[ve])-K.height,Ne*=re?1:-1),bt!==Wt&&(bt!==Et&&bt!==Dt||St!==ie)||(je=Ot,Ee-=(ce&&ue===ke&&ke.visualViewport?ke.visualViewport.width:ue[Le])-K.width,Ee*=re?1:-1)}var Je,yn=Object.assign({position:qt},fe&&Yl),Xn=he===!0?function(Xi,Kn){var vi=Xi.x,Mr=Xi.y,Ue=Kn.devicePixelRatio||1;return{x:Yr(vi*Ue)/Ue||0,y:Yr(Mr*Ue)/Ue||0}}({x:Ee,y:Ne},hr(k)):{x:Ee,y:Ne};return Ee=Xn.x,Ne=Xn.y,re?Object.assign({},yn,((Je={})[Qe]=pn?"0":"",Je[je]=on?"0":"",Je.transform=(ke.devicePixelRatio||1)<=1?"translate("+Ee+"px, "+Ne+"px)":"translate3d("+Ee+"px, "+Ne+"px, 0)",Je)):Object.assign({},yn,((w={})[Qe]=pn?Ne+"px":"",w[je]=on?Ee+"px":"",w.transform="",w))}const Xl={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(U){var w=U.state,k=U.options,K=k.gpuAcceleration,bt=K===void 0||K,St=k.adaptive,$t=St===void 0||St,qt=k.roundOffsets,re=qt===void 0||qt,fe={placement:ki(w.placement),variation:ma(w.placement),popper:w.elements.popper,popperRect:w.rects.popper,gpuAcceleration:bt,isFixed:w.options.strategy==="fixed"};w.modifiersData.popperOffsets!=null&&(w.styles.popper=Object.assign({},w.styles.popper,qs(Object.assign({},fe,{offsets:w.modifiersData.popperOffsets,position:w.options.strategy,adaptive:$t,roundOffsets:re})))),w.modifiersData.arrow!=null&&(w.styles.arrow=Object.assign({},w.styles.arrow,qs(Object.assign({},fe,{offsets:w.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:re})))),w.attributes.popper=Object.assign({},w.attributes.popper,{"data-popper-placement":w.placement})},data:{}};var Ja={passive:!0};const eu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(U){var w=U.state,k=U.instance,K=U.options,bt=K.scroll,St=bt===void 0||bt,$t=K.resize,qt=$t===void 0||$t,re=hr(w.elements.popper),fe=[].concat(w.scrollParents.reference,w.scrollParents.popper);return St&&fe.forEach(function(he){he.addEventListener("scroll",k.update,Ja)}),qt&&re.addEventListener("resize",k.update,Ja),function(){St&&fe.forEach(function(he){he.removeEventListener("scroll",k.update,Ja)}),qt&&re.removeEventListener("resize",k.update,Ja)}},data:{}};var nu={left:"right",right:"left",bottom:"top",top:"bottom"};function to(U){return U.replace(/left|right|bottom|top/g,function(w){return nu[w]})}var yp={start:"end",end:"start"};function Li(U){return U.replace(/start|end/g,function(w){return yp[w]})}function Ys(U){var w=hr(U);return{scrollLeft:w.pageXOffset,scrollTop:w.pageYOffset}}function Vo(U){return Ka(xs(U)).left+Ys(U).scrollLeft}function eo(U){var w=Ws(U),k=w.overflow,K=w.overflowX,bt=w.overflowY;return/auto|scroll|overlay|hidden/.test(k+bt+K)}function Ep(U){return["html","body","#document"].indexOf(fr(U))>=0?U.ownerDocument.body:Vi(U)&&eo(U)?U:Ep($o(U))}function no(U,w){var k;w===void 0&&(w=[]);var K=Ep(U),bt=K===((k=U.ownerDocument)==null?void 0:k.body),St=hr(K),$t=bt?[St].concat(St.visualViewport||[],eo(K)?K:[]):K,qt=w.concat($t);return bt?qt:qt.concat(no($o($t)))}function Kl(U){return Object.assign({},U,{left:U.x,top:U.y,right:U.x+U.width,bottom:U.y+U.height})}function Wo(U,w,k){return w===sn?Kl(function(K,bt){var St=hr(K),$t=xs(K),qt=St.visualViewport,re=$t.clientWidth,fe=$t.clientHeight,he=0,ce=0;if(qt){re=qt.width,fe=qt.height;var Pe=zf();(Pe||!Pe&&bt==="fixed")&&(he=qt.offsetLeft,ce=qt.offsetTop)}return{width:re,height:fe,x:he+Vo(K),y:ce}}(U,k)):si(w)?function(K,bt){var St=Ka(K,!1,bt==="fixed");return St.top=St.top+K.clientTop,St.left=St.left+K.clientLeft,St.bottom=St.top+K.clientHeight,St.right=St.left+K.clientWidth,St.width=K.clientWidth,St.height=K.clientHeight,St.x=St.left,St.y=St.top,St}(w,k):Kl(function(K){var bt,St=xs(K),$t=Ys(K),qt=(bt=K.ownerDocument)==null?void 0:bt.body,re=pa(St.scrollWidth,St.clientWidth,qt?qt.scrollWidth:0,qt?qt.clientWidth:0),fe=pa(St.scrollHeight,St.clientHeight,qt?qt.scrollHeight:0,qt?qt.clientHeight:0),he=-$t.scrollLeft+Vo(K),ce=-$t.scrollTop;return Ws(qt||St).direction==="rtl"&&(he+=pa(St.clientWidth,qt?qt.clientWidth:0)-re),{width:re,height:fe,x:he,y:ce}}(xs(U)))}function Zl(U){var w,k=U.reference,K=U.element,bt=U.placement,St=bt?ki(bt):null,$t=bt?ma(bt):null,qt=k.x+k.width/2-K.width/2,re=k.y+k.height/2-K.height/2;switch(St){case Et:w={x:qt,y:k.y-K.height};break;case Dt:w={x:qt,y:k.y+k.height};break;case Ot:w={x:k.x+k.width,y:re};break;case Wt:w={x:k.x-K.width,y:re};break;default:w={x:k.x,y:k.y}}var fe=St?tu(St):null;if(fe!=null){var he=fe==="y"?"height":"width";switch($t){case Qt:w[fe]=w[fe]-(k[he]/2-K[he]/2);break;case ie:w[fe]=w[fe]+(k[he]/2-K[he]/2)}}return w}function io(U,w){w===void 0&&(w={});var k=w,K=k.placement,bt=K===void 0?U.placement:K,St=k.strategy,$t=St===void 0?U.strategy:St,qt=k.boundary,re=qt===void 0?Ie:qt,fe=k.rootBoundary,he=fe===void 0?sn:fe,ce=k.elementContext,Pe=ce===void 0?Ze:ce,Ee=k.altBoundary,Fe=Ee!==void 0&&Ee,Ne=k.padding,Te=Ne===void 0?0:Ne,on=jf(typeof Te!="number"?Te:Go(Te,le)),pn=Pe===Ze?dn:Ze,je=U.rects.popper,Qe=U.elements[Fe?pn:Pe],ke=function(Kn,vi,Mr,Ue){var Pr=vi==="clippingParents"?function(mn){var _i=no($o(mn)),Ki=["absolute","fixed"].indexOf(Ws(mn).position)>=0&&Vi(mn)?bs(mn):mn;return si(Ki)?_i.filter(function(Ss){return si(Ss)&&bp(Ss,Ki)&&fr(Ss)!=="body"}):[]}(Kn):[].concat(vi),Fr=[].concat(Pr,[Mr]),xo=Fr[0],Zn=Fr.reduce(function(mn,_i){var Ki=Wo(Kn,_i,Ue);return mn.top=pa(Ki.top,mn.top),mn.right=Wl(Ki.right,mn.right),mn.bottom=Wl(Ki.bottom,mn.bottom),mn.left=pa(Ki.left,mn.left),mn},Wo(Kn,xo,Ue));return Zn.width=Zn.right-Zn.left,Zn.height=Zn.bottom-Zn.top,Zn.x=Zn.left,Zn.y=Zn.top,Zn}(si(Qe)?Qe:Qe.contextElement||xs(U.elements.popper),re,he,$t),ue=Ka(U.elements.reference),ve=Zl({reference:ue,element:je,placement:bt}),Le=Kl(Object.assign({},je,ve)),Je=Pe===Ze?Le:ue,yn={top:ke.top-Je.top+on.top,bottom:Je.bottom-ke.bottom+on.bottom,left:ke.left-Je.left+on.left,right:Je.right-ke.right+on.right},Xn=U.modifiersData.offset;if(Pe===Ze&&Xn){var Xi=Xn[bt];Object.keys(yn).forEach(function(Kn){var vi=[Ot,Dt].indexOf(Kn)>=0?1:-1,Mr=[Et,Dt].indexOf(Kn)>=0?"y":"x";yn[Kn]+=Xi[Mr]*vi})}return yn}function gv(U,w){w===void 0&&(w={});var k=w,K=k.placement,bt=k.boundary,St=k.rootBoundary,$t=k.padding,qt=k.flipVariations,re=k.allowedAutoPlacements,fe=re===void 0?_s:re,he=ma(K),ce=he?qt?qr:qr.filter(function(Fe){return ma(Fe)===he}):le,Pe=ce.filter(function(Fe){return fe.indexOf(Fe)>=0});Pe.length===0&&(Pe=ce);var Ee=Pe.reduce(function(Fe,Ne){return Fe[Ne]=io(U,{placement:Ne,boundary:bt,rootBoundary:St,padding:$t})[ki(Ne)],Fe},{});return Object.keys(Ee).sort(function(Fe,Ne){return Ee[Fe]-Ee[Ne]})}const wp={name:"flip",enabled:!0,phase:"main",fn:function(U){var w=U.state,k=U.options,K=U.name;if(!w.modifiersData[K]._skip){for(var bt=k.mainAxis,St=bt===void 0||bt,$t=k.altAxis,qt=$t===void 0||$t,re=k.fallbackPlacements,fe=k.padding,he=k.boundary,ce=k.rootBoundary,Pe=k.altBoundary,Ee=k.flipVariations,Fe=Ee===void 0||Ee,Ne=k.allowedAutoPlacements,Te=w.options.placement,on=ki(Te),pn=re||(on!==Te&&Fe?function(mn){if(ki(mn)===ee)return[];var _i=to(mn);return[Li(mn),_i,Li(_i)]}(Te):[to(Te)]),je=[Te].concat(pn).reduce(function(mn,_i){return mn.concat(ki(_i)===ee?gv(w,{placement:_i,boundary:he,rootBoundary:ce,padding:fe,flipVariations:Fe,allowedAutoPlacements:Ne}):_i)},[]),Qe=w.rects.reference,ke=w.rects.popper,ue=new Map,ve=!0,Le=je[0],Je=0;Je<je.length;Je++){var yn=je[Je],Xn=ki(yn),Xi=ma(yn)===Qt,Kn=[Et,Dt].indexOf(Xn)>=0,vi=Kn?"width":"height",Mr=io(w,{placement:yn,boundary:he,rootBoundary:ce,altBoundary:Pe,padding:fe}),Ue=Kn?Xi?Ot:Wt:Xi?Dt:Et;Qe[vi]>ke[vi]&&(Ue=to(Ue));var Pr=to(Ue),Fr=[];if(St&&Fr.push(Mr[Xn]<=0),qt&&Fr.push(Mr[Ue]<=0,Mr[Pr]<=0),Fr.every(function(mn){return mn})){Le=yn,ve=!1;break}ue.set(yn,Fr)}if(ve)for(var xo=function(mn){var _i=je.find(function(Ki){var Ss=ue.get(Ki);if(Ss)return Ss.slice(0,mn).every(function(xi){return xi})});if(_i)return Le=_i,"break"},Zn=Fe?3:1;Zn>0&&xo(Zn)!=="break";Zn--);w.placement!==Le&&(w.modifiersData[K]._skip=!0,w.placement=Le,w.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Ap(U,w,k){return k===void 0&&(k={x:0,y:0}),{top:U.top-w.height-k.y,right:U.right-w.width+k.x,bottom:U.bottom-w.height+k.y,left:U.left-w.width-k.x}}function iu(U){return[Et,Ot,Dt,Wt].some(function(w){return U[w]>=0})}const Sp={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(U){var w=U.state,k=U.name,K=w.rects.reference,bt=w.rects.popper,St=w.modifiersData.preventOverflow,$t=io(w,{elementContext:"reference"}),qt=io(w,{altBoundary:!0}),re=Ap($t,K),fe=Ap(qt,bt,St),he=iu(re),ce=iu(fe);w.modifiersData[k]={referenceClippingOffsets:re,popperEscapeOffsets:fe,isReferenceHidden:he,hasPopperEscaped:ce},w.attributes.popper=Object.assign({},w.attributes.popper,{"data-popper-reference-hidden":he,"data-popper-escaped":ce})}},Tp={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(U){var w=U.state,k=U.options,K=U.name,bt=k.offset,St=bt===void 0?[0,0]:bt,$t=_s.reduce(function(he,ce){return he[ce]=function(Pe,Ee,Fe){var Ne=ki(Pe),Te=[Wt,Et].indexOf(Ne)>=0?-1:1,on=typeof Fe=="function"?Fe(Object.assign({},Ee,{placement:Pe})):Fe,pn=on[0],je=on[1];return pn=pn||0,je=(je||0)*Te,[Wt,Ot].indexOf(Ne)>=0?{x:je,y:pn}:{x:pn,y:je}}(ce,w.rects,St),he},{}),qt=$t[w.placement],re=qt.x,fe=qt.y;w.modifiersData.popperOffsets!=null&&(w.modifiersData.popperOffsets.x+=re,w.modifiersData.popperOffsets.y+=fe),w.modifiersData[K]=$t}},Hf={name:"popperOffsets",enabled:!0,phase:"read",fn:function(U){var w=U.state,k=U.name;w.modifiersData[k]=Zl({reference:w.rects.reference,element:w.rects.popper,placement:w.placement})},data:{}},Cp={name:"preventOverflow",enabled:!0,phase:"main",fn:function(U){var w=U.state,k=U.options,K=U.name,bt=k.mainAxis,St=bt===void 0||bt,$t=k.altAxis,qt=$t!==void 0&&$t,re=k.boundary,fe=k.rootBoundary,he=k.altBoundary,ce=k.padding,Pe=k.tether,Ee=Pe===void 0||Pe,Fe=k.tetherOffset,Ne=Fe===void 0?0:Fe,Te=io(w,{boundary:re,rootBoundary:fe,padding:ce,altBoundary:he}),on=ki(w.placement),pn=ma(w.placement),je=!pn,Qe=tu(on),ke=Qe==="x"?"y":"x",ue=w.modifiersData.popperOffsets,ve=w.rects.reference,Le=w.rects.popper,Je=typeof Ne=="function"?Ne(Object.assign({},w.rects,{placement:w.placement})):Ne,yn=typeof Je=="number"?{mainAxis:Je,altAxis:Je}:Object.assign({mainAxis:0,altAxis:0},Je),Xn=w.modifiersData.offset?w.modifiersData.offset[w.placement]:null,Xi={x:0,y:0};if(ue){if(St){var Kn,vi=Qe==="y"?Et:Wt,Mr=Qe==="y"?Dt:Ot,Ue=Qe==="y"?"height":"width",Pr=ue[Qe],Fr=Pr+Te[vi],xo=Pr-Te[Mr],Zn=Ee?-Le[Ue]/2:0,mn=pn===Qt?ve[Ue]:Le[Ue],_i=pn===Qt?-Le[Ue]:-ve[Ue],Ki=w.elements.arrow,Ss=Ee&&Ki?ql(Ki):{width:0,height:0},xi=w.modifiersData["arrow#persistent"]?w.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},jn=xi[vi],du=xi[Mr],Aa=Qa(0,ve[Ue],Ss[Ue]),pu=je?ve[Ue]/2-Zn-Aa-jn-yn.mainAxis:mn-Aa-jn-yn.mainAxis,xh=je?-ve[Ue]/2+Zn+Aa+du+yn.mainAxis:_i+Aa+du+yn.mainAxis,Zr=w.elements.arrow&&bs(w.elements.arrow),mu=Zr?Qe==="y"?Zr.clientTop||0:Zr.clientLeft||0:0,gu=(Kn=Xn?.[Qe])!=null?Kn:0,bh=Pr+xh-gu,yh=Qa(Ee?Wl(Fr,Pr+pu-gu-mu):Fr,Pr,Ee?pa(xo,bh):xo);ue[Qe]=yh,Xi[Qe]=yh-Pr}if(qt){var Eh,c0=Qe==="x"?Et:Wt,u0=Qe==="x"?Dt:Ot,Sa=ue[ke],oc=ke==="y"?"height":"width",vu=Sa+Te[c0],wh=Sa-Te[u0],Ah=[Et,Wt].indexOf(on)!==-1,Sh=(Eh=Xn?.[ke])!=null?Eh:0,Th=Ah?vu:Sa-ve[oc]-Le[oc]-Sh+yn.altAxis,Ch=Ah?Sa+ve[oc]+Le[oc]-Sh-yn.altAxis:wh,_u=Ee&&Ah?function(f0,h0,xu){var Dh=Qa(f0,h0,xu);return Dh>xu?xu:Dh}(Th,Sa,Ch):Qa(Ee?Th:vu,Sa,Ee?Ch:wh);ue[ke]=_u,Xi[ke]=_u-Sa}w.modifiersData[K]=Xi}},requiresIfExists:["offset"]};function vv(U,w,k){k===void 0&&(k=!1);var K,bt,St=Vi(w),$t=Vi(w)&&function(ce){var Pe=ce.getBoundingClientRect(),Ee=Yr(Pe.width)/ce.offsetWidth||1,Fe=Yr(Pe.height)/ce.offsetHeight||1;return Ee!==1||Fe!==1}(w),qt=xs(w),re=Ka(U,$t,k),fe={scrollLeft:0,scrollTop:0},he={x:0,y:0};return(St||!St&&!k)&&((fr(w)!=="body"||eo(qt))&&(fe=(K=w)!==hr(K)&&Vi(K)?{scrollLeft:(bt=K).scrollLeft,scrollTop:bt.scrollTop}:Ys(K)),Vi(w)?((he=Ka(w,!0)).x+=w.clientLeft,he.y+=w.clientTop):qt&&(he.x=Vo(qt))),{x:re.left+fe.scrollLeft-he.x,y:re.top+fe.scrollTop-he.y,width:re.width,height:re.height}}function Dp(U){var w=new Map,k=new Set,K=[];function bt(St){k.add(St.name),[].concat(St.requires||[],St.requiresIfExists||[]).forEach(function($t){if(!k.has($t)){var qt=w.get($t);qt&&bt(qt)}}),K.push(St)}return U.forEach(function(St){w.set(St.name,St)}),U.forEach(function(St){k.has(St.name)||bt(St)}),K}var Op={placement:"bottom",modifiers:[],strategy:"absolute"};function Rp(){for(var U=arguments.length,w=new Array(U),k=0;k<U;k++)w[k]=arguments[k];return!w.some(function(K){return!(K&&typeof K.getBoundingClientRect=="function")})}function ru(U){U===void 0&&(U={});var w=U,k=w.defaultModifiers,K=k===void 0?[]:k,bt=w.defaultOptions,St=bt===void 0?Op:bt;return function($t,qt,re){re===void 0&&(re=St);var fe,he,ce={placement:"bottom",orderedModifiers:[],options:Object.assign({},Op,St),modifiersData:{},elements:{reference:$t,popper:qt},attributes:{},styles:{}},Pe=[],Ee=!1,Fe={state:ce,setOptions:function(Te){var on=typeof Te=="function"?Te(ce.options):Te;Ne(),ce.options=Object.assign({},St,ce.options,on),ce.scrollParents={reference:si($t)?no($t):$t.contextElement?no($t.contextElement):[],popper:no(qt)};var pn,je,Qe=function(ke){var ue=Dp(ke);return Bf.reduce(function(ve,Le){return ve.concat(ue.filter(function(Je){return Je.phase===Le}))},[])}((pn=[].concat(K,ce.options.modifiers),je=pn.reduce(function(ke,ue){var ve=ke[ue.name];return ke[ue.name]=ve?Object.assign({},ve,ue,{options:Object.assign({},ve.options,ue.options),data:Object.assign({},ve.data,ue.data)}):ue,ke},{}),Object.keys(je).map(function(ke){return je[ke]})));return ce.orderedModifiers=Qe.filter(function(ke){return ke.enabled}),ce.orderedModifiers.forEach(function(ke){var ue=ke.name,ve=ke.options,Le=ve===void 0?{}:ve,Je=ke.effect;if(typeof Je=="function"){var yn=Je({state:ce,name:ue,instance:Fe,options:Le});Pe.push(yn||function(){})}}),Fe.update()},forceUpdate:function(){if(!Ee){var Te=ce.elements,on=Te.reference,pn=Te.popper;if(Rp(on,pn)){ce.rects={reference:vv(on,bs(pn),ce.options.strategy==="fixed"),popper:ql(pn)},ce.reset=!1,ce.placement=ce.options.placement,ce.orderedModifiers.forEach(function(Je){return ce.modifiersData[Je.name]=Object.assign({},Je.data)});for(var je=0;je<ce.orderedModifiers.length;je++)if(ce.reset!==!0){var Qe=ce.orderedModifiers[je],ke=Qe.fn,ue=Qe.options,ve=ue===void 0?{}:ue,Le=Qe.name;typeof ke=="function"&&(ce=ke({state:ce,options:ve,name:Le,instance:Fe})||ce)}else ce.reset=!1,je=-1}}},update:(fe=function(){return new Promise(function(Te){Fe.forceUpdate(),Te(ce)})},function(){return he||(he=new Promise(function(Te){Promise.resolve().then(function(){he=void 0,Te(fe())})})),he}),destroy:function(){Ne(),Ee=!0}};if(!Rp($t,qt))return Fe;function Ne(){Pe.forEach(function(Te){return Te()}),Pe=[]}return Fe.setOptions(re).then(function(Te){!Ee&&re.onFirstUpdate&&re.onFirstUpdate(Te)}),Fe}}var _v=ru(),$f=ru({defaultModifiers:[eu,Hf,Xl,Vl]}),Gf=ru({defaultModifiers:[eu,Hf,Xl,Vl,Tp,wp,Cp,ys,Sp]});const Np=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ur,afterRead:da,afterWrite:Gl,applyStyles:Vl,arrow:ys,auto:ee,basePlacements:le,beforeMain:Nr,beforeRead:cr,beforeWrite:Ff,bottom:Dt,clippingParents:Ie,computeStyles:Xl,createPopper:Gf,createPopperBase:_v,createPopperLite:$f,detectOverflow:io,end:ie,eventListeners:eu,flip:wp,hide:Sp,left:Wt,main:Pf,modifierPhases:Bf,offset:Tp,placements:_s,popper:Ze,popperGenerator:ru,popperOffsets:Hf,preventOverflow:Cp,read:Rr,reference:dn,right:Ot,start:Qt,top:Et,variationPlacements:qr,viewport:sn,write:xp},Symbol.toStringTag,{value:"Module"})),kp="dropdown",ga=".bs.dropdown",Vf=".data-api",xv="ArrowUp",Lp="ArrowDown",bv=`hide${ga}`,yv=`hidden${ga}`,Ev=`show${ga}`,wv=`shown${ga}`,Ip=`click${ga}${Vf}`,Mp=`keydown${ga}${Vf}`,Wf=`keyup${ga}${Vf}`,Es="show",ro='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Pp=`${ro}.${Es}`,Ql=".dropdown-menu",Fp=b()?"top-end":"top-start",Bp=b()?"top-start":"top-end",Up=b()?"bottom-end":"bottom-start",qo=b()?"bottom-start":"bottom-end",Av=b()?"left-start":"right-start",Sv=b()?"right-start":"left-start",Tv={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},zp={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class kr extends Bt{constructor(w,k){super(w,k),this._popper=null,this._parent=this._element.parentNode,this._menu=H.next(this._element,Ql)[0]||H.prev(this._element,Ql)[0]||H.findOne(Ql,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Tv}static get DefaultType(){return zp}static get NAME(){return kp}toggle(){return this._isShown()?this.hide():this.show()}show(){if(d(this._element)||this._isShown())return;const w={relatedTarget:this._element};if(!j.trigger(this._element,Ev,w).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const k of[].concat(...document.body.children))j.on(k,"mouseover",m);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Es),this._element.classList.add(Es),j.trigger(this._element,wv,w)}}hide(){if(d(this._element)||!this._isShown())return;const w={relatedTarget:this._element};this._completeHide(w)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(w){if(!j.trigger(this._element,bv,w).defaultPrevented){if("ontouchstart"in document.documentElement)for(const k of[].concat(...document.body.children))j.off(k,"mouseover",m);this._popper&&this._popper.destroy(),this._menu.classList.remove(Es),this._element.classList.remove(Es),this._element.setAttribute("aria-expanded","false"),gt.removeDataAttribute(this._menu,"popper"),j.trigger(this._element,yv,w),this._element.focus()}}_getConfig(w){if(typeof(w=super._getConfig(w)).reference=="object"&&!l(w.reference)&&typeof w.reference.getBoundingClientRect!="function")throw new TypeError(`${kp.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return w}_createPopper(){if(Np===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let w=this._element;this._config.reference==="parent"?w=this._parent:l(this._config.reference)?w=u(this._config.reference):typeof this._config.reference=="object"&&(w=this._config.reference);const k=this._getPopperConfig();this._popper=Gf(w,this._menu,k)}_isShown(){return this._menu.classList.contains(Es)}_getPlacement(){const w=this._parent;if(w.classList.contains("dropend"))return Av;if(w.classList.contains("dropstart"))return Sv;if(w.classList.contains("dropup-center"))return"top";if(w.classList.contains("dropdown-center"))return"bottom";const k=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return w.classList.contains("dropup")?k?Bp:Fp:k?qo:Up}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:w}=this._config;return typeof w=="string"?w.split(",").map(k=>Number.parseInt(k,10)):typeof w=="function"?k=>w(k,this._element):w}_getPopperConfig(){const w={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(gt.setDataAttribute(this._menu,"popper","static"),w.modifiers=[{name:"applyStyles",enabled:!1}]),{...w,...T(this._config.popperConfig,[void 0,w])}}_selectMenuItem({key:w,target:k}){const K=H.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(bt=>f(bt));K.length&&O(K,k,w===Lp,!K.includes(k)).focus()}static jQueryInterface(w){return this.each(function(){const k=kr.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0)throw new TypeError(`No method named "${w}"`);k[w]()}})}static clearMenus(w){if(w.button===2||w.type==="keyup"&&w.key!=="Tab")return;const k=H.find(Pp);for(const K of k){const bt=kr.getInstance(K);if(!bt||bt._config.autoClose===!1)continue;const St=w.composedPath(),$t=St.includes(bt._menu);if(St.includes(bt._element)||bt._config.autoClose==="inside"&&!$t||bt._config.autoClose==="outside"&&$t||bt._menu.contains(w.target)&&(w.type==="keyup"&&w.key==="Tab"||/input|select|option|textarea|form/i.test(w.target.tagName)))continue;const qt={relatedTarget:bt._element};w.type==="click"&&(qt.clickEvent=w),bt._completeHide(qt)}}static dataApiKeydownHandler(w){const k=/input|textarea/i.test(w.target.tagName),K=w.key==="Escape",bt=[xv,Lp].includes(w.key);if(!bt&&!K||k&&!K)return;w.preventDefault();const St=this.matches(ro)?this:H.prev(this,ro)[0]||H.next(this,ro)[0]||H.findOne(ro,w.delegateTarget.parentNode),$t=kr.getOrCreateInstance(St);if(bt)return w.stopPropagation(),$t.show(),void $t._selectMenuItem(w);$t._isShown()&&(w.stopPropagation(),$t.hide(),St.focus())}}j.on(document,Mp,ro,kr.dataApiKeydownHandler),j.on(document,Mp,Ql,kr.dataApiKeydownHandler),j.on(document,Ip,kr.clearMenus),j.on(document,Wf,kr.clearMenus),j.on(document,Ip,ro,function(U){U.preventDefault(),kr.getOrCreateInstance(this).toggle()}),E(kr);const Yo="backdrop",Xo="show",jp=`mousedown.bs.${Yo}`,su={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Hp={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class qf extends _t{constructor(w){super(),this._config=this._getConfig(w),this._isAppended=!1,this._element=null}static get Default(){return su}static get DefaultType(){return Hp}static get NAME(){return Yo}show(w){if(!this._config.isVisible)return void T(w);this._append();const k=this._getElement();this._config.isAnimated&&v(k),k.classList.add(Xo),this._emulateAnimation(()=>{T(w)})}hide(w){this._config.isVisible?(this._getElement().classList.remove(Xo),this._emulateAnimation(()=>{this.dispose(),T(w)})):T(w)}dispose(){this._isAppended&&(j.off(this._element,jp),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const w=document.createElement("div");w.className=this._config.className,this._config.isAnimated&&w.classList.add("fade"),this._element=w}return this._element}_configAfterMerge(w){return w.rootElement=u(w.rootElement),w}_append(){if(this._isAppended)return;const w=this._getElement();this._config.rootElement.append(w),j.on(w,jp,()=>{T(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(w){S(w,this._getElement(),this._config.isAnimated)}}const Ko=".bs.focustrap",Yf=`focusin${Ko}`,$p=`keydown.tab${Ko}`,Xf="backward",Gp={autofocus:!0,trapElement:null},Cv={autofocus:"boolean",trapElement:"element"};class Vp extends _t{constructor(w){super(),this._config=this._getConfig(w),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Gp}static get DefaultType(){return Cv}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),j.off(document,Ko),j.on(document,Yf,w=>this._handleFocusin(w)),j.on(document,$p,w=>this._handleKeydown(w)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,j.off(document,Ko))}_handleFocusin(w){const{trapElement:k}=this._config;if(w.target===document||w.target===k||k.contains(w.target))return;const K=H.focusableChildren(k);K.length===0?k.focus():this._lastTabNavDirection===Xf?K[K.length-1].focus():K[0].focus()}_handleKeydown(w){w.key==="Tab"&&(this._lastTabNavDirection=w.shiftKey?Xf:"forward")}}const Wp=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",qp=".sticky-top",au="padding-right",Wi="margin-right";class so{constructor(){this._element=document.body}getWidth(){const w=document.documentElement.clientWidth;return Math.abs(window.innerWidth-w)}hide(){const w=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,au,k=>k+w),this._setElementAttributes(Wp,au,k=>k+w),this._setElementAttributes(qp,Wi,k=>k-w)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,au),this._resetElementAttributes(Wp,au),this._resetElementAttributes(qp,Wi)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(w,k,K){const bt=this.getWidth();this._applyManipulationCallback(w,St=>{if(St!==this._element&&window.innerWidth>St.clientWidth+bt)return;this._saveInitialAttribute(St,k);const $t=window.getComputedStyle(St).getPropertyValue(k);St.style.setProperty(k,`${K(Number.parseFloat($t))}px`)})}_saveInitialAttribute(w,k){const K=w.style.getPropertyValue(k);K&&gt.setDataAttribute(w,k,K)}_resetElementAttributes(w,k){this._applyManipulationCallback(w,K=>{const bt=gt.getDataAttribute(K,k);bt!==null?(gt.removeDataAttribute(K,k),K.style.setProperty(k,bt)):K.style.removeProperty(k)})}_applyManipulationCallback(w,k){if(l(w))k(w);else for(const K of H.find(w,this._element))k(K)}}const dr=".bs.modal",Yp=`hide${dr}`,Xp=`hidePrevented${dr}`,Kf=`hidden${dr}`,ou=`show${dr}`,Dv=`shown${dr}`,Zo=`resize${dr}`,Zf=`click.dismiss${dr}`,Jl=`mousedown.dismiss${dr}`,Qf=`keydown.dismiss${dr}`,Kp=`click${dr}.data-api`,va="modal-open",ao="show",tc="modal-static",Zp={backdrop:!0,focus:!0,keyboard:!0},oo={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class _a extends Bt{constructor(w,k){super(w,k),this._dialog=H.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new so,this._addEventListeners()}static get Default(){return Zp}static get DefaultType(){return oo}static get NAME(){return"modal"}toggle(w){return this._isShown?this.hide():this.show(w)}show(w){this._isShown||this._isTransitioning||j.trigger(this._element,ou,{relatedTarget:w}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(va),this._adjustDialog(),this._backdrop.show(()=>this._showElement(w)))}hide(){this._isShown&&!this._isTransitioning&&(j.trigger(this._element,Yp).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(ao),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){j.off(window,dr),j.off(this._dialog,dr),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new qf({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Vp({trapElement:this._element})}_showElement(w){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const k=H.findOne(".modal-body",this._dialog);k&&(k.scrollTop=0),v(this._element),this._element.classList.add(ao),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,j.trigger(this._element,Dv,{relatedTarget:w})},this._dialog,this._isAnimated())}_addEventListeners(){j.on(this._element,Qf,w=>{w.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),j.on(window,Zo,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),j.on(this._element,Jl,w=>{j.one(this._element,Zf,k=>{this._element===w.target&&this._element===k.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(va),this._resetAdjustments(),this._scrollBar.reset(),j.trigger(this._element,Kf)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(j.trigger(this._element,Xp).defaultPrevented)return;const w=this._element.scrollHeight>document.documentElement.clientHeight,k=this._element.style.overflowY;k==="hidden"||this._element.classList.contains(tc)||(w||(this._element.style.overflowY="hidden"),this._element.classList.add(tc),this._queueCallback(()=>{this._element.classList.remove(tc),this._queueCallback(()=>{this._element.style.overflowY=k},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const w=this._element.scrollHeight>document.documentElement.clientHeight,k=this._scrollBar.getWidth(),K=k>0;if(K&&!w){const bt=b()?"paddingLeft":"paddingRight";this._element.style[bt]=`${k}px`}if(!K&&w){const bt=b()?"paddingRight":"paddingLeft";this._element.style[bt]=`${k}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(w,k){return this.each(function(){const K=_a.getOrCreateInstance(this,w);if(typeof w=="string"){if(K[w]===void 0)throw new TypeError(`No method named "${w}"`);K[w](k)}})}}j.on(document,Kp,'[data-bs-toggle="modal"]',function(U){const w=H.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&U.preventDefault(),j.one(w,ou,K=>{K.defaultPrevented||j.one(w,Kf,()=>{f(this)&&this.focus()})});const k=H.findOne(".modal.show");k&&_a.getInstance(k).hide(),_a.getOrCreateInstance(w).toggle(this)}),mt(_a),E(_a);const ws=".bs.offcanvas",Jf=".data-api",Ov=`load${ws}${Jf}`,Qp="show",Jp="showing",th="hiding",eh=".offcanvas.show",nh=`show${ws}`,Xr=`shown${ws}`,t0=`hide${ws}`,pr=`hidePrevented${ws}`,mr=`hidden${ws}`,Qo=`resize${ws}`,ih=`click${ws}${Jf}`,lu=`keydown.dismiss${ws}`,cu={backdrop:!0,keyboard:!0,scroll:!1},rh={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class qi extends Bt{constructor(w,k){super(w,k),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return cu}static get DefaultType(){return rh}static get NAME(){return"offcanvas"}toggle(w){return this._isShown?this.hide():this.show(w)}show(w){this._isShown||j.trigger(this._element,nh,{relatedTarget:w}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new so().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Jp),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(Qp),this._element.classList.remove(Jp),j.trigger(this._element,Xr,{relatedTarget:w})},this._element,!0))}hide(){this._isShown&&(j.trigger(this._element,t0).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(th),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(Qp,th),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new so().reset(),j.trigger(this._element,mr)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const w=!!this._config.backdrop;return new qf({className:"offcanvas-backdrop",isVisible:w,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:w?()=>{this._config.backdrop!=="static"?this.hide():j.trigger(this._element,pr)}:null})}_initializeFocusTrap(){return new Vp({trapElement:this._element})}_addEventListeners(){j.on(this._element,lu,w=>{w.key==="Escape"&&(this._config.keyboard?this.hide():j.trigger(this._element,pr))})}static jQueryInterface(w){return this.each(function(){const k=qi.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w](this)}})}}j.on(document,ih,'[data-bs-toggle="offcanvas"]',function(U){const w=H.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&U.preventDefault(),d(this))return;j.one(w,mr,()=>{f(this)&&this.focus()});const k=H.findOne(eh);k&&k!==w&&qi.getInstance(k).hide(),qi.getOrCreateInstance(w).toggle(this)}),j.on(window,Ov,()=>{for(const U of H.find(eh))qi.getOrCreateInstance(U).show()}),j.on(window,Qo,()=>{for(const U of H.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(U).position!=="fixed"&&qi.getOrCreateInstance(U).hide()}),mt(qi),E(qi);const sh={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},uu=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Jo=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Rv=(U,w)=>{const k=U.nodeName.toLowerCase();return w.includes(k)?!uu.has(k)||!!Jo.test(U.nodeValue):w.filter(K=>K instanceof RegExp).some(K=>K.test(k))},gr={allowList:sh,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},ah={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Xs={entry:"(string|element|function|null)",selector:"(string|element)"};class e0 extends _t{constructor(w){super(),this._config=this._getConfig(w)}static get Default(){return gr}static get DefaultType(){return ah}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(w=>this._resolvePossibleFunction(w)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(w){return this._checkContent(w),this._config.content={...this._config.content,...w},this}toHtml(){const w=document.createElement("div");w.innerHTML=this._maybeSanitize(this._config.template);for(const[bt,St]of Object.entries(this._config.content))this._setContent(w,St,bt);const k=w.children[0],K=this._resolvePossibleFunction(this._config.extraClass);return K&&k.classList.add(...K.split(" ")),k}_typeCheckConfig(w){super._typeCheckConfig(w),this._checkContent(w.content)}_checkContent(w){for(const[k,K]of Object.entries(w))super._typeCheckConfig({selector:k,entry:K},Xs)}_setContent(w,k,K){const bt=H.findOne(K,w);bt&&((k=this._resolvePossibleFunction(k))?l(k)?this._putElementInTemplate(u(k),bt):this._config.html?bt.innerHTML=this._maybeSanitize(k):bt.textContent=k:bt.remove())}_maybeSanitize(w){return this._config.sanitize?function(k,K,bt){if(!k.length)return k;if(bt&&typeof bt=="function")return bt(k);const St=new window.DOMParser().parseFromString(k,"text/html"),$t=[].concat(...St.body.querySelectorAll("*"));for(const qt of $t){const re=qt.nodeName.toLowerCase();if(!Object.keys(K).includes(re)){qt.remove();continue}const fe=[].concat(...qt.attributes),he=[].concat(K["*"]||[],K[re]||[]);for(const ce of fe)Rv(ce,he)||qt.removeAttribute(ce.nodeName)}return St.body.innerHTML}(w,this._config.allowList,this._config.sanitizeFn):w}_resolvePossibleFunction(w){return T(w,[void 0,this])}_putElementInTemplate(w,k){if(this._config.html)return k.innerHTML="",void k.append(w);k.textContent=w.textContent}}const fu=new Set(["sanitize","allowList","sanitizeFn"]),Ks="fade",tl="show",oh=".tooltip-inner",lo=".modal",co="hide.bs.modal",xa="hover",el="focus",Yi="click",Lr={AUTO:"auto",TOP:"top",RIGHT:b()?"left":"right",BOTTOM:"bottom",LEFT:b()?"right":"left"},uo={allowList:sh,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Zs={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Ii extends Bt{constructor(w,k){if(Np===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(w,k),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return uo}static get DefaultType(){return Zs}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),j.off(this._element.closest(lo),co,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const w=j.trigger(this._element,this.constructor.eventName("show")),k=(p(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(w.defaultPrevented||!k)return;this._disposePopper();const K=this._getTipElement();this._element.setAttribute("aria-describedby",K.getAttribute("id"));const{container:bt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(bt.append(K),j.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(K),K.classList.add(tl),"ontouchstart"in document.documentElement)for(const St of[].concat(...document.body.children))j.on(St,"mouseover",m);this._queueCallback(()=>{j.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!j.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(tl),"ontouchstart"in document.documentElement)for(const w of[].concat(...document.body.children))j.off(w,"mouseover",m);this._activeTrigger[Yi]=!1,this._activeTrigger[el]=!1,this._activeTrigger[xa]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),j.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(w){const k=this._getTemplateFactory(w).toHtml();if(!k)return null;k.classList.remove(Ks,tl),k.classList.add(`bs-${this.constructor.NAME}-auto`);const K=(bt=>{do bt+=Math.floor(1e6*Math.random());while(document.getElementById(bt));return bt})(this.constructor.NAME).toString();return k.setAttribute("id",K),this._isAnimated()&&k.classList.add(Ks),k}setContent(w){this._newContent=w,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(w){return this._templateFactory?this._templateFactory.changeContent(w):this._templateFactory=new e0({...this._config,content:w,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[oh]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(w){return this.constructor.getOrCreateInstance(w.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ks)}_isShown(){return this.tip&&this.tip.classList.contains(tl)}_createPopper(w){const k=T(this._config.placement,[this,w,this._element]),K=Lr[k.toUpperCase()];return Gf(this._element,w,this._getPopperConfig(K))}_getOffset(){const{offset:w}=this._config;return typeof w=="string"?w.split(",").map(k=>Number.parseInt(k,10)):typeof w=="function"?k=>w(k,this._element):w}_resolvePossibleFunction(w){return T(w,[this._element,this._element])}_getPopperConfig(w){const k={placement:w,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:K=>{this._getTipElement().setAttribute("data-popper-placement",K.state.placement)}}]};return{...k,...T(this._config.popperConfig,[void 0,k])}}_setListeners(){const w=this._config.trigger.split(" ");for(const k of w)if(k==="click")j.on(this._element,this.constructor.eventName("click"),this._config.selector,K=>{const bt=this._initializeOnDelegatedTarget(K);bt._activeTrigger[Yi]=!(bt._isShown()&&bt._activeTrigger[Yi]),bt.toggle()});else if(k!=="manual"){const K=k===xa?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),bt=k===xa?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");j.on(this._element,K,this._config.selector,St=>{const $t=this._initializeOnDelegatedTarget(St);$t._activeTrigger[St.type==="focusin"?el:xa]=!0,$t._enter()}),j.on(this._element,bt,this._config.selector,St=>{const $t=this._initializeOnDelegatedTarget(St);$t._activeTrigger[St.type==="focusout"?el:xa]=$t._element.contains(St.relatedTarget),$t._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},j.on(this._element.closest(lo),co,this._hideModalHandler)}_fixTitle(){const w=this._element.getAttribute("title");w&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",w),this._element.setAttribute("data-bs-original-title",w),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(w,k){clearTimeout(this._timeout),this._timeout=setTimeout(w,k)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(w){const k=gt.getDataAttributes(this._element);for(const K of Object.keys(k))fu.has(K)&&delete k[K];return w={...k,...typeof w=="object"&&w?w:{}},w=this._mergeConfigObj(w),w=this._configAfterMerge(w),this._typeCheckConfig(w),w}_configAfterMerge(w){return w.container=w.container===!1?document.body:u(w.container),typeof w.delay=="number"&&(w.delay={show:w.delay,hide:w.delay}),typeof w.title=="number"&&(w.title=w.title.toString()),typeof w.content=="number"&&(w.content=w.content.toString()),w}_getDelegateConfig(){const w={};for(const[k,K]of Object.entries(this._config))this.constructor.Default[k]!==K&&(w[k]=K);return w.selector=!1,w.trigger="manual",w}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(w){return this.each(function(){const k=Ii.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0)throw new TypeError(`No method named "${w}"`);k[w]()}})}}E(Ii);const fo=".popover-header",n0=".popover-body",lh={...Ii.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ch={...Ii.DefaultType,content:"(null|string|element|function)"};class ai extends Ii{static get Default(){return lh}static get DefaultType(){return ch}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[fo]:this._getTitle(),[n0]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(w){return this.each(function(){const k=ai.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0)throw new TypeError(`No method named "${w}"`);k[w]()}})}}E(ai);const Nn=".bs.scrollspy",an=`activate${Nn}`,ba=`click${Nn}`,As=`load${Nn}.data-api`,ya="active",Qs="[href]",uh=".nav-link",i0=`${uh}, .nav-item > ${uh}, .list-group-item`,ec={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},nc={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class nl extends Bt{constructor(w,k){super(w,k),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ec}static get DefaultType(){return nc}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const w of this._observableSections.values())this._observer.observe(w)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(w){return w.target=u(w.target)||document.body,w.rootMargin=w.offset?`${w.offset}px 0px -30%`:w.rootMargin,typeof w.threshold=="string"&&(w.threshold=w.threshold.split(",").map(k=>Number.parseFloat(k))),w}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(j.off(this._config.target,ba),j.on(this._config.target,ba,Qs,w=>{const k=this._observableSections.get(w.target.hash);if(k){w.preventDefault();const K=this._rootElement||window,bt=k.offsetTop-this._element.offsetTop;if(K.scrollTo)return void K.scrollTo({top:bt,behavior:"smooth"});K.scrollTop=bt}}))}_getNewObserver(){const w={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(k=>this._observerCallback(k),w)}_observerCallback(w){const k=$t=>this._targetLinks.get(`#${$t.target.id}`),K=$t=>{this._previousScrollData.visibleEntryTop=$t.target.offsetTop,this._process(k($t))},bt=(this._rootElement||document.documentElement).scrollTop,St=bt>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=bt;for(const $t of w){if(!$t.isIntersecting){this._activeTarget=null,this._clearActiveClass(k($t));continue}const qt=$t.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(St&&qt){if(K($t),!bt)return}else St||qt||K($t)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const w=H.find(Qs,this._config.target);for(const k of w){if(!k.hash||d(k))continue;const K=H.findOne(decodeURI(k.hash),this._element);f(K)&&(this._targetLinks.set(decodeURI(k.hash),k),this._observableSections.set(k.hash,K))}}_process(w){this._activeTarget!==w&&(this._clearActiveClass(this._config.target),this._activeTarget=w,w.classList.add(ya),this._activateParents(w),j.trigger(this._element,an,{relatedTarget:w}))}_activateParents(w){if(w.classList.contains("dropdown-item"))H.findOne(".dropdown-toggle",w.closest(".dropdown")).classList.add(ya);else for(const k of H.parents(w,".nav, .list-group"))for(const K of H.prev(k,i0))K.classList.add(ya)}_clearActiveClass(w){w.classList.remove(ya);const k=H.find(`${Qs}.${ya}`,w);for(const K of k)K.classList.remove(ya)}static jQueryInterface(w){return this.each(function(){const k=nl.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w]()}})}}j.on(window,As,()=>{for(const U of H.find('[data-bs-spy="scroll"]'))nl.getOrCreateInstance(U)}),E(nl);const Kr=".bs.tab",fh=`hide${Kr}`,ho=`hidden${Kr}`,Js=`show${Kr}`,Ea=`shown${Kr}`,ta=`click${Kr}`,hh=`keydown${Kr}`,dh=`load${Kr}`,ic="ArrowLeft",rc="ArrowRight",po="ArrowUp",gi="ArrowDown",il="Home",ph="End",mo="active",r0="fade",mh="show",Wn=".dropdown-toggle",sc=`:not(${Wn})`,rl='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',go=`.nav-link${sc}, .list-group-item${sc}, [role="tab"]${sc}, ${rl}`,gh=`.${mo}[data-bs-toggle="tab"], .${mo}[data-bs-toggle="pill"], .${mo}[data-bs-toggle="list"]`;class Ir extends Bt{constructor(w){super(w),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),j.on(this._element,hh,k=>this._keydown(k)))}static get NAME(){return"tab"}show(){const w=this._element;if(this._elemIsActive(w))return;const k=this._getActiveElem(),K=k?j.trigger(k,fh,{relatedTarget:w}):null;j.trigger(w,Js,{relatedTarget:k}).defaultPrevented||K&&K.defaultPrevented||(this._deactivate(k,w),this._activate(w,k))}_activate(w,k){w&&(w.classList.add(mo),this._activate(H.getElementFromSelector(w)),this._queueCallback(()=>{w.getAttribute("role")==="tab"?(w.removeAttribute("tabindex"),w.setAttribute("aria-selected",!0),this._toggleDropDown(w,!0),j.trigger(w,Ea,{relatedTarget:k})):w.classList.add(mh)},w,w.classList.contains(r0)))}_deactivate(w,k){w&&(w.classList.remove(mo),w.blur(),this._deactivate(H.getElementFromSelector(w)),this._queueCallback(()=>{w.getAttribute("role")==="tab"?(w.setAttribute("aria-selected",!1),w.setAttribute("tabindex","-1"),this._toggleDropDown(w,!1),j.trigger(w,ho,{relatedTarget:k})):w.classList.remove(mh)},w,w.classList.contains(r0)))}_keydown(w){if(![ic,rc,po,gi,il,ph].includes(w.key))return;w.stopPropagation(),w.preventDefault();const k=this._getChildren().filter(bt=>!d(bt));let K;if([il,ph].includes(w.key))K=k[w.key===il?0:k.length-1];else{const bt=[rc,gi].includes(w.key);K=O(k,w.target,bt,!0)}K&&(K.focus({preventScroll:!0}),Ir.getOrCreateInstance(K).show())}_getChildren(){return H.find(go,this._parent)}_getActiveElem(){return this._getChildren().find(w=>this._elemIsActive(w))||null}_setInitialAttributes(w,k){this._setAttributeIfNotExists(w,"role","tablist");for(const K of k)this._setInitialAttributesOnChild(K)}_setInitialAttributesOnChild(w){w=this._getInnerElement(w);const k=this._elemIsActive(w),K=this._getOuterElement(w);w.setAttribute("aria-selected",k),K!==w&&this._setAttributeIfNotExists(K,"role","presentation"),k||w.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(w,"role","tab"),this._setInitialAttributesOnTargetPanel(w)}_setInitialAttributesOnTargetPanel(w){const k=H.getElementFromSelector(w);k&&(this._setAttributeIfNotExists(k,"role","tabpanel"),w.id&&this._setAttributeIfNotExists(k,"aria-labelledby",`${w.id}`))}_toggleDropDown(w,k){const K=this._getOuterElement(w);if(!K.classList.contains("dropdown"))return;const bt=(St,$t)=>{const qt=H.findOne(St,K);qt&&qt.classList.toggle($t,k)};bt(Wn,mo),bt(".dropdown-menu",mh),K.setAttribute("aria-expanded",k)}_setAttributeIfNotExists(w,k,K){w.hasAttribute(k)||w.setAttribute(k,K)}_elemIsActive(w){return w.classList.contains(mo)}_getInnerElement(w){return w.matches(go)?w:H.findOne(go,w)}_getOuterElement(w){return w.closest(".nav-item, .list-group-item")||w}static jQueryInterface(w){return this.each(function(){const k=Ir.getOrCreateInstance(this);if(typeof w=="string"){if(k[w]===void 0||w.startsWith("_")||w==="constructor")throw new TypeError(`No method named "${w}"`);k[w]()}})}}j.on(document,ta,rl,function(U){["A","AREA"].includes(this.tagName)&&U.preventDefault(),d(this)||Ir.getOrCreateInstance(this).show()}),j.on(window,dh,()=>{for(const U of H.find(gh))Ir.getOrCreateInstance(U)}),E(Ir);const vr=".bs.toast",Nv=`mouseover${vr}`,s0=`mouseout${vr}`,kv=`focusin${vr}`,a0=`focusout${vr}`,vo=`hide${vr}`,vh=`hidden${vr}`,hu=`show${vr}`,o0=`shown${vr}`,sl="hide",ac="show",_o="showing",_h={animation:"boolean",autohide:"boolean",delay:"number"},l0={animation:!0,autohide:!0,delay:5e3};class wa extends Bt{constructor(w,k){super(w,k),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return l0}static get DefaultType(){return _h}static get NAME(){return"toast"}show(){j.trigger(this._element,hu).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(sl),v(this._element),this._element.classList.add(ac,_o),this._queueCallback(()=>{this._element.classList.remove(_o),j.trigger(this._element,o0),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(j.trigger(this._element,vo).defaultPrevented||(this._element.classList.add(_o),this._queueCallback(()=>{this._element.classList.add(sl),this._element.classList.remove(_o,ac),j.trigger(this._element,vh)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ac),super.dispose()}isShown(){return this._element.classList.contains(ac)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(w,k){switch(w.type){case"mouseover":case"mouseout":this._hasMouseInteraction=k;break;case"focusin":case"focusout":this._hasKeyboardInteraction=k}if(k)return void this._clearTimeout();const K=w.relatedTarget;this._element===K||this._element.contains(K)||this._maybeScheduleHide()}_setListeners(){j.on(this._element,Nv,w=>this._onInteraction(w,!0)),j.on(this._element,s0,w=>this._onInteraction(w,!1)),j.on(this._element,kv,w=>this._onInteraction(w,!0)),j.on(this._element,a0,w=>this._onInteraction(w,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(w){return this.each(function(){const k=wa.getOrCreateInstance(this,w);if(typeof w=="string"){if(k[w]===void 0)throw new TypeError(`No method named "${w}"`);k[w](this)}})}}return mt(wa),E(wa),{Alert:Lt,Button:dt,Carousel:fa,Collapse:Ht,Dropdown:kr,Modal:_a,Offcanvas:qi,Popover:ai,ScrollSpy:nl,Tab:Ir,Toast:wa,Tooltip:Ii}})}(jm)),jm.exports}C4();/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const El=new Map,V1={set(n,t,e){El.has(n)||El.set(n,new Map);const i=El.get(n);if(!i.has(t)&&i.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`);return}i.set(t,e)},get(n,t){return El.has(n)&&El.get(n).get(t)||null},remove(n,t){if(!El.has(n))return;const e=El.get(n);e.delete(t),e.size===0&&El.delete(n)}},D4=1e6,O4=1e3,nx="transitionend",GT=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(t,e)=>`#${CSS.escape(e)}`)),n),R4=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),N4=n=>{do n+=Math.floor(Math.random()*D4);while(document.getElementById(n));return n},k4=n=>{if(!n)return 0;let{transitionDuration:t,transitionDelay:e}=window.getComputedStyle(n);const i=Number.parseFloat(t),r=Number.parseFloat(e);return!i&&!r?0:(t=t.split(",")[0],e=e.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(e))*O4)},VT=n=>{n.dispatchEvent(new Event(nx))},ko=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Dl=n=>ko(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(GT(n)):null,wf=n=>{if(!ko(n)||n.getClientRects().length===0)return!1;const t=getComputedStyle(n).getPropertyValue("visibility")==="visible",e=n.closest("details:not([open])");if(!e)return t;if(e!==n){const i=n.closest("summary");if(i&&i.parentNode!==e||i===null)return!1}return t},Ol=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",WT=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const t=n.getRootNode();return t instanceof ShadowRoot?t:null}return n instanceof ShadowRoot?n:n.parentNode?WT(n.parentNode):null},Xm=()=>{},Jd=n=>{n.offsetHeight},qT=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,W1=[],L4=n=>{document.readyState==="loading"?(W1.length||document.addEventListener("DOMContentLoaded",()=>{for(const t of W1)t()}),W1.push(n)):n()},Bs=()=>document.documentElement.dir==="rtl",Hs=n=>{L4(()=>{const t=qT();if(t){const e=n.NAME,i=t.fn[e];t.fn[e]=n.jQueryInterface,t.fn[e].Constructor=n,t.fn[e].noConflict=()=>(t.fn[e]=i,n.jQueryInterface)}})},Vr=(n,t=[],e=n)=>typeof n=="function"?n.call(...t):e,YT=(n,t,e=!0)=>{if(!e){Vr(n);return}const r=k4(t)+5;let s=!1;const a=({target:l})=>{l===t&&(s=!0,t.removeEventListener(nx,a),Vr(n))};t.addEventListener(nx,a),setTimeout(()=>{s||VT(t)},r)},Qx=(n,t,e,i)=>{const r=n.length;let s=n.indexOf(t);return s===-1?!e&&i?n[r-1]:n[0]:(s+=e?1:-1,i&&(s=(s+r)%r),n[Math.max(0,Math.min(s,r-1))])},I4=/[^.]*(?=\..*)\.|.*/,M4=/\..*/,P4=/::\d+$/,q1={};let lA=1;const XT={mouseenter:"mouseover",mouseleave:"mouseout"},F4=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function KT(n,t){return t&&`${t}::${lA++}`||n.uidEvent||lA++}function ZT(n){const t=KT(n);return n.uidEvent=t,q1[t]=q1[t]||{},q1[t]}function B4(n,t){return function e(i){return Jx(i,{delegateTarget:n}),e.oneOff&&Jt.off(n,i.type,t),t.apply(n,[i])}}function U4(n,t,e){return function i(r){const s=n.querySelectorAll(t);for(let{target:a}=r;a&&a!==this;a=a.parentNode)for(const l of s)if(l===a)return Jx(r,{delegateTarget:a}),i.oneOff&&Jt.off(n,r.type,t,e),e.apply(a,[r])}}function QT(n,t,e=null){return Object.values(n).find(i=>i.callable===t&&i.delegationSelector===e)}function JT(n,t,e){const i=typeof t=="string",r=i?e:t||e;let s=tC(n);return F4.has(s)||(s=n),[i,r,s]}function cA(n,t,e,i,r){if(typeof t!="string"||!n)return;let[s,a,l]=JT(t,e,i);t in XT&&(a=(x=>function(_){if(!_.relatedTarget||_.relatedTarget!==_.delegateTarget&&!_.delegateTarget.contains(_.relatedTarget))return x.call(this,_)})(a));const u=ZT(n),f=u[l]||(u[l]={}),d=QT(f,a,s?e:null);if(d){d.oneOff=d.oneOff&&r;return}const p=KT(a,t.replace(I4,"")),m=s?U4(n,e,a):B4(n,a);m.delegationSelector=s?e:null,m.callable=a,m.oneOff=r,m.uidEvent=p,f[p]=m,n.addEventListener(l,m,s)}function ix(n,t,e,i,r){const s=QT(t[e],i,r);s&&(n.removeEventListener(e,s,!!r),delete t[e][s.uidEvent])}function z4(n,t,e,i){const r=t[e]||{};for(const[s,a]of Object.entries(r))s.includes(i)&&ix(n,t,e,a.callable,a.delegationSelector)}function tC(n){return n=n.replace(M4,""),XT[n]||n}const Jt={on(n,t,e,i){cA(n,t,e,i,!1)},one(n,t,e,i){cA(n,t,e,i,!0)},off(n,t,e,i){if(typeof t!="string"||!n)return;const[r,s,a]=JT(t,e,i),l=a!==t,u=ZT(n),f=u[a]||{},d=t.startsWith(".");if(typeof s<"u"){if(!Object.keys(f).length)return;ix(n,u,a,s,r?e:null);return}if(d)for(const p of Object.keys(u))z4(n,u,p,t.slice(1));for(const[p,m]of Object.entries(f)){const v=p.replace(P4,"");(!l||t.includes(v))&&ix(n,u,a,m.callable,m.delegationSelector)}},trigger(n,t,e){if(typeof t!="string"||!n)return null;const i=qT(),r=tC(t),s=t!==r;let a=null,l=!0,u=!0,f=!1;s&&i&&(a=i.Event(t,e),i(n).trigger(a),l=!a.isPropagationStopped(),u=!a.isImmediatePropagationStopped(),f=a.isDefaultPrevented());const d=Jx(new Event(t,{bubbles:l,cancelable:!0}),e);return f&&d.preventDefault(),u&&n.dispatchEvent(d),d.defaultPrevented&&a&&a.preventDefault(),d}};function Jx(n,t={}){for(const[e,i]of Object.entries(t))try{n[e]=i}catch{Object.defineProperty(n,e,{configurable:!0,get(){return i}})}return n}function uA(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Y1(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}const Lo={setDataAttribute(n,t,e){n.setAttribute(`data-bs-${Y1(t)}`,e)},removeDataAttribute(n,t){n.removeAttribute(`data-bs-${Y1(t)}`)},getDataAttributes(n){if(!n)return{};const t={},e=Object.keys(n.dataset).filter(i=>i.startsWith("bs")&&!i.startsWith("bsConfig"));for(const i of e){let r=i.replace(/^bs/,"");r=r.charAt(0).toLowerCase()+r.slice(1),t[r]=uA(n.dataset[i])}return t},getDataAttribute(n,t){return uA(n.getAttribute(`data-bs-${Y1(t)}`))}};class tp{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const i=ko(e)?Lo.getDataAttribute(e,"config"):{};return{...this.constructor.Default,...typeof i=="object"?i:{},...ko(e)?Lo.getDataAttributes(e):{},...typeof t=="object"?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[i,r]of Object.entries(e)){const s=t[i],a=ko(s)?"element":R4(s);if(!new RegExp(r).test(a))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${i}" provided type "${a}" but expected type "${r}".`)}}}const j4="5.3.7";class ua extends tp{constructor(t,e){super(),t=Dl(t),t&&(this._element=t,this._config=this._getConfig(e),V1.set(this._element,this.constructor.DATA_KEY,this))}dispose(){V1.remove(this._element,this.constructor.DATA_KEY),Jt.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,i=!0){YT(t,e,i)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return V1.get(Dl(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,typeof e=="object"?e:null)}static get VERSION(){return j4}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const X1=n=>{let t=n.getAttribute("data-bs-target");if(!t||t==="#"){let e=n.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),t=e&&e!=="#"?e.trim():null}return t?t.split(",").map(e=>GT(e)).join(","):null},Ae={find(n,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,n))},findOne(n,t=document.documentElement){return Element.prototype.querySelector.call(t,n)},children(n,t){return[].concat(...n.children).filter(e=>e.matches(t))},parents(n,t){const e=[];let i=n.parentNode.closest(t);for(;i;)e.push(i),i=i.parentNode.closest(t);return e},prev(n,t){let e=n.previousElementSibling;for(;e;){if(e.matches(t))return[e];e=e.previousElementSibling}return[]},next(n,t){let e=n.nextElementSibling;for(;e;){if(e.matches(t))return[e];e=e.nextElementSibling}return[]},focusableChildren(n){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>`${e}:not([tabindex^="-"])`).join(",");return this.find(t,n).filter(e=>!Ol(e)&&wf(e))},getSelectorFromElement(n){const t=X1(n);return t&&Ae.findOne(t)?t:null},getElementFromSelector(n){const t=X1(n);return t?Ae.findOne(t):null},getMultipleElementsFromSelector(n){const t=X1(n);return t?Ae.find(t):[]}},Pg=(n,t="hide")=>{const e=`click.dismiss${n.EVENT_KEY}`,i=n.NAME;Jt.on(document,e,`[data-bs-dismiss="${i}"]`,function(r){if(["A","AREA"].includes(this.tagName)&&r.preventDefault(),Ol(this))return;const s=Ae.getElementFromSelector(this)||this.closest(`.${i}`);n.getOrCreateInstance(s)[t]()})},H4="alert",$4="bs.alert",eC=`.${$4}`,G4=`close${eC}`,V4=`closed${eC}`,W4="fade",q4="show";class Fg extends ua{static get NAME(){return H4}close(){if(Jt.trigger(this._element,G4).defaultPrevented)return;this._element.classList.remove(q4);const e=this._element.classList.contains(W4);this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),Jt.trigger(this._element,V4),this.dispose()}static jQueryInterface(t){return this.each(function(){const e=Fg.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Pg(Fg,"close");Hs(Fg);const Y4="button",X4="bs.button",K4=`.${X4}`,Z4=".data-api",Q4="active",fA='[data-bs-toggle="button"]',J4=`click${K4}${Z4}`;class Bg extends ua{static get NAME(){return Y4}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Q4))}static jQueryInterface(t){return this.each(function(){const e=Bg.getOrCreateInstance(this);t==="toggle"&&e[t]()})}}Jt.on(document,J4,fA,n=>{n.preventDefault();const t=n.target.closest(fA);Bg.getOrCreateInstance(t).toggle()});Hs(Bg);const t3="swipe",Af=".bs.swipe",e3=`touchstart${Af}`,n3=`touchmove${Af}`,i3=`touchend${Af}`,r3=`pointerdown${Af}`,s3=`pointerup${Af}`,a3="touch",o3="pen",l3="pointer-event",c3=40,u3={endCallback:null,leftCallback:null,rightCallback:null},f3={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Km extends tp{constructor(t,e){super(),this._element=t,!(!t||!Km.isSupported())&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return u3}static get DefaultType(){return f3}static get NAME(){return t3}dispose(){Jt.off(this._element,Af)}_start(t){if(!this._supportPointerEvents){this._deltaX=t.touches[0].clientX;return}this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX)}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),Vr(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=c3)return;const e=t/this._deltaX;this._deltaX=0,e&&Vr(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Jt.on(this._element,r3,t=>this._start(t)),Jt.on(this._element,s3,t=>this._end(t)),this._element.classList.add(l3)):(Jt.on(this._element,e3,t=>this._start(t)),Jt.on(this._element,n3,t=>this._move(t)),Jt.on(this._element,i3,t=>this._end(t)))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&(t.pointerType===o3||t.pointerType===a3)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const h3="carousel",d3="bs.carousel",Fl=`.${d3}`,nC=".data-api",p3="ArrowLeft",m3="ArrowRight",g3=500,ed="next",Pu="prev",ju="left",Hm="right",v3=`slide${Fl}`,K1=`slid${Fl}`,_3=`keydown${Fl}`,x3=`mouseenter${Fl}`,b3=`mouseleave${Fl}`,y3=`dragstart${Fl}`,E3=`load${Fl}${nC}`,w3=`click${Fl}${nC}`,iC="carousel",Q0="active",A3="slide",S3="carousel-item-end",T3="carousel-item-start",C3="carousel-item-next",D3="carousel-item-prev",rC=".active",sC=".carousel-item",O3=rC+sC,R3=".carousel-item img",N3=".carousel-indicators",k3="[data-bs-slide], [data-bs-slide-to]",L3='[data-bs-ride="carousel"]',I3={[p3]:Hm,[m3]:ju},M3={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},P3={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class ep extends ua{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Ae.findOne(N3,this._element),this._addEventListeners(),this._config.ride===iC&&this.cycle()}static get Default(){return M3}static get DefaultType(){return P3}static get NAME(){return h3}next(){this._slide(ed)}nextWhenVisible(){!document.hidden&&wf(this._element)&&this.next()}prev(){this._slide(Pu)}pause(){this._isSliding&&VT(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Jt.one(this._element,K1,()=>this.cycle());return}this.cycle()}}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding){Jt.one(this._element,K1,()=>this.to(t));return}const i=this._getItemIndex(this._getActive());if(i===t)return;const r=t>i?ed:Pu;this._slide(r,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&Jt.on(this._element,_3,t=>this._keydown(t)),this._config.pause==="hover"&&(Jt.on(this._element,x3,()=>this.pause()),Jt.on(this._element,b3,()=>this._maybeEnableCycle())),this._config.touch&&Km.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const i of Ae.find(R3,this._element))Jt.on(i,y3,r=>r.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(ju)),rightCallback:()=>this._slide(this._directionToOrder(Hm)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),g3+this._config.interval))}};this._swipeHelper=new Km(this._element,e)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=I3[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=Ae.findOne(rC,this._indicatorsElement);e.classList.remove(Q0),e.removeAttribute("aria-current");const i=Ae.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);i&&(i.classList.add(Q0),i.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const i=this._getActive(),r=t===ed,s=e||Qx(this._getItems(),i,r,this._config.wrap);if(s===i)return;const a=this._getItemIndex(s),l=v=>Jt.trigger(this._element,v,{relatedTarget:s,direction:this._orderToDirection(t),from:this._getItemIndex(i),to:a});if(l(v3).defaultPrevented||!i||!s)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(a),this._activeElement=s;const d=r?T3:S3,p=r?C3:D3;s.classList.add(p),Jd(s),i.classList.add(d),s.classList.add(d);const m=()=>{s.classList.remove(d,p),s.classList.add(Q0),i.classList.remove(Q0,p,d),this._isSliding=!1,l(K1)};this._queueCallback(m,i,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(A3)}_getActive(){return Ae.findOne(O3,this._element)}_getItems(){return Ae.find(sC,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return Bs()?t===ju?Pu:ed:t===ju?ed:Pu}_orderToDirection(t){return Bs()?t===Pu?ju:Hm:t===Pu?Hm:ju}static jQueryInterface(t){return this.each(function(){const e=ep.getOrCreateInstance(this,t);if(typeof t=="number"){e.to(t);return}if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(document,w3,k3,function(n){const t=Ae.getElementFromSelector(this);if(!t||!t.classList.contains(iC))return;n.preventDefault();const e=ep.getOrCreateInstance(t),i=this.getAttribute("data-bs-slide-to");if(i){e.to(i),e._maybeEnableCycle();return}if(Lo.getDataAttribute(this,"slide")==="next"){e.next(),e._maybeEnableCycle();return}e.prev(),e._maybeEnableCycle()});Jt.on(window,E3,()=>{const n=Ae.find(L3);for(const t of n)ep.getOrCreateInstance(t)});Hs(ep);const F3="collapse",B3="bs.collapse",np=`.${B3}`,U3=".data-api",z3=`show${np}`,j3=`shown${np}`,H3=`hide${np}`,$3=`hidden${np}`,G3=`click${np}${U3}`,Z1="show",Wu="collapse",J0="collapsing",V3="collapsed",W3=`:scope .${Wu} .${Wu}`,q3="collapse-horizontal",Y3="width",X3="height",K3=".collapse.show, .collapse.collapsing",rx='[data-bs-toggle="collapse"]',Z3={parent:null,toggle:!0},Q3={parent:"(null|element)",toggle:"boolean"};class Od extends ua{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const i=Ae.find(rx);for(const r of i){const s=Ae.getSelectorFromElement(r),a=Ae.find(s).filter(l=>l===this._element);s!==null&&a.length&&this._triggerArray.push(r)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Z3}static get DefaultType(){return Q3}static get NAME(){return F3}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(K3).filter(l=>l!==this._element).map(l=>Od.getOrCreateInstance(l,{toggle:!1}))),t.length&&t[0]._isTransitioning||Jt.trigger(this._element,z3).defaultPrevented)return;for(const l of t)l.hide();const i=this._getDimension();this._element.classList.remove(Wu),this._element.classList.add(J0),this._element.style[i]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const r=()=>{this._isTransitioning=!1,this._element.classList.remove(J0),this._element.classList.add(Wu,Z1),this._element.style[i]="",Jt.trigger(this._element,j3)},a=`scroll${i[0].toUpperCase()+i.slice(1)}`;this._queueCallback(r,this._element,!0),this._element.style[i]=`${this._element[a]}px`}hide(){if(this._isTransitioning||!this._isShown()||Jt.trigger(this._element,H3).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,Jd(this._element),this._element.classList.add(J0),this._element.classList.remove(Wu,Z1);for(const r of this._triggerArray){const s=Ae.getElementFromSelector(r);s&&!this._isShown(s)&&this._addAriaAndCollapsedClass([r],!1)}this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(J0),this._element.classList.add(Wu),Jt.trigger(this._element,$3)};this._element.style[e]="",this._queueCallback(i,this._element,!0)}_isShown(t=this._element){return t.classList.contains(Z1)}_configAfterMerge(t){return t.toggle=!!t.toggle,t.parent=Dl(t.parent),t}_getDimension(){return this._element.classList.contains(q3)?Y3:X3}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(rx);for(const e of t){const i=Ae.getElementFromSelector(e);i&&this._addAriaAndCollapsedClass([e],this._isShown(i))}}_getFirstLevelChildren(t){const e=Ae.find(W3,this._config.parent);return Ae.find(t,this._config.parent).filter(i=>!e.includes(i))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const i of t)i.classList.toggle(V3,!e),i.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return typeof t=="string"&&/show|hide/.test(t)&&(e.toggle=!1),this.each(function(){const i=Od.getOrCreateInstance(this,e);if(typeof t=="string"){if(typeof i[t]>"u")throw new TypeError(`No method named "${t}"`);i[t]()}})}}Jt.on(document,G3,rx,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const t of Ae.getMultipleElementsFromSelector(this))Od.getOrCreateInstance(t,{toggle:!1}).toggle()});Hs(Od);const hA="dropdown",J3="bs.dropdown",jc=`.${J3}`,tb=".data-api",tL="Escape",dA="Tab",eL="ArrowUp",pA="ArrowDown",nL=2,iL=`hide${jc}`,rL=`hidden${jc}`,sL=`show${jc}`,aL=`shown${jc}`,aC=`click${jc}${tb}`,oC=`keydown${jc}${tb}`,oL=`keyup${jc}${tb}`,Hu="show",lL="dropup",cL="dropend",uL="dropstart",fL="dropup-center",hL="dropdown-center",xc='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',dL=`${xc}.${Hu}`,$m=".dropdown-menu",pL=".navbar",mL=".navbar-nav",gL=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",vL=Bs()?"top-end":"top-start",_L=Bs()?"top-start":"top-end",xL=Bs()?"bottom-end":"bottom-start",bL=Bs()?"bottom-start":"bottom-end",yL=Bs()?"left-start":"right-start",EL=Bs()?"right-start":"left-start",wL="top",AL="bottom",SL={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},TL={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Va extends ua{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=Ae.next(this._element,$m)[0]||Ae.prev(this._element,$m)[0]||Ae.findOne($m,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return SL}static get DefaultType(){return TL}static get NAME(){return hA}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ol(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!Jt.trigger(this._element,sL,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(mL))for(const i of[].concat(...document.body.children))Jt.on(i,"mouseover",Xm);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Hu),this._element.classList.add(Hu),Jt.trigger(this._element,aL,t)}}hide(){if(Ol(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!Jt.trigger(this._element,iL,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Jt.off(i,"mouseover",Xm);this._popper&&this._popper.destroy(),this._menu.classList.remove(Hu),this._element.classList.remove(Hu),this._element.setAttribute("aria-expanded","false"),Lo.removeDataAttribute(this._menu,"popper"),Jt.trigger(this._element,rL,t),this._element.focus()}}_getConfig(t){if(t=super._getConfig(t),typeof t.reference=="object"&&!ko(t.reference)&&typeof t.reference.getBoundingClientRect!="function")throw new TypeError(`${hA.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(typeof Xx>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let t=this._element;this._config.reference==="parent"?t=this._parent:ko(this._config.reference)?t=Dl(this._config.reference):typeof this._config.reference=="object"&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=Yx(t,this._menu,e)}_isShown(){return this._menu.classList.contains(Hu)}_getPlacement(){const t=this._parent;if(t.classList.contains(cL))return yL;if(t.classList.contains(uL))return EL;if(t.classList.contains(fL))return wL;if(t.classList.contains(hL))return AL;const e=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return t.classList.contains(lL)?e?_L:vL:e?bL:xL}_detectNavbar(){return this._element.closest(pL)!==null}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Lo.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...Vr(this._config.popperConfig,[void 0,t])}}_selectMenuItem({key:t,target:e}){const i=Ae.find(gL,this._menu).filter(r=>wf(r));i.length&&Qx(i,e,t===pA,!i.includes(e)).focus()}static jQueryInterface(t){return this.each(function(){const e=Va.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(t){if(t.button===nL||t.type==="keyup"&&t.key!==dA)return;const e=Ae.find(dL);for(const i of e){const r=Va.getInstance(i);if(!r||r._config.autoClose===!1)continue;const s=t.composedPath(),a=s.includes(r._menu);if(s.includes(r._element)||r._config.autoClose==="inside"&&!a||r._config.autoClose==="outside"&&a||r._menu.contains(t.target)&&(t.type==="keyup"&&t.key===dA||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const l={relatedTarget:r._element};t.type==="click"&&(l.clickEvent=t),r._completeHide(l)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),i=t.key===tL,r=[eL,pA].includes(t.key);if(!r&&!i||e&&!i)return;t.preventDefault();const s=this.matches(xc)?this:Ae.prev(this,xc)[0]||Ae.next(this,xc)[0]||Ae.findOne(xc,t.delegateTarget.parentNode),a=Va.getOrCreateInstance(s);if(r){t.stopPropagation(),a.show(),a._selectMenuItem(t);return}a._isShown()&&(t.stopPropagation(),a.hide(),s.focus())}}Jt.on(document,oC,xc,Va.dataApiKeydownHandler);Jt.on(document,oC,$m,Va.dataApiKeydownHandler);Jt.on(document,aC,Va.clearMenus);Jt.on(document,oL,Va.clearMenus);Jt.on(document,aC,xc,function(n){n.preventDefault(),Va.getOrCreateInstance(this).toggle()});Hs(Va);const lC="backdrop",CL="fade",mA="show",gA=`mousedown.bs.${lC}`,DL={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},OL={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class cC extends tp{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return DL}static get DefaultType(){return OL}static get NAME(){return lC}show(t){if(!this._config.isVisible){Vr(t);return}this._append();const e=this._getElement();this._config.isAnimated&&Jd(e),e.classList.add(mA),this._emulateAnimation(()=>{Vr(t)})}hide(t){if(!this._config.isVisible){Vr(t);return}this._getElement().classList.remove(mA),this._emulateAnimation(()=>{this.dispose(),Vr(t)})}dispose(){this._isAppended&&(Jt.off(this._element,gA),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add(CL),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=Dl(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),Jt.on(t,gA,()=>{Vr(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(t){YT(t,this._getElement(),this._config.isAnimated)}}const RL="focustrap",NL="bs.focustrap",Zm=`.${NL}`,kL=`focusin${Zm}`,LL=`keydown.tab${Zm}`,IL="Tab",ML="forward",vA="backward",PL={autofocus:!0,trapElement:null},FL={autofocus:"boolean",trapElement:"element"};class uC extends tp{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return PL}static get DefaultType(){return FL}static get NAME(){return RL}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Jt.off(document,Zm),Jt.on(document,kL,t=>this._handleFocusin(t)),Jt.on(document,LL,t=>this._handleKeydown(t)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Jt.off(document,Zm))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const i=Ae.focusableChildren(e);i.length===0?e.focus():this._lastTabNavDirection===vA?i[i.length-1].focus():i[0].focus()}_handleKeydown(t){t.key===IL&&(this._lastTabNavDirection=t.shiftKey?vA:ML)}}const _A=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",xA=".sticky-top",tm="padding-right",bA="margin-right";class sx{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,tm,e=>e+t),this._setElementAttributes(_A,tm,e=>e+t),this._setElementAttributes(xA,bA,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,tm),this._resetElementAttributes(_A,tm),this._resetElementAttributes(xA,bA)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,i){const r=this.getWidth(),s=a=>{if(a!==this._element&&window.innerWidth>a.clientWidth+r)return;this._saveInitialAttribute(a,e);const l=window.getComputedStyle(a).getPropertyValue(e);a.style.setProperty(e,`${i(Number.parseFloat(l))}px`)};this._applyManipulationCallback(t,s)}_saveInitialAttribute(t,e){const i=t.style.getPropertyValue(e);i&&Lo.setDataAttribute(t,e,i)}_resetElementAttributes(t,e){const i=r=>{const s=Lo.getDataAttribute(r,e);if(s===null){r.style.removeProperty(e);return}Lo.removeDataAttribute(r,e),r.style.setProperty(e,s)};this._applyManipulationCallback(t,i)}_applyManipulationCallback(t,e){if(ko(t)){e(t);return}for(const i of Ae.find(t,this._element))e(i)}}const BL="modal",UL="bs.modal",Us=`.${UL}`,zL=".data-api",jL="Escape",HL=`hide${Us}`,$L=`hidePrevented${Us}`,fC=`hidden${Us}`,hC=`show${Us}`,GL=`shown${Us}`,VL=`resize${Us}`,WL=`click.dismiss${Us}`,qL=`mousedown.dismiss${Us}`,YL=`keydown.dismiss${Us}`,XL=`click${Us}${zL}`,yA="modal-open",KL="fade",EA="show",Q1="modal-static",ZL=".modal.show",QL=".modal-dialog",JL=".modal-body",tI='[data-bs-toggle="modal"]',eI={backdrop:!0,focus:!0,keyboard:!0},nI={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Oc extends ua{constructor(t,e){super(t,e),this._dialog=Ae.findOne(QL,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new sx,this._addEventListeners()}static get Default(){return eI}static get DefaultType(){return nI}static get NAME(){return BL}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||Jt.trigger(this._element,hC,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(yA),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){!this._isShown||this._isTransitioning||Jt.trigger(this._element,HL).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(EA),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Jt.off(window,Us),Jt.off(this._dialog,Us),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new cC({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new uC({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=Ae.findOne(JL,this._dialog);e&&(e.scrollTop=0),Jd(this._element),this._element.classList.add(EA);const i=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Jt.trigger(this._element,GL,{relatedTarget:t})};this._queueCallback(i,this._dialog,this._isAnimated())}_addEventListeners(){Jt.on(this._element,YL,t=>{if(t.key===jL){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Jt.on(window,VL,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Jt.on(this._element,qL,t=>{Jt.one(this._element,WL,e=>{if(!(this._element!==t.target||this._element!==e.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(yA),this._resetAdjustments(),this._scrollBar.reset(),Jt.trigger(this._element,fC)})}_isAnimated(){return this._element.classList.contains(KL)}_triggerBackdropTransition(){if(Jt.trigger(this._element,$L).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,i=this._element.style.overflowY;i==="hidden"||this._element.classList.contains(Q1)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(Q1),this._queueCallback(()=>{this._element.classList.remove(Q1),this._queueCallback(()=>{this._element.style.overflowY=i},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),i=e>0;if(i&&!t){const r=Bs()?"paddingLeft":"paddingRight";this._element.style[r]=`${e}px`}if(!i&&t){const r=Bs()?"paddingRight":"paddingLeft";this._element.style[r]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each(function(){const i=Oc.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof i[t]>"u")throw new TypeError(`No method named "${t}"`);i[t](e)}})}}Jt.on(document,XL,tI,function(n){const t=Ae.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Jt.one(t,hC,r=>{r.defaultPrevented||Jt.one(t,fC,()=>{wf(this)&&this.focus()})});const e=Ae.findOne(ZL);e&&Oc.getInstance(e).hide(),Oc.getOrCreateInstance(t).toggle(this)});Pg(Oc);Hs(Oc);const iI="offcanvas",rI="bs.offcanvas",Ho=`.${rI}`,dC=".data-api",sI=`load${Ho}${dC}`,aI="Escape",wA="show",AA="showing",SA="hiding",oI="offcanvas-backdrop",pC=".offcanvas.show",lI=`show${Ho}`,cI=`shown${Ho}`,uI=`hide${Ho}`,TA=`hidePrevented${Ho}`,mC=`hidden${Ho}`,fI=`resize${Ho}`,hI=`click${Ho}${dC}`,dI=`keydown.dismiss${Ho}`,pI='[data-bs-toggle="offcanvas"]',mI={backdrop:!0,keyboard:!0,scroll:!1},gI={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Rl extends ua{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return mI}static get DefaultType(){return gI}static get NAME(){return iI}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||Jt.trigger(this._element,lI,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new sx().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(AA);const i=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(wA),this._element.classList.remove(AA),Jt.trigger(this._element,cI,{relatedTarget:t})};this._queueCallback(i,this._element,!0)}hide(){if(!this._isShown||Jt.trigger(this._element,uI).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(SA),this._backdrop.hide();const e=()=>{this._element.classList.remove(wA,SA),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new sx().reset(),Jt.trigger(this._element,mC)};this._queueCallback(e,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=()=>{if(this._config.backdrop==="static"){Jt.trigger(this._element,TA);return}this.hide()},e=!!this._config.backdrop;return new cC({className:oI,isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?t:null})}_initializeFocusTrap(){return new uC({trapElement:this._element})}_addEventListeners(){Jt.on(this._element,dI,t=>{if(t.key===aI){if(this._config.keyboard){this.hide();return}Jt.trigger(this._element,TA)}})}static jQueryInterface(t){return this.each(function(){const e=Rl.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Jt.on(document,hI,pI,function(n){const t=Ae.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Ol(this))return;Jt.one(t,mC,()=>{wf(this)&&this.focus()});const e=Ae.findOne(pC);e&&e!==t&&Rl.getInstance(e).hide(),Rl.getOrCreateInstance(t).toggle(this)});Jt.on(window,sI,()=>{for(const n of Ae.find(pC))Rl.getOrCreateInstance(n).show()});Jt.on(window,fI,()=>{for(const n of Ae.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Rl.getOrCreateInstance(n).hide()});Pg(Rl);Hs(Rl);const vI=/^aria-[\w-]*$/i,gC={"*":["class","dir","id","lang","role",vI],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},_I=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),xI=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,bI=(n,t)=>{const e=n.nodeName.toLowerCase();return t.includes(e)?_I.has(e)?!!xI.test(n.nodeValue):!0:t.filter(i=>i instanceof RegExp).some(i=>i.test(e))};function yI(n,t,e){if(!n.length)return n;if(e&&typeof e=="function")return e(n);const r=new window.DOMParser().parseFromString(n,"text/html"),s=[].concat(...r.body.querySelectorAll("*"));for(const a of s){const l=a.nodeName.toLowerCase();if(!Object.keys(t).includes(l)){a.remove();continue}const u=[].concat(...a.attributes),f=[].concat(t["*"]||[],t[l]||[]);for(const d of u)bI(d,f)||a.removeAttribute(d.nodeName)}return r.body.innerHTML}const EI="TemplateFactory",wI={allowList:gC,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},AI={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},SI={entry:"(string|element|function|null)",selector:"(string|element)"};class TI extends tp{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return wI}static get DefaultType(){return AI}static get NAME(){return EI}getContent(){return Object.values(this._config.content).map(t=>this._resolvePossibleFunction(t)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[r,s]of Object.entries(this._config.content))this._setContent(t,s,r);const e=t.children[0],i=this._resolvePossibleFunction(this._config.extraClass);return i&&e.classList.add(...i.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,i]of Object.entries(t))super._typeCheckConfig({selector:e,entry:i},SI)}_setContent(t,e,i){const r=Ae.findOne(i,t);if(r){if(e=this._resolvePossibleFunction(e),!e){r.remove();return}if(ko(e)){this._putElementInTemplate(Dl(e),r);return}if(this._config.html){r.innerHTML=this._maybeSanitize(e);return}r.textContent=e}}_maybeSanitize(t){return this._config.sanitize?yI(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return Vr(t,[void 0,this])}_putElementInTemplate(t,e){if(this._config.html){e.innerHTML="",e.append(t);return}e.textContent=t.textContent}}const CI="tooltip",DI=new Set(["sanitize","allowList","sanitizeFn"]),J1="fade",OI="modal",em="show",RI=".tooltip-inner",CA=`.${OI}`,DA="hide.bs.modal",nd="hover",t_="focus",e_="click",NI="manual",kI="hide",LI="hidden",II="show",MI="shown",PI="inserted",FI="click",BI="focusin",UI="focusout",zI="mouseenter",jI="mouseleave",HI={AUTO:"auto",TOP:"top",RIGHT:Bs()?"left":"right",BOTTOM:"bottom",LEFT:Bs()?"right":"left"},$I={allowList:gC,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},GI={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class zs extends ua{constructor(t,e){if(typeof Xx>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return $I}static get DefaultType(){return GI}static get NAME(){return CI}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Jt.off(this._element.closest(CA),DA,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const t=Jt.trigger(this._element,this.constructor.eventName(II)),i=(WT(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!i)return;this._disposePopper();const r=this._getTipElement();this._element.setAttribute("aria-describedby",r.getAttribute("id"));const{container:s}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(s.append(r),Jt.trigger(this._element,this.constructor.eventName(PI))),this._popper=this._createPopper(r),r.classList.add(em),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))Jt.on(l,"mouseover",Xm);const a=()=>{Jt.trigger(this._element,this.constructor.eventName(MI)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(a,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Jt.trigger(this._element,this.constructor.eventName(kI)).defaultPrevented)return;if(this._getTipElement().classList.remove(em),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))Jt.off(r,"mouseover",Xm);this._activeTrigger[e_]=!1,this._activeTrigger[t_]=!1,this._activeTrigger[nd]=!1,this._isHovered=null;const i=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Jt.trigger(this._element,this.constructor.eventName(LI)))};this._queueCallback(i,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(J1,em),e.classList.add(`bs-${this.constructor.NAME}-auto`);const i=N4(this.constructor.NAME).toString();return e.setAttribute("id",i),this._isAnimated()&&e.classList.add(J1),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new TI({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[RI]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(J1)}_isShown(){return this.tip&&this.tip.classList.contains(em)}_createPopper(t){const e=Vr(this._config.placement,[this,t,this._element]),i=HI[e.toUpperCase()];return Yx(this._element,t,this._getPopperConfig(i))}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_resolvePossibleFunction(t){return Vr(t,[this._element,this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:i=>{this._getTipElement().setAttribute("data-popper-placement",i.state.placement)}}]};return{...e,...Vr(this._config.popperConfig,[void 0,e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if(e==="click")Jt.on(this._element,this.constructor.eventName(FI),this._config.selector,i=>{const r=this._initializeOnDelegatedTarget(i);r._activeTrigger[e_]=!(r._isShown()&&r._activeTrigger[e_]),r.toggle()});else if(e!==NI){const i=e===nd?this.constructor.eventName(zI):this.constructor.eventName(BI),r=e===nd?this.constructor.eventName(jI):this.constructor.eventName(UI);Jt.on(this._element,i,this._config.selector,s=>{const a=this._initializeOnDelegatedTarget(s);a._activeTrigger[s.type==="focusin"?t_:nd]=!0,a._enter()}),Jt.on(this._element,r,this._config.selector,s=>{const a=this._initializeOnDelegatedTarget(s);a._activeTrigger[s.type==="focusout"?t_:nd]=a._element.contains(s.relatedTarget),a._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Jt.on(this._element.closest(CA),DA,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=Lo.getDataAttributes(this._element);for(const i of Object.keys(e))DI.has(i)&&delete e[i];return t={...e,...typeof t=="object"&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=t.container===!1?document.body:Dl(t.container),typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),typeof t.title=="number"&&(t.title=t.title.toString()),typeof t.content=="number"&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,i]of Object.entries(this._config))this.constructor.Default[e]!==i&&(t[e]=i);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){const e=zs.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Hs(zs);const VI="popover",WI=".popover-header",qI=".popover-body",YI={...zs.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},XI={...zs.DefaultType,content:"(null|string|element|function)"};class eb extends zs{static get Default(){return YI}static get DefaultType(){return XI}static get NAME(){return VI}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[WI]:this._getTitle(),[qI]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){const e=eb.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Hs(eb);const KI="scrollspy",ZI="bs.scrollspy",nb=`.${ZI}`,QI=".data-api",JI=`activate${nb}`,OA=`click${nb}`,tM=`load${nb}${QI}`,eM="dropdown-item",Fu="active",nM='[data-bs-spy="scroll"]',n_="[href]",iM=".nav, .list-group",RA=".nav-link",rM=".nav-item",sM=".list-group-item",aM=`${RA}, ${rM} > ${RA}, ${sM}`,oM=".dropdown",lM=".dropdown-toggle",cM={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},uM={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Ug extends ua{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return cM}static get DefaultType(){return uM}static get NAME(){return KI}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=Dl(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,typeof t.threshold=="string"&&(t.threshold=t.threshold.split(",").map(e=>Number.parseFloat(e))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Jt.off(this._config.target,OA),Jt.on(this._config.target,OA,n_,t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const i=this._rootElement||window,r=e.offsetTop-this._element.offsetTop;if(i.scrollTo){i.scrollTo({top:r,behavior:"smooth"});return}i.scrollTop=r}}))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),t)}_observerCallback(t){const e=a=>this._targetLinks.get(`#${a.target.id}`),i=a=>{this._previousScrollData.visibleEntryTop=a.target.offsetTop,this._process(e(a))},r=(this._rootElement||document.documentElement).scrollTop,s=r>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=r;for(const a of t){if(!a.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(a));continue}const l=a.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&l){if(i(a),!r)return;continue}!s&&!l&&i(a)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=Ae.find(n_,this._config.target);for(const e of t){if(!e.hash||Ol(e))continue;const i=Ae.findOne(decodeURI(e.hash),this._element);wf(i)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,i))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(Fu),this._activateParents(t),Jt.trigger(this._element,JI,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains(eM)){Ae.findOne(lM,t.closest(oM)).classList.add(Fu);return}for(const e of Ae.parents(t,iM))for(const i of Ae.prev(e,aM))i.classList.add(Fu)}_clearActiveClass(t){t.classList.remove(Fu);const e=Ae.find(`${n_}.${Fu}`,t);for(const i of e)i.classList.remove(Fu)}static jQueryInterface(t){return this.each(function(){const e=Ug.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(window,tM,()=>{for(const n of Ae.find(nM))Ug.getOrCreateInstance(n)});Hs(Ug);const fM="tab",hM="bs.tab",Hc=`.${hM}`,dM=`hide${Hc}`,pM=`hidden${Hc}`,mM=`show${Hc}`,gM=`shown${Hc}`,vM=`click${Hc}`,_M=`keydown${Hc}`,xM=`load${Hc}`,bM="ArrowLeft",NA="ArrowRight",yM="ArrowUp",kA="ArrowDown",i_="Home",LA="End",bc="active",IA="fade",r_="show",EM="dropdown",vC=".dropdown-toggle",wM=".dropdown-menu",s_=`:not(${vC})`,AM='.list-group, .nav, [role="tablist"]',SM=".nav-item, .list-group-item",TM=`.nav-link${s_}, .list-group-item${s_}, [role="tab"]${s_}`,_C='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',a_=`${TM}, ${_C}`,CM=`.${bc}[data-bs-toggle="tab"], .${bc}[data-bs-toggle="pill"], .${bc}[data-bs-toggle="list"]`;class hf extends ua{constructor(t){super(t),this._parent=this._element.closest(AM),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Jt.on(this._element,_M,e=>this._keydown(e)))}static get NAME(){return fM}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),i=e?Jt.trigger(e,dM,{relatedTarget:t}):null;Jt.trigger(t,mM,{relatedTarget:e}).defaultPrevented||i&&i.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){if(!t)return;t.classList.add(bc),this._activate(Ae.getElementFromSelector(t));const i=()=>{if(t.getAttribute("role")!=="tab"){t.classList.add(r_);return}t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),Jt.trigger(t,gM,{relatedTarget:e})};this._queueCallback(i,t,t.classList.contains(IA))}_deactivate(t,e){if(!t)return;t.classList.remove(bc),t.blur(),this._deactivate(Ae.getElementFromSelector(t));const i=()=>{if(t.getAttribute("role")!=="tab"){t.classList.remove(r_);return}t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),Jt.trigger(t,pM,{relatedTarget:e})};this._queueCallback(i,t,t.classList.contains(IA))}_keydown(t){if(![bM,NA,yM,kA,i_,LA].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=this._getChildren().filter(r=>!Ol(r));let i;if([i_,LA].includes(t.key))i=e[t.key===i_?0:e.length-1];else{const r=[NA,kA].includes(t.key);i=Qx(e,t.target,r,!0)}i&&(i.focus({preventScroll:!0}),hf.getOrCreateInstance(i).show())}_getChildren(){return Ae.find(a_,this._parent)}_getActiveElem(){return this._getChildren().find(t=>this._elemIsActive(t))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const i of e)this._setInitialAttributesOnChild(i)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),i=this._getOuterElement(t);t.setAttribute("aria-selected",e),i!==t&&this._setAttributeIfNotExists(i,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=Ae.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const i=this._getOuterElement(t);if(!i.classList.contains(EM))return;const r=(s,a)=>{const l=Ae.findOne(s,i);l&&l.classList.toggle(a,e)};r(vC,bc),r(wM,r_),i.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,i){t.hasAttribute(e)||t.setAttribute(e,i)}_elemIsActive(t){return t.classList.contains(bc)}_getInnerElement(t){return t.matches(a_)?t:Ae.findOne(a_,t)}_getOuterElement(t){return t.closest(SM)||t}static jQueryInterface(t){return this.each(function(){const e=hf.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(document,vM,_C,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Ol(this)&&hf.getOrCreateInstance(this).show()});Jt.on(window,xM,()=>{for(const n of Ae.find(CM))hf.getOrCreateInstance(n)});Hs(hf);const DM="toast",OM="bs.toast",Bl=`.${OM}`,RM=`mouseover${Bl}`,NM=`mouseout${Bl}`,kM=`focusin${Bl}`,LM=`focusout${Bl}`,IM=`hide${Bl}`,MM=`hidden${Bl}`,PM=`show${Bl}`,FM=`shown${Bl}`,BM="fade",MA="hide",nm="show",im="showing",UM={animation:"boolean",autohide:"boolean",delay:"number"},zM={animation:!0,autohide:!0,delay:5e3};class zg extends ua{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return zM}static get DefaultType(){return UM}static get NAME(){return DM}show(){if(Jt.trigger(this._element,PM).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(BM);const e=()=>{this._element.classList.remove(im),Jt.trigger(this._element,FM),this._maybeScheduleHide()};this._element.classList.remove(MA),Jd(this._element),this._element.classList.add(nm,im),this._queueCallback(e,this._element,this._config.animation)}hide(){if(!this.isShown()||Jt.trigger(this._element,IM).defaultPrevented)return;const e=()=>{this._element.classList.add(MA),this._element.classList.remove(im,nm),Jt.trigger(this._element,MM)};this._element.classList.add(im),this._queueCallback(e,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(nm),super.dispose()}isShown(){return this._element.classList.contains(nm)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=e;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=e;break}}if(e){this._clearTimeout();return}const i=t.relatedTarget;this._element===i||this._element.contains(i)||this._maybeScheduleHide()}_setListeners(){Jt.on(this._element,RM,t=>this._onInteraction(t,!0)),Jt.on(this._element,NM,t=>this._onInteraction(t,!1)),Jt.on(this._element,kM,t=>this._onInteraction(t,!0)),Jt.on(this._element,LM,t=>this._onInteraction(t,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const e=zg.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Pg(zg);Hs(zg);const br=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),ax=[.001,0,0,.001,0,0],o_=1.35,is={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ha={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},jM="pdfjs_internal_editor_",Be={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Ke={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},xC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Qi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},xd={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Jn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},$u={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ip={ERRORS:0,WARNINGS:1,INFOS:5},Rd={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},rm={moveTo:0,lineTo:1,curveTo:2,closePath:3},bC={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let jg=ip.WARNINGS;function HM(n){Number.isInteger(n)&&(jg=n)}function $M(){return jg}function Hg(n){jg>=ip.INFOS&&console.log(`Info: ${n}`)}function ze(n){jg>=ip.WARNINGS&&console.log(`Warning: ${n}`)}function Tn(n){throw new Error(n)}function ui(n,t){n||Tn(t)}function GM(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ib(n,t=null,e=null){if(!n)return null;if(e&&typeof n=="string"&&(e.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),e.tryConvertEncoding))try{n=XM(n)}catch{}const i=t?URL.parse(n,t):URL.parse(n);return GM(i)?i:null}function rb(n,t,e=!1){const i=URL.parse(n);return i?(i.hash=t,i.href):e&&ib(n,"http://example.com")?n.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Xe(n,t,e,i=!1){return Object.defineProperty(n,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const $c=function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class PA extends $c{constructor(t,e){super(t,"PasswordException"),this.code=e}}class l_ extends $c{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Qm extends $c{constructor(t){super(t,"InvalidPDFException")}}class Nd extends $c{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class VM extends $c{constructor(t){super(t,"FormatError")}}class Bo extends $c{constructor(t){super(t,"AbortException")}}function yC(n){(typeof n!="object"||n?.length===void 0)&&Tn("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const i=[];for(let r=0;r<t;r+=e){const s=Math.min(r+e,t),a=n.subarray(r,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function rp(n){typeof n!="string"&&Tn("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=n.charCodeAt(i)&255;return e}function WM(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function qM(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function YM(){try{return new Function(""),!0}catch{return!1}}class Oi{static get isLittleEndian(){return Xe(this,"isLittleEndian",qM())}static get isEvalSupported(){return Xe(this,"isEvalSupported",YM())}static get isOffscreenCanvasSupported(){return Xe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Xe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Xe(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Xe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const c_=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class be{static makeHexColor(t,e,i){return`#${c_[t]}${c_[e]}${c_[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e,i=0){const r=t[i],s=t[i+1];t[i]=r*e[0]+s*e[2]+e[4],t[i+1]=r*e[1]+s*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const r=e[0],s=e[1],a=e[2],l=e[3],u=e[4],f=e[5];for(let d=0;d<6;d+=2){const p=t[i+d],m=t[i+d+1];t[i+d]=p*r+m*a+u,t[i+d+1]=p*s+m*l+f}}static applyInverseTransform(t,e){const i=t[0],r=t[1],s=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-r*e[2]+e[2]*e[5]-e[4]*e[3])/s,t[1]=(-i*e[1]+r*e[0]+e[4]*e[1]-e[5]*e[0])/s}static axialAlignedBoundingBox(t,e,i){const r=e[0],s=e[1],a=e[2],l=e[3],u=e[4],f=e[5],d=t[0],p=t[1],m=t[2],v=t[3];let x=r*d+u,_=x,b=r*m+u,E=b,T=l*p+f,S=T,O=l*v+f,R=O;if(s!==0||a!==0){const N=s*d,C=s*m,M=a*p,I=a*v;x+=M,E+=M,b+=I,_+=I,T+=N,R+=N,O+=C,S+=C}i[0]=Math.min(i[0],x,b,_,E),i[1]=Math.min(i[1],T,O,S,R),i[2]=Math.max(i[2],x,b,_,E),i[3]=Math.max(i[3],T,O,S,R)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],r=t[1],s=t[2],a=t[3],l=i**2+r**2,u=i*s+r*a,f=s**2+a**2,d=(l+f)/2,p=Math.sqrt(d**2-(l*f-u**2));e[0]=Math.sqrt(d+p||1),e[1]=Math.sqrt(d-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>r)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>a?null:[i,s,r,a]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,r,s){s[0]=Math.min(s[0],t,i),s[1]=Math.min(s[1],e,r),s[2]=Math.max(s[2],t,i),s[3]=Math.max(s[3],e,r)}static#t(t,e,i,r,s,a,l,u,f,d){if(f<=0||f>=1)return;const p=1-f,m=f*f,v=m*f,x=p*(p*(p*t+3*f*e)+3*m*i)+v*r,_=p*(p*(p*s+3*f*a)+3*m*l)+v*u;d[0]=Math.min(d[0],x),d[1]=Math.min(d[1],_),d[2]=Math.max(d[2],x),d[3]=Math.max(d[3],_)}static#e(t,e,i,r,s,a,l,u,f,d,p,m){if(Math.abs(f)<1e-12){Math.abs(d)>=1e-12&&this.#t(t,e,i,r,s,a,l,u,-p/d,m);return}const v=d**2-4*p*f;if(v<0)return;const x=Math.sqrt(v),_=2*f;this.#t(t,e,i,r,s,a,l,u,(-d+x)/_,m),this.#t(t,e,i,r,s,a,l,u,(-d-x)/_,m)}static bezierBoundingBox(t,e,i,r,s,a,l,u,f){f[0]=Math.min(f[0],t,l),f[1]=Math.min(f[1],e,u),f[2]=Math.max(f[2],t,l),f[3]=Math.max(f[3],e,u),this.#e(t,i,s,l,e,r,a,u,3*(-t+3*(i-s)+l),6*(t-2*i+s),3*(i-t),f),this.#e(t,i,s,l,e,r,a,u,3*(-e+3*(r-a)+u),6*(e-2*r+a),3*(r-e),f)}}function XM(n){return decodeURIComponent(escape(n))}let u_=null,FA=null;function EC(n){return u_||(u_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,FA=new Map([["ﬅ","ſt"]])),n.replaceAll(u_,(t,e,i)=>e?e.normalize("NFKC"):FA.get(i))}function sb(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),yC(n)}const ab="pdfjs_internal_id_";function KM(n,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,r,...s]=e;if(!n(i)&&!Number.isInteger(i)||!t(r))return!1;const a=s.length;let l=!0;switch(r.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const u of s)if(!(typeof u=="number"||l&&u===null))return!1;return!0}function Ji(n,t,e){return Math.min(Math.max(n,t),e)}function wC(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(yC(n))}function ZM(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):rp(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((t,e)=>t+e,0)});const Co="http://www.w3.org/2000/svg";class Rc{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Sf(n,t="text"){if(dd(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class sp{constructor({viewBox:t,userUnit:e,scale:i,rotation:r,offsetX:s=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=r,this.offsetX=s,this.offsetY=a,i*=e;const u=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let d,p,m,v;switch(r%=360,r<0&&(r+=360),r){case 180:d=-1,p=0,m=0,v=1;break;case 90:d=0,p=1,m=1,v=0;break;case 270:d=0,p=-1,m=-1,v=0;break;case 0:d=1,p=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,v=-v);let x,_,b,E;d===0?(x=Math.abs(f-t[1])*i+s,_=Math.abs(u-t[0])*i+a,b=(t[3]-t[1])*i,E=(t[2]-t[0])*i):(x=Math.abs(u-t[0])*i+s,_=Math.abs(f-t[1])*i+a,b=(t[2]-t[0])*i,E=(t[3]-t[1])*i),this.transform=[d*i,p*i,m*i,v*i,x-d*i*u-m*i*f,_-p*i*u-v*i*f],this.width=b,this.height=E}get rawDims(){const t=this.viewBox;return Xe(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:s=!1}={}){return new sp({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:r,dontFlip:s})}convertToViewportPoint(t,e){const i=[t,e];return be.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];be.applyTransform(e,this.transform);const i=[t[2],t[3]];return be.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return be.applyInverseTransform(i,this.transform),i}}class $g extends $c{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function ap(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function Gg(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function AC(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function SC(n,t="document.pdf"){if(typeof n!="string")return t;if(ap(n))return ze('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=e.exec(n);let s=i.exec(r[1])||i.exec(r[2])||i.exec(r[3]);if(s&&(s=s[0],s.includes("%")))try{s=i.exec(decodeURIComponent(s))[0]}catch{}return s||t}class BA{started=Object.create(null);times=[];time(t){t in this.started&&ze(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ze(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:r,end:s}of this.times)t.push(`${i.padEnd(e)} ${s-r}ms
`);return t.join("")}}function dd(n,t){const e=t?URL.parse(n,t):URL.parse(n);return e?.protocol==="http:"||e?.protocol==="https:"}function js(n){n.preventDefault()}function ei(n){n.preventDefault(),n.stopPropagation()}function QM(n){console.log("Deprecated API usage: "+n)}class ob{static#t;static toDateObject(t){if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let u=parseInt(e[6],10);u=u>=0&&u<=59?u:0;const f=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,f==="-"?(a+=d,l+=p):f==="+"&&(a-=d,l-=p),new Date(Date.UTC(i,r,s,a,l,u))}}function TC(n,{scale:t=1,rotation:e=0}){const{width:i,height:r}=n.attributes.style,s=[0,0,parseInt(i),parseInt(r)];return new sp({viewBox:s,userUnit:1,scale:t,rotation:e})}function lb(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ze(`Not a valid color format: "${n}"`),[0,0,0])}function JM(n){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of n.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;n.set(e,lb(i))}t.remove()}function $n(n){const{a:t,b:e,c:i,d:r,e:s,f:a}=n.getTransform();return[t,e,i,r,s,a]}function ka(n){const{a:t,b:e,c:i,d:r,e:s,f:a}=n.getTransform().invertSelf();return[t,e,i,r,s,a]}function Nl(n,t,e=!1,i=!0){if(t instanceof sp){const{pageWidth:r,pageHeight:s}=t.rawDims,{style:a}=n,l=Oi.isCSSRoundSupported,u=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${s}px`,d=l?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,p=l?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(a.width=d,a.height=p):(a.width=p,a.height=d)}i&&n.setAttribute("data-main-rotation",t.rotation)}class ca{constructor(){const{pixelRatio:t}=ca;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,r,s=-1){let a=1/0,l=1/0,u=1/0;i=ca.capPixels(i,s),i>0&&(a=Math.sqrt(i/(t*e))),r!==-1&&(l=r/t,u=r/e);const f=Math.min(a,l,u);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const Jm=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class bd{#t=null;#e=null;#n;#i=null;#s=null;#r=null;static#l=null;constructor(t){this.#n=t,bd.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;t.addEventListener("contextmenu",js,{signal:e}),t.addEventListener("pointerdown",bd.#o,{signal:e});const i=this.#i=document.createElement("div");i.className="buttons",t.append(i);const r=this.#n.toolbarPosition;if(r){const{style:s}=t,a=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),t}get div(){return this.#t}static#o(t){t.stopPropagation()}#f(t){this.#n._focusEventsAllowed=!1,ei(t)}#c(t){this.#n._focusEventsAllowed=!0,ei(t)}#h(t){const e=this.#n._uiManager._signal;t.addEventListener("focusin",this.#f.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",js,{signal:e})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown()}#u(){const{editorType:t,_uiManager:e}=this.#n,i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",bd.#l[t]),this.#h(i),i.addEventListener("click",r=>{e.delete()},{signal:e._signal}),this.#i.append(i)}get#d(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#h(e),this.#i.prepend(e,this.#d),this.#s=t}addColorPicker(t){this.#e=t;const e=t.renderButton();this.#h(e),this.#i.prepend(e,this.#d)}async addEditSignatureButton(t){const e=this.#r=await t.renderEditButton(this.#n);this.#h(e),this.#i.prepend(e,this.#d)}updateEditSignatureButton(t){this.#r&&(this.#r.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class tP{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",js,{signal:this.#n._signal});const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#r(),t}#s(t,e){let i=0,r=0;for(const s of t){const a=s.y+s.height;if(a<i)continue;const l=s.x+(e?s.width:0);if(a>i){r=l,i=a;continue}e?l>r&&(r=l):l<r&&(r=l)}return[e?1-r:r,i]}show(t,e,i){const[r,s]=this.#s(e,i),{style:a}=this.#e||=this.#i();t.append(this.#e),a.insetInlineEnd=`${100*r}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=this.#n._signal;t.addEventListener("contextmenu",js,{signal:i}),t.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:i}),this.#t.append(t)}}function CC(n,t,e){for(const i of e)t.addEventListener(i,n[i].bind(n))}class eP{#t=0;get id(){return`${jM}${this.#t++}`}}class cb{#t=sb();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const s=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Xe(this,"_isSVGFittingCanvas",s)}async#i(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof e=="string"?(i.url=e,r=await Sf(e,"blob")):e instanceof File?r=i.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const s=cb._isSVGFittingCanvas,a=new FileReader,l=new Image,u=new Promise((f,d)=>{l.onload=()=>{i.bitmap=l,i.isSvg=!0,f()},a.onload=async()=>{const p=i.svgUrl=a.result;l.src=await s?`${p}#svgView(preserveAspectRatio(none))`:p},l.onerror=a.onerror=d});a.readAsDataURL(r),await u}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){ze(r),i=null}return this.#n.set(t,i),i&&this.#n.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:r,type:s}=t;return this.#i(`${e}_${i}_${r}_${s}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const i=await e;return this.#i(t,i)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,i),this.#n.set(i.id,i),i}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=r.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class nP{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:i,mustExec:r,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(r&&t(),this.#e)return;const u={cmd:t,undo:e,post:i,type:s};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(u);return}if(a&&this.#t[this.#i].type===s){l&&(u.undo=this.#t[this.#i].undo),this.#t[this.#i]=u;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(u)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class op{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Oi.platform;for(const[i,r,s={}]of t)for(const a of i){const l=a.startsWith("mac+");e&&l?(this.callbacks.set(a.slice(4),{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1))):!e&&!l&&(this.callbacks.set(a,{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:r,options:{bubbles:s=!1,args:a=[],checker:l=null}}=i;l&&!l(t,e)||(r.bind(t,...a,e)(),s||ei(e))}}class ub{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return JM(t),Xe(this,"_colors",t)}convert(t){const e=lb(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,r]of this._colors)if(r.every((s,a)=>s===e[a]))return ub._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?be.makeHexColor(...e):t}}class Uo{#t=new AbortController;#e=null;#n=new Map;#i=new Map;#s=null;#r=null;#l=null;#o=new nP;#f=null;#c=null;#h=0;#u=new Set;#d=null;#a=null;#p=new Set;_editorUndoBar=null;#g=!1;#m=!1;#v=!1;#_=null;#x=null;#y=null;#w=null;#S=!1;#C=null;#O=new eP;#E=!1;#D=!1;#T=null;#N=null;#k=null;#L=null;#z=null;#A=Be.NONE;#b=new Set;#F=null;#B=null;#$=null;#G=null;#V={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#I=null;#M=null;#H=null;#P=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Uo.prototype,e=a=>a.#M.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:u}=l;return u!=="text"&&u!=="number"}return!0},r=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Xe(this,"_keyboardManager",new op([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#M.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#M.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}constructor(t,e,i,r,s,a,l,u,f,d,p,m,v,x){const _=this._signal=this.#t.signal;this.#M=t,this.#H=e,this.#s=i,this.#B=r,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:_}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),s._on("setpreference",this.onSetPreference.bind(this),{signal:_}),s._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:_}),this.#it(),this.#ot(),this.#K(),this.#r=a.annotationStorage,this.#_=a.filterFactory,this.#$=l,this.#w=u||null,this.#g=f,this.#m=d,this.#v=p,this.#z=m||null,this.viewParameters={realScale:Rc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=x!==!1}destroy(){this.#P?.resolve(),this.#P=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#i.values())t.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#L?.clear(),this.#e=null,this.#b.clear(),this.#o.destroy(),this.#s?.destroy(),this.#B?.destroy(),this.#C?.hide(),this.#C=null,this.#k?.destroy(),this.#k=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#I&&(clearTimeout(this.#I),this.#I=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#z}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Xe(this,"hcmFilter",this.#$?this.#_.addHCMFilter(this.#$.foreground,this.#$.background):"none")}get direction(){return Xe(this,"direction",getComputedStyle(this.#M).direction)}get highlightColors(){return Xe(this,"highlightColors",this.#w?new Map(this.#w.split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Xe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#k=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}getSignature(t){this.#B?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#B}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=e;break}}onPageChanging({pageNumber:t}){this.#h=t-1}focusMainContainer(){this.#M.focus()}findParent(t,e){for(const i of this.#i.values()){const{x:r,y:s,width:a,height:l}=i.div.getBoundingClientRect();if(t>=r&&t<=r+a&&e>=s&&e<=s+l)return i}return null}disableUserSelect(t=!1){this.#H.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Rc.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#X(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#i.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a}=e,l=e.toString(),f=this.#q(e).closest(".textLayer"),d=this.getSelectionBoxes(f);if(!d)return;e.empty();const p=this.#X(f),m=this.#A===Be.NONE,v=()=>{p?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a,text:l}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Be.HIGHLIGHT,v);return}v()}#et(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#q(t).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(this.#C||=new tP(this),this.#C.show(i,r,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}#nt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#F&&(this.#C?.hide(),this.#F=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#F)return;const r=this.#q(t).closest(".textLayer");if(!r){this.#F&&(this.#C?.hide(),this.#F=null,this.#R({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#F=e,this.#R({hasSelectedText:!0}),!(this.#A!==Be.HIGHLIGHT&&this.#A!==Be.NONE)&&(this.#A===Be.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const s=this.#A===Be.HIGHLIGHT?this.#X(r):null;s?.toggleDrawing();const a=new AbortController,l=this.combinedSignal(a),u=f=>{f.type==="pointerup"&&f.button!==0||(a.abort(),s?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",u,{signal:l}),window.addEventListener("blur",u,{signal:l})}}#Y(t=""){this.#A===Be.HIGHLIGHT?this.highlightSelection(t):this.#g&&this.#et()}#it(){document.addEventListener("selectionchange",this.#nt.bind(this),{signal:this._signal})}#rt(){if(this.#y)return;this.#y=new AbortController;const t=this.combinedSignal(this.#y);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#st(){this.#y?.abort(),this.#y=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#b)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#K(){if(this.#T)return;this.#T=new AbortController;const t=this.combinedSignal(this.#T);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#at(){this.#T?.abort(),this.#T=null}#Z(){if(this.#f)return;this.#f=new AbortController;const t=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#Q(){this.#f?.abort(),this.#f=null}#ot(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#K(),this.#Z()}removeEditListeners(){this.#at(),this.#Q()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#a)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#a)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#b){const r=i.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const a of this.#a)if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){ze(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const s=[];for(const u of i){const f=await r.deserialize(u);if(!f)return;s.push(f)}const a=()=>{for(const u of s)this.#J(u);this.#tt(s)},l=()=>{for(const u of s)u.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(s){ze(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==Be.NONE&&!this.isEditorHandlingKeyboard&&Uo._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#R(t){Object.entries(t).some(([i,r])=>this.#V[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#V,t)}),this.#A===Be.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#U([[Ke.HIGHLIGHT_FREE,!0]]))}#U(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#rt(),this.#Z(),this.#R({isEditing:this.#A!==Be.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#st(),this.#Q(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#a){this.#a=t;for(const e of this.#a)this.#U(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#i.get(this.#h)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#h}addLayer(t){this.#i.set(t.pageIndex,t),this.#E?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}async updateMode(t,e=null,i=!1){if(this.#A!==t&&!(this.#P&&(await this.#P.promise,!this.#P))){if(this.#P=Promise.withResolvers(),this.#c?.commitOrRemove(),this.#A=t,t===Be.NONE){this.setEditingState(!1),this.#ct(),this._editorUndoBar?.hide(),this.#P.resolve();return}t===Be.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#lt(),this.unselectAll();for(const r of this.#i.values())r.updateMode(t);if(!e){i&&this.addNewEditorFromKeyboard(),this.#P.resolve();return}for(const r of this.#n.values())r.annotationElementId===e||r.id===e?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#P.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#a){switch(t){case Ke.CREATE:this.currentLayer.addNewEditor(e);return;case Ke.HIGHLIGHT_DEFAULT_COLOR:this.#k?.updateColor(e);break;case Ke.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const i of this.#b)i.updateParams(t,e);for(const i of this.#a)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const s of this.#n.values())s.editorType===t&&s.show(e);(this.#G?.get(Ke.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#U([[Ke.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#D!==t){this.#D=t;for(const e of this.#i.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#lt(){if(!this.#E){this.#E=!0;const t=[];for(const e of this.#i.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#ct(){if(this.unselectAll(),this.#E){this.#E=!1;for(const t of this.#i.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const i of this.#n.values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#L?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#u.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#u.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#u.has(t)}removeDeletedAnnotationElement(t){this.#u.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#J(t){const e=this.#i.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#U(t.propertiesToUpdate))}get#ut(){let t=null;for(t of this.#b);return t}updateUI(t){this.#ut===t&&this.#U(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#U(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#b.has(t)){this.#b.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#b.add(t),t.select(),this.#U(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.#c?.commitOrRemove();for(const e of this.#b)e!==t&&e.unselect();this.#b.clear(),this.#b.add(t),t.select(),this.#U(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#b.has(t)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(t){t.unselect(),this.#b.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#R({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#o.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#o.cleanType(t)}#W(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#b],i=()=>{this._editorUndoBar?.show(r,e.length===1?e[0].editorType:e.length);for(const s of e)s.remove()},r=()=>{for(const s of e)this.#J(s)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#tt(t){for(const e of this.#b)e.unselect();this.#b.clear();for(const e of t)e.isEmpty()||(this.#b.add(e),e.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#b)t.commit();this.#tt(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#A!==Be.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const t of this.#b)t.unselect();this.#b.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=e;const[r,s]=this.#j,a=[...this.#b],l=1e3;this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(const u of a)this.#n.has(u.id)&&(u.translateInPage(r,s),u.translationDone())},undo:()=>{for(const u of a)this.#n.has(u.id)&&(u.translateInPage(-r,-s),u.translationDone())},mustExec:!1})},l);for(const u of a)u.translateInPage(t,e),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#d=new Map;for(const t of this.#b)this.#d.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#d)return!1;this.disableUserSelect(!1);const t=this.#d;this.#d=null;let e=!1;for(const[{x:r,y:s,pageIndex:a},l]of t)l.newX=r,l.newY=s,l.newPageIndex=a,e||=r!==l.savedX||s!==l.savedY||a!==l.savedPageIndex;if(!e)return!1;const i=(r,s,a,l)=>{if(this.#n.has(r.id)){const u=this.#i.get(l);u?r._setParentAndPosition(u,s,a):(r.pageIndex=l,r.x=s,r.y=a)}};return this.addCommands({cmd:()=>{for(const[r,{newX:s,newY:a,newPageIndex:l}]of t)i(r,s,a,l)},undo:()=>{for(const[r,{savedX:s,savedY:a,savedPageIndex:l}]of t)i(r,s,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#d)for(const i of this.#d.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#A}get imageManager(){return Xe(this,"imageManager",new cb)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,d=e.rangeCount;f<d;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:r,width:s,height:a}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(f,d,p,m)=>({x:(d-r)/a,y:1-(f+p-i)/s,width:m/a,height:p/s});break;case"180":l=(f,d,p,m)=>({x:1-(f+p-i)/s,y:1-(d+m-r)/a,width:p/s,height:m/a});break;case"270":l=(f,d,p,m)=>({x:1-(d+m-r)/a,y:(f-i)/s,width:m/a,height:p/s});break;default:l=(f,d,p,m)=>({x:(f-i)/s,y:(d-r)/a,width:p/s,height:m/a});break}const u=[];for(let f=0,d=e.rangeCount;f<d;f++){const p=e.getRangeAt(f);if(!p.collapsed)for(const{x:m,y:v,width:x,height:_}of p.getClientRects())x===0||_===0||u.push(l(m,v,x,_))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#l||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const e=this.#l?.get(t.data.id);if(!e)return;const i=this.#r.getRawValue(e);i&&(this.#A===Be.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const r=this.#L?.get(t);r&&(r.setCanvas(e,i),this.#L.delete(t))}addMissingCanvas(t,e){(this.#L||=new Map).set(t,e)}}class Ba{#t=null;#e=!1;#n=null;#i=null;#s=null;#r=null;#l=!1;#o=null;#f=null;#c=null;#h=null;#u=!1;static#d=null;static _l10n=null;constructor(t){this.#f=t,this.#u=t._uiManager.useNewAltTextFlow,Ba.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ba._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ba.#d.missing),e.setAttribute("data-l10n-id",Ba.#d["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#f._uiManager._signal;t.addEventListener("contextmenu",js,{signal:i}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:i});const r=s=>{s.preventDefault(),this.#f._uiManager.editAltText(this.#f),this.#u&&this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return t.addEventListener("click",r,{capture:!0,signal:i}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(this.#l=!0,r(s))},{signal:i}),await this.#p(),t}get#a(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#h=await Ba._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#f.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#h),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#h}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:r,cancel:s=!1}){i&&(this.#c=i,this.#h=r),!(this.#t===t&&this.#e===e)&&(s||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!t)}shown(){this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ba.#d[this.#a]),this.#i?.setAttribute("data-l10n-id",Ba.#d[`${this.#a}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#f.id}`;const r=100,s=this.#f._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#f._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:s}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:s})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#f.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class lp{#t;#e=!1;#n=null;#i;#s;#r;#l;#o=null;#f;#c=null;#h;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:s=null,onPinchEnd:a=null,signal:l}){this.#t=t,this.#n=i,this.#i=e,this.#s=r,this.#r=s,this.#l=a,this.#h=new AbortController,this.#f=AbortSignal.any([l,this.#h.signal]),t.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#f})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ca.pixelRatio}#d(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,s=AbortSignal.any([this.#f,r.signal]),a=this.#t,l={capture:!0,signal:s,passive:!1},u=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};a.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ei(f),u(f))},l),a.addEventListener("pointerup",u,l),a.addEventListener("pointercancel",u,l);return}if(!this.#u){this.#u=new AbortController;const r=AbortSignal.any([this.#f,this.#u.signal]),s=this.#t,a={signal:r,capture:!1,passive:!1};s.addEventListener("touchmove",this.#a.bind(this),a);const l=this.#p.bind(this);s.addEventListener("touchend",l,a),s.addEventListener("touchcancel",l,a),a.capture=!0,s.addEventListener("pointerdown",ei,a),s.addEventListener("pointermove",ei,a),s.addEventListener("pointercancel",ei,a),s.addEventListener("pointerup",ei,a),this.#s?.()}if(ei(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#a(t){if(!this.#c||t.touches.length!==2)return;ei(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:r,screenY:s}=e,{screenX:a,screenY:l}=i,u=this.#c,{touch0X:f,touch0Y:d,touch1X:p,touch1Y:m}=u,v=p-f,x=m-d,_=a-r,b=l-s,E=Math.hypot(_,b)||1,T=Math.hypot(v,x)||1;if(!this.#e&&Math.abs(T-E)<=lp.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=r,u.touch0Y=s,u.touch1X=a,u.touch1Y=l,!this.#e){this.#e=!0;return}const S=[(r+a)/2,(s+l)/2];this.#r?.(S,T,E)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#l?.()),this.#c&&(ei(t),this.#c=null,this.#e=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class Se{#t=null;#e=null;#n=null;#i=!1;#s=null;#r="";#l=!1;#o=null;#f=null;#c=null;#h=null;#u="";#d=!1;#a=null;#p=!1;#g=!1;#m=!1;#v=null;#_=0;#x=0;#y=null;#w=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#C=Se._zIndex++;static _borderLineWidth=-1;static _colorManager=new ub;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Se.prototype._resizeWithKeyboard,e=Uo.TRANSLATE_SMALL,i=Uo.TRANSLATE_BIG;return Xe(this,"_resizerKeyboardManager",new op([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Se.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:r,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[s,a];const[l,u]=this.parentDimensions;this.x=t.x/l,this.y=t.y/u,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Xe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new iP({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Se._l10n??=t,Se._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Se._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Se._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Tn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#H(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#d?this.#d=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,r){const[s,a]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(t+i)/s,this.y=(e+r)/a,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,r]=this.parentDimensions;this.setAt(t*i,e*r,this.width*i,this.height*r),this._onTranslated()}#O([t,e],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#O(this.parentDimensions,t,e)}translateInPage(t,e){this.#a||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#a||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[r,s]}=this;if(this.x+=t/r,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[u,f]=this.getBaseTranslation();a+=u,l+=f;const{style:d}=i;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Se,r=i/t,s=i/e;switch(this.rotation){case 90:return[-r,s];case 180:return[r,s];case 270:return[r,-s];default:return[-r,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,r]}=this;let{x:s,y:a,width:l,height:u}=this;if(l*=i,u*=r,s*=i,a*=r,this._mustFixPosition)switch(t){case 0:s=Ji(s,0,i-l),a=Ji(a,0,r-u);break;case 90:s=Ji(s,0,i-u),a=Ji(a,l,r);break;case 180:s=Ji(s,l,i),a=Ji(a,u,r);break;case 270:s=Ji(s,u,i),a=Ji(a,0,r-l);break}this.x=s/=i,this.y=a/=r;const[f,d]=this.getBaseTranslation();s+=f,a+=d,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#E(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Se.#E(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Se.#E(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(t,e){const[i,r]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*t/i).toFixed(2)}%`,this.#l||(s.height=`${(100*e/r).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,r=i.endsWith("%"),s=!this.#l&&e.endsWith("%");if(r&&s)return;const[a,l]=this.parentDimensions;r||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!this.#l&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#T(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const r=document.createElement("div");this.#o.append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",this.#N.bind(this,i),{signal:e}),r.addEventListener("contextmenu",js,{signal:e}),r.tabIndex=-1}this.div.prepend(this.#o)}#N(t,e){e.preventDefault();const{isMac:i}=Oi.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#f=[e.screenX,e.screenY];const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#z.bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",ei,{passive:!1,signal:a}),window.addEventListener("contextmenu",js,{signal:a}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const l=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=l,this.div.style.cursor=u,this.#L()};window.addEventListener("pointerup",f,{signal:a}),window.addEventListener("blur",f,{signal:a})}#k(t,e,i,r){this.width=i,this.height=r,this.x=t,this.y=e;const[s,a]=this.parentDimensions;this.setDims(s*i,a*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#L(){if(!this.#c)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:r}=this.#c;this.#c=null;const s=this.x,a=this.y,l=this.width,u=this.height;s===t&&a===e&&l===i&&u===r||this.addCommands({cmd:this.#k.bind(this,s,a,l,u),undo:this.#k.bind(this,t,e,i,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#z(t,e){const[i,r]=this.parentDimensions,s=this.x,a=this.y,l=this.width,u=this.height,f=Se.MIN_SIZE/i,d=Se.MIN_SIZE/r,p=this.#D(this.rotation),m=(Q,X)=>[p[0]*Q+p[2]*X,p[1]*Q+p[3]*X],v=this.#D(360-this.rotation),x=(Q,X)=>[v[0]*Q+v[2]*X,v[1]*Q+v[3]*X];let _,b,E=!1,T=!1;switch(t){case"topLeft":E=!0,_=(Q,X)=>[0,0],b=(Q,X)=>[Q,X];break;case"topMiddle":_=(Q,X)=>[Q/2,0],b=(Q,X)=>[Q/2,X];break;case"topRight":E=!0,_=(Q,X)=>[Q,0],b=(Q,X)=>[0,X];break;case"middleRight":T=!0,_=(Q,X)=>[Q,X/2],b=(Q,X)=>[0,X/2];break;case"bottomRight":E=!0,_=(Q,X)=>[Q,X],b=(Q,X)=>[0,0];break;case"bottomMiddle":_=(Q,X)=>[Q/2,X],b=(Q,X)=>[Q/2,0];break;case"bottomLeft":E=!0,_=(Q,X)=>[0,X],b=(Q,X)=>[Q,0];break;case"middleLeft":T=!0,_=(Q,X)=>[0,X/2],b=(Q,X)=>[Q,X/2];break}const S=_(l,u),O=b(l,u);let R=m(...O);const N=Se._round(s+R[0]),C=Se._round(a+R[1]);let M=1,I=1,F,z;if(e.fromKeyboard)({deltaX:F,deltaY:z}=e);else{const{screenX:Q,screenY:X}=e,[Rt,yt]=this.#f;[F,z]=this.screenToPageTranslation(Q-Rt,X-yt),this.#f[0]=Q,this.#f[1]=X}if([F,z]=x(F/i,z/r),E){const Q=Math.hypot(l,u);M=I=Math.max(Math.min(Math.hypot(O[0]-S[0]-F,O[1]-S[1]-z)/Q,1/l,1/u),f/l,d/u)}else T?M=Ji(Math.abs(O[0]-S[0]-F),f,1)/l:I=Ji(Math.abs(O[1]-S[1]-z),d,1)/u;const P=Se._round(l*M),tt=Se._round(u*I);R=m(...b(P,tt));const L=N-R[0],nt=C-R[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=P,this.height=tt,this.x=L,this.y=nt,this.setDims(i*P,r*tt),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#g?this._editToolbar:(this._editToolbar=new bd(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(Ba.initialize(Se._l10n),this.#n=new Ba(this),this.#t&&(this.#n.data=this.#t,this.#t=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#i?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#G();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[r,s]=this.getInitialTranslation();return this.translate(r,s),CC(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#w||=new lp({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#A.bind(this),onPinching:this.#b.bind(this),onPinchEnd:this.#F.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#A(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#b(t,e,i){let s=.7*(i/e)+1-.7;if(s===1)return;const a=this.#D(this.rotation),l=(N,C)=>[a[0]*N+a[2]*C,a[1]*N+a[3]*C],[u,f]=this.parentDimensions,d=this.x,p=this.y,m=this.width,v=this.height,x=Se.MIN_SIZE/u,_=Se.MIN_SIZE/f;s=Math.max(Math.min(s,1/m,1/v),x/m,_/v);const b=Se._round(m*s),E=Se._round(v*s);if(b===m&&E===v)return;this.#a||=[d,p,m,v];const T=l(m/2,v/2),S=Se._round(d+T[0]),O=Se._round(p+T[1]),R=l(b/2,E/2);this.x=S-R[0],this.y=O-R[1],this.width=b,this.height=E,this.setDims(u*b,f*E),this.fixAndSetPosition(),this._onResizing()}#F(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#L()}pointerdown(t){const{isMac:e}=Oi.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#d=!0,this._isDraggable){this.#$(t);return}this.#B(t)}#B(t){const{isMac:e}=Oi.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,s=this._uiManager.combinedSignal(r),a={capture:!0,passive:!1,signal:s},l=f=>{r.abort(),this.#s=null,this.#d=!1,this._uiManager.endDragSession()||this.#B(f),i&&this._onStopDragging()};e&&(this.#_=t.clientX,this.#x=t.clientY,this.#s=t.pointerId,this.#r=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._onStartDragging());const{clientX:d,clientY:p,pointerId:m}=f;if(m!==this.#s){ei(f);return}const[v,x]=this.screenToPageTranslation(d-this.#_,p-this.#x);this.#_=d,this.#x=p,this._uiManager.dragSelectedEditors(v,x)},a),window.addEventListener("touchmove",ei,a),window.addEventListener("pointerdown",f=>{f.pointerType===this.#r&&(this.#w||f.isPrimary)&&l(f),ei(f)},a));const u=f=>{if(!this.#s||this.#s===f.pointerId){l(f);return}ei(f)};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const r=this.parentScale,[s,a]=this.pageDimensions,[l,u]=this.pageTranslation,f=t/r,d=e/r,p=this.x*s,m=this.y*a,v=this.width*s,x=this.height*a;switch(i){case 0:return[p+f+l,a-m-d-x+u,p+f+v+l,a-m-d+u];case 90:return[p+d+l,a-m+f+u,p+d+x+l,a-m+f+v+u];case 180:return[p-f-v+l,a-m+d+u,p-f+l,a-m+d+x+u];case 270:return[p-d-x+l,a-m-f-v+u,p-d+l,a-m-f+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,r,s,a]=t,l=s-i,u=a-r;switch(this.rotation){case 0:return[i,e-a,l,u];case 90:return[i,e-r,u,l];case 180:return[s,e-r,l,u];case 270:return[s,e-a,u,l];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#g=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#g=!1,!0):!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#m}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return e<a&&r>0&&t<s&&i>0}#G(){if(this.#h||!this.div)return;this.#h=new AbortController;const t=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#G()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){Tn("An editor must be serializable")}static async deserialize(t,e,i){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[s,a]=r.pageDimensions,[l,u,f,d]=r.getRectInCurrentCoords(t.rect,a);return r.x=l/s,r.y=u/a,r.width=f/s,r.height=d/a,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#H(),this.removeEditToolbar(),this.#y){for(const t of this.#y.values())clearTimeout(t);this.#y=null}this.parent=null,this.#w?.destroy(),this.#w=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#T(),this.#o.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#o.children;if(!this.#e){this.#e=Array.from(e);const a=this.#V.bind(this),l=this.#j.bind(this),u=this._uiManager._signal;for(const f of this.#e){const d=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",a,{signal:u}),f.addEventListener("blur",l,{signal:u}),f.addEventListener("focus",this.#I.bind(this,d),{signal:u}),f.setAttribute("data-l10n-id",Se._l10nResizer[d])}}const i=this.#e[0];let r=0;for(const a of e){if(a===i)break;r++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(s!==r){if(s<r)for(let l=0;l<r-s;l++)this.#o.append(this.#o.firstChild);else if(s>r)for(let l=0;l<s-r;l++)this.#o.firstChild.before(this.#o.lastChild);let a=0;for(const l of e){const f=this.#e[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",Se._l10nResizer[f])}}this.#M(0),this.#m=!0,this.#o.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#V(t){Se._resizerKeyboardManager.exec(this,t)}#j(t){this.#m&&t.relatedTarget?.parentNode!==this.#o&&this.#H()}#I(t){this.#u=this.#m?t:""}#M(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#m&&this.#z(this.#u,{deltaX:t,deltaY:e,fromKeyboard:!0})}#H(){this.#m=!1,this.#M(-1),this.#L()}_stopResizingWithKeyboard(){this.#H(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#l=!0;const i=t/e,{style:r}=this.div;r.aspectRatio=i,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#y||=new Map;const{action:i}=t;let r=this.#y.get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#y.delete(i),this.#y.size===0&&(this.#y=null)},Se._telemetryTimeout),this.#y.set(i,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class iP extends Se{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const UA=3285377520,Os=4294901760,La=65535;class DC{constructor(t){this.h1=t?t&4294967295:UA,this.h2=t?t&4294967295:UA}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let _=0,b=t.length;_<b;_++){const E=t.charCodeAt(_);E<=255?e[i++]=E:(e[i++]=E>>>8,e[i++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,s=i-r*4,a=new Uint32Array(e.buffer,0,r);let l=0,u=0,f=this.h1,d=this.h2;const p=3432918353,m=461845907,v=p&La,x=m&La;for(let _=0;_<r;_++)_&1?(l=a[_],l=l*p&Os|l*v&La,l=l<<15|l>>>17,l=l*m&Os|l*x&La,f^=l,f=f<<13|f>>>19,f=f*5+3864292196):(u=a[_],u=u*p&Os|u*v&La,u=u<<15|u>>>17,u=u*m&Os|u*x&La,d^=u,d=d<<13|d>>>19,d=d*5+3864292196);switch(l=0,s){case 3:l^=e[r*4+2]<<16;case 2:l^=e[r*4+1]<<8;case 1:l^=e[r*4],l=l*p&Os|l*v&La,l=l<<15|l>>>17,l=l*m&Os|l*x&La,r&1?f^=l:d^=l}this.h1=f,this.h2=d}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Os|t*36045&La,e=e*4283543511&Os|((e<<16|t>>>16)*2950163797&Os)>>>16,t^=e>>>1,t=t*444984403&Os|t*60499&La,e=e*3301882366&Os|((e<<16|t>>>16)*3120437893&Os)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const ox=Object.freeze({map:null,hash:"",transfer:void 0});class fb{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#n.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof Se)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#n.get(t);let r=!1;if(i!==void 0)for(const[s,a]of Object.entries(e))i[s]!==a&&(r=!0,i[s]=a);else r=!0,this.#n.set(t,e);r&&this.#i(),e instanceof Se&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}get size(){return this.#n.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new OC(this)}get serializable(){if(this.#n.size===0)return ox;const t=new Map,e=new DC,i=[],r=Object.create(null);let s=!1;for(const[a,l]of this.#n){const u=l instanceof Se?l.serialize(!1,r):l;u&&(t.set(a,u),e.update(`${a}:${JSON.stringify(u)}`),s||=!!u.bitmap)}if(s)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:ox}get editorStats(){let t=null;const e=new Map;for(const i of this.#n.values()){if(!(i instanceof Se))continue;const r=i.telemetryFinalData;if(!r)continue;const{type:s}=r;e.has(s)||e.set(s,Object.getPrototypeOf(i).constructor),t||=Object.create(null);const a=t[s]||=new Map;for(const[l,u]of Object.entries(r)){if(l==="type")continue;let f=a.get(l);f||(f=new Map,a.set(l,f));const d=f.get(u)??0;f.set(u,d+1)}}for(const[i,r]of e)t[i]=r.computeTelemetryFinalData(t[i]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof Se)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class OC extends fb{#t;constructor(t){super();const{map:e,hash:i,transfer:r}=t.serializable,s=structuredClone(e,r?{transfer:r}:null);this.#t={map:s,hash:i,transfer:r}}get print(){Tn("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Xe(this,"modifiedIds",{ids:new Set,hash:""})}}class rP{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(ui(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:s,style:a}=t,l=new FontFace(r,s,a);this.addNativeFontFace(l);try{await l.load(),this.#t.add(r),i?.(t)}catch{ze(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Tn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw ze(`Failed to load font '${i.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Xe(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Xe(this,"isSyncFontLoadingSupported",br||Oi.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(ui(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:e,callback:t};return i.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Xe(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(O,R){return O.charCodeAt(R)<<24|O.charCodeAt(R+1)<<16|O.charCodeAt(R+2)<<8|O.charCodeAt(R+3)&255}function r(O,R,N,C){const M=O.substring(0,R),I=O.substring(R+N);return M+C+I}let s,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const u=l.getContext("2d");let f=0;function d(O,R){if(++f>30){ze("Load test font never loaded."),R();return}if(u.font="30px "+O,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(d.bind(null,O,R))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=r(m,976,p.length,p);const x=16,_=1482184792;let b=i(m,x);for(s=0,a=p.length-3;s<a;s+=4)b=b-_+i(p,s)|0;s<p.length&&(b=b-_+i(p+"XXX",s)|0),m=r(m,x,4,WM(b));const E=`url(data:font/opentype;base64,${btoa(m)});`,T=`@font-face {font-family:"${p}";src:${E}}`;this.insertRule(T);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const O of[t.loadedName,p]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=O,S.append(R)}this._document.body.append(S),d(p,()=>{S.remove(),e.complete()})}}class sP{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const i in t)this[i]=t[i];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${wC(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let r;try{r=t.get(i)}catch(a){ze(`getPathGenerator - ignoring character: "${a}".`)}const s=new Path2D(r||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=s}}function aP(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(br)return n;const t=URL.parse(n,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function oP(n){if(br&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return rp(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function sm(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const lx=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,lP=n=>typeof n=="object"&&typeof n?.name=="string",RC=KM.bind(null,lx,lP);class cP{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,i)})}addEventListener(t,e,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:s}=i;if(s.aborted){ze("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);r=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}this.#t.set(e,r)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const am={DATA:1,ERROR:2},oi={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function zA(){}function jr(n){if(n instanceof Bo||n instanceof Qm||n instanceof PA||n instanceof Nd||n instanceof l_)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Tn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Bo(n.message);case"InvalidPDFException":return new Qm(n.message);case"PasswordException":return new PA(n.message,n.code);case"ResponseException":return new Nd(n.message,n.status,n.missing);case"UnknownErrorException":return new l_(n.message,n.details)}return new l_(n.message,n.toString())}class pd{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const i=t.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===am.DATA)r.resolve(t.data);else if(t.callback===am.ERROR)r.reject(jr(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,r=t.sourceName,s=this.comObj;Promise.try(e,t.data).then(function(a){s.postMessage({sourceName:i,targetName:r,callback:am.DATA,callbackId:t.callbackId,data:a})},function(a){s.postMessage({sourceName:i,targetName:r,callback:am.ERROR,callbackId:t.callbackId,reason:jr(a)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const r=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},i)}catch(a){s.reject(a)}return s.promise}sendWithStream(t,e,i,r){const s=this.streamId++,a=this.sourceName,l=this.targetName,u=this.comObj;return new ReadableStream({start:f=>{const d=Promise.withResolvers();return this.streamControllers[s]={controller:f,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:a,targetName:l,action:t,streamId:s,data:e,desiredSize:f.desiredSize},r),d.promise},pull:f=>{const d=Promise.withResolvers();return this.streamControllers[s].pullCall=d,u.postMessage({sourceName:a,targetName:l,stream:oi.PULL,streamId:s,desiredSize:f.desiredSize}),d.promise},cancel:f=>{ui(f instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[s].cancelCall=d,this.streamControllers[s].isClosed=!0,u.postMessage({sourceName:a,targetName:l,stream:oi.CANCEL,streamId:s,reason:jr(f)}),d.promise}},i)}#n(t){const e=t.streamId,i=this.sourceName,r=t.sourceName,s=this.comObj,a=this,l=this.actionHandler[t.action],u={enqueue(f,d=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=d,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:r,stream:oi.ENQUEUE,streamId:e,chunk:f},p)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:oi.CLOSE,streamId:e}),delete a.streamSinks[e])},error(f){ui(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:oi.ERROR,streamId:e,reason:jr(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[e]=u,Promise.try(l,t.data,u).then(function(){s.postMessage({sourceName:i,targetName:r,stream:oi.START_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:i,targetName:r,stream:oi.START_COMPLETE,streamId:e,reason:jr(f)})})}#i(t){const e=t.streamId,i=this.sourceName,r=t.sourceName,s=this.comObj,a=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case oi.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(jr(t.reason));break;case oi.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(jr(t.reason));break;case oi.PULL:if(!l){s.postMessage({sourceName:i,targetName:r,stream:oi.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||zA).then(function(){s.postMessage({sourceName:i,targetName:r,stream:oi.PULL_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:i,targetName:r,stream:oi.PULL_COMPLETE,streamId:e,reason:jr(f)})});break;case oi.ENQUEUE:if(ui(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case oi.CLOSE:if(ui(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#s(a,e);break;case oi.ERROR:ui(a,"error should have stream controller"),a.controller.error(jr(t.reason)),this.#s(a,e);break;case oi.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(jr(t.reason)),this.#s(a,e);break;case oi.CANCEL:if(!l)break;const u=jr(t.reason);Promise.try(l.onCancel||zA,u).then(function(){s.postMessage({sourceName:i,targetName:r,stream:oi.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:i,targetName:r,stream:oi.CANCEL_COMPLETE,streamId:e,reason:jr(f)})}),l.sinkCapability.reject(u),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class NC{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Tn("Abstract method `_createCanvas` called.")}}class uP extends NC{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class kC{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Tn("Abstract method `_fetch` called.")}}class jA extends kC{async _fetch(t){const e=await Sf(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):rp(e)}}class LC{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,r,s){return"none"}destroy(t=!1){}}class fP extends LC{#t;#e;#n;#i;#s;#r;#l=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#s=e}get#o(){return this.#e||=new Map}get#f(){return this.#r||=new Map}get#c(){if(!this.#n){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(Co,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#n=this.#s.createElementNS(Co,"defs"),t.append(i),i.append(this.#n),this.#s.body.append(t)}return this.#n}#h(t){if(t.length===1){const u=t[0],f=new Array(256);for(let p=0;p<256;p++)f[p]=u[p]/255;const d=f.join(",");return[d,d,d]}const[e,i,r]=t,s=new Array(256),a=new Array(256),l=new Array(256);for(let u=0;u<256;u++)s[u]=e[u]/255,a[u]=i[u]/255,l[u]=r[u]/255;return[s.join(","),a.join(","),l.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(ap(e)?ze('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=rb(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,r,s]=this.#h(t),a=t.length===1?i:`${i}${r}${s}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#i}_transfer_map_${this.#l++}`,u=this.#u(l);this.#o.set(t,u),this.#o.set(a,u);const f=this.#p(l);return this.#m(i,r,s,f),u}addHCMFilter(t,e){const i=`${t}-${e}`,r="base";let s=this.#f.get(r);if(s?.key===i||(s?(s.filter?.remove(),s.key=i,s.url="none",s.filter=null):(s={key:i,url:"none",filter:null},this.#f.set(r,s)),!t||!e))return s.url;const a=this.#_(t);t=be.makeHexColor(...a);const l=this.#_(e);if(e=be.makeHexColor(...l),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return s.url;const u=new Array(256);for(let v=0;v<=255;v++){const x=v/255;u[v]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const f=u.join(","),d=`g_${this.#i}_hcm_filter`,p=s.filter=this.#p(d);this.#m(f,f,f,p),this.#a(p);const m=(v,x)=>{const _=a[v]/255,b=l[v]/255,E=new Array(x+1);for(let T=0;T<=x;T++)E[T]=_+T/x*(b-_);return E.join(",")};return this.#m(m(0,5),m(1,5),m(2,5),p),s.url=this.#u(d),s.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#h([t]),r=`alpha_${i}`;if(e=this.#o.get(r),e)return this.#o.set(t,e),e;const s=`g_${this.#i}_alpha_map_${this.#l++}`,a=this.#u(s);this.#o.set(t,a),this.#o.set(r,a);const l=this.#p(s);return this.#v(i,l),a}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,r;if(t?([i]=this.#h([t]),r=`luminosity_${i}`):r="luminosity",e=this.#o.get(r),e)return this.#o.set(t,e),e;const s=`g_${this.#i}_luminosity_map_${this.#l++}`,a=this.#u(s);this.#o.set(t,a),this.#o.set(r,a);const l=this.#p(s);return this.#d(l),t&&this.#v(i,l),a}addHighlightHCMFilter(t,e,i,r,s){const a=`${e}-${i}-${r}-${s}`;let l=this.#f.get(t);if(l?.key===a||(l?(l.filter?.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},this.#f.set(t,l)),!e||!i))return l.url;const[u,f]=[e,i].map(this.#_.bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[m,v]=[r,s].map(this.#_.bind(this));p<d&&([d,p,m,v]=[p,d,v,m]),this.#c.style.color="";const x=(E,T,S)=>{const O=new Array(256),R=(p-d)/S,N=E/255,C=(T-E)/(255*S);let M=0;for(let I=0;I<=S;I++){const F=Math.round(d+I*R),z=N+I*C;for(let P=M;P<=F;P++)O[P]=z;M=F+1}for(let I=M;I<256;I++)O[I]=O[M-1];return O.join(",")},_=`g_${this.#i}_hcm_${t}_filter`,b=l.filter=this.#p(_);return this.#a(b),this.#m(x(m[0],v[0],5),x(m[1],v[1],5),x(m[2],v[2],5),b),l.url=this.#u(_),l.url}destroy(t=!1){t&&this.#r?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#l=0)}#d(t){const e=this.#s.createElementNS(Co,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#a(t){const e=this.#s.createElementNS(Co,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#s.createElementNS(Co,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#g(t,e,i){const r=this.#s.createElementNS(Co,e);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)}#m(t,e,i,r){const s=this.#s.createElementNS(Co,"feComponentTransfer");r.append(s),this.#g(s,"feFuncR",t),this.#g(s,"feFuncG",e),this.#g(s,"feFuncB",i)}#v(t,e){const i=this.#s.createElementNS(Co,"feComponentTransfer");e.append(i),this.#g(i,"feFuncA",t)}#_(t){return this.#c.style.color=t,lb(getComputedStyle(this.#c).getPropertyValue("color"))}}class IC{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Tn("Abstract method `_fetch` called.")}}class HA extends IC{async _fetch(t){const e=await Sf(t,"arraybuffer");return new Uint8Array(e)}}class MC{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Tn("Abstract method `_fetch` called.")}}class $A extends MC{async _fetch(t){const e=await Sf(t,"arraybuffer");return new Uint8Array(e)}}br&&ze("Please use the `legacy` build in Node.js environments.");async function hb(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class hP extends LC{}class dP extends NC{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class pP extends kC{async _fetch(t){return hb(t)}}class mP extends IC{async _fetch(t){return hb(t)}}class gP extends MC{async _fetch(t){return hb(t)}}const Ui={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function cx(n,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,i),n.clip(r)}class db{isModifyingCurrentTransform(){return!1}getPattern(){Tn("Abstract method `getPattern` called.")}}class vP extends db{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,r){let s;if(r===Ui.STROKE||r===Ui.FILL){const a=e.current.getClippedPathBoundingBox(r,$n(t))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,u=Math.ceil(a[3]-a[1])||1,f=e.cachedCanvases.getCanvas("pattern",l,u),d=f.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),i=be.transform(i,[1,0,0,1,a[0],a[1]]),d.transform(...e.baseTransform),this.matrix&&d.transform(...this.matrix),cx(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),s=t.createPattern(f.canvas,"no-repeat");const p=new DOMMatrix(i);s.setTransform(p)}else cx(t,this._bbox),s=this._createGradient(t);return s}}function f_(n,t,e,i,r,s,a,l){const u=t.coords,f=t.colors,d=n.data,p=n.width*4;let m;u[e+1]>u[i+1]&&(m=e,e=i,i=m,m=s,s=a,a=m),u[i+1]>u[r+1]&&(m=i,i=r,r=m,m=a,a=l,l=m),u[e+1]>u[i+1]&&(m=e,e=i,i=m,m=s,s=a,a=m);const v=(u[e]+t.offsetX)*t.scaleX,x=(u[e+1]+t.offsetY)*t.scaleY,_=(u[i]+t.offsetX)*t.scaleX,b=(u[i+1]+t.offsetY)*t.scaleY,E=(u[r]+t.offsetX)*t.scaleX,T=(u[r+1]+t.offsetY)*t.scaleY;if(x>=T)return;const S=f[s],O=f[s+1],R=f[s+2],N=f[a],C=f[a+1],M=f[a+2],I=f[l],F=f[l+1],z=f[l+2],P=Math.round(x),tt=Math.round(T);let L,nt,Q,X,Rt,yt,j,J;for(let G=P;G<=tt;G++){if(G<b){const Gt=G<x?0:(x-G)/(x-b);L=v-(v-_)*Gt,nt=S-(S-N)*Gt,Q=O-(O-C)*Gt,X=R-(R-M)*Gt}else{let Gt;G>T?Gt=1:b===T?Gt=0:Gt=(b-G)/(b-T),L=_-(_-E)*Gt,nt=N-(N-I)*Gt,Q=C-(C-F)*Gt,X=M-(M-z)*Gt}let ut;G<x?ut=0:G>T?ut=1:ut=(x-G)/(x-T),Rt=v-(v-E)*ut,yt=S-(S-I)*ut,j=O-(O-F)*ut,J=R-(R-z)*ut;const gt=Math.round(Math.min(L,Rt)),_t=Math.round(Math.max(L,Rt));let Bt=p*G+gt*4;for(let Gt=gt;Gt<=_t;Gt++)ut=(L-Gt)/(L-Rt),ut<0?ut=0:ut>1&&(ut=1),d[Bt++]=nt-(nt-yt)*ut|0,d[Bt++]=Q-(Q-j)*ut|0,d[Bt++]=X-(X-J)*ut|0,d[Bt++]=255}}function _P(n,t,e){const i=t.coords,r=t.colors;let s,a;switch(t.type){case"lattice":const l=t.verticesPerRow,u=Math.floor(i.length/l)-1,f=l-1;for(s=0;s<u;s++){let d=s*l;for(let p=0;p<f;p++,d++)f_(n,e,i[d],i[d+1],i[d+l],r[d],r[d+1],r[d+l]),f_(n,e,i[d+l+1],i[d+1],i[d+l],r[d+l+1],r[d+1],r[d+l])}break;case"triangles":for(s=0,a=i.length;s<a;s+=3)f_(n,e,i[s],i[s+1],i[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class xP extends db{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const l=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-l,d=Math.ceil(this._bounds[3])-u,p=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),v=f/p,x=d/m,_={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-u,scaleX:1/v,scaleY:1/x},b=p+2*2,E=m+2*2,T=i.getCanvas("mesh",b,E),S=T.context,O=S.createImageData(p,m);if(e){const N=O.data;for(let C=0,M=N.length;C<M;C+=4)N[C]=e[0],N[C+1]=e[1],N[C+2]=e[2],N[C+3]=255}for(const N of this._figures)_P(O,N,_);return S.putImageData(O,2,2),{canvas:T.canvas,offsetX:l-2*v,offsetY:u-2*x,scaleX:v,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,r){cx(t,this._bbox);const s=new Float32Array(2);if(r===Ui.SHADING)be.singularValueDecompose2dScale($n(t),s);else if(this.matrix){be.singularValueDecompose2dScale(this.matrix,s);const[l,u]=s;be.singularValueDecompose2dScale(e.baseTransform,s),s[0]*=l,s[1]*=u}else be.singularValueDecompose2dScale(e.baseTransform,s);const a=this._createMeshCanvas(s,r===Ui.SHADING?null:this._background,e.cachedCanvases);return r!==Ui.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class bP extends db{getPattern(){return"hotpink"}}function yP(n){switch(n[0]){case"RadialAxial":return new vP(n);case"Mesh":return new xP(n);case"Dummy":return new bP}throw new Error(`Unknown IR type: ${n[0]}`)}const GA={COLORED:1,UNCOLORED:2};class pb{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(t){const{bbox:e,operatorList:i,paintType:r,tilingType:s,color:a,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:f}=this;u=Math.abs(u),f=Math.abs(f),Hg("TilingType: "+s);const d=e[0],p=e[1],m=e[2],v=e[3],x=m-d,_=v-p,b=new Float32Array(2);be.singularValueDecompose2dScale(this.matrix,b);const[E,T]=b;be.singularValueDecompose2dScale(this.baseTransform,b);const S=E*b[0],O=T*b[1];let R=x,N=_,C=!1,M=!1;const I=Math.ceil(u*S),F=Math.ceil(f*O),z=Math.ceil(x*S),P=Math.ceil(_*O);I>=z?R=u:C=!0,F>=P?N=f:M=!0;const tt=this.getSizeAndScale(R,this.ctx.canvas.width,S),L=this.getSizeAndScale(N,this.ctx.canvas.height,O),nt=t.cachedCanvases.getCanvas("pattern",tt.size,L.size),Q=nt.context,X=l.createCanvasGraphics(Q);if(X.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(X,r,a),Q.translate(-tt.scale*d,-L.scale*p),X.transform(tt.scale,0,0,L.scale,0,0),Q.save(),this.clipBbox(X,d,p,m,v),X.baseTransform=$n(X.ctx),X.executeOperatorList(i),X.endDrawing(),Q.restore(),C||M){const Rt=nt.canvas;C&&(R=u),M&&(N=f);const yt=this.getSizeAndScale(R,this.ctx.canvas.width,S),j=this.getSizeAndScale(N,this.ctx.canvas.height,O),J=yt.size,G=j.size,ut=t.cachedCanvases.getCanvas("pattern-workaround",J,G),gt=ut.context,_t=C?Math.floor(x/u):0,Bt=M?Math.floor(_/f):0;for(let Gt=0;Gt<=_t;Gt++)for(let H=0;H<=Bt;H++)gt.drawImage(Rt,J*Gt,G*H,J,G,0,0,J,G);return{canvas:ut.canvas,scaleX:yt.scale,scaleY:j.scale,offsetX:d,offsetY:p}}return{canvas:nt.canvas,scaleX:tt.scale,scaleY:L.scale,offsetX:d,offsetY:p}}getSizeAndScale(t,e,i){const r=Math.max(pb.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*i);return s>=r?s=r:i=s/t,{scale:i,size:s}}clipBbox(t,e,i,r,s){const a=r-e,l=s-i;t.ctx.rect(e,i,a,l),be.axialAlignedBoundingBox([e,i,r,s],$n(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const r=t.ctx,s=t.current;switch(e){case GA.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;r.fillStyle=s.fillColor=a,r.strokeStyle=s.strokeColor=l;break;case GA.UNCOLORED:r.fillStyle=r.strokeStyle=i,s.fillColor=s.strokeColor=i;break;default:throw new VM(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,r){let s=i;r!==Ui.SHADING&&(s=be.transform(s,e.baseTransform),this.matrix&&(s=be.transform(s,this.matrix)));const a=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const u=t.createPattern(a.canvas,"repeat");return u.setTransform(l),u}}function EP({src:n,srcPos:t=0,dest:e,width:i,height:r,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const l=Oi.isLittleEndian?4278190080:255,[u,f]=a?[s,l]:[l,s],d=i>>3,p=i&7,m=n.length;e=new Uint32Array(e.buffer);let v=0;for(let x=0;x<r;x++){for(const b=t+d;t<b;t++){const E=t<m?n[t]:255;e[v++]=E&128?f:u,e[v++]=E&64?f:u,e[v++]=E&32?f:u,e[v++]=E&16?f:u,e[v++]=E&8?f:u,e[v++]=E&4?f:u,e[v++]=E&2?f:u,e[v++]=E&1?f:u}if(p===0)continue;const _=t<m?n[t++]:255;for(let b=0;b<p;b++)e[v++]=_&1<<7-b?f:u}return{srcPos:t,destPos:v}}const VA=16,WA=100,wP=15,qA=10,$r=16,h_=new DOMMatrix,as=new Float32Array(2),qu=new Float32Array([1/0,1/0,-1/0,-1/0]);function AP(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},n.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},n.transform=function(e,i,r,s,a,l){t.transform(e,i,r,s,a,l),this.__originalTransform(e,i,r,s,a,l)},n.setTransform=function(e,i,r,s,a,l){t.setTransform(e,i,r,s,a,l),this.__originalSetTransform(e,i,r,s,a,l)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(e){t.rotate(e),this.__originalRotate(e)},n.clip=function(e){t.clip(e),this.__originalClip(e)},n.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},n.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},n.bezierCurveTo=function(e,i,r,s,a,l){t.bezierCurveTo(e,i,r,s,a,l),this.__originalBezierCurveTo(e,i,r,s,a,l)},n.rect=function(e,i,r,s){t.rect(e,i,r,s),this.__originalRect(e,i,r,s)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class SP{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,i)):(r=this.canvasFactory.create(e,i),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function om(n,t,e,i,r,s,a,l,u,f){const[d,p,m,v,x,_]=$n(n);if(p===0&&m===0){const T=a*d+x,S=Math.round(T),O=l*v+_,R=Math.round(O),N=(a+u)*d+x,C=Math.abs(Math.round(N)-S)||1,M=(l+f)*v+_,I=Math.abs(Math.round(M)-R)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(v),S,R),n.drawImage(t,e,i,r,s,0,0,C,I),n.setTransform(d,p,m,v,x,_),[C,I]}if(d===0&&v===0){const T=l*m+x,S=Math.round(T),O=a*p+_,R=Math.round(O),N=(l+f)*m+x,C=Math.abs(Math.round(N)-S)||1,M=(a+u)*p+_,I=Math.abs(Math.round(M)-R)||1;return n.setTransform(0,Math.sign(p),Math.sign(m),0,S,R),n.drawImage(t,e,i,r,s,0,0,I,C),n.setTransform(d,p,m,v,x,_),[I,C]}n.drawImage(t,e,i,r,s,a,l,u,f);const b=Math.hypot(d,p),E=Math.hypot(m,v);return[b*u,E*f]}class YA{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=ax;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Qi.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e){this.clipBox=new Float32Array([0,0,t,e]),this.minMax=qu.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ui.FILL,e=null){const i=this.minMax.slice();if(t===Ui.STROKE){e||Tn("Stroke bounding box must include transform."),be.singularValueDecompose2dScale(e,as);const r=as[0]*this.lineWidth/2,s=as[1]*this.lineWidth/2;i[0]-=r,i[1]-=s,i[2]+=r,i[3]+=s}return i}updateClipFromPath(){const t=be.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(qu,0)}getClippedPathBoundingBox(t=Ui.FILL,e=null){return be.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function XA(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,i=t.width,r=e%$r,s=(e-r)/$r,a=r===0?s:s+1,l=n.createImageData(i,$r);let u=0,f;const d=t.data,p=l.data;let m,v,x,_;if(t.kind===xd.GRAYSCALE_1BPP){const b=d.byteLength,E=new Uint32Array(p.buffer,0,p.byteLength>>2),T=E.length,S=i+7>>3,O=4294967295,R=Oi.isLittleEndian?4278190080:255;for(m=0;m<a;m++){for(x=m<s?$r:r,f=0,v=0;v<x;v++){const N=b-u;let C=0;const M=N>S?i:N*8-7,I=M&-8;let F=0,z=0;for(;C<I;C+=8)z=d[u++],E[f++]=z&128?O:R,E[f++]=z&64?O:R,E[f++]=z&32?O:R,E[f++]=z&16?O:R,E[f++]=z&8?O:R,E[f++]=z&4?O:R,E[f++]=z&2?O:R,E[f++]=z&1?O:R;for(;C<M;C++)F===0&&(z=d[u++],F=128),E[f++]=z&F?O:R,F>>=1}for(;f<T;)E[f++]=0;n.putImageData(l,0,m*$r)}}else if(t.kind===xd.RGBA_32BPP){for(v=0,_=i*$r*4,m=0;m<s;m++)p.set(d.subarray(u,u+_)),u+=_,n.putImageData(l,0,v),v+=$r;m<a&&(_=i*r*4,p.set(d.subarray(u,u+_)),n.putImageData(l,0,v))}else if(t.kind===xd.RGB_24BPP)for(x=$r,_=i*x,m=0;m<a;m++){for(m>=s&&(x=r,_=i*x),f=0,v=_;v--;)p[f++]=d[u++],p[f++]=d[u++],p[f++]=d[u++],p[f++]=255;n.putImageData(l,0,m*$r)}else throw new Error(`bad image kind: ${t.kind}`)}function KA(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,r=e%$r,s=(e-r)/$r,a=r===0?s:s+1,l=n.createImageData(i,$r);let u=0;const f=t.data,d=l.data;for(let p=0;p<a;p++){const m=p<s?$r:r;({srcPos:u}=EP({src:f,srcPos:u,dest:d,width:i,height:m,nonBlackColor:0})),n.putImageData(l,0,p*$r)}}function id(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)n[i]!==void 0&&(t[i]=n[i]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function lm(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}function ZA(n,t){if(t)return!0;be.singularValueDecompose2dScale(n,as);const e=Math.fround(ca.pixelRatio*Rc.PDF_TO_CSS_UNITS);return as[0]<=e&&as[1]<=e}const TP=["butt","round","square"],CP=["miter","round","bevel"],DP={},QA={};class Xu{constructor(t,e,i,r,s,{optionalContentConfig:a,markedContentStack:l=null},u,f){this.ctx=t,this.current=new YA(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=r,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new SP(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:r=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=l,i){const u=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...$n(this.compositeCtx))}this.ctx.save(),lm(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=$n(this.ctx)}executeOperatorList(t,e,i,r){const s=t.argsArray,a=t.fnArray;let l=e||0;const u=s.length;if(u===l)return l;const f=u-l>qA&&typeof i=="function",d=f?Date.now()+wP:0;let p=0;const m=this.commonObjs,v=this.objs;let x;for(;;){if(r!==void 0&&l===r.nextBreakPoint)return r.breakIt(l,i),l;if(x=a[l],x!==Rd.dependency)this[x].apply(this,s[l]);else for(const _ of s[l]){const b=_.startsWith("g_")?m:v;if(!b.has(_))return b.get(_,i),l}if(l++,l===u)return l;if(f&&++p>qA){if(Date.now()>d)return i(),l;p=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,r=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),l=i,u=r,f="prescale1",d,p;for(;s>2&&l>1||a>2&&u>1;){let m=l,v=u;s>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/m),a>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,a/=u/v),d=this.cachedCanvases.getCanvas(f,m,v),p=d.context,p.clearRect(0,0,m,v),p.drawImage(t,0,0,l,u,0,0,m,v),t=d.canvas,l=m,u=v,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:u}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:r}=t,s=this.current.fillColor,a=this.current.patternFill,l=$n(e);let u,f,d,p;if((t.bitmap||t.data)&&t.count>1){const I=t.bitmap||t.data.buffer;f=JSON.stringify(a?l:[l.slice(0,4),s]),u=this._cachedBitmapsMap.get(I),u||(u=new Map,this._cachedBitmapsMap.set(I,u));const F=u.get(f);if(F&&!a){const z=Math.round(Math.min(l[0],l[2])+l[4]),P=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:F,offsetX:z,offsetY:P}}d=F}d||(p=this.cachedCanvases.getCanvas("maskCanvas",i,r),KA(p.context,t));let m=be.transform(l,[1/i,0,0,-1/r,0,0]);m=be.transform(m,[1,0,0,1,0,-r]);const v=qu.slice();be.axialAlignedBoundingBox([0,0,i,r],m,v);const[x,_,b,E]=v,T=Math.round(b-x)||1,S=Math.round(E-_)||1,O=this.cachedCanvases.getCanvas("fillCanvas",T,S),R=O.context,N=x,C=_;R.translate(-N,-C),R.transform(...m),d||(d=this._scaleImage(p.canvas,ka(R)),d=d.img,u&&a&&u.set(f,d)),R.imageSmoothingEnabled=ZA($n(R),t.interpolate),om(R,d,0,0,d.width,d.height,0,0,i,r),R.globalCompositeOperation="source-in";const M=be.transform(ka(R),[1,0,0,1,-N,-C]);return R.fillStyle=a?s.getPattern(e,this,M,Ui.FILL):s,R.fillRect(0,0,i,r),u&&!a&&(this.cachedCanvases.delete("fillCanvas"),u.set(f,O.canvas)),{canvas:O.canvas,offsetX:Math.round(N),offsetY:Math.round(C)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=TP[t]}setLineJoin(t){this.ctx.lineJoin=CP[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,e);this.suspendedCtx=this.ctx;const s=this.ctx=r.context;s.setTransform(this.suspendedCtx.getTransform()),id(this.suspendedCtx,s),AP(s,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),id(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,r){const s=r[0],a=r[1],l=r[2]-s,u=r[3]-a;l===0||u===0||(this.genericComposeSMask(e.context,i,l,u,e.subtype,e.backdrop,e.transferMap,s,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,r,s,a,l,u,f,d,p){let m=t.canvas,v=u-d,x=f-p;if(a)if(v<0||x<0||v+i>m.width||x+r>m.height){const b=this.cachedCanvases.getCanvas("maskExtension",i,r),E=b.context;E.drawImage(m,-v,-x),E.globalCompositeOperation="destination-atop",E.fillStyle=a,E.fillRect(0,0,i,r),E.globalCompositeOperation="source-over",m=b.canvas,v=x=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(v,x,i,r),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(v,x,i,r),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const _=new Path2D;_.rect(u,f,i,r),e.clip(_),e.globalCompositeOperation="destination-in",e.drawImage(m,v,x,i,r,u,f,i,r),e.restore()}save(){this.inSMaskMode&&id(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&id(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,r,s,a){this.ctx.transform(t,e,i,r,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){let[r]=e;if(!i){r||=e[0]=new Path2D,this[t](r);return}if(!(r instanceof Path2D)){const s=e[0]=new Path2D;for(let a=0,l=r.length;a<l;)switch(r[a++]){case rm.moveTo:s.moveTo(r[a++],r[a++]);break;case rm.lineTo:s.lineTo(r[a++],r[a++]);break;case rm.curveTo:s.bezierCurveTo(r[a++],r[a++],r[a++],r[a++],r[a++],r[a++]);break;case rm.closePath:s.closePath();break;default:ze(`Unrecognized drawing path operator: ${r[a-1]}`);break}r=s}be.axialAlignedBoundingBox(i,$n(this.ctx),this.current.minMax),this[t](r)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&r?.getPattern){const s=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,ka(i),Ui.STROKE),s){const a=new Path2D;a.addPath(t,i.getTransform().invertSelf().multiplySelf(s)),t=a}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(Ui.STROKE,$n(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const i=this.ctx,r=this.current.fillColor,s=this.current.patternFill;let a=!1;if(s){const u=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.fillStyle=r.getPattern(i,this,ka(i),Ui.FILL),u){const f=new Path2D;f.addPath(t,i.getTransform().invertSelf().multiplySelf(u)),t=f}a=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),a&&i.restore(),e&&this.consumePath(t,l)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=DP}eoClip(){this.pendingClip=QA}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0)return;const i=new Path2D,r=e.getTransform().invertSelf();for(const{transform:s,x:a,y:l,fontSize:u,path:f}of t)i.addPath(f,new DOMMatrix(s).preMultiplySelf(r).translate(a,l).scale(u,-u));e.clip(i),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=i.fontMatrix||ax,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&ze("Invalid font matrix for font "+t),e<0?(e=-e,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const s=i.loadedName||"sans-serif",a=i.systemFontInfo?.css||`"${s}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const u=i.italic?"italic":"normal";let f=e;e<VA?f=VA:e>WA&&(f=WA),this.current.fontSizeScale=e/f,this.ctx.font=`${u} ${l} ${f}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(t,e,i){const r=new Path2D;return r.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),r}paintChar(t,e,i,r,s){const a=this.ctx,l=this.current,u=l.font,f=l.textRenderingMode,d=l.fontSize/l.fontSizeScale,p=f&Qi.FILL_STROKE_MASK,m=!!(f&Qi.ADD_TO_PATH_FLAG),v=l.patternFill&&!u.missingFile,x=l.patternStroke&&!u.missingFile;let _;if((u.disableFontFace||m||v||x)&&(_=u.getPathGenerator(this.commonObjs,t)),u.disableFontFace||v||x){a.save(),a.translate(e,i),a.scale(d,-d);let b;if((p===Qi.FILL||p===Qi.FILL_STROKE)&&(r?(b=a.getTransform(),a.setTransform(...r),a.fill(this.#n(_,b,r))):a.fill(_)),p===Qi.STROKE||p===Qi.FILL_STROKE)if(s){b||=a.getTransform(),a.setTransform(...s);const{a:E,b:T,c:S,d:O}=b,R=be.inverseTransform(s),N=be.transform([E,T,S,O,0,0],R);be.singularValueDecompose2dScale(N,as),a.lineWidth*=Math.max(as[0],as[1])/d,a.stroke(this.#n(_,b,s))}else a.lineWidth/=d,a.stroke(_);a.restore()}else(p===Qi.FILL||p===Qi.FILL_STROKE)&&a.fillText(t,e,i),(p===Qi.STROKE||p===Qi.FILL_STROKE)&&a.strokeText(t,e,i);m&&(this.pendingTextPaths||=[]).push({transform:$n(a),x:e,y:i,fontSize:d,path:_})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){i=!0;break}return Xe(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const r=e.fontSize;if(r===0)return;const s=this.ctx,a=e.fontSizeScale,l=e.charSpacing,u=e.wordSpacing,f=e.fontDirection,d=e.textHScale*f,p=t.length,m=i.vertical,v=m?1:-1,x=i.defaultVMetrics,_=r*e.fontMatrix[0],b=e.textRenderingMode===Qi.FILL&&!i.disableFontFace&&!e.patternFill;s.save(),e.textMatrix&&s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),f>0?s.scale(d,-1):s.scale(d,1);let E,T;if(e.patternFill){s.save();const C=e.fillColor.getPattern(s,this,ka(s),Ui.FILL);E=$n(s),s.restore(),s.fillStyle=C}if(e.patternStroke){s.save();const C=e.strokeColor.getPattern(s,this,ka(s),Ui.STROKE);T=$n(s),s.restore(),s.strokeStyle=C}let S=e.lineWidth;const O=e.textMatrixScale;if(O===0||S===0){const C=e.textRenderingMode&Qi.FILL_STROKE_MASK;(C===Qi.STROKE||C===Qi.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=O;if(a!==1&&(s.scale(a,a),S/=a),s.lineWidth=S,i.isInvalidPDFjsFont){const C=[];let M=0;for(const I of t)C.push(I.unicode),M+=I.width;s.fillText(C.join(""),0,0),e.x+=M*_*d,s.restore(),this.compose();return}let R=0,N;for(N=0;N<p;++N){const C=t[N];if(typeof C=="number"){R+=v*C*r/1e3;continue}let M=!1;const I=(C.isSpace?u:0)+l,F=C.fontChar,z=C.accent;let P,tt,L=C.width;if(m){const Q=C.vmetric||x,X=-(C.vmetric?Q[1]:L*.5)*_,Rt=Q[2]*_;L=Q?-Q[0]:L,P=X/a,tt=(R+Rt)/a}else P=R/a,tt=0;if(i.remeasure&&L>0){const Q=s.measureText(F).width*1e3/r*a;if(L<Q&&this.isFontSubpixelAAEnabled){const X=L/Q;M=!0,s.save(),s.scale(X,1),P/=X}else L!==Q&&(P+=(L-Q)/2e3*r/a)}if(this.contentVisible&&(C.isInFont||i.missingFile)){if(b&&!z)s.fillText(F,P,tt);else if(this.paintChar(F,P,tt,E,T),z){const Q=P+r*z.offset.x/a,X=tt-r*z.offset.y/a;this.paintChar(z.fontChar,Q,X,E,T)}}const nt=m?L*_-I*f:L*_+I*f;R+=nt,M&&s.restore()}m?e.y-=R:e.x+=R*d,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,r=i.font,s=i.fontSize,a=i.fontDirection,l=r.vertical?1:-1,u=i.charSpacing,f=i.wordSpacing,d=i.textHScale*a,p=i.fontMatrix||ax,m=t.length,v=i.textRenderingMode===Qi.INVISIBLE;let x,_,b,E;if(!(v||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),i.textMatrix&&e.transform(...i.textMatrix),e.translate(i.x,i.y+i.textRise),e.scale(d,a),x=0;x<m;++x){if(_=t[x],typeof _=="number"){E=l*_*s/1e3,this.ctx.translate(E,0),i.x+=E*d;continue}const T=(_.isSpace?f:0)+u,S=r.charProcOperatorList[_.operatorListId];S?this.contentVisible&&(this.save(),e.scale(s,s),e.transform(...p),this.executeOperatorList(S),this.restore()):ze(`Type3 character "${_.operatorListId}" is not available.`);const O=[_.width,0];be.applyTransform(O,p),b=O[0]*s+T,e.translate(b,0),i.x+=b*d}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,r,s,a){const l=new Path2D;l.rect(i,r,s-i,a-r),this.ctx.clip(l),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const i=this.baseTransform||$n(this.ctx),r={createCanvasGraphics:s=>new Xu(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new pb(t,this.ctx,r,i)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=yP(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,ka(e),Ui.SHADING);const r=ka(e);if(r){const{width:s,height:a}=e.canvas,l=qu.slice();be.axialAlignedBoundingBox([0,0,s,a],r,l);const[u,f,d,p]=l;this.ctx.fillRect(u,f,d-u,p-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Tn("Should not call beginInlineImage")}beginImageData(){Tn("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=$n(this.ctx),e)){be.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[i,r,s,a]=e,l=new Path2D;l.rect(i,r,s-i,a-r),this.ctx.clip(l),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Hg("TODO: Support non-isolated groups."),t.knockout&&ze("Knockout groups not supported.");const i=$n(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=qu.slice();be.axialAlignedBoundingBox(t.bbox,$n(e),r);const s=[0,0,e.canvas.width,e.canvas.height];r=be.intersect(r,s)||[0,0,0,0];const a=Math.floor(r[0]),l=Math.floor(r[1]),u=Math.max(Math.ceil(r[2])-a,1),f=Math.max(Math.ceil(r[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,f]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(d,u,f),m=p.context;m.translate(-a,-l),m.transform(...i);let v=new Path2D;const[x,_,b,E]=t.bbox;if(v.rect(x,_,b-x,E-_),t.matrix){const T=new Path2D;T.addPath(v,new DOMMatrix(t.matrix)),v=T}m.clip(v),t.smask?this.smaskStack.push({canvas:p.canvas,context:m,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,l),e.save()),id(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=$n(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const s=qu.slice();be.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],r,s),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,i,r,s){if(this.#t(),lm(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){i=i.slice(),i[4]-=e[0],i[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=l,be.singularValueDecompose2dScale($n(this.ctx),as);const{viewportScale:u}=this,f=Math.ceil(a*this.outputScaleX*u),d=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(f,d);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(as[0],0,0,-as[1],0,l*as[1]),lm(this.ctx)}else{lm(this.ctx),this.endPath();const u=new Path2D;u.rect(e[0],e[1],a,l),this.ctx.clip(u)}}this.current=new YA(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const i=this.ctx,r=this._createMaskCanvas(t),s=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(s,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,r=0,s,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const u=$n(l);l.transform(e,i,r,s,0,0);const f=this._createMaskCanvas(t);l.setTransform(1,0,0,1,f.offsetX-u[4],f.offsetY-u[5]);for(let d=0,p=a.length;d<p;d+=2){const m=be.transform(u,[e,i,r,s,a[d],a[d+1]]);l.drawImage(f.canvas,m[4],m[5])}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,r=this.current.patternFill;for(const s of t){const{data:a,width:l,height:u,transform:f}=s,d=this.cachedCanvases.getCanvas("maskCanvas",l,u),p=d.context;p.save();const m=this.getObject(a,s);KA(p,m),p.globalCompositeOperation="source-in",p.fillStyle=r?i.getPattern(p,this,ka(e),Ui.FILL):i,p.fillRect(0,0,l,u),p.restore(),e.save(),e.transform(...f),e.scale(1,-1),om(e,d.canvas,0,0,l,u,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){ze("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,i,r){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){ze("Dependent image isn't ready yet");return}const a=s.width,l=s.height,u=[];for(let f=0,d=r.length;f<d;f+=2)u.push({transform:[e,0,0,i,r[f],r[f+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(s,u)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:r}=t,s=this.cachedCanvases.getCanvas("inlineImage",i,r),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,r=this.ctx;this.save();const{filter:s}=r;s!=="none"&&s!==""&&(r.filter="none"),r.scale(1/e,-1/i);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",e,i).context;XA(f,t),a=this.applyTransferMapsToCanvas(f)}const l=this._scaleImage(a,ka(r));r.imageSmoothingEnabled=ZA($n(r),t.interpolate),om(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const s=t.width,a=t.height,u=this.cachedCanvases.getCanvas("inlineImage",s,a).context;XA(u,t),r=this.applyTransferMapsToCanvas(u)}for(const s of e)i.save(),i.transform(...s.transform),i.scale(1,-1),om(i,r,s.x,s.y,s.w,s.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const r=this.ctx;this.pendingClip&&(i||(this.pendingClip===QA?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=$n(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:r,d:s}=this.ctx.getTransform();let a,l;if(i===0&&r===0){const u=Math.abs(e),f=Math.abs(s);if(u===f)if(t===0)a=l=1/u;else{const d=u*t;a=l=d<1?1/d:1}else if(t===0)a=1/u,l=1/f;else{const d=u*t,p=f*t;a=d<1?1/d:1,l=p<1?1/p:1}}else{const u=Math.abs(e*s-i*r),f=Math.hypot(e,i),d=Math.hypot(r,s);if(t===0)a=d/u,l=f/u;else{const p=t*u;a=d>p?d/p:1,l=f>p?f/p:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:r}}=this,[s,a]=this.getScaleForStroking();if(s===a){i.lineWidth=(r||1)*s,i.stroke(t);return}const l=i.getLineDash();e&&i.save(),i.scale(s,a),h_.a=1/s,h_.d=1/a;const u=new Path2D;if(u.addPath(t,h_),l.length>0){const f=Math.max(s,a);i.setLineDash(l.map(d=>d/f)),i.lineDashOffset/=f}i.lineWidth=r||1,i.stroke(u),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const n in Rd)Xu.prototype[n]!==void 0&&(Xu.prototype[Rd[n]]=Xu.prototype[n]);class Sl{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class OP{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Gu=Symbol("INTERNAL");class RP{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:i,usage:r,rbGroups:s}){this.#t=!!(t&is.DISPLAY),this.#e=!!(t&is.PRINT),this.name=e,this.intent=i,this.usage=r,this.rbGroups=s}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==Gu&&Tn("Internal method `_setVisible` called."),this.#n=i,this.#i=e}}class NP{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=is.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const i of t.groups)this.#e.set(i.id,new RP(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(Gu,!1);for(const i of t.on)this.#e.get(i)._setVisible(Gu,!0);for(const i of t.off)this.#e.get(i)._setVisible(Gu,!1);this.#n=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let r=1;r<e;r++){const s=t[r];let a;if(Array.isArray(s))a=this.#s(s);else if(this.#e.has(s))a=this.#e.get(s).visible;else return ze(`Optional content group not found: ${s}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Hg("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ze(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ze(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ze(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ze(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ze(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ze(`Unknown optional content policy ${t.policy}.`),!0}return ze(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const r=this.#e.get(t);if(!r){ze(`Optional content group not found: ${t}`);return}if(i&&e&&r.rbGroups.length)for(const s of r.rbGroups)for(const a of s)a!==t&&this.#e.get(a)?._setVisible(Gu,!1,!0);r._setVisible(Gu,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const s=this.#e.get(r);if(s)switch(i){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!s.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new DC;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class kP{constructor(t,{disableRange:e=!1,disableStream:i=!1}){ui(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:s,progressiveDone:a,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,s?.length>0){const u=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((u,f)=>{this._onReceiveData({begin:u,chunk:f})}),t.addProgressListener((u,f)=>{this._onProgress({loaded:u,total:f})}),t.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(i),!0)});ui(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){ui(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new LP(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new IP(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class LP{constructor(t,e,i=!1,r=null){this._stream=t,this._done=i||!1,this._filename=Gg(r)?r:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class IP{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function MP(n){let t=!0,e=i("filename\\*","i").exec(n);if(e){e=e[1];let d=l(e);return d=unescape(d),d=u(d),d=f(d),s(d)}if(e=a(n),e){const d=f(e);return s(d)}if(e=i("filename","i").exec(n),e){e=e[1];let d=l(e);return d=f(d),s(d)}function i(d,p){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function r(d,p){if(d){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(d,{fatal:!0}),v=rp(p);p=m.decode(v),t=!1}catch{}}return p}function s(d){return t&&/[\x80-\xff]/.test(d)&&(d=r("utf-8",d),t&&(d=r("iso-8859-1",d))),d}function a(d){const p=[];let m;const v=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(d))!==null;){let[,_,b,E]=m;if(_=parseInt(_,10),_ in p){if(_===0)break;continue}p[_]=[b,E]}const x=[];for(let _=0;_<p.length&&_ in p;++_){let[b,E]=p[_];E=l(E),b&&(E=unescape(E),_===0&&(E=u(E))),x.push(E)}return x.join("")}function l(d){if(d.startsWith('"')){const p=d.slice(1).split('\\"');for(let m=0;m<p.length;++m){const v=p[m].indexOf('"');v!==-1&&(p[m]=p[m].slice(0,v),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}d=p.join('"')}return d}function u(d){const p=d.indexOf("'");if(p===-1)return d;const m=d.slice(0,p),x=d.slice(p+1).replace(/^[^']*'/,"");return r(m,x)}function f(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,v,x){if(v==="q"||v==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,b){return String.fromCharCode(parseInt(b,16))}),r(m,x);try{x=atob(x)}catch{}return r(m,x)})}return""}function PC(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const i in t){const r=t[i];r!==void 0&&e.append(i,r)}return e}function Vg(n){return URL.parse(n)?.origin??null}function FC({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(r.suggestedLength=s,s<=2*e)||i||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function BC(n){const t=n.get("Content-Disposition");if(t){let e=MP(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Gg(e))return e}return null}function cp(n,t){return new Nd(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n,n===404||n===0&&t.startsWith("file:"))}function UC(n){return n===200||n===206}function zC(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function jC(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ze(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class PP{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=PC(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ui(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new FP(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new BP(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class FP{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),r=e.url;fetch(r,zC(i,this._withCredentials,this._abortController)).then(s=>{if(t._responseOrigin=Vg(s.url),!UC(s.status))throw cp(s.status,r);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:l,suggestedLength:u}=FC({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=u||this._contentLength,this._filename=BC(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Bo("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:jC(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class BP{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${i-1}`);const a=r.url;fetch(a,zC(s,this._withCredentials,this._abortController)).then(l=>{const u=Vg(l.url);if(u!==t._responseOrigin)throw new Error(`Expected range response-origin "${u}" to match "${t._responseOrigin}".`);if(!UC(l.status))throw cp(l.status,a);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:jC(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const d_=200,p_=206;function UP(n){const t=n.response;return typeof t!="string"?t:rp(t).buffer}class zP{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=PC(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,a]of this.headers)e.setRequestHeader(s,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=p_):r.expectedStatus=d_,e.responseType="arraybuffer",ui(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){i.onError(r.status);return}const s=r.status||d_;if(!(s===d_&&i.expectedStatus===p_)&&s!==i.expectedStatus){i.onError(r.status);return}const l=UP(r);if(s===p_){const u=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);f?i.onDone({begin:parseInt(f[1],10),chunk:l}):(ze('Missing or invalid "Content-Range" header.'),i.onError(0))}else l?i.onDone({begin:0,chunk:l}):i.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class jP{constructor(t){this._source=t,this._manager=new zP(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return ui(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new HP(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new $P(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class HP{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Vg(e.responseURL);const i=e.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[u,...f]=l.split(": ");return[u,f.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=FC({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=BC(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=cp(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class $P{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Vg(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=cp(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const GP=/^[a-z][a-z0-9\-+.]+:/i;function VP(n){if(GP.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class WP{constructor(t){this.source=t,this.url=VP(t.url),ui(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ui(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new qP(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new YP(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class qP{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=cp(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Bo("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class YP{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const rd=Symbol("INITIAL_DATA");class HC{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:rd}}get(t,e=null){if(e){const r=this.#e(t);return r.promise.then(()=>e(r.data)),null}const i=this.#t[t];if(!i||i.data===rd)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==rd}delete(t){const e=this.#t[t];return!e||e.data===rd?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==rd&&(yield[t,e])}}}const XP=1e5,JA=30;let kd=class Ns{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#l=0;#o=0;#f=null;#c=null;#h=0;#u=0;#d=Object.create(null);#a=[];#p=null;#g=[];#m=new WeakMap;#v=null;static#_=new Map;static#x=new Map;static#y=new WeakMap;static#w=null;static#S=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(u){u.enqueue(t),u.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=i.scale*ca.pixelRatio,this.#h=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:s,pageX:a,pageY:l}=i.rawDims;this.#v=[1,0,0,-1,-a,l+s],this.#o=r,this.#l=s,Ns.#N(),Nl(e,i),this.#t.promise.finally(()=>{Ns.#S.delete(this),this.#r=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Oi.platform;return Xe(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#f.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#d,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#f=this.#p.getReader(),Ns.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*ca.pixelRatio,r=t.rotation;if(r!==this.#h&&(e?.(),this.#h=r,Nl(this.#c,{rotation:r})),i!==this.#u){e?.(),this.#u=i;const s={div:null,properties:null,ctx:Ns.#D(this.#s)};for(const a of this.#g)s.properties=this.#m.get(a),s.div=a,this.#E(s)}}cancel(){const t=new Bo("TextLayer task cancelled.");this.#f?.cancel(t).catch(()=>{}),this.#f=null,this.#t.reject(t)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#a}#C(t){if(this.#n)return;this.#r.ctx??=Ns.#D(this.#s);const e=this.#g,i=this.#a;for(const r of t){if(e.length>XP){ze("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const s=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id!==null&&this.#e.setAttribute("id",`${r.id}`),s.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(r.str),this.#O(r)}}#O(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#g.push(e);const r=be.transform(this.#v,t.transform);let s=Math.atan2(r[1],r[0]);const a=this.#d[t.fontName];a.vertical&&(s+=Math.PI/2);let l=this.#i&&a.fontSubstitution||a.fontFamily;l=Ns.fontFamilyMap.get(l)||l;const u=Math.hypot(r[2],r[3]),f=u*Ns.#k(l,a,this.#s);let d,p;s===0?(d=r[4],p=r[5]-f):(d=r[4]+f*Math.sin(s),p=r[5]-f*Math.cos(s));const m="calc(var(--total-scale-factor) *",v=e.style;this.#e===this.#c?(v.left=`${(100*d/this.#o).toFixed(2)}%`,v.top=`${(100*p/this.#l).toFixed(2)}%`):(v.left=`${m}${d.toFixed(2)}px)`,v.top=`${m}${p.toFixed(2)}px)`),v.fontSize=`${m}${(Ns.#w*u).toFixed(2)}px)`,v.fontFamily=l,i.fontSize=u,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),s!==0&&(i.angle=s*(180/Math.PI));let x=!1;if(t.str.length>1)x=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),b=Math.abs(t.transform[3]);_!==b&&Math.max(_,b)/Math.min(_,b)>1.5&&(x=!0)}if(x&&(i.canvasWidth=a.vertical?t.height:t.width),this.#m.set(e,i),this.#r.div=e,this.#r.properties=i,this.#E(this.#r),i.hasText&&this.#e.append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#E(t){const{div:e,properties:i,ctx:r}=t,{style:s}=e;let a="";if(Ns.#w>1&&(a=`scale(${1/Ns.#w})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=s,{canvasWidth:u,fontSize:f}=i;Ns.#T(r,f*this.#u,l);const{width:d}=r.measureText(e.textContent);d>0&&(a=`scaleX(${u*this.#u/d}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(s.transform=a)}static cleanup(){if(!(this.#S.size>0)){this.#_.clear();for(const{canvas:t}of this.#x.values())t.remove();this.#x.clear()}}static#D(t=null){let e=this.#x.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#x.set(t,e),this.#y.set(e,{size:0,family:""})}return e}static#T(t,e,i){const r=this.#y.get(t);e===r.size&&i===r.family||(t.font=`${e}px ${i}`,r.size=e,r.family=i)}static#N(){if(this.#w!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#w=t.getBoundingClientRect().height,t.remove()}static#k(t,e,i){const r=this.#_.get(t);if(r)return r;const s=this.#D(i);s.canvas.width=s.canvas.height=JA,this.#T(s,JA,t);const a=s.measureText(""),l=a.fontBoundingBoxAscent,u=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let f=.8;return l?f=l/(l+u):(Oi.platform.isFirefox&&ze("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#_.set(t,f),f}};class Ld{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function r(s){if(!s)return;let a=null;const l=s.name;if(l==="#text")a=s.value;else if(Ld.shouldBuildText(l))s?.attributes?.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&e.push({str:a}),!!s.children)for(const u of s.children)r(u)}return r(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const KP=100;function mb(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new gb,{docId:e}=t,i=n.url?aP(n.url):null,r=n.data?oP(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,l=n.password??null,u=n.range instanceof vb?n.range:null,f=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof df?n.worker:null;const p=n.verbosity,m=typeof n.docBaseUrl=="string"&&!ap(n.docBaseUrl)?n.docBaseUrl:null,v=sm(n.cMapUrl),x=n.cMapPacked!==!1,_=n.CMapReaderFactory||(br?pP:jA),b=sm(n.iccUrl),E=sm(n.standardFontDataUrl),T=n.StandardFontDataFactory||(br?mP:HA),S=sm(n.wasmUrl),O=n.WasmFactory||(br?gP:$A),R=n.stopAtErrors!==!0,N=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,C=n.isEvalSupported!==!1,M=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!br,I=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!br&&(Oi.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,z=typeof n.disableFontFace=="boolean"?n.disableFontFace:br,P=n.fontExtraProperties===!0,tt=n.enableXfa===!0,L=n.ownerDocument||globalThis.document,nt=n.disableRange===!0,Q=n.disableStream===!0,X=n.disableAutoFetch===!0,Rt=n.pdfBug===!0,yt=n.CanvasFactory||(br?dP:uP),j=n.FilterFactory||(br?hP:fP),J=n.enableHWA===!0,G=n.useWasm!==!1,ut=u?u.length:n.length??NaN,gt=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!br&&!z,_t=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(_===jA&&T===HA&&O===$A&&v&&E&&S&&dd(v,document.baseURI)&&dd(E,document.baseURI)&&dd(S,document.baseURI)),Bt=null;HM(p);const Gt={canvasFactory:new yt({ownerDocument:L,enableHWA:J}),filterFactory:new j({docId:e,ownerDocument:L}),cMapReaderFactory:_t?null:new _({baseUrl:v,isCompressed:x}),standardFontDataFactory:_t?null:new T({baseUrl:E}),wasmFactory:_t?null:new O({baseUrl:S})};d||(d=df.create({verbosity:p,port:Sl.workerPort}),t._worker=d);const H={docId:e,apiVersion:"5.3.31",data:r,password:l,disableAutoFetch:X,rangeChunkSize:f,length:ut,docBaseUrl:m,enableXfa:tt,evaluatorOptions:{maxImageSize:N,disableFontFace:z,ignoreErrors:R,isEvalSupported:C,isOffscreenCanvasSupported:M,isImageDecoderSupported:I,canvasMaxAreaInBytes:F,fontExtraProperties:P,useSystemFonts:gt,useWasm:G,useWorkerFetch:_t,cMapUrl:v,iccUrl:b,standardFontDataUrl:E,wasmUrl:S}},mt={ownerDocument:L,pdfBug:Rt,styleElement:Bt,loadingParams:{disableAutoFetch:X,enableXfa:tt}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const lt=d.messageHandler.sendWithPromise("GetDocRequest",H,r?[r.buffer]:null);let ct;if(u)ct=new kP(u,{disableRange:nt,disableStream:Q});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Ct=dd(i)?PP:br?WP:jP;ct=new Ct({url:i,length:ut,httpHeaders:s,withCredentials:a,rangeChunkSize:f,disableRange:nt,disableStream:Q})}return lt.then(Ct=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Lt=new pd(e,Ct,d.port),D=new JP(Lt,t,ct,mt,Gt);t._transport=D,Lt.send("Ready",null)})}).catch(t._capability.reject),t}class gb{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${gb.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let vb=class{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#s=[];constructor(t,e,i=!1,r=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=r}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#s)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#i)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Tn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class ZP{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Xe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class QP{#t=!1;constructor(t,e,i,r=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=r?new BA:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new HC,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:s=!1}={}){return new sp({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:r,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Xe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:r=Ha.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:f=null,printAnnotationStorage:d=null,isEditing:p=!1}){this._stats?.time("Overall");const m=this._transport.getRenderingIntent(i,r,d,p),{renderingIntent:v,cacheKey:x}=m;this.#t=!1,l||=this._transport.getOptionalContentConfig(v);let _=this._intentStates.get(x);_||(_=Object.create(null),this._intentStates.set(x,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const b=!!(v&is.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(m));const E=O=>{_.renderTasks.delete(T),b&&(this.#t=!0),this.#e(),O?(T.capability.reject(O),this._abortOperatorList({intentState:_,reason:O instanceof Error?O:new Error(O)})):T.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},T=new Yu({callback:E,params:{canvasContext:t,viewport:e,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!b,pdfBug:this._pdfBug,pageColors:f});(_.renderTasks||=new Set).add(T);const S=T.task;return Promise.all([_.displayReadyCapability.promise,l]).then(([O,R])=>{if(this.destroyed){E();return}if(this._stats?.time("Rendering"),!(R.renderingIntent&v))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");T.initializeGraphics({transparency:O,optionalContentConfig:R}),T.operatorListChanged()}).catch(E),S}getOperatorList({intent:t="display",annotationMode:e=Ha.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function s(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(u))}const a=this._transport.getRenderingIntent(t,e,i,r,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let u;return l.opListReadCapability||(u=Object.create(null),u.operatorListChanged=s,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||=new Set).add(u),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Ld.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,r){function s(){a.read().then(function({value:u,done:f}){if(f){i(l);return}l.lang??=u.lang,Object.assign(l.styles,u.styles),l.items.push(...u.items),s()},r)}const a=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new BA),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,r=t.length;i<r;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:r}){const{map:s,transfer:a}=i,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:r},a).getReader(),f=this._intentStates.get(e);f.streamReader=u;const d=()=>{u.read().then(({value:p,done:m})=>{if(m){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,f),d())},p=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const m of f.renderTasks)m.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(p);else if(f.opListReadCapability)f.opListReadCapability.reject(p);else throw p}})};d()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof $g){let r=KP;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new Bo(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,s]of this._intentStates)if(s===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var wl,ra,Oo,Ec,Ng,wc,Ac,Sr,Gm,$C,GC,md,af,Vm;const Fn=class Fn{constructor({name:t=null,port:e=null,verbosity:i=$M()}={}){Ra(this,Sr);Ra(this,wl,Promise.withResolvers());Ra(this,ra,null);Ra(this,Oo,null);Ra(this,Ec,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Pn(Fn,Ac).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Pn(Fn,Ac).set(e,this),Na(this,Sr,$C).call(this,e)}else Na(this,Sr,GC).call(this)}get promise(){return Pn(this,wl).promise}get port(){return Pn(this,Oo)}get messageHandler(){return Pn(this,ra)}destroy(){this.destroyed=!0,Pn(this,Ec)?.terminate(),zr(this,Ec,null),Pn(Fn,Ac).delete(Pn(this,Oo)),zr(this,Oo,null),Pn(this,ra)?.destroy(),zr(this,ra,null)}static create(t){const e=Pn(this,Ac).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Fn(t)}static get workerSrc(){if(Sl.workerSrc)return Sl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Xe(this,"_setupFakeWorkerGlobal",(async()=>Pn(this,af,Vm)?Pn(this,af,Vm):(await import(this.workerSrc)).WorkerMessageHandler)())}};wl=new WeakMap,ra=new WeakMap,Oo=new WeakMap,Ec=new WeakMap,Ng=new WeakMap,wc=new WeakMap,Ac=new WeakMap,Sr=new WeakSet,Gm=function(){Pn(this,wl).resolve(),Pn(this,ra).send("configure",{verbosity:this.verbosity})},$C=function(t){zr(this,Oo,t),zr(this,ra,new pd("main","worker",t)),Pn(this,ra).on("ready",()=>{}),Na(this,Sr,Gm).call(this)},GC=function(){if(Pn(Fn,wc)||Pn(Fn,af,Vm)){Na(this,Sr,md).call(this);return}let{workerSrc:t}=Fn;try{Fn._isSameOrigin(window.location,t)||(t=Fn._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new pd("main","worker",e),r=()=>{s.abort(),i.destroy(),e.terminate(),this.destroyed?Pn(this,wl).reject(new Error("Worker was destroyed")):Na(this,Sr,md).call(this)},s=new AbortController;e.addEventListener("error",()=>{Pn(this,Ec)||r()},{signal:s.signal}),i.on("test",l=>{if(s.abort(),this.destroyed||!l){r();return}zr(this,ra,i),zr(this,Oo,e),zr(this,Ec,e),Na(this,Sr,Gm).call(this)}),i.on("ready",l=>{if(s.abort(),this.destroyed){r();return}try{a()}catch{Na(this,Sr,md).call(this)}});const a=()=>{const l=new Uint8Array;i.send("test",l,[l.buffer])};a();return}catch{Hg("The worker has been disabled.")}Na(this,Sr,md).call(this)},md=function(){Pn(Fn,wc)||(ze("Setting up fake worker."),zr(Fn,wc,!0)),Fn._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Pn(this,wl).reject(new Error("Worker was destroyed"));return}const e=new cP;zr(this,Oo,e);const i=`fake${Nw(Fn,Ng)._++}`,r=new pd(i+"_worker",i,e);t.setup(r,e),zr(this,ra,new pd(i,i+"_worker",e)),Na(this,Sr,Gm).call(this)}).catch(t=>{Pn(this,wl).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},af=new WeakSet,Vm=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ra(Fn,af),Ra(Fn,Ng,0),Ra(Fn,wc,!1),Ra(Fn,Ac,new WeakMap),br&&(zr(Fn,wc,!0),Sl.workerSrc||="./pdf.worker.mjs"),Fn._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const r=new URL(e,i);return i.origin===r.origin},Fn._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Fn.fromPort=t=>{if(QM("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Fn.create(t)};let df=Fn;class JP{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#s=null;constructor(t,e,i,r,s){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new HC,this.fontLoader=new rP({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#r(t,e=null){const i=this.#t.get(t);if(i)return i;const r=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,r),r}get annotationStorage(){return Xe(this,"annotationStorage",new fb)}getRenderingIntent(t,e=Ha.ENABLE,i=null,r=!1,s=!1){let a=is.DISPLAY,l=ox;switch(t){case"any":a=is.ANY;break;case"display":break;case"print":a=is.PRINT;break;default:ze(`getRenderingIntent - invalid intent: ${t}`)}const u=a&is.PRINT&&i instanceof OC?i:this.annotationStorage;switch(e){case Ha.DISABLE:a+=is.ANNOTATIONS_DISABLE;break;case Ha.ENABLE:break;case Ha.ENABLE_FORMS:a+=is.ANNOTATIONS_FORMS;break;case Ha.ENABLE_STORAGE:a+=is.ANNOTATIONS_STORAGE,l=u.serializable;break;default:ze(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(a+=is.IS_EDITING),s&&(a+=is.OPLIST);const{ids:f,hash:d}=u.modifiedIds,p=[a,l.hash,d];return{renderingIntent:a,cacheKey:p.join("_"),annotationStorageSerializable:l,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),kd.cleanup(),this._networkStream?.cancelAllRequests(new Bo("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,r)=>{ui(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},r.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){r.close();return}ui(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{this._fullReader.cancel(s),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:s,contentLength:a}=this._fullReader;return(!r||!s)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=l=>{e.onProgress?.({loaded:l.loaded,total:l.total})}),{isStreamingSupported:r,isRangeSupported:s,contentLength:a}}),t.on("GetRangeReader",(i,r)=>{ui(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(i.begin,i.end);if(!s){r.close();return}r.onPull=()=>{s.read().then(function({value:a,done:l}){if(l){r.close();return}ui(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{s.cancel(a),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new ZP(i,this))}),t.on("DocException",i=>{e._capability.reject(jr(i))}),t.on("PasswordRequest",i=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw jr(i);const r=s=>{s instanceof Error?this.#s.reject(s):this.#s.resolve({password:s})};e.onPassword(r,i.code)}catch(r){this.#s.reject(r)}return this.#s.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,r,s])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":if("error"in s){const f=s.error;ze(`Error during font loading: ${f}`),this.commonObjs.resolve(i,f);break}const a=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,d)=>globalThis.FontInspector.fontAdded(f,d):null,l=new sP(s,a);this.fontLoader.bind(l).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(i,l)});break;case"CopyLocalImage":const{imageRef:u}=s;ui(u,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,d]of f.objs)if(d?.ref===u)return d.dataLen?(this.commonObjs.resolve(i,structuredClone(d)),d.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,s);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([i,r,s,a])=>{if(this.destroyed)return;const l=this.#e.get(r);if(!l.objs.has(i)){if(l._intentStates.size===0){a?.bitmap?.close();return}switch(s){case"Image":case"Pattern":l.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[i.type];if(!r)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ze("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#n.get(e);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#i.set(s.refStr,t);const a=new QP(e,s,this,this._params.pdfBug);return this.#e.set(e,a),a});return this.#n.set(e,r),r}getPageIndex(t){return lx(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#r("GetOptionalContentConfig").then(e=>new NP(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new OP(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),kd.cleanup()}}cachedPageNumber(t){if(!lx(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class tF{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Yu{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:r,annotationCanvasMap:s,operatorList:a,pageIndex:l,canvasFactory:u,filterFactory:f,useRequestAnimationFrame:d=!1,pdfBug:p=!1,pageColors:m=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=u,this.filterFactory=f,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new tF(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Yu.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Yu.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:r,transform:s,background:a}=this.params;this.gfx=new Xu(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:r,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Yu.#e.delete(this._canvas),t||=new $g(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Yu.#e.delete(this._canvas),this.callback())))}}const VC="5.3.31",WC="47ad820d9";function t2(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function sd(n){return Math.max(0,Math.min(255,255*n))}class e2{static CMYK_G([t,e,i,r]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=sd(t),[t,t,t]}static G_HTML([t]){const e=t2(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(sd)}static RGB_HTML(t){return`#${t.map(t2).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,i+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,i,r]){return[sd(1-Math.min(1,t+r)),sd(1-Math.min(1,i+r)),sd(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const r=1-t,s=1-e,a=1-i,l=Math.min(r,s,a);return["CMYK",r,s,a,l]}}class eF{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Tn("Abstract method `_createSVG` called.")}}class Id extends eF{_createSVG(t){return document.createElementNS(Co,t)}}class _b{static setupStorage(t,e,i,r,s){const a=r.getValue(e,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),s==="print")break;t.addEventListener("input",l=>{r.setValue(e,{value:l.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{r.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),s==="print")break;t.addEventListener("input",l=>{r.setValue(e,{value:l.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const l of i.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const u=l.target.options,f=u.selectedIndex===-1?"":u[u.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:r,linkService:s}){const{attributes:a}=e,l=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${r}`);for(const[u,f]of Object.entries(a))if(f!=null)switch(u){case"class":f.length&&t.setAttribute(u,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!l||u!=="href"&&u!=="newWindow")&&t.setAttribute(u,f)}l&&s.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,r=t.xfaHtml,s=t.intent||"display",a=document.createElement(r.name);r.attributes&&this.setAttributes({html:a,element:r,intent:s,linkService:i});const l=s!=="richText",u=t.div;if(u.append(a),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;u.style.transform=p}l&&u.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const p=document.createTextNode(r.value);a.append(p),l&&Ld.shouldBuildText(r.name)&&f.push(p)}return{textDivs:f}}const d=[[r,-1,a]];for(;d.length>0;){const[p,m,v]=d.at(-1);if(m+1===p.children.length){d.pop();continue}const x=p.children[++d.at(-1)[1]];if(x===null)continue;const{name:_}=x;if(_==="#text"){const E=document.createTextNode(x.value);f.push(E),v.append(E);continue}const b=x?.attributes?.xmlns?document.createElementNS(x.attributes.xmlns,_):document.createElement(_);if(v.append(b),x.attributes&&this.setAttributes({html:b,element:x,storage:e,intent:s,linkService:i}),x.children?.length>0)d.push([x,-1,b]);else if(x.value){const E=document.createTextNode(x.value);l&&Ld.shouldBuildText(_)&&f.push(E),b.append(E)}}for(const p of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const up=1e3,nF=9,Nc=new WeakSet;class n2{static create(t){switch(t.data.annotationType){case Jn.LINK:return new qC(t);case Jn.TEXT:return new iF(t);case Jn.WIDGET:switch(t.data.fieldType){case"Tx":return new rF(t);case"Btn":return t.data.radioButton?new YC(t):t.data.checkBox?new aF(t):new oF(t);case"Ch":return new lF(t);case"Sig":return new sF(t)}return new Gc(t);case Jn.POPUP:return new ux(t);case Jn.FREETEXT:return new XC(t);case Jn.LINE:return new uF(t);case Jn.SQUARE:return new fF(t);case Jn.CIRCLE:return new hF(t);case Jn.POLYLINE:return new KC(t);case Jn.CARET:return new pF(t);case Jn.INK:return new xb(t);case Jn.POLYGON:return new dF(t);case Jn.HIGHLIGHT:return new ZC(t);case Jn.UNDERLINE:return new mF(t);case Jn.SQUIGGLY:return new gF(t);case Jn.STRIKEOUT:return new vF(t);case Jn.STAMP:return new QC(t);case Jn.FILEATTACHMENT:return new _F(t);default:return new ni(t)}}}class ni{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t?.str||e?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ni._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#i(e),this.#n?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:l,pageY:u}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(a-t[3]+u)/a}%`,r===0?(e.width=`${100*(t[2]-t[0])/s}%`,e.height=`${100*(t[3]-t[1])/a}%`):this.setRotation(r)}_createContainer(t){const{data:e,parent:{page:i,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof Gc||(s.tabIndex=up);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof ux){const{rotation:_}=e;return!e.hasOwnCanvas&&_!==0&&this.setRotation(_,s),s}const{width:l,height:u}=this;if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const _=e.borderStyle.horizontalCornerRadius,b=e.borderStyle.verticalCornerRadius;if(_>0||b>0){const T=`calc(${_}px * var(--total-scale-factor)) / calc(${b}px * var(--total-scale-factor))`;a.borderRadius=T}else if(this instanceof YC){const T=`calc(${l}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;a.borderRadius=T}switch(e.borderStyle.style){case $u.SOLID:a.borderStyle="solid";break;case $u.DASHED:a.borderStyle="dashed";break;case $u.BEVELED:ze("Unimplemented border style: beveled");break;case $u.INSET:ze("Unimplemented border style: inset");break;case $u.UNDERLINE:a.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,a.borderColor=be.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):a.borderWidth=0}const f=be.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:d,pageHeight:p,pageX:m,pageY:v}=r.rawDims;a.left=`${100*(f[0]-m)/d}%`,a.top=`${100*(f[1]-v)/p}%`;const{rotation:x}=e;return e.hasOwnCanvas||x===0?(a.width=`${100*l/d}%`,a.height=`${100*u/p}%`):this.setRotation(x,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims;let{width:s,height:a}=this;t%180!==0&&([s,a]=[a,s]),e.style.width=`${100*s/i}%`,e.style.height=`${100*a/r}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,r)=>{const s=r.detail[e],a=s[0],l=s.slice(1);r.target.style[i]=e2[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[i]:e2[`${a}_rgb`](l)})};return Xe(this,"_commonActions",{display:e=>{const{display:i}=e.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const r of Object.keys(e.detail))(t[r]||i[r])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[r,s]of Object.entries(e)){const a=i[r];if(a){const l={detail:{[r]:s},target:t};a(l),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,r,s]=this.data.rect.map(_=>Math.fround(_));if(t.length===8){const[_,b,E,T]=t.subarray(2,6);if(r===_&&s===b&&e===E&&i===T)return}const{style:a}=this.container;let l;if(this.#e){const{borderColor:_,borderWidth:b}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const u=r-e,f=s-i,{svgFactory:d}=this,p=d.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0);const m=d.createElement("defs");p.append(m);const v=d.createElement("clipPath"),x=`clippath_${this.data.id}`;v.setAttribute("id",x),v.setAttribute("clipPathUnits","objectBoundingBox"),m.append(v);for(let _=2,b=t.length;_<b;_+=8){const E=t[_],T=t[_+1],S=t[_+2],O=t[_+3],R=d.createElement("rect"),N=(S-e)/u,C=(s-T)/f,M=(E-S)/u,I=(T-O)/f;R.setAttribute("x",N),R.setAttribute("y",C),R.setAttribute("width",M),R.setAttribute("height",I),v.append(R),l?.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${C}" width="${M}" height="${I}"/>`)}this.#e&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(p),this.container.style.clipPath=`url(#${x})`}_createPopup(){const{data:t}=this,e=this.#n=new ux({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){Tn("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:s,id:a,exportValues:l}of r){if(s===-1||a===e)continue;const u=typeof l=="string"?l:null,f=document.querySelector(`[data-element-id="${a}"]`);if(f&&!Nc.has(f)){ze(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:u,domElement:f})}return i}for(const r of document.getElementsByName(t)){const{exportValue:s}=r,a=r.getAttribute("data-element-id");a!==e&&Nc.has(r)&&i.push({id:a,exportValue:s,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class qC extends ni{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(this.#e(i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(this.#n(i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#t()}#e(t,e,i=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,i),!1),this.#t()}#n(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(e.actions)){const s=i.get(r);s&&(t[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:r}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ze('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:r,refs:s,include:a}=e,l=[];if(r.length!==0||s.length!==0){const d=new Set(s);for(const p of r){const m=this._fieldObjects[p]||[];for(const{id:v}of m)d.add(v)}for(const p of Object.values(this._fieldObjects))for(const m of p)d.has(m.id)===a&&l.push(m)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const u=this.annotationStorage,f=[];for(const d of l){const{id:p}=d;switch(f.push(p),d.type){case"text":{const v=d.defaultValue||"";u.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=d.defaultValue===d.exportValues;u.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=d.defaultValue||"";u.setValue(p,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!Nc.has(m)){ze(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class iF extends ni{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Gc extends ni{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Oi.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,r,s){i.includes("mouse")?t.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{if(i==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a)}})})}_setEventListeners(t,e,i,r){for(const[s,a]of i)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,s,a,r),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":be.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||nF,s=t.style;let a;const l=2,u=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-l),d=Math.round(f/(o_*r))||1,p=f/d;a=Math.min(r,u(p/o_))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(r,u(f/o_))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=be.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class rF extends Gc{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,r){const s=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),s.setValue(a.id,{[r]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=t.getValue(e,{value:this.data.fieldValue});let s=r.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&s.length>a&&(s=s.slice(0,a));let l=r.formattedValue||this.data.textContent?.join(`
`)||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const u={userValue:s,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=l??s,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",l??s),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Nc.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=up,this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",d=>{t.setValue(e,{value:d.target.value}),this.setPropertyOnSiblings(i,"value",d.target.value,"value"),u.formattedValue=null}),i.addEventListener("resetform",d=>{const p=this.data.defaultFieldValue??"";i.value=u.userValue=p,u.formattedValue=null});let f=d=>{const{formattedValue:p}=u;p!=null&&(d.target.value=p),d.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",p=>{if(u.focused)return;const{target:m}=p;u.userValue&&(m.value=u.userValue),u.lastCommittedValue=m.value,u.commitKey=1,this.data.actions?.Focus||(u.focused=!0)}),i.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const m={value(v){u.userValue=v.detail.value??"",t.setValue(e,{value:u.userValue.toString()}),v.target.value=u.userValue},formattedValue(v){const{formattedValue:x}=v.detail;u.formattedValue=x,x!=null&&v.target!==document.activeElement&&(v.target.value=x),t.setValue(e,{formattedValue:x})},selRange(v){v.target.setSelectionRange(...v.detail.selRange)},charLimit:v=>{const{charLimit:x}=v.detail,{target:_}=v;if(x===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",x);let b=u.userValue;!b||b.length<=x||(b=b.slice(0,x),_.value=u.userValue=b,t.setValue(e,{value:b}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(m,p)}),i.addEventListener("keydown",p=>{u.commitKey=1;let m=-1;if(p.key==="Escape"?m=0:p.key==="Enter"&&!this.data.multiLine?m=2:p.key==="Tab"&&(u.commitKey=3),m===-1)return;const{value:v}=p.target;u.lastCommittedValue!==v&&(u.lastCommittedValue=v,u.userValue=v,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:v,willCommit:!0,commitKey:m,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const d=f;f=null,i.addEventListener("blur",p=>{if(!u.focused||!p.relatedTarget)return;this.data.actions?.Blur||(u.focused=!1);const{value:m}=p.target;u.userValue=m,u.lastCommittedValue!==m&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:u.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}),d(p)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",p=>{u.lastCommittedValue=null;const{data:m,target:v}=p,{value:x,selectionStart:_,selectionEnd:b}=v;let E=_,T=b;switch(p.inputType){case"deleteWordBackward":{const S=x.substring(0,_).match(/\w*[^\w]*$/);S&&(E-=S[0].length);break}case"deleteWordForward":{const S=x.substring(_).match(/^[^\w]*\w*/);S&&(T+=S[0].length);break}case"deleteContentBackward":_===b&&(E-=1);break;case"deleteContentForward":_===b&&(T+=1);break}p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,change:m||"",willCommit:!1,selStart:E,selEnd:T}})}),this._setEventListeners(i,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(f&&i.addEventListener("blur",f),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class sF extends Gc{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class aF extends Gc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let r=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Nc.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,r&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=up,s.addEventListener("change",a=>{const{name:l,checked:u}=a.target;for(const f of this._getElementsByName(l,i)){const d=u&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=d),t.setValue(f.id,{value:d})}t.setValue(i,{value:u})}),s.addEventListener("resetform",a=>{const l=e.defaultFieldValue||"Off";a.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const l={value(u){u.target.checked=u.detail.value!=="Off",t.setValue(i,{value:u.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class YC extends Gc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let r=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(i,{value:r})),r)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const s=document.createElement("input");if(Nc.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,r&&s.setAttribute("checked",!0),s.tabIndex=up,s.addEventListener("change",a=>{const{name:l,checked:u}=a.target;for(const f of this._getElementsByName(l,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:u})}),s.addEventListener("resetform",a=>{const l=e.defaultFieldValue;a.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const u={value:f=>{const d=a===f.detail.value;for(const p of this._getElementsByName(f.target.name)){const m=d&&p.id===i;p.domElement&&(p.domElement.checked=m),t.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class oF extends qC{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class lF extends Gc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");Nc.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=up;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",d=>{const p=this.data.defaultFieldValue;for(const m of r.options)m.selected=m.value===p});for(const d of this.data.options){const p=document.createElement("option");p.textContent=d.displayValue,p.value=d.exportValue,i.value.includes(d.exportValue)&&(p.setAttribute("selected",!0),s=!1),r.append(p)}let a=null;if(s){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),r.prepend(d),a=()=>{d.remove(),r.removeEventListener("input",a),a=null},r.addEventListener("input",a)}const l=d=>{const p=d?"value":"textContent",{options:m,multiple:v}=r;return v?Array.prototype.filter.call(m,x=>x.selected).map(x=>x[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let u=l(!1);const f=d=>{const p=d.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",d=>{const p={value(m){a?.();const v=m.detail.value,x=new Set(Array.isArray(v)?v:[v]);for(const _ of r.options)_.selected=x.has(_.value);t.setValue(e,{value:l(!0)}),u=l(!1)},multipleSelection(m){r.multiple=!0},remove(m){const v=r.options,x=m.detail.remove;v[x].selected=!1,r.remove(x),v.length>0&&Array.prototype.findIndex.call(v,b=>b.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},clear(m){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),u=l(!1)},insert(m){const{index:v,displayValue:x,exportValue:_}=m.detail.insert,b=r.children[v],E=document.createElement("option");E.textContent=x,E.value=_,b?b.before(E):r.append(E),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},items(m){const{items:v}=m.detail;for(;r.length!==0;)r.remove(0);for(const x of v){const{displayValue:_,exportValue:b}=x,E=document.createElement("option");E.textContent=_,E.value=b,r.append(E)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},indices(m){const v=new Set(m.detail.indices);for(const x of m.target.options)x.selected=v.has(x.index);t.setValue(e,{value:l(!0)}),u=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,d)}),r.addEventListener("input",d=>{const p=l(!0),m=l(!1);t.setValue(e,{value:p}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:u,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):r.addEventListener("input",function(d){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class ux extends ni{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:ni._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new cF({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${ab}${i}`).join(",")),this.container}}class cF{#t=this.#C.bind(this);#e=this.#T.bind(this);#n=this.#D.bind(this);#i=this.#E.bind(this);#s=null;#r=null;#l=null;#o=null;#f=null;#c=null;#h=null;#u=!1;#d=null;#a=null;#p=null;#g=null;#m=null;#v=null;#_=!1;constructor({container:t,color:e,elements:i,titleObj:r,modificationDate:s,contentsObj:a,richText:l,parent:u,rect:f,parentRect:d,open:p}){this.#r=t,this.#m=r,this.#l=a,this.#g=l,this.#c=u,this.#s=e,this.#p=f,this.#h=d,this.#f=i,this.#o=ob.toDateObject(s),this.trigger=i.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",this.#i),m.addEventListener("mouseenter",this.#n),m.addEventListener("mouseleave",this.#e),m.classList.add("popupTriggerArea");for(const m of i)m.container?.addEventListener("keydown",this.#t);this.#r.hidden=!0,p&&this.#E()}render(){if(this.#d)return;const t=this.#d=document.createElement("div");if(t.className="popup",this.#s){const s=t.style.outlineColor=be.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),{dir:i.dir,str:i.textContent}=this.#m,t.append(e),this.#o){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),e.append(s)}const r=this.#x;if(r)_b.render({xfaHtml:r,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#l);t.append(s)}this.#r.append(t)}get#x(){const t=this.#g,e=this.#l;return t?.str&&(!e?.str||e.str===t.str)&&this.#g.html||null}get#y(){return this.#x?.attributes?.style?.fontSize||0}get#w(){return this.#x?.attributes?.style?.color||null}#S(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:this.#w,fontSize:this.#y?`calc(${this.#y}px * var(--total-scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:r});return i}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const r=t.split(/(?:\r\n?|\n)/);for(let s=0,a=r.length;s<a;++s){const l=r[s];i.append(document.createTextNode(l)),s<a-1&&i.append(document.createElement("br"))}return i}#C(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#u)&&this.#E()}updateEdited({rect:t,popupContent:e}){this.#v||={contentsObj:this.#l,richText:this.#g},t&&(this.#a=null),e&&(this.#g=this.#S(e),this.#l=null),this.#d?.remove(),this.#d=null}resetEdited(){this.#v&&({contentsObj:this.#l,richText:this.#g}=this.#v,this.#v=null,this.#d?.remove(),this.#d=null,this.#a=null)}#O(){if(this.#a!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:r,pageY:s}}}=this.#c;let a=!!this.#h,l=a?this.#h:this.#p;for(const x of this.#f)if(!l||be.intersect(x.data.rect,l)!==null){l=x.data.rect,a=!0;break}const u=be.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),d=a?l[2]-l[0]+5:0,p=u[0]+d,m=u[1];this.#a=[100*(p-r)/e,100*(m-s)/i];const{style:v}=this.#r;v.left=`${this.#a[0]}%`,v.top=`${this.#a[1]}%`}#E(){this.#u=!this.#u,this.#u?(this.#D(),this.#r.addEventListener("click",this.#i),this.#r.addEventListener("keydown",this.#t)):(this.#T(),this.#r.removeEventListener("click",this.#i),this.#r.removeEventListener("keydown",this.#t))}#D(){this.#d||this.render(),this.isVisible?this.#u&&this.#r.classList.add("focused"):(this.#O(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#T(){this.#r.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#r.hidden=!0)}maybeShow(){this.#_&&(this.#d||this.#D(),this.#_=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class XC extends ni{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Be.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class uF extends ni{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),s=this.#t=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),r.append(s),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class fF extends ni{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",s/2),a.setAttribute("y",s/2),a.setAttribute("width",e-s),a.setAttribute("height",i-s),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class hF extends ni{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",e/2),a.setAttribute("cy",i/2),a.setAttribute("rx",e/2-s/2),a.setAttribute("ry",i/2-s/2),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class KC extends ni{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:r},width:s,height:a}=this;if(!e)return this.container;const l=this.svgFactory.create(s,a,!0);let u=[];for(let d=0,p=e.length;d<p;d+=2){const m=e[d]-t[0],v=t[3]-e[d+1];u.push(`${m},${v}`)}u=u.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",u),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),l.append(f),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class dF extends KC{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class pF extends ni{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class xb extends ni{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Be.HIGHLIGHT:Be.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:r,popupRef:s}}=this,{transform:a,width:l,height:u}=this.#n(e,t),f=this.svgFactory.create(l,u,!0),d=this.#t=this.svgFactory.createElement("svg:g");f.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",a);for(let p=0,m=i.length;p<m;p++){const v=this.svgFactory.createElement(this.svgElementName);this.#e.push(v),v.setAttribute("points",i[p].join(",")),d.append(v)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:r}=t,s=this.#t;if(e>=0&&s.setAttribute("stroke-width",e||1),i)for(let a=0,l=this.#e.length;a<l;a++)this.#e[a].setAttribute("points",i[a].join(","));if(r){const{transform:a,width:l,height:u}=this.#n(this.data.rotation,r);s.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),s.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ZC extends ni{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Be.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class mF extends ni{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class gF extends ni{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class vF extends ni{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class QC extends ni{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Be.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class _F extends ni{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:r}=Oi.platform;return t.addEventListener("keydown",s=>{s.key==="Enter"&&(r?s.metaKey:s.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let bb=class JC{#t=null;#e=null;#n=new Map;#i=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:r,page:s,viewport:a,structTreeLayer:l}){this.div=t,this.#t=e,this.#e=i,this.#i=l||null,this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#n.size>0}async#s(t,e){const i=t.firstChild||t,r=i.id=`${ab}${e}`,s=await this.#i?.getAriaAttributes(r);if(s)for(const[a,l]of s)i.setAttribute(a,l);this.div.append(t),this.#t?.moveElementInDOM(this.div,t,i,!1)}async render(t){const{annotations:e}=t,i=this.div;Nl(i,this.viewport);const r=new Map,s={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Id,annotationStorage:t.annotationStorage||new fb,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const l=a.annotationType===Jn.POPUP;if(l){const d=r.get(a.id);if(!d)continue;s.elements=d}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;s.data=a;const u=n2.create(s);if(!u.isRenderable)continue;if(!l&&a.popupRef){const d=r.get(a.popupRef);d?d.push(u):r.set(a.popupRef,[u])}const f=u.render();a.hidden&&(f.style.visibility="hidden"),await this.#s(f,a.id),u._isEditable&&(this.#n.set(u.data.id,u),this._annotationEditorUIManager?.renderAnnotationElement(u))}this.#r()}async addLinkAnnotations(t,e){const i={data:null,layer:this.div,linkService:e,svgFactory:new Id,parent:this};for(const r of t){r.borderStyle||=JC._defaultBorderStyle,i.data=r;const s=n2.create(i);if(!s.isRenderable)continue;const a=s.render();await this.#s(a,r.id)}}update({viewport:t}){const e=this.div;this.viewport=t,Nl(e,{rotation:t.rotation}),this.#r(),e.hidden=!1}#r(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const r=t.querySelector(`[data-annotation-id="${e}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:s}=r;s?s.nodeName==="CANVAS"?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):r.append(i);const a=this.#n.get(e);a&&(a._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,r.id,i),a._hasNoCanvas=!1):a.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}static get _defaultBorderStyle(){return Xe(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:$u.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const cm=/\r\n?|\n/g;class yi extends Se{#t;#e="";#n=`${this.id}-editor`;#i=null;#s;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=yi.prototype,e=s=>s.isEmpty(),i=Uo.TRANSLATE_SMALL,r=Uo.TRANSLATE_BIG;return Xe(this,"_keyboardManager",new op([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}]]))}static _type="freetext";static _editorType=Be.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||yi._defaultColor||Se._defaultLineColor,this.#s=t.fontSize||yi._defaultFontSize}static initialize(t,e){Se.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Ke.FREETEXT_SIZE:yi._defaultFontSize=e;break;case Ke.FREETEXT_COLOR:yi._defaultColor=e;break}}updateParams(t,e){switch(t){case Ke.FREETEXT_SIZE:this.#r(e);break;case Ke.FREETEXT_COLOR:this.#l(e);break}}static get defaultPropertiesToUpdate(){return[[Ke.FREETEXT_SIZE,yi._defaultFontSize],[Ke.FREETEXT_COLOR,yi._defaultColor||Se._defaultLineColor]]}get propertiesToUpdate(){return[[Ke.FREETEXT_SIZE,this.#s],[Ke.FREETEXT_COLOR,this.#t]]}#r(t){const e=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#s)*this.parentScale),this.#s=r,this.#f()},i=this.#s;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(t){const e=r=>{this.#t=this.editorDiv.style.color=r},i=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-yi._internalPadding*t,-(yi._internalPadding+this.#s)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(yi.#c(i)),e=i);return t.join(`
`)}#f(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:s}=this,a=s.style.display,l=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",r.div.append(this.div),i=s.getBoundingClientRect(),s.remove(),s.style.display=a,s.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const i=r=>{if(this.#e=r,!r){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#f()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#f()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){yi._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,i.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,s]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[f,d]=this.pageDimensions,[p,m]=this.pageTranslation;let v,x;switch(this.rotation){case 0:v=t+(a[0]-p)/f,x=e+this.height-(a[1]-m)/d;break;case 90:v=t+(a[0]-p)/f,x=e-(a[1]-m)/d,[l,u]=[u,-l];break;case 180:v=t-this.width+(a[0]-p)/f,x=e-(a[1]-m)/d,[l,u]=[-l,-u];break;case 270:v=t+(a[0]-p-this.height*d)/f,x=e+(a[1]-m-this.width*f)/d,[l,u]=[-u,l];break}this.setAt(v*r,x*s,l,u)}else this._moveAfterPaste(t,e);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(cm,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=yi.#d(e.getData("text")||"").replaceAll(cm,`
`);if(!r)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const a=s.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:l,startOffset:u}=a,f=[],d=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(d.push(l.nodeValue.slice(u).replaceAll(cm,"")),v!==this.editorDiv){let x=f;for(const _ of this.editorDiv.childNodes){if(_===v){x=d;continue}x.push(yi.#c(_))}}f.push(l.nodeValue.slice(0,u).replaceAll(cm,""))}else if(l===this.editorDiv){let v=f,x=0;for(const _ of this.editorDiv.childNodes)x++===u&&(v=d),v.push(yi.#c(_))}this.#e=`${f.join(`
`)}${r}${d.join(`
`)}`,this.#h();const p=new Range;let m=Math.sumPrecise(f.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const x=v.nodeValue.length;if(m<=x){p.setStart(v,m),p.setEnd(v,m);break}m-=x}s.removeAllRanges(),s.addRange(p)}#h(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(" "," ")}static#d(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,i){let r=null;if(t instanceof XC){const{data:{defaultAppearanceData:{fontSize:a,fontColor:l},rect:u,rotation:f,id:d,popupRef:p},textContent:m,textPosition:v,parent:{page:{pageNumber:x}}}=t;if(!m||m.length===0)return null;r=t={annotationType:Be.FREETEXT,color:Array.from(l),fontSize:a,value:m.join(`
`),position:v,pageIndex:x-1,rect:u.slice(0),rotation:f,id:d,deleted:!1,popupRef:p}}const s=await super.deserialize(t,e,i);return s.#s=t.fontSize,s.#t=be.makeHexColor(...t.color),s.#e=yi.#d(t.value),s.annotationElementId=t.id||null,s._initialData=r,s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=yi._internalPadding*this.parentScale,i=this.getRect(e,e),r=Se._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),s={annotationType:Be.FREETEXT,color:r,fontSize:this.#s,value:this.#u(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(s.isCopy=!0,s):this.annotationElementId&&!this.#a(s)?null:(s.id=this.annotationElementId,s)}#a(t){const{value:e,fontSize:i,color:r,pageIndex:s}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((a,l)=>a!==r[l])||t.pageIndex!==s}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:i}=e;i.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,i.color=this.#t,e.replaceChildren();for(const s of this.#e.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),e.append(a)}const r=yi._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:this.#e}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class de{static PRECISION=1e-4;toSVGPath(){Tn("Abstract method `toSVGPath` must be implemented.")}get box(){Tn("Abstract getter `box` must be implemented.")}serialize(t,e){Tn("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,r,s,a){a||=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l+=2)a[l]=e+t[l]*r,a[l+1]=i+t[l+1]*s;return a}static _rescaleAndSwap(t,e,i,r,s,a){a||=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l+=2)a[l]=e+t[l+1]*r,a[l+1]=i+t[l]*s;return a}static _translate(t,e,i,r){r||=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s+=2)r[s]=e+t[s],r[s+1]=i+t[s+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,r,s){switch(s){case 90:return[1-e/i,t/r];case 180:return[1-t/i,1-e/r];case 270:return[e/i,1-t/r];default:return[t/i,e/r]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,r,s,a){return[(t+5*i)/6,(e+5*r)/6,(5*i+s)/6,(5*r+a)/6,(i+s)/2,(r+a)/2]}}class yc{#t;#e=[];#n;#i;#s=[];#r=new Float32Array(18);#l;#o;#f;#c;#h;#u;#d=[];static#a=8;static#p=2;static#g=yc.#a+yc.#p;constructor({x:t,y:e},i,r,s,a,l=0){this.#t=i,this.#u=s*r,this.#i=a,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=l,this.#c=yc.#a*r,this.#f=yc.#g*r,this.#h=r,this.#d.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#m(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[i,r,s,a]=this.#t;return[(this.#l+(t[0]-e[0])/2-i)/s,(this.#o+(t[1]-e[1])/2-r)/a,(this.#l+(e[0]-t[0])/2-i)/s,(this.#o+(e[1]-t[1])/2-r)/a]}add({x:t,y:e}){this.#l=t,this.#o=e;const[i,r,s,a]=this.#t;let[l,u,f,d]=this.#r.subarray(8,12);const p=t-f,m=e-d,v=Math.hypot(p,m);if(v<this.#f)return!1;const x=v-this.#c,_=x/v,b=_*p,E=_*m;let T=l,S=u;l=f,u=d,f+=b,d+=E,this.#d?.push(t,e);const O=-E/x,R=b/x,N=O*this.#u,C=R*this.#u;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+N,d+C],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-N,d-C],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([l+N,u+C],2),this.#s.push(NaN,NaN,NaN,NaN,(l+N-i)/s,(u+C-r)/a),this.#r.set([l-N,u-C],14),this.#e.push(NaN,NaN,NaN,NaN,(l-N-i)/s,(u-C-r)/a)),this.#r.set([T,S,l,u,f,d],6),!this.isEmpty()):(this.#r.set([T,S,l,u,f,d],6),Math.abs(Math.atan2(S-u,T-l)-Math.atan2(E,b))<Math.PI/2?([l,u,f,d]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((l+f)/2-i)/s,((u+d)/2-r)/a),[l,u,T,S]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((T+l)/2-i)/s,((S+u)/2-r)/a),!0):([T,S,l,u,f,d]=this.#r.subarray(0,6),this.#s.push(((T+5*l)/6-i)/s,((S+5*u)/6-r)/a,((5*l+f)/6-i)/s,((5*u+d)/6-r)/a,((l+f)/2-i)/s,((u+d)/2-r)/a),[f,d,l,u,T,S]=this.#r.subarray(12,18),this.#e.push(((T+5*l)/6-i)/s,((S+5*u)/6-r)/a,((5*l+f)/6-i)/s,((5*u+d)/6-r)/a,((l+f)/2-i)/s,((u+d)/2-r)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#v();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#x(i);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return this.#_(i),i.join(" ")}#v(){const[t,e,i,r]=this.#t,[s,a,l,u]=this.#m();return`M${(this.#r[2]-t)/i} ${(this.#r[3]-e)/r} L${(this.#r[4]-t)/i} ${(this.#r[5]-e)/r} L${s} ${a} L${l} ${u} L${(this.#r[16]-t)/i} ${(this.#r[17]-e)/r} L${(this.#r[14]-t)/i} ${(this.#r[15]-e)/r} Z`}#_(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#x(t){const[e,i,r,s]=this.#t,a=this.#r.subarray(4,6),l=this.#r.subarray(16,18),[u,f,d,p]=this.#m();t.push(`L${(a[0]-e)/r} ${(a[1]-i)/s} L${u} ${f} L${d} ${p} L${(l[0]-e)/r} ${(l[1]-i)/s}`)}newFreeDrawOutline(t,e,i,r,s,a){return new tD(t,e,i,r,s,a)}getOutlines(){const t=this.#s,e=this.#e,i=this.#r,[r,s,a,l]=this.#t,u=new Float32Array((this.#d?.length??0)+2);for(let p=0,m=u.length-2;p<m;p+=2)u[p]=(this.#d[p]-r)/a,u[p+1]=(this.#d[p+1]-s)/l;if(u[u.length-2]=(this.#l-r)/a,u[u.length-1]=(this.#o-s)/l,isNaN(i[6])&&!this.isEmpty())return this.#y(u);const f=new Float32Array(this.#s.length+24+this.#e.length);let d=t.length;for(let p=0;p<d;p+=2){if(isNaN(t[p])){f[p]=f[p+1]=NaN;continue}f[p]=t[p],f[p+1]=t[p+1]}d=this.#S(f,d);for(let p=e.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(e[p+m])){f[d]=f[d+1]=NaN,d+=2;continue}f[d]=e[p+m],f[d+1]=e[p+m+1],d+=2}return this.#w(f,d),this.newFreeDrawOutline(f,u,this.#t,this.#h,this.#n,this.#i)}#y(t){const e=this.#r,[i,r,s,a]=this.#t,[l,u,f,d]=this.#m(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-i)/s,(e[3]-r)/a,NaN,NaN,NaN,NaN,(e[4]-i)/s,(e[5]-r)/a,NaN,NaN,NaN,NaN,l,u,NaN,NaN,NaN,NaN,f,d,NaN,NaN,NaN,NaN,(e[16]-i)/s,(e[17]-r)/a,NaN,NaN,NaN,NaN,(e[14]-i)/s,(e[15]-r)/a],0),this.newFreeDrawOutline(p,t,this.#t,this.#h,this.#n,this.#i)}#w(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#S(t,e){const i=this.#r.subarray(4,6),r=this.#r.subarray(16,18),[s,a,l,u]=this.#t,[f,d,p,m]=this.#m();return t.set([NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-a)/u,NaN,NaN,NaN,NaN,f,d,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(r[0]-s)/l,(r[1]-a)/u],e),e+=24}}class tD extends de{#t;#e=new Float32Array(4);#n;#i;#s;#r;#l;constructor(t,e,i,r,s,a){super(),this.#l=t,this.#s=e,this.#t=i,this.#r=r,this.#n=s,this.#i=a,this.lastPoint=[NaN,NaN],this.#o(a);const[l,u,f,d]=this.#e;for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/f,t[p+1]=(t[p+1]-u)/d;for(let p=0,m=e.length;p<m;p+=2)e[p]=(e[p]-l)/f,e[p+1]=(e[p+1]-u)/d}toSVGPath(){const t=[`M${this.#l[4]} ${this.#l[5]}`];for(let e=6,i=this.#l.length;e<i;e+=6){if(isNaN(this.#l[e])){t.push(`L${this.#l[e+4]} ${this.#l[e+5]}`);continue}t.push(`C${this.#l[e]} ${this.#l[e+1]} ${this.#l[e+2]} ${this.#l[e+3]} ${this.#l[e+4]} ${this.#l[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,r],s){const a=i-t,l=r-e;let u,f;switch(s){case 0:u=de._rescale(this.#l,t,r,a,-l),f=de._rescale(this.#s,t,r,a,-l);break;case 90:u=de._rescaleAndSwap(this.#l,t,e,a,l),f=de._rescaleAndSwap(this.#s,t,e,a,l);break;case 180:u=de._rescale(this.#l,i,e,-a,l),f=de._rescale(this.#s,i,e,-a,l);break;case 270:u=de._rescaleAndSwap(this.#l,i,r,-a,-l),f=de._rescaleAndSwap(this.#s,i,r,-a,-l);break}return{outline:Array.from(u),points:[Array.from(f)]}}#o(t){const e=this.#l;let i=e[4],r=e[5];const s=[i,r,i,r];let a=i,l=r;const u=t?Math.max:Math.min;for(let d=6,p=e.length;d<p;d+=6){const m=e[d+4],v=e[d+5];if(isNaN(e[d]))be.pointBoundingBox(m,v,s),l<v?(a=m,l=v):l===v&&(a=u(a,m));else{const x=[1/0,1/0,-1/0,-1/0];be.bezierBoundingBox(i,r,...e.slice(d,d+6),x),be.rectBoundingBox(...x,s),l<x[3]?(a=x[2],l=x[3]):l===x[3]&&(a=u(a,x[2]))}i=m,r=v}const f=this.#e;f[0]=s[0]-this.#n,f[1]=s[1]-this.#n,f[2]=s[2]-s[0]+2*this.#n,f[3]=s[3]-s[1]+2*this.#n,this.lastPoint=[a,l]}get box(){return this.#e}newOutliner(t,e,i,r,s,a=0){return new yc(t,e,i,r,s,a)}getNewOutline(t,e){const[i,r,s,a]=this.#e,[l,u,f,d]=this.#t,p=s*f,m=a*d,v=i*f+l,x=r*d+u,_=this.newOutliner({x:this.#s[0]*p+v,y:this.#s[1]*m+x},this.#t,this.#r,t,this.#i,e??this.#n);for(let b=2;b<this.#s.length;b+=2)_.add({x:this.#s[b]*p+v,y:this.#s[b+1]*m+x});return _.getOutlines()}}class fx{#t;#e;#n=[];#i=[];constructor(t,e=0,i=0,r=!0){const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:v,y:x,width:_,height:b}of t){const E=Math.floor((v-e)/a)*a,T=Math.ceil((v+_+e)/a)*a,S=Math.floor((x-e)/a)*a,O=Math.ceil((x+b+e)/a)*a,R=[E,S,O,!0],N=[T,S,O,!1];this.#n.push(R,N),be.rectBoundingBox(E,S,T,O,s)}const l=s[2]-s[0]+2*i,u=s[3]-s[1]+2*i,f=s[0]-i,d=s[1]-i,p=this.#n.at(r?-1:-2),m=[p[0],p[2]];for(const v of this.#n){const[x,_,b]=v;v[0]=(x-f)/l,v[1]=(_-d)/u,v[2]=(b-d)/u}this.#t=new Float32Array([f,d,l,u]),this.#e=m}getOutlines(){this.#n.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#f(e)),this.#l(e)):(this.#o(e),t.push(...this.#f(e)));return this.#s(t)}#s(t){const e=[],i=new Set;for(const a of t){const[l,u,f]=a;e.push([l,u,a],[l,f,a])}e.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=e.length;a<l;a+=2){const u=e[a][2],f=e[a+1][2];u.push(f),f.push(u),i.add(u),i.add(f)}const r=[];let s;for(;i.size>0;){const a=i.values().next().value;let[l,u,f,d,p]=a;i.delete(a);let m=l,v=u;for(s=[l,f],r.push(s);;){let x;if(i.has(d))x=d;else if(i.has(p))x=p;else break;i.delete(x),[l,u,f,d,p]=x,m!==l&&(s.push(m,v,l,v===u?u:f),m=l),v=v===u?f:u}s.push(m,v)}return new xF(r,this.#t,this.#e)}#r(t){const e=this.#i;let i=0,r=e.length-1;for(;i<=r;){const s=i+r>>1,a=e[s][0];if(a===t)return s;a<t?i=s+1:r=s-1}return r+1}#l([,t,e]){const i=this.#r(t);this.#i.splice(i,0,[t,e])}#o([,t,e]){const i=this.#r(t);for(let r=i;r<this.#i.length;r++){const[s,a]=this.#i[r];if(s!==t)break;if(s===t&&a===e){this.#i.splice(r,1);return}}for(let r=i-1;r>=0;r--){const[s,a]=this.#i[r];if(s!==t)break;if(s===t&&a===e){this.#i.splice(r,1);return}}}#f(t){const[e,i,r]=t,s=[[e,i,r]],a=this.#r(r);for(let l=0;l<a;l++){const[u,f]=this.#i[l];for(let d=0,p=s.length;d<p;d++){const[,m,v]=s[d];if(!(f<=m||v<=u)){if(m>=u){if(v>f)s[d][1]=f;else{if(p===1)return[];s.splice(d,1),d--,p--}continue}s[d][2]=u,v>f&&s.push([e,f,v])}}}return s}}class xF extends de{#t;#e;constructor(t,e,i){super(),this.#e=t,this.#t=e,this.lastPoint=i}toSVGPath(){const t=[];for(const e of this.#e){let[i,r]=e;t.push(`M${i} ${r}`);for(let s=2;s<e.length;s+=2){const a=e[s],l=e[s+1];a===i?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,e,i,r],s){const a=[],l=i-t,u=r-e;for(const f of this.#e){const d=new Array(f.length);for(let p=0;p<f.length;p+=2)d[p]=t+f[p]*l,d[p+1]=r-f[p+1]*u;a.push(d)}return a}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class hx extends yc{newFreeDrawOutline(t,e,i,r,s,a){return new bF(t,e,i,r,s,a)}}class bF extends tD{newOutliner(t,e,i,r,s,a=0){return new hx(t,e,i,r,s,a)}}class rs{#t=null;#e=null;#n;#i=null;#s=!1;#r=!1;#l=null;#o;#f=null;#c=null;#h;static#u=null;static get _keyboardManager(){return Xe(this,"_keyboardManager",new op([[["Escape","mac+Escape"],rs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],rs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],rs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],rs.prototype._moveToPrevious],[["Home","mac+Home"],rs.prototype._moveToBeginning],[["End","mac+End"],rs.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#h=Ke.HIGHLIGHT_COLOR,this.#l=t):(this.#r=!0,this.#h=Ke.HIGHLIGHT_DEFAULT_COLOR),this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",rs.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#c._signal;t.addEventListener("click",this.#g.bind(this),{signal:e}),t.addEventListener("keydown",this.#p.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=this.#n,t.append(i),t}renderMainDropdown(){const t=this.#i=this.#d();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#d(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",js,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,r]of this.#c.highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",r),s.title=i,s.setAttribute("data-l10n-id",rs.#u[i]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=r,s.setAttribute("aria-selected",r===this.#n),s.addEventListener("click",this.#a.bind(this,r),{signal:e}),t.append(s)}return t.addEventListener("keydown",this.#p.bind(this),{signal:e}),t}#a(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const e=t.target.getAttribute("data-color");e&&this.#a(e,t)}_moveToNext(t){if(!this.#v){this.#g(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#v){this.#g(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#v){this.#g(t);return}this.#i.lastChild?.focus()}#p(t){rs._keyboardManager.exec(this,t)}#g(t){if(this.#v){this.hideDropdown();return}if(this.#s=t.detail===0,this.#f||(this.#f=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#c.combinedSignal(this.#f)})),this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#d();this.#t.append(e)}#m(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#f?.abort(),this.#f=null}get#v(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#v){this.#l?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#c.highlightColors.values();for(const i of this.#i.children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class ti extends Se{#t=null;#e=0;#n;#i=null;#s=null;#r=null;#l=null;#o=0;#f=null;#c=null;#h=null;#u=!1;#d=null;#a;#p=null;#g="";#m;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Be.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ti.prototype;return Xe(this,"_keyboardManager",new op([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ti._defaultColor,this.#m=t.thickness||ti._defaultThickness,this.#a=t.opacity||ti._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#g=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#x(t),this.#O()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#l=t.focusNode,this.#o=t.focusOffset,this.#_(),this.#O(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#_(){const t=new fx(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new fx(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{lastPoint:i}=this.#r;this.#d=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#x({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#c=t;const r=1.5;if(this.#r=t.getNewOutline(this.#m/2+r,.0025),e>=0)this.#h=e,this.#i=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const d=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:ti.#E(this.#c.box,(d-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:ti.#E(this.#r.box,d),path:{d:this.#r.toSVGPath()}})}const[s,a,l,u]=t.box;switch(this.rotation){case 0:this.x=s,this.y=a,this.width=l,this.height=u;break;case 90:{const[d,p]=this.parentDimensions;this.x=a,this.y=1-s,this.width=l*p/d,this.height=u*d/p;break}case 180:this.x=1-s,this.y=1-a,this.width=l,this.height=u;break;case 270:{const[d,p]=this.parentDimensions;this.x=1-a,this.y=s,this.width=l*p/d,this.height=u*d/p;break}}const{lastPoint:f}=this.#r;this.#d=[(f[0]-s)/l,(f[1]-a)/u]}static initialize(t,e){Se.initialize(t,e),ti._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Ke.HIGHLIGHT_DEFAULT_COLOR:ti._defaultColor=e;break;case Ke.HIGHLIGHT_THICKNESS:ti._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#d}updateParams(t,e){switch(t){case Ke.HIGHLIGHT_COLOR:this.#y(e);break;case Ke.HIGHLIGHT_THICKNESS:this.#w(e);break}}static get defaultPropertiesToUpdate(){return[[Ke.HIGHLIGHT_DEFAULT_COLOR,ti._defaultColor],[Ke.HIGHLIGHT_THICKNESS,ti._defaultThickness]]}get propertiesToUpdate(){return[[Ke.HIGHLIGHT_COLOR,this.color||ti._defaultColor],[Ke.HIGHLIGHT_THICKNESS,this.#m||ti._defaultThickness],[Ke.HIGHLIGHT_FREE,this.#u]]}#y(t){const e=(s,a)=>{this.color=s,this.#a=a,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:s,"fill-opacity":a}}),this.#s?.updateColor(s)},i=this.color,r=this.#a;this.addCommands({cmd:e.bind(this,t,ti._defaultOpacity),undo:e.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#w(t){const e=this.#m,i=r=>{this.#m=r,this.#S(r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#s=new rs({editor:this}),t.addColorPicker(this.#s)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#N())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#O(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#O(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#S(t){if(!this.#u)return;this.#x({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}#C(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#O(t=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#u),this.#f&&(this.#f.style.clipPath=this.#i))}static#E([t,e,i,r],s){switch(s){case 90:return[1-e-r,t,r,i];case 180:return[1-t-i,1-e-r,i,r];case 270:return[e,1-t-i,r,i]}return[t,e,i,r]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#u?(t=(t-this.rotation+360)%360,i=ti.#E(this.#c.box,t)):i=ti.#E([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#h,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:ti.#E(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#g&&(t.setAttribute("aria-label",this.#g),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#f=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i;const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),CC(this,this.#f,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#D(t){ti._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#T(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#N(){return this.#u?this.rotation:0}#k(){if(this.#u)return null;const[t,e]=this.pageDimensions,[i,r]=this.pageTranslation,s=this.#n,a=new Float32Array(s.length*8);let l=0;for(const{x:u,y:f,width:d,height:p}of s){const m=u*t+i,v=(1-f)*e+r;a[l]=a[l+4]=m,a[l+1]=a[l+3]=v,a[l+2]=a[l+6]=m+d*t,a[l+5]=a[l+7]=v-p*e,l+=8}return a}#L(t){return this.#c.serialize(t,this.#N())}static startHighlighting(t,e,{target:i,x:r,y:s}){const{x:a,y:l,width:u,height:f}=i.getBoundingClientRect(),d=new AbortController,p=t.combinedSignal(d),m=v=>{d.abort(),this.#A(t,v)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",ei,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",js,{signal:p}),i.addEventListener("pointermove",this.#z.bind(this,t),{signal:p}),this._freeHighlight=new hx({x:r,y:s},[a,l,u,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#z(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#A(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let r=null;if(t instanceof ZC){const{data:{quadPoints:x,rect:_,rotation:b,id:E,color:T,opacity:S,popupRef:O},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:Be.HIGHLIGHT,color:Array.from(T),opacity:S,quadPoints:x,boxes:null,pageIndex:R-1,rect:_.slice(0),rotation:b,id:E,deleted:!1,popupRef:O}}else if(t instanceof xb){const{data:{inkLists:x,rect:_,rotation:b,id:E,color:T,borderStyle:{rawWidth:S},popupRef:O},parent:{page:{pageNumber:R}}}=t;r=t={annotationType:Be.HIGHLIGHT,color:Array.from(T),thickness:S,inkLists:x,boxes:null,pageIndex:R-1,rect:_.slice(0),rotation:b,id:E,deleted:!1,popupRef:O}}const{color:s,quadPoints:a,inkLists:l,opacity:u}=t,f=await super.deserialize(t,e,i);f.color=be.makeHexColor(...s),f.#a=u||1,l&&(f.#m=t.thickness),f.annotationElementId=t.id||null,f._initialData=r;const[d,p]=f.pageDimensions,[m,v]=f.pageTranslation;if(a){const x=f.#n=[];for(let _=0;_<a.length;_+=8)x.push({x:(a[_]-m)/d,y:1-(a[_+1]-v)/p,width:(a[_+2]-a[_])/d,height:(a[_+1]-a[_+5])/p});f.#_(),f.#O(),f.rotate(f.rotation)}else if(l){f.#u=!0;const x=l[0],_={x:x[0]-m,y:p-(x[1]-v)},b=new hx(_,[0,0,d,p],1,f.#m/2,!0,.001);for(let S=0,O=x.length;S<O;S+=2)_.x=x[S]-m,_.y=p-(x[S+1]-v),b.add(_);const{id:E,clipPathId:T}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:b.toSVGPath()}},!0,!0);f.#x({highlightOutlines:b.getOutlines(),highlightId:E,clipPathId:T}),f.#O(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),i=Se._colorManager.convert(this.color),r={annotationType:Be.HIGHLIGHT,color:i,opacity:this.#a,thickness:this.#m,quadPoints:this.#k(),outlines:this.#L(e),pageIndex:this.pageIndex,rect:e,rotation:this.#N(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#b(r)?null:(r.id=this.annotationElementId,r)}#b(t){const{color:e}=this._initialData;return t.color.some((i,r)=>i!==e[r])}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class eD{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Tn("Not implemented")}}class Oe extends Se{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#s=null;static#r=NaN;static#l=null;static#o=null;static#f=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#d())}#c({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#h(t,this.parent),this.#g(t.box)}#h(t,e){const{id:i}=e.drawLayer.draw(Oe._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[r,s]of Object.entries(e))i.has(r)?Object.assign(t[r],s):t[r]=s;return t}static getDefaultDrawingOptions(t){Tn("Not implemented")}static get typesMap(){Tn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(Oe.#n.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,e[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,e[r]]);return t}_updateProperty(t,e,i){const r=this._drawingOptions,s=r[e],a=l=>{r.updateProperty(e,l);const u=this.#t.updateProperty(e,l);u&&this.#g(u),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#d(),this.#g(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#d(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#d(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#t,t)}}#a([t,e,i,r]){const{parentDimensions:[s,a],rotation:l}=this;switch(l){case 90:return[e,1-t,i*(a/s),r*(s/a)];case 180:return[1-t,1-e,i,r];case 270:return[1-e,t,i*(a/s),r*(s/a)];default:return[t,e,i,r]}}#p(){const{x:t,y:e,width:i,height:r,parentDimensions:[s,a],rotation:l}=this;switch(l){case 90:return[1-e,t,i*(s/a),r*(a/s)];case 180:return[1-t,1-e,i,r];case 270:return[e,1-t,i*(s/a),r*(a/s)];default:return[t,e,i,r]}}#g(t){if([this.x,this.y,this.width,this.height]=this.#a(t),this.div){this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}this._onResized()}#m(){const{x:t,y:e,width:i,height:r,rotation:s,parentRotation:a,parentDimensions:[l,u]}=this;switch((s*4+a)/90){case 1:return[1-e-r,t,r,i];case 2:return[1-t-i,1-e-r,i,r];case 3:return[e,1-t-i,r,i];case 4:return[t,e-i*(l/u),r*(u/l),i*(l/u)];case 5:return[1-e,t,i*(l/u),r*(u/l)];case 6:return[1-t-r*(u/l),1-e,r*(u/l),i*(l/u)];case 7:return[e-i*(l/u),1-t-r*(u/l),i*(l/u),r*(u/l)];case 8:return[t-i,e-r,i,r];case 9:return[1-e,t-i,r,i];case 10:return[1-t,1-e,i,r];case 11:return[e-r,1-t,r,i];case 12:return[t-r*(u/l),e,r*(u/l),i*(l/u)];case 13:return[1-e-i*(l/u),t-r*(u/l),i*(l/u),r*(u/l)];case 14:return[1-t,1-e-i*(l/u),r*(u/l),i*(l/u)];case 15:return[e,1-t,i*(l/u),r*(u/l)];default:return[t,e,i,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#g(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[s,a]=this.parentDimensions;return this.setDims(this.width*s,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,r,s){Tn("Not implemented")}static startDrawing(t,e,i,r){const{target:s,offsetX:a,offsetY:l,pointerId:u,pointerType:f}=r;if(Oe.#l&&Oe.#l!==f)return;const{viewport:{rotation:d}}=t,{width:p,height:m}=s.getBoundingClientRect(),v=Oe.#i=new AbortController,x=t.combinedSignal(v);if(Oe.#r||=u,Oe.#l??=f,window.addEventListener("pointerup",_=>{Oe.#r===_.pointerId?this._endDraw(_):Oe.#o?.delete(_.pointerId)},{signal:x}),window.addEventListener("pointercancel",_=>{Oe.#r===_.pointerId?this._currentParent.endDrawingSession():Oe.#o?.delete(_.pointerId)},{signal:x}),window.addEventListener("pointerdown",_=>{Oe.#l===_.pointerType&&((Oe.#o||=new Set).add(_.pointerId),Oe.#n.isCancellable()&&(Oe.#n.removeLastElement(),Oe.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",js,{signal:x}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),s.addEventListener("touchmove",_=>{_.timeStamp===Oe.#f&&ei(_)},{signal:x}),t.toggleDrawing(),e._editorUndoBar?.hide(),Oe.#n){t.drawLayer.updateProperties(this._currentDrawId,Oe.#n.startNew(a,l,p,m,d));return}e.updateUIForDefaultProperties(this),Oe.#n=this.createDrawerInstance(a,l,p,m,d),Oe.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Oe.#s.toSVGProperties(),Oe.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Oe.#f=-1,!Oe.#n)return;const{offsetX:e,offsetY:i,pointerId:r}=t;if(Oe.#r===r){if(Oe.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Oe.#n.add(e,i)),Oe.#f=t.timeStamp,ei(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Oe.#n=null,Oe.#s=null,Oe.#l=null,Oe.#f=NaN),Oe.#i&&(Oe.#i.abort(),Oe.#i=null,Oe.#r=NaN,Oe.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Oe.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=Oe.#n,r=this._currentDrawId,s=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(r,i.setLastElement(s))},undo:()=>{e.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:Ke.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Ke.DRAW_STEP),!Oe.#n.isEmpty()){const{pageDimensions:[i,r],scale:s}=e,a=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Oe.#n.getOutlines(i*s,r*s,s,this._INNER_MARGIN),drawingOptions:Oe.#s,mustBeCommitted:!t});return this._cleanup(!0),a}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,r,s,a){Tn("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:r,pageHeight:s,pageX:a,pageY:l}}=e.viewport,u=this.deserializeDraw(a,l,r,s,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#c({drawOutlines:u}),f.#d(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[r,s]=this.pageDimensions;return this.#t.serialize([e,i,r,s],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class yF{#t=new Float64Array(6);#e;#n;#i;#s;#r;#l="";#o=0;#f=new fp;#c;#h;constructor(t,e,i,r,s,a){this.#c=i,this.#h=r,this.#i=s,this.#s=a,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#n=[{line:l,points:this.#r}],this.#t.set(l,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#u(t,e){return de._normalizePoint(t,e,this.#c,this.#h,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#u(t,e);const[i,r,s,a]=this.#t.subarray(2,6),l=t-s,u=e-a;return Math.hypot(this.#c*l,this.#h*u)<=2?null:(this.#r.push(t,e),isNaN(i)?(this.#t.set([s,a,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,r,s,a,t,e],0),this.#e.push(...de.createBezierPoints(i,r,s,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,r,s){this.#c=i,this.#h=r,this.#i=s,[t,e]=this.#u(t,e);const a=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const l=this.#n.at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),this.#n.push({line:a,points:this.#r}),this.#t.set(a,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#f.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#f.removeLastElement();this.#n.pop(),this.#l="";for(let t=0,e=this.#n.length;t<e;t++){const{line:i,points:r}=this.#n[t];this.#e=i,this.#r=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const t=de.svgRound(this.#e[4]),e=de.svgRound(this.#e[5]);if(this.#r.length===2)return this.#l=`${this.#l} M ${t} ${e} Z`,this.#l;if(this.#r.length<=6){const r=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,r)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const r=de.svgRound(this.#e[10]),s=de.svgRound(this.#e[11]);return this.#l=`${this.#l} L ${r} ${s}`,this.#o=12,this.#l}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let r=this.#o,s=this.#e.length;r<s;r+=6){const[a,l,u,f,d,p]=this.#e.slice(r,r+6).map(de.svgRound);i.push(`C${a} ${l} ${u} ${f} ${d} ${p}`)}return this.#l+=i.join(" "),this.#o=this.#e.length,this.#l}getOutlines(t,e,i,r){const s=this.#n.at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),this.#f.build(this.#n,t,e,i,this.#i,this.#s,r),this.#t=null,this.#e=null,this.#n=null,this.#l=null,this.#f}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class fp extends de{#t;#e=0;#n;#i;#s;#r;#l;#o;#f;build(t,e,i,r,s,a,l){this.#s=e,this.#r=i,this.#l=r,this.#o=s,this.#f=a,this.#n=l??0,this.#i=t,this.#u()}get thickness(){return this.#f}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${de.svgRound(e[4])} ${de.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${de.svgRound(e[10])} ${de.svgRound(e[11])}`);continue}for(let i=6,r=e.length;i<r;i+=6){const[s,a,l,u,f,d]=e.subarray(i,i+6).map(de.svgRound);t.push(`C${s} ${a} ${l} ${u} ${f} ${d}`)}}return t.join("")}serialize([t,e,i,r],s){const a=[],l=[],[u,f,d,p]=this.#h();let m,v,x,_,b,E,T,S,O;switch(this.#o){case 0:O=de._rescale,m=t,v=e+r,x=i,_=-r,b=t+u*i,E=e+(1-f-p)*r,T=t+(u+d)*i,S=e+(1-f)*r;break;case 90:O=de._rescaleAndSwap,m=t,v=e,x=i,_=r,b=t+f*i,E=e+u*r,T=t+(f+p)*i,S=e+(u+d)*r;break;case 180:O=de._rescale,m=t+i,v=e,x=-i,_=r,b=t+(1-u-d)*i,E=e+f*r,T=t+(1-u)*i,S=e+(f+p)*r;break;case 270:O=de._rescaleAndSwap,m=t+i,v=e+r,x=-i,_=-r,b=t+(1-f-p)*i,E=e+(1-u-d)*r,T=t+(1-f)*i,S=e+(1-u)*r;break}for(const{line:R,points:N}of this.#i)a.push(O(R,m,v,x,_,s?new Array(R.length):null)),l.push(O(N,m,v,x,_,s?new Array(N.length):null));return{lines:a,points:l,rect:[b,E,T,S]}}static deserialize(t,e,i,r,s,{paths:{lines:a,points:l},rotation:u,thickness:f}){const d=[];let p,m,v,x,_;switch(u){case 0:_=de._rescale,p=-t/i,m=e/r+1,v=1/i,x=-1/r;break;case 90:_=de._rescaleAndSwap,p=-e/r,m=-t/i,v=1/r,x=1/i;break;case 180:_=de._rescale,p=t/i+1,m=-e/r,v=-1/i,x=1/r;break;case 270:_=de._rescaleAndSwap,p=e/r+1,m=t/i+1,v=-1/r,x=-1/i;break}if(!a){a=[];for(const E of l){const T=E.length;if(T===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(T===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const S=new Float32Array(3*(T-2));a.push(S);let[O,R,N,C]=E.subarray(0,4);S.set([NaN,NaN,NaN,NaN,O,R],0);for(let M=4;M<T;M+=2){const I=E[M],F=E[M+1];S.set(de.createBezierPoints(O,R,N,C,I,F),(M-2)*3),[O,R,N,C]=[N,C,I,F]}}}for(let E=0,T=a.length;E<T;E++)d.push({line:_(a[E].map(S=>S??NaN),p,m,v,x),points:_(l[E].map(S=>S??NaN),p,m,v,x)});const b=new this.prototype.constructor;return b.build(d,i,r,1,u,f,s),b}#c(t=this.#f){const e=this.#n+t/2*this.#l;return this.#o%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#h(){const[t,e,i,r]=this.#t,[s,a]=this.#c(0);return[t+s,e+a,i-2*s,r-2*a]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let l=4,u=r.length;l<u;l+=6)be.pointBoundingBox(r[l],r[l+1],t);continue}let s=r[4],a=r[5];for(let l=6,u=r.length;l<u;l+=6){const[f,d,p,m,v,x]=r.subarray(l,l+6);be.bezierBoundingBox(s,a,f,d,p,m,v,x,t),s=v,a=x}}const[e,i]=this.#c();t[0]=Ji(t[0]-e,0,1),t[1]=Ji(t[1]-i,0,1),t[2]=Ji(t[2]+e,0,1),t[3]=Ji(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#d(e):null}#d(t){const[e,i]=this.#c();this.#f=t;const[r,s]=this.#c(),[a,l]=[r-e,s-i],u=this.#t;return u[0]-=a,u[1]-=l,u[2]+=2*a,u[3]+=2*l,u}updateParentDimensions([t,e],i){const[r,s]=this.#c();this.#s=t,this.#r=e,this.#l=i;const[a,l]=this.#c(),u=a-r,f=l-s,d=this.#t;return d[0]-=u,d[1]-=f,d[2]+=2*u,d[3]+=2*f,d}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(de.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,r=0,s=0,a=0,l=0,u=0;switch(this.#e){case 90:r=e/t,s=-t/e,l=t;break;case 180:i=-1,a=-1,l=t,u=e;break;case 270:r=-e/t,s=t/e,u=e;break;default:return""}return`matrix(${i} ${r} ${s} ${a} ${de.svgRound(l)} ${de.svgRound(u)})`}getPathResizingSVGProperties([t,e,i,r]){const[s,a]=this.#c(),[l,u,f,d]=this.#t;if(Math.abs(f-s)<=de.PRECISION||Math.abs(d-a)<=de.PRECISION){const _=t+i/2-(l+f/2),b=e+r/2-(u+d/2);return{path:{"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`,transform:`${this.rotationTransform} translate(${_} ${b})`}}}const p=(i-2*s)/(f-2*s),m=(r-2*a)/(d-2*a),v=f/i,x=d/r;return{path:{"transform-origin":`${de.svgRound(l)} ${de.svgRound(u)}`,transform:`${this.rotationTransform} scale(${v} ${x}) translate(${de.svgRound(s)} ${de.svgRound(a)}) scale(${p} ${m}) translate(${de.svgRound(-s)} ${de.svgRound(-a)})`}}}getPathResizedSVGProperties([t,e,i,r]){const[s,a]=this.#c(),l=this.#t,[u,f,d,p]=l;if(l[0]=t,l[1]=e,l[2]=i,l[3]=r,Math.abs(d-s)<=de.PRECISION||Math.abs(p-a)<=de.PRECISION){const b=t+i/2-(u+d/2),E=e+r/2-(f+p/2);for(const{line:T,points:S}of this.#i)de._translate(T,b,E,T),de._translate(S,b,E,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*s)/(d-2*s),v=(r-2*a)/(p-2*a),x=-m*(u+s)+t+s,_=-v*(f+a)+e+a;if(m!==1||v!==1||x!==0||_!==0)for(const{line:b,points:E}of this.#i)de._rescale(b,x,_,m,v,b),de._rescale(E,x,_,m,v,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[r,s]=i,a=this.#t,l=t-a[0],u=e-a[1];if(this.#s===r&&this.#r===s)for(const{line:f,points:d}of this.#i)de._translate(f,l,u,f),de._translate(d,l,u,d);else{const f=this.#s/r,d=this.#r/s;this.#s=r,this.#r=s;for(const{line:p,points:m}of this.#i)de._rescale(p,l,u,f,d,p),de._rescale(m,l,u,f,d,m);a[2]*=f,a[3]*=d}return a[0]=t,a[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${de.svgRound(t[0])} ${de.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Wg extends eD{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Se._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Wg(this._viewParameters);return t.updateAll(this),t}}class yb extends Oe{static _type="ink";static _editorType=Be.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Se.initialize(t,e),this._defaultDrawingOptions=new Wg(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Xe(this,"typesMap",new Map([[Ke.INK_THICKNESS,"stroke-width"],[Ke.INK_COLOR,"stroke"],[Ke.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,r,s){return new yF(t,e,i,r,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,r,s,a){return fp.deserialize(t,e,i,r,s,a)}static async deserialize(t,e,i){let r=null;if(t instanceof xb){const{data:{inkLists:a,rect:l,rotation:u,id:f,color:d,opacity:p,borderStyle:{rawWidth:m},popupRef:v},parent:{page:{pageNumber:x}}}=t;r=t={annotationType:Be.INK,color:Array.from(d),thickness:m,opacity:p,paths:{points:a},boxes:null,pageIndex:x-1,rect:l.slice(0),rotation:u,id:f,deleted:!1,popupRef:v}}const s=await super.deserialize(t,e,i);return s.annotationElementId=t.id||null,s._initialData=r,s}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=yb.getDefaultDrawingOptions({stroke:be.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":l}}=this,u={annotationType:Be.INK,color:Se._colorManager.convert(s),opacity:a,thickness:l,paths:{lines:e,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:r,pageIndex:s}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==e[l])||t.thickness!==i||t.opacity!==r||t.pageIndex!==s}renderAnnotationElement(t){const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e}),null}}class dx extends fp{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const um=8,ad=3;class gc{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,r){return i-=t,r-=e,i===0?r>0?0:4:i===1?r+6:2-r}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,i,r,s,a,l){const u=this.#e(i,r,s,a);for(let f=0;f<8;f++){const d=(-f+u-l+16)%8,p=this.#n[2*d],m=this.#n[2*d+1];if(t[(i+p)*e+(r+m)]!==0)return d}return-1}static#s(t,e,i,r,s,a,l){const u=this.#e(i,r,s,a);for(let f=0;f<8;f++){const d=(f+u+l+16)%8,p=this.#n[2*d],m=this.#n[2*d+1];if(t[(i+p)*e+(r+m)]!==0)return d}return-1}static#r(t,e,i,r){const s=t.length,a=new Int32Array(s);for(let d=0;d<s;d++)a[d]=t[d]<=r?1:0;for(let d=1;d<i-1;d++)a[d*e]=a[d*e+e-1]=0;for(let d=0;d<e;d++)a[d]=a[e*i-1-d]=0;let l=1,u;const f=[];for(let d=1;d<i-1;d++){u=1;for(let p=1;p<e-1;p++){const m=d*e+p,v=a[m];if(v===0)continue;let x=d,_=p;if(v===1&&a[m-1]===0)l+=1,_-=1;else if(v>=1&&a[m+1]===0)l+=1,_+=1,v>1&&(u=v);else{v!==1&&(u=Math.abs(v));continue}const b=[p,d],E=_===p+1,T={isHole:E,points:b,id:l,parent:0};f.push(T);let S;for(const z of f)if(z.id===u){S=z;break}S?S.isHole?T.parent=E?S.parent:u:T.parent=E?u:S.parent:T.parent=E?u:0;const O=this.#i(a,e,d,p,x,_,0);if(O===-1){a[m]=-l,a[m]!==1&&(u=Math.abs(a[m]));continue}let R=this.#n[2*O],N=this.#n[2*O+1];const C=d+R,M=p+N;x=C,_=M;let I=d,F=p;for(;;){const z=this.#s(a,e,I,F,x,_,1);R=this.#n[2*z],N=this.#n[2*z+1];const P=I+R,tt=F+N;b.push(tt,P);const L=I*e+F;if(a[L+1]===0?a[L]=-l:a[L]===1&&(a[L]=l),P===d&&tt===p&&I===C&&F===M){a[m]!==1&&(u=Math.abs(a[m]));break}else x=I,_=F,I=P,F=tt}}}return f}static#l(t,e,i,r){if(i-e<=4){for(let C=e;C<i-2;C+=2)r.push(t[C],t[C+1]);return}const s=t[e],a=t[e+1],l=t[i-4]-s,u=t[i-3]-a,f=Math.hypot(l,u),d=l/f,p=u/f,m=d*a-p*s,v=u/l,x=1/f,_=Math.atan(v),b=Math.cos(_),E=Math.sin(_),T=x*(Math.abs(b)+Math.abs(E)),S=x*(1-T+T**2),O=Math.max(Math.atan(Math.abs(E+b)*S),Math.atan(Math.abs(E-b)*S));let R=0,N=e;for(let C=e+2;C<i-2;C+=2){const M=Math.abs(m-d*t[C+1]+p*t[C]);M>R&&(N=C,R=M)}R>(f*O)**2?(this.#l(t,e,N+2,r),this.#l(t,N,i,r)):r.push(s,a)}static#o(t){const e=[],i=t.length;return this.#l(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#f(t,e,i,r,s,a){const l=new Float32Array(a**2),u=-2*r**2,f=a>>1;for(let _=0;_<a;_++){const b=(_-f)**2;for(let E=0;E<a;E++)l[_*a+E]=Math.exp((b+(E-f)**2)/u)}const d=new Float32Array(256),p=-2*s**2;for(let _=0;_<256;_++)d[_]=Math.exp(_**2/p);const m=t.length,v=new Uint8Array(m),x=new Uint32Array(256);for(let _=0;_<i;_++)for(let b=0;b<e;b++){const E=_*e+b,T=t[E];let S=0,O=0;for(let N=0;N<a;N++){const C=_+N-f;if(!(C<0||C>=i))for(let M=0;M<a;M++){const I=b+M-f;if(I<0||I>=e)continue;const F=t[C*e+I],z=l[N*a+M]*d[Math.abs(F-T)];S+=F*z,O+=z}}const R=v[E]=Math.round(S/O);x[R]++}return[v,x]}static#c(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#h(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let r=-1/0,s=1/0;for(let l=0,u=i.length;l<u;l++){if(t[(l<<2)+3]===0){r=i[l]=255;continue}const d=i[l]=t[l<<2];d>r&&(r=d),d<s&&(s=d)}const a=255/(r-s);for(let l=0;l<e;l++)i[l]=(i[l]-s)*a;return i}static#u(t){let e,i=-1/0,r=-1/0;const s=t.findIndex(u=>u!==0);let a=s,l=s;for(e=s;e<256;e++){const u=t[e];u>i&&(e-a>r&&(r=e-a,l=e-1),i=u,a=e)}for(e=l-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#d(t){const e=t,{width:i,height:r}=t,{maxDim:s}=this.#t;let a=i,l=r;if(i>s||r>s){let m=i,v=r,x=Math.log2(Math.max(i,r)/s);const _=Math.floor(x);x=x===_?_-1:_;for(let E=0;E<x;E++){a=Math.ceil(m/2),l=Math.ceil(v/2);const T=new OffscreenCanvas(a,l);T.getContext("2d").drawImage(t,0,0,m,v,0,0,a,l),m=a,v=l,t!==e&&t.close(),t=T.transferToImageBitmap()}const b=Math.min(s/a,s/l);a=Math.round(a*b),l=Math.round(l*b)}const f=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,a,l);const d=f.getImageData(0,0,a,l).data;return[this.#h(d),a,l]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:r},s,a,l,u){let f=new OffscreenCanvas(1,1),d=f.getContext("2d",{alpha:!1});const p=200,m=d.font=`${i} ${r} ${p}px ${e}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:x,actualBoundingBoxAscent:_,actualBoundingBoxDescent:b,fontBoundingBoxAscent:E,fontBoundingBoxDescent:T,width:S}=d.measureText(t),O=1.5,R=Math.ceil(Math.max(Math.abs(v)+Math.abs(x)||0,S)*O),N=Math.ceil(Math.max(Math.abs(_)+Math.abs(b)||p,Math.abs(E)+Math.abs(T)||p)*O);f=new OffscreenCanvas(R,N),d=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=m,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,R,N),d.fillStyle="black",d.fillText(t,R*(O-1)/2,N*(3-O)/2);const C=this.#h(d.getImageData(0,0,R,N).data),M=this.#c(C),I=this.#u(M),F=this.#r(C,R,N,I);return this.processDrawnLines({lines:{curves:F,width:R,height:N},pageWidth:s,pageHeight:a,rotation:l,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(t,e,i,r,s){const[a,l,u]=this.#d(t),[f,d]=this.#f(a,l,u,Math.hypot(l,u)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#u(d),m=this.#r(f,l,u,p);return this.processDrawnLines({lines:{curves:m,width:l,height:u},pageWidth:e,pageHeight:i,rotation:r,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:r,innerMargin:s,mustSmooth:a,areContours:l}){r%180!==0&&([e,i]=[i,e]);const{curves:u,width:f,height:d}=t,p=t.thickness??0,m=[],v=Math.min(e/f,i/d),x=v/e,_=v/i,b=[];for(const{points:T}of u){const S=a?this.#o(T):T;if(!S)continue;b.push(S);const O=S.length,R=new Float32Array(O),N=new Float32Array(3*(O===2?2:O-2));if(m.push({line:N,points:R}),O===2){R[0]=S[0]*x,R[1]=S[1]*_,N.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[C,M,I,F]=S;C*=x,M*=_,I*=x,F*=_,R.set([C,M,I,F],0),N.set([NaN,NaN,NaN,NaN,C,M],0);for(let z=4;z<O;z+=2){const P=R[z]=S[z]*x,tt=R[z+1]=S[z+1]*_;N.set(de.createBezierPoints(C,M,I,F,P,tt),(z-2)*3),[C,M,I,F]=[I,F,P,tt]}}if(m.length===0)return null;const E=l?new dx:new fp;return E.build(m,e,i,1,r,l?0:p,s),{outline:E,newCurves:b,areContours:l,thickness:p,width:f,height:d}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:r,height:s}){let a=1/0,l=-1/0,u=0;for(const S of t){u+=S.length;for(let O=2,R=S.length;O<R;O++){const N=S[O]-S[O-2];a=Math.min(a,N),l=Math.max(l,N)}}let f;a>=-128&&l<=127?f=Int8Array:a>=-32768&&l<=32767?f=Int16Array:f=Int32Array;const d=t.length,p=um+ad*d,m=new Uint32Array(p);let v=0;m[v++]=p*Uint32Array.BYTES_PER_ELEMENT+(u-2*d)*f.BYTES_PER_ELEMENT,m[v++]=0,m[v++]=r,m[v++]=s,m[v++]=e?0:1,m[v++]=Math.max(0,Math.floor(i??0)),m[v++]=d,m[v++]=f.BYTES_PER_ELEMENT;for(const S of t)m[v++]=S.length-2,m[v++]=S[0],m[v++]=S[1];const x=new CompressionStream("deflate-raw"),_=x.writable.getWriter();await _.ready,_.write(m);const b=f.prototype.constructor;for(const S of t){const O=new b(S.length-2);for(let R=2,N=S.length;R<N;R++)O[R-2]=S[R]-S[R-2];_.write(O)}_.close();const E=await new Response(x.readable).arrayBuffer(),T=new Uint8Array(E);return wC(T)}static async decompressSignature(t){try{const e=ZM(t),{readable:i,writable:r}=new DecompressionStream("deflate-raw"),s=r.getWriter();await s.ready,s.write(e).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,l=0;for await(const S of i)a||=new Uint8Array(new Uint32Array(S.buffer,0,4)[0]),a.set(S,l),l+=S.length;const u=new Uint32Array(a.buffer,0,a.length>>2),f=u[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const d=u[2],p=u[3],m=u[4]===0,v=u[5],x=u[6],_=u[7],b=[],E=(um+ad*x)*Uint32Array.BYTES_PER_ELEMENT;let T;switch(_){case Int8Array.BYTES_PER_ELEMENT:T=new Int8Array(a.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:T=new Int16Array(a.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:T=new Int32Array(a.buffer,E);break}l=0;for(let S=0;S<x;S++){const O=u[ad*S+um],R=new Float32Array(O+2);b.push(R);for(let N=0;N<ad-1;N++)R[N]=u[ad*S+um+N+1];for(let N=0;N<O;N++)R[N+2]=R[N]+T[l++]}return{areContours:m,thickness:v,outlines:b,width:d,height:p}}catch(e){return ze(`decompressSignature: ${e}`),null}}}class Eb extends eD{constructor(){super(),super.updateProperties({fill:Se._defaultLineColor,"stroke-width":0})}clone(){const t=new Eb;return t.updateAll(this),t}}class wb extends Wg{constructor(t){super(t),super.updateProperties({stroke:Se._defaultLineColor,"stroke-width":1})}clone(){const t=new wb(this._viewParameters);return t.updateAll(this),t}}class Fa extends Oe{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=Be.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Se.initialize(t,e),this._defaultDrawingOptions=new Eb,this._defaultDrawnSignatureOptions=new wb(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Xe(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:r,mustSmooth:s,areContours:a,description:l,uuid:u,heightInPage:f}=this.#n,{rawDims:{pageWidth:d,pageHeight:p},rotation:m}=this.parent.viewport,v=gc.processDrawnLines({lines:r,pageWidth:d,pageHeight:p,rotation:m,innerMargin:Fa._INNER_MARGIN,mustSmooth:s,areContours:a});this.addSignature(v,f,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:r,height:s}=this.#n,a=Math.max(r,s),l=gc.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:r,height:s},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:l.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&this.#e!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,this.#i,this.#e),t.show()),t):null}addSignature(t,e,i,r){const{x:s,y:a}=this,{outline:l}=this.#n=t;this.#t=l instanceof dx,this.#e=i,this.div.setAttribute("data-l10n-args",JSON.stringify({description:i}));let u;this.#t?u=Fa.getDefaultDrawingOptions():(u=Fa._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[f,d]=this.parentDimensions,[,p]=this.pageDimensions;let m=e/p;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(f*this.width,d*this.height),this.x=s,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:r}=this.parent.viewport;return gc.process(t,e,i,r,Fa._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:r},rotation:s}=this.parent.viewport;return gc.extractContoursFromText(t,e,i,r,s,Fa._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:r}=this.parent.viewport;return gc.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:r,innerMargin:Fa._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Fa.getDefaultDrawingOptions():(this._drawingOptions=Fa._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,a={annotationType:Be.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.paths={lines:e,points:i},a.uuid=this.#i,a.isCopy=!0):a.lines=e,this.#e&&(a.accessibilityData={type:"Figure",alt:this.#e}),a}static deserializeDraw(t,e,i,r,s,a){return a.areContours?dx.deserialize(t,e,i,r,s,a):fp.deserialize(t,e,i,r,s,a)}static async deserialize(t,e,i){const r=await super.deserialize(t,e,i);return r.#t=t.areContours,r.#e=t.accessibilityData?.alt||"",r.#i=t.uuid,r}}class EF extends Se{#t=null;#e=null;#n=null;#i=null;#s=null;#r="";#l=null;#o=!1;#f=null;#c=!1;#h=!1;static _type="stamp";static _editorType=Be.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Se.initialize(t,e)}static isHandlingMimeForPasting(t){return Jm.includes(t)}static paste(t,e){e.pasteEditor({mode:Be.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#r=t.file.name),this.#p()}#d(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:s,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:r,width:s,height:a,channels:r.length/(s*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),e&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}#a(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#u(i,!0)).finally(()=>this.#d());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(i).then(r=>this.#u(r)).finally(()=>this.#d());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(i).then(r=>this.#u(r)).finally(()=>this.#d());return}const t=document.createElement("input");t.type="file",t.accept=Jm.join(",");const e=this._uiManager._signal;this.#n=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(r)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#d()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#l?.remove(),this.#l=null,this.#f&&(clearTimeout(this.#f),this.#f=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#a();return}super.rebuild(),this.div!==null&&(this.#e&&this.#l===null&&this.#a(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#s||this.#e||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#o||(this.#t?this.#p():this.#a()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,r&&(this.#t=r),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#f!==null&&clearTimeout(this.#f);const t=200;this.#f=setTimeout(()=>{this.#f=null,this.#m()},t)}#p(){const{div:t}=this;let{width:e,height:i}=this.#t;const[r,s]=this.pageDimensions,a=.75;if(this.width)e=this.width*r,i=this.height*s;else if(e>a*r||i>a*s){const d=Math.min(a*r/e,a*s/i);e*=d,i*=d}const[l,u]=this.parentDimensions;this.setDims(e*l/r,i*u/s),this._uiManager.enableWaiting(!1);const f=this.#l=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/r,this.height=i/s,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r)}copyCanvas(t,e,i=!1){t||(t=224);const{width:r,height:s}=this.#t,a=new ca;let l=this.#t,u=r,f=s,d=null;if(e){if(r>e||s>e){const N=Math.min(e/r,e/s);u=Math.floor(r*N),f=Math.floor(s*N)}d=document.createElement("canvas");const m=d.width=Math.ceil(u*a.sx),v=d.height=Math.ceil(f*a.sy);this.#c||(l=this.#g(m,v));const x=d.getContext("2d");x.filter=this._uiManager.hcmFilter;let _="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(_="#8f8f9d",b="#42414d");const E=15,T=E*a.sx,S=E*a.sy,O=new OffscreenCanvas(T*2,S*2),R=O.getContext("2d");R.fillStyle=_,R.fillRect(0,0,T*2,S*2),R.fillStyle=b,R.fillRect(0,0,T,S),R.fillRect(T,S,T,S),x.fillStyle=x.createPattern(O,"repeat"),x.fillRect(0,0,m,v),x.drawImage(l,0,0,l.width,l.height,0,0,m,v)}let p=null;if(i){let m,v;if(a.symmetric&&l.width<t&&l.height<t)m=l.width,v=l.height;else if(l=this.#t,r>t||s>t){const b=Math.min(t/r,t/s);m=Math.floor(r*b),v=Math.floor(s*b),this.#c||(l=this.#g(m,v))}const _=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});_.drawImage(l,0,0,l.width,l.height,0,0,m,v),p={width:m,height:v,data:_.getImageData(0,0,m,v).data}}return{canvas:d,width:u,height:f,imageData:p}}#g(t,e){const{width:i,height:r}=this.#t;let s=i,a=r,l=this.#t;for(;s>2*t||a>2*e;){const u=s,f=a;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const d=new OffscreenCanvas(s,a);d.getContext("2d").drawImage(l,0,0,u,f,0,0,s,a),l=d.transferToImageBitmap()}return l}#m(){const[t,e]=this.parentDimensions,{width:i,height:r}=this,s=new ca,a=Math.ceil(i*t*s.sx),l=Math.ceil(r*e*s.sy),u=this.#l;if(!u||u.width===a&&u.height===l)return;u.width=a,u.height=l;const f=this.#c?this.#t:this.#g(a,l),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(f,0,0,f.width,f.height,0,0,a,l)}#v(t){if(t){if(this.#c){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,i]=this.pageDimensions,r=Math.round(this.width*e*Rc.PDF_TO_CSS_UNITS),s=Math.round(this.height*i*Rc.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,s);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,s),a.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let r=null,s=!1;if(t instanceof QC){const{data:{rect:_,rotation:b,id:E,structParent:T,popupRef:S},container:O,parent:{page:{pageNumber:R}},canvas:N}=t;let C,M;N?(delete t.canvas,{id:C,bitmap:M}=i.imageManager.getFromCanvas(O.id,N),N.remove()):(s=!0,t._hasNoCanvas=!0);const I=(await e._structTree.getAriaAttributes(`${ab}${E}`))?.get("aria-label")||"";r=t={annotationType:Be.STAMP,bitmapId:C,bitmap:M,pageIndex:R-1,rect:_.slice(0),rotation:b,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:T,popupRef:S}}const a=await super.deserialize(t,e,i),{rect:l,bitmap:u,bitmapUrl:f,bitmapId:d,isSvg:p,accessibilityData:m}=t;s?(i.addMissingCanvas(t.id,a),a.#o=!0):d&&i.imageManager.isValidId(d)?(a.#e=d,u&&(a.#t=u)):a.#i=f,a.#c=p;const[v,x]=a.pageDimensions;return a.width=(l[2]-l[0])/v,a.height=(l[3]-l[1])/x,a.annotationElementId=t.id||null,m&&(a.altTextData=m),a._initialData=r,a.#h=!!r,a}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Be.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=this.#v(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:s}=this.serializeAltText(!1);if(!r&&s&&(i.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const l=this.#_(i);if(l.isSame)return null;l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,e===null)return i;e.stamps||=new Map;const a=this.#c?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:a,serialized:i}),i.bitmap=this.#v(!1);else if(this.#c){const l=e.stamps.get(this.#e);a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=this.#v(!1))}return i}#_(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===e,s=(t.accessibilityData?.alt||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&s,isSameAltText:s}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class Ua{#t;#e=!1;#n=null;#i=null;#s=null;#r=new Map;#l=!1;#o=!1;#f=!1;#c=null;#h=null;#u=null;#d=null;#a;static _initialized=!1;static#p=new Map([yi,yb,EF,ti,Fa].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:r,accessibilityManager:s,annotationLayer:a,drawLayer:l,textLayer:u,viewport:f,l10n:d}){const p=[...Ua.#p.values()];if(!Ua._initialized){Ua._initialized=!0;for(const m of p)m.initialize(d,t)}t.registerEditorTypes(p),this.#a=t,this.pageIndex=e,this.div=i,this.#t=s,this.#n=a,this.viewport=f,this.#u=u,this.drawLayer=l,this._structTree=r,this.#a.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===Be.NONE}updateToolbar(t){this.#a.updateToolbar(t)}updateMode(t=this.#a.getMode()){switch(this.#x(),t){case Be.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Be.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Be.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of Ua.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#a.setEditingState(t)}addCommands(t){this.#a.addCommands(t)}cleanUndoStack(t){this.#a.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#f=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of this.#r.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#a.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#n){this.#f=!1;return}const e=this.#n.getEditableAnnotations();for(const i of e){if(i.hide(),this.#a.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}this.#f=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const r of this.#r.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#n){const r=this.#n.getEditableAnnotations();for(const s of r){const{id:a}=s.data;if(this.#a.isDeletedAnnotationElement(a))continue;let l=e.get(a);if(l){l.resetAnnotationElement(s),l.show(!1),s.show();continue}l=t.get(a),l&&(this.#a.addChangedExistingAnnotation(l),l.renderAnnotationElement(s)&&l.show(!1)),s.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of Ua.#p.values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#a.getActive()!==t&&this.#a.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#d){this.#d=new AbortController;const t=this.#a.combinedSignal(this.#d);this.#u.div.addEventListener("pointerdown",this.#g.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#u.div.classList.remove("highlighting"))}#g(t){this.#a.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:i}=Oi.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#a.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),ti.startHighlighting(this,this.#a.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#a.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#a.isDeletedAnnotationElement(e)&&this.#a.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#a.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#a.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#a.addDeletedAnnotationElement(t.annotationElementId),Se.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#a.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#f),this.#a.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return this.#a.getId()}get#m(){return Ua.#p.get(this.#a.getMode())}combinedSignal(t){return this.#a.combinedSignal(t)}#v(t){const e=this.#m;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#m?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#a.updateMode(t.mode);const{offsetX:i,offsetY:r}=this.#_(),s=this.getNextId(),a=this.#v({parent:this,id:s,x:i,y:r,uiManager:this.#a,isCentered:!0,...e});a&&this.add(a)}async deserialize(t){return await Ua.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#a)||null}createAndAddNewEditor(t,e,i={}){const r=this.getNextId(),s=this.#v({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#a,isCentered:e,...i});return s&&this.add(s),s}#_(){const{x:t,y:e,width:i,height:r}=this.div.getBoundingClientRect(),s=Math.max(0,t),a=Math.max(0,e),l=Math.min(window.innerWidth,t+i),u=Math.min(window.innerHeight,e+r),f=(s+l)/2-t,d=(a+u)/2-e,[p,m]=this.viewport.rotation%180===0?[f,d]:[d,f];return{offsetX:p,offsetY:m}}addNewEditor(t={}){this.createAndAddNewEditor(this.#_(),!0,t)}setSelected(t){this.#a.setSelected(t)}toggleSelected(t){this.#a.toggleSelected(t)}unselect(t){this.#a.unselect(t)}pointerup(t){const{isMac:e}=Oi.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#l||(this.#l=!1,this.#m?.isDrawer&&this.#m.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#a.getMode();if(i===Be.STAMP||i===Be.SIGNATURE){this.#a.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#a.getMode()===Be.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:e}=Oi.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#l=!0,this.#m?.isDrawer){this.startDrawingSession(t);return}const i=this.#a.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#m.startDrawing(this,this.#a,!1,t);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#h=null,this.commitOrRemove())},{signal:e}),this.#m.startDrawing(this,this.#a,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#h=e);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(t=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#h=null,this.#m.endDrawing(t)):null}findNewParent(t,e,i){const r=this.#a.findParent(e,i);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#m.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#a.removeLayer(this)}#x(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Nl(this.div,t);for(const e of this.#a.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#a.commitOrRemove(),this.#x();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Nl(this.div,{rotation:i}),e!==i)for(const r of this.#r.values())r.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#a.viewParameters.realScale}}class Ci{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Xe(this,"_svgFactory",new Id)}static#s(t,[e,i,r,s]){const{style:a}=t;a.top=`${100*i}%`,a.left=`${100*e}%`,a.width=`${100*r}%`,a.height=`${100*s}%`}#r(){const t=Ci._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#l(t,e){const i=Ci._svgFactory.createElement("clipPath");t.append(i);const r=`clip_${e}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const s=Ci._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),r}#o(t,e){for(const[i,r]of Object.entries(e))r===null?t.removeAttribute(i):t.setAttribute(i,r)}draw(t,e=!1,i=!1){const r=Ci.#i++,s=this.#r(),a=Ci._svgFactory.createElement("defs");s.append(a);const l=Ci._svgFactory.createElement("path");a.append(l);const u=`path_p${this.pageIndex}_${r}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(r,l);const f=i?this.#l(a,u):null,d=Ci._svgFactory.createElement("use");return s.append(d),d.setAttribute("href",`#${u}`),this.updateProperties(s,t),this.#e.set(r,s),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=Ci.#i++,r=this.#r(),s=Ci._svgFactory.createElement("defs");r.append(s);const a=Ci._svgFactory.createElement("path");s.append(a);const l=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let u;if(e){const p=Ci._svgFactory.createElement("mask");s.append(p),u=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",u),p.setAttribute("maskUnits","objectBoundingBox");const m=Ci._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const v=Ci._svgFactory.createElement("use");p.append(v),v.setAttribute("href",`#${l}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const f=Ci._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${l}`),u&&f.setAttribute("mask",`url(#${u})`);const d=f.cloneNode();return r.append(d),f.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(i,r),i}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:r,rootClass:s,path:a}=e,l=typeof t=="number"?this.#e.get(t):t;if(l){if(i&&this.#o(l,i),r&&Ci.#s(l,r),s){const{classList:u}=l;for(const[f,d]of Object.entries(s))u.toggle(f,d)}if(a){const f=l.firstChild.firstChild;this.#o(f,a)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:fx};globalThis.pdfjsLib={AbortException:Bo,AnnotationEditorLayer:Ua,AnnotationEditorParamsType:Ke,AnnotationEditorType:Be,AnnotationEditorUIManager:Uo,AnnotationLayer:bb,AnnotationMode:Ha,AnnotationType:Jn,build:WC,ColorPicker:rs,createValidAbsoluteUrl:ib,DOMSVGFactory:Id,DrawLayer:Ci,FeatureTest:Oi,fetchData:Sf,getDocument:mb,getFilenameFromUrl:AC,getPdfFilenameFromUrl:SC,getUuid:sb,getXfaPageViewport:TC,GlobalWorkerOptions:Sl,ImageKind:xd,InvalidPDFException:Qm,isDataScheme:ap,isPdfFile:Gg,isValidExplicitDest:RC,MathClamp:Ji,noContextMenu:js,normalizeUnicode:EC,OPS:Rd,OutputScale:ca,PasswordResponses:bC,PDFDataRangeTransport:vb,PDFDateString:ob,PDFWorker:df,PermissionFlag:xC,PixelsPerInch:Rc,RenderingCancelledException:$g,ResponseException:Nd,setLayerDimensions:Nl,shadow:Xe,SignatureExtractor:gc,stopEvent:ei,SupportedImageMimeTypes:Jm,TextLayer:kd,TouchManager:lp,updateUrlHash:rb,Util:be,VerbosityLevel:ip,version:VC,XfaLayer:_b};const wF=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Bo,AnnotationEditorLayer:Ua,AnnotationEditorParamsType:Ke,AnnotationEditorType:Be,AnnotationEditorUIManager:Uo,AnnotationLayer:bb,AnnotationMode:Ha,AnnotationType:Jn,ColorPicker:rs,DOMSVGFactory:Id,DrawLayer:Ci,FeatureTest:Oi,GlobalWorkerOptions:Sl,ImageKind:xd,InvalidPDFException:Qm,MathClamp:Ji,OPS:Rd,OutputScale:ca,PDFDataRangeTransport:vb,PDFDateString:ob,PDFWorker:df,PasswordResponses:bC,PermissionFlag:xC,PixelsPerInch:Rc,RenderingCancelledException:$g,ResponseException:Nd,SignatureExtractor:gc,SupportedImageMimeTypes:Jm,TextLayer:kd,TouchManager:lp,Util:be,VerbosityLevel:ip,XfaLayer:_b,build:WC,createValidAbsoluteUrl:ib,fetchData:Sf,getDocument:mb,getFilenameFromUrl:AC,getPdfFilenameFromUrl:SC,getUuid:sb,getXfaPageViewport:TC,isDataScheme:ap,isPdfFile:Gg,isValidExplicitDest:RC,noContextMenu:js,normalizeUnicode:EC,setLayerDimensions:Nl,shadow:Xe,stopEvent:ei,updateUrlHash:rb,version:VC},Symbol.toStringTag,{value:"Module"})),AF=["onCopy","onCut","onPaste"],SF=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],TF=["onFocus","onBlur"],CF=["onInput","onInvalid","onReset","onSubmit"],DF=["onLoad","onError"],OF=["onKeyDown","onKeyPress","onKeyUp"],RF=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],NF=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],kF=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],LF=["onSelect"],IF=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],MF=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],PF=["onScroll"],FF=["onWheel"],BF=["onAnimationStart","onAnimationEnd","onAnimationIteration"],UF=["onTransitionEnd"],zF=["onToggle"],jF=["onChange"],HF=[...AF,...SF,...TF,...CF,...DF,...OF,...RF,...NF,...kF,...LF,...IF,...MF,...PF,...FF,...BF,...UF,...jF,...zF];function nD(n,t){const e={};for(const i of HF){const r=n[i];r&&(t?e[i]=s=>r(s,t(i)):e[i]=r)}return e}function hp(n){let t=!1;return{promise:new Promise((i,r)=>{n.then(s=>!t&&i(s)).catch(s=>!t&&r(s))}),cancel(){t=!0}}}function iD(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(t=0;t<r;t++)n[t]&&(e=iD(n[t]))&&(i&&(i+=" "),i+=e)}else for(e in n)n[e]&&(i&&(i+=" "),i+=e);return i}function qg(){for(var n,t,e=0,i="",r=arguments.length;e<r;e++)(n=arguments[e])&&(t=iD(n))&&(i&&(i+=" "),i+=t);return i}var $F="Invariant failed";function An(n,t){if(!n)throw new Error($F)}var m_,i2;function GF(){if(i2)return m_;i2=1;var n=function(){};return m_=n,m_}var VF=GF();const ir=yf(VF);var r2=Object.prototype.hasOwnProperty;function s2(n,t,e){for(e of n.keys())if(Ku(e,t))return e}function Ku(n,t){var e,i,r;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((i=n.length)===t.length)for(;i--&&Ku(n[i],t[i]););return i===-1}if(e===Set){if(n.size!==t.size)return!1;for(i of n)if(r=i,r&&typeof r=="object"&&(r=s2(t,r),!r)||!t.has(r))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(i of n)if(r=i[0],r&&typeof r=="object"&&(r=s2(t,r),!r)||!Ku(i[1],t.get(r)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((i=n.byteLength)===t.byteLength)for(;i--&&n.getInt8(i)===t.getInt8(i););return i===-1}if(ArrayBuffer.isView(n)){if((i=n.byteLength)===t.byteLength)for(;i--&&n[i]===t[i];);return i===-1}if(!e||typeof n=="object"){i=0;for(e in n)if(r2.call(n,e)&&++i&&!r2.call(t,e)||!(e in t)||!Ku(n[e],t[e]))return!1;return Object.keys(t).length===i}}return n!==n&&t!==t}const rD=vt.createContext(null);function Zu({children:n,type:t}){return at.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:n})}const WF="noopener noreferrer nofollow";class qF{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return An(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){An(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{An(this.pdfDocument),An(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{An(Array.isArray(e));const i=e[0];new Promise(r=>{An(this.pdfDocument),i instanceof Object?this.pdfDocument.getPageIndex(i).then(s=>{r(s)}).catch(()=>{An(!1)}):typeof i=="number"?r(i):An(!1)}).then(r=>{const s=r+1;An(this.pdfViewer),An(s>=1&&s<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:r,pageNumber:s})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;An(this.pdfViewer),An(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,i){t.href=e,t.rel=this.externalLinkRel||WF,t.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const a2={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Yg=typeof window<"u",sD=Yg&&window.location.protocol==="file:";function YF(n){return typeof n<"u"}function hc(n){return YF(n)&&n!==null}function XF(n){return typeof n=="string"}function KF(n){return n instanceof ArrayBuffer}function ZF(n){return An(Yg),n instanceof Blob}function px(n){return XF(n)&&/^data:/.test(n)}function o2(n){An(px(n));const[t="",e=""]=n.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function QF(){return Yg&&window.devicePixelRatio||1}const aD="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function l2(){ir(!sD,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${aD}`)}function JF(){ir(!sD,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${aD}`)}function kc(n){n?.cancel&&n.cancel()}function mx(n,t){return Object.defineProperty(n,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function t6(n){return n.name==="RenderingCancelledException"}function e6(n){return new Promise((t,e)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return e(new Error("Error while reading a file."));t(i.result)},i.onerror=r=>{if(!r.target)return e(new Error("Error while reading a file."));const{error:s}=r.target;if(!s)return e(new Error("Error while reading a file."));switch(s.code){case s.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case s.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case s.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},i.readAsArrayBuffer(n)})}function n6(n,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function pf(){return vt.useReducer(n6,{value:void 0,error:void 0})}var c2=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const{PDFDataRangeTransport:i6}=wF,r6=(n,t)=>{switch(t){case a2.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");n(e);break}case a2.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");n(e);break}}};function u2(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const s6=vt.forwardRef(function(t,e){var{children:i,className:r,error:s="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:l,file:u,inputRef:f,imageResourcesPath:d,loading:p="Loading PDF…",noData:m="No PDF file specified.",onItemClick:v,onLoadError:x,onLoadProgress:_,onLoadSuccess:b,onPassword:E=r6,onSourceError:T,onSourceSuccess:S,options:O,renderMode:R,rotate:N,scale:C}=t,M=c2(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[I,F]=pf(),{value:z,error:P}=I,[tt,L]=pf(),{value:nt,error:Q}=tt,X=vt.useRef(new qF),Rt=vt.useRef([]),yt=vt.useRef(void 0),j=vt.useRef(void 0);u&&u!==yt.current&&u2(u)&&(ir(!Ku(u,yt.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),yt.current=u),O&&O!==j.current&&(ir(!Ku(O,j.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),j.current=O);const J=vt.useRef({scrollPageIntoView:D=>{const{dest:dt,pageNumber:st,pageIndex:Y=st-1}=D;if(v){v({dest:dt,pageIndex:Y,pageNumber:st});return}const q=Rt.current[Y];if(q){q.scrollIntoView();return}ir(!1,`An internal link leading to page ${st} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});vt.useImperativeHandle(e,()=>({linkService:X,pages:Rt,viewer:J}),[]);function G(){S&&S()}function ut(){P&&(ir(!1,P.toString()),T&&T(P))}function gt(){F({type:"RESET"})}vt.useEffect(gt,[u,F]);const _t=vt.useCallback(async()=>{if(!u)return null;if(typeof u=="string")return px(u)?{data:o2(u)}:(l2(),{url:u});if(u instanceof i6)return{range:u};if(KF(u))return{data:u};if(Yg&&ZF(u))return{data:await e6(u)};if(An(typeof u=="object"),An(u2(u)),"url"in u&&typeof u.url=="string"){if(px(u.url)){const{url:D}=u,dt=c2(u,["url"]),st=o2(D);return Object.assign({data:st},dt)}l2()}return u},[u]);vt.useEffect(()=>{const D=hp(_t());return D.promise.then(dt=>{F({type:"RESOLVE",value:dt})}).catch(dt=>{F({type:"REJECT",error:dt})}),()=>{kc(D)}},[_t,F]),vt.useEffect(()=>{if(!(typeof z>"u")){if(z===!1){ut();return}G()}},[z]);function Bt(){nt&&(b&&b(nt),Rt.current=new Array(nt.numPages),X.current.setDocument(nt))}function Gt(){Q&&(ir(!1,Q.toString()),x&&x(Q))}vt.useEffect(function(){L({type:"RESET"})},[L,z]),vt.useEffect(function(){if(!z)return;const dt=O?Object.assign(Object.assign({},z),O):z,st=mb(dt);_&&(st.onProgress=_),E&&(st.onPassword=E);const Y=st,q=Y.promise.then(ft=>{L({type:"RESOLVE",value:ft})}).catch(ft=>{Y.destroyed||L({type:"REJECT",error:ft})});return()=>{q.finally(()=>Y.destroy())}},[O,L,z]),vt.useEffect(()=>{if(!(typeof nt>"u")){if(nt===!1){Gt();return}Bt()}},[nt]),vt.useEffect(function(){X.current.setViewer(J.current),X.current.setExternalLinkRel(a),X.current.setExternalLinkTarget(l)},[a,l]);const H=vt.useCallback((D,dt)=>{Rt.current[D]=dt},[]),mt=vt.useCallback(D=>{delete Rt.current[D]},[]),lt=vt.useMemo(()=>({imageResourcesPath:d,linkService:X.current,onItemClick:v,pdf:nt,registerPage:H,renderMode:R,rotate:N,scale:C,unregisterPage:mt}),[d,v,nt,H,R,N,C,mt]),ct=vt.useMemo(()=>nD(M,()=>nt),[M,nt]);function Ct(){return at.jsx(rD.Provider,{value:lt,children:i})}function Lt(){return u?nt==null?at.jsx(Zu,{type:"loading",children:typeof p=="function"?p():p}):nt===!1?at.jsx(Zu,{type:"error",children:typeof s=="function"?s():s}):Ct():at.jsx(Zu,{type:"no-data",children:typeof m=="function"?m():m})}return at.jsx("div",Object.assign({className:qg("react-pdf__Document",r),ref:f},ct,{children:Lt()}))});function oD(){return vt.useContext(rD)}function lD(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n.filter(Boolean);if(e.length<=1){var i=e[0];return i||null}return function(s){for(var a=0,l=e;a<l.length;a++){var u=l[a];typeof u=="function"?u(s):u&&(u.current=s)}}}const cD=vt.createContext(null),uD={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},a6=/^H(\d+)$/;function o6(n){return n in uD}function Xg(n){return"children"in n}function fD(n){return Xg(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function l6(n){const t={};if(Xg(n)){const{role:e}=n,i=e.match(a6);if(i)t.role="heading",t["aria-level"]=Number(i[1]);else if(o6(e)){const r=uD[e];r&&(t.role=r)}}return t}function hD(n){const t={};if(Xg(n)){if(n.alt!==void 0&&(t["aria-label"]=n.alt),n.lang!==void 0&&(t.lang=n.lang),fD(n)){const[e]=n.children;if(e){const i=hD(e);return Object.assign(Object.assign({},t),i)}}}else"id"in n&&(t["aria-owns"]=n.id);return t}function c6(n){return n?Object.assign(Object.assign({},l6(n)),hD(n)):null}function dD({className:n,node:t}){const e=vt.useMemo(()=>c6(t),[t]),i=vt.useMemo(()=>!Xg(t)||fD(t)?null:t.children.map((r,s)=>at.jsx(dD,{node:r},s)),[t]);return at.jsx("span",Object.assign({className:n},e,{children:i}))}function Kg(){return vt.useContext(cD)}function u6(){const n=Kg();An(n);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=n,[i,r]=pf(),{value:s,error:a}=i,{customTextRenderer:l,page:u}=n;function f(){s&&e&&e(s)}function d(){a&&(ir(!1,a.toString()),t&&t(a))}return vt.useEffect(function(){r({type:"RESET"})},[r,u]),vt.useEffect(function(){if(l||!u)return;const m=hp(u.getStructTree()),v=m;return m.promise.then(x=>{r({type:"RESOLVE",value:x})}).catch(x=>{r({type:"REJECT",error:x})}),()=>kc(v)},[l,u,r]),vt.useEffect(()=>{if(s!==void 0){if(s===!1){d();return}f()}},[s]),s?at.jsx(dD,{className:"react-pdf__Page__structTree structTree",node:s}):null}const f2=Ha;function f6(n){const t=Kg();An(t);const e=Object.assign(Object.assign({},t),n),{_className:i,canvasBackground:r,devicePixelRatio:s=QF(),onRenderError:a,onRenderSuccess:l,page:u,renderForms:f,renderTextLayer:d,rotate:p,scale:m}=e,{canvasRef:v}=n;An(u);const x=vt.useRef(null);function _(){u&&l&&l(mx(u,m))}function b(O){t6(O)||(ir(!1,O.toString()),a&&a(O))}const E=vt.useMemo(()=>u.getViewport({scale:m*s,rotation:p}),[s,u,p,m]),T=vt.useMemo(()=>u.getViewport({scale:m,rotation:p}),[u,p,m]);vt.useEffect(function(){if(!u)return;u.cleanup();const{current:R}=x;if(!R)return;R.width=E.width,R.height=E.height,R.style.width=`${Math.floor(T.width)}px`,R.style.height=`${Math.floor(T.height)}px`,R.style.visibility="hidden";const N={annotationMode:f?f2.ENABLE_FORMS:f2.ENABLE,canvasContext:R.getContext("2d",{alpha:!1}),viewport:E};r&&(N.background=r);const C=u.render(N),M=C;return C.promise.then(()=>{R.style.visibility="",_()}).catch(b),()=>kc(M)},[r,u,f,E,T]);const S=vt.useCallback(()=>{const{current:O}=x;O&&(O.width=0,O.height=0)},[]);return vt.useEffect(()=>S,[S]),at.jsx("canvas",{className:`${i}__canvas`,dir:"ltr",ref:lD(v,x),style:{display:"block",userSelect:"none"},children:d?at.jsx(u6,{}):null})}function h6(n){return"str"in n}function d6(){const n=Kg();An(n);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:i,onRenderTextLayerError:r,onRenderTextLayerSuccess:s,page:a,pageIndex:l,pageNumber:u,rotate:f,scale:d}=n;An(a);const[p,m]=pf(),{value:v,error:x}=p,_=vt.useRef(null);ir(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function b(){v&&i&&i(v)}function E(){x&&(ir(!1,x.toString()),e&&e(x))}vt.useEffect(function(){m({type:"RESET"})},[a,m]),vt.useEffect(function(){if(!a)return;const M=hp(a.getTextContent()),I=M;return M.promise.then(F=>{m({type:"RESOLVE",value:F})}).catch(F=>{m({type:"REJECT",error:F})}),()=>kc(I)},[a,m]),vt.useEffect(()=>{if(v!==void 0){if(v===!1){E();return}b()}},[v]);const T=vt.useCallback(()=>{s&&s()},[s]),S=vt.useCallback(C=>{ir(!1,C.toString()),r&&r(C)},[r]);function O(){const C=_.current;C&&C.classList.add("selecting")}function R(){const C=_.current;C&&C.classList.remove("selecting")}const N=vt.useMemo(()=>a.getViewport({scale:d,rotation:f}),[a,f,d]);return vt.useLayoutEffect(function(){if(!a||!v)return;const{current:M}=_;if(!M)return;M.innerHTML="";const I=a.streamTextContent({includeMarkedContent:!0}),F={container:M,textContentSource:I,viewport:N},z=new kd(F),P=z;return z.render().then(()=>{const tt=document.createElement("div");tt.className="endOfContent",M.append(tt);const L=M.querySelectorAll('[role="presentation"]');if(t){let nt=0;v.items.forEach((Q,X)=>{if(!h6(Q))return;const Rt=L[nt];if(!Rt)return;const yt=t(Object.assign({pageIndex:l,pageNumber:u,itemIndex:X},Q));Rt.innerHTML=yt,nt+=Q.str&&Q.hasEOL?2:1})}T()}).catch(S),()=>kc(P)},[t,S,T,a,l,u,v,N]),at.jsx("div",{className:qg("react-pdf__Page__textContent","textLayer"),onMouseUp:R,onMouseDown:O,ref:_})}function p6(){const n=oD(),t=Kg();An(t);const e=Object.assign(Object.assign({},n),t),{imageResourcesPath:i,linkService:r,onGetAnnotationsError:s,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:u,page:f,pdf:d,renderForms:p,rotate:m,scale:v=1}=e;An(d),An(f),An(r);const[x,_]=pf(),{value:b,error:E}=x,T=vt.useRef(null);ir(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function S(){b&&a&&a(b)}function O(){E&&(ir(!1,E.toString()),s&&s(E))}vt.useEffect(function(){_({type:"RESET"})},[_,f]),vt.useEffect(function(){if(!f)return;const I=hp(f.getAnnotations()),F=I;return I.promise.then(z=>{_({type:"RESOLVE",value:z})}).catch(z=>{_({type:"REJECT",error:z})}),()=>{kc(F)}},[_,f]),vt.useEffect(()=>{if(b!==void 0){if(b===!1){O();return}S()}},[b]);function R(){u&&u()}function N(M){ir(!1,`${M}`),l&&l(M)}const C=vt.useMemo(()=>f.getViewport({scale:v,rotation:m}),[f,m,v]);return vt.useEffect(function(){if(!d||!f||!r||!b)return;const{current:I}=T;if(!I)return;const F=C.clone({dontFlip:!0}),z={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:I,l10n:null,page:f,structTreeLayer:null,viewport:F},P={annotations:b,annotationStorage:d.annotationStorage,div:I,imageResourcesPath:i,linkService:r,page:f,renderForms:p,viewport:F};I.innerHTML="";try{new bb(z).render(P),R()}catch(tt){N(tt)}return()=>{}},[b,i,r,f,d,p,C]),at.jsx("div",{className:qg("react-pdf__Page__annotations","annotationLayer"),ref:T})}var m6=function(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e};const h2=1;function g6(n){const t=oD(),e=Object.assign(Object.assign({},t),n),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:r=!0,canvasBackground:s,canvasRef:a,children:l,className:u,customRenderer:f,customTextRenderer:d,devicePixelRatio:p,error:m="Failed to load the page.",height:v,inputRef:x,loading:_="Loading page…",noData:b="No page specified.",onGetAnnotationsError:E,onGetAnnotationsSuccess:T,onGetStructTreeError:S,onGetStructTreeSuccess:O,onGetTextError:R,onGetTextSuccess:N,onLoadError:C,onLoadSuccess:M,onRenderAnnotationLayerError:I,onRenderAnnotationLayerSuccess:F,onRenderError:z,onRenderSuccess:P,onRenderTextLayerError:tt,onRenderTextLayerSuccess:L,pageIndex:nt,pageNumber:Q,pdf:X,registerPage:Rt,renderAnnotationLayer:yt=!0,renderForms:j=!1,renderMode:J="canvas",renderTextLayer:G=!0,rotate:ut,scale:gt=h2,unregisterPage:_t,width:Bt}=e,Gt=m6(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[H,mt]=pf(),{value:lt,error:ct}=H,Ct=vt.useRef(null);An(X);const Lt=hc(Q)?Q-1:nt??null,D=Q??(hc(nt)?nt+1:null),dt=ut??(lt?lt.rotate:null),st=vt.useMemo(()=>{if(!lt)return null;let ae=1;const ne=gt??h2;if(Bt||v){const Re=lt.getViewport({scale:1,rotation:dt});Bt?ae=Bt/Re.width:v&&(ae=v/Re.height)}return ne*ae},[v,lt,dt,gt,Bt]);vt.useEffect(function(){return()=>{hc(Lt)&&r&&_t&&_t(Lt)}},[r,X,Lt,_t]);function Y(){if(M){if(!lt||!st)return;M(mx(lt,st))}if(r&&Rt){if(!hc(Lt)||!Ct.current)return;Rt(Lt,Ct.current)}}function q(){ct&&(ir(!1,ct.toString()),C&&C(ct))}vt.useEffect(function(){mt({type:"RESET"})},[mt,X,Lt]),vt.useEffect(function(){if(!X||!D)return;const ne=hp(X.getPage(D)),Re=ne;return ne.promise.then(rn=>{mt({type:"RESOLVE",value:rn})}).catch(rn=>{mt({type:"REJECT",error:rn})}),()=>kc(Re)},[mt,X,D]),vt.useEffect(()=>{if(lt!==void 0){if(lt===!1){q();return}Y()}},[lt,st]);const ft=vt.useMemo(()=>lt&&hc(Lt)&&D&&hc(dt)&&hc(st)?{_className:i,canvasBackground:s,customTextRenderer:d,devicePixelRatio:p,onGetAnnotationsError:E,onGetAnnotationsSuccess:T,onGetStructTreeError:S,onGetStructTreeSuccess:O,onGetTextError:R,onGetTextSuccess:N,onRenderAnnotationLayerError:I,onRenderAnnotationLayerSuccess:F,onRenderError:z,onRenderSuccess:P,onRenderTextLayerError:tt,onRenderTextLayerSuccess:L,page:lt,pageIndex:Lt,pageNumber:D,renderForms:j,renderTextLayer:G,rotate:dt,scale:st}:null,[i,s,d,p,E,T,S,O,R,N,I,F,z,P,tt,L,lt,Lt,D,j,G,dt,st]),Pt=vt.useMemo(()=>nD(Gt,()=>lt&&(st?mx(lt,st):void 0)),[Gt,lt,st]),jt=`${Lt}@${st}/${dt}`;function wt(){switch(J){case"custom":return An(f),at.jsx(f,{},`${jt}_custom`);case"none":return null;case"canvas":default:return at.jsx(f6,{canvasRef:a},`${jt}_canvas`)}}function Nt(){return G?at.jsx(d6,{},`${jt}_text`):null}function At(){return yt?at.jsx(p6,{},`${jt}_annotations`):null}function pt(){return at.jsxs(cD.Provider,{value:ft,children:[wt(),Nt(),At(),l]})}function te(){return D?X===null||lt===void 0||lt===null?at.jsx(Zu,{type:"loading",children:typeof _=="function"?_():_}):X===!1||lt===!1?at.jsx(Zu,{type:"error",children:typeof m=="function"?m():m}):pt():at.jsx(Zu,{type:"no-data",children:typeof b=="function"?b():b})}return at.jsx("div",Object.assign({className:qg(i,u),"data-page-number":D,ref:lD(x,Ct),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${st}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Pt,{children:te()}))}JF();Sl.workerSrc="pdf.worker.mjs";const fm=3,hm=(n,t,e,i)=>({x:n.x*e/t,width:n.width*e/t,y:i.height-n.y*e/t-n.height*e/t,height:n.height*e/t}),dm=(n,t)=>n.items.filter(e=>{const i=e.transform[4],r=e.transform[5],s=e.transform[4]+e.width,a=e.transform[5]+e.height;return i>=t.x-fm&&s<=t.x+t.width+fm&&r>=t.y-fm&&a<=t.y+t.height+fm}),d2=n=>{const t=n.filter(l=>{const u=l.str.trim();return/^(P|\d+)(\/\d+)?(\*+)?$|^-$/.test(u)});if(t.length===0)return[];const e=t.filter(l=>Ab(l.str.trim()));if(e.length<2)return t.map(l=>l.str.trim());const i=[];for(let l=0;l+1<e.length;l++)i.push(Math.abs(e[l].transform[5]-e[l+1].transform[5]));i.sort((l,u)=>l-u);const r=e.length<4?e[0].height*1.2:i[i.length-1]-i[0]<=i[0]*1.2?0:i[0]*1.1,s=[],a=[];return t.forEach((l,u)=>{if(a.length>0){a.push(l.str.trim()),s.push(a.join("/")),a.length=0;return}if(l.str.trim()==="-"){s.push(l.str.trim());return}if(u+1<t.length&&Math.abs(l.transform[5]-t[u+1].transform[5])<=r){a.push(l.str.trim());return}s.push(l.str.trim())}),a.length>0&&s.push(a.join("/")),s},pm=(n,t)=>{const e=Array(),i=Array();let r=!1;return n.sort((s,a)=>{const l=a.transform[5]-s.transform[5],f=(s.height+a.height)/2*.5;return Math.abs(l)<=f?s.transform[4]-a.transform[4]:l}),n.forEach((s,a)=>{if(s.str.trim()=="")return;const l=s.height*1.5;if(r){e.push(s.str.trim());const u=e.join("/");i.push(u),e.length=0,r=!1;return}if(a<n.length-1){const u={x:s.transform[4]+s.width/5,y:s.transform[5]-s.height/2,width:s.width*.6,height:Math.min(Math.abs(s.transform[5]-n[a+1].transform[5]),s.height/2)},f={x:s.transform[4]+s.width/5,width:s.width*(3/5),y:s.transform[5]-s.height,height:s.height};if(Math.abs(s.transform[5]-n[a+1].transform[5])<=l&&!p2(u,t))e.push(s.str.trim());else if(p2(f,t,!0)&&Ab(s.str.trim())&&v6(n,a)&&Math.abs(s.transform[5]-n[a+1].transform[5])<=l&&e.length<1)e.push(s.str.trim()),r=!0;else if(e.length>0){e.push(s.str.trim());const d=e.join(" ");i.push(d),e.length=0}else i.push(s.str.trim())}else{e.push(s.str.trim());const u=e.join(" ");i.push(u),e.length=0}}),e.length>0&&i.push(e.join(" ")),i},g_=(n,t,e)=>Math.max(Math.min(n,e),t),p2=(n,t,e=!1)=>{const i=n.x,r=n.x+n.width,s=n.y,a=n.y+n.height;return t.some(l=>l.x1<=r&&l.x2>=i&&l.y>=s&&l.y<=a&&(Math.abs(l.x2-l.x1)<=15||!e))},Ab=n=>/^\d+(\.\d+)?$/.test(n.trim()),v6=(n,t)=>{for(let e=t+1;e<n.length;e++){const i=n[e].str.trim();if(i.trim())return Ab(i)}return!1},oa=(n,t=0)=>{if(!n)return t;const e=n.trim().replaceAll(".","").replace(",","."),i=parseFloat(e);return isNaN(i)?t:i},Tf=n=>{const t=new Map;return n.forEach(e=>{e.dataType&&t.set(e.dataType,e.name)}),t},Gr=(n,t,e)=>{const i=t.get(e);return!i||!n[i]?e==="z"?"0":"":n[i][0]},No=(n,t,e)=>{const i=t.get(e);return!i||!n[i]?[]:n[i]},Zg=(n,t)=>{const e=t.get("depth");if(e&&n[e])return oa(n[e][0]);const i=t.get("depth_from_to");if(i&&n[i]){const r=n[i];return Math.max(...r.map(s=>oa(s)))}return 0},_6=({areas:n,zoomScale:t,activeAreaId:e})=>at.jsx(at.Fragment,{children:n.map(i=>!i.coordinates||i.id===e?null:at.jsx("div",{className:"position-absolute border",style:{left:i.coordinates.x*t,top:i.coordinates.y*t,width:i.coordinates.width*t,height:i.coordinates.height*t,backgroundColor:`${i.color}20`,borderColor:i.color,borderWidth:"2px",zIndex:10},title:i.name},`selected-${i.id}`))});/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),b6=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase()),m2=n=>{const t=b6(n);return t.charAt(0).toUpperCase()+t.slice(1)},pD=(...n)=>n.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim(),y6=n=>{for(const t in n)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var E6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=vt.forwardRef(({color:n="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:r="",children:s,iconNode:a,...l},u)=>vt.createElement("svg",{ref:u,...E6,width:t,height:t,stroke:n,strokeWidth:i?Number(e)*24/Number(t):e,className:pD("lucide",r),...!s&&!y6(l)&&{"aria-hidden":"true"},...l},[...a.map(([f,d])=>vt.createElement(f,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=(n,t)=>{const e=vt.forwardRef(({className:i,...r},s)=>vt.createElement(w6,{ref:s,iconNode:t,className:pD(`lucide-${x6(m2(n))}`,`lucide-${n}`,i),...r}));return e.displayName=m2(n),e};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A6=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],S6=lr("check",A6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],C6=lr("chevron-left",T6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],O6=lr("chevron-right",D6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],N6=lr("circle-question-mark",R6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k6=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],yd=lr("download",k6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L6=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],I6=lr("eraser",L6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],P6=lr("folder",M6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F6=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],B6=lr("play",F6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],z6=lr("plus",U6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],H6=lr("save",j6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $6=[["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 14v1",key:"169vum"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M7 16h6",key:"1vyc9m"}],["path",{d:"M7 8h8",key:"1jbsf9"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M9 3h1",key:"1yesri"}]],G6=lr("text-select",$6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],W6=lr("trash-2",V6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Y6=lr("trash",q6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Sb=lr("x",X6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Z6=lr("zoom-in",K6);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],J6=lr("zoom-out",Q6);Sl.workerSrc=new URL("/extrator-dados-PDF/assets/pdf.worker.min-BFAMBS4k.mjs",import.meta.url).toString();const v_=.5,__=3,t5=vt.forwardRef(({file:n,isSelectingActive:t,activeAreaId:e,onFinishSelection:i,areas:r},s)=>{const a=vt.useRef(null),[l,u]=vt.useState(),[f,d]=vt.useState(1),[p,m]=vt.useState(!1),[v,x]=vt.useState(f),[_,b]=vt.useState(!1),[E,T]=vt.useState(null),[S,O]=vt.useState(null),R=vt.useRef(null),N=vt.useRef(null),[C,M]=vt.useState(1),[I,F]=vt.useState(null),z=()=>{M(Lt=>Math.min(Lt+.25,__)),Ct(0,0)},P=()=>{Ct(0,0),M(Lt=>Math.max(Lt-.25,v_))},[tt,L]=vt.useState({x:0,y:0}),[nt,Q]=vt.useState(null),[X,Rt]=vt.useState(!1);function yt(Lt){d(D=>D+Lt)}function j(){yt(-1)}function J(){yt(1)}const G=()=>{x(f),m(!0)},ut=()=>{v>=1&&v<=(l||1)&&d(v),m(!1)},gt=()=>{x(f),m(!1)},_t=Lt=>{Lt.key==="Enter"&&ut(),Lt.key==="Escape"&&gt()};vt.useEffect(()=>{p&&R.current&&(R.current.focus(),R.current.select())},[p]);const Bt=Lt=>{if(N.current){if(_&&S&&S.x>=10&&S.y>=10)b(!1),O(null),i(S);else if(!_){const D=N.current.getBoundingClientRect(),dt=(Lt.clientX-D.left)/C,st=(Lt.clientY-D.top)/C;T({x:dt,y:st}),b(!0),O(null)}}},Gt=Lt=>{if(!N.current)return;const D=N.current.getBoundingClientRect();Q({x:Lt.clientX-D.left,y:Lt.clientY-D.top}),Rt(!0)},H=vt.useCallback(Lt=>{N.current&&(Lt.currentTarget.setPointerCapture(Lt.pointerId),t?Bt(Lt):Gt(Lt))},[_,S,C,t]),mt=vt.useCallback(Lt=>{if(!N.current)return;const D=N.current.getBoundingClientRect();if(X){if(X&&nt){const q=Lt.clientX-D.left-nt.x,ft=Lt.clientY-D.top-nt.y;Ct(q,ft)}return}if(!_||!E)return;const dt=(Lt.clientX-D.left)/C,st=(Lt.clientY-D.top)/C,Y={x:Math.min(E.x,dt),y:Math.min(E.y,st),width:Math.abs(E.x-dt),height:Math.abs(E.y-st)};O(Y)},[_,E,X,nt]),lt=vt.useCallback(Lt=>{Lt.currentTarget.releasePointerCapture(Lt.pointerId),X&&Rt(!1)},[X,Gt]);vt.useEffect(()=>{t||ct()},[t]);const ct=()=>{b(!1),O(null),T(null)},Ct=vt.useCallback((Lt,D)=>{const dt=document.querySelector(".pdf-container"),st=dt?.getBoundingClientRect().width||600,Y=dt?parseInt(getComputedStyle(dt).height):800,q=N.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().width||st,ft=N.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().height||Y,Pt=document.querySelector(".pdf-nav")?.getBoundingClientRect().height||40,jt=q>=st,wt=ft>=Y-Pt,Nt=Math.max(0,q-st),At=Math.max(0,ft-Y+Pt);L(pt=>({x:jt?g_(pt.x+Lt,-Nt,0):0,y:wt?g_(pt.y+D,-At,0):0}))},[]);return vt.useEffect(()=>{if(!n)return;const Lt=document.querySelector(".pdf-container");if(!Lt)return;const D=dt=>{dt.preventDefault();const st=Lt.getBoundingClientRect(),Y=(dt.clientX-st.left)/st.width,q=(dt.clientY-st.top)/st.height,ft=.1;M(Pt=>{const jt=dt.deltaY>0?-ft:ft,wt=g_(Pt+jt,v_,__),Nt=N.current?.querySelector(".react-pdf__Page"),At=Nt?.getBoundingClientRect().width||0,pt=Nt?.getBoundingClientRect().height||0,te=wt-Pt,ae=At*te,ne=pt*te,Re=ae*Y,rn=ne*q;return F({x:-Re,y:-rn}),wt})};return Lt.addEventListener("wheel",D,{passive:!1}),()=>{Lt.removeEventListener("wheel",D)}},[n,C]),vt.useEffect(()=>{I&&(Ct(I.x,I.y),F(null))},[C]),vt.useImperativeHandle(s,()=>({getDocument:()=>a.current})),n?at.jsx(at.Fragment,{children:at.jsxs("div",{className:"pdf-container",style:{height:"min(800px, 90vh)",overflow:"hidden",position:"relative",border:"2px solid black",marginTop:"30px",marginBottom:"15px"},children:[at.jsxs("div",{ref:N,className:`position-relative d-inline-block ${t?"pdf-cursor-crosshair":X?"pdf-cursor-grabbing":"pdf-cursor-grab"}`,onPointerDown:H,onPointerMove:mt,onPointerUp:lt,style:{userSelect:"none",transform:`translate(${tt.x}px, ${tt.y}px)`},children:[at.jsx(s6,{file:n,onLoadSuccess:Lt=>{u(Lt.numPages),d(1),M(1),a.current=Lt},children:at.jsx(g6,{pageNumber:f,renderTextLayer:!1,renderAnnotationLayer:!1,scale:C})}),at.jsx(_6,{areas:r,zoomScale:C,activeAreaId:e}),S&&at.jsx("div",{className:"position-absolute border border-secondary",style:{left:S.x*C,top:S.y*C,width:S.width*C,height:S.height*C,backgroundColor:"rgba(134, 142, 135, 0.2)",zIndex:10}})]}),at.jsxs("div",{className:"pdf-nav position-absolute bottom-0 start-0 end-0 d-flex align-items-center",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",padding:"4px 12px"},children:[at.jsx("div",{className:"flex-grow-1 d-flex justify-content-center",children:p?at.jsxs("div",{className:"d-flex align-items-center gap-1",children:[at.jsx("input",{ref:R,type:"number",className:"form-control form-control-sm text-center",style:{width:"40px",fontSize:"12px",backgroundColor:"rgba(108, 108, 108, 0.8)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"2px",color:"white"},value:v,min:1,max:l||1,onChange:Lt=>x(parseInt(Lt.target.value)||1),onKeyDown:_t,onBlur:gt,autoFocus:!0}),at.jsxs("span",{className:"text-white small",children:["de ",l||1]})]}):at.jsxs("span",{onClick:G,className:"text-white small",title:"Selecionar página",style:{cursor:"pointer"},children:["Página ",f||1," ",l&&`de ${l}`]})}),at.jsxs("div",{className:"d-flex gap-1",children:[at.jsx("button",{className:"pdf-nav-button",title:"Página anterior",onClick:j,disabled:f<=1,children:at.jsx(C6,{size:24,color:"#d0d0d0"})}),at.jsx("button",{className:"pdf-nav-button",title:"Próxima página",onClick:J,disabled:f>=(l??0),children:at.jsx(O6,{size:24,color:"#d0d0d0"})}),at.jsx("button",{className:"pdf-nav-button",onClick:P,disabled:C<=v_,children:at.jsx(J6,{size:24,color:"#d0d0d0"})}),at.jsx("button",{className:"pdf-nav-button",onClick:z,disabled:C>=__,children:at.jsx(Z6,{size:24,color:"#d0d0d0"})})]})]})]})}):at.jsx(at.Fragment,{children:at.jsx("div",{className:"row",children:at.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",style:{minHeight:"50vh"},children:at.jsx("p",{className:"text-muted",children:"Carregue um pdf para ser exibido aqui"})})})})}),e5=["default","hole_id","x","y","z","depth","date","depth_from_to","water_level","geology","nspt","campaign","interp","generic_info"],Lc={default:"Padrão",hole_id:"ID da Sondagem",x:"Coordenada X",y:"Coordenada Y",z:"Cota",depth:"Profundidade Total",date:"Data",depth_from_to:"Profundidades",water_level:"Nível d'Água",geology:"Descrição Geológica",nspt:"NSPT",campaign:"Campanha",interp:"Interpretação Geológica",generic_info:"Outras Informações"},mD=["hole_id","x","y","z","depth","date","water_level","campaign"],gD=["hole_id"],n5=["hole_id","x","y","z","depth"],x_=["hole_id","x","y","z","depth","depth_from_to","geology","nspt","water_level","interp"],mm=["collar","nspt","na","geology","interp"],i5={collar:"Collar",nspt:"NSPT",na:"NA",geology:"Geologia",interp:"Interpretação"},r5={collar:["hole_id","x","y"],nspt:["hole_id","nspt"],na:["hole_id","water_level"],geology:["hole_id","geology","depth_from_to"],interp:["hole_id","interp","depth_from_to"]},s5=({hasFile:n,area:t,areas:e,onStartSelection:i,onClearArea:r,onDeleteArea:s,onRenameArea:a,onToggleMandatory:l,onToggleRepeat:u,onChangeAreaType:f})=>{const[d,p]=vt.useState(!1),[m,v]=vt.useState(t.name),x=vt.useRef(null);vt.useEffect(()=>{const N=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));return N.forEach(C=>new zs(C)),()=>{N.forEach(C=>{const M=zs.getInstance(C);M&&M.dispose()})}},[t]),vt.useEffect(()=>{d&&x.current&&(x.current.focus(),x.current.select())},[d]);const _=()=>{i(t.id)},b=()=>{s(t.id)},E=()=>{r(t.id)},T=()=>{v(t.name),p(!0)},S=N=>{N.key==="Enter"&&O(),N.key==="Escape"&&R()},O=()=>{m.trim()&&m.trim()!==t.name?(a(t.id,m.trim()),p(!1)):R()},R=()=>{v(t.name),p(!1)};return at.jsx(at.Fragment,{children:at.jsxs("div",{className:"border rounded mb-1",children:[at.jsxs("div",{className:"d-flex align-items-center gap-1 pt-2 px-2 pb-1",children:[at.jsx("div",{className:"drag-handle",style:{cursor:"grab"},children:"⋮⋮"}),at.jsx("div",{className:"d-flex align-items-center",children:at.jsxs("span",{className:"badge me-2",style:{backgroundColor:t.color,color:"white"},children:["#",t.order]})}),d?at.jsxs("div",{className:"d-flex align-items-center flex-grow-1",children:[at.jsx("input",{ref:x,type:"text",className:"form-control form-control-sm me-2",value:m,onChange:N=>v(N.target.value),onKeyDown:S,onBlur:O}),at.jsxs("div",{className:"d-flex gap-2",children:[at.jsx("button",{className:"menu-btn menu-btn-cta",title:"Confirmar",onClick:O,children:at.jsx(S6,{size:16})}),at.jsx("button",{className:"menu-btn menu-btn-warning",title:"Cancelar",onClick:R,children:at.jsx(Sb,{size:16})})]})]}):at.jsxs(at.Fragment,{children:[at.jsx("div",{className:"flex-grow-1 text-start area-name-section",style:{minWidth:0},children:at.jsx("span",{onClick:T,style:{width:"calc(100% - 10px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},title:t.name,children:t.name})}),at.jsx("button",{className:"menu-btn menu-btn-cta",disabled:!n,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Selecionar área",onClick:_,children:at.jsx(G6,{size:16})}),t.coordinates&&at.jsx("button",{className:"menu-btn menu-btn-alert",onClick:E,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Limpar seleção",children:at.jsx(I6,{size:16})}),at.jsx("button",{className:"menu-btn menu-btn-warning area-delete",onClick:b,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Excluir área",children:at.jsx(Y6,{size:14})})]})]}),at.jsxs("div",{className:"d-flex align-items-center gap-2 px-2 pb-2 justify-content-between",children:[at.jsx("div",{className:"flex-grow-1 me-2",children:at.jsxs("select",{className:"form-select form-select-sm w-100",value:t.dataType||"",onChange:N=>f(t.id,N.target.value),children:[at.jsx("option",{value:"default",children:"Tipo padrão"}),e5.filter(N=>N!=="default"&&(!n5.includes(N)||!e.find(C=>C.dataType===N&&C.id!==t.id))).map(N=>at.jsx("option",{value:N,children:Lc[N]},N))]})}),at.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Pular páginas sem texto nesta área",children:[at.jsx("input",{className:"form-check-input",type:"checkbox",id:`mandatory-${t.id}`,checked:t.isMandatory,onChange:N=>l(t.id,N.target.checked)}),at.jsx("label",{className:"form-check-label small",children:"Obrigatório"})]}),at.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":e.find(N=>N.dataType==="hole_id")?"Usar um único valor por sondagem":"Adicione uma área como ID da Sondagem para utilizar essa opção",children:[at.jsx("input",{className:"form-check-input",type:"checkbox",id:`repeat-${t.id}`,checked:t.repeatInPages,onChange:N=>u(t.id,N.target.checked),disabled:!e.find(N=>N.dataType==="hole_id")}),at.jsx("label",{className:"form-check-label small",children:"Único"})]})]})]})})};var b_={exports:{}},y_,g2;function a5(){if(g2)return y_;g2=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return y_=n,y_}var E_,v2;function o5(){if(v2)return E_;v2=1;var n=a5();function t(){}function e(){}return e.resetWarningCache=t,E_=function(){function i(a,l,u,f,d,p){if(p!==n){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}i.isRequired=i;function r(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:r,element:i,elementType:i,instanceOf:r,node:i,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:e,resetWarningCache:t};return s.PropTypes=s,s},E_}var _2;function l5(){return _2||(_2=1,b_.exports=o5()()),b_.exports}var c5=l5();const On=yf(c5);function Vc(n,t,e,i){function r(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function l(d){try{f(i.next(d))}catch(p){a(p)}}function u(d){try{f(i.throw(d))}catch(p){a(p)}}function f(d){d.done?s(d.value):r(d.value).then(l,u)}f((i=i.apply(n,t||[])).next())})}const u5=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function mf(n,t,e){const i=f5(n),{webkitRelativePath:r}=n,s=typeof t=="string"?t:typeof r=="string"&&r.length>0?r:`./${n.name}`;return typeof i.path!="string"&&x2(i,"path",s),x2(i,"relativePath",s),i}function f5(n){const{name:t}=n;if(t&&t.lastIndexOf(".")!==-1&&!n.type){const i=t.split(".").pop().toLowerCase(),r=u5.get(i);r&&Object.defineProperty(n,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return n}function x2(n,t,e){Object.defineProperty(n,t,{value:e,writable:!1,configurable:!1,enumerable:!0})}const h5=[".DS_Store","Thumbs.db"];function d5(n){return Vc(this,void 0,void 0,function*(){return tg(n)&&p5(n.dataTransfer)?_5(n.dataTransfer,n.type):m5(n)?g5(n):Array.isArray(n)&&n.every(t=>"getFile"in t&&typeof t.getFile=="function")?v5(n):[]})}function p5(n){return tg(n)}function m5(n){return tg(n)&&tg(n.target)}function tg(n){return typeof n=="object"&&n!==null}function g5(n){return gx(n.target.files).map(t=>mf(t))}function v5(n){return Vc(this,void 0,void 0,function*(){return(yield Promise.all(n.map(e=>e.getFile()))).map(e=>mf(e))})}function _5(n,t){return Vc(this,void 0,void 0,function*(){if(n.items){const e=gx(n.items).filter(r=>r.kind==="file");if(t!=="drop")return e;const i=yield Promise.all(e.map(x5));return b2(vD(i))}return b2(gx(n.files).map(e=>mf(e)))})}function b2(n){return n.filter(t=>h5.indexOf(t.name)===-1)}function gx(n){if(n===null)return[];const t=[];for(let e=0;e<n.length;e++){const i=n[e];t.push(i)}return t}function x5(n){if(typeof n.webkitGetAsEntry!="function")return y2(n);const t=n.webkitGetAsEntry();return t&&t.isDirectory?_D(t):y2(n,t)}function vD(n){return n.reduce((t,e)=>[...t,...Array.isArray(e)?vD(e):[e]],[])}function y2(n,t){return Vc(this,void 0,void 0,function*(){var e;if(globalThis.isSecureContext&&typeof n.getAsFileSystemHandle=="function"){const s=yield n.getAsFileSystemHandle();if(s===null)throw new Error(`${n} is not a File`);if(s!==void 0){const a=yield s.getFile();return a.handle=s,mf(a)}}const i=n.getAsFile();if(!i)throw new Error(`${n} is not a File`);return mf(i,(e=t?.fullPath)!==null&&e!==void 0?e:void 0)})}function b5(n){return Vc(this,void 0,void 0,function*(){return n.isDirectory?_D(n):y5(n)})}function _D(n){const t=n.createReader();return new Promise((e,i)=>{const r=[];function s(){t.readEntries(a=>Vc(this,void 0,void 0,function*(){if(a.length){const l=Promise.all(a.map(b5));r.push(l),s()}else try{const l=yield Promise.all(r);e(l)}catch(l){i(l)}}),a=>{i(a)})}s()})}function y5(n){return Vc(this,void 0,void 0,function*(){return new Promise((t,e)=>{n.file(i=>{const r=mf(i,n.fullPath);t(r)},i=>{e(i)})})})}var gm={},E2;function E5(){return E2||(E2=1,gm.__esModule=!0,gm.default=function(n,t){if(n&&t){var e=Array.isArray(t)?t:t.split(",");if(e.length===0)return!0;var i=n.name||"",r=(n.type||"").toLowerCase(),s=r.replace(/\/.*$/,"");return e.some(function(a){var l=a.trim().toLowerCase();return l.charAt(0)==="."?i.toLowerCase().endsWith(l):l.endsWith("/*")?s===l.replace(/\/.*$/,""):r===l})}return!0}),gm}var w5=E5();const w_=yf(w5);function w2(n){return T5(n)||S5(n)||bD(n)||A5()}function A5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S5(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function T5(n){if(Array.isArray(n))return vx(n)}function A2(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),e.push.apply(e,i)}return e}function S2(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?A2(Object(e),!0).forEach(function(i){xD(n,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):A2(Object(e)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(e,i))})}return n}function xD(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function Md(n,t){return O5(n)||D5(n,t)||bD(n,t)||C5()}function C5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bD(n,t){if(n){if(typeof n=="string")return vx(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return vx(n,t)}}function vx(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,i=new Array(t);e<t;e++)i[e]=n[e];return i}function D5(n,t){var e=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(e!=null){var i=[],r=!0,s=!1,a,l;try{for(e=e.call(n);!(r=(a=e.next()).done)&&(i.push(a.value),!(t&&i.length===t));r=!0);}catch(u){s=!0,l=u}finally{try{!r&&e.return!=null&&e.return()}finally{if(s)throw l}}return i}}function O5(n){if(Array.isArray(n))return n}var R5=typeof w_=="function"?w_:w_.default,N5="file-invalid-type",k5="file-too-large",L5="file-too-small",I5="too-many-files",M5=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=t.split(","),i=e.length>1?"one of ".concat(e.join(", ")):e[0];return{code:N5,message:"File type must be ".concat(i)}},T2=function(t){return{code:k5,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},C2=function(t){return{code:L5,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},P5={code:I5,message:"Too many files"};function yD(n,t){var e=n.type==="application/x-moz-file"||R5(n,t);return[e,e?null:M5(t)]}function ED(n,t,e){if(vc(n.size))if(vc(t)&&vc(e)){if(n.size>e)return[!1,T2(e)];if(n.size<t)return[!1,C2(t)]}else{if(vc(t)&&n.size<t)return[!1,C2(t)];if(vc(e)&&n.size>e)return[!1,T2(e)]}return[!0,null]}function vc(n){return n!=null}function F5(n){var t=n.files,e=n.accept,i=n.minSize,r=n.maxSize,s=n.multiple,a=n.maxFiles,l=n.validator;return!s&&t.length>1||s&&a>=1&&t.length>a?!1:t.every(function(u){var f=yD(u,e),d=Md(f,1),p=d[0],m=ED(u,i,r),v=Md(m,1),x=v[0],_=l?l(u):null;return p&&x&&!_})}function eg(n){return typeof n.isPropagationStopped=="function"?n.isPropagationStopped():typeof n.cancelBubble<"u"?n.cancelBubble:!1}function vm(n){return n.dataTransfer?Array.prototype.some.call(n.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!n.target&&!!n.target.files}function D2(n){n.preventDefault()}function B5(n){return n.indexOf("MSIE")!==-1||n.indexOf("Trident/")!==-1}function U5(n){return n.indexOf("Edge/")!==-1}function z5(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return B5(n)||U5(n)}function Ia(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return t.some(function(l){return!eg(i)&&l&&l.apply(void 0,[i].concat(s)),eg(i)})}}function j5(){return"showOpenFilePicker"in window}function H5(n){if(vc(n)){var t=Object.entries(n).filter(function(e){var i=Md(e,2),r=i[0],s=i[1],a=!0;return wD(r)||(console.warn('Skipped "'.concat(r,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),a=!1),(!Array.isArray(s)||!s.every(AD))&&(console.warn('Skipped "'.concat(r,'" because an invalid file extension was provided.')),a=!1),a}).reduce(function(e,i){var r=Md(i,2),s=r[0],a=r[1];return S2(S2({},e),{},xD({},s,a))},{});return[{description:"Files",accept:t}]}return n}function $5(n){if(vc(n))return Object.entries(n).reduce(function(t,e){var i=Md(e,2),r=i[0],s=i[1];return[].concat(w2(t),[r],w2(s))},[]).filter(function(t){return wD(t)||AD(t)}).join(",")}function G5(n){return n instanceof DOMException&&(n.name==="AbortError"||n.code===n.ABORT_ERR)}function V5(n){return n instanceof DOMException&&(n.name==="SecurityError"||n.code===n.SECURITY_ERR)}function wD(n){return n==="audio/*"||n==="video/*"||n==="image/*"||n==="text/*"||n==="application/*"||/\w+\/[-+.\w]+/g.test(n)}function AD(n){return/^.*\.[\w]+$/.test(n)}var W5=["children"],q5=["open"],Y5=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],X5=["refKey","onChange","onClick"];function K5(n){return J5(n)||Q5(n)||SD(n)||Z5()}function Z5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q5(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function J5(n){if(Array.isArray(n))return _x(n)}function A_(n,t){return n8(n)||e8(n,t)||SD(n,t)||t8()}function t8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SD(n,t){if(n){if(typeof n=="string")return _x(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _x(n,t)}}function _x(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,i=new Array(t);e<t;e++)i[e]=n[e];return i}function e8(n,t){var e=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(e!=null){var i=[],r=!0,s=!1,a,l;try{for(e=e.call(n);!(r=(a=e.next()).done)&&(i.push(a.value),!(t&&i.length===t));r=!0);}catch(u){s=!0,l=u}finally{try{!r&&e.return!=null&&e.return()}finally{if(s)throw l}}return i}}function n8(n){if(Array.isArray(n))return n}function O2(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),e.push.apply(e,i)}return e}function Gn(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?O2(Object(e),!0).forEach(function(i){xx(n,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):O2(Object(e)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(e,i))})}return n}function xx(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function ng(n,t){if(n==null)return{};var e=i8(n,t),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(e[i]=n[i])}return e}function i8(n,t){if(n==null)return{};var e={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&(e[r]=n[r]);return e}var Tb=vt.forwardRef(function(n,t){var e=n.children,i=ng(n,W5),r=CD(i),s=r.open,a=ng(r,q5);return vt.useImperativeHandle(t,function(){return{open:s}},[s]),Yn.createElement(vt.Fragment,null,e(Gn(Gn({},a),{},{open:s})))});Tb.displayName="Dropzone";var TD={disabled:!1,getFilesFromEvent:d5,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Tb.defaultProps=TD;Tb.propTypes={children:On.func,accept:On.objectOf(On.arrayOf(On.string)),multiple:On.bool,preventDropOnDocument:On.bool,noClick:On.bool,noKeyboard:On.bool,noDrag:On.bool,noDragEventsBubbling:On.bool,minSize:On.number,maxSize:On.number,maxFiles:On.number,disabled:On.bool,getFilesFromEvent:On.func,onFileDialogCancel:On.func,onFileDialogOpen:On.func,useFsAccessApi:On.bool,autoFocus:On.bool,onDragEnter:On.func,onDragLeave:On.func,onDragOver:On.func,onDrop:On.func,onDropAccepted:On.func,onDropRejected:On.func,onError:On.func,validator:On.func};var bx={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function CD(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=Gn(Gn({},TD),n),e=t.accept,i=t.disabled,r=t.getFilesFromEvent,s=t.maxSize,a=t.minSize,l=t.multiple,u=t.maxFiles,f=t.onDragEnter,d=t.onDragLeave,p=t.onDragOver,m=t.onDrop,v=t.onDropAccepted,x=t.onDropRejected,_=t.onFileDialogCancel,b=t.onFileDialogOpen,E=t.useFsAccessApi,T=t.autoFocus,S=t.preventDropOnDocument,O=t.noClick,R=t.noKeyboard,N=t.noDrag,C=t.noDragEventsBubbling,M=t.onError,I=t.validator,F=vt.useMemo(function(){return $5(e)},[e]),z=vt.useMemo(function(){return H5(e)},[e]),P=vt.useMemo(function(){return typeof b=="function"?b:R2},[b]),tt=vt.useMemo(function(){return typeof _=="function"?_:R2},[_]),L=vt.useRef(null),nt=vt.useRef(null),Q=vt.useReducer(r8,bx),X=A_(Q,2),Rt=X[0],yt=X[1],j=Rt.isFocused,J=Rt.isFileDialogActive,G=vt.useRef(typeof window<"u"&&window.isSecureContext&&E&&j5()),ut=function(){!G.current&&J&&setTimeout(function(){if(nt.current){var pt=nt.current.files;pt.length||(yt({type:"closeDialog"}),tt())}},300)};vt.useEffect(function(){return window.addEventListener("focus",ut,!1),function(){window.removeEventListener("focus",ut,!1)}},[nt,J,tt,G]);var gt=vt.useRef([]),_t=function(pt){L.current&&L.current.contains(pt.target)||(pt.preventDefault(),gt.current=[])};vt.useEffect(function(){return S&&(document.addEventListener("dragover",D2,!1),document.addEventListener("drop",_t,!1)),function(){S&&(document.removeEventListener("dragover",D2),document.removeEventListener("drop",_t))}},[L,S]),vt.useEffect(function(){return!i&&T&&L.current&&L.current.focus(),function(){}},[L,T,i]);var Bt=vt.useCallback(function(At){M?M(At):console.error(At)},[M]),Gt=vt.useCallback(function(At){At.preventDefault(),At.persist(),Pt(At),gt.current=[].concat(K5(gt.current),[At.target]),vm(At)&&Promise.resolve(r(At)).then(function(pt){if(!(eg(At)&&!C)){var te=pt.length,ae=te>0&&F5({files:pt,accept:F,minSize:a,maxSize:s,multiple:l,maxFiles:u,validator:I}),ne=te>0&&!ae;yt({isDragAccept:ae,isDragReject:ne,isDragActive:!0,type:"setDraggedFiles"}),f&&f(At)}}).catch(function(pt){return Bt(pt)})},[r,f,Bt,C,F,a,s,l,u,I]),H=vt.useCallback(function(At){At.preventDefault(),At.persist(),Pt(At);var pt=vm(At);if(pt&&At.dataTransfer)try{At.dataTransfer.dropEffect="copy"}catch{}return pt&&p&&p(At),!1},[p,C]),mt=vt.useCallback(function(At){At.preventDefault(),At.persist(),Pt(At);var pt=gt.current.filter(function(ae){return L.current&&L.current.contains(ae)}),te=pt.indexOf(At.target);te!==-1&&pt.splice(te,1),gt.current=pt,!(pt.length>0)&&(yt({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),vm(At)&&d&&d(At))},[L,d,C]),lt=vt.useCallback(function(At,pt){var te=[],ae=[];At.forEach(function(ne){var Re=yD(ne,F),rn=A_(Re,2),ye=rn[0],ln=rn[1],Ve=ED(ne,a,s),zn=A_(Ve,2),Cn=zn[0],bn=zn[1],mi=I?I(ne):null;if(ye&&Cn&&!mi)te.push(ne);else{var vs=[ln,bn];mi&&(vs=vs.concat(mi)),ae.push({file:ne,errors:vs.filter(function(Gs){return Gs})})}}),(!l&&te.length>1||l&&u>=1&&te.length>u)&&(te.forEach(function(ne){ae.push({file:ne,errors:[P5]})}),te.splice(0)),yt({acceptedFiles:te,fileRejections:ae,isDragReject:ae.length>0,type:"setFiles"}),m&&m(te,ae,pt),ae.length>0&&x&&x(ae,pt),te.length>0&&v&&v(te,pt)},[yt,l,F,a,s,u,m,v,x,I]),ct=vt.useCallback(function(At){At.preventDefault(),At.persist(),Pt(At),gt.current=[],vm(At)&&Promise.resolve(r(At)).then(function(pt){eg(At)&&!C||lt(pt,At)}).catch(function(pt){return Bt(pt)}),yt({type:"reset"})},[r,lt,Bt,C]),Ct=vt.useCallback(function(){if(G.current){yt({type:"openDialog"}),P();var At={multiple:l,types:z};window.showOpenFilePicker(At).then(function(pt){return r(pt)}).then(function(pt){lt(pt,null),yt({type:"closeDialog"})}).catch(function(pt){G5(pt)?(tt(pt),yt({type:"closeDialog"})):V5(pt)?(G.current=!1,nt.current?(nt.current.value=null,nt.current.click()):Bt(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Bt(pt)});return}nt.current&&(yt({type:"openDialog"}),P(),nt.current.value=null,nt.current.click())},[yt,P,tt,E,lt,Bt,z,l]),Lt=vt.useCallback(function(At){!L.current||!L.current.isEqualNode(At.target)||(At.key===" "||At.key==="Enter"||At.keyCode===32||At.keyCode===13)&&(At.preventDefault(),Ct())},[L,Ct]),D=vt.useCallback(function(){yt({type:"focus"})},[]),dt=vt.useCallback(function(){yt({type:"blur"})},[]),st=vt.useCallback(function(){O||(z5()?setTimeout(Ct,0):Ct())},[O,Ct]),Y=function(pt){return i?null:pt},q=function(pt){return R?null:Y(pt)},ft=function(pt){return N?null:Y(pt)},Pt=function(pt){C&&pt.stopPropagation()},jt=vt.useMemo(function(){return function(){var At=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},pt=At.refKey,te=pt===void 0?"ref":pt,ae=At.role,ne=At.onKeyDown,Re=At.onFocus,rn=At.onBlur,ye=At.onClick,ln=At.onDragEnter,Ve=At.onDragOver,zn=At.onDragLeave,Cn=At.onDrop,bn=ng(At,Y5);return Gn(Gn(xx({onKeyDown:q(Ia(ne,Lt)),onFocus:q(Ia(Re,D)),onBlur:q(Ia(rn,dt)),onClick:Y(Ia(ye,st)),onDragEnter:ft(Ia(ln,Gt)),onDragOver:ft(Ia(Ve,H)),onDragLeave:ft(Ia(zn,mt)),onDrop:ft(Ia(Cn,ct)),role:typeof ae=="string"&&ae!==""?ae:"presentation"},te,L),!i&&!R?{tabIndex:0}:{}),bn)}},[L,Lt,D,dt,st,Gt,H,mt,ct,R,N,i]),wt=vt.useCallback(function(At){At.stopPropagation()},[]),Nt=vt.useMemo(function(){return function(){var At=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},pt=At.refKey,te=pt===void 0?"ref":pt,ae=At.onChange,ne=At.onClick,Re=ng(At,X5),rn=xx({accept:F,multiple:l,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:Y(Ia(ae,ct)),onClick:Y(Ia(ne,wt)),tabIndex:-1},te,nt);return Gn(Gn({},rn),Re)}},[nt,e,l,ct,i]);return Gn(Gn({},Rt),{},{isFocused:j&&!i,getRootProps:jt,getInputProps:Nt,rootRef:L,inputRef:nt,open:Y(Ct)})}function r8(n,t){switch(t.type){case"focus":return Gn(Gn({},n),{},{isFocused:!0});case"blur":return Gn(Gn({},n),{},{isFocused:!1});case"openDialog":return Gn(Gn({},bx),{},{isFileDialogActive:!0});case"closeDialog":return Gn(Gn({},n),{},{isFileDialogActive:!1});case"setDraggedFiles":return Gn(Gn({},n),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return Gn(Gn({},n),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case"reset":return Gn({},bx);default:return n}}function R2(){}const s8=100*1024*1024;function a8({onFileSelect:n}){const[t,e]=vt.useState(null),[i,r]=vt.useState(null),s=async S=>{if(S){const O=S[0],R=await l(O);if(!R.isValid){e({type:"error",message:`${R.error} - O arquivo pode estar corrompido ou não ser um PDF real.`});return}r(O),e({type:"success",message:`PDF "${O.name}" carregado com sucesso! (${(O.size/1024/1024).toFixed(2)} MB)`}),n(O)}};vt.useEffect(()=>{if(t?.type==="success"){const S=setTimeout(()=>{e(null)},5e3);return()=>clearTimeout(S)}},[t]);const a=()=>{e(null)},l=async S=>new Promise(O=>{const R=new FileReader;R.onload=N=>{if(!N.target?.result){O({isValid:!1,error:"Não foi possível ler o arquivo"});return}const C=new Uint8Array(N.target.result),I=[37,80,68,70,45].every((F,z)=>C[z]===F);O(I?{isValid:!0}:{isValid:!1,error:"Arquivo não é um PDF válido"})},R.onerror=()=>{O({isValid:!1,error:"Erro ao ler arquivo"})},R.readAsArrayBuffer(S.slice(0,5))}),u=S=>{if(S.length>0){const O=S[0],R=O.file,N=O.errors;N.some(C=>C.code==="file-invalid-type")?e({type:"error",message:`Arquivo "${R.name}" não é um PDF válido. Apenas arquivos PDF são permitidos!`}):N.some(C=>C.code==="file-too-large")?e({type:"error",message:`Arquivo "${R.name}" muito grande! Limite máximo: 100MB. Seu arquivo: ${(R.size/1024/1024).toFixed(1)}MB`}):N.some(C=>C.code==="too-many-files")?e({type:"error",message:"Apenas um arquivo por vez é permitido!"}):e({type:"error",message:`Erro ao carregar "${R.name}": ${N[0]?.message||"Arquivo inválido"}`})}},f={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"10px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},d={borderColor:"#2196f3"},p={borderColor:"#00e676"},m={borderColor:"#ff1744"},{getRootProps:v,getInputProps:x,isFocused:_,isDragAccept:b,isDragReject:E}=CD({accept:{"application/pdf":[".pdf"]},onDropAccepted:s,onDropRejected:u,maxFiles:1,maxSize:s8}),T=vt.useMemo(()=>({...f,..._?d:{},...b?p:{},...E?m:{}}),[_,b,E,i]);return at.jsxs("div",{children:[t&&at.jsxs("div",{className:`alert alert-${t.type==="success"?"success":"danger"} alert-dismissible fade show`,role:"alert",children:[at.jsx("strong",{children:t.type==="success"?"Sucesso!":"Erro!"})," ",t.message,at.jsx("button",{type:"button",className:"btn-close",onClick:a,"aria-label":"Close"})]}),at.jsx("div",{className:"container",children:at.jsxs("div",{...v({style:T}),children:[at.jsx("input",{...x()}),i?at.jsxs("div",{style:{color:"#4caf50",textAlign:"center"},children:[at.jsx("p",{style:{margin:0,wordBreak:"break-all",wordWrap:"break-word",overflowWrap:"break-word",maxWidth:"100%"},children:at.jsx("strong",{children:i.name})}),at.jsx("p",{className:"m-0 small",children:"Clique ou arraste para trocar o arquivo"})]}):at.jsx("p",{className:"m-0",children:"Arraste seu PDF aqui, ou clique para selecionar arquivos"})]})})]})}const N2="extrator-dados-pdf-presets",o8=({isOpen:n,onClose:t,currentAreas:e,onLoadPreset:i})=>{const[r,s]=vt.useState(""),[a,l]=vt.useState([]);vt.useEffect(()=>{u()},[]);const u=()=>{try{const _=localStorage.getItem(N2);if(_){const b=JSON.parse(_);l(b)}}catch(_){console.error("Erro ao carregar presets:",_)}},f=_=>{try{localStorage.setItem(N2,JSON.stringify(_))}catch(b){console.error("Erro ao salvar presets:",b)}},d=()=>{if(!r.trim())return;if(e.length<=0){alert("Não é possível salvar um preset sem áreas");return}const _={name:r.trim(),areas:e},b=[...a,_];l(b),f(b),s("")},p=_=>{confirm("Isso vai substituir todas as áreas atuais. Continuar?")&&(i(_.areas),t())},m=_=>{if(!confirm("Tem certeza que deseja excluir este preset?"))return;const b=a.filter((E,T)=>T!==_);l(b),f(b)},v=_=>{const b=JSON.stringify(_,null,2),E=new Blob([b],{type:"application/json"}),T=URL.createObjectURL(E),S=document.createElement("a");S.href=T,S.download=`${_.name}.json`,S.click(),URL.revokeObjectURL(T)},x=_=>{const b=_.target.files?.[0];if(!b)return;const E=new FileReader;E.onload=T=>{try{const S=T.target?.result,O=JSON.parse(S);if(!O.name||!Array.isArray(O.areas)){alert("Arquivo JSON inválido!");return}const R=[...a,O];l(R),f(R),_.target.value="",alert(`Preset "${O.name}" importado com sucesso!`)}catch(S){alert("Erro ao ler arquivo JSON!"),console.error(S)}},E.readAsText(b)};return n?at.jsxs(at.Fragment,{children:[at.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50",style:{zIndex:1050},onClick:t}),at.jsxs("div",{className:"position-fixed top-50 start-50 translate-middle bg-white rounded shadow-lg p-4",style:{zIndex:1051,width:"500px",maxHeight:"80vh",overflowY:"auto"},children:[at.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[at.jsx("h5",{className:"mb-0",children:"Gerenciar Presets"}),at.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:t,children:at.jsx(Sb,{size:16})})]}),at.jsxs("div",{className:"mb-4 p-3 border rounded",children:[at.jsx("h6",{children:"Salvar Preset Atual"}),at.jsxs("div",{className:"d-flex gap-2",children:[at.jsx("input",{type:"text",className:"form-control",placeholder:"Nome do preset...",value:r,onChange:_=>s(_.target.value),onKeyDown:_=>_.key==="Enter"&&d()}),at.jsxs("button",{className:"btn btn-success",onClick:d,disabled:!r.trim()||e.length===0,children:[at.jsx(H6,{size:16,className:"me-1"}),"Salvar"]})]}),at.jsx("small",{className:"text-muted",children:e.length===0?"Nenhuma área para salvar":e.length===1?"1 área será salva":`${e.length} áreas serão salvas`})]}),at.jsxs("div",{className:"mb-4",children:[at.jsx("h6",{children:"Presets Salvos"}),a.length===0?at.jsx("p",{className:"text-muted",children:"Nenhum preset salvo ainda."}):a.map((_,b)=>at.jsxs("div",{className:"d-flex justify-content-between align-items-center p-2 border rounded mb-2",children:[at.jsxs("div",{children:[at.jsx("strong",{children:_.name}),at.jsx("br",{}),at.jsxs("small",{className:"text-muted",children:[_.areas.length," área(s)"]})]}),at.jsxs("div",{className:"d-flex gap-1",children:[at.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>p(_),title:"Carregar preset",children:at.jsx(B6,{size:14})}),at.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>v(_),title:"Download JSON",children:at.jsx(yd,{size:14})}),at.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>m(b),title:"Excluir preset",children:at.jsx(W6,{size:14})})]})]},b))]}),at.jsxs("div",{className:"p-3 border rounded",children:[at.jsx("h6",{children:"Importar Preset"}),at.jsx("input",{type:"file",className:"form-control",accept:".json",onChange:_=>{x(_)}})]})]})]}):null};var Cb=pT();const l8=yf(Cb);function xr(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var c8=typeof Symbol=="function"&&Symbol.observable||"@@observable",k2=c8,L2=()=>Math.random().toString(36).substring(7).split("").join("."),u8={INIT:`@@redux/INIT${L2()}`,REPLACE:`@@redux/REPLACE${L2()}`},I2=u8;function f8(n){if(typeof n!="object"||n===null)return!1;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t||Object.getPrototypeOf(n)===null}function DD(n,t,e){if(typeof n!="function")throw new Error(xr(2));if(typeof t=="function"&&typeof e=="function"||typeof e=="function"&&typeof arguments[3]=="function")throw new Error(xr(0));if(typeof t=="function"&&typeof e>"u"&&(e=t,t=void 0),typeof e<"u"){if(typeof e!="function")throw new Error(xr(1));return e(DD)(n,t)}let i=n,r=t,s=new Map,a=s,l=0,u=!1;function f(){a===s&&(a=new Map,s.forEach((b,E)=>{a.set(E,b)}))}function d(){if(u)throw new Error(xr(3));return r}function p(b){if(typeof b!="function")throw new Error(xr(4));if(u)throw new Error(xr(5));let E=!0;f();const T=l++;return a.set(T,b),function(){if(E){if(u)throw new Error(xr(6));E=!1,f(),a.delete(T),s=null}}}function m(b){if(!f8(b))throw new Error(xr(7));if(typeof b.type>"u")throw new Error(xr(8));if(typeof b.type!="string")throw new Error(xr(17));if(u)throw new Error(xr(9));try{u=!0,r=i(r,b)}finally{u=!1}return(s=a).forEach(T=>{T()}),b}function v(b){if(typeof b!="function")throw new Error(xr(10));i=b,m({type:I2.REPLACE})}function x(){const b=p;return{subscribe(E){if(typeof E!="object"||E===null)throw new Error(xr(11));function T(){const O=E;O.next&&O.next(d())}return T(),{unsubscribe:b(T)}},[k2](){return this}}}return m({type:I2.INIT}),{dispatch:m,subscribe:p,getState:d,replaceReducer:v,[k2]:x}}function M2(n,t){return function(...e){return t(n.apply(this,e))}}function P2(n,t){if(typeof n=="function")return M2(n,t);if(typeof n!="object"||n===null)throw new Error(xr(16));const e={};for(const i in n){const r=n[i];typeof r=="function"&&(e[i]=M2(r,t))}return e}function OD(...n){return n.length===0?t=>t:n.length===1?n[0]:n.reduce((t,e)=>(...i)=>t(e(...i)))}function h8(...n){return t=>(e,i)=>{const r=t(e,i);let s=()=>{throw new Error(xr(15))};const a={getState:r.getState,dispatch:(u,...f)=>s(u,...f)},l=n.map(u=>u(a));return s=OD(...l)(r.dispatch),{...r,dispatch:s}}}var S_={exports:{}},T_={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F2;function d8(){if(F2)return T_;F2=1;var n=kg();function t(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var e=typeof Object.is=="function"?Object.is:t,i=n.useSyncExternalStore,r=n.useRef,s=n.useEffect,a=n.useMemo,l=n.useDebugValue;return T_.useSyncExternalStoreWithSelector=function(u,f,d,p,m){var v=r(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=a(function(){function b(R){if(!E){if(E=!0,T=R,R=p(R),m!==void 0&&x.hasValue){var N=x.value;if(m(N,R))return S=N}return S=R}if(N=S,e(T,R))return N;var C=p(R);return m!==void 0&&m(N,C)?(T=R,N):(T=R,S=C)}var E=!1,T,S,O=d===void 0?null:d;return[function(){return b(f())},O===null?void 0:function(){return b(O())}]},[f,d,p,m]);var _=i(u,v[0],v[1]);return s(function(){x.hasValue=!0,x.value=_},[_]),l(_),_},T_}var B2;function p8(){return B2||(B2=1,S_.exports=d8()),S_.exports}p8();var m8=vt.version.startsWith("19"),g8=Symbol.for(m8?"react.transitional.element":"react.element"),v8=Symbol.for("react.portal"),_8=Symbol.for("react.fragment"),x8=Symbol.for("react.strict_mode"),b8=Symbol.for("react.profiler"),y8=Symbol.for("react.consumer"),E8=Symbol.for("react.context"),RD=Symbol.for("react.forward_ref"),w8=Symbol.for("react.suspense"),A8=Symbol.for("react.suspense_list"),Db=Symbol.for("react.memo"),S8=Symbol.for("react.lazy"),T8=RD,C8=Db;function D8(n){if(typeof n=="object"&&n!==null){const{$$typeof:t}=n;switch(t){case g8:switch(n=n.type,n){case _8:case b8:case x8:case w8:case A8:return n;default:switch(n=n&&n.$$typeof,n){case E8:case RD:case S8:case Db:return n;case y8:return n;default:return t}}case v8:return t}}}function O8(n){return D8(n)===Db}function R8(n,t,e,i,{areStatesEqual:r,areOwnPropsEqual:s,areStatePropsEqual:a}){let l=!1,u,f,d,p,m;function v(T,S){return u=T,f=S,d=n(u,f),p=t(i,f),m=e(d,p,f),l=!0,m}function x(){return d=n(u,f),t.dependsOnOwnProps&&(p=t(i,f)),m=e(d,p,f),m}function _(){return n.dependsOnOwnProps&&(d=n(u,f)),t.dependsOnOwnProps&&(p=t(i,f)),m=e(d,p,f),m}function b(){const T=n(u,f),S=!a(T,d);return d=T,S&&(m=e(d,p,f)),m}function E(T,S){const O=!s(S,f),R=!r(T,u,S,f);return u=T,f=S,O&&R?x():O?_():R?b():m}return function(S,O){return l?E(S,O):v(S,O)}}function N8(n,{initMapStateToProps:t,initMapDispatchToProps:e,initMergeProps:i,...r}){const s=t(n,r),a=e(n,r),l=i(n,r);return R8(s,a,l,n,r)}function k8(n,t){const e={};for(const i in n){const r=n[i];typeof r=="function"&&(e[i]=(...s)=>t(r(...s)))}return e}function yx(n){return function(e){const i=n(e);function r(){return i}return r.dependsOnOwnProps=!1,r}}function U2(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function ND(n,t){return function(i,{displayName:r}){const s=function(l,u){return s.dependsOnOwnProps?s.mapToProps(l,u):s.mapToProps(l,void 0)};return s.dependsOnOwnProps=!0,s.mapToProps=function(l,u){s.mapToProps=n,s.dependsOnOwnProps=U2(n);let f=s(l,u);return typeof f=="function"&&(s.mapToProps=f,s.dependsOnOwnProps=U2(f),f=s(l,u)),f},s}}function Ob(n,t){return(e,i)=>{throw new Error(`Invalid value of type ${typeof n} for ${t} argument when connecting component ${i.wrappedComponentName}.`)}}function L8(n){return n&&typeof n=="object"?yx(t=>k8(n,t)):n?typeof n=="function"?ND(n):Ob(n,"mapDispatchToProps"):yx(t=>({dispatch:t}))}function I8(n){return n?typeof n=="function"?ND(n):Ob(n,"mapStateToProps"):yx(()=>({}))}function M8(n,t,e){return{...e,...n,...t}}function P8(n){return function(e,{displayName:i,areMergedPropsEqual:r}){let s=!1,a;return function(u,f,d){const p=n(u,f,d);return s?r(p,a)||(a=p):(s=!0,a=p),a}}}function F8(n){return n?typeof n=="function"?P8(n):Ob(n,"mergeProps"):()=>M8}function B8(n){n()}function U8(){let n=null,t=null;return{clear(){n=null,t=null},notify(){B8(()=>{let e=n;for(;e;)e.callback(),e=e.next})},get(){const e=[];let i=n;for(;i;)e.push(i),i=i.next;return e},subscribe(e){let i=!0;const r=t={callback:e,next:null,prev:t};return r.prev?r.prev.next=r:n=r,function(){!i||n===null||(i=!1,r.next?r.next.prev=r.prev:t=r.prev,r.prev?r.prev.next=r.next:n=r.next)}}}}var z2={notify(){},get:()=>[]};function kD(n,t){let e,i=z2,r=0,s=!1;function a(_){d();const b=i.subscribe(_);let E=!1;return()=>{E||(E=!0,b(),p())}}function l(){i.notify()}function u(){x.onStateChange&&x.onStateChange()}function f(){return s}function d(){r++,e||(e=t?t.addNestedSub(u):n.subscribe(u),i=U8())}function p(){r--,e&&r===0&&(e(),e=void 0,i.clear(),i=z2)}function m(){s||(s=!0,d())}function v(){s&&(s=!1,p())}const x={addNestedSub:a,notifyNestedSubs:l,handleChangeWrapper:u,isSubscribed:f,trySubscribe:m,tryUnsubscribe:v,getListeners:()=>i};return x}var z8=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",j8=z8(),H8=()=>typeof navigator<"u"&&navigator.product==="ReactNative",$8=H8(),G8=()=>j8||$8?vt.useLayoutEffect:vt.useEffect,ig=G8();function j2(n,t){return n===t?n!==0||t!==0||1/n===1/t:n!==n&&t!==t}function C_(n,t){if(j2(n,t))return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null)return!1;const e=Object.keys(n),i=Object.keys(t);if(e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(!Object.prototype.hasOwnProperty.call(t,e[r])||!j2(n[e[r]],t[e[r]]))return!1;return!0}var V8={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},W8={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},q8={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},LD={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Y8={[T8]:q8,[C8]:LD};function H2(n){return O8(n)?LD:Y8[n.$$typeof]||V8}var X8=Object.defineProperty,K8=Object.getOwnPropertyNames,$2=Object.getOwnPropertySymbols,Z8=Object.getOwnPropertyDescriptor,Q8=Object.getPrototypeOf,G2=Object.prototype;function Ex(n,t){if(typeof t!="string"){if(G2){const s=Q8(t);s&&s!==G2&&Ex(n,s)}let e=K8(t);$2&&(e=e.concat($2(t)));const i=H2(n),r=H2(t);for(let s=0;s<e.length;++s){const a=e[s];if(!W8[a]&&!(r&&r[a])&&!(i&&i[a])){const l=Z8(t,a);try{X8(n,a,l)}catch{}}}}return n}var J8=Symbol.for("react-redux-context"),tB=typeof globalThis<"u"?globalThis:{};function eB(){if(!vt.createContext)return{};const n=tB[J8]??=new Map;let t=n.get(vt.createContext);return t||(t=vt.createContext(null),n.set(vt.createContext,t)),t}var ID=eB(),nB=[null,null];function iB(n,t,e){ig(()=>n(...t),e)}function rB(n,t,e,i,r,s){n.current=i,e.current=!1,r.current&&(r.current=null,s())}function sB(n,t,e,i,r,s,a,l,u,f,d){if(!n)return()=>{};let p=!1,m=null;const v=()=>{if(p||!l.current)return;const _=t.getState();let b,E;try{b=i(_,r.current)}catch(T){E=T,m=T}E||(m=null),b===s.current?a.current||f():(s.current=b,u.current=b,a.current=!0,d())};return e.onStateChange=v,e.trySubscribe(),v(),()=>{if(p=!0,e.tryUnsubscribe(),e.onStateChange=null,m)throw m}}function aB(n,t){return n===t}function oB(n,t,e,{pure:i,areStatesEqual:r=aB,areOwnPropsEqual:s=C_,areStatePropsEqual:a=C_,areMergedPropsEqual:l=C_,forwardRef:u=!1,context:f=ID}={}){const d=f,p=I8(n),m=L8(t),v=F8(e),x=!!n;return b=>{const E=b.displayName||b.name||"Component",T=`Connect(${E})`,S={shouldHandleStateChanges:x,displayName:T,wrappedComponentName:E,WrappedComponent:b,initMapStateToProps:p,initMapDispatchToProps:m,initMergeProps:v,areStatesEqual:r,areStatePropsEqual:a,areOwnPropsEqual:s,areMergedPropsEqual:l};function O(C){const[M,I,F]=vt.useMemo(()=>{const{reactReduxForwardedRef:Ct,...Lt}=C;return[C.context,Ct,Lt]},[C]),z=vt.useMemo(()=>{let Ct=d;return M?.Consumer,Ct},[M,d]),P=vt.useContext(z),tt=!!C.store&&!!C.store.getState&&!!C.store.dispatch,L=!!P&&!!P.store,nt=tt?C.store:P.store,Q=L?P.getServerState:nt.getState,X=vt.useMemo(()=>N8(nt.dispatch,S),[nt]),[Rt,yt]=vt.useMemo(()=>{if(!x)return nB;const Ct=kD(nt,tt?void 0:P.subscription),Lt=Ct.notifyNestedSubs.bind(Ct);return[Ct,Lt]},[nt,tt,P]),j=vt.useMemo(()=>tt?P:{...P,subscription:Rt},[tt,P,Rt]),J=vt.useRef(void 0),G=vt.useRef(F),ut=vt.useRef(void 0),gt=vt.useRef(!1),_t=vt.useRef(!1),Bt=vt.useRef(void 0);ig(()=>(_t.current=!0,()=>{_t.current=!1}),[]);const Gt=vt.useMemo(()=>()=>ut.current&&F===G.current?ut.current:X(nt.getState(),F),[nt,F]),H=vt.useMemo(()=>Lt=>Rt?sB(x,nt,Rt,X,G,J,gt,_t,ut,yt,Lt):()=>{},[Rt]);iB(rB,[G,J,gt,F,ut,yt]);let mt;try{mt=vt.useSyncExternalStore(H,Gt,Q?()=>X(Q(),F):Gt)}catch(Ct){throw Bt.current&&(Ct.message+=`
The error may be correlated with this previous error:
${Bt.current.stack}

`),Ct}ig(()=>{Bt.current=void 0,ut.current=void 0,J.current=mt});const lt=vt.useMemo(()=>vt.createElement(b,{...mt,ref:I}),[I,b,mt]);return vt.useMemo(()=>x?vt.createElement(z.Provider,{value:j},lt):lt,[z,lt,j])}const N=vt.memo(O);if(N.WrappedComponent=b,N.displayName=O.displayName=T,u){const M=vt.forwardRef(function(F,z){return vt.createElement(N,{...F,reactReduxForwardedRef:z})});return M.displayName=T,M.WrappedComponent=b,Ex(M,b)}return Ex(N,b)}}var MD=oB;function lB(n){const{children:t,context:e,serverState:i,store:r}=n,s=vt.useMemo(()=>{const u=kD(r);return{store:r,subscription:u,getServerState:i?()=>i:void 0}},[r,i]),a=vt.useMemo(()=>r.getState(),[r]);ig(()=>{const{subscription:u}=s;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),a!==r.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[s,a]);const l=e||ID;return vt.createElement(l.Provider,{value:s},t)}var cB=lB,sa=function(t){var e=t.top,i=t.right,r=t.bottom,s=t.left,a=i-s,l=r-e,u={top:e,right:i,bottom:r,left:s,width:a,height:l,x:s,y:e,center:{x:(i+s)/2,y:(r+e)/2}};return u},Rb=function(t,e){return{top:t.top-e.top,left:t.left-e.left,bottom:t.bottom+e.bottom,right:t.right+e.right}},V2=function(t,e){return{top:t.top+e.top,left:t.left+e.left,bottom:t.bottom-e.bottom,right:t.right-e.right}},uB=function(t,e){return{top:t.top+e.y,left:t.left+e.x,bottom:t.bottom+e.y,right:t.right+e.x}},D_={top:0,right:0,bottom:0,left:0},Nb=function(t){var e=t.borderBox,i=t.margin,r=i===void 0?D_:i,s=t.border,a=s===void 0?D_:s,l=t.padding,u=l===void 0?D_:l,f=sa(Rb(e,r)),d=sa(V2(e,a)),p=sa(V2(d,u));return{marginBox:f,borderBox:sa(e),paddingBox:d,contentBox:p,margin:r,border:a,padding:u}},Rs=function(t){var e=t.slice(0,-2),i=t.slice(-2);if(i!=="px")return 0;var r=Number(e);return isNaN(r)&&An(!1),r},fB=function(){return{x:window.pageXOffset,y:window.pageYOffset}},rg=function(t,e){var i=t.borderBox,r=t.border,s=t.margin,a=t.padding,l=uB(i,e);return Nb({borderBox:l,border:r,margin:s,padding:a})},sg=function(t,e){return e===void 0&&(e=fB()),rg(t,e)},PD=function(t,e){var i={top:Rs(e.marginTop),right:Rs(e.marginRight),bottom:Rs(e.marginBottom),left:Rs(e.marginLeft)},r={top:Rs(e.paddingTop),right:Rs(e.paddingRight),bottom:Rs(e.paddingBottom),left:Rs(e.paddingLeft)},s={top:Rs(e.borderTopWidth),right:Rs(e.borderRightWidth),bottom:Rs(e.borderBottomWidth),left:Rs(e.borderLeftWidth)};return Nb({borderBox:t,margin:i,padding:r,border:s})},FD=function(t){var e=t.getBoundingClientRect(),i=window.getComputedStyle(t);return PD(e,i)},Pd=function(t){var e=[],i=null,r=function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];e=l,!i&&(i=requestAnimationFrame(function(){i=null,t.apply(void 0,e)}))};return r.cancel=function(){i&&(cancelAnimationFrame(i),i=null)},r};function ag(){return ag=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)({}).hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},ag.apply(null,arguments)}function BD(n,t){}BD.bind(null,"warn");BD.bind(null,"error");function Tl(){}function hB(n,t){return{...n,...t}}function Ms(n,t,e){const i=t.map(r=>{const s=hB(e,r.options);return n.addEventListener(r.eventName,r.fn,s),function(){n.removeEventListener(r.eventName,r.fn,s)}});return function(){i.forEach(s=>{s()})}}const dB="Invariant failed";class og extends Error{}og.prototype.toString=function(){return this.message};function oe(n,t){throw new og(dB)}class pB extends Yn.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=Tl,this.onWindowError=e=>{const i=this.getCallbacks();i.isDragging()&&i.tryAbort(),e.error instanceof og&&e.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=e=>{this.callbacks=e}}componentDidMount(){this.unbind=Ms(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof og){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const mB=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,lg=n=>n+1,gB=n=>`
  You have lifted an item in position ${lg(n.source.index)}
`,UD=(n,t)=>{const e=n.droppableId===t.droppableId,i=lg(n.index),r=lg(t.index);return e?`
      You have moved the item from position ${i}
      to position ${r}
    `:`
    You have moved the item from position ${i}
    in list ${n.droppableId}
    to list ${t.droppableId}
    in position ${r}
  `},zD=(n,t,e)=>t.droppableId===e.droppableId?`
      The item ${n}
      has been combined with ${e.draggableId}`:`
      The item ${n}
      in list ${t.droppableId}
      has been combined with ${e.draggableId}
      in list ${e.droppableId}
    `,vB=n=>{const t=n.destination;if(t)return UD(n.source,t);const e=n.combine;return e?zD(n.draggableId,n.source,e):"You are over an area that cannot be dropped on"},W2=n=>`
  The item has returned to its starting position
  of ${lg(n.index)}
`,_B=n=>{if(n.reason==="CANCEL")return`
      Movement cancelled.
      ${W2(n.source)}
    `;const t=n.destination,e=n.combine;return t?`
      You have dropped the item.
      ${UD(n.source,t)}
    `:e?`
      You have dropped the item.
      ${zD(n.draggableId,n.source,e)}
    `:`
    The item has been dropped while not over a drop area.
    ${W2(n.source)}
  `},Wm={dragHandleUsageInstructions:mB,onDragStart:gB,onDragUpdate:vB,onDragEnd:_B};function xB(n,t){return!!(n===t||Number.isNaN(n)&&Number.isNaN(t))}function jD(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!xB(n[e],t[e]))return!1;return!0}function nn(n,t){const e=vt.useState(()=>({inputs:t,result:n()}))[0],i=vt.useRef(!0),r=vt.useRef(e),a=i.current||!!(t&&r.current.inputs&&jD(t,r.current.inputs))?r.current:{inputs:t,result:n()};return vt.useEffect(()=>{i.current=!1,r.current=a},[a]),a.result}function xe(n,t){return nn(()=>n,t)}const Ni={x:0,y:0},ji=(n,t)=>({x:n.x+t.x,y:n.y+t.y}),us=(n,t)=>({x:n.x-t.x,y:n.y-t.y}),Cl=(n,t)=>n.x===t.x&&n.y===t.y,Cf=n=>({x:n.x!==0?-n.x:0,y:n.y!==0?-n.y:0}),Ic=(n,t,e=0)=>n==="x"?{x:t,y:e}:{x:e,y:t},Fd=(n,t)=>Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2),q2=(n,t)=>Math.min(...t.map(e=>Fd(n,e))),HD=n=>t=>({x:n(t.x),y:n(t.y)});var bB=(n,t)=>{const e=sa({top:Math.max(t.top,n.top),right:Math.min(t.right,n.right),bottom:Math.min(t.bottom,n.bottom),left:Math.max(t.left,n.left)});return e.width<=0||e.height<=0?null:e};const dp=(n,t)=>({top:n.top+t.y,left:n.left+t.x,bottom:n.bottom+t.y,right:n.right+t.x}),Y2=n=>[{x:n.left,y:n.top},{x:n.right,y:n.top},{x:n.left,y:n.bottom},{x:n.right,y:n.bottom}],yB={top:0,right:0,bottom:0,left:0},EB=(n,t)=>t?dp(n,t.scroll.diff.displacement):n,wB=(n,t,e)=>e&&e.increasedBy?{...n,[t.end]:n[t.end]+e.increasedBy[t.line]}:n,AB=(n,t)=>t&&t.shouldClipSubject?bB(t.pageMarginBox,n):sa(n);var gf=({page:n,withPlaceholder:t,axis:e,frame:i})=>{const r=EB(n.marginBox,i),s=wB(r,e,t),a=AB(s,i);return{page:n,withPlaceholder:t,active:a}},kb=(n,t)=>{n.frame||oe();const e=n.frame,i=us(t,e.scroll.initial),r=Cf(i),s={...e,scroll:{initial:e.scroll.initial,current:t,diff:{value:i,displacement:r},max:e.scroll.max}},a=gf({page:n.subject.page,withPlaceholder:n.subject.withPlaceholder,axis:n.axis,frame:s});return{...n,frame:s,subject:a}};function Ri(n,t=jD){let e=null;function i(...r){if(e&&e.lastThis===this&&t(r,e.lastArgs))return e.lastResult;const s=n.apply(this,r);return e={lastResult:s,lastArgs:r,lastThis:this},s}return i.clear=function(){e=null},i}const $D=Ri(n=>n.reduce((t,e)=>(t[e.descriptor.id]=e,t),{})),GD=Ri(n=>n.reduce((t,e)=>(t[e.descriptor.id]=e,t),{})),Qg=Ri(n=>Object.values(n)),SB=Ri(n=>Object.values(n));var Df=Ri((n,t)=>SB(t).filter(i=>n===i.descriptor.droppableId).sort((i,r)=>i.descriptor.index-r.descriptor.index));function Lb(n){return n.at&&n.at.type==="REORDER"?n.at.destination:null}function Jg(n){return n.at&&n.at.type==="COMBINE"?n.at.combine:null}var tv=Ri((n,t)=>t.filter(e=>e.descriptor.id!==n.descriptor.id)),TB=({isMovingForward:n,draggable:t,destination:e,insideDestination:i,previousImpact:r})=>{if(!e.isCombineEnabled||!Lb(r))return null;function a(v){const x={type:"COMBINE",combine:{draggableId:v,droppableId:e.descriptor.id}};return{...r,at:x}}const l=r.displaced.all,u=l.length?l[0]:null;if(n)return u?a(u):null;const f=tv(t,i);if(!u){if(!f.length)return null;const v=f[f.length-1];return a(v.descriptor.id)}const d=f.findIndex(v=>v.descriptor.id===u);d===-1&&oe();const p=d-1;if(p<0)return null;const m=f[p];return a(m.descriptor.id)},Of=(n,t)=>n.descriptor.droppableId===t.descriptor.id;const VD={point:Ni,value:0},Bd={invisible:{},visible:{},all:[]},CB={displaced:Bd,displacedBy:VD,at:null};var Fs=(n,t)=>e=>n<=e&&e<=t,WD=n=>{const t=Fs(n.top,n.bottom),e=Fs(n.left,n.right);return i=>{if(t(i.top)&&t(i.bottom)&&e(i.left)&&e(i.right))return!0;const s=t(i.top)||t(i.bottom),a=e(i.left)||e(i.right);if(s&&a)return!0;const u=i.top<n.top&&i.bottom>n.bottom,f=i.left<n.left&&i.right>n.right;return u&&f?!0:u&&a||f&&s}},DB=n=>{const t=Fs(n.top,n.bottom),e=Fs(n.left,n.right);return i=>t(i.top)&&t(i.bottom)&&e(i.left)&&e(i.right)};const Ib={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},qD={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var OB=n=>t=>{const e=Fs(t.top,t.bottom),i=Fs(t.left,t.right);return r=>n===Ib?e(r.top)&&e(r.bottom):i(r.left)&&i(r.right)};const RB=(n,t)=>{const e=t.frame?t.frame.scroll.diff.displacement:Ni;return dp(n,e)},NB=(n,t,e)=>t.subject.active?e(t.subject.active)(n):!1,kB=(n,t,e)=>e(t)(n),Mb=({target:n,destination:t,viewport:e,withDroppableDisplacement:i,isVisibleThroughFrameFn:r})=>{const s=i?RB(n,t):n;return NB(s,t,r)&&kB(s,e,r)},LB=n=>Mb({...n,isVisibleThroughFrameFn:WD}),YD=n=>Mb({...n,isVisibleThroughFrameFn:DB}),IB=n=>Mb({...n,isVisibleThroughFrameFn:OB(n.destination.axis)}),MB=(n,t,e)=>{if(typeof e=="boolean")return e;if(!t)return!0;const{invisible:i,visible:r}=t;if(i[n])return!1;const s=r[n];return s?s.shouldAnimate:!0};function PB(n,t){const e=n.page.marginBox,i={top:t.point.y,right:0,bottom:0,left:t.point.x};return sa(Rb(e,i))}function Ud({afterDragging:n,destination:t,displacedBy:e,viewport:i,forceShouldAnimate:r,last:s}){return n.reduce(function(l,u){const f=PB(u,e),d=u.descriptor.id;if(l.all.push(d),!LB({target:f,destination:t,viewport:i,withDroppableDisplacement:!0}))return l.invisible[u.descriptor.id]=!0,l;const m=MB(d,s,r),v={draggableId:d,shouldAnimate:m};return l.visible[d]=v,l},{all:[],visible:{},invisible:{}})}function FB(n,t){if(!n.length)return 0;const e=n[n.length-1].descriptor.index;return t.inHomeList?e:e+1}function X2({insideDestination:n,inHomeList:t,displacedBy:e,destination:i}){const r=FB(n,{inHomeList:t});return{displaced:Bd,displacedBy:e,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:r}}}}function cg({draggable:n,insideDestination:t,destination:e,viewport:i,displacedBy:r,last:s,index:a,forceShouldAnimate:l}){const u=Of(n,e);if(a==null)return X2({insideDestination:t,inHomeList:u,displacedBy:r,destination:e});const f=t.find(x=>x.descriptor.index===a);if(!f)return X2({insideDestination:t,inHomeList:u,displacedBy:r,destination:e});const d=tv(n,t),p=t.indexOf(f),m=d.slice(p);return{displaced:Ud({afterDragging:m,destination:e,displacedBy:r,last:s,viewport:i.frame,forceShouldAnimate:l}),displacedBy:r,at:{type:"REORDER",destination:{droppableId:e.descriptor.id,index:a}}}}function kl(n,t){return!!t.effected[n]}var BB=({isMovingForward:n,destination:t,draggables:e,combine:i,afterCritical:r})=>{if(!t.isCombineEnabled)return null;const s=i.draggableId,l=e[s].descriptor.index;return kl(s,r)?n?l:l-1:n?l+1:l},UB=({isMovingForward:n,isInHomeList:t,insideDestination:e,location:i})=>{if(!e.length)return null;const r=i.index,s=n?r+1:r-1,a=e[0].descriptor.index,l=e[e.length-1].descriptor.index,u=t?l:l+1;return s<a||s>u?null:s},zB=({isMovingForward:n,isInHomeList:t,draggable:e,draggables:i,destination:r,insideDestination:s,previousImpact:a,viewport:l,afterCritical:u})=>{const f=a.at;if(f||oe(),f.type==="REORDER"){const p=UB({isMovingForward:n,isInHomeList:t,location:f.destination,insideDestination:s});return p==null?null:cg({draggable:e,insideDestination:s,destination:r,viewport:l,last:a.displaced,displacedBy:a.displacedBy,index:p})}const d=BB({isMovingForward:n,destination:r,displaced:a.displaced,draggables:i,combine:f.combine,afterCritical:u});return d==null?null:cg({draggable:e,insideDestination:s,destination:r,viewport:l,last:a.displaced,displacedBy:a.displacedBy,index:d})},jB=({displaced:n,afterCritical:t,combineWith:e,displacedBy:i})=>{const r=!!(n.visible[e]||n.invisible[e]);return kl(e,t)?r?Ni:Cf(i.point):r?i.point:Ni},HB=({afterCritical:n,impact:t,draggables:e})=>{const i=Jg(t);i||oe();const r=i.draggableId,s=e[r].page.borderBox.center,a=jB({displaced:t.displaced,afterCritical:n,combineWith:r,displacedBy:t.displacedBy});return ji(s,a)};const XD=(n,t)=>t.margin[n.start]+t.borderBox[n.size]/2,$B=(n,t)=>t.margin[n.end]+t.borderBox[n.size]/2,Pb=(n,t,e)=>t[n.crossAxisStart]+e.margin[n.crossAxisStart]+e.borderBox[n.crossAxisSize]/2,K2=({axis:n,moveRelativeTo:t,isMoving:e})=>Ic(n.line,t.marginBox[n.end]+XD(n,e),Pb(n,t.marginBox,e)),Z2=({axis:n,moveRelativeTo:t,isMoving:e})=>Ic(n.line,t.marginBox[n.start]-$B(n,e),Pb(n,t.marginBox,e)),GB=({axis:n,moveInto:t,isMoving:e})=>Ic(n.line,t.contentBox[n.start]+XD(n,e),Pb(n,t.contentBox,e));var VB=({impact:n,draggable:t,draggables:e,droppable:i,afterCritical:r})=>{const s=Df(i.descriptor.id,e),a=t.page,l=i.axis;if(!s.length)return GB({axis:l,moveInto:i.page,isMoving:a});const{displaced:u,displacedBy:f}=n,d=u.all[0];if(d){const m=e[d];if(kl(d,r))return Z2({axis:l,moveRelativeTo:m.page,isMoving:a});const v=rg(m.page,f.point);return Z2({axis:l,moveRelativeTo:v,isMoving:a})}const p=s[s.length-1];if(p.descriptor.id===t.descriptor.id)return a.borderBox.center;if(kl(p.descriptor.id,r)){const m=rg(p.page,Cf(r.displacedBy.point));return K2({axis:l,moveRelativeTo:m,isMoving:a})}return K2({axis:l,moveRelativeTo:p.page,isMoving:a})},wx=(n,t)=>{const e=n.frame;return e?ji(t,e.scroll.diff.displacement):t};const WB=({impact:n,draggable:t,droppable:e,draggables:i,afterCritical:r})=>{const s=t.page.borderBox.center,a=n.at;return!e||!a?s:a.type==="REORDER"?VB({impact:n,draggable:t,draggables:i,droppable:e,afterCritical:r}):HB({impact:n,draggables:i,afterCritical:r})};var ev=n=>{const t=WB(n),e=n.droppable;return e?wx(e,t):t},KD=(n,t)=>{const e=us(t,n.scroll.initial),i=Cf(e);return{frame:sa({top:t.y,bottom:t.y+n.frame.height,left:t.x,right:t.x+n.frame.width}),scroll:{initial:n.scroll.initial,max:n.scroll.max,current:t,diff:{value:e,displacement:i}}}};function Q2(n,t){return n.map(e=>t[e])}function qB(n,t){for(let e=0;e<t.length;e++){const i=t[e].visible[n];if(i)return i}return null}var YB=({impact:n,viewport:t,destination:e,draggables:i,maxScrollChange:r})=>{const s=KD(t,ji(t.scroll.current,r)),a=e.frame?kb(e,ji(e.frame.scroll.current,r)):e,l=n.displaced,u=Ud({afterDragging:Q2(l.all,i),destination:e,displacedBy:n.displacedBy,viewport:s.frame,last:l,forceShouldAnimate:!1}),f=Ud({afterDragging:Q2(l.all,i),destination:a,displacedBy:n.displacedBy,viewport:t.frame,last:l,forceShouldAnimate:!1}),d={},p={},m=[l,u,f];return l.all.forEach(x=>{const _=qB(x,m);if(_){p[x]=_;return}d[x]=!0}),{...n,displaced:{all:l.all,invisible:d,visible:p}}},XB=(n,t)=>ji(n.scroll.diff.displacement,t),Fb=({pageBorderBoxCenter:n,draggable:t,viewport:e})=>{const i=XB(e,n),r=us(i,t.page.borderBox.center);return ji(t.client.borderBox.center,r)},ZD=({draggable:n,destination:t,newPageBorderBoxCenter:e,viewport:i,withDroppableDisplacement:r,onlyOnMainAxis:s=!1})=>{const a=us(e,n.page.borderBox.center),u={target:dp(n.page.borderBox,a),destination:t,withDroppableDisplacement:r,viewport:i};return s?IB(u):YD(u)},KB=({isMovingForward:n,draggable:t,destination:e,draggables:i,previousImpact:r,viewport:s,previousPageBorderBoxCenter:a,previousClientSelection:l,afterCritical:u})=>{if(!e.isEnabled)return null;const f=Df(e.descriptor.id,i),d=Of(t,e),p=TB({isMovingForward:n,draggable:t,destination:e,insideDestination:f,previousImpact:r})||zB({isMovingForward:n,isInHomeList:d,draggable:t,draggables:i,destination:e,insideDestination:f,previousImpact:r,viewport:s,afterCritical:u});if(!p)return null;const m=ev({impact:p,draggable:t,droppable:e,draggables:i,afterCritical:u});if(ZD({draggable:t,destination:e,newPageBorderBoxCenter:m,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:Fb({pageBorderBoxCenter:m,draggable:t,viewport:s}),impact:p,scrollJumpRequest:null};const x=us(m,a),_=YB({impact:p,viewport:s,destination:e,draggables:i,maxScrollChange:x});return{clientSelection:l,impact:_,scrollJumpRequest:x}};const _r=n=>{const t=n.subject.active;return t||oe(),t};var ZB=({isMovingForward:n,pageBorderBoxCenter:t,source:e,droppables:i,viewport:r})=>{const s=e.subject.active;if(!s)return null;const a=e.axis,l=Fs(s[a.start],s[a.end]),u=Qg(i).filter(d=>d!==e).filter(d=>d.isEnabled).filter(d=>!!d.subject.active).filter(d=>WD(r.frame)(_r(d))).filter(d=>{const p=_r(d);return n?s[a.crossAxisEnd]<p[a.crossAxisEnd]:p[a.crossAxisStart]<s[a.crossAxisStart]}).filter(d=>{const p=_r(d),m=Fs(p[a.start],p[a.end]);return l(p[a.start])||l(p[a.end])||m(s[a.start])||m(s[a.end])}).sort((d,p)=>{const m=_r(d)[a.crossAxisStart],v=_r(p)[a.crossAxisStart];return n?m-v:v-m}).filter((d,p,m)=>_r(d)[a.crossAxisStart]===_r(m[0])[a.crossAxisStart]);if(!u.length)return null;if(u.length===1)return u[0];const f=u.filter(d=>Fs(_r(d)[a.start],_r(d)[a.end])(t[a.line]));return f.length===1?f[0]:f.length>1?f.sort((d,p)=>_r(d)[a.start]-_r(p)[a.start])[0]:u.sort((d,p)=>{const m=q2(t,Y2(_r(d))),v=q2(t,Y2(_r(p)));return m!==v?m-v:_r(d)[a.start]-_r(p)[a.start]})[0]};const J2=(n,t)=>{const e=n.page.borderBox.center;return kl(n.descriptor.id,t)?us(e,t.displacedBy.point):e},QB=(n,t)=>{const e=n.page.borderBox;return kl(n.descriptor.id,t)?dp(e,Cf(t.displacedBy.point)):e};var JB=({pageBorderBoxCenter:n,viewport:t,destination:e,insideDestination:i,afterCritical:r})=>i.filter(a=>YD({target:QB(a,r),destination:e,viewport:t.frame,withDroppableDisplacement:!0})).sort((a,l)=>{const u=Fd(n,wx(e,J2(a,r))),f=Fd(n,wx(e,J2(l,r)));return u<f?-1:f<u?1:a.descriptor.index-l.descriptor.index})[0]||null,pp=Ri(function(t,e){const i=e[t.line];return{value:i,point:Ic(t.line,i)}});const tU=(n,t,e)=>{const i=n.axis;if(n.descriptor.mode==="virtual")return Ic(i.line,t[i.line]);const r=n.subject.page.contentBox[i.size],u=Df(n.descriptor.id,e).reduce((f,d)=>f+d.client.marginBox[i.size],0)+t[i.line]-r;return u<=0?null:Ic(i.line,u)},QD=(n,t)=>({...n,scroll:{...n.scroll,max:t}}),JD=(n,t,e)=>{const i=n.frame;Of(t,n)&&oe(),n.subject.withPlaceholder&&oe();const r=pp(n.axis,t.displaceBy).point,s=tU(n,r,e),a={placeholderSize:r,increasedBy:s,oldFrameMaxScroll:n.frame?n.frame.scroll.max:null};if(!i){const d=gf({page:n.subject.page,withPlaceholder:a,axis:n.axis,frame:n.frame});return{...n,subject:d}}const l=s?ji(i.scroll.max,s):i.scroll.max,u=QD(i,l),f=gf({page:n.subject.page,withPlaceholder:a,axis:n.axis,frame:u});return{...n,subject:f,frame:u}},eU=n=>{const t=n.subject.withPlaceholder;t||oe();const e=n.frame;if(!e){const a=gf({page:n.subject.page,axis:n.axis,frame:null,withPlaceholder:null});return{...n,subject:a}}const i=t.oldFrameMaxScroll;i||oe();const r=QD(e,i),s=gf({page:n.subject.page,axis:n.axis,frame:r,withPlaceholder:null});return{...n,subject:s,frame:r}};var nU=({previousPageBorderBoxCenter:n,moveRelativeTo:t,insideDestination:e,draggable:i,draggables:r,destination:s,viewport:a,afterCritical:l})=>{if(!t){if(e.length)return null;const p={displaced:Bd,displacedBy:VD,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:0}}},m=ev({impact:p,draggable:i,droppable:s,draggables:r,afterCritical:l}),v=Of(i,s)?s:JD(s,i,r);return ZD({draggable:i,destination:v,newPageBorderBoxCenter:m,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?p:null}const u=n[s.axis.line]<=t.page.borderBox.center[s.axis.line],f=(()=>{const p=t.descriptor.index;return t.descriptor.id===i.descriptor.id||u?p:p+1})(),d=pp(s.axis,i.displaceBy);return cg({draggable:i,insideDestination:e,destination:s,viewport:a,displacedBy:d,last:Bd,index:f})},iU=({isMovingForward:n,previousPageBorderBoxCenter:t,draggable:e,isOver:i,draggables:r,droppables:s,viewport:a,afterCritical:l})=>{const u=ZB({isMovingForward:n,pageBorderBoxCenter:t,source:i,droppables:s,viewport:a});if(!u)return null;const f=Df(u.descriptor.id,r),d=JB({pageBorderBoxCenter:t,viewport:a,destination:u,insideDestination:f,afterCritical:l}),p=nU({previousPageBorderBoxCenter:t,destination:u,draggable:e,draggables:r,moveRelativeTo:d,insideDestination:f,viewport:a,afterCritical:l});if(!p)return null;const m=ev({impact:p,draggable:e,droppable:u,draggables:r,afterCritical:l});return{clientSelection:Fb({pageBorderBoxCenter:m,draggable:e,viewport:a}),impact:p,scrollJumpRequest:null}},hs=n=>{const t=n.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const rU=(n,t)=>{const e=hs(n);return e?t[e]:null};var sU=({state:n,type:t})=>{const e=rU(n.impact,n.dimensions.droppables),i=!!e,r=n.dimensions.droppables[n.critical.droppable.id],s=e||r,a=s.axis.direction,l=a==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||a==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(l&&!i)return null;const u=t==="MOVE_DOWN"||t==="MOVE_RIGHT",f=n.dimensions.draggables[n.critical.draggable.id],d=n.current.page.borderBoxCenter,{draggables:p,droppables:m}=n.dimensions;return l?KB({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:f,destination:s,draggables:p,viewport:n.viewport,previousClientSelection:n.current.client.selection,previousImpact:n.impact,afterCritical:n.afterCritical}):iU({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:f,isOver:s,draggables:p,droppables:m,viewport:n.viewport,afterCritical:n.afterCritical})};function mc(n){return n.phase==="DRAGGING"||n.phase==="COLLECTING"}function tO(n){const t=Fs(n.top,n.bottom),e=Fs(n.left,n.right);return function(r){return t(r.y)&&e(r.x)}}function aU(n,t){return n.left<t.right&&n.right>t.left&&n.top<t.bottom&&n.bottom>t.top}function oU({pageBorderBox:n,draggable:t,candidates:e}){const i=t.page.borderBox.center,r=e.map(s=>{const a=s.axis,l=Ic(s.axis.line,n.center[a.line],s.page.borderBox.center[a.crossAxisLine]);return{id:s.descriptor.id,distance:Fd(i,l)}}).sort((s,a)=>a.distance-s.distance);return r[0]?r[0].id:null}function lU({pageBorderBox:n,draggable:t,droppables:e}){const i=Qg(e).filter(r=>{if(!r.isEnabled)return!1;const s=r.subject.active;if(!s||!aU(n,s))return!1;if(tO(s)(n.center))return!0;const a=r.axis,l=s.center[a.crossAxisLine],u=n[a.crossAxisStart],f=n[a.crossAxisEnd],d=Fs(s[a.crossAxisStart],s[a.crossAxisEnd]),p=d(u),m=d(f);return!p&&!m?!0:p?u<l:f>l});return i.length?i.length===1?i[0].descriptor.id:oU({pageBorderBox:n,draggable:t,candidates:i}):null}const eO=(n,t)=>sa(dp(n,t));var cU=(n,t)=>{const e=n.frame;return e?eO(t,e.scroll.diff.value):t};function nO({displaced:n,id:t}){return!!(n.visible[t]||n.invisible[t])}function uU({draggable:n,closest:t,inHomeList:e}){return t?e&&t.descriptor.index>n.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var fU=({pageBorderBoxWithDroppableScroll:n,draggable:t,destination:e,insideDestination:i,last:r,viewport:s,afterCritical:a})=>{const l=e.axis,u=pp(e.axis,t.displaceBy),f=u.value,d=n[l.start],p=n[l.end],v=tv(t,i).find(_=>{const b=_.descriptor.id,E=_.page.borderBox.center[l.line],T=kl(b,a),S=nO({displaced:r,id:b});return T?S?p<=E:d<E-f:S?p<=E+f:d<E})||null,x=uU({draggable:t,closest:v,inHomeList:Of(t,e)});return cg({draggable:t,insideDestination:i,destination:e,viewport:s,last:r,displacedBy:u,index:x})};const hU=4;var dU=({draggable:n,pageBorderBoxWithDroppableScroll:t,previousImpact:e,destination:i,insideDestination:r,afterCritical:s})=>{if(!i.isCombineEnabled)return null;const a=i.axis,l=pp(i.axis,n.displaceBy),u=l.value,f=t[a.start],d=t[a.end],m=tv(n,r).find(x=>{const _=x.descriptor.id,b=x.page.borderBox,T=b[a.size]/hU,S=kl(_,s),O=nO({displaced:e.displaced,id:_});return S?O?d>b[a.start]+T&&d<b[a.end]-T:f>b[a.start]-u+T&&f<b[a.end]-u-T:O?d>b[a.start]+u+T&&d<b[a.end]+u-T:f>b[a.start]+T&&f<b[a.end]-T});return m?{displacedBy:l,displaced:e.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:i.descriptor.id}}}:null},iO=({pageOffset:n,draggable:t,draggables:e,droppables:i,previousImpact:r,viewport:s,afterCritical:a})=>{const l=eO(t.page.borderBox,n),u=lU({pageBorderBox:l,draggable:t,droppables:i});if(!u)return CB;const f=i[u],d=Df(f.descriptor.id,e),p=cU(f,l);return dU({pageBorderBoxWithDroppableScroll:p,draggable:t,previousImpact:r,destination:f,insideDestination:d,afterCritical:a})||fU({pageBorderBoxWithDroppableScroll:p,draggable:t,destination:f,insideDestination:d,last:r.displaced,viewport:s,afterCritical:a})},Bb=(n,t)=>({...n,[t.descriptor.id]:t});const pU=({previousImpact:n,impact:t,droppables:e})=>{const i=hs(n),r=hs(t);if(!i||i===r)return e;const s=e[i];if(!s.subject.withPlaceholder)return e;const a=eU(s);return Bb(e,a)};var mU=({draggable:n,draggables:t,droppables:e,previousImpact:i,impact:r})=>{const s=pU({previousImpact:i,impact:r,droppables:e}),a=hs(r);if(!a)return s;const l=e[a];if(Of(n,l)||l.subject.withPlaceholder)return s;const u=JD(l,n,t);return Bb(s,u)},Ed=({state:n,clientSelection:t,dimensions:e,viewport:i,impact:r,scrollJumpRequest:s})=>{const a=i||n.viewport,l=e||n.dimensions,u=t||n.current.client.selection,f=us(u,n.initial.client.selection),d={offset:f,selection:u,borderBoxCenter:ji(n.initial.client.borderBoxCenter,f)},p={selection:ji(d.selection,a.scroll.current),borderBoxCenter:ji(d.borderBoxCenter,a.scroll.current),offset:ji(d.offset,a.scroll.diff.value)},m={client:d,page:p};if(n.phase==="COLLECTING")return{...n,dimensions:l,viewport:a,current:m};const v=l.draggables[n.critical.draggable.id],x=r||iO({pageOffset:p.offset,draggable:v,draggables:l.draggables,droppables:l.droppables,previousImpact:n.impact,viewport:a,afterCritical:n.afterCritical}),_=mU({draggable:v,impact:x,previousImpact:n.impact,draggables:l.draggables,droppables:l.droppables});return{...n,current:m,dimensions:{draggables:l.draggables,droppables:_},impact:x,viewport:a,scrollJumpRequest:s||null,forceShouldAnimate:s?!1:null}};function gU(n,t){return n.map(e=>t[e])}var rO=({impact:n,viewport:t,draggables:e,destination:i,forceShouldAnimate:r})=>{const s=n.displaced,a=gU(s.all,e),l=Ud({afterDragging:a,destination:i,displacedBy:n.displacedBy,viewport:t.frame,forceShouldAnimate:r,last:s});return{...n,displaced:l}},sO=({impact:n,draggable:t,droppable:e,draggables:i,viewport:r,afterCritical:s})=>{const a=ev({impact:n,draggable:t,draggables:i,droppable:e,afterCritical:s});return Fb({pageBorderBoxCenter:a,draggable:t,viewport:r})},aO=({state:n,dimensions:t,viewport:e})=>{n.movementMode!=="SNAP"&&oe();const i=n.impact,r=e||n.viewport,s=t||n.dimensions,{draggables:a,droppables:l}=s,u=a[n.critical.draggable.id],f=hs(i);f||oe();const d=l[f],p=rO({impact:i,viewport:r,destination:d,draggables:a}),m=sO({impact:p,draggable:u,droppable:d,draggables:a,viewport:r,afterCritical:n.afterCritical});return Ed({impact:p,clientSelection:m,state:n,dimensions:s,viewport:r})},vU=n=>({index:n.index,droppableId:n.droppableId}),oO=({draggable:n,home:t,draggables:e,viewport:i})=>{const r=pp(t.axis,n.displaceBy),s=Df(t.descriptor.id,e),a=s.indexOf(n);a===-1&&oe();const l=s.slice(a+1),u=l.reduce((m,v)=>(m[v.descriptor.id]=!0,m),{}),f={inVirtualList:t.descriptor.mode==="virtual",displacedBy:r,effected:u};return{impact:{displaced:Ud({afterDragging:l,destination:t,displacedBy:r,last:null,viewport:i.frame,forceShouldAnimate:!1}),displacedBy:r,at:{type:"REORDER",destination:vU(n.descriptor)}},afterCritical:f}},_U=(n,t)=>({draggables:n.draggables,droppables:Bb(n.droppables,t)}),xU=({draggable:n,offset:t,initialWindowScroll:e})=>{const i=rg(n.client,t),r=sg(i,e);return{...n,placeholder:{...n.placeholder,client:i},client:i,page:r}},bU=n=>{const t=n.frame;return t||oe(),t},yU=({additions:n,updatedDroppables:t,viewport:e})=>{const i=e.scroll.diff.value;return n.map(r=>{const s=r.descriptor.droppableId,a=t[s],u=bU(a).scroll.diff.value,f=ji(i,u);return xU({draggable:r,offset:f,initialWindowScroll:e.scroll.initial})})},EU=({state:n,published:t})=>{const e=t.modified.map(E=>{const T=n.dimensions.droppables[E.droppableId];return kb(T,E.scroll)}),i={...n.dimensions.droppables,...$D(e)},r=GD(yU({additions:t.additions,updatedDroppables:i,viewport:n.viewport})),s={...n.dimensions.draggables,...r};t.removals.forEach(E=>{delete s[E]});const a={droppables:i,draggables:s},l=hs(n.impact),u=l?a.droppables[l]:null,f=a.draggables[n.critical.draggable.id],d=a.droppables[n.critical.droppable.id],{impact:p,afterCritical:m}=oO({draggable:f,home:d,draggables:s,viewport:n.viewport}),v=u&&u.isCombineEnabled?n.impact:p,x=iO({pageOffset:n.current.page.offset,draggable:a.draggables[n.critical.draggable.id],draggables:a.draggables,droppables:a.droppables,previousImpact:v,viewport:n.viewport,afterCritical:m}),_={...n,phase:"DRAGGING",impact:x,onLiftImpact:p,dimensions:a,afterCritical:m,forceShouldAnimate:!1};return n.phase==="COLLECTING"?_:{..._,phase:"DROP_PENDING",reason:n.reason,isWaiting:!1}};const Ax=n=>n.movementMode==="SNAP",O_=(n,t,e)=>{const i=_U(n.dimensions,t);return!Ax(n)||e?Ed({state:n,dimensions:i}):aO({state:n,dimensions:i})};function R_(n){return n.isDragging&&n.movementMode==="SNAP"?{...n,scrollJumpRequest:null}:n}const tS={phase:"IDLE",completed:null,shouldFlush:!1};var wU=(n=tS,t)=>{if(t.type==="FLUSH")return{...tS,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){n.phase!=="IDLE"&&oe();const{critical:e,clientSelection:i,viewport:r,dimensions:s,movementMode:a}=t.payload,l=s.draggables[e.draggable.id],u=s.droppables[e.droppable.id],f={selection:i,borderBoxCenter:l.client.borderBox.center,offset:Ni},d={client:f,page:{selection:ji(f.selection,r.scroll.initial),borderBoxCenter:ji(f.selection,r.scroll.initial),offset:ji(f.selection,r.scroll.diff.value)}},p=Qg(s.droppables).every(_=>!_.isFixedOnPage),{impact:m,afterCritical:v}=oO({draggable:l,home:u,draggables:s.draggables,viewport:r});return{phase:"DRAGGING",isDragging:!0,critical:e,movementMode:a,dimensions:s,initial:d,current:d,isWindowScrollAllowed:p,impact:m,afterCritical:v,onLiftImpact:m,viewport:r,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"?n:(n.phase!=="DRAGGING"&&oe(),{...n,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"||oe(),EU({state:n,published:t.payload});if(t.type==="MOVE"){if(n.phase==="DROP_PENDING")return n;mc(n)||oe();const{client:e}=t.payload;return Cl(e,n.current.client.selection)?n:Ed({state:n,clientSelection:e,impact:Ax(n)?n.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="COLLECTING")return R_(n);mc(n)||oe();const{id:e,newScroll:i}=t.payload,r=n.dimensions.droppables[e];if(!r)return n;const s=kb(r,i);return O_(n,s,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(n.phase==="DROP_PENDING")return n;mc(n)||oe();const{id:e,isEnabled:i}=t.payload,r=n.dimensions.droppables[e];r||oe(),r.isEnabled===i&&oe();const s={...r,isEnabled:i};return O_(n,s,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(n.phase==="DROP_PENDING")return n;mc(n)||oe();const{id:e,isCombineEnabled:i}=t.payload,r=n.dimensions.droppables[e];r||oe(),r.isCombineEnabled===i&&oe();const s={...r,isCombineEnabled:i};return O_(n,s,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="DROP_ANIMATING")return n;mc(n)||oe(),n.isWindowScrollAllowed||oe();const e=t.payload.newScroll;if(Cl(n.viewport.scroll.current,e))return R_(n);const i=KD(n.viewport,e);return Ax(n)?aO({state:n,viewport:i}):Ed({state:n,viewport:i})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!mc(n))return n;const e=t.payload.maxScroll;if(Cl(e,n.viewport.scroll.max))return n;const i={...n.viewport,scroll:{...n.viewport.scroll,max:e}};return{...n,viewport:i}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(n.phase==="COLLECTING"||n.phase==="DROP_PENDING")return n;n.phase!=="DRAGGING"&&oe();const e=sU({state:n,type:t.type});return e?Ed({state:n,impact:e.impact,clientSelection:e.clientSelection,scrollJumpRequest:e.scrollJumpRequest}):n}if(t.type==="DROP_PENDING"){const e=t.payload.reason;return n.phase!=="COLLECTING"&&oe(),{...n,phase:"DROP_PENDING",isWaiting:!0,reason:e}}if(t.type==="DROP_ANIMATE"){const{completed:e,dropDuration:i,newHomeClientOffset:r}=t.payload;return n.phase==="DRAGGING"||n.phase==="DROP_PENDING"||oe(),{phase:"DROP_ANIMATING",completed:e,dropDuration:i,newHomeClientOffset:r,dimensions:n.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:e}=t.payload;return{phase:"IDLE",completed:e,shouldFlush:!1}}return n};function hn(n,t){return n instanceof Object&&"type"in n&&n.type===t}const AU=n=>({type:"BEFORE_INITIAL_CAPTURE",payload:n}),SU=n=>({type:"LIFT",payload:n}),TU=n=>({type:"INITIAL_PUBLISH",payload:n}),CU=n=>({type:"PUBLISH_WHILE_DRAGGING",payload:n}),DU=()=>({type:"COLLECTION_STARTING",payload:null}),OU=n=>({type:"UPDATE_DROPPABLE_SCROLL",payload:n}),RU=n=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:n}),NU=n=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:n}),lO=n=>({type:"MOVE",payload:n}),kU=n=>({type:"MOVE_BY_WINDOW_SCROLL",payload:n}),LU=n=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:n}),IU=()=>({type:"MOVE_UP",payload:null}),MU=()=>({type:"MOVE_DOWN",payload:null}),PU=()=>({type:"MOVE_RIGHT",payload:null}),FU=()=>({type:"MOVE_LEFT",payload:null}),Ub=()=>({type:"FLUSH",payload:null}),BU=n=>({type:"DROP_ANIMATE",payload:n}),zb=n=>({type:"DROP_COMPLETE",payload:n}),cO=n=>({type:"DROP",payload:n}),UU=n=>({type:"DROP_PENDING",payload:n}),uO=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var zU=n=>({getState:t,dispatch:e})=>i=>r=>{if(!hn(r,"LIFT")){i(r);return}const{id:s,clientSelection:a,movementMode:l}=r.payload,u=t();u.phase==="DROP_ANIMATING"&&e(zb({completed:u.completed})),t().phase!=="IDLE"&&oe(),e(Ub()),e(AU({draggableId:s,movementMode:l}));const d={draggableId:s,scrollOptions:{shouldPublishImmediately:l==="SNAP"}},{critical:p,dimensions:m,viewport:v}=n.startPublishing(d);e(TU({critical:p,dimensions:m,clientSelection:a,movementMode:l,viewport:v}))},jU=n=>()=>t=>e=>{hn(e,"INITIAL_PUBLISH")&&n.dragging(),hn(e,"DROP_ANIMATE")&&n.dropping(e.payload.completed.result.reason),(hn(e,"FLUSH")||hn(e,"DROP_COMPLETE"))&&n.resting(),t(e)};const jb={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},zd={opacity:{drop:0,combining:.7},scale:{drop:.75}},fO={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},dc=`${fO.outOfTheWay}s ${jb.outOfTheWay}`,wd={fluid:`opacity ${dc}`,snap:`transform ${dc}, opacity ${dc}`,drop:n=>{const t=`${n}s ${jb.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${dc}`,placeholder:`height ${dc}, width ${dc}, margin ${dc}`},eS=n=>Cl(n,Ni)?void 0:`translate(${n.x}px, ${n.y}px)`,Sx={moveTo:eS,drop:(n,t)=>{const e=eS(n);if(e)return t?`${e} scale(${zd.scale.drop})`:e}},{minDropTime:Tx,maxDropTime:hO}=fO,HU=hO-Tx,nS=1500,$U=.6;var GU=({current:n,destination:t,reason:e})=>{const i=Fd(n,t);if(i<=0)return Tx;if(i>=nS)return hO;const r=i/nS,s=Tx+HU*r,a=e==="CANCEL"?s*$U:s;return Number(a.toFixed(2))},VU=({impact:n,draggable:t,dimensions:e,viewport:i,afterCritical:r})=>{const{draggables:s,droppables:a}=e,l=hs(n),u=l?a[l]:null,f=a[t.descriptor.droppableId],d=sO({impact:n,draggable:t,draggables:s,afterCritical:r,droppable:u||f,viewport:i});return us(d,t.client.borderBox.center)},WU=({draggables:n,reason:t,lastImpact:e,home:i,viewport:r,onLiftImpact:s})=>!e.at||t!=="DROP"?{impact:rO({draggables:n,impact:s,destination:i,viewport:r,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:e.at.type==="REORDER"?{impact:e,didDropInsideDroppable:!0}:{impact:{...e,displaced:Bd},didDropInsideDroppable:!0};const qU=({getState:n,dispatch:t})=>e=>i=>{if(!hn(i,"DROP")){e(i);return}const r=n(),s=i.payload.reason;if(r.phase==="COLLECTING"){t(UU({reason:s}));return}if(r.phase==="IDLE")return;r.phase==="DROP_PENDING"&&r.isWaiting&&oe(),r.phase==="DRAGGING"||r.phase==="DROP_PENDING"||oe();const l=r.critical,u=r.dimensions,f=u.draggables[r.critical.draggable.id],{impact:d,didDropInsideDroppable:p}=WU({reason:s,lastImpact:r.impact,afterCritical:r.afterCritical,onLiftImpact:r.onLiftImpact,home:r.dimensions.droppables[r.critical.droppable.id],viewport:r.viewport,draggables:r.dimensions.draggables}),m=p?Lb(d):null,v=p?Jg(d):null,x={index:l.draggable.index,droppableId:l.droppable.id},_={draggableId:f.descriptor.id,type:f.descriptor.type,source:x,reason:s,mode:r.movementMode,destination:m,combine:v},b=VU({impact:d,draggable:f,dimensions:u,viewport:r.viewport,afterCritical:r.afterCritical}),E={critical:r.critical,afterCritical:r.afterCritical,result:_,impact:d};if(!(!Cl(r.current.client.offset,b)||!!_.combine)){t(zb({completed:E}));return}const S=GU({current:r.current.client.offset,destination:b,reason:s});t(BU({newHomeClientOffset:b,dropDuration:S,completed:E}))};var dO=()=>({x:window.pageXOffset,y:window.pageYOffset});function YU(n){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||n()}}}function XU({onWindowScroll:n}){function t(){n(dO())}const e=Pd(t),i=YU(e);let r=Tl;function s(){return r!==Tl}function a(){s()&&oe(),r=Ms(window,[i])}function l(){s()||oe(),e.cancel(),r(),r=Tl}return{start:a,stop:l,isActive:s}}const KU=n=>hn(n,"DROP_COMPLETE")||hn(n,"DROP_ANIMATE")||hn(n,"FLUSH"),ZU=n=>{const t=XU({onWindowScroll:e=>{n.dispatch(kU({newScroll:e}))}});return e=>i=>{!t.isActive()&&hn(i,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&KU(i)&&t.stop(),e(i)}};var QU=n=>{let t=!1,e=!1;const i=setTimeout(()=>{e=!0}),r=s=>{t||e||(t=!0,n(s),clearTimeout(i))};return r.wasCalled=()=>t,r},JU=()=>{const n=[],t=r=>{const s=n.findIndex(l=>l.timerId===r);s===-1&&oe();const[a]=n.splice(s,1);a.callback()};return{add:r=>{const s=setTimeout(()=>t(s)),a={timerId:s,callback:r};n.push(a)},flush:()=>{if(!n.length)return;const r=[...n];n.length=0,r.forEach(s=>{clearTimeout(s.timerId),s.callback()})}}};const tz=(n,t)=>n==null&&t==null?!0:n==null||t==null?!1:n.droppableId===t.droppableId&&n.index===t.index,ez=(n,t)=>n==null&&t==null?!0:n==null||t==null?!1:n.draggableId===t.draggableId&&n.droppableId===t.droppableId,nz=(n,t)=>{if(n===t)return!0;const e=n.draggable.id===t.draggable.id&&n.draggable.droppableId===t.draggable.droppableId&&n.draggable.type===t.draggable.type&&n.draggable.index===t.draggable.index,i=n.droppable.id===t.droppable.id&&n.droppable.type===t.droppable.type;return e&&i},od=(n,t)=>{t()},_m=(n,t)=>({draggableId:n.draggable.id,type:n.droppable.type,source:{droppableId:n.droppable.id,index:n.draggable.index},mode:t});function N_(n,t,e,i){if(!n){e(i(t));return}const r=QU(e);n(t,{announce:r}),r.wasCalled()||e(i(t))}var iz=(n,t)=>{const e=JU();let i=null;const r=(p,m)=>{i&&oe(),od("onBeforeCapture",()=>{const v=n().onBeforeCapture;v&&v({draggableId:p,mode:m})})},s=(p,m)=>{i&&oe(),od("onBeforeDragStart",()=>{const v=n().onBeforeDragStart;v&&v(_m(p,m))})},a=(p,m)=>{i&&oe();const v=_m(p,m);i={mode:m,lastCritical:p,lastLocation:v.source,lastCombine:null},e.add(()=>{od("onDragStart",()=>N_(n().onDragStart,v,t,Wm.onDragStart))})},l=(p,m)=>{const v=Lb(m),x=Jg(m);i||oe();const _=!nz(p,i.lastCritical);_&&(i.lastCritical=p);const b=!tz(i.lastLocation,v);b&&(i.lastLocation=v);const E=!ez(i.lastCombine,x);if(E&&(i.lastCombine=x),!_&&!b&&!E)return;const T={..._m(p,i.mode),combine:x,destination:v};e.add(()=>{od("onDragUpdate",()=>N_(n().onDragUpdate,T,t,Wm.onDragUpdate))})},u=()=>{i||oe(),e.flush()},f=p=>{i||oe(),i=null,od("onDragEnd",()=>N_(n().onDragEnd,p,t,Wm.onDragEnd))};return{beforeCapture:r,beforeStart:s,start:a,update:l,flush:u,drop:f,abort:()=>{if(!i)return;const p={..._m(i.lastCritical,i.mode),combine:null,destination:null,reason:"CANCEL"};f(p)}}},rz=(n,t)=>{const e=iz(n,t);return i=>r=>s=>{if(hn(s,"BEFORE_INITIAL_CAPTURE")){e.beforeCapture(s.payload.draggableId,s.payload.movementMode);return}if(hn(s,"INITIAL_PUBLISH")){const l=s.payload.critical;e.beforeStart(l,s.payload.movementMode),r(s),e.start(l,s.payload.movementMode);return}if(hn(s,"DROP_COMPLETE")){const l=s.payload.completed.result;e.flush(),r(s),e.drop(l);return}if(r(s),hn(s,"FLUSH")){e.abort();return}const a=i.getState();a.phase==="DRAGGING"&&e.update(a.critical,a.impact)}};const sz=n=>t=>e=>{if(!hn(e,"DROP_ANIMATION_FINISHED")){t(e);return}const i=n.getState();i.phase!=="DROP_ANIMATING"&&oe(),n.dispatch(zb({completed:i.completed}))},az=n=>{let t=null,e=null;function i(){e&&(cancelAnimationFrame(e),e=null),t&&(t(),t=null)}return r=>s=>{if((hn(s,"FLUSH")||hn(s,"DROP_COMPLETE")||hn(s,"DROP_ANIMATION_FINISHED"))&&i(),r(s),!hn(s,"DROP_ANIMATE"))return;const a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){n.getState().phase==="DROP_ANIMATING"&&n.dispatch(uO())}};e=requestAnimationFrame(()=>{e=null,t=Ms(window,[a])})}};var oz=n=>()=>t=>e=>{(hn(e,"DROP_COMPLETE")||hn(e,"FLUSH")||hn(e,"DROP_ANIMATE"))&&n.stopPublishing(),t(e)},lz=n=>{let t=!1;return()=>e=>i=>{if(hn(i,"INITIAL_PUBLISH")){t=!0,n.tryRecordFocus(i.payload.critical.draggable.id),e(i),n.tryRestoreFocusRecorded();return}if(e(i),!!t){if(hn(i,"FLUSH")){t=!1,n.tryRestoreFocusRecorded();return}if(hn(i,"DROP_COMPLETE")){t=!1;const r=i.payload.completed.result;r.combine&&n.tryShiftRecord(r.draggableId,r.combine.draggableId),n.tryRestoreFocusRecorded()}}}};const cz=n=>hn(n,"DROP_COMPLETE")||hn(n,"DROP_ANIMATE")||hn(n,"FLUSH");var uz=n=>t=>e=>i=>{if(cz(i)){n.stop(),e(i);return}if(hn(i,"INITIAL_PUBLISH")){e(i);const r=t.getState();r.phase!=="DRAGGING"&&oe(),n.start(r);return}e(i),n.scroll(t.getState())};const fz=n=>t=>e=>{if(t(e),!hn(e,"PUBLISH_WHILE_DRAGGING"))return;const i=n.getState();i.phase==="DROP_PENDING"&&(i.isWaiting||n.dispatch(cO({reason:i.reason})))},hz=OD;var dz=({dimensionMarshal:n,focusMarshal:t,styleMarshal:e,getResponders:i,announce:r,autoScroller:s})=>DD(wU,hz(h8(jU(e),oz(n),zU(n),qU,sz,az,fz,uz(s),ZU,lz(t),rz(i,r))));const k_=()=>({additions:{},removals:{},modified:{}});function pz({registry:n,callbacks:t}){let e=k_(),i=null;const r=()=>{i||(t.collectionStarting(),i=requestAnimationFrame(()=>{i=null;const{additions:u,removals:f,modified:d}=e,p=Object.keys(u).map(x=>n.draggable.getById(x).getDimension(Ni)).sort((x,_)=>x.descriptor.index-_.descriptor.index),m=Object.keys(d).map(x=>{const b=n.droppable.getById(x).callbacks.getScrollWhileDragging();return{droppableId:x,scroll:b}}),v={additions:p,removals:Object.keys(f),modified:m};e=k_(),t.publish(v)}))};return{add:u=>{const f=u.descriptor.id;e.additions[f]=u,e.modified[u.descriptor.droppableId]=!0,e.removals[f]&&delete e.removals[f],r()},remove:u=>{const f=u.descriptor;e.removals[f.id]=!0,e.modified[f.droppableId]=!0,e.additions[f.id]&&delete e.additions[f.id],r()},stop:()=>{i&&(cancelAnimationFrame(i),i=null,e=k_())}}}var pO=({scrollHeight:n,scrollWidth:t,height:e,width:i})=>{const r=us({x:t,y:n},{x:i,y:e});return{x:Math.max(0,r.x),y:Math.max(0,r.y)}},mO=()=>{const n=document.documentElement;return n||oe(),n},gO=()=>{const n=mO();return pO({scrollHeight:n.scrollHeight,scrollWidth:n.scrollWidth,width:n.clientWidth,height:n.clientHeight})},mz=()=>{const n=dO(),t=gO(),e=n.y,i=n.x,r=mO(),s=r.clientWidth,a=r.clientHeight,l=i+s,u=e+a;return{frame:sa({top:e,left:i,right:l,bottom:u}),scroll:{initial:n,current:n,max:t,diff:{value:Ni,displacement:Ni}}}},gz=({critical:n,scrollOptions:t,registry:e})=>{const i=mz(),r=i.scroll.current,s=n.droppable,a=e.droppable.getAllByType(s.type).map(d=>d.callbacks.getDimensionAndWatchScroll(r,t)),l=e.draggable.getAllByType(n.draggable.type).map(d=>d.getDimension(r));return{dimensions:{draggables:GD(l),droppables:$D(a)},critical:n,viewport:i}};function iS(n,t,e){return!(e.descriptor.id===t.id||e.descriptor.type!==t.type||n.droppable.getById(e.descriptor.droppableId).descriptor.mode!=="virtual")}var vz=(n,t)=>{let e=null;const i=pz({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:n}),r=(m,v)=>{n.droppable.exists(m)||oe(),e&&t.updateDroppableIsEnabled({id:m,isEnabled:v})},s=(m,v)=>{e&&(n.droppable.exists(m)||oe(),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:v}))},a=(m,v)=>{e&&(n.droppable.exists(m)||oe(),t.updateDroppableScroll({id:m,newScroll:v}))},l=(m,v)=>{e&&n.droppable.getById(m).callbacks.scroll(v)},u=()=>{if(!e)return;i.stop();const m=e.critical.droppable;n.droppable.getAllByType(m.type).forEach(v=>v.callbacks.dragStopped()),e.unsubscribe(),e=null},f=m=>{e||oe();const v=e.critical.draggable;m.type==="ADDITION"&&iS(n,v,m.value)&&i.add(m.value),m.type==="REMOVAL"&&iS(n,v,m.value)&&i.remove(m.value)};return{updateDroppableIsEnabled:r,updateDroppableIsCombineEnabled:s,scrollDroppable:l,updateDroppableScroll:a,startPublishing:m=>{e&&oe();const v=n.draggable.getById(m.draggableId),x=n.droppable.getById(v.descriptor.droppableId),_={draggable:v.descriptor,droppable:x.descriptor},b=n.subscribe(f);return e={critical:_,unsubscribe:b},gz({critical:_,registry:n,scrollOptions:m.scrollOptions})},stopPublishing:u}},vO=(n,t)=>n.phase==="IDLE"?!0:n.phase!=="DROP_ANIMATING"||n.completed.result.draggableId===t?!1:n.completed.result.reason==="DROP",_z=n=>{window.scrollBy(n.x,n.y)};const xz=Ri(n=>Qg(n).filter(t=>!(!t.isEnabled||!t.frame))),bz=(n,t)=>xz(t).find(i=>(i.frame||oe(),tO(i.frame.pageMarginBox)(n)))||null;var yz=({center:n,destination:t,droppables:e})=>{if(t){const r=e[t];return r.frame?r:null}return bz(n,e)};const jd={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:n=>n**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var Ez=(n,t,e=()=>jd)=>{const i=e(),r=n[t.size]*i.startFromPercentage,s=n[t.size]*i.maxScrollAtPercentage;return{startScrollingFrom:r,maxScrollValueAt:s}},_O=({startOfRange:n,endOfRange:t,current:e})=>{const i=t-n;return i===0?0:(e-n)/i},Hb=1,wz=(n,t,e=()=>jd)=>{const i=e();if(n>t.startScrollingFrom)return 0;if(n<=t.maxScrollValueAt)return i.maxPixelScroll;if(n===t.startScrollingFrom)return Hb;const s=1-_O({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:n}),a=i.maxPixelScroll*i.ease(s);return Math.ceil(a)},Az=(n,t,e)=>{const i=e(),r=i.durationDampening.accelerateAt,s=i.durationDampening.stopDampeningAt,a=t,l=s,f=Date.now()-a;if(f>=s)return n;if(f<r)return Hb;const d=_O({startOfRange:r,endOfRange:l,current:f}),p=n*i.ease(d);return Math.ceil(p)},rS=({distanceToEdge:n,thresholds:t,dragStartTime:e,shouldUseTimeDampening:i,getAutoScrollerOptions:r})=>{const s=wz(n,t,r);return s===0?0:i?Math.max(Az(s,e,r),Hb):s},sS=({container:n,distanceToEdges:t,dragStartTime:e,axis:i,shouldUseTimeDampening:r,getAutoScrollerOptions:s})=>{const a=Ez(n,i,s);return t[i.end]<t[i.start]?rS({distanceToEdge:t[i.end],thresholds:a,dragStartTime:e,shouldUseTimeDampening:r,getAutoScrollerOptions:s}):-1*rS({distanceToEdge:t[i.start],thresholds:a,dragStartTime:e,shouldUseTimeDampening:r,getAutoScrollerOptions:s})},Sz=({container:n,subject:t,proposedScroll:e})=>{const i=t.height>n.height,r=t.width>n.width;return!r&&!i?e:r&&i?null:{x:r?0:e.x,y:i?0:e.y}};const Tz=HD(n=>n===0?0:n);var xO=({dragStartTime:n,container:t,subject:e,center:i,shouldUseTimeDampening:r,getAutoScrollerOptions:s})=>{const a={top:i.y-t.top,right:t.right-i.x,bottom:t.bottom-i.y,left:i.x-t.left},l=sS({container:t,distanceToEdges:a,dragStartTime:n,axis:Ib,shouldUseTimeDampening:r,getAutoScrollerOptions:s}),u=sS({container:t,distanceToEdges:a,dragStartTime:n,axis:qD,shouldUseTimeDampening:r,getAutoScrollerOptions:s}),f=Tz({x:u,y:l});if(Cl(f,Ni))return null;const d=Sz({container:t,subject:e,proposedScroll:f});return d?Cl(d,Ni)?null:d:null};const Cz=HD(n=>n===0?0:n>0?1:-1),$b=(()=>{const n=(t,e)=>t<0?t:t>e?t-e:0;return({current:t,max:e,change:i})=>{const r=ji(t,i),s={x:n(r.x,e.x),y:n(r.y,e.y)};return Cl(s,Ni)?null:s}})(),bO=({max:n,current:t,change:e})=>{const i={x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)},r=Cz(e),s=$b({max:i,current:t,change:r});return!s||r.x!==0&&s.x===0||r.y!==0&&s.y===0},Gb=(n,t)=>bO({current:n.scroll.current,max:n.scroll.max,change:t}),Dz=(n,t)=>{if(!Gb(n,t))return null;const e=n.scroll.max,i=n.scroll.current;return $b({current:i,max:e,change:t})},Vb=(n,t)=>{const e=n.frame;return e?bO({current:e.scroll.current,max:e.scroll.max,change:t}):!1},Oz=(n,t)=>{const e=n.frame;return!e||!Vb(n,t)?null:$b({current:e.scroll.current,max:e.scroll.max,change:t})};var Rz=({viewport:n,subject:t,center:e,dragStartTime:i,shouldUseTimeDampening:r,getAutoScrollerOptions:s})=>{const a=xO({dragStartTime:i,container:n.frame,subject:t,center:e,shouldUseTimeDampening:r,getAutoScrollerOptions:s});return a&&Gb(n,a)?a:null},Nz=({droppable:n,subject:t,center:e,dragStartTime:i,shouldUseTimeDampening:r,getAutoScrollerOptions:s})=>{const a=n.frame;if(!a)return null;const l=xO({dragStartTime:i,container:a.pageMarginBox,subject:t,center:e,shouldUseTimeDampening:r,getAutoScrollerOptions:s});return l&&Vb(n,l)?l:null},aS=({state:n,dragStartTime:t,shouldUseTimeDampening:e,scrollWindow:i,scrollDroppable:r,getAutoScrollerOptions:s})=>{const a=n.current.page.borderBoxCenter,u=n.dimensions.draggables[n.critical.draggable.id].page.marginBox;if(n.isWindowScrollAllowed){const p=n.viewport,m=Rz({dragStartTime:t,viewport:p,subject:u,center:a,shouldUseTimeDampening:e,getAutoScrollerOptions:s});if(m){i(m);return}}const f=yz({center:a,destination:hs(n.impact),droppables:n.dimensions.droppables});if(!f)return;const d=Nz({dragStartTime:t,droppable:f,subject:u,center:a,shouldUseTimeDampening:e,getAutoScrollerOptions:s});d&&r(f.descriptor.id,d)},kz=({scrollWindow:n,scrollDroppable:t,getAutoScrollerOptions:e=()=>jd})=>{const i=Pd(n),r=Pd(t);let s=null;const a=f=>{s||oe();const{shouldUseTimeDampening:d,dragStartTime:p}=s;aS({state:f,scrollWindow:i,scrollDroppable:r,dragStartTime:p,shouldUseTimeDampening:d,getAutoScrollerOptions:e})};return{start:f=>{s&&oe();const d=Date.now();let p=!1;const m=()=>{p=!0};aS({state:f,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m,getAutoScrollerOptions:e}),s={dragStartTime:d,shouldUseTimeDampening:p},p&&a(f)},stop:()=>{s&&(i.cancel(),r.cancel(),s=null)},scroll:a}},Lz=({move:n,scrollDroppable:t,scrollWindow:e})=>{const i=(l,u)=>{const f=ji(l.current.client.selection,u);n({client:f})},r=(l,u)=>{if(!Vb(l,u))return u;const f=Oz(l,u);if(!f)return t(l.descriptor.id,u),null;const d=us(u,f);return t(l.descriptor.id,d),us(u,d)},s=(l,u,f)=>{if(!l||!Gb(u,f))return f;const d=Dz(u,f);if(!d)return e(f),null;const p=us(f,d);return e(p),us(f,p)};return l=>{const u=l.scrollJumpRequest;if(!u)return;const f=hs(l.impact);f||oe();const d=r(l.dimensions.droppables[f],u);if(!d)return;const p=l.viewport,m=s(l.isWindowScrollAllowed,p,d);m&&i(l,m)}},Iz=({scrollDroppable:n,scrollWindow:t,move:e,getAutoScrollerOptions:i})=>{const r=kz({scrollWindow:t,scrollDroppable:n,getAutoScrollerOptions:i}),s=Lz({move:e,scrollWindow:t,scrollDroppable:n});return{scroll:u=>{if(!(i().disabled||u.phase!=="DRAGGING")){if(u.movementMode==="FLUID"){r.scroll(u);return}u.scrollJumpRequest&&s(u)}},start:r.start,stop:r.stop}};const vf="data-rfd",_f=(()=>{const n=`${vf}-drag-handle`;return{base:n,draggableId:`${n}-draggable-id`,contextId:`${n}-context-id`}})(),Cx=(()=>{const n=`${vf}-draggable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),Mz=(()=>{const n=`${vf}-droppable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),oS={contextId:`${vf}-scroll-container-context-id`},Pz=n=>t=>`[${t}="${n}"]`,ld=(n,t)=>n.map(e=>{const i=e.styles[t];return i?`${e.selector} { ${i} }`:""}).join(" "),Fz="pointer-events: none;";var Bz=n=>{const t=Pz(n),e=(()=>{const l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(_f.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:Fz,dropAnimating:l}}})(),i=(()=>{const l=`
      transition: ${wd.outOfTheWay};
    `;return{selector:t(Cx.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}})(),r={selector:t(Mz.contextId),styles:{always:"overflow-anchor: none;"}},a=[i,e,r,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:ld(a,"always"),resting:ld(a,"resting"),dragging:ld(a,"dragging"),dropAnimating:ld(a,"dropAnimating"),userCancel:ld(a,"userCancel")}};const ds=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?vt.useLayoutEffect:vt.useEffect,L_=()=>{const n=document.querySelector("head");return n||oe(),n},lS=n=>{const t=document.createElement("style");return n&&t.setAttribute("nonce",n),t.type="text/css",t};function Uz(n,t){const e=nn(()=>Bz(n),[n]),i=vt.useRef(null),r=vt.useRef(null),s=xe(Ri(p=>{const m=r.current;m||oe(),m.textContent=p}),[]),a=xe(p=>{const m=i.current;m||oe(),m.textContent=p},[]);ds(()=>{!i.current&&!r.current||oe();const p=lS(t),m=lS(t);return i.current=p,r.current=m,p.setAttribute(`${vf}-always`,n),m.setAttribute(`${vf}-dynamic`,n),L_().appendChild(p),L_().appendChild(m),a(e.always),s(e.resting),()=>{const v=x=>{const _=x.current;_||oe(),L_().removeChild(_),x.current=null};v(i),v(r)}},[t,a,s,e.always,e.resting,n]);const l=xe(()=>s(e.dragging),[s,e.dragging]),u=xe(p=>{if(p==="DROP"){s(e.dropAnimating);return}s(e.userCancel)},[s,e.dropAnimating,e.userCancel]),f=xe(()=>{r.current&&s(e.resting)},[s,e.resting]);return nn(()=>({dragging:l,dropping:u,resting:f}),[l,u,f])}function yO(n,t){return Array.from(n.querySelectorAll(t))}var EO=n=>n&&n.ownerDocument&&n.ownerDocument.defaultView?n.ownerDocument.defaultView:window;function nv(n){return n instanceof EO(n).HTMLElement}function zz(n,t){const e=`[${_f.contextId}="${n}"]`,i=yO(document,e);if(!i.length)return null;const r=i.find(s=>s.getAttribute(_f.draggableId)===t);return!r||!nv(r)?null:r}function jz(n){const t=vt.useRef({}),e=vt.useRef(null),i=vt.useRef(null),r=vt.useRef(!1),s=xe(function(m,v){const x={id:m,focus:v};return t.current[m]=x,function(){const b=t.current;b[m]!==x&&delete b[m]}},[]),a=xe(function(m){const v=zz(n,m);v&&v!==document.activeElement&&v.focus()},[n]),l=xe(function(m,v){e.current===m&&(e.current=v)},[]),u=xe(function(){i.current||r.current&&(i.current=requestAnimationFrame(()=>{i.current=null;const m=e.current;m&&a(m)}))},[a]),f=xe(function(m){e.current=null;const v=document.activeElement;v&&v.getAttribute(_f.draggableId)===m&&(e.current=m)},[]);return ds(()=>(r.current=!0,function(){r.current=!1;const m=i.current;m&&cancelAnimationFrame(m)}),[]),nn(()=>({register:s,tryRecordFocus:f,tryRestoreFocusRecorded:u,tryShiftRecord:l}),[s,f,u,l])}function Hz(){const n={draggables:{},droppables:{}},t=[];function e(p){return t.push(p),function(){const v=t.indexOf(p);v!==-1&&t.splice(v,1)}}function i(p){t.length&&t.forEach(m=>m(p))}function r(p){return n.draggables[p]||null}function s(p){const m=r(p);return m||oe(),m}const a={register:p=>{n.draggables[p.descriptor.id]=p,i({type:"ADDITION",value:p})},update:(p,m)=>{const v=n.draggables[m.descriptor.id];v&&v.uniqueId===p.uniqueId&&(delete n.draggables[m.descriptor.id],n.draggables[p.descriptor.id]=p)},unregister:p=>{const m=p.descriptor.id,v=r(m);v&&p.uniqueId===v.uniqueId&&(delete n.draggables[m],n.droppables[p.descriptor.droppableId]&&i({type:"REMOVAL",value:p}))},getById:s,findById:r,exists:p=>!!r(p),getAllByType:p=>Object.values(n.draggables).filter(m=>m.descriptor.type===p)};function l(p){return n.droppables[p]||null}function u(p){const m=l(p);return m||oe(),m}const f={register:p=>{n.droppables[p.descriptor.id]=p},unregister:p=>{const m=l(p.descriptor.id);m&&p.uniqueId===m.uniqueId&&delete n.droppables[p.descriptor.id]},getById:u,findById:l,exists:p=>!!l(p),getAllByType:p=>Object.values(n.droppables).filter(m=>m.descriptor.type===p)};function d(){n.draggables={},n.droppables={},t.length=0}return{draggable:a,droppable:f,subscribe:e,clean:d}}function $z(){const n=nn(Hz,[]);return vt.useEffect(()=>function(){n.clean()},[n]),n}var Wb=Yn.createContext(null),ug=()=>{const n=document.body;return n||oe(),n};const Gz={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},Vz=n=>`rfd-announcement-${n}`;function Wz(n){const t=nn(()=>Vz(n),[n]),e=vt.useRef(null);return vt.useEffect(function(){const s=document.createElement("div");return e.current=s,s.id=t,s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true"),ag(s.style,Gz),ug().appendChild(s),function(){setTimeout(function(){const u=ug();u.contains(s)&&u.removeChild(s),s===e.current&&(e.current=null)})}},[t]),xe(r=>{const s=e.current;if(s){s.textContent=r;return}},[])}const qz={separator:"::"};function qb(n,t=qz){const e=Yn.useId();return nn(()=>`${n}${t.separator}${e}`,[t.separator,n,e])}function Yz({contextId:n,uniqueId:t}){return`rfd-hidden-text-${n}-${t}`}function Xz({contextId:n,text:t}){const e=qb("hidden-text",{separator:"-"}),i=nn(()=>Yz({contextId:n,uniqueId:e}),[e,n]);return vt.useEffect(function(){const s=document.createElement("div");return s.id=i,s.textContent=t,s.style.display="none",ug().appendChild(s),function(){const l=ug();l.contains(s)&&l.removeChild(s)}},[i,t]),i}var iv=Yn.createContext(null);function wO(n){const t=vt.useRef(n);return vt.useEffect(()=>{t.current=n}),t}function Kz(){let n=null;function t(){return!!n}function e(a){return a===n}function i(a){n&&oe();const l={abandon:a};return n=l,l}function r(){n||oe(),n=null}function s(){n&&(n.abandon(),r())}return{isClaimed:t,isActive:e,claim:i,release:r,tryAbandon:s}}function Hd(n){return n.phase==="IDLE"||n.phase==="DROP_ANIMATING"?!1:n.isDragging}const Zz=9,Qz=13,Yb=27,AO=32,Jz=33,t7=34,e7=35,n7=36,i7=37,r7=38,s7=39,a7=40,o7={[Qz]:!0,[Zz]:!0};var SO=n=>{o7[n.keyCode]&&n.preventDefault()};const rv=(()=>{const n="visibilitychange";return typeof document>"u"?n:[n,`ms${n}`,`webkit${n}`,`moz${n}`,`o${n}`].find(i=>`on${i}`in document)||n})(),TO=0,cS=5;function l7(n,t){return Math.abs(t.x-n.x)>=cS||Math.abs(t.y-n.y)>=cS}const uS={type:"IDLE"};function c7({cancel:n,completed:t,getPhase:e,setPhase:i}){return[{eventName:"mousemove",fn:r=>{const{button:s,clientX:a,clientY:l}=r;if(s!==TO)return;const u={x:a,y:l},f=e();if(f.type==="DRAGGING"){r.preventDefault(),f.actions.move(u);return}f.type!=="PENDING"&&oe();const d=f.point;if(!l7(d,u))return;r.preventDefault();const p=f.actions.fluidLift(u);i({type:"DRAGGING",actions:p})}},{eventName:"mouseup",fn:r=>{const s=e();if(s.type!=="DRAGGING"){n();return}r.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:r=>{e().type==="DRAGGING"&&r.preventDefault(),n()}},{eventName:"keydown",fn:r=>{if(e().type==="PENDING"){n();return}if(r.keyCode===Yb){r.preventDefault(),n();return}SO(r)}},{eventName:"resize",fn:n},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{e().type==="PENDING"&&n()}},{eventName:"webkitmouseforcedown",fn:r=>{const s=e();if(s.type==="IDLE"&&oe(),s.actions.shouldRespectForcePress()){n();return}r.preventDefault()}},{eventName:rv,fn:n}]}function u7(n){const t=vt.useRef(uS),e=vt.useRef(Tl),i=nn(()=>({eventName:"mousedown",fn:function(p){if(p.defaultPrevented||p.button!==TO||p.ctrlKey||p.metaKey||p.shiftKey||p.altKey)return;const m=n.findClosestDraggableId(p);if(!m)return;const v=n.tryGetLock(m,a,{sourceEvent:p});if(!v)return;p.preventDefault();const x={x:p.clientX,y:p.clientY};e.current(),f(v,x)}}),[n]),r=nn(()=>({eventName:"webkitmouseforcewillbegin",fn:d=>{if(d.defaultPrevented)return;const p=n.findClosestDraggableId(d);if(!p)return;const m=n.findOptionsForDraggable(p);m&&(m.shouldRespectForcePress||n.canGetLock(p)&&d.preventDefault())}}),[n]),s=xe(function(){const p={passive:!1,capture:!0};e.current=Ms(window,[r,i],p)},[r,i]),a=xe(()=>{t.current.type!=="IDLE"&&(t.current=uS,e.current(),s())},[s]),l=xe(()=>{const d=t.current;a(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[a]),u=xe(function(){const p={capture:!0,passive:!1},m=c7({cancel:l,completed:a,getPhase:()=>t.current,setPhase:v=>{t.current=v}});e.current=Ms(window,m,p)},[l,a]),f=xe(function(p,m){t.current.type!=="IDLE"&&oe(),t.current={type:"PENDING",point:m,actions:p},u()},[u]);ds(function(){return s(),function(){e.current()}},[s])}function f7(){}const h7={[t7]:!0,[Jz]:!0,[n7]:!0,[e7]:!0};function d7(n,t){function e(){t(),n.cancel()}function i(){t(),n.drop()}return[{eventName:"keydown",fn:r=>{if(r.keyCode===Yb){r.preventDefault(),e();return}if(r.keyCode===AO){r.preventDefault(),i();return}if(r.keyCode===a7){r.preventDefault(),n.moveDown();return}if(r.keyCode===r7){r.preventDefault(),n.moveUp();return}if(r.keyCode===s7){r.preventDefault(),n.moveRight();return}if(r.keyCode===i7){r.preventDefault(),n.moveLeft();return}if(h7[r.keyCode]){r.preventDefault();return}SO(r)}},{eventName:"mousedown",fn:e},{eventName:"mouseup",fn:e},{eventName:"click",fn:e},{eventName:"touchstart",fn:e},{eventName:"resize",fn:e},{eventName:"wheel",fn:e,options:{passive:!0}},{eventName:rv,fn:e}]}function p7(n){const t=vt.useRef(f7),e=nn(()=>({eventName:"keydown",fn:function(s){if(s.defaultPrevented||s.keyCode!==AO)return;const a=n.findClosestDraggableId(s);if(!a)return;const l=n.tryGetLock(a,d,{sourceEvent:s});if(!l)return;s.preventDefault();let u=!0;const f=l.snapLift();t.current();function d(){u||oe(),u=!1,t.current(),i()}t.current=Ms(window,d7(f,d),{capture:!0,passive:!1})}}),[n]),i=xe(function(){const s={passive:!1,capture:!0};t.current=Ms(window,[e],s)},[e]);ds(function(){return i(),function(){t.current()}},[i])}const I_={type:"IDLE"},m7=120,g7=.15;function v7({cancel:n,getPhase:t}){return[{eventName:"orientationchange",fn:n},{eventName:"resize",fn:n},{eventName:"contextmenu",fn:e=>{e.preventDefault()}},{eventName:"keydown",fn:e=>{if(t().type!=="DRAGGING"){n();return}e.keyCode===Yb&&e.preventDefault(),n()}},{eventName:rv,fn:n}]}function _7({cancel:n,completed:t,getPhase:e}){return[{eventName:"touchmove",options:{capture:!1},fn:i=>{const r=e();if(r.type!=="DRAGGING"){n();return}r.hasMoved=!0;const{clientX:s,clientY:a}=i.touches[0],l={x:s,y:a};i.preventDefault(),r.actions.move(l)}},{eventName:"touchend",fn:i=>{const r=e();if(r.type!=="DRAGGING"){n();return}i.preventDefault(),r.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:i=>{if(e().type!=="DRAGGING"){n();return}i.preventDefault(),n()}},{eventName:"touchforcechange",fn:i=>{const r=e();r.type==="IDLE"&&oe();const s=i.touches[0];if(!s||!(s.force>=g7))return;const l=r.actions.shouldRespectForcePress();if(r.type==="PENDING"){l&&n();return}if(l){if(r.hasMoved){i.preventDefault();return}n();return}i.preventDefault()}},{eventName:rv,fn:n}]}function x7(n){const t=vt.useRef(I_),e=vt.useRef(Tl),i=xe(function(){return t.current},[]),r=xe(function(v){t.current=v},[]),s=nn(()=>({eventName:"touchstart",fn:function(v){if(v.defaultPrevented)return;const x=n.findClosestDraggableId(v);if(!x)return;const _=n.tryGetLock(x,l,{sourceEvent:v});if(!_)return;const b=v.touches[0],{clientX:E,clientY:T}=b,S={x:E,y:T};e.current(),p(_,S)}}),[n]),a=xe(function(){const v={capture:!0,passive:!1};e.current=Ms(window,[s],v)},[s]),l=xe(()=>{const m=t.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),r(I_),e.current(),a())},[a,r]),u=xe(()=>{const m=t.current;l(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[l]),f=xe(function(){const v={capture:!0,passive:!1},x={cancel:u,completed:l,getPhase:i},_=Ms(window,_7(x),v),b=Ms(window,v7(x),v);e.current=function(){_(),b()}},[u,i,l]),d=xe(function(){const v=i();v.type!=="PENDING"&&oe();const x=v.actions.fluidLift(v.point);r({type:"DRAGGING",actions:x,hasMoved:!1})},[i,r]),p=xe(function(v,x){i().type!=="IDLE"&&oe();const _=setTimeout(d,m7);r({type:"PENDING",point:x,actions:v,longPressTimerId:_}),f()},[f,i,r,d]);ds(function(){return a(),function(){e.current();const x=i();x.type==="PENDING"&&(clearTimeout(x.longPressTimerId),r(I_))}},[i,a,r]),ds(function(){return Ms(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const b7=["input","button","textarea","select","option","optgroup","video","audio"];function CO(n,t){if(t==null)return!1;if(b7.includes(t.tagName.toLowerCase()))return!0;const i=t.getAttribute("contenteditable");return i==="true"||i===""?!0:t===n?!1:CO(n,t.parentElement)}function y7(n,t){const e=t.target;return nv(e)?CO(n,e):!1}var E7=n=>sa(n.getBoundingClientRect()).center;function w7(n){return n instanceof EO(n).Element}const A7=(()=>{const n="matches";return typeof document>"u"?n:[n,"msMatchesSelector","webkitMatchesSelector"].find(i=>i in Element.prototype)||n})();function DO(n,t){return n==null?null:n[A7](t)?n:DO(n.parentElement,t)}function S7(n,t){return n.closest?n.closest(t):DO(n,t)}function T7(n){return`[${_f.contextId}="${n}"]`}function C7(n,t){const e=t.target;if(!w7(e))return null;const i=T7(n),r=S7(e,i);return!r||!nv(r)?null:r}function D7(n,t){const e=C7(n,t);return e?e.getAttribute(_f.draggableId):null}function O7(n,t){const e=`[${Cx.contextId}="${n}"]`,r=yO(document,e).find(s=>s.getAttribute(Cx.id)===t);return!r||!nv(r)?null:r}function R7(n){n.preventDefault()}function xm({expected:n,phase:t,isLockActive:e,shouldWarn:i}){return!(!e()||n!==t)}function OO({lockAPI:n,store:t,registry:e,draggableId:i}){if(n.isClaimed())return!1;const r=e.draggable.findById(i);return!(!r||!r.options.isEnabled||!vO(t.getState(),i))}function N7({lockAPI:n,contextId:t,store:e,registry:i,draggableId:r,forceSensorStop:s,sourceEvent:a}){if(!OO({lockAPI:n,store:e,registry:i,draggableId:r}))return null;const u=i.draggable.getById(r),f=O7(t,u.descriptor.id);if(!f||a&&!u.options.canDragInteractiveElements&&y7(f,a))return null;const d=n.claim(s||Tl);let p="PRE_DRAG";function m(){return u.options.shouldRespectForcePress}function v(){return n.isActive(d)}function x(R,N){xm({expected:R,phase:p,isLockActive:v,shouldWarn:!0})&&e.dispatch(N())}const _=x.bind(null,"DRAGGING");function b(R){function N(){n.release(),p="COMPLETED"}p!=="PRE_DRAG"&&(N(),oe()),e.dispatch(SU(R.liftActionArgs)),p="DRAGGING";function C(M,I={shouldBlockNextClick:!1}){if(R.cleanup(),I.shouldBlockNextClick){const F=Ms(window,[{eventName:"click",fn:R7,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(F)}N(),e.dispatch(cO({reason:M}))}return{isActive:()=>xm({expected:"DRAGGING",phase:p,isLockActive:v,shouldWarn:!1}),shouldRespectForcePress:m,drop:M=>C("DROP",M),cancel:M=>C("CANCEL",M),...R.actions}}function E(R){const N=Pd(M=>{_(()=>lO({client:M}))});return{...b({liftActionArgs:{id:r,clientSelection:R,movementMode:"FLUID"},cleanup:()=>N.cancel(),actions:{move:N}}),move:N}}function T(){const R={moveUp:()=>_(IU),moveRight:()=>_(PU),moveDown:()=>_(MU),moveLeft:()=>_(FU)};return b({liftActionArgs:{id:r,clientSelection:E7(f),movementMode:"SNAP"},cleanup:Tl,actions:R})}function S(){xm({expected:"PRE_DRAG",phase:p,isLockActive:v,shouldWarn:!0})&&n.release()}return{isActive:()=>xm({expected:"PRE_DRAG",phase:p,isLockActive:v,shouldWarn:!1}),shouldRespectForcePress:m,fluidLift:E,snapLift:T,abort:S}}const k7=[u7,p7,x7];function L7({contextId:n,store:t,registry:e,customSensors:i,enableDefaultSensors:r}){const s=[...r?k7:[],...i||[]],a=vt.useState(()=>Kz())[0],l=xe(function(b,E){Hd(b)&&!Hd(E)&&a.tryAbandon()},[a]);ds(function(){let b=t.getState();return t.subscribe(()=>{const T=t.getState();l(b,T),b=T})},[a,t,l]),ds(()=>a.tryAbandon,[a.tryAbandon]);const u=xe(_=>OO({lockAPI:a,registry:e,store:t,draggableId:_}),[a,e,t]),f=xe((_,b,E)=>N7({lockAPI:a,registry:e,contextId:n,store:t,draggableId:_,forceSensorStop:b||null,sourceEvent:E&&E.sourceEvent?E.sourceEvent:null}),[n,a,e,t]),d=xe(_=>D7(n,_),[n]),p=xe(_=>{const b=e.draggable.findById(_);return b?b.options:null},[e.draggable]),m=xe(function(){a.isClaimed()&&(a.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(Ub()))},[a,t]),v=xe(()=>a.isClaimed(),[a]),x=nn(()=>({canGetLock:u,tryGetLock:f,findClosestDraggableId:d,findOptionsForDraggable:p,tryReleaseLock:m,isLockClaimed:v}),[u,f,d,p,m,v]);for(let _=0;_<s.length;_++)s[_](x)}const I7=n=>({onBeforeCapture:t=>{const e=()=>{n.onBeforeCapture&&n.onBeforeCapture(t)};Cb.flushSync(e)},onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd,onDragUpdate:n.onDragUpdate}),M7=n=>({...jd,...n.autoScrollerOptions,durationDampening:{...jd.durationDampening,...n.autoScrollerOptions}});function cd(n){return n.current||oe(),n.current}function P7(n){const{contextId:t,setCallbacks:e,sensors:i,nonce:r,dragHandleUsageInstructions:s}=n,a=vt.useRef(null),l=wO(n),u=xe(()=>I7(l.current),[l]),f=xe(()=>M7(l.current),[l]),d=Wz(t),p=Xz({contextId:t,text:s}),m=Uz(t,r),v=xe(F=>{cd(a).dispatch(F)},[]),x=nn(()=>P2({publishWhileDragging:CU,updateDroppableScroll:OU,updateDroppableIsEnabled:RU,updateDroppableIsCombineEnabled:NU,collectionStarting:DU},v),[v]),_=$z(),b=nn(()=>vz(_,x),[_,x]),E=nn(()=>Iz({scrollWindow:_z,scrollDroppable:b.scrollDroppable,getAutoScrollerOptions:f,...P2({move:lO},v)}),[b.scrollDroppable,v,f]),T=jz(t),S=nn(()=>dz({announce:d,autoScroller:E,dimensionMarshal:b,focusMarshal:T,getResponders:u,styleMarshal:m}),[d,E,b,T,u,m]);a.current=S;const O=xe(()=>{const F=cd(a);F.getState().phase!=="IDLE"&&F.dispatch(Ub())},[]),R=xe(()=>{const F=cd(a).getState();return F.phase==="DROP_ANIMATING"?!0:F.phase==="IDLE"?!1:F.isDragging},[]),N=nn(()=>({isDragging:R,tryAbort:O}),[R,O]);e(N);const C=xe(F=>vO(cd(a).getState(),F),[]),M=xe(()=>mc(cd(a).getState()),[]),I=nn(()=>({marshal:b,focus:T,contextId:t,canLift:C,isMovementAllowed:M,dragHandleUsageInstructionsId:p,registry:_}),[t,b,p,T,C,M,_]);return L7({contextId:t,store:S,registry:_,customSensors:i||null,enableDefaultSensors:n.enableDefaultSensors!==!1}),vt.useEffect(()=>O,[O]),Yn.createElement(iv.Provider,{value:I},Yn.createElement(cB,{context:Wb,store:S},n.children))}function F7(){return Yn.useId()}function B7(n){const t=F7(),e=n.dragHandleUsageInstructions||Wm.dragHandleUsageInstructions;return Yn.createElement(pB,null,i=>Yn.createElement(P7,{nonce:n.nonce,contextId:t,setCallbacks:i,dragHandleUsageInstructions:e,enableDefaultSensors:n.enableDefaultSensors,sensors:n.sensors,onBeforeCapture:n.onBeforeCapture,onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragUpdate:n.onDragUpdate,onDragEnd:n.onDragEnd,autoScrollerOptions:n.autoScrollerOptions},n.children))}const fS={dragging:5e3,dropAnimating:4500},U7=(n,t)=>t?wd.drop(t.duration):n?wd.snap:wd.fluid,z7=(n,t)=>{if(n)return t?zd.opacity.drop:zd.opacity.combining},j7=n=>n.forceShouldAnimate!=null?n.forceShouldAnimate:n.mode==="SNAP";function H7(n){const e=n.dimension.client,{offset:i,combineWith:r,dropping:s}=n,a=!!r,l=j7(n),u=!!s,f=u?Sx.drop(i,a):Sx.moveTo(i);return{position:"fixed",top:e.marginBox.top,left:e.marginBox.left,boxSizing:"border-box",width:e.borderBox.width,height:e.borderBox.height,transition:U7(l,s),transform:f,opacity:z7(a,u),zIndex:u?fS.dropAnimating:fS.dragging,pointerEvents:"none"}}function $7(n){return{transform:Sx.moveTo(n.offset),transition:n.shouldAnimateDisplacement?void 0:"none"}}function G7(n){return n.type==="DRAGGING"?H7(n):$7(n)}function V7(n,t,e=Ni){const i=window.getComputedStyle(t),r=t.getBoundingClientRect(),s=PD(r,i),a=sg(s,e),l={client:s,tagName:t.tagName.toLowerCase(),display:i.display},u={x:s.marginBox.width,y:s.marginBox.height};return{descriptor:n,placeholder:l,displaceBy:u,client:s,page:a}}function W7(n){const t=qb("draggable"),{descriptor:e,registry:i,getDraggableRef:r,canDragInteractiveElements:s,shouldRespectForcePress:a,isEnabled:l}=n,u=nn(()=>({canDragInteractiveElements:s,shouldRespectForcePress:a,isEnabled:l}),[s,l,a]),f=xe(v=>{const x=r();return x||oe(),V7(e,x,v)},[e,r]),d=nn(()=>({uniqueId:t,descriptor:e,options:u,getDimension:f}),[e,f,u,t]),p=vt.useRef(d),m=vt.useRef(!0);ds(()=>(i.draggable.register(p.current),()=>i.draggable.unregister(p.current)),[i.draggable]),ds(()=>{if(m.current){m.current=!1;return}const v=p.current;p.current=d,i.draggable.update(d,v)},[d,i.draggable])}var Xb=Yn.createContext(null);function fg(n){const t=vt.useContext(n);return t||oe(),t}function q7(n){n.preventDefault()}const Y7=n=>{const t=vt.useRef(null),e=xe((N=null)=>{t.current=N},[]),i=xe(()=>t.current,[]),{contextId:r,dragHandleUsageInstructionsId:s,registry:a}=fg(iv),{type:l,droppableId:u}=fg(Xb),f=nn(()=>({id:n.draggableId,index:n.index,type:l,droppableId:u}),[n.draggableId,n.index,l,u]),{children:d,draggableId:p,isEnabled:m,shouldRespectForcePress:v,canDragInteractiveElements:x,isClone:_,mapped:b,dropAnimationFinished:E}=n;if(!_){const N=nn(()=>({descriptor:f,registry:a,getDraggableRef:i,canDragInteractiveElements:x,shouldRespectForcePress:v,isEnabled:m}),[f,a,i,x,v,m]);W7(N)}const T=nn(()=>m?{tabIndex:0,role:"button","aria-describedby":s,"data-rfd-drag-handle-draggable-id":p,"data-rfd-drag-handle-context-id":r,draggable:!1,onDragStart:q7}:null,[r,s,p,m]),S=xe(N=>{b.type==="DRAGGING"&&b.dropping&&N.propertyName==="transform"&&Cb.flushSync(E)},[E,b]),O=nn(()=>{const N=G7(b),C=b.type==="DRAGGING"&&b.dropping?S:void 0;return{innerRef:e,draggableProps:{"data-rfd-draggable-context-id":r,"data-rfd-draggable-id":p,style:N,onTransitionEnd:C},dragHandleProps:T}},[r,T,p,b,S,e]),R=nn(()=>({draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}),[f.droppableId,f.id,f.index,f.type]);return Yn.createElement(Yn.Fragment,null,d(O,b.snapshot,R))};var RO=(n,t)=>n===t,NO=n=>{const{combine:t,destination:e}=n;return e?e.droppableId:t?t.droppableId:null};const X7=n=>n.combine?n.combine.draggableId:null,K7=n=>n.at&&n.at.type==="COMBINE"?n.at.combine.draggableId:null;function Z7(){const n=Ri((r,s)=>({x:r,y:s})),t=Ri((r,s,a=null,l=null,u=null)=>({isDragging:!0,isClone:s,isDropAnimating:!!u,dropAnimation:u,mode:r,draggingOver:a,combineWith:l,combineTargetFor:null})),e=Ri((r,s,a,l,u=null,f=null,d=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:u,combineWith:f,mode:s,offset:r,dimension:a,forceShouldAnimate:d,snapshot:t(s,l,u,f,null)}}));return(r,s)=>{if(Hd(r)){if(r.critical.draggable.id!==s.draggableId)return null;const a=r.current.client.offset,l=r.dimensions.draggables[s.draggableId],u=hs(r.impact),f=K7(r.impact),d=r.forceShouldAnimate;return e(n(a.x,a.y),r.movementMode,l,s.isClone,u,f,d)}if(r.phase==="DROP_ANIMATING"){const a=r.completed;if(a.result.draggableId!==s.draggableId)return null;const l=s.isClone,u=r.dimensions.draggables[s.draggableId],f=a.result,d=f.mode,p=NO(f),m=X7(f),x={duration:r.dropDuration,curve:jb.drop,moveTo:r.newHomeClientOffset,opacity:m?zd.opacity.drop:null,scale:m?zd.scale.drop:null};return{mapped:{type:"DRAGGING",offset:r.newHomeClientOffset,dimension:u,dropping:x,draggingOver:p,combineWith:m,mode:d,forceShouldAnimate:null,snapshot:t(d,l,p,m,x)}}}return null}}function kO(n=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:n,combineWith:null}}const Q7={mapped:{type:"SECONDARY",offset:Ni,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:kO(null)}};function J7(){const n=Ri((a,l)=>({x:a,y:l})),t=Ri(kO),e=Ri((a,l=null,u)=>({mapped:{type:"SECONDARY",offset:a,combineTargetFor:l,shouldAnimateDisplacement:u,snapshot:t(l)}})),i=a=>a?e(Ni,a,!0):null,r=(a,l,u,f)=>{const d=u.displaced.visible[a],p=!!(f.inVirtualList&&f.effected[a]),m=Jg(u),v=m&&m.draggableId===a?l:null;if(!d){if(!p)return i(v);if(u.displaced.invisible[a])return null;const b=Cf(f.displacedBy.point),E=n(b.x,b.y);return e(E,v,!0)}if(p)return i(v);const x=u.displacedBy.point,_=n(x.x,x.y);return e(_,v,d.shouldAnimate)};return(a,l)=>{if(Hd(a))return a.critical.draggable.id===l.draggableId?null:r(l.draggableId,a.critical.draggable.id,a.impact,a.afterCritical);if(a.phase==="DROP_ANIMATING"){const u=a.completed;return u.result.draggableId===l.draggableId?null:r(l.draggableId,u.result.draggableId,u.impact,u.afterCritical)}return null}}const tj=()=>{const n=Z7(),t=J7();return(i,r)=>n(i,r)||t(i,r)||Q7},ej={dropAnimationFinished:uO},nj=MD(tj,ej,null,{context:Wb,areStatePropsEqual:RO})(Y7);function LO(n){return fg(Xb).isUsingCloneFor===n.draggableId&&!n.isClone?null:Yn.createElement(nj,n)}function ij(n){const t=typeof n.isDragDisabled=="boolean"?!n.isDragDisabled:!0,e=!!n.disableInteractiveElementBlocking,i=!!n.shouldRespectForcePress;return Yn.createElement(LO,ag({},n,{isClone:!1,isEnabled:t,canDragInteractiveElements:e,shouldRespectForcePress:i}))}const IO=n=>t=>n===t,rj=IO("scroll"),sj=IO("auto"),hS=(n,t)=>t(n.overflowX)||t(n.overflowY),aj=n=>{const t=window.getComputedStyle(n),e={overflowX:t.overflowX,overflowY:t.overflowY};return hS(e,rj)||hS(e,sj)},oj=()=>!1,MO=n=>n==null?null:n===document.body?oj()?n:null:n===document.documentElement?null:aj(n)?n:MO(n.parentElement);var Dx=n=>({x:n.scrollLeft,y:n.scrollTop});const PO=n=>n?window.getComputedStyle(n).position==="fixed"?!0:PO(n.parentElement):!1;var lj=n=>{const t=MO(n),e=PO(n);return{closestScrollable:t,isFixedOnPage:e}},cj=({descriptor:n,isEnabled:t,isCombineEnabled:e,isFixedOnPage:i,direction:r,client:s,page:a,closest:l})=>{const u=(()=>{if(!l)return null;const{scrollSize:m,client:v}=l,x=pO({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:v,scrollSize:m,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:x,diff:{value:Ni,displacement:Ni}}}})(),f=r==="vertical"?Ib:qD,d=gf({page:a,withPlaceholder:null,axis:f,frame:u});return{descriptor:n,isCombineEnabled:e,isFixedOnPage:i,axis:f,isEnabled:t,client:s,page:a,frame:u,subject:d}};const uj=(n,t)=>{const e=FD(n);if(!t||n!==t)return e;const i=e.paddingBox.top-t.scrollTop,r=e.paddingBox.left-t.scrollLeft,s=i+t.scrollHeight,a=r+t.scrollWidth,u=Rb({top:i,right:a,bottom:s,left:r},e.border);return Nb({borderBox:u,margin:e.margin,border:e.border,padding:e.padding})};var fj=({ref:n,descriptor:t,env:e,windowScroll:i,direction:r,isDropDisabled:s,isCombineEnabled:a,shouldClipSubject:l})=>{const u=e.closestScrollable,f=uj(n,u),d=sg(f,i),p=(()=>{if(!u)return null;const v=FD(u),x={scrollHeight:u.scrollHeight,scrollWidth:u.scrollWidth};return{client:v,page:sg(v,i),scroll:Dx(u),scrollSize:x,shouldClipSubject:l}})();return cj({descriptor:t,isEnabled:!s,isCombineEnabled:a,isFixedOnPage:e.isFixedOnPage,direction:r,client:f,page:d,closest:p})};const hj={passive:!1},dj={passive:!0};var dS=n=>n.shouldPublishImmediately?hj:dj;const bm=n=>n&&n.env.closestScrollable||null;function pj(n){const t=vt.useRef(null),e=fg(iv),i=qb("droppable"),{registry:r,marshal:s}=e,a=wO(n),l=nn(()=>({id:n.droppableId,type:n.type,mode:n.mode}),[n.droppableId,n.mode,n.type]),u=vt.useRef(l),f=nn(()=>Ri((O,R)=>{t.current||oe();const N={x:O,y:R};s.updateDroppableScroll(l.id,N)}),[l.id,s]),d=xe(()=>{const O=t.current;return!O||!O.env.closestScrollable?Ni:Dx(O.env.closestScrollable)},[]),p=xe(()=>{const O=d();f(O.x,O.y)},[d,f]),m=nn(()=>Pd(p),[p]),v=xe(()=>{const O=t.current,R=bm(O);if(O&&R||oe(),O.scrollOptions.shouldPublishImmediately){p();return}m()},[m,p]),x=xe((O,R)=>{t.current&&oe();const N=a.current,C=N.getDroppableRef();C||oe();const M=lj(C),I={ref:C,descriptor:l,env:M,scrollOptions:R};t.current=I;const F=fj({ref:C,descriptor:l,env:M,windowScroll:O,direction:N.direction,isDropDisabled:N.isDropDisabled,isCombineEnabled:N.isCombineEnabled,shouldClipSubject:!N.ignoreContainerClipping}),z=M.closestScrollable;return z&&(z.setAttribute(oS.contextId,e.contextId),z.addEventListener("scroll",v,dS(I.scrollOptions))),F},[e.contextId,l,v,a]),_=xe(()=>{const O=t.current,R=bm(O);return O&&R||oe(),Dx(R)},[]),b=xe(()=>{const O=t.current;O||oe();const R=bm(O);t.current=null,R&&(m.cancel(),R.removeAttribute(oS.contextId),R.removeEventListener("scroll",v,dS(O.scrollOptions)))},[v,m]),E=xe(O=>{const R=t.current;R||oe();const N=bm(R);N||oe(),N.scrollTop+=O.y,N.scrollLeft+=O.x},[]),T=nn(()=>({getDimensionAndWatchScroll:x,getScrollWhileDragging:_,dragStopped:b,scroll:E}),[b,x,_,E]),S=nn(()=>({uniqueId:i,descriptor:l,callbacks:T}),[T,l,i]);ds(()=>(u.current=S.descriptor,r.droppable.register(S),()=>{t.current&&b(),r.droppable.unregister(S)}),[T,l,b,S,s,r.droppable]),ds(()=>{t.current&&s.updateDroppableIsEnabled(u.current.id,!n.isDropDisabled)},[n.isDropDisabled,s]),ds(()=>{t.current&&s.updateDroppableIsCombineEnabled(u.current.id,n.isCombineEnabled)},[n.isCombineEnabled,s])}function M_(){}const pS={width:0,height:0,margin:yB},mj=({isAnimatingOpenOnMount:n,placeholder:t,animate:e})=>n||e==="close"?pS:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},gj=({isAnimatingOpenOnMount:n,placeholder:t,animate:e})=>{const i=mj({isAnimatingOpenOnMount:n,placeholder:t,animate:e});return{display:t.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:e!=="none"?wd.placeholder:null}},vj=n=>{const t=vt.useRef(null),e=xe(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:i,onTransitionEnd:r,onClose:s,contextId:a}=n,[l,u]=vt.useState(n.animate==="open");vt.useEffect(()=>l?i!=="open"?(e(),u(!1),M_):t.current?M_:(t.current=setTimeout(()=>{t.current=null,u(!1)}),e):M_,[i,l,e]);const f=xe(p=>{p.propertyName==="height"&&(r(),i==="close"&&s())},[i,s,r]),d=gj({isAnimatingOpenOnMount:l,animate:n.animate,placeholder:n.placeholder});return Yn.createElement(n.placeholder.tagName,{style:d,"data-rfd-placeholder-context-id":a,onTransitionEnd:f,ref:n.innerRef})};var _j=Yn.memo(vj);class xj extends Yn.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,e){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:e.isVisible?{isVisible:!0,data:e.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const bj=n=>{const t=vt.useContext(iv);t||oe();const{contextId:e,isMovementAllowed:i}=t,r=vt.useRef(null),s=vt.useRef(null),{children:a,droppableId:l,type:u,mode:f,direction:d,ignoreContainerClipping:p,isDropDisabled:m,isCombineEnabled:v,snapshot:x,useClone:_,updateViewportMaxScroll:b,getContainerForClone:E}=n,T=xe(()=>r.current,[]),S=xe((z=null)=>{r.current=z},[]);xe(()=>s.current,[]);const O=xe((z=null)=>{s.current=z},[]),R=xe(()=>{i()&&b({maxScroll:gO()})},[i,b]);pj({droppableId:l,type:u,mode:f,direction:d,isDropDisabled:m,isCombineEnabled:v,ignoreContainerClipping:p,getDroppableRef:T});const N=nn(()=>Yn.createElement(xj,{on:n.placeholder,shouldAnimate:n.shouldAnimatePlaceholder},({onClose:z,data:P,animate:tt})=>Yn.createElement(_j,{placeholder:P,onClose:z,innerRef:O,animate:tt,contextId:e,onTransitionEnd:R})),[e,R,n.placeholder,n.shouldAnimatePlaceholder,O]),C=nn(()=>({innerRef:S,placeholder:N,droppableProps:{"data-rfd-droppable-id":l,"data-rfd-droppable-context-id":e}}),[e,l,N,S]),M=_?_.dragging.draggableId:null,I=nn(()=>({droppableId:l,type:u,isUsingCloneFor:M}),[l,M,u]);function F(){if(!_)return null;const{dragging:z,render:P}=_,tt=Yn.createElement(LO,{draggableId:z.draggableId,index:z.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(L,nt)=>P(L,nt,z));return l8.createPortal(tt,E())}return Yn.createElement(Xb.Provider,{value:I},a(C,x),F())};function yj(){return document.body||oe(),document.body}const mS={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:yj},FO=n=>{let t={...n},e;for(e in mS)n[e]===void 0&&(t={...t,[e]:mS[e]});return t},P_=(n,t)=>n===t.droppable.type,gS=(n,t)=>t.draggables[n.draggable.id],Ej=()=>{const n={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...n,shouldAnimatePlaceholder:!1},e=Ri(s=>({draggableId:s.id,type:s.type,source:{index:s.index,droppableId:s.droppableId}})),i=Ri((s,a,l,u,f,d)=>{const p=f.descriptor.id;if(f.descriptor.droppableId===s){const x=d?{render:d,dragging:e(f.descriptor)}:null,_={isDraggingOver:l,draggingOverWith:l?p:null,draggingFromThisWith:p,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!1,snapshot:_,useClone:x}}if(!a)return t;if(!u)return n;const v={isDraggingOver:l,draggingOverWith:p,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!0,snapshot:v,useClone:null}});return(s,a)=>{const l=FO(a),u=l.droppableId,f=l.type,d=!l.isDropDisabled,p=l.renderClone;if(Hd(s)){const m=s.critical;if(!P_(f,m))return t;const v=gS(m,s.dimensions),x=hs(s.impact)===u;return i(u,d,x,x,v,p)}if(s.phase==="DROP_ANIMATING"){const m=s.completed;if(!P_(f,m.critical))return t;const v=gS(m.critical,s.dimensions);return i(u,d,NO(m.result)===u,hs(m.impact)===u,v,p)}if(s.phase==="IDLE"&&s.completed&&!s.shouldFlush){const m=s.completed;if(!P_(f,m.critical))return t;const v=hs(m.impact)===u,x=!!(m.impact.at&&m.impact.at.type==="COMBINE"),_=m.critical.droppable.id===u;return v?x?n:t:_?n:t}return t}},wj={updateViewportMaxScroll:LU},Aj=MD(Ej,wj,(n,t,e)=>({...FO(e),...n,...t}),{context:Wb,areStatePropsEqual:RO})(bj),Sj=({showOnLoad:n,onToggleShowOnLoad:t})=>at.jsx(at.Fragment,{children:at.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:at.jsxs("div",{className:"modal-content",children:[at.jsxs("div",{className:"modal-header",children:[at.jsx("img",{src:"js_logo_simbolo.png",alt:"JS Geologia Aplicada",style:{maxWidth:"50px"}}),at.jsx("h5",{className:"modal-title flex-grow-1 text-center",children:"Extrator de dados de PDFs"}),at.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),at.jsxs("div",{className:"modal-body text-start",children:[at.jsx("p",{className:"lead text-muted mb-3",children:"O Extrator de Dados de PDF da JS Geologia Aplicada é uma ferramenta desenvolvida para automatizar a extração de informações de relatórios de sondagem e outros documentos técnicos, facilitando a organização e análise de dados geológicos."}),at.jsxs("div",{className:"mt-3 px-3 text-start",children:[at.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Como usar"}),at.jsxs("ol",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[at.jsxs("li",{className:"mb-1 text-start",children:[at.jsx("strong",{children:"Carregue um PDF"}),' clicando em "Escolher arquivo"']}),at.jsxs("li",{className:"mb-1 text-start",children:[at.jsx("strong",{children:"Adicione áreas"})," para marcar regiões que deseja extrair texto"]}),at.jsxs("li",{className:"mb-1 text-start",children:[at.jsx("strong",{children:"Renomeie as áreas"})," clicando no nome para facilitar identificação"]}),at.jsxs("li",{className:"mb-1 text-start",children:[at.jsx("strong",{children:"Selecione as áreas"})," clicando no ícone de seleção e arrastando no PDF"]}),at.jsxs("li",{className:"mb-1 text-start",children:[at.jsx("strong",{children:"Extraia os dados"})," e exporte em JSON, CSV ou Excel"]})]})]}),at.jsxs("div",{className:"mt-3 px-3 text-start",children:[at.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Recursos disponíveis"}),at.jsxs("ul",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[at.jsxs("li",{className:"mb-1 text-start",children:[at.jsx("strong",{children:"Até 10 áreas"})," de extração com cores diferentes"]}),at.jsxs("li",{className:"mb-1 text-start",children:[at.jsx("strong",{children:"Sistema de presets"})," para salvar configurações"]}),at.jsxs("li",{className:"mb-1 text-start",children:[at.jsx("strong",{children:"Campos obrigatórios"})," para ignorar páginas que não contenham dados essenciais"]})]})]}),at.jsx("div",{className:"alert alert-warning mt-3 mb-0 text-start",role:"alert",children:at.jsx("p",{className:"mb-0 text-start",children:"A JS Geologia Aplicada não se responsabiliza por eventuais erros na leitura automática dos dados."})})]}),at.jsxs("div",{className:"modal-footer d-flex justify-content-between",children:[at.jsxs("div",{className:"form-check form-switch",children:[at.jsx("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:n,onChange:e=>{t(e.target.checked)}}),at.jsx("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Mostrar ao abrir"})]}),at.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Fechar"})]})]})})});function Tj({onFileSelect:n,onExtractTexts:t,onStartAreaSelection:e,onDeleteArea:i,onRenameArea:r,onClearArea:s,onAddNewArea:a,onLoadPreset:l,onDragEnd:u,onToggleMandatory:f,onToggleRepeat:d,onChangeAreaType:p,areas:m,hasFile:v}){vt.useEffect(()=>{const N=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));return N.forEach(C=>new zs(C)),()=>{N.forEach(C=>{const M=zs.getInstance(C);M&&M.dispose()})}},[m.length]);const[x,_]=vt.useState(!1),b=()=>{_(!0)},[E,T]=vt.useState(()=>localStorage.getItem("showHelpOnLoad")!=="false");vt.useEffect(()=>{const N=()=>{new Oc("#helpModal").show()};if(E)if(document.readyState==="complete")N();else return window.addEventListener("load",N),()=>window.removeEventListener("load",N)},[]);const S=N=>{T(N),localStorage.setItem("showHelpOnLoad",N.toString())},O=()=>{confirm("Deseja remover todas as áreas?")&&m.forEach(N=>{i(N.id)})},R=()=>{x_.forEach(N=>{m.find(C=>C.dataType===N)||a(N)})};return at.jsxs(at.Fragment,{children:[at.jsx(a8,{onFileSelect:n}),at.jsx("div",{className:"modal fade",id:"helpModal",tabIndex:-1,children:at.jsx(Sj,{showOnLoad:E,onToggleShowOnLoad:S})}),at.jsxs("div",{className:"d-flex justify-content-end gap-2 my-3",children:[m.length>0&&at.jsx("button",{"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Excluir todas as áreas",className:"menu-btn menu-btn-warning",onClick:O,children:at.jsx(Sb,{size:24})}),at.jsx("span",{"data-bs-placement":"top","data-bs-toggle":"tooltip","data-bs-title":"Ajuda",children:at.jsx("button",{className:"menu-btn","data-bs-toggle":"modal","data-bs-target":"#helpModal",children:at.jsx(N6,{size:24})})}),at.jsx("button",{"data-bs-title":"Presets","data-bs-toggle":"tooltip","data-bs-target":"tooltip",className:"menu-btn",onClick:b,children:at.jsx(P6,{size:24})}),at.jsxs("div",{className:"btn-group",children:[at.jsx("button",{type:"button","data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-trigger":"hover","data-bs-title":"Adicionar área",className:"menu-btn",onClick:()=>a(),children:at.jsx(z6,{size:24})}),at.jsx("button",{className:"menu-btn dropdown-toggle dropdown-toggle-split",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:at.jsx("span",{className:"visually-hidden",children:"Toggle Dropdown"})}),at.jsxs("ul",{className:"dropdown-menu",id:"add-area-dropdown",style:{zIndex:1001},children:[x_.filter(N=>!m.find(C=>C.dataType===N)).map((N,C)=>at.jsx("li",{children:at.jsx("button",{className:"dropdown-item",type:"button","data-bs-dismiss":"dropdown",onClick:()=>a(N),children:Lc[N]})},`list-item${C}`)),at.jsx("div",{className:"dropdown-divider"}),at.jsx("li",{children:at.jsx("button",{className:"dropdown-item",onClick:R,disabled:x_.some(N=>m.find(C=>C.dataType===N)),children:"Criar todos ausentes"})})]})]}),at.jsx("button",{"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-title":"Extrair texto",className:"menu-btn menu-btn-cta",disabled:!(m.length>0&&v&&m.some(N=>N.coordinates)),onClick:t,children:at.jsx(yd,{size:24})})]}),m.length===0&&at.jsx("p",{className:"text-muted",children:"Adicione uma área para começar!"}),at.jsx(B7,{onDragEnd:u,children:at.jsx(Aj,{droppableId:"areas",children:N=>at.jsxs("div",{className:"areas-container",...N.droppableProps,ref:N.innerRef,children:[m.map((C,M)=>at.jsx(ij,{draggableId:C.id,index:M,children:I=>at.jsx("div",{ref:I.innerRef,...I.draggableProps,...I.dragHandleProps,children:at.jsx(s5,{area:C,areas:m,hasFile:v,onStartSelection:e,onClearArea:s,onDeleteArea:i,onRenameArea:r,onToggleMandatory:f,onToggleRepeat:d,onChangeAreaType:p},C.id)})},C.id)),N.placeholder]})})}),at.jsx(o8,{isOpen:x,onClose:()=>_(!1),currentAreas:m,onLoadPreset:l})]})}const Cj=(n,t)=>{const i={id:`area-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,name:$d(t?Lc[t]:"Nova Área",n),order:n.length+1,color:Lj(n),coordinates:null,isMandatory:t?gD.includes(t):!1,repeatInPages:t?mD.includes(t):!1,dataType:t};return[...n,i]},Dj=(n,t)=>n.filter(e=>e.id!==t).map((e,i)=>({...e,order:i+1})),Oj=(n,t,e)=>{if(e.trim().toLowerCase()==="pagenumber")return alert('Nome "pageNumber" é reservado. Use outro nome.'),n;const i=$d(e,n);return n.map(r=>r.id===t?{...r,name:i}:r)},Rj=(n,t)=>n.map(e=>e.id===t?{...e,coordinates:null}:e),vS=n=>Object.values(Lc).includes(n)||/^Nova Área( \(\d+\))?$/.test(n),Nj=(n,t,e)=>n.map(i=>i.id===t?{...i,coordinates:e}:i),$d=(n,t)=>{let e=2,i=n;for(;t.some(r=>r.name===i);)i=`${n} (${e})`,e++;return i},kj=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F97316","#84CC16","#6B7280","#DC2626","#059669","#7C3AED","#BE123C","#0369A1"],Lj=n=>{const t=n.map(e=>e.color);return kj.find(e=>!t.includes(e))??"#000000"},Ij=({children:n})=>at.jsxs("div",{className:"card mt-5",children:[at.jsx("div",{className:"card-header",children:at.jsx("img",{src:"js_logo_horizontal.png",alt:"JS Geologia Aplicada",style:{maxWidth:"200px"}})}),at.jsxs("div",{className:"card-body",children:[at.jsx("h4",{className:"card-title",children:"Extrator de dados de PDF"}),at.jsx("p",{className:"card-text",children:"Selecione áreas, extraia dados"}),n]})]}),Mj=async(n,t)=>{const e=[],i=n.filter(f=>f.isMandatory&&f.coordinates),r=t.numPages,s=n.find(f=>f.dataType==="hole_id"),a=n.filter(f=>!f.repeatInPages&&f.dataType!=="hole_id"),l=async f=>{if(i.length===0)return!0;const d=await t.getPage(f),p=await d.getTextContent(),m=d.getViewport({scale:1});for(const v of i){const x=hm(v.coordinates,1,1,m),_=dm(p,x);if(!pm(_,[]).join(" ").trim())return!1}return!0},u=[];for(let f=1;f<=r;f++)await l(f)&&u.push(f);if(s&&s.coordinates){const f=s.name;for(const p of u){const m=await t.getPage(p),v=await m.getTextContent(),x=m.getViewport({scale:1}),_=hm(s.coordinates,1,1,x),b=dm(v,_);b.sort((T,S)=>S.transform[5]-T.transform[5]);const E=pm(b,[]).join(" ").trim();if(E){const T=e.find(S=>S[f]&&Array.isArray(S[f])&&S[f][0]===E);T?T.pageNumber.push(p):e.push({pageNumber:[p],[f]:[E]})}}const d=n.filter(p=>p.repeatInPages);if(d.length>0)for(const p of e){const m=p.pageNumber[0],v=await t.getPage(m),x=await v.getOperatorList(),_=await v.getTextContent(),b=v.getViewport({scale:1}),E=_S(x);d.forEach(T=>{if(T.coordinates){const S=hm(T.coordinates,1,1,b),O=dm(_,S);O.sort((N,C)=>C.transform[5]-N.transform[5]);const R=T.dataType==="nspt"?d2(O):pm(O,E);p[T.name]=R}})}}else for(const f of u)e.push({pageNumber:[f]});if(a.length>0)for(const f of e)for(const d of f.pageNumber){const p=await t.getPage(d),m=await p.getOperatorList(),v=await p.getTextContent(),x=p.getViewport({scale:1}),_=_S(m);a.forEach(b=>{if(b.coordinates){const E=hm(b.coordinates,1,1,x),T=dm(v,E);T.sort((N,C)=>C.transform[5]-N.transform[5]);const S=b.dataType==="nspt"?d2(T):pm(T,_);f[b.name]||(f[b.name]=[]);const O=f[b.name],R=[...S];if(O.length>0&&R.length>0){const N=O[O.length-1].trim().toLowerCase().replace(/\s+/g," "),C=R[0].trim().toLowerCase().replace(/\s+/g," ");N===C&&R.shift()}O.push(...R)}})}return e},_S=n=>{const t=[];for(let e=0;e<n.fnArray.length;e++)if(n.fnArray[e]===91){const i=n.argsArray[e][1][0];for(let r=0;r<i.length;r++)if(i[r]===1&&r>=2){const s=i[r-2],a=i[r-1],l=i[r+1],u=i[r+2];Math.abs(a-u)<2&&t.push({x1:Math.min(s,l),x2:Math.max(s,l),y:a})}}return t};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var hg={};hg.version="0.20.3";var Ro=1200,Gd=function(n){Ro=n};function Pj(){Gd(1200)}var ym=function(t){return String.fromCharCode(t)},xS=function(t){return String.fromCharCode(t)},rr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function dg(n){for(var t="",e=0,i=0,r=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n.charCodeAt(f++),s=e>>2,i=n.charCodeAt(f++),a=(e&3)<<4|i>>4,r=n.charCodeAt(f++),l=(i&15)<<2|r>>6,u=r&63,isNaN(i)?l=u=64:isNaN(r)&&(u=64),t+=rr.charAt(s)+rr.charAt(a)+rr.charAt(l)+rr.charAt(u);return t}function Fj(n){for(var t="",e=0,i=0,r=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n.charCodeAt(f++),e>255&&(e=95),s=e>>2,i=n.charCodeAt(f++),i>255&&(i=95),a=(e&3)<<4|i>>4,r=n.charCodeAt(f++),r>255&&(r=95),l=(i&15)<<2|r>>6,u=r&63,isNaN(i)?l=u=64:isNaN(r)&&(u=64),t+=rr.charAt(s)+rr.charAt(a)+rr.charAt(l)+rr.charAt(u);return t}function Bj(n){for(var t="",e=0,i=0,r=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n[f++],s=e>>2,i=n[f++],a=(e&3)<<4|i>>4,r=n[f++],l=(i&15)<<2|r>>6,u=r&63,isNaN(i)?l=u=64:isNaN(r)&&(u=64),t+=rr.charAt(s)+rr.charAt(a)+rr.charAt(l)+rr.charAt(u);return t}function Ll(n){var t="",e=0,i=0,r=0,s=0,a=0,l=0,u=0;if(n.slice(0,5)=="data:"){var f=n.slice(0,1024).indexOf(";base64,");f>-1&&(n=n.slice(f+8))}n=n.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<n.length;)s=rr.indexOf(n.charAt(f++)),a=rr.indexOf(n.charAt(f++)),e=s<<2|a>>4,t+=String.fromCharCode(e),l=rr.indexOf(n.charAt(f++)),i=(a&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(i)),u=rr.indexOf(n.charAt(f++)),r=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(r));return t}var fn=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ya=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}(),pg=function(){if(typeof Buffer>"u")return!1;var n=Ya([65,0]);if(!n)return!1;var t=n.toString("utf16le");return t.length==1}();function Mc(n){return fn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function bS(n){return fn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var os=function(t){return fn?Ya(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function sv(n){if(typeof ArrayBuffer>"u")return os(n);for(var t=new ArrayBuffer(n.length),e=new Uint8Array(t),i=0;i!=n.length;++i)e[i]=n.charCodeAt(i)&255;return t}function Pc(n){if(Array.isArray(n))return n.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],e=0;e<n.length;++e)t[e]=String.fromCharCode(n[e]);return t.join("")}function Uj(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var fi=fn?function(n){return Buffer.concat(n.map(function(t){return Buffer.isBuffer(t)?t:Ya(t)}))}:function(n){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<n.length;++t)e+=n[t].length;var i=new Uint8Array(e),r=0;for(t=0,e=0;t<n.length;e+=r,++t)r=n[t].length,n[t]instanceof Uint8Array?i.set(n[t],e):typeof n[t]=="string"?i.set(new Uint8Array(os(n[t])),e):i.set(new Uint8Array(n[t]),e);return i}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function zj(n){for(var t=[],e=0,i=n.length+250,r=Mc(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)r[e++]=a;else if(a<2048)r[e++]=192|a>>6&31,r[e++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=n.charCodeAt(++s)&1023;r[e++]=240|a>>8&7,r[e++]=128|a>>2&63,r[e++]=128|l>>6&15|(a&3)<<4,r[e++]=128|l&63}else r[e++]=224|a>>12&15,r[e++]=128|a>>6&63,r[e++]=128|a&63;e>i&&(t.push(r.slice(0,e)),e=0,r=Mc(65535),i=65530)}return t.push(r.slice(0,e)),fi(t)}var Ad=/\u0000/g,Em=/[\u0001-\u0006]/g;function Qu(n){for(var t="",e=n.length-1;e>=0;)t+=n.charAt(e--);return t}function aa(n,t){var e=""+n;return e.length>=t?e:Bn("0",t-e.length)+e}function Kb(n,t){var e=""+n;return e.length>=t?e:Bn(" ",t-e.length)+e}function mg(n,t){var e=""+n;return e.length>=t?e:e+Bn(" ",t-e.length)}function jj(n,t){var e=""+Math.round(n);return e.length>=t?e:Bn("0",t-e.length)+e}function Hj(n,t){var e=""+n;return e.length>=t?e:Bn("0",t-e.length)+e}var yS=Math.pow(2,32);function Bu(n,t){if(n>yS||n<-yS)return jj(n,t);var e=Math.round(n);return Hj(e,t)}function gg(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var ES=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],F_=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $j(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',n}var Ln={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},wS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Gj={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vg(n,t,e){for(var i=n<0?-1:1,r=n*i,s=0,a=1,l=0,u=1,f=0,d=0,p=Math.floor(r);f<t&&(p=Math.floor(r),l=p*a+s,d=p*f+u,!(r-p<5e-8));)r=1/(r-p),s=a,a=l,u=f,f=d;if(d>t&&(f>t?(d=u,l=s):(d=f,l=a)),!e)return[0,i*l,d];var m=Math.floor(i*l/d);return[m,i*l-m*d,d]}function Vj(n){var t=n.toPrecision(16);if(t.indexOf("e")>-1){var e=t.slice(0,t.indexOf("e"));return e=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+Bn("0",e.length-15),e+t.slice(t.indexOf("e"))}var i=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Bn("0",t.length-15);return Number(i)}function Uu(n,t,e){if(n>2958465||n<0)return null;n=Vj(n);var i=n|0,r=Math.floor(86400*(n-i)),s=0,a=[],l={D:i,T:r,u:86400*(n-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(i+=1462),l.u>.9999&&(l.u=0,++r==86400&&(l.T=r=0,++i,++l.D)),i===60)a=e?[1317,10,29]:[1900,2,29],s=3;else if(i===0)a=e?[1317,8,29]:[1900,1,0],s=6;else{i>60&&--i;var u=new Date(1900,0,1);u.setDate(u.getDate()+i-1),a=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),i<60&&(s=(s+6)%7),e&&(s=Kj(u,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=r%60,r=Math.floor(r/60),l.M=r%60,r=Math.floor(r/60),l.H=r,l.q=s,l}function Zb(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wj(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qj(n){var t=n<0?12:11,e=Zb(n.toFixed(12));return e.length<=t||(e=n.toPrecision(10),e.length<=t)?e:n.toExponential(5)}function Yj(n){var t=Zb(n.toFixed(11));return t.length>(n<0?12:11)||t==="0"||t==="-0"?n.toPrecision(6):t}function Xj(n){if(!isFinite(n))return isNaN(n)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),e;return t>=-4&&t<=-1?e=n.toPrecision(10+t):Math.abs(t)<=9?e=qj(n):t===10?e=n.toFixed(10).substr(0,12):e=Yj(n),Zb(Wj(e.toUpperCase()))}function Ox(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):Xj(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return zo(14,$i(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}function Kj(n,t){t[0]-=581;var e=n.getDay();return n<60&&(e=(e+6)%7),e}function Zj(n,t,e,i){var r="",s=0,a=0,l=e.y,u,f=0;switch(n){case 98:l=e.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=e.m,f=t.length;break;case 3:return F_[e.m-1][1];case 5:return F_[e.m-1][0];default:return F_[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=e.d,f=t.length;break;case 3:return ES[e.q][0];default:return ES[e.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(e.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=e.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=e.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?aa(e.S,t.length):(i>=2?a=i===3?1e3:100:a=i===1?10:1,s=Math.round(a*(e.S+e.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(r=aa(s,2+i),t==="ss"?r.substr(0,2):"."+r.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=e.D*24+e.H;break;case"[m]":case"[mm]":u=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":u=((e.D*24+e.H)*60+e.M)*60+(i==0?Math.round(e.S+e.u):e.S);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var d=f>0?aa(u,f):"";return d}function Al(n){var t=3;if(n.length<=t)return n;for(var e=n.length%t,i=n.substr(0,e);e!=n.length;e+=t)i+=(i.length>0?",":"")+n.substr(e,t);return i}var BO=/%/g;function Qj(n,t,e){var i=t.replace(BO,""),r=t.length-i.length;return Io(n,i,e*Math.pow(10,2*r))+Bn("%",r)}function Jj(n,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return Io(n,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function UO(n,t){var e,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+UO(n,-t);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%r;if(s<0&&(s+=r),e=(t/Math.pow(10,s)).toPrecision(i+1+(r+s)%r),e.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,r)+"."+e.substr(2+r),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(r+s)%r)+"."+d.substr(s)+"E"})}else e=t.toExponential(i);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var zO=/# (\?+)( ?)\/( ?)(\d+)/;function t9(n,t,e){var i=parseInt(n[4],10),r=Math.round(t*i),s=Math.floor(r/i),a=r-s*i,l=i;return e+(s===0?"":""+s)+" "+(a===0?Bn(" ",n[1].length+1+n[4].length):Kb(a,n[1].length)+n[2]+"/"+n[3]+aa(l,n[4].length))}function e9(n,t,e){return e+(t===0?"":""+t)+Bn(" ",n[1].length+2+n[4].length)}var jO=/^#*0*\.([0#]+)/,HO=/\)[^)]*[0#]/,$O=/\(###\) ###\\?-####/;function Er(n){for(var t="",e,i=0;i!=n.length;++i)switch(e=n.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function AS(n,t){var e=Math.pow(10,t);return""+Math.round(n*e)/e}function SS(n,t){var e=n-Math.floor(n),i=Math.pow(10,t);return t<(""+Math.round(e*i)).length?0:Math.round(e*i)}function n9(n,t){return t<(""+Math.round((n-Math.floor(n))*Math.pow(10,t))).length?1:0}function i9(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function ks(n,t,e){if(n.charCodeAt(0)===40&&!t.match(HO)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?ks("n",i,e):"("+ks("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return Jj(n,t,e);if(t.indexOf("%")!==-1)return Qj(n,t,e);if(t.indexOf("E")!==-1)return UO(t,e);if(t.charCodeAt(0)===36)return"$"+ks(n,t.substr(t.charAt(1)==" "?2:1),e);var r,s,a,l,u=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+Bu(u,t.length);if(t.match(/^[#?]+$/))return r=Bu(e,0),r==="0"&&(r=""),r.length>t.length?r:Er(t.substr(0,t.length-r.length))+r;if(s=t.match(zO))return t9(s,u,f);if(t.match(/^#+0+$/))return f+Bu(u,t.length-t.indexOf("0"));if(s=t.match(jO))return r=AS(e,s[1].length).replace(/^([^\.]+)$/,"$1."+Er(s[1])).replace(/\.$/,"."+Er(s[1])).replace(/\.(\d*)$/,function(x,_){return"."+_+Bn("0",Er(s[1]).length-_.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+AS(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+Al(Bu(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+ks(n,t,-e):Al(""+(Math.floor(e)+n9(e,s[1].length)))+"."+aa(SS(e,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ks(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Qu(ks(n,t.replace(/[\\-]/g,""),e)),a=0,Qu(Qu(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<r.length?r.charAt(a++):x==="0"?"0":""}));if(t.match($O))return r=ks(n,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=vg(u,Math.pow(10,a)-1,!1),r=""+f,d=Io("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),r+=d+s[2]+"/"+s[3],d=mg(l[2],a),d.length<s[4].length&&(d=Er(s[4].substr(s[4].length-d.length))+d),r+=d,r;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=vg(u,Math.pow(10,a)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Kb(l[1],a)+s[2]+"/"+s[3]+mg(l[2],a):Bn(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return r=Bu(e,0),t.length<=r.length?r:Er(t.substr(0,t.length-r.length))+r;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=r.indexOf(".");var p=t.indexOf(".")-a,m=t.length-r.length-p;return Er(t.substr(0,p)+r+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=SS(e,s[1].length),e<0?"-"+ks(n,t,-e):Al(i9(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?aa(0,3-x.length):"")+x})+"."+aa(a,s[1].length);switch(t){case"###,##0.00":return ks(n,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var v=Al(Bu(u,0));return v!=="0"?f+v:"";case"###,###.00":return ks(n,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return ks(n,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function r9(n,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return Io(n,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function s9(n,t,e){var i=t.replace(BO,""),r=t.length-i.length;return Io(n,i,e*Math.pow(10,2*r))+Bn("%",r)}function GO(n,t){var e,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+GO(n,-t);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%r;if(s<0&&(s+=r),e=(t/Math.pow(10,s)).toPrecision(i+1+(r+s)%r),!e.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(r+s)%r)+"."+d.substr(s)+"E"})}else e=t.toExponential(i);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Ma(n,t,e){if(n.charCodeAt(0)===40&&!t.match(HO)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ma("n",i,e):"("+Ma("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return r9(n,t,e);if(t.indexOf("%")!==-1)return s9(n,t,e);if(t.indexOf("E")!==-1)return GO(t,e);if(t.charCodeAt(0)===36)return"$"+Ma(n,t.substr(t.charAt(1)==" "?2:1),e);var r,s,a,l,u=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+aa(u,t.length);if(t.match(/^[#?]+$/))return r=""+e,e===0&&(r=""),r.length>t.length?r:Er(t.substr(0,t.length-r.length))+r;if(s=t.match(zO))return e9(s,u,f);if(t.match(/^#+0+$/))return f+aa(u,t.length-t.indexOf("0"));if(s=t.match(jO))return r=(""+e).replace(/^([^\.]+)$/,"$1."+Er(s[1])).replace(/\.$/,"."+Er(s[1])),r=r.replace(/\.(\d*)$/,function(x,_){return"."+_+Bn("0",Er(s[1]).length-_.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+Al(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ma(n,t,-e):Al(""+e)+"."+Bn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ma(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Qu(Ma(n,t.replace(/[\\-]/g,""),e)),a=0,Qu(Qu(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<r.length?r.charAt(a++):x==="0"?"0":""}));if(t.match($O))return r=Ma(n,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=vg(u,Math.pow(10,a)-1,!1),r=""+f,d=Io("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),r+=d+s[2]+"/"+s[3],d=mg(l[2],a),d.length<s[4].length&&(d=Er(s[4].substr(s[4].length-d.length))+d),r+=d,r;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=vg(u,Math.pow(10,a)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Kb(l[1],a)+s[2]+"/"+s[3]+mg(l[2],a):Bn(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return r=""+e,t.length<=r.length?r:Er(t.substr(0,t.length-r.length))+r;if(s=t.match(/^([#0]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=r.indexOf(".");var p=t.indexOf(".")-a,m=t.length-r.length-p;return Er(t.substr(0,p)+r+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Ma(n,t,-e):Al(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?aa(0,3-x.length):"")+x})+"."+aa(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Al(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return Ma(n,t.slice(0,t.lastIndexOf(".")),e)+Er(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Io(n,t,e){return(e|0)===e?Ma(n,t,e):ks(n,t,e)}function a9(n){for(var t=[],e=!1,i=0,r=0;i<n.length;++i)switch(n.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=n.substr(r,i-r),r=i+1}if(t[t.length]=n.substr(r),e===!0)throw new Error("Format |"+n+"| unterminated string ");return t}var VO=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fc(n){for(var t=0,e="",i="";t<n.length;)switch(e=n.charAt(t)){case"G":gg(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(i=e;n.charAt(t++)!=="]"&&t<n.length;)i+=n.charAt(t);if(i.match(VO))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(e=n.charAt(++t))>-1||e=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===e;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function o9(n,t,e,i){for(var r=[],s="",a=0,l="",u="t",f,d,p,m="H";a<n.length;)switch(l=n.charAt(a)){case"G":if(!gg(n,a))throw new Error("unrecognized character "+l+" in "+n);r[r.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(p);r[r.length]={t:"t",v:s},++a;break;case"\\":var v=n.charAt(++a),x=v==="("||v===")"?v:"t";r[r.length]={t:x,v},++a;break;case"_":r[r.length]={t:"t",v:" "},a+=2;break;case"@":r[r.length]={t:"T",v:t},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(f==null&&(f=Uu(t,e,n.charAt(a+1)==="2"),f==null))return"";r[r.length]={t:"X",v:n.substr(a,2)},u=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Uu(t,e),f==null))return"";for(s=l;++a<n.length&&n.charAt(a).toLowerCase()===l;)s+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),r[r.length]={t:l,v:s},u=l;break;case"A":case"a":case"上":var _={t:l,v:l};if(f==null&&(f=Uu(t,e)),n.substr(a,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?n.charAt(a+2):l),_.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="上午/下午"?(f!=null&&(_.v=f.H>=12?"下午":"上午"),_.t="T",a+=5,m="h"):(_.t="t",++a),f==null&&_.t==="T")return"";r[r.length]=_,u=l;break;case"[":for(s=l;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(VO)){if(f==null&&(f=Uu(t,e),f==null))return"";r[r.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fc(n)||(r[r.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=l;++a<n.length&&(l=n.charAt(a))==="0";)s+=l;r[r.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++a<n.length&&"0#?.,E+-%".indexOf(l=n.charAt(a))>-1;)s+=l;r[r.length]={t:"n",v:s};break;case"?":for(s=l;n.charAt(++a)===l;)s+=l;r[r.length]={t:l,v:s},u=l;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":r[r.length]={t:i===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);r[r.length]={t:"D",v:s};break;case" ":r[r.length]={t:l,v:l},++a;break;case"$":r[r.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+n);r[r.length]={t:"t",v:l},++a;break}var b=0,E=0,T;for(a=r.length-1,u="t";a>=0;--a)switch(r[a].t){case"h":case"H":r[a].t=m,u="h",b<1&&(b=1);break;case"s":(T=r[a].v.match(/\.0+$/))&&(E=Math.max(E,T[0].length-1),b=4),b<3&&(b=3);case"d":case"y":case"e":u=r[a].t;break;case"M":u=r[a].t,b<2&&(b=2);break;case"m":u==="s"&&(r[a].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&r[a].v.match(/[Hh]/)&&(b=1),b<2&&r[a].v.match(/[Mm]/)&&(b=2),b<3&&r[a].v.match(/[Ss]/)&&(b=3)}var S;switch(b){case 0:break;case 1:case 2:case 3:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H),f.H>=24&&(f.H=0,++f.D,S=Uu(f.D),S.u=f.u,S.S=f.S,S.M=f.M,S.H=f.H,f=S);break;case 4:switch(E){case 1:f.u=Math.round(f.u*10)/10;break;case 2:f.u=Math.round(f.u*100)/100;break;case 3:f.u=Math.round(f.u*1e3)/1e3;break}f.u>=1&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H),f.H>=24&&(f.H=0,++f.D,S=Uu(f.D),S.u=f.u,S.S=f.S,S.M=f.M,S.H=f.H,f=S);break}var O="",R;for(a=0;a<r.length;++a)switch(r[a].t){case"t":case"T":case" ":case"D":break;case"X":r[a].v="",r[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[a].v=Zj(r[a].t.charCodeAt(0),r[a].v,f,E),r[a].t="t";break;case"n":case"?":for(R=a+1;r[R]!=null&&((l=r[R].t)==="?"||l==="D"||(l===" "||l==="t")&&r[R+1]!=null&&(r[R+1].t==="?"||r[R+1].t==="t"&&r[R+1].v==="/")||r[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(r[R].v==="/"||r[R].v===" "&&r[R+1]!=null&&r[R+1].t=="?"));)r[a].v+=r[R].v,r[R]={v:"",t:";"},++R;O+=r[a].v,a=R-1;break;case"G":r[a].t="t",r[a].v=Ox(t,e);break}var N="",C,M;if(O.length>0){O.charCodeAt(0)==40?(C=t<0&&O.charCodeAt(0)===45?-t:t,M=Io("n",O,C)):(C=t<0&&i>1?-t:t,M=Io("n",O,C),C<0&&r[0]&&r[0].t=="t"&&(M=M.substr(1),r[0].v="-"+r[0].v)),R=M.length-1;var I=r.length;for(a=0;a<r.length;++a)if(r[a]!=null&&r[a].t!="t"&&r[a].v.indexOf(".")>-1){I=a;break}var F=r.length;if(I===r.length&&M.indexOf("E")===-1){for(a=r.length-1;a>=0;--a)r[a]==null||"n?".indexOf(r[a].t)===-1||(R>=r[a].v.length-1?(R-=r[a].v.length,r[a].v=M.substr(R+1,r[a].v.length)):R<0?r[a].v="":(r[a].v=M.substr(0,R+1),R=-1),r[a].t="t",F=a);R>=0&&F<r.length&&(r[F].v=M.substr(0,R+1)+r[F].v)}else if(I!==r.length&&M.indexOf("E")===-1){for(R=M.indexOf(".")-1,a=I;a>=0;--a)if(!(r[a]==null||"n?".indexOf(r[a].t)===-1)){for(d=r[a].v.indexOf(".")>-1&&a===I?r[a].v.indexOf(".")-1:r[a].v.length-1,N=r[a].v.substr(d+1);d>=0;--d)R>=0&&(r[a].v.charAt(d)==="0"||r[a].v.charAt(d)==="#")&&(N=M.charAt(R--)+N);r[a].v=N,r[a].t="t",F=a}for(R>=0&&F<r.length&&(r[F].v=M.substr(0,R+1)+r[F].v),R=M.indexOf(".")+1,a=I;a<r.length;++a)if(!(r[a]==null||"n?(".indexOf(r[a].t)===-1&&a!==I)){for(d=r[a].v.indexOf(".")>-1&&a===I?r[a].v.indexOf(".")+1:0,N=r[a].v.substr(0,d);d<r[a].v.length;++d)R<M.length&&(N+=M.charAt(R++));r[a].v=N,r[a].t="t",F=a}}}for(a=0;a<r.length;++a)r[a]!=null&&"n?".indexOf(r[a].t)>-1&&(C=i>1&&t<0&&a>0&&r[a-1].v==="-"?-t:t,r[a].v=Io(r[a].t,r[a].v,C),r[a].t="t");var z="";for(a=0;a!==r.length;++a)r[a]!=null&&(z+=r[a].v);return z}var TS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function CS(n,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(n==e)return!0;break;case">":if(n>e)return!0;break;case"<":if(n<e)return!0;break;case"<>":if(n!=e)return!0;break;case">=":if(n>=e)return!0;break;case"<=":if(n<=e)return!0;break}return!1}function l9(n,t){var e=a9(n),i=e.length,r=e[i-1].indexOf("@");if(i<4&&r>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||r>-1?e[e.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),e.length){case 1:e=r>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=r>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=r>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var s=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,s];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var a=e[0].match(TS),l=e[1].match(TS);return CS(t,a)?[i,e[0]]:CS(t,l)?[i,e[1]]:[i,e[a!=null&&l!=null?2:1]]}return[i,s]}function zo(n,t,e){e==null&&(e={});var i="";switch(typeof n){case"string":n=="m/d/yy"&&e.dateNF?i=e.dateNF:i=n;break;case"number":n==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:Ln)[n],i==null&&(i=e.table&&e.table[wS[n]]||Ln[wS[n]]),i==null&&(i=Gj[n]||"General");break}if(gg(i,0))return Ox(t,e);t instanceof Date&&(t=$i(t,e.date1904));var r=l9(i,t);if(gg(r[1]))return Ox(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&r[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&r[1].indexOf("0")>-1)return"#DIV/0!"}return o9(r[1],t,e,r[0])}function WO(n,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(Ln[e]==null){t<0&&(t=e);continue}if(Ln[e]==n){t=e;break}}t<0&&(t=391)}return Ln[t]=n,t}function av(n){for(var t=0;t!=392;++t)n[t]!==void 0&&WO(n[t],t)}function ov(){Ln=$j()}var _g=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function c9(n){var t=typeof n=="number"?Ln[n]:n;return t=t.replace(_g,"(\\d+)"),_g.lastIndex=0,new RegExp("^"+t+"$")}function u9(n,t,e){var i=-1,r=-1,s=-1,a=-1,l=-1,u=-1;(t.match(_g)||[]).forEach(function(p,m){var v=parseInt(e[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":i=v;break;case"d":s=v;break;case"h":a=v;break;case"s":u=v;break;case"m":a>=0?l=v:r=v;break}}),_g.lastIndex=0,u>=0&&l==-1&&r>=0&&(l=r,r=-1);var f=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return a==-1&&l==-1&&u==-1?f:i==-1&&r==-1&&s==-1?d:f+"T"+d}var f9={"d.m":"d\\.m"};function h9(n,t){return WO(f9[n]||n,t)}var DS=function(){var n={};n.version="1.2.0";function t(){for(var C=0,M=new Array(256),I=0;I!=256;++I)C=I,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,M[I]=C;return typeof Int32Array<"u"?new Int32Array(M):M}var e=t();function i(C){var M=0,I=0,F=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)z[F]=C[F];for(F=0;F!=256;++F)for(I=C[F],M=256+F;M<4096;M+=256)I=z[M]=I>>>8^C[I&255];var P=[];for(F=1;F!=16;++F)P[F-1]=typeof Int32Array<"u"&&typeof z.subarray=="function"?z.subarray(F*256,F*256+256):z.slice(F*256,F*256+256);return P}var r=i(e),s=r[0],a=r[1],l=r[2],u=r[3],f=r[4],d=r[5],p=r[6],m=r[7],v=r[8],x=r[9],_=r[10],b=r[11],E=r[12],T=r[13],S=r[14];function O(C,M){for(var I=M^-1,F=0,z=C.length;F<z;)I=I>>>8^e[(I^C.charCodeAt(F++))&255];return~I}function R(C,M){for(var I=M^-1,F=C.length-15,z=0;z<F;)I=S[C[z++]^I&255]^T[C[z++]^I>>8&255]^E[C[z++]^I>>16&255]^b[C[z++]^I>>>24]^_[C[z++]]^x[C[z++]]^v[C[z++]]^m[C[z++]]^p[C[z++]]^d[C[z++]]^f[C[z++]]^u[C[z++]]^l[C[z++]]^a[C[z++]]^s[C[z++]]^e[C[z++]];for(F+=15;z<F;)I=I>>>8^e[(I^C[z++])&255];return~I}function N(C,M){for(var I=M^-1,F=0,z=C.length,P=0,tt=0;F<z;)P=C.charCodeAt(F++),P<128?I=I>>>8^e[(I^P)&255]:P<2048?(I=I>>>8^e[(I^(192|P>>6&31))&255],I=I>>>8^e[(I^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,tt=C.charCodeAt(F++)&1023,I=I>>>8^e[(I^(240|P>>8&7))&255],I=I>>>8^e[(I^(128|P>>2&63))&255],I=I>>>8^e[(I^(128|tt>>6&15|(P&3)<<4))&255],I=I>>>8^e[(I^(128|tt&63))&255]):(I=I>>>8^e[(I^(224|P>>12&15))&255],I=I>>>8^e[(I^(128|P>>6&63))&255],I=I>>>8^e[(I^(128|P&63))&255]);return~I}return n.table=e,n.bstr=O,n.buf=R,n.str=N,n}(),Rn=function(){var t={};t.version="1.2.2";function e(V,rt){for(var Z=V.split("/"),et=rt.split("/"),it=0,ot=0,It=Math.min(Z.length,et.length);it<It;++it){if(ot=Z[it].length-et[it].length)return ot;if(Z[it]!=et[it])return Z[it]<et[it]?-1:1}return Z.length-et.length}function i(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:i(V.slice(0,-1));var rt=V.lastIndexOf("/");return rt===-1?V:V.slice(0,rt+1)}function r(V){if(V.charAt(V.length-1)=="/")return r(V.slice(0,-1));var rt=V.lastIndexOf("/");return rt===-1?V:V.slice(rt+1)}function s(V,rt){typeof rt=="string"&&(rt=new Date(rt));var Z=rt.getHours();Z=Z<<6|rt.getMinutes(),Z=Z<<5|rt.getSeconds()>>>1,V.write_shift(2,Z);var et=rt.getFullYear()-1980;et=et<<4|rt.getMonth()+1,et=et<<5|rt.getDate(),V.write_shift(2,et)}function a(V){var rt=V.read_shift(2)&65535,Z=V.read_shift(2)&65535,et=new Date,it=Z&31;Z>>>=5;var ot=Z&15;Z>>>=4,et.setMilliseconds(0),et.setFullYear(Z+1980),et.setMonth(ot-1),et.setDate(it);var It=rt&31;rt>>>=5;var Ht=rt&63;return rt>>>=6,et.setHours(rt),et.setMinutes(Ht),et.setSeconds(It<<1),et}function l(V){wr(V,0);for(var rt={},Z=0;V.l<=V.length-4;){var et=V.read_shift(2),it=V.read_shift(2),ot=V.l+it,It={};switch(et){case 21589:Z=V.read_shift(1),Z&1&&(It.mtime=V.read_shift(4)),it>5&&(Z&2&&(It.atime=V.read_shift(4)),Z&4&&(It.ctime=V.read_shift(4))),It.mtime&&(It.mt=new Date(It.mtime*1e3));break;case 1:{var Ht=V.read_shift(4),Et=V.read_shift(4);It.usz=Et*Math.pow(2,32)+Ht,Ht=V.read_shift(4),Et=V.read_shift(4),It.csz=Et*Math.pow(2,32)+Ht}break}V.l=ot,rt[et]=It}return rt}var u;function f(){return u||(u=d9)}function d(V,rt){if(V[0]==80&&V[1]==75)return Xa(V,rt);if((V[0]|32)==109&&(V[1]|32)==105)return fa(V,rt);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var Z=3,et=512,it=0,ot=0,It=0,Ht=0,Et=0,Dt=[],Ot=V.slice(0,512);wr(Ot,0);var Wt=p(Ot);switch(Z=Wt[0],Z){case 3:et=512;break;case 4:et=4096;break;case 0:if(Wt[1]==0)return Xa(V,rt);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}et!==512&&(Ot=V.slice(0,et),wr(Ot,28));var ee=V.slice(0,et);m(Ot,Z);var le=Ot.read_shift(4,"i");if(Z===3&&le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+le);Ot.l+=4,It=Ot.read_shift(4,"i"),Ot.l+=4,Ot.chk("00100000","Mini Stream Cutoff Size: "),Ht=Ot.read_shift(4,"i"),it=Ot.read_shift(4,"i"),Et=Ot.read_shift(4,"i"),ot=Ot.read_shift(4,"i");for(var Qt=-1,ie=0;ie<109&&(Qt=Ot.read_shift(4,"i"),!(Qt<0));++ie)Dt[ie]=Qt;var Ie=v(V,et);b(Et,ot,Ie,et,Dt);var sn=T(Ie,It,Dt,et);It<sn.length&&(sn[It].name="!Directory"),it>0&&Ht!==tt&&(sn[Ht].name="!MiniFAT"),sn[Dt[0]].name="!FAT",sn.fat_addrs=Dt,sn.ssz=et;var Ze={},dn=[],qr=[],_s=[];S(It,sn,Ie,dn,it,Ze,qr,Ht),x(qr,_s,dn),dn.shift();var cr={FileIndex:qr,FullPaths:_s};return rt&&rt.raw&&(cr.raw={header:ee,sectors:Ie}),cr}function p(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(L,"Header Signature: "),V.l+=16;var rt=V.read_shift(2,"u");return[V.read_shift(2,"u"),rt]}function m(V,rt){var Z=9;switch(V.l+=2,Z=V.read_shift(2)){case 9:if(rt!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(rt!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function v(V,rt){for(var Z=Math.ceil(V.length/rt)-1,et=[],it=1;it<Z;++it)et[it-1]=V.slice(it*rt,(it+1)*rt);return et[Z-1]=V.slice(Z*rt),et}function x(V,rt,Z){for(var et=0,it=0,ot=0,It=0,Ht=0,Et=Z.length,Dt=[],Ot=[];et<Et;++et)Dt[et]=Ot[et]=et,rt[et]=Z[et];for(;Ht<Ot.length;++Ht)et=Ot[Ht],it=V[et].L,ot=V[et].R,It=V[et].C,Dt[et]===et&&(it!==-1&&Dt[it]!==it&&(Dt[et]=Dt[it]),ot!==-1&&Dt[ot]!==ot&&(Dt[et]=Dt[ot])),It!==-1&&(Dt[It]=et),it!==-1&&et!=Dt[et]&&(Dt[it]=Dt[et],Ot.lastIndexOf(it)<Ht&&Ot.push(it)),ot!==-1&&et!=Dt[et]&&(Dt[ot]=Dt[et],Ot.lastIndexOf(ot)<Ht&&Ot.push(ot));for(et=1;et<Et;++et)Dt[et]===et&&(ot!==-1&&Dt[ot]!==ot?Dt[et]=Dt[ot]:it!==-1&&Dt[it]!==it&&(Dt[et]=Dt[it]));for(et=1;et<Et;++et)if(V[et].type!==0){if(Ht=et,Ht!=Dt[Ht])do Ht=Dt[Ht],rt[et]=rt[Ht]+"/"+rt[et];while(Ht!==0&&Dt[Ht]!==-1&&Ht!=Dt[Ht]);Dt[et]=-1}for(rt[0]+="/",et=1;et<Et;++et)V[et].type!==2&&(rt[et]+="/")}function _(V,rt,Z){for(var et=V.start,it=V.size,ot=[],It=et;Z&&it>0&&It>=0;)ot.push(rt.slice(It*P,It*P+P)),it-=P,It=_c(Z,It*4);return ot.length===0?Ft(0):fi(ot).slice(0,V.size)}function b(V,rt,Z,et,it){var ot=tt;if(V===tt){if(rt!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var It=Z[V],Ht=(et>>>2)-1;if(!It)return;for(var Et=0;Et<Ht&&(ot=_c(It,Et*4))!==tt;++Et)it.push(ot);rt>=1&&b(_c(It,et-4),rt-1,Z,et,it)}}function E(V,rt,Z,et,it){var ot=[],It=[];it||(it=[]);var Ht=et-1,Et=0,Dt=0;for(Et=rt;Et>=0;){it[Et]=!0,ot[ot.length]=Et,It.push(V[Et]);var Ot=Z[Math.floor(Et*4/et)];if(Dt=Et*4&Ht,et<4+Dt)throw new Error("FAT boundary crossed: "+Et+" 4 "+et);if(!V[Ot])break;Et=_c(V[Ot],Dt)}return{nodes:ot,data:MS([It])}}function T(V,rt,Z,et){var it=V.length,ot=[],It=[],Ht=[],Et=[],Dt=et-1,Ot=0,Wt=0,ee=0,le=0;for(Ot=0;Ot<it;++Ot)if(Ht=[],ee=Ot+rt,ee>=it&&(ee-=it),!It[ee]){Et=[];var Qt=[];for(Wt=ee;Wt>=0;){Qt[Wt]=!0,It[Wt]=!0,Ht[Ht.length]=Wt,Et.push(V[Wt]);var ie=Z[Math.floor(Wt*4/et)];if(le=Wt*4&Dt,et<4+le)throw new Error("FAT boundary crossed: "+Wt+" 4 "+et);if(!V[ie]||(Wt=_c(V[ie],le),Qt[Wt]))break}ot[ee]={nodes:Ht,data:MS([Et])}}return ot}function S(V,rt,Z,et,it,ot,It,Ht){for(var Et=0,Dt=et.length?2:0,Ot=rt[V].data,Wt=0,ee=0,le;Wt<Ot.length;Wt+=128){var Qt=Ot.slice(Wt,Wt+128);wr(Qt,64),ee=Qt.read_shift(2),le=iy(Qt,0,ee-Dt),et.push(le);var ie={name:le,type:Qt.read_shift(1),color:Qt.read_shift(1),L:Qt.read_shift(4,"i"),R:Qt.read_shift(4,"i"),C:Qt.read_shift(4,"i"),clsid:Qt.read_shift(16),state:Qt.read_shift(4,"i"),start:0,size:0},Ie=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);Ie!==0&&(ie.ct=O(Qt,Qt.l-8));var sn=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);sn!==0&&(ie.mt=O(Qt,Qt.l-8)),ie.start=Qt.read_shift(4,"i"),ie.size=Qt.read_shift(4,"i"),ie.size<0&&ie.start<0&&(ie.size=ie.type=0,ie.start=tt,ie.name=""),ie.type===5?(Et=ie.start,it>0&&Et!==tt&&(rt[Et].name="!StreamData")):ie.size>=4096?(ie.storage="fat",rt[ie.start]===void 0&&(rt[ie.start]=E(Z,ie.start,rt.fat_addrs,rt.ssz)),rt[ie.start].name=ie.name,ie.content=rt[ie.start].data.slice(0,ie.size)):(ie.storage="minifat",ie.size<0?ie.size=0:Et!==tt&&ie.start!==tt&&rt[Et]&&(ie.content=_(ie,rt[Et].data,(rt[Ht]||{}).data))),ie.content&&wr(ie.content,0),ot[le]=ie,It.push(ie)}}function O(V,rt){return new Date((cs(V,rt+4)/1e7*Math.pow(2,32)+cs(V,rt)/1e7-11644473600)*1e3)}function R(V,rt){return f(),d(u.readFileSync(V),rt)}function N(V,rt){var Z=rt&&rt.type;switch(Z||fn&&Buffer.isBuffer(V)&&(Z="buffer"),Z||"base64"){case"file":return R(V,rt);case"base64":return d(os(Ll(V)),rt);case"binary":return d(os(V),rt)}return d(V,rt)}function C(V,rt){var Z=rt||{},et=Z.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=et+"/",V.FileIndex[0]={name:et,type:5}),Z.CLSID&&(V.FileIndex[0].clsid=Z.CLSID),M(V)}function M(V){var rt="Sh33tJ5";if(!Rn.find(V,"/"+rt)){var Z=Ft(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,V.FileIndex.push({name:rt,type:2,content:Z,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+rt),I(V)}}function I(V,rt){C(V);for(var Z=!1,et=!1,it=V.FullPaths.length-1;it>=0;--it){var ot=V.FileIndex[it];switch(ot.type){case 0:et?Z=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:et=!0,isNaN(ot.R*ot.L*ot.C)&&(Z=!0),ot.R>-1&&ot.L>-1&&ot.R==ot.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!rt)){var It=new Date(1987,1,19),Ht=0,Et=Object.create?Object.create(null):{},Dt=[];for(it=0;it<V.FullPaths.length;++it)Et[V.FullPaths[it]]=!0,V.FileIndex[it].type!==0&&Dt.push([V.FullPaths[it],V.FileIndex[it]]);for(it=0;it<Dt.length;++it){var Ot=i(Dt[it][0]);for(et=Et[Ot];!et;){for(;i(Ot)&&!Et[i(Ot)];)Ot=i(Ot);Dt.push([Ot,{name:r(Ot).replace("/",""),type:1,clsid:Q,ct:It,mt:It,content:null}]),Et[Ot]=!0,Ot=i(Dt[it][0]),et=Et[Ot]}}for(Dt.sort(function(le,Qt){return e(le[0],Qt[0])}),V.FullPaths=[],V.FileIndex=[],it=0;it<Dt.length;++it)V.FullPaths[it]=Dt[it][0],V.FileIndex[it]=Dt[it][1];for(it=0;it<Dt.length;++it){var Wt=V.FileIndex[it],ee=V.FullPaths[it];if(Wt.name=r(ee).replace("/",""),Wt.L=Wt.R=Wt.C=-(Wt.color=1),Wt.size=Wt.content?Wt.content.length:0,Wt.start=0,Wt.clsid=Wt.clsid||Q,it===0)Wt.C=Dt.length>1?1:-1,Wt.size=0,Wt.type=5;else if(ee.slice(-1)=="/"){for(Ht=it+1;Ht<Dt.length&&i(V.FullPaths[Ht])!=ee;++Ht);for(Wt.C=Ht>=Dt.length?-1:Ht,Ht=it+1;Ht<Dt.length&&i(V.FullPaths[Ht])!=i(ee);++Ht);Wt.R=Ht>=Dt.length?-1:Ht,Wt.type=1}else i(V.FullPaths[it+1]||"")==i(ee)&&(Wt.R=it+1),Wt.type=2}}}function F(V,rt){var Z=rt||{};if(Z.fileType=="mad")return Gi(V,Z);switch(I(V),Z.fileType){case"zip":return wi(V,Z)}var et=function(le){for(var Qt=0,ie=0,Ie=0;Ie<le.FileIndex.length;++Ie){var sn=le.FileIndex[Ie];if(sn.content){var Ze=sn.content.length;Ze>0&&(Ze<4096?Qt+=Ze+63>>6:ie+=Ze+511>>9)}}for(var dn=le.FullPaths.length+3>>2,qr=Qt+7>>3,_s=Qt+127>>7,cr=qr+ie+dn+_s,Rr=cr+127>>7,da=Rr<=109?0:Math.ceil((Rr-109)/127);cr+Rr+da+127>>7>Rr;)da=++Rr<=109?0:Math.ceil((Rr-109)/127);var Nr=[1,da,Rr,_s,dn,ie,Qt,0];return le.FileIndex[0].size=Qt<<6,Nr[7]=(le.FileIndex[0].start=Nr[0]+Nr[1]+Nr[2]+Nr[3]+Nr[4]+Nr[5])+(Nr[6]+7>>3),Nr}(V),it=Ft(et[7]<<9),ot=0,It=0;{for(ot=0;ot<8;++ot)it.write_shift(1,nt[ot]);for(ot=0;ot<8;++ot)it.write_shift(2,0);for(it.write_shift(2,62),it.write_shift(2,3),it.write_shift(2,65534),it.write_shift(2,9),it.write_shift(2,6),ot=0;ot<3;++ot)it.write_shift(2,0);for(it.write_shift(4,0),it.write_shift(4,et[2]),it.write_shift(4,et[0]+et[1]+et[2]+et[3]-1),it.write_shift(4,0),it.write_shift(4,4096),it.write_shift(4,et[3]?et[0]+et[1]+et[2]-1:tt),it.write_shift(4,et[3]),it.write_shift(-4,et[1]?et[0]-1:tt),it.write_shift(4,et[1]),ot=0;ot<109;++ot)it.write_shift(-4,ot<et[2]?et[1]+ot:-1)}if(et[1])for(It=0;It<et[1];++It){for(;ot<236+It*127;++ot)it.write_shift(-4,ot<et[2]?et[1]+ot:-1);it.write_shift(-4,It===et[1]-1?tt:It+1)}var Ht=function(le){for(It+=le;ot<It-1;++ot)it.write_shift(-4,ot+1);le&&(++ot,it.write_shift(-4,tt))};for(It=ot=0,It+=et[1];ot<It;++ot)it.write_shift(-4,X.DIFSECT);for(It+=et[2];ot<It;++ot)it.write_shift(-4,X.FATSECT);Ht(et[3]),Ht(et[4]);for(var Et=0,Dt=0,Ot=V.FileIndex[0];Et<V.FileIndex.length;++Et)Ot=V.FileIndex[Et],Ot.content&&(Dt=Ot.content.length,!(Dt<4096)&&(Ot.start=It,Ht(Dt+511>>9)));for(Ht(et[6]+7>>3);it.l&511;)it.write_shift(-4,X.ENDOFCHAIN);for(It=ot=0,Et=0;Et<V.FileIndex.length;++Et)Ot=V.FileIndex[Et],Ot.content&&(Dt=Ot.content.length,!(!Dt||Dt>=4096)&&(Ot.start=It,Ht(Dt+63>>6)));for(;it.l&511;)it.write_shift(-4,X.ENDOFCHAIN);for(ot=0;ot<et[4]<<2;++ot){var Wt=V.FullPaths[ot];if(!Wt||Wt.length===0){for(Et=0;Et<17;++Et)it.write_shift(4,0);for(Et=0;Et<3;++Et)it.write_shift(4,-1);for(Et=0;Et<12;++Et)it.write_shift(4,0);continue}Ot=V.FileIndex[ot],ot===0&&(Ot.start=Ot.size?Ot.start-1:tt);var ee=ot===0&&Z.root||Ot.name;if(ee.length>31&&(console.error("Name "+ee+" will be truncated to "+ee.slice(0,31)),ee=ee.slice(0,31)),Dt=2*(ee.length+1),it.write_shift(64,ee,"utf16le"),it.write_shift(2,Dt),it.write_shift(1,Ot.type),it.write_shift(1,Ot.color),it.write_shift(-4,Ot.L),it.write_shift(-4,Ot.R),it.write_shift(-4,Ot.C),Ot.clsid)it.write_shift(16,Ot.clsid,"hex");else for(Et=0;Et<4;++Et)it.write_shift(4,0);it.write_shift(4,Ot.state||0),it.write_shift(4,0),it.write_shift(4,0),it.write_shift(4,0),it.write_shift(4,0),it.write_shift(4,Ot.start),it.write_shift(4,Ot.size),it.write_shift(4,0)}for(ot=1;ot<V.FileIndex.length;++ot)if(Ot=V.FileIndex[ot],Ot.size>=4096)if(it.l=Ot.start+1<<9,fn&&Buffer.isBuffer(Ot.content))Ot.content.copy(it,it.l,0,Ot.size),it.l+=Ot.size+511&-512;else{for(Et=0;Et<Ot.size;++Et)it.write_shift(1,Ot.content[Et]);for(;Et&511;++Et)it.write_shift(1,0)}for(ot=1;ot<V.FileIndex.length;++ot)if(Ot=V.FileIndex[ot],Ot.size>0&&Ot.size<4096)if(fn&&Buffer.isBuffer(Ot.content))Ot.content.copy(it,it.l,0,Ot.size),it.l+=Ot.size+63&-64;else{for(Et=0;Et<Ot.size;++Et)it.write_shift(1,Ot.content[Et]);for(;Et&63;++Et)it.write_shift(1,0)}if(fn)it.l=it.length;else for(;it.l<it.length;)it.write_shift(1,0);return it}function z(V,rt){var Z=V.FullPaths.map(function(Et){return Et.toUpperCase()}),et=Z.map(function(Et){var Dt=Et.split("/");return Dt[Dt.length-(Et.slice(-1)=="/"?2:1)]}),it=!1;rt.charCodeAt(0)===47?(it=!0,rt=Z[0].slice(0,-1)+rt):it=rt.indexOf("/")!==-1;var ot=rt.toUpperCase(),It=it===!0?Z.indexOf(ot):et.indexOf(ot);if(It!==-1)return V.FileIndex[It];var Ht=!ot.match(Em);for(ot=ot.replace(Ad,""),Ht&&(ot=ot.replace(Em,"!")),It=0;It<Z.length;++It)if((Ht?Z[It].replace(Em,"!"):Z[It]).replace(Ad,"")==ot||(Ht?et[It].replace(Em,"!"):et[It]).replace(Ad,"")==ot)return V.FileIndex[It];return null}var P=64,tt=-2,L="d0cf11e0a1b11ae1",nt=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:tt,FREESECT:-1,HEADER_SIGNATURE:L,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Rt(V,rt,Z){f();var et=F(V,Z);u.writeFileSync(rt,et)}function yt(V){for(var rt=new Array(V.length),Z=0;Z<V.length;++Z)rt[Z]=String.fromCharCode(V[Z]);return rt.join("")}function j(V,rt){var Z=F(V,rt);switch(rt&&rt.type||"buffer"){case"file":return f(),u.writeFileSync(rt.filename,Z),Z;case"binary":return typeof Z=="string"?Z:yt(Z);case"base64":return dg(typeof Z=="string"?Z:yt(Z));case"buffer":if(fn)return Buffer.isBuffer(Z)?Z:Ya(Z);case"array":return typeof Z=="string"?os(Z):Z}return Z}var J;function G(V){try{var rt=V.InflateRaw,Z=new rt;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)J=V;else throw new Error("zlib does not expose bytesRead")}catch(et){console.error("cannot use native zlib: "+(et.message||et))}}function ut(V,rt){if(!J)return vs(V,rt);var Z=J.InflateRaw,et=new Z,it=et._processChunk(V.slice(V.l),et._finishFlushFlag);return V.l+=et.bytesRead,it}function gt(V){return J?J.deflateRawSync(V):rn(V)}var _t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Bt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Gt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function H(V){var rt=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(rt>>16|rt>>8|rt)&255}for(var mt=typeof Uint8Array<"u",lt=mt?new Uint8Array(256):[],ct=0;ct<256;++ct)lt[ct]=H(ct);function Ct(V,rt){var Z=lt[V&255];return rt<=8?Z>>>8-rt:(Z=Z<<8|lt[V>>8&255],rt<=16?Z>>>16-rt:(Z=Z<<8|lt[V>>16&255],Z>>>24-rt))}function Lt(V,rt){var Z=rt&7,et=rt>>>3;return(V[et]|(Z<=6?0:V[et+1]<<8))>>>Z&3}function D(V,rt){var Z=rt&7,et=rt>>>3;return(V[et]|(Z<=5?0:V[et+1]<<8))>>>Z&7}function dt(V,rt){var Z=rt&7,et=rt>>>3;return(V[et]|(Z<=4?0:V[et+1]<<8))>>>Z&15}function st(V,rt){var Z=rt&7,et=rt>>>3;return(V[et]|(Z<=3?0:V[et+1]<<8))>>>Z&31}function Y(V,rt){var Z=rt&7,et=rt>>>3;return(V[et]|(Z<=1?0:V[et+1]<<8))>>>Z&127}function q(V,rt,Z){var et=rt&7,it=rt>>>3,ot=(1<<Z)-1,It=V[it]>>>et;return Z<8-et||(It|=V[it+1]<<8-et,Z<16-et)||(It|=V[it+2]<<16-et,Z<24-et)||(It|=V[it+3]<<24-et),It&ot}function ft(V,rt,Z){var et=rt&7,it=rt>>>3;return et<=5?V[it]|=(Z&7)<<et:(V[it]|=Z<<et&255,V[it+1]=(Z&7)>>8-et),rt+3}function Pt(V,rt,Z){var et=rt&7,it=rt>>>3;return Z=(Z&1)<<et,V[it]|=Z,rt+1}function jt(V,rt,Z){var et=rt&7,it=rt>>>3;return Z<<=et,V[it]|=Z&255,Z>>>=8,V[it+1]=Z,rt+8}function wt(V,rt,Z){var et=rt&7,it=rt>>>3;return Z<<=et,V[it]|=Z&255,Z>>>=8,V[it+1]=Z&255,V[it+2]=Z>>>8,rt+16}function Nt(V,rt){var Z=V.length,et=2*Z>rt?2*Z:rt+5,it=0;if(Z>=rt)return V;if(fn){var ot=bS(et);if(V.copy)V.copy(ot);else for(;it<V.length;++it)ot[it]=V[it];return ot}else if(mt){var It=new Uint8Array(et);if(It.set)It.set(V);else for(;it<Z;++it)It[it]=V[it];return It}return V.length=et,V}function At(V){for(var rt=new Array(V),Z=0;Z<V;++Z)rt[Z]=0;return rt}function pt(V,rt,Z){var et=1,it=0,ot=0,It=0,Ht=0,Et=V.length,Dt=mt?new Uint16Array(32):At(32);for(ot=0;ot<32;++ot)Dt[ot]=0;for(ot=Et;ot<Z;++ot)V[ot]=0;Et=V.length;var Ot=mt?new Uint16Array(Et):At(Et);for(ot=0;ot<Et;++ot)Dt[it=V[ot]]++,et<it&&(et=it),Ot[ot]=0;for(Dt[0]=0,ot=1;ot<=et;++ot)Dt[ot+16]=Ht=Ht+Dt[ot-1]<<1;for(ot=0;ot<Et;++ot)Ht=V[ot],Ht!=0&&(Ot[ot]=Dt[Ht+16]++);var Wt=0;for(ot=0;ot<Et;++ot)if(Wt=V[ot],Wt!=0)for(Ht=Ct(Ot[ot],et)>>et-Wt,It=(1<<et+4-Wt)-1;It>=0;--It)rt[Ht|It<<Wt]=Wt&15|ot<<4;return et}var te=mt?new Uint16Array(512):At(512),ae=mt?new Uint16Array(32):At(32);if(!mt){for(var ne=0;ne<512;++ne)te[ne]=0;for(ne=0;ne<32;++ne)ae[ne]=0}(function(){for(var V=[],rt=0;rt<32;rt++)V.push(5);pt(V,ae,32);var Z=[];for(rt=0;rt<=143;rt++)Z.push(8);for(;rt<=255;rt++)Z.push(9);for(;rt<=279;rt++)Z.push(7);for(;rt<=287;rt++)Z.push(8);pt(Z,te,288)})();var Re=function(){for(var rt=mt?new Uint8Array(32768):[],Z=0,et=0;Z<Gt.length-1;++Z)for(;et<Gt[Z+1];++et)rt[et]=Z;for(;et<32768;++et)rt[et]=29;var it=mt?new Uint8Array(259):[];for(Z=0,et=0;Z<Bt.length-1;++Z)for(;et<Bt[Z+1];++et)it[et]=Z;function ot(Ht,Et){for(var Dt=0;Dt<Ht.length;){var Ot=Math.min(65535,Ht.length-Dt),Wt=Dt+Ot==Ht.length;for(Et.write_shift(1,+Wt),Et.write_shift(2,Ot),Et.write_shift(2,~Ot&65535);Ot-- >0;)Et[Et.l++]=Ht[Dt++]}return Et.l}function It(Ht,Et){for(var Dt=0,Ot=0,Wt=mt?new Uint16Array(32768):[];Ot<Ht.length;){var ee=Math.min(65535,Ht.length-Ot);if(ee<10){for(Dt=ft(Et,Dt,+(Ot+ee==Ht.length)),Dt&7&&(Dt+=8-(Dt&7)),Et.l=Dt/8|0,Et.write_shift(2,ee),Et.write_shift(2,~ee&65535);ee-- >0;)Et[Et.l++]=Ht[Ot++];Dt=Et.l*8;continue}Dt=ft(Et,Dt,+(Ot+ee==Ht.length)+2);for(var le=0;ee-- >0;){var Qt=Ht[Ot];le=(le<<5^Qt)&32767;var ie=-1,Ie=0;if((ie=Wt[le])&&(ie|=Ot&-32768,ie>Ot&&(ie-=32768),ie<Ot))for(;Ht[ie+Ie]==Ht[Ot+Ie]&&Ie<250;)++Ie;if(Ie>2){Qt=it[Ie],Qt<=22?Dt=jt(Et,Dt,lt[Qt+1]>>1)-1:(jt(Et,Dt,3),Dt+=5,jt(Et,Dt,lt[Qt-23]>>5),Dt+=3);var sn=Qt<8?0:Qt-4>>2;sn>0&&(wt(Et,Dt,Ie-Bt[Qt]),Dt+=sn),Qt=rt[Ot-ie],Dt=jt(Et,Dt,lt[Qt]>>3),Dt-=3;var Ze=Qt<4?0:Qt-2>>1;Ze>0&&(wt(Et,Dt,Ot-ie-Gt[Qt]),Dt+=Ze);for(var dn=0;dn<Ie;++dn)Wt[le]=Ot&32767,le=(le<<5^Ht[Ot])&32767,++Ot;ee-=Ie-1}else Qt<=143?Qt=Qt+48:Dt=Pt(Et,Dt,1),Dt=jt(Et,Dt,lt[Qt]),Wt[le]=Ot&32767,++Ot}Dt=jt(Et,Dt,0)-1}return Et.l=(Dt+7)/8|0,Et.l}return function(Et,Dt){return Et.length<8?ot(Et,Dt):It(Et,Dt)}}();function rn(V){var rt=Ft(50+Math.floor(V.length*1.1)),Z=Re(V,rt);return rt.slice(0,Z)}var ye=mt?new Uint16Array(32768):At(32768),ln=mt?new Uint16Array(32768):At(32768),Ve=mt?new Uint16Array(128):At(128),zn=1,Cn=1;function bn(V,rt){var Z=st(V,rt)+257;rt+=5;var et=st(V,rt)+1;rt+=5;var it=dt(V,rt)+4;rt+=4;for(var ot=0,It=mt?new Uint8Array(19):At(19),Ht=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Et=1,Dt=mt?new Uint8Array(8):At(8),Ot=mt?new Uint8Array(8):At(8),Wt=It.length,ee=0;ee<it;++ee)It[_t[ee]]=ot=D(V,rt),Et<ot&&(Et=ot),Dt[ot]++,rt+=3;var le=0;for(Dt[0]=0,ee=1;ee<=Et;++ee)Ot[ee]=le=le+Dt[ee-1]<<1;for(ee=0;ee<Wt;++ee)(le=It[ee])!=0&&(Ht[ee]=Ot[le]++);var Qt=0;for(ee=0;ee<Wt;++ee)if(Qt=It[ee],Qt!=0){le=lt[Ht[ee]]>>8-Qt;for(var ie=(1<<7-Qt)-1;ie>=0;--ie)Ve[le|ie<<Qt]=Qt&7|ee<<3}var Ie=[];for(Et=1;Ie.length<Z+et;)switch(le=Ve[Y(V,rt)],rt+=le&7,le>>>=3){case 16:for(ot=3+Lt(V,rt),rt+=2,le=Ie[Ie.length-1];ot-- >0;)Ie.push(le);break;case 17:for(ot=3+D(V,rt),rt+=3;ot-- >0;)Ie.push(0);break;case 18:for(ot=11+Y(V,rt),rt+=7;ot-- >0;)Ie.push(0);break;default:Ie.push(le),Et<le&&(Et=le);break}var sn=Ie.slice(0,Z),Ze=Ie.slice(Z);for(ee=Z;ee<286;++ee)sn[ee]=0;for(ee=et;ee<30;++ee)Ze[ee]=0;return zn=pt(sn,ye,286),Cn=pt(Ze,ln,30),rt}function mi(V,rt){if(V[0]==3&&!(V[1]&3))return[Mc(rt),2];for(var Z=0,et=0,it=bS(rt||1<<18),ot=0,It=it.length>>>0,Ht=0,Et=0;(et&1)==0;){if(et=D(V,Z),Z+=3,et>>>1)et>>1==1?(Ht=9,Et=5):(Z=bn(V,Z),Ht=zn,Et=Cn);else{Z&7&&(Z+=8-(Z&7));var Dt=V[Z>>>3]|V[(Z>>>3)+1]<<8;if(Z+=32,Dt>0)for(!rt&&It<ot+Dt&&(it=Nt(it,ot+Dt),It=it.length);Dt-- >0;)it[ot++]=V[Z>>>3],Z+=8;continue}for(;;){!rt&&It<ot+32767&&(it=Nt(it,ot+32767),It=it.length);var Ot=q(V,Z,Ht),Wt=et>>>1==1?te[Ot]:ye[Ot];if(Z+=Wt&15,Wt>>>=4,(Wt>>>8&255)===0)it[ot++]=Wt;else{if(Wt==256)break;Wt-=257;var ee=Wt<8?0:Wt-4>>2;ee>5&&(ee=0);var le=ot+Bt[Wt];ee>0&&(le+=q(V,Z,ee),Z+=ee),Ot=q(V,Z,Et),Wt=et>>>1==1?ae[Ot]:ln[Ot],Z+=Wt&15,Wt>>>=4;var Qt=Wt<4?0:Wt-2>>1,ie=Gt[Wt];for(Qt>0&&(ie+=q(V,Z,Qt),Z+=Qt),!rt&&It<le&&(it=Nt(it,le+100),It=it.length);ot<le;)it[ot]=it[ot-ie],++ot}}}return rt?[it,Z+7>>>3]:[it.slice(0,ot),Z+7>>>3]}function vs(V,rt){var Z=V.slice(V.l||0),et=mi(Z,rt);return V.l+=et[1],et[0]}function Gs(V,rt){if(V)typeof console<"u"&&console.error(rt);else throw new Error(rt)}function Xa(V,rt){var Z=V;wr(Z,0);var et=[],it=[],ot={FileIndex:et,FullPaths:it};C(ot,{root:rt.root});for(var It=Z.length-4;(Z[It]!=80||Z[It+1]!=75||Z[It+2]!=5||Z[It+3]!=6)&&It>=0;)--It;Z.l=It+4,Z.l+=4;var Ht=Z.read_shift(2);Z.l+=6;var Et=Z.read_shift(4);for(Z.l=Et,It=0;It<Ht;++It){Z.l+=20;var Dt=Z.read_shift(4),Ot=Z.read_shift(4),Wt=Z.read_shift(2),ee=Z.read_shift(2),le=Z.read_shift(2);Z.l+=8;var Qt=Z.read_shift(4),ie=l(Z.slice(Z.l+Wt,Z.l+Wt+ee));Z.l+=Wt+ee+le;var Ie=Z.l;Z.l=Qt+4,ie&&ie[1]&&((ie[1]||{}).usz&&(Ot=ie[1].usz),(ie[1]||{}).csz&&(Dt=ie[1].csz)),Vs(Z,Dt,Ot,ot,ie),Z.l=Ie}return ot}function Vs(V,rt,Z,et,it){V.l+=2;var ot=V.read_shift(2),It=V.read_shift(2),Ht=a(V);if(ot&8257)throw new Error("Unsupported ZIP encryption");for(var Et=V.read_shift(4),Dt=V.read_shift(4),Ot=V.read_shift(4),Wt=V.read_shift(2),ee=V.read_shift(2),le="",Qt=0;Qt<Wt;++Qt)le+=String.fromCharCode(V[V.l++]);if(ee){var ie=l(V.slice(V.l,V.l+ee));(ie[21589]||{}).mt&&(Ht=ie[21589].mt),(ie[1]||{}).usz&&(Ot=ie[1].usz),(ie[1]||{}).csz&&(Dt=ie[1].csz),it&&((it[21589]||{}).mt&&(Ht=it[21589].mt),(it[1]||{}).usz&&(Ot=it[1].usz),(it[1]||{}).csz&&(Dt=it[1].csz))}V.l+=ee;var Ie=V.slice(V.l,V.l+Dt);switch(It){case 8:Ie=ut(V,Ot);break;case 0:V.l+=Dt;break;default:throw new Error("Unsupported ZIP Compression method "+It)}var sn=!1;ot&8&&(Et=V.read_shift(4),Et==134695760&&(Et=V.read_shift(4),sn=!0),Dt=V.read_shift(4),Ot=V.read_shift(4)),Dt!=rt&&Gs(sn,"Bad compressed size: "+rt+" != "+Dt),Ot!=Z&&Gs(sn,"Bad uncompressed size: "+Z+" != "+Ot),ri(et,le,Ie,{unsafe:!0,mt:Ht})}function wi(V,rt){var Z=rt||{},et=[],it=[],ot=Ft(1),It=Z.compression?8:0,Ht=0,Et=0,Dt=0,Ot=0,Wt=0,ee=V.FullPaths[0],le=ee,Qt=V.FileIndex[0],ie=[],Ie=0;for(Et=1;Et<V.FullPaths.length;++Et)if(le=V.FullPaths[Et].slice(ee.length),Qt=V.FileIndex[Et],!(!Qt.size||!Qt.content||Array.isArray(Qt.content)&&Qt.content.length==0||le=="Sh33tJ5")){var sn=Ot,Ze=Ft(le.length);for(Dt=0;Dt<le.length;++Dt)Ze.write_shift(1,le.charCodeAt(Dt)&127);Ze=Ze.slice(0,Ze.l),ie[Wt]=typeof Qt.content=="string"?DS.bstr(Qt.content,0):DS.buf(Qt.content,0);var dn=typeof Qt.content=="string"?os(Qt.content):Qt.content;It==8&&(dn=gt(dn)),ot=Ft(30),ot.write_shift(4,67324752),ot.write_shift(2,20),ot.write_shift(2,Ht),ot.write_shift(2,It),Qt.mt?s(ot,Qt.mt):ot.write_shift(4,0),ot.write_shift(-4,ie[Wt]),ot.write_shift(4,dn.length),ot.write_shift(4,Qt.content.length),ot.write_shift(2,Ze.length),ot.write_shift(2,0),Ot+=ot.length,et.push(ot),Ot+=Ze.length,et.push(Ze),Ot+=dn.length,et.push(dn),ot=Ft(46),ot.write_shift(4,33639248),ot.write_shift(2,0),ot.write_shift(2,20),ot.write_shift(2,Ht),ot.write_shift(2,It),ot.write_shift(4,0),ot.write_shift(-4,ie[Wt]),ot.write_shift(4,dn.length),ot.write_shift(4,Qt.content.length),ot.write_shift(2,Ze.length),ot.write_shift(2,0),ot.write_shift(2,0),ot.write_shift(2,0),ot.write_shift(2,0),ot.write_shift(4,0),ot.write_shift(4,sn),Ie+=ot.l,it.push(ot),Ie+=Ze.length,it.push(Ze),++Wt}return ot=Ft(22),ot.write_shift(4,101010256),ot.write_shift(2,0),ot.write_shift(2,0),ot.write_shift(2,Wt),ot.write_shift(2,Wt),ot.write_shift(4,Ie),ot.write_shift(4,Ot),ot.write_shift(2,0),fi([fi(et),fi(it),ot])}var Or={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zl(V,rt){if(V.ctype)return V.ctype;var Z=V.name||"",et=Z.match(/\.([^\.]+)$/);return et&&Or[et[1]]||rt&&(et=(Z=rt).match(/[\.\\]([^\.\\])+$/),et&&Or[et[1]])?Or[et[1]]:"application/octet-stream"}function Kc(V){for(var rt=dg(V),Z=[],et=0;et<rt.length;et+=76)Z.push(rt.slice(et,et+76));return Z.join(`\r
`)+`\r
`}function jl(V){var rt=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Dt){var Ot=Dt.charCodeAt(0).toString(16).toUpperCase();return"="+(Ot.length==1?"0"+Ot:Ot)});rt=rt.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),rt.charAt(0)==`
`&&(rt="=0D"+rt.slice(1)),rt=rt.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],et=rt.split(`\r
`),it=0;it<et.length;++it){var ot=et[it];if(ot.length==0){Z.push("");continue}for(var It=0;It<ot.length;){var Ht=76,Et=ot.slice(It,It+Ht);Et.charAt(Ht-1)=="="?Ht--:Et.charAt(Ht-2)=="="?Ht-=2:Et.charAt(Ht-3)=="="&&(Ht-=3),Et=ot.slice(It,It+Ht),It+=Ht,It<ot.length&&(Et+="="),Z.push(Et)}}return Z.join(`\r
`)}function Hl(V){for(var rt=[],Z=0;Z<V.length;++Z){for(var et=V[Z];Z<=V.length&&et.charAt(et.length-1)=="=";)et=et.slice(0,et.length-1)+V[++Z];rt.push(et)}for(var it=0;it<rt.length;++it)rt[it]=rt[it].replace(/[=][0-9A-Fa-f]{2}/g,function(ot){return String.fromCharCode(parseInt(ot.slice(1),16))});return os(rt.join(`\r
`))}function Zc(V,rt,Z){for(var et="",it="",ot="",It,Ht=0;Ht<10;++Ht){var Et=rt[Ht];if(!Et||Et.match(/^\s*$/))break;var Dt=Et.match(/^([^:]*?):\s*([^\s].*)$/);if(Dt)switch(Dt[1].toLowerCase()){case"content-location":et=Dt[2].trim();break;case"content-type":ot=Dt[2].trim();break;case"content-transfer-encoding":it=Dt[2].trim();break}}switch(++Ht,it.toLowerCase()){case"base64":It=os(Ll(rt.slice(Ht).join("")));break;case"quoted-printable":It=Hl(rt.slice(Ht));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+it)}var Ot=ri(V,et.slice(Z.length),It,{unsafe:!0});ot&&(Ot.ctype=ot)}function fa(V,rt){if(yt(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=rt&&rt.root||"",et=(fn&&Buffer.isBuffer(V)?V.toString("binary"):yt(V)).split(`\r
`),it=0,ot="";for(it=0;it<et.length;++it)if(ot=et[it],!!/^Content-Location:/i.test(ot)&&(ot=ot.slice(ot.indexOf("file")),Z||(Z=ot.slice(0,ot.lastIndexOf("/")+1)),ot.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),ot.slice(0,Z.length)!=Z););var It=(et[1]||"").match(/boundary="(.*?)"/);if(!It)throw new Error("MAD cannot find boundary");var Ht="--"+(It[1]||""),Et=[],Dt=[],Ot={FileIndex:Et,FullPaths:Dt};C(Ot);var Wt,ee=0;for(it=0;it<et.length;++it){var le=et[it];le!==Ht&&le!==Ht+"--"||(ee++&&Zc(Ot,et.slice(Wt,it),Z),Wt=it)}return Ot}function Gi(V,rt){var Z=rt||{},et=Z.boundary||"SheetJS";et="------="+et;for(var it=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+et.slice(2)+'"',"","",""],ot=V.FullPaths[0],It=ot,Ht=V.FileIndex[0],Et=1;Et<V.FullPaths.length;++Et)if(It=V.FullPaths[Et].slice(ot.length),Ht=V.FileIndex[Et],!(!Ht.size||!Ht.content||It=="Sh33tJ5")){It=It.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var Dt=Ht.content,Ot=fn&&Buffer.isBuffer(Dt)?Dt.toString("binary"):yt(Dt),Wt=0,ee=Math.min(1024,Ot.length),le=0,Qt=0;Qt<=ee;++Qt)(le=Ot.charCodeAt(Qt))>=32&&le<128&&++Wt;var ie=Wt>=ee*4/5;it.push(et),it.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+It),it.push("Content-Transfer-Encoding: "+(ie?"quoted-printable":"base64")),it.push("Content-Type: "+zl(Ht,It)),it.push(""),it.push(ie?jl(Ot):Kc(Ot))}return it.push(et+`--\r
`),it.join(`\r
`)}function ii(V){var rt={};return C(rt,V),rt}function ri(V,rt,Z,et){var it=et&&et.unsafe;it||C(V);var ot=!it&&Rn.find(V,rt);if(!ot){var It=V.FullPaths[0];rt.slice(0,It.length)==It?It=rt:(It.slice(-1)!="/"&&(It+="/"),It=(It+rt).replace("//","/")),ot={name:r(rt),type:2},V.FileIndex.push(ot),V.FullPaths.push(It),it||Rn.utils.cfb_gc(V)}return ot.content=Z,ot.size=Z?Z.length:0,et&&(et.CLSID&&(ot.clsid=et.CLSID),et.mt&&(ot.mt=et.mt),et.ct&&(ot.ct=et.ct)),ot}function ha(V,rt){C(V);var Z=Rn.find(V,rt);if(Z){for(var et=0;et<V.FileIndex.length;++et)if(V.FileIndex[et]==Z)return V.FileIndex.splice(et,1),V.FullPaths.splice(et,1),!0}return!1}function $l(V,rt,Z){C(V);var et=Rn.find(V,rt);if(et){for(var it=0;it<V.FileIndex.length;++it)if(V.FileIndex[it]==et)return V.FileIndex[it].name=r(Z),V.FullPaths[it]=Z,!0}return!1}function Mf(V){I(V,!0)}return t.find=z,t.read=N,t.parse=d,t.write=j,t.writeFile=Rt,t.utils={cfb_new:ii,cfb_add:ri,cfb_del:ha,cfb_mov:$l,cfb_gc:Mf,ReadShift:Sd,CheckField:cR,prep_blob:wr,bconcat:fi,use_zlib:G,_deflateRaw:rn,_inflateRaw:vs,consts:X},t}(),d9;function OS(n){return typeof n=="string"?sv(n):Array.isArray(n)?Uj(n):n}function mp(n,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=sv(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(n,t)}var i=e=="utf8"?Vd(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,n);if(typeof Blob<"u"){var r=new Blob([OS(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,n);if(typeof saveAs<"u")return saveAs(r,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+Bj(new Uint8Array(OS(i)));return chrome.downloads.download({url:l,filename:n,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(n);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Pc(t)),u.write(t),u.close(),t}catch(f){if(!f.message||f.message.indexOf("onstruct")==-1)throw f}throw new Error("cannot save file "+n)}function hi(n){for(var t=Object.keys(n),e=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(n,t[i])&&e.push(t[i]);return e}function RS(n,t){for(var e=[],i=hi(n),r=0;r!==i.length;++r)e[n[i[r]][t]]==null&&(e[n[i[r]][t]]=i[r]);return e}function Qb(n){for(var t=[],e=hi(n),i=0;i!==e.length;++i)t[n[e[i]]]=e[i];return t}function lv(n){for(var t=[],e=hi(n),i=0;i!==e.length;++i)t[n[e[i]]]=parseInt(e[i],10);return t}function p9(n){for(var t=[],e=hi(n),i=0;i!==e.length;++i)t[n[e[i]]]==null&&(t[n[e[i]]]=[]),t[n[e[i]]].push(e[i]);return t}var qO=Date.UTC(1899,11,30,0,0,0),m9=Date.UTC(1899,11,31,0,0,0),g9=Date.UTC(1904,0,1,0,0,0);function $i(n,t){var e=n.getTime(),i=(e-qO)/(24*60*60*1e3);return t?(i-=1462,i<-1402?i-1:i):i<60?i-1:i}function Ju(n){if(n>=60&&n<61)return n;var t=new Date;return t.setTime((n>60?n:n+1)*24*60*60*1e3+qO),t}var v9=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,_9=/^(\d+)-(\d+)-(\d+)$/,YO=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Wr(n,t){if(n instanceof Date)return n;var e=n.match(v9);if(e)return new Date((t?g9:m9)+((parseInt(e[1],10)*60+parseInt(e[2],10))*60+(e[3]?parseInt(e[3].slice(1),10):0))*1e3+(e[4]?parseInt((e[4]+"000").slice(1,4),10):0));if(e=n.match(_9),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],0,0,0,0));if(e=n.match(YO),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5],e[6]&&parseInt(e[6].slice(1),10)||0,e[7]&&parseInt((e[7]+"0000").slice(1,4),10)||0));var i=new Date(n);return i}function Jb(n,t){if(fn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return e[s]||s})}catch{}var i=[],r=0;try{for(r=0;r<n.length-65536;r+=65536)i.push(String.fromCharCode.apply(0,n.slice(r,r+65536)));i.push(String.fromCharCode.apply(0,n.slice(r)))}catch{try{for(;r<n.length-16384;r+=16384)i.push(String.fromCharCode.apply(0,n.slice(r,r+16384)));i.push(String.fromCharCode.apply(0,n.slice(r)))}catch{for(;r!=n.length;++r)i.push(String.fromCharCode(n[r]))}}return i.join("")}function or(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var t={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=or(n[e]));return t}function Bn(n,t){for(var e="";e.length<t;)e+=n;return e}function Mo(n){var t=Number(n);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(n))return t;var e=1,i=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(]([^()]*)[)]/,function(r,s){return e=-e,s}),!isNaN(t=Number(i)))?t/e:t}var x9=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,b9=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,y9=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,E9=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function w9(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,n[7]=="p"?12:0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),0,0,0))}function A9(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1],+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1],0,0,0))}var S9=["january","february","march","april","may","june","july","august","september","october","november","december"];function xg(n){if(y9.test(n))return n.indexOf("Z")==-1?cv(new Date(n)):new Date(n);var t=n.toLowerCase(),e=t.replace(/\s+/g," ").trim(),i=e.match(x9);if(i)return w9(i);if(i=e.match(b9),i)return A9(i);if(i=e.match(YO),i)return new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],i[6]&&parseInt(i[6].slice(1),10)||0,i[7]&&parseInt((i[7]+"0000").slice(1,4),10)||0));var r=new Date(E9&&n.indexOf("UTC")==-1?n+" UTC":n),s=new Date(NaN),a=r.getYear();r.getMonth();var l=r.getDate();if(isNaN(l))return s;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&S9.indexOf(t)==-1)return s}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return s;return a<0||a>8099||n.match(/[^-0-9:,\/\\\ ]/)?s:r}function xf(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds())}function cv(n){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()))}function He(n,t,e){if(n.FullPaths){if(Array.isArray(e)&&typeof e[0]=="string"&&(e=e.join("")),typeof e=="string"){var i;return fn?i=Ya(e):i=zj(e),Rn.utils.cfb_add(n,t,i)}Rn.utils.cfb_add(n,t,e)}else n.file(t,e)}function ty(){return Rn.utils.cfb_new()}var pi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,T9={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ey=Qb(T9),ny=/[&<>'"]/g,C9=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function $e(n){var t=n+"";return t.replace(ny,function(e){return ey[e]}).replace(C9,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function NS(n){return $e(n).replace(/ /g,"_x0020_")}var XO=/[\u0000-\u001f]/g;function B_(n){var t=n+"";return t.replace(ny,function(e){return ey[e]}).replace(/\n/g,"<br/>").replace(XO,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function D9(n){var t=n+"";return t.replace(ny,function(e){return ey[e]}).replace(XO,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function O9(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function R9(n){switch(n){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function U_(n){for(var t="",e=0,i=0,r=0,s=0,a=0,l=0;e<n.length;){if(i=n.charCodeAt(e++),i<128){t+=String.fromCharCode(i);continue}if(r=n.charCodeAt(e++),i>191&&i<224){a=(i&31)<<6,a|=r&63,t+=String.fromCharCode(a);continue}if(s=n.charCodeAt(e++),i<240){t+=String.fromCharCode((i&15)<<12|(r&63)<<6|s&63);continue}a=n.charCodeAt(e++),l=((i&7)<<18|(r&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function kS(n){var t=Mc(2*n.length),e,i,r=1,s=0,a=0,l;for(i=0;i<n.length;i+=r)r=1,(l=n.charCodeAt(i))<128?e=l:l<224?(e=(l&31)*64+(n.charCodeAt(i+1)&63),r=2):l<240?(e=(l&15)*4096+(n.charCodeAt(i+1)&63)*64+(n.charCodeAt(i+2)&63),r=3):(r=4,e=(l&7)*262144+(n.charCodeAt(i+1)&63)*4096+(n.charCodeAt(i+2)&63)*64+(n.charCodeAt(i+3)&63),e-=65536,a=55296+(e>>>10&1023),e=56320+(e&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=e%256,t[s++]=e>>>8;return t.slice(0,s).toString("ucs2")}function LS(n){return Ya(n,"binary").toString("utf8")}var wm="foo bar bazâð£",tf=fn&&(LS(wm)==U_(wm)&&LS||kS(wm)==U_(wm)&&kS)||U_,Vd=fn?function(n){return Ya(n,"utf8").toString("binary")}:function(n){for(var t=[],e=0,i=0,r=0;e<n.length;)switch(i=n.charCodeAt(e++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=n.charCodeAt(e++)-56320+(i<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")},N9=function(){var n=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),r=0;r<n.length;++r)i=i.replace(n[r][0],n[r][1]);return i}}(),KO=/(^\s|\s$|\n)/;function zi(n,t){return"<"+n+(t.match(KO)?' xml:space="preserve"':"")+">"+t+"</"+n+">"}function Wd(n){return hi(n).map(function(t){return" "+t+'="'+n[t]+'"'}).join("")}function se(n,t,e){return"<"+n+(e!=null?Wd(e):"")+(t!=null?(t.match(KO)?' xml:space="preserve"':"")+">"+t+"</"+n:"/")+">"}function Rx(n,t){try{return n.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function k9(n,t){switch(typeof n){case"string":var e=se("vt:lpwstr",$e(n));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return se((n|0)==n?"vt:i4":"vt:r8",$e(String(n)));case"boolean":return se("vt:bool",n?"true":"false")}if(n instanceof Date)return se("vt:filetime",Rx(n));throw new Error("Unable to serialize "+n)}var Di={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Rf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ls={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function L9(n,t){for(var e=1-2*(n[t+7]>>>7),i=((n[t+7]&127)<<4)+(n[t+6]>>>4&15),r=n[t+6]&15,s=5;s>=0;--s)r=r*256+n[t+s];return i==2047?r==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),e*Math.pow(2,i-52)*r)}function I9(n,t,e){var i=(t<0||1/t==-1/0?1:0)<<7,r=0,s=0,a=i?-t:t;isFinite(a)?a==0?r=s=0:(r=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-r),r<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?r=-1022:(s-=Math.pow(2,52),r+=1023)):(r=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)n[e+l]=s&255;n[e+6]=(r&15)<<4|s&15,n[e+7]=r>>4|i}var IS=function(n){for(var t=[],e=10240,i=0;i<n[0].length;++i)if(n[0][i])for(var r=0,s=n[0][i].length;r<s;r+=e)t.push.apply(t,n[0][i].slice(r,r+e));return t},MS=fn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(t){return Buffer.isBuffer(t)?t:Ya(t)})):IS(n)}:IS,PS=function(n,t,e){for(var i=[],r=t;r<e;r+=2)i.push(String.fromCharCode(gd(n,r)));return i.join("").replace(Ad,"")},iy=fn?function(n,t,e){return!Buffer.isBuffer(n)||!pg?PS(n,t,e):n.toString("utf16le",t,e).replace(Ad,"")}:PS,FS=function(n,t,e){for(var i=[],r=t;r<t+e;++r)i.push(("0"+n[r].toString(16)).slice(-2));return i.join("")},ZO=fn?function(n,t,e){return Buffer.isBuffer(n)?n.toString("hex",t,t+e):FS(n,t,e)}:FS,BS=function(n,t,e){for(var i=[],r=t;r<e;r++)i.push(String.fromCharCode(Vu(n,r)));return i.join("")},gp=fn?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):BS(t,e,i)}:BS,QO=function(n,t){var e=cs(n,t);return e>0?gp(n,t+4,t+4+e-1):""},JO=QO,tR=function(n,t){var e=cs(n,t);return e>0?gp(n,t+4,t+4+e-1):""},eR=tR,nR=function(n,t){var e=2*cs(n,t);return e>0?gp(n,t+4,t+4+e-1):""},iR=nR,rR=function(t,e){var i=cs(t,e);return i>0?iy(t,e+4,e+4+i):""},sR=rR,aR=function(n,t){var e=cs(n,t);return e>0?gp(n,t+4,t+4+e):""},oR=aR,lR=function(n,t){return L9(n,t)},bg=lR,ry=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};fn&&(JO=function(t,e){if(!Buffer.isBuffer(t))return QO(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},eR=function(t,e){if(!Buffer.isBuffer(t))return tR(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},iR=function(t,e){if(!Buffer.isBuffer(t)||!pg)return nR(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},sR=function(t,e){if(!Buffer.isBuffer(t)||!pg)return rR(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},oR=function(t,e){if(!Buffer.isBuffer(t))return aR(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},bg=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):lR(t,e)},ry=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Vu=function(n,t){return n[t]},gd=function(n,t){return n[t+1]*256+n[t]},M9=function(n,t){var e=n[t+1]*256+n[t];return e<32768?e:(65535-e+1)*-1},cs=function(n,t){return n[t+3]*(1<<24)+(n[t+2]<<16)+(n[t+1]<<8)+n[t]},_c=function(n,t){return n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]},P9=function(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]};function Sd(n,t){var e="",i,r,s=[],a,l,u,f;switch(t){case"dbcs":if(f=this.l,fn&&Buffer.isBuffer(this)&&pg)e=this.slice(this.l,this.l+2*n).toString("utf16le");else for(u=0;u<n;++u)e+=String.fromCharCode(gd(this,f)),f+=2;n*=2;break;case"utf8":e=gp(this,this.l,this.l+n);break;case"utf16le":n*=2,e=iy(this,this.l,this.l+n);break;case"wstr":return Sd.call(this,n,"dbcs");case"lpstr-ansi":e=JO(this,this.l),n=4+cs(this,this.l);break;case"lpstr-cp":e=eR(this,this.l),n=4+cs(this,this.l);break;case"lpwstr":e=iR(this,this.l),n=4+2*cs(this,this.l);break;case"lpp4":n=4+cs(this,this.l),e=sR(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+cs(this,this.l),e=oR(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,e="";(a=Vu(this,this.l+n++))!==0;)s.push(ym(a));e=s.join("");break;case"_wstr":for(n=0,e="";(a=gd(this,this.l+n))!==0;)s.push(ym(a)),n+=2;n+=2,e=s.join("");break;case"dbcs-cont":for(e="",f=this.l,u=0;u<n;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return a=Vu(this,f),this.l=f+1,l=Sd.call(this,n-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(ym(gd(this,f))),f+=2}e=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(e="",f=this.l,u=0;u!=n;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return a=Vu(this,f),this.l=f+1,l=Sd.call(this,n-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(ym(Vu(this,f))),f+=1}e=s.join("");break;default:switch(n){case 1:return i=Vu(this,this.l),this.l++,i;case 2:return i=(t==="i"?M9:gd)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(i=(n>0?_c:P9)(this,this.l),this.l+=4,i):(r=cs(this,this.l),this.l+=4,r);case 8:case-8:if(t==="f")return n==8?r=bg(this,this.l):r=bg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;n=8;case 16:e=ZO(this,this.l,n);break}}return this.l+=n,e}var F9=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},B9=function(n,t,e){n[e]=t&255,n[e+1]=t>>8&255,n[e+2]=t>>16&255,n[e+3]=t>>24&255},U9=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255};function z9(n,t,e){var i=0,r=0;if(e==="dbcs"){for(r=0;r!=t.length;++r)U9(this,t.charCodeAt(r),this.l+2*r);i=2*t.length}else if(e==="sbcs"||e=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=t.charCodeAt(r)&255;i=t.length}else if(e==="hex"){for(;r<n;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+n,this.length);for(r=0;r<Math.min(t.length,n);++r){var a=t.charCodeAt(r);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,F9(this,t,this.l);break;case 8:if(i=8,e==="f"){I9(this,t,this.l);break}case 16:break;case-4:i=4,B9(this,t,this.l);break}return this.l+=i,this}function cR(n,t){var e=ZO(this,this.l,n.length>>1);if(e!==n)throw new Error(t+"Expected "+n+" saw "+e);this.l+=n.length>>1}function wr(n,t){n.l=t,n.read_shift=Sd,n.chk=cR,n.write_shift=z9}function qa(n,t){n.l+=t}function Ft(n){var t=Mc(n);return wr(t,0),t}function sr(){var n=[],t=fn?16384:2048;fn&&Ft(t).copy;var e=function(d){var p=Ft(d);return wr(p,0),p},i=e(t),r=function(){i&&(i.l&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&n.push(i)),i=null)},s=function(d){return i&&d<i.length-i.l?i:(r(),i=e(Math.max(d+1,t)))},a=function(){return r(),fi(n)},l=function(){return r(),n},u=function(d){r(),i=d,i.l==null&&(i.l=i.length),s(t)};return{next:s,push:u,end:a,_bufs:n,end2:l}}function Xt(n,t,e,i){var r=+t,s;if(!isNaN(r)){i||(i=qq[r].p||(e||[]).length||0),s=1+(r>=128?1:0)+1,i>=128&&++s,i>=16384&&++s,i>=2097152&&++s;var a=n.next(s);r<=127?a.write_shift(1,r):(a.write_shift(1,(r&127)+128),a.write_shift(1,r>>7));for(var l=0;l!=4;++l)if(i>=128)a.write_shift(1,(i&127)+128),i>>=7;else{a.write_shift(1,i);break}i>0&&ry(e)&&n.push(e)}}function Td(n,t,e){var i=or(n);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function US(n,t,e){var i=or(n);return i.s=Td(i.s,t.s,e),i.e=Td(i.e,t.s,e),i}function Cd(n,t){if(n.cRel&&n.c<0)for(n=or(n);n.c<0;)n.c+=t>8?16384:256;if(n.rRel&&n.r<0)for(n=or(n);n.r<0;)n.r+=t>8?1048576:t>5?65536:16384;var e=Vn(n);return!n.cRel&&n.cRel!=null&&(e=$9(e)),!n.rRel&&n.rRel!=null&&(e=j9(e)),e}function z_(n,t){return n.s.r==0&&!n.s.rRel&&n.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+xn(n.s.c)+":"+(n.e.cRel?"":"$")+xn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(t.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Sn(n.s.r)+":"+(n.e.rRel?"":"$")+Sn(n.e.r):Cd(n.s,t.biff)+":"+Cd(n.e,t.biff)}function sy(n){return parseInt(H9(n),10)-1}function Sn(n){return""+(n+1)}function j9(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function H9(n){return n.replace(/\$(\d+)$/,"$1")}function ay(n){for(var t=G9(n),e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function xn(n){if(n<0)throw new Error("invalid column "+n);var t="";for(++n;n;n=Math.floor((n-1)/26))t=String.fromCharCode((n-1)%26+65)+t;return t}function $9(n){return n.replace(/^([A-Z])/,"$$$1")}function G9(n){return n.replace(/^\$([A-Z])/,"$1")}function V9(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Un(n){for(var t=0,e=0,i=0;i<n.length;++i){var r=n.charCodeAt(i);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(e=26*e+(r-64))}return{c:e-1,r:t-1}}function Vn(n){for(var t=n.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(n.r+1)}function Hi(n){var t=n.indexOf(":");return t==-1?{s:Un(n),e:Un(n)}:{s:Un(n.slice(0,t)),e:Un(n.slice(t+1))}}function di(n,t){return typeof t>"u"||typeof t=="number"?di(n.s,n.e):(typeof n!="string"&&(n=Vn(n)),typeof t!="string"&&(t=Vn(t)),n==t?n:n+":"+t)}function qd(n){var t=Hi(n);return"$"+xn(t.s.c)+"$"+Sn(t.s.r)+":$"+xn(t.e.c)+"$"+Sn(t.e.r)}function Yd(n,t){if(!n&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n.replace(/'/g,"''")+"'":n}function In(n){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,r=0,s=n.length;for(e=0;i<s&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(t.s.c=--e,e=0;i<s&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;if(t.s.r=--e,i===s||r!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,e=0;i!=s&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(t.e.c=--e,e=0;i!=s&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;return t.e.r=--e,t}function zS(n,t){var e=n.t=="d"&&t instanceof Date;if(n.z!=null)try{return n.w=zo(n.z,e?$i(t):t)}catch{}try{return n.w=zo((n.XF||{}).numFmtId||(e?14:0),e?$i(t):t)}catch{return""+t}}function jo(n,t,e){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&e&&e.dateNF&&(n.z=e.dateNF),n.t=="e"?Dr[n.v]||n.v:t==null?zS(n,n.v):zS(n,t))}function Nf(n,t){var e=t&&t.sheet?t.sheet:"Sheet1",i={};return i[e]=n,{SheetNames:[e],Sheets:i}}function W9(n){var t={},e=n||{};return e.dense&&(t["!data"]=[]),t}function uR(n,t,e){var i=e||{},r=n?n["!data"]!=null:i.dense,s=n||(r?{"!data":[]}:{});r&&!s["!data"]&&(s["!data"]=[]);var a=0,l=0;if(s&&i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var u=typeof i.origin=="string"?Un(i.origin):i.origin;a=u.r,l=u.c}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=In(s["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),a==-1&&(f.e.r=a=s["!ref"]?d.e.r+1:0)}else f.s.c=f.e.c=f.s.r=f.e.r=0;for(var p=[],m=!1,v=0;v!=t.length;++v)if(t[v]){if(!Array.isArray(t[v]))throw new Error("aoa_to_sheet expects an array of arrays");var x=a+v;r&&(s["!data"][x]||(s["!data"][x]=[]),p=s["!data"][x]);for(var _=t[v],b=0;b!=_.length;++b)if(!(typeof _[b]>"u")){var E={v:_[b],t:""},T=l+b;if(f.s.r>x&&(f.s.r=x),f.s.c>T&&(f.s.c=T),f.e.r<x&&(f.e.r=x),f.e.c<T&&(f.e.c=T),m=!0,_[b]&&typeof _[b]=="object"&&!Array.isArray(_[b])&&!(_[b]instanceof Date))E=_[b];else if(Array.isArray(E.v)&&(E.f=_[b][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(i.nullError)E.t="e",E.v=0;else if(i.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?isFinite(E.v)?E.t="n":isNaN(E.v)?(E.t="e",E.v=15):(E.t="e",E.v=7):typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=i.dateNF||Ln[14],i.UTC||(E.v=cv(E.v)),i.cellDates?(E.t="d",E.w=zo(E.z,$i(E.v,i.date1904))):(E.t="n",E.v=$i(E.v,i.date1904),E.w=zo(E.z,E.v))):E.t="s";if(r)p[T]&&p[T].z&&(E.z=p[T].z),p[T]=E;else{var S=xn(T)+(x+1);s[S]&&s[S].z&&(E.z=s[S].z),s[S]=E}}}return m&&f.s.c<104e5&&(s["!ref"]=di(f)),s}function kf(n,t){return uR(null,n,t)}function q9(n){return n.read_shift(4,"i")}function la(n,t){return t||(t=Ft(4)),t.write_shift(4,n),t}function ar(n){var t=n.read_shift(4);return t===0?"":n.read_shift(t,"dbcs")}function Ei(n,t){var e=!1;return t==null&&(e=!0,t=Ft(4+2*n.length)),t.write_shift(4,n.length),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}function Y9(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function X9(n,t){return t||(t=Ft(4)),t.write_shift(2,0),t.write_shift(2,0),t}function oy(n,t){var e=n.l,i=n.read_shift(1),r=ar(n),s=[],a={t:r,h:r};if((i&1)!==0){for(var l=n.read_shift(4),u=0;u!=l;++u)s.push(Y9(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=e+t,a}function K9(n,t){var e=!1;return t==null&&(e=!0,t=Ft(15+4*n.t.length)),t.write_shift(1,0),Ei(n.t,t),e?t.slice(0,t.l):t}var Z9=oy;function Q9(n,t){var e=!1;return t==null&&(e=!0,t=Ft(23+4*n.t.length)),t.write_shift(1,1),Ei(n.t,t),t.write_shift(4,1),X9({},t),e?t.slice(0,t.l):t}function $s(n){var t=n.read_shift(4),e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:t,iStyleRef:e}}function Wc(n,t){return t==null&&(t=Ft(8)),t.write_shift(-4,n.c),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}function qc(n){var t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:t}}function Yc(n,t){return t==null&&(t=Ft(4)),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}var J9=ar,fR=Ei;function uv(n){var t=n.read_shift(4);return t===0||t===4294967295?"":n.read_shift(t,"dbcs")}function Xd(n,t){var e=!1;return t==null&&(e=!0,t=Ft(127)),t.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}var tH=ar,Nx=uv,ly=Xd;function cy(n){var t=n.slice(n.l,n.l+4),e=t[0]&1,i=t[0]&2;n.l+=4;var r=i===0?bg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):_c(t,0)>>2;return e?r/100:r}function hR(n,t){t==null&&(t=Ft(4));var e=0,i=0,r=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?i=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(i=1,e=1),i)t.write_shift(-4,((e?r:n)<<2)+(e+2));else throw new Error("unsupported RkNumber "+n)}function dR(n){var t={s:{},e:{}};return t.s.r=n.read_shift(4),t.e.r=n.read_shift(4),t.s.c=n.read_shift(4),t.e.c=n.read_shift(4),t}function eH(n,t){return t||(t=Ft(16)),t.write_shift(4,n.s.r),t.write_shift(4,n.e.r),t.write_shift(4,n.s.c),t.write_shift(4,n.e.c),t}var Xc=dR,Lf=eH;function If(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Bc(n,t){return(t||Ft(8)).write_shift(8,n,"f")}function nH(n){var t={},e=n.read_shift(1),i=e>>>1,r=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),l=n.read_shift(1),u=n.read_shift(1);switch(n.l++,i){case 0:t.auto=1;break;case 1:t.index=r;var f=fH[r];f&&(t.rgb=QS(f));break;case 2:t.rgb=QS([a,l,u]);break;case 3:t.theme=r;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function yg(n,t){if(t||(t=Ft(8)),!n||n.auto)return t.write_shift(4,0),t.write_shift(4,0),t;n.index!=null?(t.write_shift(1,2),t.write_shift(1,n.index)):n.theme!=null?(t.write_shift(1,6),t.write_shift(1,n.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=n.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!n.rgb||n.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=n.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function iH(n){var t=n.read_shift(1);n.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function rH(n,t){t||(t=Ft(2));var e=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var pR=2,ss=3,Am=11,Eg=19,Sm=64,sH=65,aH=71,oH=4108,lH=4126,Bi=80,jS={1:{n:"CodePage",t:pR},2:{n:"Category",t:Bi},3:{n:"PresentationFormat",t:Bi},4:{n:"ByteCount",t:ss},5:{n:"LineCount",t:ss},6:{n:"ParagraphCount",t:ss},7:{n:"SlideCount",t:ss},8:{n:"NoteCount",t:ss},9:{n:"HiddenCount",t:ss},10:{n:"MultimediaClipCount",t:ss},11:{n:"ScaleCrop",t:Am},12:{n:"HeadingPairs",t:oH},13:{n:"TitlesOfParts",t:lH},14:{n:"Manager",t:Bi},15:{n:"Company",t:Bi},16:{n:"LinksUpToDate",t:Am},17:{n:"CharacterCount",t:ss},19:{n:"SharedDoc",t:Am},22:{n:"HyperlinksChanged",t:Am},23:{n:"AppVersion",t:ss,p:"version"},24:{n:"DigSig",t:sH},26:{n:"ContentType",t:Bi},27:{n:"ContentStatus",t:Bi},28:{n:"Language",t:Bi},29:{n:"Version",t:Bi},255:{},2147483648:{n:"Locale",t:Eg},2147483651:{n:"Behavior",t:Eg},1919054434:{}},HS={1:{n:"CodePage",t:pR},2:{n:"Title",t:Bi},3:{n:"Subject",t:Bi},4:{n:"Author",t:Bi},5:{n:"Keywords",t:Bi},6:{n:"Comments",t:Bi},7:{n:"Template",t:Bi},8:{n:"LastAuthor",t:Bi},9:{n:"RevNumber",t:Bi},10:{n:"EditTime",t:Sm},11:{n:"LastPrinted",t:Sm},12:{n:"CreatedDate",t:Sm},13:{n:"ModifiedDate",t:Sm},14:{n:"PageCount",t:ss},15:{n:"WordCount",t:ss},16:{n:"CharCount",t:ss},17:{n:"Thumbnail",t:aH},18:{n:"Application",t:Bi},19:{n:"DocSecurity",t:ss},255:{},2147483648:{n:"Locale",t:Eg},2147483651:{n:"Behavior",t:Eg},1919054434:{}};function cH(n){return n.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var uH=cH([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),fH=or(uH),Dr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$a={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},hH=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],dH={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Tm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function mR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gR(n,t,e){var i=p9(dH),r=[],s;r[r.length]=pi,r[r.length]=se("Types",null,{xmlns:Di.CT,"xmlns:xsd":Di.xsd,"xmlns:xsi":Di.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return se("Default",null,{Extension:f[0],ContentType:f[1]})}));var a=function(f){n[f]&&n[f].length>0&&(s=n[f][0],r[r.length]=se("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Tm[f][t.bookType]||Tm[f].xlsx}))},l=function(f){(n[f]||[]).forEach(function(d){r[r.length]=se("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Tm[f][t.bookType]||Tm[f].xlsx})})},u=function(f){(n[f]||[]).forEach(function(d){r[r.length]=se("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:i[f][0]})})};return a("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var en={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vR(n){var t=n.lastIndexOf("/");return n.slice(0,t+1)+"_rels/"+n.slice(t+1)+".rels"}function ef(n){var t=[pi,se("Relationships",null,{xmlns:Di.RELS})];return hi(n["!id"]).forEach(function(e){t[t.length]=se("Relationship",null,n["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function un(n,t,e,i,r,s){if(r||(r={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),t<0)for(t=n["!idx"];n["!id"]["rId"+t];++t);if(n["!idx"]=t+1,r.Id="rId"+t,r.Type=i,r.Target=e,[en.HLINK,en.XPATH,en.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),n["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return n["!id"][r.Id]=r,n[("/"+r.Target).replace("//","/")]=r,t}function pH(n){var t=[pi];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<n.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+n[e][0]+'" manifest:media-type="'+n[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function $S(n,t,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function mH(n,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function gH(n){var t=[pi];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=n.length;++e)t.push($S(n[e][0],n[e][1])),t.push(mH("",n[e][0]));return t.push($S("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function _R(n,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+hg.version+"</meta:generator></office:meta></office:document-meta>"}var Tc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function j_(n,t,e,i,r){r[n]!=null||t==null||t===""||(r[n]=t,t=$e(t),i[i.length]=e?se(n,t,e):zi(n,t))}function xR(n,t){var e=t||{},i=[pi,se("cp:coreProperties",null,{"xmlns:cp":Di.CORE_PROPS,"xmlns:dc":Di.dc,"xmlns:dcterms":Di.dcterms,"xmlns:dcmitype":Di.dcmitype,"xmlns:xsi":Di.xsi})],r={};if(!n&&!e.Props)return i.join("");n&&(n.CreatedDate!=null&&j_("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Rx(n.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),n.ModifiedDate!=null&&j_("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Rx(n.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var s=0;s!=Tc.length;++s){var a=Tc[s],l=e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:n?n[a[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&j_(a[0],l,null,i,r)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var nf=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],bR=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function yR(n){var t=[],e=se;return n||(n={}),n.Application="SheetJS",t[t.length]=pi,t[t.length]=se("Properties",null,{xmlns:Di.EXT_PROPS,"xmlns:vt":Di.vt}),nf.forEach(function(i){if(n[i[1]]!==void 0){var r;switch(i[2]){case"string":r=$e(String(n[i[1]]));break;case"bool":r=n[i[1]]?"true":"false";break}r!==void 0&&(t[t.length]=e(i[0],r))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",n.SheetNames.map(function(i){return"<vt:lpstr>"+$e(i)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function ER(n){var t=[pi,se("Properties",null,{xmlns:Di.CUST_PROPS,"xmlns:vt":Di.vt})];if(!n)return t.join("");var e=1;return hi(n).forEach(function(r){++e,t[t.length]=se("property",k9(n[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:$e(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var GS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function vH(n,t){var e=[];return hi(GS).map(function(i){for(var r=0;r<Tc.length;++r)if(Tc[r][1]==i)return Tc[r];for(r=0;r<nf.length;++r)if(nf[r][1]==i)return nf[r];throw i}).forEach(function(i){if(n[i[1]]!=null){var r=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:n[i[1]];switch(i[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),e.push(zi(GS[i[1]]||i[1],r))}}),se("DocumentProperties",e.join(""),{xmlns:ls.o})}function _H(n,t){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",r=[];return n&&hi(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<Tc.length;++a)if(s==Tc[a][1])return;for(a=0;a<nf.length;++a)if(s==nf[a][1])return;for(a=0;a<e.length;++a)if(s==e[a])return;var l=n[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l=String(l),r.push(se(NS(s),l,{"dt:dt":u}))}}),t&&hi(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a instanceof Date?(l="dateTime.tz",a=a.toISOString()):a=String(a),r.push(se(NS(s),a,{"dt:dt":l}))}}),"<"+i+' xmlns="'+ls.o+'">'+r.join("")+"</"+i+">"}function xH(n){var t=typeof n=="string"?new Date(Date.parse(n)):n,e=t.getTime()/1e3+11644473600,i=e%Math.pow(2,32),r=(e-i)/Math.pow(2,32);i*=1e7,r*=1e7;var s=i/Math.pow(2,32)|0;s>0&&(i=i%Math.pow(2,32),r+=s);var a=Ft(8);return a.write_shift(4,i),a.write_shift(4,r),a}function VS(n,t){var e=Ft(4),i=Ft(4);switch(e.write_shift(4,n==80?31:n),n){case 3:i.write_shift(-4,t);break;case 5:i=Ft(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=xH(t);break;case 31:case 80:for(i=Ft(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+t)}return fi([e,i])}var wR=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function bH(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function WS(n,t,e){var i=Ft(8),r=[],s=[],a=8,l=0,u=Ft(8),f=Ft(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),s.push(u),r.push(f),a+=8+u.length,!t){f=Ft(8),f.write_shift(4,0),r.unshift(f);var d=[Ft(4)];for(d[0].write_shift(4,n.length),l=0;l<n.length;++l){var p=n[l][0];for(u=Ft(8+2*(p.length+1)+(p.length%2?0:2)),u.write_shift(4,l+2),u.write_shift(4,p.length+1),u.write_shift(0,p,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=fi(d),s.unshift(u),a+=8+u.length}for(l=0;l<n.length;++l)if(!(t&&!t[n[l][0]])&&!(wR.indexOf(n[l][0])>-1||bR.indexOf(n[l][0])>-1)&&n[l][1]!=null){var m=n[l][1],v=0;if(t){v=+t[n[l][0]];var x=e[v];if(x.p=="version"&&typeof m=="string"){var _=m.split(".");m=(+_[0]<<16)+(+_[1]||0)}u=VS(x.t,m)}else{var b=bH(m);b==-1&&(b=31,m=String(m)),u=VS(b,m)}s.push(u),f=Ft(8),f.write_shift(4,t?v:2+l),r.push(f),a+=8+u.length}var E=8*(s.length+1);for(l=0;l<s.length;++l)r[l].write_shift(4,E),E+=s[l].length;return i.write_shift(4,a),i.write_shift(4,s.length),fi([i].concat(r).concat(s))}function qS(n,t,e,i,r,s){var a=Ft(r?68:48),l=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Rn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,r?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,r?68:48);var u=WS(n,e,i);if(l.push(u),r){var f=WS(r,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+u.length),l.push(f)}return fi(l)}function yH(n,t){t||(t=Ft(n));for(var e=0;e<n;++e)t.write_shift(1,0);return t}function EH(n,t){return n.read_shift(t)===1}function nr(n,t){return t||(t=Ft(2)),t.write_shift(2,+!!n),t}function qm(n){return n.read_shift(2,"u")}function Is(n,t){return t||(t=Ft(2)),t.write_shift(2,n),t}function AR(n,t,e){return e||(e=Ft(2)),e.write_shift(1,t=="e"?+n:+!!n),e.write_shift(1,t=="e"?1:0),e}function SR(n,t,e){var i=n.read_shift(e&&e.biff>=12?2:1),r="sbcs-cont",s=Ro;if(e&&e.biff>=8&&(Ro=1200),!e||e.biff==8){var a=n.read_shift(1);a&&(r="dbcs-cont")}else e.biff==12&&(r="wstr");e.biff>=2&&e.biff<=5&&(r="cpstr");var l=i?n.read_shift(i,r):"";return Ro=s,l}function wH(n){var t=n.t||"",e=Ft(3);e.write_shift(2,t.length),e.write_shift(1,1);var i=Ft(2*t.length);i.write_shift(2*t.length,t,"utf16le");var r=[e,i];return fi(r)}function AH(n,t,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return n.read_shift(t,"cpstr");if(e.biff>=12)return n.read_shift(t,"dbcs-cont")}var r=n.read_shift(1);return r===0?i=n.read_shift(t,"sbcs-cont"):i=n.read_shift(t,"dbcs-cont"),i}function SH(n,t,e){var i=n.read_shift(e&&e.biff==2?1:2);return i===0?(n.l++,""):AH(n,i,e)}function TH(n,t,e){if(e.biff>5)return SH(n,t,e);var i=n.read_shift(1);return i===0?(n.l++,""):n.read_shift(i,e.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function TR(n,t,e){return e||(e=Ft(3+2*n.length)),e.write_shift(2,n.length),e.write_shift(1,1),e.write_shift(31,n,"utf16le"),e}function YS(n,t){t||(t=Ft(6+n.length*2)),t.write_shift(4,1+n.length);for(var e=0;e<n.length;++e)t.write_shift(2,n.charCodeAt(e));return t.write_shift(2,0),t}function CH(n){var t=Ft(512),e=0,i=n.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var r=i.indexOf("#"),s=r>-1?31:23;switch(i.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)t.write_shift(4,a[e]);if(s==28)i=i.slice(1),YS(i,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));var l=r>-1?i.slice(0,r):i;for(t.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)t.write_shift(2,l.charCodeAt(e));t.write_shift(2,0),s&8&&YS(r>-1?i.slice(r+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));for(var u=0;i.slice(u*3,u*3+3)=="../"||i.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,i.length-3*u+1),e=0;e<i.length-3*u;++e)t.write_shift(1,i.charCodeAt(e+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function Uc(n,t,e,i){return i||(i=Ft(6)),i.write_shift(2,n),i.write_shift(2,t),i.write_shift(2,e||0),i}function DH(n,t,e){var i=e.biff>8?4:2,r=n.read_shift(i),s=n.read_shift(i,"i"),a=n.read_shift(i,"i");return[r,s,a]}function OH(n){var t=n.read_shift(2),e=n.read_shift(2),i=n.read_shift(2),r=n.read_shift(2);return{s:{c:i,r:t},e:{c:r,r:e}}}function CR(n,t){return t||(t=Ft(8)),t.write_shift(2,n.s.r),t.write_shift(2,n.e.r),t.write_shift(2,n.s.c),t.write_shift(2,n.e.c),t}function uy(n,t,e){var i=1536,r=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ft(r);return s.write_shift(2,i),s.write_shift(2,t),r>4&&s.write_shift(2,29282),r>6&&s.write_shift(2,1997),r>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function RH(n,t){var e=!t||t.biff==8,i=Ft(e?112:54);for(i.write_shift(t.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function NH(n,t){var e=!t||t.biff>=8?2:1,i=Ft(8+e*n.name.length);i.write_shift(4,n.pos),i.write_shift(1,n.hs||0),i.write_shift(1,n.dt),i.write_shift(1,n.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(e*n.name.length,n.name,t.biff<8?"sbcs":"utf16le");var r=i.slice(0,i.l);return r.l=i.l,r}function kH(n,t){var e=Ft(8);e.write_shift(4,n.Count),e.write_shift(4,n.Unique);for(var i=[],r=0;r<n.length;++r)i[r]=wH(n[r]);var s=fi([e].concat(i));return s.parts=[e.length].concat(i.map(function(a){return a.length})),s}function LH(){var n=Ft(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function IH(n){var t=Ft(18),e=1718;return n&&n.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function MH(n,t){var e=n.name||"Arial",i=t&&t.biff==5,r=i?15+e.length:16+2*e.length,s=Ft(r);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,e.length),i||s.write_shift(1,1),s.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),s}function PH(n,t,e,i){var r=Ft(10);return Uc(n,t,i,r),r.write_shift(4,e),r}function FH(n,t,e,i,r){var s=!r||r.biff==8,a=Ft(8+ +s+(1+s)*e.length);return Uc(n,t,i,a),a.write_shift(2,e.length),s&&a.write_shift(1,1),a.write_shift((1+s)*e.length,e,s?"utf16le":"sbcs"),a}function BH(n,t,e,i){var r=e&&e.biff==5;i||(i=Ft(r?3+t.length:5+2*t.length)),i.write_shift(2,n),i.write_shift(r?1:2,t.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var s=i.length>i.l?i.slice(0,i.l):i;return s.l==null&&(s.l=s.length),s}function UH(n){var t=Ft(1+n.length);return t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t}function zH(n){var t=Ft(3+n.length);return t.l+=2,t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t}function jH(n,t){var e=t.biff==8||!t.biff?4:2,i=Ft(2*e+6);return i.write_shift(e,n.s.r),i.write_shift(e,n.e.r+1),i.write_shift(2,n.s.c),i.write_shift(2,n.e.c+1),i.write_shift(2,0),i}function XS(n,t,e,i){var r=e&&e.biff==5;i||(i=Ft(r?16:20)),i.write_shift(2,0),n.style?(i.write_shift(2,n.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,n.numFmtId||0),i.write_shift(2,t<<4));var s=0;return n.numFmtId>0&&r&&(s|=1024),i.write_shift(4,s),i.write_shift(4,0),r||i.write_shift(4,0),i.write_shift(2,0),i}function HH(n){var t=Ft(4);return t.l+=2,t.write_shift(1,n.numFmtId),t.l++,t}function DR(n){var t=Ft(12);return t.l++,t.write_shift(1,n.numFmtId),t.l+=10,t}var $H=DR;function GH(n){var t=Ft(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function H_(n,t,e,i,r,s){var a=Ft(8);return Uc(n,t,i,a),AR(e,s,a),a}function VH(n,t,e,i){var r=Ft(14);return Uc(n,t,i,r),Bc(e,r),r}function WH(n,t,e){if(e.biff<8||!(e.biff>8)&&t==n[n.l]+(n[n.l+1]==3?1:0)+1)return KS(n,t,e);for(var i=[],r=n.l+t,s=n.read_shift(e.biff>8?4:2);s--!==0;)i.push(DH(n,e.biff>8?12:6,e));if(n.l!=r)throw new Error("Bad ExternSheet: "+n.l+" != "+r);return i}function KS(n,t,e){n[n.l+1]==3&&n[n.l]++;var i=SR(n,t,e);return i.charCodeAt(0)==3?i.slice(1):i}function $_(n,t,e,i){var r=Ft(6+(i||n.length));return r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,i||n.length),r.write_shift(n.length,n,"sbcs"),r}function qH(n){var t=Ft(2+n.length*8);t.write_shift(2,n.length);for(var e=0;e<n.length;++e)CR(n[e],t);return t}function YH(n){var t=Ft(24),e=Un(n[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(i[r],16));return fi([t,CH(n[1])])}function XH(n){var t=n[1].Tooltip,e=Ft(10+2*(t.length+1));e.write_shift(2,2048);var i=Un(n[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function KH(n){return n||(n=Ft(4)),n.write_shift(2,1),n.write_shift(2,1),n}function ZH(n,t,e){if(!e.cellStyles)return qa(n,t);var i=e&&e.biff>=12?4:2,r=n.read_shift(i),s=n.read_shift(i),a=n.read_shift(i),l=n.read_shift(i),u=n.read_shift(2);i==2&&(n.l+=2);var f={s:r,e:s,w:a,ixfe:l,flags:u};return(e.biff>=5||!e.biff)&&(f.level=u>>8&7),f}function QH(n,t){var e=Ft(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,n.width*256),e.write_shift(2,0);var i=0;return n.hidden&&(i|=1),e.write_shift(1,i),i=n.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function JH(n){for(var t=Ft(2*n),e=0;e<n;++e)t.write_shift(2,e+1);return t}function vp(n,t,e,i,r){return n||(n=Ft(7)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,i||0),n.write_shift(1,r||0),n.write_shift(1,0),n}function t$(n,t,e,i,r){var s=Ft(15);return vp(s,n,t,i||0,r||0),s.write_shift(8,e,"f"),s}function e$(n,t,e,i,r){var s=Ft(9);return vp(s,n,t,i||0,r||0),s.write_shift(2,e),s}var n$=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Qb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,u){var f=[],d=Mc(1);switch(u.type){case"base64":d=os(Ll(l));break;case"binary":d=os(l);break;case"buffer":case"array":d=l;break}wr(d,0);var p=d.read_shift(1),m=!!(p&136),v=!1,x=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var _=0,b=521;p==2&&(_=d.read_shift(2)),d.l+=3,p!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),p!=2&&(b=d.read_shift(2));var E=d.read_shift(2);u.codepage,p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&n[d[d.l]],d.l+=1,d.l+=2),x&&(d.l+=36);for(var T=[],S={},O=Math.min(d.length,p==2?521:b-10-(v?264:0)),R=x?32:11;d.l<O&&d[d.l]!=13;)switch(S={},S.name=Pc(d.slice(d.l,d.l+R)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=R,S.type=String.fromCharCode(d.read_shift(1)),p!=2&&!x&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),p==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&T.push(S),p!=2&&(d.l+=x?13:14),S.type){case"B":(!v||S.len!=8)&&u.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=b-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=b;var N=0,C=0;for(f[0]=[],C=0;C!=T.length;++C)f[0][C]=T[C].name;for(;_-- >0;){if(d[d.l]===42){d.l+=E;continue}for(++d.l,f[++N]=[],C=0,C=0;C!=T.length;++C){var M=d.slice(d.l,d.l+T[C].len);d.l+=T[C].len,wr(M,0);var I=Pc(M);switch(T[C].type){case"C":I.trim().length&&(f[N][C]=I.replace(/([^\s])\s+$/,"$1"));break;case"D":I.length===8?(f[N][C]=new Date(Date.UTC(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8),0,0,0,0)),u&&u.UTC||(f[N][C]=xf(f[N][C]))):f[N][C]=I;break;case"F":f[N][C]=parseFloat(I.trim());break;case"+":case"I":f[N][C]=x?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":f[N][C]=!0;break;case"N":case"F":f[N][C]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[N][C]="##MEMO##"+(x?parseInt(I.trim(),10):M.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(f[N][C]=+I||0);break;case"@":f[N][C]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":{var F=M.read_shift(4),z=M.read_shift(4);if(F==0&&z==0)break;f[N][C]=new Date((F-2440588)*864e5+z),u&&u.UTC||(f[N][C]=xf(f[N][C]))}break;case"Y":f[N][C]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[N][C]=-M.read_shift(-8,"f");break;case"B":if(v&&T[C].len==8){f[N][C]=M.read_shift(8,"f");break}case"G":case"P":M.l+=T[C].len;break;case"0":if(T[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[C].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=T,f}function i(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=kf(e(l,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function r(l,u){try{var f=Nf(i(l,u),u);return f.bookType="dbf",f}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,u){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var f=u||{},d=Ro;if(+f.codepage>=0&&Gd(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=sr(),m=Mx(l,{header:1,raw:!0,cellDates:!0}),v=m[0],x=m.slice(1),_=l["!cols"]||[],b=0,E=0,T=0,S=1;for(b=0;b<v.length;++b){if(((_[b]||{}).DBF||{}).name){v[b]=_[b].DBF.name,++T;continue}if(v[b]!=null){if(++T,typeof v[b]=="number"&&(v[b]=v[b].toString(10)),typeof v[b]!="string")throw new Error("DBF Invalid column name "+v[b]+" |"+typeof v[b]+"|");if(v.indexOf(v[b])!==b){for(E=0;E<1024;++E)if(v.indexOf(v[b]+"_"+E)==-1){v[b]+="_"+E;break}}}}var O=In(l["!ref"]),R=[],N=[],C=[];for(b=0;b<=O.e.c-O.s.c;++b){var M="",I="",F=0,z=[];for(E=0;E<x.length;++E)x[E][b]!=null&&z.push(x[E][b]);if(z.length==0||v[b]==null){R[b]="?";continue}for(E=0;E<z.length;++E){switch(typeof z[E]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=z[E]instanceof Date?"D":"C";break;default:I="C"}F=Math.max(F,String(z[E]).length),M=M&&M!=I?"C":I}F>250&&(F=250),I=((_[b]||{}).DBF||{}).type,I=="C"&&_[b].DBF.len>F&&(F=_[b].DBF.len),M=="B"&&I=="N"&&(M="N",C[b]=_[b].DBF.dec,F=_[b].DBF.len),N[b]=M=="C"||I=="N"?F:s[M]||0,S+=N[b],R[b]=M}var P=p.next(32);for(P.write_shift(4,318902576),P.write_shift(4,x.length),P.write_shift(2,296+32*T),P.write_shift(2,S),b=0;b<4;++b)P.write_shift(4,0);var tt=+t[Ro]||3;for(P.write_shift(4,0|tt<<8),n[tt]!=+f.codepage&&(f.codepage&&console.error("DBF Unsupported codepage "+Ro+", using 1252"),Ro=1252),b=0,E=0;b<v.length;++b)if(v[b]!=null){var L=p.next(32),nt=(v[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,nt,"sbcs"),L.write_shift(1,R[b]=="?"?"C":R[b],"sbcs"),L.write_shift(4,E),L.write_shift(1,N[b]||s[R[b]]||0),L.write_shift(1,C[b]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),E+=N[b]||s[R[b]]||0}var Q=p.next(264);for(Q.write_shift(4,13),b=0;b<65;++b)Q.write_shift(4,0);for(b=0;b<x.length;++b){var X=p.next(S);for(X.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(R[E]){case"L":X.write_shift(1,x[b][E]==null?63:x[b][E]?84:70);break;case"B":X.write_shift(8,x[b][E]||0,"f");break;case"N":var Rt="0";for(typeof x[b][E]=="number"&&(Rt=x[b][E].toFixed(C[E]||0)),Rt.length>N[E]&&(Rt=Rt.slice(0,N[E])),T=0;T<N[E]-Rt.length;++T)X.write_shift(1,32);X.write_shift(1,Rt,"sbcs");break;case"D":x[b][E]?(X.write_shift(4,("0000"+x[b][E].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(x[b][E].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+x[b][E].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var yt=X.l,j=String(x[b][E]!=null?x[b][E]:"").slice(0,N[E]);for(X.write_shift(1,j,"cpstr"),yt+=N[E]-X.l,T=0;T<yt;++T)X.write_shift(1,32);break}}return Ro=d,p.next(1).write_shift(1,26),p.end()}return{to_workbook:r,to_sheet:i,from_sheet:a}}(),i$=function(){var n={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+hi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+hi(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var e=function(v,x){var _=n[x];return typeof _=="number"?xS(_):_},i=function(v,x,_){var b=x.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return b==59?v:xS(b)};n["|"]=254;var r=function(v){return v.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function s(v,x){switch(x.type){case"base64":return a(Ll(v),x);case"binary":return a(v,x);case"buffer":return a(fn&&Buffer.isBuffer(v)?v.toString("binary"):Pc(v),x);case"array":return a(Jb(v),x)}throw new Error("Unrecognized type "+x.type)}function a(v,x){var _=v.split(/[\n\r]+/),b=-1,E=-1,T=0,S=0,O=[],R=[],N=null,C={},M=[],I=[],F=[],z=0,P,tt={Workbook:{WBProps:{},Names:[]}};for(+x.codepage>=0&&Gd(+x.codepage);T!==_.length;++T){z=0;var L=_[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,e),nt=L.replace(/;;/g,"\0").split(";").map(function(ct){return ct.replace(/\u0000/g,";")}),Q=nt[0],X;if(L.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":for(S=1;S<nt.length;++S)switch(nt[S].charAt(0)){case"V":{var Rt=parseInt(nt[S].slice(1),10);Rt>=1&&Rt<=4&&(tt.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(nt[1].charAt(0)){case"P":R.push(L.slice(3).replace(/;;/g,";"));break}break;case"NN":{var yt={Sheet:0};for(S=1;S<nt.length;++S)switch(nt[S].charAt(0)){case"N":yt.Name=nt[S].slice(1);break;case"E":yt.Ref=(x&&x.sheet||"Sheet1")+"!"+eT(nt[S].slice(1));break}tt.Workbook.Names.push(yt)}break;case"C":var j=!1,J=!1,G=!1,ut=!1,gt=-1,_t=-1,Bt="",Gt="z",H="";for(S=1;S<nt.length;++S)switch(nt[S].charAt(0)){case"A":H=nt[S].slice(1);break;case"X":E=parseInt(nt[S].slice(1),10)-1,J=!0;break;case"Y":for(b=parseInt(nt[S].slice(1),10)-1,J||(E=0),P=O.length;P<=b;++P)O[P]=[];break;case"K":X=nt[S].slice(1),X.charAt(0)==='"'?(X=X.slice(1,X.length-1),Gt="s"):X==="TRUE"||X==="FALSE"?(X=X==="TRUE",Gt="b"):X.charAt(0)=="#"&&$a[X]!=null?(Gt="e",X=$a[X]):isNaN(Mo(X))||(X=Mo(X),Gt="n",N!==null&&Fc(N)&&x.cellDates&&(X=Ju(tt.Workbook.WBProps.date1904?X+1462:X),Gt=typeof X=="number"?"n":"d")),j=!0;break;case"E":ut=!0,Bt=eT(nt[S].slice(1),{r:b,c:E});break;case"S":G=!0;break;case"G":break;case"R":gt=parseInt(nt[S].slice(1),10)-1;break;case"C":_t=parseInt(nt[S].slice(1),10)-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}if(j&&(O[b][E]?(O[b][E].t=Gt,O[b][E].v=X):O[b][E]={t:Gt,v:X},N&&(O[b][E].z=N),x.cellText!==!1&&N&&(O[b][E].w=zo(O[b][E].z,O[b][E].v,{date1904:tt.Workbook.WBProps.date1904})),N=null),G){if(ut)throw new Error("SYLK shared formula cannot have own formula");var mt=gt>-1&&O[gt][_t];if(!mt||!mt[1])throw new Error("SYLK shared formula cannot find base");Bt=rG(mt[1],{r:b-gt,c:E-_t})}Bt&&(O[b][E]?O[b][E].f=Bt:O[b][E]={t:"n",f:Bt}),H&&(O[b][E]||(O[b][E]={t:"z"}),O[b][E].c=[{a:"SheetJSYLK",t:H}]);break;case"F":var lt=0;for(S=1;S<nt.length;++S)switch(nt[S].charAt(0)){case"X":E=parseInt(nt[S].slice(1),10)-1,++lt;break;case"Y":for(b=parseInt(nt[S].slice(1),10)-1,P=O.length;P<=b;++P)O[P]=[];break;case"M":z=parseInt(nt[S].slice(1),10)/20;break;case"F":break;case"G":break;case"P":N=R[parseInt(nt[S].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(F=nt[S].slice(1).split(" "),P=parseInt(F[0],10);P<=parseInt(F[1],10);++P)z=parseInt(F[2],10),I[P-1]=z===0?{hidden:!0}:{wch:z};break;case"C":E=parseInt(nt[S].slice(1),10)-1,I[E]||(I[E]={});break;case"R":b=parseInt(nt[S].slice(1),10)-1,M[b]||(M[b]={}),z>0?(M[b].hpt=z,M[b].hpx=kR(z)):z===0&&(M[b].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}lt<1&&(N=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}}return M.length>0&&(C["!rows"]=M),I.length>0&&(C["!cols"]=I),I.forEach(function(ct){fy(ct)}),x&&x.sheetRows&&(O=O.slice(0,x.sheetRows)),[O,C,tt]}function l(v,x){var _=s(v,x),b=_[0],E=_[1],T=_[2],S=or(x);S.date1904=(((T||{}).Workbook||{}).WBProps||{}).date1904;var O=kf(b,S);hi(E).forEach(function(N){O[N]=E[N]});var R=Nf(O,x);return hi(T).forEach(function(N){R[N]=T[N]}),R.bookType="sylk",R}function u(v,x,_,b,E,T){var S="C;Y"+(_+1)+";X"+(b+1)+";K";switch(v.t){case"n":S+=isFinite(v.v)?v.v||0:Dr[isNaN(v.v)?36:7],v.f&&!v.F&&(S+=";E"+hv(v.f,{r:_,c:b}));break;case"b":S+=v.v?"TRUE":"FALSE";break;case"e":S+=v.w||Dr[v.v]||v.v;break;case"d":S+=$i(Wr(v.v,T),T);break;case"s":S+='"'+(v.v==null?"":String(v.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function f(v,x,_){var b="C;Y"+(x+1)+";X"+(_+1)+";A";return b+=r(v.map(function(E){return E.t}).join("")),b}function d(v,x){x.forEach(function(_,b){var E="F;W"+(b+1)+" "+(b+1)+" ";_.hidden?E+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=wg(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Ag(_.wpx)),typeof _.wch=="number"&&(E+=Math.round(_.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function p(v,x){x.forEach(function(_,b){var E="F;";_.hidden?E+="M0;":_.hpt?E+="M"+20*_.hpt+";":_.hpx&&(E+="M"+20*Sg(_.hpx)+";"),E.length>2&&v.push(E+"R"+(b+1))})}function m(v,x,_){x||(x={}),x._formats=["General"];var b=["ID;PSheetJS;N;E"],E=[],T=In(v["!ref"]||"A1"),S,O=v["!data"]!=null,R=`\r
`,N=(((_||{}).Workbook||{}).WBProps||{}).date1904,C="General";b.push("P;PGeneral");var M=T.s.r,I=T.s.c,F=[];if(v["!ref"]){for(M=T.s.r;M<=T.e.r;++M)if(!(O&&!v["!data"][M])){for(F=[],I=T.s.c;I<=T.e.c;++I)S=O?v["!data"][M][I]:v[xn(I)+Sn(M)],!(!S||!S.c)&&F.push(f(S.c,M,I));F.length&&E.push(F.join(R))}}if(v["!ref"]){for(M=T.s.r;M<=T.e.r;++M)if(!(O&&!v["!data"][M])){for(F=[],I=T.s.c;I<=T.e.c;++I)if(S=O?v["!data"][M][I]:v[xn(I)+Sn(M)],!(!S||S.v==null&&(!S.f||S.F))){if((S.z||(S.t=="d"?Ln[14]:"General"))!=C){var z=x._formats.indexOf(S.z);z==-1&&(x._formats.push(S.z),z=x._formats.length-1,b.push("P;P"+S.z.replace(/;/g,";;"))),F.push("F;P"+z+";Y"+(M+1)+";X"+(I+1))}F.push(u(S,v,M,I,x,N))}E.push(F.join(R))}}return b.push("F;P0;DG0G8;M255"),v["!cols"]&&d(b,v["!cols"]),v["!rows"]&&p(b,v["!rows"]),v["!ref"]&&b.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" ")),b.push("O;L;D;B"+(N?";V4":"")+";K47;G100 0.001"),delete x._formats,b.join(R)+R+E.join(R)+R+"E"+R}return{to_workbook:l,from_sheet:m}}(),r$=function(){function n(l,u){switch(u.type){case"base64":return t(Ll(l),u);case"binary":return t(l,u);case"buffer":return t(fn&&Buffer.isBuffer(l)?l.toString("binary"):Pc(l),u);case"array":return t(Jb(l),u)}throw new Error("Unrecognized type "+u.type)}function t(l,u){for(var f=l.split(`
`),d=-1,p=-1,m=0,v=[];m!==f.length;++m){if(f[m].trim()==="BOT"){v[++d]=[],p=0;continue}if(!(d<0)){var x=f[m].trim().split(","),_=x[0],b=x[1];++m;for(var E=f[m]||"";(E.match(/["]/g)||[]).length&1&&m<f.length-1;)E+=`
`+f[++m];switch(E=E.trim(),+_){case-1:if(E==="BOT"){v[++d]=[],p=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?v[d][p]=!0:E==="FALSE"?v[d][p]=!1:isNaN(Mo(b))?isNaN(xg(b).getDate())?v[d][p]=b:(v[d][p]=Wr(b),u&&u.UTC||(v[d][p]=xf(v[d][p]))):v[d][p]=Mo(b),++p;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),v[d][p++]=E!==""?E:null;break}if(E==="EOD")break}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function e(l,u){return kf(n(l,u),u)}function i(l,u){var f=Nf(e(l,u),u);return f.bookType="dif",f}function r(l,u){return"0,"+String(l)+`\r
`+u}function s(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function a(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var u=In(l["!ref"]),f=l["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(u.e.r-u.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(u.e.c-u.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],p=u.s.r;p<=u.e.r;++p){for(var m=f?l["!data"][p]:[],v=`-1,0\r
BOT\r
`,x=u.s.c;x<=u.e.c;++x){var _=f?m&&m[x]:l[Vn({r:p,c:x})];if(_==null){v+=`1,0\r
""\r
`;continue}switch(_.t){case"n":_.w!=null?v+="0,"+_.w+`\r
V`:_.v!=null?v+=r(_.v,"V"):_.f!=null&&!_.F?v+=s("="+_.f):v+=`1,0\r
""`;break;case"b":v+=_.v?r(1,"TRUE"):r(0,"FALSE");break;case"s":v+=s(isNaN(+_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=zo(_.z||Ln[14],$i(Wr(_.v)))),v+=r(_.w,"V");break;default:v+=`1,0\r
""`}v+=`\r
`}d.push(v)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:i,to_sheet:e,from_sheet:a}}(),OR=function(){function n(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,m){for(var v=p.split(`
`),x=-1,_=-1,b=0,E=[];b!==v.length;++b){var T=v[b].trim().split(":");if(T[0]==="cell"){var S=Un(T[1]);if(E.length<=S.r)for(x=E.length;x<=S.r;++x)E[x]||(E[x]=[]);switch(x=S.r,_=S.c,T[2]){case"t":E[x][_]=n(T[3]);break;case"v":E[x][_]=+T[3];break;case"vtf":var O=T[T.length-1];case"vtc":switch(T[3]){case"nl":E[x][_]=!!+T[4];break;default:E[x][_]=T[T.length-1].charAt(0)=="#"?{t:"e",v:$a[T[T.length-1]]}:+T[4];break}T[2]=="vtf"&&(E[x][_]=[E[x][_],O])}}}return m&&m.sheetRows&&(E=E.slice(0,m.sheetRows)),E}function i(p,m){return kf(e(p,m),m)}function r(p,m){return Nf(i(p,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],v=[],x,_="",b=Hi(p["!ref"]),E=p["!data"]!=null,T=b.s.r;T<=b.e.r;++T)for(var S=b.s.c;S<=b.e.c;++S)if(_=Vn({r:T,c:S}),x=E?(p["!data"][T]||[])[S]:p[_],!(!x||x.v==null||x.t==="z")){switch(v=["cell",_,"t"],x.t){case"s":v.push(t(x.v));break;case"b":v[2]="vt"+(x.f?"f":"c"),v[3]="nl",v[4]=x.v?"1":"0",v[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var O=$i(Wr(x.v));v[2]="vtc",v[3]="nd",v[4]=""+O,v[5]=x.w||zo(x.z||Ln[14],O);break;case"n":isFinite(x.v)?x.f?(v[2]="vtf",v[3]="n",v[4]=x.v,v[5]=t(x.f)):(v[2]="v",v[3]=x.v):(v[2]="vt"+(x.f?"f":"c"),v[3]="e"+Dr[isNaN(x.v)?36:7],v[4]="0",v[5]=x.f||v[3].slice(1),v[6]="e",v[7]=v[3].slice(1));break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(p){return[s,a,l,a,f(p),u].join(`
`)}return{to_workbook:r,to_sheet:i,from_sheet:d}}(),s$=function(){function n(d,p,m,v,x){x.raw?p[m][v]=d:d===""||(d==="TRUE"?p[m][v]=!0:d==="FALSE"?p[m][v]=!1:isNaN(Mo(d))?isNaN(xg(d).getDate())?d.charCodeAt(0)==35&&$a[d]!=null?p[m][v]={t:"e",v:$a[d],w:d}:p[m][v]=d:p[m][v]=Wr(d):p[m][v]=Mo(d))}function t(d,p){var m=p||{},v=[];if(!d||d.length===0)return v;for(var x=d.split(/[\r\n]/),_=x.length-1;_>=0&&x[_].length===0;)--_;for(var b=10,E=0,T=0;T<=_;++T)E=x[T].indexOf(" "),E==-1?E=x[T].length:E++,b=Math.max(b,E);for(T=0;T<=_;++T){v[T]=[];var S=0;for(n(x[T].slice(0,b).trim(),v,T,S,m),S=1;S<=(x[T].length-b)/10+1;++S)n(x[T].slice(b+(S-1)*10,b+S*10).trim(),v,T,S,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(d){for(var p={},m=!1,v=0,x=0;v<d.length;++v)(x=d.charCodeAt(v))==34?m=!m:!m&&x in e&&(p[x]=(p[x]||0)+1);x=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&x.push([p[v],v]);if(!x.length){p=i;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&x.push([p[v],v])}return x.sort(function(_,b){return _[0]-b[0]||i[_[1]]-i[b[1]]}),e[x.pop()[1]]||44}function s(d,p){var m=p||{},v="",x={};m.dense&&(x["!data"]=[]);var _={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=r(d.slice(0,1024)):m&&m.FS?v=m.FS:v=r(d.slice(0,1024));var b=0,E=0,T=0,S=0,O=0,R=v.charCodeAt(0),N=!1,C=0,M=d.charCodeAt(0),I=m.dateNF!=null?c9(m.dateNF):null;function F(){var z=d.slice(S,O);z.slice(-1)=="\r"&&(z=z.slice(0,-1));var P={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),m.cellText!==!1&&(P.w=z),z.length===0)P.t="z";else if(m.raw)P.t="s",P.v=z;else if(z.trim().length===0)P.t="s",P.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(P.t="s",P.v=z.slice(2,-1).replace(/""/g,'"')):sG(z)?(P.t="s",P.f=z.slice(1),P.v=z):(P.t="s",P.v=z);else if(z=="TRUE")P.t="b",P.v=!0;else if(z=="FALSE")P.t="b",P.v=!1;else if(!isNaN(T=Mo(z)))P.t="n",P.v=T;else if(!isNaN((T=xg(z)).getDate())||I&&z.match(I)){if(P.z=m.dateNF||Ln[14],I&&z.match(I)){var tt=u9(z,m.dateNF,z.match(I)||[]);T=Wr(tt),m&&m.UTC===!1&&(T=xf(T))}else m&&m.UTC===!1?T=xf(T):m.cellText!==!1&&m.dateNF&&(P.w=zo(P.z,T));m.cellDates?(P.t="d",P.v=T):(P.t="n",P.v=$i(T)),m.cellNF||delete P.z}else z.charCodeAt(0)==35&&$a[z]!=null?(P.t="e",P.w=z,P.v=$a[z]):(P.t="s",P.v=z);if(P.t=="z"||(m.dense?(x["!data"][b]||(x["!data"][b]=[]),x["!data"][b][E]=P):x[Vn({c:E,r:b})]=P),S=O+1,M=d.charCodeAt(S),_.e.c<E&&(_.e.c=E),_.e.r<b&&(_.e.r=b),C==R)++E;else if(E=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}t:for(;O<d.length;++O)switch(C=d.charCodeAt(O)){case 34:M===34&&(N=!N);break;case 13:if(N)break;d.charCodeAt(O+1)==10&&++O;case R:case 10:if(!N&&F())break t;break}return O-S>0&&F(),x["!ref"]=di(_),x}function a(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,p):kf(t(d,p),p)}function l(d,p){var m="",v=p.type=="string"?[0,0,0,0]:kY(d,p);switch(p.type){case"base64":m=Ll(d);break;case"binary":m=d;break;case"buffer":p.codepage==65001?m=d.toString("utf8"):(p.codepage,m=fn&&Buffer.isBuffer(d)?d.toString("binary"):Pc(d));break;case"array":m=Jb(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=tf(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=tf(m):p.type=="binary",m.slice(0,19)=="socialcalc:version:"?OR.to_sheet(p.type=="string"?m:tf(m),p):a(m,p)}function u(d,p){return Nf(l(d,p),p)}function f(d){var p=[];if(!d["!ref"])return"";for(var m=In(d["!ref"]),v,x=d["!data"]!=null,_=m.s.r;_<=m.e.r;++_){for(var b=[],E=m.s.c;E<=m.e.c;++E){var T=Vn({r:_,c:E});if(v=x?(d["!data"][_]||[])[E]:d[T],!v||v.v==null){b.push("          ");continue}for(var S=(v.w||(jo(v),v.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(E===0?" ":""))}p.push(b.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}(),ZS=function(){function n(H,mt,lt){if(H){wr(H,H.l||0);for(var ct=lt.Enum||ut;H.l<H.length;){var Ct=H.read_shift(2),Lt=ct[Ct]||ct[65535],D=H.read_shift(2),dt=H.l+D,st=Lt.f&&Lt.f(H,D,lt);if(H.l=dt,mt(st,Lt,Ct))return}}}function t(H,mt){switch(mt.type){case"base64":return i(os(Ll(H)),mt);case"binary":return i(os(H),mt);case"buffer":case"array":return i(H,mt)}throw"Unsupported type "+mt.type}var e=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function i(H,mt){if(!H)return H;var lt=mt||{},ct={},Ct="Sheet1",Lt="",D=0,dt={},st=[],Y=[],q=[];lt.dense&&(q=ct["!data"]=[]);var ft={s:{r:0,c:0},e:{r:0,c:0}},Pt=lt.sheetRows||0,jt={};if(H[4]==81&&H[5]==80&&H[6]==87)return Gt(H,mt);if(H[2]==0&&(H[3]==8||H[3]==9)&&H.length>=16&&H[14]==5&&H[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(H[2]==2)lt.Enum=ut,n(H,function(pt,te,ae){switch(ae){case 0:lt.vers=pt,pt>=4096&&(lt.qpro=!0);break;case 255:lt.vers=pt,lt.works=!0;break;case 6:ft=pt;break;case 204:pt&&(Lt=pt);break;case 222:Lt=pt;break;case 15:case 51:(!lt.qpro&&!lt.works||ae==51)&&pt[1].v.charCodeAt(0)<48&&(pt[1].v=pt[1].v.slice(1)),(lt.works||lt.works2)&&(pt[1].v=pt[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(pt[2]&112)==112&&(pt[2]&15)>1&&(pt[2]&15)<15&&(pt[1].z=lt.dateNF||e[(pt[2]&15)-1]||Ln[14],lt.cellDates&&(pt[1].v=Ju(pt[1].v),pt[1].t=typeof pt[1].v=="number"?"n":"d")),lt.qpro&&pt[3]>D&&(ct["!ref"]=di(ft),dt[Ct]=ct,st.push(Ct),ct={},lt.dense&&(q=ct["!data"]=[]),ft={s:{r:0,c:0},e:{r:0,c:0}},D=pt[3],Ct=Lt||"Sheet"+(D+1),Lt="");var ne=lt.dense?(q[pt[0].r]||[])[pt[0].c]:ct[Vn(pt[0])];if(ne){ne.t=pt[1].t,ne.v=pt[1].v,pt[1].z!=null&&(ne.z=pt[1].z),pt[1].f!=null&&(ne.f=pt[1].f),jt=ne;break}lt.dense?(q[pt[0].r]||(q[pt[0].r]=[]),q[pt[0].r][pt[0].c]=pt[1]):ct[Vn(pt[0])]=pt[1],jt=pt[1];break;case 21509:lt.works2=!0;break;case 21506:pt==5281&&(jt.z="hh:mm:ss",lt.cellDates&&jt.t=="n"&&(jt.v=Ju(jt.v),jt.t=typeof jt.v=="number"?"n":"d"));break}},lt);else if(H[2]==26||H[2]==14)lt.Enum=gt,H[2]==14&&(lt.qpro=!0,H.l=0),n(H,function(pt,te,ae){switch(ae){case 204:Ct=pt;break;case 22:pt[1].v.charCodeAt(0)<48&&(pt[1].v=pt[1].v.slice(1)),pt[1].v=pt[1].v.replace(/\x0F./g,function(ne){return String.fromCharCode(ne.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(pt[3]>D&&(ct["!ref"]=di(ft),dt[Ct]=ct,st.push(Ct),ct={},lt.dense&&(q=ct["!data"]=[]),ft={s:{r:0,c:0},e:{r:0,c:0}},D=pt[3],Ct="Sheet"+(D+1)),Pt>0&&pt[0].r>=Pt)break;lt.dense?(q[pt[0].r]||(q[pt[0].r]=[]),q[pt[0].r][pt[0].c]=pt[1]):ct[Vn(pt[0])]=pt[1],ft.e.c<pt[0].c&&(ft.e.c=pt[0].c),ft.e.r<pt[0].r&&(ft.e.r=pt[0].r);break;case 27:pt[14e3]&&(Y[pt[14e3][0]]=pt[14e3][1]);break;case 1537:Y[pt[0]]=pt[1],pt[0]==D&&(Ct=pt[1]);break}},lt);else throw new Error("Unrecognized LOTUS BOF "+H[2]);if(ct["!ref"]=di(ft),dt[Lt||Ct]=ct,st.push(Lt||Ct),!Y.length)return{SheetNames:st,Sheets:dt};for(var wt={},Nt=[],At=0;At<Y.length;++At)dt[st[At]]?(Nt.push(Y[At]||st[At]),wt[Y[At]]=dt[Y[At]]||dt[st[At]]):(Nt.push(Y[At]),wt[Y[At]]={"!ref":"A1"});return{SheetNames:Nt,Sheets:wt}}function r(H,mt){var lt=mt||{};if(+lt.codepage>=0&&Gd(+lt.codepage),lt.type=="string")throw new Error("Cannot write WK1 to JS string");var ct=sr();if(!H["!ref"])throw new Error("Cannot export empty sheet to WK1");var Ct=In(H["!ref"]),Lt=H["!data"]!=null,D=[];Zt(ct,0,a(1030)),Zt(ct,6,f(Ct));for(var dt=Math.min(Ct.e.r,8191),st=Ct.s.c;st<=Ct.e.c;++st)D[st]=xn(st);for(var Y=Ct.s.r;Y<=dt;++Y){var q=Sn(Y);for(st=Ct.s.c;st<=Ct.e.c;++st){var ft=Lt?(H["!data"][Y]||[])[st]:H[D[st]+q];if(!(!ft||ft.t=="z"))switch(ft.t){case"n":(ft.v|0)==ft.v&&ft.v>=-32768&&ft.v<=32767?Zt(ct,13,b(Y,st,ft)):Zt(ct,14,T(Y,st,ft));break;case"d":var Pt=$i(ft.v);(Pt|0)==Pt&&Pt>=-32768&&Pt<=32767?Zt(ct,13,b(Y,st,{v:Pt,z:ft.z||Ln[14]})):Zt(ct,14,T(Y,st,{v:Pt,z:ft.z||Ln[14]}));break;default:var jt=jo(ft);Zt(ct,15,v(Y,st,jt.slice(0,239)))}}}return Zt(ct,1),ct.end()}function s(H,mt){var lt=mt||{};if(+lt.codepage>=0&&Gd(+lt.codepage),lt.type=="string")throw new Error("Cannot write WK3 to JS string");var ct=sr();Zt(ct,0,l(H));for(var Ct=0,Lt=0;Ct<H.SheetNames.length;++Ct)(H.Sheets[H.SheetNames[Ct]]||{})["!ref"]&&Zt(ct,27,G(H.SheetNames[Ct],Lt++));var D=0;for(Ct=0;Ct<H.SheetNames.length;++Ct){var dt=H.Sheets[H.SheetNames[Ct]];if(!(!dt||!dt["!ref"])){for(var st=In(dt["!ref"]),Y=dt["!data"]!=null,q=[],ft=Math.min(st.e.r,8191),Pt=st.s.r;Pt<=ft;++Pt)for(var jt=Sn(Pt),wt=st.s.c;wt<=st.e.c;++wt){Pt===st.s.r&&(q[wt]=xn(wt));var Nt=q[wt]+jt,At=Y?(dt["!data"][Pt]||[])[wt]:dt[Nt];if(!(!At||At.t=="z"))if(At.t=="n")Zt(ct,23,tt(Pt,wt,D,At.v));else{var pt=jo(At);Zt(ct,22,F(Pt,wt,D,pt.slice(0,239)))}}++D}}return Zt(ct,1),ct.end()}function a(H){var mt=Ft(2);return mt.write_shift(2,H),mt}function l(H){var mt=Ft(26);mt.write_shift(2,4096),mt.write_shift(2,4),mt.write_shift(4,0);for(var lt=0,ct=0,Ct=0,Lt=0;Lt<H.SheetNames.length;++Lt){var D=H.SheetNames[Lt],dt=H.Sheets[D];if(!(!dt||!dt["!ref"])){++Ct;var st=Hi(dt["!ref"]);lt<st.e.r&&(lt=st.e.r),ct<st.e.c&&(ct=st.e.c)}}return lt>8191&&(lt=8191),mt.write_shift(2,lt),mt.write_shift(1,Ct),mt.write_shift(1,ct),mt.write_shift(2,0),mt.write_shift(2,0),mt.write_shift(1,1),mt.write_shift(1,2),mt.write_shift(4,0),mt.write_shift(4,0),mt}function u(H,mt,lt){var ct={s:{c:0,r:0},e:{c:0,r:0}};return mt==8&&lt.qpro?(ct.s.c=H.read_shift(1),H.l++,ct.s.r=H.read_shift(2),ct.e.c=H.read_shift(1),H.l++,ct.e.r=H.read_shift(2),ct):(ct.s.c=H.read_shift(2),ct.s.r=H.read_shift(2),mt==12&&lt.qpro&&(H.l+=2),ct.e.c=H.read_shift(2),ct.e.r=H.read_shift(2),mt==12&&lt.qpro&&(H.l+=2),ct.s.c==65535&&(ct.s.c=ct.e.c=ct.s.r=ct.e.r=0),ct)}function f(H){var mt=Ft(8);return mt.write_shift(2,H.s.c),mt.write_shift(2,H.s.r),mt.write_shift(2,H.e.c),mt.write_shift(2,H.e.r),mt}function d(H,mt,lt){var ct=[{c:0,r:0},{t:"n",v:0},0,0];return lt.qpro&&lt.vers!=20768?(ct[0].c=H.read_shift(1),ct[3]=H.read_shift(1),ct[0].r=H.read_shift(2),H.l+=2):lt.works?(ct[0].c=H.read_shift(2),ct[0].r=H.read_shift(2),ct[2]=H.read_shift(2)):(ct[2]=H.read_shift(1),ct[0].c=H.read_shift(2),ct[0].r=H.read_shift(2)),ct}function p(H){return H.z&&Fc(H.z)?240|(e.indexOf(H.z)+1||2):255}function m(H,mt,lt){var ct=H.l+mt,Ct=d(H,mt,lt);if(Ct[1].t="s",(lt.vers&65534)==20768){H.l++;var Lt=H.read_shift(1);return Ct[1].v=H.read_shift(Lt,"utf8"),Ct}return lt.qpro&&H.l++,Ct[1].v=H.read_shift(ct-H.l,"cstr"),Ct}function v(H,mt,lt){var ct=Ft(7+lt.length);ct.write_shift(1,255),ct.write_shift(2,mt),ct.write_shift(2,H),ct.write_shift(1,39);for(var Ct=0;Ct<ct.length;++Ct){var Lt=lt.charCodeAt(Ct);ct.write_shift(1,Lt>=128?95:Lt)}return ct.write_shift(1,0),ct}function x(H,mt,lt){var ct=H.l+mt,Ct=d(H,mt,lt);if(Ct[1].t="s",lt.vers==20768){var Lt=H.read_shift(1);return Ct[1].v=H.read_shift(Lt,"utf8"),Ct}return Ct[1].v=H.read_shift(ct-H.l,"cstr"),Ct}function _(H,mt,lt){var ct=d(H,mt,lt);return ct[1].v=H.read_shift(2,"i"),ct}function b(H,mt,lt){var ct=Ft(7);return ct.write_shift(1,p(lt)),ct.write_shift(2,mt),ct.write_shift(2,H),ct.write_shift(2,lt.v,"i"),ct}function E(H,mt,lt){var ct=d(H,mt,lt);return ct[1].v=H.read_shift(8,"f"),ct}function T(H,mt,lt){var ct=Ft(13);return ct.write_shift(1,p(lt)),ct.write_shift(2,mt),ct.write_shift(2,H),ct.write_shift(8,lt.v,"f"),ct}function S(H,mt,lt){var ct=H.l+mt,Ct=d(H,mt,lt);if(Ct[1].v=H.read_shift(8,"f"),lt.qpro)H.l=ct;else{var Lt=H.read_shift(2);C(H.slice(H.l,H.l+Lt),Ct),H.l+=Lt}return Ct}function O(H,mt,lt){var ct=mt&32768;return mt&=-32769,mt=(ct?H:0)+(mt>=8192?mt-16384:mt),(ct?"":"$")+(lt?xn(mt):Sn(mt))}var R={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(H,mt){wr(H,0);for(var lt=[],ct=0,Ct="",Lt="",D="",dt="";H.l<H.length;){var st=H[H.l++];switch(st){case 0:lt.push(H.read_shift(8,"f"));break;case 1:Lt=O(mt[0].c,H.read_shift(2),!0),Ct=O(mt[0].r,H.read_shift(2),!1),lt.push(Lt+Ct);break;case 2:{var Y=O(mt[0].c,H.read_shift(2),!0),q=O(mt[0].r,H.read_shift(2),!1);Lt=O(mt[0].c,H.read_shift(2),!0),Ct=O(mt[0].r,H.read_shift(2),!1),lt.push(Y+q+":"+Lt+Ct)}break;case 3:if(H.l<H.length){console.error("WK1 premature formula end");return}break;case 4:lt.push("("+lt.pop()+")");break;case 5:lt.push(H.read_shift(2));break;case 6:{for(var ft="";st=H[H.l++];)ft+=String.fromCharCode(st);lt.push('"'+ft.replace(/"/g,'""')+'"')}break;case 8:lt.push("-"+lt.pop());break;case 23:lt.push("+"+lt.pop());break;case 22:lt.push("NOT("+lt.pop()+")");break;case 20:case 21:dt=lt.pop(),D=lt.pop(),lt.push(["AND","OR"][st-20]+"("+D+","+dt+")");break;default:if(st<32&&N[st])dt=lt.pop(),D=lt.pop(),lt.push(D+N[st]+dt);else if(R[st]){if(ct=R[st][1],ct==69&&(ct=H[H.l++]),ct>lt.length){console.error("WK1 bad formula parse 0x"+st.toString(16)+":|"+lt.join("|")+"|");return}var Pt=lt.slice(-ct);lt.length-=ct,lt.push(R[st][0]+"("+Pt.join(",")+")")}else return st<=7?console.error("WK1 invalid opcode "+st.toString(16)):st<=24?console.error("WK1 unsupported op "+st.toString(16)):st<=30?console.error("WK1 invalid opcode "+st.toString(16)):st<=115?console.error("WK1 unsupported function opcode "+st.toString(16)):console.error("WK1 unrecognized opcode "+st.toString(16))}}lt.length==1?mt[1].f=""+lt[0]:console.error("WK1 bad formula parse |"+lt.join("|")+"|")}function M(H){var mt=[{c:0,r:0},{t:"n",v:0},0];return mt[0].r=H.read_shift(2),mt[3]=H[H.l++],mt[0].c=H[H.l++],mt}function I(H,mt){var lt=M(H);return lt[1].t="s",lt[1].v=H.read_shift(mt-4,"cstr"),lt}function F(H,mt,lt,ct){var Ct=Ft(6+ct.length);Ct.write_shift(2,H),Ct.write_shift(1,lt),Ct.write_shift(1,mt),Ct.write_shift(1,39);for(var Lt=0;Lt<ct.length;++Lt){var D=ct.charCodeAt(Lt);Ct.write_shift(1,D>=128?95:D)}return Ct.write_shift(1,0),Ct}function z(H,mt){var lt=M(H);lt[1].v=H.read_shift(2);var ct=lt[1].v>>1;if(lt[1].v&1)switch(ct&7){case 0:ct=(ct>>3)*5e3;break;case 1:ct=(ct>>3)*500;break;case 2:ct=(ct>>3)/20;break;case 3:ct=(ct>>3)/200;break;case 4:ct=(ct>>3)/2e3;break;case 5:ct=(ct>>3)/2e4;break;case 6:ct=(ct>>3)/16;break;case 7:ct=(ct>>3)/64;break}return lt[1].v=ct,lt}function P(H,mt){var lt=M(H),ct=H.read_shift(4),Ct=H.read_shift(4),Lt=H.read_shift(2);if(Lt==65535)return ct===0&&Ct===3221225472?(lt[1].t="e",lt[1].v=15):ct===0&&Ct===3489660928?(lt[1].t="e",lt[1].v=42):lt[1].v=0,lt;var D=Lt&32768;return Lt=(Lt&32767)-16446,lt[1].v=(1-D*2)*(Ct*Math.pow(2,Lt+32)+ct*Math.pow(2,Lt)),lt}function tt(H,mt,lt,ct){var Ct=Ft(14);if(Ct.write_shift(2,H),Ct.write_shift(1,lt),Ct.write_shift(1,mt),ct==0)return Ct.write_shift(4,0),Ct.write_shift(4,0),Ct.write_shift(2,65535),Ct;var Lt=0,D=0,dt=0,st=0;return ct<0&&(Lt=1,ct=-ct),D=Math.log2(ct)|0,ct/=Math.pow(2,D-31),st=ct>>>0,(st&2147483648)==0&&(ct/=2,++D,st=ct>>>0),ct-=st,st|=2147483648,st>>>=0,ct*=Math.pow(2,32),dt=ct>>>0,Ct.write_shift(4,dt),Ct.write_shift(4,st),D+=16383+(Lt?32768:0),Ct.write_shift(2,D),Ct}function L(H,mt){var lt=P(H);return H.l+=mt-14,lt}function nt(H,mt){var lt=M(H),ct=H.read_shift(4);return lt[1].v=ct>>6,lt}function Q(H,mt){var lt=M(H),ct=H.read_shift(8,"f");return lt[1].v=ct,lt}function X(H,mt){var lt=Q(H);return H.l+=mt-12,lt}function Rt(H,mt){return H[H.l+mt-1]==0?H.read_shift(mt,"cstr"):""}function yt(H,mt){var lt=H[H.l++];lt>mt-1&&(lt=mt-1);for(var ct="";ct.length<lt;)ct+=String.fromCharCode(H[H.l++]);return ct}function j(H,mt,lt){if(!(!lt.qpro||mt<21)){var ct=H.read_shift(1);H.l+=17,H.l+=1,H.l+=2;var Ct=H.read_shift(mt-21,"cstr");return[ct,Ct]}}function J(H,mt){for(var lt={},ct=H.l+mt;H.l<ct;){var Ct=H.read_shift(2);if(Ct==14e3){for(lt[Ct]=[0,""],lt[Ct][0]=H.read_shift(2);H[H.l];)lt[Ct][1]+=String.fromCharCode(H[H.l]),H.l++;H.l++}}return lt}function G(H,mt){var lt=Ft(5+H.length);lt.write_shift(2,14e3),lt.write_shift(2,mt);for(var ct=0;ct<H.length;++ct){var Ct=H.charCodeAt(ct);lt[lt.l++]=Ct>127?95:Ct}return lt[lt.l++]=0,lt}var ut={0:{n:"BOF",f:qm},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Rt},222:{n:"SHEETNAMELP",f:yt},255:{n:"BOF",f:qm},21506:{n:"WKSNF",f:qm},65535:{n:""}},gt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:nt},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Rt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:j},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},_t={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Bt(H){var mt=H.read_shift(2),lt=H.read_shift(1);if(lt!=0)throw"unsupported QPW string type "+lt.toString(16);return H.read_shift(mt,"sbcs-cont")}function Gt(H,mt){wr(H,0);var lt=mt||{},ct={};lt.dense&&(ct["!data"]=[]);var Ct=[],Lt="",D={s:{r:-1,c:-1},e:{r:-1,c:-1}},dt=0,st=0,Y=0,q=0,ft={SheetNames:[],Sheets:{}},Pt=[];t:for(;H.l<H.length;){var jt=H.read_shift(2),wt=H.read_shift(2),Nt=H.slice(H.l,H.l+wt);switch(wr(Nt,0),jt){case 1:if(Nt.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break t;case 8:break;case 10:for(var At=Nt.read_shift(4),pt=(Nt.length-Nt.l)/At|0,te=0;te<At;++te){var ae=Nt.l+pt,ne={};Nt.l+=2,ne.numFmtId=Nt.read_shift(2),_t[ne.numFmtId]&&(ne.z=_t[ne.numFmtId]),Nt.l=ae,Pt.push(ne)}break;case 1025:break;case 1026:break;case 1031:for(Nt.l+=12;Nt.l<Nt.length;)dt=Nt.read_shift(2),st=Nt.read_shift(1),Ct.push(Nt.read_shift(dt,"cstr"));break;case 1032:break;case 1537:{var Re=Nt.read_shift(2);ct={},lt.dense&&(ct["!data"]=[]),D.s.c=Nt.read_shift(2),D.e.c=Nt.read_shift(2),D.s.r=Nt.read_shift(4),D.e.r=Nt.read_shift(4),Nt.l+=4,Nt.l+2<Nt.length&&(dt=Nt.read_shift(2),st=Nt.read_shift(1),Lt=dt==0?"":Nt.read_shift(dt,"cstr")),Lt||(Lt=xn(Re))}break;case 1538:{if(D.s.c>255||D.s.r>999999)break;D.e.c<D.s.c&&(D.e.c=D.s.c),D.e.r<D.s.r&&(D.e.r=D.s.r),ct["!ref"]=di(D),gy(ft,ct,Lt)}break;case 2561:Y=Nt.read_shift(2),D.e.c<Y&&(D.e.c=Y),D.s.c>Y&&(D.s.c=Y),q=Nt.read_shift(4),D.s.r>q&&(D.s.r=q),q=Nt.read_shift(4),D.e.r<q&&(D.e.r=q);break;case 3073:{q=Nt.read_shift(4),dt=Nt.read_shift(4),D.s.r>q&&(D.s.r=q),D.e.r<q+dt-1&&(D.e.r=q+dt-1);for(var rn=xn(Y);Nt.l<Nt.length;){var ye={t:"z"},ln=Nt.read_shift(1),Ve=-1;ln&128&&(Ve=Nt.read_shift(2));var zn=ln&64?Nt.read_shift(2)-1:0;switch(ln&31){case 0:break;case 1:break;case 2:ye={t:"n",v:Nt.read_shift(2)};break;case 3:ye={t:"n",v:Nt.read_shift(2,"i")};break;case 4:ye={t:"n",v:cy(Nt)};break;case 5:ye={t:"n",v:Nt.read_shift(8,"f")};break;case 7:ye={t:"s",v:Ct[st=Nt.read_shift(4)-1]};break;case 8:ye={t:"n",v:Nt.read_shift(8,"f")},Nt.l+=2,Nt.l+=4,isNaN(ye.v)&&(ye={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(ln&31)}Ve!=-1&&(Pt[Ve-1]||{}).z&&(ye.z=Pt[Ve-1].z);var Cn=0;if(ln&32)switch(ln&31){case 2:Cn=Nt.read_shift(2);break;case 3:Cn=Nt.read_shift(2,"i");break;case 7:Cn=Nt.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(ln&31)}if(!(!lt.sheetStubs&&ye.t=="z")){var bn=or(ye);ye.t=="n"&&ye.z&&Fc(ye.z)&&lt.cellDates&&(bn.v=Ju(ye.v),bn.t=typeof bn.v=="number"?"n":"d"),ct["!data"]!=null?(ct["!data"][q]||(ct["!data"][q]=[]),ct["!data"][q][Y]=bn):ct[rn+Sn(q)]=bn}for(++q,--dt;zn-- >0&&dt>=0;){if(ln&32)switch(ln&31){case 2:ye={t:"n",v:ye.v+Cn&65535};break;case 3:ye={t:"n",v:ye.v+Cn&65535},ye.v>32767&&(ye.v-=65536);break;case 7:ye={t:"s",v:Ct[st=st+Cn>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(ln&31)}else switch(ln&31){case 1:ye={t:"z"};break;case 2:ye={t:"n",v:Nt.read_shift(2)};break;case 7:ye={t:"s",v:Ct[st=Nt.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(ln&31)}!lt.sheetStubs&&ye.t=="z"||(ct["!data"]!=null?(ct["!data"][q]||(ct["!data"][q]=[]),ct["!data"][q][Y]=ye):ct[rn+Sn(q)]=ye),++q,--dt}}}break;case 3074:{Y=Nt.read_shift(2),q=Nt.read_shift(4);var mi=Bt(Nt);ct["!data"]!=null?(ct["!data"][q]||(ct["!data"][q]=[]),ct["!data"][q][Y]={t:"s",v:mi}):ct[xn(Y)+Sn(q)]={t:"s",v:mi}}break}H.l+=wt}return ft}return{sheet_to_wk1:r,book_to_wk3:s,to_workbook:t}}(),a$=/^\s|\s$|[\t\n\r]/;function o$(n,t){if(!t.bookSST)return"";var e=[pi];e[e.length]=se("sst",null,{xmlns:Rf[0],count:n.Count,uniqueCount:n.Unique});for(var i=0;i!=n.length;++i)if(n[i]!=null){var r=n[i],s="<si>";r.r?s+=r.r:(s+="<t",r.t||(r.t=""),typeof r.t!="string"&&(r.t=String(r.t)),r.t.match(a$)&&(s+=' xml:space="preserve"'),s+=">"+$e(r.t)+"</t>"),s+="</si>",e[e.length]=s}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function l$(n){return[n.read_shift(4),n.read_shift(4)]}function c$(n,t){return t||(t=Ft(8)),t.write_shift(4,n.Count),t.write_shift(4,n.Unique),t}var u$=K9;function f$(n){var t=sr();Xt(t,159,c$(n));for(var e=0;e<n.length;++e)Xt(t,19,u$(n[e]));return Xt(t,160),t.end()}function h$(n){for(var t=[],e=n.split(""),i=0;i<e.length;++i)t[i]=e[i].charCodeAt(0);return t}function RR(n){var t=0,e,i=h$(n),r=i.length+1,s,a,l,u,f;for(e=Mc(r),e[0]=i.length,s=1;s!=r;++s)e[s]=i[s-1];for(s=r-1;s>=0;--s)a=e[s],l=(t&16384)===0?0:1,u=t<<1&32767,f=l|u,t=f^a;return t^52811}function d$(n,t){var e=["{\\rtf1\\ansi"];if(!n["!ref"])return e[0]+"}";for(var i=In(n["!ref"]),r,s=n["!data"]!=null,a=[],l=i.s.r;l<=i.e.r;++l){e.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)e.push("\\cellx"+(u+1));for(e.push("\\pard\\intbl"),s&&(a=n["!data"][l]||[]),u=i.s.c;u<=i.e.c;++u){var f=Vn({r:l,c:u});if(r=s?a[u]:n[f],!r||r.v==null&&(!r.f||r.F)){e.push(" \\cell");continue}e.push(" "+(r.w||(jo(r),r.w)||"").replace(/[\r\n]/g,"\\par ")),e.push("\\cell")}e.push("\\pard\\intbl\\row")}return e.join("")+"}"}function QS(n){for(var t=0,e=1;t!=3;++t)e=e*256+(n[t]>255?255:n[t]<0?0:n[t]);return e.toString(16).toUpperCase().slice(1)}var p$=6,Po=p$;function wg(n){return Math.floor((n+Math.round(128/Po)/256)*Po)}function Ag(n){return Math.floor((n-5)/Po*100+.5)/100}function kx(n){return Math.round((n*Po+5)/Po*256)/256}function fy(n){n.width?(n.wpx=wg(n.width),n.wch=Ag(n.wpx),n.MDW=Po):n.wpx?(n.wch=Ag(n.wpx),n.width=kx(n.wch),n.MDW=Po):typeof n.wch=="number"&&(n.width=kx(n.wch),n.wpx=wg(n.width),n.MDW=Po),n.customWidth&&delete n.customWidth}var m$=96,NR=m$;function Sg(n){return n*96/NR}function kR(n){return n*NR/96}function g$(n){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)n[i]!=null&&(t[t.length]=se("numFmt",null,{numFmtId:i,formatCode:$e(n[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function v$(n){var t=[];return t[t.length]=se("cellXfs",null),n.forEach(function(e){t[t.length]=se("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function _$(n,t){var e=[pi,se("styleSheet",null,{xmlns:Rf[0],"xmlns:vt":Di.vt})],i;return n.SSF&&(i=g$(n.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=v$(t.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function x$(n,t){var e=n.read_shift(2),i=ar(n);return[e,i]}function b$(n,t,e){e||(e=Ft(6+4*t.length)),e.write_shift(2,n),Ei(t,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function y$(n,t,e){var i={};i.sz=n.read_shift(2)/20;var r=iH(n);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var s=n.read_shift(2);switch(s===700&&(i.bold=1),n.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(i.underline=a);var l=n.read_shift(1);l>0&&(i.family=l);var u=n.read_shift(1);switch(u>0&&(i.charset=u),n.l++,i.color=nH(n),n.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=ar(n),i}function E$(n,t){t||(t=Ft(25+4*32)),t.write_shift(2,n.sz*20),rH(n,t),t.write_shift(2,n.bold?700:400);var e=0;n.vertAlign=="superscript"?e=1:n.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,n.underline||0),t.write_shift(1,n.family||0),t.write_shift(1,n.charset||0),t.write_shift(1,0),yg(n.color,t);var i=0;return i=2,t.write_shift(1,i),Ei(n.name,t),t.length>t.l?t.slice(0,t.l):t}var w$=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],G_,A$=qa;function JS(n,t){t||(t=Ft(4*3+8*7+16*1)),G_||(G_=Qb(w$));var e=G_[n.patternType];e==null&&(e=40),t.write_shift(4,e);var i=0;if(e!=40)for(yg({auto:1},t),yg({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function S$(n,t){var e=n.l+t,i=n.read_shift(2),r=n.read_shift(2);return n.l=e,{ixfe:i,numFmtId:r}}function LR(n,t,e){e||(e=Ft(16)),e.write_shift(2,t||0),e.write_shift(2,n.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function ud(n,t){return t||(t=Ft(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var T$=qa;function C$(n,t){return t||(t=Ft(51)),t.write_shift(1,0),ud(null,t),ud(null,t),ud(null,t),ud(null,t),ud(null,t),t.length>t.l?t.slice(0,t.l):t}function D$(n,t){return t||(t=Ft(12+4*10)),t.write_shift(4,n.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Xd(n.name||"",t),t.length>t.l?t.slice(0,t.l):t}function O$(n,t,e){var i=Ft(2052);return i.write_shift(4,n),Xd(t,i),Xd(e,i),i.length>i.l?i.slice(0,i.l):i}function R$(n,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&++e}),e!=0&&(Xt(n,615,la(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&Xt(n,44,b$(r,t[r]))}),Xt(n,616))}}function N$(n){var t=1;Xt(n,611,la(t)),Xt(n,43,E$({sz:12,color:{theme:1},name:"Calibri",family:2})),Xt(n,612)}function k$(n){var t=2;Xt(n,603,la(t)),Xt(n,45,JS({patternType:"none"})),Xt(n,45,JS({patternType:"gray125"})),Xt(n,604)}function L$(n){var t=1;Xt(n,613,la(t)),Xt(n,46,C$()),Xt(n,614)}function I$(n){var t=1;Xt(n,626,la(t)),Xt(n,47,LR({numFmtId:0},65535)),Xt(n,627)}function M$(n,t){Xt(n,617,la(t.length)),t.forEach(function(e){Xt(n,47,LR(e,0))}),Xt(n,618)}function P$(n){var t=1;Xt(n,619,la(t)),Xt(n,48,D$({xfId:0,name:"Normal"})),Xt(n,620)}function F$(n){var t=0;Xt(n,505,la(t)),Xt(n,506)}function B$(n){var t=0;Xt(n,508,O$(t,"TableStyleMedium9","PivotStyleMedium4")),Xt(n,509)}function U$(n,t){var e=sr();return Xt(e,278),R$(e,n.SSF),N$(e),k$(e),L$(e),I$(e),M$(e,t.cellXfs),P$(e),F$(e),B$(e),Xt(e,279),e.end()}function IR(n,t){if(t&&t.themeXLSX)return t.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var e=[pi];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function z$(n,t){return{flags:n.read_shift(4),version:n.read_shift(4),name:ar(n)}}function j$(n){var t=Ft(12+2*n.name.length);return t.write_shift(4,n.flags),t.write_shift(4,n.version),Ei(n.name,t),t.slice(0,t.l)}function H$(n){for(var t=[],e=n.read_shift(4);e-- >0;)t.push([n.read_shift(4),n.read_shift(4)]);return t}function $$(n){var t=Ft(4+8*n.length);t.write_shift(4,n.length);for(var e=0;e<n.length;++e)t.write_shift(4,n[e][0]),t.write_shift(4,n[e][1]);return t}function G$(n,t){var e=Ft(8+2*t.length);return e.write_shift(4,n),Ei(t,e),e.slice(0,e.l)}function V$(n){return n.l+=4,n.read_shift(4)!=0}function W$(n,t){var e=Ft(8);return e.write_shift(4,n),e.write_shift(4,1),e}function q$(){var n=sr();return Xt(n,332),Xt(n,334,la(1)),Xt(n,335,j$({name:"XLDAPR",version:12e4,flags:3496657072})),Xt(n,336),Xt(n,339,G$(1,"XLDAPR")),Xt(n,52),Xt(n,35,la(514)),Xt(n,4096,la(0)),Xt(n,4097,Is(1)),Xt(n,36),Xt(n,53),Xt(n,340),Xt(n,337,W$(1)),Xt(n,51,$$([[1,0]])),Xt(n,338),Xt(n,333),n.end()}function Y$(){var n=[pi];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function X$(n){var t={};t.i=n.read_shift(4);var e={};e.r=n.read_shift(4),e.c=n.read_shift(4),t.r=Vn(e);var i=n.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}function MR(n,t,e){var i=[21600,21600],r=["m0,0l0",i[1],i[0],i[1],i[0],"0xe"].join(","),s=[se("xml",null,{"xmlns:v":ls.v,"xmlns:o":ls.o,"xmlns:x":ls.x,"xmlns:mv":ls.mv}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"})],a=65536*n,l=t||[];return l.length>0&&s.push(se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:i.join(","),"o:spt":202,path:r})),l.forEach(function(u){++a,s.push(K$(u,a))}),s.push("</xml>"),s.join("")}function K$(n,t,e){var i=Un(n[0]),r={color2:"#BEFF82",type:"gradient"};r.type=="gradient"&&(r.angle="-180");var s=r.type=="gradient"?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=se("v:fill",s,r),l={on:"t",obscured:"t"};return["<v:shape"+Wd({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,se("v:shadow",null,l),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zi("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),zi("x:AutoFill","False"),zi("x:Row",String(i.r)),zi("x:Column",String(i.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function Z$(n){var t=[pi,se("comments",null,{xmlns:Rf[0]})],e=[];return t.push("<authors>"),n.forEach(function(i){i[1].forEach(function(r){var s=$e(r.a);e.indexOf(s)==-1&&(e.push(s),t.push("<author>"+s+"</author>")),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),t.push("<author>tc="+r.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),n.forEach(function(i){var r=0,s=[],a=0;if(i[1][0]&&i[1][0].T&&i[1][0].ID&&(r=e.indexOf("tc="+i[1][0].ID)),i[1].forEach(function(f){f.a&&(r=e.indexOf($e(f.a))),f.T&&++a,s.push(f.t==null?"":$e(f.t))}),a===0)i[1].forEach(function(f){t.push('<comment ref="'+i[0]+'" authorId="'+e.indexOf($e(f.a))+'"><text>'),t.push(zi("t",f.t==null?"":$e(f.t))),t.push("</text></comment>")});else{i[1][0]&&i[1][0].T&&i[1][0].ID&&(r=e.indexOf("tc="+i[1][0].ID)),t.push('<comment ref="'+i[0]+'" authorId="'+r+'"><text>');for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;t.push(zi("t",$e(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function PR(n,t,e){var i=[pi,se("ThreadedComments",null,{xmlns:Di.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(r){var s="";(r[1]||[]).forEach(function(a,l){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var u={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};l==0?s=u.id:u.parentId=s,a.ID=u.id,a.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),i.push(se("threadedComment",zi("text",a.t||""),u))})}),i.push("</ThreadedComments>"),i.join("")}function FR(n){var t=[pi,se("personList",null,{xmlns:Di.TCMNT,"xmlns:x":Rf[0]}).replace(/[\/]>/,">")];return n.forEach(function(e,i){t.push(se("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Q$(n){var t={};t.iauthor=n.read_shift(4);var e=Xc(n);return t.rfx=e.s,t.ref=Vn(e.s),n.l+=16,t}function J$(n,t){return t==null&&(t=Ft(36)),t.write_shift(4,n[1].iauthor),Lf(n[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var tG=ar;function tT(n){return Ei(n.slice(0,54))}function eG(n){var t=sr(),e=[];return Xt(t,628),Xt(t,630),n.forEach(function(i){i[1].forEach(function(r){e.indexOf(r.a)>-1||(e.push(r.a.slice(0,54)),Xt(t,632,tT(r.a)),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),Xt(t,632,tT("tc="+r.ID))))})}),Xt(t,631),Xt(t,633),n.forEach(function(i){i[1].forEach(function(r){var s=-1;r.ID&&(s=e.indexOf("tc="+r.ID)),s==-1&&i[1][0].T&&i[1][0].ID&&(s=e.indexOf("tc="+i[1][0].ID)),s==-1&&(s=e.indexOf(r.a)),r.iauthor=s;var a={s:Un(i[0]),e:Un(i[0])};Xt(t,635,J$([a,r])),r.t&&r.t.length>0&&Xt(t,637,Q9(r)),Xt(t,636),delete r.iauthor})}),Xt(t,634),Xt(t,629),t.end()}function nG(n,t){t.FullPaths.forEach(function(e,i){if(i!=0){var r=e.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&Rn.utils.cfb_add(n,r,t.FileIndex[i].content)}})}var iG=["xlsb","xlsm","xlam","biff8","xla"],eT=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(i,r,s,a){var l=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return l?d+=t.c:--d,u?f+=t.r:--f,r+(l?"":"$")+xn(d)+(u?"":"$")+Sn(f)}return function(r,s){return t=s,r.replace(n,e)}}(),fv=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{fv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var hv=function(){return function(t,e){return t.replace(fv,function(i,r,s,a,l,u){var f=ay(a)-(s?0:e.c),d=sy(u)-(l?0:e.r),p=l=="$"?d+1:d==0?"":"["+d+"]",m=s=="$"?f+1:f==0?"":"["+f+"]";return r+"R"+p+"C"+m})}}();function rG(n,t){return n.replace(fv,function(e,i,r,s,a,l){return i+(r=="$"?r+s:xn(ay(s)+t.c))+(a=="$"?a+l:Sn(sy(l)+t.r))})}function sG(n){return n.length!=1}function li(n){n.l+=1}function Il(n,t){var e=n.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function BR(n,t,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return UR(n);e.biff==12&&(i=4)}var r=n.read_shift(i),s=n.read_shift(i),a=Il(n),l=Il(n);return{s:{r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function UR(n){var t=Il(n),e=Il(n),i=n.read_shift(1),r=n.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:e[0],c:r,cRel:e[1],rRel:e[2]}}}function aG(n,t,e){if(e.biff<8)return UR(n);var i=n.read_shift(e.biff==12?4:2),r=n.read_shift(e.biff==12?4:2),s=Il(n),a=Il(n);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r,c:a[0],cRel:a[1],rRel:a[2]}}}function zR(n,t,e){if(e&&e.biff>=2&&e.biff<=5)return oG(n);var i=n.read_shift(e&&e.biff==12?4:2),r=Il(n);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function oG(n){var t=Il(n),e=n.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function lG(n){var t=n.read_shift(2),e=n.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function cG(n,t,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return uG(n);var r=n.read_shift(i>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;r>524287;)r-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r,c:s,cRel:a,rRel:l}}function uG(n){var t=n.read_shift(2),e=n.read_shift(1),i=(t&32768)>>15,r=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),r==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:r,rRel:i}}function fG(n,t,e){var i=(n[n.l++]&96)>>5,r=BR(n,e.biff>=2&&e.biff<=5?6:8,e);return[i,r]}function hG(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2,"i"),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=BR(n,s,e);return[i,r,a]}function dG(n,t,e){var i=(n[n.l++]&96)>>5;return n.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function pG(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[i,r]}function mG(n,t,e){var i=(n[n.l++]&96)>>5,r=aG(n,t-1,e);return[i,r]}function gG(n,t,e){var i=(n[n.l++]&96)>>5;return n.l+=e.biff==2?6:e.biff==12?14:7,[i]}function nT(n){var t=n[n.l+1]&1,e=1;return n.l+=4,[t,e]}function vG(n,t,e){n.l+=2;for(var i=n.read_shift(e&&e.biff==2?1:2),r=[],s=0;s<=i;++s)r.push(n.read_shift(e&&e.biff==2?1:2));return r}function _G(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(e&&e.biff==2?1:2)]}function xG(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(e&&e.biff==2?1:2)]}function bG(n){var t=n[n.l+1]&255?1:0;return n.l+=2,[t,n.read_shift(2)]}function yG(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=e&&e.biff==2?3:4,[i]}function jR(n){var t=n.read_shift(1),e=n.read_shift(1);return[t,e]}function EG(n){return n.read_shift(2),jR(n)}function wG(n){return n.read_shift(2),jR(n)}function AG(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=zR(n,0,e);return[i,r]}function SG(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=cG(n,0,e);return[i,r]}function TG(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(2);e&&e.biff==5&&(n.l+=12);var s=zR(n,0,e);return[i,r,s]}function CG(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(e&&e.biff<=3?1:2);return[BV[r],GR[r],i]}function DG(n,t,e){var i=n[n.l++],r=n.read_shift(1),s=e&&e.biff<=3?[i==88?-1:0,n.read_shift(1)]:OG(n);return[r,(s[0]===0?GR:FV)[s[1]]]}function OG(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function RG(n,t,e){n.l+=e&&e.biff==2?3:4}function NG(n,t,e){if(n.l++,e&&e.biff==12)return[n.read_shift(4,"i"),0];var i=n.read_shift(2),r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function kG(n){return n.l++,Dr[n.read_shift(1)]}function LG(n){return n.l++,n.read_shift(2)}function IG(n){return n.l++,n.read_shift(1)!==0}function MG(n){return n.l++,If(n)}function PG(n,t,e){return n.l++,SR(n,t-1,e)}function FG(n,t){var e=[n.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=EH(n,1)?"TRUE":"FALSE",t!=12&&(n.l+=7);break;case 37:case 16:e[1]=Dr[n[n.l]],n.l+=t==12?4:8;break;case 0:n.l+=8;break;case 1:e[1]=If(n);break;case 2:e[1]=TH(n,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function BG(n,t,e){for(var i=n.read_shift(e.biff==12?4:2),r=[],s=0;s!=i;++s)r.push((e.biff==12?Xc:OH)(n));return r}function UG(n,t,e){var i=0,r=0;e.biff==12?(i=n.read_shift(4),r=n.read_shift(4)):(r=1+n.read_shift(1),i=1+n.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--r==0&&(r=256));for(var s=0,a=[];s!=i&&(a[s]=[]);++s)for(var l=0;l!=r;++l)a[s][l]=FG(n,e.biff);return a}function zG(n,t,e){var i=n.read_shift(1)>>>5&3,r=!e||e.biff>=8?4:2,s=n.read_shift(r);switch(e.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[i,0,s]}function jG(n,t,e){if(e.biff==5)return HG(n);var i=n.read_shift(1)>>>5&3,r=n.read_shift(2),s=n.read_shift(4);return[i,r,s]}function HG(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2,"i");n.l+=8;var i=n.read_shift(2);return n.l+=12,[t,e,i]}function $G(n,t,e){var i=n.read_shift(1)>>>5&3;n.l+=e&&e.biff==2?3:4;var r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function GG(n,t,e){var i=n.read_shift(1)>>>5&3,r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function VG(n,t,e){var i=n.read_shift(1)>>>5&3;return n.l+=4,e.biff<8&&n.l--,e.biff==12&&(n.l+=2),[i]}function WG(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),s=4;if(e)switch(e.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[i,r]}var qG=qa,YG=qa,XG=qa;function _p(n,t,e){return n.l+=2,[lG(n)]}function hy(n){return n.l+=6,[]}var KG=_p,ZG=hy,QG=hy,JG=_p;function HR(n){return n.l+=2,[qm(n),n.read_shift(2)&1]}var tV=_p,eV=HR,nV=hy,iV=_p,rV=_p,sV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function aV(n){n.l+=2;var t=n.read_shift(2),e=n.read_shift(2),i=n.read_shift(4),r=n.read_shift(2),s=n.read_shift(2),a=sV[e>>2&31];return{ixti:t,coltype:e&3,rt:a,idx:i,c:r,C:s}}function oV(n){return n.l+=2,[n.read_shift(4)]}function lV(n,t,e){return n.l+=5,n.l+=2,n.l+=e.biff==2?1:4,["PTGSHEET"]}function cV(n,t,e){return n.l+=e.biff==2?4:5,["PTGENDSHEET"]}function uV(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function fV(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function hV(n){return n.l+=4,[0,0]}var iT={1:{n:"PtgExp",f:NG},2:{n:"PtgTbl",f:XG},3:{n:"PtgAdd",f:li},4:{n:"PtgSub",f:li},5:{n:"PtgMul",f:li},6:{n:"PtgDiv",f:li},7:{n:"PtgPower",f:li},8:{n:"PtgConcat",f:li},9:{n:"PtgLt",f:li},10:{n:"PtgLe",f:li},11:{n:"PtgEq",f:li},12:{n:"PtgGe",f:li},13:{n:"PtgGt",f:li},14:{n:"PtgNe",f:li},15:{n:"PtgIsect",f:li},16:{n:"PtgUnion",f:li},17:{n:"PtgRange",f:li},18:{n:"PtgUplus",f:li},19:{n:"PtgUminus",f:li},20:{n:"PtgPercent",f:li},21:{n:"PtgParen",f:li},22:{n:"PtgMissArg",f:li},23:{n:"PtgStr",f:PG},26:{n:"PtgSheet",f:lV},27:{n:"PtgEndSheet",f:cV},28:{n:"PtgErr",f:kG},29:{n:"PtgBool",f:IG},30:{n:"PtgInt",f:LG},31:{n:"PtgNum",f:MG},32:{n:"PtgArray",f:gG},33:{n:"PtgFunc",f:CG},34:{n:"PtgFuncVar",f:DG},35:{n:"PtgName",f:zG},36:{n:"PtgRef",f:AG},37:{n:"PtgArea",f:fG},38:{n:"PtgMemArea",f:$G},39:{n:"PtgMemErr",f:qG},40:{n:"PtgMemNoMem",f:YG},41:{n:"PtgMemFunc",f:GG},42:{n:"PtgRefErr",f:VG},43:{n:"PtgAreaErr",f:dG},44:{n:"PtgRefN",f:SG},45:{n:"PtgAreaN",f:mG},46:{n:"PtgMemAreaN",f:uV},47:{n:"PtgMemNoMemN",f:fV},57:{n:"PtgNameX",f:jG},58:{n:"PtgRef3d",f:TG},59:{n:"PtgArea3d",f:hG},60:{n:"PtgRefErr3d",f:WG},61:{n:"PtgAreaErr3d",f:pG},255:{}},dV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},pV={1:{n:"PtgElfLel",f:HR},2:{n:"PtgElfRw",f:iV},3:{n:"PtgElfCol",f:KG},6:{n:"PtgElfRwV",f:rV},7:{n:"PtgElfColV",f:JG},10:{n:"PtgElfRadical",f:tV},11:{n:"PtgElfRadicalS",f:nV},13:{n:"PtgElfColS",f:ZG},15:{n:"PtgElfColSV",f:QG},16:{n:"PtgElfRadicalLel",f:eV},25:{n:"PtgList",f:aV},29:{n:"PtgSxName",f:oV},255:{}},mV={0:{n:"PtgAttrNoop",f:hV},1:{n:"PtgAttrSemi",f:yG},2:{n:"PtgAttrIf",f:xG},4:{n:"PtgAttrChoose",f:vG},8:{n:"PtgAttrGoto",f:_G},16:{n:"PtgAttrSum",f:RG},32:{n:"PtgAttrBaxcel",f:nT},33:{n:"PtgAttrBaxcel",f:nT},64:{n:"PtgAttrSpace",f:EG},65:{n:"PtgAttrSpaceSemi",f:wG},128:{n:"PtgAttrIfError",f:bG},255:{}};function gV(n,t,e,i){if(i.biff<8)return qa(n,t);for(var r=n.l+t,s=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=UG(n,0,i),s.push(e[a][1]);break;case"PtgMemArea":e[a][2]=BG(n,e[a][1],i),s.push(e[a][2]);break;case"PtgExp":i&&i.biff==12&&(e[a][1][1]=n.read_shift(4),s.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0]}return t=r-n.l,t!==0&&s.push(qa(n,t)),s}function vV(n,t,e){for(var i=n.l+t,r,s,a=[];i!=n.l;)t=i-n.l,s=n[n.l],r=iT[s]||iT[dV[s]],(s===24||s===25)&&(r=(s===24?pV:mV)[n[n.l+1]]),!r||!r.f?qa(n,t):a.push([r.n,r.f(n,t,e)]);return a}function _V(n){for(var t=[],e=0;e<n.length;++e){for(var i=n[e],r=[],s=0;s<i.length;++s){var a=i[s];if(a)switch(a[0]){case 2:r.push('"'+a[1].replace(/"/g,'""')+'"');break;default:r.push(a[1])}else r.push("")}t.push(r.join(","))}return t.join(";")}var xV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function bV(n,t){var e=n.lastIndexOf("!"),i=t.lastIndexOf("!");return e==-1&&i==-1?n+":"+t:e>0&&i>0&&n.slice(0,e).toLowerCase()==t.slice(0,i).toLowerCase()?n+":"+t.slice(i+1):(console.error("Cannot hydrate range",n,t),n+":"+t)}function $R(n,t,e){if(!n)return"SH33TJSERR0";if(e.biff>8&&(!n.XTI||!n.XTI[t]))return n.SheetNames[t];if(!n.XTI)return"SH33TJSERR6";var i=n.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":n.XTI[t-1];if(!i)return"SH33TJSERR1";var r="";if(e.biff>8)switch(n[i[0]][0]){case 357:return r=i[1]==-1?"#REF":n.SheetNames[i[1]],i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 358:return e.SID!=null?n.SheetNames[e.SID]:"SH33TJSSAME"+n[i[0]][0];case 355:default:return"SH33TJSSRC"+n[i[0]][0]}switch(n[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":n.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 14849:return n[i[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[i[0]][0][3]?(r=i[1]==-1?"#REF":n[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+n[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function rT(n,t,e){var i=$R(n,t,e);return i=="#REF"?i:Yd(i,e)}function bf(n,t,e,i,r){var s=r&&r.biff||8,a={s:{c:0,r:0}},l=[],u,f,d,p=0,m=0,v,x="";if(!n[0]||!n[0][0])return"";for(var _=-1,b="",E=0,T=n[0].length;E<T;++E){var S=n[0][E];switch(S[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),_>=0){switch(n[0][_][1][0]){case 0:b=Bn(" ",n[0][_][1][1]);break;case 1:b=Bn("\r",n[0][_][1][1]);break;default:if(b="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}f=f+b,_=-1}l.push(f+xV[S[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(bV(f,u));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Td(S[1][1],a,r),l.push(Cd(d,s));break;case"PtgRefN":d=e?Td(S[1][1],e,r):S[1][1],l.push(Cd(d,s));break;case"PtgRef3d":p=S[1][1],d=Td(S[1][2],a,r),x=rT(i,p,r),l.push(x+"!"+Cd(d,s));break;case"PtgFunc":case"PtgFuncVar":var O=S[1][0],R=S[1][1];O||(O=0),O&=127;var N=O==0?[]:l.slice(-O);l.length-=O,R==="User"&&(R=N.shift()),l.push(R+"("+N.join(",")+")");break;case"PtgBool":l.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(S[1]);break;case"PtgNum":l.push(String(S[1]));break;case"PtgStr":l.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(S[1]);break;case"PtgAreaN":v=US(S[1][1],e?{s:e}:a,r),l.push(z_(v,r));break;case"PtgArea":v=US(S[1][1],a,r),l.push(z_(v,r));break;case"PtgArea3d":p=S[1][1],v=S[1][2],x=rT(i,p,r),l.push(x+"!"+z_(v,r));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=S[1][2];var C=(i.names||[])[m-1]||(i[0]||[])[m],M=C?C.Name:"SH33TJSNAME"+String(m);M&&M.slice(0,6)=="_xlfn."&&!r.xlfn&&(M=M.slice(6)),l.push(M);break;case"PtgNameX":var I=S[1][1];m=S[1][2];var F;if(r.biff<=5)I<0&&(I=-I),i[I]&&(F=i[I][m]);else{var z="";if(((i[I]||[])[0]||[])[0]==14849||(((i[I]||[])[0]||[])[0]==1025?i[I][m]&&i[I][m].itab>0&&(z=i.SheetNames[i[I][m].itab-1]+"!"):z=i.SheetNames[m-1]+"!"),i[I]&&i[I][m])z+=i[I][m].Name;else if(i[0]&&i[0][m])z+=i[0][m].Name;else{var P=($R(i,I,r)||"").split(";;");P[m-1]?z=P[m-1]:z+="SH33TJSERRX"}l.push(z);break}F||(F={Name:"SH33TJSERRY"}),l.push(F.Name);break;case"PtgParen":var tt="(",L=")";if(_>=0){switch(b="",n[0][_][1][0]){case 2:tt=Bn(" ",n[0][_][1][1])+tt;break;case 3:tt=Bn("\r",n[0][_][1][1])+tt;break;case 4:L=Bn(" ",n[0][_][1][1])+L;break;case 5:L=Bn("\r",n[0][_][1][1])+L;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}l.push(tt+l.pop()+L);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:S[1][1],r:S[1][0]};var nt={c:e.c,r:e.r};if(i.sharedf[Vn(d)]){var Q=i.sharedf[Vn(d)];l.push(bf(Q,a,nt,i,r))}else{var X=!1;for(u=0;u!=i.arrayf.length;++u)if(f=i.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(bf(f[1],a,nt,i,r)),X=!0;break}X||l.push(S[1])}break;case"PtgArray":l.push("{"+_V(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var Rt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&_>=0&&Rt.indexOf(n[0][E][0])==-1){S=n[0][_];var yt=!0;switch(S[1][0]){case 4:yt=!1;case 0:b=Bn(" ",S[1][1]);break;case 5:yt=!1;case 1:b=Bn("\r",S[1][1]);break;default:if(b="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}l.push((yt?b:"")+l.pop()+(yt?"":b)),_=-1}}if(l.length>1&&r.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function yV(n){if(n==null){var t=Ft(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof n=="number")return Bc(n);return Bc(0)}function EV(n,t,e,i,r){var s=Uc(t,e,r),a=yV(n.v),l=Ft(6),u=33;l.write_shift(2,u),l.write_shift(4,0);for(var f=Ft(n.bf.length),d=0;d<n.bf.length;++d)f[d]=n.bf[d];var p=fi([s,a,l,f]);return p}function dv(n,t,e){var i=n.read_shift(4),r=vV(n,i,e),s=n.read_shift(4),a=s>0?gV(n,s,r,e):null;return[r,a]}var wV=dv,pv=dv,AV=dv,SV=dv;function sT(n){if((n|0)==n&&n<Math.pow(2,16)&&n>=0){var t=Ft(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,n),t.write_shift(4,0),t}var e=Ft(17);return e.write_shift(4,11),e.write_shift(1,31),e.write_shift(8,n),e.write_shift(4,0),e}function TV(n){var t=Ft(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,n),t.write_shift(4,0),t}function CV(n){var t=Ft(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,n?1:0),t.write_shift(4,0),t}function DV(n){var t=Ft(7);t.write_shift(4,3+2*n.length),t.write_shift(1,23),t.write_shift(2,n.length);var e=Ft(2*n.length);e.write_shift(2*n.length,n,"utf16le");var i=Ft(4);return i.write_shift(4,0),fi([t,e,i])}function OV(n){var t=Un(n),e=Ft(15);return e.write_shift(4,7),e.write_shift(1,36),e.write_shift(4,t.r),e.write_shift(2,t.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),e.write_shift(4,0),e}function RV(n,t){var e=n.lastIndexOf("!"),i=n.slice(0,e);n=n.slice(e+1);var r=Un(n);i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var s=Ft(17);return s.write_shift(4,9),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,r.r),s.write_shift(2,r.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s}function NV(n,t){var e=n.lastIndexOf("!"),i=n.slice(0,e);n=n.slice(e+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var r=Ft(17);return r.write_shift(4,9),r.write_shift(1,60),r.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(i.toLowerCase())),r.write_shift(4,0),r.write_shift(2,0),r.write_shift(4,0),r}function kV(n){var t=n.split(":"),e=t[0],i=Ft(23);i.write_shift(4,15),e=t[0];var r=Un(e);return i.write_shift(1,36),i.write_shift(4,r.r),i.write_shift(2,r.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),e=t[1],r=Un(e),i.write_shift(1,36),i.write_shift(4,r.r),i.write_shift(2,r.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),i.write_shift(4,0),i.write_shift(1,17),i.write_shift(4,0),i}function LV(n,t){var e=n.lastIndexOf("!"),i=n.slice(0,e);n=n.slice(e+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var r=n.split(":"),s=Ft(27);s.write_shift(4,19);var a=r[0],l=Un(a);return s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(u){return u.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),a=r[1],l=Un(a),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(u){return u.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),s.write_shift(1,17),s.write_shift(4,0),s}function IV(n,t){var e=n.lastIndexOf("!"),i=n.slice(0,e);n=n.slice(e+1),i.charAt(0)=="'"&&(i=i.slice(1,-1).replace(/''/g,"'"));var r=Hi(n),s=Ft(23);return s.write_shift(4,15),s.write_shift(1,59),s.write_shift(2,2+t.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(i.toLowerCase())),s.write_shift(4,r.s.r),s.write_shift(4,r.e.r),s.write_shift(2,r.s.c),s.write_shift(2,r.e.c),s.write_shift(4,0),s}function MV(n,t){if(typeof n=="number")return sT(n);if(typeof n=="boolean")return CV(n);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(n))return TV(+$a[n]);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return OV(n);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return kV(n);if(n.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return IV(n,t);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return RV(n,t);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return LV(n,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(n))return NV(n,t);if(/^".*"$/.test(n))return DV(n);if(/^[+-]\d+$/.test(n))return sT(parseInt(n,10));throw"Formula |"+n+"| not supported for XLSB"}var PV=MV,FV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},GR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},BV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function UV(n){var t="of:="+n.replace(fv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function VR(n){return n.replace(/!/,".").replace(/:/,":.")}var Dd=typeof Map<"u";function dy(n,t,e){var i=0,r=n.length;if(e){if(Dd?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var s=Dd?e.get(t):e[t];i<s.length;++i)if(n[s[i]].t===t)return n.Count++,s[i]}}else for(;i<r;++i)if(n[i].t===t)return n.Count++,i;return n[r]={t},n.Count++,n.Unique++,e&&(Dd?(e.has(t)||e.set(t,[]),e.get(t).push(r)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(r))),r}function mv(n,t){var e={min:n+1,max:n+1},i=-1;return t.MDW&&(Po=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?i=Ag(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(e.width=kx(i),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function WR(n,t){if(n){var e=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=e[0]),n.right==null&&(n.right=e[1]),n.top==null&&(n.top=e[2]),n.bottom==null&&(n.bottom=e[3]),n.header==null&&(n.header=e[4]),n.footer==null&&(n.footer=e[5])}}function Ul(n,t,e){var i=e.revssf[t.z!=null?t.z:"General"],r=60,s=n.length;if(i==null&&e.ssf){for(;r<392;++r)if(e.ssf[r]==null){h9(t.z,r),e.ssf[r]=t.z,e.revssf[t.z]=i=r;break}}for(r=0;r!=s;++r)if(n[r].numFmtId===i)return r;return n[s]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function zV(n,t,e){if(n&&n["!ref"]){var i=In(n["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+n["!ref"])}}function jV(n){if(n.length===0)return"";for(var t='<mergeCells count="'+n.length+'">',e=0;e!=n.length;++e)t+='<mergeCell ref="'+di(n[e])+'"/>';return t+"</mergeCells>"}function HV(n,t,e,i,r){var s=!1,a={},l=null;if(i.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[e];try{t.Workbook&&(u=t.Workbook.Sheets[e].CodeName||u)}catch{}s=!0,a.codeName=Vd($e(u))}if(n&&n["!outline"]){var f={summaryBelow:1,summaryRight:1};n["!outline"].above&&(f.summaryBelow=0),n["!outline"].left&&(f.summaryRight=0),l=(l||"")+se("outlinePr",null,f)}!s&&!l||(r[r.length]=se("sheetPr",l,a))}var $V=["objects","scenarios","selectLockedCells","selectUnlockedCells"],GV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function VV(n){var t={sheet:1};return $V.forEach(function(e){n[e]!=null&&n[e]&&(t[e]="1")}),GV.forEach(function(e){n[e]!=null&&!n[e]&&(t[e]="0")}),n.password&&(t.password=RR(n.password).toString(16).toUpperCase()),se("sheetProtection",null,t)}function WV(n){return WR(n),se("pageMargins",null,n)}function qV(n,t){for(var e=["<cols>"],i,r=0;r!=t.length;++r)(i=t[r])&&(e[e.length]=se("col",null,mv(r,i)));return e[e.length]="</cols>",e.join("")}function YV(n,t,e,i){var r=typeof n.ref=="string"?n.ref:di(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,a=Hi(r);a.s.r==a.e.r&&(a.e.r=Hi(t["!ref"]).e.r,r=di(a));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==i){u.Ref=Yd(e.SheetNames[i])+"!"+qd(r);break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+r}),se("autoFilter",null,{ref:r})}function XV(n,t,e,i){var r={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,r),{})}function KV(n,t,e,i,r,s,a){if(n.c&&e["!comments"].push([t,n.c]),(n.v===void 0||n.t==="z"&&!(i||{}).sheetStubs)&&typeof n.f!="string"&&typeof n.z>"u")return"";var l="",u=n.t,f=n.v;if(n.t!=="z")switch(n.t){case"b":l=n.v?"1":"0";break;case"n":isNaN(n.v)?(n.t="e",l=Dr[n.v=36]):isFinite(n.v)?l=""+n.v:(n.t="e",l=Dr[n.v=7]);break;case"e":l=Dr[n.v];break;case"d":if(i&&i.cellDates){var d=Wr(n.v,a);l=d.toISOString(),d.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else n=or(n),n.t="n",l=""+(n.v=$i(Wr(n.v,a),a));typeof n.z>"u"&&(n.z=Ln[14]);break;default:l=n.v;break}var p=n.t=="z"||n.v==null?"":zi("v",$e(l)),m={r:t},v=Ul(i.cellXfs,n,i);switch(v!==0&&(m.s=v),n.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){p=zi("v",""+dy(i.Strings,n.v,i.revStrings)),m.t="s";break}else m.t="str";break}if(n.t!=u&&(n.t=u,n.v=f),typeof n.f=="string"&&n.f){var x=n.F&&n.F.slice(0,t.length)==t?{t:"array",ref:n.F}:null;p=se("f",$e(n.f),x)+(n.v!=null?p:"")}return n.l&&(n.l.display=$e(l),e["!links"].push([t,n.l])),n.D&&(m.cm=1),se("c",p,m)}function ZV(n,t,e,i){var r=[],s=[],a=In(n["!ref"]),l="",u,f="",d=[],p=0,m=0,v=n["!rows"],x=n["!data"]!=null,_=x?n["!data"]:[],b={r:f},E,T=-1,S=(((i||{}).Workbook||{}).WBProps||{}).date1904;for(m=a.s.c;m<=a.e.c;++m)d[m]=xn(m);for(p=a.s.r;p<=a.e.r;++p){s=[],f=Sn(p);var O=x?_[p]:[];for(m=a.s.c;m<=a.e.c;++m){u=d[m]+f;var R=x?O[m]:n[u];R!==void 0&&(l=KV(R,u,n,t,e,i,S))!=null&&s.push(l)}(s.length>0||v&&v[p])&&(b={r:f},v&&v[p]&&(E=v[p],E.hidden&&(b.hidden=1),T=-1,E.hpx?T=Sg(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(b.ht=T,b.customHeight=1),E.level&&(b.outlineLevel=E.level)),r[r.length]=se("row",s.join(""),b))}if(v)for(;p<v.length;++p)v&&v[p]&&(b={r:p+1},E=v[p],E.hidden&&(b.hidden=1),T=-1,E.hpx?T=Sg(E.hpx):E.hpt&&(T=E.hpt),T>-1&&(b.ht=T,b.customHeight=1),E.level&&(b.outlineLevel=E.level),r[r.length]=se("row","",b));return r.join("")}function QV(n,t,e,i){var r=[pi,se("worksheet",null,{xmlns:Rf[0],"xmlns:r":Di.r})],s=e.SheetNames[n],a=0,l="",u=e.Sheets[s];u==null&&(u={});var f=u["!ref"]||"A1",d=In(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=di(d)}i||(i={}),u["!comments"]=[];var p=[];HV(u,e,n,t,r),r[r.length]=se("dimension",null,{ref:f}),r[r.length]=XV(u,t,n,e),t.sheetFormat&&(r[r.length]=se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(r[r.length]=qV(u,u["!cols"])),r[a=r.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(l=ZV(u,t,n,e),l.length>0&&(r[r.length]=l)),r.length>a+1&&(r[r.length]="</sheetData>",r[a]=r[a].replace("/>",">")),u["!protect"]&&(r[r.length]=VV(u["!protect"])),u["!autofilter"]!=null&&(r[r.length]=YV(u["!autofilter"],u,e,n)),u["!merges"]!=null&&u["!merges"].length>0&&(r[r.length]=jV(u["!merges"]));var m=-1,v,x=-1;return u["!links"].length>0&&(r[r.length]="<hyperlinks>",u["!links"].forEach(function(_){_[1].Target&&(v={ref:_[0]},_[1].Target.charAt(0)!="#"&&(x=un(i,-1,$e(_[1].Target).replace(/#[\s\S]*$/,""),en.HLINK),v["r:id"]="rId"+x),(m=_[1].Target.indexOf("#"))>-1&&(v.location=$e(_[1].Target.slice(m+1))),_[1].Tooltip&&(v.tooltip=$e(_[1].Tooltip)),v.display=_[1].display,r[r.length]=se("hyperlink",null,v))}),r[r.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(r[r.length]=WV(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(r[r.length]=zi("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(x=un(i,-1,"../drawings/drawing"+(n+1)+".xml",en.DRAW),r[r.length]=se("drawing",null,{"r:id":"rId"+x}),u["!drawing"]=p),u["!comments"].length>0&&(x=un(i,-1,"../drawings/vmlDrawing"+(n+1)+".vml",en.VML),r[r.length]=se("legacyDrawing",null,{"r:id":"rId"+x}),u["!legacy"]=x),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function JV(n,t){var e={},i=n.l+t;e.r=n.read_shift(4),n.l+=4;var r=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=i,s&7&&(e.level=s&7),s&16&&(e.hidden=!0),s&32&&(e.hpt=r/20),e}function tW(n,t,e){var i=Ft(145),r=(e["!rows"]||[])[n]||{};i.write_shift(4,n),i.write_shift(4,0);var s=320;r.hpx?s=Sg(r.hpx)*20:r.hpt&&(s=r.hpt*20),i.write_shift(2,s),i.write_shift(1,0);var a=0;r.level&&(a|=r.level),r.hidden&&(a|=16),(r.hpx||r.hpt)&&(a|=32),i.write_shift(1,a),i.write_shift(1,0);var l=0,u=i.l;i.l+=4;for(var f={r:n,c:0},d=e["!data"]!=null,p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var m=-1,v=-1,x=p<<10;x<p+1<<10;++x){f.c=x;var _=d?(e["!data"][f.r]||[])[f.c]:e[Vn(f)];_&&(m<0&&(m=x),v=x)}m<0||(++l,i.write_shift(4,m),i.write_shift(4,v))}var b=i.l;return i.l=u,i.write_shift(4,l),i.l=b,i.length>i.l?i.slice(0,i.l):i}function eW(n,t,e,i){var r=tW(i,e,t);(r.length>17||(t["!rows"]||[])[i])&&Xt(n,0,r)}var nW=Xc,iW=Lf;function rW(){}function sW(n,t){var e={},i=n[n.l];return++n.l,e.above=!(i&64),e.left=!(i&128),n.l+=18,e.name=J9(n),e}function aW(n,t,e){e==null&&(e=Ft(84+4*n.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),e.write_shift(1,i);for(var r=1;r<3;++r)e.write_shift(1,0);return yg({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),fR(n,e),e.slice(0,e.l)}function oW(n){var t=$s(n);return[t]}function lW(n,t,e){return e==null&&(e=Ft(8)),Wc(t,e)}function cW(n){var t=qc(n);return[t]}function uW(n,t,e){return e==null&&(e=Ft(4)),Yc(t,e)}function fW(n){var t=$s(n),e=n.read_shift(1);return[t,e,"b"]}function hW(n,t,e){return e==null&&(e=Ft(9)),Wc(t,e),e.write_shift(1,n.v?1:0),e}function dW(n){var t=qc(n),e=n.read_shift(1);return[t,e,"b"]}function pW(n,t,e){return e==null&&(e=Ft(5)),Yc(t,e),e.write_shift(1,n.v?1:0),e}function mW(n){var t=$s(n),e=n.read_shift(1);return[t,e,"e"]}function V_(n,t,e){return e==null&&(e=Ft(9)),Wc(t,e),e.write_shift(1,n.v),e}function gW(n){var t=qc(n),e=n.read_shift(1);return[t,e,"e"]}function W_(n,t,e){return e==null&&(e=Ft(8)),Yc(t,e),e.write_shift(1,n.v),e.write_shift(2,0),e.write_shift(1,0),e}function vW(n){var t=$s(n),e=n.read_shift(4);return[t,e,"s"]}function _W(n,t,e){return e==null&&(e=Ft(12)),Wc(t,e),e.write_shift(4,t.v),e}function xW(n){var t=qc(n),e=n.read_shift(4);return[t,e,"s"]}function bW(n,t,e){return e==null&&(e=Ft(8)),Yc(t,e),e.write_shift(4,t.v),e}function yW(n){var t=$s(n),e=If(n);return[t,e,"n"]}function EW(n,t,e){return e==null&&(e=Ft(16)),Wc(t,e),Bc(n.v,e),e}function wW(n){var t=qc(n),e=If(n);return[t,e,"n"]}function AW(n,t,e){return e==null&&(e=Ft(12)),Yc(t,e),Bc(n.v,e),e}function SW(n){var t=$s(n),e=cy(n);return[t,e,"n"]}function TW(n,t,e){return e==null&&(e=Ft(12)),Wc(t,e),hR(n.v,e),e}function CW(n){var t=qc(n),e=cy(n);return[t,e,"n"]}function DW(n,t,e){return e==null&&(e=Ft(8)),Yc(t,e),hR(n.v,e),e}function OW(n){var t=$s(n),e=oy(n);return[t,e,"is"]}function RW(n){var t=$s(n),e=ar(n);return[t,e,"str"]}function NW(n,t,e){var i=n.v==null?"":String(n.v);return e==null&&(e=Ft(12+4*n.v.length)),Wc(t,e),Ei(i,e),e.length>e.l?e.slice(0,e.l):e}function kW(n){var t=qc(n),e=ar(n);return[t,e,"str"]}function LW(n,t,e){var i=n.v==null?"":String(n.v);return e==null&&(e=Ft(8+4*i.length)),Yc(t,e),Ei(i,e),e.length>e.l?e.slice(0,e.l):e}function IW(n,t,e){var i=n.l+t,r=$s(n);r.r=e["!row"];var s=n.read_shift(1),a=[r,s,"b"];if(e.cellFormula){n.l+=2;var l=pv(n,i-n.l,e);a[3]=bf(l,null,r,e.supbooks,e)}else n.l=i;return a}function MW(n,t,e){var i=n.l+t,r=$s(n);r.r=e["!row"];var s=n.read_shift(1),a=[r,s,"e"];if(e.cellFormula){n.l+=2;var l=pv(n,i-n.l,e);a[3]=bf(l,null,r,e.supbooks,e)}else n.l=i;return a}function PW(n,t,e){var i=n.l+t,r=$s(n);r.r=e["!row"];var s=If(n),a=[r,s,"n"];if(e.cellFormula){n.l+=2;var l=pv(n,i-n.l,e);a[3]=bf(l,null,r,e.supbooks,e)}else n.l=i;return a}function FW(n,t,e){var i=n.l+t,r=$s(n);r.r=e["!row"];var s=ar(n),a=[r,s,"str"];if(e.cellFormula){n.l+=2;var l=pv(n,i-n.l,e);a[3]=bf(l,null,r,e.supbooks,e)}else n.l=i;return a}var BW=Xc,UW=Lf;function zW(n,t){return t==null&&(t=Ft(4)),t.write_shift(4,n),t}function jW(n,t){var e=n.l+t,i=Xc(n),r=uv(n),s=ar(n),a=ar(n),l=ar(n);n.l=e;var u={rfx:i,relId:r,loc:s,display:l};return a&&(u.Tooltip=a),u}function HW(n,t){var e=Ft(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Lf({s:Un(n[0]),e:Un(n[0])},e),ly("rId"+t,e);var i=n[1].Target.indexOf("#"),r=i==-1?"":n[1].Target.slice(i+1);return Ei(r||"",e),Ei(n[1].Tooltip||"",e),Ei("",e),e.slice(0,e.l)}function $W(){}function GW(n,t,e){var i=n.l+t,r=dR(n),s=n.read_shift(1),a=[r];if(a[2]=s,e.cellFormula){var l=wV(n,i-n.l,e);a[1]=l}else n.l=i;return a}function VW(n,t,e){var i=n.l+t,r=Xc(n),s=[r];if(e.cellFormula){var a=SV(n,i-n.l,e);s[1]=a,n.l=i}else n.l=i;return s}function WW(n,t,e){e==null&&(e=Ft(18));var i=mv(n,t);e.write_shift(-4,n),e.write_shift(-4,n),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var r=0;return t.hidden&&(r|=1),typeof i.width=="number"&&(r|=2),t.level&&(r|=t.level<<8),e.write_shift(2,r),e}var qR=["left","right","top","bottom","header","footer"];function qW(n){var t={};return qR.forEach(function(e){t[e]=If(n)}),t}function YW(n,t){return t==null&&(t=Ft(6*8)),WR(n),qR.forEach(function(e){Bc(n[e],t)}),t}function XW(n){var t=n.read_shift(2);return n.l+=28,{RTL:t&32}}function KW(n,t,e){e==null&&(e=Ft(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function ZW(n){var t=Ft(24);return t.write_shift(4,4),t.write_shift(4,1),Lf(n,t),t}function QW(n,t){return t==null&&(t=Ft(16*4+2)),t.write_shift(2,n.password?RR(n.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,n[e[0]]!=null&&!n[e[0]]?1:0):t.write_shift(4,n[e[0]]!=null&&n[e[0]]?0:1)}),t}function JW(){}function tq(){}function eq(n,t,e,i,r,s,a,l){var u={r:e,c:i};if(t.c&&s["!comments"].push([Vn(u),t.c]),t.v===void 0)return!1;var f="";switch(t.t){case"b":f=t.v?"1":"0";break;case"d":t=or(t),t.z=t.z||Ln[14],t.v=$i(Wr(t.v,l),l),t.t="n";break;case"n":case"e":f=""+t.v;break;default:f=t.v;break}switch(u.s=Ul(r.cellXfs,t,r),t.l&&s["!links"].push([Vn(u),t.l]),t.t){case"s":case"str":return r.bookSST?(f=dy(r.Strings,t.v==null?"":String(t.v),r.revStrings),u.t="s",u.v=f,a?Xt(n,18,bW(t,u)):Xt(n,7,_W(t,u))):(u.t="str",a?Xt(n,17,LW(t,u)):Xt(n,6,NW(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Xt(n,13,DW(t,u)):Xt(n,2,TW(t,u)):isFinite(t.v)?a?Xt(n,16,AW(t,u)):Xt(n,5,EW(t,u)):(u.t="e",isNaN(t.v)?a?Xt(n,14,W_({v:36},u)):Xt(n,3,V_({v:36},u)):a?Xt(n,14,W_({v:7},u)):Xt(n,3,V_({v:7},u))),!0;case"b":return u.t="b",a?Xt(n,15,pW(t,u)):Xt(n,4,hW(t,u)),!0;case"e":return u.t="e",a?Xt(n,14,W_(t,u)):Xt(n,3,V_(t,u)),!0}return a?Xt(n,12,uW(t,u)):Xt(n,1,lW(t,u)),!0}function nq(n,t,e,i,r){var s=In(t["!ref"]||"A1"),a="",l=[],u=(((r||{}).Workbook||{}).WBProps||{}).date1904;Xt(n,145);var f=t["!data"]!=null,d=f?t["!data"][s.s.r]:[],p=s.e.r;t["!rows"]&&(p=Math.max(s.e.r,t["!rows"].length-1));for(var m=s.s.r;m<=p;++m)if(a=Sn(m),f&&(d=t["!data"][m]),eW(n,t,s,m),!(f&&!d)){var v=!1;if(m<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){m===s.s.r&&(l[x]=xn(x));var _=f?d[x]:t[l[x]+a];if(!_){v=!1;continue}v=eq(n,_,m,x,i,t,v,u)}}Xt(n,146)}function iq(n,t){!t||!t["!merges"]||(Xt(n,177,zW(t["!merges"].length)),t["!merges"].forEach(function(e){Xt(n,176,UW(e))}),Xt(n,178))}function rq(n,t){!t||!t["!cols"]||(Xt(n,390),t["!cols"].forEach(function(e,i){e&&Xt(n,60,WW(i,e))}),Xt(n,391))}function sq(n,t){!t||!t["!ref"]||(Xt(n,648),Xt(n,649,ZW(In(t["!ref"]))),Xt(n,650))}function aq(n,t,e){t["!links"].forEach(function(i){if(i[1].Target){var r=un(e,-1,i[1].Target.replace(/#[\s\S]*$/,""),en.HLINK);Xt(n,494,HW(i,r))}}),delete t["!links"]}function oq(n,t,e,i){if(t["!comments"].length>0){var r=un(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",en.VML);Xt(n,551,ly("rId"+r)),t["!legacy"]=r}}function lq(n,t,e,i){if(t["!autofilter"]){var r=t["!autofilter"],s=typeof r.ref=="string"?r.ref:di(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,l=Hi(s);l.s.r==l.e.r&&(l.e.r=Hi(t["!ref"]).e.r,s=di(l));for(var u=0;u<a.length;++u){var f=a[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i){f.Ref=Yd(e.SheetNames[i])+"!"+qd(s);break}}u==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:Yd(e.SheetNames[i])+"!"+qd(s)}),Xt(n,161,Lf(In(s))),Xt(n,162)}}function cq(n,t,e){Xt(n,133),Xt(n,137,KW(t,e)),Xt(n,138),Xt(n,134)}function uq(n,t){t["!protect"]&&Xt(n,535,QW(t["!protect"]))}function fq(n,t,e,i){var r=sr(),s=e.SheetNames[n],a=e.Sheets[s]||{},l=s;try{e&&e.Workbook&&(l=e.Workbook.Sheets[n].CodeName||l)}catch{}var u=In(a["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Xt(r,129),(e.vbaraw||a["!outline"])&&Xt(r,147,aW(l,a["!outline"])),Xt(r,148,iW(u)),cq(r,a,e.Workbook),rq(r,a),nq(r,a,n,t,e),uq(r,a),lq(r,a,e,n),iq(r,a),aq(r,a,i),a["!margins"]&&Xt(r,476,YW(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&sq(r,a),oq(r,a,n,i),Xt(r,130),r.end()}function hq(n,t){n.l+=10;var e=ar(n);return{name:e}}var dq=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function pq(n){return!n.Workbook||!n.Workbook.WBProps?"false":R9(n.Workbook.WBProps.date1904)?"true":"false"}var mq=":][*?/\\".split("");function YR(n,t){try{if(n=="")throw new Error("Sheet name cannot be blank");if(n.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(n.charCodeAt(0)==39||n.charCodeAt(n.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(n.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");mq.forEach(function(e){if(n.indexOf(e)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(e){throw e}return!0}function gq(n,t,e){n.forEach(function(i,r){YR(i);for(var s=0;s<r;++s)if(i==n[s])throw new Error("Duplicate Sheet Name: "+i);if(e){var a=t&&t[r]&&t[r].CodeName||i;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function vq(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var t=n.Workbook&&n.Workbook.Sheets||[];gq(n.SheetNames,t,!!n.vbaraw);for(var e=0;e<n.SheetNames.length;++e)zV(n.Sheets[n.SheetNames[e]],n.SheetNames[e],e);n.SheetNames.forEach(function(i,r){var s=n.Sheets[i];if(!(!s||!s["!autofilter"])){var a;n.Workbook||(n.Workbook={}),n.Workbook.Names||(n.Workbook.Names=[]),n.Workbook.Names.forEach(function(u){u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r&&(a=u)});var l=Yd(i)+"!"+qd(s["!autofilter"].ref);a?a.Ref=l:n.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:l})}})}function _q(n){var t=[pi];t[t.length]=se("workbook",null,{xmlns:Rf[0],"xmlns:r":Di.r});var e=n.Workbook&&(n.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(dq.forEach(function(l){n.Workbook.WBProps[l[0]]!=null&&n.Workbook.WBProps[l[0]]!=l[1]&&(i[l[0]]=n.Workbook.WBProps[l[0]])}),n.Workbook.WBProps.CodeName&&(i.codeName=n.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=se("workbookPr",null,i);var r=n.Workbook&&n.Workbook.Sheets||[],s=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!r[s]||!r[s].Hidden);++s);s==n.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:$e(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),r[s])switch(r[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=se("sheet",null,a)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(l){var u={name:l.Name};l.Comment&&(u.comment=l.Comment),l.Sheet!=null&&(u.localSheetId=""+l.Sheet),l.Hidden&&(u.hidden="1"),l.Ref&&(t[t.length]=se("definedName",$e(l.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function xq(n,t){var e={};return e.Hidden=n.read_shift(4),e.iTabID=n.read_shift(4),e.strRelID=Nx(n),e.name=ar(n),e}function bq(n,t){return t||(t=Ft(127)),t.write_shift(4,n.Hidden),t.write_shift(4,n.iTabID),ly(n.strRelID,t),Ei(n.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function yq(n,t){var e={},i=n.read_shift(4);e.defaultThemeVersion=n.read_shift(4);var r=t>8?ar(n):"";return r.length>0&&(e.CodeName=r),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function Eq(n,t){t||(t=Ft(72));var e=0;return n&&(n.date1904&&(e|=1),n.filterPrivacy&&(e|=8)),t.write_shift(4,e),t.write_shift(4,0),fR(n&&n.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function wq(n,t,e){var i=n.l+t,r=n.read_shift(4);n.l+=1;var s=n.read_shift(4),a=tH(n),l,u="";try{l=AV(n,0,e);try{u=uv(n)}catch{}}catch{console.error("Could not parse defined name "+a)}r&32&&(a="_xlnm."+a),n.l=i;var f={Name:a,Ptg:l,Flags:r};return s<268435455&&(f.Sheet=s),u&&(f.Comment=u),f}function Aq(n,t){var e=Ft(9),i=0,r=n.Name;hH.indexOf(r)>-1&&(i|=32,r=r.slice(6)),e.write_shift(4,i),e.write_shift(1,0),e.write_shift(4,n.Sheet==null?4294967295:n.Sheet);var s=[e,Ei(r),PV(n.Ref,t)];if(n.Comment)s.push(Xd(n.Comment));else{var a=Ft(4);a.write_shift(4,4294967295),s.push(a)}return fi(s)}function Sq(n,t){Xt(n,143);for(var e=0;e!=t.SheetNames.length;++e){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,r={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};Xt(n,156,bq(r))}Xt(n,144)}function Tq(n,t){t||(t=Ft(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return Ei("SheetJS",t),Ei(hg.version,t),Ei(hg.version,t),Ei("7262",t),t.length>t.l?t.slice(0,t.l):t}function Cq(n,t){t||(t=Ft(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,n),t.write_shift(4,n);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function Dq(n,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,i=0,r=-1,s=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&r==-1?r=i:e[i].Hidden==1&&s==-1&&(s=i);s>r||(Xt(n,135),Xt(n,158,Cq(r)),Xt(n,136))}}function Oq(n,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(e){try{if(e.Flags&14)return;Xt(n,39,Aq(e,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(e))}})}function Rq(n){var t=n.SheetNames.length,e=Ft(12*t+28);e.write_shift(4,t+2),e.write_shift(4,0),e.write_shift(4,-2),e.write_shift(4,-2),e.write_shift(4,0),e.write_shift(4,-1),e.write_shift(4,-1);for(var i=0;i<t;++i)e.write_shift(4,0),e.write_shift(4,i),e.write_shift(4,i);return e}function Nq(n,t){Xt(n,353),Xt(n,357),Xt(n,362,Rq(t)),Xt(n,354)}function kq(n,t){var e=sr();return Xt(e,131),Xt(e,128,Tq()),Xt(e,153,Eq(n.Workbook&&n.Workbook.WBProps||null)),Dq(e,n),Sq(e,n),Nq(e,n),(n.Workbook||{}).Names&&Oq(e,n),Xt(e,132),e.end()}function Lq(n,t){var e=[];return n.Props&&e.push(vH(n.Props,t)),n.Custprops&&e.push(_H(n.Props,n.Custprops)),e.join("")}function Iq(n){return(((n||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function Mq(n,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,r){var s=[];s.push(se("NumberFormat",null,{"ss:Format":$e(Ln[i.numFmtId])}));var a={"ss:ID":"s"+(21+r)};e.push(se("Style",s.join(""),a))}),se("Styles",e.join(""))}function XR(n){return se("NamedRange",null,{"ss:Name":n.Name.slice(0,6)=="_xlnm."?n.Name.slice(6):n.Name,"ss:RefersTo":"="+hv(n.Ref,{r:0,c:0})})}function Pq(n){if(!((n||{}).Workbook||{}).Names)return"";for(var t=n.Workbook.Names,e=[],i=0;i<t.length;++i){var r=t[i];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||e.push(XR(r)))}return se("Names",e.join(""))}function Fq(n,t,e,i){if(!n||!((i||{}).Workbook||{}).Names)return"";for(var r=i.Workbook.Names,s=[],a=0;a<r.length;++a){var l=r[a];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||s.push(XR(l)))}return s.join("")}function Bq(n,t,e,i){if(!n)return"";var r=[];if(n["!margins"]&&(r.push("<PageSetup>"),n["!margins"].header&&r.push(se("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&r.push(se("Footer",null,{"x:Margin":n["!margins"].footer})),r.push(se("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),r.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)r.push(se("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<e&&!(i.Workbook.Sheets[s]&&!i.Workbook.Sheets[s].Hidden);++s);s==e&&r.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),n["!protect"]&&(r.push(zi("ProtectContents","True")),n["!protect"].objects&&r.push(zi("ProtectObjects","True")),n["!protect"].scenarios&&r.push(zi("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?r.push(zi("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&r.push(zi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&r.push("<"+a[1]+"/>")})),r.length==0?"":se("WorksheetOptions",r.join(""),{xmlns:ls.x})}function Uq(n){return n.map(function(t){var e=O9(t.t||""),i=se("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"}),r={};return t.a&&(r["ss:Author"]=t.a),n.hidden||(r["ss:ShowAlways"]="1"),se("Comment",i,r)}).join("")}function zq(n,t,e,i,r,s,a){if(!n||n.v==null&&n.f==null)return"";var l={};if(n.f&&(l["ss:Formula"]="="+$e(hv(n.f,a))),n.F&&n.F.slice(0,t.length)==t){var u=Un(n.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(u.r==a.r?"":"["+(u.r-a.r)+"]")+"C"+(u.c==a.c?"":"["+(u.c-a.c)+"]")}if(n.l&&n.l.Target&&(l["ss:HRef"]=$e(n.l.Target),n.l.Tooltip&&(l["x:HRefScreenTip"]=$e(n.l.Tooltip))),e["!merges"])for(var f=e["!merges"],d=0;d!=f.length;++d)f[d].s.c!=a.c||f[d].s.r!=a.r||(f[d].e.c>f[d].s.c&&(l["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(l["ss:MergeDown"]=f[d].e.r-f[d].s.r));var p="",m="";switch(n.t){case"z":if(!i.sheetStubs)return"";break;case"n":isFinite(n.v)?(p="Number",m=String(n.v)):(p="Error",m=Dr[isNaN(n.v)?36:7]);break;case"b":p="Boolean",m=n.v?"1":"0";break;case"e":p="Error",m=Dr[n.v];break;case"d":p="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Ln[14]);break;case"s":p="String",m=D9(n.v||"");break}var v=Ul(i.cellXfs,n,i);l["ss:StyleID"]="s"+(21+v),l["ss:Index"]=a.c+1;var x=n.v!=null?m:"",_=n.t=="z"?"":'<Data ss:Type="'+p+'">'+x+"</Data>";return(n.c||[]).length>0&&(_+=Uq(n.c)),se("Cell",_,l)}function jq(n,t){var e='<Row ss:Index="'+(n+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=kR(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function Hq(n,t,e,i){if(!n["!ref"])return"";var r=In(n["!ref"]),s=n["!merges"]||[],a=0,l=[];n["!cols"]&&n["!cols"].forEach(function(b,E){fy(b);var T=!!b.width,S=mv(E,b),O={"ss:Index":E+1};T&&(O["ss:Width"]=wg(S.width)),b.hidden&&(O["ss:Hidden"]="1"),l.push(se("Column",null,O))});for(var u=n["!data"]!=null,f={r:0,c:0},d=r.s.r;d<=r.e.r;++d){var p=[jq(d,(n["!rows"]||[])[d])];f.r=d;for(var m=r.s.c;m<=r.e.c;++m){f.c=m;var v=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>m)&&!(s[a].s.r>d)&&!(s[a].e.c<m)&&!(s[a].e.r<d)){(s[a].s.c!=m||s[a].s.r!=d)&&(v=!0);break}if(!v){var x=xn(m)+Sn(d),_=u?(n["!data"][d]||[])[m]:n[x];p.push(zq(_,x,n,t,e,i,f))}}p.push("</Row>"),p.length>2&&l.push(p.join(""))}return l.join("")}function $q(n,t,e){var i=[],r=e.SheetNames[n],s=e.Sheets[r],a=s?Fq(s,t,n,e):"";return a.length>0&&i.push("<Names>"+a+"</Names>"),a=s?Hq(s,t,n,e):"",a.length>0&&i.push("<Table>"+a+"</Table>"),i.push(Bq(s,t,n,e)),s&&s["!autofilter"]&&i.push('<AutoFilter x:Range="'+hv(qd(s["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),i.join("")}function Gq(n,t){t||(t={}),n.SSF||(n.SSF=or(Ln)),n.SSF&&(ov(),av(n.SSF),t.revssf=lv(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF,t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(Lq(n,t)),e.push(Iq(n)),e.push(""),e.push(Pq(n));for(var i=0;i<n.SheetNames.length;++i)e.push(se("Worksheet",$q(i,t,n),{"ss:Name":$e(n.SheetNames[i])}));return e[2]=Mq(n,t),pi+se("Workbook",e.join(""),{xmlns:ls.ss,"xmlns:o":ls.o,"xmlns:x":ls.x,"xmlns:ss":ls.ss,"xmlns:dt":ls.dt,"xmlns:html":ls.html})}var q_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Vq(n,t){var e=[],i=[],r=[],s=0,a,l=RS(jS,"n"),u=RS(HS,"n");if(n.Props)for(a=hi(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(l,a[s])?e:Object.prototype.hasOwnProperty.call(u,a[s])?i:r).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=hi(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(l,a[s])?e:Object.prototype.hasOwnProperty.call(u,a[s])?i:r).push([a[s],n.Custprops[a[s]]]);var f=[];for(s=0;s<r.length;++s)wR.indexOf(r[s][0])>-1||bR.indexOf(r[s][0])>-1||r[s][1]!=null&&f.push(r[s]);i.length&&Rn.utils.cfb_add(t,"/SummaryInformation",qS(i,q_.SI,u,HS)),(e.length||f.length)&&Rn.utils.cfb_add(t,"/DocumentSummaryInformation",qS(e,q_.DSI,l,jS,f.length?f:null,q_.UDI))}function Wq(n,t){var e=t||{},i=Rn.utils.cfb_new({root:"R"}),r="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":r="/Workbook",e.biff=8;break;case"biff5":r="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Rn.utils.cfb_add(i,r,ZR(n,e)),e.biff==8&&(n.Props||n.Custprops)&&Vq(n,i),e.biff==8&&n.vbaraw&&nG(i,Rn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),i}var qq={0:{f:JV},1:{f:oW},2:{f:SW},3:{f:mW},4:{f:fW},5:{f:yW},6:{f:RW},7:{f:vW},8:{f:FW},9:{f:PW},10:{f:IW},11:{f:MW},12:{f:cW},13:{f:CW},14:{f:gW},15:{f:dW},16:{f:wW},17:{f:kW},18:{f:xW},19:{f:oy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:wq},40:{},42:{},43:{f:y$},44:{f:x$},45:{f:A$},46:{f:T$},47:{f:S$},48:{},49:{f:q9},50:{},51:{f:H$},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ZH},62:{f:OW},63:{f:X$},64:{f:JW},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:XW},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:sW},148:{f:nW,p:16},151:{f:$W},152:{},153:{f:yq},154:{},155:{},156:{f:xq},157:{},158:{},159:{T:1,f:l$},160:{T:-1},161:{T:1,f:Xc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:BW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:z$},336:{T:-1},337:{f:V$,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Nx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:WH},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:GW},427:{f:VW},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:qW},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:rW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:jW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Nx},551:{f:uv},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:tG},633:{T:1},634:{T:-1},635:{T:1,f:Q$},636:{T:-1},637:{f:Z9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hq},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:tq},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Zt(n,t,e,i){var r=t;if(!isNaN(r)){var s=i||(e||[]).length||0,a=n.next(4);a.write_shift(2,r),a.write_shift(2,s),s>0&&ry(e)&&n.push(e)}}function Yq(n,t,e,i){var r=(e||[]).length||0;if(r<=8224)return Zt(n,t,e,r);var s=t;if(!isNaN(s)){for(var a=e.parts||[],l=0,u=0,f=0;f+(a[l]||8224)<=8224;)f+=a[l]||8224,l++;var d=n.next(4);for(d.write_shift(2,s),d.write_shift(2,f),n.push(e.slice(u,u+f)),u+=f;u<r;){for(d=n.next(4),d.write_shift(2,60),f=0;f+(a[l]||8224)<=8224;)f+=a[l]||8224,l++;d.write_shift(2,f),n.push(e.slice(u,u+f)),u+=f}}}function Y_(n,t,e,i){var r=Ft(9);return vp(r,n,t),AR(e,i||"b",r),r}function Xq(n,t,e){var i=Ft(8+2*e.length);return vp(i,n,t),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function KR(n,t){t.forEach(function(e){var i=e[0].map(function(s){return s.t}).join("");if(i.length<=2048)return Zt(n,28,$_(i,e[1],e[2]));Zt(n,28,$_(i.slice(0,2048),e[1],e[2],i.length));for(var r=2048;r<i.length;r+=2048)Zt(n,28,$_(i.slice(r,Math.min(r+2048,i.length)),-1,-1,Math.min(2048,i.length-r)))})}function Kq(n,t,e,i,r,s){var a=0;t.z!=null&&(a=r._BIFF2FmtTable.indexOf(t.z),a==-1&&(r._BIFF2FmtTable.push(t.z),a=r._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<r.cellXfs.length&&r.cellXfs[l].numFmtId!=a;++l);l==r.cellXfs.length&&r.cellXfs.push({numFmtId:a})}if(t.v!=null)switch(t.t){case"d":case"n":var u=t.t=="d"?$i(Wr(t.v,s),s):t.v;r.biff==2&&u==(u|0)&&u>=0&&u<65536?Zt(n,2,e$(e,i,u,l,a)):isNaN(u)?Zt(n,5,Y_(e,i,36,"e")):isFinite(u)?Zt(n,3,t$(e,i,u,l,a)):Zt(n,5,Y_(e,i,7,"e"));return;case"b":case"e":Zt(n,5,Y_(e,i,t.v,t.t));return;case"s":case"str":Zt(n,4,Xq(e,i,t.v==null?"":String(t.v).slice(0,255)));return}Zt(n,1,vp(null,e,i))}function Zq(n,t,e,i,r){var s=t["!data"]!=null,a=In(t["!ref"]||"A1"),l="",u=[];if(a.e.c>255||a.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.r,16383)}for(var f=(((r||{}).Workbook||{}).WBProps||{}).date1904,d=[],p=[],m=a.s.c;m<=a.e.c;++m)u[m]=xn(m);for(var v=a.s.r;v<=a.e.r;++v)for(s&&(d=t["!data"][v]||[]),l=Sn(v),m=a.s.c;m<=a.e.c;++m){var x=s?d[m]:t[u[m]+l];x&&(Kq(n,x,v,m,i,f),x.c&&p.push([x.c,v,m]))}KR(n,p)}function Qq(n,t){for(var e=t||{},i=sr(),r=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==e.sheet&&(r=s);if(r==0&&e.sheet&&n.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);Zt(i,e.biff==4?1033:e.biff==3?521:9,uy(n,16,e)),((n.Workbook||{}).WBProps||{}).date1904&&Zt(i,34,nr(!0)),e.cellXfs=[{numFmtId:0}],e._BIFF2FmtTable=["General"],e._Fonts=[];var a=sr();return Zq(a,n.Sheets[n.SheetNames[r]],r,e,n),e._BIFF2FmtTable.forEach(function(l){e.biff<=3?Zt(i,30,UH(l)):Zt(i,1054,zH(l))}),e.cellXfs.forEach(function(l){switch(e.biff){case 2:Zt(i,67,HH(l));break;case 3:Zt(i,579,DR(l));break;case 4:Zt(i,1091,$H(l));break}}),delete e._BIFF2FmtTable,delete e.cellXfs,delete e._Fonts,i.push(a.end()),Zt(i,10),i.end()}var ia=1,Ls=[];function Jq(){var n=Ft(82+8*Ls.length);n.write_shift(2,15),n.write_shift(2,61440),n.write_shift(4,74+8*Ls.length);{n.write_shift(2,0),n.write_shift(2,61446),n.write_shift(4,16+8*Ls.length);{n.write_shift(4,ia),n.write_shift(4,Ls.length+1);for(var t=0,e=0;e<Ls.length;++e)t+=Ls[e]&&Ls[e][1]||0;n.write_shift(4,t),n.write_shift(4,Ls.length)}Ls.forEach(function(i){n.write_shift(4,i[0]),n.write_shift(4,i[2])})}return n.write_shift(2,51),n.write_shift(2,61451),n.write_shift(4,18),n.write_shift(2,191),n.write_shift(4,524296),n.write_shift(2,385),n.write_shift(4,134217793),n.write_shift(2,448),n.write_shift(4,134217792),n.write_shift(2,64),n.write_shift(2,61726),n.write_shift(4,16),n.write_shift(4,134217741),n.write_shift(4,134217740),n.write_shift(4,134217751),n.write_shift(4,268435703),n}function tY(n,t){var e=[],i=0,r=sr(),s=ia,a;t.forEach(function(u,f){var d="",p=u[0].map(function(S){return S.a&&!d&&(d=S.a),S.t}).join("");++ia;{var m=Ft(150);m.write_shift(2,15),m.write_shift(2,61444),m.write_shift(4,150),m.write_shift(2,3234),m.write_shift(2,61450),m.write_shift(4,8),m.write_shift(4,ia),m.write_shift(4,2560),m.write_shift(2,227),m.write_shift(2,61451),m.write_shift(4,84),m.write_shift(2,128),m.write_shift(4,0),m.write_shift(2,139),m.write_shift(4,2),m.write_shift(2,191),m.write_shift(4,524296),m.write_shift(2,344),m.l+=4,m.write_shift(2,385),m.write_shift(4,134217808),m.write_shift(2,387),m.write_shift(4,134217808),m.write_shift(2,389),m.write_shift(4,268435700),m.write_shift(2,447),m.write_shift(4,1048592),m.write_shift(2,448),m.write_shift(4,134217809),m.write_shift(2,451),m.write_shift(4,268435700),m.write_shift(2,513),m.write_shift(4,134217809),m.write_shift(2,515),m.write_shift(4,268435700),m.write_shift(2,575),m.write_shift(4,196609),m.write_shift(2,959),m.write_shift(4,131072|(u[0].hidden?2:0)),m.l+=2,m.write_shift(2,61456),m.write_shift(4,18),m.write_shift(2,3),m.write_shift(2,u[2]+2),m.l+=2,m.write_shift(2,u[1]+1),m.l+=2,m.write_shift(2,u[2]+4),m.l+=2,m.write_shift(2,u[1]+5),m.l+=2,m.l+=2,m.write_shift(2,61457),m.l+=4,m.l=150,f==0?a=m:Zt(r,236,m)}i+=150;{var v=Ft(52);v.write_shift(2,21),v.write_shift(2,18),v.write_shift(2,25),v.write_shift(2,ia),v.write_shift(2,0),v.l=22,v.write_shift(2,13),v.write_shift(2,22),v.write_shift(4,1651663474),v.write_shift(4,2503426821),v.write_shift(4,2150634280),v.write_shift(4,1768515844+ia*256),v.write_shift(2,0),v.write_shift(4,0),v.l+=4,Zt(r,93,v)}{var x=Ft(8);x.l+=2,x.write_shift(2,61453),x.l+=4,Zt(r,236,x)}i+=8;{var _=Ft(18);_.write_shift(2,18),_.l+=8,_.write_shift(2,p.length),_.write_shift(2,16),_.l+=4,Zt(r,438,_);{var b=Ft(1+p.length);b.write_shift(1,0),b.write_shift(p.length,p,"sbcs"),Zt(r,60,b)}{var E=Ft(16);E.l+=8,E.write_shift(2,p.length),E.l+=6,Zt(r,60,E)}}{var T=Ft(12+d.length);T.write_shift(2,u[1]),T.write_shift(2,u[2]),T.write_shift(2,0|(u[0].hidden?0:2)),T.write_shift(2,ia),T.write_shift(2,d.length),T.write_shift(1,0),T.write_shift(d.length,d,"sbcs"),T.l++,e.push(T)}});{var l=Ft(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,i+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,ia),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,i+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,s),l.write_shift(4,5),Zt(n,236,a?fi([l,a]):l)}n.push(r.end()),e.forEach(function(u){Zt(n,28,u)}),Ls.push([s,t.length+1,ia]),++ia}function eY(n,t,e){Zt(n,49,MH({sz:12,name:"Arial"},e))}function nY(n,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&Zt(n,1054,BH(r,t[r],e))})}function iY(n,t){var e=Ft(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Zt(n,2151,e),e=Ft(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),CR(In(t["!ref"]||"A1"),e),e.write_shift(4,4),Zt(n,2152,e)}function rY(n,t){for(var e=0;e<16;++e)Zt(n,224,XS({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){Zt(n,224,XS(i,0,t))})}function sY(n,t){for(var e=0;e<t["!links"].length;++e){var i=t["!links"][e];Zt(n,440,YH(i)),i[1].Tooltip&&Zt(n,2048,XH(i))}delete t["!links"]}function aY(n,t){if(t){var e=0;t.forEach(function(i,r){++e<=256&&i&&Zt(n,125,QH(mv(r,i),r))})}}function oY(n,t,e,i,r,s){var a=16+Ul(r.cellXfs,t,r);if(t.v==null&&!t.bf){Zt(n,513,Uc(e,i,a));return}if(t.bf)Zt(n,6,EV(t,e,i,r,a));else switch(t.t){case"d":case"n":var l=t.t=="d"?$i(Wr(t.v,s),s):t.v;isNaN(l)?Zt(n,517,H_(e,i,36,a,r,"e")):isFinite(l)?Zt(n,515,VH(e,i,l,a)):Zt(n,517,H_(e,i,7,a,r,"e"));break;case"b":case"e":Zt(n,517,H_(e,i,t.v,a,r,t.t));break;case"s":case"str":if(r.bookSST){var u=dy(r.Strings,t.v==null?"":String(t.v),r.revStrings);Zt(n,253,PH(e,i,u,a))}else Zt(n,516,FH(e,i,(t.v==null?"":String(t.v)).slice(0,255),a,r));break;default:Zt(n,513,Uc(e,i,a))}}function lY(n,t,e){var i=sr(),r=e.SheetNames[n],s=e.Sheets[r]||{},a=(e||{}).Workbook||{},l=(a.Sheets||[])[n]||{},u=s["!data"]!=null,f=t.biff==8,d="",p=[],m=In(s["!ref"]||"A1"),v=f?65536:16384;if(m.e.c>255||m.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV"+v);m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.r,v-1)}Zt(i,2057,uy(e,16,t)),Zt(i,13,Is(1)),Zt(i,12,Is(100)),Zt(i,15,nr(!0)),Zt(i,17,nr(!1)),Zt(i,16,Bc(.001)),Zt(i,95,nr(!0)),Zt(i,42,nr(!1)),Zt(i,43,nr(!1)),Zt(i,130,Is(1)),Zt(i,128,GH()),Zt(i,131,nr(!1)),Zt(i,132,nr(!1)),f&&aY(i,s["!cols"]),Zt(i,512,jH(m,t));var x=(((e||{}).Workbook||{}).WBProps||{}).date1904;f&&(s["!links"]=[]);for(var _=m.s.c;_<=m.e.c;++_)p[_]=xn(_);for(var b=[],E=[],T=m.s.r;T<=m.e.r;++T)for(u&&(E=s["!data"][T]||[]),d=Sn(T),_=m.s.c;_<=m.e.c;++_){var S=u?E[_]:s[p[_]+d];S&&(oY(i,S,T,_,t,x),f&&S.l&&s["!links"].push([p[_]+d,S.l]),S.c&&b.push([S.c,T,_]))}var O=l.CodeName||l.name||r;return f?tY(i,b):KR(i,b),f&&Zt(i,574,IH((a.Views||[])[0])),f&&(s["!merges"]||[]).length&&Zt(i,229,qH(s["!merges"])),f&&sY(i,s),Zt(i,442,TR(O)),f&&iY(i,s),Zt(i,10),i.end()}function cY(n,t,e){var i=sr(),r=(n||{}).Workbook||{},s=r.Sheets||[],a=r.WBProps||{},l=e.biff==8,u=e.biff==5;if(Zt(i,2057,uy(n,5,e)),e.bookType=="xla"&&Zt(i,135),Zt(i,225,l?Is(1200):null),Zt(i,193,yH(2)),u&&Zt(i,191),u&&Zt(i,192),Zt(i,226),Zt(i,92,RH("SheetJS",e)),Zt(i,66,Is(l?1200:1252)),l&&Zt(i,353,Is(0)),l&&Zt(i,448),Zt(i,317,JH(n.SheetNames.length)),l&&n.vbaraw&&Zt(i,211),l&&n.vbaraw){var f=a.CodeName||"ThisWorkbook";Zt(i,442,TR(f))}Zt(i,156,Is(17)),Zt(i,25,nr(!1)),Zt(i,18,nr(!1)),Zt(i,19,Is(0)),l&&Zt(i,431,nr(!1)),l&&Zt(i,444,Is(0)),Zt(i,61,LH()),Zt(i,64,nr(!1)),Zt(i,141,Is(0)),Zt(i,34,nr(pq(n)=="true")),Zt(i,14,nr(!0)),l&&Zt(i,439,nr(!1)),Zt(i,218,Is(0)),eY(i,n,e),nY(i,n.SSF,e),rY(i,e),l&&Zt(i,352,nr(!1));var d=i.end(),p=sr();l&&Zt(p,140,KH()),l&&Ls.length&&Zt(p,235,Jq()),l&&e.Strings&&Yq(p,252,kH(e.Strings)),Zt(p,10);var m=p.end(),v=sr(),x=0,_=0;for(_=0;_<n.SheetNames.length;++_)x+=(l?12:11)+(l?2:1)*n.SheetNames[_].length;var b=d.length+x+m.length;for(_=0;_<n.SheetNames.length;++_){var E=s[_]||{};Zt(v,133,NH({pos:b,hs:E.Hidden||0,dt:0,name:n.SheetNames[_]},e)),b+=t[_].length}var T=v.end();if(x!=T.length)throw new Error("BS8 "+x+" != "+T.length);var S=[];return d.length&&S.push(d),T.length&&S.push(T),m.length&&S.push(m),fi(S)}function uY(n,t){var e=t||{},i=[];n&&!n.SSF&&(n.SSF=or(Ln)),n&&n.SSF&&(ov(),av(n.SSF),e.revssf=lv(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),ia=1,Ls=[],e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,py(e),e.cellXfs=[],Ul(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var r=0;r<n.SheetNames.length;++r)i[i.length]=lY(r,e,n);return i.unshift(cY(n,i,e)),fi(i)}function ZR(n,t){for(var e=0;e<=n.SheetNames.length;++e){var i=n.Sheets[n.SheetNames[e]];if(!(!i||!i["!ref"])){var r=Hi(i["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost."),r.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond row 65536.  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return uY(n,t);case 4:case 3:case 2:return Qq(n,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function fY(n,t,e,i){for(var r=n["!merges"]||[],s=[],a={},l=n["!data"]!=null,u=t.s.c;u<=t.e.c;++u){for(var f=0,d=0,p=0;p<r.length;++p)if(!(r[p].s.r>e||r[p].s.c>u)&&!(r[p].e.r<e||r[p].e.c<u)){if(r[p].s.r<e||r[p].s.c<u){f=-1;break}f=r[p].e.r-r[p].s.r+1,d=r[p].e.c-r[p].s.c+1;break}if(!(f<0)){var m=xn(u)+Sn(e),v=l?(n["!data"][e]||[])[u]:n[m];v&&v.t=="n"&&v.v!=null&&!isFinite(v.v)&&(isNaN(v.v)?v={t:"e",v:36,w:Dr[36]}:v={t:"e",v:7,w:Dr[7]});var x=v&&v.v!=null&&(v.h||B_(v.w||(jo(v),v.w)||""))||"";a={},f>1&&(a.rowspan=f),d>1&&(a.colspan=d),i.editable?x='<span contenteditable="true">'+x+"</span>":v&&(a["data-t"]=v&&v.t||"z",v.v!=null&&(a["data-v"]=B_(v.v instanceof Date?v.v.toISOString():v.v)),v.z!=null&&(a["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+B_(v.l.Target)+'">'+x+"</a>")),a.id=(i.id||"sjs")+"-"+m,s.push(se("td",x,a))}}var _="<tr>";return _+s.join("")+"</tr>"}var hY='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',dY="</body></html>";function pY(n,t,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function QR(n,t){var e=t||{},i=e.header!=null?e.header:hY,r=e.footer!=null?e.footer:dY,s=[i],a=Hi(n["!ref"]||"A1");if(s.push(pY(n,a,e)),n["!ref"])for(var l=a.s.r;l<=a.e.r;++l)s.push(fY(n,a,l,e));return s.push("</table>"+r),s.join("")}function JR(n,t,e){var i=t.rows;if(!i)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var r=e||{},s=n["!data"]!=null,a=0,l=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Un(r.origin):r.origin;a=u.r,l=u.c}var f=Math.min(r.sheetRows||1e7,i.length),d={s:{r:0,c:0},e:{r:a,c:l}};if(n["!ref"]){var p=Hi(n["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),a==-1&&(d.e.r=a=p.e.r+1)}var m=[],v=0,x=n["!rows"]||(n["!rows"]=[]),_=0,b=0,E=0,T=0,S=0,O=0;for(n["!cols"]||(n["!cols"]=[]);_<i.length&&b<f;++_){var R=i[_];if(aT(R)){if(r.display)continue;x[b]={hidden:!0}}var N=R.cells;for(E=T=0;E<N.length;++E){var C=N[E];if(!(r.display&&aT(C))){var M=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):N9(C.innerHTML),I=C.getAttribute("data-z")||C.getAttribute("z");for(v=0;v<m.length;++v){var F=m[v];F.s.c==T+l&&F.s.r<b+a&&b+a<=F.e.r&&(T=F.e.c+1-l,v=-1)}O=+C.getAttribute("colspan")||1,((S=+C.getAttribute("rowspan")||1)>1||O>1)&&m.push({s:{r:b+a,c:T+l},e:{r:b+a+(S||1)-1,c:T+l+(O||1)-1}});var z={t:"s",v:M},P=C.getAttribute("data-t")||C.getAttribute("t")||"";M!=null&&(M.length==0?z.t=P||"z":r.raw||M.trim().length==0||P=="s"||(P=="e"&&Dr[+M]?z={t:"e",v:+M,w:Dr[+M]}:M==="TRUE"?z={t:"b",v:!0}:M==="FALSE"?z={t:"b",v:!1}:isNaN(Mo(M))?isNaN(xg(M).getDate())?M.charCodeAt(0)==35&&$a[M]!=null&&(z={t:"e",v:$a[M],w:M}):(z={t:"d",v:Wr(M)},r.UTC&&(z.v=cv(z.v)),r.cellDates||(z={t:"n",v:$i(z.v)}),z.z=r.dateNF||Ln[14]):z={t:"n",v:Mo(M)})),z.z===void 0&&I!=null&&(z.z=I);var tt="",L=C.getElementsByTagName("A");if(L&&L.length)for(var nt=0;nt<L.length&&!(L[nt].hasAttribute("href")&&(tt=L[nt].getAttribute("href"),tt.charAt(0)!="#"));++nt);tt&&tt.charAt(0)!="#"&&tt.slice(0,11).toLowerCase()!="javascript:"&&(z.l={Target:tt}),s?(n["!data"][b+a]||(n["!data"][b+a]=[]),n["!data"][b+a][T+l]=z):n[Vn({c:T+l,r:b+a})]=z,d.e.c<T+l&&(d.e.c=T+l),T+=O}}++b}return m.length&&(n["!merges"]=(n["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,b-1+a),n["!ref"]=di(d),b>=f&&(n["!fullref"]=di((d.e.r=i.length-_+b-1+a,d))),n}function tN(n,t){var e=t||{},i={};return e.dense&&(i["!data"]=[]),JR(i,n,t)}function mY(n,t){var e=Nf(tN(n,t),t);return e}function aT(n){var t="",e=gY(n);return e&&(t=e(n).getPropertyValue("display")),t||(t=n.style&&n.style.display),t==="none"}function gY(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var vY=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Wd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return pi+t}}();function _Y(n,t){var e="number",i="",r={"style:name":t},s="",a=0;n=n.replace(/"[$]"/g,"$");t:{if(n.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+n),n=n.slice(0,n.indexOf(";"))),n=="@"){e="text",i="<number:text-content/>";break t}if(n.indexOf(/\$/)>-1&&(e="currency"),n[a]=='"'){for(s="";n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,n[a+1]=="*"?(a++,i+="<number:fill-character>"+$e(s.replace(/""/g,'"'))+"</number:fill-character>"):i+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>",n=n.slice(a+1),a=0}var l=n.match(/# (\?+)\/(\?+)/);if(l){i+=se("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break t}if(l=n.match(/# (\?+)\/(\d+)/)){i+=se("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break t}if(l=n.match(/\b(\d+)(|\.\d+)%/)){e="percentage",i+=se("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break t}var u=!1;if(["y","m","d"].indexOf(n[0])>-1){e="date";e:for(;a<n.length;++a)switch(s=n[a].toLowerCase()){case"h":case"s":u=!0,--a;break e;case"m":n:for(var f=a+1;f<n.length;++f)switch(n[f]){case"y":case"d":break n;case"h":case"s":u=!0,--a;break e}case"y":case"d":for(;(n[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"y":case"yy":i+="<number:year/>";break;case"yyy":case"yyyy":i+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":i+='<number:month number:style="'+(s.length%2?"short":"long")+'" number:textual="'+(s.length>=3?"true":"false")+'"/>';break;case"d":case"dd":i+='<number:day number:style="'+(s.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":i+='<number:day-of-week number:style="'+(s.length%2?"short":"long")+'"/>';break}break;case'"':for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,i+="<number:text>"+$e(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":s=n[++a],i+="<number:text>"+$e(s)+"</number:text>";break;case"/":case":":i+="<number:text>"+$e(s)+"</number:text>";break;default:console.error("unrecognized character "+s+" in ODF format "+n)}if(!u)break t;n=n.slice(a+1),a=0}if(n.match(/^\[?[hms]/)){for(e=="number"&&(e="time"),n.match(/\[/)&&(n=n.replace(/[\[\]]/g,""),r["number:truncate-on-overflow"]="false");a<n.length;++a)switch(s=n[a].toLowerCase()){case"h":case"m":case"s":for(;(n[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"h":case"hh":i+='<number:hours number:style="'+(s.length%2?"short":"long")+'"/>';break;case"m":case"mm":i+='<number:minutes number:style="'+(s.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(n[a+1]==".")do s+=n[a+1],++a;while(n[a+1]=="0");i+='<number:seconds number:style="'+(s.match("ss")?"long":"short")+'"'+(s.match(/\./)?' number:decimal-places="'+(s.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,i+="<number:text>"+$e(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":i+="<number:text>"+$e(s)+"</number:text>";break;case"a":if(n.slice(a,a+3).toLowerCase()=="a/p"){i+="<number:am-pm/>",a+=2;break}if(n.slice(a,a+5).toLowerCase()=="am/pm"){i+="<number:am-pm/>",a+=4;break}default:console.error("unrecognized character "+s+" in ODF format "+n)}break t}if(n.indexOf(/\$/)>-1&&(e="currency"),n[0]=="$"&&(i+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',n=n.slice(1),a=0),a=0,n[a]=='"'){for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,n[a+1]=="*"?(a++,i+="<number:fill-character>"+$e(s.replace(/""/g,'"'))+"</number:fill-character>"):i+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>",n=n.slice(a+1),a=0}var d=n.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+n);else{var p=d[1].replace(/,/g,"");i+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(p.indexOf("0")==-1?"0":p.length-p.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",a=d.index+d[0].length}if(n[a]=='"'){for(s="";n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,i+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>"}}return i?se("number:"+e+"-style",i,r):(console.error("Could not generate ODS number format for |"+n+"|"),"")}function oT(n,t,e){for(var i=[],r=0;r<n.length;++r){var s=n[r];s&&s.Sheet==(e==-1?null:e)&&i.push(s)}return i.length?`      <table:named-expressions>
`+i.map(function(a){var l=(e==-1?"$":"")+VR(a.Ref);return"        "+se("table:named-range",null,{"table:name":a.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var lT=function(){var n=function(r,s){return $e(r).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=function(r,s,a,l,u,f){var d=[];d.push('      <table:table table:name="'+$e(s.SheetNames[a])+`" table:style-name="ta1">
`);var p=0,m=0,v=Hi(r["!ref"]||"A1"),x=r["!merges"]||[],_=0,b=r["!data"]!=null;if(r["!cols"])for(m=0;m<=v.e.c;++m)d.push("        <table:table-column"+(r["!cols"][m]?' table:style-name="co'+r["!cols"][m].ods+'"':"")+`></table:table-column>
`);var E="",T=r["!rows"]||[];for(p=0;p<v.s.r;++p)E=T[p]?' table:style-name="ro'+T[p].ods+'"':"",d.push("        <table:table-row"+E+`></table:table-row>
`);for(;p<=v.e.r;++p){for(E=T[p]?' table:style-name="ro'+T[p].ods+'"':"",d.push("        <table:table-row"+E+`>
`),m=0;m<v.s.c;++m)d.push(t);for(;m<=v.e.c;++m){var S=!1,O={},R="";for(_=0;_!=x.length;++_)if(!(x[_].s.c>m)&&!(x[_].s.r>p)&&!(x[_].e.c<m)&&!(x[_].e.r<p)){(x[_].s.c!=m||x[_].s.r!=p)&&(S=!0),O["table:number-columns-spanned"]=x[_].e.c-x[_].s.c+1,O["table:number-rows-spanned"]=x[_].e.r-x[_].s.r+1;break}if(S){d.push(`          <table:covered-table-cell/>
`);continue}var N=Vn({r:p,c:m}),C=b?(r["!data"][p]||[])[m]:r[N];if(C&&C.f&&(O["table:formula"]=$e(UV(C.f)),C.F&&C.F.slice(0,N.length)==N)){var M=Hi(C.F);O["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,O["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!C){d.push(t);continue}switch(C.t){case"b":R=C.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=C.v?"true":"false";break;case"n":isFinite(C.v)?(R=C.w||String(C.v||0),O["office:value-type"]="float",O["office:value"]=C.v||0):(isNaN(C.v)?(R="#NUM!",O["table:formula"]="of:=#NUM!"):(R="#DIV/0!",O["table:formula"]="of:="+(C.v<0?"-":"")+"1/0"),O["office:string-value"]="",O["office:value-type"]="string",O["calcext:value-type"]="error");break;case"s":case"str":R=C.v==null?"":C.v,O["office:value-type"]="string";break;case"d":R=C.w||Wr(C.v,f).toISOString(),O["office:value-type"]="date",O["office:date-value"]=Wr(C.v,f).toISOString(),O["table:style-name"]="ce1";break;default:d.push(t);continue}var I=n(R);if(C.l&&C.l.Target){var F=C.l.Target;F=F.charAt(0)=="#"?"#"+VR(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),I=se("text:a",I,{"xlink:href":F.replace(/&/g,"&amp;")})}u[C.z]&&(O["table:style-name"]="ce"+u[C.z].slice(1));var z=se("text:p",I,{});if(C.c){for(var P="",tt="",L={},nt=0;nt<C.c.length;++nt)!P&&C.c[nt].a&&(P=C.c[nt].a),tt+="<text:p>"+n(C.c[nt].t)+"</text:p>";C.c.hidden||(L["office:display"]=!0),z=se("office:annotation",tt,L)+z}d.push("          "+se("table:table-cell",z,O)+`
`)}d.push(`        </table:table-row>
`)}return(s.Workbook||{}).Names&&d.push(oT(s.Workbook.Names,s.SheetNames,a)),d.push(`      </table:table>
`),d.join("")},i=function(r,s){r.push(` <office:automatic-styles>
`);var a=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var m=d["!cols"][p];if(m.width==null&&m.wpx==null&&m.wch==null)continue;fy(m),m.ods=a;var v=d["!cols"][p].wpx+"px";r.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),r.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),r.push(`  </style:style>
`),++a}}});var l=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=l;var m=d["!rows"][p].hpx+"px";r.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),r.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),r.push(`  </style:style>
`),++l}}}),r.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),r.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),r.push(`  </style:style>
`),r.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),r.push(`   <number:month number:style="long"/>
`),r.push(`   <number:text>/</number:text>
`),r.push(`   <number:day number:style="long"/>
`),r.push(`   <number:text>/</number:text>
`),r.push(`   <number:year/>
`),r.push(`  </number:date-style>
`);var u={},f=69;return s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d){var p=d["!data"]!=null;if(d["!ref"])for(var m=Hi(d["!ref"]),v=0;v<=m.e.r;++v)for(var x=0;x<=m.e.c;++x){var _=p?(d["!data"][v]||[])[x]:d[Vn({r:v,c:x})];if(!(!_||!_.z||_.z.toLowerCase()=="general")&&!u[_.z]){var b=_Y(_.z,"N"+f);b&&(u[_.z]="N"+f,++f,r.push(b+`
`))}}}}),r.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),hi(u).forEach(function(d){r.push('<style:style style:name="ce'+u[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+u[d]+`"/>
`)}),r.push(` </office:automatic-styles>
`),u};return function(s,a){var l=[pi],u=Wd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Wd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(_R().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+u+`>
`);var d=i(l,s);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((s.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var p=0;p!=s.SheetNames.length;++p)l.push(e(s.Sheets[s.SheetNames[p]],s,p,a,d,((s.Workbook||{}).WBProps||{}).date1904));return(s.Workbook||{}).Names&&l.push(oT(s.Workbook.Names,s.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function eN(n,t){if(t.bookType=="fods")return lT(n,t);var e=ty(),i="",r=[],s=[];return i="mimetype",He(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",He(e,i,lT(n,t)),r.push([i,"text/xml"]),s.push([i,"ContentFile"]),i="styles.xml",He(e,i,vY(n,t)),r.push([i,"text/xml"]),s.push([i,"StylesFile"]),i="meta.xml",He(e,i,pi+_R()),r.push([i,"text/xml"]),s.push([i,"MetadataFile"]),i="manifest.rdf",He(e,i,gH(s)),r.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",He(e,i,pH(r)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var Ar=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function Tg(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function Kd(n){return typeof TextDecoder<"u"?new TextDecoder().decode(n):tf(Pc(n))}function yr(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):os(Vd(n))}function Ml(n){for(var t=0,e=0;e<n.length;++e)t+=n[e].length;var i=new Uint8Array(t),r=0;for(e=0;e<n.length;++e){var s=n[e],a=s.length;if(a<250)for(var l=0;l<a;++l)i[r++]=s[l];else i.set(s,r),r+=a}return i}function xY(n,t,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-16,r=e/Math.pow(10,i-6176);n[t+15]|=i>>7,n[t+14]|=(i&127)<<1;for(var s=0;r>=1;++s,r/=256)n[t+s]=r&255;n[t+15]|=e>=0?0:128}function Zd(n,t){var e=t.l,i=n[e]&127;t:if(n[e++]>=128&&(i|=(n[e]&127)<<7,n[e++]<128||(i|=(n[e]&127)<<14,n[e++]<128)||(i|=(n[e]&127)<<21,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,28),++e,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,35),++e,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,42),++e,n[e++]<128)))break t;return t.l=e,i}function me(n){var t=new Uint8Array(7);t[0]=n&127;var e=1;t:if(n>127){if(t[e-1]|=128,t[e]=n>>7&127,++e,n<=16383||(t[e-1]|=128,t[e]=n>>14&127,++e,n<=2097151)||(t[e-1]|=128,t[e]=n>>21&127,++e,n<=268435455)||(t[e-1]|=128,t[e]=n/256>>>21&127,++e,n<=34359738367)||(t[e-1]|=128,t[e]=n/65536>>>21&127,++e,n<=4398046511103))break t;t[e-1]|=128,t[e]=n/16777216>>>21&127,++e}return t[Ar](0,e)}function nN(n){for(var t={l:0},e=[];t.l<n.length;)e.push(Zd(n,t));return e}function iN(n){return Ml(n.map(function(t){return me(t)}))}function fs(n){var t=0,e=n[t]&127;return n[t++]<128||(e|=(n[t]&127)<<7,n[t++]<128)||(e|=(n[t]&127)<<14,n[t++]<128)||(e|=(n[t]&127)<<21,n[t++]<128)||(e|=(n[t]&15)<<28),e}function we(n){for(var t=[],e={l:0};e.l<n.length;){var i=e.l,r=Zd(n,e),s=r&7;r=r/8|0;var a,l=e.l;switch(s){case 0:{for(;n[l++]>=128;);a=n[Ar](e.l,l),e.l=l}break;case 1:a=n[Ar](l,l+8),e.l=l+8;break;case 2:{var u=Zd(n,e);a=n[Ar](e.l,e.l+u),e.l+=u}break;case 5:a=n[Ar](l,l+4),e.l=l+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(r," at offset ").concat(i))}var f={data:a,type:s};t[r]==null&&(t[r]=[]),t[r].push(f)}return t}function ge(n){var t=[];return n.forEach(function(e,i){i!=0&&e.forEach(function(r){r.data&&(t.push(me(i*8+r.type)),r.type==2&&t.push(me(r.data.length)),t.push(r.data))})}),Ml(t)}function Cg(n,t){return n?.map(function(e){return t(e.data)})||[]}function Dg(n){for(var t,e=[],i={l:0};i.l<n.length;){var r=Zd(n,i),s=we(n[Ar](i.l,i.l+r));i.l+=r;var a={id:fs(s[1][0].data),messages:[]};s[2].forEach(function(l){var u=we(l.data),f=fs(u[3][0].data);a.messages.push({meta:u,data:n[Ar](i.l,i.l+f)}),i.l+=f}),(t=s[3])!=null&&t[0]&&(a.merge=fs(s[3][0].data)>>>0>0),e.push(a)}return e}function rf(n){var t=[];return n.forEach(function(e){var i=[[],[{data:me(e.id),type:0}],[]];e.merge!=null&&(i[3]=[{data:me(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(a){r.push(a.data),a.meta[3]=[{type:0,data:me(a.data.length)}],i[2].push({data:ge(a.meta),type:2})});var s=ge(i);t.push(me(s.length)),t.push(s),r.forEach(function(a){return t.push(a)})}),Ml(t)}function bY(n,t){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var e={l:0},i=Zd(t,e),r=[],s=e.l;s<t.length;){var a=t[s]&3;if(a==0){var l=t[s++]>>2;if(l<60)++l;else{var u=l-59;l=t[s],u>1&&(l|=t[s+1]<<8),u>2&&(l|=t[s+2]<<16),u>3&&(l|=t[s+3]<<24),l>>>=0,l++,s+=u}r.push(t[Ar](s,s+l)),s+=l;continue}else{var f=0,d=0;if(a==1?(d=(t[s]>>2&7)+4,f=(t[s++]&224)<<3,f|=t[s++]):(d=(t[s++]>>2)+1,a==2?(f=t[s]|t[s+1]<<8,s+=2):(f=(t[s]|t[s+1]<<8|t[s+2]<<16|t[s+3]<<24)>>>0,s+=4)),f==0)throw new Error("Invalid offset 0");for(var p=r.length-1,m=f;p>=0&&m>=r[p].length;)m-=r[p].length,--p;if(p<0)if(m==0)m=r[p=0].length;else throw new Error("Invalid offset beyond length");if(d<m)r.push(r[p][Ar](r[p].length-m,r[p].length-m+d));else{for(m>0&&(r.push(r[p][Ar](r[p].length-m)),d-=m),++p;d>=r[p].length;)r.push(r[p]),d-=r[p].length,++p;d&&r.push(r[p][Ar](0,d))}r.length>25&&(r=[Ml(r)])}}for(var v=0,x=0;x<r.length;++x)v+=r[x].length;if(v!=i)throw new Error("Unexpected length: ".concat(v," != ").concat(i));return r}function Og(n){Array.isArray(n)&&(n=new Uint8Array(n));for(var t=[],e=0;e<n.length;){var i=n[e++],r=n[e]|n[e+1]<<8|n[e+2]<<16;e+=3,t.push.apply(t,bY(i,n[Ar](e,e+r))),e+=r}if(e!==n.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:Ml(t)}function sf(n){for(var t=[],e=0;e<n.length;){var i=Math.min(n.length-e,268435455),r=new Uint8Array(4);t.push(r);var s=me(i),a=s.length;t.push(s),i<=60?(a++,t.push(new Uint8Array([i-1<<2]))):i<=256?(a+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(a+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(a+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(a+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(n[Ar](e,e+i)),a+=i,r[0]=0,r[1]=a&255,r[2]=a>>8&255,r[3]=a>>16&255,e+=i}return Ml(t)}function X_(n,t){var e=new Uint8Array(32),i=Tg(e),r=12,s=0;switch(e[0]=5,n.t){case"n":if(n.z&&Fc(n.z)){e[1]=5,i.setFloat64(r,(Ju(n.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,r+=8;break}else e[1]=2,xY(e,r,n.v),s|=1,r+=16;break;case"b":e[1]=6,i.setFloat64(r,n.v?1:0,!0),s|=2,r+=8;break;case"s":{var a=n.v==null?"":String(n.v);if(n.l){var l=t.rsst.findIndex(function(f){var d;return f.v==a&&f.l==((d=n.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:a,l:n.l.Target}),e[1]=9,i.setUint32(r,l,!0),s|=16,r+=4}else{var u=t.sst.indexOf(a);u==-1&&(t.sst[u=t.sst.length]=a),e[1]=3,i.setUint32(r,u,!0),s|=8,r+=4}}break;case"d":e[1]=5,i.setFloat64(r,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,r+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+n.t}return n.c&&(t.cmnt.push(yY(n.c)),i.setUint32(r,t.cmnt.length-1,!0),s|=524288,r+=4),i.setUint32(8,s,!0),e[Ar](0,r)}function K_(n,t){var e=new Uint8Array(32),i=Tg(e),r=12,s=0,a="";switch(e[0]=4,n.t){case"n":break;case"b":break;case"s":if(a=n.v==null?"":String(n.v),n.l){var l=t.rsst.findIndex(function(f){var d;return f.v==a&&f.l==((d=n.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:a,l:n.l.Target}),e[1]=9,i.setUint32(r,l,!0),s|=512,r+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+n.t}switch(n.c&&(i.setUint32(r,t.cmnt.length-1,!0),s|=4096,r+=4),n.t){case"n":e[1]=2,i.setFloat64(r,n.v,!0),s|=32,r+=8;break;case"b":e[1]=6,i.setFloat64(r,n.v?1:0,!0),s|=32,r+=8;break;case"s":if(a=n.v==null?"":String(n.v),!n.l){var u=t.sst.indexOf(a);u==-1&&(t.sst[u=t.sst.length]=a),e[1]=3,i.setUint32(r,u,!0),s|=16,r+=4}break;case"d":e[1]=5,i.setFloat64(r,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=64,r+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+n.t}return i.setUint32(8,s,!0),e[Ar](0,r)}function ci(n){var t=we(n);return fs(t[1][0].data)}function er(n){return ge([[],[{type:0,data:me(n)}]])}function tr(n,t){var e,i=(e=n.messages[0].meta[5])!=null&&e[0]?nN(n.messages[0].meta[5][0].data):[],r=i.indexOf(t);r==-1&&(i.push(t),n.messages[0].meta[5]=[{type:2,data:iN(i)}])}function Do(n,t){var e,i=(e=n.messages[0].meta[5])!=null&&e[0]?nN(n.messages[0].meta[5][0].data):[];n.messages[0].meta[5]=[{type:2,data:iN(i.filter(function(r){return r!=t}))}]}function yY(n){for(var t={a:"",t:"",replies:[]},e=0;e<n.length;++e)e==0?(t.a=n[e].a,t.t=n[e].t):t.replies.push({a:n[e].a,t:n[e].t});return t}function EY(n,t,e){var i,r,s,a=[[],[{type:0,data:me(0)}],[{type:0,data:me(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:me(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:me(1)}]];if(!((i=a[6])!=null&&i[0])||!((r=a[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(a[7][0].data.length<2*n.length){var u=new Uint8Array(2*n.length);u.set(a[7][0].data),a[7][0].data=u}if(a[4][0].data.length<2*n.length){var f=new Uint8Array(2*n.length);f.set(a[4][0].data),a[4][0].data=f}for(var d=Tg(a[7][0].data),p=0,m=[],v=Tg(a[4][0].data),x=0,_=[],b=4,E=0;E<n.length;++E){if(n[E]==null||n[E].t=="z"&&!((s=n[E].c)!=null&&s.length)||n[E].t=="e"){d.setUint16(E*2,65535,!0),v.setUint16(E*2,65535);continue}d.setUint16(E*2,p/b,!0),v.setUint16(E*2,x/b,!0);var T,S;switch(n[E].t){case"d":if(n[E].v instanceof Date){T=X_(n[E],t),S=K_(n[E],t);break}T=X_(n[E],t),S=K_(n[E],t);break;case"s":case"n":case"b":case"z":T=X_(n[E],t),S=K_(n[E],t);break;default:throw new Error("Unsupported value "+n[E])}m.push(T),p+=T.length,_.push(S),x+=S.length,++l}for(a[2][0].data=me(l),a[5][0].data=me(5);E<a[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),v.setUint16(E*2,65535,!0);return a[6][0].data=Ml(m),a[3][0].data=Ml(_),a[8]=[{type:0,data:me(1)}],a}function Lx(n,t){return{meta:[[],[{type:0,data:me(n)}]],data:t}}function za(n,t){t.last||(t.last=927262);for(var e=t.last;e<2e6;++e)if(!t[e])return t[t.last=e]=n,e;throw new Error("Too many messages")}function wY(n){var t={},e=[];return n.FileIndex.map(function(i,r){return[i,n.FullPaths[r]]}).forEach(function(i){var r=i[0],s=i[1];r.type==2&&r.name.match(/\.iwa/)&&r.content[0]==0&&Dg(Og(r.content)).forEach(function(a){e.push(a.id),t[a.id]={deps:[],location:s,type:fs(a.messages[0].meta[1][0].data)}})}),n.FileIndex.forEach(function(i){i.name.match(/\.iwa/)&&i.content[0]==0&&Dg(Og(i.content)).forEach(function(r){r.messages.forEach(function(s){[5,6].forEach(function(a){s.meta[a]&&s.meta[a].forEach(function(l){t[r.id].deps.push(fs(l.data))})})})})}),t}function Cm(n,t,e){return ge([[],[{type:0,data:me(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([n/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:me(1)}]])}function cT(n){switch(n){case 0:return Cm(99,222,171);case 1:return Cm(162,197,240);case 2:return Cm(255,189,189)}return Cm(Math.random()*255,Math.random()*255,Math.random()*255)}function AY(n,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=Rn.read(t.numbers,{type:"base64"}),i=wY(e),r=ja(e,i,1);if(r==null)throw"Could not find message ".concat(1," in Numbers template");var s=Cg(we(r.messages[0].data)[1],ci);if(s.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return n.SheetNames.forEach(function(a,l){l>=1&&(TY(e,i,l+1),r=ja(e,i,1),s=Cg(we(r.messages[0].data)[1],ci)),CY(e,i,n.Sheets[a],a,l,s[l])}),e}function _n(n,t,e,i){var r=Rn.find(n,t[e].location);if(!r)throw"Could not find ".concat(t[e].location," in Numbers template");var s=Dg(Og(r.content)),a=s.find(function(l){return l.id==e});i(a,s),r.content=sf(rf(s)),r.size=r.content.length}function ja(n,t,e){var i=Rn.find(n,t[e].location);if(!i)throw"Could not find ".concat(t[e].location," in Numbers template");var r=Dg(Og(i.content)),s=r.find(function(a){return a.id==e});return s}function Ix(n,t,e){n[3].push({type:2,data:ge([[],[{type:0,data:me(t)}],[{type:2,data:yr(e.replace(/-[\s\S]*$/,""))}],[{type:2,data:yr(e)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(0)}]])}),n[1]=[{type:0,data:me(Math.max(t+1,fs(n[1][0].data)))}]}function pc(n,t,e,i,r,s){s||(s=za({deps:[],location:"",type:t},r));var a="".concat(i,"-").concat(s,".iwa");r[s].location="Root Entry"+a,Rn.utils.cfb_add(n,a,sf(rf([{id:s,messages:[Lx(t,ge(e))]}])));var l=a.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return _n(n,r,2,function(u){var f=we(u.messages[0].data);Ix(f,s||0,l),u.messages[0].data=ge(f)}),s}function Hr(n,t,e,i){var r=t[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=n[3].findIndex(function(l){var u,f,d=we(l.data);return(u=d[3])!=null&&u[0]?Kd(d[3][0].data)==r:!!((f=d[2])!=null&&f[0]&&Kd(d[2][0].data)==r)}),a=we(n[3][s].data);a[6]||(a[6]=[]),(Array.isArray(i)?i:[i]).forEach(function(l){a[6].push({type:2,data:ge([[],[{type:0,data:me(l)}]])})}),n[3][s].data=ge(a)}function SY(n,t,e,i){var r=t[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=n[3].findIndex(function(l){var u,f,d=we(l.data);return(u=d[3])!=null&&u[0]?Kd(d[3][0].data)==r:!!((f=d[2])!=null&&f[0]&&Kd(d[2][0].data)==r)}),a=we(n[3][s].data);a[6]||(a[6]=[]),a[6]=a[6].filter(function(l){return fs(we(l.data)[1][0].data)!=i}),n[3][s].data=ge(a)}function TY(n,t,e){var i=-1,r=-1,s={};_n(n,t,1,function(u,f){var d=we(u.messages[0].data);i=ci(we(u.messages[0].data)[1][0].data),r=za({deps:[1],location:t[i].location,type:2},t),s[i]=r,tr(u,r),d[1].push({type:2,data:er(r)});var p=ja(n,t,i);p.id=r,t[1].location==t[r].location?f.push(p):_n(n,t,r,function(m,v){return v.push(p)}),u.messages[0].data=ge(d)});var a=-1;_n(n,t,r,function(u,f){for(var d=we(u.messages[0].data),p=3;p<=69;++p)delete d[p];var m=Cg(d[2],ci);m.forEach(function(x){return Do(u,x)}),a=za({deps:[r],location:t[m[0]].location,type:t[m[0]].type},t),tr(u,a),s[m[0]]=a,d[2]=[{type:2,data:er(a)}];var v=ja(n,t,m[0]);v.id=a,t[m[0]].location==t[r].location?f.push(v):(_n(n,t,2,function(x){var _=we(x.messages[0].data);Hr(_,t,r,a),x.messages[0].data=ge(_)}),_n(n,t,a,function(x,_){return _.push(v)})),u.messages[0].data=ge(d)});var l=-1;_n(n,t,a,function(u,f){for(var d=we(u.messages[0].data),p=we(d[1][0].data),m=3;m<=69;++m)delete p[m];var v=ci(p[2][0].data);p[2][0].data=er(s[v]),d[1][0].data=ge(p);var x=ci(d[2][0].data);Do(u,x),l=za({deps:[a],location:t[x].location,type:t[x].type},t),tr(u,l),s[x]=l,d[2][0].data=er(l);var _=ja(n,t,x);_.id=l,t[a].location==t[l].location?f.push(_):_n(n,t,l,function(b,E){return E.push(_)}),u.messages[0].data=ge(d)}),_n(n,t,l,function(u,f){var d,p,m=we(u.messages[0].data),v=Kd(m[1][0].data),x=v.replace(/-[A-Z0-9]*/,"-".concat(("0000"+e.toString(16)).slice(-4)));if(m[1][0].data=yr(x),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(R){return delete m[R]}),m[45]){var _=we(m[45][0].data),b=ci(_[1][0].data);Do(u,b),delete m[45]}if(m[70]){var E=we(m[70][0].data);(d=E[2])==null||d.forEach(function(R){var N=we(R.data);[2,3].map(function(C){return N[C][0]}).forEach(function(C){var M=we(C.data);if(M[8]){var I=ci(M[8][0].data);Do(u,I)}})}),delete m[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(R){if(m[R]){var N=ci(m[R][0].data);delete m[R],Do(u,N)}});var T=we(m[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(R){var N;if((N=T[R])!=null&&N[0]){var C=ci(T[R][0].data),M=za({deps:[l],location:t[C].location,type:t[C].type},t);Do(u,C),tr(u,M),s[C]=M;var I=ja(n,t,C);if(I.id=M,t[C].location==t[l].location)f.push(I);else{t[M].location=t[C].location.replace(C.toString(),M.toString()),t[M].location==t[C].location&&(t[M].location=t[M].location.replace(/\.iwa/,"-".concat(M,".iwa"))),Rn.utils.cfb_add(n,t[M].location,sf(rf([I])));var F=t[M].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");_n(n,t,2,function(z){var P=we(z.messages[0].data);Ix(P,M,F),Hr(P,t,l,M),z.messages[0].data=ge(P)})}T[R][0].data=er(M)}});var S=we(T[1][0].data);(p=S[2])==null||p.forEach(function(R){var N=ci(R.data),C=za({deps:[l],location:t[N].location,type:t[N].type},t);Do(u,N),tr(u,C),s[N]=C;var M=ja(n,t,N);if(M.id=C,t[N].location==t[l].location)f.push(M);else{t[C].location=t[N].location.replace(N.toString(),C.toString()),t[C].location==t[N].location&&(t[C].location=t[C].location.replace(/\.iwa/,"-".concat(C,".iwa"))),Rn.utils.cfb_add(n,t[C].location,sf(rf([M])));var I=t[C].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");_n(n,t,2,function(F){var z=we(F.messages[0].data);Ix(z,C,I),Hr(z,t,l,C),F.messages[0].data=ge(z)})}R.data=er(C)}),T[1][0].data=ge(S);var O=we(T[3][0].data);O[1].forEach(function(R){var N=we(R.data),C=ci(N[2][0].data),M=s[C];if(!s[C]){M=za({deps:[l],location:"",type:t[C].type},t),t[M].location="Root Entry/Index/Tables/Tile-".concat(M,".iwa"),s[C]=M;var I=ja(n,t,C);I.id=M,Do(u,C),tr(u,M),Rn.utils.cfb_add(n,"/Index/Tables/Tile-".concat(M,".iwa"),sf(rf([I]))),_n(n,t,2,function(F){var z=we(F.messages[0].data);z[3].push({type:2,data:ge([[],[{type:0,data:me(M)}],[{type:2,data:yr("Tables/Tile")}],[{type:2,data:yr("Tables/Tile-".concat(M))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(0)}]])}),z[1]=[{type:0,data:me(Math.max(M+1,fs(z[1][0].data)))}],Hr(z,t,l,M),F.messages[0].data=ge(z)})}N[2][0].data=er(M),R.data=ge(N)}),T[3][0].data=ge(O)}m[4][0].data=ge(T),u.messages[0].data=ge(m)})}function CY(n,t,e,i,r,s){var a=[];_n(n,t,s,function(f){var d=we(f.messages[0].data);d[1]=[{type:2,data:yr(i)}],a=Cg(d[2],ci),f.messages[0].data=ge(d)});var l=ja(n,t,a[0]),u=ci(we(l.messages[0].data)[2][0].data);_n(n,t,u,function(f,d){return DY(n,t,e,f,d,u)})}function DY(n,t,e,i,r,s){if(!e["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var a=Hi(e["!ref"]);a.s.r=a.s.c=0;var l=!1;a.e.c>999&&(l=!0,a.e.c=999),a.e.r>999999&&(l=!0,a.e.r=999999),l&&console.error("Truncating to ".concat(di(a)));var u=[];if(e["!data"])u=e["!data"];else{for(var f=[],d=0;d<=a.e.c;++d)f[d]=xn(d);for(var p=0;p<=a.e.r;++p){u[p]=[];var m=""+(p+1);for(d=0;d<=a.e.c;++d){var v=e[f[d]+m];v&&(u[p][d]=v)}}}var x={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},_=we(i.messages[0].data);{_[6][0].data=me(a.e.r+1),_[7][0].data=me(a.e.c+1),delete _[46];var b=we(_[4][0].data);{var E=ci(we(b[1][0].data)[2][0].data);_n(n,t,E,function(G,ut){var gt,_t=we(G.messages[0].data);if((gt=_t?.[2])!=null&&gt[0])for(var Bt=0;Bt<u.length;++Bt){var Gt=we(_t[2][0].data);Gt[1][0].data=me(Bt),Gt[4][0].data=me(u[Bt].length),_t[2][Bt]={type:_t[2][0].type,data:ge(Gt)}}G.messages[0].data=ge(_t)});var T=ci(b[2][0].data);_n(n,t,T,function(G,ut){for(var gt=we(G.messages[0].data),_t=0;_t<=a.e.c;++_t){var Bt=we(gt[2][0].data);Bt[1][0].data=me(_t),Bt[4][0].data=me(a.e.r+1),gt[2][_t]={type:gt[2][0].type,data:ge(Bt)}}G.messages[0].data=ge(gt)});var S=we(b[9][0].data);S[1]=[];var O=we(b[3][0].data);{var R=256;O[2]=[{type:0,data:me(R)}];var N=ci(we(O[1][0].data)[2][0].data),C=function(){var G=ja(n,t,2),ut=we(G.messages[0].data),gt=ut[3].filter(function(_t){return fs(we(_t.data)[1][0].data)==N});return gt?.length?fs(we(gt[0].data)[12][0].data):0}();Rn.utils.cfb_del(n,t[N].location),_n(n,t,2,function(G){var ut=we(G.messages[0].data);ut[3]=ut[3].filter(function(gt){return fs(we(gt.data)[1][0].data)!=N}),SY(ut,t,s,N),G.messages[0].data=ge(ut)}),Do(i,N),O[1]=[];for(var M=Math.ceil((a.e.r+1)/R),I=0;I<M;++I){var F=za({deps:[],location:"",type:6002},t);t[F].location="Root Entry/Index/Tables/Tile-".concat(F,".iwa");for(var z=[[],[{type:0,data:me(0)}],[{type:0,data:me(Math.min(a.e.r+1,(I+1)*R))}],[{type:0,data:me(0)}],[{type:0,data:me(Math.min((I+1)*R,a.e.r+1)-I*R)}],[],[{type:0,data:me(5)}],[{type:0,data:me(1)}],[{type:0,data:me(1)}]],P=I*R;P<=Math.min(a.e.r,(I+1)*R-1);++P){var tt=EY(u[P],x);tt[1][0].data=me(P-I*R),z[5].push({data:ge(tt),type:2})}O[1].push({type:2,data:ge([[],[{type:0,data:me(I)}],[{type:2,data:er(F)}]])});var L={id:F,messages:[Lx(6002,ge(z))]},nt=sf(rf([L]));Rn.utils.cfb_add(n,"/Index/Tables/Tile-".concat(F,".iwa"),nt),_n(n,t,2,function(G){var ut=we(G.messages[0].data);ut[3].push({type:2,data:ge([[],[{type:0,data:me(F)}],[{type:2,data:yr("Tables/Tile")}],[{type:2,data:yr("Tables/Tile-".concat(F))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(C)}]])}),ut[1]=[{type:0,data:me(Math.max(F+1,fs(ut[1][0].data)))}],Hr(ut,t,s,F),G.messages[0].data=ge(ut)}),tr(i,F),S[1].push({type:2,data:ge([[],[{type:0,data:me(I*R)}],[{type:0,data:me(I)}]])})}}if(b[3][0].data=ge(O),b[9][0].data=ge(S),b[10]=[{type:2,data:new Uint8Array([])}],e["!merges"]){var Q=za({type:6144,deps:[s],location:t[s].location},t);r.push({id:Q,messages:[Lx(6144,ge([[],e["!merges"].map(function(G){return{type:2,data:ge([[],[{type:2,data:ge([[],[{type:5,data:new Uint8Array(new Uint16Array([G.s.r,G.s.c]).buffer)}]])}],[{type:2,data:ge([[],[{type:5,data:new Uint8Array(new Uint16Array([G.e.r-G.s.r+1,G.e.c-G.s.c+1]).buffer)}]])}]])}})]))]}),b[13]=[{type:2,data:er(Q)}],_n(n,t,2,function(G){var ut=we(G.messages[0].data);Hr(ut,t,s,Q),G.messages[0].data=ge(ut)}),tr(i,Q)}else delete b[13];var X=ci(b[4][0].data);_n(n,t,X,function(G){var ut=we(G.messages[0].data);ut[3]=[],x.sst.forEach(function(gt,_t){_t!=0&&ut[3].push({type:2,data:ge([[],[{type:0,data:me(_t)}],[{type:0,data:me(1)}],[{type:2,data:yr(gt)}]])})}),G.messages[0].data=ge(ut)});var Rt=ci(b[17][0].data);if(_n(n,t,Rt,function(G){var ut=we(G.messages[0].data);ut[3]=[];var gt=[904980,903835,903815,903845];x.rsst.forEach(function(_t,Bt){if(Bt!=0){var Gt=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:yr(_t.v)}]];Gt[10]=[{type:0,data:new Uint8Array([1])}],Gt[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Gt[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Gt[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Gt[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Gt[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Gt[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Gt[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Gt[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var H=za({deps:[],location:"",type:2001},t),mt=[];if(_t.l){var lt=pc(n,2032,[[],[],[{type:2,data:yr(_t.l)}]],"/Index/Tables/DataList",t);Gt[11]=[];var ct=[[],[]];ct[1]||(ct[1]=[]),ct[1].push({type:2,data:ge([[],[{type:0,data:me(0)}],[{type:2,data:er(lt)}]])}),Gt[11][0]={type:2,data:ge(ct)},mt.push(lt)}pc(n,2001,Gt,"/Index/Tables/DataList",t,H),_n(n,t,H,function(Lt){gt.forEach(function(D){return tr(Lt,D)}),mt.forEach(function(D){return tr(Lt,D)})});var Ct=pc(n,6218,[[],[{type:2,data:er(H)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);_n(n,t,Ct,function(Lt){return tr(Lt,H)}),ut[3].push({type:2,data:ge([[],[{type:0,data:me(Bt)}],[{type:0,data:me(1)}],[],[],[],[],[],[],[{type:2,data:er(Ct)}]])}),tr(G,Ct),_n(n,t,2,function(Lt){var D=we(Lt.messages[0].data);Hr(D,t,Rt,Ct),Hr(D,t,Ct,H),Hr(D,t,H,mt),Hr(D,t,H,gt),Lt.messages[0].data=ge(D)})}}),G.messages[0].data=ge(ut)}),x.cmnt.length>1){var yt=ci(b[19][0].data),j={},J=0;_n(n,t,yt,function(G){var ut=we(G.messages[0].data);ut[3]=[],x.cmnt.forEach(function(gt,_t){if(_t!=0){var Bt=[];gt.replies&&gt.replies.forEach(function(mt){j[mt.a||""]||(j[mt.a||""]=pc(n,212,[[],[{type:2,data:yr(mt.a||"")}],[{type:2,data:cT(++J)}],[],[{type:0,data:me(0)}]],"/Index/Tables/DataList",t));var lt=j[mt.a||""],ct=pc(n,3056,[[],[{type:2,data:yr(mt.t||"")}],[{type:2,data:ge([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:er(lt)}]],"/Index/Tables/DataList",t);_n(n,t,ct,function(Ct){return tr(Ct,lt)}),Bt.push(ct),_n(n,t,2,function(Ct){var Lt=we(Ct.messages[0].data);Hr(Lt,t,ct,lt),Ct.messages[0].data=ge(Lt)})}),j[gt.a||""]||(j[gt.a||""]=pc(n,212,[[],[{type:2,data:yr(gt.a||"")}],[{type:2,data:cT(++J)}],[],[{type:0,data:me(0)}]],"/Index/Tables/DataList",t));var Gt=j[gt.a||""],H=pc(n,3056,[[],[{type:2,data:yr(gt.t||"")}],[{type:2,data:ge([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:er(Gt)}],Bt.map(function(mt){return{type:2,data:er(mt)}}),[{type:2,data:ge([[],[{type:0,data:me(_t)}],[{type:0,data:me(0)}]])}]],"/Index/Tables/DataList",t);_n(n,t,H,function(mt){tr(mt,Gt),Bt.forEach(function(lt){return tr(mt,lt)})}),ut[3].push({type:2,data:ge([[],[{type:0,data:me(_t)}],[{type:0,data:me(1)}],[],[],[],[],[],[],[],[{type:2,data:er(H)}]])}),tr(G,H),_n(n,t,2,function(mt){var lt=we(mt.messages[0].data);Hr(lt,t,yt,H),Hr(lt,t,H,Gt),Bt.length&&Hr(lt,t,H,Bt),mt.messages[0].data=ge(lt)})}}),ut[2][0].data=me(x.cmnt.length+1),G.messages[0].data=ge(ut)})}}_[4][0].data=ge(b)}i.messages[0].data=ge(_)}function OY(n){return function(e){for(var i=0;i!=n.length;++i){var r=n[i];e[r[0]]===void 0&&(e[r[0]]=r[1]),r[2]==="n"&&(e[r[0]]=Number(e[r[0]]))}}}function py(n){OY([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function RY(n,t){n&&!n.SSF&&(n.SSF=or(Ln)),n&&n.SSF&&(ov(),av(n.SSF),t.revssf=lv(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Dd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="bin",i=!0,r=mR();py(t=t||{});var s=ty(),a="",l=0;if(t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",He(s,a,xR(n.Props,t)),r.coreprops.push(a),un(t.rels,2,a,en.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var u=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(n.SheetNames[f]);n.Props.SheetNames=u}n.Props.Worksheets=n.Props.SheetNames.length,He(s,a,yR(n.Props)),r.extprops.push(a),un(t.rels,3,a,en.EXT_PROPS),n.Custprops!==n.Props&&hi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",He(s,a,ER(n.Custprops)),r.custprops.push(a),un(t.rels,4,a,en.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=n.SheetNames.length;++l){var p={"!id":{}},m=n.Sheets[n.SheetNames[l-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:a="xl/worksheets/sheet"+l+"."+e,He(s,a,fq(l-1,t,n,p)),r.sheets.push(a),un(t.wbrels,-1,"worksheets/sheet"+l+"."+e,en.WS[0])}if(m){var x=m["!comments"],_=!1,b="";if(x&&x.length>0){var E=!1;x.forEach(function(S){S[1].forEach(function(O){O.T==!0&&(E=!0)})}),E&&(b="xl/threadedComments/threadedComment"+l+".xml",He(s,b,PR(x,d,t)),r.threadedcomments.push(b),un(p,-1,"../threadedComments/threadedComment"+l+".xml",en.TCMNT)),b="xl/comments"+l+"."+e,He(s,b,eG(x)),r.comments.push(b),un(p,-1,"../comments"+l+"."+e,en.CMNT),_=!0}m["!legacy"]&&_&&He(s,"xl/drawings/vmlDrawing"+l+".vml",MR(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&He(s,vR(a),ef(p))}t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,He(s,a,f$(t.Strings)),r.strs.push(a),un(t.wbrels,-1,"sharedStrings."+e,en.SST)),a="xl/workbook."+e,He(s,a,kq(n)),r.workbooks.push(a),un(t.rels,1,a,en.WB),a="xl/theme/theme1.xml";var T=IR(n.Themes,t);return He(s,a,T),r.themes.push(a),un(t.wbrels,-1,"theme/theme1.xml",en.THEME),a="xl/styles."+e,He(s,a,U$(n,t)),r.styles.push(a),un(t.wbrels,-1,"styles."+e,en.STY),n.vbaraw&&i&&(a="xl/vbaProject.bin",He(s,a,n.vbaraw),r.vba.push(a),un(t.wbrels,-1,"vbaProject.bin",en.VBA)),a="xl/metadata."+e,He(s,a,q$()),r.metadata.push(a),un(t.wbrels,-1,"metadata."+e,en.XLMETA),d.length>1&&(a="xl/persons/person.xml",He(s,a,FR(d)),r.people.push(a),un(t.wbrels,-1,"persons/person.xml",en.PEOPLE)),He(s,"[Content_Types].xml",gR(r,t)),He(s,"_rels/.rels",ef(t.rels)),He(s,"xl/_rels/workbook."+e+".rels",ef(t.wbrels)),delete t.revssf,delete t.ssf,s}function NY(n,t){n&&!n.SSF&&(n.SSF=or(Ln)),n&&n.SSF&&(ov(),av(n.SSF),t.revssf=lv(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Dd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",i=iG.indexOf(t.bookType)>-1,r=mR();py(t=t||{});var s=ty(),a="",l=0;if(t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",He(s,a,xR(n.Props,t)),r.coreprops.push(a),un(t.rels,2,a,en.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var u=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(n.SheetNames[f]);n.Props.SheetNames=u}n.Props.Worksheets=n.Props.SheetNames.length,He(s,a,yR(n.Props)),r.extprops.push(a),un(t.rels,3,a,en.EXT_PROPS),n.Custprops!==n.Props&&hi(n.Custprops||{}).length>0&&(a="docProps/custom.xml",He(s,a,ER(n.Custprops)),r.custprops.push(a),un(t.rels,4,a,en.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=n.SheetNames.length;++l){var p={"!id":{}},m=n.Sheets[n.SheetNames[l-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:a="xl/worksheets/sheet"+l+"."+e,He(s,a,QV(l-1,t,n,p)),r.sheets.push(a),un(t.wbrels,-1,"worksheets/sheet"+l+"."+e,en.WS[0])}if(m){var x=m["!comments"],_=!1,b="";if(x&&x.length>0){var E=!1;x.forEach(function(T){T[1].forEach(function(S){S.T==!0&&(E=!0)})}),E&&(b="xl/threadedComments/threadedComment"+l+".xml",He(s,b,PR(x,d,t)),r.threadedcomments.push(b),un(p,-1,"../threadedComments/threadedComment"+l+".xml",en.TCMNT)),b="xl/comments"+l+"."+e,He(s,b,Z$(x)),r.comments.push(b),un(p,-1,"../comments"+l+"."+e,en.CMNT),_=!0}m["!legacy"]&&_&&He(s,"xl/drawings/vmlDrawing"+l+".vml",MR(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&He(s,vR(a),ef(p))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,He(s,a,o$(t.Strings,t)),r.strs.push(a),un(t.wbrels,-1,"sharedStrings."+e,en.SST)),a="xl/workbook."+e,He(s,a,_q(n)),r.workbooks.push(a),un(t.rels,1,a,en.WB),a="xl/theme/theme1.xml",He(s,a,IR(n.Themes,t)),r.themes.push(a),un(t.wbrels,-1,"theme/theme1.xml",en.THEME),a="xl/styles."+e,He(s,a,_$(n,t)),r.styles.push(a),un(t.wbrels,-1,"styles."+e,en.STY),n.vbaraw&&i&&(a="xl/vbaProject.bin",He(s,a,n.vbaraw),r.vba.push(a),un(t.wbrels,-1,"vbaProject.bin",en.VBA)),a="xl/metadata."+e,He(s,a,Y$()),r.metadata.push(a),un(t.wbrels,-1,"metadata."+e,en.XLMETA),d.length>1&&(a="xl/persons/person.xml",He(s,a,FR(d)),r.people.push(a),un(t.wbrels,-1,"persons/person.xml",en.PEOPLE)),He(s,"[Content_Types].xml",gR(r,t)),He(s,"_rels/.rels",ef(t.rels)),He(s,"xl/_rels/workbook."+e+".rels",ef(t.wbrels)),delete t.revssf,delete t.ssf,s}function kY(n,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":e=Ll(n.slice(0,12));break;case"binary":e=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function rN(n,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return mp(t.file,Rn.write(n,{type:fn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Rn.write(n,t)}function LY(n,t){switch(t.bookType){case"ods":return eN(n,t);case"numbers":return AY(n,t);case"xlsb":return RY(n,t);default:return NY(n,t)}}function IY(n,t){var e=or(t||{}),i=LY(n,e);return MY(i,e)}function MY(n,t){var e={},i=fn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=i;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var r=n.FullPaths?Rn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):n.generate(e);if(typeof Deno<"u"&&typeof r=="string"){if(t.type=="binary"||t.type=="base64")return r;r=new Uint8Array(sv(r))}return t.password&&typeof encrypt_agile<"u"?rN(encrypt_agile(r,t.password),t):t.type==="file"?mp(t.file,r):t.type=="string"?tf(r):r}function PY(n,t){var e=t||{},i=Wq(n,e);return rN(i,e)}function Pa(n,t,e){e||(e="");var i=e+n;switch(t.type){case"base64":return dg(Vd(i));case"binary":return Vd(i);case"string":return n;case"file":return mp(t.file,i,"utf8");case"buffer":return fn?Ya(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Pa(i,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function FY(n,t){switch(t.type){case"base64":return Fj(n);case"binary":return n;case"string":return n;case"file":return mp(t.file,n,"binary");case"buffer":return fn?Ya(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dm(n,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",i=0;i<n.length;++i)e+=String.fromCharCode(n[i]);return t.type=="base64"?dg(e):t.type=="string"?tf(e):e;case"file":return mp(t.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+t.type)}}function sN(n,t){Pj(),vq(n);var e=or(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=sN(n,e);return e.type="array",sv(i)}var r=0;if(e.sheet&&(typeof e.sheet=="number"?r=e.sheet:r=n.SheetNames.indexOf(e.sheet),!n.SheetNames[r]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Pa(Gq(n,e),e);case"slk":case"sylk":return Pa(i$.from_sheet(n.Sheets[n.SheetNames[r]],e,n),e);case"htm":case"html":return Pa(QR(n.Sheets[n.SheetNames[r]],e),e);case"txt":return FY(aN(n.Sheets[n.SheetNames[r]],e),e);case"csv":return Pa(my(n.Sheets[n.SheetNames[r]],e),e,"\uFEFF");case"dif":return Pa(r$.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"dbf":return Dm(n$.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"prn":return Pa(s$.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"rtf":return Pa(d$(n.Sheets[n.SheetNames[r]]),e);case"eth":return Pa(OR.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"fods":return Pa(eN(n,e),e);case"wk1":return Dm(ZS.sheet_to_wk1(n.Sheets[n.SheetNames[r]],e),e);case"wk3":return Dm(ZS.book_to_wk3(n,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),Dm(ZR(n,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),PY(n,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return IY(n,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function BY(n){if(!n.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(n.bookType=e.slice(1)),n.bookType=t[n.bookType]||n.bookType}}function UY(n,t,e){var i=e||{};return i.type="file",i.file=t,BY(i),sN(n,i)}function zY(n,t,e,i,r,s,a){var l=Sn(e),u=a.defval,f=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,p=n["!data"]!=null,m=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:e,enumerable:!1})}catch{m.__rowNum__=e}else m.__rowNum__=e;if(!p||n["!data"][e])for(var v=t.s.c;v<=t.e.c;++v){var x=p?(n["!data"][e]||[])[v]:n[i[v]+l];if(x==null||x.t===void 0){if(u===void 0)continue;s[v]!=null&&(m[s[v]]=u);continue}var _=x.v;switch(x.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"b":case"n":if(!x.z||!Fc(x.z)||(_=Ju(_),typeof _=="number"))break;case"d":a&&(a.UTC||a.raw===!1)||(_=xf(new Date(_)));break;default:throw new Error("unrecognized type "+x.t)}if(s[v]!=null){if(_==null)if(x.t=="e"&&_===null)m[s[v]]=null;else if(u!==void 0)m[s[v]]=u;else if(f&&_===null)m[s[v]]=null;else continue;else m[s[v]]=(x.t==="n"&&typeof a.rawNumbers=="boolean"?a.rawNumbers:f)?_:jo(x,_,a);_!=null&&(d=!1)}}return{row:m,isempty:d}}function Mx(n,t){if(n==null||n["!ref"]==null)return[];var e={t:"n",v:0},i=0,r=1,s=[],a=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:n["!ref"];switch(f.header===1?i=1:f.header==="A"?i=2:Array.isArray(f.header)?i=3:f.header==null&&(i=0),typeof d){case"string":u=In(d);break;case"number":u=In(n["!ref"]),u.s.r=d;break;default:u=d}i>0&&(r=0);var p=Sn(u.s.r),m=[],v=[],x=0,_=0,b=n["!data"]!=null,E=u.s.r,T=0,S={};b&&!n["!data"][E]&&(n["!data"][E]=[]);var O=f.skipHidden&&n["!cols"]||[],R=f.skipHidden&&n["!rows"]||[];for(T=u.s.c;T<=u.e.c;++T)if(!(O[T]||{}).hidden)switch(m[T]=xn(T),e=b?n["!data"][E][T]:n[m[T]+p],i){case 1:s[T]=T-u.s.c;break;case 2:s[T]=m[T];break;case 3:s[T]=f.header[T-u.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=a=jo(e,null,f),_=S[a]||0,!_)S[a]=1;else{do l=a+"_"+_++;while(S[l]);S[a]=_,S[l]=1}s[T]=l}for(E=u.s.r+r;E<=u.e.r;++E)if(!(R[E]||{}).hidden){var N=zY(n,u,E,m,i,s,f);(N.isempty===!1||(i===1?f.blankrows!==!1:f.blankrows))&&(v[x++]=N.row)}return v.length=x,v}var uT=/"/g;function jY(n,t,e,i,r,s,a,l,u){for(var f=!0,d=[],p="",m=Sn(e),v=n["!data"]!=null,x=v&&n["!data"][e]||[],_=t.s.c;_<=t.e.c;++_)if(i[_]){var b=v?x[_]:n[i[_]+m];if(b==null)p="";else if(b.v!=null){f=!1,p=""+(u.rawNumbers&&b.t=="n"?b.v:jo(b,null,u));for(var E=0,T=0;E!==p.length;++E)if((T=p.charCodeAt(E))===r||T===s||T===34||u.forceQuotes){p='"'+p.replace(uT,'""')+'"';break}p=="ID"&&l==0&&d.length==0&&(p='"ID"')}else b.f!=null&&!b.F?(f=!1,p="="+b.f,p.indexOf(",")>=0&&(p='"'+p.replace(uT,'""')+'"')):p="";d.push(p)}if(u.strip)for(;d[d.length-1]==="";)--d.length;return u.blankrows===!1&&f?null:d.join(a)}function my(n,t){var e=[],i=t??{};if(n==null||n["!ref"]==null)return"";for(var r=In(n["!ref"]),s=i.FS!==void 0?i.FS:",",a=s.charCodeAt(0),l=i.RS!==void 0?i.RS:`
`,u=l.charCodeAt(0),f="",d=[],p=i.skipHidden&&n["!cols"]||[],m=i.skipHidden&&n["!rows"]||[],v=r.s.c;v<=r.e.c;++v)(p[v]||{}).hidden||(d[v]=xn(v));for(var x=0,_=r.s.r;_<=r.e.r;++_)(m[_]||{}).hidden||(f=jY(n,r,_,d,a,u,s,x,i),f!=null&&(f||i.blankrows!==!1)&&e.push((x++?l:"")+f));return e.join("")}function aN(n,t){t||(t={}),t.FS="	",t.RS=`
`;var e=my(n,t);return e}function HY(n,t){var e="",i,r="";if(n==null||n["!ref"]==null)return[];var s=In(n["!ref"]),a="",l=[],u,f=[],d=n["!data"]!=null;for(u=s.s.c;u<=s.e.c;++u)l[u]=xn(u);for(var p=s.s.r;p<=s.e.r;++p)for(a=Sn(p),u=s.s.c;u<=s.e.c;++u)if(e=l[u]+a,i=d?(n["!data"][p]||[])[u]:n[e],r="",i!==void 0){if(i.F!=null){if(e=i.F,!i.f)continue;r=i.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(i.f!=null)r=i.f;else{if(t&&t.values===!1)continue;if(i.t=="z")continue;if(i.t=="n"&&i.v!=null)r=""+i.v;else if(i.t=="b")r=i.v?"TRUE":"FALSE";else if(i.w!==void 0)r="'"+i.w;else{if(i.v===void 0)continue;i.t=="s"?r="'"+i.v:r=""+i.v}}f[f.length]=e+"="+r}return f}function oN(n,t,e){var i=e||{},r=n?n["!data"]!=null:i.dense,s=+!i.skipHeader,a=n||{};!n&&r&&(a["!data"]=[]);var l=0,u=0;if(a&&i.origin!=null)if(typeof i.origin=="number")l=i.origin;else{var f=typeof i.origin=="string"?Un(i.origin):i.origin;l=f.r,u=f.c}var d={s:{c:0,r:0},e:{c:u,r:l+t.length-1+s}};if(a["!ref"]){var p=In(a["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),l==-1&&(l=p.e.r+1,d.e.r=l+t.length-1+s)}else l==-1&&(l=0,d.e.r=t.length-1+s);var m=i.header||[],v=0,x=[];t.forEach(function(b,E){r&&!a["!data"][l+E+s]&&(a["!data"][l+E+s]=[]),r&&(x=a["!data"][l+E+s]),hi(b).forEach(function(T){(v=m.indexOf(T))==-1&&(m[v=m.length]=T);var S=b[T],O="z",R="",N=r?"":xn(u+v)+Sn(l+E+s),C=r?x[u+v]:a[N];S&&typeof S=="object"&&!(S instanceof Date)?r?x[u+v]=S:a[N]=S:(typeof S=="number"?O="n":typeof S=="boolean"?O="b":typeof S=="string"?O="s":S instanceof Date?(O="d",i.UTC||(S=cv(S)),i.cellDates||(O="n",S=$i(S)),R=C!=null&&C.z&&Fc(C.z)?C.z:i.dateNF||Ln[14]):S===null&&i.nullError&&(O="e",S=0),C?(C.t=O,C.v=S,delete C.w,delete C.R,R&&(C.z=R)):r?x[u+v]=C={t:O,v:S}:a[N]=C={t:O,v:S},R&&(C.z=R))})}),d.e.c=Math.max(d.e.c,u+m.length-1);var _=Sn(l);if(r&&!a["!data"][l]&&(a["!data"][l]=[]),s)for(v=0;v<m.length;++v)r?a["!data"][l][v+u]={t:"s",v:m[v]}:a[xn(v+u)+_]={t:"s",v:m[v]};return a["!ref"]=di(d),a}function $Y(n,t){return oN(null,n,t)}function Rg(n,t,e){if(typeof t=="string"){if(n["!data"]!=null){var i=Un(t);return n["!data"][i.r]||(n["!data"][i.r]=[]),n["!data"][i.r][i.c]||(n["!data"][i.r][i.c]={t:"z"})}return n[t]||(n[t]={t:"z"})}return typeof t!="number"?Rg(n,Vn(t)):Rg(n,xn(e||0)+Sn(t))}function GY(n,t){if(typeof t=="number"){if(t>=0&&n.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=n.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function VY(n,t){var e={SheetNames:[],Sheets:{}};return n&&gy(e,n,t||"Sheet1"),e}function gy(n,t,e,i){var r=1;if(!e)for(;r<=65535&&n.SheetNames.indexOf(e="Sheet"+r)!=-1;++r,e=void 0);if(!e||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&n.SheetNames.indexOf(e)>=0&&e.length<32){var s=e.match(/\d+$/);r=s&&+s[0]||0;var a=s&&e.slice(0,s.index)||e;for(++r;r<=65535&&n.SheetNames.indexOf(e=a+r)!=-1;++r);}if(YR(e),n.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return n.SheetNames.push(e),n.Sheets[e]=t,e}function WY(n,t,e){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var i=GY(n,t);switch(n.Workbook.Sheets[i]||(n.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}n.Workbook.Sheets[i].Hidden=e}function qY(n,t){return n.z=t,n}function lN(n,t,e){return t?(n.l={Target:t},e&&(n.l.Tooltip=e)):delete n.l,n}function YY(n,t,e){return lN(n,"#"+t,e)}function XY(n,t,e){n.c||(n.c=[]),n.c.push({t,a:e||"SheetJS"})}function KY(n,t,e,i){for(var r=typeof t!="string"?t:In(t),s=typeof t=="string"?t:di(t),a=r.s.r;a<=r.e.r;++a)for(var l=r.s.c;l<=r.e.c;++l){var u=Rg(n,a,l);u.t="n",u.F=s,delete u.v,a==r.s.r&&l==r.s.c&&(u.f=e,i&&(u.D=!0))}var f=Hi(n["!ref"]);return f.s.r>r.s.r&&(f.s.r=r.s.r),f.s.c>r.s.c&&(f.s.c=r.s.c),f.e.r<r.e.r&&(f.e.r=r.e.r),f.e.c<r.e.c&&(f.e.c=r.e.c),n["!ref"]=di(f),n}var Z_={encode_col:xn,encode_row:Sn,encode_cell:Vn,encode_range:di,decode_col:ay,decode_row:sy,split_cell:V9,decode_cell:Un,decode_range:Hi,format_cell:jo,sheet_new:W9,sheet_add_aoa:uR,sheet_add_json:oN,sheet_add_dom:JR,aoa_to_sheet:kf,json_to_sheet:$Y,table_to_sheet:tN,table_to_book:mY,sheet_to_csv:my,sheet_to_txt:aN,sheet_to_json:Mx,sheet_to_html:QR,sheet_to_formulae:HY,sheet_to_row_object_array:Mx,sheet_get_cell:Rg,book_new:VY,book_append_sheet:gy,book_set_sheet_visibility:WY,cell_set_number_format:qY,cell_set_hyperlink:lN,cell_set_internal_link:YY,cell_add_comment:XY,sheet_set_array_formula:KY,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ZY=(n,t)=>{const e=Tf(t),i=[];return n.forEach(r=>{const s=Gr(r,e,"date"),a=Gr(r,e,"campaign");i.push({"HOLE ID":Gr(r,e,"hole_id"),X:oa(Gr(r,e,"x")),Y:oa(Gr(r,e,"y")),Z:oa(Gr(r,e,"z")),DEPTH:Zg(r,e),...s&&{DATA:s},...a&&{CAMPANHA:a}})}),i},QY=(n,t)=>{const e=Tf(t),i=[];return n.forEach(r=>{const s=Gr(r,e,"hole_id"),a=No(r,e,"nspt"),l=Zg(r,e),u=Math.ceil(l)-a.length+1;let f=0;a.forEach((d,p)=>{const m=p===0?u:p===a.length-1?l:f+1;i.push({"HOLE ID":s,from:f,to:m,NSPT:d}),f=m})}),i},JY=(n,t)=>{const e=Tf(t),i=[];return n.forEach(r=>{const s=Gr(r,e,"hole_id"),a=Zg(r,e),l=Gr(r,e,"water_level"),u=oa(l,-1);typeof u=="number"&&u>=0?u!==0?i.push({"HOLE ID":s,from:0,to:u,cond:"SECO"},{"HOLE ID":s,from:u,to:a,cond:"ÁGUA"}):i.push({"HOLE ID":s,from:0,to:a,cond:"ÁGUA"}):i.push({"HOLE ID":s,from:0,to:a,cond:"SECO"})}),i},tX=(n,t)=>{const e=Tf(t),i=[];return n.forEach(r=>{const s=Gr(r,e,"hole_id"),l=No(r,e,"depth_from_to").map(d=>oa(d)).sort((d,p)=>d-p);l.includes(0)||l.unshift(0);const f=No(r,e,"geology").filter(d=>!d.toUpperCase().startsWith("LIMITE DE SONDAGEM"));if(f.length>0){const d=f.length-1,p=f[d],m=p.toUpperCase().indexOf("LIMITE DE SONDAGEM");m!==-1&&(f[d]=p.substring(0,m).trim())}for(let d=0;d<l.length-1;d++)i.push({"HOLE ID":s,from:l[d],to:l[d+1],Descrição:f[d]||""})}),i},eX=(n,t)=>{const e=Tf(t),i=[];return n.forEach(r=>{const s=Gr(r,e,"hole_id"),l=No(r,e,"depth_from_to").map(d=>oa(d)).sort((d,p)=>d-p);l.includes(0)||l.unshift(0);const u=No(r,e,"interp"),f=[];for(let d=0;d<l.length-1;d++)f.push({"HOLE ID":s,from:l[d],to:l[d+1],"interp. geol":u[d]||""});i.push(...f)}),i},fT=(n,t)=>[t.join(";"),...n.map(i=>t.map(r=>`"${i[r]??""}"`).join(";"))].join(`
`),hT=(n,t,e)=>{switch(e){case"collar":const i=["HOLE ID","X","Y","Z","DEPTH"];return t.find(r=>r.dataType==="date")&&i.push("DATA"),t.find(r=>r.dataType==="campaign")&&i.push("CAMPANHA"),{data:ZY(n,t),headers:i,filename:"collar.csv"};case"nspt":return{data:QY(n,t),headers:["HOLE ID","from","to","NSPT"],filename:"nspt.csv"};case"na":return{data:JY(n,t),headers:["HOLE ID","from","to","cond"],filename:"na.csv"};case"geology":return{data:tX(n,t),headers:["HOLE ID","from","to","Descrição"],filename:"geology.csv"};case"interp":return{data:eX(n,t),headers:["HOLE ID","from","to","interp. geol"],filename:"interp.csv"};default:return}},Om=(n,t)=>{const e=r5[t];if(!e)return{isValid:!1,missingFields:[],errorMessage:`Tipo de exportação '${t}' não reconhecido`};const i=[],r=n.filter(s=>s.dataType&&s.coordinates).map(s=>s.dataType);if(e.forEach(s=>{r.includes(s)||i.push(s)}),t==="nspt"||t==="collar"||t==="na"){const s=r.includes("depth"),a=r.includes("depth_from_to");!s&&!a&&i.unshift("depth")}return{isValid:i.length===0,missingFields:i,errorMessage:i.length>0?`Campos obrigatórios ausentes: ${i.join(", ")}`:void 0}};function Rm(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Q_={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var dT;function nX(){return dT||(dT=1,function(n,t){(function(e){n.exports=e()})(function(){return function e(i,r,s){function a(f,d){if(!r[f]){if(!i[f]){var p=typeof Rm=="function"&&Rm;if(!d&&p)return p(f,!0);if(l)return l(f,!0);var m=new Error("Cannot find module '"+f+"'");throw m.code="MODULE_NOT_FOUND",m}var v=r[f]={exports:{}};i[f][0].call(v.exports,function(x){var _=i[f][1][x];return a(_||x)},v,v.exports,e,i,r,s)}return r[f].exports}for(var l=typeof Rm=="function"&&Rm,u=0;u<s.length;u++)a(s[u]);return a}({1:[function(e,i,r){var s=e("./utils"),a=e("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(u){for(var f,d,p,m,v,x,_,b=[],E=0,T=u.length,S=T,O=s.getTypeOf(u)!=="string";E<u.length;)S=T-E,p=O?(f=u[E++],d=E<T?u[E++]:0,E<T?u[E++]:0):(f=u.charCodeAt(E++),d=E<T?u.charCodeAt(E++):0,E<T?u.charCodeAt(E++):0),m=f>>2,v=(3&f)<<4|d>>4,x=1<S?(15&d)<<2|p>>6:64,_=2<S?63&p:64,b.push(l.charAt(m)+l.charAt(v)+l.charAt(x)+l.charAt(_));return b.join("")},r.decode=function(u){var f,d,p,m,v,x,_=0,b=0,E="data:";if(u.substr(0,E.length)===E)throw new Error("Invalid base64 input, it looks like a data url.");var T,S=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===l.charAt(64)&&S--,u.charAt(u.length-2)===l.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(T=a.uint8array?new Uint8Array(0|S):new Array(0|S);_<u.length;)f=l.indexOf(u.charAt(_++))<<2|(m=l.indexOf(u.charAt(_++)))>>4,d=(15&m)<<4|(v=l.indexOf(u.charAt(_++)))>>2,p=(3&v)<<6|(x=l.indexOf(u.charAt(_++))),T[b++]=f,v!==64&&(T[b++]=d),x!==64&&(T[b++]=p);return T}},{"./support":30,"./utils":32}],2:[function(e,i,r){var s=e("./external"),a=e("./stream/DataWorker"),l=e("./stream/Crc32Probe"),u=e("./stream/DataLengthProbe");function f(d,p,m,v,x){this.compressedSize=d,this.uncompressedSize=p,this.crc32=m,this.compression=v,this.compressedContent=x}f.prototype={getContentWorker:function(){var d=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(d,p,m){return d.pipe(new l).pipe(new u("uncompressedSize")).pipe(p.compressWorker(m)).pipe(new u("compressedSize")).withStreamInfo("compression",p)},i.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,i,r){var s=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,i,r){var s=e("./utils"),a=function(){for(var l,u=[],f=0;f<256;f++){l=f;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;u[f]=l}return u}();i.exports=function(l,u){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(f,d,p,m){var v=a,x=m+p;f^=-1;for(var _=m;_<x;_++)f=f>>>8^v[255&(f^d[_])];return-1^f}(0|u,l,l.length,0):function(f,d,p,m){var v=a,x=m+p;f^=-1;for(var _=m;_<x;_++)f=f>>>8^v[255&(f^d.charCodeAt(_))];return-1^f}(0|u,l,l.length,0):0}},{"./utils":32}],5:[function(e,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,i,r){var s=null;s=typeof Promise<"u"?Promise:e("lie"),i.exports={Promise:s}},{lie:37}],7:[function(e,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),l=e("./utils"),u=e("./stream/GenericWorker"),f=s?"uint8array":"array";function d(p,m){u.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=m,this.meta={}}r.magic="\b\0",l.inherits(d,u),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(f,p.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(m){p.push({data:m,meta:p.meta})}},r.compressWorker=function(p){return new d("Deflate",p)},r.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,i,r){function s(v,x){var _,b="";for(_=0;_<x;_++)b+=String.fromCharCode(255&v),v>>>=8;return b}function a(v,x,_,b,E,T){var S,O,R=v.file,N=v.compression,C=T!==f.utf8encode,M=l.transformTo("string",T(R.name)),I=l.transformTo("string",f.utf8encode(R.name)),F=R.comment,z=l.transformTo("string",T(F)),P=l.transformTo("string",f.utf8encode(F)),tt=I.length!==R.name.length,L=P.length!==F.length,nt="",Q="",X="",Rt=R.dir,yt=R.date,j={crc32:0,compressedSize:0,uncompressedSize:0};x&&!_||(j.crc32=v.crc32,j.compressedSize=v.compressedSize,j.uncompressedSize=v.uncompressedSize);var J=0;x&&(J|=8),C||!tt&&!L||(J|=2048);var G=0,ut=0;Rt&&(G|=16),E==="UNIX"?(ut=798,G|=function(_t,Bt){var Gt=_t;return _t||(Gt=Bt?16893:33204),(65535&Gt)<<16}(R.unixPermissions,Rt)):(ut=20,G|=function(_t){return 63&(_t||0)}(R.dosPermissions)),S=yt.getUTCHours(),S<<=6,S|=yt.getUTCMinutes(),S<<=5,S|=yt.getUTCSeconds()/2,O=yt.getUTCFullYear()-1980,O<<=4,O|=yt.getUTCMonth()+1,O<<=5,O|=yt.getUTCDate(),tt&&(Q=s(1,1)+s(d(M),4)+I,nt+="up"+s(Q.length,2)+Q),L&&(X=s(1,1)+s(d(z),4)+P,nt+="uc"+s(X.length,2)+X);var gt="";return gt+=`
\0`,gt+=s(J,2),gt+=N.magic,gt+=s(S,2),gt+=s(O,2),gt+=s(j.crc32,4),gt+=s(j.compressedSize,4),gt+=s(j.uncompressedSize,4),gt+=s(M.length,2),gt+=s(nt.length,2),{fileRecord:p.LOCAL_FILE_HEADER+gt+M+nt,dirRecord:p.CENTRAL_FILE_HEADER+s(ut,2)+gt+s(z.length,2)+"\0\0\0\0"+s(G,4)+s(b,4)+M+nt+z}}var l=e("../utils"),u=e("../stream/GenericWorker"),f=e("../utf8"),d=e("../crc32"),p=e("../signature");function m(v,x,_,b){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=_,this.encodeFileName=b,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(m,u),m.prototype.push=function(v){var x=v.meta.percent||0,_=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,u.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:_?(x+100*(_-b-1))/_:100}}))},m.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var x=this.streamFiles&&!v.file.dir;if(x){var _=a(v,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(v){this.accumulate=!1;var x=this.streamFiles&&!v.file.dir,_=a(v,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),x)this.push({data:function(b){return p.DATA_DESCRIPTOR+s(b.crc32,4)+s(b.compressedSize,4)+s(b.uncompressedSize,4)}(v),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var v=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var _=this.bytesWritten-v,b=function(E,T,S,O,R){var N=l.transformTo("string",R(O));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(E,2)+s(E,2)+s(T,4)+s(S,4)+s(N.length,2)+N}(this.dirRecords.length,_,v,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(v){this._sources.push(v);var x=this;return v.on("data",function(_){x.processChunk(_)}),v.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),v.on("error",function(_){x.error(_)}),this},m.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(v){var x=this._sources;if(!u.prototype.error.call(this,v))return!1;for(var _=0;_<x.length;_++)try{x[_].error(v)}catch{}return!0},m.prototype.lock=function(){u.prototype.lock.call(this);for(var v=this._sources,x=0;x<v.length;x++)v[x].lock()},i.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,i,r){var s=e("../compressions"),a=e("./ZipFileWorker");r.generateWorker=function(l,u,f){var d=new a(u.streamFiles,f,u.platform,u.encodeFileName),p=0;try{l.forEach(function(m,v){p++;var x=function(T,S){var O=T||S,R=s[O];if(!R)throw new Error(O+" is not a valid compression method !");return R}(v.options.compression,u.compression),_=v.options.compressionOptions||u.compressionOptions||{},b=v.dir,E=v.date;v._compressWorker(x,_).withStreamInfo("file",{name:m,dir:b,date:E,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(d)}),d.entriesCount=p}catch(m){d.error(m)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,i,r){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var l in this)typeof this[l]!="function"&&(a[l]=this[l]);return a}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(a,l){return new s().loadAsync(a,l)},s.external=e("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,i,r){var s=e("./utils"),a=e("./external"),l=e("./utf8"),u=e("./zipEntries"),f=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function p(m){return new a.Promise(function(v,x){var _=m.decompressed.getContentWorker().pipe(new f);_.on("error",function(b){x(b)}).on("end",function(){_.streamInfo.crc32!==m.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):v()}).resume()})}i.exports=function(m,v){var x=this;return v=s.extend(v||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(m)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",m,!0,v.optimizedBinaryString,v.base64).then(function(_){var b=new u(v);return b.load(_),b}).then(function(_){var b=[a.Promise.resolve(_)],E=_.files;if(v.checkCRC32)for(var T=0;T<E.length;T++)b.push(p(E[T]));return a.Promise.all(b)}).then(function(_){for(var b=_.shift(),E=b.files,T=0;T<E.length;T++){var S=E[T],O=S.fileNameStr,R=s.resolve(S.fileNameStr);x.file(R,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:v.createFolders}),S.dir||(x.file(R).unsafeOriginalName=O)}return b.zipComment.length&&(x.comment=b.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,i,r){var s=e("../utils"),a=e("../stream/GenericWorker");function l(u,f){a.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}s.inherits(l,a),l.prototype._bindStream=function(u){var f=this;(this._stream=u).pause(),u.on("data",function(d){f.push({data:d,meta:{percent:0}})}).on("error",function(d){f.isPaused?this.generatedError=d:f.error(d)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},l.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,i,r){var s=e("readable-stream").Readable;function a(l,u,f){s.call(this,u),this._helper=l;var d=this;l.on("data",function(p,m){d.push(p)||d._helper.pause(),f&&f(m)}).on("error",function(p){d.emit("error",p)}).on("end",function(){d.push(null)})}e("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},i.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,i,r){function s(R,N,C){var M,I=l.getTypeOf(N),F=l.extend(C||{},d);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(R=E(R)),F.createFolders&&(M=b(R))&&T.call(this,M,!0);var z=I==="string"&&F.binary===!1&&F.base64===!1;C&&C.binary!==void 0||(F.binary=!z),(N instanceof p&&N.uncompressedSize===0||F.dir||!N||N.length===0)&&(F.base64=!1,F.binary=!0,N="",F.compression="STORE",I="string");var P=null;P=N instanceof p||N instanceof u?N:x.isNode&&x.isStream(N)?new _(R,N):l.prepareContent(R,N,F.binary,F.optimizedBinaryString,F.base64);var tt=new m(R,P,F);this.files[R]=tt}var a=e("./utf8"),l=e("./utils"),u=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),d=e("./defaults"),p=e("./compressedObject"),m=e("./zipObject"),v=e("./generate"),x=e("./nodejsUtils"),_=e("./nodejs/NodejsStreamInputAdapter"),b=function(R){R.slice(-1)==="/"&&(R=R.substring(0,R.length-1));var N=R.lastIndexOf("/");return 0<N?R.substring(0,N):""},E=function(R){return R.slice(-1)!=="/"&&(R+="/"),R},T=function(R,N){return N=N!==void 0?N:d.createFolders,R=E(R),this.files[R]||s.call(this,R,null,{dir:!0,createFolders:N}),this.files[R]};function S(R){return Object.prototype.toString.call(R)==="[object RegExp]"}var O={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(R){var N,C,M;for(N in this.files)M=this.files[N],(C=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&R(C,M)},filter:function(R){var N=[];return this.forEach(function(C,M){R(C,M)&&N.push(M)}),N},file:function(R,N,C){if(arguments.length!==1)return R=this.root+R,s.call(this,R,N,C),this;if(S(R)){var M=R;return this.filter(function(F,z){return!z.dir&&M.test(F)})}var I=this.files[this.root+R];return I&&!I.dir?I:null},folder:function(R){if(!R)return this;if(S(R))return this.filter(function(I,F){return F.dir&&R.test(I)});var N=this.root+R,C=T.call(this,N),M=this.clone();return M.root=C.name,M},remove:function(R){R=this.root+R;var N=this.files[R];if(N||(R.slice(-1)!=="/"&&(R+="/"),N=this.files[R]),N&&!N.dir)delete this.files[R];else for(var C=this.filter(function(I,F){return F.name.slice(0,R.length)===R}),M=0;M<C.length;M++)delete this.files[C[M].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(R){var N,C={};try{if((C=l.extend(R||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),C.type==="binarystring"&&(C.type="string"),!C.type)throw new Error("No output type specified.");l.checkSupport(C.type),C.platform!=="darwin"&&C.platform!=="freebsd"&&C.platform!=="linux"&&C.platform!=="sunos"||(C.platform="UNIX"),C.platform==="win32"&&(C.platform="DOS");var M=C.comment||this.comment||"";N=v.generateWorker(this,C,M)}catch(I){(N=new u("error")).error(I)}return new f(N,C.type||"string",C.mimeType)},generateAsync:function(R,N){return this.generateInternalStream(R).accumulate(N)},generateNodeStream:function(R,N){return(R=R||{}).type||(R.type="nodebuffer"),this.generateInternalStream(R).toNodejsStream(N)}};i.exports=O},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,i,r){i.exports=e("stream")},{stream:void 0}],17:[function(e,i,r){var s=e("./DataReader");function a(l){s.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=255&l[u]}e("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===u&&this.data[m+1]===f&&this.data[m+2]===d&&this.data[m+3]===p)return m-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),m=this.readData(4);return u===m[0]&&f===m[1]&&d===m[2]&&p===m[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,i,r){var s=e("../utils");function a(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var u,f=0;for(this.checkOffset(l),u=this.index+l-1;u>=this.index;u--)f=(f<<8)+this.byteAt(u);return this.index+=l,f},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},i.exports=a},{"../utils":32}],19:[function(e,i,r){var s=e("./Uint8ArrayReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,i,r){var s=e("./DataReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,i,r){var s=e("./ArrayReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,i,r){var s=e("../utils"),a=e("../support"),l=e("./ArrayReader"),u=e("./StringReader"),f=e("./NodeBufferReader"),d=e("./Uint8ArrayReader");i.exports=function(p){var m=s.getTypeOf(p);return s.checkSupport(m),m!=="string"||a.uint8array?m==="nodebuffer"?new f(p):a.uint8array?new d(s.transformTo("uint8array",p)):new l(s.transformTo("array",p)):new u(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,i,r){var s=e("./GenericWorker"),a=e("../utils");function l(u){s.call(this,"ConvertWorker to "+u),this.destType=u}a.inherits(l,s),l.prototype.processChunk=function(u){this.push({data:a.transformTo(this.destType,u.data),meta:u.meta})},i.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,i,r){var s=e("./GenericWorker"),a=e("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,s),l.prototype.processChunk=function(u){this.streamInfo.crc32=a(u.data,this.streamInfo.crc32||0),this.push(u)},i.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,i,r){var s=e("../utils"),a=e("./GenericWorker");function l(u){a.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}s.inherits(l,a),l.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}a.prototype.processChunk.call(this,u)},i.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,i,r){var s=e("../utils"),a=e("./GenericWorker");function l(u){a.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){f.dataIsReady=!0,f.data=d,f.max=d&&d.length||0,f.type=s.getTypeOf(d),f.isPaused||f._tickAndRepeat()},function(d){f.error(d)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,f);break;case"uint8array":u=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":u=this.data.slice(this.index,f)}return this.index=f,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,i,r){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,l){return this._listeners[a].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,l){if(this._listeners[a])for(var u=0;u<this._listeners[a].length;u++)this._listeners[a][u].call(this,l)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var l=this;return a.on("data",function(u){l.processChunk(u)}),a.on("end",function(){l.end()}),a.on("error",function(u){l.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,l){return this.extraStreamInfo[a]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=s},{}],29:[function(e,i,r){var s=e("../utils"),a=e("./ConvertWorker"),l=e("./GenericWorker"),u=e("../base64"),f=e("../support"),d=e("../external"),p=null;if(f.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(x,_){return new d.Promise(function(b,E){var T=[],S=x._internalType,O=x._outputType,R=x._mimeType;x.on("data",function(N,C){T.push(N),_&&_(C)}).on("error",function(N){T=[],E(N)}).on("end",function(){try{var N=function(C,M,I){switch(C){case"blob":return s.newBlob(s.transformTo("arraybuffer",M),I);case"base64":return u.encode(M);default:return s.transformTo(C,M)}}(O,function(C,M){var I,F=0,z=null,P=0;for(I=0;I<M.length;I++)P+=M[I].length;switch(C){case"string":return M.join("");case"array":return Array.prototype.concat.apply([],M);case"uint8array":for(z=new Uint8Array(P),I=0;I<M.length;I++)z.set(M[I],F),F+=M[I].length;return z;case"nodebuffer":return Buffer.concat(M);default:throw new Error("concat : unsupported type '"+C+"'")}}(S,T),R);b(N)}catch(C){E(C)}T=[]}).resume()})}function v(x,_,b){var E=_;switch(_){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string"}try{this._internalType=E,this._outputType=_,this._mimeType=b,s.checkSupport(E),this._worker=x.pipe(new a(E)),x.lock()}catch(T){this._worker=new l("error"),this._worker.error(T)}}v.prototype={accumulate:function(x){return m(this,x)},on:function(x,_){var b=this;return x==="data"?this._worker.on(x,function(E){_.call(b,E.data,E.meta)}):this._worker.on(x,function(){s.delay(_,arguments,b)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},x)}},i.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var s=new ArrayBuffer(0);try{r.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),r.blob=a.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(e,i,r){for(var s=e("./utils"),a=e("./support"),l=e("./nodejsUtils"),u=e("./stream/GenericWorker"),f=new Array(256),d=0;d<256;d++)f[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;f[254]=f[254]=1;function p(){u.call(this,"utf-8 decode"),this.leftOver=null}function m(){u.call(this,"utf-8 encode")}r.utf8encode=function(v){return a.nodebuffer?l.newBufferFrom(v,"utf-8"):function(x){var _,b,E,T,S,O=x.length,R=0;for(T=0;T<O;T++)(64512&(b=x.charCodeAt(T)))==55296&&T+1<O&&(64512&(E=x.charCodeAt(T+1)))==56320&&(b=65536+(b-55296<<10)+(E-56320),T++),R+=b<128?1:b<2048?2:b<65536?3:4;for(_=a.uint8array?new Uint8Array(R):new Array(R),T=S=0;S<R;T++)(64512&(b=x.charCodeAt(T)))==55296&&T+1<O&&(64512&(E=x.charCodeAt(T+1)))==56320&&(b=65536+(b-55296<<10)+(E-56320),T++),b<128?_[S++]=b:(b<2048?_[S++]=192|b>>>6:(b<65536?_[S++]=224|b>>>12:(_[S++]=240|b>>>18,_[S++]=128|b>>>12&63),_[S++]=128|b>>>6&63),_[S++]=128|63&b);return _}(v)},r.utf8decode=function(v){return a.nodebuffer?s.transformTo("nodebuffer",v).toString("utf-8"):function(x){var _,b,E,T,S=x.length,O=new Array(2*S);for(_=b=0;_<S;)if((E=x[_++])<128)O[b++]=E;else if(4<(T=f[E]))O[b++]=65533,_+=T-1;else{for(E&=T===2?31:T===3?15:7;1<T&&_<S;)E=E<<6|63&x[_++],T--;1<T?O[b++]=65533:E<65536?O[b++]=E:(E-=65536,O[b++]=55296|E>>10&1023,O[b++]=56320|1023&E)}return O.length!==b&&(O.subarray?O=O.subarray(0,b):O.length=b),s.applyFromCharCode(O)}(v=s.transformTo(a.uint8array?"uint8array":"array",v))},s.inherits(p,u),p.prototype.processChunk=function(v){var x=s.transformTo(a.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var _=x;(x=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),x.set(_,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var b=function(T,S){var O;for((S=S||T.length)>T.length&&(S=T.length),O=S-1;0<=O&&(192&T[O])==128;)O--;return O<0||O===0?S:O+f[T[O]]>S?O:S}(x),E=x;b!==x.length&&(a.uint8array?(E=x.subarray(0,b),this.leftOver=x.subarray(b,x.length)):(E=x.slice(0,b),this.leftOver=x.slice(b,x.length))),this.push({data:r.utf8decode(E),meta:v.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=p,s.inherits(m,u),m.prototype.processChunk=function(v){this.push({data:r.utf8encode(v.data),meta:v.meta})},r.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,i,r){var s=e("./support"),a=e("./base64"),l=e("./nodejsUtils"),u=e("./external");function f(_){return _}function d(_,b){for(var E=0;E<_.length;++E)b[E]=255&_.charCodeAt(E);return b}e("setimmediate"),r.newBlob=function(_,b){r.checkSupport("blob");try{return new Blob([_],{type:b})}catch{try{var E=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return E.append(_),E.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(_,b,E){var T=[],S=0,O=_.length;if(O<=E)return String.fromCharCode.apply(null,_);for(;S<O;)b==="array"||b==="nodebuffer"?T.push(String.fromCharCode.apply(null,_.slice(S,Math.min(S+E,O)))):T.push(String.fromCharCode.apply(null,_.subarray(S,Math.min(S+E,O)))),S+=E;return T.join("")},stringifyByChar:function(_){for(var b="",E=0;E<_.length;E++)b+=String.fromCharCode(_[E]);return b},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function m(_){var b=65536,E=r.getTypeOf(_),T=!0;if(E==="uint8array"?T=p.applyCanBeUsed.uint8array:E==="nodebuffer"&&(T=p.applyCanBeUsed.nodebuffer),T)for(;1<b;)try{return p.stringifyByChunk(_,E,b)}catch{b=Math.floor(b/2)}return p.stringifyByChar(_)}function v(_,b){for(var E=0;E<_.length;E++)b[E]=_[E];return b}r.applyFromCharCode=m;var x={};x.string={string:f,array:function(_){return d(_,new Array(_.length))},arraybuffer:function(_){return x.string.uint8array(_).buffer},uint8array:function(_){return d(_,new Uint8Array(_.length))},nodebuffer:function(_){return d(_,l.allocBuffer(_.length))}},x.array={string:m,array:f,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return l.newBufferFrom(_)}},x.arraybuffer={string:function(_){return m(new Uint8Array(_))},array:function(_){return v(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:f,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return l.newBufferFrom(new Uint8Array(_))}},x.uint8array={string:m,array:function(_){return v(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:f,nodebuffer:function(_){return l.newBufferFrom(_)}},x.nodebuffer={string:m,array:function(_){return v(_,new Array(_.length))},arraybuffer:function(_){return x.nodebuffer.uint8array(_).buffer},uint8array:function(_){return v(_,new Uint8Array(_.length))},nodebuffer:f},r.transformTo=function(_,b){if(b=b||"",!_)return b;r.checkSupport(_);var E=r.getTypeOf(b);return x[E][_](b)},r.resolve=function(_){for(var b=_.split("/"),E=[],T=0;T<b.length;T++){var S=b[T];S==="."||S===""&&T!==0&&T!==b.length-1||(S===".."?E.pop():E.push(S))}return E.join("/")},r.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(_)?"nodebuffer":s.uint8array&&_ instanceof Uint8Array?"uint8array":s.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(_){if(!s[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(_){var b,E,T="";for(E=0;E<(_||"").length;E++)T+="\\x"+((b=_.charCodeAt(E))<16?"0":"")+b.toString(16).toUpperCase();return T},r.delay=function(_,b,E){setImmediate(function(){_.apply(E||null,b||[])})},r.inherits=function(_,b){function E(){}E.prototype=b.prototype,_.prototype=new E},r.extend=function(){var _,b,E={};for(_=0;_<arguments.length;_++)for(b in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],b)&&E[b]===void 0&&(E[b]=arguments[_][b]);return E},r.prepareContent=function(_,b,E,T,S){return u.Promise.resolve(b).then(function(O){return s.blob&&(O instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(O))!==-1)&&typeof FileReader<"u"?new u.Promise(function(R,N){var C=new FileReader;C.onload=function(M){R(M.target.result)},C.onerror=function(M){N(M.target.error)},C.readAsArrayBuffer(O)}):O}).then(function(O){var R=r.getTypeOf(O);return R?(R==="arraybuffer"?O=r.transformTo("uint8array",O):R==="string"&&(S?O=a.decode(O):E&&T!==!0&&(O=function(N){return d(N,s.uint8array?new Uint8Array(N.length):new Array(N.length))}(O))),O):u.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,i,r){var s=e("./reader/readerFor"),a=e("./utils"),l=e("./signature"),u=e("./zipEntry"),f=e("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(m)+", expected "+a.pretty(p)+")")}},isSignature:function(p,m){var v=this.reader.index;this.reader.setIndex(p);var x=this.reader.readString(4)===m;return this.reader.setIndex(v),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),m=f.uint8array?"uint8array":"array",v=a.transformTo(m,p);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,m,v,x=this.zip64EndOfCentralSize-44;0<x;)p=this.reader.readInt(2),m=this.reader.readInt(4),v=this.reader.readData(m),this.zip64ExtensibleData[p]={id:p,length:m,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,m;for(p=0;p<this.files.length;p++)m=this.files[p],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var m=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var x=m-v;if(0<x)this.isSignature(m,l.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,i,r){var s=e("./reader/readerFor"),a=e("./utils"),l=e("./compressedObject"),u=e("./crc32"),f=e("./utf8"),d=e("./compressions"),p=e("./support");function m(v,x){this.options=v,this.loadOptions=x}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(v){var x,_;if(v.skip(22),this.fileNameLength=v.readInt(2),_=v.readInt(2),this.fileName=v.readData(this.fileNameLength),v.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(b){for(var E in d)if(Object.prototype.hasOwnProperty.call(d,E)&&d[E].magic===b)return d[E];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,x,v.readData(this.compressedSize))},readCentralPart:function(v){this.versionMadeBy=v.readInt(2),v.skip(2),this.bitFlag=v.readInt(2),this.compressionMethod=v.readString(2),this.date=v.readDate(),this.crc32=v.readInt(4),this.compressedSize=v.readInt(4),this.uncompressedSize=v.readInt(4);var x=v.readInt(2);if(this.extraFieldsLength=v.readInt(2),this.fileCommentLength=v.readInt(2),this.diskNumberStart=v.readInt(2),this.internalFileAttributes=v.readInt(2),this.externalFileAttributes=v.readInt(4),this.localHeaderOffset=v.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");v.skip(x),this.readExtraFields(v),this.parseZIP64ExtraField(v),this.fileComment=v.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var v=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),v==0&&(this.dosPermissions=63&this.externalFileAttributes),v==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var v=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(v){var x,_,b,E=v.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});v.index+4<E;)x=v.readInt(2),_=v.readInt(2),b=v.readData(_),this.extraFields[x]={id:x,length:_,value:b};v.setIndex(E)},handleUTF8:function(){var v=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var _=a.transformTo(v,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var E=a.transformTo(v,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(E)}}},findExtraFieldUnicodePath:function(){var v=this.extraFields[28789];if(v){var x=s(v.value);return x.readInt(1)!==1||u(this.fileName)!==x.readInt(4)?null:f.utf8decode(x.readData(v.length-5))}return null},findExtraFieldUnicodeComment:function(){var v=this.extraFields[25461];if(v){var x=s(v.value);return x.readInt(1)!==1||u(this.fileComment)!==x.readInt(4)?null:f.utf8decode(x.readData(v.length-5))}return null}},i.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,i,r){function s(x,_,b){this.name=x,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=_,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var a=e("./stream/StreamHelper"),l=e("./stream/DataWorker"),u=e("./utf8"),f=e("./compressedObject"),d=e("./stream/GenericWorker");s.prototype={internalStream:function(x){var _=null,b="string";try{if(!x)throw new Error("No output type specified.");var E=(b=x.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),_=this._decompressWorker();var T=!this._dataBinary;T&&!E&&(_=_.pipe(new u.Utf8EncodeWorker)),!T&&E&&(_=_.pipe(new u.Utf8DecodeWorker))}catch(S){(_=new d("error")).error(S)}return new a(_,b,"")},async:function(x,_){return this.internalStream(x).accumulate(_)},nodeStream:function(x,_){return this.internalStream(x||"nodebuffer").toNodejsStream(_)},_compressWorker:function(x,_){if(this._data instanceof f&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new u.Utf8EncodeWorker)),f.createWorkerFrom(b,x,_)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},v=0;v<p.length;v++)s.prototype[p[v]]=m;i.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,i,r){(function(s){var a,l,u=s.MutationObserver||s.WebKitMutationObserver;if(u){var f=0,d=new u(x),p=s.document.createTextNode("");d.observe(p,{characterData:!0}),a=function(){p.data=f=++f%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var _=s.document.createElement("script");_.onreadystatechange=function(){x(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},s.document.documentElement.appendChild(_)}:function(){setTimeout(x,0)};else{var m=new s.MessageChannel;m.port1.onmessage=x,a=function(){m.port2.postMessage(0)}}var v=[];function x(){var _,b;l=!0;for(var E=v.length;E;){for(b=v,v=[],_=-1;++_<E;)b[_]();E=v.length}l=!1}i.exports=function(_){v.push(_)!==1||l||a()}}).call(this,typeof K0<"u"?K0:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,i,r){var s=e("immediate");function a(){}var l={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];function p(E){if(typeof E!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,E!==a&&_(this,E)}function m(E,T,S){this.promise=E,typeof T=="function"&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function v(E,T,S){s(function(){var O;try{O=T(S)}catch(R){return l.reject(E,R)}O===E?l.reject(E,new TypeError("Cannot resolve promise with itself")):l.resolve(E,O)})}function x(E){var T=E&&E.then;if(E&&(typeof E=="object"||typeof E=="function")&&typeof T=="function")return function(){T.apply(E,arguments)}}function _(E,T){var S=!1;function O(C){S||(S=!0,l.reject(E,C))}function R(C){S||(S=!0,l.resolve(E,C))}var N=b(function(){T(R,O)});N.status==="error"&&O(N.value)}function b(E,T){var S={};try{S.value=E(T),S.status="success"}catch(O){S.status="error",S.value=O}return S}(i.exports=p).prototype.finally=function(E){if(typeof E!="function")return this;var T=this.constructor;return this.then(function(S){return T.resolve(E()).then(function(){return S})},function(S){return T.resolve(E()).then(function(){throw S})})},p.prototype.catch=function(E){return this.then(null,E)},p.prototype.then=function(E,T){if(typeof E!="function"&&this.state===f||typeof T!="function"&&this.state===u)return this;var S=new this.constructor(a);return this.state!==d?v(S,this.state===f?E:T,this.outcome):this.queue.push(new m(S,E,T)),S},m.prototype.callFulfilled=function(E){l.resolve(this.promise,E)},m.prototype.otherCallFulfilled=function(E){v(this.promise,this.onFulfilled,E)},m.prototype.callRejected=function(E){l.reject(this.promise,E)},m.prototype.otherCallRejected=function(E){v(this.promise,this.onRejected,E)},l.resolve=function(E,T){var S=b(x,T);if(S.status==="error")return l.reject(E,S.value);var O=S.value;if(O)_(E,O);else{E.state=f,E.outcome=T;for(var R=-1,N=E.queue.length;++R<N;)E.queue[R].callFulfilled(T)}return E},l.reject=function(E,T){E.state=u,E.outcome=T;for(var S=-1,O=E.queue.length;++S<O;)E.queue[S].callRejected(T);return E},p.resolve=function(E){return E instanceof this?E:l.resolve(new this(a),E)},p.reject=function(E){var T=new this(a);return l.reject(T,E)},p.all=function(E){var T=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=E.length,O=!1;if(!S)return this.resolve([]);for(var R=new Array(S),N=0,C=-1,M=new this(a);++C<S;)I(E[C],C);return M;function I(F,z){T.resolve(F).then(function(P){R[z]=P,++N!==S||O||(O=!0,l.resolve(M,R))},function(P){O||(O=!0,l.reject(M,P))})}},p.race=function(E){var T=this;if(Object.prototype.toString.call(E)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=E.length,O=!1;if(!S)return this.resolve([]);for(var R=-1,N=new this(a);++R<S;)C=E[R],T.resolve(C).then(function(M){O||(O=!0,l.resolve(N,M))},function(M){O||(O=!0,l.reject(N,M))});var C;return N}},{immediate:36}],38:[function(e,i,r){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),i.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,i,r){var s=e("./zlib/deflate"),a=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/messages"),f=e("./zlib/zstream"),d=Object.prototype.toString,p=0,m=-1,v=0,x=8;function _(E){if(!(this instanceof _))return new _(E);this.options=a.assign({level:m,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},E||{});var T=this.options;T.raw&&0<T.windowBits?T.windowBits=-T.windowBits:T.gzip&&0<T.windowBits&&T.windowBits<16&&(T.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var S=s.deflateInit2(this.strm,T.level,T.method,T.windowBits,T.memLevel,T.strategy);if(S!==p)throw new Error(u[S]);if(T.header&&s.deflateSetHeader(this.strm,T.header),T.dictionary){var O;if(O=typeof T.dictionary=="string"?l.string2buf(T.dictionary):d.call(T.dictionary)==="[object ArrayBuffer]"?new Uint8Array(T.dictionary):T.dictionary,(S=s.deflateSetDictionary(this.strm,O))!==p)throw new Error(u[S]);this._dict_set=!0}}function b(E,T){var S=new _(T);if(S.push(E,!0),S.err)throw S.msg||u[S.err];return S.result}_.prototype.push=function(E,T){var S,O,R=this.strm,N=this.options.chunkSize;if(this.ended)return!1;O=T===~~T?T:T===!0?4:0,typeof E=="string"?R.input=l.string2buf(E):d.call(E)==="[object ArrayBuffer]"?R.input=new Uint8Array(E):R.input=E,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(N),R.next_out=0,R.avail_out=N),(S=s.deflate(R,O))!==1&&S!==p)return this.onEnd(S),!(this.ended=!0);R.avail_out!==0&&(R.avail_in!==0||O!==4&&O!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(a.shrinkBuf(R.output,R.next_out))):this.onData(a.shrinkBuf(R.output,R.next_out)))}while((0<R.avail_in||R.avail_out===0)&&S!==1);return O===4?(S=s.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===p):O!==2||(this.onEnd(p),!(R.avail_out=0))},_.prototype.onData=function(E){this.chunks.push(E)},_.prototype.onEnd=function(E){E===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},r.Deflate=_,r.deflate=b,r.deflateRaw=function(E,T){return(T=T||{}).raw=!0,b(E,T)},r.gzip=function(E,T){return(T=T||{}).gzip=!0,b(E,T)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,i,r){var s=e("./zlib/inflate"),a=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/constants"),f=e("./zlib/messages"),d=e("./zlib/zstream"),p=e("./zlib/gzheader"),m=Object.prototype.toString;function v(_){if(!(this instanceof v))return new v(_);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},_||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||_&&_.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&(15&b.windowBits)==0&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var E=s.inflateInit2(this.strm,b.windowBits);if(E!==u.Z_OK)throw new Error(f[E]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function x(_,b){var E=new v(b);if(E.push(_,!0),E.err)throw E.msg||f[E.err];return E.result}v.prototype.push=function(_,b){var E,T,S,O,R,N,C=this.strm,M=this.options.chunkSize,I=this.options.dictionary,F=!1;if(this.ended)return!1;T=b===~~b?b:b===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof _=="string"?C.input=l.binstring2buf(_):m.call(_)==="[object ArrayBuffer]"?C.input=new Uint8Array(_):C.input=_,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(M),C.next_out=0,C.avail_out=M),(E=s.inflate(C,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&I&&(N=typeof I=="string"?l.string2buf(I):m.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,E=s.inflateSetDictionary(this.strm,N)),E===u.Z_BUF_ERROR&&F===!0&&(E=u.Z_OK,F=!1),E!==u.Z_STREAM_END&&E!==u.Z_OK)return this.onEnd(E),!(this.ended=!0);C.next_out&&(C.avail_out!==0&&E!==u.Z_STREAM_END&&(C.avail_in!==0||T!==u.Z_FINISH&&T!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=l.utf8border(C.output,C.next_out),O=C.next_out-S,R=l.buf2string(C.output,S),C.next_out=O,C.avail_out=M-O,O&&a.arraySet(C.output,C.output,S,O,0),this.onData(R)):this.onData(a.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(F=!0)}while((0<C.avail_in||C.avail_out===0)&&E!==u.Z_STREAM_END);return E===u.Z_STREAM_END&&(T=u.Z_FINISH),T===u.Z_FINISH?(E=s.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===u.Z_OK):T!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(C.avail_out=0))},v.prototype.onData=function(_){this.chunks.push(_)},v.prototype.onEnd=function(_){_===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},r.Inflate=v,r.inflate=x,r.inflateRaw=function(_,b){return(b=b||{}).raw=!0,x(_,b)},r.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var d=f.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(u[p]=d[p])}}return u},r.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var a={arraySet:function(u,f,d,p,m){if(f.subarray&&u.subarray)u.set(f.subarray(d,d+p),m);else for(var v=0;v<p;v++)u[m+v]=f[d+v]},flattenChunks:function(u){var f,d,p,m,v,x;for(f=p=0,d=u.length;f<d;f++)p+=u[f].length;for(x=new Uint8Array(p),f=m=0,d=u.length;f<d;f++)v=u[f],x.set(v,m),m+=v.length;return x}},l={arraySet:function(u,f,d,p,m){for(var v=0;v<p;v++)u[m+v]=f[d+v]},flattenChunks:function(u){return[].concat.apply([],u)}};r.setTyped=function(u){u?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,l))},r.setTyped(s)},{}],42:[function(e,i,r){var s=e("./common"),a=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var u=new s.Buf8(256),f=0;f<256;f++)u[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function d(p,m){if(m<65537&&(p.subarray&&l||!p.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(p,m));for(var v="",x=0;x<m;x++)v+=String.fromCharCode(p[x]);return v}u[254]=u[254]=1,r.string2buf=function(p){var m,v,x,_,b,E=p.length,T=0;for(_=0;_<E;_++)(64512&(v=p.charCodeAt(_)))==55296&&_+1<E&&(64512&(x=p.charCodeAt(_+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),_++),T+=v<128?1:v<2048?2:v<65536?3:4;for(m=new s.Buf8(T),_=b=0;b<T;_++)(64512&(v=p.charCodeAt(_)))==55296&&_+1<E&&(64512&(x=p.charCodeAt(_+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),_++),v<128?m[b++]=v:(v<2048?m[b++]=192|v>>>6:(v<65536?m[b++]=224|v>>>12:(m[b++]=240|v>>>18,m[b++]=128|v>>>12&63),m[b++]=128|v>>>6&63),m[b++]=128|63&v);return m},r.buf2binstring=function(p){return d(p,p.length)},r.binstring2buf=function(p){for(var m=new s.Buf8(p.length),v=0,x=m.length;v<x;v++)m[v]=p.charCodeAt(v);return m},r.buf2string=function(p,m){var v,x,_,b,E=m||p.length,T=new Array(2*E);for(v=x=0;v<E;)if((_=p[v++])<128)T[x++]=_;else if(4<(b=u[_]))T[x++]=65533,v+=b-1;else{for(_&=b===2?31:b===3?15:7;1<b&&v<E;)_=_<<6|63&p[v++],b--;1<b?T[x++]=65533:_<65536?T[x++]=_:(_-=65536,T[x++]=55296|_>>10&1023,T[x++]=56320|1023&_)}return d(T,x)},r.utf8border=function(p,m){var v;for((m=m||p.length)>p.length&&(m=p.length),v=m-1;0<=v&&(192&p[v])==128;)v--;return v<0||v===0?m:v+u[p[v]]>m?v:m}},{"./common":41}],43:[function(e,i,r){i.exports=function(s,a,l,u){for(var f=65535&s|0,d=s>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;d=d+(f=f+a[u++]|0)|0,--p;);f%=65521,d%=65521}return f|d<<16|0}},{}],44:[function(e,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,i,r){var s=function(){for(var a,l=[],u=0;u<256;u++){a=u;for(var f=0;f<8;f++)a=1&a?3988292384^a>>>1:a>>>1;l[u]=a}return l}();i.exports=function(a,l,u,f){var d=s,p=f+u;a^=-1;for(var m=f;m<p;m++)a=a>>>8^d[255&(a^l[m])];return-1^a}},{}],46:[function(e,i,r){var s,a=e("../utils/common"),l=e("./trees"),u=e("./adler32"),f=e("./crc32"),d=e("./messages"),p=0,m=4,v=0,x=-2,_=-1,b=4,E=2,T=8,S=9,O=286,R=30,N=19,C=2*O+1,M=15,I=3,F=258,z=F+I+1,P=42,tt=113,L=1,nt=2,Q=3,X=4;function Rt(D,dt){return D.msg=d[dt],dt}function yt(D){return(D<<1)-(4<D?9:0)}function j(D){for(var dt=D.length;0<=--dt;)D[dt]=0}function J(D){var dt=D.state,st=dt.pending;st>D.avail_out&&(st=D.avail_out),st!==0&&(a.arraySet(D.output,dt.pending_buf,dt.pending_out,st,D.next_out),D.next_out+=st,dt.pending_out+=st,D.total_out+=st,D.avail_out-=st,dt.pending-=st,dt.pending===0&&(dt.pending_out=0))}function G(D,dt){l._tr_flush_block(D,0<=D.block_start?D.block_start:-1,D.strstart-D.block_start,dt),D.block_start=D.strstart,J(D.strm)}function ut(D,dt){D.pending_buf[D.pending++]=dt}function gt(D,dt){D.pending_buf[D.pending++]=dt>>>8&255,D.pending_buf[D.pending++]=255&dt}function _t(D,dt){var st,Y,q=D.max_chain_length,ft=D.strstart,Pt=D.prev_length,jt=D.nice_match,wt=D.strstart>D.w_size-z?D.strstart-(D.w_size-z):0,Nt=D.window,At=D.w_mask,pt=D.prev,te=D.strstart+F,ae=Nt[ft+Pt-1],ne=Nt[ft+Pt];D.prev_length>=D.good_match&&(q>>=2),jt>D.lookahead&&(jt=D.lookahead);do if(Nt[(st=dt)+Pt]===ne&&Nt[st+Pt-1]===ae&&Nt[st]===Nt[ft]&&Nt[++st]===Nt[ft+1]){ft+=2,st++;do;while(Nt[++ft]===Nt[++st]&&Nt[++ft]===Nt[++st]&&Nt[++ft]===Nt[++st]&&Nt[++ft]===Nt[++st]&&Nt[++ft]===Nt[++st]&&Nt[++ft]===Nt[++st]&&Nt[++ft]===Nt[++st]&&Nt[++ft]===Nt[++st]&&ft<te);if(Y=F-(te-ft),ft=te-F,Pt<Y){if(D.match_start=dt,jt<=(Pt=Y))break;ae=Nt[ft+Pt-1],ne=Nt[ft+Pt]}}while((dt=pt[dt&At])>wt&&--q!=0);return Pt<=D.lookahead?Pt:D.lookahead}function Bt(D){var dt,st,Y,q,ft,Pt,jt,wt,Nt,At,pt=D.w_size;do{if(q=D.window_size-D.lookahead-D.strstart,D.strstart>=pt+(pt-z)){for(a.arraySet(D.window,D.window,pt,pt,0),D.match_start-=pt,D.strstart-=pt,D.block_start-=pt,dt=st=D.hash_size;Y=D.head[--dt],D.head[dt]=pt<=Y?Y-pt:0,--st;);for(dt=st=pt;Y=D.prev[--dt],D.prev[dt]=pt<=Y?Y-pt:0,--st;);q+=pt}if(D.strm.avail_in===0)break;if(Pt=D.strm,jt=D.window,wt=D.strstart+D.lookahead,Nt=q,At=void 0,At=Pt.avail_in,Nt<At&&(At=Nt),st=At===0?0:(Pt.avail_in-=At,a.arraySet(jt,Pt.input,Pt.next_in,At,wt),Pt.state.wrap===1?Pt.adler=u(Pt.adler,jt,At,wt):Pt.state.wrap===2&&(Pt.adler=f(Pt.adler,jt,At,wt)),Pt.next_in+=At,Pt.total_in+=At,At),D.lookahead+=st,D.lookahead+D.insert>=I)for(ft=D.strstart-D.insert,D.ins_h=D.window[ft],D.ins_h=(D.ins_h<<D.hash_shift^D.window[ft+1])&D.hash_mask;D.insert&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[ft+I-1])&D.hash_mask,D.prev[ft&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=ft,ft++,D.insert--,!(D.lookahead+D.insert<I)););}while(D.lookahead<z&&D.strm.avail_in!==0)}function Gt(D,dt){for(var st,Y;;){if(D.lookahead<z){if(Bt(D),D.lookahead<z&&dt===p)return L;if(D.lookahead===0)break}if(st=0,D.lookahead>=I&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+I-1])&D.hash_mask,st=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),st!==0&&D.strstart-st<=D.w_size-z&&(D.match_length=_t(D,st)),D.match_length>=I)if(Y=l._tr_tally(D,D.strstart-D.match_start,D.match_length-I),D.lookahead-=D.match_length,D.match_length<=D.max_lazy_match&&D.lookahead>=I){for(D.match_length--;D.strstart++,D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+I-1])&D.hash_mask,st=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart,--D.match_length!=0;);D.strstart++}else D.strstart+=D.match_length,D.match_length=0,D.ins_h=D.window[D.strstart],D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+1])&D.hash_mask;else Y=l._tr_tally(D,0,D.window[D.strstart]),D.lookahead--,D.strstart++;if(Y&&(G(D,!1),D.strm.avail_out===0))return L}return D.insert=D.strstart<I-1?D.strstart:I-1,dt===m?(G(D,!0),D.strm.avail_out===0?Q:X):D.last_lit&&(G(D,!1),D.strm.avail_out===0)?L:nt}function H(D,dt){for(var st,Y,q;;){if(D.lookahead<z){if(Bt(D),D.lookahead<z&&dt===p)return L;if(D.lookahead===0)break}if(st=0,D.lookahead>=I&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+I-1])&D.hash_mask,st=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),D.prev_length=D.match_length,D.prev_match=D.match_start,D.match_length=I-1,st!==0&&D.prev_length<D.max_lazy_match&&D.strstart-st<=D.w_size-z&&(D.match_length=_t(D,st),D.match_length<=5&&(D.strategy===1||D.match_length===I&&4096<D.strstart-D.match_start)&&(D.match_length=I-1)),D.prev_length>=I&&D.match_length<=D.prev_length){for(q=D.strstart+D.lookahead-I,Y=l._tr_tally(D,D.strstart-1-D.prev_match,D.prev_length-I),D.lookahead-=D.prev_length-1,D.prev_length-=2;++D.strstart<=q&&(D.ins_h=(D.ins_h<<D.hash_shift^D.window[D.strstart+I-1])&D.hash_mask,st=D.prev[D.strstart&D.w_mask]=D.head[D.ins_h],D.head[D.ins_h]=D.strstart),--D.prev_length!=0;);if(D.match_available=0,D.match_length=I-1,D.strstart++,Y&&(G(D,!1),D.strm.avail_out===0))return L}else if(D.match_available){if((Y=l._tr_tally(D,0,D.window[D.strstart-1]))&&G(D,!1),D.strstart++,D.lookahead--,D.strm.avail_out===0)return L}else D.match_available=1,D.strstart++,D.lookahead--}return D.match_available&&(Y=l._tr_tally(D,0,D.window[D.strstart-1]),D.match_available=0),D.insert=D.strstart<I-1?D.strstart:I-1,dt===m?(G(D,!0),D.strm.avail_out===0?Q:X):D.last_lit&&(G(D,!1),D.strm.avail_out===0)?L:nt}function mt(D,dt,st,Y,q){this.good_length=D,this.max_lazy=dt,this.nice_length=st,this.max_chain=Y,this.func=q}function lt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*C),this.dyn_dtree=new a.Buf16(2*(2*R+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),j(this.dyn_ltree),j(this.dyn_dtree),j(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(M+1),this.heap=new a.Buf16(2*O+1),j(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*O+1),j(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ct(D){var dt;return D&&D.state?(D.total_in=D.total_out=0,D.data_type=E,(dt=D.state).pending=0,dt.pending_out=0,dt.wrap<0&&(dt.wrap=-dt.wrap),dt.status=dt.wrap?P:tt,D.adler=dt.wrap===2?0:1,dt.last_flush=p,l._tr_init(dt),v):Rt(D,x)}function Ct(D){var dt=ct(D);return dt===v&&function(st){st.window_size=2*st.w_size,j(st.head),st.max_lazy_match=s[st.level].max_lazy,st.good_match=s[st.level].good_length,st.nice_match=s[st.level].nice_length,st.max_chain_length=s[st.level].max_chain,st.strstart=0,st.block_start=0,st.lookahead=0,st.insert=0,st.match_length=st.prev_length=I-1,st.match_available=0,st.ins_h=0}(D.state),dt}function Lt(D,dt,st,Y,q,ft){if(!D)return x;var Pt=1;if(dt===_&&(dt=6),Y<0?(Pt=0,Y=-Y):15<Y&&(Pt=2,Y-=16),q<1||S<q||st!==T||Y<8||15<Y||dt<0||9<dt||ft<0||b<ft)return Rt(D,x);Y===8&&(Y=9);var jt=new lt;return(D.state=jt).strm=D,jt.wrap=Pt,jt.gzhead=null,jt.w_bits=Y,jt.w_size=1<<jt.w_bits,jt.w_mask=jt.w_size-1,jt.hash_bits=q+7,jt.hash_size=1<<jt.hash_bits,jt.hash_mask=jt.hash_size-1,jt.hash_shift=~~((jt.hash_bits+I-1)/I),jt.window=new a.Buf8(2*jt.w_size),jt.head=new a.Buf16(jt.hash_size),jt.prev=new a.Buf16(jt.w_size),jt.lit_bufsize=1<<q+6,jt.pending_buf_size=4*jt.lit_bufsize,jt.pending_buf=new a.Buf8(jt.pending_buf_size),jt.d_buf=1*jt.lit_bufsize,jt.l_buf=3*jt.lit_bufsize,jt.level=dt,jt.strategy=ft,jt.method=st,Ct(D)}s=[new mt(0,0,0,0,function(D,dt){var st=65535;for(st>D.pending_buf_size-5&&(st=D.pending_buf_size-5);;){if(D.lookahead<=1){if(Bt(D),D.lookahead===0&&dt===p)return L;if(D.lookahead===0)break}D.strstart+=D.lookahead,D.lookahead=0;var Y=D.block_start+st;if((D.strstart===0||D.strstart>=Y)&&(D.lookahead=D.strstart-Y,D.strstart=Y,G(D,!1),D.strm.avail_out===0)||D.strstart-D.block_start>=D.w_size-z&&(G(D,!1),D.strm.avail_out===0))return L}return D.insert=0,dt===m?(G(D,!0),D.strm.avail_out===0?Q:X):(D.strstart>D.block_start&&(G(D,!1),D.strm.avail_out),L)}),new mt(4,4,8,4,Gt),new mt(4,5,16,8,Gt),new mt(4,6,32,32,Gt),new mt(4,4,16,16,H),new mt(8,16,32,32,H),new mt(8,16,128,128,H),new mt(8,32,128,256,H),new mt(32,128,258,1024,H),new mt(32,258,258,4096,H)],r.deflateInit=function(D,dt){return Lt(D,dt,T,15,8,0)},r.deflateInit2=Lt,r.deflateReset=Ct,r.deflateResetKeep=ct,r.deflateSetHeader=function(D,dt){return D&&D.state?D.state.wrap!==2?x:(D.state.gzhead=dt,v):x},r.deflate=function(D,dt){var st,Y,q,ft;if(!D||!D.state||5<dt||dt<0)return D?Rt(D,x):x;if(Y=D.state,!D.output||!D.input&&D.avail_in!==0||Y.status===666&&dt!==m)return Rt(D,D.avail_out===0?-5:x);if(Y.strm=D,st=Y.last_flush,Y.last_flush=dt,Y.status===P)if(Y.wrap===2)D.adler=0,ut(Y,31),ut(Y,139),ut(Y,8),Y.gzhead?(ut(Y,(Y.gzhead.text?1:0)+(Y.gzhead.hcrc?2:0)+(Y.gzhead.extra?4:0)+(Y.gzhead.name?8:0)+(Y.gzhead.comment?16:0)),ut(Y,255&Y.gzhead.time),ut(Y,Y.gzhead.time>>8&255),ut(Y,Y.gzhead.time>>16&255),ut(Y,Y.gzhead.time>>24&255),ut(Y,Y.level===9?2:2<=Y.strategy||Y.level<2?4:0),ut(Y,255&Y.gzhead.os),Y.gzhead.extra&&Y.gzhead.extra.length&&(ut(Y,255&Y.gzhead.extra.length),ut(Y,Y.gzhead.extra.length>>8&255)),Y.gzhead.hcrc&&(D.adler=f(D.adler,Y.pending_buf,Y.pending,0)),Y.gzindex=0,Y.status=69):(ut(Y,0),ut(Y,0),ut(Y,0),ut(Y,0),ut(Y,0),ut(Y,Y.level===9?2:2<=Y.strategy||Y.level<2?4:0),ut(Y,3),Y.status=tt);else{var Pt=T+(Y.w_bits-8<<4)<<8;Pt|=(2<=Y.strategy||Y.level<2?0:Y.level<6?1:Y.level===6?2:3)<<6,Y.strstart!==0&&(Pt|=32),Pt+=31-Pt%31,Y.status=tt,gt(Y,Pt),Y.strstart!==0&&(gt(Y,D.adler>>>16),gt(Y,65535&D.adler)),D.adler=1}if(Y.status===69)if(Y.gzhead.extra){for(q=Y.pending;Y.gzindex<(65535&Y.gzhead.extra.length)&&(Y.pending!==Y.pending_buf_size||(Y.gzhead.hcrc&&Y.pending>q&&(D.adler=f(D.adler,Y.pending_buf,Y.pending-q,q)),J(D),q=Y.pending,Y.pending!==Y.pending_buf_size));)ut(Y,255&Y.gzhead.extra[Y.gzindex]),Y.gzindex++;Y.gzhead.hcrc&&Y.pending>q&&(D.adler=f(D.adler,Y.pending_buf,Y.pending-q,q)),Y.gzindex===Y.gzhead.extra.length&&(Y.gzindex=0,Y.status=73)}else Y.status=73;if(Y.status===73)if(Y.gzhead.name){q=Y.pending;do{if(Y.pending===Y.pending_buf_size&&(Y.gzhead.hcrc&&Y.pending>q&&(D.adler=f(D.adler,Y.pending_buf,Y.pending-q,q)),J(D),q=Y.pending,Y.pending===Y.pending_buf_size)){ft=1;break}ft=Y.gzindex<Y.gzhead.name.length?255&Y.gzhead.name.charCodeAt(Y.gzindex++):0,ut(Y,ft)}while(ft!==0);Y.gzhead.hcrc&&Y.pending>q&&(D.adler=f(D.adler,Y.pending_buf,Y.pending-q,q)),ft===0&&(Y.gzindex=0,Y.status=91)}else Y.status=91;if(Y.status===91)if(Y.gzhead.comment){q=Y.pending;do{if(Y.pending===Y.pending_buf_size&&(Y.gzhead.hcrc&&Y.pending>q&&(D.adler=f(D.adler,Y.pending_buf,Y.pending-q,q)),J(D),q=Y.pending,Y.pending===Y.pending_buf_size)){ft=1;break}ft=Y.gzindex<Y.gzhead.comment.length?255&Y.gzhead.comment.charCodeAt(Y.gzindex++):0,ut(Y,ft)}while(ft!==0);Y.gzhead.hcrc&&Y.pending>q&&(D.adler=f(D.adler,Y.pending_buf,Y.pending-q,q)),ft===0&&(Y.status=103)}else Y.status=103;if(Y.status===103&&(Y.gzhead.hcrc?(Y.pending+2>Y.pending_buf_size&&J(D),Y.pending+2<=Y.pending_buf_size&&(ut(Y,255&D.adler),ut(Y,D.adler>>8&255),D.adler=0,Y.status=tt)):Y.status=tt),Y.pending!==0){if(J(D),D.avail_out===0)return Y.last_flush=-1,v}else if(D.avail_in===0&&yt(dt)<=yt(st)&&dt!==m)return Rt(D,-5);if(Y.status===666&&D.avail_in!==0)return Rt(D,-5);if(D.avail_in!==0||Y.lookahead!==0||dt!==p&&Y.status!==666){var jt=Y.strategy===2?function(wt,Nt){for(var At;;){if(wt.lookahead===0&&(Bt(wt),wt.lookahead===0)){if(Nt===p)return L;break}if(wt.match_length=0,At=l._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++,At&&(G(wt,!1),wt.strm.avail_out===0))return L}return wt.insert=0,Nt===m?(G(wt,!0),wt.strm.avail_out===0?Q:X):wt.last_lit&&(G(wt,!1),wt.strm.avail_out===0)?L:nt}(Y,dt):Y.strategy===3?function(wt,Nt){for(var At,pt,te,ae,ne=wt.window;;){if(wt.lookahead<=F){if(Bt(wt),wt.lookahead<=F&&Nt===p)return L;if(wt.lookahead===0)break}if(wt.match_length=0,wt.lookahead>=I&&0<wt.strstart&&(pt=ne[te=wt.strstart-1])===ne[++te]&&pt===ne[++te]&&pt===ne[++te]){ae=wt.strstart+F;do;while(pt===ne[++te]&&pt===ne[++te]&&pt===ne[++te]&&pt===ne[++te]&&pt===ne[++te]&&pt===ne[++te]&&pt===ne[++te]&&pt===ne[++te]&&te<ae);wt.match_length=F-(ae-te),wt.match_length>wt.lookahead&&(wt.match_length=wt.lookahead)}if(wt.match_length>=I?(At=l._tr_tally(wt,1,wt.match_length-I),wt.lookahead-=wt.match_length,wt.strstart+=wt.match_length,wt.match_length=0):(At=l._tr_tally(wt,0,wt.window[wt.strstart]),wt.lookahead--,wt.strstart++),At&&(G(wt,!1),wt.strm.avail_out===0))return L}return wt.insert=0,Nt===m?(G(wt,!0),wt.strm.avail_out===0?Q:X):wt.last_lit&&(G(wt,!1),wt.strm.avail_out===0)?L:nt}(Y,dt):s[Y.level].func(Y,dt);if(jt!==Q&&jt!==X||(Y.status=666),jt===L||jt===Q)return D.avail_out===0&&(Y.last_flush=-1),v;if(jt===nt&&(dt===1?l._tr_align(Y):dt!==5&&(l._tr_stored_block(Y,0,0,!1),dt===3&&(j(Y.head),Y.lookahead===0&&(Y.strstart=0,Y.block_start=0,Y.insert=0))),J(D),D.avail_out===0))return Y.last_flush=-1,v}return dt!==m?v:Y.wrap<=0?1:(Y.wrap===2?(ut(Y,255&D.adler),ut(Y,D.adler>>8&255),ut(Y,D.adler>>16&255),ut(Y,D.adler>>24&255),ut(Y,255&D.total_in),ut(Y,D.total_in>>8&255),ut(Y,D.total_in>>16&255),ut(Y,D.total_in>>24&255)):(gt(Y,D.adler>>>16),gt(Y,65535&D.adler)),J(D),0<Y.wrap&&(Y.wrap=-Y.wrap),Y.pending!==0?v:1)},r.deflateEnd=function(D){var dt;return D&&D.state?(dt=D.state.status)!==P&&dt!==69&&dt!==73&&dt!==91&&dt!==103&&dt!==tt&&dt!==666?Rt(D,x):(D.state=null,dt===tt?Rt(D,-3):v):x},r.deflateSetDictionary=function(D,dt){var st,Y,q,ft,Pt,jt,wt,Nt,At=dt.length;if(!D||!D.state||(ft=(st=D.state).wrap)===2||ft===1&&st.status!==P||st.lookahead)return x;for(ft===1&&(D.adler=u(D.adler,dt,At,0)),st.wrap=0,At>=st.w_size&&(ft===0&&(j(st.head),st.strstart=0,st.block_start=0,st.insert=0),Nt=new a.Buf8(st.w_size),a.arraySet(Nt,dt,At-st.w_size,st.w_size,0),dt=Nt,At=st.w_size),Pt=D.avail_in,jt=D.next_in,wt=D.input,D.avail_in=At,D.next_in=0,D.input=dt,Bt(st);st.lookahead>=I;){for(Y=st.strstart,q=st.lookahead-(I-1);st.ins_h=(st.ins_h<<st.hash_shift^st.window[Y+I-1])&st.hash_mask,st.prev[Y&st.w_mask]=st.head[st.ins_h],st.head[st.ins_h]=Y,Y++,--q;);st.strstart=Y,st.lookahead=I-1,Bt(st)}return st.strstart+=st.lookahead,st.block_start=st.strstart,st.insert=st.lookahead,st.lookahead=0,st.match_length=st.prev_length=I-1,st.match_available=0,D.next_in=jt,D.input=wt,D.avail_in=Pt,st.wrap=ft,v},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,i,r){i.exports=function(s,a){var l,u,f,d,p,m,v,x,_,b,E,T,S,O,R,N,C,M,I,F,z,P,tt,L,nt;l=s.state,u=s.next_in,L=s.input,f=u+(s.avail_in-5),d=s.next_out,nt=s.output,p=d-(a-s.avail_out),m=d+(s.avail_out-257),v=l.dmax,x=l.wsize,_=l.whave,b=l.wnext,E=l.window,T=l.hold,S=l.bits,O=l.lencode,R=l.distcode,N=(1<<l.lenbits)-1,C=(1<<l.distbits)-1;t:do{S<15&&(T+=L[u++]<<S,S+=8,T+=L[u++]<<S,S+=8),M=O[T&N];e:for(;;){if(T>>>=I=M>>>24,S-=I,(I=M>>>16&255)===0)nt[d++]=65535&M;else{if(!(16&I)){if((64&I)==0){M=O[(65535&M)+(T&(1<<I)-1)];continue e}if(32&I){l.mode=12;break t}s.msg="invalid literal/length code",l.mode=30;break t}F=65535&M,(I&=15)&&(S<I&&(T+=L[u++]<<S,S+=8),F+=T&(1<<I)-1,T>>>=I,S-=I),S<15&&(T+=L[u++]<<S,S+=8,T+=L[u++]<<S,S+=8),M=R[T&C];n:for(;;){if(T>>>=I=M>>>24,S-=I,!(16&(I=M>>>16&255))){if((64&I)==0){M=R[(65535&M)+(T&(1<<I)-1)];continue n}s.msg="invalid distance code",l.mode=30;break t}if(z=65535&M,S<(I&=15)&&(T+=L[u++]<<S,(S+=8)<I&&(T+=L[u++]<<S,S+=8)),v<(z+=T&(1<<I)-1)){s.msg="invalid distance too far back",l.mode=30;break t}if(T>>>=I,S-=I,(I=d-p)<z){if(_<(I=z-I)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break t}if(tt=E,(P=0)===b){if(P+=x-I,I<F){for(F-=I;nt[d++]=E[P++],--I;);P=d-z,tt=nt}}else if(b<I){if(P+=x+b-I,(I-=b)<F){for(F-=I;nt[d++]=E[P++],--I;);if(P=0,b<F){for(F-=I=b;nt[d++]=E[P++],--I;);P=d-z,tt=nt}}}else if(P+=b-I,I<F){for(F-=I;nt[d++]=E[P++],--I;);P=d-z,tt=nt}for(;2<F;)nt[d++]=tt[P++],nt[d++]=tt[P++],nt[d++]=tt[P++],F-=3;F&&(nt[d++]=tt[P++],1<F&&(nt[d++]=tt[P++]))}else{for(P=d-z;nt[d++]=nt[P++],nt[d++]=nt[P++],nt[d++]=nt[P++],2<(F-=3););F&&(nt[d++]=nt[P++],1<F&&(nt[d++]=nt[P++]))}break}}break}}while(u<f&&d<m);u-=F=S>>3,T&=(1<<(S-=F<<3))-1,s.next_in=u,s.next_out=d,s.avail_in=u<f?f-u+5:5-(u-f),s.avail_out=d<m?m-d+257:257-(d-m),l.hold=T,l.bits=S}},{}],49:[function(e,i,r){var s=e("../utils/common"),a=e("./adler32"),l=e("./crc32"),u=e("./inffast"),f=e("./inftrees"),d=1,p=2,m=0,v=-2,x=1,_=852,b=592;function E(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function T(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(P){var tt;return P&&P.state?(tt=P.state,P.total_in=P.total_out=tt.total=0,P.msg="",tt.wrap&&(P.adler=1&tt.wrap),tt.mode=x,tt.last=0,tt.havedict=0,tt.dmax=32768,tt.head=null,tt.hold=0,tt.bits=0,tt.lencode=tt.lendyn=new s.Buf32(_),tt.distcode=tt.distdyn=new s.Buf32(b),tt.sane=1,tt.back=-1,m):v}function O(P){var tt;return P&&P.state?((tt=P.state).wsize=0,tt.whave=0,tt.wnext=0,S(P)):v}function R(P,tt){var L,nt;return P&&P.state?(nt=P.state,tt<0?(L=0,tt=-tt):(L=1+(tt>>4),tt<48&&(tt&=15)),tt&&(tt<8||15<tt)?v:(nt.window!==null&&nt.wbits!==tt&&(nt.window=null),nt.wrap=L,nt.wbits=tt,O(P))):v}function N(P,tt){var L,nt;return P?(nt=new T,(P.state=nt).window=null,(L=R(P,tt))!==m&&(P.state=null),L):v}var C,M,I=!0;function F(P){if(I){var tt;for(C=new s.Buf32(512),M=new s.Buf32(32),tt=0;tt<144;)P.lens[tt++]=8;for(;tt<256;)P.lens[tt++]=9;for(;tt<280;)P.lens[tt++]=7;for(;tt<288;)P.lens[tt++]=8;for(f(d,P.lens,0,288,C,0,P.work,{bits:9}),tt=0;tt<32;)P.lens[tt++]=5;f(p,P.lens,0,32,M,0,P.work,{bits:5}),I=!1}P.lencode=C,P.lenbits=9,P.distcode=M,P.distbits=5}function z(P,tt,L,nt){var Q,X=P.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new s.Buf8(X.wsize)),nt>=X.wsize?(s.arraySet(X.window,tt,L-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):(nt<(Q=X.wsize-X.wnext)&&(Q=nt),s.arraySet(X.window,tt,L-nt,Q,X.wnext),(nt-=Q)?(s.arraySet(X.window,tt,L-nt,nt,0),X.wnext=nt,X.whave=X.wsize):(X.wnext+=Q,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=Q))),0}r.inflateReset=O,r.inflateReset2=R,r.inflateResetKeep=S,r.inflateInit=function(P){return N(P,15)},r.inflateInit2=N,r.inflate=function(P,tt){var L,nt,Q,X,Rt,yt,j,J,G,ut,gt,_t,Bt,Gt,H,mt,lt,ct,Ct,Lt,D,dt,st,Y,q=0,ft=new s.Buf8(4),Pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return v;(L=P.state).mode===12&&(L.mode=13),Rt=P.next_out,Q=P.output,j=P.avail_out,X=P.next_in,nt=P.input,yt=P.avail_in,J=L.hold,G=L.bits,ut=yt,gt=j,dt=m;t:for(;;)switch(L.mode){case x:if(L.wrap===0){L.mode=13;break}for(;G<16;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if(2&L.wrap&&J===35615){ft[L.check=0]=255&J,ft[1]=J>>>8&255,L.check=l(L.check,ft,2,0),G=J=0,L.mode=2;break}if(L.flags=0,L.head&&(L.head.done=!1),!(1&L.wrap)||(((255&J)<<8)+(J>>8))%31){P.msg="incorrect header check",L.mode=30;break}if((15&J)!=8){P.msg="unknown compression method",L.mode=30;break}if(G-=4,D=8+(15&(J>>>=4)),L.wbits===0)L.wbits=D;else if(D>L.wbits){P.msg="invalid window size",L.mode=30;break}L.dmax=1<<D,P.adler=L.check=1,L.mode=512&J?10:12,G=J=0;break;case 2:for(;G<16;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if(L.flags=J,(255&L.flags)!=8){P.msg="unknown compression method",L.mode=30;break}if(57344&L.flags){P.msg="unknown header flags set",L.mode=30;break}L.head&&(L.head.text=J>>8&1),512&L.flags&&(ft[0]=255&J,ft[1]=J>>>8&255,L.check=l(L.check,ft,2,0)),G=J=0,L.mode=3;case 3:for(;G<32;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}L.head&&(L.head.time=J),512&L.flags&&(ft[0]=255&J,ft[1]=J>>>8&255,ft[2]=J>>>16&255,ft[3]=J>>>24&255,L.check=l(L.check,ft,4,0)),G=J=0,L.mode=4;case 4:for(;G<16;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}L.head&&(L.head.xflags=255&J,L.head.os=J>>8),512&L.flags&&(ft[0]=255&J,ft[1]=J>>>8&255,L.check=l(L.check,ft,2,0)),G=J=0,L.mode=5;case 5:if(1024&L.flags){for(;G<16;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}L.length=J,L.head&&(L.head.extra_len=J),512&L.flags&&(ft[0]=255&J,ft[1]=J>>>8&255,L.check=l(L.check,ft,2,0)),G=J=0}else L.head&&(L.head.extra=null);L.mode=6;case 6:if(1024&L.flags&&(yt<(_t=L.length)&&(_t=yt),_t&&(L.head&&(D=L.head.extra_len-L.length,L.head.extra||(L.head.extra=new Array(L.head.extra_len)),s.arraySet(L.head.extra,nt,X,_t,D)),512&L.flags&&(L.check=l(L.check,nt,_t,X)),yt-=_t,X+=_t,L.length-=_t),L.length))break t;L.length=0,L.mode=7;case 7:if(2048&L.flags){if(yt===0)break t;for(_t=0;D=nt[X+_t++],L.head&&D&&L.length<65536&&(L.head.name+=String.fromCharCode(D)),D&&_t<yt;);if(512&L.flags&&(L.check=l(L.check,nt,_t,X)),yt-=_t,X+=_t,D)break t}else L.head&&(L.head.name=null);L.length=0,L.mode=8;case 8:if(4096&L.flags){if(yt===0)break t;for(_t=0;D=nt[X+_t++],L.head&&D&&L.length<65536&&(L.head.comment+=String.fromCharCode(D)),D&&_t<yt;);if(512&L.flags&&(L.check=l(L.check,nt,_t,X)),yt-=_t,X+=_t,D)break t}else L.head&&(L.head.comment=null);L.mode=9;case 9:if(512&L.flags){for(;G<16;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if(J!==(65535&L.check)){P.msg="header crc mismatch",L.mode=30;break}G=J=0}L.head&&(L.head.hcrc=L.flags>>9&1,L.head.done=!0),P.adler=L.check=0,L.mode=12;break;case 10:for(;G<32;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}P.adler=L.check=E(J),G=J=0,L.mode=11;case 11:if(L.havedict===0)return P.next_out=Rt,P.avail_out=j,P.next_in=X,P.avail_in=yt,L.hold=J,L.bits=G,2;P.adler=L.check=1,L.mode=12;case 12:if(tt===5||tt===6)break t;case 13:if(L.last){J>>>=7&G,G-=7&G,L.mode=27;break}for(;G<3;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}switch(L.last=1&J,G-=1,3&(J>>>=1)){case 0:L.mode=14;break;case 1:if(F(L),L.mode=20,tt!==6)break;J>>>=2,G-=2;break t;case 2:L.mode=17;break;case 3:P.msg="invalid block type",L.mode=30}J>>>=2,G-=2;break;case 14:for(J>>>=7&G,G-=7&G;G<32;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if((65535&J)!=(J>>>16^65535)){P.msg="invalid stored block lengths",L.mode=30;break}if(L.length=65535&J,G=J=0,L.mode=15,tt===6)break t;case 15:L.mode=16;case 16:if(_t=L.length){if(yt<_t&&(_t=yt),j<_t&&(_t=j),_t===0)break t;s.arraySet(Q,nt,X,_t,Rt),yt-=_t,X+=_t,j-=_t,Rt+=_t,L.length-=_t;break}L.mode=12;break;case 17:for(;G<14;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if(L.nlen=257+(31&J),J>>>=5,G-=5,L.ndist=1+(31&J),J>>>=5,G-=5,L.ncode=4+(15&J),J>>>=4,G-=4,286<L.nlen||30<L.ndist){P.msg="too many length or distance symbols",L.mode=30;break}L.have=0,L.mode=18;case 18:for(;L.have<L.ncode;){for(;G<3;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}L.lens[Pt[L.have++]]=7&J,J>>>=3,G-=3}for(;L.have<19;)L.lens[Pt[L.have++]]=0;if(L.lencode=L.lendyn,L.lenbits=7,st={bits:L.lenbits},dt=f(0,L.lens,0,19,L.lencode,0,L.work,st),L.lenbits=st.bits,dt){P.msg="invalid code lengths set",L.mode=30;break}L.have=0,L.mode=19;case 19:for(;L.have<L.nlen+L.ndist;){for(;mt=(q=L.lencode[J&(1<<L.lenbits)-1])>>>16&255,lt=65535&q,!((H=q>>>24)<=G);){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if(lt<16)J>>>=H,G-=H,L.lens[L.have++]=lt;else{if(lt===16){for(Y=H+2;G<Y;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if(J>>>=H,G-=H,L.have===0){P.msg="invalid bit length repeat",L.mode=30;break}D=L.lens[L.have-1],_t=3+(3&J),J>>>=2,G-=2}else if(lt===17){for(Y=H+3;G<Y;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}G-=H,D=0,_t=3+(7&(J>>>=H)),J>>>=3,G-=3}else{for(Y=H+7;G<Y;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}G-=H,D=0,_t=11+(127&(J>>>=H)),J>>>=7,G-=7}if(L.have+_t>L.nlen+L.ndist){P.msg="invalid bit length repeat",L.mode=30;break}for(;_t--;)L.lens[L.have++]=D}}if(L.mode===30)break;if(L.lens[256]===0){P.msg="invalid code -- missing end-of-block",L.mode=30;break}if(L.lenbits=9,st={bits:L.lenbits},dt=f(d,L.lens,0,L.nlen,L.lencode,0,L.work,st),L.lenbits=st.bits,dt){P.msg="invalid literal/lengths set",L.mode=30;break}if(L.distbits=6,L.distcode=L.distdyn,st={bits:L.distbits},dt=f(p,L.lens,L.nlen,L.ndist,L.distcode,0,L.work,st),L.distbits=st.bits,dt){P.msg="invalid distances set",L.mode=30;break}if(L.mode=20,tt===6)break t;case 20:L.mode=21;case 21:if(6<=yt&&258<=j){P.next_out=Rt,P.avail_out=j,P.next_in=X,P.avail_in=yt,L.hold=J,L.bits=G,u(P,gt),Rt=P.next_out,Q=P.output,j=P.avail_out,X=P.next_in,nt=P.input,yt=P.avail_in,J=L.hold,G=L.bits,L.mode===12&&(L.back=-1);break}for(L.back=0;mt=(q=L.lencode[J&(1<<L.lenbits)-1])>>>16&255,lt=65535&q,!((H=q>>>24)<=G);){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if(mt&&(240&mt)==0){for(ct=H,Ct=mt,Lt=lt;mt=(q=L.lencode[Lt+((J&(1<<ct+Ct)-1)>>ct)])>>>16&255,lt=65535&q,!(ct+(H=q>>>24)<=G);){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}J>>>=ct,G-=ct,L.back+=ct}if(J>>>=H,G-=H,L.back+=H,L.length=lt,mt===0){L.mode=26;break}if(32&mt){L.back=-1,L.mode=12;break}if(64&mt){P.msg="invalid literal/length code",L.mode=30;break}L.extra=15&mt,L.mode=22;case 22:if(L.extra){for(Y=L.extra;G<Y;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}L.length+=J&(1<<L.extra)-1,J>>>=L.extra,G-=L.extra,L.back+=L.extra}L.was=L.length,L.mode=23;case 23:for(;mt=(q=L.distcode[J&(1<<L.distbits)-1])>>>16&255,lt=65535&q,!((H=q>>>24)<=G);){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if((240&mt)==0){for(ct=H,Ct=mt,Lt=lt;mt=(q=L.distcode[Lt+((J&(1<<ct+Ct)-1)>>ct)])>>>16&255,lt=65535&q,!(ct+(H=q>>>24)<=G);){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}J>>>=ct,G-=ct,L.back+=ct}if(J>>>=H,G-=H,L.back+=H,64&mt){P.msg="invalid distance code",L.mode=30;break}L.offset=lt,L.extra=15&mt,L.mode=24;case 24:if(L.extra){for(Y=L.extra;G<Y;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}L.offset+=J&(1<<L.extra)-1,J>>>=L.extra,G-=L.extra,L.back+=L.extra}if(L.offset>L.dmax){P.msg="invalid distance too far back",L.mode=30;break}L.mode=25;case 25:if(j===0)break t;if(_t=gt-j,L.offset>_t){if((_t=L.offset-_t)>L.whave&&L.sane){P.msg="invalid distance too far back",L.mode=30;break}Bt=_t>L.wnext?(_t-=L.wnext,L.wsize-_t):L.wnext-_t,_t>L.length&&(_t=L.length),Gt=L.window}else Gt=Q,Bt=Rt-L.offset,_t=L.length;for(j<_t&&(_t=j),j-=_t,L.length-=_t;Q[Rt++]=Gt[Bt++],--_t;);L.length===0&&(L.mode=21);break;case 26:if(j===0)break t;Q[Rt++]=L.length,j--,L.mode=21;break;case 27:if(L.wrap){for(;G<32;){if(yt===0)break t;yt--,J|=nt[X++]<<G,G+=8}if(gt-=j,P.total_out+=gt,L.total+=gt,gt&&(P.adler=L.check=L.flags?l(L.check,Q,gt,Rt-gt):a(L.check,Q,gt,Rt-gt)),gt=j,(L.flags?J:E(J))!==L.check){P.msg="incorrect data check",L.mode=30;break}G=J=0}L.mode=28;case 28:if(L.wrap&&L.flags){for(;G<32;){if(yt===0)break t;yt--,J+=nt[X++]<<G,G+=8}if(J!==(4294967295&L.total)){P.msg="incorrect length check",L.mode=30;break}G=J=0}L.mode=29;case 29:dt=1;break t;case 30:dt=-3;break t;case 31:return-4;case 32:default:return v}return P.next_out=Rt,P.avail_out=j,P.next_in=X,P.avail_in=yt,L.hold=J,L.bits=G,(L.wsize||gt!==P.avail_out&&L.mode<30&&(L.mode<27||tt!==4))&&z(P,P.output,P.next_out,gt-P.avail_out)?(L.mode=31,-4):(ut-=P.avail_in,gt-=P.avail_out,P.total_in+=ut,P.total_out+=gt,L.total+=gt,L.wrap&&gt&&(P.adler=L.check=L.flags?l(L.check,Q,gt,P.next_out-gt):a(L.check,Q,gt,P.next_out-gt)),P.data_type=L.bits+(L.last?64:0)+(L.mode===12?128:0)+(L.mode===20||L.mode===15?256:0),(ut==0&&gt===0||tt===4)&&dt===m&&(dt=-5),dt)},r.inflateEnd=function(P){if(!P||!P.state)return v;var tt=P.state;return tt.window&&(tt.window=null),P.state=null,m},r.inflateGetHeader=function(P,tt){var L;return P&&P.state?(2&(L=P.state).wrap)==0?v:((L.head=tt).done=!1,m):v},r.inflateSetDictionary=function(P,tt){var L,nt=tt.length;return P&&P.state?(L=P.state).wrap!==0&&L.mode!==11?v:L.mode===11&&a(1,tt,nt,0)!==L.check?-3:z(P,tt,nt,nt)?(L.mode=31,-4):(L.havedict=1,m):v},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,i,r){var s=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(d,p,m,v,x,_,b,E){var T,S,O,R,N,C,M,I,F,z=E.bits,P=0,tt=0,L=0,nt=0,Q=0,X=0,Rt=0,yt=0,j=0,J=0,G=null,ut=0,gt=new s.Buf16(16),_t=new s.Buf16(16),Bt=null,Gt=0;for(P=0;P<=15;P++)gt[P]=0;for(tt=0;tt<v;tt++)gt[p[m+tt]]++;for(Q=z,nt=15;1<=nt&&gt[nt]===0;nt--);if(nt<Q&&(Q=nt),nt===0)return x[_++]=20971520,x[_++]=20971520,E.bits=1,0;for(L=1;L<nt&&gt[L]===0;L++);for(Q<L&&(Q=L),P=yt=1;P<=15;P++)if(yt<<=1,(yt-=gt[P])<0)return-1;if(0<yt&&(d===0||nt!==1))return-1;for(_t[1]=0,P=1;P<15;P++)_t[P+1]=_t[P]+gt[P];for(tt=0;tt<v;tt++)p[m+tt]!==0&&(b[_t[p[m+tt]]++]=tt);if(C=d===0?(G=Bt=b,19):d===1?(G=a,ut-=257,Bt=l,Gt-=257,256):(G=u,Bt=f,-1),P=L,N=_,Rt=tt=J=0,O=-1,R=(j=1<<(X=Q))-1,d===1&&852<j||d===2&&592<j)return 1;for(;;){for(M=P-Rt,F=b[tt]<C?(I=0,b[tt]):b[tt]>C?(I=Bt[Gt+b[tt]],G[ut+b[tt]]):(I=96,0),T=1<<P-Rt,L=S=1<<X;x[N+(J>>Rt)+(S-=T)]=M<<24|I<<16|F|0,S!==0;);for(T=1<<P-1;J&T;)T>>=1;if(T!==0?(J&=T-1,J+=T):J=0,tt++,--gt[P]==0){if(P===nt)break;P=p[m+b[tt]]}if(Q<P&&(J&R)!==O){for(Rt===0&&(Rt=Q),N+=L,yt=1<<(X=P-Rt);X+Rt<nt&&!((yt-=gt[X+Rt])<=0);)X++,yt<<=1;if(j+=1<<X,d===1&&852<j||d===2&&592<j)return 1;x[O=J&R]=Q<<24|X<<16|N-_|0}}return J!==0&&(x[N+J]=P-Rt<<24|64<<16|0),E.bits=Q,0}},{"../utils/common":41}],51:[function(e,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,i,r){var s=e("../utils/common"),a=0,l=1;function u(q){for(var ft=q.length;0<=--ft;)q[ft]=0}var f=0,d=29,p=256,m=p+1+d,v=30,x=19,_=2*m+1,b=15,E=16,T=7,S=256,O=16,R=17,N=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],M=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(2*(m+2));u(z);var P=new Array(2*v);u(P);var tt=new Array(512);u(tt);var L=new Array(256);u(L);var nt=new Array(d);u(nt);var Q,X,Rt,yt=new Array(v);function j(q,ft,Pt,jt,wt){this.static_tree=q,this.extra_bits=ft,this.extra_base=Pt,this.elems=jt,this.max_length=wt,this.has_stree=q&&q.length}function J(q,ft){this.dyn_tree=q,this.max_code=0,this.stat_desc=ft}function G(q){return q<256?tt[q]:tt[256+(q>>>7)]}function ut(q,ft){q.pending_buf[q.pending++]=255&ft,q.pending_buf[q.pending++]=ft>>>8&255}function gt(q,ft,Pt){q.bi_valid>E-Pt?(q.bi_buf|=ft<<q.bi_valid&65535,ut(q,q.bi_buf),q.bi_buf=ft>>E-q.bi_valid,q.bi_valid+=Pt-E):(q.bi_buf|=ft<<q.bi_valid&65535,q.bi_valid+=Pt)}function _t(q,ft,Pt){gt(q,Pt[2*ft],Pt[2*ft+1])}function Bt(q,ft){for(var Pt=0;Pt|=1&q,q>>>=1,Pt<<=1,0<--ft;);return Pt>>>1}function Gt(q,ft,Pt){var jt,wt,Nt=new Array(b+1),At=0;for(jt=1;jt<=b;jt++)Nt[jt]=At=At+Pt[jt-1]<<1;for(wt=0;wt<=ft;wt++){var pt=q[2*wt+1];pt!==0&&(q[2*wt]=Bt(Nt[pt]++,pt))}}function H(q){var ft;for(ft=0;ft<m;ft++)q.dyn_ltree[2*ft]=0;for(ft=0;ft<v;ft++)q.dyn_dtree[2*ft]=0;for(ft=0;ft<x;ft++)q.bl_tree[2*ft]=0;q.dyn_ltree[2*S]=1,q.opt_len=q.static_len=0,q.last_lit=q.matches=0}function mt(q){8<q.bi_valid?ut(q,q.bi_buf):0<q.bi_valid&&(q.pending_buf[q.pending++]=q.bi_buf),q.bi_buf=0,q.bi_valid=0}function lt(q,ft,Pt,jt){var wt=2*ft,Nt=2*Pt;return q[wt]<q[Nt]||q[wt]===q[Nt]&&jt[ft]<=jt[Pt]}function ct(q,ft,Pt){for(var jt=q.heap[Pt],wt=Pt<<1;wt<=q.heap_len&&(wt<q.heap_len&&lt(ft,q.heap[wt+1],q.heap[wt],q.depth)&&wt++,!lt(ft,jt,q.heap[wt],q.depth));)q.heap[Pt]=q.heap[wt],Pt=wt,wt<<=1;q.heap[Pt]=jt}function Ct(q,ft,Pt){var jt,wt,Nt,At,pt=0;if(q.last_lit!==0)for(;jt=q.pending_buf[q.d_buf+2*pt]<<8|q.pending_buf[q.d_buf+2*pt+1],wt=q.pending_buf[q.l_buf+pt],pt++,jt===0?_t(q,wt,ft):(_t(q,(Nt=L[wt])+p+1,ft),(At=C[Nt])!==0&&gt(q,wt-=nt[Nt],At),_t(q,Nt=G(--jt),Pt),(At=M[Nt])!==0&&gt(q,jt-=yt[Nt],At)),pt<q.last_lit;);_t(q,S,ft)}function Lt(q,ft){var Pt,jt,wt,Nt=ft.dyn_tree,At=ft.stat_desc.static_tree,pt=ft.stat_desc.has_stree,te=ft.stat_desc.elems,ae=-1;for(q.heap_len=0,q.heap_max=_,Pt=0;Pt<te;Pt++)Nt[2*Pt]!==0?(q.heap[++q.heap_len]=ae=Pt,q.depth[Pt]=0):Nt[2*Pt+1]=0;for(;q.heap_len<2;)Nt[2*(wt=q.heap[++q.heap_len]=ae<2?++ae:0)]=1,q.depth[wt]=0,q.opt_len--,pt&&(q.static_len-=At[2*wt+1]);for(ft.max_code=ae,Pt=q.heap_len>>1;1<=Pt;Pt--)ct(q,Nt,Pt);for(wt=te;Pt=q.heap[1],q.heap[1]=q.heap[q.heap_len--],ct(q,Nt,1),jt=q.heap[1],q.heap[--q.heap_max]=Pt,q.heap[--q.heap_max]=jt,Nt[2*wt]=Nt[2*Pt]+Nt[2*jt],q.depth[wt]=(q.depth[Pt]>=q.depth[jt]?q.depth[Pt]:q.depth[jt])+1,Nt[2*Pt+1]=Nt[2*jt+1]=wt,q.heap[1]=wt++,ct(q,Nt,1),2<=q.heap_len;);q.heap[--q.heap_max]=q.heap[1],function(ne,Re){var rn,ye,ln,Ve,zn,Cn,bn=Re.dyn_tree,mi=Re.max_code,vs=Re.stat_desc.static_tree,Gs=Re.stat_desc.has_stree,Xa=Re.stat_desc.extra_bits,Vs=Re.stat_desc.extra_base,wi=Re.stat_desc.max_length,Or=0;for(Ve=0;Ve<=b;Ve++)ne.bl_count[Ve]=0;for(bn[2*ne.heap[ne.heap_max]+1]=0,rn=ne.heap_max+1;rn<_;rn++)wi<(Ve=bn[2*bn[2*(ye=ne.heap[rn])+1]+1]+1)&&(Ve=wi,Or++),bn[2*ye+1]=Ve,mi<ye||(ne.bl_count[Ve]++,zn=0,Vs<=ye&&(zn=Xa[ye-Vs]),Cn=bn[2*ye],ne.opt_len+=Cn*(Ve+zn),Gs&&(ne.static_len+=Cn*(vs[2*ye+1]+zn)));if(Or!==0){do{for(Ve=wi-1;ne.bl_count[Ve]===0;)Ve--;ne.bl_count[Ve]--,ne.bl_count[Ve+1]+=2,ne.bl_count[wi]--,Or-=2}while(0<Or);for(Ve=wi;Ve!==0;Ve--)for(ye=ne.bl_count[Ve];ye!==0;)mi<(ln=ne.heap[--rn])||(bn[2*ln+1]!==Ve&&(ne.opt_len+=(Ve-bn[2*ln+1])*bn[2*ln],bn[2*ln+1]=Ve),ye--)}}(q,ft),Gt(Nt,ae,q.bl_count)}function D(q,ft,Pt){var jt,wt,Nt=-1,At=ft[1],pt=0,te=7,ae=4;for(At===0&&(te=138,ae=3),ft[2*(Pt+1)+1]=65535,jt=0;jt<=Pt;jt++)wt=At,At=ft[2*(jt+1)+1],++pt<te&&wt===At||(pt<ae?q.bl_tree[2*wt]+=pt:wt!==0?(wt!==Nt&&q.bl_tree[2*wt]++,q.bl_tree[2*O]++):pt<=10?q.bl_tree[2*R]++:q.bl_tree[2*N]++,Nt=wt,ae=(pt=0)===At?(te=138,3):wt===At?(te=6,3):(te=7,4))}function dt(q,ft,Pt){var jt,wt,Nt=-1,At=ft[1],pt=0,te=7,ae=4;for(At===0&&(te=138,ae=3),jt=0;jt<=Pt;jt++)if(wt=At,At=ft[2*(jt+1)+1],!(++pt<te&&wt===At)){if(pt<ae)for(;_t(q,wt,q.bl_tree),--pt!=0;);else wt!==0?(wt!==Nt&&(_t(q,wt,q.bl_tree),pt--),_t(q,O,q.bl_tree),gt(q,pt-3,2)):pt<=10?(_t(q,R,q.bl_tree),gt(q,pt-3,3)):(_t(q,N,q.bl_tree),gt(q,pt-11,7));Nt=wt,ae=(pt=0)===At?(te=138,3):wt===At?(te=6,3):(te=7,4)}}u(yt);var st=!1;function Y(q,ft,Pt,jt){gt(q,(f<<1)+(jt?1:0),3),function(wt,Nt,At,pt){mt(wt),ut(wt,At),ut(wt,~At),s.arraySet(wt.pending_buf,wt.window,Nt,At,wt.pending),wt.pending+=At}(q,ft,Pt)}r._tr_init=function(q){st||(function(){var ft,Pt,jt,wt,Nt,At=new Array(b+1);for(wt=jt=0;wt<d-1;wt++)for(nt[wt]=jt,ft=0;ft<1<<C[wt];ft++)L[jt++]=wt;for(L[jt-1]=wt,wt=Nt=0;wt<16;wt++)for(yt[wt]=Nt,ft=0;ft<1<<M[wt];ft++)tt[Nt++]=wt;for(Nt>>=7;wt<v;wt++)for(yt[wt]=Nt<<7,ft=0;ft<1<<M[wt]-7;ft++)tt[256+Nt++]=wt;for(Pt=0;Pt<=b;Pt++)At[Pt]=0;for(ft=0;ft<=143;)z[2*ft+1]=8,ft++,At[8]++;for(;ft<=255;)z[2*ft+1]=9,ft++,At[9]++;for(;ft<=279;)z[2*ft+1]=7,ft++,At[7]++;for(;ft<=287;)z[2*ft+1]=8,ft++,At[8]++;for(Gt(z,m+1,At),ft=0;ft<v;ft++)P[2*ft+1]=5,P[2*ft]=Bt(ft,5);Q=new j(z,C,p+1,m,b),X=new j(P,M,0,v,b),Rt=new j(new Array(0),I,0,x,T)}(),st=!0),q.l_desc=new J(q.dyn_ltree,Q),q.d_desc=new J(q.dyn_dtree,X),q.bl_desc=new J(q.bl_tree,Rt),q.bi_buf=0,q.bi_valid=0,H(q)},r._tr_stored_block=Y,r._tr_flush_block=function(q,ft,Pt,jt){var wt,Nt,At=0;0<q.level?(q.strm.data_type===2&&(q.strm.data_type=function(pt){var te,ae=4093624447;for(te=0;te<=31;te++,ae>>>=1)if(1&ae&&pt.dyn_ltree[2*te]!==0)return a;if(pt.dyn_ltree[18]!==0||pt.dyn_ltree[20]!==0||pt.dyn_ltree[26]!==0)return l;for(te=32;te<p;te++)if(pt.dyn_ltree[2*te]!==0)return l;return a}(q)),Lt(q,q.l_desc),Lt(q,q.d_desc),At=function(pt){var te;for(D(pt,pt.dyn_ltree,pt.l_desc.max_code),D(pt,pt.dyn_dtree,pt.d_desc.max_code),Lt(pt,pt.bl_desc),te=x-1;3<=te&&pt.bl_tree[2*F[te]+1]===0;te--);return pt.opt_len+=3*(te+1)+5+5+4,te}(q),wt=q.opt_len+3+7>>>3,(Nt=q.static_len+3+7>>>3)<=wt&&(wt=Nt)):wt=Nt=Pt+5,Pt+4<=wt&&ft!==-1?Y(q,ft,Pt,jt):q.strategy===4||Nt===wt?(gt(q,2+(jt?1:0),3),Ct(q,z,P)):(gt(q,4+(jt?1:0),3),function(pt,te,ae,ne){var Re;for(gt(pt,te-257,5),gt(pt,ae-1,5),gt(pt,ne-4,4),Re=0;Re<ne;Re++)gt(pt,pt.bl_tree[2*F[Re]+1],3);dt(pt,pt.dyn_ltree,te-1),dt(pt,pt.dyn_dtree,ae-1)}(q,q.l_desc.max_code+1,q.d_desc.max_code+1,At+1),Ct(q,q.dyn_ltree,q.dyn_dtree)),H(q),jt&&mt(q)},r._tr_tally=function(q,ft,Pt){return q.pending_buf[q.d_buf+2*q.last_lit]=ft>>>8&255,q.pending_buf[q.d_buf+2*q.last_lit+1]=255&ft,q.pending_buf[q.l_buf+q.last_lit]=255&Pt,q.last_lit++,ft===0?q.dyn_ltree[2*Pt]++:(q.matches++,ft--,q.dyn_ltree[2*(L[Pt]+p+1)]++,q.dyn_dtree[2*G(ft)]++),q.last_lit===q.lit_bufsize-1},r._tr_align=function(q){gt(q,2,3),_t(q,S,z),function(ft){ft.bi_valid===16?(ut(ft,ft.bi_buf),ft.bi_buf=0,ft.bi_valid=0):8<=ft.bi_valid&&(ft.pending_buf[ft.pending++]=255&ft.bi_buf,ft.bi_buf>>=8,ft.bi_valid-=8)}(q)}},{"../utils/common":41}],53:[function(e,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,i,r){(function(s){(function(a,l){if(!a.setImmediate){var u,f,d,p,m=1,v={},x=!1,_=a.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(a);b=b&&b.setTimeout?b:a,u={}.toString.call(a.process)==="[object process]"?function(O){process.nextTick(function(){T(O)})}:function(){if(a.postMessage&&!a.importScripts){var O=!0,R=a.onmessage;return a.onmessage=function(){O=!1},a.postMessage("","*"),a.onmessage=R,O}}()?(p="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(O){a.postMessage(p+O,"*")}):a.MessageChannel?((d=new MessageChannel).port1.onmessage=function(O){T(O.data)},function(O){d.port2.postMessage(O)}):_&&"onreadystatechange"in _.createElement("script")?(f=_.documentElement,function(O){var R=_.createElement("script");R.onreadystatechange=function(){T(O),R.onreadystatechange=null,f.removeChild(R),R=null},f.appendChild(R)}):function(O){setTimeout(T,0,O)},b.setImmediate=function(O){typeof O!="function"&&(O=new Function(""+O));for(var R=new Array(arguments.length-1),N=0;N<R.length;N++)R[N]=arguments[N+1];var C={callback:O,args:R};return v[m]=C,u(m),m++},b.clearImmediate=E}function E(O){delete v[O]}function T(O){if(x)setTimeout(T,0,O);else{var R=v[O];if(R){x=!0;try{(function(N){var C=N.callback,M=N.args;switch(M.length){case 0:C();break;case 1:C(M[0]);break;case 2:C(M[0],M[1]);break;case 3:C(M[0],M[1],M[2]);break;default:C.apply(l,M)}})(R)}finally{E(O),x=!1}}}}function S(O){O.source===a&&typeof O.data=="string"&&O.data.indexOf(p)===0&&T(+O.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof K0<"u"?K0:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(Q_)),Q_.exports}var iX=nX();const rX=yf(iX),sX=({extractedTexts:n,areas:t})=>{const[e,i]=vt.useState(!1),r=n.length>0?Object.keys(n[0]).filter(v=>v!=="pageNumber"):[];vt.useEffect(()=>{document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(x=>{const _=zs.getInstance(x);_&&_.dispose(),new zs(x)})},[n,e]);const s=()=>{const v=Tf(t),x=[];n.forEach(S=>{const O={hole_id:Gr(S,v,"hole_id"),nspt:{start_depth:1,interval:1,values:[]},depths:[],geology:[]},R=Zg(S,v);R>0&&(O.max_depth=R);const N=oa(Gr(S,v,"z"));N!==-1&&(O.z=N);const C=Gr(S,v,"water_level");if(C){const P=oa(C,-1);P>=0&&(O.water_level=P)}const M=No(S,v,"depth_from_to").map(P=>oa(P)).filter(P=>P!==-1).sort((P,tt)=>P-tt);M.length>0&&!M.includes(0)&&M.unshift(0),M.length>0&&(O.depths=M);const I=No(S,v,"geology");I.length>0&&(O.geology=I);const F=No(S,v,"interp");F.length>0&&(O.interp=F);const z=No(S,v,"nspt");z.length>0&&(O.nspt={start_depth:1,interval:1,values:z}),x.push(O)});const _=JSON.stringify(x,null,2),b=new Blob([_],{type:"application/json"}),E=URL.createObjectURL(b),T=document.createElement("a");T.href=E,T.download="dados-estruturados.json",T.click(),URL.revokeObjectURL(E)},a=()=>{const v=["Página",...r],x=n.map(R=>{const N=[R.pageNumber.join(", ")];return r.forEach(C=>{const M=R[C];Array.isArray(M)?N.push(M.join("; ")):N.push(M||"")}),N}),E="\uFEFF"+[v,...x].map(R=>R.map(N=>`"${N}"`).join(",")).join(`
`),T=new Blob([E],{type:"text/csv;charset=utf-8;"}),S=URL.createObjectURL(T),O=document.createElement("a");O.href=S,O.download="dados-extraidos.csv",O.click(),URL.revokeObjectURL(S)},l=()=>{const v=n.map(b=>{const E={Página:b.pageNumber};return r.forEach(T=>{const S=b[T];Array.isArray(S)?E[T]=S.join("; "):E[T]=S||""}),E});var x=Z_.json_to_sheet(v),_=Z_.book_new();Z_.book_append_sheet(_,x,"Dados extraídos"),UY(_,"dados-pdf.xlsx")},u=v=>{const x=hT(n,t,v);if(!x){alert("Não existem todas as áreas necessárias para gerar esse arquivo");return}const b="\uFEFF"+fT(x.data,x.headers),E=new Blob([b],{type:"text/csv"}),T=URL.createObjectURL(E),S=document.createElement("a");S.href=T,S.download=x.filename,S.click(),URL.revokeObjectURL(T)},f=async()=>{const v=new rX,x="\uFEFF";["collar","nspt","na","geology","interp"].forEach(S=>{if(Om(t,S).isValid||e){const O=hT(n,t,S);if(O){const R=x+fT(O.data,O.headers);v.file(O.filename,R)}}});const b=await v.generateAsync({type:"blob"}),E=URL.createObjectURL(b),T=document.createElement("a");T.href=E,T.download="leapfrog-data.zip",T.click(),URL.revokeObjectURL(E)},d=v=>`dropdown-item${Om(t,v).isValid||e?"":" disabled"}`,m=(()=>{const v=mm.filter(x=>Om(t,x).isValid);return{validExports:v,nonValidExports:mm.filter(x=>!v.includes(x)),someValid:v.length>0,allValid:v.length===mm.length}})();return at.jsx("div",{className:"data-panel mt-5",children:!n||n.length<=0?at.jsx("div",{children:at.jsx("p",{className:"text-muted",children:"Os dados extraídos serão exibidos aqui"})}):at.jsxs(at.Fragment,{children:[at.jsx("h5",{className:"mb-3 pb-2 border-bottom",children:"Dados Extraídos"}),at.jsx("div",{className:"data-table mb-3",style:{maxHeight:"65vh",overflowY:"auto"},children:at.jsxs("table",{className:"table table-hover",children:[at.jsx("thead",{children:at.jsxs("tr",{children:[at.jsx("th",{scope:"col",style:{minWidth:"100px"},children:"#"}),r.map((v,x)=>at.jsx("th",{scope:"col",style:{minWidth:"100px"},children:v.toString()},`coluna${x}`))]})}),at.jsx("tbody",{children:n.map((v,x)=>at.jsxs("tr",{children:[at.jsx("th",{scope:"row",children:v.pageNumber}),r.map((_,b)=>{const E=v[_];return at.jsx("td",{children:Array.isArray(E)?E.join(", "):"-"},`area-${b}`)})]},`coluna-pag-${x}`))})]})}),at.jsx("hr",{className:"mt-3"}),at.jsxs("div",{className:"d-flex gap-3 mb-2",children:[at.jsxs("div",{className:"border rounded p-3 flex-grow-1",children:[at.jsx("h6",{children:"Exportar todos os dados"}),at.jsxs("div",{className:"d-flex gap-1 mt-3",children:[at.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:s,children:[at.jsx(yd,{className:"me-1",size:16}),"JSON"]}),at.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:a,children:[at.jsx(yd,{className:"me-1",size:16}),"CSV"]}),at.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:l,children:[at.jsx(yd,{className:"me-1",size:16}),"Excel"]})]})]}),at.jsxs("div",{className:"border rounded p-3 flex-grow-1",children:[at.jsx("h6",{children:"Exportar formato Leapfrog"}),at.jsx("div",{children:at.jsxs("div",{className:"btn-group dropup",children:[at.jsx("button",{className:"btn btn-secondary",type:"button",onClick:f,disabled:!m.someValid,"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"top","data-bs-title":m.allValid?"Exportar todos os arquivos":e&&m.someValid?`Exportar ${m.validExports.join(", ")} completo(s) e ${m.nonValidExports.join(", ")} incompleto(s)`:e?"Exportar todos incompletos":m.someValid?`Exportar ${m.validExports.join(", ")}`:"Dados insuficientes para gerar arquivos",children:"Exportar todos"}),at.jsx("button",{type:"button",className:"btn  btn-secondary dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:at.jsx("span",{className:"sr-only"})}),at.jsx("ul",{className:"dropdown-menu",children:mm.map(v=>{const x=Om(t,v);return at.jsx("li",{"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"left","data-bs-title":x.isValid?`Exportar ${v}.csv`:e?`Exportar ${v}.csv incompleto (dados ausentes: ${x.missingFields.map(_=>_==="depth"?"Profundidades ou Profundidade Total":Lc[_]).join(", ")})`:`Campos faltantes: ${x.missingFields.map(_=>_==="depth"?"Profundidades ou Profundidade Total":Lc[_]).join(", ")}`,children:at.jsx("button",{className:d(v),onClick:()=>u(v),children:i5[v]})},`export-leapfrog-${v}`)})})]})}),at.jsxs("div",{className:"form-check form-switch mt-2",children:[at.jsx("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"switchCheckDefault",checked:e,onChange:v=>i(v.target.checked)}),at.jsx("label",{className:"form-check-label small text-align-start",htmlFor:"switchCheckDefault",children:"Aceitar dados incompletos"})]})]})]})]})})};function aX(){const n=vt.useRef(null),[t,e]=vt.useState(null),[i,r]=vt.useState([]),[s,a]=vt.useState([]),[l,u]=vt.useState(!1),[f,d]=vt.useState(null),p=M=>{if(s.length>=15){alert("Limite de 15 áreas atingido");return}a(I=>Cj(I,M))},m=M=>{a(I=>Dj(I,M))},v=(M,I)=>{a(F=>Oj(F,M,I))},x=M=>{a(I=>Rj(I,M))},_=M=>{d(M),u(!0)},b=M=>{f&&a(I=>Nj(I,f,M)),u(!1),d(null)},E=async()=>{const M=n.current?.getDocument(),I=s.some(tt=>tt.repeatInPages),F=s.find(tt=>tt.dataType==="hole_id"),z=s.filter(tt=>!tt.coordinates).map(tt=>tt.name);if(z.length>0&&!confirm(`A(s) seguinte(s) área(s) não possue(m) coordenadas:
`+z.join(", ")+`
Deseja continuar mesmo assim?`)||!F&&I&&!confirm("Algumas áreas estão configuradas como 'Único' mas não há uma área de ID da Sondagem. A função não vai funcionar corretamente. Deseja continuar mesmo assim?")||!M)return;const P=await Mj(s,M);r(P)},T=M=>{a(M)},S=()=>{u(!1),d(null)};vt.useEffect(()=>{const M=F=>{F.key==="Escape"&&l&&S()},I=F=>{const z=document.querySelector(".pdf-container");l&&!z?.contains(F.target)&&S()};return document.addEventListener("keydown",M),document.addEventListener("mousedown",I),()=>{document.removeEventListener("keydown",M),document.removeEventListener("mousedown",I)}},[l]);const O=M=>{if(!M.destination)return;const I=M.source.index,F=M.destination.index;if(I===F)return;const z=Array.from(s),[P]=z.splice(I,1);z.splice(F,0,P);const tt=z.map((L,nt)=>({...L,order:nt+1}));a(tt)},R=(M,I)=>{a(F=>F.map(z=>z.id===M?{...z,isMandatory:I}:z))},N=(M,I)=>{a(F=>F.map(z=>z.id===M?{...z,repeatInPages:I}:z))},C=(M,I)=>{const F=mD.includes(I),z=gD.includes(I);a(P=>P.map(tt=>tt.id===M?{...tt,dataType:I,repeatInPages:F,isMandatory:z,name:vS(tt.name)&&I==="default"?$d("Nova Área",P):vS(tt.name)?$d(Lc[I],P):tt.name}:tt))};return at.jsxs(at.Fragment,{children:[l&&at.jsx("div",{className:"selection-mode-overlay"}),at.jsx("div",{className:"container-fluid text-center px-xl-5",children:at.jsxs("div",{className:"row justify-content-center",children:[at.jsx("div",{className:"col-12 col-lg-6 col-xxl-3 col-xxxl-4",style:{maxWidth:"450px",minWidth:"300px"},children:at.jsx(Ij,{children:at.jsx(Tj,{onFileSelect:e,onExtractTexts:E,onStartAreaSelection:_,onClearArea:x,onDeleteArea:m,onRenameArea:v,onAddNewArea:p,onLoadPreset:T,onDragEnd:O,onToggleMandatory:R,onToggleRepeat:N,onChangeAreaType:C,areas:s,hasFile:!!t})})}),at.jsx("div",{className:"col-12 col-lg-6 col-xxl-5 col-xxxl-4",children:at.jsx(t5,{ref:n,file:t,isSelectingActive:l,activeAreaId:f,onFinishSelection:b,areas:s})}),at.jsx("div",{className:"col-12 col-lg-6 col-xxl-4 col-xxxl-4",children:at.jsx(sX,{extractedTexts:i,areas:s})})]})})]})}function oX(){return at.jsx("div",{children:at.jsx(aX,{})})}Ak.createRoot(document.getElementById("root")).render(at.jsx(vt.StrictMode,{children:at.jsx(oX,{})}));
