var eA=n=>{throw TypeError(n)};var z1=(n,t,e)=>t.has(n)||eA("Cannot "+e);var Pn=(n,t,e)=>(z1(n,t,"read from private field"),e?e.call(n):t.get(n)),Ra=(n,t,e)=>t.has(n)?eA("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),zi=(n,t,e,r)=>(z1(n,t,"write to private field"),r?r.call(n,e):t.set(n,e),e),Na=(n,t,e)=>(z1(n,t,"access private method"),e);var nA=(n,t,e,r)=>({set _(i){zi(n,t,i,e)},get _(){return Pn(n,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();var Q0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function mL(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),e}var j1={exports:{}},Jh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rA;function gL(){if(rA)return Jh;rA=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(r,i,s){var a=null;if(s!==void 0&&(a=""+s),i.key!==void 0&&(a=""+i.key),"key"in i){s={};for(var l in i)l!=="key"&&(s[l]=i[l])}else s=i;return i=s.ref,{$$typeof:n,type:r,key:a,ref:i!==void 0?i:null,props:s}}return Jh.Fragment=t,Jh.jsx=e,Jh.jsxs=e,Jh}var iA;function vL(){return iA||(iA=1,j1.exports=gL()),j1.exports}var nt=vL(),H1={exports:{}},Ge={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sA;function _L(){if(sA)return Ge;sA=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function m(P){return P===null||typeof P!="object"?null:(P=p&&P[p]||P["@@iterator"],typeof P=="function"?P:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,_={};function y(P,V,j){this.props=P,this.context=V,this.refs=_,this.updater=j||v}y.prototype.isReactComponent={},y.prototype.setState=function(P,V){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,V,"setState")},y.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function w(){}w.prototype=y.prototype;function S(P,V,j){this.props=P,this.context=V,this.refs=_,this.updater=j||v}var T=S.prototype=new w;T.constructor=S,x(T,y.prototype),T.isPureReactComponent=!0;var C=Array.isArray,R={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function D(P,V,j,et,dt,xt){return j=xt.ref,{$$typeof:n,type:P,key:V,ref:j!==void 0?j:null,props:xt}}function I(P,V){return D(P.type,V,void 0,void 0,void 0,P.props)}function M(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function B(P){var V={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(j){return V[j]})}var H=/\/+/g;function F(P,V){return typeof P=="object"&&P!==null&&P.key!=null?B(""+P.key):V.toString(36)}function rt(){}function L(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(rt,rt):(P.status="pending",P.then(function(V){P.status==="pending"&&(P.status="fulfilled",P.value=V)},function(V){P.status==="pending"&&(P.status="rejected",P.reason=V)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function it(P,V,j,et,dt){var xt=typeof P;(xt==="undefined"||xt==="boolean")&&(P=null);var Nt=!1;if(P===null)Nt=!0;else switch(xt){case"bigint":case"string":case"number":Nt=!0;break;case"object":switch(P.$$typeof){case n:case t:Nt=!0;break;case d:return Nt=P._init,it(Nt(P._payload),V,j,et,dt)}}if(Nt)return dt=dt(P),Nt=et===""?"."+F(P,0):et,C(dt)?(j="",Nt!=null&&(j=Nt.replace(H,"$&/")+"/"),it(dt,V,j,"",function(lt){return lt})):dt!=null&&(M(dt)&&(dt=I(dt,j+(dt.key==null||P&&P.key===dt.key?"":(""+dt.key).replace(H,"$&/")+"/")+Nt)),V.push(dt)),1;Nt=0;var Rt=et===""?".":et+":";if(C(P))for(var z=0;z<P.length;z++)et=P[z],xt=Rt+F(et,z),Nt+=it(et,V,j,xt,dt);else if(z=m(P),typeof z=="function")for(P=z.call(P),z=0;!(et=P.next()).done;)et=et.value,xt=Rt+F(et,z++),Nt+=it(et,V,j,xt,dt);else if(xt==="object"){if(typeof P.then=="function")return it(L(P),V,j,et,dt);throw V=String(P),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return Nt}function Z(P,V,j){if(P==null)return P;var et=[],dt=0;return it(P,et,"","",function(xt){return V.call(j,xt,dt++)}),et}function q(P){if(P._status===-1){var V=P._result;V=V(),V.then(function(j){(P._status===0||P._status===-1)&&(P._status=1,P._result=j)},function(j){(P._status===0||P._status===-1)&&(P._status=2,P._result=j)}),P._status===-1&&(P._status=0,P._result=V)}if(P._status===1)return P._result.default;throw P._result}var Ct=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function at(){}return Ge.Children={map:Z,forEach:function(P,V,j){Z(P,function(){V.apply(this,arguments)},j)},count:function(P){var V=0;return Z(P,function(){V++}),V},toArray:function(P){return Z(P,function(V){return V})||[]},only:function(P){if(!M(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Ge.Component=y,Ge.Fragment=e,Ge.Profiler=i,Ge.PureComponent=S,Ge.StrictMode=r,Ge.Suspense=u,Ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ge.__COMPILER_RUNTIME={__proto__:null,c:function(P){return R.H.useMemoCache(P)}},Ge.cache=function(P){return function(){return P.apply(null,arguments)}},Ge.cloneElement=function(P,V,j){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var et=x({},P.props),dt=P.key,xt=void 0;if(V!=null)for(Nt in V.ref!==void 0&&(xt=void 0),V.key!==void 0&&(dt=""+V.key),V)!N.call(V,Nt)||Nt==="key"||Nt==="__self"||Nt==="__source"||Nt==="ref"&&V.ref===void 0||(et[Nt]=V[Nt]);var Nt=arguments.length-2;if(Nt===1)et.children=j;else if(1<Nt){for(var Rt=Array(Nt),z=0;z<Nt;z++)Rt[z]=arguments[z+2];et.children=Rt}return D(P.type,dt,void 0,void 0,xt,et)},Ge.createContext=function(P){return P={$$typeof:a,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:s,_context:P},P},Ge.createElement=function(P,V,j){var et,dt={},xt=null;if(V!=null)for(et in V.key!==void 0&&(xt=""+V.key),V)N.call(V,et)&&et!=="key"&&et!=="__self"&&et!=="__source"&&(dt[et]=V[et]);var Nt=arguments.length-2;if(Nt===1)dt.children=j;else if(1<Nt){for(var Rt=Array(Nt),z=0;z<Nt;z++)Rt[z]=arguments[z+2];dt.children=Rt}if(P&&P.defaultProps)for(et in Nt=P.defaultProps,Nt)dt[et]===void 0&&(dt[et]=Nt[et]);return D(P,xt,void 0,void 0,null,dt)},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(P){return{$$typeof:l,render:P}},Ge.isValidElement=M,Ge.lazy=function(P){return{$$typeof:d,_payload:{_status:-1,_result:P},_init:q}},Ge.memo=function(P,V){return{$$typeof:f,type:P,compare:V===void 0?null:V}},Ge.startTransition=function(P){var V=R.T,j={};R.T=j;try{var et=P(),dt=R.S;dt!==null&&dt(j,et),typeof et=="object"&&et!==null&&typeof et.then=="function"&&et.then(at,Ct)}catch(xt){Ct(xt)}finally{R.T=V}},Ge.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Ge.use=function(P){return R.H.use(P)},Ge.useActionState=function(P,V,j){return R.H.useActionState(P,V,j)},Ge.useCallback=function(P,V){return R.H.useCallback(P,V)},Ge.useContext=function(P){return R.H.useContext(P)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(P,V){return R.H.useDeferredValue(P,V)},Ge.useEffect=function(P,V,j){var et=R.H;if(typeof j=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return et.useEffect(P,V)},Ge.useId=function(){return R.H.useId()},Ge.useImperativeHandle=function(P,V,j){return R.H.useImperativeHandle(P,V,j)},Ge.useInsertionEffect=function(P,V){return R.H.useInsertionEffect(P,V)},Ge.useLayoutEffect=function(P,V){return R.H.useLayoutEffect(P,V)},Ge.useMemo=function(P,V){return R.H.useMemo(P,V)},Ge.useOptimistic=function(P,V){return R.H.useOptimistic(P,V)},Ge.useReducer=function(P,V,j){return R.H.useReducer(P,V,j)},Ge.useRef=function(P){return R.H.useRef(P)},Ge.useState=function(P){return R.H.useState(P)},Ge.useSyncExternalStore=function(P,V,j){return R.H.useSyncExternalStore(P,V,j)},Ge.useTransition=function(){return R.H.useTransition()},Ge.version="19.1.0",Ge}var aA;function Lg(){return aA||(aA=1,H1.exports=_L()),H1.exports}var _t=Lg();const Yn=bf(_t);var $1={exports:{}},td={},G1={exports:{}},V1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oA;function xL(){return oA||(oA=1,function(n){function t(Z,q){var Ct=Z.length;Z.push(q);t:for(;0<Ct;){var at=Ct-1>>>1,P=Z[at];if(0<i(P,q))Z[at]=q,Z[Ct]=P,Ct=at;else break t}}function e(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var q=Z[0],Ct=Z.pop();if(Ct!==q){Z[0]=Ct;t:for(var at=0,P=Z.length,V=P>>>1;at<V;){var j=2*(at+1)-1,et=Z[j],dt=j+1,xt=Z[dt];if(0>i(et,Ct))dt<P&&0>i(xt,et)?(Z[at]=xt,Z[dt]=Ct,at=dt):(Z[at]=et,Z[j]=Ct,at=j);else if(dt<P&&0>i(xt,Ct))Z[at]=xt,Z[dt]=Ct,at=dt;else break t}}return q}function i(Z,q){var Ct=Z.sortIndex-q.sortIndex;return Ct!==0?Ct:Z.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();n.unstable_now=function(){return a.now()-l}}var u=[],f=[],d=1,p=null,m=3,v=!1,x=!1,_=!1,y=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function C(Z){for(var q=e(f);q!==null;){if(q.callback===null)r(f);else if(q.startTime<=Z)r(f),q.sortIndex=q.expirationTime,t(u,q);else break;q=e(f)}}function R(Z){if(_=!1,C(Z),!x)if(e(u)!==null)x=!0,N||(N=!0,F());else{var q=e(f);q!==null&&it(R,q.startTime-Z)}}var N=!1,D=-1,I=5,M=-1;function B(){return y?!0:!(n.unstable_now()-M<I)}function H(){if(y=!1,N){var Z=n.unstable_now();M=Z;var q=!0;try{t:{x=!1,_&&(_=!1,S(D),D=-1),v=!0;var Ct=m;try{e:{for(C(Z),p=e(u);p!==null&&!(p.expirationTime>Z&&B());){var at=p.callback;if(typeof at=="function"){p.callback=null,m=p.priorityLevel;var P=at(p.expirationTime<=Z);if(Z=n.unstable_now(),typeof P=="function"){p.callback=P,C(Z),q=!0;break e}p===e(u)&&r(u),C(Z)}else r(u);p=e(u)}if(p!==null)q=!0;else{var V=e(f);V!==null&&it(R,V.startTime-Z),q=!1}}break t}finally{p=null,m=Ct,v=!1}q=void 0}}finally{q?F():N=!1}}}var F;if(typeof T=="function")F=function(){T(H)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,L=rt.port2;rt.port1.onmessage=H,F=function(){L.postMessage(null)}}else F=function(){w(H,0)};function it(Z,q){D=w(function(){Z(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Z){Z.callback=null},n.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Z?Math.floor(1e3/Z):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(Z){switch(m){case 1:case 2:case 3:var q=3;break;default:q=m}var Ct=m;m=q;try{return Z()}finally{m=Ct}},n.unstable_requestPaint=function(){y=!0},n.unstable_runWithPriority=function(Z,q){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Ct=m;m=Z;try{return q()}finally{m=Ct}},n.unstable_scheduleCallback=function(Z,q,Ct){var at=n.unstable_now();switch(typeof Ct=="object"&&Ct!==null?(Ct=Ct.delay,Ct=typeof Ct=="number"&&0<Ct?at+Ct:at):Ct=at,Z){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=Ct+P,Z={id:d++,callback:q,priorityLevel:Z,startTime:Ct,expirationTime:P,sortIndex:-1},Ct>at?(Z.sortIndex=Ct,t(f,Z),e(u)===null&&Z===e(f)&&(_?(S(D),D=-1):_=!0,it(R,Ct-at))):(Z.sortIndex=P,t(u,Z),x||v||(x=!0,N||(N=!0,F()))),Z},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(Z){var q=m;return function(){var Ct=m;m=q;try{return Z.apply(this,arguments)}finally{m=Ct}}}}(V1)),V1}var lA;function yL(){return lA||(lA=1,G1.exports=xL()),G1.exports}var W1={exports:{}},Qr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cA;function bL(){if(cA)return Qr;cA=1;var n=Lg();function t(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var r={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(u,f,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:u,containerInfo:f,implementation:d}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,f){if(u==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Qr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Qr.createPortal=function(u,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return s(u,f,null,d)},Qr.flushSync=function(u){var f=a.T,d=r.p;try{if(a.T=null,r.p=2,u)return u()}finally{a.T=f,r.p=d,r.d.f()}},Qr.preconnect=function(u,f){typeof u=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(u,f))},Qr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},Qr.preinit=function(u,f){if(typeof u=="string"&&f&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin),m=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?r.d.S(u,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:v}):d==="script"&&r.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Qr.preinitModule=function(u,f){if(typeof u=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=l(f.as,f.crossOrigin);r.d.M(u,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(u)},Qr.preload=function(u,f){if(typeof u=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,p=l(d,f.crossOrigin);r.d.L(u,d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Qr.preloadModule=function(u,f){if(typeof u=="string")if(f){var d=l(f.as,f.crossOrigin);r.d.m(u,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(u)},Qr.requestFormReset=function(u){r.d.r(u)},Qr.unstable_batchedUpdates=function(u,f){return u(f)},Qr.useFormState=function(u,f,d){return a.H.useFormState(u,f,d)},Qr.useFormStatus=function(){return a.H.useHostTransitionStatus()},Qr.version="19.1.0",Qr}var uA;function lC(){if(uA)return W1.exports;uA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),W1.exports=bL(),W1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fA;function wL(){if(fA)return td;fA=1;var n=yL(),t=Lg(),e=lC();function r(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var c=o,h=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(h=c.return),o=c.return;while(o)}return c.tag===3?h:null}function a(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function l(o){if(s(o)!==o)throw Error(r(188))}function u(o){var c=o.alternate;if(!c){if(c=s(o),c===null)throw Error(r(188));return c!==o?null:o}for(var h=o,g=c;;){var b=h.return;if(b===null)break;var A=b.alternate;if(A===null){if(g=b.return,g!==null){h=g;continue}break}if(b.child===A.child){for(A=b.child;A;){if(A===h)return l(b),o;if(A===g)return l(b),c;A=A.sibling}throw Error(r(188))}if(h.return!==g.return)h=b,g=A;else{for(var U=!1,Y=b.child;Y;){if(Y===h){U=!0,h=b,g=A;break}if(Y===g){U=!0,g=b,h=A;break}Y=Y.sibling}if(!U){for(Y=A.child;Y;){if(Y===h){U=!0,h=A,g=b;break}if(Y===g){U=!0,g=A,h=b;break}Y=Y.sibling}if(!U)throw Error(r(189))}}if(h.alternate!==g)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?o:c}function f(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=f(o),c!==null)return c;o=o.sibling}return null}var d=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),S=Symbol.for("react.consumer"),T=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function F(o){return o===null||typeof o!="object"?null:(o=H&&o[H]||o["@@iterator"],typeof o=="function"?o:null)}var rt=Symbol.for("react.client.reference");function L(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===rt?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case x:return"Fragment";case y:return"Profiler";case _:return"StrictMode";case R:return"Suspense";case N:return"SuspenseList";case M:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case v:return"Portal";case T:return(o.displayName||"Context")+".Provider";case S:return(o._context.displayName||"Context")+".Consumer";case C:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case D:return c=o.displayName||null,c!==null?c:L(o.type)||"Memo";case I:c=o._payload,o=o._init;try{return L(o(c))}catch{}}return null}var it=Array.isArray,Z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ct={pending:!1,data:null,method:null,action:null},at=[],P=-1;function V(o){return{current:o}}function j(o){0>P||(o.current=at[P],at[P]=null,P--)}function et(o,c){P++,at[P]=o.current,o.current=c}var dt=V(null),xt=V(null),Nt=V(null),Rt=V(null);function z(o,c){switch(et(Nt,c),et(xt,o),et(dt,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?OE(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=OE(c),o=RE(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}j(dt),et(dt,o)}function lt(){j(dt),j(xt),j(Nt)}function J(o){o.memoizedState!==null&&et(Rt,o);var c=dt.current,h=RE(c,o.type);c!==h&&(et(xt,o),et(dt,h))}function ot(o){xt.current===o&&(j(dt),j(xt)),Rt.current===o&&(j(Rt),Yh._currentValue=Ct)}var yt=Object.prototype.hasOwnProperty,At=n.unstable_scheduleCallback,O=n.unstable_cancelCallback,gt=n.unstable_shouldYield,ut=n.unstable_requestPaint,K=n.unstable_now,X=n.unstable_getCurrentPriorityLevel,pt=n.unstable_ImmediatePriority,Bt=n.unstable_UserBlockingPriority,Ht=n.unstable_NormalPriority,St=n.unstable_LowPriority,It=n.unstable_IdlePriority,Tt=n.log,vt=n.unstable_setDisableYieldValue,te=null,ae=null;function ne(o){if(typeof Tt=="function"&&vt(o),ae&&typeof ae.setStrictMode=="function")try{ae.setStrictMode(te,o)}catch{}}var Re=Math.clz32?Math.clz32:ln,rn=Math.log,be=Math.LN2;function ln(o){return o>>>=0,o===0?32:31-(rn(o)/be|0)|0}var Ve=256,zn=4194304;function Cn(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function yn(o,c,h){var g=o.pendingLanes;if(g===0)return 0;var b=0,A=o.suspendedLanes,U=o.pingedLanes;o=o.warmLanes;var Y=g&134217727;return Y!==0?(g=Y&~A,g!==0?b=Cn(g):(U&=Y,U!==0?b=Cn(U):h||(h=Y&~o,h!==0&&(b=Cn(h))))):(Y=g&~A,Y!==0?b=Cn(Y):U!==0?b=Cn(U):h||(h=g&~o,h!==0&&(b=Cn(h)))),b===0?0:c!==0&&c!==b&&(c&A)===0&&(A=b&-b,h=c&-c,A>=h||A===32&&(h&4194048)!==0)?c:b}function mr(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function _s(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vs(){var o=Ve;return Ve<<=1,(Ve&4194048)===0&&(Ve=256),o}function Xa(){var o=zn;return zn<<=1,(zn&62914560)===0&&(zn=4194304),o}function Ws(o){for(var c=[],h=0;31>h;h++)c.push(o);return c}function Er(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Oi(o,c,h,g,b,A){var U=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var Y=o.entanglements,mt=o.expirationTimes,Ft=o.hiddenUpdates;for(h=U&~h;0<h;){var Vt=31-Re(h),Kt=1<<Vt;Y[Vt]=0,mt[Vt]=-1;var zt=Ft[Vt];if(zt!==null)for(Ft[Vt]=null,Vt=0;Vt<zt.length;Vt++){var jt=zt[Vt];jt!==null&&(jt.lane&=-536870913)}h&=~Kt}g!==0&&zl(o,g,0),A!==0&&b===0&&o.tag!==0&&(o.suspendedLanes|=A&~(U&~c))}function zl(o,c,h){o.pendingLanes|=c,o.suspendedLanes&=~c;var g=31-Re(c);o.entangledLanes|=c,o.entanglements[g]=o.entanglements[g]|1073741824|h&4194090}function Kc(o,c){var h=o.entangledLanes|=c;for(o=o.entanglements;h;){var g=31-Re(h),b=1<<g;b&c|o[g]&c&&(o[g]|=c),h&=~b}}function jl(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Hl(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Zc(){var o=q.p;return o!==0?o:(o=window.event,o===void 0?32:XE(o.type))}function fa(o,c){var h=q.p;try{return q.p=o,c()}finally{q.p=h}}var Vr=Math.random().toString(36).slice(2),rr="__reactFiber$"+Vr,ir="__reactProps$"+Vr,ha="__reactContainer$"+Vr,$l="__reactEvents$"+Vr,Mf="__reactListeners$"+Vr,W="__reactHandles$"+Vr,ft="__reactResources$"+Vr,tt="__reactMarker$"+Vr;function st(o){delete o[rr],delete o[ir],delete o[$l],delete o[Mf],delete o[W]}function ct(o){var c=o[rr];if(c)return c;for(var h=o.parentNode;h;){if(c=h[ha]||h[rr]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(o=IE(o);o!==null;){if(h=o[rr])return h;o=IE(o)}return c}o=h,h=o.parentNode}return null}function ht(o){if(o=o[rr]||o[ha]){var c=o.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return o}return null}function Pt(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(r(33))}function $t(o){var c=o[ft];return c||(c=o[ft]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Et(o){o[tt]=!0}var kt=new Set,Lt={};function Wt(o,c){ee(o,c),ee(o+"Capture",c)}function ee(o,c){for(Lt[o]=c,o=0;o<c.length;o++)kt.add(c[o])}var le=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qt={},re={};function Ie(o){return yt.call(re,o)?!0:yt.call(Qt,o)?!1:le.test(o)?re[o]=!0:(Qt[o]=!0,!1)}function sn(o,c,h){if(Ie(c))if(h===null)o.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var g=c.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+h)}}function Ze(o,c,h){if(h===null)o.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+h)}}function dn(o,c,h,g){if(g===null)o.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(c,h,""+g)}}var qi,xs;function ci(o){if(qi===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);qi=c&&c[1]||"",xs=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qi+o+xs}var Ri=!1;function da(o,c){if(!o||Ri)return"";Ri=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(c){var Kt=function(){throw Error()};if(Object.defineProperty(Kt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Kt,[])}catch(jt){var zt=jt}Reflect.construct(o,[],Kt)}else{try{Kt.call()}catch(jt){zt=jt}o.call(Kt.prototype)}}else{try{throw Error()}catch(jt){zt=jt}(Kt=o())&&typeof Kt.catch=="function"&&Kt.catch(function(){})}}catch(jt){if(jt&&zt&&typeof jt.stack=="string")return[jt.stack,zt.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=g.DetermineComponentFrameRoot(),U=A[0],Y=A[1];if(U&&Y){var mt=U.split(`
`),Ft=Y.split(`
`);for(b=g=0;g<mt.length&&!mt[g].includes("DetermineComponentFrameRoot");)g++;for(;b<Ft.length&&!Ft[b].includes("DetermineComponentFrameRoot");)b++;if(g===mt.length||b===Ft.length)for(g=mt.length-1,b=Ft.length-1;1<=g&&0<=b&&mt[g]!==Ft[b];)b--;for(;1<=g&&0<=b;g--,b--)if(mt[g]!==Ft[b]){if(g!==1||b!==1)do if(g--,b--,0>b||mt[g]!==Ft[b]){var Vt=`
`+mt[g].replace(" at new "," at ");return o.displayName&&Vt.includes("<anonymous>")&&(Vt=Vt.replace("<anonymous>",o.displayName)),Vt}while(1<=g&&0<=b);break}}}finally{Ri=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?ci(h):""}function Ni(o){switch(o.tag){case 26:case 27:case 5:return ci(o.type);case 16:return ci("Lazy");case 13:return ci("Suspense");case 19:return ci("SuspenseList");case 0:case 15:return da(o.type,!1);case 11:return da(o.type.render,!1);case 1:return da(o.type,!0);case 31:return ci("Activity");default:return""}}function Pf(o){try{var c="";do c+=Ni(o),o=o.return;while(o);return c}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function ui(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Ff(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function bp(o){var c=Ff(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),g=""+o[c];if(!o.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var b=h.get,A=h.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return b.call(this)},set:function(U){g=""+U,A.call(this,U)}}),Object.defineProperty(o,c,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(U){g=""+U},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Gl(o){o._valueTracker||(o._valueTracker=bp(o))}function Bf(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var h=c.getValue(),g="";return o&&(g=Ff(o)?o.checked?"true":"false":o.value),o=g,o!==h?(c.setValue(o),!0):!1}function fi(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var hi=/[\n"\\]/g;function sr(o){return o.replace(hi,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Wr(o,c,h,g,b,A,U,Y){o.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?o.type=U:o.removeAttribute("type"),c!=null?U==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+ui(c)):o.value!==""+ui(c)&&(o.value=""+ui(c)):U!=="submit"&&U!=="reset"||o.removeAttribute("value"),c!=null?Vl(o,U,ui(c)):h!=null?Vl(o,U,ui(h)):g!=null&&o.removeAttribute("value"),b==null&&A!=null&&(o.defaultChecked=!!A),b!=null&&(o.checked=b&&typeof b!="function"&&typeof b!="symbol"),Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"?o.name=""+ui(Y):o.removeAttribute("name")}function Qc(o,c,h,g,b,A,U,Y){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(o.type=A),c!=null||h!=null){if(!(A!=="submit"&&A!=="reset"||c!=null))return;h=h!=null?""+ui(h):"",c=c!=null?""+ui(c):h,Y||c===o.value||(o.value=c),o.defaultValue=c}g=g??b,g=typeof g!="function"&&typeof g!="symbol"&&!!g,o.checked=Y?o.checked:!!g,o.defaultChecked=!!g,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(o.name=U)}function Vl(o,c,h){c==="number"&&fi(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function kr(o,c,h,g){if(o=o.options,c){c={};for(var b=0;b<h.length;b++)c["$"+h[b]]=!0;for(h=0;h<o.length;h++)b=c.hasOwnProperty("$"+o[h].value),o[h].selected!==b&&(o[h].selected=b),b&&g&&(o[h].defaultSelected=!0)}else{for(h=""+ui(h),c=null,b=0;b<o.length;b++){if(o[b].value===h){o[b].selected=!0,g&&(o[b].defaultSelected=!0);return}c!==null||o[b].disabled||(c=o[b])}c!==null&&(c.selected=!0)}}function pa(o,c,h){if(c!=null&&(c=""+ui(c),c!==o.value&&(o.value=c),h==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=h!=null?""+ui(h):""}function Wl(o,c,h,g){if(c==null){if(g!=null){if(h!=null)throw Error(r(92));if(it(g)){if(1<g.length)throw Error(r(93));g=g[0]}h=g}h==null&&(h=""),c=h}h=ui(c),o.defaultValue=h,g=o.textContent,g===h&&g!==""&&g!==null&&(o.value=g)}function Yi(o,c){if(c){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=c;return}}o.textContent=c}var Uf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zf(o,c,h){var g=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?g?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":g?o.setProperty(c,h):typeof h!="number"||h===0||Uf.has(c)?c==="float"?o.cssFloat=h:o[c]=(""+h).trim():o[c]=h+"px"}function Ka(o,c,h){if(c!=null&&typeof c!="object")throw Error(r(62));if(o=o.style,h!=null){for(var g in h)!h.hasOwnProperty(g)||c!=null&&c.hasOwnProperty(g)||(g.indexOf("--")===0?o.setProperty(g,""):g==="float"?o.cssFloat="":o[g]="");for(var b in c)g=c[b],c.hasOwnProperty(b)&&h[b]!==g&&zf(o,b,g)}else for(var A in c)c.hasOwnProperty(A)&&zf(o,A,c[A])}function ql(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jc(o){return qs.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var ys=null;function $o(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Za=null,bs=null;function tu(o){var c=ht(o);if(c&&(o=c.stateNode)){var h=o[ir]||null;t:switch(o=c.stateNode,c.type){case"input":if(Wr(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+sr(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var g=h[c];if(g!==o&&g.form===o.form){var b=g[ir]||null;if(!b)throw Error(r(90));Wr(g,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(c=0;c<h.length;c++)g=h[c],g.form===o.form&&Bf(g)}break t;case"textarea":pa(o,h.value,h.defaultValue);break t;case"select":c=h.value,c!=null&&kr(o,!!h.multiple,c,!1)}}}var Qa=!1;function jf(o,c,h){if(Qa)return o(c,h);Qa=!0;try{var g=o(c);return g}finally{if(Qa=!1,(Za!==null||bs!==null)&&(N0(),Za&&(c=Za,o=bs,bs=Za=null,tu(c),o)))for(c=0;c<o.length;c++)tu(o[c])}}function Go(o,c){var h=o.stateNode;if(h===null)return null;var g=h[ir]||null;if(g===null)return null;h=g[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break t;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(r(231,c,typeof h));return h}var ws=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ma=!1;if(ws)try{var Yl={};Object.defineProperty(Yl,"passive",{get:function(){ma=!0}}),window.addEventListener("test",Yl,Yl),window.removeEventListener("test",Yl,Yl)}catch{ma=!1}var Ys=null,Xl=null,Ja=null;function eu(){if(Ja)return Ja;var o,c=Xl,h=c.length,g,b="value"in Ys?Ys.value:Ys.textContent,A=b.length;for(o=0;o<h&&c[o]===b[o];o++);var U=h-o;for(g=1;g<=U&&c[h-g]===b[A-g];g++);return Ja=b.slice(o,1<g?1-g:void 0)}function nu(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function to(){return!0}function Ep(){return!1}function Lr(o){function c(h,g,b,A,U){this._reactName=h,this._targetInst=b,this.type=g,this.nativeEvent=A,this.target=U,this.currentTarget=null;for(var Y in o)o.hasOwnProperty(Y)&&(h=o[Y],this[Y]=h?h(A):A[Y]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?to:Ep,this.isPropagationStopped=Ep,this}return d(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=to)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=to)},persist:function(){},isPersistent:to}),c}var Xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vo=Lr(Xs),eo=d({},Xs,{view:0,detail:0}),Ap=Lr(eo),no,Kl,Wo,Zl=d({},eo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$f,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Wo&&(Wo&&o.type==="mousemove"?(no=o.screenX-Wo.screenX,Kl=o.screenY-Wo.screenY):Kl=no=0,Wo=o),no)},movementY:function(o){return"movementY"in o?o.movementY:Kl}}),ro=Lr(Zl),_v=d({},Zl,{dataTransfer:0}),Sp=Lr(_v),Tp=d({},eo,{relatedTarget:0}),ru=Lr(Tp),Cp=d({},Xs,{animationName:0,elapsedTime:0,pseudoElement:0}),Dp=Lr(Cp),Hf=d({},Xs,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Op=Lr(Hf),xv=d({},Xs,{data:0}),Rp=Lr(xv),Np={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},iu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yv(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=iu[o])?!!c[o]:!1}function $f(){return yv}var Gf=d({},eo,{key:function(o){if(o.key){var c=Np[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=nu(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?kp[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$f,charCode:function(o){return o.type==="keypress"?nu(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?nu(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Lp=Lr(Gf),Ip=d({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ga=Lr(Ip),Vf=d({},eo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$f}),bv=Lr(Vf),Mp=d({},Xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),wv=Lr(Mp),Ev=d({},Zl,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Av=Lr(Ev),Sv=d({},Xs,{newState:0,oldState:0}),Pp=Lr(Sv),Fp=[9,13,27,32],Wf=ws&&"CompositionEvent"in window,Es=null;ws&&"documentMode"in document&&(Es=document.documentMode);var io=ws&&"TextEvent"in window&&!Es,Bp=ws&&(!Wf||Es&&8<Es&&11>=Es),Ql=" ",Up=!1;function zp(o,c){switch(o){case"keyup":return Fp.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jp(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var qo=!1;function Tv(o,c){switch(o){case"compositionend":return jp(c);case"keypress":return c.which!==32?null:(Up=!0,Ql);case"textInput":return o=c.data,o===Ql&&Up?null:o;default:return null}}function Cv(o,c){if(qo)return o==="compositionend"||!Wf&&zp(o,c)?(o=eu(),Ja=Xl=Ys=null,qo=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Bp&&c.locale!=="ko"?null:c.data;default:return null}}var Dv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hp(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!Dv[o.type]:c==="textarea"}function ki(o,c,h,g){Za?bs?bs.push(g):bs=[g]:Za=g,c=F0(c,"onChange"),0<c.length&&(h=new Vo("onChange","change",null,h,g),o.push({event:h,listeners:c}))}var Yo=null,Xo=null;function $p(o){AE(o,0)}function su(o){var c=Pt(o);if(Bf(c))return o}function Gp(o,c){if(o==="change")return c}var qf=!1;if(ws){var Ko;if(ws){var Yf="oninput"in document;if(!Yf){var Vp=document.createElement("div");Vp.setAttribute("oninput","return;"),Yf=typeof Vp.oninput=="function"}Ko=Yf}else Ko=!1;qf=Ko&&(!document.documentMode||9<document.documentMode)}function Xf(){Yo&&(Yo.detachEvent("onpropertychange",Wp),Xo=Yo=null)}function Wp(o){if(o.propertyName==="value"&&su(Xo)){var c=[];ki(c,Xo,o,$o(o)),jf($p,c)}}function Ov(o,c,h){o==="focusin"?(Xf(),Yo=c,Xo=h,Yo.attachEvent("onpropertychange",Wp)):o==="focusout"&&Xf()}function qp(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return su(Xo)}function Yp(o,c){if(o==="click")return su(c)}function Xp(o,c){if(o==="input"||o==="change")return su(c)}function au(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var qr=typeof Object.is=="function"?Object.is:au;function so(o,c){if(qr(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var h=Object.keys(o),g=Object.keys(c);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var b=h[g];if(!yt.call(c,b)||!qr(o[b],c[b]))return!1}return!0}function di(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Kp(o,c){var h=di(o);o=0;for(var g;h;){if(h.nodeType===3){if(g=o+h.textContent.length,o<=c&&g>=c)return{node:h,offset:c-o};o=g}t:{for(;h;){if(h.nextSibling){h=h.nextSibling;break t}h=h.parentNode}h=void 0}h=di(h)}}function Zp(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?Zp(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function Kf(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=fi(o.document);c instanceof o.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)o=c.contentWindow;else break;c=fi(o.document)}return c}function ou(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var Rv=ws&&"documentMode"in document&&11>=document.documentMode,Zo=null,Zf=null,Jl=null,Qf=!1;function Qp(o,c,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Qf||Zo==null||Zo!==fi(g)||(g=Zo,"selectionStart"in g&&ou(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Jl&&so(Jl,g)||(Jl=g,g=F0(Zf,"onSelect"),0<g.length&&(c=new Vo("onSelect","select",null,c,h),o.push({event:c,listeners:g}),c.target=Zo)))}function va(o,c){var h={};return h[o.toLowerCase()]=c.toLowerCase(),h["Webkit"+o]="webkit"+c,h["Moz"+o]="moz"+c,h}var ao={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionrun:va("Transition","TransitionRun"),transitionstart:va("Transition","TransitionStart"),transitioncancel:va("Transition","TransitionCancel"),transitionend:va("Transition","TransitionEnd")},tc={},Jp={};ws&&(Jp=document.createElement("div").style,"AnimationEvent"in window||(delete ao.animationend.animation,delete ao.animationiteration.animation,delete ao.animationstart.animation),"TransitionEvent"in window||delete ao.transitionend.transition);function oo(o){if(tc[o])return tc[o];if(!ao[o])return o;var c=ao[o],h;for(h in c)if(c.hasOwnProperty(h)&&h in Jp)return tc[o]=c[h];return o}var _a=oo("animationend"),As=oo("animationiteration"),Jf=oo("animationstart"),Nv=oo("transitionrun"),t0=oo("transitionstart"),e0=oo("transitioncancel"),th=oo("transitionend"),eh=new Map,nh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nh.push("scrollEnd");function Xi(o,c){eh.set(o,c),Wt(c,[o])}var n0=new WeakMap;function pi(o,c){if(typeof o=="object"&&o!==null){var h=n0.get(o);return h!==void 0?h:(c={value:o,source:c,stack:Pf(c)},n0.set(o,c),c)}return{value:o,source:c,stack:Pf(c)}}var mi=[],Qo=0,rh=0;function lu(){for(var o=Qo,c=rh=Qo=0;c<o;){var h=mi[c];mi[c++]=null;var g=mi[c];mi[c++]=null;var b=mi[c];mi[c++]=null;var A=mi[c];if(mi[c++]=null,g!==null&&b!==null){var U=g.pending;U===null?b.next=b:(b.next=U.next,U.next=b),g.pending=b}A!==0&&sh(h,b,A)}}function cu(o,c,h,g){mi[Qo++]=o,mi[Qo++]=c,mi[Qo++]=h,mi[Qo++]=g,rh|=g,o.lanes|=g,o=o.alternate,o!==null&&(o.lanes|=g)}function ih(o,c,h,g){return cu(o,c,h,g),uu(o)}function Yr(o,c){return cu(o,null,null,c),uu(o)}function sh(o,c,h){o.lanes|=h;var g=o.alternate;g!==null&&(g.lanes|=h);for(var b=!1,A=o.return;A!==null;)A.childLanes|=h,g=A.alternate,g!==null&&(g.childLanes|=h),A.tag===22&&(o=A.stateNode,o===null||o._visibility&1||(b=!0)),o=A,A=A.return;return o.tag===3?(A=o.stateNode,b&&c!==null&&(b=31-Re(h),o=A.hiddenUpdates,g=o[b],g===null?o[b]=[c]:g.push(c),c.lane=h|536870912),A):null}function uu(o){if(50<zh)throw zh=0,u1=null,Error(r(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var Jo={};function kv(o,c,h,g){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(o,c,h,g){return new kv(o,c,h,g)}function ah(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Ks(o,c){var h=o.alternate;return h===null?(h=gi(o.tag,c,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=c,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,c=o.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function r0(o,c){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,c=h.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function fu(o,c,h,g,b,A){var U=0;if(g=o,typeof o=="function")ah(o)&&(U=1);else if(typeof o=="string")U=nL(o,h,dt.current)?26:o==="html"||o==="head"||o==="body"?27:5;else t:switch(o){case M:return o=gi(31,h,c,b),o.elementType=M,o.lanes=A,o;case x:return Zs(h.children,b,A,c);case _:U=8,b|=24;break;case y:return o=gi(12,h,c,b|2),o.elementType=y,o.lanes=A,o;case R:return o=gi(13,h,c,b),o.elementType=R,o.lanes=A,o;case N:return o=gi(19,h,c,b),o.elementType=N,o.lanes=A,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case w:case T:U=10;break t;case S:U=9;break t;case C:U=11;break t;case D:U=14;break t;case I:U=16,g=null;break t}U=29,h=Error(r(130,o===null?"null":typeof o,"")),g=null}return c=gi(U,h,c,b),c.elementType=o,c.type=g,c.lanes=A,c}function Zs(o,c,h,g){return o=gi(7,o,g,c),o.lanes=h,o}function tl(o,c,h){return o=gi(6,o,null,c),o.lanes=h,o}function oh(o,c,h){return c=gi(4,o.children!==null?o.children:[],o.key,c),c.lanes=h,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var lo=[],co=0,xa=null,el=0,Xr=[],Li=0,uo=null,Qs=1,Ir="";function fo(o,c){lo[co++]=el,lo[co++]=xa,xa=o,el=c}function i0(o,c,h){Xr[Li++]=Qs,Xr[Li++]=Ir,Xr[Li++]=uo,uo=o;var g=Qs;o=Ir;var b=32-Re(g)-1;g&=~(1<<b),h+=1;var A=32-Re(c)+b;if(30<A){var U=b-b%5;A=(g&(1<<U)-1).toString(32),g>>=U,b-=U,Qs=1<<32-Re(c)+b|h<<b|g,Ir=A+o}else Qs=1<<A|h<<b|g,Ir=o}function lh(o){o.return!==null&&(fo(o,1),i0(o,1,0))}function ch(o){for(;o===xa;)xa=lo[--co],lo[co]=null,el=lo[--co],lo[co]=null;for(;o===uo;)uo=Xr[--Li],Xr[Li]=null,Ir=Xr[--Li],Xr[Li]=null,Qs=Xr[--Li],Xr[Li]=null}var ar=null,Nn=null,an=!1,ya=null,Ss=!1,ba=Error(r(519));function Js(o){var c=Error(r(418,""));throw Ki(pi(c,o)),ba}function uh(o){var c=o.stateNode,h=o.type,g=o.memoizedProps;switch(c[rr]=o,c[ir]=g,h){case"dialog":Ye("cancel",c),Ye("close",c);break;case"iframe":case"object":case"embed":Ye("load",c);break;case"video":case"audio":for(h=0;h<Hh.length;h++)Ye(Hh[h],c);break;case"source":Ye("error",c);break;case"img":case"image":case"link":Ye("error",c),Ye("load",c);break;case"details":Ye("toggle",c);break;case"input":Ye("invalid",c),Qc(c,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0),Gl(c);break;case"select":Ye("invalid",c);break;case"textarea":Ye("invalid",c),Wl(c,g.value,g.defaultValue,g.children),Gl(c)}h=g.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||g.suppressHydrationWarning===!0||DE(c.textContent,h)?(g.popover!=null&&(Ye("beforetoggle",c),Ye("toggle",c)),g.onScroll!=null&&Ye("scroll",c),g.onScrollEnd!=null&&Ye("scrollend",c),g.onClick!=null&&(c.onclick=B0),c=!0):c=!1,c||Js(o)}function s0(o){for(ar=o.return;ar;)switch(ar.tag){case 5:case 13:Ss=!1;return;case 27:case 3:Ss=!0;return;default:ar=ar.return}}function ec(o){if(o!==ar)return!1;if(!an)return s0(o),an=!0,!1;var c=o.tag,h;if((h=c!==3&&c!==27)&&((h=c===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||T1(o.type,o.memoizedProps)),h=!h),h&&Nn&&Js(o),s0(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(r(317));t:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8)if(h=o.data,h==="/$"){if(c===0){Nn=ra(o.nextSibling);break t}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++;o=o.nextSibling}Nn=null}}else c===27?(c=Nn,gl(o.type)?(o=R1,R1=null,Nn=o):Nn=c):Nn=ar?ra(o.stateNode.nextSibling):null;return!0}function nc(){Nn=ar=null,an=!1}function nl(){var o=ya;return o!==null&&(Ui===null?Ui=o:Ui.push.apply(Ui,o),ya=null),o}function Ki(o){ya===null?ya=[o]:ya.push(o)}var fh=V(null),ho=null,ta=null;function wa(o,c,h){et(fh,c._currentValue),c._currentValue=h}function ea(o){o._currentValue=fh.current,j(fh)}function hh(o,c,h){for(;o!==null;){var g=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,g!==null&&(g.childLanes|=c)):g!==null&&(g.childLanes&c)!==c&&(g.childLanes|=c),o===h)break;o=o.return}}function dh(o,c,h,g){var b=o.child;for(b!==null&&(b.return=o);b!==null;){var A=b.dependencies;if(A!==null){var U=b.child;A=A.firstContext;t:for(;A!==null;){var Y=A;A=b;for(var mt=0;mt<c.length;mt++)if(Y.context===c[mt]){A.lanes|=h,Y=A.alternate,Y!==null&&(Y.lanes|=h),hh(A.return,h,o),g||(U=null);break t}A=Y.next}}else if(b.tag===18){if(U=b.return,U===null)throw Error(r(341));U.lanes|=h,A=U.alternate,A!==null&&(A.lanes|=h),hh(U,h,o),U=null}else U=b.child;if(U!==null)U.return=b;else for(U=b;U!==null;){if(U===o){U=null;break}if(b=U.sibling,b!==null){b.return=U.return,U=b;break}U=U.return}b=U}}function rc(o,c,h,g){o=null;for(var b=c,A=!1;b!==null;){if(!A){if((b.flags&524288)!==0)A=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var U=b.alternate;if(U===null)throw Error(r(387));if(U=U.memoizedProps,U!==null){var Y=b.type;qr(b.pendingProps.value,U.value)||(o!==null?o.push(Y):o=[Y])}}else if(b===Rt.current){if(U=b.alternate,U===null)throw Error(r(387));U.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(o!==null?o.push(Yh):o=[Yh])}b=b.return}o!==null&&dh(c,o,h,g),c.flags|=262144}function ic(o){for(o=o.firstContext;o!==null;){if(!qr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function po(o){ho=o,ta=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function gr(o){return ph(ho,o)}function rl(o,c){return ho===null&&po(o),ph(o,c)}function ph(o,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},ta===null){if(o===null)throw Error(r(308));ta=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else ta=ta.next=c;return h}var mo=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(h,g){o.push(g)}};this.abort=function(){c.aborted=!0,o.forEach(function(h){return h()})}},a0=n.unstable_scheduleCallback,mh=n.unstable_NormalPriority,Wn={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sc(){return{controller:new mo,data:new Map,refCount:0}}function il(o){o.refCount--,o.refCount===0&&a0(mh,function(){o.controller.abort()})}var go=null,gh=0,Ii=0,vi=null;function Lv(o,c){if(go===null){var h=go=[];gh=0,Ii=v1(),vi={status:"pending",value:void 0,then:function(g){h.push(g)}}}return gh++,c.then(o0,o0),c}function o0(){if(--gh===0&&go!==null){vi!==null&&(vi.status="fulfilled");var o=go;go=null,Ii=0,vi=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function Iv(o,c){var h=[],g={status:"pending",value:null,reason:null,then:function(b){h.push(b)}};return o.then(function(){g.status="fulfilled",g.value=c;for(var b=0;b<h.length;b++)(0,h[b])(c)},function(b){for(g.status="rejected",g.reason=b,b=0;b<h.length;b++)(0,h[b])(void 0)}),g}var l0=Z.S;Z.S=function(o,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&Lv(o,c),l0!==null&&l0(o,c)};var vo=V(null);function vh(){var o=vo.current;return o!==null?o:kn.pooledCache}function hu(o,c){c===null?et(vo,vo.current):et(vo,c.pool)}function c0(){var o=vh();return o===null?null:{parent:Wn._currentValue,pool:o}}var sl=Error(r(460)),ac=Error(r(474)),_o=Error(r(542)),_h={then:function(){}};function u0(o){return o=o.status,o==="fulfilled"||o==="rejected"}function Ea(){}function G(o,c,h){switch(h=o[h],h===void 0?o.push(c):h!==c&&(c.then(Ea,Ea),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,Q(o),o;default:if(typeof c.status=="string")c.then(Ea,Ea);else{if(o=kn,o!==null&&100<o.shellSuspendCounter)throw Error(r(482));o=c,o.status="pending",o.then(function(g){if(c.status==="pending"){var b=c;b.status="fulfilled",b.value=g}},function(g){if(c.status==="pending"){var b=c;b.status="rejected",b.reason=g}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,Q(o),o}throw E=c,sl}}var E=null;function k(){if(E===null)throw Error(r(459));var o=E;return E=null,o}function Q(o){if(o===sl||o===_o)throw Error(r(483))}var wt=!1;function Dt(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gt(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function qt(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function ie(o,c,h){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(gn&2)!==0){var b=g.pending;return b===null?c.next=c:(c.next=b.next,b.next=c),g.pending=c,c=uu(o),sh(o,null,h),c}return cu(o,g,c,h),uu(o)}function fe(o,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194048)!==0)){var g=c.lanes;g&=o.pendingLanes,h|=g,c.lanes=h,Kc(o,h)}}function he(o,c){var h=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var b=null,A=null;if(h=h.firstBaseUpdate,h!==null){do{var U={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};A===null?b=A=U:A=A.next=U,h=h.next}while(h!==null);A===null?b=A=c:A=A.next=c}else b=A=c;h={baseState:g.baseState,firstBaseUpdate:b,lastBaseUpdate:A,shared:g.shared,callbacks:g.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=c:o.next=c,h.lastBaseUpdate=c}var ce=!1;function Pe(){if(ce){var o=vi;if(o!==null)throw o}}function we(o,c,h,g){ce=!1;var b=o.updateQueue;wt=!1;var A=b.firstBaseUpdate,U=b.lastBaseUpdate,Y=b.shared.pending;if(Y!==null){b.shared.pending=null;var mt=Y,Ft=mt.next;mt.next=null,U===null?A=Ft:U.next=Ft,U=mt;var Vt=o.alternate;Vt!==null&&(Vt=Vt.updateQueue,Y=Vt.lastBaseUpdate,Y!==U&&(Y===null?Vt.firstBaseUpdate=Ft:Y.next=Ft,Vt.lastBaseUpdate=mt))}if(A!==null){var Kt=b.baseState;U=0,Vt=Ft=mt=null,Y=A;do{var zt=Y.lane&-536870913,jt=zt!==Y.lane;if(jt?(tn&zt)===zt:(g&zt)===zt){zt!==0&&zt===Ii&&(ce=!0),Vt!==null&&(Vt=Vt.next={lane:0,tag:Y.tag,payload:Y.payload,callback:null,next:null});t:{var Me=o,Ce=Y;zt=c;var En=h;switch(Ce.tag){case 1:if(Me=Ce.payload,typeof Me=="function"){Kt=Me.call(En,Kt,zt);break t}Kt=Me;break t;case 3:Me.flags=Me.flags&-65537|128;case 0:if(Me=Ce.payload,zt=typeof Me=="function"?Me.call(En,Kt,zt):Me,zt==null)break t;Kt=d({},Kt,zt);break t;case 2:wt=!0}}zt=Y.callback,zt!==null&&(o.flags|=64,jt&&(o.flags|=8192),jt=b.callbacks,jt===null?b.callbacks=[zt]:jt.push(zt))}else jt={lane:zt,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null},Vt===null?(Ft=Vt=jt,mt=Kt):Vt=Vt.next=jt,U|=zt;if(Y=Y.next,Y===null){if(Y=b.shared.pending,Y===null)break;jt=Y,Y=jt.next,jt.next=null,b.lastBaseUpdate=jt,b.shared.pending=null}}while(!0);Vt===null&&(mt=Kt),b.baseState=mt,b.firstBaseUpdate=Ft,b.lastBaseUpdate=Vt,A===null&&(b.shared.lanes=0),hl|=U,o.lanes=U,o.memoizedState=Kt}}function Fe(o,c){if(typeof o!="function")throw Error(r(191,o));o.call(c)}function Ne(o,c){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)Fe(h[o],c)}var Te=V(null),on=V(0);function pn(o,c){o=So,et(on,o),et(Te,c),So=o|c.baseLanes}function je(){et(on,So),et(Te,Te.current)}function Qe(){So=on.current,j(Te),j(on)}var ke=0,ue=null,ve=null,Le=null,Je=!1,bn=!1,Xn=!1,Kr=0,Kn=0,vr=null,Mi=0;function Ue(){throw Error(r(321))}function Pi(o,c){if(c===null)return!1;for(var h=0;h<c.length&&h<o.length;h++)if(!qr(o[h],c[h]))return!1;return!0}function Fi(o,c,h,g,b,A){return ke=A,ue=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Z.H=o===null||o.memoizedState===null?lw:cw,Xn=!1,A=h(g,b),Xn=!1,bn&&(A=Zn(c,h,g,b)),xo(o),A}function xo(o){Z.H=_0;var c=ve!==null&&ve.next!==null;if(ke=0,Le=ve=ue=null,Je=!1,Kn=0,vr=null,c)throw Error(r(300));o===null||Ar||(o=o.dependencies,o!==null&&ic(o)&&(Ar=!0))}function Zn(o,c,h,g){ue=o;var b=0;do{if(bn&&(vr=null),Kn=0,bn=!1,25<=b)throw Error(r(301));if(b+=1,Le=ve=null,o.updateQueue!=null){var A=o.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}Z.H=dk,A=c(h,g)}while(bn);return A}function mn(){var o=Z.H,c=o.useState()[0];return c=typeof c.then=="function"?Aa(c):c,o=o.useState()[0],(ve!==null?ve.memoizedState:null)!==o&&(ue.flags|=1024),c}function _r(){var o=Kr!==0;return Kr=0,o}function Zr(o,c,h){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~h}function Ts(o){if(Je){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}Je=!1}ke=0,Le=ve=ue=null,bn=!1,Kn=Kr=0,vr=null}function xr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Le===null?ue.memoizedState=Le=o:Le=Le.next=o,Le}function jn(){if(ve===null){var o=ue.alternate;o=o!==null?o.memoizedState:null}else o=ve.next;var c=Le===null?ue.memoizedState:Le.next;if(c!==null)Le=c,ve=o;else{if(o===null)throw ue.alternate===null?Error(r(467)):Error(r(310));ve=o,o={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},Le===null?ue.memoizedState=Le=o:Le=Le.next=o}return Le}function du(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Aa(o){var c=Kn;return Kn+=1,vr===null&&(vr=[]),o=G(vr,o,c),c=ue,(Le===null?c.memoizedState:Le.next)===null&&(c=c.alternate,Z.H=c===null||c.memoizedState===null?lw:cw),o}function pu(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Aa(o);if(o.$$typeof===T)return gr(o)}throw Error(r(438,String(o)))}function xh(o){var c=null,h=ue.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var g=ue.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(c={data:g.data.map(function(b){return b.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=du(),ue.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(o),g=0;g<o;g++)h[g]=B;return c.index++,h}function Zi(o,c){return typeof c=="function"?c(o):c}function mu(o){var c=jn();return gu(c,ve,o)}function gu(o,c,h){var g=o.queue;if(g===null)throw Error(r(311));g.lastRenderedReducer=h;var b=o.baseQueue,A=g.pending;if(A!==null){if(b!==null){var U=b.next;b.next=A.next,A.next=U}c.baseQueue=b=A,g.pending=null}if(A=o.baseState,b===null)o.memoizedState=A;else{c=b.next;var Y=U=null,mt=null,Ft=c,Vt=!1;do{var Kt=Ft.lane&-536870913;if(Kt!==Ft.lane?(tn&Kt)===Kt:(ke&Kt)===Kt){var zt=Ft.revertLane;if(zt===0)mt!==null&&(mt=mt.next={lane:0,revertLane:0,action:Ft.action,hasEagerState:Ft.hasEagerState,eagerState:Ft.eagerState,next:null}),Kt===Ii&&(Vt=!0);else if((ke&zt)===zt){Ft=Ft.next,zt===Ii&&(Vt=!0);continue}else Kt={lane:0,revertLane:Ft.revertLane,action:Ft.action,hasEagerState:Ft.hasEagerState,eagerState:Ft.eagerState,next:null},mt===null?(Y=mt=Kt,U=A):mt=mt.next=Kt,ue.lanes|=zt,hl|=zt;Kt=Ft.action,Xn&&h(A,Kt),A=Ft.hasEagerState?Ft.eagerState:h(A,Kt)}else zt={lane:Kt,revertLane:Ft.revertLane,action:Ft.action,hasEagerState:Ft.hasEagerState,eagerState:Ft.eagerState,next:null},mt===null?(Y=mt=zt,U=A):mt=mt.next=zt,ue.lanes|=Kt,hl|=Kt;Ft=Ft.next}while(Ft!==null&&Ft!==c);if(mt===null?U=A:mt.next=Y,!qr(A,o.memoizedState)&&(Ar=!0,Vt&&(h=vi,h!==null)))throw h;o.memoizedState=A,o.baseState=U,o.baseQueue=mt,g.lastRenderedState=A}return b===null&&(g.lanes=0),[o.memoizedState,g.dispatch]}function yh(o){var c=jn(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=o;var g=h.dispatch,b=h.pending,A=c.memoizedState;if(b!==null){h.pending=null;var U=b=b.next;do A=o(A,U.action),U=U.next;while(U!==b);qr(A,c.memoizedState)||(Ar=!0),c.memoizedState=A,c.baseQueue===null&&(c.baseState=A),h.lastRenderedState=A}return[A,g]}function bh(o,c,h){var g=ue,b=jn(),A=an;if(A){if(h===void 0)throw Error(r(407));h=h()}else h=c();var U=!qr((ve||b).memoizedState,h);U&&(b.memoizedState=h,Ar=!0),b=b.queue;var Y=h0.bind(null,g,b,o);if(Oh(2048,8,Y,[o]),b.getSnapshot!==c||U||Le!==null&&Le.memoizedState.tag&1){if(g.flags|=2048,yu(9,m0(),f0.bind(null,g,b,h,c),null),kn===null)throw Error(r(349));A||(ke&124)!==0||wh(g,c,h)}return h}function wh(o,c,h){o.flags|=16384,o={getSnapshot:c,value:h},c=ue.updateQueue,c===null?(c=du(),ue.updateQueue=c,c.stores=[o]):(h=c.stores,h===null?c.stores=[o]:h.push(o))}function f0(o,c,h,g){c.value=h,c.getSnapshot=g,Sa(c)&&oc(o)}function h0(o,c,h){return h(function(){Sa(c)&&oc(o)})}function Sa(o){var c=o.getSnapshot;o=o.value;try{var h=c();return!qr(o,h)}catch{return!0}}function oc(o){var c=Yr(o,2);c!==null&&ns(c,o,2)}function vu(o){var c=xr();if(typeof o=="function"){var h=o;if(o=h(),Xn){ne(!0);try{h()}finally{ne(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:o},c}function Eh(o,c,h,g){return o.baseState=h,gu(o,ve,typeof g=="function"?g:Zi)}function Ah(o,c,h,g,b){if(v0(o))throw Error(r(485));if(o=c.action,o!==null){var A={payload:b,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){A.listeners.push(U)}};Z.T!==null?h(!0):A.isTransition=!1,g(A),h=c.pending,h===null?(A.next=c.pending=A,Sh(c,A)):(A.next=h.next,c.pending=h.next=A)}}function Sh(o,c){var h=c.action,g=c.payload,b=o.state;if(c.isTransition){var A=Z.T,U={};Z.T=U;try{var Y=h(b,g),mt=Z.S;mt!==null&&mt(U,Y),Th(o,c,Y)}catch(Ft){_u(o,c,Ft)}finally{Z.T=A}}else try{A=h(b,g),Th(o,c,A)}catch(Ft){_u(o,c,Ft)}}function Th(o,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(g){Ch(o,c,g)},function(g){return _u(o,c,g)}):Ch(o,c,h)}function Ch(o,c,h){c.status="fulfilled",c.value=h,d0(c),o.state=h,c=o.pending,c!==null&&(h=c.next,h===c?o.pending=null:(h=h.next,c.next=h,Sh(o,h)))}function _u(o,c,h){var g=o.pending;if(o.pending=null,g!==null){g=g.next;do c.status="rejected",c.reason=h,d0(c),c=c.next;while(c!==g)}o.action=null}function d0(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function p0(o,c){return c}function xu(o,c){if(an){var h=kn.formState;if(h!==null){t:{var g=ue;if(an){if(Nn){e:{for(var b=Nn,A=Ss;b.nodeType!==8;){if(!A){b=null;break e}if(b=ra(b.nextSibling),b===null){b=null;break e}}A=b.data,b=A==="F!"||A==="F"?b:null}if(b){Nn=ra(b.nextSibling),g=b.data==="F!";break t}}Js(g)}g=!1}g&&(c=h[0])}}return h=xr(),h.memoizedState=h.baseState=c,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p0,lastRenderedState:c},h.queue=g,h=sw.bind(null,ue,g),g.dispatch=h,g=vu(!1),A=Uv.bind(null,ue,!1,g.queue),g=xr(),b={state:c,dispatch:null,action:o,pending:null},g.queue=b,h=Ah.bind(null,ue,b,A,h),b.dispatch=h,g.memoizedState=o,[c,h,!1]}function Dh(o){var c=jn();return Hb(c,ve,o)}function Hb(o,c,h){if(c=gu(o,c,p0)[0],o=mu(Zi)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var g=Aa(c)}catch(U){throw U===sl?_o:U}else g=c;c=jn();var b=c.queue,A=b.dispatch;return h!==c.memoizedState&&(ue.flags|=2048,yu(9,m0(),ck.bind(null,b,h),null)),[g,A,o]}function ck(o,c){o.action=c}function $b(o){var c=jn(),h=ve;if(h!==null)return Hb(c,h,o);jn(),c=c.memoizedState,h=jn();var g=h.queue.dispatch;return h.memoizedState=o,[c,g,!1]}function yu(o,c,h,g){return o={tag:o,create:h,deps:g,inst:c,next:null},c=ue.updateQueue,c===null&&(c=du(),ue.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=o.next=o:(g=h.next,h.next=o,o.next=g,c.lastEffect=o),o}function m0(){return{destroy:void 0,resource:void 0}}function Gb(){return jn().memoizedState}function g0(o,c,h,g){var b=xr();g=g===void 0?null:g,ue.flags|=o,b.memoizedState=yu(1|c,m0(),h,g)}function Oh(o,c,h,g){var b=jn();g=g===void 0?null:g;var A=b.memoizedState.inst;ve!==null&&g!==null&&Pi(g,ve.memoizedState.deps)?b.memoizedState=yu(c,A,h,g):(ue.flags|=o,b.memoizedState=yu(1|c,A,h,g))}function Vb(o,c){g0(8390656,8,o,c)}function Wb(o,c){Oh(2048,8,o,c)}function qb(o,c){return Oh(4,2,o,c)}function Yb(o,c){return Oh(4,4,o,c)}function Xb(o,c){if(typeof c=="function"){o=o();var h=c(o);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function Kb(o,c,h){h=h!=null?h.concat([o]):null,Oh(4,4,Xb.bind(null,c,o),h)}function Mv(){}function Zb(o,c){var h=jn();c=c===void 0?null:c;var g=h.memoizedState;return c!==null&&Pi(c,g[1])?g[0]:(h.memoizedState=[o,c],o)}function Qb(o,c){var h=jn();c=c===void 0?null:c;var g=h.memoizedState;if(c!==null&&Pi(c,g[1]))return g[0];if(g=o(),Xn){ne(!0);try{o()}finally{ne(!1)}}return h.memoizedState=[g,c],g}function Pv(o,c,h){return h===void 0||(ke&1073741824)!==0?o.memoizedState=c:(o.memoizedState=h,o=eE(),ue.lanes|=o,hl|=o,h)}function Jb(o,c,h,g){return qr(h,c)?h:Te.current!==null?(o=Pv(o,h,g),qr(o,c)||(Ar=!0),o):(ke&42)===0?(Ar=!0,o.memoizedState=h):(o=eE(),ue.lanes|=o,hl|=o,c)}function tw(o,c,h,g,b){var A=q.p;q.p=A!==0&&8>A?A:8;var U=Z.T,Y={};Z.T=Y,Uv(o,!1,c,h);try{var mt=b(),Ft=Z.S;if(Ft!==null&&Ft(Y,mt),mt!==null&&typeof mt=="object"&&typeof mt.then=="function"){var Vt=Iv(mt,g);Rh(o,c,Vt,es(o))}else Rh(o,c,g,es(o))}catch(Kt){Rh(o,c,{then:function(){},status:"rejected",reason:Kt},es())}finally{q.p=A,Z.T=U}}function uk(){}function Fv(o,c,h,g){if(o.tag!==5)throw Error(r(476));var b=ew(o).queue;tw(o,b,c,Ct,h===null?uk:function(){return nw(o),h(g)})}function ew(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:Ct,baseState:Ct,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:Ct},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zi,lastRenderedState:h},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function nw(o){var c=ew(o).next.queue;Rh(o,c,{},es())}function Bv(){return gr(Yh)}function rw(){return jn().memoizedState}function iw(){return jn().memoizedState}function fk(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var h=es();o=qt(h);var g=ie(c,o,h);g!==null&&(ns(g,c,h),fe(g,c,h)),c={cache:sc()},o.payload=c;return}c=c.return}}function hk(o,c,h){var g=es();h={lane:g,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},v0(o)?aw(c,h):(h=ih(o,c,h,g),h!==null&&(ns(h,o,g),ow(h,c,g)))}function sw(o,c,h){var g=es();Rh(o,c,h,g)}function Rh(o,c,h,g){var b={lane:g,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(v0(o))aw(c,b);else{var A=o.alternate;if(o.lanes===0&&(A===null||A.lanes===0)&&(A=c.lastRenderedReducer,A!==null))try{var U=c.lastRenderedState,Y=A(U,h);if(b.hasEagerState=!0,b.eagerState=Y,qr(Y,U))return cu(o,c,b,0),kn===null&&lu(),!1}catch{}finally{}if(h=ih(o,c,b,g),h!==null)return ns(h,o,g),ow(h,c,g),!0}return!1}function Uv(o,c,h,g){if(g={lane:2,revertLane:v1(),action:g,hasEagerState:!1,eagerState:null,next:null},v0(o)){if(c)throw Error(r(479))}else c=ih(o,h,g,2),c!==null&&ns(c,o,2)}function v0(o){var c=o.alternate;return o===ue||c!==null&&c===ue}function aw(o,c){bn=Je=!0;var h=o.pending;h===null?c.next=c:(c.next=h.next,h.next=c),o.pending=c}function ow(o,c,h){if((h&4194048)!==0){var g=c.lanes;g&=o.pendingLanes,h|=g,c.lanes=h,Kc(o,h)}}var _0={readContext:gr,use:pu,useCallback:Ue,useContext:Ue,useEffect:Ue,useImperativeHandle:Ue,useLayoutEffect:Ue,useInsertionEffect:Ue,useMemo:Ue,useReducer:Ue,useRef:Ue,useState:Ue,useDebugValue:Ue,useDeferredValue:Ue,useTransition:Ue,useSyncExternalStore:Ue,useId:Ue,useHostTransitionStatus:Ue,useFormState:Ue,useActionState:Ue,useOptimistic:Ue,useMemoCache:Ue,useCacheRefresh:Ue},lw={readContext:gr,use:pu,useCallback:function(o,c){return xr().memoizedState=[o,c===void 0?null:c],o},useContext:gr,useEffect:Vb,useImperativeHandle:function(o,c,h){h=h!=null?h.concat([o]):null,g0(4194308,4,Xb.bind(null,c,o),h)},useLayoutEffect:function(o,c){return g0(4194308,4,o,c)},useInsertionEffect:function(o,c){g0(4,2,o,c)},useMemo:function(o,c){var h=xr();c=c===void 0?null:c;var g=o();if(Xn){ne(!0);try{o()}finally{ne(!1)}}return h.memoizedState=[g,c],g},useReducer:function(o,c,h){var g=xr();if(h!==void 0){var b=h(c);if(Xn){ne(!0);try{h(c)}finally{ne(!1)}}}else b=c;return g.memoizedState=g.baseState=b,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:b},g.queue=o,o=o.dispatch=hk.bind(null,ue,o),[g.memoizedState,o]},useRef:function(o){var c=xr();return o={current:o},c.memoizedState=o},useState:function(o){o=vu(o);var c=o.queue,h=sw.bind(null,ue,c);return c.dispatch=h,[o.memoizedState,h]},useDebugValue:Mv,useDeferredValue:function(o,c){var h=xr();return Pv(h,o,c)},useTransition:function(){var o=vu(!1);return o=tw.bind(null,ue,o.queue,!0,!1),xr().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,h){var g=ue,b=xr();if(an){if(h===void 0)throw Error(r(407));h=h()}else{if(h=c(),kn===null)throw Error(r(349));(tn&124)!==0||wh(g,c,h)}b.memoizedState=h;var A={value:h,getSnapshot:c};return b.queue=A,Vb(h0.bind(null,g,A,o),[o]),g.flags|=2048,yu(9,m0(),f0.bind(null,g,A,h,c),null),h},useId:function(){var o=xr(),c=kn.identifierPrefix;if(an){var h=Ir,g=Qs;h=(g&~(1<<32-Re(g)-1)).toString(32)+h,c="«"+c+"R"+h,h=Kr++,0<h&&(c+="H"+h.toString(32)),c+="»"}else h=Mi++,c="«"+c+"r"+h.toString(32)+"»";return o.memoizedState=c},useHostTransitionStatus:Bv,useFormState:xu,useActionState:xu,useOptimistic:function(o){var c=xr();c.memoizedState=c.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=Uv.bind(null,ue,!0,h),h.dispatch=c,[o,c]},useMemoCache:xh,useCacheRefresh:function(){return xr().memoizedState=fk.bind(null,ue)}},cw={readContext:gr,use:pu,useCallback:Zb,useContext:gr,useEffect:Wb,useImperativeHandle:Kb,useInsertionEffect:qb,useLayoutEffect:Yb,useMemo:Qb,useReducer:mu,useRef:Gb,useState:function(){return mu(Zi)},useDebugValue:Mv,useDeferredValue:function(o,c){var h=jn();return Jb(h,ve.memoizedState,o,c)},useTransition:function(){var o=mu(Zi)[0],c=jn().memoizedState;return[typeof o=="boolean"?o:Aa(o),c]},useSyncExternalStore:bh,useId:rw,useHostTransitionStatus:Bv,useFormState:Dh,useActionState:Dh,useOptimistic:function(o,c){var h=jn();return Eh(h,ve,o,c)},useMemoCache:xh,useCacheRefresh:iw},dk={readContext:gr,use:pu,useCallback:Zb,useContext:gr,useEffect:Wb,useImperativeHandle:Kb,useInsertionEffect:qb,useLayoutEffect:Yb,useMemo:Qb,useReducer:yh,useRef:Gb,useState:function(){return yh(Zi)},useDebugValue:Mv,useDeferredValue:function(o,c){var h=jn();return ve===null?Pv(h,o,c):Jb(h,ve.memoizedState,o,c)},useTransition:function(){var o=yh(Zi)[0],c=jn().memoizedState;return[typeof o=="boolean"?o:Aa(o),c]},useSyncExternalStore:bh,useId:rw,useHostTransitionStatus:Bv,useFormState:$b,useActionState:$b,useOptimistic:function(o,c){var h=jn();return ve!==null?Eh(h,ve,o,c):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:xh,useCacheRefresh:iw},bu=null,Nh=0;function x0(o){var c=Nh;return Nh+=1,bu===null&&(bu=[]),G(bu,o,c)}function kh(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function y0(o,c){throw c.$$typeof===p?Error(r(525)):(o=Object.prototype.toString.call(c),Error(r(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function uw(o){var c=o._init;return c(o._payload)}function fw(o){function c(Ot,bt){if(o){var Mt=Ot.deletions;Mt===null?(Ot.deletions=[bt],Ot.flags|=16):Mt.push(bt)}}function h(Ot,bt){if(!o)return null;for(;bt!==null;)c(Ot,bt),bt=bt.sibling;return null}function g(Ot){for(var bt=new Map;Ot!==null;)Ot.key!==null?bt.set(Ot.key,Ot):bt.set(Ot.index,Ot),Ot=Ot.sibling;return bt}function b(Ot,bt){return Ot=Ks(Ot,bt),Ot.index=0,Ot.sibling=null,Ot}function A(Ot,bt,Mt){return Ot.index=Mt,o?(Mt=Ot.alternate,Mt!==null?(Mt=Mt.index,Mt<bt?(Ot.flags|=67108866,bt):Mt):(Ot.flags|=67108866,bt)):(Ot.flags|=1048576,bt)}function U(Ot){return o&&Ot.alternate===null&&(Ot.flags|=67108866),Ot}function Y(Ot,bt,Mt,Yt){return bt===null||bt.tag!==6?(bt=tl(Mt,Ot.mode,Yt),bt.return=Ot,bt):(bt=b(bt,Mt),bt.return=Ot,bt)}function mt(Ot,bt,Mt,Yt){var pe=Mt.type;return pe===x?Vt(Ot,bt,Mt.props.children,Yt,Mt.key):bt!==null&&(bt.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===I&&uw(pe)===bt.type)?(bt=b(bt,Mt.props),kh(bt,Mt),bt.return=Ot,bt):(bt=fu(Mt.type,Mt.key,Mt.props,null,Ot.mode,Yt),kh(bt,Mt),bt.return=Ot,bt)}function Ft(Ot,bt,Mt,Yt){return bt===null||bt.tag!==4||bt.stateNode.containerInfo!==Mt.containerInfo||bt.stateNode.implementation!==Mt.implementation?(bt=oh(Mt,Ot.mode,Yt),bt.return=Ot,bt):(bt=b(bt,Mt.children||[]),bt.return=Ot,bt)}function Vt(Ot,bt,Mt,Yt,pe){return bt===null||bt.tag!==7?(bt=Zs(Mt,Ot.mode,Yt,pe),bt.return=Ot,bt):(bt=b(bt,Mt),bt.return=Ot,bt)}function Kt(Ot,bt,Mt){if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return bt=tl(""+bt,Ot.mode,Mt),bt.return=Ot,bt;if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case m:return Mt=fu(bt.type,bt.key,bt.props,null,Ot.mode,Mt),kh(Mt,bt),Mt.return=Ot,Mt;case v:return bt=oh(bt,Ot.mode,Mt),bt.return=Ot,bt;case I:var Yt=bt._init;return bt=Yt(bt._payload),Kt(Ot,bt,Mt)}if(it(bt)||F(bt))return bt=Zs(bt,Ot.mode,Mt,null),bt.return=Ot,bt;if(typeof bt.then=="function")return Kt(Ot,x0(bt),Mt);if(bt.$$typeof===T)return Kt(Ot,rl(Ot,bt),Mt);y0(Ot,bt)}return null}function zt(Ot,bt,Mt,Yt){var pe=bt!==null?bt.key:null;if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint")return pe!==null?null:Y(Ot,bt,""+Mt,Yt);if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case m:return Mt.key===pe?mt(Ot,bt,Mt,Yt):null;case v:return Mt.key===pe?Ft(Ot,bt,Mt,Yt):null;case I:return pe=Mt._init,Mt=pe(Mt._payload),zt(Ot,bt,Mt,Yt)}if(it(Mt)||F(Mt))return pe!==null?null:Vt(Ot,bt,Mt,Yt,null);if(typeof Mt.then=="function")return zt(Ot,bt,x0(Mt),Yt);if(Mt.$$typeof===T)return zt(Ot,bt,rl(Ot,Mt),Yt);y0(Ot,Mt)}return null}function jt(Ot,bt,Mt,Yt,pe){if(typeof Yt=="string"&&Yt!==""||typeof Yt=="number"||typeof Yt=="bigint")return Ot=Ot.get(Mt)||null,Y(bt,Ot,""+Yt,pe);if(typeof Yt=="object"&&Yt!==null){switch(Yt.$$typeof){case m:return Ot=Ot.get(Yt.key===null?Mt:Yt.key)||null,mt(bt,Ot,Yt,pe);case v:return Ot=Ot.get(Yt.key===null?Mt:Yt.key)||null,Ft(bt,Ot,Yt,pe);case I:var We=Yt._init;return Yt=We(Yt._payload),jt(Ot,bt,Mt,Yt,pe)}if(it(Yt)||F(Yt))return Ot=Ot.get(Mt)||null,Vt(bt,Ot,Yt,pe,null);if(typeof Yt.then=="function")return jt(Ot,bt,Mt,x0(Yt),pe);if(Yt.$$typeof===T)return jt(Ot,bt,Mt,rl(bt,Yt),pe);y0(bt,Yt)}return null}function Me(Ot,bt,Mt,Yt){for(var pe=null,We=null,_e=bt,De=bt=0,Tr=null;_e!==null&&De<Mt.length;De++){_e.index>De?(Tr=_e,_e=null):Tr=_e.sibling;var cn=zt(Ot,_e,Mt[De],Yt);if(cn===null){_e===null&&(_e=Tr);break}o&&_e&&cn.alternate===null&&c(Ot,_e),bt=A(cn,bt,De),We===null?pe=cn:We.sibling=cn,We=cn,_e=Tr}if(De===Mt.length)return h(Ot,_e),an&&fo(Ot,De),pe;if(_e===null){for(;De<Mt.length;De++)_e=Kt(Ot,Mt[De],Yt),_e!==null&&(bt=A(_e,bt,De),We===null?pe=_e:We.sibling=_e,We=_e);return an&&fo(Ot,De),pe}for(_e=g(_e);De<Mt.length;De++)Tr=jt(_e,Ot,De,Mt[De],Yt),Tr!==null&&(o&&Tr.alternate!==null&&_e.delete(Tr.key===null?De:Tr.key),bt=A(Tr,bt,De),We===null?pe=Tr:We.sibling=Tr,We=Tr);return o&&_e.forEach(function(bl){return c(Ot,bl)}),an&&fo(Ot,De),pe}function Ce(Ot,bt,Mt,Yt){if(Mt==null)throw Error(r(151));for(var pe=null,We=null,_e=bt,De=bt=0,Tr=null,cn=Mt.next();_e!==null&&!cn.done;De++,cn=Mt.next()){_e.index>De?(Tr=_e,_e=null):Tr=_e.sibling;var bl=zt(Ot,_e,cn.value,Yt);if(bl===null){_e===null&&(_e=Tr);break}o&&_e&&bl.alternate===null&&c(Ot,_e),bt=A(bl,bt,De),We===null?pe=bl:We.sibling=bl,We=bl,_e=Tr}if(cn.done)return h(Ot,_e),an&&fo(Ot,De),pe;if(_e===null){for(;!cn.done;De++,cn=Mt.next())cn=Kt(Ot,cn.value,Yt),cn!==null&&(bt=A(cn,bt,De),We===null?pe=cn:We.sibling=cn,We=cn);return an&&fo(Ot,De),pe}for(_e=g(_e);!cn.done;De++,cn=Mt.next())cn=jt(_e,Ot,De,cn.value,Yt),cn!==null&&(o&&cn.alternate!==null&&_e.delete(cn.key===null?De:cn.key),bt=A(cn,bt,De),We===null?pe=cn:We.sibling=cn,We=cn);return o&&_e.forEach(function(pL){return c(Ot,pL)}),an&&fo(Ot,De),pe}function En(Ot,bt,Mt,Yt){if(typeof Mt=="object"&&Mt!==null&&Mt.type===x&&Mt.key===null&&(Mt=Mt.props.children),typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case m:t:{for(var pe=Mt.key;bt!==null;){if(bt.key===pe){if(pe=Mt.type,pe===x){if(bt.tag===7){h(Ot,bt.sibling),Yt=b(bt,Mt.props.children),Yt.return=Ot,Ot=Yt;break t}}else if(bt.elementType===pe||typeof pe=="object"&&pe!==null&&pe.$$typeof===I&&uw(pe)===bt.type){h(Ot,bt.sibling),Yt=b(bt,Mt.props),kh(Yt,Mt),Yt.return=Ot,Ot=Yt;break t}h(Ot,bt);break}else c(Ot,bt);bt=bt.sibling}Mt.type===x?(Yt=Zs(Mt.props.children,Ot.mode,Yt,Mt.key),Yt.return=Ot,Ot=Yt):(Yt=fu(Mt.type,Mt.key,Mt.props,null,Ot.mode,Yt),kh(Yt,Mt),Yt.return=Ot,Ot=Yt)}return U(Ot);case v:t:{for(pe=Mt.key;bt!==null;){if(bt.key===pe)if(bt.tag===4&&bt.stateNode.containerInfo===Mt.containerInfo&&bt.stateNode.implementation===Mt.implementation){h(Ot,bt.sibling),Yt=b(bt,Mt.children||[]),Yt.return=Ot,Ot=Yt;break t}else{h(Ot,bt);break}else c(Ot,bt);bt=bt.sibling}Yt=oh(Mt,Ot.mode,Yt),Yt.return=Ot,Ot=Yt}return U(Ot);case I:return pe=Mt._init,Mt=pe(Mt._payload),En(Ot,bt,Mt,Yt)}if(it(Mt))return Me(Ot,bt,Mt,Yt);if(F(Mt)){if(pe=F(Mt),typeof pe!="function")throw Error(r(150));return Mt=pe.call(Mt),Ce(Ot,bt,Mt,Yt)}if(typeof Mt.then=="function")return En(Ot,bt,x0(Mt),Yt);if(Mt.$$typeof===T)return En(Ot,bt,rl(Ot,Mt),Yt);y0(Ot,Mt)}return typeof Mt=="string"&&Mt!==""||typeof Mt=="number"||typeof Mt=="bigint"?(Mt=""+Mt,bt!==null&&bt.tag===6?(h(Ot,bt.sibling),Yt=b(bt,Mt),Yt.return=Ot,Ot=Yt):(h(Ot,bt),Yt=tl(Mt,Ot.mode,Yt),Yt.return=Ot,Ot=Yt),U(Ot)):h(Ot,bt)}return function(Ot,bt,Mt,Yt){try{Nh=0;var pe=En(Ot,bt,Mt,Yt);return bu=null,pe}catch(_e){if(_e===sl||_e===_o)throw _e;var We=gi(29,_e,null,Ot.mode);return We.lanes=Yt,We.return=Ot,We}finally{}}}var wu=fw(!0),hw=fw(!1),Cs=V(null),Ta=null;function al(o){var c=o.alternate;et(yr,yr.current&1),et(Cs,o),Ta===null&&(c===null||Te.current!==null||c.memoizedState!==null)&&(Ta=o)}function dw(o){if(o.tag===22){if(et(yr,yr.current),et(Cs,o),Ta===null){var c=o.alternate;c!==null&&c.memoizedState!==null&&(Ta=o)}}else ol()}function ol(){et(yr,yr.current),et(Cs,Cs.current)}function yo(o){j(Cs),Ta===o&&(Ta=null),j(yr)}var yr=V(0);function b0(o){for(var c=o;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||O1(h)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function zv(o,c,h,g){c=o.memoizedState,h=h(g,c),h=h==null?c:d({},c,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var jv={enqueueSetState:function(o,c,h){o=o._reactInternals;var g=es(),b=qt(g);b.payload=c,h!=null&&(b.callback=h),c=ie(o,b,g),c!==null&&(ns(c,o,g),fe(c,o,g))},enqueueReplaceState:function(o,c,h){o=o._reactInternals;var g=es(),b=qt(g);b.tag=1,b.payload=c,h!=null&&(b.callback=h),c=ie(o,b,g),c!==null&&(ns(c,o,g),fe(c,o,g))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var h=es(),g=qt(h);g.tag=2,c!=null&&(g.callback=c),c=ie(o,g,h),c!==null&&(ns(c,o,h),fe(c,o,h))}};function pw(o,c,h,g,b,A,U){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,A,U):c.prototype&&c.prototype.isPureReactComponent?!so(h,g)||!so(b,A):!0}function mw(o,c,h,g){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,g),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,g),c.state!==o&&jv.enqueueReplaceState(c,c.state,null)}function lc(o,c){var h=c;if("ref"in c){h={};for(var g in c)g!=="ref"&&(h[g]=c[g])}if(o=o.defaultProps){h===c&&(h=d({},h));for(var b in o)h[b]===void 0&&(h[b]=o[b])}return h}var w0=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function gw(o){w0(o)}function vw(o){console.error(o)}function _w(o){w0(o)}function E0(o,c){try{var h=o.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(g){setTimeout(function(){throw g})}}function xw(o,c,h){try{var g=o.onCaughtError;g(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function Hv(o,c,h){return h=qt(h),h.tag=3,h.payload={element:null},h.callback=function(){E0(o,c)},h}function yw(o){return o=qt(o),o.tag=3,o}function bw(o,c,h,g){var b=h.type.getDerivedStateFromError;if(typeof b=="function"){var A=g.value;o.payload=function(){return b(A)},o.callback=function(){xw(c,h,g)}}var U=h.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(o.callback=function(){xw(c,h,g),typeof b!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var Y=g.stack;this.componentDidCatch(g.value,{componentStack:Y!==null?Y:""})})}function pk(o,c,h,g,b){if(h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(c=h.alternate,c!==null&&rc(c,h,b,!0),h=Cs.current,h!==null){switch(h.tag){case 13:return Ta===null?h1():h.alternate===null&&qn===0&&(qn=3),h.flags&=-257,h.flags|=65536,h.lanes=b,g===_h?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([g]):c.add(g),p1(o,g,b)),!1;case 22:return h.flags|=65536,g===_h?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([g])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([g]):h.add(g)),p1(o,g,b)),!1}throw Error(r(435,h.tag))}return p1(o,g,b),h1(),!1}if(an)return c=Cs.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=b,g!==ba&&(o=Error(r(422),{cause:g}),Ki(pi(o,h)))):(g!==ba&&(c=Error(r(423),{cause:g}),Ki(pi(c,h))),o=o.current.alternate,o.flags|=65536,b&=-b,o.lanes|=b,g=pi(g,h),b=Hv(o.stateNode,g,b),he(o,b),qn!==4&&(qn=2)),!1;var A=Error(r(520),{cause:g});if(A=pi(A,h),Uh===null?Uh=[A]:Uh.push(A),qn!==4&&(qn=2),c===null)return!0;g=pi(g,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,o=b&-b,h.lanes|=o,o=Hv(h.stateNode,g,o),he(h,o),!1;case 1:if(c=h.type,A=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(dl===null||!dl.has(A))))return h.flags|=65536,b&=-b,h.lanes|=b,b=yw(b),bw(b,o,h,g),he(h,b),!1}h=h.return}while(h!==null);return!1}var ww=Error(r(461)),Ar=!1;function Mr(o,c,h,g){c.child=o===null?hw(c,null,h,g):wu(c,o.child,h,g)}function Ew(o,c,h,g,b){h=h.render;var A=c.ref;if("ref"in g){var U={};for(var Y in g)Y!=="ref"&&(U[Y]=g[Y])}else U=g;return po(c),g=Fi(o,c,h,U,A,b),Y=_r(),o!==null&&!Ar?(Zr(o,c,b),bo(o,c,b)):(an&&Y&&lh(c),c.flags|=1,Mr(o,c,g,b),c.child)}function Aw(o,c,h,g,b){if(o===null){var A=h.type;return typeof A=="function"&&!ah(A)&&A.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=A,Sw(o,c,A,g,b)):(o=fu(h.type,null,g,c,c.mode,b),o.ref=c.ref,o.return=c,c.child=o)}if(A=o.child,!Kv(o,b)){var U=A.memoizedProps;if(h=h.compare,h=h!==null?h:so,h(U,g)&&o.ref===c.ref)return bo(o,c,b)}return c.flags|=1,o=Ks(A,g),o.ref=c.ref,o.return=c,c.child=o}function Sw(o,c,h,g,b){if(o!==null){var A=o.memoizedProps;if(so(A,g)&&o.ref===c.ref)if(Ar=!1,c.pendingProps=g=A,Kv(o,b))(o.flags&131072)!==0&&(Ar=!0);else return c.lanes=o.lanes,bo(o,c,b)}return $v(o,c,h,g,b)}function Tw(o,c,h){var g=c.pendingProps,b=g.children,A=o!==null?o.memoizedState:null;if(g.mode==="hidden"){if((c.flags&128)!==0){if(g=A!==null?A.baseLanes|h:h,o!==null){for(b=c.child=o.child,A=0;b!==null;)A=A|b.lanes|b.childLanes,b=b.sibling;c.childLanes=A&~g}else c.childLanes=0,c.child=null;return Cw(o,c,g,h)}if((h&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&hu(c,A!==null?A.cachePool:null),A!==null?pn(c,A):je(),dw(c);else return c.lanes=c.childLanes=536870912,Cw(o,c,A!==null?A.baseLanes|h:h,h)}else A!==null?(hu(c,A.cachePool),pn(c,A),ol(),c.memoizedState=null):(o!==null&&hu(c,null),je(),ol());return Mr(o,c,b,h),c.child}function Cw(o,c,h,g){var b=vh();return b=b===null?null:{parent:Wn._currentValue,pool:b},c.memoizedState={baseLanes:h,cachePool:b},o!==null&&hu(c,null),je(),dw(c),o!==null&&rc(o,c,g,!0),null}function A0(o,c){var h=c.ref;if(h===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(o===null||o.ref!==h)&&(c.flags|=4194816)}}function $v(o,c,h,g,b){return po(c),h=Fi(o,c,h,g,void 0,b),g=_r(),o!==null&&!Ar?(Zr(o,c,b),bo(o,c,b)):(an&&g&&lh(c),c.flags|=1,Mr(o,c,h,b),c.child)}function Dw(o,c,h,g,b,A){return po(c),c.updateQueue=null,h=Zn(c,g,h,b),xo(o),g=_r(),o!==null&&!Ar?(Zr(o,c,A),bo(o,c,A)):(an&&g&&lh(c),c.flags|=1,Mr(o,c,h,A),c.child)}function Ow(o,c,h,g,b){if(po(c),c.stateNode===null){var A=Jo,U=h.contextType;typeof U=="object"&&U!==null&&(A=gr(U)),A=new h(g,A),c.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=jv,c.stateNode=A,A._reactInternals=c,A=c.stateNode,A.props=g,A.state=c.memoizedState,A.refs={},Dt(c),U=h.contextType,A.context=typeof U=="object"&&U!==null?gr(U):Jo,A.state=c.memoizedState,U=h.getDerivedStateFromProps,typeof U=="function"&&(zv(c,h,U,g),A.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(U=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),U!==A.state&&jv.enqueueReplaceState(A,A.state,null),we(c,g,A,b),Pe(),A.state=c.memoizedState),typeof A.componentDidMount=="function"&&(c.flags|=4194308),g=!0}else if(o===null){A=c.stateNode;var Y=c.memoizedProps,mt=lc(h,Y);A.props=mt;var Ft=A.context,Vt=h.contextType;U=Jo,typeof Vt=="object"&&Vt!==null&&(U=gr(Vt));var Kt=h.getDerivedStateFromProps;Vt=typeof Kt=="function"||typeof A.getSnapshotBeforeUpdate=="function",Y=c.pendingProps!==Y,Vt||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(Y||Ft!==U)&&mw(c,A,g,U),wt=!1;var zt=c.memoizedState;A.state=zt,we(c,g,A,b),Pe(),Ft=c.memoizedState,Y||zt!==Ft||wt?(typeof Kt=="function"&&(zv(c,h,Kt,g),Ft=c.memoizedState),(mt=wt||pw(c,h,mt,g,zt,Ft,U))?(Vt||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(c.flags|=4194308)):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=g,c.memoizedState=Ft),A.props=g,A.state=Ft,A.context=U,g=mt):(typeof A.componentDidMount=="function"&&(c.flags|=4194308),g=!1)}else{A=c.stateNode,Gt(o,c),U=c.memoizedProps,Vt=lc(h,U),A.props=Vt,Kt=c.pendingProps,zt=A.context,Ft=h.contextType,mt=Jo,typeof Ft=="object"&&Ft!==null&&(mt=gr(Ft)),Y=h.getDerivedStateFromProps,(Ft=typeof Y=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==Kt||zt!==mt)&&mw(c,A,g,mt),wt=!1,zt=c.memoizedState,A.state=zt,we(c,g,A,b),Pe();var jt=c.memoizedState;U!==Kt||zt!==jt||wt||o!==null&&o.dependencies!==null&&ic(o.dependencies)?(typeof Y=="function"&&(zv(c,h,Y,g),jt=c.memoizedState),(Vt=wt||pw(c,h,Vt,g,zt,jt,mt)||o!==null&&o.dependencies!==null&&ic(o.dependencies))?(Ft||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(g,jt,mt),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(g,jt,mt)),typeof A.componentDidUpdate=="function"&&(c.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===o.memoizedProps&&zt===o.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===o.memoizedProps&&zt===o.memoizedState||(c.flags|=1024),c.memoizedProps=g,c.memoizedState=jt),A.props=g,A.state=jt,A.context=mt,g=Vt):(typeof A.componentDidUpdate!="function"||U===o.memoizedProps&&zt===o.memoizedState||(c.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===o.memoizedProps&&zt===o.memoizedState||(c.flags|=1024),g=!1)}return A=g,A0(o,c),g=(c.flags&128)!==0,A||g?(A=c.stateNode,h=g&&typeof h.getDerivedStateFromError!="function"?null:A.render(),c.flags|=1,o!==null&&g?(c.child=wu(c,o.child,null,b),c.child=wu(c,null,h,b)):Mr(o,c,h,b),c.memoizedState=A.state,o=c.child):o=bo(o,c,b),o}function Rw(o,c,h,g){return nc(),c.flags|=256,Mr(o,c,h,g),c.child}var Gv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vv(o){return{baseLanes:o,cachePool:c0()}}function Wv(o,c,h){return o=o!==null?o.childLanes&~h:0,c&&(o|=Ds),o}function Nw(o,c,h){var g=c.pendingProps,b=!1,A=(c.flags&128)!==0,U;if((U=A)||(U=o!==null&&o.memoizedState===null?!1:(yr.current&2)!==0),U&&(b=!0,c.flags&=-129),U=(c.flags&32)!==0,c.flags&=-33,o===null){if(an){if(b?al(c):ol(),an){var Y=Nn,mt;if(mt=Y){t:{for(mt=Y,Y=Ss;mt.nodeType!==8;){if(!Y){Y=null;break t}if(mt=ra(mt.nextSibling),mt===null){Y=null;break t}}Y=mt}Y!==null?(c.memoizedState={dehydrated:Y,treeContext:uo!==null?{id:Qs,overflow:Ir}:null,retryLane:536870912,hydrationErrors:null},mt=gi(18,null,null,0),mt.stateNode=Y,mt.return=c,c.child=mt,ar=c,Nn=null,mt=!0):mt=!1}mt||Js(c)}if(Y=c.memoizedState,Y!==null&&(Y=Y.dehydrated,Y!==null))return O1(Y)?c.lanes=32:c.lanes=536870912,null;yo(c)}return Y=g.children,g=g.fallback,b?(ol(),b=c.mode,Y=S0({mode:"hidden",children:Y},b),g=Zs(g,b,h,null),Y.return=c,g.return=c,Y.sibling=g,c.child=Y,b=c.child,b.memoizedState=Vv(h),b.childLanes=Wv(o,U,h),c.memoizedState=Gv,g):(al(c),qv(c,Y))}if(mt=o.memoizedState,mt!==null&&(Y=mt.dehydrated,Y!==null)){if(A)c.flags&256?(al(c),c.flags&=-257,c=Yv(o,c,h)):c.memoizedState!==null?(ol(),c.child=o.child,c.flags|=128,c=null):(ol(),b=g.fallback,Y=c.mode,g=S0({mode:"visible",children:g.children},Y),b=Zs(b,Y,h,null),b.flags|=2,g.return=c,b.return=c,g.sibling=b,c.child=g,wu(c,o.child,null,h),g=c.child,g.memoizedState=Vv(h),g.childLanes=Wv(o,U,h),c.memoizedState=Gv,c=b);else if(al(c),O1(Y)){if(U=Y.nextSibling&&Y.nextSibling.dataset,U)var Ft=U.dgst;U=Ft,g=Error(r(419)),g.stack="",g.digest=U,Ki({value:g,source:null,stack:null}),c=Yv(o,c,h)}else if(Ar||rc(o,c,h,!1),U=(h&o.childLanes)!==0,Ar||U){if(U=kn,U!==null&&(g=h&-h,g=(g&42)!==0?1:jl(g),g=(g&(U.suspendedLanes|h))!==0?0:g,g!==0&&g!==mt.retryLane))throw mt.retryLane=g,Yr(o,g),ns(U,o,g),ww;Y.data==="$?"||h1(),c=Yv(o,c,h)}else Y.data==="$?"?(c.flags|=192,c.child=o.child,c=null):(o=mt.treeContext,Nn=ra(Y.nextSibling),ar=c,an=!0,ya=null,Ss=!1,o!==null&&(Xr[Li++]=Qs,Xr[Li++]=Ir,Xr[Li++]=uo,Qs=o.id,Ir=o.overflow,uo=c),c=qv(c,g.children),c.flags|=4096);return c}return b?(ol(),b=g.fallback,Y=c.mode,mt=o.child,Ft=mt.sibling,g=Ks(mt,{mode:"hidden",children:g.children}),g.subtreeFlags=mt.subtreeFlags&65011712,Ft!==null?b=Ks(Ft,b):(b=Zs(b,Y,h,null),b.flags|=2),b.return=c,g.return=c,g.sibling=b,c.child=g,g=b,b=c.child,Y=o.child.memoizedState,Y===null?Y=Vv(h):(mt=Y.cachePool,mt!==null?(Ft=Wn._currentValue,mt=mt.parent!==Ft?{parent:Ft,pool:Ft}:mt):mt=c0(),Y={baseLanes:Y.baseLanes|h,cachePool:mt}),b.memoizedState=Y,b.childLanes=Wv(o,U,h),c.memoizedState=Gv,g):(al(c),h=o.child,o=h.sibling,h=Ks(h,{mode:"visible",children:g.children}),h.return=c,h.sibling=null,o!==null&&(U=c.deletions,U===null?(c.deletions=[o],c.flags|=16):U.push(o)),c.child=h,c.memoizedState=null,h)}function qv(o,c){return c=S0({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function S0(o,c){return o=gi(22,o,null,c),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function Yv(o,c,h){return wu(c,o.child,null,h),o=qv(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function kw(o,c,h){o.lanes|=c;var g=o.alternate;g!==null&&(g.lanes|=c),hh(o.return,c,h)}function Xv(o,c,h,g,b){var A=o.memoizedState;A===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:b}:(A.isBackwards=c,A.rendering=null,A.renderingStartTime=0,A.last=g,A.tail=h,A.tailMode=b)}function Lw(o,c,h){var g=c.pendingProps,b=g.revealOrder,A=g.tail;if(Mr(o,c,g.children,h),g=yr.current,(g&2)!==0)g=g&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)t:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&kw(o,h,c);else if(o.tag===19)kw(o,h,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break t;for(;o.sibling===null;){if(o.return===null||o.return===c)break t;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}switch(et(yr,g),b){case"forwards":for(h=c.child,b=null;h!==null;)o=h.alternate,o!==null&&b0(o)===null&&(b=h),h=h.sibling;h=b,h===null?(b=c.child,c.child=null):(b=h.sibling,h.sibling=null),Xv(c,!1,b,h,A);break;case"backwards":for(h=null,b=c.child,c.child=null;b!==null;){if(o=b.alternate,o!==null&&b0(o)===null){c.child=b;break}o=b.sibling,b.sibling=h,h=b,b=o}Xv(c,!0,h,null,A);break;case"together":Xv(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function bo(o,c,h){if(o!==null&&(c.dependencies=o.dependencies),hl|=c.lanes,(h&c.childLanes)===0)if(o!==null){if(rc(o,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(r(153));if(c.child!==null){for(o=c.child,h=Ks(o,o.pendingProps),c.child=h,h.return=c;o.sibling!==null;)o=o.sibling,h=h.sibling=Ks(o,o.pendingProps),h.return=c;h.sibling=null}return c.child}function Kv(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&ic(o)))}function mk(o,c,h){switch(c.tag){case 3:z(c,c.stateNode.containerInfo),wa(c,Wn,o.memoizedState.cache),nc();break;case 27:case 5:J(c);break;case 4:z(c,c.stateNode.containerInfo);break;case 10:wa(c,c.type,c.memoizedProps.value);break;case 13:var g=c.memoizedState;if(g!==null)return g.dehydrated!==null?(al(c),c.flags|=128,null):(h&c.child.childLanes)!==0?Nw(o,c,h):(al(c),o=bo(o,c,h),o!==null?o.sibling:null);al(c);break;case 19:var b=(o.flags&128)!==0;if(g=(h&c.childLanes)!==0,g||(rc(o,c,h,!1),g=(h&c.childLanes)!==0),b){if(g)return Lw(o,c,h);c.flags|=128}if(b=c.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),et(yr,yr.current),g)break;return null;case 22:case 23:return c.lanes=0,Tw(o,c,h);case 24:wa(c,Wn,o.memoizedState.cache)}return bo(o,c,h)}function Iw(o,c,h){if(o!==null)if(o.memoizedProps!==c.pendingProps)Ar=!0;else{if(!Kv(o,h)&&(c.flags&128)===0)return Ar=!1,mk(o,c,h);Ar=(o.flags&131072)!==0}else Ar=!1,an&&(c.flags&1048576)!==0&&i0(c,el,c.index);switch(c.lanes=0,c.tag){case 16:t:{o=c.pendingProps;var g=c.elementType,b=g._init;if(g=b(g._payload),c.type=g,typeof g=="function")ah(g)?(o=lc(g,o),c.tag=1,c=Ow(null,c,g,o,h)):(c.tag=0,c=$v(null,c,g,o,h));else{if(g!=null){if(b=g.$$typeof,b===C){c.tag=11,c=Ew(null,c,g,o,h);break t}else if(b===D){c.tag=14,c=Aw(null,c,g,o,h);break t}}throw c=L(g)||g,Error(r(306,c,""))}}return c;case 0:return $v(o,c,c.type,c.pendingProps,h);case 1:return g=c.type,b=lc(g,c.pendingProps),Ow(o,c,g,b,h);case 3:t:{if(z(c,c.stateNode.containerInfo),o===null)throw Error(r(387));g=c.pendingProps;var A=c.memoizedState;b=A.element,Gt(o,c),we(c,g,null,h);var U=c.memoizedState;if(g=U.cache,wa(c,Wn,g),g!==A.cache&&dh(c,[Wn],h,!0),Pe(),g=U.element,A.isDehydrated)if(A={element:g,isDehydrated:!1,cache:U.cache},c.updateQueue.baseState=A,c.memoizedState=A,c.flags&256){c=Rw(o,c,g,h);break t}else if(g!==b){b=pi(Error(r(424)),c),Ki(b),c=Rw(o,c,g,h);break t}else{switch(o=c.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(Nn=ra(o.firstChild),ar=c,an=!0,ya=null,Ss=!0,h=hw(c,null,g,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(nc(),g===b){c=bo(o,c,h);break t}Mr(o,c,g,h)}c=c.child}return c;case 26:return A0(o,c),o===null?(h=BE(c.type,null,c.pendingProps,null))?c.memoizedState=h:an||(h=c.type,o=c.pendingProps,g=U0(Nt.current).createElement(h),g[rr]=c,g[ir]=o,Fr(g,h,o),Et(g),c.stateNode=g):c.memoizedState=BE(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return J(c),o===null&&an&&(g=c.stateNode=ME(c.type,c.pendingProps,Nt.current),ar=c,Ss=!0,b=Nn,gl(c.type)?(R1=b,Nn=ra(g.firstChild)):Nn=b),Mr(o,c,c.pendingProps.children,h),A0(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&an&&((b=g=Nn)&&(g=$k(g,c.type,c.pendingProps,Ss),g!==null?(c.stateNode=g,ar=c,Nn=ra(g.firstChild),Ss=!1,b=!0):b=!1),b||Js(c)),J(c),b=c.type,A=c.pendingProps,U=o!==null?o.memoizedProps:null,g=A.children,T1(b,A)?g=null:U!==null&&T1(b,U)&&(c.flags|=32),c.memoizedState!==null&&(b=Fi(o,c,mn,null,null,h),Yh._currentValue=b),A0(o,c),Mr(o,c,g,h),c.child;case 6:return o===null&&an&&((o=h=Nn)&&(h=Gk(h,c.pendingProps,Ss),h!==null?(c.stateNode=h,ar=c,Nn=null,o=!0):o=!1),o||Js(c)),null;case 13:return Nw(o,c,h);case 4:return z(c,c.stateNode.containerInfo),g=c.pendingProps,o===null?c.child=wu(c,null,g,h):Mr(o,c,g,h),c.child;case 11:return Ew(o,c,c.type,c.pendingProps,h);case 7:return Mr(o,c,c.pendingProps,h),c.child;case 8:return Mr(o,c,c.pendingProps.children,h),c.child;case 12:return Mr(o,c,c.pendingProps.children,h),c.child;case 10:return g=c.pendingProps,wa(c,c.type,g.value),Mr(o,c,g.children,h),c.child;case 9:return b=c.type._context,g=c.pendingProps.children,po(c),b=gr(b),g=g(b),c.flags|=1,Mr(o,c,g,h),c.child;case 14:return Aw(o,c,c.type,c.pendingProps,h);case 15:return Sw(o,c,c.type,c.pendingProps,h);case 19:return Lw(o,c,h);case 31:return g=c.pendingProps,h=c.mode,g={mode:g.mode,children:g.children},o===null?(h=S0(g,h),h.ref=c.ref,c.child=h,h.return=c,c=h):(h=Ks(o.child,g),h.ref=c.ref,c.child=h,h.return=c,c=h),c;case 22:return Tw(o,c,h);case 24:return po(c),g=gr(Wn),o===null?(b=vh(),b===null&&(b=kn,A=sc(),b.pooledCache=A,A.refCount++,A!==null&&(b.pooledCacheLanes|=h),b=A),c.memoizedState={parent:g,cache:b},Dt(c),wa(c,Wn,b)):((o.lanes&h)!==0&&(Gt(o,c),we(c,null,null,h),Pe()),b=o.memoizedState,A=c.memoizedState,b.parent!==g?(b={parent:g,cache:g},c.memoizedState=b,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=b),wa(c,Wn,g)):(g=A.cache,wa(c,Wn,g),g!==b.cache&&dh(c,[Wn],h,!0))),Mr(o,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}function wo(o){o.flags|=4}function Mw(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!$E(c)){if(c=Cs.current,c!==null&&((tn&4194048)===tn?Ta!==null:(tn&62914560)!==tn&&(tn&536870912)===0||c!==Ta))throw E=_h,ac;o.flags|=8192}}function T0(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?Xa():536870912,o.lanes|=c,Tu|=c)}function Lh(o,c){if(!an)switch(o.tailMode){case"hidden":c=o.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Hn(o){var c=o.alternate!==null&&o.alternate.child===o.child,h=0,g=0;if(c)for(var b=o.child;b!==null;)h|=b.lanes|b.childLanes,g|=b.subtreeFlags&65011712,g|=b.flags&65011712,b.return=o,b=b.sibling;else for(b=o.child;b!==null;)h|=b.lanes|b.childLanes,g|=b.subtreeFlags,g|=b.flags,b.return=o,b=b.sibling;return o.subtreeFlags|=g,o.childLanes=h,c}function gk(o,c,h){var g=c.pendingProps;switch(ch(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(c),null;case 1:return Hn(c),null;case 3:return h=c.stateNode,g=null,o!==null&&(g=o.memoizedState.cache),c.memoizedState.cache!==g&&(c.flags|=2048),ea(Wn),lt(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(ec(c)?wo(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,nl())),Hn(c),null;case 26:return h=c.memoizedState,o===null?(wo(c),h!==null?(Hn(c),Mw(c,h)):(Hn(c),c.flags&=-16777217)):h?h!==o.memoizedState?(wo(c),Hn(c),Mw(c,h)):(Hn(c),c.flags&=-16777217):(o.memoizedProps!==g&&wo(c),Hn(c),c.flags&=-16777217),null;case 27:ot(c),h=Nt.current;var b=c.type;if(o!==null&&c.stateNode!=null)o.memoizedProps!==g&&wo(c);else{if(!g){if(c.stateNode===null)throw Error(r(166));return Hn(c),null}o=dt.current,ec(c)?uh(c):(o=ME(b,g,h),c.stateNode=o,wo(c))}return Hn(c),null;case 5:if(ot(c),h=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==g&&wo(c);else{if(!g){if(c.stateNode===null)throw Error(r(166));return Hn(c),null}if(o=dt.current,ec(c))uh(c);else{switch(b=U0(Nt.current),o){case 1:o=b.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:o=b.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":o=b.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":o=b.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":o=b.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof g.is=="string"?b.createElement("select",{is:g.is}):b.createElement("select"),g.multiple?o.multiple=!0:g.size&&(o.size=g.size);break;default:o=typeof g.is=="string"?b.createElement(h,{is:g.is}):b.createElement(h)}}o[rr]=c,o[ir]=g;t:for(b=c.child;b!==null;){if(b.tag===5||b.tag===6)o.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===c)break t;for(;b.sibling===null;){if(b.return===null||b.return===c)break t;b=b.return}b.sibling.return=b.return,b=b.sibling}c.stateNode=o;t:switch(Fr(o,h,g),h){case"button":case"input":case"select":case"textarea":o=!!g.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&wo(c)}}return Hn(c),c.flags&=-16777217,null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==g&&wo(c);else{if(typeof g!="string"&&c.stateNode===null)throw Error(r(166));if(o=Nt.current,ec(c)){if(o=c.stateNode,h=c.memoizedProps,g=null,b=ar,b!==null)switch(b.tag){case 27:case 5:g=b.memoizedProps}o[rr]=c,o=!!(o.nodeValue===h||g!==null&&g.suppressHydrationWarning===!0||DE(o.nodeValue,h)),o||Js(c)}else o=U0(o).createTextNode(g),o[rr]=c,c.stateNode=o}return Hn(c),null;case 13:if(g=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(b=ec(c),g!==null&&g.dehydrated!==null){if(o===null){if(!b)throw Error(r(318));if(b=c.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));b[rr]=c}else nc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Hn(c),b=!1}else b=nl(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=b),b=!0;if(!b)return c.flags&256?(yo(c),c):(yo(c),null)}if(yo(c),(c.flags&128)!==0)return c.lanes=h,c;if(h=g!==null,o=o!==null&&o.memoizedState!==null,h){g=c.child,b=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(b=g.alternate.memoizedState.cachePool.pool);var A=null;g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(A=g.memoizedState.cachePool.pool),A!==b&&(g.flags|=2048)}return h!==o&&h&&(c.child.flags|=8192),T0(c,c.updateQueue),Hn(c),null;case 4:return lt(),o===null&&b1(c.stateNode.containerInfo),Hn(c),null;case 10:return ea(c.type),Hn(c),null;case 19:if(j(yr),b=c.memoizedState,b===null)return Hn(c),null;if(g=(c.flags&128)!==0,A=b.rendering,A===null)if(g)Lh(b,!1);else{if(qn!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(A=b0(o),A!==null){for(c.flags|=128,Lh(b,!1),o=A.updateQueue,c.updateQueue=o,T0(c,o),c.subtreeFlags=0,o=h,h=c.child;h!==null;)r0(h,o),h=h.sibling;return et(yr,yr.current&1|2),c.child}o=o.sibling}b.tail!==null&&K()>O0&&(c.flags|=128,g=!0,Lh(b,!1),c.lanes=4194304)}else{if(!g)if(o=b0(A),o!==null){if(c.flags|=128,g=!0,o=o.updateQueue,c.updateQueue=o,T0(c,o),Lh(b,!0),b.tail===null&&b.tailMode==="hidden"&&!A.alternate&&!an)return Hn(c),null}else 2*K()-b.renderingStartTime>O0&&h!==536870912&&(c.flags|=128,g=!0,Lh(b,!1),c.lanes=4194304);b.isBackwards?(A.sibling=c.child,c.child=A):(o=b.last,o!==null?o.sibling=A:c.child=A,b.last=A)}return b.tail!==null?(c=b.tail,b.rendering=c,b.tail=c.sibling,b.renderingStartTime=K(),c.sibling=null,o=yr.current,et(yr,g?o&1|2:o&1),c):(Hn(c),null);case 22:case 23:return yo(c),Qe(),g=c.memoizedState!==null,o!==null?o.memoizedState!==null!==g&&(c.flags|=8192):g&&(c.flags|=8192),g?(h&536870912)!==0&&(c.flags&128)===0&&(Hn(c),c.subtreeFlags&6&&(c.flags|=8192)):Hn(c),h=c.updateQueue,h!==null&&T0(c,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==h&&(c.flags|=2048),o!==null&&j(vo),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),ea(Wn),Hn(c),null;case 25:return null;case 30:return null}throw Error(r(156,c.tag))}function vk(o,c){switch(ch(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return ea(Wn),lt(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return ot(c),null;case 13:if(yo(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(r(340));nc()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return j(yr),null;case 4:return lt(),null;case 10:return ea(c.type),null;case 22:case 23:return yo(c),Qe(),o!==null&&j(vo),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return ea(Wn),null;case 25:return null;default:return null}}function Pw(o,c){switch(ch(c),c.tag){case 3:ea(Wn),lt();break;case 26:case 27:case 5:ot(c);break;case 4:lt();break;case 13:yo(c);break;case 19:j(yr);break;case 10:ea(c.type);break;case 22:case 23:yo(c),Qe(),o!==null&&j(vo);break;case 24:ea(Wn)}}function Ih(o,c){try{var h=c.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var b=g.next;h=b;do{if((h.tag&o)===o){g=void 0;var A=h.create,U=h.inst;g=A(),U.destroy=g}h=h.next}while(h!==b)}}catch(Y){Dn(c,c.return,Y)}}function ll(o,c,h){try{var g=c.updateQueue,b=g!==null?g.lastEffect:null;if(b!==null){var A=b.next;g=A;do{if((g.tag&o)===o){var U=g.inst,Y=U.destroy;if(Y!==void 0){U.destroy=void 0,b=c;var mt=h,Ft=Y;try{Ft()}catch(Vt){Dn(b,mt,Vt)}}}g=g.next}while(g!==A)}}catch(Vt){Dn(c,c.return,Vt)}}function Fw(o){var c=o.updateQueue;if(c!==null){var h=o.stateNode;try{Ne(c,h)}catch(g){Dn(o,o.return,g)}}}function Bw(o,c,h){h.props=lc(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(g){Dn(o,c,g)}}function Mh(o,c){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var g=o.stateNode;break;case 30:g=o.stateNode;break;default:g=o.stateNode}typeof h=="function"?o.refCleanup=h(g):h.current=g}}catch(b){Dn(o,c,b)}}function Ca(o,c){var h=o.ref,g=o.refCleanup;if(h!==null)if(typeof g=="function")try{g()}catch(b){Dn(o,c,b)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(b){Dn(o,c,b)}else h.current=null}function Uw(o){var c=o.type,h=o.memoizedProps,g=o.stateNode;try{t:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&g.focus();break t;case"img":h.src?g.src=h.src:h.srcSet&&(g.srcset=h.srcSet)}}catch(b){Dn(o,o.return,b)}}function Zv(o,c,h){try{var g=o.stateNode;Bk(g,o.type,h,c),g[ir]=c}catch(b){Dn(o,o.return,b)}}function zw(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&gl(o.type)||o.tag===4}function Qv(o){t:for(;;){for(;o.sibling===null;){if(o.return===null||zw(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&gl(o.type)||o.flags&2||o.child===null||o.tag===4)continue t;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Jv(o,c,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,c):(c=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,c.appendChild(o),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=B0));else if(g!==4&&(g===27&&gl(o.type)&&(h=o.stateNode,c=null),o=o.child,o!==null))for(Jv(o,c,h),o=o.sibling;o!==null;)Jv(o,c,h),o=o.sibling}function C0(o,c,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?h.insertBefore(o,c):h.appendChild(o);else if(g!==4&&(g===27&&gl(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(C0(o,c,h),o=o.sibling;o!==null;)C0(o,c,h),o=o.sibling}function jw(o){var c=o.stateNode,h=o.memoizedProps;try{for(var g=o.type,b=c.attributes;b.length;)c.removeAttributeNode(b[0]);Fr(c,g,h),c[rr]=o,c[ir]=h}catch(A){Dn(o,o.return,A)}}var Eo=!1,Qn=!1,t1=!1,Hw=typeof WeakSet=="function"?WeakSet:Set,Sr=null;function _k(o,c){if(o=o.containerInfo,A1=V0,o=Kf(o),ou(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else t:{h=(h=o.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var b=g.anchorOffset,A=g.focusNode;g=g.focusOffset;try{h.nodeType,A.nodeType}catch{h=null;break t}var U=0,Y=-1,mt=-1,Ft=0,Vt=0,Kt=o,zt=null;e:for(;;){for(var jt;Kt!==h||b!==0&&Kt.nodeType!==3||(Y=U+b),Kt!==A||g!==0&&Kt.nodeType!==3||(mt=U+g),Kt.nodeType===3&&(U+=Kt.nodeValue.length),(jt=Kt.firstChild)!==null;)zt=Kt,Kt=jt;for(;;){if(Kt===o)break e;if(zt===h&&++Ft===b&&(Y=U),zt===A&&++Vt===g&&(mt=U),(jt=Kt.nextSibling)!==null)break;Kt=zt,zt=Kt.parentNode}Kt=jt}h=Y===-1||mt===-1?null:{start:Y,end:mt}}else h=null}h=h||{start:0,end:0}}else h=null;for(S1={focusedElem:o,selectionRange:h},V0=!1,Sr=c;Sr!==null;)if(c=Sr,o=c.child,(c.subtreeFlags&1024)!==0&&o!==null)o.return=c,Sr=o;else for(;Sr!==null;){switch(c=Sr,A=c.alternate,o=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&A!==null){o=void 0,h=c,b=A.memoizedProps,A=A.memoizedState,g=h.stateNode;try{var Me=lc(h.type,b,h.elementType===h.type);o=g.getSnapshotBeforeUpdate(Me,A),g.__reactInternalSnapshotBeforeUpdate=o}catch(Ce){Dn(h,h.return,Ce)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,h=o.nodeType,h===9)D1(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":D1(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(r(163))}if(o=c.sibling,o!==null){o.return=c.return,Sr=o;break}Sr=c.return}}function $w(o,c,h){var g=h.flags;switch(h.tag){case 0:case 11:case 15:cl(o,h),g&4&&Ih(5,h);break;case 1:if(cl(o,h),g&4)if(o=h.stateNode,c===null)try{o.componentDidMount()}catch(U){Dn(h,h.return,U)}else{var b=lc(h.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(b,c,o.__reactInternalSnapshotBeforeUpdate)}catch(U){Dn(h,h.return,U)}}g&64&&Fw(h),g&512&&Mh(h,h.return);break;case 3:if(cl(o,h),g&64&&(o=h.updateQueue,o!==null)){if(c=null,h.child!==null)switch(h.child.tag){case 27:case 5:c=h.child.stateNode;break;case 1:c=h.child.stateNode}try{Ne(o,c)}catch(U){Dn(h,h.return,U)}}break;case 27:c===null&&g&4&&jw(h);case 26:case 5:cl(o,h),c===null&&g&4&&Uw(h),g&512&&Mh(h,h.return);break;case 12:cl(o,h);break;case 13:cl(o,h),g&4&&Ww(o,h),g&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=Ck.bind(null,h),Vk(o,h))));break;case 22:if(g=h.memoizedState!==null||Eo,!g){c=c!==null&&c.memoizedState!==null||Qn,b=Eo;var A=Qn;Eo=g,(Qn=c)&&!A?ul(o,h,(h.subtreeFlags&8772)!==0):cl(o,h),Eo=b,Qn=A}break;case 30:break;default:cl(o,h)}}function Gw(o){var c=o.alternate;c!==null&&(o.alternate=null,Gw(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&st(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var Mn=null,Bi=!1;function Ao(o,c,h){for(h=h.child;h!==null;)Vw(o,c,h),h=h.sibling}function Vw(o,c,h){if(ae&&typeof ae.onCommitFiberUnmount=="function")try{ae.onCommitFiberUnmount(te,h)}catch{}switch(h.tag){case 26:Qn||Ca(h,c),Ao(o,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Qn||Ca(h,c);var g=Mn,b=Bi;gl(h.type)&&(Mn=h.stateNode,Bi=!1),Ao(o,c,h),Gh(h.stateNode),Mn=g,Bi=b;break;case 5:Qn||Ca(h,c);case 6:if(g=Mn,b=Bi,Mn=null,Ao(o,c,h),Mn=g,Bi=b,Mn!==null)if(Bi)try{(Mn.nodeType===9?Mn.body:Mn.nodeName==="HTML"?Mn.ownerDocument.body:Mn).removeChild(h.stateNode)}catch(A){Dn(h,c,A)}else try{Mn.removeChild(h.stateNode)}catch(A){Dn(h,c,A)}break;case 18:Mn!==null&&(Bi?(o=Mn,LE(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),Qh(o)):LE(Mn,h.stateNode));break;case 4:g=Mn,b=Bi,Mn=h.stateNode.containerInfo,Bi=!0,Ao(o,c,h),Mn=g,Bi=b;break;case 0:case 11:case 14:case 15:Qn||ll(2,h,c),Qn||ll(4,h,c),Ao(o,c,h);break;case 1:Qn||(Ca(h,c),g=h.stateNode,typeof g.componentWillUnmount=="function"&&Bw(h,c,g)),Ao(o,c,h);break;case 21:Ao(o,c,h);break;case 22:Qn=(g=Qn)||h.memoizedState!==null,Ao(o,c,h),Qn=g;break;default:Ao(o,c,h)}}function Ww(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Qh(o)}catch(h){Dn(c,c.return,h)}}function xk(o){switch(o.tag){case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new Hw),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new Hw),c;default:throw Error(r(435,o.tag))}}function e1(o,c){var h=xk(o);c.forEach(function(g){var b=Dk.bind(null,o,g);h.has(g)||(h.add(g),g.then(b,b))})}function Qi(o,c){var h=c.deletions;if(h!==null)for(var g=0;g<h.length;g++){var b=h[g],A=o,U=c,Y=U;t:for(;Y!==null;){switch(Y.tag){case 27:if(gl(Y.type)){Mn=Y.stateNode,Bi=!1;break t}break;case 5:Mn=Y.stateNode,Bi=!1;break t;case 3:case 4:Mn=Y.stateNode.containerInfo,Bi=!0;break t}Y=Y.return}if(Mn===null)throw Error(r(160));Vw(A,U,b),Mn=null,Bi=!1,A=b.alternate,A!==null&&(A.return=null),b.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)qw(c,o),c=c.sibling}var na=null;function qw(o,c){var h=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Qi(c,o),Ji(o),g&4&&(ll(3,o,o.return),Ih(3,o),ll(5,o,o.return));break;case 1:Qi(c,o),Ji(o),g&512&&(Qn||h===null||Ca(h,h.return)),g&64&&Eo&&(o=o.updateQueue,o!==null&&(g=o.callbacks,g!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?g:h.concat(g))));break;case 26:var b=na;if(Qi(c,o),Ji(o),g&512&&(Qn||h===null||Ca(h,h.return)),g&4){var A=h!==null?h.memoizedState:null;if(g=o.memoizedState,h===null)if(g===null)if(o.stateNode===null){t:{g=o.type,h=o.memoizedProps,b=b.ownerDocument||b;e:switch(g){case"title":A=b.getElementsByTagName("title")[0],(!A||A[tt]||A[rr]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=b.createElement(g),b.head.insertBefore(A,b.querySelector("head > title"))),Fr(A,g,h),A[rr]=o,Et(A),g=A;break t;case"link":var U=jE("link","href",b).get(g+(h.href||""));if(U){for(var Y=0;Y<U.length;Y++)if(A=U[Y],A.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&A.getAttribute("rel")===(h.rel==null?null:h.rel)&&A.getAttribute("title")===(h.title==null?null:h.title)&&A.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){U.splice(Y,1);break e}}A=b.createElement(g),Fr(A,g,h),b.head.appendChild(A);break;case"meta":if(U=jE("meta","content",b).get(g+(h.content||""))){for(Y=0;Y<U.length;Y++)if(A=U[Y],A.getAttribute("content")===(h.content==null?null:""+h.content)&&A.getAttribute("name")===(h.name==null?null:h.name)&&A.getAttribute("property")===(h.property==null?null:h.property)&&A.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&A.getAttribute("charset")===(h.charSet==null?null:h.charSet)){U.splice(Y,1);break e}}A=b.createElement(g),Fr(A,g,h),b.head.appendChild(A);break;default:throw Error(r(468,g))}A[rr]=o,Et(A),g=A}o.stateNode=g}else HE(b,o.type,o.stateNode);else o.stateNode=zE(b,g,o.memoizedProps);else A!==g?(A===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):A.count--,g===null?HE(b,o.type,o.stateNode):zE(b,g,o.memoizedProps)):g===null&&o.stateNode!==null&&Zv(o,o.memoizedProps,h.memoizedProps)}break;case 27:Qi(c,o),Ji(o),g&512&&(Qn||h===null||Ca(h,h.return)),h!==null&&g&4&&Zv(o,o.memoizedProps,h.memoizedProps);break;case 5:if(Qi(c,o),Ji(o),g&512&&(Qn||h===null||Ca(h,h.return)),o.flags&32){b=o.stateNode;try{Yi(b,"")}catch(jt){Dn(o,o.return,jt)}}g&4&&o.stateNode!=null&&(b=o.memoizedProps,Zv(o,b,h!==null?h.memoizedProps:b)),g&1024&&(t1=!0);break;case 6:if(Qi(c,o),Ji(o),g&4){if(o.stateNode===null)throw Error(r(162));g=o.memoizedProps,h=o.stateNode;try{h.nodeValue=g}catch(jt){Dn(o,o.return,jt)}}break;case 3:if(H0=null,b=na,na=z0(c.containerInfo),Qi(c,o),na=b,Ji(o),g&4&&h!==null&&h.memoizedState.isDehydrated)try{Qh(c.containerInfo)}catch(jt){Dn(o,o.return,jt)}t1&&(t1=!1,Yw(o));break;case 4:g=na,na=z0(o.stateNode.containerInfo),Qi(c,o),Ji(o),na=g;break;case 12:Qi(c,o),Ji(o);break;case 13:Qi(c,o),Ji(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(o1=K()),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,e1(o,g)));break;case 22:b=o.memoizedState!==null;var mt=h!==null&&h.memoizedState!==null,Ft=Eo,Vt=Qn;if(Eo=Ft||b,Qn=Vt||mt,Qi(c,o),Qn=Vt,Eo=Ft,Ji(o),g&8192)t:for(c=o.stateNode,c._visibility=b?c._visibility&-2:c._visibility|1,b&&(h===null||mt||Eo||Qn||cc(o)),h=null,c=o;;){if(c.tag===5||c.tag===26){if(h===null){mt=h=c;try{if(A=mt.stateNode,b)U=A.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{Y=mt.stateNode;var Kt=mt.memoizedProps.style,zt=Kt!=null&&Kt.hasOwnProperty("display")?Kt.display:null;Y.style.display=zt==null||typeof zt=="boolean"?"":(""+zt).trim()}}catch(jt){Dn(mt,mt.return,jt)}}}else if(c.tag===6){if(h===null){mt=c;try{mt.stateNode.nodeValue=b?"":mt.memoizedProps}catch(jt){Dn(mt,mt.return,jt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break t;for(;c.sibling===null;){if(c.return===null||c.return===o)break t;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}g&4&&(g=o.updateQueue,g!==null&&(h=g.retryQueue,h!==null&&(g.retryQueue=null,e1(o,h))));break;case 19:Qi(c,o),Ji(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,e1(o,g)));break;case 30:break;case 21:break;default:Qi(c,o),Ji(o)}}function Ji(o){var c=o.flags;if(c&2){try{for(var h,g=o.return;g!==null;){if(zw(g)){h=g;break}g=g.return}if(h==null)throw Error(r(160));switch(h.tag){case 27:var b=h.stateNode,A=Qv(o);C0(o,A,b);break;case 5:var U=h.stateNode;h.flags&32&&(Yi(U,""),h.flags&=-33);var Y=Qv(o);C0(o,Y,U);break;case 3:case 4:var mt=h.stateNode.containerInfo,Ft=Qv(o);Jv(o,Ft,mt);break;default:throw Error(r(161))}}catch(Vt){Dn(o,o.return,Vt)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function Yw(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;Yw(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function cl(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)$w(o,c.alternate,c),c=c.sibling}function cc(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:ll(4,c,c.return),cc(c);break;case 1:Ca(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&Bw(c,c.return,h),cc(c);break;case 27:Gh(c.stateNode);case 26:case 5:Ca(c,c.return),cc(c);break;case 22:c.memoizedState===null&&cc(c);break;case 30:cc(c);break;default:cc(c)}o=o.sibling}}function ul(o,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var g=c.alternate,b=o,A=c,U=A.flags;switch(A.tag){case 0:case 11:case 15:ul(b,A,h),Ih(4,A);break;case 1:if(ul(b,A,h),g=A,b=g.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Ft){Dn(g,g.return,Ft)}if(g=A,b=g.updateQueue,b!==null){var Y=g.stateNode;try{var mt=b.shared.hiddenCallbacks;if(mt!==null)for(b.shared.hiddenCallbacks=null,b=0;b<mt.length;b++)Fe(mt[b],Y)}catch(Ft){Dn(g,g.return,Ft)}}h&&U&64&&Fw(A),Mh(A,A.return);break;case 27:jw(A);case 26:case 5:ul(b,A,h),h&&g===null&&U&4&&Uw(A),Mh(A,A.return);break;case 12:ul(b,A,h);break;case 13:ul(b,A,h),h&&U&4&&Ww(b,A);break;case 22:A.memoizedState===null&&ul(b,A,h),Mh(A,A.return);break;case 30:break;default:ul(b,A,h)}c=c.sibling}}function n1(o,c){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&il(h))}function r1(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&il(o))}function Da(o,c,h,g){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)Xw(o,c,h,g),c=c.sibling}function Xw(o,c,h,g){var b=c.flags;switch(c.tag){case 0:case 11:case 15:Da(o,c,h,g),b&2048&&Ih(9,c);break;case 1:Da(o,c,h,g);break;case 3:Da(o,c,h,g),b&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&il(o)));break;case 12:if(b&2048){Da(o,c,h,g),o=c.stateNode;try{var A=c.memoizedProps,U=A.id,Y=A.onPostCommit;typeof Y=="function"&&Y(U,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(mt){Dn(c,c.return,mt)}}else Da(o,c,h,g);break;case 13:Da(o,c,h,g);break;case 23:break;case 22:A=c.stateNode,U=c.alternate,c.memoizedState!==null?A._visibility&2?Da(o,c,h,g):Ph(o,c):A._visibility&2?Da(o,c,h,g):(A._visibility|=2,Eu(o,c,h,g,(c.subtreeFlags&10256)!==0)),b&2048&&n1(U,c);break;case 24:Da(o,c,h,g),b&2048&&r1(c.alternate,c);break;default:Da(o,c,h,g)}}function Eu(o,c,h,g,b){for(b=b&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var A=o,U=c,Y=h,mt=g,Ft=U.flags;switch(U.tag){case 0:case 11:case 15:Eu(A,U,Y,mt,b),Ih(8,U);break;case 23:break;case 22:var Vt=U.stateNode;U.memoizedState!==null?Vt._visibility&2?Eu(A,U,Y,mt,b):Ph(A,U):(Vt._visibility|=2,Eu(A,U,Y,mt,b)),b&&Ft&2048&&n1(U.alternate,U);break;case 24:Eu(A,U,Y,mt,b),b&&Ft&2048&&r1(U.alternate,U);break;default:Eu(A,U,Y,mt,b)}c=c.sibling}}function Ph(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=o,g=c,b=g.flags;switch(g.tag){case 22:Ph(h,g),b&2048&&n1(g.alternate,g);break;case 24:Ph(h,g),b&2048&&r1(g.alternate,g);break;default:Ph(h,g)}c=c.sibling}}var Fh=8192;function Au(o){if(o.subtreeFlags&Fh)for(o=o.child;o!==null;)Kw(o),o=o.sibling}function Kw(o){switch(o.tag){case 26:Au(o),o.flags&Fh&&o.memoizedState!==null&&iL(na,o.memoizedState,o.memoizedProps);break;case 5:Au(o);break;case 3:case 4:var c=na;na=z0(o.stateNode.containerInfo),Au(o),na=c;break;case 22:o.memoizedState===null&&(c=o.alternate,c!==null&&c.memoizedState!==null?(c=Fh,Fh=16777216,Au(o),Fh=c):Au(o));break;default:Au(o)}}function Zw(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function Bh(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var g=c[h];Sr=g,Jw(g,o)}Zw(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Qw(o),o=o.sibling}function Qw(o){switch(o.tag){case 0:case 11:case 15:Bh(o),o.flags&2048&&ll(9,o,o.return);break;case 3:Bh(o);break;case 12:Bh(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,D0(o)):Bh(o);break;default:Bh(o)}}function D0(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var h=0;h<c.length;h++){var g=c[h];Sr=g,Jw(g,o)}Zw(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:ll(8,c,c.return),D0(c);break;case 22:h=c.stateNode,h._visibility&2&&(h._visibility&=-3,D0(c));break;default:D0(c)}o=o.sibling}}function Jw(o,c){for(;Sr!==null;){var h=Sr;switch(h.tag){case 0:case 11:case 15:ll(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var g=h.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:il(h.memoizedState.cache)}if(g=h.child,g!==null)g.return=h,Sr=g;else t:for(h=o;Sr!==null;){g=Sr;var b=g.sibling,A=g.return;if(Gw(g),g===h){Sr=null;break t}if(b!==null){b.return=A,Sr=b;break t}Sr=A}}}var yk={getCacheForType:function(o){var c=gr(Wn),h=c.data.get(o);return h===void 0&&(h=o(),c.data.set(o,h)),h}},bk=typeof WeakMap=="function"?WeakMap:Map,gn=0,kn=null,qe=null,tn=0,vn=0,ts=null,fl=!1,Su=!1,i1=!1,So=0,qn=0,hl=0,uc=0,s1=0,Ds=0,Tu=0,Uh=null,Ui=null,a1=!1,o1=0,O0=1/0,R0=null,dl=null,Pr=0,pl=null,Cu=null,Du=0,l1=0,c1=null,tE=null,zh=0,u1=null;function es(){if((gn&2)!==0&&tn!==0)return tn&-tn;if(Z.T!==null){var o=Ii;return o!==0?o:v1()}return Zc()}function eE(){Ds===0&&(Ds=(tn&536870912)===0||an?Vs():536870912);var o=Cs.current;return o!==null&&(o.flags|=32),Ds}function ns(o,c,h){(o===kn&&(vn===2||vn===9)||o.cancelPendingCommit!==null)&&(Ou(o,0),ml(o,tn,Ds,!1)),Er(o,h),((gn&2)===0||o!==kn)&&(o===kn&&((gn&2)===0&&(uc|=h),qn===4&&ml(o,tn,Ds,!1)),Oa(o))}function nE(o,c,h){if((gn&6)!==0)throw Error(r(327));var g=!h&&(c&124)===0&&(c&o.expiredLanes)===0||mr(o,c),b=g?Ak(o,c):d1(o,c,!0),A=g;do{if(b===0){Su&&!g&&ml(o,c,0,!1);break}else{if(h=o.current.alternate,A&&!wk(h)){b=d1(o,c,!1),A=!1;continue}if(b===2){if(A=c,o.errorRecoveryDisabledLanes&A)var U=0;else U=o.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){c=U;t:{var Y=o;b=Uh;var mt=Y.current.memoizedState.isDehydrated;if(mt&&(Ou(Y,U).flags|=256),U=d1(Y,U,!1),U!==2){if(i1&&!mt){Y.errorRecoveryDisabledLanes|=A,uc|=A,b=4;break t}A=Ui,Ui=b,A!==null&&(Ui===null?Ui=A:Ui.push.apply(Ui,A))}b=U}if(A=!1,b!==2)continue}}if(b===1){Ou(o,0),ml(o,c,0,!0);break}t:{switch(g=o,A=b,A){case 0:case 1:throw Error(r(345));case 4:if((c&4194048)!==c)break;case 6:ml(g,c,Ds,!fl);break t;case 2:Ui=null;break;case 3:case 5:break;default:throw Error(r(329))}if((c&62914560)===c&&(b=o1+300-K(),10<b)){if(ml(g,c,Ds,!fl),yn(g,0,!0)!==0)break t;g.timeoutHandle=NE(rE.bind(null,g,h,Ui,R0,a1,c,Ds,uc,Tu,fl,A,2,-0,0),b);break t}rE(g,h,Ui,R0,a1,c,Ds,uc,Tu,fl,A,0,-0,0)}}break}while(!0);Oa(o)}function rE(o,c,h,g,b,A,U,Y,mt,Ft,Vt,Kt,zt,jt){if(o.timeoutHandle=-1,Kt=c.subtreeFlags,(Kt&8192||(Kt&16785408)===16785408)&&(qh={stylesheets:null,count:0,unsuspend:rL},Kw(c),Kt=sL(),Kt!==null)){o.cancelPendingCommit=Kt(uE.bind(null,o,c,A,h,g,b,U,Y,mt,Vt,1,zt,jt)),ml(o,A,U,!Ft);return}uE(o,c,A,h,g,b,U,Y,mt)}function wk(o){for(var c=o;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var g=0;g<h.length;g++){var b=h[g],A=b.getSnapshot;b=b.value;try{if(!qr(A(),b))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ml(o,c,h,g){c&=~s1,c&=~uc,o.suspendedLanes|=c,o.pingedLanes&=~c,g&&(o.warmLanes|=c),g=o.expirationTimes;for(var b=c;0<b;){var A=31-Re(b),U=1<<A;g[A]=-1,b&=~U}h!==0&&zl(o,h,c)}function N0(){return(gn&6)===0?(jh(0),!1):!0}function f1(){if(qe!==null){if(vn===0)var o=qe.return;else o=qe,ta=ho=null,Ts(o),bu=null,Nh=0,o=qe;for(;o!==null;)Pw(o.alternate,o),o=o.return;qe=null}}function Ou(o,c){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,zk(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),f1(),kn=o,qe=h=Ks(o.current,null),tn=c,vn=0,ts=null,fl=!1,Su=mr(o,c),i1=!1,Tu=Ds=s1=uc=hl=qn=0,Ui=Uh=null,a1=!1,(c&8)!==0&&(c|=c&32);var g=o.entangledLanes;if(g!==0)for(o=o.entanglements,g&=c;0<g;){var b=31-Re(g),A=1<<b;c|=o[b],g&=~A}return So=c,lu(),h}function iE(o,c){ue=null,Z.H=_0,c===sl||c===_o?(c=k(),vn=3):c===ac?(c=k(),vn=4):vn=c===ww?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,ts=c,qe===null&&(qn=1,E0(o,pi(c,o.current)))}function sE(){var o=Z.H;return Z.H=_0,o===null?_0:o}function aE(){var o=Z.A;return Z.A=yk,o}function h1(){qn=4,fl||(tn&4194048)!==tn&&Cs.current!==null||(Su=!0),(hl&134217727)===0&&(uc&134217727)===0||kn===null||ml(kn,tn,Ds,!1)}function d1(o,c,h){var g=gn;gn|=2;var b=sE(),A=aE();(kn!==o||tn!==c)&&(R0=null,Ou(o,c)),c=!1;var U=qn;t:do try{if(vn!==0&&qe!==null){var Y=qe,mt=ts;switch(vn){case 8:f1(),U=6;break t;case 3:case 2:case 9:case 6:Cs.current===null&&(c=!0);var Ft=vn;if(vn=0,ts=null,Ru(o,Y,mt,Ft),h&&Su){U=0;break t}break;default:Ft=vn,vn=0,ts=null,Ru(o,Y,mt,Ft)}}Ek(),U=qn;break}catch(Vt){iE(o,Vt)}while(!0);return c&&o.shellSuspendCounter++,ta=ho=null,gn=g,Z.H=b,Z.A=A,qe===null&&(kn=null,tn=0,lu()),U}function Ek(){for(;qe!==null;)oE(qe)}function Ak(o,c){var h=gn;gn|=2;var g=sE(),b=aE();kn!==o||tn!==c?(R0=null,O0=K()+500,Ou(o,c)):Su=mr(o,c);t:do try{if(vn!==0&&qe!==null){c=qe;var A=ts;e:switch(vn){case 1:vn=0,ts=null,Ru(o,c,A,1);break;case 2:case 9:if(u0(A)){vn=0,ts=null,lE(c);break}c=function(){vn!==2&&vn!==9||kn!==o||(vn=7),Oa(o)},A.then(c,c);break t;case 3:vn=7;break t;case 4:vn=5;break t;case 7:u0(A)?(vn=0,ts=null,lE(c)):(vn=0,ts=null,Ru(o,c,A,7));break;case 5:var U=null;switch(qe.tag){case 26:U=qe.memoizedState;case 5:case 27:var Y=qe;if(!U||$E(U)){vn=0,ts=null;var mt=Y.sibling;if(mt!==null)qe=mt;else{var Ft=Y.return;Ft!==null?(qe=Ft,k0(Ft)):qe=null}break e}}vn=0,ts=null,Ru(o,c,A,5);break;case 6:vn=0,ts=null,Ru(o,c,A,6);break;case 8:f1(),qn=6;break t;default:throw Error(r(462))}}Sk();break}catch(Vt){iE(o,Vt)}while(!0);return ta=ho=null,Z.H=g,Z.A=b,gn=h,qe!==null?0:(kn=null,tn=0,lu(),qn)}function Sk(){for(;qe!==null&&!gt();)oE(qe)}function oE(o){var c=Iw(o.alternate,o,So);o.memoizedProps=o.pendingProps,c===null?k0(o):qe=c}function lE(o){var c=o,h=c.alternate;switch(c.tag){case 15:case 0:c=Dw(h,c,c.pendingProps,c.type,void 0,tn);break;case 11:c=Dw(h,c,c.pendingProps,c.type.render,c.ref,tn);break;case 5:Ts(c);default:Pw(h,c),c=qe=r0(c,So),c=Iw(h,c,So)}o.memoizedProps=o.pendingProps,c===null?k0(o):qe=c}function Ru(o,c,h,g){ta=ho=null,Ts(c),bu=null,Nh=0;var b=c.return;try{if(pk(o,b,c,h,tn)){qn=1,E0(o,pi(h,o.current)),qe=null;return}}catch(A){if(b!==null)throw qe=b,A;qn=1,E0(o,pi(h,o.current)),qe=null;return}c.flags&32768?(an||g===1?o=!0:Su||(tn&536870912)!==0?o=!1:(fl=o=!0,(g===2||g===9||g===3||g===6)&&(g=Cs.current,g!==null&&g.tag===13&&(g.flags|=16384))),cE(c,o)):k0(c)}function k0(o){var c=o;do{if((c.flags&32768)!==0){cE(c,fl);return}o=c.return;var h=gk(c.alternate,c,So);if(h!==null){qe=h;return}if(c=c.sibling,c!==null){qe=c;return}qe=c=o}while(c!==null);qn===0&&(qn=5)}function cE(o,c){do{var h=vk(o.alternate,o);if(h!==null){h.flags&=32767,qe=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(o=o.sibling,o!==null)){qe=o;return}qe=o=h}while(o!==null);qn=6,qe=null}function uE(o,c,h,g,b,A,U,Y,mt){o.cancelPendingCommit=null;do L0();while(Pr!==0);if((gn&6)!==0)throw Error(r(327));if(c!==null){if(c===o.current)throw Error(r(177));if(A=c.lanes|c.childLanes,A|=rh,Oi(o,h,A,U,Y,mt),o===kn&&(qe=kn=null,tn=0),Cu=c,pl=o,Du=h,l1=A,c1=b,tE=g,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,Ok(Ht,function(){return mE(),null})):(o.callbackNode=null,o.callbackPriority=0),g=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||g){g=Z.T,Z.T=null,b=q.p,q.p=2,U=gn,gn|=4;try{_k(o,c,h)}finally{gn=U,q.p=b,Z.T=g}}Pr=1,fE(),hE(),dE()}}function fE(){if(Pr===1){Pr=0;var o=pl,c=Cu,h=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||h){h=Z.T,Z.T=null;var g=q.p;q.p=2;var b=gn;gn|=4;try{qw(c,o);var A=S1,U=Kf(o.containerInfo),Y=A.focusedElem,mt=A.selectionRange;if(U!==Y&&Y&&Y.ownerDocument&&Zp(Y.ownerDocument.documentElement,Y)){if(mt!==null&&ou(Y)){var Ft=mt.start,Vt=mt.end;if(Vt===void 0&&(Vt=Ft),"selectionStart"in Y)Y.selectionStart=Ft,Y.selectionEnd=Math.min(Vt,Y.value.length);else{var Kt=Y.ownerDocument||document,zt=Kt&&Kt.defaultView||window;if(zt.getSelection){var jt=zt.getSelection(),Me=Y.textContent.length,Ce=Math.min(mt.start,Me),En=mt.end===void 0?Ce:Math.min(mt.end,Me);!jt.extend&&Ce>En&&(U=En,En=Ce,Ce=U);var Ot=Kp(Y,Ce),bt=Kp(Y,En);if(Ot&&bt&&(jt.rangeCount!==1||jt.anchorNode!==Ot.node||jt.anchorOffset!==Ot.offset||jt.focusNode!==bt.node||jt.focusOffset!==bt.offset)){var Mt=Kt.createRange();Mt.setStart(Ot.node,Ot.offset),jt.removeAllRanges(),Ce>En?(jt.addRange(Mt),jt.extend(bt.node,bt.offset)):(Mt.setEnd(bt.node,bt.offset),jt.addRange(Mt))}}}}for(Kt=[],jt=Y;jt=jt.parentNode;)jt.nodeType===1&&Kt.push({element:jt,left:jt.scrollLeft,top:jt.scrollTop});for(typeof Y.focus=="function"&&Y.focus(),Y=0;Y<Kt.length;Y++){var Yt=Kt[Y];Yt.element.scrollLeft=Yt.left,Yt.element.scrollTop=Yt.top}}V0=!!A1,S1=A1=null}finally{gn=b,q.p=g,Z.T=h}}o.current=c,Pr=2}}function hE(){if(Pr===2){Pr=0;var o=pl,c=Cu,h=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||h){h=Z.T,Z.T=null;var g=q.p;q.p=2;var b=gn;gn|=4;try{$w(o,c.alternate,c)}finally{gn=b,q.p=g,Z.T=h}}Pr=3}}function dE(){if(Pr===4||Pr===3){Pr=0,ut();var o=pl,c=Cu,h=Du,g=tE;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Pr=5:(Pr=0,Cu=pl=null,pE(o,o.pendingLanes));var b=o.pendingLanes;if(b===0&&(dl=null),Hl(h),c=c.stateNode,ae&&typeof ae.onCommitFiberRoot=="function")try{ae.onCommitFiberRoot(te,c,void 0,(c.current.flags&128)===128)}catch{}if(g!==null){c=Z.T,b=q.p,q.p=2,Z.T=null;try{for(var A=o.onRecoverableError,U=0;U<g.length;U++){var Y=g[U];A(Y.value,{componentStack:Y.stack})}}finally{Z.T=c,q.p=b}}(Du&3)!==0&&L0(),Oa(o),b=o.pendingLanes,(h&4194090)!==0&&(b&42)!==0?o===u1?zh++:(zh=0,u1=o):zh=0,jh(0)}}function pE(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,il(c)))}function L0(o){return fE(),hE(),dE(),mE()}function mE(){if(Pr!==5)return!1;var o=pl,c=l1;l1=0;var h=Hl(Du),g=Z.T,b=q.p;try{q.p=32>h?32:h,Z.T=null,h=c1,c1=null;var A=pl,U=Du;if(Pr=0,Cu=pl=null,Du=0,(gn&6)!==0)throw Error(r(331));var Y=gn;if(gn|=4,Qw(A.current),Xw(A,A.current,U,h),gn=Y,jh(0,!1),ae&&typeof ae.onPostCommitFiberRoot=="function")try{ae.onPostCommitFiberRoot(te,A)}catch{}return!0}finally{q.p=b,Z.T=g,pE(o,c)}}function gE(o,c,h){c=pi(h,c),c=Hv(o.stateNode,c,2),o=ie(o,c,2),o!==null&&(Er(o,2),Oa(o))}function Dn(o,c,h){if(o.tag===3)gE(o,o,h);else for(;c!==null;){if(c.tag===3){gE(c,o,h);break}else if(c.tag===1){var g=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(dl===null||!dl.has(g))){o=pi(h,o),h=yw(2),g=ie(c,h,2),g!==null&&(bw(h,g,c,o),Er(g,2),Oa(g));break}}c=c.return}}function p1(o,c,h){var g=o.pingCache;if(g===null){g=o.pingCache=new bk;var b=new Set;g.set(c,b)}else b=g.get(c),b===void 0&&(b=new Set,g.set(c,b));b.has(h)||(i1=!0,b.add(h),o=Tk.bind(null,o,c,h),c.then(o,o))}function Tk(o,c,h){var g=o.pingCache;g!==null&&g.delete(c),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,kn===o&&(tn&h)===h&&(qn===4||qn===3&&(tn&62914560)===tn&&300>K()-o1?(gn&2)===0&&Ou(o,0):s1|=h,Tu===tn&&(Tu=0)),Oa(o)}function vE(o,c){c===0&&(c=Xa()),o=Yr(o,c),o!==null&&(Er(o,c),Oa(o))}function Ck(o){var c=o.memoizedState,h=0;c!==null&&(h=c.retryLane),vE(o,h)}function Dk(o,c){var h=0;switch(o.tag){case 13:var g=o.stateNode,b=o.memoizedState;b!==null&&(h=b.retryLane);break;case 19:g=o.stateNode;break;case 22:g=o.stateNode._retryCache;break;default:throw Error(r(314))}g!==null&&g.delete(c),vE(o,h)}function Ok(o,c){return At(o,c)}var I0=null,Nu=null,m1=!1,M0=!1,g1=!1,fc=0;function Oa(o){o!==Nu&&o.next===null&&(Nu===null?I0=Nu=o:Nu=Nu.next=o),M0=!0,m1||(m1=!0,Nk())}function jh(o,c){if(!g1&&M0){g1=!0;do for(var h=!1,g=I0;g!==null;){if(o!==0){var b=g.pendingLanes;if(b===0)var A=0;else{var U=g.suspendedLanes,Y=g.pingedLanes;A=(1<<31-Re(42|o)+1)-1,A&=b&~(U&~Y),A=A&201326741?A&201326741|1:A?A|2:0}A!==0&&(h=!0,bE(g,A))}else A=tn,A=yn(g,g===kn?A:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(A&3)===0||mr(g,A)||(h=!0,bE(g,A));g=g.next}while(h);g1=!1}}function Rk(){_E()}function _E(){M0=m1=!1;var o=0;fc!==0&&(Uk()&&(o=fc),fc=0);for(var c=K(),h=null,g=I0;g!==null;){var b=g.next,A=xE(g,c);A===0?(g.next=null,h===null?I0=b:h.next=b,b===null&&(Nu=h)):(h=g,(o!==0||(A&3)!==0)&&(M0=!0)),g=b}jh(o)}function xE(o,c){for(var h=o.suspendedLanes,g=o.pingedLanes,b=o.expirationTimes,A=o.pendingLanes&-62914561;0<A;){var U=31-Re(A),Y=1<<U,mt=b[U];mt===-1?((Y&h)===0||(Y&g)!==0)&&(b[U]=_s(Y,c)):mt<=c&&(o.expiredLanes|=Y),A&=~Y}if(c=kn,h=tn,h=yn(o,o===c?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g=o.callbackNode,h===0||o===c&&(vn===2||vn===9)||o.cancelPendingCommit!==null)return g!==null&&g!==null&&O(g),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||mr(o,h)){if(c=h&-h,c===o.callbackPriority)return c;switch(g!==null&&O(g),Hl(h)){case 2:case 8:h=Bt;break;case 32:h=Ht;break;case 268435456:h=It;break;default:h=Ht}return g=yE.bind(null,o),h=At(h,g),o.callbackPriority=c,o.callbackNode=h,c}return g!==null&&g!==null&&O(g),o.callbackPriority=2,o.callbackNode=null,2}function yE(o,c){if(Pr!==0&&Pr!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(L0()&&o.callbackNode!==h)return null;var g=tn;return g=yn(o,o===kn?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g===0?null:(nE(o,g,c),xE(o,K()),o.callbackNode!=null&&o.callbackNode===h?yE.bind(null,o):null)}function bE(o,c){if(L0())return null;nE(o,c,!0)}function Nk(){jk(function(){(gn&6)!==0?At(pt,Rk):_E()})}function v1(){return fc===0&&(fc=Vs()),fc}function wE(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Jc(""+o)}function EE(o,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,o.id&&h.setAttribute("form",o.id),c.parentNode.insertBefore(h,c),o=new FormData(o),h.parentNode.removeChild(h),o}function kk(o,c,h,g,b){if(c==="submit"&&h&&h.stateNode===b){var A=wE((b[ir]||null).action),U=g.submitter;U&&(c=(c=U[ir]||null)?wE(c.formAction):U.getAttribute("formAction"),c!==null&&(A=c,U=null));var Y=new Vo("action","action",null,g,b);o.push({event:Y,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(fc!==0){var mt=U?EE(b,U):new FormData(b);Fv(h,{pending:!0,data:mt,method:b.method,action:A},null,mt)}}else typeof A=="function"&&(Y.preventDefault(),mt=U?EE(b,U):new FormData(b),Fv(h,{pending:!0,data:mt,method:b.method,action:A},A,mt))},currentTarget:b}]})}}for(var _1=0;_1<nh.length;_1++){var x1=nh[_1],Lk=x1.toLowerCase(),Ik=x1[0].toUpperCase()+x1.slice(1);Xi(Lk,"on"+Ik)}Xi(_a,"onAnimationEnd"),Xi(As,"onAnimationIteration"),Xi(Jf,"onAnimationStart"),Xi("dblclick","onDoubleClick"),Xi("focusin","onFocus"),Xi("focusout","onBlur"),Xi(Nv,"onTransitionRun"),Xi(t0,"onTransitionStart"),Xi(e0,"onTransitionCancel"),Xi(th,"onTransitionEnd"),ee("onMouseEnter",["mouseout","mouseover"]),ee("onMouseLeave",["mouseout","mouseover"]),ee("onPointerEnter",["pointerout","pointerover"]),ee("onPointerLeave",["pointerout","pointerover"]),Wt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Hh));function AE(o,c){c=(c&4)!==0;for(var h=0;h<o.length;h++){var g=o[h],b=g.event;g=g.listeners;t:{var A=void 0;if(c)for(var U=g.length-1;0<=U;U--){var Y=g[U],mt=Y.instance,Ft=Y.currentTarget;if(Y=Y.listener,mt!==A&&b.isPropagationStopped())break t;A=Y,b.currentTarget=Ft;try{A(b)}catch(Vt){w0(Vt)}b.currentTarget=null,A=mt}else for(U=0;U<g.length;U++){if(Y=g[U],mt=Y.instance,Ft=Y.currentTarget,Y=Y.listener,mt!==A&&b.isPropagationStopped())break t;A=Y,b.currentTarget=Ft;try{A(b)}catch(Vt){w0(Vt)}b.currentTarget=null,A=mt}}}}function Ye(o,c){var h=c[$l];h===void 0&&(h=c[$l]=new Set);var g=o+"__bubble";h.has(g)||(SE(c,o,2,!1),h.add(g))}function y1(o,c,h){var g=0;c&&(g|=4),SE(h,o,g,c)}var P0="_reactListening"+Math.random().toString(36).slice(2);function b1(o){if(!o[P0]){o[P0]=!0,kt.forEach(function(h){h!=="selectionchange"&&(Mk.has(h)||y1(h,!1,o),y1(h,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[P0]||(c[P0]=!0,y1("selectionchange",!1,c))}}function SE(o,c,h,g){switch(XE(c)){case 2:var b=lL;break;case 8:b=cL;break;default:b=M1}h=b.bind(null,c,h,o),b=void 0,!ma||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(b=!0),g?b!==void 0?o.addEventListener(c,h,{capture:!0,passive:b}):o.addEventListener(c,h,!0):b!==void 0?o.addEventListener(c,h,{passive:b}):o.addEventListener(c,h,!1)}function w1(o,c,h,g,b){var A=g;if((c&1)===0&&(c&2)===0&&g!==null)t:for(;;){if(g===null)return;var U=g.tag;if(U===3||U===4){var Y=g.stateNode.containerInfo;if(Y===b)break;if(U===4)for(U=g.return;U!==null;){var mt=U.tag;if((mt===3||mt===4)&&U.stateNode.containerInfo===b)return;U=U.return}for(;Y!==null;){if(U=ct(Y),U===null)return;if(mt=U.tag,mt===5||mt===6||mt===26||mt===27){g=A=U;continue t}Y=Y.parentNode}}g=g.return}jf(function(){var Ft=A,Vt=$o(h),Kt=[];t:{var zt=eh.get(o);if(zt!==void 0){var jt=Vo,Me=o;switch(o){case"keypress":if(nu(h)===0)break t;case"keydown":case"keyup":jt=Lp;break;case"focusin":Me="focus",jt=ru;break;case"focusout":Me="blur",jt=ru;break;case"beforeblur":case"afterblur":jt=ru;break;case"click":if(h.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":jt=ro;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":jt=Sp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":jt=bv;break;case _a:case As:case Jf:jt=Dp;break;case th:jt=wv;break;case"scroll":case"scrollend":jt=Ap;break;case"wheel":jt=Av;break;case"copy":case"cut":case"paste":jt=Op;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":jt=ga;break;case"toggle":case"beforetoggle":jt=Pp}var Ce=(c&4)!==0,En=!Ce&&(o==="scroll"||o==="scrollend"),Ot=Ce?zt!==null?zt+"Capture":null:zt;Ce=[];for(var bt=Ft,Mt;bt!==null;){var Yt=bt;if(Mt=Yt.stateNode,Yt=Yt.tag,Yt!==5&&Yt!==26&&Yt!==27||Mt===null||Ot===null||(Yt=Go(bt,Ot),Yt!=null&&Ce.push($h(bt,Yt,Mt))),En)break;bt=bt.return}0<Ce.length&&(zt=new jt(zt,Me,null,h,Vt),Kt.push({event:zt,listeners:Ce}))}}if((c&7)===0){t:{if(zt=o==="mouseover"||o==="pointerover",jt=o==="mouseout"||o==="pointerout",zt&&h!==ys&&(Me=h.relatedTarget||h.fromElement)&&(ct(Me)||Me[ha]))break t;if((jt||zt)&&(zt=Vt.window===Vt?Vt:(zt=Vt.ownerDocument)?zt.defaultView||zt.parentWindow:window,jt?(Me=h.relatedTarget||h.toElement,jt=Ft,Me=Me?ct(Me):null,Me!==null&&(En=s(Me),Ce=Me.tag,Me!==En||Ce!==5&&Ce!==27&&Ce!==6)&&(Me=null)):(jt=null,Me=Ft),jt!==Me)){if(Ce=ro,Yt="onMouseLeave",Ot="onMouseEnter",bt="mouse",(o==="pointerout"||o==="pointerover")&&(Ce=ga,Yt="onPointerLeave",Ot="onPointerEnter",bt="pointer"),En=jt==null?zt:Pt(jt),Mt=Me==null?zt:Pt(Me),zt=new Ce(Yt,bt+"leave",jt,h,Vt),zt.target=En,zt.relatedTarget=Mt,Yt=null,ct(Vt)===Ft&&(Ce=new Ce(Ot,bt+"enter",Me,h,Vt),Ce.target=Mt,Ce.relatedTarget=En,Yt=Ce),En=Yt,jt&&Me)e:{for(Ce=jt,Ot=Me,bt=0,Mt=Ce;Mt;Mt=ku(Mt))bt++;for(Mt=0,Yt=Ot;Yt;Yt=ku(Yt))Mt++;for(;0<bt-Mt;)Ce=ku(Ce),bt--;for(;0<Mt-bt;)Ot=ku(Ot),Mt--;for(;bt--;){if(Ce===Ot||Ot!==null&&Ce===Ot.alternate)break e;Ce=ku(Ce),Ot=ku(Ot)}Ce=null}else Ce=null;jt!==null&&TE(Kt,zt,jt,Ce,!1),Me!==null&&En!==null&&TE(Kt,En,Me,Ce,!0)}}t:{if(zt=Ft?Pt(Ft):window,jt=zt.nodeName&&zt.nodeName.toLowerCase(),jt==="select"||jt==="input"&&zt.type==="file")var pe=Gp;else if(Hp(zt))if(qf)pe=Xp;else{pe=qp;var We=Ov}else jt=zt.nodeName,!jt||jt.toLowerCase()!=="input"||zt.type!=="checkbox"&&zt.type!=="radio"?Ft&&ql(Ft.elementType)&&(pe=Gp):pe=Yp;if(pe&&(pe=pe(o,Ft))){ki(Kt,pe,h,Vt);break t}We&&We(o,zt,Ft),o==="focusout"&&Ft&&zt.type==="number"&&Ft.memoizedProps.value!=null&&Vl(zt,"number",zt.value)}switch(We=Ft?Pt(Ft):window,o){case"focusin":(Hp(We)||We.contentEditable==="true")&&(Zo=We,Zf=Ft,Jl=null);break;case"focusout":Jl=Zf=Zo=null;break;case"mousedown":Qf=!0;break;case"contextmenu":case"mouseup":case"dragend":Qf=!1,Qp(Kt,h,Vt);break;case"selectionchange":if(Rv)break;case"keydown":case"keyup":Qp(Kt,h,Vt)}var _e;if(Wf)t:{switch(o){case"compositionstart":var De="onCompositionStart";break t;case"compositionend":De="onCompositionEnd";break t;case"compositionupdate":De="onCompositionUpdate";break t}De=void 0}else qo?zp(o,h)&&(De="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(De="onCompositionStart");De&&(Bp&&h.locale!=="ko"&&(qo||De!=="onCompositionStart"?De==="onCompositionEnd"&&qo&&(_e=eu()):(Ys=Vt,Xl="value"in Ys?Ys.value:Ys.textContent,qo=!0)),We=F0(Ft,De),0<We.length&&(De=new Rp(De,o,null,h,Vt),Kt.push({event:De,listeners:We}),_e?De.data=_e:(_e=jp(h),_e!==null&&(De.data=_e)))),(_e=io?Tv(o,h):Cv(o,h))&&(De=F0(Ft,"onBeforeInput"),0<De.length&&(We=new Rp("onBeforeInput","beforeinput",null,h,Vt),Kt.push({event:We,listeners:De}),We.data=_e)),kk(Kt,o,Ft,h,Vt)}AE(Kt,c)})}function $h(o,c,h){return{instance:o,listener:c,currentTarget:h}}function F0(o,c){for(var h=c+"Capture",g=[];o!==null;){var b=o,A=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||A===null||(b=Go(o,h),b!=null&&g.unshift($h(o,b,A)),b=Go(o,c),b!=null&&g.push($h(o,b,A))),o.tag===3)return g;o=o.return}return[]}function ku(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function TE(o,c,h,g,b){for(var A=c._reactName,U=[];h!==null&&h!==g;){var Y=h,mt=Y.alternate,Ft=Y.stateNode;if(Y=Y.tag,mt!==null&&mt===g)break;Y!==5&&Y!==26&&Y!==27||Ft===null||(mt=Ft,b?(Ft=Go(h,A),Ft!=null&&U.unshift($h(h,Ft,mt))):b||(Ft=Go(h,A),Ft!=null&&U.push($h(h,Ft,mt)))),h=h.return}U.length!==0&&o.push({event:c,listeners:U})}var Pk=/\r\n?/g,Fk=/\u0000|\uFFFD/g;function CE(o){return(typeof o=="string"?o:""+o).replace(Pk,`
`).replace(Fk,"")}function DE(o,c){return c=CE(c),CE(o)===c}function B0(){}function wn(o,c,h,g,b,A){switch(h){case"children":typeof g=="string"?c==="body"||c==="textarea"&&g===""||Yi(o,g):(typeof g=="number"||typeof g=="bigint")&&c!=="body"&&Yi(o,""+g);break;case"className":Ze(o,"class",g);break;case"tabIndex":Ze(o,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Ze(o,h,g);break;case"style":Ka(o,g,A);break;case"data":if(c!=="object"){Ze(o,"data",g);break}case"src":case"href":if(g===""&&(c!=="a"||h!=="href")){o.removeAttribute(h);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(h);break}g=Jc(""+g),o.setAttribute(h,g);break;case"action":case"formAction":if(typeof g=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(h==="formAction"?(c!=="input"&&wn(o,c,"name",b.name,b,null),wn(o,c,"formEncType",b.formEncType,b,null),wn(o,c,"formMethod",b.formMethod,b,null),wn(o,c,"formTarget",b.formTarget,b,null)):(wn(o,c,"encType",b.encType,b,null),wn(o,c,"method",b.method,b,null),wn(o,c,"target",b.target,b,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(h);break}g=Jc(""+g),o.setAttribute(h,g);break;case"onClick":g!=null&&(o.onclick=B0);break;case"onScroll":g!=null&&Ye("scroll",o);break;case"onScrollEnd":g!=null&&Ye("scrollend",o);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(h=g.__html,h!=null){if(b.children!=null)throw Error(r(60));o.innerHTML=h}}break;case"multiple":o.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":o.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){o.removeAttribute("xlink:href");break}h=Jc(""+g),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,""+g):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":g===!0?o.setAttribute(h,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,g):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?o.setAttribute(h,g):o.removeAttribute(h);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?o.removeAttribute(h):o.setAttribute(h,g);break;case"popover":Ye("beforetoggle",o),Ye("toggle",o),sn(o,"popover",g);break;case"xlinkActuate":dn(o,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":dn(o,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":dn(o,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":dn(o,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":dn(o,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":dn(o,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":dn(o,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":dn(o,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":dn(o,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":sn(o,"is",g);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=wp.get(h)||h,sn(o,h,g))}}function E1(o,c,h,g,b,A){switch(h){case"style":Ka(o,g,A);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(r(61));if(h=g.__html,h!=null){if(b.children!=null)throw Error(r(60));o.innerHTML=h}}break;case"children":typeof g=="string"?Yi(o,g):(typeof g=="number"||typeof g=="bigint")&&Yi(o,""+g);break;case"onScroll":g!=null&&Ye("scroll",o);break;case"onScrollEnd":g!=null&&Ye("scrollend",o);break;case"onClick":g!=null&&(o.onclick=B0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lt.hasOwnProperty(h))t:{if(h[0]==="o"&&h[1]==="n"&&(b=h.endsWith("Capture"),c=h.slice(2,b?h.length-7:void 0),A=o[ir]||null,A=A!=null?A[h]:null,typeof A=="function"&&o.removeEventListener(c,A,b),typeof g=="function")){typeof A!="function"&&A!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(c,g,b);break t}h in o?o[h]=g:g===!0?o.setAttribute(h,""):sn(o,h,g)}}}function Fr(o,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ye("error",o),Ye("load",o);var g=!1,b=!1,A;for(A in h)if(h.hasOwnProperty(A)){var U=h[A];if(U!=null)switch(A){case"src":g=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:wn(o,c,A,U,h,null)}}b&&wn(o,c,"srcSet",h.srcSet,h,null),g&&wn(o,c,"src",h.src,h,null);return;case"input":Ye("invalid",o);var Y=A=U=b=null,mt=null,Ft=null;for(g in h)if(h.hasOwnProperty(g)){var Vt=h[g];if(Vt!=null)switch(g){case"name":b=Vt;break;case"type":U=Vt;break;case"checked":mt=Vt;break;case"defaultChecked":Ft=Vt;break;case"value":A=Vt;break;case"defaultValue":Y=Vt;break;case"children":case"dangerouslySetInnerHTML":if(Vt!=null)throw Error(r(137,c));break;default:wn(o,c,g,Vt,h,null)}}Qc(o,A,Y,mt,Ft,U,b,!1),Gl(o);return;case"select":Ye("invalid",o),g=U=A=null;for(b in h)if(h.hasOwnProperty(b)&&(Y=h[b],Y!=null))switch(b){case"value":A=Y;break;case"defaultValue":U=Y;break;case"multiple":g=Y;default:wn(o,c,b,Y,h,null)}c=A,h=U,o.multiple=!!g,c!=null?kr(o,!!g,c,!1):h!=null&&kr(o,!!g,h,!0);return;case"textarea":Ye("invalid",o),A=b=g=null;for(U in h)if(h.hasOwnProperty(U)&&(Y=h[U],Y!=null))switch(U){case"value":g=Y;break;case"defaultValue":b=Y;break;case"children":A=Y;break;case"dangerouslySetInnerHTML":if(Y!=null)throw Error(r(91));break;default:wn(o,c,U,Y,h,null)}Wl(o,g,b,A),Gl(o);return;case"option":for(mt in h)if(h.hasOwnProperty(mt)&&(g=h[mt],g!=null))switch(mt){case"selected":o.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:wn(o,c,mt,g,h,null)}return;case"dialog":Ye("beforetoggle",o),Ye("toggle",o),Ye("cancel",o),Ye("close",o);break;case"iframe":case"object":Ye("load",o);break;case"video":case"audio":for(g=0;g<Hh.length;g++)Ye(Hh[g],o);break;case"image":Ye("error",o),Ye("load",o);break;case"details":Ye("toggle",o);break;case"embed":case"source":case"link":Ye("error",o),Ye("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ft in h)if(h.hasOwnProperty(Ft)&&(g=h[Ft],g!=null))switch(Ft){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:wn(o,c,Ft,g,h,null)}return;default:if(ql(c)){for(Vt in h)h.hasOwnProperty(Vt)&&(g=h[Vt],g!==void 0&&E1(o,c,Vt,g,h,void 0));return}}for(Y in h)h.hasOwnProperty(Y)&&(g=h[Y],g!=null&&wn(o,c,Y,g,h,null))}function Bk(o,c,h,g){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,A=null,U=null,Y=null,mt=null,Ft=null,Vt=null;for(jt in h){var Kt=h[jt];if(h.hasOwnProperty(jt)&&Kt!=null)switch(jt){case"checked":break;case"value":break;case"defaultValue":mt=Kt;default:g.hasOwnProperty(jt)||wn(o,c,jt,null,g,Kt)}}for(var zt in g){var jt=g[zt];if(Kt=h[zt],g.hasOwnProperty(zt)&&(jt!=null||Kt!=null))switch(zt){case"type":A=jt;break;case"name":b=jt;break;case"checked":Ft=jt;break;case"defaultChecked":Vt=jt;break;case"value":U=jt;break;case"defaultValue":Y=jt;break;case"children":case"dangerouslySetInnerHTML":if(jt!=null)throw Error(r(137,c));break;default:jt!==Kt&&wn(o,c,zt,jt,g,Kt)}}Wr(o,U,Y,mt,Ft,Vt,A,b);return;case"select":jt=U=Y=zt=null;for(A in h)if(mt=h[A],h.hasOwnProperty(A)&&mt!=null)switch(A){case"value":break;case"multiple":jt=mt;default:g.hasOwnProperty(A)||wn(o,c,A,null,g,mt)}for(b in g)if(A=g[b],mt=h[b],g.hasOwnProperty(b)&&(A!=null||mt!=null))switch(b){case"value":zt=A;break;case"defaultValue":Y=A;break;case"multiple":U=A;default:A!==mt&&wn(o,c,b,A,g,mt)}c=Y,h=U,g=jt,zt!=null?kr(o,!!h,zt,!1):!!g!=!!h&&(c!=null?kr(o,!!h,c,!0):kr(o,!!h,h?[]:"",!1));return;case"textarea":jt=zt=null;for(Y in h)if(b=h[Y],h.hasOwnProperty(Y)&&b!=null&&!g.hasOwnProperty(Y))switch(Y){case"value":break;case"children":break;default:wn(o,c,Y,null,g,b)}for(U in g)if(b=g[U],A=h[U],g.hasOwnProperty(U)&&(b!=null||A!=null))switch(U){case"value":zt=b;break;case"defaultValue":jt=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(r(91));break;default:b!==A&&wn(o,c,U,b,g,A)}pa(o,zt,jt);return;case"option":for(var Me in h)if(zt=h[Me],h.hasOwnProperty(Me)&&zt!=null&&!g.hasOwnProperty(Me))switch(Me){case"selected":o.selected=!1;break;default:wn(o,c,Me,null,g,zt)}for(mt in g)if(zt=g[mt],jt=h[mt],g.hasOwnProperty(mt)&&zt!==jt&&(zt!=null||jt!=null))switch(mt){case"selected":o.selected=zt&&typeof zt!="function"&&typeof zt!="symbol";break;default:wn(o,c,mt,zt,g,jt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in h)zt=h[Ce],h.hasOwnProperty(Ce)&&zt!=null&&!g.hasOwnProperty(Ce)&&wn(o,c,Ce,null,g,zt);for(Ft in g)if(zt=g[Ft],jt=h[Ft],g.hasOwnProperty(Ft)&&zt!==jt&&(zt!=null||jt!=null))switch(Ft){case"children":case"dangerouslySetInnerHTML":if(zt!=null)throw Error(r(137,c));break;default:wn(o,c,Ft,zt,g,jt)}return;default:if(ql(c)){for(var En in h)zt=h[En],h.hasOwnProperty(En)&&zt!==void 0&&!g.hasOwnProperty(En)&&E1(o,c,En,void 0,g,zt);for(Vt in g)zt=g[Vt],jt=h[Vt],!g.hasOwnProperty(Vt)||zt===jt||zt===void 0&&jt===void 0||E1(o,c,Vt,zt,g,jt);return}}for(var Ot in h)zt=h[Ot],h.hasOwnProperty(Ot)&&zt!=null&&!g.hasOwnProperty(Ot)&&wn(o,c,Ot,null,g,zt);for(Kt in g)zt=g[Kt],jt=h[Kt],!g.hasOwnProperty(Kt)||zt===jt||zt==null&&jt==null||wn(o,c,Kt,zt,g,jt)}var A1=null,S1=null;function U0(o){return o.nodeType===9?o:o.ownerDocument}function OE(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function RE(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function T1(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var C1=null;function Uk(){var o=window.event;return o&&o.type==="popstate"?o===C1?!1:(C1=o,!0):(C1=null,!1)}var NE=typeof setTimeout=="function"?setTimeout:void 0,zk=typeof clearTimeout=="function"?clearTimeout:void 0,kE=typeof Promise=="function"?Promise:void 0,jk=typeof queueMicrotask=="function"?queueMicrotask:typeof kE<"u"?function(o){return kE.resolve(null).then(o).catch(Hk)}:NE;function Hk(o){setTimeout(function(){throw o})}function gl(o){return o==="head"}function LE(o,c){var h=c,g=0,b=0;do{var A=h.nextSibling;if(o.removeChild(h),A&&A.nodeType===8)if(h=A.data,h==="/$"){if(0<g&&8>g){h=g;var U=o.ownerDocument;if(h&1&&Gh(U.documentElement),h&2&&Gh(U.body),h&4)for(h=U.head,Gh(h),U=h.firstChild;U;){var Y=U.nextSibling,mt=U.nodeName;U[tt]||mt==="SCRIPT"||mt==="STYLE"||mt==="LINK"&&U.rel.toLowerCase()==="stylesheet"||h.removeChild(U),U=Y}}if(b===0){o.removeChild(A),Qh(c);return}b--}else h==="$"||h==="$?"||h==="$!"?b++:g=h.charCodeAt(0)-48;else g=0;h=A}while(h);Qh(c)}function D1(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":D1(h),st(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function $k(o,c,h,g){for(;o.nodeType===1;){var b=h;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!g&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(g){if(!o[tt])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(A=o.getAttribute("rel"),A==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(A!==b.rel||o.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||o.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||o.getAttribute("title")!==(b.title==null?null:b.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(A=o.getAttribute("src"),(A!==(b.src==null?null:b.src)||o.getAttribute("type")!==(b.type==null?null:b.type)||o.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&A&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var A=b.name==null?null:""+b.name;if(b.type==="hidden"&&o.getAttribute("name")===A)return o}else return o;if(o=ra(o.nextSibling),o===null)break}return null}function Gk(o,c,h){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=ra(o.nextSibling),o===null))return null;return o}function O1(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function Vk(o,c){var h=o.ownerDocument;if(o.data!=="$?"||h.readyState==="complete")c();else{var g=function(){c(),h.removeEventListener("DOMContentLoaded",g)};h.addEventListener("DOMContentLoaded",g),o._reactRetry=g}}function ra(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return o}var R1=null;function IE(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return o;c--}else h==="/$"&&c++}o=o.previousSibling}return null}function ME(o,c,h){switch(c=U0(h),o){case"html":if(o=c.documentElement,!o)throw Error(r(452));return o;case"head":if(o=c.head,!o)throw Error(r(453));return o;case"body":if(o=c.body,!o)throw Error(r(454));return o;default:throw Error(r(451))}}function Gh(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);st(o)}var Os=new Map,PE=new Set;function z0(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var To=q.d;q.d={f:Wk,r:qk,D:Yk,C:Xk,L:Kk,m:Zk,X:Jk,S:Qk,M:tL};function Wk(){var o=To.f(),c=N0();return o||c}function qk(o){var c=ht(o);c!==null&&c.tag===5&&c.type==="form"?nw(c):To.r(o)}var Lu=typeof document>"u"?null:document;function FE(o,c,h){var g=Lu;if(g&&typeof c=="string"&&c){var b=sr(c);b='link[rel="'+o+'"][href="'+b+'"]',typeof h=="string"&&(b+='[crossorigin="'+h+'"]'),PE.has(b)||(PE.add(b),o={rel:o,crossOrigin:h,href:c},g.querySelector(b)===null&&(c=g.createElement("link"),Fr(c,"link",o),Et(c),g.head.appendChild(c)))}}function Yk(o){To.D(o),FE("dns-prefetch",o,null)}function Xk(o,c){To.C(o,c),FE("preconnect",o,c)}function Kk(o,c,h){To.L(o,c,h);var g=Lu;if(g&&o&&c){var b='link[rel="preload"][as="'+sr(c)+'"]';c==="image"&&h&&h.imageSrcSet?(b+='[imagesrcset="'+sr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(b+='[imagesizes="'+sr(h.imageSizes)+'"]')):b+='[href="'+sr(o)+'"]';var A=b;switch(c){case"style":A=Iu(o);break;case"script":A=Mu(o)}Os.has(A)||(o=d({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:o,as:c},h),Os.set(A,o),g.querySelector(b)!==null||c==="style"&&g.querySelector(Vh(A))||c==="script"&&g.querySelector(Wh(A))||(c=g.createElement("link"),Fr(c,"link",o),Et(c),g.head.appendChild(c)))}}function Zk(o,c){To.m(o,c);var h=Lu;if(h&&o){var g=c&&typeof c.as=="string"?c.as:"script",b='link[rel="modulepreload"][as="'+sr(g)+'"][href="'+sr(o)+'"]',A=b;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=Mu(o)}if(!Os.has(A)&&(o=d({rel:"modulepreload",href:o},c),Os.set(A,o),h.querySelector(b)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Wh(A)))return}g=h.createElement("link"),Fr(g,"link",o),Et(g),h.head.appendChild(g)}}}function Qk(o,c,h){To.S(o,c,h);var g=Lu;if(g&&o){var b=$t(g).hoistableStyles,A=Iu(o);c=c||"default";var U=b.get(A);if(!U){var Y={loading:0,preload:null};if(U=g.querySelector(Vh(A)))Y.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":c},h),(h=Os.get(A))&&N1(o,h);var mt=U=g.createElement("link");Et(mt),Fr(mt,"link",o),mt._p=new Promise(function(Ft,Vt){mt.onload=Ft,mt.onerror=Vt}),mt.addEventListener("load",function(){Y.loading|=1}),mt.addEventListener("error",function(){Y.loading|=2}),Y.loading|=4,j0(U,c,g)}U={type:"stylesheet",instance:U,count:1,state:Y},b.set(A,U)}}}function Jk(o,c){To.X(o,c);var h=Lu;if(h&&o){var g=$t(h).hoistableScripts,b=Mu(o),A=g.get(b);A||(A=h.querySelector(Wh(b)),A||(o=d({src:o,async:!0},c),(c=Os.get(b))&&k1(o,c),A=h.createElement("script"),Et(A),Fr(A,"link",o),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},g.set(b,A))}}function tL(o,c){To.M(o,c);var h=Lu;if(h&&o){var g=$t(h).hoistableScripts,b=Mu(o),A=g.get(b);A||(A=h.querySelector(Wh(b)),A||(o=d({src:o,async:!0,type:"module"},c),(c=Os.get(b))&&k1(o,c),A=h.createElement("script"),Et(A),Fr(A,"link",o),h.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},g.set(b,A))}}function BE(o,c,h,g){var b=(b=Nt.current)?z0(b):null;if(!b)throw Error(r(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=Iu(h.href),h=$t(b).hoistableStyles,g=h.get(c),g||(g={type:"style",instance:null,count:0,state:null},h.set(c,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=Iu(h.href);var A=$t(b).hoistableStyles,U=A.get(o);if(U||(b=b.ownerDocument||b,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(o,U),(A=b.querySelector(Vh(o)))&&!A._p&&(U.instance=A,U.state.loading=5),Os.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Os.set(o,h),A||eL(b,o,h,U.state))),c&&g===null)throw Error(r(528,""));return U}if(c&&g!==null)throw Error(r(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Mu(h),h=$t(b).hoistableScripts,g=h.get(c),g||(g={type:"script",instance:null,count:0,state:null},h.set(c,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,o))}}function Iu(o){return'href="'+sr(o)+'"'}function Vh(o){return'link[rel="stylesheet"]['+o+"]"}function UE(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function eL(o,c,h,g){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?g.loading=1:(c=o.createElement("link"),g.preload=c,c.addEventListener("load",function(){return g.loading|=1}),c.addEventListener("error",function(){return g.loading|=2}),Fr(c,"link",h),Et(c),o.head.appendChild(c))}function Mu(o){return'[src="'+sr(o)+'"]'}function Wh(o){return"script[async]"+o}function zE(o,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var g=o.querySelector('style[data-href~="'+sr(h.href)+'"]');if(g)return c.instance=g,Et(g),g;var b=d({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return g=(o.ownerDocument||o).createElement("style"),Et(g),Fr(g,"style",b),j0(g,h.precedence,o),c.instance=g;case"stylesheet":b=Iu(h.href);var A=o.querySelector(Vh(b));if(A)return c.state.loading|=4,c.instance=A,Et(A),A;g=UE(h),(b=Os.get(b))&&N1(g,b),A=(o.ownerDocument||o).createElement("link"),Et(A);var U=A;return U._p=new Promise(function(Y,mt){U.onload=Y,U.onerror=mt}),Fr(A,"link",g),c.state.loading|=4,j0(A,h.precedence,o),c.instance=A;case"script":return A=Mu(h.src),(b=o.querySelector(Wh(A)))?(c.instance=b,Et(b),b):(g=h,(b=Os.get(A))&&(g=d({},h),k1(g,b)),o=o.ownerDocument||o,b=o.createElement("script"),Et(b),Fr(b,"link",g),o.head.appendChild(b),c.instance=b);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(g=c.instance,c.state.loading|=4,j0(g,h.precedence,o));return c.instance}function j0(o,c,h){for(var g=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=g.length?g[g.length-1]:null,A=b,U=0;U<g.length;U++){var Y=g[U];if(Y.dataset.precedence===c)A=Y;else if(A!==b)break}A?A.parentNode.insertBefore(o,A.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(o,c.firstChild))}function N1(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function k1(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var H0=null;function jE(o,c,h){if(H0===null){var g=new Map,b=H0=new Map;b.set(h,g)}else b=H0,g=b.get(h),g||(g=new Map,b.set(h,g));if(g.has(o))return g;for(g.set(o,null),h=h.getElementsByTagName(o),b=0;b<h.length;b++){var A=h[b];if(!(A[tt]||A[rr]||o==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var U=A.getAttribute(c)||"";U=o+U;var Y=g.get(U);Y?Y.push(A):g.set(U,[A])}}return g}function HE(o,c,h){o=o.ownerDocument||o,o.head.insertBefore(h,c==="title"?o.querySelector("head > title"):null)}function nL(o,c,h){if(h===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return o=c.disabled,typeof c.precedence=="string"&&o==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function $E(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var qh=null;function rL(){}function iL(o,c,h){if(qh===null)throw Error(r(475));var g=qh;if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var b=Iu(h.href),A=o.querySelector(Vh(b));if(A){o=A._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(g.count++,g=$0.bind(g),o.then(g,g)),c.state.loading|=4,c.instance=A,Et(A);return}A=o.ownerDocument||o,h=UE(h),(b=Os.get(b))&&N1(h,b),A=A.createElement("link"),Et(A);var U=A;U._p=new Promise(function(Y,mt){U.onload=Y,U.onerror=mt}),Fr(A,"link",h),c.instance=A}g.stylesheets===null&&(g.stylesheets=new Map),g.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(g.count++,c=$0.bind(g),o.addEventListener("load",c),o.addEventListener("error",c))}}function sL(){if(qh===null)throw Error(r(475));var o=qh;return o.stylesheets&&o.count===0&&L1(o,o.stylesheets),0<o.count?function(c){var h=setTimeout(function(){if(o.stylesheets&&L1(o,o.stylesheets),o.unsuspend){var g=o.unsuspend;o.unsuspend=null,g()}},6e4);return o.unsuspend=c,function(){o.unsuspend=null,clearTimeout(h)}}:null}function $0(){if(this.count--,this.count===0){if(this.stylesheets)L1(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var G0=null;function L1(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,G0=new Map,c.forEach(aL,o),G0=null,$0.call(o))}function aL(o,c){if(!(c.state.loading&4)){var h=G0.get(o);if(h)var g=h.get(null);else{h=new Map,G0.set(o,h);for(var b=o.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<b.length;A++){var U=b[A];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(h.set(U.dataset.precedence,U),g=U)}g&&h.set(null,g)}b=c.instance,U=b.getAttribute("data-precedence"),A=h.get(U)||g,A===g&&h.set(null,b),h.set(U,b),this.count++,g=$0.bind(this),b.addEventListener("load",g),b.addEventListener("error",g),A?A.parentNode.insertBefore(b,A.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(b,o.firstChild)),c.state.loading|=4}}var Yh={$$typeof:T,Provider:null,Consumer:null,_currentValue:Ct,_currentValue2:Ct,_threadCount:0};function oL(o,c,h,g,b,A,U,Y){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ws(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ws(0),this.hiddenUpdates=Ws(null),this.identifierPrefix=g,this.onUncaughtError=b,this.onCaughtError=A,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Y,this.incompleteTransitions=new Map}function GE(o,c,h,g,b,A,U,Y,mt,Ft,Vt,Kt){return o=new oL(o,c,h,U,Y,mt,Ft,Kt),c=1,A===!0&&(c|=24),A=gi(3,null,null,c),o.current=A,A.stateNode=o,c=sc(),c.refCount++,o.pooledCache=c,c.refCount++,A.memoizedState={element:g,isDehydrated:h,cache:c},Dt(A),o}function VE(o){return o?(o=Jo,o):Jo}function WE(o,c,h,g,b,A){b=VE(b),g.context===null?g.context=b:g.pendingContext=b,g=qt(c),g.payload={element:h},A=A===void 0?null:A,A!==null&&(g.callback=A),h=ie(o,g,c),h!==null&&(ns(h,o,c),fe(h,o,c))}function qE(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<c?h:c}}function I1(o,c){qE(o,c),(o=o.alternate)&&qE(o,c)}function YE(o){if(o.tag===13){var c=Yr(o,67108864);c!==null&&ns(c,o,67108864),I1(o,67108864)}}var V0=!0;function lL(o,c,h,g){var b=Z.T;Z.T=null;var A=q.p;try{q.p=2,M1(o,c,h,g)}finally{q.p=A,Z.T=b}}function cL(o,c,h,g){var b=Z.T;Z.T=null;var A=q.p;try{q.p=8,M1(o,c,h,g)}finally{q.p=A,Z.T=b}}function M1(o,c,h,g){if(V0){var b=P1(g);if(b===null)w1(o,c,g,W0,h),KE(o,g);else if(fL(b,o,c,h,g))g.stopPropagation();else if(KE(o,g),c&4&&-1<uL.indexOf(o)){for(;b!==null;){var A=ht(b);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var U=Cn(A.pendingLanes);if(U!==0){var Y=A;for(Y.pendingLanes|=2,Y.entangledLanes|=2;U;){var mt=1<<31-Re(U);Y.entanglements[1]|=mt,U&=~mt}Oa(A),(gn&6)===0&&(O0=K()+500,jh(0))}}break;case 13:Y=Yr(A,2),Y!==null&&ns(Y,A,2),N0(),I1(A,2)}if(A=P1(g),A===null&&w1(o,c,g,W0,h),A===b)break;b=A}b!==null&&g.stopPropagation()}else w1(o,c,g,null,h)}}function P1(o){return o=$o(o),F1(o)}var W0=null;function F1(o){if(W0=null,o=ct(o),o!==null){var c=s(o);if(c===null)o=null;else{var h=c.tag;if(h===13){if(o=a(c),o!==null)return o;o=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return W0=o,null}function XE(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(X()){case pt:return 2;case Bt:return 8;case Ht:case St:return 32;case It:return 268435456;default:return 32}default:return 32}}var B1=!1,vl=null,_l=null,xl=null,Xh=new Map,Kh=new Map,yl=[],uL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function KE(o,c){switch(o){case"focusin":case"focusout":vl=null;break;case"dragenter":case"dragleave":_l=null;break;case"mouseover":case"mouseout":xl=null;break;case"pointerover":case"pointerout":Xh.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kh.delete(c.pointerId)}}function Zh(o,c,h,g,b,A){return o===null||o.nativeEvent!==A?(o={blockedOn:c,domEventName:h,eventSystemFlags:g,nativeEvent:A,targetContainers:[b]},c!==null&&(c=ht(c),c!==null&&YE(c)),o):(o.eventSystemFlags|=g,c=o.targetContainers,b!==null&&c.indexOf(b)===-1&&c.push(b),o)}function fL(o,c,h,g,b){switch(c){case"focusin":return vl=Zh(vl,o,c,h,g,b),!0;case"dragenter":return _l=Zh(_l,o,c,h,g,b),!0;case"mouseover":return xl=Zh(xl,o,c,h,g,b),!0;case"pointerover":var A=b.pointerId;return Xh.set(A,Zh(Xh.get(A)||null,o,c,h,g,b)),!0;case"gotpointercapture":return A=b.pointerId,Kh.set(A,Zh(Kh.get(A)||null,o,c,h,g,b)),!0}return!1}function ZE(o){var c=ct(o.target);if(c!==null){var h=s(c);if(h!==null){if(c=h.tag,c===13){if(c=a(h),c!==null){o.blockedOn=c,fa(o.priority,function(){if(h.tag===13){var g=es();g=jl(g);var b=Yr(h,g);b!==null&&ns(b,h,g),I1(h,g)}});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function q0(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var h=P1(o.nativeEvent);if(h===null){h=o.nativeEvent;var g=new h.constructor(h.type,h);ys=g,h.target.dispatchEvent(g),ys=null}else return c=ht(h),c!==null&&YE(c),o.blockedOn=h,!1;c.shift()}return!0}function QE(o,c,h){q0(o)&&h.delete(c)}function hL(){B1=!1,vl!==null&&q0(vl)&&(vl=null),_l!==null&&q0(_l)&&(_l=null),xl!==null&&q0(xl)&&(xl=null),Xh.forEach(QE),Kh.forEach(QE)}function Y0(o,c){o.blockedOn===c&&(o.blockedOn=null,B1||(B1=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,hL)))}var X0=null;function JE(o){X0!==o&&(X0=o,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){X0===o&&(X0=null);for(var c=0;c<o.length;c+=3){var h=o[c],g=o[c+1],b=o[c+2];if(typeof g!="function"){if(F1(g||h)===null)continue;break}var A=ht(h);A!==null&&(o.splice(c,3),c-=3,Fv(A,{pending:!0,data:b,method:h.method,action:g},g,b))}}))}function Qh(o){function c(mt){return Y0(mt,o)}vl!==null&&Y0(vl,o),_l!==null&&Y0(_l,o),xl!==null&&Y0(xl,o),Xh.forEach(c),Kh.forEach(c);for(var h=0;h<yl.length;h++){var g=yl[h];g.blockedOn===o&&(g.blockedOn=null)}for(;0<yl.length&&(h=yl[0],h.blockedOn===null);)ZE(h),h.blockedOn===null&&yl.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(g=0;g<h.length;g+=3){var b=h[g],A=h[g+1],U=b[ir]||null;if(typeof A=="function")U||JE(h);else if(U){var Y=null;if(A&&A.hasAttribute("formAction")){if(b=A,U=A[ir]||null)Y=U.formAction;else if(F1(b)!==null)continue}else Y=U.action;typeof Y=="function"?h[g+1]=Y:(h.splice(g,3),g-=3),JE(h)}}}function U1(o){this._internalRoot=o}K0.prototype.render=U1.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(r(409));var h=c.current,g=es();WE(h,g,o,c,null,null)},K0.prototype.unmount=U1.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;WE(o.current,2,null,o,null,null),N0(),c[ha]=null}};function K0(o){this._internalRoot=o}K0.prototype.unstable_scheduleHydration=function(o){if(o){var c=Zc();o={blockedOn:null,target:o,priority:c};for(var h=0;h<yl.length&&c!==0&&c<yl[h].priority;h++);yl.splice(h,0,o),h===0&&ZE(o)}};var tA=t.version;if(tA!=="19.1.0")throw Error(r(527,tA,"19.1.0"));q.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(r(188)):(o=Object.keys(o).join(","),Error(r(268,o)));return o=u(c),o=o!==null?f(o):null,o=o===null?null:o.stateNode,o};var dL={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Z0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Z0.isDisabled&&Z0.supportsFiber)try{te=Z0.inject(dL),ae=Z0}catch{}}return td.createRoot=function(o,c){if(!i(o))throw Error(r(299));var h=!1,g="",b=gw,A=vw,U=_w,Y=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(Y=c.unstable_transitionCallbacks)),c=GE(o,1,!1,null,null,h,g,b,A,U,Y,null),o[ha]=c.current,b1(o),new U1(c)},td.hydrateRoot=function(o,c,h){if(!i(o))throw Error(r(299));var g=!1,b="",A=gw,U=vw,Y=_w,mt=null,Ft=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(b=h.identifierPrefix),h.onUncaughtError!==void 0&&(A=h.onUncaughtError),h.onCaughtError!==void 0&&(U=h.onCaughtError),h.onRecoverableError!==void 0&&(Y=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(mt=h.unstable_transitionCallbacks),h.formState!==void 0&&(Ft=h.formState)),c=GE(o,1,!0,c,h??null,g,b,A,U,Y,mt,Ft),c.context=VE(null),h=c.current,g=es(),g=jl(g),b=qt(g),b.callback=null,ie(h,b,g),h=g,c.current.lanes=h,Er(c,h),Oa(c),o[ha]=c.current,b1(o),new K0(c)},td.version="19.1.0",td}var hA;function EL(){if(hA)return $1.exports;hA=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),$1.exports=wL(),$1.exports}var AL=EL(),Rm={exports:{}},Ti="top",ms="bottom",gs="right",Ci="left",Ig="auto",wf=[Ti,ms,gs,Ci],Cc="start",of="end",cC="clippingParents",sy="viewport",zu="popper",uC="reference",bx=wf.reduce(function(n,t){return n.concat([t+"-"+Cc,t+"-"+of])},[]),ay=[].concat(wf,[Ig]).reduce(function(n,t){return n.concat([t,t+"-"+Cc,t+"-"+of])},[]),fC="beforeRead",hC="read",dC="afterRead",pC="beforeMain",mC="main",gC="afterMain",vC="beforeWrite",_C="write",xC="afterWrite",yC=[fC,hC,dC,pC,mC,gC,vC,_C,xC];function Wa(n){return n?(n.nodeName||"").toLowerCase():null}function vs(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var t=n.ownerDocument;return t&&t.defaultView||window}return n}function Dc(n){var t=vs(n).Element;return n instanceof t||n instanceof Element}function Fs(n){var t=vs(n).HTMLElement;return n instanceof t||n instanceof HTMLElement}function oy(n){if(typeof ShadowRoot>"u")return!1;var t=vs(n).ShadowRoot;return n instanceof t||n instanceof ShadowRoot}function SL(n){var t=n.state;Object.keys(t.elements).forEach(function(e){var r=t.styles[e]||{},i=t.attributes[e]||{},s=t.elements[e];!Fs(s)||!Wa(s)||(Object.assign(s.style,r),Object.keys(i).forEach(function(a){var l=i[a];l===!1?s.removeAttribute(a):s.setAttribute(a,l===!0?"":l)}))})}function TL(n){var t=n.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(r){var i=t.elements[r],s=t.attributes[r]||{},a=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:e[r]),l=a.reduce(function(u,f){return u[f]="",u},{});!Fs(i)||!Wa(i)||(Object.assign(i.style,l),Object.keys(s).forEach(function(u){i.removeAttribute(u)}))})}}const ly={name:"applyStyles",enabled:!0,phase:"write",fn:SL,effect:TL,requires:["computeStyles"]};function Ga(n){return n.split("-")[0]}var Sc=Math.max,Xm=Math.min,lf=Math.round;function wx(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function bC(){return!/^((?!chrome|android).)*safari/i.test(wx())}function cf(n,t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var r=n.getBoundingClientRect(),i=1,s=1;t&&Fs(n)&&(i=n.offsetWidth>0&&lf(r.width)/n.offsetWidth||1,s=n.offsetHeight>0&&lf(r.height)/n.offsetHeight||1);var a=Dc(n)?vs(n):window,l=a.visualViewport,u=!bC()&&e,f=(r.left+(u&&l?l.offsetLeft:0))/i,d=(r.top+(u&&l?l.offsetTop:0))/s,p=r.width/i,m=r.height/s;return{width:p,height:m,top:d,right:f+p,bottom:d+m,left:f,x:f,y:d}}function cy(n){var t=cf(n),e=n.offsetWidth,r=n.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:n.offsetLeft,y:n.offsetTop,width:e,height:r}}function wC(n,t){var e=t.getRootNode&&t.getRootNode();if(n.contains(t))return!0;if(e&&oy(e)){var r=t;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Fo(n){return vs(n).getComputedStyle(n)}function CL(n){return["table","td","th"].indexOf(Wa(n))>=0}function Pl(n){return((Dc(n)?n.ownerDocument:n.document)||window.document).documentElement}function Mg(n){return Wa(n)==="html"?n:n.assignedSlot||n.parentNode||(oy(n)?n.host:null)||Pl(n)}function dA(n){return!Fs(n)||Fo(n).position==="fixed"?null:n.offsetParent}function DL(n){var t=/firefox/i.test(wx()),e=/Trident/i.test(wx());if(e&&Fs(n)){var r=Fo(n);if(r.position==="fixed")return null}var i=Mg(n);for(oy(i)&&(i=i.host);Fs(i)&&["html","body"].indexOf(Wa(i))<0;){var s=Fo(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function tp(n){for(var t=vs(n),e=dA(n);e&&CL(e)&&Fo(e).position==="static";)e=dA(e);return e&&(Wa(e)==="html"||Wa(e)==="body"&&Fo(e).position==="static")?t:e||DL(n)||t}function uy(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function yd(n,t,e){return Sc(n,Xm(t,e))}function OL(n,t,e){var r=yd(n,t,e);return r>e?e:r}function EC(){return{top:0,right:0,bottom:0,left:0}}function AC(n){return Object.assign({},EC(),n)}function SC(n,t){return t.reduce(function(e,r){return e[r]=n,e},{})}var RL=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,AC(typeof t!="number"?t:SC(t,wf))};function NL(n){var t,e=n.state,r=n.name,i=n.options,s=e.elements.arrow,a=e.modifiersData.popperOffsets,l=Ga(e.placement),u=uy(l),f=[Ci,gs].indexOf(l)>=0,d=f?"height":"width";if(!(!s||!a)){var p=RL(i.padding,e),m=cy(s),v=u==="y"?Ti:Ci,x=u==="y"?ms:gs,_=e.rects.reference[d]+e.rects.reference[u]-a[u]-e.rects.popper[d],y=a[u]-e.rects.reference[u],w=tp(s),S=w?u==="y"?w.clientHeight||0:w.clientWidth||0:0,T=_/2-y/2,C=p[v],R=S-m[d]-p[x],N=S/2-m[d]/2+T,D=yd(C,N,R),I=u;e.modifiersData[r]=(t={},t[I]=D,t.centerOffset=D-N,t)}}function kL(n){var t=n.state,e=n.options,r=e.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=t.elements.popper.querySelector(i),!i)||wC(t.elements.popper,i)&&(t.elements.arrow=i))}const TC={name:"arrow",enabled:!0,phase:"main",fn:NL,effect:kL,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function uf(n){return n.split("-")[1]}var LL={top:"auto",right:"auto",bottom:"auto",left:"auto"};function IL(n,t){var e=n.x,r=n.y,i=t.devicePixelRatio||1;return{x:lf(e*i)/i||0,y:lf(r*i)/i||0}}function pA(n){var t,e=n.popper,r=n.popperRect,i=n.placement,s=n.variation,a=n.offsets,l=n.position,u=n.gpuAcceleration,f=n.adaptive,d=n.roundOffsets,p=n.isFixed,m=a.x,v=m===void 0?0:m,x=a.y,_=x===void 0?0:x,y=typeof d=="function"?d({x:v,y:_}):{x:v,y:_};v=y.x,_=y.y;var w=a.hasOwnProperty("x"),S=a.hasOwnProperty("y"),T=Ci,C=Ti,R=window;if(f){var N=tp(e),D="clientHeight",I="clientWidth";if(N===vs(e)&&(N=Pl(e),Fo(N).position!=="static"&&l==="absolute"&&(D="scrollHeight",I="scrollWidth")),N=N,i===Ti||(i===Ci||i===gs)&&s===of){C=ms;var M=p&&N===R&&R.visualViewport?R.visualViewport.height:N[D];_-=M-r.height,_*=u?1:-1}if(i===Ci||(i===Ti||i===ms)&&s===of){T=gs;var B=p&&N===R&&R.visualViewport?R.visualViewport.width:N[I];v-=B-r.width,v*=u?1:-1}}var H=Object.assign({position:l},f&&LL),F=d===!0?IL({x:v,y:_},vs(e)):{x:v,y:_};if(v=F.x,_=F.y,u){var rt;return Object.assign({},H,(rt={},rt[C]=S?"0":"",rt[T]=w?"0":"",rt.transform=(R.devicePixelRatio||1)<=1?"translate("+v+"px, "+_+"px)":"translate3d("+v+"px, "+_+"px, 0)",rt))}return Object.assign({},H,(t={},t[C]=S?_+"px":"",t[T]=w?v+"px":"",t.transform="",t))}function ML(n){var t=n.state,e=n.options,r=e.gpuAcceleration,i=r===void 0?!0:r,s=e.adaptive,a=s===void 0?!0:s,l=e.roundOffsets,u=l===void 0?!0:l,f={placement:Ga(t.placement),variation:uf(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,pA(Object.assign({},f,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,pA(Object.assign({},f,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const fy={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ML,data:{}};var J0={passive:!0};function PL(n){var t=n.state,e=n.instance,r=n.options,i=r.scroll,s=i===void 0?!0:i,a=r.resize,l=a===void 0?!0:a,u=vs(t.elements.popper),f=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&f.forEach(function(d){d.addEventListener("scroll",e.update,J0)}),l&&u.addEventListener("resize",e.update,J0),function(){s&&f.forEach(function(d){d.removeEventListener("scroll",e.update,J0)}),l&&u.removeEventListener("resize",e.update,J0)}}const hy={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:PL,data:{}};var FL={left:"right",right:"left",bottom:"top",top:"bottom"};function Nm(n){return n.replace(/left|right|bottom|top/g,function(t){return FL[t]})}var BL={start:"end",end:"start"};function mA(n){return n.replace(/start|end/g,function(t){return BL[t]})}function dy(n){var t=vs(n),e=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:e,scrollTop:r}}function py(n){return cf(Pl(n)).left+dy(n).scrollLeft}function UL(n,t){var e=vs(n),r=Pl(n),i=e.visualViewport,s=r.clientWidth,a=r.clientHeight,l=0,u=0;if(i){s=i.width,a=i.height;var f=bC();(f||!f&&t==="fixed")&&(l=i.offsetLeft,u=i.offsetTop)}return{width:s,height:a,x:l+py(n),y:u}}function zL(n){var t,e=Pl(n),r=dy(n),i=(t=n.ownerDocument)==null?void 0:t.body,s=Sc(e.scrollWidth,e.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Sc(e.scrollHeight,e.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),l=-r.scrollLeft+py(n),u=-r.scrollTop;return Fo(i||e).direction==="rtl"&&(l+=Sc(e.clientWidth,i?i.clientWidth:0)-s),{width:s,height:a,x:l,y:u}}function my(n){var t=Fo(n),e=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(e+i+r)}function CC(n){return["html","body","#document"].indexOf(Wa(n))>=0?n.ownerDocument.body:Fs(n)&&my(n)?n:CC(Mg(n))}function bd(n,t){var e;t===void 0&&(t=[]);var r=CC(n),i=r===((e=n.ownerDocument)==null?void 0:e.body),s=vs(r),a=i?[s].concat(s.visualViewport||[],my(r)?r:[]):r,l=t.concat(a);return i?l:l.concat(bd(Mg(a)))}function Ex(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function jL(n,t){var e=cf(n,!1,t==="fixed");return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}function gA(n,t,e){return t===sy?Ex(UL(n,e)):Dc(t)?jL(t,e):Ex(zL(Pl(n)))}function HL(n){var t=bd(Mg(n)),e=["absolute","fixed"].indexOf(Fo(n).position)>=0,r=e&&Fs(n)?tp(n):n;return Dc(r)?t.filter(function(i){return Dc(i)&&wC(i,r)&&Wa(i)!=="body"}):[]}function $L(n,t,e,r){var i=t==="clippingParents"?HL(n):[].concat(t),s=[].concat(i,[e]),a=s[0],l=s.reduce(function(u,f){var d=gA(n,f,r);return u.top=Sc(d.top,u.top),u.right=Xm(d.right,u.right),u.bottom=Xm(d.bottom,u.bottom),u.left=Sc(d.left,u.left),u},gA(n,a,r));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function DC(n){var t=n.reference,e=n.element,r=n.placement,i=r?Ga(r):null,s=r?uf(r):null,a=t.x+t.width/2-e.width/2,l=t.y+t.height/2-e.height/2,u;switch(i){case Ti:u={x:a,y:t.y-e.height};break;case ms:u={x:a,y:t.y+t.height};break;case gs:u={x:t.x+t.width,y:l};break;case Ci:u={x:t.x-e.width,y:l};break;default:u={x:t.x,y:t.y}}var f=i?uy(i):null;if(f!=null){var d=f==="y"?"height":"width";switch(s){case Cc:u[f]=u[f]-(t[d]/2-e[d]/2);break;case of:u[f]=u[f]+(t[d]/2-e[d]/2);break}}return u}function ff(n,t){t===void 0&&(t={});var e=t,r=e.placement,i=r===void 0?n.placement:r,s=e.strategy,a=s===void 0?n.strategy:s,l=e.boundary,u=l===void 0?cC:l,f=e.rootBoundary,d=f===void 0?sy:f,p=e.elementContext,m=p===void 0?zu:p,v=e.altBoundary,x=v===void 0?!1:v,_=e.padding,y=_===void 0?0:_,w=AC(typeof y!="number"?y:SC(y,wf)),S=m===zu?uC:zu,T=n.rects.popper,C=n.elements[x?S:m],R=$L(Dc(C)?C:C.contextElement||Pl(n.elements.popper),u,d,a),N=cf(n.elements.reference),D=DC({reference:N,element:T,placement:i}),I=Ex(Object.assign({},T,D)),M=m===zu?I:N,B={top:R.top-M.top+w.top,bottom:M.bottom-R.bottom+w.bottom,left:R.left-M.left+w.left,right:M.right-R.right+w.right},H=n.modifiersData.offset;if(m===zu&&H){var F=H[i];Object.keys(B).forEach(function(rt){var L=[gs,ms].indexOf(rt)>=0?1:-1,it=[Ti,ms].indexOf(rt)>=0?"y":"x";B[rt]+=F[it]*L})}return B}function GL(n,t){t===void 0&&(t={});var e=t,r=e.placement,i=e.boundary,s=e.rootBoundary,a=e.padding,l=e.flipVariations,u=e.allowedAutoPlacements,f=u===void 0?ay:u,d=uf(r),p=d?l?bx:bx.filter(function(x){return uf(x)===d}):wf,m=p.filter(function(x){return f.indexOf(x)>=0});m.length===0&&(m=p);var v=m.reduce(function(x,_){return x[_]=ff(n,{placement:_,boundary:i,rootBoundary:s,padding:a})[Ga(_)],x},{});return Object.keys(v).sort(function(x,_){return v[x]-v[_]})}function VL(n){if(Ga(n)===Ig)return[];var t=Nm(n);return[mA(n),t,mA(t)]}function WL(n){var t=n.state,e=n.options,r=n.name;if(!t.modifiersData[r]._skip){for(var i=e.mainAxis,s=i===void 0?!0:i,a=e.altAxis,l=a===void 0?!0:a,u=e.fallbackPlacements,f=e.padding,d=e.boundary,p=e.rootBoundary,m=e.altBoundary,v=e.flipVariations,x=v===void 0?!0:v,_=e.allowedAutoPlacements,y=t.options.placement,w=Ga(y),S=w===y,T=u||(S||!x?[Nm(y)]:VL(y)),C=[y].concat(T).reduce(function(dt,xt){return dt.concat(Ga(xt)===Ig?GL(t,{placement:xt,boundary:d,rootBoundary:p,padding:f,flipVariations:x,allowedAutoPlacements:_}):xt)},[]),R=t.rects.reference,N=t.rects.popper,D=new Map,I=!0,M=C[0],B=0;B<C.length;B++){var H=C[B],F=Ga(H),rt=uf(H)===Cc,L=[Ti,ms].indexOf(F)>=0,it=L?"width":"height",Z=ff(t,{placement:H,boundary:d,rootBoundary:p,altBoundary:m,padding:f}),q=L?rt?gs:Ci:rt?ms:Ti;R[it]>N[it]&&(q=Nm(q));var Ct=Nm(q),at=[];if(s&&at.push(Z[F]<=0),l&&at.push(Z[q]<=0,Z[Ct]<=0),at.every(function(dt){return dt})){M=H,I=!1;break}D.set(H,at)}if(I)for(var P=x?3:1,V=function(xt){var Nt=C.find(function(Rt){var z=D.get(Rt);if(z)return z.slice(0,xt).every(function(lt){return lt})});if(Nt)return M=Nt,"break"},j=P;j>0;j--){var et=V(j);if(et==="break")break}t.placement!==M&&(t.modifiersData[r]._skip=!0,t.placement=M,t.reset=!0)}}const OC={name:"flip",enabled:!0,phase:"main",fn:WL,requiresIfExists:["offset"],data:{_skip:!1}};function vA(n,t,e){return e===void 0&&(e={x:0,y:0}),{top:n.top-t.height-e.y,right:n.right-t.width+e.x,bottom:n.bottom-t.height+e.y,left:n.left-t.width-e.x}}function _A(n){return[Ti,gs,ms,Ci].some(function(t){return n[t]>=0})}function qL(n){var t=n.state,e=n.name,r=t.rects.reference,i=t.rects.popper,s=t.modifiersData.preventOverflow,a=ff(t,{elementContext:"reference"}),l=ff(t,{altBoundary:!0}),u=vA(a,r),f=vA(l,i,s),d=_A(u),p=_A(f);t.modifiersData[e]={referenceClippingOffsets:u,popperEscapeOffsets:f,isReferenceHidden:d,hasPopperEscaped:p},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":p})}const RC={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:qL};function YL(n,t,e){var r=Ga(n),i=[Ci,Ti].indexOf(r)>=0?-1:1,s=typeof e=="function"?e(Object.assign({},t,{placement:n})):e,a=s[0],l=s[1];return a=a||0,l=(l||0)*i,[Ci,gs].indexOf(r)>=0?{x:l,y:a}:{x:a,y:l}}function XL(n){var t=n.state,e=n.options,r=n.name,i=e.offset,s=i===void 0?[0,0]:i,a=ay.reduce(function(d,p){return d[p]=YL(p,t.rects,s),d},{}),l=a[t.placement],u=l.x,f=l.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=f),t.modifiersData[r]=a}const NC={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:XL};function KL(n){var t=n.state,e=n.name;t.modifiersData[e]=DC({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const gy={name:"popperOffsets",enabled:!0,phase:"read",fn:KL,data:{}};function ZL(n){return n==="x"?"y":"x"}function QL(n){var t=n.state,e=n.options,r=n.name,i=e.mainAxis,s=i===void 0?!0:i,a=e.altAxis,l=a===void 0?!1:a,u=e.boundary,f=e.rootBoundary,d=e.altBoundary,p=e.padding,m=e.tether,v=m===void 0?!0:m,x=e.tetherOffset,_=x===void 0?0:x,y=ff(t,{boundary:u,rootBoundary:f,padding:p,altBoundary:d}),w=Ga(t.placement),S=uf(t.placement),T=!S,C=uy(w),R=ZL(C),N=t.modifiersData.popperOffsets,D=t.rects.reference,I=t.rects.popper,M=typeof _=="function"?_(Object.assign({},t.rects,{placement:t.placement})):_,B=typeof M=="number"?{mainAxis:M,altAxis:M}:Object.assign({mainAxis:0,altAxis:0},M),H=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,F={x:0,y:0};if(N){if(s){var rt,L=C==="y"?Ti:Ci,it=C==="y"?ms:gs,Z=C==="y"?"height":"width",q=N[C],Ct=q+y[L],at=q-y[it],P=v?-I[Z]/2:0,V=S===Cc?D[Z]:I[Z],j=S===Cc?-I[Z]:-D[Z],et=t.elements.arrow,dt=v&&et?cy(et):{width:0,height:0},xt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:EC(),Nt=xt[L],Rt=xt[it],z=yd(0,D[Z],dt[Z]),lt=T?D[Z]/2-P-z-Nt-B.mainAxis:V-z-Nt-B.mainAxis,J=T?-D[Z]/2+P+z+Rt+B.mainAxis:j+z+Rt+B.mainAxis,ot=t.elements.arrow&&tp(t.elements.arrow),yt=ot?C==="y"?ot.clientTop||0:ot.clientLeft||0:0,At=(rt=H?.[C])!=null?rt:0,O=q+lt-At-yt,gt=q+J-At,ut=yd(v?Xm(Ct,O):Ct,q,v?Sc(at,gt):at);N[C]=ut,F[C]=ut-q}if(l){var K,X=C==="x"?Ti:Ci,pt=C==="x"?ms:gs,Bt=N[R],Ht=R==="y"?"height":"width",St=Bt+y[X],It=Bt-y[pt],Tt=[Ti,Ci].indexOf(w)!==-1,vt=(K=H?.[R])!=null?K:0,te=Tt?St:Bt-D[Ht]-I[Ht]-vt+B.altAxis,ae=Tt?Bt+D[Ht]+I[Ht]-vt-B.altAxis:It,ne=v&&Tt?OL(te,Bt,ae):yd(v?te:St,Bt,v?ae:It);N[R]=ne,F[R]=ne-Bt}t.modifiersData[r]=F}}const kC={name:"preventOverflow",enabled:!0,phase:"main",fn:QL,requiresIfExists:["offset"]};function JL(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function t4(n){return n===vs(n)||!Fs(n)?dy(n):JL(n)}function e4(n){var t=n.getBoundingClientRect(),e=lf(t.width)/n.offsetWidth||1,r=lf(t.height)/n.offsetHeight||1;return e!==1||r!==1}function n4(n,t,e){e===void 0&&(e=!1);var r=Fs(t),i=Fs(t)&&e4(t),s=Pl(t),a=cf(n,i,e),l={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(r||!r&&!e)&&((Wa(t)!=="body"||my(s))&&(l=t4(t)),Fs(t)?(u=cf(t,!0),u.x+=t.clientLeft,u.y+=t.clientTop):s&&(u.x=py(s))),{x:a.left+l.scrollLeft-u.x,y:a.top+l.scrollTop-u.y,width:a.width,height:a.height}}function r4(n){var t=new Map,e=new Set,r=[];n.forEach(function(s){t.set(s.name,s)});function i(s){e.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(l){if(!e.has(l)){var u=t.get(l);u&&i(u)}}),r.push(s)}return n.forEach(function(s){e.has(s.name)||i(s)}),r}function i4(n){var t=r4(n);return yC.reduce(function(e,r){return e.concat(t.filter(function(i){return i.phase===r}))},[])}function s4(n){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(n())})})),t}}function a4(n){var t=n.reduce(function(e,r){var i=e[r.name];return e[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,e},{});return Object.keys(t).map(function(e){return t[e]})}var xA={placement:"bottom",modifiers:[],strategy:"absolute"};function yA(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Pg(n){n===void 0&&(n={});var t=n,e=t.defaultModifiers,r=e===void 0?[]:e,i=t.defaultOptions,s=i===void 0?xA:i;return function(l,u,f){f===void 0&&(f=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},xA,s),modifiersData:{},elements:{reference:l,popper:u},attributes:{},styles:{}},p=[],m=!1,v={state:d,setOptions:function(w){var S=typeof w=="function"?w(d.options):w;_(),d.options=Object.assign({},s,d.options,S),d.scrollParents={reference:Dc(l)?bd(l):l.contextElement?bd(l.contextElement):[],popper:bd(u)};var T=i4(a4([].concat(r,d.options.modifiers)));return d.orderedModifiers=T.filter(function(C){return C.enabled}),x(),v.update()},forceUpdate:function(){if(!m){var w=d.elements,S=w.reference,T=w.popper;if(yA(S,T)){d.rects={reference:n4(S,tp(T),d.options.strategy==="fixed"),popper:cy(T)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(B){return d.modifiersData[B.name]=Object.assign({},B.data)});for(var C=0;C<d.orderedModifiers.length;C++){if(d.reset===!0){d.reset=!1,C=-1;continue}var R=d.orderedModifiers[C],N=R.fn,D=R.options,I=D===void 0?{}:D,M=R.name;typeof N=="function"&&(d=N({state:d,options:I,name:M,instance:v})||d)}}}},update:s4(function(){return new Promise(function(y){v.forceUpdate(),y(d)})}),destroy:function(){_(),m=!0}};if(!yA(l,u))return v;v.setOptions(f).then(function(y){!m&&f.onFirstUpdate&&f.onFirstUpdate(y)});function x(){d.orderedModifiers.forEach(function(y){var w=y.name,S=y.options,T=S===void 0?{}:S,C=y.effect;if(typeof C=="function"){var R=C({state:d,name:w,instance:v,options:T}),N=function(){};p.push(R||N)}})}function _(){p.forEach(function(y){return y()}),p=[]}return v}}var o4=Pg(),l4=[hy,gy,fy,ly],c4=Pg({defaultModifiers:l4}),u4=[hy,gy,fy,ly,NC,OC,kC,TC,RC],vy=Pg({defaultModifiers:u4});const _y=Object.freeze(Object.defineProperty({__proto__:null,afterMain:gC,afterRead:dC,afterWrite:xC,applyStyles:ly,arrow:TC,auto:Ig,basePlacements:wf,beforeMain:pC,beforeRead:fC,beforeWrite:vC,bottom:ms,clippingParents:cC,computeStyles:fy,createPopper:vy,createPopperBase:o4,createPopperLite:c4,detectOverflow:ff,end:of,eventListeners:hy,flip:OC,hide:RC,left:Ci,main:mC,modifierPhases:yC,offset:NC,placements:ay,popper:zu,popperGenerator:Pg,popperOffsets:gy,preventOverflow:kC,read:hC,reference:uC,right:gs,start:Cc,top:Ti,variationPlacements:bx,viewport:sy,write:_C},Symbol.toStringTag,{value:"Module"})),LC=mL(_y);var km={exports:{}},Lm={exports:{}};/*!
  * Bootstrap data.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var f4=Lm.exports,bA;function h4(){return bA||(bA=1,function(n,t){(function(e,r){n.exports=r()})(f4,function(){const e=new Map;return{set(i,s,a){e.has(i)||e.set(i,new Map);const l=e.get(i);if(!l.has(s)&&l.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(l.keys())[0]}.`);return}l.set(s,a)},get(i,s){return e.has(i)&&e.get(i).get(s)||null},remove(i,s){if(!e.has(i))return;const a=e.get(i);a.delete(s),a.size===0&&e.delete(i)}}})}(Lm)),Lm.exports}var Im={exports:{}},hd={exports:{}};/*!
  * Bootstrap index.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var d4=hd.exports,wA;function zc(){return wA||(wA=1,function(n,t){(function(e,r){r(t)})(d4,function(e){const s="transitionend",a=B=>(B&&window.CSS&&window.CSS.escape&&(B=B.replace(/#([^\s"#']+)/g,(H,F)=>`#${CSS.escape(F)}`)),B),l=B=>B==null?`${B}`:Object.prototype.toString.call(B).match(/\s([a-z]+)/i)[1].toLowerCase(),u=B=>{do B+=Math.floor(Math.random()*1e6);while(document.getElementById(B));return B},f=B=>{if(!B)return 0;let{transitionDuration:H,transitionDelay:F}=window.getComputedStyle(B);const rt=Number.parseFloat(H),L=Number.parseFloat(F);return!rt&&!L?0:(H=H.split(",")[0],F=F.split(",")[0],(Number.parseFloat(H)+Number.parseFloat(F))*1e3)},d=B=>{B.dispatchEvent(new Event(s))},p=B=>!B||typeof B!="object"?!1:(typeof B.jquery<"u"&&(B=B[0]),typeof B.nodeType<"u"),m=B=>p(B)?B.jquery?B[0]:B:typeof B=="string"&&B.length>0?document.querySelector(a(B)):null,v=B=>{if(!p(B)||B.getClientRects().length===0)return!1;const H=getComputedStyle(B).getPropertyValue("visibility")==="visible",F=B.closest("details:not([open])");if(!F)return H;if(F!==B){const rt=B.closest("summary");if(rt&&rt.parentNode!==F||rt===null)return!1}return H},x=B=>!B||B.nodeType!==Node.ELEMENT_NODE||B.classList.contains("disabled")?!0:typeof B.disabled<"u"?B.disabled:B.hasAttribute("disabled")&&B.getAttribute("disabled")!=="false",_=B=>{if(!document.documentElement.attachShadow)return null;if(typeof B.getRootNode=="function"){const H=B.getRootNode();return H instanceof ShadowRoot?H:null}return B instanceof ShadowRoot?B:B.parentNode?_(B.parentNode):null},y=()=>{},w=B=>{B.offsetHeight},S=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,T=[],C=B=>{document.readyState==="loading"?(T.length||document.addEventListener("DOMContentLoaded",()=>{for(const H of T)H()}),T.push(B)):B()},R=()=>document.documentElement.dir==="rtl",N=B=>{C(()=>{const H=S();if(H){const F=B.NAME,rt=H.fn[F];H.fn[F]=B.jQueryInterface,H.fn[F].Constructor=B,H.fn[F].noConflict=()=>(H.fn[F]=rt,B.jQueryInterface)}})},D=(B,H=[],F=B)=>typeof B=="function"?B.call(...H):F,I=(B,H,F=!0)=>{if(!F){D(B);return}const L=f(H)+5;let it=!1;const Z=({target:q})=>{q===H&&(it=!0,H.removeEventListener(s,Z),D(B))};H.addEventListener(s,Z),setTimeout(()=>{it||d(H)},L)},M=(B,H,F,rt)=>{const L=B.length;let it=B.indexOf(H);return it===-1?!F&&rt?B[L-1]:B[0]:(it+=F?1:-1,rt&&(it=(it+L)%L),B[Math.max(0,Math.min(it,L-1))])};e.defineJQueryPlugin=N,e.execute=D,e.executeAfterTransition=I,e.findShadowRoot=_,e.getElement=m,e.getNextActiveElement=M,e.getTransitionDurationFromElement=f,e.getUID=u,e.getjQuery=S,e.isDisabled=x,e.isElement=p,e.isRTL=R,e.isVisible=v,e.noop=y,e.onDOMContentLoaded=C,e.parseSelector=a,e.reflow=w,e.toType=l,e.triggerTransitionEnd=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})}(hd,hd.exports)),hd.exports}/*!
  * Bootstrap event-handler.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var p4=Im.exports,EA;function xy(){return EA||(EA=1,function(n,t){(function(e,r){n.exports=r(zc())})(p4,function(e){const r=/[^.]*(?=\..*)\.|.*/,i=/\..*/,s=/::\d+$/,a={};let l=1;const u={mouseenter:"mouseover",mouseleave:"mouseout"},f=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function d(N,D){return D&&`${D}::${l++}`||N.uidEvent||l++}function p(N){const D=d(N);return N.uidEvent=D,a[D]=a[D]||{},a[D]}function m(N,D){return function I(M){return R(M,{delegateTarget:N}),I.oneOff&&C.off(N,M.type,D),D.apply(N,[M])}}function v(N,D,I){return function M(B){const H=N.querySelectorAll(D);for(let{target:F}=B;F&&F!==this;F=F.parentNode)for(const rt of H)if(rt===F)return R(B,{delegateTarget:F}),M.oneOff&&C.off(N,B.type,D,I),I.apply(F,[B])}}function x(N,D,I=null){return Object.values(N).find(M=>M.callable===D&&M.delegationSelector===I)}function _(N,D,I){const M=typeof D=="string",B=M?I:D||I;let H=T(N);return f.has(H)||(H=N),[M,B,H]}function y(N,D,I,M,B){if(typeof D!="string"||!N)return;let[H,F,rt]=_(D,I,M);D in u&&(F=(P=>function(V){if(!V.relatedTarget||V.relatedTarget!==V.delegateTarget&&!V.delegateTarget.contains(V.relatedTarget))return P.call(this,V)})(F));const L=p(N),it=L[rt]||(L[rt]={}),Z=x(it,F,H?I:null);if(Z){Z.oneOff=Z.oneOff&&B;return}const q=d(F,D.replace(r,"")),Ct=H?v(N,I,F):m(N,F);Ct.delegationSelector=H?I:null,Ct.callable=F,Ct.oneOff=B,Ct.uidEvent=q,it[q]=Ct,N.addEventListener(rt,Ct,H)}function w(N,D,I,M,B){const H=x(D[I],M,B);H&&(N.removeEventListener(I,H,!!B),delete D[I][H.uidEvent])}function S(N,D,I,M){const B=D[I]||{};for(const[H,F]of Object.entries(B))H.includes(M)&&w(N,D,I,F.callable,F.delegationSelector)}function T(N){return N=N.replace(i,""),u[N]||N}const C={on(N,D,I,M){y(N,D,I,M,!1)},one(N,D,I,M){y(N,D,I,M,!0)},off(N,D,I,M){if(typeof D!="string"||!N)return;const[B,H,F]=_(D,I,M),rt=F!==D,L=p(N),it=L[F]||{},Z=D.startsWith(".");if(typeof H<"u"){if(!Object.keys(it).length)return;w(N,L,F,H,B?I:null);return}if(Z)for(const q of Object.keys(L))S(N,L,q,D.slice(1));for(const[q,Ct]of Object.entries(it)){const at=q.replace(s,"");(!rt||D.includes(at))&&w(N,L,F,Ct.callable,Ct.delegationSelector)}},trigger(N,D,I){if(typeof D!="string"||!N)return null;const M=e.getjQuery(),B=T(D),H=D!==B;let F=null,rt=!0,L=!0,it=!1;H&&M&&(F=M.Event(D,I),M(N).trigger(F),rt=!F.isPropagationStopped(),L=!F.isImmediatePropagationStopped(),it=F.isDefaultPrevented());const Z=R(new Event(D,{bubbles:rt,cancelable:!0}),I);return it&&Z.preventDefault(),L&&N.dispatchEvent(Z),Z.defaultPrevented&&F&&F.preventDefault(),Z}};function R(N,D={}){for(const[I,M]of Object.entries(D))try{N[I]=M}catch{Object.defineProperty(N,I,{configurable:!0,get(){return M}})}return N}return C})}(Im)),Im.exports}var Mm={exports:{}},Pm={exports:{}};/*!
  * Bootstrap manipulator.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var m4=Pm.exports,AA;function yy(){return AA||(AA=1,function(n,t){(function(e,r){n.exports=r()})(m4,function(){function e(s){if(s==="true")return!0;if(s==="false")return!1;if(s===Number(s).toString())return Number(s);if(s===""||s==="null")return null;if(typeof s!="string")return s;try{return JSON.parse(decodeURIComponent(s))}catch{return s}}function r(s){return s.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)}return{setDataAttribute(s,a,l){s.setAttribute(`data-bs-${r(a)}`,l)},removeDataAttribute(s,a){s.removeAttribute(`data-bs-${r(a)}`)},getDataAttributes(s){if(!s)return{};const a={},l=Object.keys(s.dataset).filter(u=>u.startsWith("bs")&&!u.startsWith("bsConfig"));for(const u of l){let f=u.replace(/^bs/,"");f=f.charAt(0).toLowerCase()+f.slice(1),a[f]=e(s.dataset[u])}return a},getDataAttribute(s,a){return e(s.getAttribute(`data-bs-${r(a)}`))}}})}(Pm)),Pm.exports}/*!
  * Bootstrap config.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var g4=Mm.exports,SA;function IC(){return SA||(SA=1,function(n,t){(function(e,r){n.exports=r(yy(),zc())})(g4,function(e,r){class i{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(a){return a=this._mergeConfigObj(a),a=this._configAfterMerge(a),this._typeCheckConfig(a),a}_configAfterMerge(a){return a}_mergeConfigObj(a,l){const u=r.isElement(l)?e.getDataAttribute(l,"config"):{};return{...this.constructor.Default,...typeof u=="object"?u:{},...r.isElement(l)?e.getDataAttributes(l):{},...typeof a=="object"?a:{}}}_typeCheckConfig(a,l=this.constructor.DefaultType){for(const[u,f]of Object.entries(l)){const d=a[u],p=r.isElement(d)?"element":r.toType(d);if(!new RegExp(f).test(p))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${u}" provided type "${p}" but expected type "${f}".`)}}}return i})}(Mm)),Mm.exports}/*!
  * Bootstrap base-component.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var v4=km.exports,TA;function MC(){return TA||(TA=1,function(n,t){(function(e,r){n.exports=r(h4(),xy(),IC(),zc())})(v4,function(e,r,i,s){const a="5.3.7";class l extends i{constructor(f,d){super(),f=s.getElement(f),f&&(this._element=f,this._config=this._getConfig(d),e.set(this._element,this.constructor.DATA_KEY,this))}dispose(){e.remove(this._element,this.constructor.DATA_KEY),r.off(this._element,this.constructor.EVENT_KEY);for(const f of Object.getOwnPropertyNames(this))this[f]=null}_queueCallback(f,d,p=!0){s.executeAfterTransition(f,d,p)}_getConfig(f){return f=this._mergeConfigObj(f,this._element),f=this._configAfterMerge(f),this._typeCheckConfig(f),f}static getInstance(f){return e.get(s.getElement(f),this.DATA_KEY)}static getOrCreateInstance(f,d={}){return this.getInstance(f)||new this(f,typeof d=="object"?d:null)}static get VERSION(){return a}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(f){return`${f}${this.EVENT_KEY}`}}return l})}(km)),km.exports}var dd={exports:{}};/*!
  * Bootstrap sanitizer.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var _4=dd.exports,CA;function PC(){return CA||(CA=1,function(n,t){(function(e,r){r(t)})(_4,function(e){const i={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},s=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),a=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,l=(f,d)=>{const p=f.nodeName.toLowerCase();return d.includes(p)?s.has(p)?!!a.test(f.nodeValue):!0:d.filter(m=>m instanceof RegExp).some(m=>m.test(p))};function u(f,d,p){if(!f.length)return f;if(p&&typeof p=="function")return p(f);const v=new window.DOMParser().parseFromString(f,"text/html"),x=[].concat(...v.body.querySelectorAll("*"));for(const _ of x){const y=_.nodeName.toLowerCase();if(!Object.keys(d).includes(y)){_.remove();continue}const w=[].concat(..._.attributes),S=[].concat(d["*"]||[],d[y]||[]);for(const T of w)l(T,S)||_.removeAttribute(T.nodeName)}return v.body.innerHTML}e.DefaultAllowlist=i,e.sanitizeHtml=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})}(dd,dd.exports)),dd.exports}var Fm={exports:{}},Bm={exports:{}};/*!
  * Bootstrap selector-engine.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var x4=Bm.exports,DA;function FC(){return DA||(DA=1,function(n,t){(function(e,r){n.exports=r(zc())})(x4,function(e){const r=s=>{let a=s.getAttribute("data-bs-target");if(!a||a==="#"){let l=s.getAttribute("href");if(!l||!l.includes("#")&&!l.startsWith("."))return null;l.includes("#")&&!l.startsWith("#")&&(l=`#${l.split("#")[1]}`),a=l&&l!=="#"?l.trim():null}return a?a.split(",").map(l=>e.parseSelector(l)).join(","):null},i={find(s,a=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(a,s))},findOne(s,a=document.documentElement){return Element.prototype.querySelector.call(a,s)},children(s,a){return[].concat(...s.children).filter(l=>l.matches(a))},parents(s,a){const l=[];let u=s.parentNode.closest(a);for(;u;)l.push(u),u=u.parentNode.closest(a);return l},prev(s,a){let l=s.previousElementSibling;for(;l;){if(l.matches(a))return[l];l=l.previousElementSibling}return[]},next(s,a){let l=s.nextElementSibling;for(;l;){if(l.matches(a))return[l];l=l.nextElementSibling}return[]},focusableChildren(s){const a=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(l=>`${l}:not([tabindex^="-"])`).join(",");return this.find(a,s).filter(l=>!e.isDisabled(l)&&e.isVisible(l))},getSelectorFromElement(s){const a=r(s);return a&&i.findOne(a)?a:null},getElementFromSelector(s){const a=r(s);return a?i.findOne(a):null},getMultipleElementsFromSelector(s){const a=r(s);return a?i.find(a):[]}};return i})}(Bm)),Bm.exports}/*!
  * Bootstrap template-factory.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var y4=Fm.exports,OA;function b4(){return OA||(OA=1,function(n,t){(function(e,r){n.exports=r(FC(),IC(),PC(),zc())})(y4,function(e,r,i,s){const a="TemplateFactory",l={allowList:i.DefaultAllowlist,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},u={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},f={entry:"(string|element|function|null)",selector:"(string|element)"};class d extends r{constructor(m){super(),this._config=this._getConfig(m)}static get Default(){return l}static get DefaultType(){return u}static get NAME(){return a}getContent(){return Object.values(this._config.content).map(m=>this._resolvePossibleFunction(m)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(m){return this._checkContent(m),this._config.content={...this._config.content,...m},this}toHtml(){const m=document.createElement("div");m.innerHTML=this._maybeSanitize(this._config.template);for(const[_,y]of Object.entries(this._config.content))this._setContent(m,y,_);const v=m.children[0],x=this._resolvePossibleFunction(this._config.extraClass);return x&&v.classList.add(...x.split(" ")),v}_typeCheckConfig(m){super._typeCheckConfig(m),this._checkContent(m.content)}_checkContent(m){for(const[v,x]of Object.entries(m))super._typeCheckConfig({selector:v,entry:x},f)}_setContent(m,v,x){const _=e.findOne(x,m);if(_){if(v=this._resolvePossibleFunction(v),!v){_.remove();return}if(s.isElement(v)){this._putElementInTemplate(s.getElement(v),_);return}if(this._config.html){_.innerHTML=this._maybeSanitize(v);return}_.textContent=v}}_maybeSanitize(m){return this._config.sanitize?i.sanitizeHtml(m,this._config.allowList,this._config.sanitizeFn):m}_resolvePossibleFunction(m){return s.execute(m,[void 0,this])}_putElementInTemplate(m,v){if(this._config.html){v.innerHTML="",v.append(m);return}v.textContent=m.textContent}}return d})}(Fm)),Fm.exports}/*!
  * Bootstrap tooltip.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var w4=Rm.exports,RA;function E4(){return RA||(RA=1,function(n,t){(function(e,r){n.exports=r(LC,MC(),xy(),yy(),zc(),PC(),b4())})(w4,function(e,r,i,s,a,l,u){function f(V){const j=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(V){for(const et in V)if(et!=="default"){const dt=Object.getOwnPropertyDescriptor(V,et);Object.defineProperty(j,et,dt.get?dt:{enumerable:!0,get:()=>V[et]})}}return j.default=V,Object.freeze(j)}const d=f(e),p="tooltip",m=new Set(["sanitize","allowList","sanitizeFn"]),v="fade",x="modal",_="show",y=".tooltip-inner",w=`.${x}`,S="hide.bs.modal",T="hover",C="focus",R="click",N="manual",D="hide",I="hidden",M="show",B="shown",H="inserted",F="click",rt="focusin",L="focusout",it="mouseenter",Z="mouseleave",q={AUTO:"auto",TOP:"top",RIGHT:a.isRTL()?"left":"right",BOTTOM:"bottom",LEFT:a.isRTL()?"right":"left"},Ct={allowList:l.DefaultAllowlist,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},at={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class P extends r{constructor(j,et){if(typeof d>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(j,et),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Ct}static get DefaultType(){return at}static get NAME(){return p}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),i.off(this._element.closest(w),S,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const j=i.trigger(this._element,this.constructor.eventName(M)),dt=(a.findShadowRoot(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(j.defaultPrevented||!dt)return;this._disposePopper();const xt=this._getTipElement();this._element.setAttribute("aria-describedby",xt.getAttribute("id"));const{container:Nt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(Nt.append(xt),i.trigger(this._element,this.constructor.eventName(H))),this._popper=this._createPopper(xt),xt.classList.add(_),"ontouchstart"in document.documentElement)for(const z of[].concat(...document.body.children))i.on(z,"mouseover",a.noop);const Rt=()=>{i.trigger(this._element,this.constructor.eventName(B)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(Rt,this.tip,this._isAnimated())}hide(){if(!this._isShown()||i.trigger(this._element,this.constructor.eventName(D)).defaultPrevented)return;if(this._getTipElement().classList.remove(_),"ontouchstart"in document.documentElement)for(const xt of[].concat(...document.body.children))i.off(xt,"mouseover",a.noop);this._activeTrigger[R]=!1,this._activeTrigger[C]=!1,this._activeTrigger[T]=!1,this._isHovered=null;const dt=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),i.trigger(this._element,this.constructor.eventName(I)))};this._queueCallback(dt,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(j){const et=this._getTemplateFactory(j).toHtml();if(!et)return null;et.classList.remove(v,_),et.classList.add(`bs-${this.constructor.NAME}-auto`);const dt=a.getUID(this.constructor.NAME).toString();return et.setAttribute("id",dt),this._isAnimated()&&et.classList.add(v),et}setContent(j){this._newContent=j,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(j){return this._templateFactory?this._templateFactory.changeContent(j):this._templateFactory=new u({...this._config,content:j,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[y]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(j){return this.constructor.getOrCreateInstance(j.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(v)}_isShown(){return this.tip&&this.tip.classList.contains(_)}_createPopper(j){const et=a.execute(this._config.placement,[this,j,this._element]),dt=q[et.toUpperCase()];return d.createPopper(this._element,j,this._getPopperConfig(dt))}_getOffset(){const{offset:j}=this._config;return typeof j=="string"?j.split(",").map(et=>Number.parseInt(et,10)):typeof j=="function"?et=>j(et,this._element):j}_resolvePossibleFunction(j){return a.execute(j,[this._element,this._element])}_getPopperConfig(j){const et={placement:j,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:dt=>{this._getTipElement().setAttribute("data-popper-placement",dt.state.placement)}}]};return{...et,...a.execute(this._config.popperConfig,[void 0,et])}}_setListeners(){const j=this._config.trigger.split(" ");for(const et of j)if(et==="click")i.on(this._element,this.constructor.eventName(F),this._config.selector,dt=>{const xt=this._initializeOnDelegatedTarget(dt);xt._activeTrigger[R]=!(xt._isShown()&&xt._activeTrigger[R]),xt.toggle()});else if(et!==N){const dt=et===T?this.constructor.eventName(it):this.constructor.eventName(rt),xt=et===T?this.constructor.eventName(Z):this.constructor.eventName(L);i.on(this._element,dt,this._config.selector,Nt=>{const Rt=this._initializeOnDelegatedTarget(Nt);Rt._activeTrigger[Nt.type==="focusin"?C:T]=!0,Rt._enter()}),i.on(this._element,xt,this._config.selector,Nt=>{const Rt=this._initializeOnDelegatedTarget(Nt);Rt._activeTrigger[Nt.type==="focusout"?C:T]=Rt._element.contains(Nt.relatedTarget),Rt._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},i.on(this._element.closest(w),S,this._hideModalHandler)}_fixTitle(){const j=this._element.getAttribute("title");j&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",j),this._element.setAttribute("data-bs-original-title",j),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(j,et){clearTimeout(this._timeout),this._timeout=setTimeout(j,et)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(j){const et=s.getDataAttributes(this._element);for(const dt of Object.keys(et))m.has(dt)&&delete et[dt];return j={...et,...typeof j=="object"&&j?j:{}},j=this._mergeConfigObj(j),j=this._configAfterMerge(j),this._typeCheckConfig(j),j}_configAfterMerge(j){return j.container=j.container===!1?document.body:a.getElement(j.container),typeof j.delay=="number"&&(j.delay={show:j.delay,hide:j.delay}),typeof j.title=="number"&&(j.title=j.title.toString()),typeof j.content=="number"&&(j.content=j.content.toString()),j}_getDelegateConfig(){const j={};for(const[et,dt]of Object.entries(this._config))this.constructor.Default[et]!==dt&&(j[et]=dt);return j.selector=!1,j.trigger="manual",j}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(j){return this.each(function(){const et=P.getOrCreateInstance(this,j);if(typeof j=="string"){if(typeof et[j]>"u")throw new TypeError(`No method named "${j}"`);et[j]()}})}}return a.defineJQueryPlugin(P),P})}(Rm)),Rm.exports}E4();var Um={exports:{}};/*!
  * Bootstrap dropdown.js v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var A4=Um.exports,NA;function S4(){return NA||(NA=1,function(n,t){(function(e,r){n.exports=r(LC,MC(),xy(),yy(),FC(),zc())})(A4,function(e,r,i,s,a,l){function u(At){const O=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(At){for(const gt in At)if(gt!=="default"){const ut=Object.getOwnPropertyDescriptor(At,gt);Object.defineProperty(O,gt,ut.get?ut:{enumerable:!0,get:()=>At[gt]})}}return O.default=At,Object.freeze(O)}const f=u(e),d="dropdown",m=".bs.dropdown",v=".data-api",x="Escape",_="Tab",y="ArrowUp",w="ArrowDown",S=2,T=`hide${m}`,C=`hidden${m}`,R=`show${m}`,N=`shown${m}`,D=`click${m}${v}`,I=`keydown${m}${v}`,M=`keyup${m}${v}`,B="show",H="dropup",F="dropend",rt="dropstart",L="dropup-center",it="dropdown-center",Z='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',q=`${Z}.${B}`,Ct=".dropdown-menu",at=".navbar",P=".navbar-nav",V=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",j=l.isRTL()?"top-end":"top-start",et=l.isRTL()?"top-start":"top-end",dt=l.isRTL()?"bottom-end":"bottom-start",xt=l.isRTL()?"bottom-start":"bottom-end",Nt=l.isRTL()?"left-start":"right-start",Rt=l.isRTL()?"right-start":"left-start",z="top",lt="bottom",J={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},ot={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class yt extends r{constructor(O,gt){super(O,gt),this._popper=null,this._parent=this._element.parentNode,this._menu=a.next(this._element,Ct)[0]||a.prev(this._element,Ct)[0]||a.findOne(Ct,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return J}static get DefaultType(){return ot}static get NAME(){return d}toggle(){return this._isShown()?this.hide():this.show()}show(){if(l.isDisabled(this._element)||this._isShown())return;const O={relatedTarget:this._element};if(!i.trigger(this._element,R,O).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(P))for(const ut of[].concat(...document.body.children))i.on(ut,"mouseover",l.noop);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(B),this._element.classList.add(B),i.trigger(this._element,N,O)}}hide(){if(l.isDisabled(this._element)||!this._isShown())return;const O={relatedTarget:this._element};this._completeHide(O)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(O){if(!i.trigger(this._element,T,O).defaultPrevented){if("ontouchstart"in document.documentElement)for(const ut of[].concat(...document.body.children))i.off(ut,"mouseover",l.noop);this._popper&&this._popper.destroy(),this._menu.classList.remove(B),this._element.classList.remove(B),this._element.setAttribute("aria-expanded","false"),s.removeDataAttribute(this._menu,"popper"),i.trigger(this._element,C,O),this._element.focus()}}_getConfig(O){if(O=super._getConfig(O),typeof O.reference=="object"&&!l.isElement(O.reference)&&typeof O.reference.getBoundingClientRect!="function")throw new TypeError(`${d.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return O}_createPopper(){if(typeof f>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let O=this._element;this._config.reference==="parent"?O=this._parent:l.isElement(this._config.reference)?O=l.getElement(this._config.reference):typeof this._config.reference=="object"&&(O=this._config.reference);const gt=this._getPopperConfig();this._popper=f.createPopper(O,this._menu,gt)}_isShown(){return this._menu.classList.contains(B)}_getPlacement(){const O=this._parent;if(O.classList.contains(F))return Nt;if(O.classList.contains(rt))return Rt;if(O.classList.contains(L))return z;if(O.classList.contains(it))return lt;const gt=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return O.classList.contains(H)?gt?et:j:gt?xt:dt}_detectNavbar(){return this._element.closest(at)!==null}_getOffset(){const{offset:O}=this._config;return typeof O=="string"?O.split(",").map(gt=>Number.parseInt(gt,10)):typeof O=="function"?gt=>O(gt,this._element):O}_getPopperConfig(){const O={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(s.setDataAttribute(this._menu,"popper","static"),O.modifiers=[{name:"applyStyles",enabled:!1}]),{...O,...l.execute(this._config.popperConfig,[void 0,O])}}_selectMenuItem({key:O,target:gt}){const ut=a.find(V,this._menu).filter(K=>l.isVisible(K));ut.length&&l.getNextActiveElement(ut,gt,O===w,!ut.includes(gt)).focus()}static jQueryInterface(O){return this.each(function(){const gt=yt.getOrCreateInstance(this,O);if(typeof O=="string"){if(typeof gt[O]>"u")throw new TypeError(`No method named "${O}"`);gt[O]()}})}static clearMenus(O){if(O.button===S||O.type==="keyup"&&O.key!==_)return;const gt=a.find(q);for(const ut of gt){const K=yt.getInstance(ut);if(!K||K._config.autoClose===!1)continue;const X=O.composedPath(),pt=X.includes(K._menu);if(X.includes(K._element)||K._config.autoClose==="inside"&&!pt||K._config.autoClose==="outside"&&pt||K._menu.contains(O.target)&&(O.type==="keyup"&&O.key===_||/input|select|option|textarea|form/i.test(O.target.tagName)))continue;const Bt={relatedTarget:K._element};O.type==="click"&&(Bt.clickEvent=O),K._completeHide(Bt)}}static dataApiKeydownHandler(O){const gt=/input|textarea/i.test(O.target.tagName),ut=O.key===x,K=[y,w].includes(O.key);if(!K&&!ut||gt&&!ut)return;O.preventDefault();const X=this.matches(Z)?this:a.prev(this,Z)[0]||a.next(this,Z)[0]||a.findOne(Z,O.delegateTarget.parentNode),pt=yt.getOrCreateInstance(X);if(K){O.stopPropagation(),pt.show(),pt._selectMenuItem(O);return}pt._isShown()&&(O.stopPropagation(),pt.hide(),X.focus())}}return i.on(document,I,Z,yt.dataApiKeydownHandler),i.on(document,I,Ct,yt.dataApiKeydownHandler),i.on(document,D,yt.clearMenus),i.on(document,M,yt.clearMenus),i.on(document,D,Z,function(At){At.preventDefault(),yt.getOrCreateInstance(this).toggle()}),l.defineJQueryPlugin(yt),yt})}(Um)),Um.exports}S4();var zm={exports:{}};/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var T4=zm.exports,kA;function C4(){return kA||(kA=1,function(n,t){(function(e,r){n.exports=r()})(T4,function(){const e=new Map,r={set(G,E,k){e.has(G)||e.set(G,new Map);const Q=e.get(G);Q.has(E)||Q.size===0?Q.set(E,k):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(Q.keys())[0]}.`)},get:(G,E)=>e.has(G)&&e.get(G).get(E)||null,remove(G,E){if(!e.has(G))return;const k=e.get(G);k.delete(E),k.size===0&&e.delete(G)}},i="transitionend",s=G=>(G&&window.CSS&&window.CSS.escape&&(G=G.replace(/#([^\s"#']+)/g,(E,k)=>`#${CSS.escape(k)}`)),G),a=G=>{G.dispatchEvent(new Event(i))},l=G=>!(!G||typeof G!="object")&&(G.jquery!==void 0&&(G=G[0]),G.nodeType!==void 0),u=G=>l(G)?G.jquery?G[0]:G:typeof G=="string"&&G.length>0?document.querySelector(s(G)):null,f=G=>{if(!l(G)||G.getClientRects().length===0)return!1;const E=getComputedStyle(G).getPropertyValue("visibility")==="visible",k=G.closest("details:not([open])");if(!k)return E;if(k!==G){const Q=G.closest("summary");if(Q&&Q.parentNode!==k||Q===null)return!1}return E},d=G=>!G||G.nodeType!==Node.ELEMENT_NODE||!!G.classList.contains("disabled")||(G.disabled!==void 0?G.disabled:G.hasAttribute("disabled")&&G.getAttribute("disabled")!=="false"),p=G=>{if(!document.documentElement.attachShadow)return null;if(typeof G.getRootNode=="function"){const E=G.getRootNode();return E instanceof ShadowRoot?E:null}return G instanceof ShadowRoot?G:G.parentNode?p(G.parentNode):null},m=()=>{},v=G=>{G.offsetHeight},x=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_=[],y=()=>document.documentElement.dir==="rtl",w=G=>{var E;E=()=>{const k=x();if(k){const Q=G.NAME,wt=k.fn[Q];k.fn[Q]=G.jQueryInterface,k.fn[Q].Constructor=G,k.fn[Q].noConflict=()=>(k.fn[Q]=wt,G.jQueryInterface)}},document.readyState==="loading"?(_.length||document.addEventListener("DOMContentLoaded",()=>{for(const k of _)k()}),_.push(E)):E()},S=(G,E=[],k=G)=>typeof G=="function"?G.call(...E):k,T=(G,E,k=!0)=>{if(!k)return void S(G);const Q=(Gt=>{if(!Gt)return 0;let{transitionDuration:qt,transitionDelay:ie}=window.getComputedStyle(Gt);const fe=Number.parseFloat(qt),he=Number.parseFloat(ie);return fe||he?(qt=qt.split(",")[0],ie=ie.split(",")[0],1e3*(Number.parseFloat(qt)+Number.parseFloat(ie))):0})(E)+5;let wt=!1;const Dt=({target:Gt})=>{Gt===E&&(wt=!0,E.removeEventListener(i,Dt),S(G))};E.addEventListener(i,Dt),setTimeout(()=>{wt||a(E)},Q)},C=(G,E,k,Q)=>{const wt=G.length;let Dt=G.indexOf(E);return Dt===-1?!k&&Q?G[wt-1]:G[0]:(Dt+=k?1:-1,Q&&(Dt=(Dt+wt)%wt),G[Math.max(0,Math.min(Dt,wt-1))])},R=/[^.]*(?=\..*)\.|.*/,N=/\..*/,D=/::\d+$/,I={};let M=1;const B={mouseenter:"mouseover",mouseleave:"mouseout"},H=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function F(G,E){return E&&`${E}::${M++}`||G.uidEvent||M++}function rt(G){const E=F(G);return G.uidEvent=E,I[E]=I[E]||{},I[E]}function L(G,E,k=null){return Object.values(G).find(Q=>Q.callable===E&&Q.delegationSelector===k)}function it(G,E,k){const Q=typeof E=="string",wt=Q?k:E||k;let Dt=at(G);return H.has(Dt)||(Dt=G),[Q,wt,Dt]}function Z(G,E,k,Q,wt){if(typeof E!="string"||!G)return;let[Dt,Gt,qt]=it(E,k,Q);E in B&&(Gt=(Fe=>function(Ne){if(!Ne.relatedTarget||Ne.relatedTarget!==Ne.delegateTarget&&!Ne.delegateTarget.contains(Ne.relatedTarget))return Fe.call(this,Ne)})(Gt));const ie=rt(G),fe=ie[qt]||(ie[qt]={}),he=L(fe,Gt,Dt?k:null);if(he)return void(he.oneOff=he.oneOff&&wt);const ce=F(Gt,E.replace(R,"")),Pe=Dt?function(we,Fe,Ne){return function Te(on){const pn=we.querySelectorAll(Fe);for(let{target:je}=on;je&&je!==this;je=je.parentNode)for(const Qe of pn)if(Qe===je)return V(on,{delegateTarget:je}),Te.oneOff&&P.off(we,on.type,Fe,Ne),Ne.apply(je,[on])}}(G,k,Gt):function(we,Fe){return function Ne(Te){return V(Te,{delegateTarget:we}),Ne.oneOff&&P.off(we,Te.type,Fe),Fe.apply(we,[Te])}}(G,Gt);Pe.delegationSelector=Dt?k:null,Pe.callable=Gt,Pe.oneOff=wt,Pe.uidEvent=ce,fe[ce]=Pe,G.addEventListener(qt,Pe,Dt)}function q(G,E,k,Q,wt){const Dt=L(E[k],Q,wt);Dt&&(G.removeEventListener(k,Dt,!!wt),delete E[k][Dt.uidEvent])}function Ct(G,E,k,Q){const wt=E[k]||{};for(const[Dt,Gt]of Object.entries(wt))Dt.includes(Q)&&q(G,E,k,Gt.callable,Gt.delegationSelector)}function at(G){return G=G.replace(N,""),B[G]||G}const P={on(G,E,k,Q){Z(G,E,k,Q,!1)},one(G,E,k,Q){Z(G,E,k,Q,!0)},off(G,E,k,Q){if(typeof E!="string"||!G)return;const[wt,Dt,Gt]=it(E,k,Q),qt=Gt!==E,ie=rt(G),fe=ie[Gt]||{},he=E.startsWith(".");if(Dt===void 0){if(he)for(const ce of Object.keys(ie))Ct(G,ie,ce,E.slice(1));for(const[ce,Pe]of Object.entries(fe)){const we=ce.replace(D,"");qt&&!E.includes(we)||q(G,ie,Gt,Pe.callable,Pe.delegationSelector)}}else{if(!Object.keys(fe).length)return;q(G,ie,Gt,Dt,wt?k:null)}},trigger(G,E,k){if(typeof E!="string"||!G)return null;const Q=x();let wt=null,Dt=!0,Gt=!0,qt=!1;E!==at(E)&&Q&&(wt=Q.Event(E,k),Q(G).trigger(wt),Dt=!wt.isPropagationStopped(),Gt=!wt.isImmediatePropagationStopped(),qt=wt.isDefaultPrevented());const ie=V(new Event(E,{bubbles:Dt,cancelable:!0}),k);return qt&&ie.preventDefault(),Gt&&G.dispatchEvent(ie),ie.defaultPrevented&&wt&&wt.preventDefault(),ie}};function V(G,E={}){for(const[k,Q]of Object.entries(E))try{G[k]=Q}catch{Object.defineProperty(G,k,{configurable:!0,get:()=>Q})}return G}function j(G){if(G==="true")return!0;if(G==="false")return!1;if(G===Number(G).toString())return Number(G);if(G===""||G==="null")return null;if(typeof G!="string")return G;try{return JSON.parse(decodeURIComponent(G))}catch{return G}}function et(G){return G.replace(/[A-Z]/g,E=>`-${E.toLowerCase()}`)}const dt={setDataAttribute(G,E,k){G.setAttribute(`data-bs-${et(E)}`,k)},removeDataAttribute(G,E){G.removeAttribute(`data-bs-${et(E)}`)},getDataAttributes(G){if(!G)return{};const E={},k=Object.keys(G.dataset).filter(Q=>Q.startsWith("bs")&&!Q.startsWith("bsConfig"));for(const Q of k){let wt=Q.replace(/^bs/,"");wt=wt.charAt(0).toLowerCase()+wt.slice(1),E[wt]=j(G.dataset[Q])}return E},getDataAttribute:(G,E)=>j(G.getAttribute(`data-bs-${et(E)}`))};class xt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(E){return E=this._mergeConfigObj(E),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}_configAfterMerge(E){return E}_mergeConfigObj(E,k){const Q=l(k)?dt.getDataAttribute(k,"config"):{};return{...this.constructor.Default,...typeof Q=="object"?Q:{},...l(k)?dt.getDataAttributes(k):{},...typeof E=="object"?E:{}}}_typeCheckConfig(E,k=this.constructor.DefaultType){for(const[wt,Dt]of Object.entries(k)){const Gt=E[wt],qt=l(Gt)?"element":(Q=Gt)==null?`${Q}`:Object.prototype.toString.call(Q).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(Dt).test(qt))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${wt}" provided type "${qt}" but expected type "${Dt}".`)}var Q}}class Nt extends xt{constructor(E,k){super(),(E=u(E))&&(this._element=E,this._config=this._getConfig(k),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),P.off(this._element,this.constructor.EVENT_KEY);for(const E of Object.getOwnPropertyNames(this))this[E]=null}_queueCallback(E,k,Q=!0){T(E,k,Q)}_getConfig(E){return E=this._mergeConfigObj(E,this._element),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}static getInstance(E){return r.get(u(E),this.DATA_KEY)}static getOrCreateInstance(E,k={}){return this.getInstance(E)||new this(E,typeof k=="object"?k:null)}static get VERSION(){return"5.3.7"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(E){return`${E}${this.EVENT_KEY}`}}const Rt=G=>{let E=G.getAttribute("data-bs-target");if(!E||E==="#"){let k=G.getAttribute("href");if(!k||!k.includes("#")&&!k.startsWith("."))return null;k.includes("#")&&!k.startsWith("#")&&(k=`#${k.split("#")[1]}`),E=k&&k!=="#"?k.trim():null}return E?E.split(",").map(k=>s(k)).join(","):null},z={find:(G,E=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(E,G)),findOne:(G,E=document.documentElement)=>Element.prototype.querySelector.call(E,G),children:(G,E)=>[].concat(...G.children).filter(k=>k.matches(E)),parents(G,E){const k=[];let Q=G.parentNode.closest(E);for(;Q;)k.push(Q),Q=Q.parentNode.closest(E);return k},prev(G,E){let k=G.previousElementSibling;for(;k;){if(k.matches(E))return[k];k=k.previousElementSibling}return[]},next(G,E){let k=G.nextElementSibling;for(;k;){if(k.matches(E))return[k];k=k.nextElementSibling}return[]},focusableChildren(G){const E=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(k=>`${k}:not([tabindex^="-"])`).join(",");return this.find(E,G).filter(k=>!d(k)&&f(k))},getSelectorFromElement(G){const E=Rt(G);return E&&z.findOne(E)?E:null},getElementFromSelector(G){const E=Rt(G);return E?z.findOne(E):null},getMultipleElementsFromSelector(G){const E=Rt(G);return E?z.find(E):[]}},lt=(G,E="hide")=>{const k=`click.dismiss${G.EVENT_KEY}`,Q=G.NAME;P.on(document,k,`[data-bs-dismiss="${Q}"]`,function(wt){if(["A","AREA"].includes(this.tagName)&&wt.preventDefault(),d(this))return;const Dt=z.getElementFromSelector(this)||this.closest(`.${Q}`);G.getOrCreateInstance(Dt)[E]()})},J=".bs.alert",ot=`close${J}`,yt=`closed${J}`;class At extends Nt{static get NAME(){return"alert"}close(){if(P.trigger(this._element,ot).defaultPrevented)return;this._element.classList.remove("show");const E=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,E)}_destroyElement(){this._element.remove(),P.trigger(this._element,yt),this.dispose()}static jQueryInterface(E){return this.each(function(){const k=At.getOrCreateInstance(this);if(typeof E=="string"){if(k[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);k[E](this)}})}}lt(At,"close"),w(At);const O='[data-bs-toggle="button"]';class gt extends Nt{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(E){return this.each(function(){const k=gt.getOrCreateInstance(this);E==="toggle"&&k[E]()})}}P.on(document,"click.bs.button.data-api",O,G=>{G.preventDefault();const E=G.target.closest(O);gt.getOrCreateInstance(E).toggle()}),w(gt);const ut=".bs.swipe",K=`touchstart${ut}`,X=`touchmove${ut}`,pt=`touchend${ut}`,Bt=`pointerdown${ut}`,Ht=`pointerup${ut}`,St={endCallback:null,leftCallback:null,rightCallback:null},It={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Tt extends xt{constructor(E,k){super(),this._element=E,E&&Tt.isSupported()&&(this._config=this._getConfig(k),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return St}static get DefaultType(){return It}static get NAME(){return"swipe"}dispose(){P.off(this._element,ut)}_start(E){this._supportPointerEvents?this._eventIsPointerPenTouch(E)&&(this._deltaX=E.clientX):this._deltaX=E.touches[0].clientX}_end(E){this._eventIsPointerPenTouch(E)&&(this._deltaX=E.clientX-this._deltaX),this._handleSwipe(),S(this._config.endCallback)}_move(E){this._deltaX=E.touches&&E.touches.length>1?0:E.touches[0].clientX-this._deltaX}_handleSwipe(){const E=Math.abs(this._deltaX);if(E<=40)return;const k=E/this._deltaX;this._deltaX=0,k&&S(k>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(P.on(this._element,Bt,E=>this._start(E)),P.on(this._element,Ht,E=>this._end(E)),this._element.classList.add("pointer-event")):(P.on(this._element,K,E=>this._start(E)),P.on(this._element,X,E=>this._move(E)),P.on(this._element,pt,E=>this._end(E)))}_eventIsPointerPenTouch(E){return this._supportPointerEvents&&(E.pointerType==="pen"||E.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const vt=".bs.carousel",te=".data-api",ae="ArrowLeft",ne="ArrowRight",Re="next",rn="prev",be="left",ln="right",Ve=`slide${vt}`,zn=`slid${vt}`,Cn=`keydown${vt}`,yn=`mouseenter${vt}`,mr=`mouseleave${vt}`,_s=`dragstart${vt}`,Vs=`load${vt}${te}`,Xa=`click${vt}${te}`,Ws="carousel",Er="active",Oi=".active",zl=".carousel-item",Kc=Oi+zl,jl={[ae]:ln,[ne]:be},Hl={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Zc={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class fa extends Nt{constructor(E,k){super(E,k),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=z.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Ws&&this.cycle()}static get Default(){return Hl}static get DefaultType(){return Zc}static get NAME(){return"carousel"}next(){this._slide(Re)}nextWhenVisible(){!document.hidden&&f(this._element)&&this.next()}prev(){this._slide(rn)}pause(){this._isSliding&&a(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?P.one(this._element,zn,()=>this.cycle()):this.cycle())}to(E){const k=this._getItems();if(E>k.length-1||E<0)return;if(this._isSliding)return void P.one(this._element,zn,()=>this.to(E));const Q=this._getItemIndex(this._getActive());if(Q===E)return;const wt=E>Q?Re:rn;this._slide(wt,k[E])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(E){return E.defaultInterval=E.interval,E}_addEventListeners(){this._config.keyboard&&P.on(this._element,Cn,E=>this._keydown(E)),this._config.pause==="hover"&&(P.on(this._element,yn,()=>this.pause()),P.on(this._element,mr,()=>this._maybeEnableCycle())),this._config.touch&&Tt.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const k of z.find(".carousel-item img",this._element))P.on(k,_s,Q=>Q.preventDefault());const E={leftCallback:()=>this._slide(this._directionToOrder(be)),rightCallback:()=>this._slide(this._directionToOrder(ln)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new Tt(this._element,E)}_keydown(E){if(/input|textarea/i.test(E.target.tagName))return;const k=jl[E.key];k&&(E.preventDefault(),this._slide(this._directionToOrder(k)))}_getItemIndex(E){return this._getItems().indexOf(E)}_setActiveIndicatorElement(E){if(!this._indicatorsElement)return;const k=z.findOne(Oi,this._indicatorsElement);k.classList.remove(Er),k.removeAttribute("aria-current");const Q=z.findOne(`[data-bs-slide-to="${E}"]`,this._indicatorsElement);Q&&(Q.classList.add(Er),Q.setAttribute("aria-current","true"))}_updateInterval(){const E=this._activeElement||this._getActive();if(!E)return;const k=Number.parseInt(E.getAttribute("data-bs-interval"),10);this._config.interval=k||this._config.defaultInterval}_slide(E,k=null){if(this._isSliding)return;const Q=this._getActive(),wt=E===Re,Dt=k||C(this._getItems(),Q,wt,this._config.wrap);if(Dt===Q)return;const Gt=this._getItemIndex(Dt),qt=ce=>P.trigger(this._element,ce,{relatedTarget:Dt,direction:this._orderToDirection(E),from:this._getItemIndex(Q),to:Gt});if(qt(Ve).defaultPrevented||!Q||!Dt)return;const ie=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(Gt),this._activeElement=Dt;const fe=wt?"carousel-item-start":"carousel-item-end",he=wt?"carousel-item-next":"carousel-item-prev";Dt.classList.add(he),v(Dt),Q.classList.add(fe),Dt.classList.add(fe),this._queueCallback(()=>{Dt.classList.remove(fe,he),Dt.classList.add(Er),Q.classList.remove(Er,he,fe),this._isSliding=!1,qt(zn)},Q,this._isAnimated()),ie&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return z.findOne(Kc,this._element)}_getItems(){return z.find(zl,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(E){return y()?E===be?rn:Re:E===be?Re:rn}_orderToDirection(E){return y()?E===rn?be:ln:E===rn?ln:be}static jQueryInterface(E){return this.each(function(){const k=fa.getOrCreateInstance(this,E);if(typeof E!="number"){if(typeof E=="string"){if(k[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);k[E]()}}else k.to(E)})}}P.on(document,Xa,"[data-bs-slide], [data-bs-slide-to]",function(G){const E=z.getElementFromSelector(this);if(!E||!E.classList.contains(Ws))return;G.preventDefault();const k=fa.getOrCreateInstance(E),Q=this.getAttribute("data-bs-slide-to");return Q?(k.to(Q),void k._maybeEnableCycle()):dt.getDataAttribute(this,"slide")==="next"?(k.next(),void k._maybeEnableCycle()):(k.prev(),void k._maybeEnableCycle())}),P.on(window,Vs,()=>{const G=z.find('[data-bs-ride="carousel"]');for(const E of G)fa.getOrCreateInstance(E)}),w(fa);const Vr=".bs.collapse",rr=`show${Vr}`,ir=`shown${Vr}`,ha=`hide${Vr}`,$l=`hidden${Vr}`,Mf=`click${Vr}.data-api`,W="show",ft="collapse",tt="collapsing",st=`:scope .${ft} .${ft}`,ct='[data-bs-toggle="collapse"]',ht={parent:null,toggle:!0},Pt={parent:"(null|element)",toggle:"boolean"};class $t extends Nt{constructor(E,k){super(E,k),this._isTransitioning=!1,this._triggerArray=[];const Q=z.find(ct);for(const wt of Q){const Dt=z.getSelectorFromElement(wt),Gt=z.find(Dt).filter(qt=>qt===this._element);Dt!==null&&Gt.length&&this._triggerArray.push(wt)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ht}static get DefaultType(){return Pt}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let E=[];if(this._config.parent&&(E=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(wt=>wt!==this._element).map(wt=>$t.getOrCreateInstance(wt,{toggle:!1}))),E.length&&E[0]._isTransitioning||P.trigger(this._element,rr).defaultPrevented)return;for(const wt of E)wt.hide();const k=this._getDimension();this._element.classList.remove(ft),this._element.classList.add(tt),this._element.style[k]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const Q=`scroll${k[0].toUpperCase()+k.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(tt),this._element.classList.add(ft,W),this._element.style[k]="",P.trigger(this._element,ir)},this._element,!0),this._element.style[k]=`${this._element[Q]}px`}hide(){if(this._isTransitioning||!this._isShown()||P.trigger(this._element,ha).defaultPrevented)return;const E=this._getDimension();this._element.style[E]=`${this._element.getBoundingClientRect()[E]}px`,v(this._element),this._element.classList.add(tt),this._element.classList.remove(ft,W);for(const k of this._triggerArray){const Q=z.getElementFromSelector(k);Q&&!this._isShown(Q)&&this._addAriaAndCollapsedClass([k],!1)}this._isTransitioning=!0,this._element.style[E]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(tt),this._element.classList.add(ft),P.trigger(this._element,$l)},this._element,!0)}_isShown(E=this._element){return E.classList.contains(W)}_configAfterMerge(E){return E.toggle=!!E.toggle,E.parent=u(E.parent),E}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const E=this._getFirstLevelChildren(ct);for(const k of E){const Q=z.getElementFromSelector(k);Q&&this._addAriaAndCollapsedClass([k],this._isShown(Q))}}_getFirstLevelChildren(E){const k=z.find(st,this._config.parent);return z.find(E,this._config.parent).filter(Q=>!k.includes(Q))}_addAriaAndCollapsedClass(E,k){if(E.length)for(const Q of E)Q.classList.toggle("collapsed",!k),Q.setAttribute("aria-expanded",k)}static jQueryInterface(E){const k={};return typeof E=="string"&&/show|hide/.test(E)&&(k.toggle=!1),this.each(function(){const Q=$t.getOrCreateInstance(this,k);if(typeof E=="string"){if(Q[E]===void 0)throw new TypeError(`No method named "${E}"`);Q[E]()}})}}P.on(document,Mf,ct,function(G){(G.target.tagName==="A"||G.delegateTarget&&G.delegateTarget.tagName==="A")&&G.preventDefault();for(const E of z.getMultipleElementsFromSelector(this))$t.getOrCreateInstance(E,{toggle:!1}).toggle()}),w($t);var Et="top",kt="bottom",Lt="right",Wt="left",ee="auto",le=[Et,kt,Lt,Wt],Qt="start",re="end",Ie="clippingParents",sn="viewport",Ze="popper",dn="reference",qi=le.reduce(function(G,E){return G.concat([E+"-"+Qt,E+"-"+re])},[]),xs=[].concat(le,[ee]).reduce(function(G,E){return G.concat([E,E+"-"+Qt,E+"-"+re])},[]),ci="beforeRead",Ri="read",da="afterRead",Ni="beforeMain",Pf="main",ui="afterMain",Ff="beforeWrite",bp="write",Gl="afterWrite",Bf=[ci,Ri,da,Ni,Pf,ui,Ff,bp,Gl];function fi(G){return G?(G.nodeName||"").toLowerCase():null}function hi(G){if(G==null)return window;if(G.toString()!=="[object Window]"){var E=G.ownerDocument;return E&&E.defaultView||window}return G}function sr(G){return G instanceof hi(G).Element||G instanceof Element}function Wr(G){return G instanceof hi(G).HTMLElement||G instanceof HTMLElement}function Qc(G){return typeof ShadowRoot<"u"&&(G instanceof hi(G).ShadowRoot||G instanceof ShadowRoot)}const Vl={name:"applyStyles",enabled:!0,phase:"write",fn:function(G){var E=G.state;Object.keys(E.elements).forEach(function(k){var Q=E.styles[k]||{},wt=E.attributes[k]||{},Dt=E.elements[k];Wr(Dt)&&fi(Dt)&&(Object.assign(Dt.style,Q),Object.keys(wt).forEach(function(Gt){var qt=wt[Gt];qt===!1?Dt.removeAttribute(Gt):Dt.setAttribute(Gt,qt===!0?"":qt)}))})},effect:function(G){var E=G.state,k={popper:{position:E.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(E.elements.popper.style,k.popper),E.styles=k,E.elements.arrow&&Object.assign(E.elements.arrow.style,k.arrow),function(){Object.keys(E.elements).forEach(function(Q){var wt=E.elements[Q],Dt=E.attributes[Q]||{},Gt=Object.keys(E.styles.hasOwnProperty(Q)?E.styles[Q]:k[Q]).reduce(function(qt,ie){return qt[ie]="",qt},{});Wr(wt)&&fi(wt)&&(Object.assign(wt.style,Gt),Object.keys(Dt).forEach(function(qt){wt.removeAttribute(qt)}))})}},requires:["computeStyles"]};function kr(G){return G.split("-")[0]}var pa=Math.max,Wl=Math.min,Yi=Math.round;function Uf(){var G=navigator.userAgentData;return G!=null&&G.brands&&Array.isArray(G.brands)?G.brands.map(function(E){return E.brand+"/"+E.version}).join(" "):navigator.userAgent}function zf(){return!/^((?!chrome|android).)*safari/i.test(Uf())}function Ka(G,E,k){E===void 0&&(E=!1),k===void 0&&(k=!1);var Q=G.getBoundingClientRect(),wt=1,Dt=1;E&&Wr(G)&&(wt=G.offsetWidth>0&&Yi(Q.width)/G.offsetWidth||1,Dt=G.offsetHeight>0&&Yi(Q.height)/G.offsetHeight||1);var Gt=(sr(G)?hi(G):window).visualViewport,qt=!zf()&&k,ie=(Q.left+(qt&&Gt?Gt.offsetLeft:0))/wt,fe=(Q.top+(qt&&Gt?Gt.offsetTop:0))/Dt,he=Q.width/wt,ce=Q.height/Dt;return{width:he,height:ce,top:fe,right:ie+he,bottom:fe+ce,left:ie,x:ie,y:fe}}function ql(G){var E=Ka(G),k=G.offsetWidth,Q=G.offsetHeight;return Math.abs(E.width-k)<=1&&(k=E.width),Math.abs(E.height-Q)<=1&&(Q=E.height),{x:G.offsetLeft,y:G.offsetTop,width:k,height:Q}}function wp(G,E){var k=E.getRootNode&&E.getRootNode();if(G.contains(E))return!0;if(k&&Qc(k)){var Q=E;do{if(Q&&G.isSameNode(Q))return!0;Q=Q.parentNode||Q.host}while(Q)}return!1}function qs(G){return hi(G).getComputedStyle(G)}function Jc(G){return["table","td","th"].indexOf(fi(G))>=0}function ys(G){return((sr(G)?G.ownerDocument:G.document)||window.document).documentElement}function $o(G){return fi(G)==="html"?G:G.assignedSlot||G.parentNode||(Qc(G)?G.host:null)||ys(G)}function Za(G){return Wr(G)&&qs(G).position!=="fixed"?G.offsetParent:null}function bs(G){for(var E=hi(G),k=Za(G);k&&Jc(k)&&qs(k).position==="static";)k=Za(k);return k&&(fi(k)==="html"||fi(k)==="body"&&qs(k).position==="static")?E:k||function(Q){var wt=/firefox/i.test(Uf());if(/Trident/i.test(Uf())&&Wr(Q)&&qs(Q).position==="fixed")return null;var Dt=$o(Q);for(Qc(Dt)&&(Dt=Dt.host);Wr(Dt)&&["html","body"].indexOf(fi(Dt))<0;){var Gt=qs(Dt);if(Gt.transform!=="none"||Gt.perspective!=="none"||Gt.contain==="paint"||["transform","perspective"].indexOf(Gt.willChange)!==-1||wt&&Gt.willChange==="filter"||wt&&Gt.filter&&Gt.filter!=="none")return Dt;Dt=Dt.parentNode}return null}(G)||E}function tu(G){return["top","bottom"].indexOf(G)>=0?"x":"y"}function Qa(G,E,k){return pa(G,Wl(E,k))}function jf(G){return Object.assign({},{top:0,right:0,bottom:0,left:0},G)}function Go(G,E){return E.reduce(function(k,Q){return k[Q]=G,k},{})}const ws={name:"arrow",enabled:!0,phase:"main",fn:function(G){var E,k=G.state,Q=G.name,wt=G.options,Dt=k.elements.arrow,Gt=k.modifiersData.popperOffsets,qt=kr(k.placement),ie=tu(qt),fe=[Wt,Lt].indexOf(qt)>=0?"height":"width";if(Dt&&Gt){var he=function(Le,Je){return jf(typeof(Le=typeof Le=="function"?Le(Object.assign({},Je.rects,{placement:Je.placement})):Le)!="number"?Le:Go(Le,le))}(wt.padding,k),ce=ql(Dt),Pe=ie==="y"?Et:Wt,we=ie==="y"?kt:Lt,Fe=k.rects.reference[fe]+k.rects.reference[ie]-Gt[ie]-k.rects.popper[fe],Ne=Gt[ie]-k.rects.reference[ie],Te=bs(Dt),on=Te?ie==="y"?Te.clientHeight||0:Te.clientWidth||0:0,pn=Fe/2-Ne/2,je=he[Pe],Qe=on-ce[fe]-he[we],ke=on/2-ce[fe]/2+pn,ue=Qa(je,ke,Qe),ve=ie;k.modifiersData[Q]=((E={})[ve]=ue,E.centerOffset=ue-ke,E)}},effect:function(G){var E=G.state,k=G.options.element,Q=k===void 0?"[data-popper-arrow]":k;Q!=null&&(typeof Q!="string"||(Q=E.elements.popper.querySelector(Q)))&&wp(E.elements.popper,Q)&&(E.elements.arrow=Q)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ma(G){return G.split("-")[1]}var Yl={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ys(G){var E,k=G.popper,Q=G.popperRect,wt=G.placement,Dt=G.variation,Gt=G.offsets,qt=G.position,ie=G.gpuAcceleration,fe=G.adaptive,he=G.roundOffsets,ce=G.isFixed,Pe=Gt.x,we=Pe===void 0?0:Pe,Fe=Gt.y,Ne=Fe===void 0?0:Fe,Te=typeof he=="function"?he({x:we,y:Ne}):{x:we,y:Ne};we=Te.x,Ne=Te.y;var on=Gt.hasOwnProperty("x"),pn=Gt.hasOwnProperty("y"),je=Wt,Qe=Et,ke=window;if(fe){var ue=bs(k),ve="clientHeight",Le="clientWidth";ue===hi(k)&&qs(ue=ys(k)).position!=="static"&&qt==="absolute"&&(ve="scrollHeight",Le="scrollWidth"),(wt===Et||(wt===Wt||wt===Lt)&&Dt===re)&&(Qe=kt,Ne-=(ce&&ue===ke&&ke.visualViewport?ke.visualViewport.height:ue[ve])-Q.height,Ne*=ie?1:-1),wt!==Wt&&(wt!==Et&&wt!==kt||Dt!==re)||(je=Lt,we-=(ce&&ue===ke&&ke.visualViewport?ke.visualViewport.width:ue[Le])-Q.width,we*=ie?1:-1)}var Je,bn=Object.assign({position:qt},fe&&Yl),Xn=he===!0?function(Kr,Kn){var vr=Kr.x,Mi=Kr.y,Ue=Kn.devicePixelRatio||1;return{x:Yi(vr*Ue)/Ue||0,y:Yi(Mi*Ue)/Ue||0}}({x:we,y:Ne},hi(k)):{x:we,y:Ne};return we=Xn.x,Ne=Xn.y,ie?Object.assign({},bn,((Je={})[Qe]=pn?"0":"",Je[je]=on?"0":"",Je.transform=(ke.devicePixelRatio||1)<=1?"translate("+we+"px, "+Ne+"px)":"translate3d("+we+"px, "+Ne+"px, 0)",Je)):Object.assign({},bn,((E={})[Qe]=pn?Ne+"px":"",E[je]=on?we+"px":"",E.transform="",E))}const Xl={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(G){var E=G.state,k=G.options,Q=k.gpuAcceleration,wt=Q===void 0||Q,Dt=k.adaptive,Gt=Dt===void 0||Dt,qt=k.roundOffsets,ie=qt===void 0||qt,fe={placement:kr(E.placement),variation:ma(E.placement),popper:E.elements.popper,popperRect:E.rects.popper,gpuAcceleration:wt,isFixed:E.options.strategy==="fixed"};E.modifiersData.popperOffsets!=null&&(E.styles.popper=Object.assign({},E.styles.popper,Ys(Object.assign({},fe,{offsets:E.modifiersData.popperOffsets,position:E.options.strategy,adaptive:Gt,roundOffsets:ie})))),E.modifiersData.arrow!=null&&(E.styles.arrow=Object.assign({},E.styles.arrow,Ys(Object.assign({},fe,{offsets:E.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:ie})))),E.attributes.popper=Object.assign({},E.attributes.popper,{"data-popper-placement":E.placement})},data:{}};var Ja={passive:!0};const eu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(G){var E=G.state,k=G.instance,Q=G.options,wt=Q.scroll,Dt=wt===void 0||wt,Gt=Q.resize,qt=Gt===void 0||Gt,ie=hi(E.elements.popper),fe=[].concat(E.scrollParents.reference,E.scrollParents.popper);return Dt&&fe.forEach(function(he){he.addEventListener("scroll",k.update,Ja)}),qt&&ie.addEventListener("resize",k.update,Ja),function(){Dt&&fe.forEach(function(he){he.removeEventListener("scroll",k.update,Ja)}),qt&&ie.removeEventListener("resize",k.update,Ja)}},data:{}};var nu={left:"right",right:"left",bottom:"top",top:"bottom"};function to(G){return G.replace(/left|right|bottom|top/g,function(E){return nu[E]})}var Ep={start:"end",end:"start"};function Lr(G){return G.replace(/start|end/g,function(E){return Ep[E]})}function Xs(G){var E=hi(G);return{scrollLeft:E.pageXOffset,scrollTop:E.pageYOffset}}function Vo(G){return Ka(ys(G)).left+Xs(G).scrollLeft}function eo(G){var E=qs(G),k=E.overflow,Q=E.overflowX,wt=E.overflowY;return/auto|scroll|overlay|hidden/.test(k+wt+Q)}function Ap(G){return["html","body","#document"].indexOf(fi(G))>=0?G.ownerDocument.body:Wr(G)&&eo(G)?G:Ap($o(G))}function no(G,E){var k;E===void 0&&(E=[]);var Q=Ap(G),wt=Q===((k=G.ownerDocument)==null?void 0:k.body),Dt=hi(Q),Gt=wt?[Dt].concat(Dt.visualViewport||[],eo(Q)?Q:[]):Q,qt=E.concat(Gt);return wt?qt:qt.concat(no($o(Gt)))}function Kl(G){return Object.assign({},G,{left:G.x,top:G.y,right:G.x+G.width,bottom:G.y+G.height})}function Wo(G,E,k){return E===sn?Kl(function(Q,wt){var Dt=hi(Q),Gt=ys(Q),qt=Dt.visualViewport,ie=Gt.clientWidth,fe=Gt.clientHeight,he=0,ce=0;if(qt){ie=qt.width,fe=qt.height;var Pe=zf();(Pe||!Pe&&wt==="fixed")&&(he=qt.offsetLeft,ce=qt.offsetTop)}return{width:ie,height:fe,x:he+Vo(Q),y:ce}}(G,k)):sr(E)?function(Q,wt){var Dt=Ka(Q,!1,wt==="fixed");return Dt.top=Dt.top+Q.clientTop,Dt.left=Dt.left+Q.clientLeft,Dt.bottom=Dt.top+Q.clientHeight,Dt.right=Dt.left+Q.clientWidth,Dt.width=Q.clientWidth,Dt.height=Q.clientHeight,Dt.x=Dt.left,Dt.y=Dt.top,Dt}(E,k):Kl(function(Q){var wt,Dt=ys(Q),Gt=Xs(Q),qt=(wt=Q.ownerDocument)==null?void 0:wt.body,ie=pa(Dt.scrollWidth,Dt.clientWidth,qt?qt.scrollWidth:0,qt?qt.clientWidth:0),fe=pa(Dt.scrollHeight,Dt.clientHeight,qt?qt.scrollHeight:0,qt?qt.clientHeight:0),he=-Gt.scrollLeft+Vo(Q),ce=-Gt.scrollTop;return qs(qt||Dt).direction==="rtl"&&(he+=pa(Dt.clientWidth,qt?qt.clientWidth:0)-ie),{width:ie,height:fe,x:he,y:ce}}(ys(G)))}function Zl(G){var E,k=G.reference,Q=G.element,wt=G.placement,Dt=wt?kr(wt):null,Gt=wt?ma(wt):null,qt=k.x+k.width/2-Q.width/2,ie=k.y+k.height/2-Q.height/2;switch(Dt){case Et:E={x:qt,y:k.y-Q.height};break;case kt:E={x:qt,y:k.y+k.height};break;case Lt:E={x:k.x+k.width,y:ie};break;case Wt:E={x:k.x-Q.width,y:ie};break;default:E={x:k.x,y:k.y}}var fe=Dt?tu(Dt):null;if(fe!=null){var he=fe==="y"?"height":"width";switch(Gt){case Qt:E[fe]=E[fe]-(k[he]/2-Q[he]/2);break;case re:E[fe]=E[fe]+(k[he]/2-Q[he]/2)}}return E}function ro(G,E){E===void 0&&(E={});var k=E,Q=k.placement,wt=Q===void 0?G.placement:Q,Dt=k.strategy,Gt=Dt===void 0?G.strategy:Dt,qt=k.boundary,ie=qt===void 0?Ie:qt,fe=k.rootBoundary,he=fe===void 0?sn:fe,ce=k.elementContext,Pe=ce===void 0?Ze:ce,we=k.altBoundary,Fe=we!==void 0&&we,Ne=k.padding,Te=Ne===void 0?0:Ne,on=jf(typeof Te!="number"?Te:Go(Te,le)),pn=Pe===Ze?dn:Ze,je=G.rects.popper,Qe=G.elements[Fe?pn:Pe],ke=function(Kn,vr,Mi,Ue){var Pi=vr==="clippingParents"?function(mn){var _r=no($o(mn)),Zr=["absolute","fixed"].indexOf(qs(mn).position)>=0&&Wr(mn)?bs(mn):mn;return sr(Zr)?_r.filter(function(Ts){return sr(Ts)&&wp(Ts,Zr)&&fi(Ts)!=="body"}):[]}(Kn):[].concat(vr),Fi=[].concat(Pi,[Mi]),xo=Fi[0],Zn=Fi.reduce(function(mn,_r){var Zr=Wo(Kn,_r,Ue);return mn.top=pa(Zr.top,mn.top),mn.right=Wl(Zr.right,mn.right),mn.bottom=Wl(Zr.bottom,mn.bottom),mn.left=pa(Zr.left,mn.left),mn},Wo(Kn,xo,Ue));return Zn.width=Zn.right-Zn.left,Zn.height=Zn.bottom-Zn.top,Zn.x=Zn.left,Zn.y=Zn.top,Zn}(sr(Qe)?Qe:Qe.contextElement||ys(G.elements.popper),ie,he,Gt),ue=Ka(G.elements.reference),ve=Zl({reference:ue,element:je,placement:wt}),Le=Kl(Object.assign({},je,ve)),Je=Pe===Ze?Le:ue,bn={top:ke.top-Je.top+on.top,bottom:Je.bottom-ke.bottom+on.bottom,left:ke.left-Je.left+on.left,right:Je.right-ke.right+on.right},Xn=G.modifiersData.offset;if(Pe===Ze&&Xn){var Kr=Xn[wt];Object.keys(bn).forEach(function(Kn){var vr=[Lt,kt].indexOf(Kn)>=0?1:-1,Mi=[Et,kt].indexOf(Kn)>=0?"y":"x";bn[Kn]+=Kr[Mi]*vr})}return bn}function _v(G,E){E===void 0&&(E={});var k=E,Q=k.placement,wt=k.boundary,Dt=k.rootBoundary,Gt=k.padding,qt=k.flipVariations,ie=k.allowedAutoPlacements,fe=ie===void 0?xs:ie,he=ma(Q),ce=he?qt?qi:qi.filter(function(Fe){return ma(Fe)===he}):le,Pe=ce.filter(function(Fe){return fe.indexOf(Fe)>=0});Pe.length===0&&(Pe=ce);var we=Pe.reduce(function(Fe,Ne){return Fe[Ne]=ro(G,{placement:Ne,boundary:wt,rootBoundary:Dt,padding:Gt})[kr(Ne)],Fe},{});return Object.keys(we).sort(function(Fe,Ne){return we[Fe]-we[Ne]})}const Sp={name:"flip",enabled:!0,phase:"main",fn:function(G){var E=G.state,k=G.options,Q=G.name;if(!E.modifiersData[Q]._skip){for(var wt=k.mainAxis,Dt=wt===void 0||wt,Gt=k.altAxis,qt=Gt===void 0||Gt,ie=k.fallbackPlacements,fe=k.padding,he=k.boundary,ce=k.rootBoundary,Pe=k.altBoundary,we=k.flipVariations,Fe=we===void 0||we,Ne=k.allowedAutoPlacements,Te=E.options.placement,on=kr(Te),pn=ie||(on!==Te&&Fe?function(mn){if(kr(mn)===ee)return[];var _r=to(mn);return[Lr(mn),_r,Lr(_r)]}(Te):[to(Te)]),je=[Te].concat(pn).reduce(function(mn,_r){return mn.concat(kr(_r)===ee?_v(E,{placement:_r,boundary:he,rootBoundary:ce,padding:fe,flipVariations:Fe,allowedAutoPlacements:Ne}):_r)},[]),Qe=E.rects.reference,ke=E.rects.popper,ue=new Map,ve=!0,Le=je[0],Je=0;Je<je.length;Je++){var bn=je[Je],Xn=kr(bn),Kr=ma(bn)===Qt,Kn=[Et,kt].indexOf(Xn)>=0,vr=Kn?"width":"height",Mi=ro(E,{placement:bn,boundary:he,rootBoundary:ce,altBoundary:Pe,padding:fe}),Ue=Kn?Kr?Lt:Wt:Kr?kt:Et;Qe[vr]>ke[vr]&&(Ue=to(Ue));var Pi=to(Ue),Fi=[];if(Dt&&Fi.push(Mi[Xn]<=0),qt&&Fi.push(Mi[Ue]<=0,Mi[Pi]<=0),Fi.every(function(mn){return mn})){Le=bn,ve=!1;break}ue.set(bn,Fi)}if(ve)for(var xo=function(mn){var _r=je.find(function(Zr){var Ts=ue.get(Zr);if(Ts)return Ts.slice(0,mn).every(function(xr){return xr})});if(_r)return Le=_r,"break"},Zn=Fe?3:1;Zn>0&&xo(Zn)!=="break";Zn--);E.placement!==Le&&(E.modifiersData[Q]._skip=!0,E.placement=Le,E.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Tp(G,E,k){return k===void 0&&(k={x:0,y:0}),{top:G.top-E.height-k.y,right:G.right-E.width+k.x,bottom:G.bottom-E.height+k.y,left:G.left-E.width-k.x}}function ru(G){return[Et,Lt,kt,Wt].some(function(E){return G[E]>=0})}const Cp={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(G){var E=G.state,k=G.name,Q=E.rects.reference,wt=E.rects.popper,Dt=E.modifiersData.preventOverflow,Gt=ro(E,{elementContext:"reference"}),qt=ro(E,{altBoundary:!0}),ie=Tp(Gt,Q),fe=Tp(qt,wt,Dt),he=ru(ie),ce=ru(fe);E.modifiersData[k]={referenceClippingOffsets:ie,popperEscapeOffsets:fe,isReferenceHidden:he,hasPopperEscaped:ce},E.attributes.popper=Object.assign({},E.attributes.popper,{"data-popper-reference-hidden":he,"data-popper-escaped":ce})}},Dp={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(G){var E=G.state,k=G.options,Q=G.name,wt=k.offset,Dt=wt===void 0?[0,0]:wt,Gt=xs.reduce(function(he,ce){return he[ce]=function(Pe,we,Fe){var Ne=kr(Pe),Te=[Wt,Et].indexOf(Ne)>=0?-1:1,on=typeof Fe=="function"?Fe(Object.assign({},we,{placement:Pe})):Fe,pn=on[0],je=on[1];return pn=pn||0,je=(je||0)*Te,[Wt,Lt].indexOf(Ne)>=0?{x:je,y:pn}:{x:pn,y:je}}(ce,E.rects,Dt),he},{}),qt=Gt[E.placement],ie=qt.x,fe=qt.y;E.modifiersData.popperOffsets!=null&&(E.modifiersData.popperOffsets.x+=ie,E.modifiersData.popperOffsets.y+=fe),E.modifiersData[Q]=Gt}},Hf={name:"popperOffsets",enabled:!0,phase:"read",fn:function(G){var E=G.state,k=G.name;E.modifiersData[k]=Zl({reference:E.rects.reference,element:E.rects.popper,placement:E.placement})},data:{}},Op={name:"preventOverflow",enabled:!0,phase:"main",fn:function(G){var E=G.state,k=G.options,Q=G.name,wt=k.mainAxis,Dt=wt===void 0||wt,Gt=k.altAxis,qt=Gt!==void 0&&Gt,ie=k.boundary,fe=k.rootBoundary,he=k.altBoundary,ce=k.padding,Pe=k.tether,we=Pe===void 0||Pe,Fe=k.tetherOffset,Ne=Fe===void 0?0:Fe,Te=ro(E,{boundary:ie,rootBoundary:fe,padding:ce,altBoundary:he}),on=kr(E.placement),pn=ma(E.placement),je=!pn,Qe=tu(on),ke=Qe==="x"?"y":"x",ue=E.modifiersData.popperOffsets,ve=E.rects.reference,Le=E.rects.popper,Je=typeof Ne=="function"?Ne(Object.assign({},E.rects,{placement:E.placement})):Ne,bn=typeof Je=="number"?{mainAxis:Je,altAxis:Je}:Object.assign({mainAxis:0,altAxis:0},Je),Xn=E.modifiersData.offset?E.modifiersData.offset[E.placement]:null,Kr={x:0,y:0};if(ue){if(Dt){var Kn,vr=Qe==="y"?Et:Wt,Mi=Qe==="y"?kt:Lt,Ue=Qe==="y"?"height":"width",Pi=ue[Qe],Fi=Pi+Te[vr],xo=Pi-Te[Mi],Zn=we?-Le[Ue]/2:0,mn=pn===Qt?ve[Ue]:Le[Ue],_r=pn===Qt?-Le[Ue]:-ve[Ue],Zr=E.elements.arrow,Ts=we&&Zr?ql(Zr):{width:0,height:0},xr=E.modifiersData["arrow#persistent"]?E.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},jn=xr[vr],du=xr[Mi],Aa=Qa(0,ve[Ue],Ts[Ue]),pu=je?ve[Ue]/2-Zn-Aa-jn-bn.mainAxis:mn-Aa-jn-bn.mainAxis,xh=je?-ve[Ue]/2+Zn+Aa+du+bn.mainAxis:_r+Aa+du+bn.mainAxis,Zi=E.elements.arrow&&bs(E.elements.arrow),mu=Zi?Qe==="y"?Zi.clientTop||0:Zi.clientLeft||0:0,gu=(Kn=Xn?.[Qe])!=null?Kn:0,yh=Pi+xh-gu,bh=Qa(we?Wl(Fi,Pi+pu-gu-mu):Fi,Pi,we?pa(xo,yh):xo);ue[Qe]=bh,Kr[Qe]=bh-Pi}if(qt){var wh,f0=Qe==="x"?Et:Wt,h0=Qe==="x"?kt:Lt,Sa=ue[ke],oc=ke==="y"?"height":"width",vu=Sa+Te[f0],Eh=Sa-Te[h0],Ah=[Et,Wt].indexOf(on)!==-1,Sh=(wh=Xn?.[ke])!=null?wh:0,Th=Ah?vu:Sa-ve[oc]-Le[oc]-Sh+bn.altAxis,Ch=Ah?Sa+ve[oc]+Le[oc]-Sh-bn.altAxis:Eh,_u=we&&Ah?function(d0,p0,xu){var Dh=Qa(d0,p0,xu);return Dh>xu?xu:Dh}(Th,Sa,Ch):Qa(we?Th:vu,Sa,we?Ch:Eh);ue[ke]=_u,Kr[ke]=_u-Sa}E.modifiersData[Q]=Kr}},requiresIfExists:["offset"]};function xv(G,E,k){k===void 0&&(k=!1);var Q,wt,Dt=Wr(E),Gt=Wr(E)&&function(ce){var Pe=ce.getBoundingClientRect(),we=Yi(Pe.width)/ce.offsetWidth||1,Fe=Yi(Pe.height)/ce.offsetHeight||1;return we!==1||Fe!==1}(E),qt=ys(E),ie=Ka(G,Gt,k),fe={scrollLeft:0,scrollTop:0},he={x:0,y:0};return(Dt||!Dt&&!k)&&((fi(E)!=="body"||eo(qt))&&(fe=(Q=E)!==hi(Q)&&Wr(Q)?{scrollLeft:(wt=Q).scrollLeft,scrollTop:wt.scrollTop}:Xs(Q)),Wr(E)?((he=Ka(E,!0)).x+=E.clientLeft,he.y+=E.clientTop):qt&&(he.x=Vo(qt))),{x:ie.left+fe.scrollLeft-he.x,y:ie.top+fe.scrollTop-he.y,width:ie.width,height:ie.height}}function Rp(G){var E=new Map,k=new Set,Q=[];function wt(Dt){k.add(Dt.name),[].concat(Dt.requires||[],Dt.requiresIfExists||[]).forEach(function(Gt){if(!k.has(Gt)){var qt=E.get(Gt);qt&&wt(qt)}}),Q.push(Dt)}return G.forEach(function(Dt){E.set(Dt.name,Dt)}),G.forEach(function(Dt){k.has(Dt.name)||wt(Dt)}),Q}var Np={placement:"bottom",modifiers:[],strategy:"absolute"};function kp(){for(var G=arguments.length,E=new Array(G),k=0;k<G;k++)E[k]=arguments[k];return!E.some(function(Q){return!(Q&&typeof Q.getBoundingClientRect=="function")})}function iu(G){G===void 0&&(G={});var E=G,k=E.defaultModifiers,Q=k===void 0?[]:k,wt=E.defaultOptions,Dt=wt===void 0?Np:wt;return function(Gt,qt,ie){ie===void 0&&(ie=Dt);var fe,he,ce={placement:"bottom",orderedModifiers:[],options:Object.assign({},Np,Dt),modifiersData:{},elements:{reference:Gt,popper:qt},attributes:{},styles:{}},Pe=[],we=!1,Fe={state:ce,setOptions:function(Te){var on=typeof Te=="function"?Te(ce.options):Te;Ne(),ce.options=Object.assign({},Dt,ce.options,on),ce.scrollParents={reference:sr(Gt)?no(Gt):Gt.contextElement?no(Gt.contextElement):[],popper:no(qt)};var pn,je,Qe=function(ke){var ue=Rp(ke);return Bf.reduce(function(ve,Le){return ve.concat(ue.filter(function(Je){return Je.phase===Le}))},[])}((pn=[].concat(Q,ce.options.modifiers),je=pn.reduce(function(ke,ue){var ve=ke[ue.name];return ke[ue.name]=ve?Object.assign({},ve,ue,{options:Object.assign({},ve.options,ue.options),data:Object.assign({},ve.data,ue.data)}):ue,ke},{}),Object.keys(je).map(function(ke){return je[ke]})));return ce.orderedModifiers=Qe.filter(function(ke){return ke.enabled}),ce.orderedModifiers.forEach(function(ke){var ue=ke.name,ve=ke.options,Le=ve===void 0?{}:ve,Je=ke.effect;if(typeof Je=="function"){var bn=Je({state:ce,name:ue,instance:Fe,options:Le});Pe.push(bn||function(){})}}),Fe.update()},forceUpdate:function(){if(!we){var Te=ce.elements,on=Te.reference,pn=Te.popper;if(kp(on,pn)){ce.rects={reference:xv(on,bs(pn),ce.options.strategy==="fixed"),popper:ql(pn)},ce.reset=!1,ce.placement=ce.options.placement,ce.orderedModifiers.forEach(function(Je){return ce.modifiersData[Je.name]=Object.assign({},Je.data)});for(var je=0;je<ce.orderedModifiers.length;je++)if(ce.reset!==!0){var Qe=ce.orderedModifiers[je],ke=Qe.fn,ue=Qe.options,ve=ue===void 0?{}:ue,Le=Qe.name;typeof ke=="function"&&(ce=ke({state:ce,options:ve,name:Le,instance:Fe})||ce)}else ce.reset=!1,je=-1}}},update:(fe=function(){return new Promise(function(Te){Fe.forceUpdate(),Te(ce)})},function(){return he||(he=new Promise(function(Te){Promise.resolve().then(function(){he=void 0,Te(fe())})})),he}),destroy:function(){Ne(),we=!0}};if(!kp(Gt,qt))return Fe;function Ne(){Pe.forEach(function(Te){return Te()}),Pe=[]}return Fe.setOptions(ie).then(function(Te){!we&&ie.onFirstUpdate&&ie.onFirstUpdate(Te)}),Fe}}var yv=iu(),$f=iu({defaultModifiers:[eu,Hf,Xl,Vl]}),Gf=iu({defaultModifiers:[eu,Hf,Xl,Vl,Dp,Sp,Op,ws,Cp]});const Lp=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ui,afterRead:da,afterWrite:Gl,applyStyles:Vl,arrow:ws,auto:ee,basePlacements:le,beforeMain:Ni,beforeRead:ci,beforeWrite:Ff,bottom:kt,clippingParents:Ie,computeStyles:Xl,createPopper:Gf,createPopperBase:yv,createPopperLite:$f,detectOverflow:ro,end:re,eventListeners:eu,flip:Sp,hide:Cp,left:Wt,main:Pf,modifierPhases:Bf,offset:Dp,placements:xs,popper:Ze,popperGenerator:iu,popperOffsets:Hf,preventOverflow:Op,read:Ri,reference:dn,right:Lt,start:Qt,top:Et,variationPlacements:qi,viewport:sn,write:bp},Symbol.toStringTag,{value:"Module"})),Ip="dropdown",ga=".bs.dropdown",Vf=".data-api",bv="ArrowUp",Mp="ArrowDown",wv=`hide${ga}`,Ev=`hidden${ga}`,Av=`show${ga}`,Sv=`shown${ga}`,Pp=`click${ga}${Vf}`,Fp=`keydown${ga}${Vf}`,Wf=`keyup${ga}${Vf}`,Es="show",io='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Bp=`${io}.${Es}`,Ql=".dropdown-menu",Up=y()?"top-end":"top-start",zp=y()?"top-start":"top-end",jp=y()?"bottom-end":"bottom-start",qo=y()?"bottom-start":"bottom-end",Tv=y()?"left-start":"right-start",Cv=y()?"right-start":"left-start",Dv={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Hp={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ki extends Nt{constructor(E,k){super(E,k),this._popper=null,this._parent=this._element.parentNode,this._menu=z.next(this._element,Ql)[0]||z.prev(this._element,Ql)[0]||z.findOne(Ql,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Dv}static get DefaultType(){return Hp}static get NAME(){return Ip}toggle(){return this._isShown()?this.hide():this.show()}show(){if(d(this._element)||this._isShown())return;const E={relatedTarget:this._element};if(!P.trigger(this._element,Av,E).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const k of[].concat(...document.body.children))P.on(k,"mouseover",m);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Es),this._element.classList.add(Es),P.trigger(this._element,Sv,E)}}hide(){if(d(this._element)||!this._isShown())return;const E={relatedTarget:this._element};this._completeHide(E)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(E){if(!P.trigger(this._element,wv,E).defaultPrevented){if("ontouchstart"in document.documentElement)for(const k of[].concat(...document.body.children))P.off(k,"mouseover",m);this._popper&&this._popper.destroy(),this._menu.classList.remove(Es),this._element.classList.remove(Es),this._element.setAttribute("aria-expanded","false"),dt.removeDataAttribute(this._menu,"popper"),P.trigger(this._element,Ev,E),this._element.focus()}}_getConfig(E){if(typeof(E=super._getConfig(E)).reference=="object"&&!l(E.reference)&&typeof E.reference.getBoundingClientRect!="function")throw new TypeError(`${Ip.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return E}_createPopper(){if(Lp===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let E=this._element;this._config.reference==="parent"?E=this._parent:l(this._config.reference)?E=u(this._config.reference):typeof this._config.reference=="object"&&(E=this._config.reference);const k=this._getPopperConfig();this._popper=Gf(E,this._menu,k)}_isShown(){return this._menu.classList.contains(Es)}_getPlacement(){const E=this._parent;if(E.classList.contains("dropend"))return Tv;if(E.classList.contains("dropstart"))return Cv;if(E.classList.contains("dropup-center"))return"top";if(E.classList.contains("dropdown-center"))return"bottom";const k=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return E.classList.contains("dropup")?k?zp:Up:k?qo:jp}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:E}=this._config;return typeof E=="string"?E.split(",").map(k=>Number.parseInt(k,10)):typeof E=="function"?k=>E(k,this._element):E}_getPopperConfig(){const E={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(dt.setDataAttribute(this._menu,"popper","static"),E.modifiers=[{name:"applyStyles",enabled:!1}]),{...E,...S(this._config.popperConfig,[void 0,E])}}_selectMenuItem({key:E,target:k}){const Q=z.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(wt=>f(wt));Q.length&&C(Q,k,E===Mp,!Q.includes(k)).focus()}static jQueryInterface(E){return this.each(function(){const k=ki.getOrCreateInstance(this,E);if(typeof E=="string"){if(k[E]===void 0)throw new TypeError(`No method named "${E}"`);k[E]()}})}static clearMenus(E){if(E.button===2||E.type==="keyup"&&E.key!=="Tab")return;const k=z.find(Bp);for(const Q of k){const wt=ki.getInstance(Q);if(!wt||wt._config.autoClose===!1)continue;const Dt=E.composedPath(),Gt=Dt.includes(wt._menu);if(Dt.includes(wt._element)||wt._config.autoClose==="inside"&&!Gt||wt._config.autoClose==="outside"&&Gt||wt._menu.contains(E.target)&&(E.type==="keyup"&&E.key==="Tab"||/input|select|option|textarea|form/i.test(E.target.tagName)))continue;const qt={relatedTarget:wt._element};E.type==="click"&&(qt.clickEvent=E),wt._completeHide(qt)}}static dataApiKeydownHandler(E){const k=/input|textarea/i.test(E.target.tagName),Q=E.key==="Escape",wt=[bv,Mp].includes(E.key);if(!wt&&!Q||k&&!Q)return;E.preventDefault();const Dt=this.matches(io)?this:z.prev(this,io)[0]||z.next(this,io)[0]||z.findOne(io,E.delegateTarget.parentNode),Gt=ki.getOrCreateInstance(Dt);if(wt)return E.stopPropagation(),Gt.show(),void Gt._selectMenuItem(E);Gt._isShown()&&(E.stopPropagation(),Gt.hide(),Dt.focus())}}P.on(document,Fp,io,ki.dataApiKeydownHandler),P.on(document,Fp,Ql,ki.dataApiKeydownHandler),P.on(document,Pp,ki.clearMenus),P.on(document,Wf,ki.clearMenus),P.on(document,Pp,io,function(G){G.preventDefault(),ki.getOrCreateInstance(this).toggle()}),w(ki);const Yo="backdrop",Xo="show",$p=`mousedown.bs.${Yo}`,su={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Gp={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class qf extends xt{constructor(E){super(),this._config=this._getConfig(E),this._isAppended=!1,this._element=null}static get Default(){return su}static get DefaultType(){return Gp}static get NAME(){return Yo}show(E){if(!this._config.isVisible)return void S(E);this._append();const k=this._getElement();this._config.isAnimated&&v(k),k.classList.add(Xo),this._emulateAnimation(()=>{S(E)})}hide(E){this._config.isVisible?(this._getElement().classList.remove(Xo),this._emulateAnimation(()=>{this.dispose(),S(E)})):S(E)}dispose(){this._isAppended&&(P.off(this._element,$p),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const E=document.createElement("div");E.className=this._config.className,this._config.isAnimated&&E.classList.add("fade"),this._element=E}return this._element}_configAfterMerge(E){return E.rootElement=u(E.rootElement),E}_append(){if(this._isAppended)return;const E=this._getElement();this._config.rootElement.append(E),P.on(E,$p,()=>{S(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(E){T(E,this._getElement(),this._config.isAnimated)}}const Ko=".bs.focustrap",Yf=`focusin${Ko}`,Vp=`keydown.tab${Ko}`,Xf="backward",Wp={autofocus:!0,trapElement:null},Ov={autofocus:"boolean",trapElement:"element"};class qp extends xt{constructor(E){super(),this._config=this._getConfig(E),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Wp}static get DefaultType(){return Ov}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),P.off(document,Ko),P.on(document,Yf,E=>this._handleFocusin(E)),P.on(document,Vp,E=>this._handleKeydown(E)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,P.off(document,Ko))}_handleFocusin(E){const{trapElement:k}=this._config;if(E.target===document||E.target===k||k.contains(E.target))return;const Q=z.focusableChildren(k);Q.length===0?k.focus():this._lastTabNavDirection===Xf?Q[Q.length-1].focus():Q[0].focus()}_handleKeydown(E){E.key==="Tab"&&(this._lastTabNavDirection=E.shiftKey?Xf:"forward")}}const Yp=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Xp=".sticky-top",au="padding-right",qr="margin-right";class so{constructor(){this._element=document.body}getWidth(){const E=document.documentElement.clientWidth;return Math.abs(window.innerWidth-E)}hide(){const E=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,au,k=>k+E),this._setElementAttributes(Yp,au,k=>k+E),this._setElementAttributes(Xp,qr,k=>k-E)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,au),this._resetElementAttributes(Yp,au),this._resetElementAttributes(Xp,qr)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(E,k,Q){const wt=this.getWidth();this._applyManipulationCallback(E,Dt=>{if(Dt!==this._element&&window.innerWidth>Dt.clientWidth+wt)return;this._saveInitialAttribute(Dt,k);const Gt=window.getComputedStyle(Dt).getPropertyValue(k);Dt.style.setProperty(k,`${Q(Number.parseFloat(Gt))}px`)})}_saveInitialAttribute(E,k){const Q=E.style.getPropertyValue(k);Q&&dt.setDataAttribute(E,k,Q)}_resetElementAttributes(E,k){this._applyManipulationCallback(E,Q=>{const wt=dt.getDataAttribute(Q,k);wt!==null?(dt.removeDataAttribute(Q,k),Q.style.setProperty(k,wt)):Q.style.removeProperty(k)})}_applyManipulationCallback(E,k){if(l(E))k(E);else for(const Q of z.find(E,this._element))k(Q)}}const di=".bs.modal",Kp=`hide${di}`,Zp=`hidePrevented${di}`,Kf=`hidden${di}`,ou=`show${di}`,Rv=`shown${di}`,Zo=`resize${di}`,Zf=`click.dismiss${di}`,Jl=`mousedown.dismiss${di}`,Qf=`keydown.dismiss${di}`,Qp=`click${di}.data-api`,va="modal-open",ao="show",tc="modal-static",Jp={backdrop:!0,focus:!0,keyboard:!0},oo={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class _a extends Nt{constructor(E,k){super(E,k),this._dialog=z.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new so,this._addEventListeners()}static get Default(){return Jp}static get DefaultType(){return oo}static get NAME(){return"modal"}toggle(E){return this._isShown?this.hide():this.show(E)}show(E){this._isShown||this._isTransitioning||P.trigger(this._element,ou,{relatedTarget:E}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(va),this._adjustDialog(),this._backdrop.show(()=>this._showElement(E)))}hide(){this._isShown&&!this._isTransitioning&&(P.trigger(this._element,Kp).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(ao),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){P.off(window,di),P.off(this._dialog,di),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new qf({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new qp({trapElement:this._element})}_showElement(E){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const k=z.findOne(".modal-body",this._dialog);k&&(k.scrollTop=0),v(this._element),this._element.classList.add(ao),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,P.trigger(this._element,Rv,{relatedTarget:E})},this._dialog,this._isAnimated())}_addEventListeners(){P.on(this._element,Qf,E=>{E.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),P.on(window,Zo,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),P.on(this._element,Jl,E=>{P.one(this._element,Zf,k=>{this._element===E.target&&this._element===k.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(va),this._resetAdjustments(),this._scrollBar.reset(),P.trigger(this._element,Kf)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(P.trigger(this._element,Zp).defaultPrevented)return;const E=this._element.scrollHeight>document.documentElement.clientHeight,k=this._element.style.overflowY;k==="hidden"||this._element.classList.contains(tc)||(E||(this._element.style.overflowY="hidden"),this._element.classList.add(tc),this._queueCallback(()=>{this._element.classList.remove(tc),this._queueCallback(()=>{this._element.style.overflowY=k},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const E=this._element.scrollHeight>document.documentElement.clientHeight,k=this._scrollBar.getWidth(),Q=k>0;if(Q&&!E){const wt=y()?"paddingLeft":"paddingRight";this._element.style[wt]=`${k}px`}if(!Q&&E){const wt=y()?"paddingRight":"paddingLeft";this._element.style[wt]=`${k}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(E,k){return this.each(function(){const Q=_a.getOrCreateInstance(this,E);if(typeof E=="string"){if(Q[E]===void 0)throw new TypeError(`No method named "${E}"`);Q[E](k)}})}}P.on(document,Qp,'[data-bs-toggle="modal"]',function(G){const E=z.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&G.preventDefault(),P.one(E,ou,Q=>{Q.defaultPrevented||P.one(E,Kf,()=>{f(this)&&this.focus()})});const k=z.findOne(".modal.show");k&&_a.getInstance(k).hide(),_a.getOrCreateInstance(E).toggle(this)}),lt(_a),w(_a);const As=".bs.offcanvas",Jf=".data-api",Nv=`load${As}${Jf}`,t0="show",e0="showing",th="hiding",eh=".offcanvas.show",nh=`show${As}`,Xi=`shown${As}`,n0=`hide${As}`,pi=`hidePrevented${As}`,mi=`hidden${As}`,Qo=`resize${As}`,rh=`click${As}${Jf}`,lu=`keydown.dismiss${As}`,cu={backdrop:!0,keyboard:!0,scroll:!1},ih={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Yr extends Nt{constructor(E,k){super(E,k),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return cu}static get DefaultType(){return ih}static get NAME(){return"offcanvas"}toggle(E){return this._isShown?this.hide():this.show(E)}show(E){this._isShown||P.trigger(this._element,nh,{relatedTarget:E}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new so().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(e0),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(t0),this._element.classList.remove(e0),P.trigger(this._element,Xi,{relatedTarget:E})},this._element,!0))}hide(){this._isShown&&(P.trigger(this._element,n0).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(th),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(t0,th),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new so().reset(),P.trigger(this._element,mi)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const E=!!this._config.backdrop;return new qf({className:"offcanvas-backdrop",isVisible:E,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:E?()=>{this._config.backdrop!=="static"?this.hide():P.trigger(this._element,pi)}:null})}_initializeFocusTrap(){return new qp({trapElement:this._element})}_addEventListeners(){P.on(this._element,lu,E=>{E.key==="Escape"&&(this._config.keyboard?this.hide():P.trigger(this._element,pi))})}static jQueryInterface(E){return this.each(function(){const k=Yr.getOrCreateInstance(this,E);if(typeof E=="string"){if(k[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);k[E](this)}})}}P.on(document,rh,'[data-bs-toggle="offcanvas"]',function(G){const E=z.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&G.preventDefault(),d(this))return;P.one(E,mi,()=>{f(this)&&this.focus()});const k=z.findOne(eh);k&&k!==E&&Yr.getInstance(k).hide(),Yr.getOrCreateInstance(E).toggle(this)}),P.on(window,Nv,()=>{for(const G of z.find(eh))Yr.getOrCreateInstance(G).show()}),P.on(window,Qo,()=>{for(const G of z.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(G).position!=="fixed"&&Yr.getOrCreateInstance(G).hide()}),lt(Yr),w(Yr);const sh={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},uu=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Jo=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,kv=(G,E)=>{const k=G.nodeName.toLowerCase();return E.includes(k)?!uu.has(k)||!!Jo.test(G.nodeValue):E.filter(Q=>Q instanceof RegExp).some(Q=>Q.test(k))},gi={allowList:sh,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},ah={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Ks={entry:"(string|element|function|null)",selector:"(string|element)"};class r0 extends xt{constructor(E){super(),this._config=this._getConfig(E)}static get Default(){return gi}static get DefaultType(){return ah}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(E=>this._resolvePossibleFunction(E)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(E){return this._checkContent(E),this._config.content={...this._config.content,...E},this}toHtml(){const E=document.createElement("div");E.innerHTML=this._maybeSanitize(this._config.template);for(const[wt,Dt]of Object.entries(this._config.content))this._setContent(E,Dt,wt);const k=E.children[0],Q=this._resolvePossibleFunction(this._config.extraClass);return Q&&k.classList.add(...Q.split(" ")),k}_typeCheckConfig(E){super._typeCheckConfig(E),this._checkContent(E.content)}_checkContent(E){for(const[k,Q]of Object.entries(E))super._typeCheckConfig({selector:k,entry:Q},Ks)}_setContent(E,k,Q){const wt=z.findOne(Q,E);wt&&((k=this._resolvePossibleFunction(k))?l(k)?this._putElementInTemplate(u(k),wt):this._config.html?wt.innerHTML=this._maybeSanitize(k):wt.textContent=k:wt.remove())}_maybeSanitize(E){return this._config.sanitize?function(k,Q,wt){if(!k.length)return k;if(wt&&typeof wt=="function")return wt(k);const Dt=new window.DOMParser().parseFromString(k,"text/html"),Gt=[].concat(...Dt.body.querySelectorAll("*"));for(const qt of Gt){const ie=qt.nodeName.toLowerCase();if(!Object.keys(Q).includes(ie)){qt.remove();continue}const fe=[].concat(...qt.attributes),he=[].concat(Q["*"]||[],Q[ie]||[]);for(const ce of fe)kv(ce,he)||qt.removeAttribute(ce.nodeName)}return Dt.body.innerHTML}(E,this._config.allowList,this._config.sanitizeFn):E}_resolvePossibleFunction(E){return S(E,[void 0,this])}_putElementInTemplate(E,k){if(this._config.html)return k.innerHTML="",void k.append(E);k.textContent=E.textContent}}const fu=new Set(["sanitize","allowList","sanitizeFn"]),Zs="fade",tl="show",oh=".tooltip-inner",lo=".modal",co="hide.bs.modal",xa="hover",el="focus",Xr="click",Li={AUTO:"auto",TOP:"top",RIGHT:y()?"left":"right",BOTTOM:"bottom",LEFT:y()?"right":"left"},uo={allowList:sh,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Qs={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Ir extends Nt{constructor(E,k){if(Lp===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(E,k),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return uo}static get DefaultType(){return Qs}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),P.off(this._element.closest(lo),co,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const E=P.trigger(this._element,this.constructor.eventName("show")),k=(p(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(E.defaultPrevented||!k)return;this._disposePopper();const Q=this._getTipElement();this._element.setAttribute("aria-describedby",Q.getAttribute("id"));const{container:wt}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(wt.append(Q),P.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(Q),Q.classList.add(tl),"ontouchstart"in document.documentElement)for(const Dt of[].concat(...document.body.children))P.on(Dt,"mouseover",m);this._queueCallback(()=>{P.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!P.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(tl),"ontouchstart"in document.documentElement)for(const E of[].concat(...document.body.children))P.off(E,"mouseover",m);this._activeTrigger[Xr]=!1,this._activeTrigger[el]=!1,this._activeTrigger[xa]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),P.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(E){const k=this._getTemplateFactory(E).toHtml();if(!k)return null;k.classList.remove(Zs,tl),k.classList.add(`bs-${this.constructor.NAME}-auto`);const Q=(wt=>{do wt+=Math.floor(1e6*Math.random());while(document.getElementById(wt));return wt})(this.constructor.NAME).toString();return k.setAttribute("id",Q),this._isAnimated()&&k.classList.add(Zs),k}setContent(E){this._newContent=E,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(E){return this._templateFactory?this._templateFactory.changeContent(E):this._templateFactory=new r0({...this._config,content:E,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[oh]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(E){return this.constructor.getOrCreateInstance(E.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Zs)}_isShown(){return this.tip&&this.tip.classList.contains(tl)}_createPopper(E){const k=S(this._config.placement,[this,E,this._element]),Q=Li[k.toUpperCase()];return Gf(this._element,E,this._getPopperConfig(Q))}_getOffset(){const{offset:E}=this._config;return typeof E=="string"?E.split(",").map(k=>Number.parseInt(k,10)):typeof E=="function"?k=>E(k,this._element):E}_resolvePossibleFunction(E){return S(E,[this._element,this._element])}_getPopperConfig(E){const k={placement:E,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:Q=>{this._getTipElement().setAttribute("data-popper-placement",Q.state.placement)}}]};return{...k,...S(this._config.popperConfig,[void 0,k])}}_setListeners(){const E=this._config.trigger.split(" ");for(const k of E)if(k==="click")P.on(this._element,this.constructor.eventName("click"),this._config.selector,Q=>{const wt=this._initializeOnDelegatedTarget(Q);wt._activeTrigger[Xr]=!(wt._isShown()&&wt._activeTrigger[Xr]),wt.toggle()});else if(k!=="manual"){const Q=k===xa?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),wt=k===xa?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");P.on(this._element,Q,this._config.selector,Dt=>{const Gt=this._initializeOnDelegatedTarget(Dt);Gt._activeTrigger[Dt.type==="focusin"?el:xa]=!0,Gt._enter()}),P.on(this._element,wt,this._config.selector,Dt=>{const Gt=this._initializeOnDelegatedTarget(Dt);Gt._activeTrigger[Dt.type==="focusout"?el:xa]=Gt._element.contains(Dt.relatedTarget),Gt._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},P.on(this._element.closest(lo),co,this._hideModalHandler)}_fixTitle(){const E=this._element.getAttribute("title");E&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",E),this._element.setAttribute("data-bs-original-title",E),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(E,k){clearTimeout(this._timeout),this._timeout=setTimeout(E,k)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(E){const k=dt.getDataAttributes(this._element);for(const Q of Object.keys(k))fu.has(Q)&&delete k[Q];return E={...k,...typeof E=="object"&&E?E:{}},E=this._mergeConfigObj(E),E=this._configAfterMerge(E),this._typeCheckConfig(E),E}_configAfterMerge(E){return E.container=E.container===!1?document.body:u(E.container),typeof E.delay=="number"&&(E.delay={show:E.delay,hide:E.delay}),typeof E.title=="number"&&(E.title=E.title.toString()),typeof E.content=="number"&&(E.content=E.content.toString()),E}_getDelegateConfig(){const E={};for(const[k,Q]of Object.entries(this._config))this.constructor.Default[k]!==Q&&(E[k]=Q);return E.selector=!1,E.trigger="manual",E}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(E){return this.each(function(){const k=Ir.getOrCreateInstance(this,E);if(typeof E=="string"){if(k[E]===void 0)throw new TypeError(`No method named "${E}"`);k[E]()}})}}w(Ir);const fo=".popover-header",i0=".popover-body",lh={...Ir.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},ch={...Ir.DefaultType,content:"(null|string|element|function)"};class ar extends Ir{static get Default(){return lh}static get DefaultType(){return ch}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[fo]:this._getTitle(),[i0]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(E){return this.each(function(){const k=ar.getOrCreateInstance(this,E);if(typeof E=="string"){if(k[E]===void 0)throw new TypeError(`No method named "${E}"`);k[E]()}})}}w(ar);const Nn=".bs.scrollspy",an=`activate${Nn}`,ya=`click${Nn}`,Ss=`load${Nn}.data-api`,ba="active",Js="[href]",uh=".nav-link",s0=`${uh}, .nav-item > ${uh}, .list-group-item`,ec={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},nc={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class nl extends Nt{constructor(E,k){super(E,k),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ec}static get DefaultType(){return nc}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const E of this._observableSections.values())this._observer.observe(E)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(E){return E.target=u(E.target)||document.body,E.rootMargin=E.offset?`${E.offset}px 0px -30%`:E.rootMargin,typeof E.threshold=="string"&&(E.threshold=E.threshold.split(",").map(k=>Number.parseFloat(k))),E}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(P.off(this._config.target,ya),P.on(this._config.target,ya,Js,E=>{const k=this._observableSections.get(E.target.hash);if(k){E.preventDefault();const Q=this._rootElement||window,wt=k.offsetTop-this._element.offsetTop;if(Q.scrollTo)return void Q.scrollTo({top:wt,behavior:"smooth"});Q.scrollTop=wt}}))}_getNewObserver(){const E={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(k=>this._observerCallback(k),E)}_observerCallback(E){const k=Gt=>this._targetLinks.get(`#${Gt.target.id}`),Q=Gt=>{this._previousScrollData.visibleEntryTop=Gt.target.offsetTop,this._process(k(Gt))},wt=(this._rootElement||document.documentElement).scrollTop,Dt=wt>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=wt;for(const Gt of E){if(!Gt.isIntersecting){this._activeTarget=null,this._clearActiveClass(k(Gt));continue}const qt=Gt.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(Dt&&qt){if(Q(Gt),!wt)return}else Dt||qt||Q(Gt)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const E=z.find(Js,this._config.target);for(const k of E){if(!k.hash||d(k))continue;const Q=z.findOne(decodeURI(k.hash),this._element);f(Q)&&(this._targetLinks.set(decodeURI(k.hash),k),this._observableSections.set(k.hash,Q))}}_process(E){this._activeTarget!==E&&(this._clearActiveClass(this._config.target),this._activeTarget=E,E.classList.add(ba),this._activateParents(E),P.trigger(this._element,an,{relatedTarget:E}))}_activateParents(E){if(E.classList.contains("dropdown-item"))z.findOne(".dropdown-toggle",E.closest(".dropdown")).classList.add(ba);else for(const k of z.parents(E,".nav, .list-group"))for(const Q of z.prev(k,s0))Q.classList.add(ba)}_clearActiveClass(E){E.classList.remove(ba);const k=z.find(`${Js}.${ba}`,E);for(const Q of k)Q.classList.remove(ba)}static jQueryInterface(E){return this.each(function(){const k=nl.getOrCreateInstance(this,E);if(typeof E=="string"){if(k[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);k[E]()}})}}P.on(window,Ss,()=>{for(const G of z.find('[data-bs-spy="scroll"]'))nl.getOrCreateInstance(G)}),w(nl);const Ki=".bs.tab",fh=`hide${Ki}`,ho=`hidden${Ki}`,ta=`show${Ki}`,wa=`shown${Ki}`,ea=`click${Ki}`,hh=`keydown${Ki}`,dh=`load${Ki}`,rc="ArrowLeft",ic="ArrowRight",po="ArrowUp",gr="ArrowDown",rl="Home",ph="End",mo="active",a0="fade",mh="show",Wn=".dropdown-toggle",sc=`:not(${Wn})`,il='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',go=`.nav-link${sc}, .list-group-item${sc}, [role="tab"]${sc}, ${il}`,gh=`.${mo}[data-bs-toggle="tab"], .${mo}[data-bs-toggle="pill"], .${mo}[data-bs-toggle="list"]`;class Ii extends Nt{constructor(E){super(E),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),P.on(this._element,hh,k=>this._keydown(k)))}static get NAME(){return"tab"}show(){const E=this._element;if(this._elemIsActive(E))return;const k=this._getActiveElem(),Q=k?P.trigger(k,fh,{relatedTarget:E}):null;P.trigger(E,ta,{relatedTarget:k}).defaultPrevented||Q&&Q.defaultPrevented||(this._deactivate(k,E),this._activate(E,k))}_activate(E,k){E&&(E.classList.add(mo),this._activate(z.getElementFromSelector(E)),this._queueCallback(()=>{E.getAttribute("role")==="tab"?(E.removeAttribute("tabindex"),E.setAttribute("aria-selected",!0),this._toggleDropDown(E,!0),P.trigger(E,wa,{relatedTarget:k})):E.classList.add(mh)},E,E.classList.contains(a0)))}_deactivate(E,k){E&&(E.classList.remove(mo),E.blur(),this._deactivate(z.getElementFromSelector(E)),this._queueCallback(()=>{E.getAttribute("role")==="tab"?(E.setAttribute("aria-selected",!1),E.setAttribute("tabindex","-1"),this._toggleDropDown(E,!1),P.trigger(E,ho,{relatedTarget:k})):E.classList.remove(mh)},E,E.classList.contains(a0)))}_keydown(E){if(![rc,ic,po,gr,rl,ph].includes(E.key))return;E.stopPropagation(),E.preventDefault();const k=this._getChildren().filter(wt=>!d(wt));let Q;if([rl,ph].includes(E.key))Q=k[E.key===rl?0:k.length-1];else{const wt=[ic,gr].includes(E.key);Q=C(k,E.target,wt,!0)}Q&&(Q.focus({preventScroll:!0}),Ii.getOrCreateInstance(Q).show())}_getChildren(){return z.find(go,this._parent)}_getActiveElem(){return this._getChildren().find(E=>this._elemIsActive(E))||null}_setInitialAttributes(E,k){this._setAttributeIfNotExists(E,"role","tablist");for(const Q of k)this._setInitialAttributesOnChild(Q)}_setInitialAttributesOnChild(E){E=this._getInnerElement(E);const k=this._elemIsActive(E),Q=this._getOuterElement(E);E.setAttribute("aria-selected",k),Q!==E&&this._setAttributeIfNotExists(Q,"role","presentation"),k||E.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(E,"role","tab"),this._setInitialAttributesOnTargetPanel(E)}_setInitialAttributesOnTargetPanel(E){const k=z.getElementFromSelector(E);k&&(this._setAttributeIfNotExists(k,"role","tabpanel"),E.id&&this._setAttributeIfNotExists(k,"aria-labelledby",`${E.id}`))}_toggleDropDown(E,k){const Q=this._getOuterElement(E);if(!Q.classList.contains("dropdown"))return;const wt=(Dt,Gt)=>{const qt=z.findOne(Dt,Q);qt&&qt.classList.toggle(Gt,k)};wt(Wn,mo),wt(".dropdown-menu",mh),Q.setAttribute("aria-expanded",k)}_setAttributeIfNotExists(E,k,Q){E.hasAttribute(k)||E.setAttribute(k,Q)}_elemIsActive(E){return E.classList.contains(mo)}_getInnerElement(E){return E.matches(go)?E:z.findOne(go,E)}_getOuterElement(E){return E.closest(".nav-item, .list-group-item")||E}static jQueryInterface(E){return this.each(function(){const k=Ii.getOrCreateInstance(this);if(typeof E=="string"){if(k[E]===void 0||E.startsWith("_")||E==="constructor")throw new TypeError(`No method named "${E}"`);k[E]()}})}}P.on(document,ea,il,function(G){["A","AREA"].includes(this.tagName)&&G.preventDefault(),d(this)||Ii.getOrCreateInstance(this).show()}),P.on(window,dh,()=>{for(const G of z.find(gh))Ii.getOrCreateInstance(G)}),w(Ii);const vi=".bs.toast",Lv=`mouseover${vi}`,o0=`mouseout${vi}`,Iv=`focusin${vi}`,l0=`focusout${vi}`,vo=`hide${vi}`,vh=`hidden${vi}`,hu=`show${vi}`,c0=`shown${vi}`,sl="hide",ac="show",_o="showing",_h={animation:"boolean",autohide:"boolean",delay:"number"},u0={animation:!0,autohide:!0,delay:5e3};class Ea extends Nt{constructor(E,k){super(E,k),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return u0}static get DefaultType(){return _h}static get NAME(){return"toast"}show(){P.trigger(this._element,hu).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(sl),v(this._element),this._element.classList.add(ac,_o),this._queueCallback(()=>{this._element.classList.remove(_o),P.trigger(this._element,c0),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(P.trigger(this._element,vo).defaultPrevented||(this._element.classList.add(_o),this._queueCallback(()=>{this._element.classList.add(sl),this._element.classList.remove(_o,ac),P.trigger(this._element,vh)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ac),super.dispose()}isShown(){return this._element.classList.contains(ac)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(E,k){switch(E.type){case"mouseover":case"mouseout":this._hasMouseInteraction=k;break;case"focusin":case"focusout":this._hasKeyboardInteraction=k}if(k)return void this._clearTimeout();const Q=E.relatedTarget;this._element===Q||this._element.contains(Q)||this._maybeScheduleHide()}_setListeners(){P.on(this._element,Lv,E=>this._onInteraction(E,!0)),P.on(this._element,o0,E=>this._onInteraction(E,!1)),P.on(this._element,Iv,E=>this._onInteraction(E,!0)),P.on(this._element,l0,E=>this._onInteraction(E,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(E){return this.each(function(){const k=Ea.getOrCreateInstance(this,E);if(typeof E=="string"){if(k[E]===void 0)throw new TypeError(`No method named "${E}"`);k[E](this)}})}}return lt(Ea),w(Ea),{Alert:At,Button:gt,Carousel:fa,Collapse:$t,Dropdown:ki,Modal:_a,Offcanvas:Yr,Popover:ar,ScrollSpy:nl,Tab:Ii,Toast:Ea,Tooltip:Ir}})}(zm)),zm.exports}C4();/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const wl=new Map,q1={set(n,t,e){wl.has(n)||wl.set(n,new Map);const r=wl.get(n);if(!r.has(t)&&r.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`);return}r.set(t,e)},get(n,t){return wl.has(n)&&wl.get(n).get(t)||null},remove(n,t){if(!wl.has(n))return;const e=wl.get(n);e.delete(t),e.size===0&&wl.delete(n)}},D4=1e6,O4=1e3,Ax="transitionend",BC=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(t,e)=>`#${CSS.escape(e)}`)),n),R4=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),N4=n=>{do n+=Math.floor(Math.random()*D4);while(document.getElementById(n));return n},k4=n=>{if(!n)return 0;let{transitionDuration:t,transitionDelay:e}=window.getComputedStyle(n);const r=Number.parseFloat(t),i=Number.parseFloat(e);return!r&&!i?0:(t=t.split(",")[0],e=e.split(",")[0],(Number.parseFloat(t)+Number.parseFloat(e))*O4)},UC=n=>{n.dispatchEvent(new Event(Ax))},ko=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Dl=n=>ko(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(BC(n)):null,Ef=n=>{if(!ko(n)||n.getClientRects().length===0)return!1;const t=getComputedStyle(n).getPropertyValue("visibility")==="visible",e=n.closest("details:not([open])");if(!e)return t;if(e!==n){const r=n.closest("summary");if(r&&r.parentNode!==e||r===null)return!1}return t},Ol=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",zC=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const t=n.getRootNode();return t instanceof ShadowRoot?t:null}return n instanceof ShadowRoot?n:n.parentNode?zC(n.parentNode):null},Km=()=>{},ep=n=>{n.offsetHeight},jC=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Y1=[],L4=n=>{document.readyState==="loading"?(Y1.length||document.addEventListener("DOMContentLoaded",()=>{for(const t of Y1)t()}),Y1.push(n)):n()},Us=()=>document.documentElement.dir==="rtl",$s=n=>{L4(()=>{const t=jC();if(t){const e=n.NAME,r=t.fn[e];t.fn[e]=n.jQueryInterface,t.fn[e].Constructor=n,t.fn[e].noConflict=()=>(t.fn[e]=r,n.jQueryInterface)}})},Vi=(n,t=[],e=n)=>typeof n=="function"?n.call(...t):e,HC=(n,t,e=!0)=>{if(!e){Vi(n);return}const i=k4(t)+5;let s=!1;const a=({target:l})=>{l===t&&(s=!0,t.removeEventListener(Ax,a),Vi(n))};t.addEventListener(Ax,a),setTimeout(()=>{s||UC(t)},i)},by=(n,t,e,r)=>{const i=n.length;let s=n.indexOf(t);return s===-1?!e&&r?n[i-1]:n[0]:(s+=e?1:-1,r&&(s=(s+i)%i),n[Math.max(0,Math.min(s,i-1))])},I4=/[^.]*(?=\..*)\.|.*/,M4=/\..*/,P4=/::\d+$/,X1={};let LA=1;const $C={mouseenter:"mouseover",mouseleave:"mouseout"},F4=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function GC(n,t){return t&&`${t}::${LA++}`||n.uidEvent||LA++}function VC(n){const t=GC(n);return n.uidEvent=t,X1[t]=X1[t]||{},X1[t]}function B4(n,t){return function e(r){return wy(r,{delegateTarget:n}),e.oneOff&&Jt.off(n,r.type,t),t.apply(n,[r])}}function U4(n,t,e){return function r(i){const s=n.querySelectorAll(t);for(let{target:a}=i;a&&a!==this;a=a.parentNode)for(const l of s)if(l===a)return wy(i,{delegateTarget:a}),r.oneOff&&Jt.off(n,i.type,t,e),e.apply(a,[i])}}function WC(n,t,e=null){return Object.values(n).find(r=>r.callable===t&&r.delegationSelector===e)}function qC(n,t,e){const r=typeof t=="string",i=r?e:t||e;let s=YC(n);return F4.has(s)||(s=n),[r,i,s]}function IA(n,t,e,r,i){if(typeof t!="string"||!n)return;let[s,a,l]=qC(t,e,r);t in $C&&(a=(x=>function(_){if(!_.relatedTarget||_.relatedTarget!==_.delegateTarget&&!_.delegateTarget.contains(_.relatedTarget))return x.call(this,_)})(a));const u=VC(n),f=u[l]||(u[l]={}),d=WC(f,a,s?e:null);if(d){d.oneOff=d.oneOff&&i;return}const p=GC(a,t.replace(I4,"")),m=s?U4(n,e,a):B4(n,a);m.delegationSelector=s?e:null,m.callable=a,m.oneOff=i,m.uidEvent=p,f[p]=m,n.addEventListener(l,m,s)}function Sx(n,t,e,r,i){const s=WC(t[e],r,i);s&&(n.removeEventListener(e,s,!!i),delete t[e][s.uidEvent])}function z4(n,t,e,r){const i=t[e]||{};for(const[s,a]of Object.entries(i))s.includes(r)&&Sx(n,t,e,a.callable,a.delegationSelector)}function YC(n){return n=n.replace(M4,""),$C[n]||n}const Jt={on(n,t,e,r){IA(n,t,e,r,!1)},one(n,t,e,r){IA(n,t,e,r,!0)},off(n,t,e,r){if(typeof t!="string"||!n)return;const[i,s,a]=qC(t,e,r),l=a!==t,u=VC(n),f=u[a]||{},d=t.startsWith(".");if(typeof s<"u"){if(!Object.keys(f).length)return;Sx(n,u,a,s,i?e:null);return}if(d)for(const p of Object.keys(u))z4(n,u,p,t.slice(1));for(const[p,m]of Object.entries(f)){const v=p.replace(P4,"");(!l||t.includes(v))&&Sx(n,u,a,m.callable,m.delegationSelector)}},trigger(n,t,e){if(typeof t!="string"||!n)return null;const r=jC(),i=YC(t),s=t!==i;let a=null,l=!0,u=!0,f=!1;s&&r&&(a=r.Event(t,e),r(n).trigger(a),l=!a.isPropagationStopped(),u=!a.isImmediatePropagationStopped(),f=a.isDefaultPrevented());const d=wy(new Event(t,{bubbles:l,cancelable:!0}),e);return f&&d.preventDefault(),u&&n.dispatchEvent(d),d.defaultPrevented&&a&&a.preventDefault(),d}};function wy(n,t={}){for(const[e,r]of Object.entries(t))try{n[e]=r}catch{Object.defineProperty(n,e,{configurable:!0,get(){return r}})}return n}function MA(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function K1(n){return n.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}const Lo={setDataAttribute(n,t,e){n.setAttribute(`data-bs-${K1(t)}`,e)},removeDataAttribute(n,t){n.removeAttribute(`data-bs-${K1(t)}`)},getDataAttributes(n){if(!n)return{};const t={},e=Object.keys(n.dataset).filter(r=>r.startsWith("bs")&&!r.startsWith("bsConfig"));for(const r of e){let i=r.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),t[i]=MA(n.dataset[r])}return t},getDataAttribute(n,t){return MA(n.getAttribute(`data-bs-${K1(t)}`))}};class np{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(t){return t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t}_mergeConfigObj(t,e){const r=ko(e)?Lo.getDataAttribute(e,"config"):{};return{...this.constructor.Default,...typeof r=="object"?r:{},...ko(e)?Lo.getDataAttributes(e):{},...typeof t=="object"?t:{}}}_typeCheckConfig(t,e=this.constructor.DefaultType){for(const[r,i]of Object.entries(e)){const s=t[r],a=ko(s)?"element":R4(s);if(!new RegExp(i).test(a))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${r}" provided type "${a}" but expected type "${i}".`)}}}const j4="5.3.7";class ua extends np{constructor(t,e){super(),t=Dl(t),t&&(this._element=t,this._config=this._getConfig(e),q1.set(this._element,this.constructor.DATA_KEY,this))}dispose(){q1.remove(this._element,this.constructor.DATA_KEY),Jt.off(this._element,this.constructor.EVENT_KEY);for(const t of Object.getOwnPropertyNames(this))this[t]=null}_queueCallback(t,e,r=!0){HC(t,e,r)}_getConfig(t){return t=this._mergeConfigObj(t,this._element),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}static getInstance(t){return q1.get(Dl(t),this.DATA_KEY)}static getOrCreateInstance(t,e={}){return this.getInstance(t)||new this(t,typeof e=="object"?e:null)}static get VERSION(){return j4}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(t){return`${t}${this.EVENT_KEY}`}}const Z1=n=>{let t=n.getAttribute("data-bs-target");if(!t||t==="#"){let e=n.getAttribute("href");if(!e||!e.includes("#")&&!e.startsWith("."))return null;e.includes("#")&&!e.startsWith("#")&&(e=`#${e.split("#")[1]}`),t=e&&e!=="#"?e.trim():null}return t?t.split(",").map(e=>BC(e)).join(","):null},Ae={find(n,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,n))},findOne(n,t=document.documentElement){return Element.prototype.querySelector.call(t,n)},children(n,t){return[].concat(...n.children).filter(e=>e.matches(t))},parents(n,t){const e=[];let r=n.parentNode.closest(t);for(;r;)e.push(r),r=r.parentNode.closest(t);return e},prev(n,t){let e=n.previousElementSibling;for(;e;){if(e.matches(t))return[e];e=e.previousElementSibling}return[]},next(n,t){let e=n.nextElementSibling;for(;e;){if(e.matches(t))return[e];e=e.nextElementSibling}return[]},focusableChildren(n){const t=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(e=>`${e}:not([tabindex^="-"])`).join(",");return this.find(t,n).filter(e=>!Ol(e)&&Ef(e))},getSelectorFromElement(n){const t=Z1(n);return t&&Ae.findOne(t)?t:null},getElementFromSelector(n){const t=Z1(n);return t?Ae.findOne(t):null},getMultipleElementsFromSelector(n){const t=Z1(n);return t?Ae.find(t):[]}},Fg=(n,t="hide")=>{const e=`click.dismiss${n.EVENT_KEY}`,r=n.NAME;Jt.on(document,e,`[data-bs-dismiss="${r}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Ol(this))return;const s=Ae.getElementFromSelector(this)||this.closest(`.${r}`);n.getOrCreateInstance(s)[t]()})},H4="alert",$4="bs.alert",XC=`.${$4}`,G4=`close${XC}`,V4=`closed${XC}`,W4="fade",q4="show";class Bg extends ua{static get NAME(){return H4}close(){if(Jt.trigger(this._element,G4).defaultPrevented)return;this._element.classList.remove(q4);const e=this._element.classList.contains(W4);this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),Jt.trigger(this._element,V4),this.dispose()}static jQueryInterface(t){return this.each(function(){const e=Bg.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Fg(Bg,"close");$s(Bg);const Y4="button",X4="bs.button",K4=`.${X4}`,Z4=".data-api",Q4="active",PA='[data-bs-toggle="button"]',J4=`click${K4}${Z4}`;class Ug extends ua{static get NAME(){return Y4}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Q4))}static jQueryInterface(t){return this.each(function(){const e=Ug.getOrCreateInstance(this);t==="toggle"&&e[t]()})}}Jt.on(document,J4,PA,n=>{n.preventDefault();const t=n.target.closest(PA);Ug.getOrCreateInstance(t).toggle()});$s(Ug);const t3="swipe",Af=".bs.swipe",e3=`touchstart${Af}`,n3=`touchmove${Af}`,r3=`touchend${Af}`,i3=`pointerdown${Af}`,s3=`pointerup${Af}`,a3="touch",o3="pen",l3="pointer-event",c3=40,u3={endCallback:null,leftCallback:null,rightCallback:null},f3={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Zm extends np{constructor(t,e){super(),this._element=t,!(!t||!Zm.isSupported())&&(this._config=this._getConfig(e),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return u3}static get DefaultType(){return f3}static get NAME(){return t3}dispose(){Jt.off(this._element,Af)}_start(t){if(!this._supportPointerEvents){this._deltaX=t.touches[0].clientX;return}this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX)}_end(t){this._eventIsPointerPenTouch(t)&&(this._deltaX=t.clientX-this._deltaX),this._handleSwipe(),Vi(this._config.endCallback)}_move(t){this._deltaX=t.touches&&t.touches.length>1?0:t.touches[0].clientX-this._deltaX}_handleSwipe(){const t=Math.abs(this._deltaX);if(t<=c3)return;const e=t/this._deltaX;this._deltaX=0,e&&Vi(e>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Jt.on(this._element,i3,t=>this._start(t)),Jt.on(this._element,s3,t=>this._end(t)),this._element.classList.add(l3)):(Jt.on(this._element,e3,t=>this._start(t)),Jt.on(this._element,n3,t=>this._move(t)),Jt.on(this._element,r3,t=>this._end(t)))}_eventIsPointerPenTouch(t){return this._supportPointerEvents&&(t.pointerType===o3||t.pointerType===a3)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const h3="carousel",d3="bs.carousel",Fl=`.${d3}`,KC=".data-api",p3="ArrowLeft",m3="ArrowRight",g3=500,ed="next",Pu="prev",ju="left",jm="right",v3=`slide${Fl}`,Q1=`slid${Fl}`,_3=`keydown${Fl}`,x3=`mouseenter${Fl}`,y3=`mouseleave${Fl}`,b3=`dragstart${Fl}`,w3=`load${Fl}${KC}`,E3=`click${Fl}${KC}`,ZC="carousel",tm="active",A3="slide",S3="carousel-item-end",T3="carousel-item-start",C3="carousel-item-next",D3="carousel-item-prev",QC=".active",JC=".carousel-item",O3=QC+JC,R3=".carousel-item img",N3=".carousel-indicators",k3="[data-bs-slide], [data-bs-slide-to]",L3='[data-bs-ride="carousel"]',I3={[p3]:jm,[m3]:ju},M3={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},P3={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class rp extends ua{constructor(t,e){super(t,e),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Ae.findOne(N3,this._element),this._addEventListeners(),this._config.ride===ZC&&this.cycle()}static get Default(){return M3}static get DefaultType(){return P3}static get NAME(){return h3}next(){this._slide(ed)}nextWhenVisible(){!document.hidden&&Ef(this._element)&&this.next()}prev(){this._slide(Pu)}pause(){this._isSliding&&UC(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Jt.one(this._element,Q1,()=>this.cycle());return}this.cycle()}}to(t){const e=this._getItems();if(t>e.length-1||t<0)return;if(this._isSliding){Jt.one(this._element,Q1,()=>this.to(t));return}const r=this._getItemIndex(this._getActive());if(r===t)return;const i=t>r?ed:Pu;this._slide(i,e[t])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(t){return t.defaultInterval=t.interval,t}_addEventListeners(){this._config.keyboard&&Jt.on(this._element,_3,t=>this._keydown(t)),this._config.pause==="hover"&&(Jt.on(this._element,x3,()=>this.pause()),Jt.on(this._element,y3,()=>this._maybeEnableCycle())),this._config.touch&&Zm.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const r of Ae.find(R3,this._element))Jt.on(r,b3,i=>i.preventDefault());const e={leftCallback:()=>this._slide(this._directionToOrder(ju)),rightCallback:()=>this._slide(this._directionToOrder(jm)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),g3+this._config.interval))}};this._swipeHelper=new Zm(this._element,e)}_keydown(t){if(/input|textarea/i.test(t.target.tagName))return;const e=I3[t.key];e&&(t.preventDefault(),this._slide(this._directionToOrder(e)))}_getItemIndex(t){return this._getItems().indexOf(t)}_setActiveIndicatorElement(t){if(!this._indicatorsElement)return;const e=Ae.findOne(QC,this._indicatorsElement);e.classList.remove(tm),e.removeAttribute("aria-current");const r=Ae.findOne(`[data-bs-slide-to="${t}"]`,this._indicatorsElement);r&&(r.classList.add(tm),r.setAttribute("aria-current","true"))}_updateInterval(){const t=this._activeElement||this._getActive();if(!t)return;const e=Number.parseInt(t.getAttribute("data-bs-interval"),10);this._config.interval=e||this._config.defaultInterval}_slide(t,e=null){if(this._isSliding)return;const r=this._getActive(),i=t===ed,s=e||by(this._getItems(),r,i,this._config.wrap);if(s===r)return;const a=this._getItemIndex(s),l=v=>Jt.trigger(this._element,v,{relatedTarget:s,direction:this._orderToDirection(t),from:this._getItemIndex(r),to:a});if(l(v3).defaultPrevented||!r||!s)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(a),this._activeElement=s;const d=i?T3:S3,p=i?C3:D3;s.classList.add(p),ep(s),r.classList.add(d),s.classList.add(d);const m=()=>{s.classList.remove(d,p),s.classList.add(tm),r.classList.remove(tm,p,d),this._isSliding=!1,l(Q1)};this._queueCallback(m,r,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(A3)}_getActive(){return Ae.findOne(O3,this._element)}_getItems(){return Ae.find(JC,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(t){return Us()?t===ju?Pu:ed:t===ju?ed:Pu}_orderToDirection(t){return Us()?t===Pu?ju:jm:t===Pu?jm:ju}static jQueryInterface(t){return this.each(function(){const e=rp.getOrCreateInstance(this,t);if(typeof t=="number"){e.to(t);return}if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(document,E3,k3,function(n){const t=Ae.getElementFromSelector(this);if(!t||!t.classList.contains(ZC))return;n.preventDefault();const e=rp.getOrCreateInstance(t),r=this.getAttribute("data-bs-slide-to");if(r){e.to(r),e._maybeEnableCycle();return}if(Lo.getDataAttribute(this,"slide")==="next"){e.next(),e._maybeEnableCycle();return}e.prev(),e._maybeEnableCycle()});Jt.on(window,w3,()=>{const n=Ae.find(L3);for(const t of n)rp.getOrCreateInstance(t)});$s(rp);const F3="collapse",B3="bs.collapse",ip=`.${B3}`,U3=".data-api",z3=`show${ip}`,j3=`shown${ip}`,H3=`hide${ip}`,$3=`hidden${ip}`,G3=`click${ip}${U3}`,J1="show",Wu="collapse",em="collapsing",V3="collapsed",W3=`:scope .${Wu} .${Wu}`,q3="collapse-horizontal",Y3="width",X3="height",K3=".collapse.show, .collapse.collapsing",Tx='[data-bs-toggle="collapse"]',Z3={parent:null,toggle:!0},Q3={parent:"(null|element)",toggle:"boolean"};class Nd extends ua{constructor(t,e){super(t,e),this._isTransitioning=!1,this._triggerArray=[];const r=Ae.find(Tx);for(const i of r){const s=Ae.getSelectorFromElement(i),a=Ae.find(s).filter(l=>l===this._element);s!==null&&a.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Z3}static get DefaultType(){return Q3}static get NAME(){return F3}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(K3).filter(l=>l!==this._element).map(l=>Nd.getOrCreateInstance(l,{toggle:!1}))),t.length&&t[0]._isTransitioning||Jt.trigger(this._element,z3).defaultPrevented)return;for(const l of t)l.hide();const r=this._getDimension();this._element.classList.remove(Wu),this._element.classList.add(em),this._element.style[r]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(em),this._element.classList.add(Wu,J1),this._element.style[r]="",Jt.trigger(this._element,j3)},a=`scroll${r[0].toUpperCase()+r.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[r]=`${this._element[a]}px`}hide(){if(this._isTransitioning||!this._isShown()||Jt.trigger(this._element,H3).defaultPrevented)return;const e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,ep(this._element),this._element.classList.add(em),this._element.classList.remove(Wu,J1);for(const i of this._triggerArray){const s=Ae.getElementFromSelector(i);s&&!this._isShown(s)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const r=()=>{this._isTransitioning=!1,this._element.classList.remove(em),this._element.classList.add(Wu),Jt.trigger(this._element,$3)};this._element.style[e]="",this._queueCallback(r,this._element,!0)}_isShown(t=this._element){return t.classList.contains(J1)}_configAfterMerge(t){return t.toggle=!!t.toggle,t.parent=Dl(t.parent),t}_getDimension(){return this._element.classList.contains(q3)?Y3:X3}_initializeChildren(){if(!this._config.parent)return;const t=this._getFirstLevelChildren(Tx);for(const e of t){const r=Ae.getElementFromSelector(e);r&&this._addAriaAndCollapsedClass([e],this._isShown(r))}}_getFirstLevelChildren(t){const e=Ae.find(W3,this._config.parent);return Ae.find(t,this._config.parent).filter(r=>!e.includes(r))}_addAriaAndCollapsedClass(t,e){if(t.length)for(const r of t)r.classList.toggle(V3,!e),r.setAttribute("aria-expanded",e)}static jQueryInterface(t){const e={};return typeof t=="string"&&/show|hide/.test(t)&&(e.toggle=!1),this.each(function(){const r=Nd.getOrCreateInstance(this,e);if(typeof t=="string"){if(typeof r[t]>"u")throw new TypeError(`No method named "${t}"`);r[t]()}})}}Jt.on(document,G3,Tx,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const t of Ae.getMultipleElementsFromSelector(this))Nd.getOrCreateInstance(t,{toggle:!1}).toggle()});$s(Nd);const FA="dropdown",J3="bs.dropdown",jc=`.${J3}`,Ey=".data-api",tI="Escape",BA="Tab",eI="ArrowUp",UA="ArrowDown",nI=2,rI=`hide${jc}`,iI=`hidden${jc}`,sI=`show${jc}`,aI=`shown${jc}`,tD=`click${jc}${Ey}`,eD=`keydown${jc}${Ey}`,oI=`keyup${jc}${Ey}`,Hu="show",lI="dropup",cI="dropend",uI="dropstart",fI="dropup-center",hI="dropdown-center",xc='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',dI=`${xc}.${Hu}`,Hm=".dropdown-menu",pI=".navbar",mI=".navbar-nav",gI=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",vI=Us()?"top-end":"top-start",_I=Us()?"top-start":"top-end",xI=Us()?"bottom-end":"bottom-start",yI=Us()?"bottom-start":"bottom-end",bI=Us()?"left-start":"right-start",wI=Us()?"right-start":"left-start",EI="top",AI="bottom",SI={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},TI={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Va extends ua{constructor(t,e){super(t,e),this._popper=null,this._parent=this._element.parentNode,this._menu=Ae.next(this._element,Hm)[0]||Ae.prev(this._element,Hm)[0]||Ae.findOne(Hm,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return SI}static get DefaultType(){return TI}static get NAME(){return FA}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ol(this._element)||this._isShown())return;const t={relatedTarget:this._element};if(!Jt.trigger(this._element,sI,t).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(mI))for(const r of[].concat(...document.body.children))Jt.on(r,"mouseover",Km);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Hu),this._element.classList.add(Hu),Jt.trigger(this._element,aI,t)}}hide(){if(Ol(this._element)||!this._isShown())return;const t={relatedTarget:this._element};this._completeHide(t)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(t){if(!Jt.trigger(this._element,rI,t).defaultPrevented){if("ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))Jt.off(r,"mouseover",Km);this._popper&&this._popper.destroy(),this._menu.classList.remove(Hu),this._element.classList.remove(Hu),this._element.setAttribute("aria-expanded","false"),Lo.removeDataAttribute(this._menu,"popper"),Jt.trigger(this._element,iI,t),this._element.focus()}}_getConfig(t){if(t=super._getConfig(t),typeof t.reference=="object"&&!ko(t.reference)&&typeof t.reference.getBoundingClientRect!="function")throw new TypeError(`${FA.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return t}_createPopper(){if(typeof _y>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let t=this._element;this._config.reference==="parent"?t=this._parent:ko(this._config.reference)?t=Dl(this._config.reference):typeof this._config.reference=="object"&&(t=this._config.reference);const e=this._getPopperConfig();this._popper=vy(t,this._menu,e)}_isShown(){return this._menu.classList.contains(Hu)}_getPlacement(){const t=this._parent;if(t.classList.contains(cI))return bI;if(t.classList.contains(uI))return wI;if(t.classList.contains(fI))return EI;if(t.classList.contains(hI))return AI;const e=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return t.classList.contains(lI)?e?_I:vI:e?yI:xI}_detectNavbar(){return this._element.closest(pI)!==null}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_getPopperConfig(){const t={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Lo.setDataAttribute(this._menu,"popper","static"),t.modifiers=[{name:"applyStyles",enabled:!1}]),{...t,...Vi(this._config.popperConfig,[void 0,t])}}_selectMenuItem({key:t,target:e}){const r=Ae.find(gI,this._menu).filter(i=>Ef(i));r.length&&by(r,e,t===UA,!r.includes(e)).focus()}static jQueryInterface(t){return this.each(function(){const e=Va.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}static clearMenus(t){if(t.button===nI||t.type==="keyup"&&t.key!==BA)return;const e=Ae.find(dI);for(const r of e){const i=Va.getInstance(r);if(!i||i._config.autoClose===!1)continue;const s=t.composedPath(),a=s.includes(i._menu);if(s.includes(i._element)||i._config.autoClose==="inside"&&!a||i._config.autoClose==="outside"&&a||i._menu.contains(t.target)&&(t.type==="keyup"&&t.key===BA||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;const l={relatedTarget:i._element};t.type==="click"&&(l.clickEvent=t),i._completeHide(l)}}static dataApiKeydownHandler(t){const e=/input|textarea/i.test(t.target.tagName),r=t.key===tI,i=[eI,UA].includes(t.key);if(!i&&!r||e&&!r)return;t.preventDefault();const s=this.matches(xc)?this:Ae.prev(this,xc)[0]||Ae.next(this,xc)[0]||Ae.findOne(xc,t.delegateTarget.parentNode),a=Va.getOrCreateInstance(s);if(i){t.stopPropagation(),a.show(),a._selectMenuItem(t);return}a._isShown()&&(t.stopPropagation(),a.hide(),s.focus())}}Jt.on(document,eD,xc,Va.dataApiKeydownHandler);Jt.on(document,eD,Hm,Va.dataApiKeydownHandler);Jt.on(document,tD,Va.clearMenus);Jt.on(document,oI,Va.clearMenus);Jt.on(document,tD,xc,function(n){n.preventDefault(),Va.getOrCreateInstance(this).toggle()});$s(Va);const nD="backdrop",CI="fade",zA="show",jA=`mousedown.bs.${nD}`,DI={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},OI={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class rD extends np{constructor(t){super(),this._config=this._getConfig(t),this._isAppended=!1,this._element=null}static get Default(){return DI}static get DefaultType(){return OI}static get NAME(){return nD}show(t){if(!this._config.isVisible){Vi(t);return}this._append();const e=this._getElement();this._config.isAnimated&&ep(e),e.classList.add(zA),this._emulateAnimation(()=>{Vi(t)})}hide(t){if(!this._config.isVisible){Vi(t);return}this._getElement().classList.remove(zA),this._emulateAnimation(()=>{this.dispose(),Vi(t)})}dispose(){this._isAppended&&(Jt.off(this._element,jA),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const t=document.createElement("div");t.className=this._config.className,this._config.isAnimated&&t.classList.add(CI),this._element=t}return this._element}_configAfterMerge(t){return t.rootElement=Dl(t.rootElement),t}_append(){if(this._isAppended)return;const t=this._getElement();this._config.rootElement.append(t),Jt.on(t,jA,()=>{Vi(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(t){HC(t,this._getElement(),this._config.isAnimated)}}const RI="focustrap",NI="bs.focustrap",Qm=`.${NI}`,kI=`focusin${Qm}`,LI=`keydown.tab${Qm}`,II="Tab",MI="forward",HA="backward",PI={autofocus:!0,trapElement:null},FI={autofocus:"boolean",trapElement:"element"};class iD extends np{constructor(t){super(),this._config=this._getConfig(t),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return PI}static get DefaultType(){return FI}static get NAME(){return RI}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Jt.off(document,Qm),Jt.on(document,kI,t=>this._handleFocusin(t)),Jt.on(document,LI,t=>this._handleKeydown(t)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Jt.off(document,Qm))}_handleFocusin(t){const{trapElement:e}=this._config;if(t.target===document||t.target===e||e.contains(t.target))return;const r=Ae.focusableChildren(e);r.length===0?e.focus():this._lastTabNavDirection===HA?r[r.length-1].focus():r[0].focus()}_handleKeydown(t){t.key===II&&(this._lastTabNavDirection=t.shiftKey?HA:MI)}}const $A=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",GA=".sticky-top",nm="padding-right",VA="margin-right";class Cx{constructor(){this._element=document.body}getWidth(){const t=document.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}hide(){const t=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,nm,e=>e+t),this._setElementAttributes($A,nm,e=>e+t),this._setElementAttributes(GA,VA,e=>e-t)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,nm),this._resetElementAttributes($A,nm),this._resetElementAttributes(GA,VA)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(t,e,r){const i=this.getWidth(),s=a=>{if(a!==this._element&&window.innerWidth>a.clientWidth+i)return;this._saveInitialAttribute(a,e);const l=window.getComputedStyle(a).getPropertyValue(e);a.style.setProperty(e,`${r(Number.parseFloat(l))}px`)};this._applyManipulationCallback(t,s)}_saveInitialAttribute(t,e){const r=t.style.getPropertyValue(e);r&&Lo.setDataAttribute(t,e,r)}_resetElementAttributes(t,e){const r=i=>{const s=Lo.getDataAttribute(i,e);if(s===null){i.style.removeProperty(e);return}Lo.removeDataAttribute(i,e),i.style.setProperty(e,s)};this._applyManipulationCallback(t,r)}_applyManipulationCallback(t,e){if(ko(t)){e(t);return}for(const r of Ae.find(t,this._element))e(r)}}const BI="modal",UI="bs.modal",zs=`.${UI}`,zI=".data-api",jI="Escape",HI=`hide${zs}`,$I=`hidePrevented${zs}`,sD=`hidden${zs}`,aD=`show${zs}`,GI=`shown${zs}`,VI=`resize${zs}`,WI=`click.dismiss${zs}`,qI=`mousedown.dismiss${zs}`,YI=`keydown.dismiss${zs}`,XI=`click${zs}${zI}`,WA="modal-open",KI="fade",qA="show",t_="modal-static",ZI=".modal.show",QI=".modal-dialog",JI=".modal-body",tM='[data-bs-toggle="modal"]',eM={backdrop:!0,focus:!0,keyboard:!0},nM={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Oc extends ua{constructor(t,e){super(t,e),this._dialog=Ae.findOne(QI,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Cx,this._addEventListeners()}static get Default(){return eM}static get DefaultType(){return nM}static get NAME(){return BI}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){this._isShown||this._isTransitioning||Jt.trigger(this._element,aD,{relatedTarget:t}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(WA),this._adjustDialog(),this._backdrop.show(()=>this._showElement(t)))}hide(){!this._isShown||this._isTransitioning||Jt.trigger(this._element,HI).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(qA),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Jt.off(window,zs),Jt.off(this._dialog,zs),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new rD({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new iD({trapElement:this._element})}_showElement(t){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const e=Ae.findOne(JI,this._dialog);e&&(e.scrollTop=0),ep(this._element),this._element.classList.add(qA);const r=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Jt.trigger(this._element,GI,{relatedTarget:t})};this._queueCallback(r,this._dialog,this._isAnimated())}_addEventListeners(){Jt.on(this._element,YI,t=>{if(t.key===jI){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Jt.on(window,VI,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Jt.on(this._element,qI,t=>{Jt.one(this._element,WI,e=>{if(!(this._element!==t.target||this._element!==e.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(WA),this._resetAdjustments(),this._scrollBar.reset(),Jt.trigger(this._element,sD)})}_isAnimated(){return this._element.classList.contains(KI)}_triggerBackdropTransition(){if(Jt.trigger(this._element,$I).defaultPrevented)return;const e=this._element.scrollHeight>document.documentElement.clientHeight,r=this._element.style.overflowY;r==="hidden"||this._element.classList.contains(t_)||(e||(this._element.style.overflowY="hidden"),this._element.classList.add(t_),this._queueCallback(()=>{this._element.classList.remove(t_),this._queueCallback(()=>{this._element.style.overflowY=r},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const t=this._element.scrollHeight>document.documentElement.clientHeight,e=this._scrollBar.getWidth(),r=e>0;if(r&&!t){const i=Us()?"paddingLeft":"paddingRight";this._element.style[i]=`${e}px`}if(!r&&t){const i=Us()?"paddingRight":"paddingLeft";this._element.style[i]=`${e}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(t,e){return this.each(function(){const r=Oc.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof r[t]>"u")throw new TypeError(`No method named "${t}"`);r[t](e)}})}}Jt.on(document,XI,tM,function(n){const t=Ae.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Jt.one(t,aD,i=>{i.defaultPrevented||Jt.one(t,sD,()=>{Ef(this)&&this.focus()})});const e=Ae.findOne(ZI);e&&Oc.getInstance(e).hide(),Oc.getOrCreateInstance(t).toggle(this)});Fg(Oc);$s(Oc);const rM="offcanvas",iM="bs.offcanvas",Ho=`.${iM}`,oD=".data-api",sM=`load${Ho}${oD}`,aM="Escape",YA="show",XA="showing",KA="hiding",oM="offcanvas-backdrop",lD=".offcanvas.show",lM=`show${Ho}`,cM=`shown${Ho}`,uM=`hide${Ho}`,ZA=`hidePrevented${Ho}`,cD=`hidden${Ho}`,fM=`resize${Ho}`,hM=`click${Ho}${oD}`,dM=`keydown.dismiss${Ho}`,pM='[data-bs-toggle="offcanvas"]',mM={backdrop:!0,keyboard:!0,scroll:!1},gM={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Rl extends ua{constructor(t,e){super(t,e),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return mM}static get DefaultType(){return gM}static get NAME(){return rM}toggle(t){return this._isShown?this.hide():this.show(t)}show(t){if(this._isShown||Jt.trigger(this._element,lM,{relatedTarget:t}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Cx().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(XA);const r=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(YA),this._element.classList.remove(XA),Jt.trigger(this._element,cM,{relatedTarget:t})};this._queueCallback(r,this._element,!0)}hide(){if(!this._isShown||Jt.trigger(this._element,uM).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(KA),this._backdrop.hide();const e=()=>{this._element.classList.remove(YA,KA),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Cx().reset(),Jt.trigger(this._element,cD)};this._queueCallback(e,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const t=()=>{if(this._config.backdrop==="static"){Jt.trigger(this._element,ZA);return}this.hide()},e=!!this._config.backdrop;return new rD({className:oM,isVisible:e,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:e?t:null})}_initializeFocusTrap(){return new iD({trapElement:this._element})}_addEventListeners(){Jt.on(this._element,dM,t=>{if(t.key===aM){if(this._config.keyboard){this.hide();return}Jt.trigger(this._element,ZA)}})}static jQueryInterface(t){return this.each(function(){const e=Rl.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Jt.on(document,hM,pM,function(n){const t=Ae.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Ol(this))return;Jt.one(t,cD,()=>{Ef(this)&&this.focus()});const e=Ae.findOne(lD);e&&e!==t&&Rl.getInstance(e).hide(),Rl.getOrCreateInstance(t).toggle(this)});Jt.on(window,sM,()=>{for(const n of Ae.find(lD))Rl.getOrCreateInstance(n).show()});Jt.on(window,fM,()=>{for(const n of Ae.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Rl.getOrCreateInstance(n).hide()});Fg(Rl);$s(Rl);const vM=/^aria-[\w-]*$/i,uD={"*":["class","dir","id","lang","role",vM],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},_M=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),xM=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,yM=(n,t)=>{const e=n.nodeName.toLowerCase();return t.includes(e)?_M.has(e)?!!xM.test(n.nodeValue):!0:t.filter(r=>r instanceof RegExp).some(r=>r.test(e))};function bM(n,t,e){if(!n.length)return n;if(e&&typeof e=="function")return e(n);const i=new window.DOMParser().parseFromString(n,"text/html"),s=[].concat(...i.body.querySelectorAll("*"));for(const a of s){const l=a.nodeName.toLowerCase();if(!Object.keys(t).includes(l)){a.remove();continue}const u=[].concat(...a.attributes),f=[].concat(t["*"]||[],t[l]||[]);for(const d of u)yM(d,f)||a.removeAttribute(d.nodeName)}return i.body.innerHTML}const wM="TemplateFactory",EM={allowList:uD,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},AM={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},SM={entry:"(string|element|function|null)",selector:"(string|element)"};class TM extends np{constructor(t){super(),this._config=this._getConfig(t)}static get Default(){return EM}static get DefaultType(){return AM}static get NAME(){return wM}getContent(){return Object.values(this._config.content).map(t=>this._resolvePossibleFunction(t)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(t){return this._checkContent(t),this._config.content={...this._config.content,...t},this}toHtml(){const t=document.createElement("div");t.innerHTML=this._maybeSanitize(this._config.template);for(const[i,s]of Object.entries(this._config.content))this._setContent(t,s,i);const e=t.children[0],r=this._resolvePossibleFunction(this._config.extraClass);return r&&e.classList.add(...r.split(" ")),e}_typeCheckConfig(t){super._typeCheckConfig(t),this._checkContent(t.content)}_checkContent(t){for(const[e,r]of Object.entries(t))super._typeCheckConfig({selector:e,entry:r},SM)}_setContent(t,e,r){const i=Ae.findOne(r,t);if(i){if(e=this._resolvePossibleFunction(e),!e){i.remove();return}if(ko(e)){this._putElementInTemplate(Dl(e),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(e);return}i.textContent=e}}_maybeSanitize(t){return this._config.sanitize?bM(t,this._config.allowList,this._config.sanitizeFn):t}_resolvePossibleFunction(t){return Vi(t,[void 0,this])}_putElementInTemplate(t,e){if(this._config.html){e.innerHTML="",e.append(t);return}e.textContent=t.textContent}}const CM="tooltip",DM=new Set(["sanitize","allowList","sanitizeFn"]),e_="fade",OM="modal",rm="show",RM=".tooltip-inner",QA=`.${OM}`,JA="hide.bs.modal",nd="hover",n_="focus",r_="click",NM="manual",kM="hide",LM="hidden",IM="show",MM="shown",PM="inserted",FM="click",BM="focusin",UM="focusout",zM="mouseenter",jM="mouseleave",HM={AUTO:"auto",TOP:"top",RIGHT:Us()?"left":"right",BOTTOM:"bottom",LEFT:Us()?"right":"left"},$M={allowList:uD,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},GM={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class js extends ua{constructor(t,e){if(typeof _y>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(t,e),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return $M}static get DefaultType(){return GM}static get NAME(){return CM}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Jt.off(this._element.closest(QA),JA,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const t=Jt.trigger(this._element,this.constructor.eventName(IM)),r=(zC(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(t.defaultPrevented||!r)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:s}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(s.append(i),Jt.trigger(this._element,this.constructor.eventName(PM))),this._popper=this._createPopper(i),i.classList.add(rm),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))Jt.on(l,"mouseover",Km);const a=()=>{Jt.trigger(this._element,this.constructor.eventName(MM)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(a,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Jt.trigger(this._element,this.constructor.eventName(kM)).defaultPrevented)return;if(this._getTipElement().classList.remove(rm),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Jt.off(i,"mouseover",Km);this._activeTrigger[r_]=!1,this._activeTrigger[n_]=!1,this._activeTrigger[nd]=!1,this._isHovered=null;const r=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Jt.trigger(this._element,this.constructor.eventName(LM)))};this._queueCallback(r,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(t){const e=this._getTemplateFactory(t).toHtml();if(!e)return null;e.classList.remove(e_,rm),e.classList.add(`bs-${this.constructor.NAME}-auto`);const r=N4(this.constructor.NAME).toString();return e.setAttribute("id",r),this._isAnimated()&&e.classList.add(e_),e}setContent(t){this._newContent=t,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(t){return this._templateFactory?this._templateFactory.changeContent(t):this._templateFactory=new TM({...this._config,content:t,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[RM]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(t){return this.constructor.getOrCreateInstance(t.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(e_)}_isShown(){return this.tip&&this.tip.classList.contains(rm)}_createPopper(t){const e=Vi(this._config.placement,[this,t,this._element]),r=HM[e.toUpperCase()];return vy(this._element,t,this._getPopperConfig(r))}_getOffset(){const{offset:t}=this._config;return typeof t=="string"?t.split(",").map(e=>Number.parseInt(e,10)):typeof t=="function"?e=>t(e,this._element):t}_resolvePossibleFunction(t){return Vi(t,[this._element,this._element])}_getPopperConfig(t){const e={placement:t,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:r=>{this._getTipElement().setAttribute("data-popper-placement",r.state.placement)}}]};return{...e,...Vi(this._config.popperConfig,[void 0,e])}}_setListeners(){const t=this._config.trigger.split(" ");for(const e of t)if(e==="click")Jt.on(this._element,this.constructor.eventName(FM),this._config.selector,r=>{const i=this._initializeOnDelegatedTarget(r);i._activeTrigger[r_]=!(i._isShown()&&i._activeTrigger[r_]),i.toggle()});else if(e!==NM){const r=e===nd?this.constructor.eventName(zM):this.constructor.eventName(BM),i=e===nd?this.constructor.eventName(jM):this.constructor.eventName(UM);Jt.on(this._element,r,this._config.selector,s=>{const a=this._initializeOnDelegatedTarget(s);a._activeTrigger[s.type==="focusin"?n_:nd]=!0,a._enter()}),Jt.on(this._element,i,this._config.selector,s=>{const a=this._initializeOnDelegatedTarget(s);a._activeTrigger[s.type==="focusout"?n_:nd]=a._element.contains(s.relatedTarget),a._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Jt.on(this._element.closest(QA),JA,this._hideModalHandler)}_fixTitle(){const t=this._element.getAttribute("title");t&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",t),this._element.setAttribute("data-bs-original-title",t),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(t,e){clearTimeout(this._timeout),this._timeout=setTimeout(t,e)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(t){const e=Lo.getDataAttributes(this._element);for(const r of Object.keys(e))DM.has(r)&&delete e[r];return t={...e,...typeof t=="object"&&t?t:{}},t=this._mergeConfigObj(t),t=this._configAfterMerge(t),this._typeCheckConfig(t),t}_configAfterMerge(t){return t.container=t.container===!1?document.body:Dl(t.container),typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),typeof t.title=="number"&&(t.title=t.title.toString()),typeof t.content=="number"&&(t.content=t.content.toString()),t}_getDelegateConfig(){const t={};for(const[e,r]of Object.entries(this._config))this.constructor.Default[e]!==r&&(t[e]=r);return t.selector=!1,t.trigger="manual",t}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(t){return this.each(function(){const e=js.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}}$s(js);const VM="popover",WM=".popover-header",qM=".popover-body",YM={...js.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},XM={...js.DefaultType,content:"(null|string|element|function)"};class Ay extends js{static get Default(){return YM}static get DefaultType(){return XM}static get NAME(){return VM}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[WM]:this._getTitle(),[qM]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){const e=Ay.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t]()}})}}$s(Ay);const KM="scrollspy",ZM="bs.scrollspy",Sy=`.${ZM}`,QM=".data-api",JM=`activate${Sy}`,tS=`click${Sy}`,tP=`load${Sy}${QM}`,eP="dropdown-item",Fu="active",nP='[data-bs-spy="scroll"]',i_="[href]",rP=".nav, .list-group",eS=".nav-link",iP=".nav-item",sP=".list-group-item",aP=`${eS}, ${iP} > ${eS}, ${sP}`,oP=".dropdown",lP=".dropdown-toggle",cP={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},uP={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class zg extends ua{constructor(t,e){super(t,e),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return cP}static get DefaultType(){return uP}static get NAME(){return KM}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const t of this._observableSections.values())this._observer.observe(t)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(t){return t.target=Dl(t.target)||document.body,t.rootMargin=t.offset?`${t.offset}px 0px -30%`:t.rootMargin,typeof t.threshold=="string"&&(t.threshold=t.threshold.split(",").map(e=>Number.parseFloat(e))),t}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Jt.off(this._config.target,tS),Jt.on(this._config.target,tS,i_,t=>{const e=this._observableSections.get(t.target.hash);if(e){t.preventDefault();const r=this._rootElement||window,i=e.offsetTop-this._element.offsetTop;if(r.scrollTo){r.scrollTo({top:i,behavior:"smooth"});return}r.scrollTop=i}}))}_getNewObserver(){const t={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),t)}_observerCallback(t){const e=a=>this._targetLinks.get(`#${a.target.id}`),r=a=>{this._previousScrollData.visibleEntryTop=a.target.offsetTop,this._process(e(a))},i=(this._rootElement||document.documentElement).scrollTop,s=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const a of t){if(!a.isIntersecting){this._activeTarget=null,this._clearActiveClass(e(a));continue}const l=a.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(s&&l){if(r(a),!i)return;continue}!s&&!l&&r(a)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const t=Ae.find(i_,this._config.target);for(const e of t){if(!e.hash||Ol(e))continue;const r=Ae.findOne(decodeURI(e.hash),this._element);Ef(r)&&(this._targetLinks.set(decodeURI(e.hash),e),this._observableSections.set(e.hash,r))}}_process(t){this._activeTarget!==t&&(this._clearActiveClass(this._config.target),this._activeTarget=t,t.classList.add(Fu),this._activateParents(t),Jt.trigger(this._element,JM,{relatedTarget:t}))}_activateParents(t){if(t.classList.contains(eP)){Ae.findOne(lP,t.closest(oP)).classList.add(Fu);return}for(const e of Ae.parents(t,rP))for(const r of Ae.prev(e,aP))r.classList.add(Fu)}_clearActiveClass(t){t.classList.remove(Fu);const e=Ae.find(`${i_}.${Fu}`,t);for(const r of e)r.classList.remove(Fu)}static jQueryInterface(t){return this.each(function(){const e=zg.getOrCreateInstance(this,t);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(window,tP,()=>{for(const n of Ae.find(nP))zg.getOrCreateInstance(n)});$s(zg);const fP="tab",hP="bs.tab",Hc=`.${hP}`,dP=`hide${Hc}`,pP=`hidden${Hc}`,mP=`show${Hc}`,gP=`shown${Hc}`,vP=`click${Hc}`,_P=`keydown${Hc}`,xP=`load${Hc}`,yP="ArrowLeft",nS="ArrowRight",bP="ArrowUp",rS="ArrowDown",s_="Home",iS="End",yc="active",sS="fade",a_="show",wP="dropdown",fD=".dropdown-toggle",EP=".dropdown-menu",o_=`:not(${fD})`,AP='.list-group, .nav, [role="tablist"]',SP=".nav-item, .list-group-item",TP=`.nav-link${o_}, .list-group-item${o_}, [role="tab"]${o_}`,hD='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',l_=`${TP}, ${hD}`,CP=`.${yc}[data-bs-toggle="tab"], .${yc}[data-bs-toggle="pill"], .${yc}[data-bs-toggle="list"]`;class hf extends ua{constructor(t){super(t),this._parent=this._element.closest(AP),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Jt.on(this._element,_P,e=>this._keydown(e)))}static get NAME(){return fP}show(){const t=this._element;if(this._elemIsActive(t))return;const e=this._getActiveElem(),r=e?Jt.trigger(e,dP,{relatedTarget:t}):null;Jt.trigger(t,mP,{relatedTarget:e}).defaultPrevented||r&&r.defaultPrevented||(this._deactivate(e,t),this._activate(t,e))}_activate(t,e){if(!t)return;t.classList.add(yc),this._activate(Ae.getElementFromSelector(t));const r=()=>{if(t.getAttribute("role")!=="tab"){t.classList.add(a_);return}t.removeAttribute("tabindex"),t.setAttribute("aria-selected",!0),this._toggleDropDown(t,!0),Jt.trigger(t,gP,{relatedTarget:e})};this._queueCallback(r,t,t.classList.contains(sS))}_deactivate(t,e){if(!t)return;t.classList.remove(yc),t.blur(),this._deactivate(Ae.getElementFromSelector(t));const r=()=>{if(t.getAttribute("role")!=="tab"){t.classList.remove(a_);return}t.setAttribute("aria-selected",!1),t.setAttribute("tabindex","-1"),this._toggleDropDown(t,!1),Jt.trigger(t,pP,{relatedTarget:e})};this._queueCallback(r,t,t.classList.contains(sS))}_keydown(t){if(![yP,nS,bP,rS,s_,iS].includes(t.key))return;t.stopPropagation(),t.preventDefault();const e=this._getChildren().filter(i=>!Ol(i));let r;if([s_,iS].includes(t.key))r=e[t.key===s_?0:e.length-1];else{const i=[nS,rS].includes(t.key);r=by(e,t.target,i,!0)}r&&(r.focus({preventScroll:!0}),hf.getOrCreateInstance(r).show())}_getChildren(){return Ae.find(l_,this._parent)}_getActiveElem(){return this._getChildren().find(t=>this._elemIsActive(t))||null}_setInitialAttributes(t,e){this._setAttributeIfNotExists(t,"role","tablist");for(const r of e)this._setInitialAttributesOnChild(r)}_setInitialAttributesOnChild(t){t=this._getInnerElement(t);const e=this._elemIsActive(t),r=this._getOuterElement(t);t.setAttribute("aria-selected",e),r!==t&&this._setAttributeIfNotExists(r,"role","presentation"),e||t.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(t,"role","tab"),this._setInitialAttributesOnTargetPanel(t)}_setInitialAttributesOnTargetPanel(t){const e=Ae.getElementFromSelector(t);e&&(this._setAttributeIfNotExists(e,"role","tabpanel"),t.id&&this._setAttributeIfNotExists(e,"aria-labelledby",`${t.id}`))}_toggleDropDown(t,e){const r=this._getOuterElement(t);if(!r.classList.contains(wP))return;const i=(s,a)=>{const l=Ae.findOne(s,r);l&&l.classList.toggle(a,e)};i(fD,yc),i(EP,a_),r.setAttribute("aria-expanded",e)}_setAttributeIfNotExists(t,e,r){t.hasAttribute(e)||t.setAttribute(e,r)}_elemIsActive(t){return t.classList.contains(yc)}_getInnerElement(t){return t.matches(l_)?t:Ae.findOne(l_,t)}_getOuterElement(t){return t.closest(SP)||t}static jQueryInterface(t){return this.each(function(){const e=hf.getOrCreateInstance(this);if(typeof t=="string"){if(e[t]===void 0||t.startsWith("_")||t==="constructor")throw new TypeError(`No method named "${t}"`);e[t]()}})}}Jt.on(document,vP,hD,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Ol(this)&&hf.getOrCreateInstance(this).show()});Jt.on(window,xP,()=>{for(const n of Ae.find(CP))hf.getOrCreateInstance(n)});$s(hf);const DP="toast",OP="bs.toast",Bl=`.${OP}`,RP=`mouseover${Bl}`,NP=`mouseout${Bl}`,kP=`focusin${Bl}`,LP=`focusout${Bl}`,IP=`hide${Bl}`,MP=`hidden${Bl}`,PP=`show${Bl}`,FP=`shown${Bl}`,BP="fade",aS="hide",im="show",sm="showing",UP={animation:"boolean",autohide:"boolean",delay:"number"},zP={animation:!0,autohide:!0,delay:5e3};class jg extends ua{constructor(t,e){super(t,e),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return zP}static get DefaultType(){return UP}static get NAME(){return DP}show(){if(Jt.trigger(this._element,PP).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(BP);const e=()=>{this._element.classList.remove(sm),Jt.trigger(this._element,FP),this._maybeScheduleHide()};this._element.classList.remove(aS),ep(this._element),this._element.classList.add(im,sm),this._queueCallback(e,this._element,this._config.animation)}hide(){if(!this.isShown()||Jt.trigger(this._element,IP).defaultPrevented)return;const e=()=>{this._element.classList.add(aS),this._element.classList.remove(sm,im),Jt.trigger(this._element,MP)};this._element.classList.add(sm),this._queueCallback(e,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(im),super.dispose()}isShown(){return this._element.classList.contains(im)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(t,e){switch(t.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=e;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=e;break}}if(e){this._clearTimeout();return}const r=t.relatedTarget;this._element===r||this._element.contains(r)||this._maybeScheduleHide()}_setListeners(){Jt.on(this._element,RP,t=>this._onInteraction(t,!0)),Jt.on(this._element,NP,t=>this._onInteraction(t,!1)),Jt.on(this._element,kP,t=>this._onInteraction(t,!0)),Jt.on(this._element,LP,t=>this._onInteraction(t,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){const e=jg.getOrCreateInstance(this,t);if(typeof t=="string"){if(typeof e[t]>"u")throw new TypeError(`No method named "${t}"`);e[t](this)}})}}Fg(jg);$s(jg);const yi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Dx=[.001,0,0,.001,0,0],c_=1.35,rs={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ha={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},jP="pdfjs_internal_editor_",Be={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Ke={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},dD={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Jr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},wd={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Jn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},$u={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},sp={ERRORS:0,WARNINGS:1,INFOS:5},kd={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},am={moveTo:0,lineTo:1,curveTo:2,closePath:3},pD={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Hg=sp.WARNINGS;function HP(n){Number.isInteger(n)&&(Hg=n)}function $P(){return Hg}function $g(n){Hg>=sp.INFOS&&console.log(`Info: ${n}`)}function ze(n){Hg>=sp.WARNINGS&&console.log(`Warning: ${n}`)}function Tn(n){throw new Error(n)}function ur(n,t){n||Tn(t)}function GP(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ty(n,t=null,e=null){if(!n)return null;if(e&&typeof n=="string"&&(e.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),e.tryConvertEncoding))try{n=XP(n)}catch{}const r=t?URL.parse(n,t):URL.parse(n);return GP(r)?r:null}function Cy(n,t,e=!1){const r=URL.parse(n);return r?(r.hash=t,r.href):e&&Ty(n,"http://example.com")?n.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Xe(n,t,e,r=!1){return Object.defineProperty(n,t,{value:e,enumerable:!r,configurable:!0,writable:!1}),e}const $c=function(){function t(e,r){this.message=e,this.name=r}return t.prototype=new Error,t.constructor=t,t}();class oS extends $c{constructor(t,e){super(t,"PasswordException"),this.code=e}}class u_ extends $c{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Jm extends $c{constructor(t){super(t,"InvalidPDFException")}}class Ld extends $c{constructor(t,e,r){super(t,"ResponseException"),this.status=e,this.missing=r}}class VP extends $c{constructor(t){super(t,"FormatError")}}class Bo extends $c{constructor(t){super(t,"AbortException")}}function mD(n){(typeof n!="object"||n?.length===void 0)&&Tn("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const r=[];for(let i=0;i<t;i+=e){const s=Math.min(i+e,t),a=n.subarray(i,s);r.push(String.fromCharCode.apply(null,a))}return r.join("")}function ap(n){typeof n!="string"&&Tn("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let r=0;r<t;++r)e[r]=n.charCodeAt(r)&255;return e}function WP(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function qP(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function YP(){try{return new Function(""),!0}catch{return!1}}class Or{static get isLittleEndian(){return Xe(this,"isLittleEndian",qP())}static get isEvalSupported(){return Xe(this,"isEvalSupported",YP())}static get isOffscreenCanvasSupported(){return Xe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Xe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Xe(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Xe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const f_=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class ye{static makeHexColor(t,e,r){return`#${f_[t]}${f_[e]}${f_[r]}`}static scaleMinMax(t,e){let r;t[0]?(t[0]<0&&(r=e[0],e[0]=e[2],e[2]=r),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(r=e[1],e[1]=e[3],e[3]=r),e[1]*=t[3],e[3]*=t[3]):(r=e[0],e[0]=e[1],e[1]=r,r=e[2],e[2]=e[3],e[3]=r,t[1]<0&&(r=e[1],e[1]=e[3],e[3]=r),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(r=e[0],e[0]=e[2],e[2]=r),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e,r=0){const i=t[r],s=t[r+1];t[r]=i*e[0]+s*e[2]+e[4],t[r+1]=i*e[1]+s*e[3]+e[5]}static applyTransformToBezier(t,e,r=0){const i=e[0],s=e[1],a=e[2],l=e[3],u=e[4],f=e[5];for(let d=0;d<6;d+=2){const p=t[r+d],m=t[r+d+1];t[r+d]=p*i+m*a+u,t[r+d+1]=p*s+m*l+f}}static applyInverseTransform(t,e){const r=t[0],i=t[1],s=e[0]*e[3]-e[1]*e[2];t[0]=(r*e[3]-i*e[2]+e[2]*e[5]-e[4]*e[3])/s,t[1]=(-r*e[1]+i*e[0]+e[4]*e[1]-e[5]*e[0])/s}static axialAlignedBoundingBox(t,e,r){const i=e[0],s=e[1],a=e[2],l=e[3],u=e[4],f=e[5],d=t[0],p=t[1],m=t[2],v=t[3];let x=i*d+u,_=x,y=i*m+u,w=y,S=l*p+f,T=S,C=l*v+f,R=C;if(s!==0||a!==0){const N=s*d,D=s*m,I=a*p,M=a*v;x+=I,w+=I,y+=M,_+=M,S+=N,R+=N,C+=D,T+=D}r[0]=Math.min(r[0],x,y,_,w),r[1]=Math.min(r[1],S,C,T,R),r[2]=Math.max(r[2],x,y,_,w),r[3]=Math.max(r[3],S,C,T,R)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const r=t[0],i=t[1],s=t[2],a=t[3],l=r**2+i**2,u=r*s+i*a,f=s**2+a**2,d=(l+f)/2,p=Math.sqrt(d**2-(l*f-u**2));e[0]=Math.sqrt(d+p||1),e[1]=Math.sqrt(d-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const r=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(r>i)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>a?null:[r,s,i,a]}static pointBoundingBox(t,e,r){r[0]=Math.min(r[0],t),r[1]=Math.min(r[1],e),r[2]=Math.max(r[2],t),r[3]=Math.max(r[3],e)}static rectBoundingBox(t,e,r,i,s){s[0]=Math.min(s[0],t,r),s[1]=Math.min(s[1],e,i),s[2]=Math.max(s[2],t,r),s[3]=Math.max(s[3],e,i)}static#t(t,e,r,i,s,a,l,u,f,d){if(f<=0||f>=1)return;const p=1-f,m=f*f,v=m*f,x=p*(p*(p*t+3*f*e)+3*m*r)+v*i,_=p*(p*(p*s+3*f*a)+3*m*l)+v*u;d[0]=Math.min(d[0],x),d[1]=Math.min(d[1],_),d[2]=Math.max(d[2],x),d[3]=Math.max(d[3],_)}static#e(t,e,r,i,s,a,l,u,f,d,p,m){if(Math.abs(f)<1e-12){Math.abs(d)>=1e-12&&this.#t(t,e,r,i,s,a,l,u,-p/d,m);return}const v=d**2-4*p*f;if(v<0)return;const x=Math.sqrt(v),_=2*f;this.#t(t,e,r,i,s,a,l,u,(-d+x)/_,m),this.#t(t,e,r,i,s,a,l,u,(-d-x)/_,m)}static bezierBoundingBox(t,e,r,i,s,a,l,u,f){f[0]=Math.min(f[0],t,l),f[1]=Math.min(f[1],e,u),f[2]=Math.max(f[2],t,l),f[3]=Math.max(f[3],e,u),this.#e(t,r,s,l,e,i,a,u,3*(-t+3*(r-s)+l),6*(t-2*r+s),3*(r-t),f),this.#e(t,r,s,l,e,i,a,u,3*(-e+3*(i-a)+u),6*(e-2*i+a),3*(i-e),f)}}function XP(n){return decodeURIComponent(escape(n))}let h_=null,lS=null;function gD(n){return h_||(h_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,lS=new Map([["ﬅ","ſt"]])),n.replaceAll(h_,(t,e,r)=>e?e.normalize("NFKC"):lS.get(r))}function Dy(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),mD(n)}const Oy="pdfjs_internal_id_";function KP(n,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[r,i,...s]=e;if(!n(r)&&!Number.isInteger(r)||!t(i))return!1;const a=s.length;let l=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const u of s)if(!(typeof u=="number"||l&&u===null))return!1;return!0}function ti(n,t,e){return Math.min(Math.max(n,t),e)}function vD(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(mD(n))}function ZP(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):ap(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((t,e)=>t+e,0)});const Co="http://www.w3.org/2000/svg";class Rc{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Sf(n,t="text"){if(pd(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,r)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(i.response);return}e(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class op{constructor({viewBox:t,userUnit:e,scale:r,rotation:i,offsetX:s=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=e,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=a,r*=e;const u=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let d,p,m,v;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,p=0,m=0,v=1;break;case 90:d=0,p=1,m=1,v=0;break;case 270:d=0,p=-1,m=-1,v=0;break;case 0:d=1,p=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,v=-v);let x,_,y,w;d===0?(x=Math.abs(f-t[1])*r+s,_=Math.abs(u-t[0])*r+a,y=(t[3]-t[1])*r,w=(t[2]-t[0])*r):(x=Math.abs(u-t[0])*r+s,_=Math.abs(f-t[1])*r+a,y=(t[2]-t[0])*r,w=(t[3]-t[1])*r),this.transform=[d*r,p*r,m*r,v*r,x-d*r*u-m*r*f,_-p*r*u-v*r*f],this.width=y,this.height=w}get rawDims(){const t=this.viewBox;return Xe(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new op({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:r,offsetY:i,dontFlip:s})}convertToViewportPoint(t,e){const r=[t,e];return ye.applyTransform(r,this.transform),r}convertToViewportRectangle(t){const e=[t[0],t[1]];ye.applyTransform(e,this.transform);const r=[t[2],t[3]];return ye.applyTransform(r,this.transform),[e[0],e[1],r[0],r[1]]}convertToPdfPoint(t,e){const r=[t,e];return ye.applyInverseTransform(r,this.transform),r}}class Gg extends $c{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function lp(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function Vg(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function _D(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function xD(n,t="document.pdf"){if(typeof n!="string")return t;if(lp(n))return ze('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=e.exec(n);let s=r.exec(i[1])||r.exec(i[2])||r.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=r.exec(decodeURIComponent(s))[0]}catch{}return s||t}class cS{started=Object.create(null);times=[];time(t){t in this.started&&ze(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ze(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:r}of this.times)e=Math.max(r.length,e);for(const{name:r,start:i,end:s}of this.times)t.push(`${r.padEnd(e)} ${s-i}ms
`);return t.join("")}}function pd(n,t){const e=t?URL.parse(n,t):URL.parse(n);return e?.protocol==="http:"||e?.protocol==="https:"}function Hs(n){n.preventDefault()}function er(n){n.preventDefault(),n.stopPropagation()}function QP(n){console.log("Deprecated API usage: "+n)}class Ry{static#t;static toDateObject(t){if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const r=parseInt(e[1],10);let i=parseInt(e[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(e[5],10);l=l>=0&&l<=59?l:0;let u=parseInt(e[6],10);u=u>=0&&u<=59?u:0;const f=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,f==="-"?(a+=d,l+=p):f==="+"&&(a-=d,l-=p),new Date(Date.UTC(r,i,s,a,l,u))}}function yD(n,{scale:t=1,rotation:e=0}){const{width:r,height:i}=n.attributes.style,s=[0,0,parseInt(r),parseInt(i)];return new op({viewBox:s,userUnit:1,scale:t,rotation:e})}function Ny(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ze(`Not a valid color format: "${n}"`),[0,0,0])}function JP(n){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of n.keys()){t.style.color=e;const r=window.getComputedStyle(t).color;n.set(e,Ny(r))}t.remove()}function $n(n){const{a:t,b:e,c:r,d:i,e:s,f:a}=n.getTransform();return[t,e,r,i,s,a]}function ka(n){const{a:t,b:e,c:r,d:i,e:s,f:a}=n.getTransform().invertSelf();return[t,e,r,i,s,a]}function Nl(n,t,e=!1,r=!0){if(t instanceof op){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:a}=n,l=Or.isCSSRoundSupported,u=`var(--total-scale-factor) * ${i}px`,f=`var(--total-scale-factor) * ${s}px`,d=l?`round(down, ${u}, var(--scale-round-x))`:`calc(${u})`,p=l?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(a.width=d,a.height=p):(a.width=p,a.height=d)}r&&n.setAttribute("data-main-rotation",t.rotation)}class ca{constructor(){const{pixelRatio:t}=ca;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,r,i,s=-1){let a=1/0,l=1/0,u=1/0;r=ca.capPixels(r,s),r>0&&(a=Math.sqrt(r/(t*e))),i!==-1&&(l=i/t,u=i/e);const f=Math.min(a,l,u);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,r):r}return t}}const tg=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Ed{#t=null;#e=null;#n;#r=null;#s=null;#i=null;static#l=null;constructor(t){this.#n=t,Ed.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;t.addEventListener("contextmenu",Hs,{signal:e}),t.addEventListener("pointerdown",Ed.#o,{signal:e});const r=this.#r=document.createElement("div");r.className="buttons",t.append(r);const i=this.#n.toolbarPosition;if(i){const{style:s}=t,a=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),t}get div(){return this.#t}static#o(t){t.stopPropagation()}#f(t){this.#n._focusEventsAllowed=!1,er(t)}#c(t){this.#n._focusEventsAllowed=!0,er(t)}#h(t){const e=this.#n._uiManager._signal;t.addEventListener("focusin",this.#f.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Hs,{signal:e})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown()}#u(){const{editorType:t,_uiManager:e}=this.#n,r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",Ed.#l[t]),this.#h(r),r.addEventListener("click",i=>{e.delete()},{signal:e._signal}),this.#r.append(r)}get#d(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#h(e),this.#r.prepend(e,this.#d),this.#s=t}addColorPicker(t){this.#e=t;const e=t.renderButton();this.#h(e),this.#r.prepend(e,this.#d)}async addEditSignatureButton(t){const e=this.#i=await t.renderEditButton(this.#n);this.#h(e),this.#r.prepend(e,this.#d)}updateEditSignatureButton(t){this.#i&&(this.#i.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class tF{#t=null;#e=null;#n;constructor(t){this.#n=t}#r(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Hs,{signal:this.#n._signal});const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#i(),t}#s(t,e){let r=0,i=0;for(const s of t){const a=s.y+s.height;if(a<r)continue;const l=s.x+(e?s.width:0);if(a>r){i=l,r=a;continue}e?l>i&&(i=l):l<i&&(i=l)}return[e?1-i:i,r]}show(t,e,r){const[i,s]=this.#s(e,r),{style:a}=this.#e||=this.#r();t.append(this.#e),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#i(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const r=this.#n._signal;t.addEventListener("contextmenu",Hs,{signal:r}),t.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:r}),this.#t.append(t)}}function bD(n,t,e){for(const r of e)t.addEventListener(r,n[r].bind(n))}class eF{#t=0;get id(){return`${jP}${this.#t++}`}}class ky{#t=Dy();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=t;const s=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Xe(this,"_isSVGFittingCanvas",s)}async#r(t,e){this.#n||=new Map;let r=this.#n.get(t);if(r===null)return null;if(r?.bitmap)return r.refCounter+=1,r;try{r||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let i;if(typeof e=="string"?(r.url=e,i=await Sf(e,"blob")):e instanceof File?i=r.file=e:e instanceof Blob&&(i=e),i.type==="image/svg+xml"){const s=ky._isSVGFittingCanvas,a=new FileReader,l=new Image,u=new Promise((f,d)=>{l.onload=()=>{r.bitmap=l,r.isSvg=!0,f()},a.onload=async()=>{const p=r.svgUrl=a.result;l.src=await s?`${p}#svgView(preserveAspectRatio(none))`:p},l.onerror=a.onerror=d});a.readAsDataURL(i),await u}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){ze(i),r=null}return this.#n.set(t,r),r&&this.#n.set(r.id,r),r}async getFromFile(t){const{lastModified:e,name:r,size:i,type:s}=t;return this.#r(`${e}_${r}_${i}_${s}`,t)}async getFromUrl(t){return this.#r(t,t)}async getFromBlob(t,e){const r=await e;return this.#r(t,r)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:r}=e;return delete e.blobPromise,this.getFromBlob(e.id,r)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let r=this.#n.get(t);if(r?.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(e.width,e.height);return i.getContext("2d").drawImage(e,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,r),this.#n.set(r.id,r),r}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:r}=e;if(!e.url&&!e.file){const i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),e.blobPromise=i.convertToBlob()}r.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class nF{#t=[];#e=!1;#n;#r=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:r,mustExec:i,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(i&&t(),this.#e)return;const u={cmd:t,undo:e,post:r,type:s};if(this.#r===-1){this.#t.length>0&&(this.#t.length=0),this.#r=0,this.#t.push(u);return}if(a&&this.#t[this.#r].type===s){l&&(u.undo=this.#t[this.#r].undo),this.#t[this.#r]=u;return}const f=this.#r+1;f===this.#n?this.#t.splice(0,1):(this.#r=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(u)}undo(){if(this.#r===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#r];t(),e?.(),this.#e=!1,this.#r-=1}redo(){if(this.#r<this.#t.length-1){this.#r+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#r];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#t.length-1}cleanType(t){if(this.#r!==-1){for(let e=this.#r;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#r-e),this.#r=e;return}this.#t.length=0,this.#r=-1}}destroy(){this.#t=null}}class cp{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Or.platform;for(const[r,i,s={}]of t)for(const a of r){const l=a.startsWith("mac+");e&&l?(this.callbacks.set(a.slice(4),{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1))):!e&&!l&&(this.callbacks.set(a,{callback:i,options:s}),this.allKeys.add(a.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const r=this.callbacks.get(this.#t(e));if(!r)return;const{callback:i,options:{bubbles:s=!1,args:a=[],checker:l=null}}=r;l&&!l(t,e)||(i.bind(t,...a,e)(),s||er(e))}}class Ly{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return JP(t),Xe(this,"_colors",t)}convert(t){const e=Ny(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[r,i]of this._colors)if(i.every((s,a)=>s===e[a]))return Ly._colorsMapping.get(r);return e}getHexCode(t){const e=this._colors.get(t);return e?ye.makeHexColor(...e):t}}class Uo{#t=new AbortController;#e=null;#n=new Map;#r=new Map;#s=null;#i=null;#l=null;#o=new nF;#f=null;#c=null;#h=0;#u=new Set;#d=null;#a=null;#p=new Set;_editorUndoBar=null;#g=!1;#m=!1;#v=!1;#_=null;#x=null;#b=null;#E=null;#S=!1;#C=null;#O=new eF;#w=!1;#D=!1;#T=null;#N=null;#k=null;#L=null;#z=null;#A=Be.NONE;#y=new Set;#F=null;#B=null;#$=null;#G=null;#V={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#I=null;#M=null;#H=null;#P=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Uo.prototype,e=a=>a.#M.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:u}=l;return u!=="text"&&u!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Xe(this,"_keyboardManager",new cp([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],t.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:r}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#M.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#M.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}constructor(t,e,r,i,s,a,l,u,f,d,p,m,v,x){const _=this._signal=this.#t.signal;this.#M=t,this.#H=e,this.#s=r,this.#B=i,this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:_}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),s._on("setpreference",this.onSetPreference.bind(this),{signal:_}),s._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:_}),this.#rt(),this.#ot(),this.#K(),this.#i=a.annotationStorage,this.#_=a.filterFactory,this.#$=l,this.#E=u||null,this.#g=f,this.#m=d,this.#v=p,this.#z=m||null,this.viewParameters={realScale:Rc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=x!==!1}destroy(){this.#P?.resolve(),this.#P=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#r.values())t.destroy();this.#r.clear(),this.#n.clear(),this.#p.clear(),this.#L?.clear(),this.#e=null,this.#y.clear(),this.#o.destroy(),this.#s?.destroy(),this.#B?.destroy(),this.#C?.hide(),this.#C=null,this.#k?.destroy(),this.#k=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#I&&(clearTimeout(this.#I),this.#I=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#z}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Xe(this,"hcmFilter",this.#$?this.#_.addHCMFilter(this.#$.foreground,this.#$.background):"none")}get direction(){return Xe(this,"direction",getComputedStyle(this.#M).direction)}get highlightColors(){return Xe(this,"highlightColors",this.#E?new Map(this.#E.split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Xe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#k=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}getSignature(t){this.#B?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#B}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=e;break}}onPageChanging({pageNumber:t}){this.#h=t-1}focusMainContainer(){this.#M.focus()}findParent(t,e){for(const r of this.#r.values()){const{x:i,y:s,width:a,height:l}=r.div.getBoundingClientRect();if(t>=i&&t<=i+a&&e>=s&&e<=s+l)return r}return null}disableUserSelect(t=!1){this.#H.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Rc.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#X(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const r of this.#r.values())if(r.hasTextLayer(t))return r;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:a}=e,l=e.toString(),f=this.#q(e).closest(".textLayer"),d=this.getSelectionBoxes(f);if(!d)return;e.empty();const p=this.#X(f),m=this.#A===Be.NONE,v=()=>{p?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:a,text:l}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Be.HIGHLIGHT,v);return}v()}#et(){const t=document.getSelection();if(!t||t.isCollapsed)return;const r=this.#q(t).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(this.#C||=new tF(this),this.#C.show(r,i,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#i&&!this.#i.has(t.id)&&this.#i.setValue(t.id,t)}#nt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#F&&(this.#C?.hide(),this.#F=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#F)return;const i=this.#q(t).closest(".textLayer");if(!i){this.#F&&(this.#C?.hide(),this.#F=null,this.#R({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#F=e,this.#R({hasSelectedText:!0}),!(this.#A!==Be.HIGHLIGHT&&this.#A!==Be.NONE)&&(this.#A===Be.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const s=this.#A===Be.HIGHLIGHT?this.#X(i):null;s?.toggleDrawing();const a=new AbortController,l=this.combinedSignal(a),u=f=>{f.type==="pointerup"&&f.button!==0||(a.abort(),s?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",u,{signal:l}),window.addEventListener("blur",u,{signal:l})}}#Y(t=""){this.#A===Be.HIGHLIGHT?this.highlightSelection(t):this.#g&&this.#et()}#rt(){document.addEventListener("selectionchange",this.#nt.bind(this),{signal:this._signal})}#it(){if(this.#b)return;this.#b=new AbortController;const t=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#st(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#y)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#K(){if(this.#T)return;this.#T=new AbortController;const t=this.combinedSignal(this.#T);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#at(){this.#T?.abort(),this.#T=null}#Z(){if(this.#f)return;this.#f=new AbortController;const t=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#Q(){this.#f?.abort(),this.#f=null}#ot(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#K(),this.#Z()}removeEditListeners(){this.#at(),this.#Q()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const r of this.#a)if(r.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const r of this.#a)if(r.isHandlingMimeForPasting(e.type)){r.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const r of this.#y){const i=r.serialize(!0);i&&e.push(i)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const a of this.#a)if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let r=e.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){ze(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const u of r){const f=await i.deserialize(u);if(!f)return;s.push(f)}const a=()=>{for(const u of s)this.#J(u);this.#tt(s)},l=()=>{for(const u of s)u.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(s){ze(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#A!==Be.NONE&&!this.isEditorHandlingKeyboard&&Uo._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#R(t){Object.entries(t).some(([r,i])=>this.#V[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#V,t)}),this.#A===Be.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#U([[Ke.HIGHLIGHT_FREE,!0]]))}#U(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#it(),this.#Z(),this.#R({isEditing:this.#A!==Be.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#st(),this.#Q(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#a){this.#a=t;for(const e of this.#a)this.#U(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#r.get(this.#h)}getLayer(t){return this.#r.get(t)}get currentPageIndex(){return this.#h}addLayer(t){this.#r.set(t.pageIndex,t),this.#w?t.enable():t.disable()}removeLayer(t){this.#r.delete(t.pageIndex)}async updateMode(t,e=null,r=!1){if(this.#A!==t&&!(this.#P&&(await this.#P.promise,!this.#P))){if(this.#P=Promise.withResolvers(),this.#c?.commitOrRemove(),this.#A=t,t===Be.NONE){this.setEditingState(!1),this.#ct(),this._editorUndoBar?.hide(),this.#P.resolve();return}t===Be.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#lt(),this.unselectAll();for(const i of this.#r.values())i.updateMode(t);if(!e){r&&this.addNewEditorFromKeyboard(),this.#P.resolve();return}for(const i of this.#n.values())i.annotationElementId===e||i.id===e?(this.setSelected(i),i.enterInEditMode()):i.unselect();this.#P.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#A&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#a){switch(t){case Ke.CREATE:this.currentLayer.addNewEditor(e);return;case Ke.HIGHLIGHT_DEFAULT_COLOR:this.#k?.updateColor(e);break;case Ke.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const r of this.#y)r.updateParams(t,e);for(const r of this.#a)r.updateDefaultParams(t,e)}}showAllEditors(t,e,r=!1){for(const s of this.#n.values())s.editorType===t&&s.show(e);(this.#G?.get(Ke.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#U([[Ke.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#D!==t){this.#D=t;for(const e of this.#r.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#lt(){if(!this.#w){this.#w=!0;const t=[];for(const e of this.#r.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#ct(){if(this.unselectAll(),this.#w){this.#w=!1;for(const t of this.#r.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const r of this.#n.values())r.pageIndex===t&&e.push(r);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#L?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#u.has(t.annotationElementId))&&this.#i?.remove(t.id)}addDeletedAnnotationElement(t){this.#u.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#u.has(t)}removeDeletedAnnotationElement(t){this.#u.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#J(t){const e=this.#r.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#U(t.propertiesToUpdate))}get#ut(){let t=null;for(t of this.#y);return t}updateUI(t){this.#ut===t&&this.#U(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#U(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#y.has(t)){this.#y.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#y.add(t),t.select(),this.#U(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.#c?.commitOrRemove();for(const e of this.#y)e!==t&&e.unselect();this.#y.clear(),this.#y.add(t),t.select(),this.#U(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#y.has(t)}get firstSelectedEditor(){return this.#y.values().next().value}unselect(t){t.unselect(),this.#y.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#y.size!==0}get isEnterHandled(){return this.#y.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#R({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(t){this.#o.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(t){this.#o.cleanType(t)}#W(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#y],r=()=>{this._editorUndoBar?.show(i,e.length===1?e[0].editorType:e.length);for(const s of e)s.remove()},i=()=>{for(const s of e)this.#J(s)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#tt(t){for(const e of this.#y)e.unselect();this.#y.clear();for(const e of t)e.isEmpty()||(this.#y.add(e),e.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#y)t.commit();this.#tt(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#A!==Be.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const t of this.#y)t.unselect();this.#y.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=e;const[i,s]=this.#j,a=[...this.#y],l=1e3;this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(const u of a)this.#n.has(u.id)&&(u.translateInPage(i,s),u.translationDone())},undo:()=>{for(const u of a)this.#n.has(u.id)&&(u.translateInPage(-i,-s),u.translationDone())},mustExec:!1})},l);for(const u of a)u.translateInPage(t,e),u.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#d=new Map;for(const t of this.#y)this.#d.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#d)return!1;this.disableUserSelect(!1);const t=this.#d;this.#d=null;let e=!1;for(const[{x:i,y:s,pageIndex:a},l]of t)l.newX=i,l.newY=s,l.newPageIndex=a,e||=i!==l.savedX||s!==l.savedY||a!==l.savedPageIndex;if(!e)return!1;const r=(i,s,a,l)=>{if(this.#n.has(i.id)){const u=this.#r.get(l);u?i._setParentAndPosition(u,s,a):(i.pageIndex=l,i.x=s,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:a,newPageIndex:l}]of t)r(i,s,a,l)},undo:()=>{for(const[i,{savedX:s,savedY:a,savedPageIndex:l}]of t)r(i,s,a,l)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#d)for(const r of this.#d.keys())r.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#y.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#A}get imageManager(){return Xe(this,"imageManager",new ky)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,d=e.rangeCount;f<d;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:r,y:i,width:s,height:a}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(f,d,p,m)=>({x:(d-i)/a,y:1-(f+p-r)/s,width:m/a,height:p/s});break;case"180":l=(f,d,p,m)=>({x:1-(f+p-r)/s,y:1-(d+m-i)/a,width:p/s,height:m/a});break;case"270":l=(f,d,p,m)=>({x:1-(d+m-i)/a,y:(f-r)/s,width:m/a,height:p/s});break;default:l=(f,d,p,m)=>({x:(f-r)/s,y:(d-i)/a,width:p/s,height:m/a});break}const u=[];for(let f=0,d=e.rangeCount;f<d;f++){const p=e.getRangeAt(f);if(!p.collapsed)for(const{x:m,y:v,width:x,height:_}of p.getClientRects())x===0||_===0||u.push(l(m,v,x,_))}return u.length===0?null:u}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#l||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const e=this.#l?.get(t.data.id);if(!e)return;const r=this.#i.getRawValue(e);r&&(this.#A===Be.NONE&&!r.hasBeenModified||r.renderAnnotationElement(t))}setMissingCanvas(t,e,r){const i=this.#L?.get(t);i&&(i.setCanvas(e,r),this.#L.delete(t))}addMissingCanvas(t,e){(this.#L||=new Map).set(t,e)}}class Ba{#t=null;#e=!1;#n=null;#r=null;#s=null;#i=null;#l=!1;#o=null;#f=null;#c=null;#h=null;#u=!1;static#d=null;static _l10n=null;constructor(t){this.#f=t,this.#u=t._uiManager.useNewAltTextFlow,Ba.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ba._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#r=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ba.#d.missing),e.setAttribute("data-l10n-id",Ba.#d["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=this.#f._uiManager._signal;t.addEventListener("contextmenu",Hs,{signal:r}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const i=s=>{s.preventDefault(),this.#f._uiManager.editAltText(this.#f),this.#u&&this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return t.addEventListener("click",i,{capture:!0,signal:r}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(this.#l=!0,i(s))},{signal:r}),await this.#p(),t}get#a(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#h=await Ba._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#f.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#h),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#h}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:r,textWithDisclaimer:i,cancel:s=!1}){r&&(this.#c=r,this.#h=i),!(this.#t===t&&this.#e===e)&&(s||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#n.disabled=!t)}shown(){this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#n?.remove(),this.#n=null,this.#r=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ba.#d[this.#a]),this.#r?.setAttribute("data-l10n-id",Ba.#d[`${this.#a}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#f.id}`;const i=100,s=this.#f._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#s.classList.add("show"),this.#f._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:s}),t.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#s?.classList.remove("show")},{signal:s})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#f.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class up{#t;#e=!1;#n=null;#r;#s;#i;#l;#o=null;#f;#c=null;#h;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:a=null,signal:l}){this.#t=t,this.#n=r,this.#r=e,this.#s=i,this.#i=s,this.#l=a,this.#h=new AbortController,this.#f=AbortSignal.any([l,this.#h.signal]),t.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#f})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ca.pixelRatio}#d(t){if(this.#r?.())return;if(t.touches.length===1){if(this.#o)return;const i=this.#o=new AbortController,s=AbortSignal.any([this.#f,i.signal]),a=this.#t,l={capture:!0,signal:s,passive:!1},u=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};a.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(er(f),u(f))},l),a.addEventListener("pointerup",u,l),a.addEventListener("pointercancel",u,l);return}if(!this.#u){this.#u=new AbortController;const i=AbortSignal.any([this.#f,this.#u.signal]),s=this.#t,a={signal:i,capture:!1,passive:!1};s.addEventListener("touchmove",this.#a.bind(this),a);const l=this.#p.bind(this);s.addEventListener("touchend",l,a),s.addEventListener("touchcancel",l,a),a.capture=!0,s.addEventListener("pointerdown",er,a),s.addEventListener("pointermove",er,a),s.addEventListener("pointercancel",er,a),s.addEventListener("pointerup",er,a),this.#s?.()}if(er(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,r]=t.touches;e.identifier>r.identifier&&([e,r]=[r,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:r.screenX,touch1Y:r.screenY}}#a(t){if(!this.#c||t.touches.length!==2)return;er(t);let[e,r]=t.touches;e.identifier>r.identifier&&([e,r]=[r,e]);const{screenX:i,screenY:s}=e,{screenX:a,screenY:l}=r,u=this.#c,{touch0X:f,touch0Y:d,touch1X:p,touch1Y:m}=u,v=p-f,x=m-d,_=a-i,y=l-s,w=Math.hypot(_,y)||1,S=Math.hypot(v,x)||1;if(!this.#e&&Math.abs(S-w)<=up.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(u.touch0X=i,u.touch0Y=s,u.touch1X=a,u.touch1Y=l,!this.#e){this.#e=!0;return}const T=[(i+a)/2,(s+l)/2];this.#i?.(T,S,w)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#l?.()),this.#c&&(er(t),this.#c=null,this.#e=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class Se{#t=null;#e=null;#n=null;#r=!1;#s=null;#i="";#l=!1;#o=null;#f=null;#c=null;#h=null;#u="";#d=!1;#a=null;#p=!1;#g=!1;#m=!1;#v=null;#_=0;#x=0;#b=null;#E=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#C=Se._zIndex++;static _borderLineWidth=-1;static _colorManager=new Ly;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Se.prototype._resizeWithKeyboard,e=Uo.TRANSLATE_SMALL,r=Uo.TRANSLATE_BIG;return Xe(this,"_resizerKeyboardManager",new cp([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,r]}],[["Escape","mac+Escape"],Se.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:r,pageHeight:i,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[s,a];const[l,u]=this.parentDimensions;this.x=t.x/l,this.y=t.y/u,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Xe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new rF({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Se._l10n??=t,Se._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Se._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);Se._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Tn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#H(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#d?this.#d=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,r,i){const[s,a]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(t+r)/s,this.y=(e+i)/a,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[r,i]=this.parentDimensions;this.setAt(t*r,e*i,this.width*r,this.height*i),this._onTranslated()}#O([t,e],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/t,this.y+=i/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#O(this.parentDimensions,t,e)}translateInPage(t,e){this.#a||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#a||=[this.x,this.y,this.width,this.height];const{div:r,parentDimensions:[i,s]}=this;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[u,f]=this.getBaseTranslation();a+=u,l+=f;const{style:d}=r;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),r.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:r}=Se,i=r/t,s=r/e;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[r,i]}=this;let{x:s,y:a,width:l,height:u}=this;if(l*=r,u*=i,s*=r,a*=i,this._mustFixPosition)switch(t){case 0:s=ti(s,0,r-l),a=ti(a,0,i-u);break;case 90:s=ti(s,0,r-u),a=ti(a,l,i);break;case 180:s=ti(s,l,r),a=ti(a,u,i);break;case 270:s=ti(s,u,r),a=ti(a,0,i-l);break}this.x=s/=r,this.y=a/=i;const[f,d]=this.getBaseTranslation();s+=f,a+=d,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#w(t,e,r){switch(r){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Se.#w(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Se.#w(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,r]=this.pageDimensions;return[0,-e/r,r/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,r]=this.pageDimensions;return[0,e/r,-r/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,r]}=this;return[e*t,r*t]}setDims(t,e){const[r,i]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*t/r).toFixed(2)}%`,this.#l||(s.height=`${(100*e/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:r}=t,i=r.endsWith("%"),s=!this.#l&&e.endsWith("%");if(i&&s)return;const[a,l]=this.parentDimensions;i||(t.width=`${(100*parseFloat(r)/a).toFixed(2)}%`),!this.#l&&!s&&(t.height=`${(100*parseFloat(e)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#T(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const r of t){const i=document.createElement("div");this.#o.append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",this.#N.bind(this,r),{signal:e}),i.addEventListener("contextmenu",Hs,{signal:e}),i.tabIndex=-1}this.div.prepend(this.#o)}#N(t,e){e.preventDefault();const{isMac:r}=Or.platform;if(e.button!==0||e.ctrlKey&&r)return;this.#n?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#f=[e.screenX,e.screenY];const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#z.bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",er,{passive:!1,signal:a}),window.addEventListener("contextmenu",Hs,{signal:a}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const l=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=u,this.#L()};window.addEventListener("pointerup",f,{signal:a}),window.addEventListener("blur",f,{signal:a})}#k(t,e,r,i){this.width=r,this.height=i,this.x=t,this.y=e;const[s,a]=this.parentDimensions;this.setDims(s*r,a*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#L(){if(!this.#c)return;const{savedX:t,savedY:e,savedWidth:r,savedHeight:i}=this.#c;this.#c=null;const s=this.x,a=this.y,l=this.width,u=this.height;s===t&&a===e&&l===r&&u===i||this.addCommands({cmd:this.#k.bind(this,s,a,l,u),undo:this.#k.bind(this,t,e,r,i),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#z(t,e){const[r,i]=this.parentDimensions,s=this.x,a=this.y,l=this.width,u=this.height,f=Se.MIN_SIZE/r,d=Se.MIN_SIZE/i,p=this.#D(this.rotation),m=(Z,q)=>[p[0]*Z+p[2]*q,p[1]*Z+p[3]*q],v=this.#D(360-this.rotation),x=(Z,q)=>[v[0]*Z+v[2]*q,v[1]*Z+v[3]*q];let _,y,w=!1,S=!1;switch(t){case"topLeft":w=!0,_=(Z,q)=>[0,0],y=(Z,q)=>[Z,q];break;case"topMiddle":_=(Z,q)=>[Z/2,0],y=(Z,q)=>[Z/2,q];break;case"topRight":w=!0,_=(Z,q)=>[Z,0],y=(Z,q)=>[0,q];break;case"middleRight":S=!0,_=(Z,q)=>[Z,q/2],y=(Z,q)=>[0,q/2];break;case"bottomRight":w=!0,_=(Z,q)=>[Z,q],y=(Z,q)=>[0,0];break;case"bottomMiddle":_=(Z,q)=>[Z/2,q],y=(Z,q)=>[Z/2,0];break;case"bottomLeft":w=!0,_=(Z,q)=>[0,q],y=(Z,q)=>[Z,0];break;case"middleLeft":S=!0,_=(Z,q)=>[0,q/2],y=(Z,q)=>[Z,q/2];break}const T=_(l,u),C=y(l,u);let R=m(...C);const N=Se._round(s+R[0]),D=Se._round(a+R[1]);let I=1,M=1,B,H;if(e.fromKeyboard)({deltaX:B,deltaY:H}=e);else{const{screenX:Z,screenY:q}=e,[Ct,at]=this.#f;[B,H]=this.screenToPageTranslation(Z-Ct,q-at),this.#f[0]=Z,this.#f[1]=q}if([B,H]=x(B/r,H/i),w){const Z=Math.hypot(l,u);I=M=Math.max(Math.min(Math.hypot(C[0]-T[0]-B,C[1]-T[1]-H)/Z,1/l,1/u),f/l,d/u)}else S?I=ti(Math.abs(C[0]-T[0]-B),f,1)/l:M=ti(Math.abs(C[1]-T[1]-H),d,1)/u;const F=Se._round(l*I),rt=Se._round(u*M);R=m(...y(F,rt));const L=N-R[0],it=D-R[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=F,this.height=rt,this.x=L,this.y=it,this.setDims(r*F,i*rt),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#g?this._editToolbar:(this._editToolbar=new Ed(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(Ba.initialize(Se._l10n),this.#n=new Ba(this),this.#t&&(this.#n.data=this.#t,this.#t=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#G();const[e,r]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*r/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/r).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),bD(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#E||=new up({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#A.bind(this),onPinching:this.#y.bind(this),onPinchEnd:this.#F.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#A(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#y(t,e,r){let s=.7*(r/e)+1-.7;if(s===1)return;const a=this.#D(this.rotation),l=(N,D)=>[a[0]*N+a[2]*D,a[1]*N+a[3]*D],[u,f]=this.parentDimensions,d=this.x,p=this.y,m=this.width,v=this.height,x=Se.MIN_SIZE/u,_=Se.MIN_SIZE/f;s=Math.max(Math.min(s,1/m,1/v),x/m,_/v);const y=Se._round(m*s),w=Se._round(v*s);if(y===m&&w===v)return;this.#a||=[d,p,m,v];const S=l(m/2,v/2),T=Se._round(d+S[0]),C=Se._round(p+S[1]),R=l(y/2,w/2);this.x=T-R[0],this.y=C-R[1],this.width=y,this.height=w,this.setDims(u*y,f*w),this.fixAndSetPosition(),this._onResizing()}#F(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#L()}pointerdown(t){const{isMac:e}=Or.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#d=!0,this._isDraggable){this.#$(t);return}this.#B(t)}#B(t){const{isMac:e}=Or.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:s},l=f=>{i.abort(),this.#s=null,this.#d=!1,this._uiManager.endDragSession()||this.#B(f),r&&this._onStopDragging()};e&&(this.#_=t.clientX,this.#x=t.clientY,this.#s=t.pointerId,this.#i=t.pointerType,window.addEventListener("pointermove",f=>{r||(r=!0,this._onStartDragging());const{clientX:d,clientY:p,pointerId:m}=f;if(m!==this.#s){er(f);return}const[v,x]=this.screenToPageTranslation(d-this.#_,p-this.#x);this.#_=d,this.#x=p,this._uiManager.dragSelectedEditors(v,x)},a),window.addEventListener("touchmove",er,a),window.addEventListener("pointerdown",f=>{f.pointerType===this.#i&&(this.#E||f.isPrimary)&&l(f),er(f)},a));const u=f=>{if(!this.#s||this.#s===f.pointerId){l(f);return}er(f)};window.addEventListener("pointerup",u,{signal:s}),window.addEventListener("blur",u,{signal:s})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,r){t.changeParent(this),this.x=e,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,r=this.rotation){const i=this.parentScale,[s,a]=this.pageDimensions,[l,u]=this.pageTranslation,f=t/i,d=e/i,p=this.x*s,m=this.y*a,v=this.width*s,x=this.height*a;switch(r){case 0:return[p+f+l,a-m-d-x+u,p+f+v+l,a-m-d+u];case 90:return[p+d+l,a-m+f+u,p+d+x+l,a-m+f+v+u];case 180:return[p-f-v+l,a-m+d+u,p-f+l,a-m+d+x+u];case 270:return[p-d-x+l,a-m-f-v+u,p-d+l,a-m-f+u];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[r,i,s,a]=t,l=s-r,u=a-i;switch(this.rotation){case 0:return[r,e-a,l,u];case 90:return[r,e-i,u,l];case 180:return[s,e-i,l,u];case 270:return[s,e-a,u,l];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#g=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#g=!1,!0):!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#m}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return e<a&&i>0&&t<s&&r>0}#G(){if(this.#h||!this.div)return;this.#h=new AbortController;const t=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#G()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){Tn("An editor must be serializable")}static async deserialize(t,e,r){const i=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:r});i.rotation=t.rotation,i.#t=t.accessibilityData,i._isCopy=t.isCopy||!1;const[s,a]=i.pageDimensions,[l,u,f,d]=i.getRectInCurrentCoords(t.rect,a);return i.x=l/s,i.y=u/a,i.width=f/s,i.height=d/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#H(),this.removeEditToolbar(),this.#b){for(const t of this.#b.values())clearTimeout(t);this.#b=null}this.parent=null,this.#E?.destroy(),this.#E=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#T(),this.#o.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#o.children;if(!this.#e){this.#e=Array.from(e);const a=this.#V.bind(this),l=this.#j.bind(this),u=this._uiManager._signal;for(const f of this.#e){const d=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",a,{signal:u}),f.addEventListener("blur",l,{signal:u}),f.addEventListener("focus",this.#I.bind(this,d),{signal:u}),f.setAttribute("data-l10n-id",Se._l10nResizer[d])}}const r=this.#e[0];let i=0;for(const a of e){if(a===r)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(s!==i){if(s<i)for(let l=0;l<i-s;l++)this.#o.append(this.#o.firstChild);else if(s>i)for(let l=0;l<s-i;l++)this.#o.firstChild.before(this.#o.lastChild);let a=0;for(const l of e){const f=this.#e[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",Se._l10nResizer[f])}}this.#M(0),this.#m=!0,this.#o.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#V(t){Se._resizerKeyboardManager.exec(this,t)}#j(t){this.#m&&t.relatedTarget?.parentNode!==this.#o&&this.#H()}#I(t){this.#u=this.#m?t:""}#M(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#m&&this.#z(this.#u,{deltaX:t,deltaY:e,fromKeyboard:!0})}#H(){this.#m=!1,this.#M(-1),this.#L()}_stopResizingWithKeyboard(){this.#H(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#l=!0;const r=t/e,{style:i}=this.div;i.aspectRatio=r,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#b||=new Map;const{action:r}=t;let i=this.#b.get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),this.#b.delete(r),this.#b.size===0&&(this.#b=null)},Se._telemetryTimeout),this.#b.set(r,i);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const r=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),r.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class rF extends Se{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const uS=3285377520,Rs=4294901760,La=65535;class wD{constructor(t){this.h1=t?t&4294967295:uS,this.h2=t?t&4294967295:uS}update(t){let e,r;if(typeof t=="string"){e=new Uint8Array(t.length*2),r=0;for(let _=0,y=t.length;_<y;_++){const w=t.charCodeAt(_);w<=255?e[r++]=w:(e[r++]=w>>>8,e[r++]=w&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),r=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,s=r-i*4,a=new Uint32Array(e.buffer,0,i);let l=0,u=0,f=this.h1,d=this.h2;const p=3432918353,m=461845907,v=p&La,x=m&La;for(let _=0;_<i;_++)_&1?(l=a[_],l=l*p&Rs|l*v&La,l=l<<15|l>>>17,l=l*m&Rs|l*x&La,f^=l,f=f<<13|f>>>19,f=f*5+3864292196):(u=a[_],u=u*p&Rs|u*v&La,u=u<<15|u>>>17,u=u*m&Rs|u*x&La,d^=u,d=d<<13|d>>>19,d=d*5+3864292196);switch(l=0,s){case 3:l^=e[i*4+2]<<16;case 2:l^=e[i*4+1]<<8;case 1:l^=e[i*4],l=l*p&Rs|l*v&La,l=l<<15|l>>>17,l=l*m&Rs|l*x&La,i&1?f^=l:d^=l}this.h1=f,this.h2=d}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Rs|t*36045&La,e=e*4283543511&Rs|((e<<16|t>>>16)*2950163797&Rs)>>>16,t^=e>>>1,t=t*444984403&Rs|t*60499&La,e=e*3301882366&Rs|((e<<16|t>>>16)*3120437893&Rs)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Ox=Object.freeze({map:null,hash:"",transfer:void 0});class Iy{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const r=this.#n.get(t);return r===void 0?e:Object.assign(e,r)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof Se)return;this.onAnnotationEditor(null)}}setValue(t,e){const r=this.#n.get(t);let i=!1;if(r!==void 0)for(const[s,a]of Object.entries(e))r[s]!==a&&(i=!0,r[s]=a);else i=!0,this.#n.set(t,e);i&&this.#r(),e instanceof Se&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}get size(){return this.#n.size}#r(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ED(this)}get serializable(){if(this.#n.size===0)return Ox;const t=new Map,e=new wD,r=[],i=Object.create(null);let s=!1;for(const[a,l]of this.#n){const u=l instanceof Se?l.serialize(!1,i):l;u&&(t.set(a,u),e.update(`${a}:${JSON.stringify(u)}`),s||=!!u.bitmap)}if(s)for(const a of t.values())a.bitmap&&r.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:r}:Ox}get editorStats(){let t=null;const e=new Map;for(const r of this.#n.values()){if(!(r instanceof Se))continue;const i=r.telemetryFinalData;if(!i)continue;const{type:s}=i;e.has(s)||e.set(s,Object.getPrototypeOf(r).constructor),t||=Object.create(null);const a=t[s]||=new Map;for(const[l,u]of Object.entries(i)){if(l==="type")continue;let f=a.get(l);f||(f=new Map,a.set(l,f));const d=f.get(u)??0;f.set(u,d+1)}}for(const[r,i]of e)t[r]=i.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof Se)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class ED extends Iy{#t;constructor(t){super();const{map:e,hash:r,transfer:i}=t.serializable,s=structuredClone(e,i?{transfer:i}:null);this.#t={map:s,hash:r,transfer:i}}get print(){Tn("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Xe(this,"modifiedIds",{ids:new Set,hash:""})}}class iF{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:r}){if(!(!t||this.#t.has(t.loadedName))){if(ur(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:a}=t,l=new FontFace(i,s,a);this.addNativeFontFace(l);try{await l.load(),this.#t.add(i),r?.(t)}catch{ze(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Tn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const r=t.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw ze(`Failed to load font '${r.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Xe(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Xe(this,"isSyncFontLoadingSupported",yi||Or.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(ur(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:e,callback:t};return r.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Xe(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function r(C,R){return C.charCodeAt(R)<<24|C.charCodeAt(R+1)<<16|C.charCodeAt(R+2)<<8|C.charCodeAt(R+3)&255}function i(C,R,N,D){const I=C.substring(0,R),M=C.substring(R+N);return I+D+M}let s,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const u=l.getContext("2d");let f=0;function d(C,R){if(++f>30){ze("Load test font never loaded."),R();return}if(u.font="30px "+C,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){R();return}setTimeout(d.bind(null,C,R))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,p.length,p);const x=16,_=1482184792;let y=r(m,x);for(s=0,a=p.length-3;s<a;s+=4)y=y-_+r(p,s)|0;s<p.length&&(y=y-_+r(p+"XXX",s)|0),m=i(m,x,4,WP(y));const w=`url(data:font/opentype;base64,${btoa(m)});`,S=`@font-face {font-family:"${p}";src:${w}}`;this.insertRule(S);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const C of[t.loadedName,p]){const R=this._document.createElement("span");R.textContent="Hi",R.style.fontFamily=C,T.append(R)}this._document.body.append(T),d(p,()=>{T.remove(),e.complete()})}}class sF{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const r in t)this[r]=t[r];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${vD(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const r=this.loadedName+"_path_"+e;let i;try{i=t.get(r)}catch(a){ze(`getPathGenerator - ignoring character: "${a}".`)}const s=new Path2D(i||"");return this.fontExtraProperties||t.delete(r),this.compiledGlyphs[e]=s}}function aF(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(yi)return n;const t=URL.parse(n,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function oF(n){if(yi&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return ap(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function om(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Rx=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,lF=n=>typeof n=="object"&&typeof n?.name=="string",AD=KP.bind(null,Rx,lF);class cF{#t=new Map;#e=Promise.resolve();postMessage(t,e){const r={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[i]of this.#t)i.call(this,r)})}addEventListener(t,e,r=null){let i=null;if(r?.signal instanceof AbortSignal){const{signal:s}=r;if(s.aborted){ze("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(t,e);i=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}this.#t.set(e,i)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const lm={DATA:1,ERROR:2},or={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function fS(){}function ji(n){if(n instanceof Bo||n instanceof Jm||n instanceof oS||n instanceof Ld||n instanceof u_)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Tn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Bo(n.message);case"InvalidPDFException":return new Jm(n.message);case"PasswordException":return new oS(n.message,n.code);case"ResponseException":return new Ld(n.message,n.status,n.missing);case"UnknownErrorException":return new u_(n.message,n.details)}return new u_(n.message,n.toString())}class md{#t=new AbortController;constructor(t,e,r){this.sourceName=t,this.targetName=e,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#r(t);return}if(t.callback){const r=t.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],t.callback===lm.DATA)i.resolve(t.data);else if(t.callback===lm.ERROR)i.reject(ji(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const r=this.sourceName,i=t.sourceName,s=this.comObj;Promise.try(e,t.data).then(function(a){s.postMessage({sourceName:r,targetName:i,callback:lm.DATA,callbackId:t.callbackId,data:a})},function(a){s.postMessage({sourceName:r,targetName:i,callback:lm.ERROR,callbackId:t.callbackId,reason:ji(a)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const r=this.actionHandler;if(r[t])throw new Error(`There is already an actionName called "${t}"`);r[t]=e}send(t,e,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},r)}sendWithPromise(t,e,r){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:e},r)}catch(a){s.reject(a)}return s.promise}sendWithStream(t,e,r,i){const s=this.streamId++,a=this.sourceName,l=this.targetName,u=this.comObj;return new ReadableStream({start:f=>{const d=Promise.withResolvers();return this.streamControllers[s]={controller:f,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},u.postMessage({sourceName:a,targetName:l,action:t,streamId:s,data:e,desiredSize:f.desiredSize},i),d.promise},pull:f=>{const d=Promise.withResolvers();return this.streamControllers[s].pullCall=d,u.postMessage({sourceName:a,targetName:l,stream:or.PULL,streamId:s,desiredSize:f.desiredSize}),d.promise},cancel:f=>{ur(f instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[s].cancelCall=d,this.streamControllers[s].isClosed=!0,u.postMessage({sourceName:a,targetName:l,stream:or.CANCEL,streamId:s,reason:ji(f)}),d.promise}},r)}#n(t){const e=t.streamId,r=this.sourceName,i=t.sourceName,s=this.comObj,a=this,l=this.actionHandler[t.action],u={enqueue(f,d=1,p){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=d,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:i,stream:or.ENQUEUE,streamId:e,chunk:f},p)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:or.CLOSE,streamId:e}),delete a.streamSinks[e])},error(f){ur(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:i,stream:or.ERROR,streamId:e,reason:ji(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[e]=u,Promise.try(l,t.data,u).then(function(){s.postMessage({sourceName:r,targetName:i,stream:or.START_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:r,targetName:i,stream:or.START_COMPLETE,streamId:e,reason:ji(f)})})}#r(t){const e=t.streamId,r=this.sourceName,i=t.sourceName,s=this.comObj,a=this.streamControllers[e],l=this.streamSinks[e];switch(t.stream){case or.START_COMPLETE:t.success?a.startCall.resolve():a.startCall.reject(ji(t.reason));break;case or.PULL_COMPLETE:t.success?a.pullCall.resolve():a.pullCall.reject(ji(t.reason));break;case or.PULL:if(!l){s.postMessage({sourceName:r,targetName:i,stream:or.PULL_COMPLETE,streamId:e,success:!0});break}l.desiredSize<=0&&t.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=t.desiredSize,Promise.try(l.onPull||fS).then(function(){s.postMessage({sourceName:r,targetName:i,stream:or.PULL_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:r,targetName:i,stream:or.PULL_COMPLETE,streamId:e,reason:ji(f)})});break;case or.ENQUEUE:if(ur(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case or.CLOSE:if(ur(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#s(a,e);break;case or.ERROR:ur(a,"error should have stream controller"),a.controller.error(ji(t.reason)),this.#s(a,e);break;case or.CANCEL_COMPLETE:t.success?a.cancelCall.resolve():a.cancelCall.reject(ji(t.reason)),this.#s(a,e);break;case or.CANCEL:if(!l)break;const u=ji(t.reason);Promise.try(l.onCancel||fS,u).then(function(){s.postMessage({sourceName:r,targetName:i,stream:or.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:r,targetName:i,stream:or.CANCEL_COMPLETE,streamId:e,reason:ji(f)})}),l.sinkCapability.reject(u),l.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class SD{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(t,e);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,r){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||r<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=r}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Tn("Abstract method `_createCanvas` called.")}}class uF extends SD{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const r=this._document.createElement("canvas");return r.width=t,r.height=e,r}}class TD{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Tn("Abstract method `_fetch` called.")}}class hS extends TD{async _fetch(t){const e=await Sf(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):ap(e)}}class CD{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,r,i,s){return"none"}destroy(t=!1){}}class fF extends CD{#t;#e;#n;#r;#s;#i;#l=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#r=t,this.#s=e}get#o(){return this.#e||=new Map}get#f(){return this.#i||=new Map}get#c(){if(!this.#n){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const r=this.#s.createElementNS(Co,"svg");r.setAttribute("width",0),r.setAttribute("height",0),this.#n=this.#s.createElementNS(Co,"defs"),t.append(r),r.append(this.#n),this.#s.body.append(t)}return this.#n}#h(t){if(t.length===1){const u=t[0],f=new Array(256);for(let p=0;p<256;p++)f[p]=u[p]/255;const d=f.join(",");return[d,d,d]}const[e,r,i]=t,s=new Array(256),a=new Array(256),l=new Array(256);for(let u=0;u<256;u++)s[u]=e[u]/255,a[u]=r[u]/255,l[u]=i[u]/255;return[s.join(","),a.join(","),l.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(lp(e)?ze('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Cy(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[r,i,s]=this.#h(t),a=t.length===1?r:`${r}${i}${s}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#r}_transfer_map_${this.#l++}`,u=this.#u(l);this.#o.set(t,u),this.#o.set(a,u);const f=this.#p(l);return this.#m(r,i,s,f),u}addHCMFilter(t,e){const r=`${t}-${e}`,i="base";let s=this.#f.get(i);if(s?.key===r||(s?(s.filter?.remove(),s.key=r,s.url="none",s.filter=null):(s={key:r,url:"none",filter:null},this.#f.set(i,s)),!t||!e))return s.url;const a=this.#_(t);t=ye.makeHexColor(...a);const l=this.#_(e);if(e=ye.makeHexColor(...l),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return s.url;const u=new Array(256);for(let v=0;v<=255;v++){const x=v/255;u[v]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const f=u.join(","),d=`g_${this.#r}_hcm_filter`,p=s.filter=this.#p(d);this.#m(f,f,f,p),this.#a(p);const m=(v,x)=>{const _=a[v]/255,y=l[v]/255,w=new Array(x+1);for(let S=0;S<=x;S++)w[S]=_+S/x*(y-_);return w.join(",")};return this.#m(m(0,5),m(1,5),m(2,5),p),s.url=this.#u(d),s.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[r]=this.#h([t]),i=`alpha_${r}`;if(e=this.#o.get(i),e)return this.#o.set(t,e),e;const s=`g_${this.#r}_alpha_map_${this.#l++}`,a=this.#u(s);this.#o.set(t,a),this.#o.set(i,a);const l=this.#p(s);return this.#v(r,l),a}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let r,i;if(t?([r]=this.#h([t]),i=`luminosity_${r}`):i="luminosity",e=this.#o.get(i),e)return this.#o.set(t,e),e;const s=`g_${this.#r}_luminosity_map_${this.#l++}`,a=this.#u(s);this.#o.set(t,a),this.#o.set(i,a);const l=this.#p(s);return this.#d(l),t&&this.#v(r,l),a}addHighlightHCMFilter(t,e,r,i,s){const a=`${e}-${r}-${i}-${s}`;let l=this.#f.get(t);if(l?.key===a||(l?(l.filter?.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},this.#f.set(t,l)),!e||!r))return l.url;const[u,f]=[e,r].map(this.#_.bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[m,v]=[i,s].map(this.#_.bind(this));p<d&&([d,p,m,v]=[p,d,v,m]),this.#c.style.color="";const x=(w,S,T)=>{const C=new Array(256),R=(p-d)/T,N=w/255,D=(S-w)/(255*T);let I=0;for(let M=0;M<=T;M++){const B=Math.round(d+M*R),H=N+M*D;for(let F=I;F<=B;F++)C[F]=H;I=B+1}for(let M=I;M<256;M++)C[M]=C[I-1];return C.join(",")},_=`g_${this.#r}_hcm_${t}_filter`,y=l.filter=this.#p(_);return this.#a(y),this.#m(x(m[0],v[0],5),x(m[1],v[1],5),x(m[2],v[2],5),y),l.url=this.#u(_),l.url}destroy(t=!1){t&&this.#i?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#i?.clear(),this.#i=null,this.#l=0)}#d(t){const e=this.#s.createElementNS(Co,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#a(t){const e=this.#s.createElementNS(Co,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#s.createElementNS(Co,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#g(t,e,r){const i=this.#s.createElementNS(Co,e);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),t.append(i)}#m(t,e,r,i){const s=this.#s.createElementNS(Co,"feComponentTransfer");i.append(s),this.#g(s,"feFuncR",t),this.#g(s,"feFuncG",e),this.#g(s,"feFuncB",r)}#v(t,e){const r=this.#s.createElementNS(Co,"feComponentTransfer");e.append(r),this.#g(r,"feFuncA",t)}#_(t){return this.#c.style.color=t,Ny(getComputedStyle(this.#c).getPropertyValue("color"))}}class DD{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(r=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Tn("Abstract method `_fetch` called.")}}class dS extends DD{async _fetch(t){const e=await Sf(t,"arraybuffer");return new Uint8Array(e)}}class OD{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(r=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Tn("Abstract method `_fetch` called.")}}class pS extends OD{async _fetch(t){const e=await Sf(t,"arraybuffer");return new Uint8Array(e)}}yi&&ze("Please use the `legacy` build in Node.js environments.");async function My(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class hF extends CD{}class dF extends SD{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class pF extends TD{async _fetch(t){return My(t)}}class mF extends DD{async _fetch(t){return My(t)}}class gF extends OD{async _fetch(t){return My(t)}}const Ur={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Nx(n,t){if(!t)return;const e=t[2]-t[0],r=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],e,r),n.clip(i)}class Py{isModifyingCurrentTransform(){return!1}getPattern(){Tn("Abstract method `getPattern` called.")}}class vF extends Py{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)e.addColorStop(r[0],r[1]);return e}getPattern(t,e,r,i){let s;if(i===Ur.STROKE||i===Ur.FILL){const a=e.current.getClippedPathBoundingBox(i,$n(t))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,u=Math.ceil(a[3]-a[1])||1,f=e.cachedCanvases.getCanvas("pattern",l,u),d=f.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),r=ye.transform(r,[1,0,0,1,a[0],a[1]]),d.transform(...e.baseTransform),this.matrix&&d.transform(...this.matrix),Nx(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),s=t.createPattern(f.canvas,"no-repeat");const p=new DOMMatrix(r);s.setTransform(p)}else Nx(t,this._bbox),s=this._createGradient(t);return s}}function d_(n,t,e,r,i,s,a,l){const u=t.coords,f=t.colors,d=n.data,p=n.width*4;let m;u[e+1]>u[r+1]&&(m=e,e=r,r=m,m=s,s=a,a=m),u[r+1]>u[i+1]&&(m=r,r=i,i=m,m=a,a=l,l=m),u[e+1]>u[r+1]&&(m=e,e=r,r=m,m=s,s=a,a=m);const v=(u[e]+t.offsetX)*t.scaleX,x=(u[e+1]+t.offsetY)*t.scaleY,_=(u[r]+t.offsetX)*t.scaleX,y=(u[r+1]+t.offsetY)*t.scaleY,w=(u[i]+t.offsetX)*t.scaleX,S=(u[i+1]+t.offsetY)*t.scaleY;if(x>=S)return;const T=f[s],C=f[s+1],R=f[s+2],N=f[a],D=f[a+1],I=f[a+2],M=f[l],B=f[l+1],H=f[l+2],F=Math.round(x),rt=Math.round(S);let L,it,Z,q,Ct,at,P,V;for(let j=F;j<=rt;j++){if(j<y){const Rt=j<x?0:(x-j)/(x-y);L=v-(v-_)*Rt,it=T-(T-N)*Rt,Z=C-(C-D)*Rt,q=R-(R-I)*Rt}else{let Rt;j>S?Rt=1:y===S?Rt=0:Rt=(y-j)/(y-S),L=_-(_-w)*Rt,it=N-(N-M)*Rt,Z=D-(D-B)*Rt,q=I-(I-H)*Rt}let et;j<x?et=0:j>S?et=1:et=(x-j)/(x-S),Ct=v-(v-w)*et,at=T-(T-M)*et,P=C-(C-B)*et,V=R-(R-H)*et;const dt=Math.round(Math.min(L,Ct)),xt=Math.round(Math.max(L,Ct));let Nt=p*j+dt*4;for(let Rt=dt;Rt<=xt;Rt++)et=(L-Rt)/(L-Ct),et<0?et=0:et>1&&(et=1),d[Nt++]=it-(it-at)*et|0,d[Nt++]=Z-(Z-P)*et|0,d[Nt++]=q-(q-V)*et|0,d[Nt++]=255}}function _F(n,t,e){const r=t.coords,i=t.colors;let s,a;switch(t.type){case"lattice":const l=t.verticesPerRow,u=Math.floor(r.length/l)-1,f=l-1;for(s=0;s<u;s++){let d=s*l;for(let p=0;p<f;p++,d++)d_(n,e,r[d],r[d+1],r[d+l],i[d],i[d+1],i[d+l]),d_(n,e,r[d+l+1],r[d+1],r[d+l],i[d+l+1],i[d+1],i[d+l])}break;case"triangles":for(s=0,a=r.length;s<a;s+=3)d_(n,e,r[s],r[s+1],r[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class xF extends Py{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,r){const l=Math.floor(this._bounds[0]),u=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-l,d=Math.ceil(this._bounds[3])-u,p=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),v=f/p,x=d/m,_={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-u,scaleX:1/v,scaleY:1/x},y=p+2*2,w=m+2*2,S=r.getCanvas("mesh",y,w),T=S.context,C=T.createImageData(p,m);if(e){const N=C.data;for(let D=0,I=N.length;D<I;D+=4)N[D]=e[0],N[D+1]=e[1],N[D+2]=e[2],N[D+3]=255}for(const N of this._figures)_F(C,N,_);return T.putImageData(C,2,2),{canvas:S.canvas,offsetX:l-2*v,offsetY:u-2*x,scaleX:v,scaleY:x}}isModifyingCurrentTransform(){return!0}getPattern(t,e,r,i){Nx(t,this._bbox);const s=new Float32Array(2);if(i===Ur.SHADING)ye.singularValueDecompose2dScale($n(t),s);else if(this.matrix){ye.singularValueDecompose2dScale(this.matrix,s);const[l,u]=s;ye.singularValueDecompose2dScale(e.baseTransform,s),s[0]*=l,s[1]*=u}else ye.singularValueDecompose2dScale(e.baseTransform,s);const a=this._createMeshCanvas(s,i===Ur.SHADING?null:this._background,e.cachedCanvases);return i!==Ur.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class yF extends Py{getPattern(){return"hotpink"}}function bF(n){switch(n[0]){case"RadialAxial":return new vF(n);case"Mesh":return new xF(n);case"Dummy":return new yF}throw new Error(`Unknown IR type: ${n[0]}`)}const mS={COLORED:1,UNCOLORED:2};class Fy{static MAX_PATTERN_SIZE=3e3;constructor(t,e,r,i){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(t){const{bbox:e,operatorList:r,paintType:i,tilingType:s,color:a,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:f}=this;u=Math.abs(u),f=Math.abs(f),$g("TilingType: "+s);const d=e[0],p=e[1],m=e[2],v=e[3],x=m-d,_=v-p,y=new Float32Array(2);ye.singularValueDecompose2dScale(this.matrix,y);const[w,S]=y;ye.singularValueDecompose2dScale(this.baseTransform,y);const T=w*y[0],C=S*y[1];let R=x,N=_,D=!1,I=!1;const M=Math.ceil(u*T),B=Math.ceil(f*C),H=Math.ceil(x*T),F=Math.ceil(_*C);M>=H?R=u:D=!0,B>=F?N=f:I=!0;const rt=this.getSizeAndScale(R,this.ctx.canvas.width,T),L=this.getSizeAndScale(N,this.ctx.canvas.height,C),it=t.cachedCanvases.getCanvas("pattern",rt.size,L.size),Z=it.context,q=l.createCanvasGraphics(Z);if(q.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(q,i,a),Z.translate(-rt.scale*d,-L.scale*p),q.transform(rt.scale,0,0,L.scale,0,0),Z.save(),this.clipBbox(q,d,p,m,v),q.baseTransform=$n(q.ctx),q.executeOperatorList(r),q.endDrawing(),Z.restore(),D||I){const Ct=it.canvas;D&&(R=u),I&&(N=f);const at=this.getSizeAndScale(R,this.ctx.canvas.width,T),P=this.getSizeAndScale(N,this.ctx.canvas.height,C),V=at.size,j=P.size,et=t.cachedCanvases.getCanvas("pattern-workaround",V,j),dt=et.context,xt=D?Math.floor(x/u):0,Nt=I?Math.floor(_/f):0;for(let Rt=0;Rt<=xt;Rt++)for(let z=0;z<=Nt;z++)dt.drawImage(Ct,V*Rt,j*z,V,j,0,0,V,j);return{canvas:et.canvas,scaleX:at.scale,scaleY:P.scale,offsetX:d,offsetY:p}}return{canvas:it.canvas,scaleX:rt.scale,scaleY:L.scale,offsetX:d,offsetY:p}}getSizeAndScale(t,e,r){const i=Math.max(Fy.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*r);return s>=i?s=i:r=s/t,{scale:r,size:s}}clipBbox(t,e,r,i,s){const a=i-e,l=s-r;t.ctx.rect(e,r,a,l),ye.axialAlignedBoundingBox([e,r,i,s],$n(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,r){const i=t.ctx,s=t.current;switch(e){case mS.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;i.fillStyle=s.fillColor=a,i.strokeStyle=s.strokeColor=l;break;case mS.UNCOLORED:i.fillStyle=i.strokeStyle=r,s.fillColor=s.strokeColor=r;break;default:throw new VP(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,r,i){let s=r;i!==Ur.SHADING&&(s=ye.transform(s,e.baseTransform),this.matrix&&(s=ye.transform(s,this.matrix)));const a=this.createPatternCanvas(e);let l=new DOMMatrix(s);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const u=t.createPattern(a.canvas,"repeat");return u.setTransform(l),u}}function wF({src:n,srcPos:t=0,dest:e,width:r,height:i,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const l=Or.isLittleEndian?4278190080:255,[u,f]=a?[s,l]:[l,s],d=r>>3,p=r&7,m=n.length;e=new Uint32Array(e.buffer);let v=0;for(let x=0;x<i;x++){for(const y=t+d;t<y;t++){const w=t<m?n[t]:255;e[v++]=w&128?f:u,e[v++]=w&64?f:u,e[v++]=w&32?f:u,e[v++]=w&16?f:u,e[v++]=w&8?f:u,e[v++]=w&4?f:u,e[v++]=w&2?f:u,e[v++]=w&1?f:u}if(p===0)continue;const _=t<m?n[t++]:255;for(let y=0;y<p;y++)e[v++]=_&1<<7-y?f:u}return{srcPos:t,destPos:v}}const gS=16,vS=100,EF=15,_S=10,$i=16,p_=new DOMMatrix,as=new Float32Array(2),qu=new Float32Array([1/0,1/0,-1/0,-1/0]);function AF(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(e,r){t.translate(e,r),this.__originalTranslate(e,r)},n.scale=function(e,r){t.scale(e,r),this.__originalScale(e,r)},n.transform=function(e,r,i,s,a,l){t.transform(e,r,i,s,a,l),this.__originalTransform(e,r,i,s,a,l)},n.setTransform=function(e,r,i,s,a,l){t.setTransform(e,r,i,s,a,l),this.__originalSetTransform(e,r,i,s,a,l)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(e){t.rotate(e),this.__originalRotate(e)},n.clip=function(e){t.clip(e),this.__originalClip(e)},n.moveTo=function(e,r){t.moveTo(e,r),this.__originalMoveTo(e,r)},n.lineTo=function(e,r){t.lineTo(e,r),this.__originalLineTo(e,r)},n.bezierCurveTo=function(e,r,i,s,a,l){t.bezierCurveTo(e,r,i,s,a,l),this.__originalBezierCurveTo(e,r,i,s,a,l)},n.rect=function(e,r,i,s){t.rect(e,r,i,s),this.__originalRect(e,r,i,s)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class SF{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,r){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,e,r)):(i=this.canvasFactory.create(e,r),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function cm(n,t,e,r,i,s,a,l,u,f){const[d,p,m,v,x,_]=$n(n);if(p===0&&m===0){const S=a*d+x,T=Math.round(S),C=l*v+_,R=Math.round(C),N=(a+u)*d+x,D=Math.abs(Math.round(N)-T)||1,I=(l+f)*v+_,M=Math.abs(Math.round(I)-R)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(v),T,R),n.drawImage(t,e,r,i,s,0,0,D,M),n.setTransform(d,p,m,v,x,_),[D,M]}if(d===0&&v===0){const S=l*m+x,T=Math.round(S),C=a*p+_,R=Math.round(C),N=(l+f)*m+x,D=Math.abs(Math.round(N)-T)||1,I=(a+u)*p+_,M=Math.abs(Math.round(I)-R)||1;return n.setTransform(0,Math.sign(p),Math.sign(m),0,T,R),n.drawImage(t,e,r,i,s,0,0,M,D),n.setTransform(d,p,m,v,x,_),[M,D]}n.drawImage(t,e,r,i,s,a,l,u,f);const y=Math.hypot(d,p),w=Math.hypot(m,v);return[y*u,w*f]}class xS{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Dx;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Jr.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e){this.clipBox=new Float32Array([0,0,t,e]),this.minMax=qu.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ur.FILL,e=null){const r=this.minMax.slice();if(t===Ur.STROKE){e||Tn("Stroke bounding box must include transform."),ye.singularValueDecompose2dScale(e,as);const i=as[0]*this.lineWidth/2,s=as[1]*this.lineWidth/2;r[0]-=i,r[1]-=s,r[2]+=i,r[3]+=s}return r}updateClipFromPath(){const t=ye.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(qu,0)}getClippedPathBoundingBox(t=Ur.FILL,e=null){return ye.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function yS(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,r=t.width,i=e%$i,s=(e-i)/$i,a=i===0?s:s+1,l=n.createImageData(r,$i);let u=0,f;const d=t.data,p=l.data;let m,v,x,_;if(t.kind===wd.GRAYSCALE_1BPP){const y=d.byteLength,w=new Uint32Array(p.buffer,0,p.byteLength>>2),S=w.length,T=r+7>>3,C=4294967295,R=Or.isLittleEndian?4278190080:255;for(m=0;m<a;m++){for(x=m<s?$i:i,f=0,v=0;v<x;v++){const N=y-u;let D=0;const I=N>T?r:N*8-7,M=I&-8;let B=0,H=0;for(;D<M;D+=8)H=d[u++],w[f++]=H&128?C:R,w[f++]=H&64?C:R,w[f++]=H&32?C:R,w[f++]=H&16?C:R,w[f++]=H&8?C:R,w[f++]=H&4?C:R,w[f++]=H&2?C:R,w[f++]=H&1?C:R;for(;D<I;D++)B===0&&(H=d[u++],B=128),w[f++]=H&B?C:R,B>>=1}for(;f<S;)w[f++]=0;n.putImageData(l,0,m*$i)}}else if(t.kind===wd.RGBA_32BPP){for(v=0,_=r*$i*4,m=0;m<s;m++)p.set(d.subarray(u,u+_)),u+=_,n.putImageData(l,0,v),v+=$i;m<a&&(_=r*i*4,p.set(d.subarray(u,u+_)),n.putImageData(l,0,v))}else if(t.kind===wd.RGB_24BPP)for(x=$i,_=r*x,m=0;m<a;m++){for(m>=s&&(x=i,_=r*x),f=0,v=_;v--;)p[f++]=d[u++],p[f++]=d[u++],p[f++]=d[u++],p[f++]=255;n.putImageData(l,0,m*$i)}else throw new Error(`bad image kind: ${t.kind}`)}function bS(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,r=t.width,i=e%$i,s=(e-i)/$i,a=i===0?s:s+1,l=n.createImageData(r,$i);let u=0;const f=t.data,d=l.data;for(let p=0;p<a;p++){const m=p<s?$i:i;({srcPos:u}=wF({src:f,srcPos:u,dest:d,width:r,height:m,nonBlackColor:0})),n.putImageData(l,0,p*$i)}}function rd(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of e)n[r]!==void 0&&(t[r]=n[r]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function um(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}function wS(n,t){if(t)return!0;ye.singularValueDecompose2dScale(n,as);const e=Math.fround(ca.pixelRatio*Rc.PDF_TO_CSS_UNITS);return as[0]<=e&&as[1]<=e}const TF=["butt","round","square"],CF=["miter","round","bevel"],DF={},ES={};class Xu{constructor(t,e,r,i,s,{optionalContentConfig:a,markedContentStack:l=null},u,f){this.ctx=t,this.current=new xS(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=r,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new SF(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=u,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:r=!1,background:i=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=l,r){const u=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=u.canvas,this.ctx=u.context,this.ctx.save(),this.ctx.transform(...$n(this.compositeCtx))}this.ctx.save(),um(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=$n(this.ctx)}executeOperatorList(t,e,r,i){const s=t.argsArray,a=t.fnArray;let l=e||0;const u=s.length;if(u===l)return l;const f=u-l>_S&&typeof r=="function",d=f?Date.now()+EF:0;let p=0;const m=this.commonObjs,v=this.objs;let x;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,r),l;if(x=a[l],x!==kd.dependency)this[x].apply(this,s[l]);else for(const _ of s[l]){const y=_.startsWith("g_")?m:v;if(!y.has(_))return y.get(_,r),l}if(l++,l===u)return l;if(f&&++p>_S){if(Date.now()>d)return r(),l;p=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const r=t.width??t.displayWidth,i=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),l=r,u=i,f="prescale1",d,p;for(;s>2&&l>1||a>2&&u>1;){let m=l,v=u;s>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),s/=l/m),a>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u)/2,a/=u/v),d=this.cachedCanvases.getCanvas(f,m,v),p=d.context,p.clearRect(0,0,m,v),p.drawImage(t,0,0,l,u,0,0,m,v),t=d.canvas,l=m,u=v,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:u}}_createMaskCanvas(t){const e=this.ctx,{width:r,height:i}=t,s=this.current.fillColor,a=this.current.patternFill,l=$n(e);let u,f,d,p;if((t.bitmap||t.data)&&t.count>1){const M=t.bitmap||t.data.buffer;f=JSON.stringify(a?l:[l.slice(0,4),s]),u=this._cachedBitmapsMap.get(M),u||(u=new Map,this._cachedBitmapsMap.set(M,u));const B=u.get(f);if(B&&!a){const H=Math.round(Math.min(l[0],l[2])+l[4]),F=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:B,offsetX:H,offsetY:F}}d=B}d||(p=this.cachedCanvases.getCanvas("maskCanvas",r,i),bS(p.context,t));let m=ye.transform(l,[1/r,0,0,-1/i,0,0]);m=ye.transform(m,[1,0,0,1,0,-i]);const v=qu.slice();ye.axialAlignedBoundingBox([0,0,r,i],m,v);const[x,_,y,w]=v,S=Math.round(y-x)||1,T=Math.round(w-_)||1,C=this.cachedCanvases.getCanvas("fillCanvas",S,T),R=C.context,N=x,D=_;R.translate(-N,-D),R.transform(...m),d||(d=this._scaleImage(p.canvas,ka(R)),d=d.img,u&&a&&u.set(f,d)),R.imageSmoothingEnabled=wS($n(R),t.interpolate),cm(R,d,0,0,d.width,d.height,0,0,r,i),R.globalCompositeOperation="source-in";const I=ye.transform(ka(R),[1,0,0,1,-N,-D]);return R.fillStyle=a?s.getPattern(e,this,I,Ur.FILL):s,R.fillRect(0,0,r,i),u&&!a&&(this.cachedCanvases.delete("fillCanvas"),u.set(f,C.canvas)),{canvas:C.canvas,offsetX:Math.round(N),offsetY:Math.round(D)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=TF[t]}setLineJoin(t){this.ctx.lineJoin=CF[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,r]of t)switch(e){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,e);this.suspendedCtx=this.ctx;const s=this.ctx=i.context;s.setTransform(this.suspendedCtx.getTransform()),rd(this.suspendedCtx,s),AF(s,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),rd(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,r,i){const s=i[0],a=i[1],l=i[2]-s,u=i[3]-a;l===0||u===0||(this.genericComposeSMask(e.context,r,l,u,e.subtype,e.backdrop,e.transferMap,s,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(r.canvas,0,0),t.restore())}genericComposeSMask(t,e,r,i,s,a,l,u,f,d,p){let m=t.canvas,v=u-d,x=f-p;if(a)if(v<0||x<0||v+r>m.width||x+i>m.height){const y=this.cachedCanvases.getCanvas("maskExtension",r,i),w=y.context;w.drawImage(m,-v,-x),w.globalCompositeOperation="destination-atop",w.fillStyle=a,w.fillRect(0,0,r,i),w.globalCompositeOperation="source-over",m=y.canvas,v=x=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const y=new Path2D;y.rect(v,x,r,i),t.clip(y),t.globalCompositeOperation="destination-atop",t.fillStyle=a,t.fillRect(v,x,r,i),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&l?e.filter=this.filterFactory.addAlphaFilter(l):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(l));const _=new Path2D;_.rect(u,f,r,i),e.clip(_),e.globalCompositeOperation="destination-in",e.drawImage(m,v,x,r,i,u,f,r,i),e.restore()}save(){this.inSMaskMode&&rd(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&rd(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,r,i,s,a){this.ctx.transform(t,e,r,i,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,r){let[i]=e;if(!r){i||=e[0]=new Path2D,this[t](i);return}if(!(i instanceof Path2D)){const s=e[0]=new Path2D;for(let a=0,l=i.length;a<l;)switch(i[a++]){case am.moveTo:s.moveTo(i[a++],i[a++]);break;case am.lineTo:s.lineTo(i[a++],i[a++]);break;case am.curveTo:s.bezierCurveTo(i[a++],i[a++],i[a++],i[a++],i[a++],i[a++]);break;case am.closePath:s.closePath();break;default:ze(`Unrecognized drawing path operator: ${i[a-1]}`);break}i=s}ye.axialAlignedBoundingBox(r,$n(this.ctx),this.current.minMax),this[t](i)}closePath(){this.ctx.closePath()}stroke(t,e=!0){const r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&i?.getPattern){const s=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=i.getPattern(r,this,ka(r),Ur.STROKE),s){const a=new Path2D;a.addPath(t,r.getTransform().invertSelf().multiplySelf(s)),t=a}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);e&&this.consumePath(t,this.current.getClippedPathBoundingBox(Ur.STROKE,$n(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t){this.stroke(t)}fill(t,e=!0){const r=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let a=!1;if(s){const u=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.fillStyle=i.getPattern(r,this,ka(r),Ur.FILL),u){const f=new Path2D;f.addPath(t,r.getTransform().invertSelf().multiplySelf(u)),t=f}a=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(r.fill(t,"evenodd"),this.pendingEOFill=!1):r.fill(t)),a&&r.restore(),e&&this.consumePath(t,l)}eoFill(t){this.pendingEOFill=!0,this.fill(t)}fillStroke(t){this.fill(t,!1),this.stroke(t,!1),this.consumePath(t)}eoFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}closeFillStroke(t){this.fillStroke(t)}closeEOFillStroke(t){this.pendingEOFill=!0,this.fillStroke(t)}endPath(t){this.consumePath(t)}rawFillPath(t){this.ctx.fill(t)}clip(){this.pendingClip=DF}eoClip(){this.pendingClip=ES}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0)return;const r=new Path2D,i=e.getTransform().invertSelf();for(const{transform:s,x:a,y:l,fontSize:u,path:f}of t)r.addPath(f,new DOMMatrix(s).preMultiplySelf(i).translate(a,l).scale(u,-u));e.clip(r),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const r=this.commonObjs.get(t),i=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=r.fontMatrix||Dx,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ze("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=e,r.isType3Font)return;const s=r.loadedName||"sans-serif",a=r.systemFontInfo?.css||`"${s}", ${r.fallbackName}`;let l="normal";r.black?l="900":r.bold&&(l="bold");const u=r.italic?"italic":"normal";let f=e;e<gS?f=gS:e>vS&&(f=vS),this.current.fontSizeScale=e/f,this.ctx.font=`${u} ${l} ${f}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t){const{current:e}=this;e.textMatrix=t,e.textMatrixScale=Math.hypot(t[0],t[1]),e.x=e.lineX=0,e.y=e.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(t,e,r){const i=new Path2D;return i.addPath(t,new DOMMatrix(r).invertSelf().multiplySelf(e)),i}paintChar(t,e,r,i,s){const a=this.ctx,l=this.current,u=l.font,f=l.textRenderingMode,d=l.fontSize/l.fontSizeScale,p=f&Jr.FILL_STROKE_MASK,m=!!(f&Jr.ADD_TO_PATH_FLAG),v=l.patternFill&&!u.missingFile,x=l.patternStroke&&!u.missingFile;let _;if((u.disableFontFace||m||v||x)&&(_=u.getPathGenerator(this.commonObjs,t)),u.disableFontFace||v||x){a.save(),a.translate(e,r),a.scale(d,-d);let y;if((p===Jr.FILL||p===Jr.FILL_STROKE)&&(i?(y=a.getTransform(),a.setTransform(...i),a.fill(this.#n(_,y,i))):a.fill(_)),p===Jr.STROKE||p===Jr.FILL_STROKE)if(s){y||=a.getTransform(),a.setTransform(...s);const{a:w,b:S,c:T,d:C}=y,R=ye.inverseTransform(s),N=ye.transform([w,S,T,C,0,0],R);ye.singularValueDecompose2dScale(N,as),a.lineWidth*=Math.max(as[0],as[1])/d,a.stroke(this.#n(_,y,s))}else a.lineWidth/=d,a.stroke(_);a.restore()}else(p===Jr.FILL||p===Jr.FILL_STROKE)&&a.fillText(t,e,r),(p===Jr.STROKE||p===Jr.FILL_STROKE)&&a.strokeText(t,e,r);m&&(this.pendingTextPaths||=[]).push({transform:$n(a),x:e,y:r,fontSize:d,path:_})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){r=!0;break}return Xe(this,"isFontSubpixelAAEnabled",r)}showText(t){const e=this.current,r=e.font;if(r.isType3Font)return this.showType3Text(t);const i=e.fontSize;if(i===0)return;const s=this.ctx,a=e.fontSizeScale,l=e.charSpacing,u=e.wordSpacing,f=e.fontDirection,d=e.textHScale*f,p=t.length,m=r.vertical,v=m?1:-1,x=r.defaultVMetrics,_=i*e.fontMatrix[0],y=e.textRenderingMode===Jr.FILL&&!r.disableFontFace&&!e.patternFill;s.save(),e.textMatrix&&s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),f>0?s.scale(d,-1):s.scale(d,1);let w,S;if(e.patternFill){s.save();const D=e.fillColor.getPattern(s,this,ka(s),Ur.FILL);w=$n(s),s.restore(),s.fillStyle=D}if(e.patternStroke){s.save();const D=e.strokeColor.getPattern(s,this,ka(s),Ur.STROKE);S=$n(s),s.restore(),s.strokeStyle=D}let T=e.lineWidth;const C=e.textMatrixScale;if(C===0||T===0){const D=e.textRenderingMode&Jr.FILL_STROKE_MASK;(D===Jr.STROKE||D===Jr.FILL_STROKE)&&(T=this.getSinglePixelWidth())}else T/=C;if(a!==1&&(s.scale(a,a),T/=a),s.lineWidth=T,r.isInvalidPDFjsFont){const D=[];let I=0;for(const M of t)D.push(M.unicode),I+=M.width;s.fillText(D.join(""),0,0),e.x+=I*_*d,s.restore(),this.compose();return}let R=0,N;for(N=0;N<p;++N){const D=t[N];if(typeof D=="number"){R+=v*D*i/1e3;continue}let I=!1;const M=(D.isSpace?u:0)+l,B=D.fontChar,H=D.accent;let F,rt,L=D.width;if(m){const Z=D.vmetric||x,q=-(D.vmetric?Z[1]:L*.5)*_,Ct=Z[2]*_;L=Z?-Z[0]:L,F=q/a,rt=(R+Ct)/a}else F=R/a,rt=0;if(r.remeasure&&L>0){const Z=s.measureText(B).width*1e3/i*a;if(L<Z&&this.isFontSubpixelAAEnabled){const q=L/Z;I=!0,s.save(),s.scale(q,1),F/=q}else L!==Z&&(F+=(L-Z)/2e3*i/a)}if(this.contentVisible&&(D.isInFont||r.missingFile)){if(y&&!H)s.fillText(B,F,rt);else if(this.paintChar(B,F,rt,w,S),H){const Z=F+i*H.offset.x/a,q=rt-i*H.offset.y/a;this.paintChar(H.fontChar,Z,q,w,S)}}const it=m?L*_-M*f:L*_+M*f;R+=it,I&&s.restore()}m?e.y-=R:e.x+=R*d,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,r=this.current,i=r.font,s=r.fontSize,a=r.fontDirection,l=i.vertical?1:-1,u=r.charSpacing,f=r.wordSpacing,d=r.textHScale*a,p=r.fontMatrix||Dx,m=t.length,v=r.textRenderingMode===Jr.INVISIBLE;let x,_,y,w;if(!(v||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),r.textMatrix&&e.transform(...r.textMatrix),e.translate(r.x,r.y+r.textRise),e.scale(d,a),x=0;x<m;++x){if(_=t[x],typeof _=="number"){w=l*_*s/1e3,this.ctx.translate(w,0),r.x+=w*d;continue}const S=(_.isSpace?f:0)+u,T=i.charProcOperatorList[_.operatorListId];T?this.contentVisible&&(this.save(),e.scale(s,s),e.transform(...p),this.executeOperatorList(T),this.restore()):ze(`Type3 character "${_.operatorListId}" is not available.`);const C=[_.width,0];ye.applyTransform(C,p),y=C[0]*s+S,e.translate(y,0),r.x+=y*d}e.restore()}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,r,i,s,a){const l=new Path2D;l.rect(r,i,s-r,a-i),this.ctx.clip(l),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const r=this.baseTransform||$n(this.ctx),i={createCanvasGraphics:s=>new Xu(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Fy(t,this.ctx,i,r)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t){this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t){this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=bF(this.getObject(t)),this.cachedPatterns.set(t,r)),e&&(r.matrix=e),r}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const r=this._getPattern(t);e.fillStyle=r.getPattern(e,this,ka(e),Ur.SHADING);const i=ka(e);if(i){const{width:s,height:a}=e.canvas,l=qu.slice();ye.axialAlignedBoundingBox([0,0,s,a],i,l);const[u,f,d,p]=l;this.ctx.fillRect(u,f,d-u,p-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Tn("Should not call beginInlineImage")}beginImageData(){Tn("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=$n(this.ctx),e)){ye.axialAlignedBoundingBox(e,this.baseTransform,this.current.minMax);const[r,i,s,a]=e,l=new Path2D;l.rect(r,i,s-r,a-i),this.ctx.clip(l),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||$g("TODO: Support non-isolated groups."),t.knockout&&ze("Knockout groups not supported.");const r=$n(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=qu.slice();ye.axialAlignedBoundingBox(t.bbox,$n(e),i);const s=[0,0,e.canvas.width,e.canvas.height];i=ye.intersect(i,s)||[0,0,0,0];const a=Math.floor(i[0]),l=Math.floor(i[1]),u=Math.max(Math.ceil(i[2])-a,1),f=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,f]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(d,u,f),m=p.context;m.translate(-a,-l),m.transform(...r);let v=new Path2D;const[x,_,y,w]=t.bbox;if(v.rect(x,_,y-x,w-_),t.matrix){const S=new Path2D;S.addPath(v,new DOMMatrix(t.matrix)),v=S}m.clip(v),t.smask?this.smaskStack.push({canvas:p.canvas,context:m,offsetX:a,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,l),e.save()),rd(e,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=$n(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const s=qu.slice();ye.axialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],i,s),this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,r,i,s){if(this.#t(),um(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],l=e[3]-e[1];if(s&&this.annotationCanvasMap){r=r.slice(),r[4]-=e[0],r[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=a,e[3]=l,ye.singularValueDecompose2dScale($n(this.ctx),as);const{viewportScale:u}=this,f=Math.ceil(a*this.outputScaleX*u),d=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(f,d);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(as[0],0,0,-as[1],0,l*as[1]),um(this.ctx)}else{um(this.ctx),this.endPath();const u=new Path2D;u.rect(e[0],e[1],a,l),this.ctx.clip(u)}}this.current=new xS(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const r=this.ctx,i=this._createMaskCanvas(t),s=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(s,i.offsetX,i.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,r=0,i=0,s,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const u=$n(l);l.transform(e,r,i,s,0,0);const f=this._createMaskCanvas(t);l.setTransform(1,0,0,1,f.offsetX-u[4],f.offsetY-u[5]);for(let d=0,p=a.length;d<p;d+=2){const m=ye.transform(u,[e,r,i,s,a[d],a[d+1]]);l.drawImage(f.canvas,m[4],m[5])}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,r=this.current.fillColor,i=this.current.patternFill;for(const s of t){const{data:a,width:l,height:u,transform:f}=s,d=this.cachedCanvases.getCanvas("maskCanvas",l,u),p=d.context;p.save();const m=this.getObject(a,s);bS(p,m),p.globalCompositeOperation="source-in",p.fillStyle=i?r.getPattern(p,this,ka(e),Ur.FILL):r,p.fillRect(0,0,l,u),p.restore(),e.save(),e.transform(...f),e.scale(1,-1),cm(e,d.canvas,0,0,l,u,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){ze("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,r,i){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){ze("Dependent image isn't ready yet");return}const a=s.width,l=s.height,u=[];for(let f=0,d=i.length;f<d;f+=2)u.push({transform:[e,0,0,r,i[f],i[f+1]],x:0,y:0,w:a,h:l});this.paintInlineImageXObjectGroup(s,u)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:r,height:i}=t,s=this.cachedCanvases.getCanvas("inlineImage",r,i),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,r=t.height,i=this.ctx;this.save();const{filter:s}=i;s!=="none"&&s!==""&&(i.filter="none"),i.scale(1/e,-1/r);let a;if(t.bitmap)a=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)a=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",e,r).context;yS(f,t),a=this.applyTransferMapsToCanvas(f)}const l=this._scaleImage(a,ka(i));i.imageSmoothingEnabled=wS($n(i),t.interpolate),cm(i,l.img,0,0,l.paintWidth,l.paintHeight,0,-r,e,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const r=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const s=t.width,a=t.height,u=this.cachedCanvases.getCanvas("inlineImage",s,a).context;yS(u,t),i=this.applyTransferMapsToCanvas(u)}for(const s of e)r.save(),r.transform(...s.transform),r.scale(1,-1),cm(r,i,s.x,s.y,s.w,s.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t,e){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(r||(this.pendingClip===ES?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=$n(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),r=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:r,c:i,d:s}=this.ctx.getTransform();let a,l;if(r===0&&i===0){const u=Math.abs(e),f=Math.abs(s);if(u===f)if(t===0)a=l=1/u;else{const d=u*t;a=l=d<1?1/d:1}else if(t===0)a=1/u,l=1/f;else{const d=u*t,p=f*t;a=d<1?1/d:1,l=p<1?1/p:1}}else{const u=Math.abs(e*s-r*i),f=Math.hypot(e,r),d=Math.hypot(i,s);if(t===0)a=d/u,l=f/u;else{const p=t*u;a=d>p?d/p:1,l=f>p?f/p:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:r,current:{lineWidth:i}}=this,[s,a]=this.getScaleForStroking();if(s===a){r.lineWidth=(i||1)*s,r.stroke(t);return}const l=r.getLineDash();e&&r.save(),r.scale(s,a),p_.a=1/s,p_.d=1/a;const u=new Path2D;if(u.addPath(t,p_),l.length>0){const f=Math.max(s,a);r.setLineDash(l.map(d=>d/f)),r.lineDashOffset/=f}r.lineWidth=i||1,r.stroke(u),e&&r.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const n in kd)Xu.prototype[n]!==void 0&&(Xu.prototype[kd[n]]=Xu.prototype[n]);class Sl{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class OF{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Gu=Symbol("INTERNAL");class RF{#t=!1;#e=!1;#n=!1;#r=!0;constructor(t,{name:e,intent:r,usage:i,rbGroups:s}){this.#t=!!(t&rs.DISPLAY),this.#e=!!(t&rs.PRINT),this.name=e,this.intent=r,this.usage=i,this.rbGroups=s}get visible(){if(this.#n)return this.#r;if(!this.#r)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,r=!1){t!==Gu&&Tn("Internal method `_setVisible` called."),this.#n=r,this.#r=e}}class NF{#t=null;#e=new Map;#n=null;#r=null;constructor(t,e=rs.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#r=t.order;for(const r of t.groups)this.#e.set(r.id,new RF(e,r));if(t.baseState==="OFF")for(const r of this.#e.values())r._setVisible(Gu,!1);for(const r of t.on)this.#e.get(r)._setVisible(Gu,!0);for(const r of t.off)this.#e.get(r)._setVisible(Gu,!1);this.#n=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const r=t[0];for(let i=1;i<e;i++){const s=t[i];let a;if(Array.isArray(s))a=this.#s(s);else if(this.#e.has(s))a=this.#e.get(s).visible;else return ze(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return $g("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ze(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ze(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ze(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ze(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ze(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ze(`Unknown optional content policy ${t.policy}.`),!0}return ze(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,r=!0){const i=this.#e.get(t);if(!i){ze(`Optional content group not found: ${t}`);return}if(r&&e&&i.rbGroups.length)for(const s of i.rbGroups)for(const a of s)a!==t&&this.#e.get(a)?._setVisible(Gu,!1,!0);i._setVisible(Gu,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let r;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const s=this.#e.get(i);if(s)switch(r){case"ON":this.setVisibility(i,!0,e);break;case"OFF":this.setVisibility(i,!1,e);break;case"Toggle":this.setVisibility(i,!s.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#r?this.#r.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new wD;for(const[e,r]of this.#e)t.update(`${e}:${r.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class kF{constructor(t,{disableRange:e=!1,disableStream:r=!1}){ur(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:s,progressiveDone:a,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,s?.length>0){const u=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(u)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!r,this._isRangeSupported=!e,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((u,f)=>{this._onReceiveData({begin:u,chunk:f})}),t.addProgressListener((u,f)=>{this._onProgress({loaded:u,total:f})}),t.addProgressiveReadListener(u=>{this._onReceiveData({chunk:u})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const r=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(r),!0)});ur(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){ur(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new LF(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new IF(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(r),r}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class LF{constructor(t,e,r=!1,i=null){this._stream=t,this._done=r||!1,this._filename=Vg(i)?i:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class IF{constructor(t,e,r){this._stream=t,this._begin=e,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function MF(n){let t=!0,e=r("filename\\*","i").exec(n);if(e){e=e[1];let d=l(e);return d=unescape(d),d=u(d),d=f(d),s(d)}if(e=a(n),e){const d=f(e);return s(d)}if(e=r("filename","i").exec(n),e){e=e[1];let d=l(e);return d=f(d),s(d)}function r(d,p){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function i(d,p){if(d){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const m=new TextDecoder(d,{fatal:!0}),v=ap(p);p=m.decode(v),t=!1}catch{}}return p}function s(d){return t&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),t&&(d=i("iso-8859-1",d))),d}function a(d){const p=[];let m;const v=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(d))!==null;){let[,_,y,w]=m;if(_=parseInt(_,10),_ in p){if(_===0)break;continue}p[_]=[y,w]}const x=[];for(let _=0;_<p.length&&_ in p;++_){let[y,w]=p[_];w=l(w),y&&(w=unescape(w),_===0&&(w=u(w))),x.push(w)}return x.join("")}function l(d){if(d.startsWith('"')){const p=d.slice(1).split('\\"');for(let m=0;m<p.length;++m){const v=p[m].indexOf('"');v!==-1&&(p[m]=p[m].slice(0,v),p.length=m+1),p[m]=p[m].replaceAll(/\\(.)/g,"$1")}d=p.join('"')}return d}function u(d){const p=d.indexOf("'");if(p===-1)return d;const m=d.slice(0,p),x=d.slice(p+1).replace(/^[^']*'/,"");return i(m,x)}function f(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,m,v,x){if(v==="q"||v==="Q")return x=x.replaceAll("_"," "),x=x.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,y){return String.fromCharCode(parseInt(y,16))}),i(m,x);try{x=atob(x)}catch{}return i(m,x)})}return""}function RD(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const r in t){const i=t[r];i!==void 0&&e.append(r,i)}return e}function Wg(n){return URL.parse(n)?.origin??null}function ND({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*e)||r||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function kD(n){const t=n.get("Content-Disposition");if(t){let e=MF(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Vg(e))return e}return null}function fp(n,t){return new Ld(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n,n===404||n===0&&t.startsWith("file:"))}function LD(n){return n===200||n===206}function ID(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function MD(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ze(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class PF{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=RD(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ur(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new FF(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new BF(this,t,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class FF{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const r=new Headers(t.headers),i=e.url;fetch(i,ID(r,this._withCredentials,this._abortController)).then(s=>{if(t._responseOrigin=Wg(s.url),!LD(s.status))throw fp(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:l,suggestedLength:u}=ND({responseHeaders:a,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=u||this._contentLength,this._filename=kD(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Bo("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:MD(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class BF{constructor(t,e,r){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${r-1}`);const a=i.url;fetch(a,ID(s,this._withCredentials,this._abortController)).then(l=>{const u=Wg(l.url);if(u!==t._responseOrigin)throw new Error(`Expected range response-origin "${u}" to match "${t._responseOrigin}".`);if(!LD(l.status))throw fp(l.status,a);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:MD(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const m_=200,g_=206;function UF(n){const t=n.response;return typeof t!="string"?t:ap(t).buffer}class zF{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:r}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=RD(this.isHttp,e),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,a]of this.headers)e.setRequestHeader(s,a);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=g_):i.expectedStatus=m_,e.responseType="arraybuffer",ur(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,r),e.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,e.send(null),r}onProgress(t,e){const r=this.pendingRequests[t];r&&r.onProgress?.(e)}onStateChange(t,e){const r=this.pendingRequests[t];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){r.onError(i.status);return}const s=i.status||m_;if(!(s===m_&&r.expectedStatus===g_)&&s!==r.expectedStatus){r.onError(i.status);return}const l=UF(i);if(s===g_){const u=i.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);f?r.onDone({begin:parseInt(f[1],10),chunk:l}):(ze('Missing or invalid "Content-Range" header.'),r.onError(0))}else l?r.onDone({begin:0,chunk:l}):r.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class jF{constructor(t){this._source=t,this._manager=new zF(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return ur(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new HF(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const r=new $F(this._manager,t,e);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class HF{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Wg(e.responseURL);const r=e.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[u,...f]=l.split(": ");return[u,f.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=ND({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=kD(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=fp(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class $F{constructor(t,e,r){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Wg(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=fp(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const GF=/^[a-z][a-z0-9\-+.]+:/i;function VF(n){if(GF.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class WF{constructor(t){this.source=t,this.url=VF(t.url),ur(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ur(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new qF(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new YF(this,t,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class qF{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=fp(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Bo("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class YF{constructor(t,e,r){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const id=Symbol("INITIAL_DATA");class PD{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:id}}get(t,e=null){if(e){const i=this.#e(t);return i.promise.then(()=>e(i.data)),null}const r=this.#t[t];if(!r||r.data===id)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return r.data}has(t){const e=this.#t[t];return!!e&&e.data!==id}delete(t){const e=this.#t[t];return!e||e.data===id?!1:(delete this.#t[t],!0)}resolve(t,e=null){const r=this.#e(t);r.data=e,r.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==id&&(yield[t,e])}}}const XF=1e5,AS=30;let Id=class ks{#t=Promise.withResolvers();#e=null;#n=!1;#r=!!globalThis.FontInspector?.enabled;#s=null;#i=null;#l=0;#o=0;#f=null;#c=null;#h=0;#u=0;#d=Object.create(null);#a=[];#p=null;#g=[];#m=new WeakMap;#v=null;static#_=new Map;static#x=new Map;static#b=new WeakMap;static#E=null;static#S=new Set;constructor({textContentSource:t,container:e,viewport:r}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(u){u.enqueue(t),u.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=r.scale*ca.pixelRatio,this.#h=r.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:s,pageX:a,pageY:l}=r.rawDims;this.#v=[1,0,0,-1,-a,l+s],this.#o=i,this.#l=s,ks.#N(),Nl(e,r),this.#t.promise.finally(()=>{ks.#S.delete(this),this.#i=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Or.platform;return Xe(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#f.read().then(({value:e,done:r})=>{if(r){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#d,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#f=this.#p.getReader(),ks.#S.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const r=t.scale*ca.pixelRatio,i=t.rotation;if(i!==this.#h&&(e?.(),this.#h=i,Nl(this.#c,{rotation:i})),r!==this.#u){e?.(),this.#u=r;const s={div:null,properties:null,ctx:ks.#D(this.#s)};for(const a of this.#g)s.properties=this.#m.get(a),s.div=a,this.#w(s)}}cancel(){const t=new Bo("TextLayer task cancelled.");this.#f?.cancel(t).catch(()=>{}),this.#f=null,this.#t.reject(t)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#a}#C(t){if(this.#n)return;this.#i.ctx??=ks.#D(this.#s);const e=this.#g,r=this.#a;for(const i of t){if(e.length>XF){ze("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const s=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),i.id!==null&&this.#e.setAttribute("id",`${i.id}`),s.append(this.#e)}else i.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}r.push(i.str),this.#O(i)}}#O(t){const e=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#g.push(e);const i=ye.transform(this.#v,t.transform);let s=Math.atan2(i[1],i[0]);const a=this.#d[t.fontName];a.vertical&&(s+=Math.PI/2);let l=this.#r&&a.fontSubstitution||a.fontFamily;l=ks.fontFamilyMap.get(l)||l;const u=Math.hypot(i[2],i[3]),f=u*ks.#k(l,a,this.#s);let d,p;s===0?(d=i[4],p=i[5]-f):(d=i[4]+f*Math.sin(s),p=i[5]-f*Math.cos(s));const m="calc(var(--total-scale-factor) *",v=e.style;this.#e===this.#c?(v.left=`${(100*d/this.#o).toFixed(2)}%`,v.top=`${(100*p/this.#l).toFixed(2)}%`):(v.left=`${m}${d.toFixed(2)}px)`,v.top=`${m}${p.toFixed(2)}px)`),v.fontSize=`${m}${(ks.#E*u).toFixed(2)}px)`,v.fontFamily=l,r.fontSize=u,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#r&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),s!==0&&(r.angle=s*(180/Math.PI));let x=!1;if(t.str.length>1)x=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),y=Math.abs(t.transform[3]);_!==y&&Math.max(_,y)/Math.min(_,y)>1.5&&(x=!0)}if(x&&(r.canvasWidth=a.vertical?t.height:t.width),this.#m.set(e,r),this.#i.div=e,this.#i.properties=r,this.#w(this.#i),r.hasText&&this.#e.append(e),r.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#w(t){const{div:e,properties:r,ctx:i}=t,{style:s}=e;let a="";if(ks.#E>1&&(a=`scale(${1/ks.#E})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=s,{canvasWidth:u,fontSize:f}=r;ks.#T(i,f*this.#u,l);const{width:d}=i.measureText(e.textContent);d>0&&(a=`scaleX(${u*this.#u/d}) ${a}`)}r.angle!==0&&(a=`rotate(${r.angle}deg) ${a}`),a.length>0&&(s.transform=a)}static cleanup(){if(!(this.#S.size>0)){this.#_.clear();for(const{canvas:t}of this.#x.values())t.remove();this.#x.clear()}}static#D(t=null){let e=this.#x.get(t||="");if(!e){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=t,document.body.append(r),e=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#x.set(t,e),this.#b.set(e,{size:0,family:""})}return e}static#T(t,e,r){const i=this.#b.get(t);e===i.size&&r===i.family||(t.font=`${e}px ${r}`,i.size=e,i.family=r)}static#N(){if(this.#E!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#E=t.getBoundingClientRect().height,t.remove()}static#k(t,e,r){const i=this.#_.get(t);if(i)return i;const s=this.#D(r);s.canvas.width=s.canvas.height=AS,this.#T(s,AS,t);const a=s.measureText(""),l=a.fontBoundingBoxAscent,u=Math.abs(a.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let f=.8;return l?f=l/(l+u):(Or.platform.isFirefox&&ze("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#_.set(t,f),f}};class Md{static textContent(t){const e=[],r={items:e,styles:Object.create(null)};function i(s){if(!s)return;let a=null;const l=s.name;if(l==="#text")a=s.value;else if(Md.shouldBuildText(l))s?.attributes?.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&e.push({str:a}),!!s.children)for(const u of s.children)i(u)}return i(t),r}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const KF=100;function By(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new Uy,{docId:e}=t,r=n.url?aF(n.url):null,i=n.data?oF(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,l=n.password??null,u=n.range instanceof zy?n.range:null,f=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof df?n.worker:null;const p=n.verbosity,m=typeof n.docBaseUrl=="string"&&!lp(n.docBaseUrl)?n.docBaseUrl:null,v=om(n.cMapUrl),x=n.cMapPacked!==!1,_=n.CMapReaderFactory||(yi?pF:hS),y=om(n.iccUrl),w=om(n.standardFontDataUrl),S=n.StandardFontDataFactory||(yi?mF:dS),T=om(n.wasmUrl),C=n.WasmFactory||(yi?gF:pS),R=n.stopAtErrors!==!0,N=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,D=n.isEvalSupported!==!1,I=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!yi,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!yi&&(Or.platform.isFirefox||!globalThis.chrome),B=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,H=typeof n.disableFontFace=="boolean"?n.disableFontFace:yi,F=n.fontExtraProperties===!0,rt=n.enableXfa===!0,L=n.ownerDocument||globalThis.document,it=n.disableRange===!0,Z=n.disableStream===!0,q=n.disableAutoFetch===!0,Ct=n.pdfBug===!0,at=n.CanvasFactory||(yi?dF:uF),P=n.FilterFactory||(yi?hF:fF),V=n.enableHWA===!0,j=n.useWasm!==!1,et=u?u.length:n.length??NaN,dt=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!yi&&!H,xt=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(_===hS&&S===dS&&C===pS&&v&&w&&T&&pd(v,document.baseURI)&&pd(w,document.baseURI)&&pd(T,document.baseURI)),Nt=null;HP(p);const Rt={canvasFactory:new at({ownerDocument:L,enableHWA:V}),filterFactory:new P({docId:e,ownerDocument:L}),cMapReaderFactory:xt?null:new _({baseUrl:v,isCompressed:x}),standardFontDataFactory:xt?null:new S({baseUrl:w}),wasmFactory:xt?null:new C({baseUrl:T})};d||(d=df.create({verbosity:p,port:Sl.workerPort}),t._worker=d);const z={docId:e,apiVersion:"5.3.31",data:i,password:l,disableAutoFetch:q,rangeChunkSize:f,length:et,docBaseUrl:m,enableXfa:rt,evaluatorOptions:{maxImageSize:N,disableFontFace:H,ignoreErrors:R,isEvalSupported:D,isOffscreenCanvasSupported:I,isImageDecoderSupported:M,canvasMaxAreaInBytes:B,fontExtraProperties:F,useSystemFonts:dt,useWasm:j,useWorkerFetch:xt,cMapUrl:v,iccUrl:y,standardFontDataUrl:w,wasmUrl:T}},lt={ownerDocument:L,pdfBug:Ct,styleElement:Nt,loadingParams:{disableAutoFetch:q,enableXfa:rt}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const J=d.messageHandler.sendWithPromise("GetDocRequest",z,i?[i.buffer]:null);let ot;if(u)ot=new kF(u,{disableRange:it,disableStream:Z});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");const yt=pd(r)?PF:yi?WF:jF;ot=new yt({url:r,length:et,httpHeaders:s,withCredentials:a,rangeChunkSize:f,disableRange:it,disableStream:Z})}return J.then(yt=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const At=new md(e,yt,d.port),O=new JF(At,t,ot,lt,Rt);t._transport=O,At.send("Ready",null)})}).catch(t._capability.reject),t}class Uy{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Uy.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let zy=class{#t=Promise.withResolvers();#e=[];#n=[];#r=[];#s=[];constructor(t,e,r=!1,i=null){this.length=t,this.initialData=e,this.progressiveDone=r,this.contentDispositionFilename=i}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#r.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const r of this.#s)r(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const r of this.#r)r(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Tn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class ZF{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Xe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class QF{#t=!1;constructor(t,e,r,i=!1){this._pageIndex=t,this._pageInfo=e,this._transport=r,this._stats=i?new cS:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new PD,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:s=!1}={}){return new op({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:r,offsetY:i,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Xe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:r="display",annotationMode:i=Ha.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:f=null,printAnnotationStorage:d=null,isEditing:p=!1}){this._stats?.time("Overall");const m=this._transport.getRenderingIntent(r,i,d,p),{renderingIntent:v,cacheKey:x}=m;this.#t=!1,l||=this._transport.getOptionalContentConfig(v);let _=this._intentStates.get(x);_||(_=Object.create(null),this._intentStates.set(x,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const y=!!(v&rs.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(m));const w=C=>{_.renderTasks.delete(S),y&&(this.#t=!0),this.#e(),C?(S.capability.reject(C),this._abortOperatorList({intentState:_,reason:C instanceof Error?C:new Error(C)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new Yu({callback:w,params:{canvasContext:t,viewport:e,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!y,pdfBug:this._pdfBug,pageColors:f});(_.renderTasks||=new Set).add(S);const T=S.task;return Promise.all([_.displayReadyCapability.promise,l]).then(([C,R])=>{if(this.destroyed){w();return}if(this._stats?.time("Rendering"),!(R.renderingIntent&v))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:C,optionalContentConfig:R}),S.operatorListChanged()}).catch(w),T}getOperatorList({intent:t="display",annotationMode:e=Ha.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){function s(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(u))}const a=this._transport.getRenderingIntent(t,e,r,i,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let u;return l.opListReadCapability||(u=Object.create(null),u.operatorListChanged=s,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||=new Set).add(u),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>Md.textContent(r));const e=this.streamTextContent(t);return new Promise(function(r,i){function s(){a.read().then(function({value:u,done:f}){if(f){r(l);return}l.lang??=u.lang,Object.assign(l.styles,u.styles),l.items.push(...u.items),s()},i)}const a=e.getReader(),l={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const r of e.renderTasks)t.push(r.completed),r.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new cS),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const r=this._intentStates.get(e);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let r=0,i=t.length;r<i;r++)e.operatorList.fnArray.push(t.fnArray[r]),e.operatorList.argsArray.push(t.argsArray[r]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const r of e.renderTasks)r.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:r,modifiedIds:i}){const{map:s,transfer:a}=r,u=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:i},a).getReader(),f=this._intentStates.get(e);f.streamReader=u;const d=()=>{u.read().then(({value:p,done:m})=>{if(m){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,f),d())},p=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const m of f.renderTasks)m.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(p);else if(f.opListReadCapability)f.opListReadCapability.reject(p);else throw p}})};d()}_abortOperatorList({intentState:t,reason:e,force:r=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!r){if(t.renderTasks.size>0)return;if(e instanceof Gg){let i=KF;e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i);return}}if(t.streamReader.cancel(new Bo(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var El,sa,Oo,wc,kg,Ec,Ac,Si,$m,FD,BD,gd,af,Gm;const Fn=class Fn{constructor({name:t=null,port:e=null,verbosity:r=$P()}={}){Ra(this,Si);Ra(this,El,Promise.withResolvers());Ra(this,sa,null);Ra(this,Oo,null);Ra(this,wc,null);if(this.name=t,this.destroyed=!1,this.verbosity=r,e){if(Pn(Fn,Ac).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Pn(Fn,Ac).set(e,this),Na(this,Si,FD).call(this,e)}else Na(this,Si,BD).call(this)}get promise(){return Pn(this,El).promise}get port(){return Pn(this,Oo)}get messageHandler(){return Pn(this,sa)}destroy(){this.destroyed=!0,Pn(this,wc)?.terminate(),zi(this,wc,null),Pn(Fn,Ac).delete(Pn(this,Oo)),zi(this,Oo,null),Pn(this,sa)?.destroy(),zi(this,sa,null)}static create(t){const e=Pn(this,Ac).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Fn(t)}static get workerSrc(){if(Sl.workerSrc)return Sl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Xe(this,"_setupFakeWorkerGlobal",(async()=>Pn(this,af,Gm)?Pn(this,af,Gm):(await import(this.workerSrc)).WorkerMessageHandler)())}};El=new WeakMap,sa=new WeakMap,Oo=new WeakMap,wc=new WeakMap,kg=new WeakMap,Ec=new WeakMap,Ac=new WeakMap,Si=new WeakSet,$m=function(){Pn(this,El).resolve(),Pn(this,sa).send("configure",{verbosity:this.verbosity})},FD=function(t){zi(this,Oo,t),zi(this,sa,new md("main","worker",t)),Pn(this,sa).on("ready",()=>{}),Na(this,Si,$m).call(this)},BD=function(){if(Pn(Fn,Ec)||Pn(Fn,af,Gm)){Na(this,Si,gd).call(this);return}let{workerSrc:t}=Fn;try{Fn._isSameOrigin(window.location,t)||(t=Fn._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),r=new md("main","worker",e),i=()=>{s.abort(),r.destroy(),e.terminate(),this.destroyed?Pn(this,El).reject(new Error("Worker was destroyed")):Na(this,Si,gd).call(this)},s=new AbortController;e.addEventListener("error",()=>{Pn(this,wc)||i()},{signal:s.signal}),r.on("test",l=>{if(s.abort(),this.destroyed||!l){i();return}zi(this,sa,r),zi(this,Oo,e),zi(this,wc,e),Na(this,Si,$m).call(this)}),r.on("ready",l=>{if(s.abort(),this.destroyed){i();return}try{a()}catch{Na(this,Si,gd).call(this)}});const a=()=>{const l=new Uint8Array;r.send("test",l,[l.buffer])};a();return}catch{$g("The worker has been disabled.")}Na(this,Si,gd).call(this)},gd=function(){Pn(Fn,Ec)||(ze("Setting up fake worker."),zi(Fn,Ec,!0)),Fn._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Pn(this,El).reject(new Error("Worker was destroyed"));return}const e=new cF;zi(this,Oo,e);const r=`fake${nA(Fn,kg)._++}`,i=new md(r+"_worker",r,e);t.setup(i,e),zi(this,sa,new md(r,r+"_worker",e)),Na(this,Si,$m).call(this)}).catch(t=>{Pn(this,El).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},af=new WeakSet,Gm=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ra(Fn,af),Ra(Fn,kg,0),Ra(Fn,Ec,!1),Ra(Fn,Ac,new WeakMap),yi&&(zi(Fn,Ec,!0),Sl.workerSrc||="./pdf.worker.mjs"),Fn._isSameOrigin=(t,e)=>{const r=URL.parse(t);if(!r?.origin||r.origin==="null")return!1;const i=new URL(e,r);return r.origin===i.origin},Fn._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Fn.fromPort=t=>{if(QP("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Fn.create(t)};let df=Fn;class JF{#t=new Map;#e=new Map;#n=new Map;#r=new Map;#s=null;constructor(t,e,r,i,s){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new PD,this.fontLoader=new iF({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#i(t,e=null){const r=this.#t.get(t);if(r)return r;const i=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,i),i}get annotationStorage(){return Xe(this,"annotationStorage",new Iy)}getRenderingIntent(t,e=Ha.ENABLE,r=null,i=!1,s=!1){let a=rs.DISPLAY,l=Ox;switch(t){case"any":a=rs.ANY;break;case"display":break;case"print":a=rs.PRINT;break;default:ze(`getRenderingIntent - invalid intent: ${t}`)}const u=a&rs.PRINT&&r instanceof ED?r:this.annotationStorage;switch(e){case Ha.DISABLE:a+=rs.ANNOTATIONS_DISABLE;break;case Ha.ENABLE:break;case Ha.ENABLE_FORMS:a+=rs.ANNOTATIONS_FORMS;break;case Ha.ENABLE_STORAGE:a+=rs.ANNOTATIONS_STORAGE,l=u.serializable;break;default:ze(`getRenderingIntent - invalid annotationMode: ${e}`)}i&&(a+=rs.IS_EDITING),s&&(a+=rs.OPLIST);const{ids:f,hash:d}=u.modifiedIds,p=[a,l.hash,d];return{renderingIntent:a,cacheKey:p.join("_"),annotationStorageSerializable:l,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const r of this.#e.values())t.push(r._destroy());this.#e.clear(),this.#n.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Id.cleanup(),this._networkStream?.cancelAllRequests(new Bo("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(r,i)=>{ur(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},i.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){i.close();return}ur(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this._fullReader.cancel(s),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",async r=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:a}=this._fullReader;return(!i||!s)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=l=>{e.onProgress?.({loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:s,contentLength:a}}),t.on("GetRangeReader",(r,i)=>{ur(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:a,done:l}){if(l){i.close();return}ur(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{s.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,e._capability.resolve(new ZF(r,this))}),t.on("DocException",r=>{e._capability.reject(ji(r))}),t.on("PasswordRequest",r=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw ji(r);const i=s=>{s instanceof Error?this.#s.reject(s):this.#s.resolve({password:s})};e.onPassword(i,r.code)}catch(i){this.#s.reject(i)}return this.#s.promise}),t.on("DataLoaded",r=>{e.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),t.on("StartRenderPage",r=>{if(this.destroyed)return;this.#e.get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),t.on("commonobj",([r,i,s])=>{if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":if("error"in s){const f=s.error;ze(`Error during font loading: ${f}`),this.commonObjs.resolve(r,f);break}const a=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,d)=>globalThis.FontInspector.fontAdded(f,d):null,l=new sF(s,a);this.fontLoader.bind(l).catch(()=>t.sendWithPromise("FontFallback",{id:r})).finally(()=>{!l.fontExtraProperties&&l.data&&(l.data=null),this.commonObjs.resolve(r,l)});break;case"CopyLocalImage":const{imageRef:u}=s;ur(u,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,d]of f.objs)if(d?.ref===u)return d.dataLen?(this.commonObjs.resolve(r,structuredClone(d)),d.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,s);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([r,i,s,a])=>{if(this.destroyed)return;const l=this.#e.get(i);if(!l.objs.has(r)){if(l._intentStates.size===0){a?.bitmap?.close();return}switch(s){case"Image":case"Pattern":l.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",r=>{this.destroyed||e.onProgress?.({loaded:r.loaded,total:r.total})}),t.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[r.type];if(!i)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ze("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,r=this.#n.get(e);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#r.set(s.refStr,t);const a=new QF(e,s,this,this._params.pdfBug);return this.#e.set(e,a),a});return this.#n.set(e,i),i}getPageIndex(t){return Rx(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#i("GetOptionalContentConfig").then(e=>new NF(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const r=this.messageHandler.sendWithPromise(t,null).then(i=>({info:i[0],metadata:i[1]?new OF(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Id.cleanup()}}cachedPageNumber(t){if(!Rx(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#r.get(e)??null}}class t6{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Yu{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:r,commonObjs:i,annotationCanvasMap:s,operatorList:a,pageIndex:l,canvasFactory:u,filterFactory:f,useRequestAnimationFrame:d=!1,pdfBug:p=!1,pageColors:m=null}){this.callback=t,this.params=e,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=u,this.filterFactory=f,this._pdfBug=p,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new t6(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Yu.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Yu.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:i,transform:s,background:a}=this.params;this.gfx=new Xu(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Yu.#e.delete(this._canvas),t||=new Gg(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Yu.#e.delete(this._canvas),this.callback())))}}const UD="5.3.31",zD="47ad820d9";function SS(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function sd(n){return Math.max(0,Math.min(255,255*n))}class TS{static CMYK_G([t,e,r,i]){return["G",1-Math.min(1,.3*t+.59*r+.11*e+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=sd(t),[t,t,t]}static G_HTML([t]){const e=SS(t);return`#${e}${e}${e}`}static RGB_G([t,e,r]){return["G",.3*t+.59*e+.11*r]}static RGB_rgb(t){return t.map(sd)}static RGB_HTML(t){return`#${t.map(SS).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,r,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,r+i),1-Math.min(1,e+i)]}static CMYK_rgb([t,e,r,i]){return[sd(1-Math.min(1,t+i)),sd(1-Math.min(1,r+i)),sd(1-Math.min(1,e+i))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,r]){const i=1-t,s=1-e,a=1-r,l=Math.min(i,s,a);return["CMYK",i,s,a,l]}}class e6{create(t,e,r=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${e}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${e}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Tn("Abstract method `_createSVG` called.")}}class Pd extends e6{_createSVG(t){return document.createElementNS(Co,t)}}class jy{static setupStorage(t,e,r,i,s){const a=i.getValue(e,{value:null});switch(r.name){case"textarea":if(a.value!==null&&(t.textContent=a.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(a.value===r.attributes.xfaOn?t.setAttribute("checked",!0):a.value===r.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",l=>{i.setValue(e,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&t.setAttribute("value",a.value),s==="print")break;t.addEventListener("input",l=>{i.setValue(e,{value:l.target.value})})}break;case"select":if(a.value!==null){t.setAttribute("value",a.value);for(const l of r.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const u=l.target.options,f=u.selectedIndex===-1?"":u[u.selectedIndex].value;i.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:r=null,intent:i,linkService:s}){const{attributes:a}=e,l=t instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[u,f]of Object.entries(a))if(f!=null)switch(u){case"class":f.length&&t.setAttribute(u,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!l||u!=="href"&&u!=="newWindow")&&t.setAttribute(u,f)}l&&s.addLinkAttributes(t,a.href,a.newWindow),r&&a.dataId&&this.setupStorage(t,a.dataId,e,r)}static render(t){const e=t.annotationStorage,r=t.linkService,i=t.xfaHtml,s=t.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:s,linkService:r});const l=s!=="richText",u=t.div;if(u.append(a),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;u.style.transform=p}l&&u.setAttribute("class","xfaLayer xfaFont");const f=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);a.append(p),l&&Md.shouldBuildText(i.name)&&f.push(p)}return{textDivs:f}}const d=[[i,-1,a]];for(;d.length>0;){const[p,m,v]=d.at(-1);if(m+1===p.children.length){d.pop();continue}const x=p.children[++d.at(-1)[1]];if(x===null)continue;const{name:_}=x;if(_==="#text"){const w=document.createTextNode(x.value);f.push(w),v.append(w);continue}const y=x?.attributes?.xmlns?document.createElementNS(x.attributes.xmlns,_):document.createElement(_);if(v.append(y),x.attributes&&this.setAttributes({html:y,element:x,storage:e,intent:s,linkService:r}),x.children?.length>0)d.push([x,-1,y]);else if(x.value){const w=document.createTextNode(x.value);l&&Md.shouldBuildText(_)&&f.push(w),y.append(w)}}for(const p of u.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const hp=1e3,n6=9,Nc=new WeakSet;class CS{static create(t){switch(t.data.annotationType){case Jn.LINK:return new jD(t);case Jn.TEXT:return new r6(t);case Jn.WIDGET:switch(t.data.fieldType){case"Tx":return new i6(t);case"Btn":return t.data.radioButton?new HD(t):t.data.checkBox?new a6(t):new o6(t);case"Ch":return new l6(t);case"Sig":return new s6(t)}return new Gc(t);case Jn.POPUP:return new kx(t);case Jn.FREETEXT:return new $D(t);case Jn.LINE:return new u6(t);case Jn.SQUARE:return new f6(t);case Jn.CIRCLE:return new h6(t);case Jn.POLYLINE:return new GD(t);case Jn.CARET:return new p6(t);case Jn.INK:return new Hy(t);case Jn.POLYGON:return new d6(t);case Jn.HIGHLIGHT:return new VD(t);case Jn.UNDERLINE:return new m6(t);case Jn.SQUIGGLY:return new g6(t);case Jn.STRIKEOUT:return new v6(t);case Jn.STAMP:return new WD(t);case Jn.FILEATTACHMENT:return new _6(t);default:return new nr(t)}}}class nr{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:r}){return!!(t?.str||e?.str||r?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return nr._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#r(e),this.#n?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#r(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#r(t){const{container:{style:e},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:l,pageY:u}}}}=this;r?.splice(0,4,...t),e.left=`${100*(t[0]-l)/s}%`,e.top=`${100*(a-t[3]+u)/a}%`,i===0?(e.width=`${100*(t[2]-t[0])/s}%`,e.height=`${100*(t[3]-t[1])/a}%`):this.setRotation(i)}_createContainer(t){const{data:e,parent:{page:r,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof Gc||(s.tabIndex=hp);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof kx){const{rotation:_}=e;return!e.hasOwnCanvas&&_!==0&&this.setRotation(_,s),s}const{width:l,height:u}=this;if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const _=e.borderStyle.horizontalCornerRadius,y=e.borderStyle.verticalCornerRadius;if(_>0||y>0){const S=`calc(${_}px * var(--total-scale-factor)) / calc(${y}px * var(--total-scale-factor))`;a.borderRadius=S}else if(this instanceof HD){const S=`calc(${l}px * var(--total-scale-factor)) / calc(${u}px * var(--total-scale-factor))`;a.borderRadius=S}switch(e.borderStyle.style){case $u.SOLID:a.borderStyle="solid";break;case $u.DASHED:a.borderStyle="dashed";break;case $u.BEVELED:ze("Unimplemented border style: beveled");break;case $u.INSET:ze("Unimplemented border style: inset");break;case $u.UNDERLINE:a.borderBottomStyle="solid";break}const w=e.borderColor||null;w?(this.#e=!0,a.borderColor=ye.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):a.borderWidth=0}const f=ye.normalizeRect([e.rect[0],r.view[3]-e.rect[1]+r.view[1],e.rect[2],r.view[3]-e.rect[3]+r.view[1]]),{pageWidth:d,pageHeight:p,pageX:m,pageY:v}=i.rawDims;a.left=`${100*(f[0]-m)/d}%`,a.top=`${100*(f[1]-v)/p}%`;const{rotation:x}=e;return e.hasOwnCanvas||x===0?(a.width=`${100*l/d}%`,a.height=`${100*u/p}%`):this.setRotation(x,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:a}=this;t%180!==0&&([s,a]=[a,s]),e.style.width=`${100*s/r}%`,e.style.height=`${100*a/i}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,r,i)=>{const s=i.detail[e],a=s[0],l=s.slice(1);i.target.style[r]=TS[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[r]:TS[`${a}_rgb`](l)})};return Xe(this,"_commonActions",{display:e=>{const{display:r}=e.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:r}=e.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const r=e.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(t,e){const r=this._commonActions;for(const i of Object.keys(e.detail))(t[i]||r[i])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const r=this._commonActions;for(const[i,s]of Object.entries(e)){const a=r[i];if(a){const l={detail:{[i]:s},target:t};a(l),delete e[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,r,i,s]=this.data.rect.map(_=>Math.fround(_));if(t.length===8){const[_,y,w,S]=t.subarray(2,6);if(i===_&&s===y&&e===w&&r===S)return}const{style:a}=this.container;let l;if(this.#e){const{borderColor:_,borderWidth:y}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${y}">`],this.container.classList.add("hasBorder")}const u=i-e,f=s-r,{svgFactory:d}=this,p=d.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0);const m=d.createElement("defs");p.append(m);const v=d.createElement("clipPath"),x=`clippath_${this.data.id}`;v.setAttribute("id",x),v.setAttribute("clipPathUnits","objectBoundingBox"),m.append(v);for(let _=2,y=t.length;_<y;_+=8){const w=t[_],S=t[_+1],T=t[_+2],C=t[_+3],R=d.createElement("rect"),N=(T-e)/u,D=(s-S)/f,I=(w-T)/u,M=(S-C)/f;R.setAttribute("x",N),R.setAttribute("y",D),R.setAttribute("width",I),R.setAttribute("height",M),v.append(R),l?.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${D}" width="${I}" height="${M}"/>`)}this.#e&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(p),this.container.style.clipPath=`url(#${x})`}_createPopup(){const{data:t}=this,e=this.#n=new kx({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){Tn("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:s,id:a,exportValues:l}of i){if(s===-1||a===e)continue;const u=typeof l=="string"?l:null,f=document.querySelector(`[data-element-id="${a}"]`);if(f&&!Nc.has(f)){ze(`_getElementsByName - element not allowed: ${a}`);continue}r.push({id:a,exportValue:u,domElement:f})}return r}for(const i of document.getElementsByName(t)){const{exportValue:s}=i,a=i.getAttribute("data-element-id");a!==e&&Nc.has(i)&&r.push({id:a,exportValue:s,domElement:i})}return r}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class jD extends nr{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let i=!1;return t.url?(e.addLinkAttributes(r,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(r,t.action),i=!0):t.attachment?(this.#e(r,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(this.#n(r,t.setOCGState),i=!0):t.dest?(this._bindLink(r,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),i=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(r),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#t()}#e(t,e,r=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,r),!1),this.#t()}#n(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(e.actions)){const s=r.get(i);s&&(t[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:i}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ze('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{r?.();const{fields:i,refs:s,include:a}=e,l=[];if(i.length!==0||s.length!==0){const d=new Set(s);for(const p of i){const m=this._fieldObjects[p]||[];for(const{id:v}of m)d.add(v)}for(const p of Object.values(this._fieldObjects))for(const m of p)d.has(m.id)===a&&l.push(m)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const u=this.annotationStorage,f=[];for(const d of l){const{id:p}=d;switch(f.push(p),d.type){case"text":{const v=d.defaultValue||"";u.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=d.defaultValue===d.exportValues;u.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=d.defaultValue||"";u.setValue(p,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!Nc.has(m)){ze(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class r6 extends nr{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Gc extends nr{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Or.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,r,i,s){r.includes("mouse")?t.addEventListener(r,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(r,a=>{if(r==="blur"){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if(r==="focus"){if(e.focused)return;e.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(a)}})})}_setEventListeners(t,e,r,i){for(const[s,a]of r)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,s,a,i),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":ye.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||n6,s=t.style;let a;const l=2,u=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-l),d=Math.round(f/(c_*i))||1,p=f/d;a=Math.min(i,u(p/c_))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(i,u(f/c_))}s.fontSize=`calc(${a}px * var(--total-scale-factor))`,s.color=ye.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class i6 extends Gc{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,r,i){const s=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=r),s.setValue(a.id,{[i]:r})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const i=t.getValue(e,{value:this.data.fieldValue});let s=i.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&s.length>a&&(s=s.slice(0,a));let l=i.formattedValue||this.data.textContent?.join(`
`)||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const u={userValue:s,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=l??s,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",l??s),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Nc.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=hp,this._setRequired(r,this.data.required),a&&(r.maxLength=a),r.addEventListener("input",d=>{t.setValue(e,{value:d.target.value}),this.setPropertyOnSiblings(r,"value",d.target.value,"value"),u.formattedValue=null}),r.addEventListener("resetform",d=>{const p=this.data.defaultFieldValue??"";r.value=u.userValue=p,u.formattedValue=null});let f=d=>{const{formattedValue:p}=u;p!=null&&(d.target.value=p),d.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",p=>{if(u.focused)return;const{target:m}=p;u.userValue&&(m.value=u.userValue),u.lastCommittedValue=m.value,u.commitKey=1,this.data.actions?.Focus||(u.focused=!0)}),r.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const m={value(v){u.userValue=v.detail.value??"",t.setValue(e,{value:u.userValue.toString()}),v.target.value=u.userValue},formattedValue(v){const{formattedValue:x}=v.detail;u.formattedValue=x,x!=null&&v.target!==document.activeElement&&(v.target.value=x),t.setValue(e,{formattedValue:x})},selRange(v){v.target.setSelectionRange(...v.detail.selRange)},charLimit:v=>{const{charLimit:x}=v.detail,{target:_}=v;if(x===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",x);let y=u.userValue;!y||y.length<=x||(y=y.slice(0,x),_.value=u.userValue=y,t.setValue(e,{value:y}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(m,p)}),r.addEventListener("keydown",p=>{u.commitKey=1;let m=-1;if(p.key==="Escape"?m=0:p.key==="Enter"&&!this.data.multiLine?m=2:p.key==="Tab"&&(u.commitKey=3),m===-1)return;const{value:v}=p.target;u.lastCommittedValue!==v&&(u.lastCommittedValue=v,u.userValue=v,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:v,willCommit:!0,commitKey:m,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const d=f;f=null,r.addEventListener("blur",p=>{if(!u.focused||!p.relatedTarget)return;this.data.actions?.Blur||(u.focused=!1);const{value:m}=p.target;u.userValue=m,u.lastCommittedValue!==m&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:m,willCommit:!0,commitKey:u.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}),d(p)}),this.data.actions?.Keystroke&&r.addEventListener("beforeinput",p=>{u.lastCommittedValue=null;const{data:m,target:v}=p,{value:x,selectionStart:_,selectionEnd:y}=v;let w=_,S=y;switch(p.inputType){case"deleteWordBackward":{const T=x.substring(0,_).match(/\w*[^\w]*$/);T&&(w-=T[0].length);break}case"deleteWordForward":{const T=x.substring(_).match(/^[^\w]*\w*/);T&&(S+=T[0].length);break}case"deleteContentBackward":_===y&&(w-=1);break;case"deleteContentForward":_===y&&(S+=1);break}p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,change:m||"",willCommit:!1,selStart:w,selEnd:S}})}),this._setEventListeners(r,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(f&&r.addEventListener("blur",f),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/a;r.classList.add("comb"),r.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class s6 extends Gc{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class a6 extends Gc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,r=e.id;let i=t.getValue(r,{value:e.exportValue===e.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Nc.add(s),s.setAttribute("data-element-id",r),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=hp,s.addEventListener("change",a=>{const{name:l,checked:u}=a.target;for(const f of this._getElementsByName(l,r)){const d=u&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=d),t.setValue(f.id,{value:d})}t.setValue(r,{value:u})}),s.addEventListener("resetform",a=>{const l=e.defaultFieldValue||"Off";a.target.checked=l===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const l={value(u){u.target.checked=u.detail.value!=="Off",t.setValue(r,{value:u.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class HD extends Gc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,r=e.id;let i=t.getValue(r,{value:e.fieldValue===e.buttonValue}).value;if(typeof i=="string"&&(i=i!==e.buttonValue,t.setValue(r,{value:i})),i)for(const a of this._getElementsByName(e.fieldName,r))t.setValue(a.id,{value:!1});const s=document.createElement("input");if(Nc.add(s),s.setAttribute("data-element-id",r),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=hp,s.addEventListener("change",a=>{const{name:l,checked:u}=a.target;for(const f of this._getElementsByName(l,r))t.setValue(f.id,{value:!1});t.setValue(r,{value:u})}),s.addEventListener("resetform",a=>{const l=e.defaultFieldValue;a.target.checked=l!=null&&l===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;s.addEventListener("updatefromsandbox",l=>{const u={value:f=>{const d=a===f.detail.value;for(const p of this._getElementsByName(f.target.name)){const m=d&&p.id===r;p.domElement&&(p.domElement.checked=m),t.setValue(p.id,{value:m})}}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class o6 extends jD{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),t}}class l6 extends Gc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,r=t.getValue(e,{value:this.data.fieldValue}),i=document.createElement("select");Nc.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=hp;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const p=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===p});for(const d of this.data.options){const p=document.createElement("option");p.textContent=d.displayValue,p.value=d.exportValue,r.value.includes(d.exportValue)&&(p.setAttribute("selected",!0),s=!1),i.append(p)}let a=null;if(s){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),a=()=>{d.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const l=d=>{const p=d?"value":"textContent",{options:m,multiple:v}=i;return v?Array.prototype.filter.call(m,x=>x.selected).map(x=>x[p]):m.selectedIndex===-1?null:m[m.selectedIndex][p]};let u=l(!1);const f=d=>{const p=d.target.options;return Array.prototype.map.call(p,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const p={value(m){a?.();const v=m.detail.value,x=new Set(Array.isArray(v)?v:[v]);for(const _ of i.options)_.selected=x.has(_.value);t.setValue(e,{value:l(!0)}),u=l(!1)},multipleSelection(m){i.multiple=!0},remove(m){const v=i.options,x=m.detail.remove;v[x].selected=!1,i.remove(x),v.length>0&&Array.prototype.findIndex.call(v,y=>y.selected)===-1&&(v[0].selected=!0),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},clear(m){for(;i.length!==0;)i.remove(0);t.setValue(e,{value:null,items:[]}),u=l(!1)},insert(m){const{index:v,displayValue:x,exportValue:_}=m.detail.insert,y=i.children[v],w=document.createElement("option");w.textContent=x,w.value=_,y?y.before(w):i.append(w),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},items(m){const{items:v}=m.detail;for(;i.length!==0;)i.remove(0);for(const x of v){const{displayValue:_,exportValue:y}=x,w=document.createElement("option");w.textContent=_,w.value=y,i.append(w)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(e,{value:l(!0),items:f(m)}),u=l(!1)},indices(m){const v=new Set(m.detail.indices);for(const x of m.target.options)x.selected=v.has(x.index);t.setValue(e,{value:l(!0)}),u=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(p,d)}),i.addEventListener("input",d=>{const p=l(!0),m=l(!1);t.setValue(e,{value:p}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:u,change:m,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){t.setValue(e,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class kx extends nr{constructor(t){const{data:e,elements:r}=t;super(t,{isRenderable:nr._hasPopupData(e)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new c6({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",e.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(r=>`${Oy}${r}`).join(",")),this.container}}class c6{#t=this.#C.bind(this);#e=this.#T.bind(this);#n=this.#D.bind(this);#r=this.#w.bind(this);#s=null;#i=null;#l=null;#o=null;#f=null;#c=null;#h=null;#u=!1;#d=null;#a=null;#p=null;#g=null;#m=null;#v=null;#_=!1;constructor({container:t,color:e,elements:r,titleObj:i,modificationDate:s,contentsObj:a,richText:l,parent:u,rect:f,parentRect:d,open:p}){this.#i=t,this.#m=i,this.#l=a,this.#g=l,this.#c=u,this.#s=e,this.#p=f,this.#h=d,this.#f=r,this.#o=Ry.toDateObject(s),this.trigger=r.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",this.#r),m.addEventListener("mouseenter",this.#n),m.addEventListener("mouseleave",this.#e),m.classList.add("popupTriggerArea");for(const m of r)m.container?.addEventListener("keydown",this.#t);this.#i.hidden=!0,p&&this.#w()}render(){if(this.#d)return;const t=this.#d=document.createElement("div");if(t.className="popup",this.#s){const s=t.style.outlineColor=ye.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");e.className="header";const r=document.createElement("h1");if(e.append(r),{dir:r.dir,str:r.textContent}=this.#m,t.append(e),this.#o){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),e.append(s)}const i=this.#x;if(i)jy.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#l);t.append(s)}this.#i.append(t)}get#x(){const t=this.#g,e=this.#l;return t?.str&&(!e?.str||e.str===t.str)&&this.#g.html||null}get#b(){return this.#x?.attributes?.style?.fontSize||0}get#E(){return this.#x?.attributes?.style?.color||null}#S(t){const e=[],r={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},i={style:{color:this.#E,fontSize:this.#b?`calc(${this.#b}px * var(--total-scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:i});return r}_formatContents({str:t,dir:e}){const r=document.createElement("p");r.classList.add("popupContent"),r.dir=e;const i=t.split(/(?:\r\n?|\n)/);for(let s=0,a=i.length;s<a;++s){const l=i[s];r.append(document.createTextNode(l)),s<a-1&&r.append(document.createElement("br"))}return r}#C(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#u)&&this.#w()}updateEdited({rect:t,popupContent:e}){this.#v||={contentsObj:this.#l,richText:this.#g},t&&(this.#a=null),e&&(this.#g=this.#S(e),this.#l=null),this.#d?.remove(),this.#d=null}resetEdited(){this.#v&&({contentsObj:this.#l,richText:this.#g}=this.#v,this.#v=null,this.#d?.remove(),this.#d=null,this.#a=null)}#O(){if(this.#a!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:r,pageX:i,pageY:s}}}=this.#c;let a=!!this.#h,l=a?this.#h:this.#p;for(const x of this.#f)if(!l||ye.intersect(x.data.rect,l)!==null){l=x.data.rect,a=!0;break}const u=ye.normalizeRect([l[0],t[3]-l[1]+t[1],l[2],t[3]-l[3]+t[1]]),d=a?l[2]-l[0]+5:0,p=u[0]+d,m=u[1];this.#a=[100*(p-i)/e,100*(m-s)/r];const{style:v}=this.#i;v.left=`${this.#a[0]}%`,v.top=`${this.#a[1]}%`}#w(){this.#u=!this.#u,this.#u?(this.#D(),this.#i.addEventListener("click",this.#r),this.#i.addEventListener("keydown",this.#t)):(this.#T(),this.#i.removeEventListener("click",this.#r),this.#i.removeEventListener("keydown",this.#t))}#D(){this.#d||this.render(),this.isVisible?this.#u&&this.#i.classList.add("focused"):(this.#O(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#T(){this.#i.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#i.hidden=!0)}maybeShow(){this.#_&&(this.#d||this.#D(),this.#_=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class $D extends nr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Be.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const r=document.createElement("span");r.textContent=e,t.append(r)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class u6 extends nr{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:r}=this,i=this.svgFactory.create(e,r,!0),s=this.#t=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class f6 extends nr{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:r}=this,i=this.svgFactory.create(e,r,!0),s=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",s/2),a.setAttribute("y",s/2),a.setAttribute("width",e-s),a.setAttribute("height",r-s),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class h6 extends nr{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:r}=this,i=this.svgFactory.create(e,r,!0),s=t.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",e/2),a.setAttribute("cy",r/2),a.setAttribute("rx",e/2-s/2),a.setAttribute("ry",r/2-s/2),a.setAttribute("stroke-width",s||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class GD extends nr{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:r,popupRef:i},width:s,height:a}=this;if(!e)return this.container;const l=this.svgFactory.create(s,a,!0);let u=[];for(let d=0,p=e.length;d<p;d+=2){const m=e[d]-t[0],v=t[3]-e[d+1];u.push(`${m},${v}`)}u=u.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",u),f.setAttribute("stroke-width",r.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),l.append(f),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class d6 extends GD{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class p6 extends nr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Hy extends nr{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Be.HIGHLIGHT:Be.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:r,borderStyle:i,popupRef:s}}=this,{transform:a,width:l,height:u}=this.#n(e,t),f=this.svgFactory.create(l,u,!0),d=this.#t=this.svgFactory.createElement("svg:g");f.append(d),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",a);for(let p=0,m=r.length;p<m;p++){const v=this.svgFactory.createElement(this.svgElementName);this.#e.push(v),v.setAttribute("points",r[p].join(",")),d.append(v)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:r,rect:i}=t,s=this.#t;if(e>=0&&s.setAttribute("stroke-width",e||1),r)for(let a=0,l=this.#e.length;a<l;a++)this.#e[a].setAttribute("points",r[a].join(","));if(i){const{transform:a,width:l,height:u}=this.#n(this.data.rotation,i);s.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),s.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class VD extends nr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Be.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class m6 extends nr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class g6 extends nr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class v6 extends nr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class WD extends nr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Be.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class _6 extends nr{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let r;e.hasAppearance||e.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),r.addEventListener("dblclick",this.#e.bind(this)),this.#t=r;const{isMac:i}=Or.platform;return t.addEventListener("keydown",s=>{s.key==="Enter"&&(i?s.metaKey:s.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let $y=class qD{#t=null;#e=null;#n=new Map;#r=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:r,annotationEditorUIManager:i,page:s,viewport:a,structTreeLayer:l}){this.div=t,this.#t=e,this.#e=r,this.#r=l||null,this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#n.size>0}async#s(t,e){const r=t.firstChild||t,i=r.id=`${Oy}${e}`,s=await this.#r?.getAriaAttributes(i);if(s)for(const[a,l]of s)r.setAttribute(a,l);this.div.append(t),this.#t?.moveElementInDOM(this.div,t,r,!1)}async render(t){const{annotations:e}=t,r=this.div;Nl(r,this.viewport);const i=new Map,s={data:null,layer:r,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Pd,annotationStorage:t.annotationStorage||new Iy,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const a of e){if(a.noHTML)continue;const l=a.annotationType===Jn.POPUP;if(l){const d=i.get(a.id);if(!d)continue;s.elements=d}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;s.data=a;const u=CS.create(s);if(!u.isRenderable)continue;if(!l&&a.popupRef){const d=i.get(a.popupRef);d?d.push(u):i.set(a.popupRef,[u])}const f=u.render();a.hidden&&(f.style.visibility="hidden"),await this.#s(f,a.id),u._isEditable&&(this.#n.set(u.data.id,u),this._annotationEditorUIManager?.renderAnnotationElement(u))}this.#i()}async addLinkAnnotations(t,e){const r={data:null,layer:this.div,linkService:e,svgFactory:new Pd,parent:this};for(const i of t){i.borderStyle||=qD._defaultBorderStyle,r.data=i;const s=CS.create(r);if(!s.isRenderable)continue;const a=s.render();await this.#s(a,i.id)}}update({viewport:t}){const e=this.div;this.viewport=t,Nl(e,{rotation:t.rotation}),this.#i(),e.hidden=!1}#i(){if(!this.#e)return;const t=this.div;for(const[e,r]of this.#e){const i=t.querySelector(`[data-annotation-id="${e}"]`);if(!i)continue;r.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(r):s.classList.contains("annotationContent")?s.after(r):s.before(r):i.append(r);const a=this.#n.get(e);a&&(a._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,i.id,r),a._hasNoCanvas=!1):a.canvas=r)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}static get _defaultBorderStyle(){return Xe(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:$u.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const fm=/\r\n?|\n/g;class br extends Se{#t;#e="";#n=`${this.id}-editor`;#r=null;#s;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=br.prototype,e=s=>s.isEmpty(),r=Uo.TRANSLATE_SMALL,i=Uo.TRANSLATE_BIG;return Xe(this,"_keyboardManager",new cp([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}]]))}static _type="freetext";static _editorType=Be.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||br._defaultColor||Se._defaultLineColor,this.#s=t.fontSize||br._defaultFontSize}static initialize(t,e){Se.initialize(t,e);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Ke.FREETEXT_SIZE:br._defaultFontSize=e;break;case Ke.FREETEXT_COLOR:br._defaultColor=e;break}}updateParams(t,e){switch(t){case Ke.FREETEXT_SIZE:this.#i(e);break;case Ke.FREETEXT_COLOR:this.#l(e);break}}static get defaultPropertiesToUpdate(){return[[Ke.FREETEXT_SIZE,br._defaultFontSize],[Ke.FREETEXT_COLOR,br._defaultColor||Se._defaultLineColor]]}get propertiesToUpdate(){return[[Ke.FREETEXT_SIZE,this.#s],[Ke.FREETEXT_COLOR,this.#t]]}#i(t){const e=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#s)*this.parentScale),this.#s=i,this.#f()},r=this.#s;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(t){const e=i=>{this.#t=this.editorDiv.style.color=i},r=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-br._internalPadding*t,-(br._internalPadding+this.#s)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#r=new AbortController;const t=this._uiManager.combinedSignal(this.#r);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#r?.abort(),this.#r=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const r of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(br.#c(r)),e=r);return t.join(`
`)}#f(){const[t,e]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:i,div:s}=this,a=s.style.display,l=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",i.div.append(this.div),r=s.getBoundingClientRect(),s.remove(),s.style.display=a,s.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/e):(this.width=r.height/t,this.height=r.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const r=i=>{if(this.#e=i,!i){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#f()};this.addCommands({cmd:()=>{r(e)},undo:()=>{r(t)},mustExec:!1}),this.#f()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){br._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,r.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,s]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[f,d]=this.pageDimensions,[p,m]=this.pageTranslation;let v,x;switch(this.rotation){case 0:v=t+(a[0]-p)/f,x=e+this.height-(a[1]-m)/d;break;case 90:v=t+(a[0]-p)/f,x=e-(a[1]-m)/d,[l,u]=[u,-l];break;case 180:v=t-this.width+(a[0]-p)/f,x=e-(a[1]-m)/d,[l,u]=[-l,-u];break;case 270:v=t+(a[0]-p-this.height*d)/f,x=e+(a[1]-m-this.width*f)/d,[l,u]=[-u,l];break}this.setAt(v*i,x*s,l,u)}else this._moveAfterPaste(t,e);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(fm,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:r}=e;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const i=br.#d(e.getData("text")||"").replaceAll(fm,`
`);if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const a=s.getRangeAt(0);if(!i.includes(`
`)){a.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:l,startOffset:u}=a,f=[],d=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(d.push(l.nodeValue.slice(u).replaceAll(fm,"")),v!==this.editorDiv){let x=f;for(const _ of this.editorDiv.childNodes){if(_===v){x=d;continue}x.push(br.#c(_))}}f.push(l.nodeValue.slice(0,u).replaceAll(fm,""))}else if(l===this.editorDiv){let v=f,x=0;for(const _ of this.editorDiv.childNodes)x++===u&&(v=d),v.push(br.#c(_))}this.#e=`${f.join(`
`)}${i}${d.join(`
`)}`,this.#h();const p=new Range;let m=Math.sumPrecise(f.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const x=v.nodeValue.length;if(m<=x){p.setStart(v,m),p.setEnd(v,m);break}m-=x}s.removeAllRanges(),s.addRange(p)}#h(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(" "," ")}static#d(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,r){let i=null;if(t instanceof $D){const{data:{defaultAppearanceData:{fontSize:a,fontColor:l},rect:u,rotation:f,id:d,popupRef:p},textContent:m,textPosition:v,parent:{page:{pageNumber:x}}}=t;if(!m||m.length===0)return null;i=t={annotationType:Be.FREETEXT,color:Array.from(l),fontSize:a,value:m.join(`
`),position:v,pageIndex:x-1,rect:u.slice(0),rotation:f,id:d,deleted:!1,popupRef:p}}const s=await super.deserialize(t,e,r);return s.#s=t.fontSize,s.#t=ye.makeHexColor(...t.color),s.#e=br.#d(t.value),s.annotationElementId=t.id||null,s._initialData=i,s}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=br._internalPadding*this.parentScale,r=this.getRect(e,e),i=Se._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),s={annotationType:Be.FREETEXT,color:i,fontSize:this.#s,value:this.#u(),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(s.isCopy=!0,s):this.annotationElementId&&!this.#a(s)?null:(s.id=this.annotationElementId,s)}#a(t){const{value:e,fontSize:r,color:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==r||t.color.some((a,l)=>a!==i[l])||t.pageIndex!==s}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:r}=e;r.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,r.color=this.#t,e.replaceChildren();for(const s of this.#e.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),e.append(a)}const i=br._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:this.#e}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class de{static PRECISION=1e-4;toSVGPath(){Tn("Abstract method `toSVGPath` must be implemented.")}get box(){Tn("Abstract getter `box` must be implemented.")}serialize(t,e){Tn("Abstract method `serialize` must be implemented.")}static _rescale(t,e,r,i,s,a){a||=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l+=2)a[l]=e+t[l]*i,a[l+1]=r+t[l+1]*s;return a}static _rescaleAndSwap(t,e,r,i,s,a){a||=new Float32Array(t.length);for(let l=0,u=t.length;l<u;l+=2)a[l]=e+t[l+1]*i,a[l+1]=r+t[l]*s;return a}static _translate(t,e,r,i){i||=new Float32Array(t.length);for(let s=0,a=t.length;s<a;s+=2)i[s]=e+t[s],i[s+1]=r+t[s+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,r,i,s){switch(s){case 90:return[1-e/r,t/i];case 180:return[1-t/r,1-e/i];case 270:return[e/r,1-t/i];default:return[t/r,e/i]}}static _normalizePagePoint(t,e,r){switch(r){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,r,i,s,a){return[(t+5*r)/6,(e+5*i)/6,(5*r+s)/6,(5*i+a)/6,(r+s)/2,(i+a)/2]}}class bc{#t;#e=[];#n;#r;#s=[];#i=new Float32Array(18);#l;#o;#f;#c;#h;#u;#d=[];static#a=8;static#p=2;static#g=bc.#a+bc.#p;constructor({x:t,y:e},r,i,s,a,l=0){this.#t=r,this.#u=s*i,this.#r=a,this.#i.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=l,this.#c=bc.#a*i,this.#f=bc.#g*i,this.#h=i,this.#d.push(t,e)}isEmpty(){return isNaN(this.#i[8])}#m(){const t=this.#i.subarray(4,6),e=this.#i.subarray(16,18),[r,i,s,a]=this.#t;return[(this.#l+(t[0]-e[0])/2-r)/s,(this.#o+(t[1]-e[1])/2-i)/a,(this.#l+(e[0]-t[0])/2-r)/s,(this.#o+(e[1]-t[1])/2-i)/a]}add({x:t,y:e}){this.#l=t,this.#o=e;const[r,i,s,a]=this.#t;let[l,u,f,d]=this.#i.subarray(8,12);const p=t-f,m=e-d,v=Math.hypot(p,m);if(v<this.#f)return!1;const x=v-this.#c,_=x/v,y=_*p,w=_*m;let S=l,T=u;l=f,u=d,f+=y,d+=w,this.#d?.push(t,e);const C=-w/x,R=y/x,N=C*this.#u,D=R*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([f+N,d+D],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([f-N,d-D],16),isNaN(this.#i[6])?(this.#s.length===0&&(this.#i.set([l+N,u+D],2),this.#s.push(NaN,NaN,NaN,NaN,(l+N-r)/s,(u+D-i)/a),this.#i.set([l-N,u-D],14),this.#e.push(NaN,NaN,NaN,NaN,(l-N-r)/s,(u-D-i)/a)),this.#i.set([S,T,l,u,f,d],6),!this.isEmpty()):(this.#i.set([S,T,l,u,f,d],6),Math.abs(Math.atan2(T-u,S-l)-Math.atan2(w,y))<Math.PI/2?([l,u,f,d]=this.#i.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((l+f)/2-r)/s,((u+d)/2-i)/a),[l,u,S,T]=this.#i.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((S+l)/2-r)/s,((T+u)/2-i)/a),!0):([S,T,l,u,f,d]=this.#i.subarray(0,6),this.#s.push(((S+5*l)/6-r)/s,((T+5*u)/6-i)/a,((5*l+f)/6-r)/s,((5*u+d)/6-i)/a,((l+f)/2-r)/s,((u+d)/2-i)/a),[f,d,l,u,S,T]=this.#i.subarray(12,18),this.#e.push(((S+5*l)/6-r)/s,((T+5*u)/6-i)/a,((5*l+f)/6-r)/s,((5*u+d)/6-i)/a,((l+f)/2-r)/s,((u+d)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#v();const r=[];r.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);this.#x(r);for(let i=e.length-6;i>=6;i-=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);return this.#_(r),r.join(" ")}#v(){const[t,e,r,i]=this.#t,[s,a,l,u]=this.#m();return`M${(this.#i[2]-t)/r} ${(this.#i[3]-e)/i} L${(this.#i[4]-t)/r} ${(this.#i[5]-e)/i} L${s} ${a} L${l} ${u} L${(this.#i[16]-t)/r} ${(this.#i[17]-e)/i} L${(this.#i[14]-t)/r} ${(this.#i[15]-e)/i} Z`}#_(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#x(t){const[e,r,i,s]=this.#t,a=this.#i.subarray(4,6),l=this.#i.subarray(16,18),[u,f,d,p]=this.#m();t.push(`L${(a[0]-e)/i} ${(a[1]-r)/s} L${u} ${f} L${d} ${p} L${(l[0]-e)/i} ${(l[1]-r)/s}`)}newFreeDrawOutline(t,e,r,i,s,a){return new YD(t,e,r,i,s,a)}getOutlines(){const t=this.#s,e=this.#e,r=this.#i,[i,s,a,l]=this.#t,u=new Float32Array((this.#d?.length??0)+2);for(let p=0,m=u.length-2;p<m;p+=2)u[p]=(this.#d[p]-i)/a,u[p+1]=(this.#d[p+1]-s)/l;if(u[u.length-2]=(this.#l-i)/a,u[u.length-1]=(this.#o-s)/l,isNaN(r[6])&&!this.isEmpty())return this.#b(u);const f=new Float32Array(this.#s.length+24+this.#e.length);let d=t.length;for(let p=0;p<d;p+=2){if(isNaN(t[p])){f[p]=f[p+1]=NaN;continue}f[p]=t[p],f[p+1]=t[p+1]}d=this.#S(f,d);for(let p=e.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(e[p+m])){f[d]=f[d+1]=NaN,d+=2;continue}f[d]=e[p+m],f[d+1]=e[p+m+1],d+=2}return this.#E(f,d),this.newFreeDrawOutline(f,u,this.#t,this.#h,this.#n,this.#r)}#b(t){const e=this.#i,[r,i,s,a]=this.#t,[l,u,f,d]=this.#m(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-r)/s,(e[3]-i)/a,NaN,NaN,NaN,NaN,(e[4]-r)/s,(e[5]-i)/a,NaN,NaN,NaN,NaN,l,u,NaN,NaN,NaN,NaN,f,d,NaN,NaN,NaN,NaN,(e[16]-r)/s,(e[17]-i)/a,NaN,NaN,NaN,NaN,(e[14]-r)/s,(e[15]-i)/a],0),this.newFreeDrawOutline(p,t,this.#t,this.#h,this.#n,this.#r)}#E(t,e){const r=this.#e;return t.set([NaN,NaN,NaN,NaN,r[4],r[5]],e),e+=6}#S(t,e){const r=this.#i.subarray(4,6),i=this.#i.subarray(16,18),[s,a,l,u]=this.#t,[f,d,p,m]=this.#m();return t.set([NaN,NaN,NaN,NaN,(r[0]-s)/l,(r[1]-a)/u,NaN,NaN,NaN,NaN,f,d,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(i[0]-s)/l,(i[1]-a)/u],e),e+=24}}class YD extends de{#t;#e=new Float32Array(4);#n;#r;#s;#i;#l;constructor(t,e,r,i,s,a){super(),this.#l=t,this.#s=e,this.#t=r,this.#i=i,this.#n=s,this.#r=a,this.lastPoint=[NaN,NaN],this.#o(a);const[l,u,f,d]=this.#e;for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/f,t[p+1]=(t[p+1]-u)/d;for(let p=0,m=e.length;p<m;p+=2)e[p]=(e[p]-l)/f,e[p+1]=(e[p+1]-u)/d}toSVGPath(){const t=[`M${this.#l[4]} ${this.#l[5]}`];for(let e=6,r=this.#l.length;e<r;e+=6){if(isNaN(this.#l[e])){t.push(`L${this.#l[e+4]} ${this.#l[e+5]}`);continue}t.push(`C${this.#l[e]} ${this.#l[e+1]} ${this.#l[e+2]} ${this.#l[e+3]} ${this.#l[e+4]} ${this.#l[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,r,i],s){const a=r-t,l=i-e;let u,f;switch(s){case 0:u=de._rescale(this.#l,t,i,a,-l),f=de._rescale(this.#s,t,i,a,-l);break;case 90:u=de._rescaleAndSwap(this.#l,t,e,a,l),f=de._rescaleAndSwap(this.#s,t,e,a,l);break;case 180:u=de._rescale(this.#l,r,e,-a,l),f=de._rescale(this.#s,r,e,-a,l);break;case 270:u=de._rescaleAndSwap(this.#l,r,i,-a,-l),f=de._rescaleAndSwap(this.#s,r,i,-a,-l);break}return{outline:Array.from(u),points:[Array.from(f)]}}#o(t){const e=this.#l;let r=e[4],i=e[5];const s=[r,i,r,i];let a=r,l=i;const u=t?Math.max:Math.min;for(let d=6,p=e.length;d<p;d+=6){const m=e[d+4],v=e[d+5];if(isNaN(e[d]))ye.pointBoundingBox(m,v,s),l<v?(a=m,l=v):l===v&&(a=u(a,m));else{const x=[1/0,1/0,-1/0,-1/0];ye.bezierBoundingBox(r,i,...e.slice(d,d+6),x),ye.rectBoundingBox(...x,s),l<x[3]?(a=x[2],l=x[3]):l===x[3]&&(a=u(a,x[2]))}r=m,i=v}const f=this.#e;f[0]=s[0]-this.#n,f[1]=s[1]-this.#n,f[2]=s[2]-s[0]+2*this.#n,f[3]=s[3]-s[1]+2*this.#n,this.lastPoint=[a,l]}get box(){return this.#e}newOutliner(t,e,r,i,s,a=0){return new bc(t,e,r,i,s,a)}getNewOutline(t,e){const[r,i,s,a]=this.#e,[l,u,f,d]=this.#t,p=s*f,m=a*d,v=r*f+l,x=i*d+u,_=this.newOutliner({x:this.#s[0]*p+v,y:this.#s[1]*m+x},this.#t,this.#i,t,this.#r,e??this.#n);for(let y=2;y<this.#s.length;y+=2)_.add({x:this.#s[y]*p+v,y:this.#s[y+1]*m+x});return _.getOutlines()}}class Lx{#t;#e;#n=[];#r=[];constructor(t,e=0,r=0,i=!0){const s=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:v,y:x,width:_,height:y}of t){const w=Math.floor((v-e)/a)*a,S=Math.ceil((v+_+e)/a)*a,T=Math.floor((x-e)/a)*a,C=Math.ceil((x+y+e)/a)*a,R=[w,T,C,!0],N=[S,T,C,!1];this.#n.push(R,N),ye.rectBoundingBox(w,T,S,C,s)}const l=s[2]-s[0]+2*r,u=s[3]-s[1]+2*r,f=s[0]-r,d=s[1]-r,p=this.#n.at(i?-1:-2),m=[p[0],p[2]];for(const v of this.#n){const[x,_,y]=v;v[0]=(x-f)/l,v[1]=(_-d)/u,v[2]=(y-d)/u}this.#t=new Float32Array([f,d,l,u]),this.#e=m}getOutlines(){this.#n.sort((e,r)=>e[0]-r[0]||e[1]-r[1]||e[2]-r[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#f(e)),this.#l(e)):(this.#o(e),t.push(...this.#f(e)));return this.#s(t)}#s(t){const e=[],r=new Set;for(const a of t){const[l,u,f]=a;e.push([l,u,a],[l,f,a])}e.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=e.length;a<l;a+=2){const u=e[a][2],f=e[a+1][2];u.push(f),f.push(u),r.add(u),r.add(f)}const i=[];let s;for(;r.size>0;){const a=r.values().next().value;let[l,u,f,d,p]=a;r.delete(a);let m=l,v=u;for(s=[l,f],i.push(s);;){let x;if(r.has(d))x=d;else if(r.has(p))x=p;else break;r.delete(x),[l,u,f,d,p]=x,m!==l&&(s.push(m,v,l,v===u?u:f),m=l),v=v===u?f:u}s.push(m,v)}return new x6(i,this.#t,this.#e)}#i(t){const e=this.#r;let r=0,i=e.length-1;for(;r<=i;){const s=r+i>>1,a=e[s][0];if(a===t)return s;a<t?r=s+1:i=s-1}return i+1}#l([,t,e]){const r=this.#i(t);this.#r.splice(r,0,[t,e])}#o([,t,e]){const r=this.#i(t);for(let i=r;i<this.#r.length;i++){const[s,a]=this.#r[i];if(s!==t)break;if(s===t&&a===e){this.#r.splice(i,1);return}}for(let i=r-1;i>=0;i--){const[s,a]=this.#r[i];if(s!==t)break;if(s===t&&a===e){this.#r.splice(i,1);return}}}#f(t){const[e,r,i]=t,s=[[e,r,i]],a=this.#i(i);for(let l=0;l<a;l++){const[u,f]=this.#r[l];for(let d=0,p=s.length;d<p;d++){const[,m,v]=s[d];if(!(f<=m||v<=u)){if(m>=u){if(v>f)s[d][1]=f;else{if(p===1)return[];s.splice(d,1),d--,p--}continue}s[d][2]=u,v>f&&s.push([e,f,v])}}}return s}}class x6 extends de{#t;#e;constructor(t,e,r){super(),this.#e=t,this.#t=e,this.lastPoint=r}toSVGPath(){const t=[];for(const e of this.#e){let[r,i]=e;t.push(`M${r} ${i}`);for(let s=2;s<e.length;s+=2){const a=e[s],l=e[s+1];a===r?(t.push(`V${l}`),i=l):l===i&&(t.push(`H${a}`),r=a)}t.push("Z")}return t.join(" ")}serialize([t,e,r,i],s){const a=[],l=r-t,u=i-e;for(const f of this.#e){const d=new Array(f.length);for(let p=0;p<f.length;p+=2)d[p]=t+f[p]*l,d[p+1]=i-f[p+1]*u;a.push(d)}return a}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Ix extends bc{newFreeDrawOutline(t,e,r,i,s,a){return new y6(t,e,r,i,s,a)}}class y6 extends YD{newOutliner(t,e,r,i,s,a=0){return new Ix(t,e,r,i,s,a)}}class is{#t=null;#e=null;#n;#r=null;#s=!1;#i=!1;#l=null;#o;#f=null;#c=null;#h;static#u=null;static get _keyboardManager(){return Xe(this,"_keyboardManager",new cp([[["Escape","mac+Escape"],is.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],is.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],is.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],is.prototype._moveToPrevious],[["Home","mac+Home"],is.prototype._moveToBeginning],[["End","mac+End"],is.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#i=!1,this.#h=Ke.HIGHLIGHT_COLOR,this.#l=t):(this.#i=!0,this.#h=Ke.HIGHLIGHT_DEFAULT_COLOR),this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",is.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#c._signal;t.addEventListener("click",this.#g.bind(this),{signal:e}),t.addEventListener("keydown",this.#p.bind(this),{signal:e});const r=this.#e=document.createElement("span");return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=this.#n,t.append(r),t}renderMainDropdown(){const t=this.#r=this.#d();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#d(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",Hs,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[r,i]of this.#c.highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=r,s.setAttribute("data-l10n-id",is.#u[r]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=i,s.setAttribute("aria-selected",i===this.#n),s.addEventListener("click",this.#a.bind(this,i),{signal:e}),t.append(s)}return t.addEventListener("keydown",this.#p.bind(this),{signal:e}),t}#a(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const e=t.target.getAttribute("data-color");e&&this.#a(e,t)}_moveToNext(t){if(!this.#v){this.#g(t);return}if(t.target===this.#t){this.#r.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#r?.firstChild||t.target===this.#t){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#v){this.#g(t);return}this.#r.firstChild?.focus()}_moveToEnd(t){if(!this.#v){this.#g(t);return}this.#r.lastChild?.focus()}#p(t){is._keyboardManager.exec(this,t)}#g(t){if(this.#v){this.hideDropdown();return}if(this.#s=t.detail===0,this.#f||(this.#f=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#c.combinedSignal(this.#f)})),this.#r){this.#r.classList.remove("hidden");return}const e=this.#r=this.#d();this.#t.append(e)}#m(t){this.#r?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#r?.classList.add("hidden"),this.#f?.abort(),this.#f=null}get#v(){return this.#r&&!this.#r.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#v){this.#l?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#r)return;const e=this.#c.highlightColors.values();for(const r of this.#r.children)r.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#r?.remove(),this.#r=null}}class tr extends Se{#t=null;#e=0;#n;#r=null;#s=null;#i=null;#l=null;#o=0;#f=null;#c=null;#h=null;#u=!1;#d=null;#a;#p=null;#g="";#m;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Be.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=tr.prototype;return Xe(this,"_keyboardManager",new cp([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||tr._defaultColor,this.#m=t.thickness||tr._defaultThickness,this.#a=t.opacity||tr._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#g=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#x(t),this.#O()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#l=t.focusNode,this.#o=t.focusOffset,this.#_(),this.#O(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#_(){const t=new Lx(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new Lx(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#i=e.getOutlines();const{lastPoint:r}=this.#i;this.#d=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#x({highlightOutlines:t,highlightId:e,clipPathId:r}){this.#c=t;const i=1.5;if(this.#i=t.getNewOutline(this.#m/2+i,.0025),e>=0)this.#h=e,this.#r=r,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const d=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:tr.#w(this.#c.box,(d-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:tr.#w(this.#i.box,d),path:{d:this.#i.toSVGPath()}})}const[s,a,l,u]=t.box;switch(this.rotation){case 0:this.x=s,this.y=a,this.width=l,this.height=u;break;case 90:{const[d,p]=this.parentDimensions;this.x=a,this.y=1-s,this.width=l*p/d,this.height=u*d/p;break}case 180:this.x=1-s,this.y=1-a,this.width=l,this.height=u;break;case 270:{const[d,p]=this.parentDimensions;this.x=1-a,this.y=s,this.width=l*p/d,this.height=u*d/p;break}}const{lastPoint:f}=this.#i;this.#d=[(f[0]-s)/l,(f[1]-a)/u]}static initialize(t,e){Se.initialize(t,e),tr._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Ke.HIGHLIGHT_DEFAULT_COLOR:tr._defaultColor=e;break;case Ke.HIGHLIGHT_THICKNESS:tr._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#d}updateParams(t,e){switch(t){case Ke.HIGHLIGHT_COLOR:this.#b(e);break;case Ke.HIGHLIGHT_THICKNESS:this.#E(e);break}}static get defaultPropertiesToUpdate(){return[[Ke.HIGHLIGHT_DEFAULT_COLOR,tr._defaultColor],[Ke.HIGHLIGHT_THICKNESS,tr._defaultThickness]]}get propertiesToUpdate(){return[[Ke.HIGHLIGHT_COLOR,this.color||tr._defaultColor],[Ke.HIGHLIGHT_THICKNESS,this.#m||tr._defaultThickness],[Ke.HIGHLIGHT_FREE,this.#u]]}#b(t){const e=(s,a)=>{this.color=s,this.#a=a,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:s,"fill-opacity":a}}),this.#s?.updateColor(s)},r=this.color,i=this.#a;this.addCommands({cmd:e.bind(this,t,tr._defaultOpacity),undo:e.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#E(t){const e=this.#m,r=i=>{this.#m=i,this.#S(i)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ke.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#s=new is({editor:this}),t.addColorPicker(this.#s)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#N())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#O(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#O(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#S(t){if(!this.#u)return;this.#x({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,r]=this.parentDimensions;this.setDims(this.width*e,this.height*r)}#C(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#O(t=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#r}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#u),this.#f&&(this.#f.style.clipPath=this.#r))}static#w([t,e,r,i],s){switch(s){case 90:return[1-e-i,t,i,r];case 180:return[1-t-r,1-e-i,r,i];case 270:return[e,1-t-r,i,r]}return[t,e,r,i]}rotate(t){const{drawLayer:e}=this.parent;let r;this.#u?(t=(t-this.rotation+360)%360,r=tr.#w(this.#c.box,t)):r=tr.#w([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#h,{bbox:r,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:tr.#w(this.#i.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#g&&(t.setAttribute("aria-label",this.#g),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#f=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#r;const[r,i]=this.parentDimensions;return this.setDims(this.width*r,this.height*i),bD(this,this.#f,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#D(t){tr._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#T(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#N(){return this.#u?this.rotation:0}#k(){if(this.#u)return null;const[t,e]=this.pageDimensions,[r,i]=this.pageTranslation,s=this.#n,a=new Float32Array(s.length*8);let l=0;for(const{x:u,y:f,width:d,height:p}of s){const m=u*t+r,v=(1-f)*e+i;a[l]=a[l+4]=m,a[l+1]=a[l+3]=v,a[l+2]=a[l+6]=m+d*t,a[l+5]=a[l+7]=v-p*e,l+=8}return a}#L(t){return this.#c.serialize(t,this.#N())}static startHighlighting(t,e,{target:r,x:i,y:s}){const{x:a,y:l,width:u,height:f}=r.getBoundingClientRect(),d=new AbortController,p=t.combinedSignal(d),m=v=>{d.abort(),this.#A(t,v)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",er,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Hs,{signal:p}),r.addEventListener("pointermove",this.#z.bind(this,t),{signal:p}),this._freeHighlight=new Ix({x:i,y:s},[a,l,u,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#z(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#A(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,r){let i=null;if(t instanceof VD){const{data:{quadPoints:x,rect:_,rotation:y,id:w,color:S,opacity:T,popupRef:C},parent:{page:{pageNumber:R}}}=t;i=t={annotationType:Be.HIGHLIGHT,color:Array.from(S),opacity:T,quadPoints:x,boxes:null,pageIndex:R-1,rect:_.slice(0),rotation:y,id:w,deleted:!1,popupRef:C}}else if(t instanceof Hy){const{data:{inkLists:x,rect:_,rotation:y,id:w,color:S,borderStyle:{rawWidth:T},popupRef:C},parent:{page:{pageNumber:R}}}=t;i=t={annotationType:Be.HIGHLIGHT,color:Array.from(S),thickness:T,inkLists:x,boxes:null,pageIndex:R-1,rect:_.slice(0),rotation:y,id:w,deleted:!1,popupRef:C}}const{color:s,quadPoints:a,inkLists:l,opacity:u}=t,f=await super.deserialize(t,e,r);f.color=ye.makeHexColor(...s),f.#a=u||1,l&&(f.#m=t.thickness),f.annotationElementId=t.id||null,f._initialData=i;const[d,p]=f.pageDimensions,[m,v]=f.pageTranslation;if(a){const x=f.#n=[];for(let _=0;_<a.length;_+=8)x.push({x:(a[_]-m)/d,y:1-(a[_+1]-v)/p,width:(a[_+2]-a[_])/d,height:(a[_+1]-a[_+5])/p});f.#_(),f.#O(),f.rotate(f.rotation)}else if(l){f.#u=!0;const x=l[0],_={x:x[0]-m,y:p-(x[1]-v)},y=new Ix(_,[0,0,d,p],1,f.#m/2,!0,.001);for(let T=0,C=x.length;T<C;T+=2)_.x=x[T]-m,_.y=p-(x[T+1]-v),y.add(_);const{id:w,clipPathId:S}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:y.toSVGPath()}},!0,!0);f.#x({highlightOutlines:y.getOutlines(),highlightId:w,clipPathId:S}),f.#O(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),r=Se._colorManager.convert(this.color),i={annotationType:Be.HIGHLIGHT,color:r,opacity:this.#a,thickness:this.#m,quadPoints:this.#k(),outlines:this.#L(e),pageIndex:this.pageIndex,rect:e,rotation:this.#N(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#y(i)?null:(i.id=this.annotationElementId,i)}#y(t){const{color:e}=this._initialData;return t.color.some((r,i)=>r!==e[i])}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class XD{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,r]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,r)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Tn("Not implemented")}}class Oe extends Se{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#r=null;static#s=null;static#i=NaN;static#l=null;static#o=null;static#f=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#d())}#c({drawOutlines:t,drawId:e,drawingOptions:r}){this.#t=t,this._drawingOptions||=r,e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#h(t,this.parent),this.#g(t.box)}#h(t,e){const{id:r}=e.drawLayer.draw(Oe._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r}static _mergeSVGProperties(t,e){const r=new Set(Object.keys(t));for(const[i,s]of Object.entries(e))r.has(i)?Object.assign(t[i],s):t[i]=s;return t}static getDefaultDrawingOptions(t){Tn("Not implemented")}static get typesMap(){Tn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,e),this._currentParent&&(Oe.#n.updateProperty(r,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[r,i]of this.typesMap)t.push([r,e[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[r,i]of this.constructor.typesMap)t.push([r,e[i]]);return t}_updateProperty(t,e,r){const i=this._drawingOptions,s=i[e],a=l=>{i.updateProperty(e,l);const u=this.#t.updateProperty(e,l);u&&this.#g(u),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:a.bind(this,r),undo:a.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#d(),this.#g(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#d(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#d(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#t,t)}}#a([t,e,r,i]){const{parentDimensions:[s,a],rotation:l}=this;switch(l){case 90:return[e,1-t,r*(a/s),i*(s/a)];case 180:return[1-t,1-e,r,i];case 270:return[1-e,t,r*(a/s),i*(s/a)];default:return[t,e,r,i]}}#p(){const{x:t,y:e,width:r,height:i,parentDimensions:[s,a],rotation:l}=this;switch(l){case 90:return[1-e,t,r*(s/a),i*(a/s)];case 180:return[1-t,1-e,r,i];case 270:return[e,1-t,r*(s/a),i*(a/s)];default:return[t,e,r,i]}}#g(t){if([this.x,this.y,this.width,this.height]=this.#a(t),this.div){this.fixAndSetPosition();const[e,r]=this.parentDimensions;this.setDims(this.width*e,this.height*r)}this._onResized()}#m(){const{x:t,y:e,width:r,height:i,rotation:s,parentRotation:a,parentDimensions:[l,u]}=this;switch((s*4+a)/90){case 1:return[1-e-i,t,i,r];case 2:return[1-t-r,1-e-i,r,i];case 3:return[e,1-t-r,i,r];case 4:return[t,e-r*(l/u),i*(u/l),r*(l/u)];case 5:return[1-e,t,r*(l/u),i*(u/l)];case 6:return[1-t-i*(u/l),1-e,i*(u/l),r*(l/u)];case 7:return[e-r*(l/u),1-t-i*(u/l),r*(l/u),i*(u/l)];case 8:return[t-r,e-i,r,i];case 9:return[1-e,t-r,i,r];case 10:return[1-t,1-e,r,i];case 11:return[e-i,1-t,i,r];case 12:return[t-i*(u/l),e,i*(u/l),r*(l/u)];case 13:return[1-e-r*(l/u),t-i*(u/l),r*(l/u),i*(u/l)];case 14:return[1-t,1-e-r*(l/u),i*(u/l),r*(l/u)];case 15:return[e,1-t,r*(l/u),i*(u/l)];default:return[t,e,r,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Oe._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#g(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const r=super.render();r.classList.add("draw");const i=document.createElement("div");r.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,a]=this.parentDimensions;return this.setDims(this.width*s,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),r}static createDrawerInstance(t,e,r,i,s){Tn("Not implemented")}static startDrawing(t,e,r,i){const{target:s,offsetX:a,offsetY:l,pointerId:u,pointerType:f}=i;if(Oe.#l&&Oe.#l!==f)return;const{viewport:{rotation:d}}=t,{width:p,height:m}=s.getBoundingClientRect(),v=Oe.#r=new AbortController,x=t.combinedSignal(v);if(Oe.#i||=u,Oe.#l??=f,window.addEventListener("pointerup",_=>{Oe.#i===_.pointerId?this._endDraw(_):Oe.#o?.delete(_.pointerId)},{signal:x}),window.addEventListener("pointercancel",_=>{Oe.#i===_.pointerId?this._currentParent.endDrawingSession():Oe.#o?.delete(_.pointerId)},{signal:x}),window.addEventListener("pointerdown",_=>{Oe.#l===_.pointerType&&((Oe.#o||=new Set).add(_.pointerId),Oe.#n.isCancellable()&&(Oe.#n.removeLastElement(),Oe.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",Hs,{signal:x}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),s.addEventListener("touchmove",_=>{_.timeStamp===Oe.#f&&er(_)},{signal:x}),t.toggleDrawing(),e._editorUndoBar?.hide(),Oe.#n){t.drawLayer.updateProperties(this._currentDrawId,Oe.#n.startNew(a,l,p,m,d));return}e.updateUIForDefaultProperties(this),Oe.#n=this.createDrawerInstance(a,l,p,m,d),Oe.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Oe.#s.toSVGProperties(),Oe.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Oe.#f=-1,!Oe.#n)return;const{offsetX:e,offsetY:r,pointerId:i}=t;if(Oe.#i===i){if(Oe.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Oe.#n.add(e,r)),Oe.#f=t.timeStamp,er(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Oe.#n=null,Oe.#s=null,Oe.#l=null,Oe.#f=NaN),Oe.#r&&(Oe.#r.abort(),Oe.#r=null,Oe.#i=NaN,Oe.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Oe.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=Oe.#n,i=this._currentDrawId,s=r.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(i,r.setLastElement(s))},undo:()=>{e.drawLayer.updateProperties(i,r.removeLastElement())},mustExec:!1,type:Ke.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Ke.DRAW_STEP),!Oe.#n.isEmpty()){const{pageDimensions:[r,i],scale:s}=e,a=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Oe.#n.getOutlines(r*s,i*s,s,this._INNER_MARGIN),drawingOptions:Oe.#s,mustBeCommitted:!t});return this._cleanup(!0),a}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,r,i,s,a){Tn("Not implemented")}static async deserialize(t,e,r){const{rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:l}}=e.viewport,u=this.deserializeDraw(a,l,i,s,this._INNER_MARGIN,t),f=await super.deserialize(t,e,r);return f.createDrawingOptions(t),f.#c({drawOutlines:u}),f.#d(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,r]=this.pageTranslation,[i,s]=this.pageDimensions;return this.#t.serialize([e,r,i,s],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class b6{#t=new Float64Array(6);#e;#n;#r;#s;#i;#l="";#o=0;#f=new dp;#c;#h;constructor(t,e,r,i,s,a){this.#c=r,this.#h=i,this.#r=s,this.#s=a,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#i=[t,e],this.#n=[{line:l,points:this.#i}],this.#t.set(l,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#u(t,e){return de._normalizePoint(t,e,this.#c,this.#h,this.#r)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#i.length<=10}add(t,e){[t,e]=this.#u(t,e);const[r,i,s,a]=this.#t.subarray(2,6),l=t-s,u=e-a;return Math.hypot(this.#c*l,this.#h*u)<=2?null:(this.#i.push(t,e),isNaN(r)?(this.#t.set([s,a,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([r,i,s,a,t,e],0),this.#e.push(...de.createBezierPoints(r,i,s,a,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const r=this.add(t,e);return r||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,r,i,s){this.#c=r,this.#h=i,this.#r=s,[t,e]=this.#u(t,e);const a=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#i=[t,e];const l=this.#n.at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),this.#n.push({line:a,points:this.#i}),this.#t.set(a,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#i=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#f.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#f.removeLastElement();this.#n.pop(),this.#l="";for(let t=0,e=this.#n.length;t<e;t++){const{line:r,points:i}=this.#n[t];this.#e=r,this.#i=i,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const t=de.svgRound(this.#e[4]),e=de.svgRound(this.#e[5]);if(this.#i.length===2)return this.#l=`${this.#l} M ${t} ${e} Z`,this.#l;if(this.#i.length<=6){const i=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,i)} M ${t} ${e}`,this.#o=6}if(this.#i.length===4){const i=de.svgRound(this.#e[10]),s=de.svgRound(this.#e[11]);return this.#l=`${this.#l} L ${i} ${s}`,this.#o=12,this.#l}const r=[];this.#o===0&&(r.push(`M ${t} ${e}`),this.#o=6);for(let i=this.#o,s=this.#e.length;i<s;i+=6){const[a,l,u,f,d,p]=this.#e.slice(i,i+6).map(de.svgRound);r.push(`C${a} ${l} ${u} ${f} ${d} ${p}`)}return this.#l+=r.join(" "),this.#o=this.#e.length,this.#l}getOutlines(t,e,r,i){const s=this.#n.at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),this.#f.build(this.#n,t,e,r,this.#r,this.#s,i),this.#t=null,this.#e=null,this.#n=null,this.#l=null,this.#f}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class dp extends de{#t;#e=0;#n;#r;#s;#i;#l;#o;#f;build(t,e,r,i,s,a,l){this.#s=e,this.#i=r,this.#l=i,this.#o=s,this.#f=a,this.#n=l??0,this.#r=t,this.#u()}get thickness(){return this.#f}setLastElement(t){return this.#r.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#r.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#r){if(t.push(`M${de.svgRound(e[4])} ${de.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${de.svgRound(e[10])} ${de.svgRound(e[11])}`);continue}for(let r=6,i=e.length;r<i;r+=6){const[s,a,l,u,f,d]=e.subarray(r,r+6).map(de.svgRound);t.push(`C${s} ${a} ${l} ${u} ${f} ${d}`)}}return t.join("")}serialize([t,e,r,i],s){const a=[],l=[],[u,f,d,p]=this.#h();let m,v,x,_,y,w,S,T,C;switch(this.#o){case 0:C=de._rescale,m=t,v=e+i,x=r,_=-i,y=t+u*r,w=e+(1-f-p)*i,S=t+(u+d)*r,T=e+(1-f)*i;break;case 90:C=de._rescaleAndSwap,m=t,v=e,x=r,_=i,y=t+f*r,w=e+u*i,S=t+(f+p)*r,T=e+(u+d)*i;break;case 180:C=de._rescale,m=t+r,v=e,x=-r,_=i,y=t+(1-u-d)*r,w=e+f*i,S=t+(1-u)*r,T=e+(f+p)*i;break;case 270:C=de._rescaleAndSwap,m=t+r,v=e+i,x=-r,_=-i,y=t+(1-f-p)*r,w=e+(1-u-d)*i,S=t+(1-f)*r,T=e+(1-u)*i;break}for(const{line:R,points:N}of this.#r)a.push(C(R,m,v,x,_,s?new Array(R.length):null)),l.push(C(N,m,v,x,_,s?new Array(N.length):null));return{lines:a,points:l,rect:[y,w,S,T]}}static deserialize(t,e,r,i,s,{paths:{lines:a,points:l},rotation:u,thickness:f}){const d=[];let p,m,v,x,_;switch(u){case 0:_=de._rescale,p=-t/r,m=e/i+1,v=1/r,x=-1/i;break;case 90:_=de._rescaleAndSwap,p=-e/i,m=-t/r,v=1/i,x=1/r;break;case 180:_=de._rescale,p=t/r+1,m=-e/i,v=-1/r,x=1/i;break;case 270:_=de._rescaleAndSwap,p=e/i+1,m=t/r+1,v=-1/i,x=-1/r;break}if(!a){a=[];for(const w of l){const S=w.length;if(S===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(S===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const T=new Float32Array(3*(S-2));a.push(T);let[C,R,N,D]=w.subarray(0,4);T.set([NaN,NaN,NaN,NaN,C,R],0);for(let I=4;I<S;I+=2){const M=w[I],B=w[I+1];T.set(de.createBezierPoints(C,R,N,D,M,B),(I-2)*3),[C,R,N,D]=[N,D,M,B]}}}for(let w=0,S=a.length;w<S;w++)d.push({line:_(a[w].map(T=>T??NaN),p,m,v,x),points:_(l[w].map(T=>T??NaN),p,m,v,x)});const y=new this.prototype.constructor;return y.build(d,r,i,1,u,f,s),y}#c(t=this.#f){const e=this.#n+t/2*this.#l;return this.#o%180===0?[e/this.#s,e/this.#i]:[e/this.#i,e/this.#s]}#h(){const[t,e,r,i]=this.#t,[s,a]=this.#c(0);return[t+s,e+a,r-2*s,i-2*a]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#r){if(i.length<=12){for(let l=4,u=i.length;l<u;l+=6)ye.pointBoundingBox(i[l],i[l+1],t);continue}let s=i[4],a=i[5];for(let l=6,u=i.length;l<u;l+=6){const[f,d,p,m,v,x]=i.subarray(l,l+6);ye.bezierBoundingBox(s,a,f,d,p,m,v,x,t),s=v,a=x}}const[e,r]=this.#c();t[0]=ti(t[0]-e,0,1),t[1]=ti(t[1]-r,0,1),t[2]=ti(t[2]+e,0,1),t[3]=ti(t[3]+r,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#d(e):null}#d(t){const[e,r]=this.#c();this.#f=t;const[i,s]=this.#c(),[a,l]=[i-e,s-r],u=this.#t;return u[0]-=a,u[1]-=l,u[2]+=2*a,u[3]+=2*l,u}updateParentDimensions([t,e],r){const[i,s]=this.#c();this.#s=t,this.#i=e,this.#l=r;const[a,l]=this.#c(),u=a-i,f=l-s,d=this.#t;return d[0]-=u,d[1]-=f,d[2]+=2*u,d[3]+=2*f,d}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(de.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let r=0,i=0,s=0,a=0,l=0,u=0;switch(this.#e){case 90:i=e/t,s=-t/e,l=t;break;case 180:r=-1,a=-1,l=t,u=e;break;case 270:i=-e/t,s=t/e,u=e;break;default:return""}return`matrix(${r} ${i} ${s} ${a} ${de.svgRound(l)} ${de.svgRound(u)})`}getPathResizingSVGProperties([t,e,r,i]){const[s,a]=this.#c(),[l,u,f,d]=this.#t;if(Math.abs(f-s)<=de.PRECISION||Math.abs(d-a)<=de.PRECISION){const _=t+r/2-(l+f/2),y=e+i/2-(u+d/2);return{path:{"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`,transform:`${this.rotationTransform} translate(${_} ${y})`}}}const p=(r-2*s)/(f-2*s),m=(i-2*a)/(d-2*a),v=f/r,x=d/i;return{path:{"transform-origin":`${de.svgRound(l)} ${de.svgRound(u)}`,transform:`${this.rotationTransform} scale(${v} ${x}) translate(${de.svgRound(s)} ${de.svgRound(a)}) scale(${p} ${m}) translate(${de.svgRound(-s)} ${de.svgRound(-a)})`}}}getPathResizedSVGProperties([t,e,r,i]){const[s,a]=this.#c(),l=this.#t,[u,f,d,p]=l;if(l[0]=t,l[1]=e,l[2]=r,l[3]=i,Math.abs(d-s)<=de.PRECISION||Math.abs(p-a)<=de.PRECISION){const y=t+r/2-(u+d/2),w=e+i/2-(f+p/2);for(const{line:S,points:T}of this.#r)de._translate(S,y,w,S),de._translate(T,y,w,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(r-2*s)/(d-2*s),v=(i-2*a)/(p-2*a),x=-m*(u+s)+t+s,_=-v*(f+a)+e+a;if(m!==1||v!==1||x!==0||_!==0)for(const{line:y,points:w}of this.#r)de._rescale(y,x,_,m,v,y),de._rescale(w,x,_,m,v,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],r){const[i,s]=r,a=this.#t,l=t-a[0],u=e-a[1];if(this.#s===i&&this.#i===s)for(const{line:f,points:d}of this.#r)de._translate(f,l,u,f),de._translate(d,l,u,d);else{const f=this.#s/i,d=this.#i/s;this.#s=i,this.#i=s;for(const{line:p,points:m}of this.#r)de._rescale(p,l,u,f,d,p),de._rescale(m,l,u,f,d,m);a[2]*=f,a[3]*=d}return a[0]=t,a[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${de.svgRound(t)} ${de.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${de.svgRound(t[0])} ${de.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class qg extends XD{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Se._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new qg(this._viewParameters);return t.updateAll(this),t}}class Gy extends Oe{static _type="ink";static _editorType=Be.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Se.initialize(t,e),this._defaultDrawingOptions=new qg(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Xe(this,"typesMap",new Map([[Ke.INK_THICKNESS,"stroke-width"],[Ke.INK_COLOR,"stroke"],[Ke.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,r,i,s){return new b6(t,e,r,i,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,r,i,s,a){return dp.deserialize(t,e,r,i,s,a)}static async deserialize(t,e,r){let i=null;if(t instanceof Hy){const{data:{inkLists:a,rect:l,rotation:u,id:f,color:d,opacity:p,borderStyle:{rawWidth:m},popupRef:v},parent:{page:{pageNumber:x}}}=t;i=t={annotationType:Be.INK,color:Array.from(d),thickness:m,opacity:p,paths:{points:a},boxes:null,pageIndex:x-1,rect:l.slice(0),rotation:u,id:f,deleted:!1,popupRef:v}}const s=await super.deserialize(t,e,r);return s.annotationElementId=t.id||null,s._initialData=i,s}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:r}=this;e.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:r}){this._drawingOptions=Gy.getDefaultDrawingOptions({stroke:ye.makeHexColor(...t),"stroke-width":e,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:r,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":l}}=this,u={annotationType:Be.INK,color:Se._colorManager.convert(s),opacity:a,thickness:l,paths:{lines:e,points:r},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:r,opacity:i,pageIndex:s}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==e[l])||t.thickness!==r||t.opacity!==i||t.pageIndex!==s}renderAnnotationElement(t){const{points:e,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:e}),null}}class Mx extends dp{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const hm=8,ad=3;class gc{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,r,i){return r-=t,i-=e,r===0?i>0?0:4:r===1?i+6:2-i}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#r(t,e,r,i,s,a,l){const u=this.#e(r,i,s,a);for(let f=0;f<8;f++){const d=(-f+u-l+16)%8,p=this.#n[2*d],m=this.#n[2*d+1];if(t[(r+p)*e+(i+m)]!==0)return d}return-1}static#s(t,e,r,i,s,a,l){const u=this.#e(r,i,s,a);for(let f=0;f<8;f++){const d=(f+u+l+16)%8,p=this.#n[2*d],m=this.#n[2*d+1];if(t[(r+p)*e+(i+m)]!==0)return d}return-1}static#i(t,e,r,i){const s=t.length,a=new Int32Array(s);for(let d=0;d<s;d++)a[d]=t[d]<=i?1:0;for(let d=1;d<r-1;d++)a[d*e]=a[d*e+e-1]=0;for(let d=0;d<e;d++)a[d]=a[e*r-1-d]=0;let l=1,u;const f=[];for(let d=1;d<r-1;d++){u=1;for(let p=1;p<e-1;p++){const m=d*e+p,v=a[m];if(v===0)continue;let x=d,_=p;if(v===1&&a[m-1]===0)l+=1,_-=1;else if(v>=1&&a[m+1]===0)l+=1,_+=1,v>1&&(u=v);else{v!==1&&(u=Math.abs(v));continue}const y=[p,d],w=_===p+1,S={isHole:w,points:y,id:l,parent:0};f.push(S);let T;for(const H of f)if(H.id===u){T=H;break}T?T.isHole?S.parent=w?T.parent:u:S.parent=w?u:T.parent:S.parent=w?u:0;const C=this.#r(a,e,d,p,x,_,0);if(C===-1){a[m]=-l,a[m]!==1&&(u=Math.abs(a[m]));continue}let R=this.#n[2*C],N=this.#n[2*C+1];const D=d+R,I=p+N;x=D,_=I;let M=d,B=p;for(;;){const H=this.#s(a,e,M,B,x,_,1);R=this.#n[2*H],N=this.#n[2*H+1];const F=M+R,rt=B+N;y.push(rt,F);const L=M*e+B;if(a[L+1]===0?a[L]=-l:a[L]===1&&(a[L]=l),F===d&&rt===p&&M===D&&B===I){a[m]!==1&&(u=Math.abs(a[m]));break}else x=M,_=B,M=F,B=rt}}}return f}static#l(t,e,r,i){if(r-e<=4){for(let D=e;D<r-2;D+=2)i.push(t[D],t[D+1]);return}const s=t[e],a=t[e+1],l=t[r-4]-s,u=t[r-3]-a,f=Math.hypot(l,u),d=l/f,p=u/f,m=d*a-p*s,v=u/l,x=1/f,_=Math.atan(v),y=Math.cos(_),w=Math.sin(_),S=x*(Math.abs(y)+Math.abs(w)),T=x*(1-S+S**2),C=Math.max(Math.atan(Math.abs(w+y)*T),Math.atan(Math.abs(w-y)*T));let R=0,N=e;for(let D=e+2;D<r-2;D+=2){const I=Math.abs(m-d*t[D+1]+p*t[D]);I>R&&(N=D,R=I)}R>(f*C)**2?(this.#l(t,e,N+2,i),this.#l(t,N,r,i)):i.push(s,a)}static#o(t){const e=[],r=t.length;return this.#l(t,0,r,e),e.push(t[r-2],t[r-1]),e.length<=4?null:e}static#f(t,e,r,i,s,a){const l=new Float32Array(a**2),u=-2*i**2,f=a>>1;for(let _=0;_<a;_++){const y=(_-f)**2;for(let w=0;w<a;w++)l[_*a+w]=Math.exp((y+(w-f)**2)/u)}const d=new Float32Array(256),p=-2*s**2;for(let _=0;_<256;_++)d[_]=Math.exp(_**2/p);const m=t.length,v=new Uint8Array(m),x=new Uint32Array(256);for(let _=0;_<r;_++)for(let y=0;y<e;y++){const w=_*e+y,S=t[w];let T=0,C=0;for(let N=0;N<a;N++){const D=_+N-f;if(!(D<0||D>=r))for(let I=0;I<a;I++){const M=y+I-f;if(M<0||M>=e)continue;const B=t[D*e+M],H=l[N*a+I]*d[Math.abs(B-S)];T+=B*H,C+=H}}const R=v[w]=Math.round(T/C);x[R]++}return[v,x]}static#c(t){const e=new Uint32Array(256);for(const r of t)e[r]++;return e}static#h(t){const e=t.length,r=new Uint8ClampedArray(e>>2);let i=-1/0,s=1/0;for(let l=0,u=r.length;l<u;l++){if(t[(l<<2)+3]===0){i=r[l]=255;continue}const d=r[l]=t[l<<2];d>i&&(i=d),d<s&&(s=d)}const a=255/(i-s);for(let l=0;l<e;l++)r[l]=(r[l]-s)*a;return r}static#u(t){let e,r=-1/0,i=-1/0;const s=t.findIndex(u=>u!==0);let a=s,l=s;for(e=s;e<256;e++){const u=t[e];u>r&&(e-a>i&&(i=e-a,l=e-1),r=u,a=e)}for(e=l-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#d(t){const e=t,{width:r,height:i}=t,{maxDim:s}=this.#t;let a=r,l=i;if(r>s||i>s){let m=r,v=i,x=Math.log2(Math.max(r,i)/s);const _=Math.floor(x);x=x===_?_-1:_;for(let w=0;w<x;w++){a=Math.ceil(m/2),l=Math.ceil(v/2);const S=new OffscreenCanvas(a,l);S.getContext("2d").drawImage(t,0,0,m,v,0,0,a,l),m=a,v=l,t!==e&&t.close(),t=S.transferToImageBitmap()}const y=Math.min(s/a,s/l);a=Math.round(a*y),l=Math.round(l*y)}const f=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,a,l);const d=f.getImageData(0,0,a,l).data;return[this.#h(d),a,l]}static extractContoursFromText(t,{fontFamily:e,fontStyle:r,fontWeight:i},s,a,l,u){let f=new OffscreenCanvas(1,1),d=f.getContext("2d",{alpha:!1});const p=200,m=d.font=`${r} ${i} ${p}px ${e}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:x,actualBoundingBoxAscent:_,actualBoundingBoxDescent:y,fontBoundingBoxAscent:w,fontBoundingBoxDescent:S,width:T}=d.measureText(t),C=1.5,R=Math.ceil(Math.max(Math.abs(v)+Math.abs(x)||0,T)*C),N=Math.ceil(Math.max(Math.abs(_)+Math.abs(y)||p,Math.abs(w)+Math.abs(S)||p)*C);f=new OffscreenCanvas(R,N),d=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=m,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,R,N),d.fillStyle="black",d.fillText(t,R*(C-1)/2,N*(3-C)/2);const D=this.#h(d.getImageData(0,0,R,N).data),I=this.#c(D),M=this.#u(I),B=this.#i(D,R,N,M);return this.processDrawnLines({lines:{curves:B,width:R,height:N},pageWidth:s,pageHeight:a,rotation:l,innerMargin:u,mustSmooth:!0,areContours:!0})}static process(t,e,r,i,s){const[a,l,u]=this.#d(t),[f,d]=this.#f(a,l,u,Math.hypot(l,u)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#u(d),m=this.#i(f,l,u,p);return this.processDrawnLines({lines:{curves:m,width:l,height:u},pageWidth:e,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:r,rotation:i,innerMargin:s,mustSmooth:a,areContours:l}){i%180!==0&&([e,r]=[r,e]);const{curves:u,width:f,height:d}=t,p=t.thickness??0,m=[],v=Math.min(e/f,r/d),x=v/e,_=v/r,y=[];for(const{points:S}of u){const T=a?this.#o(S):S;if(!T)continue;y.push(T);const C=T.length,R=new Float32Array(C),N=new Float32Array(3*(C===2?2:C-2));if(m.push({line:N,points:R}),C===2){R[0]=T[0]*x,R[1]=T[1]*_,N.set([NaN,NaN,NaN,NaN,R[0],R[1]],0);continue}let[D,I,M,B]=T;D*=x,I*=_,M*=x,B*=_,R.set([D,I,M,B],0),N.set([NaN,NaN,NaN,NaN,D,I],0);for(let H=4;H<C;H+=2){const F=R[H]=T[H]*x,rt=R[H+1]=T[H+1]*_;N.set(de.createBezierPoints(D,I,M,B,F,rt),(H-2)*3),[D,I,M,B]=[M,B,F,rt]}}if(m.length===0)return null;const w=l?new Mx:new dp;return w.build(m,e,r,1,i,l?0:p,s),{outline:w,newCurves:y,areContours:l,thickness:p,width:f,height:d}}static async compressSignature({outlines:t,areContours:e,thickness:r,width:i,height:s}){let a=1/0,l=-1/0,u=0;for(const T of t){u+=T.length;for(let C=2,R=T.length;C<R;C++){const N=T[C]-T[C-2];a=Math.min(a,N),l=Math.max(l,N)}}let f;a>=-128&&l<=127?f=Int8Array:a>=-32768&&l<=32767?f=Int16Array:f=Int32Array;const d=t.length,p=hm+ad*d,m=new Uint32Array(p);let v=0;m[v++]=p*Uint32Array.BYTES_PER_ELEMENT+(u-2*d)*f.BYTES_PER_ELEMENT,m[v++]=0,m[v++]=i,m[v++]=s,m[v++]=e?0:1,m[v++]=Math.max(0,Math.floor(r??0)),m[v++]=d,m[v++]=f.BYTES_PER_ELEMENT;for(const T of t)m[v++]=T.length-2,m[v++]=T[0],m[v++]=T[1];const x=new CompressionStream("deflate-raw"),_=x.writable.getWriter();await _.ready,_.write(m);const y=f.prototype.constructor;for(const T of t){const C=new y(T.length-2);for(let R=2,N=T.length;R<N;R++)C[R-2]=T[R]-T[R-2];_.write(C)}_.close();const w=await new Response(x.readable).arrayBuffer(),S=new Uint8Array(w);return vD(S)}static async decompressSignature(t){try{const e=ZP(t),{readable:r,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(e).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let a=null,l=0;for await(const T of r)a||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),a.set(T,l),l+=T.length;const u=new Uint32Array(a.buffer,0,a.length>>2),f=u[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const d=u[2],p=u[3],m=u[4]===0,v=u[5],x=u[6],_=u[7],y=[],w=(hm+ad*x)*Uint32Array.BYTES_PER_ELEMENT;let S;switch(_){case Int8Array.BYTES_PER_ELEMENT:S=new Int8Array(a.buffer,w);break;case Int16Array.BYTES_PER_ELEMENT:S=new Int16Array(a.buffer,w);break;case Int32Array.BYTES_PER_ELEMENT:S=new Int32Array(a.buffer,w);break}l=0;for(let T=0;T<x;T++){const C=u[ad*T+hm],R=new Float32Array(C+2);y.push(R);for(let N=0;N<ad-1;N++)R[N]=u[ad*T+hm+N+1];for(let N=0;N<C;N++)R[N+2]=R[N]+S[l++]}return{areContours:m,thickness:v,outlines:y,width:d,height:p}}catch(e){return ze(`decompressSignature: ${e}`),null}}}class Vy extends XD{constructor(){super(),super.updateProperties({fill:Se._defaultLineColor,"stroke-width":0})}clone(){const t=new Vy;return t.updateAll(this),t}}class Wy extends qg{constructor(t){super(t),super.updateProperties({stroke:Se._defaultLineColor,"stroke-width":1})}clone(){const t=new Wy(this._viewParameters);return t.updateAll(this),t}}class Fa extends Oe{#t=!1;#e=null;#n=null;#r=null;static _type="signature";static _editorType=Be.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Se.initialize(t,e),this._defaultDrawingOptions=new Vy,this._defaultDrawnSignatureOptions=new Wy(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Xe(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:i,mustSmooth:s,areContours:a,description:l,uuid:u,heightInPage:f}=this.#n,{rawDims:{pageWidth:d,pageHeight:p},rotation:m}=this.parent.viewport,v=gc.processDrawnLines({lines:i,pageWidth:d,pageHeight:p,rotation:m,innerMargin:Fa._INNER_MARGIN,mustSmooth:s,areContours:a});this.addSignature(v,f,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return r&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#r=t,this.addEditToolbar()}getUuid(){return this.#r}get description(){return this.#e}set description(t){this.#e=t,super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:r,width:i,height:s}=this.#n,a=Math.max(i,s),l=gc.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:r,width:i,height:s},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:l.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&this.#e!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,this.#r,this.#e),t.show()),t):null}addSignature(t,e,r,i){const{x:s,y:a}=this,{outline:l}=this.#n=t;this.#t=l instanceof Mx,this.#e=r,this.div.setAttribute("data-l10n-args",JSON.stringify({description:r}));let u;this.#t?u=Fa.getDefaultDrawingOptions():(u=Fa._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[f,d]=this.parentDimensions,[,p]=this.pageDimensions;let m=e/p;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(f*this.width,d*this.height),this.x=s,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:r},rotation:i}=this.parent.viewport;return gc.process(t,e,r,i,Fa._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:r,pageHeight:i},rotation:s}=this.parent.viewport;return gc.extractContoursFromText(t,e,r,i,s,Fa._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:r},rotation:i}=this.parent.viewport;return gc.processDrawnLines({lines:t,pageWidth:e,pageHeight:r,rotation:i,innerMargin:Fa._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Fa.getDefaultDrawingOptions():(this._drawingOptions=Fa._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:r,rect:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,a={annotationType:Be.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.paths={lines:e,points:r},a.uuid=this.#r,a.isCopy=!0):a.lines=e,this.#e&&(a.accessibilityData={type:"Figure",alt:this.#e}),a}static deserializeDraw(t,e,r,i,s,a){return a.areContours?Mx.deserialize(t,e,r,i,s,a):dp.deserialize(t,e,r,i,s,a)}static async deserialize(t,e,r){const i=await super.deserialize(t,e,r);return i.#t=t.areContours,i.#e=t.accessibilityData?.alt||"",i.#r=t.uuid,i}}class w6 extends Se{#t=null;#e=null;#n=null;#r=null;#s=null;#i="";#l=null;#o=!1;#f=null;#c=!1;#h=!1;static _type="stamp";static _editorType=Be.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#r=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Se.initialize(t,e)}static isHandlingMimeForPasting(t){return tg.includes(t)}static paste(t,e){e.pasteEditor({mode:Be.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#i=t.file.name),this.#p()}#d(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await r.guess({name:"altText",request:{data:i,width:s,height:a,channels:i.length/(s*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),e&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}#a(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(r=>this.#u(r,!0)).finally(()=>this.#d());return}if(this.#r){const r=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(r).then(i=>this.#u(i)).finally(()=>this.#d());return}if(this.#s){const r=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(r).then(i=>this.#u(i)).finally(()=>this.#d());return}const t=document.createElement("input");t.type="file",t.accept=tg.join(",");const e=this._uiManager._signal;this.#n=new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(i)}r()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:e})}).finally(()=>this.#d()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#l?.remove(),this.#l=null,this.#f&&(clearTimeout(this.#f),this.#f=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#a();return}super.rebuild(),this.div!==null&&(this.#e&&this.#l===null&&this.#a(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#r||this.#s||this.#e||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#o||(this.#t?this.#p():this.#a()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:r,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(this.#e=r,i&&(this.#t=i),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#f!==null&&clearTimeout(this.#f);const t=200;this.#f=setTimeout(()=>{this.#f=null,this.#m()},t)}#p(){const{div:t}=this;let{width:e,height:r}=this.#t;const[i,s]=this.pageDimensions,a=.75;if(this.width)e=this.width*i,r=this.height*s;else if(e>a*i||r>a*s){const d=Math.min(a*i/e,a*s/r);e*=d,r*=d}const[l,u]=this.parentDimensions;this.setDims(e*l/i,r*u/s),this._uiManager.enableWaiting(!1);const f=this.#l=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/i,this.height=r/s,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&this.div.setAttribute("aria-description",this.#i)}copyCanvas(t,e,r=!1){t||(t=224);const{width:i,height:s}=this.#t,a=new ca;let l=this.#t,u=i,f=s,d=null;if(e){if(i>e||s>e){const N=Math.min(e/i,e/s);u=Math.floor(i*N),f=Math.floor(s*N)}d=document.createElement("canvas");const m=d.width=Math.ceil(u*a.sx),v=d.height=Math.ceil(f*a.sy);this.#c||(l=this.#g(m,v));const x=d.getContext("2d");x.filter=this._uiManager.hcmFilter;let _="white",y="#cfcfd8";this._uiManager.hcmFilter!=="none"?y="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(_="#8f8f9d",y="#42414d");const w=15,S=w*a.sx,T=w*a.sy,C=new OffscreenCanvas(S*2,T*2),R=C.getContext("2d");R.fillStyle=_,R.fillRect(0,0,S*2,T*2),R.fillStyle=y,R.fillRect(0,0,S,T),R.fillRect(S,T,S,T),x.fillStyle=x.createPattern(C,"repeat"),x.fillRect(0,0,m,v),x.drawImage(l,0,0,l.width,l.height,0,0,m,v)}let p=null;if(r){let m,v;if(a.symmetric&&l.width<t&&l.height<t)m=l.width,v=l.height;else if(l=this.#t,i>t||s>t){const y=Math.min(t/i,t/s);m=Math.floor(i*y),v=Math.floor(s*y),this.#c||(l=this.#g(m,v))}const _=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});_.drawImage(l,0,0,l.width,l.height,0,0,m,v),p={width:m,height:v,data:_.getImageData(0,0,m,v).data}}return{canvas:d,width:u,height:f,imageData:p}}#g(t,e){const{width:r,height:i}=this.#t;let s=r,a=i,l=this.#t;for(;s>2*t||a>2*e;){const u=s,f=a;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const d=new OffscreenCanvas(s,a);d.getContext("2d").drawImage(l,0,0,u,f,0,0,s,a),l=d.transferToImageBitmap()}return l}#m(){const[t,e]=this.parentDimensions,{width:r,height:i}=this,s=new ca,a=Math.ceil(r*t*s.sx),l=Math.ceil(i*e*s.sy),u=this.#l;if(!u||u.width===a&&u.height===l)return;u.width=a,u.height=l;const f=this.#c?this.#t:this.#g(a,l),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(f,0,0,f.width,f.height,0,0,a,l)}#v(t){if(t){if(this.#c){const i=this._uiManager.imageManager.getSvgUrl(this.#e);if(i)return i}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,r]=this.pageDimensions,i=Math.round(this.width*e*Rc.PDF_TO_CSS_UNITS),s=Math.round(this.height*r*Rc.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(i,s);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,i,s),a.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,r){let i=null,s=!1;if(t instanceof WD){const{data:{rect:_,rotation:y,id:w,structParent:S,popupRef:T},container:C,parent:{page:{pageNumber:R}},canvas:N}=t;let D,I;N?(delete t.canvas,{id:D,bitmap:I}=r.imageManager.getFromCanvas(C.id,N),N.remove()):(s=!0,t._hasNoCanvas=!0);const M=(await e._structTree.getAriaAttributes(`${Oy}${w}`))?.get("aria-label")||"";i=t={annotationType:Be.STAMP,bitmapId:D,bitmap:I,pageIndex:R-1,rect:_.slice(0),rotation:y,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:M},isSvg:!1,structParent:S,popupRef:T}}const a=await super.deserialize(t,e,r),{rect:l,bitmap:u,bitmapUrl:f,bitmapId:d,isSvg:p,accessibilityData:m}=t;s?(r.addMissingCanvas(t.id,a),a.#o=!0):d&&r.imageManager.isValidId(d)?(a.#e=d,u&&(a.#t=u)):a.#r=f,a.#c=p;const[v,x]=a.pageDimensions;return a.width=(l[2]-l[0])/v,a.height=(l[3]-l[1])/x,a.annotationElementId=t.id||null,m&&(a.altTextData=m),a._initialData=i,a.#h=!!i,a}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r={annotationType:Be.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(t)return r.bitmapUrl=this.#v(!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(r.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const l=this.#_(r);if(l.isSame)return null;l.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,e===null)return r;e.stamps||=new Map;const a=this.#c?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:a,serialized:r}),r.bitmap=this.#v(!1);else if(this.#c){const l=e.stamps.get(this.#e);a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=this.#v(!1))}return r}#_(t){const{pageIndex:e,accessibilityData:{altText:r}}=this._initialData,i=t.pageIndex===e,s=(t.accessibilityData?.alt||"")===r;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&s,isSameAltText:s}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class Ua{#t;#e=!1;#n=null;#r=null;#s=null;#i=new Map;#l=!1;#o=!1;#f=!1;#c=null;#h=null;#u=null;#d=null;#a;static _initialized=!1;static#p=new Map([br,Gy,w6,tr,Fa].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:r,structTreeLayer:i,accessibilityManager:s,annotationLayer:a,drawLayer:l,textLayer:u,viewport:f,l10n:d}){const p=[...Ua.#p.values()];if(!Ua._initialized){Ua._initialized=!0;for(const m of p)m.initialize(d,t)}t.registerEditorTypes(p),this.#a=t,this.pageIndex=e,this.div=r,this.#t=s,this.#n=a,this.viewport=f,this.#u=u,this.drawLayer=l,this._structTree=i,this.#a.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===Be.NONE}updateToolbar(t){this.#a.updateToolbar(t)}updateMode(t=this.#a.getMode()){switch(this.#x(),t){case Be.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Be.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Be.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const r of Ua.#p.values())e.toggle(`${r._type}Editing`,t===r._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#a.setEditingState(t)}addCommands(t){this.#a.addCommands(t)}cleanUndoStack(t){this.#a.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#f=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const r of this.#i.values())r.enableEditing(),r.show(!0),r.annotationElementId&&(this.#a.removeChangedExistingAnnotation(r),t.add(r.annotationElementId));if(!this.#n){this.#f=!1;return}const e=this.#n.getEditableAnnotations();for(const r of e){if(r.hide(),this.#a.isDeletedAnnotationElement(r.data.id)||t.has(r.data.id))continue;const i=await this.deserialize(r);i&&(this.addOrRebuild(i),i.enableEditing())}this.#f=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const i of this.#i.values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){t.set(i.annotationElementId,i);continue}else e.set(i.annotationElementId,i);this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()}if(this.#n){const i=this.#n.getEditableAnnotations();for(const s of i){const{id:a}=s.data;if(this.#a.isDeletedAnnotationElement(a))continue;let l=e.get(a);if(l){l.resetAnnotationElement(s),l.show(!1),s.show();continue}l=t.get(a),l&&(this.#a.addChangedExistingAnnotation(l),l.renderAnnotationElement(s)&&l.show(!1)),s.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const i of Ua.#p.values())r.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#a.getActive()!==t&&this.#a.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#d){this.#d=new AbortController;const t=this.#a.combinedSignal(this.#d);this.#u.div.addEventListener("pointerdown",this.#g.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#u.div.classList.remove("highlighting"))}#g(t){this.#a.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:r}=Or.platform;if(t.button!==0||t.ctrlKey&&r)return;this.#a.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),tr.startHighlighting(this,this.#a.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),t.preventDefault()}}enableClick(){if(this.#r)return;this.#r=new AbortController;const t=this.#a.combinedSignal(this.#r);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#r?.abort(),this.#r=null}attach(t){this.#i.set(t.id,t);const{annotationElementId:e}=t;e&&this.#a.isDeletedAnnotationElement(e)&&this.#a.removeDeletedAnnotationElement(t)}detach(t){this.#i.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#a.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#a.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#a.addDeletedAnnotationElement(t.annotationElementId),Se.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#a.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#f),this.#a.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),r=()=>{t.remove()};this.addCommands({cmd:e,undo:r,mustExec:!1})}getNextId(){return this.#a.getId()}get#m(){return Ua.#p.get(this.#a.getMode())}combinedSignal(t){return this.#a.combinedSignal(t)}#v(t){const e=this.#m;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#m?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#a.updateMode(t.mode);const{offsetX:r,offsetY:i}=this.#_(),s=this.getNextId(),a=this.#v({parent:this,id:s,x:r,y:i,uiManager:this.#a,isCentered:!0,...e});a&&this.add(a)}async deserialize(t){return await Ua.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#a)||null}createAndAddNewEditor(t,e,r={}){const i=this.getNextId(),s=this.#v({parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:this.#a,isCentered:e,...r});return s&&this.add(s),s}#_(){const{x:t,y:e,width:r,height:i}=this.div.getBoundingClientRect(),s=Math.max(0,t),a=Math.max(0,e),l=Math.min(window.innerWidth,t+r),u=Math.min(window.innerHeight,e+i),f=(s+l)/2-t,d=(a+u)/2-e,[p,m]=this.viewport.rotation%180===0?[f,d]:[d,f];return{offsetX:p,offsetY:m}}addNewEditor(t={}){this.createAndAddNewEditor(this.#_(),!0,t)}setSelected(t){this.#a.setSelected(t)}toggleSelected(t){this.#a.toggleSelected(t)}unselect(t){this.#a.unselect(t)}pointerup(t){const{isMac:e}=Or.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#l||(this.#l=!1,this.#m?.isDrawer&&this.#m.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const r=this.#a.getMode();if(r===Be.STAMP||r===Be.SIGNATURE){this.#a.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#a.getMode()===Be.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:e}=Or.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#l=!0,this.#m?.isDrawer){this.startDrawingSession(t);return}const r=this.#a.getActive();this.#e=!r||r.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#m.startDrawing(this,this.#a,!1,t);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(this.#h=null,this.commitOrRemove())},{signal:e}),this.#m.startDrawing(this,this.#a,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#h=e);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(t=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#h=null,this.#m.endDrawing(t)):null}findNewParent(t,e,r){const i=this.#a.findParent(e,r);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#m.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#i.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#i.clear(),this.#a.removeLayer(this)}#x(){for(const t of this.#i.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Nl(this.div,t);for(const e of this.#a.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#a.commitOrRemove(),this.#x();const e=this.viewport.rotation,r=t.rotation;if(this.viewport=t,Nl(this.div,{rotation:r}),e!==r)for(const i of this.#i.values())i.rotate(r)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#a.viewParameters.realScale}}class Cr{#t=null;#e=new Map;#n=new Map;static#r=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Xe(this,"_svgFactory",new Pd)}static#s(t,[e,r,i,s]){const{style:a}=t;a.top=`${100*r}%`,a.left=`${100*e}%`,a.width=`${100*i}%`,a.height=`${100*s}%`}#i(){const t=Cr._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#l(t,e){const r=Cr._svgFactory.createElement("clipPath");t.append(r);const i=`clip_${e}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const s=Cr._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),i}#o(t,e){for(const[r,i]of Object.entries(e))i===null?t.removeAttribute(r):t.setAttribute(r,i)}draw(t,e=!1,r=!1){const i=Cr.#r++,s=this.#i(),a=Cr._svgFactory.createElement("defs");s.append(a);const l=Cr._svgFactory.createElement("path");a.append(l);const u=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(i,l);const f=r?this.#l(a,u):null,d=Cr._svgFactory.createElement("use");return s.append(d),d.setAttribute("href",`#${u}`),this.updateProperties(s,t),this.#e.set(i,s),{id:i,clipPathId:`url(#${f})`}}drawOutline(t,e){const r=Cr.#r++,i=this.#i(),s=Cr._svgFactory.createElement("defs");i.append(s);const a=Cr._svgFactory.createElement("path");s.append(a);const l=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let u;if(e){const p=Cr._svgFactory.createElement("mask");s.append(p),u=`mask_p${this.pageIndex}_${r}`,p.setAttribute("id",u),p.setAttribute("maskUnits","objectBoundingBox");const m=Cr._svgFactory.createElement("rect");p.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const v=Cr._svgFactory.createElement("use");p.append(v),v.setAttribute("href",`#${l}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const f=Cr._svgFactory.createElement("use");i.append(f),f.setAttribute("href",`#${l}`),u&&f.setAttribute("mask",`url(#${u})`);const d=f.cloneNode();return i.append(d),f.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,t),this.#e.set(r,i),r}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:r,bbox:i,rootClass:s,path:a}=e,l=typeof t=="number"?this.#e.get(t):t;if(l){if(r&&this.#o(l,r),i&&Cr.#s(l,i),s){const{classList:u}=l;for(const[f,d]of Object.entries(s))u.toggle(f,d)}if(a){const f=l.firstChild.firstChild;this.#o(f,a)}}}updateParent(t,e){if(e===this)return;const r=this.#e.get(t);r&&(e.#t.append(r),this.#e.delete(t),e.#e.set(t,r))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Lx};globalThis.pdfjsLib={AbortException:Bo,AnnotationEditorLayer:Ua,AnnotationEditorParamsType:Ke,AnnotationEditorType:Be,AnnotationEditorUIManager:Uo,AnnotationLayer:$y,AnnotationMode:Ha,AnnotationType:Jn,build:zD,ColorPicker:is,createValidAbsoluteUrl:Ty,DOMSVGFactory:Pd,DrawLayer:Cr,FeatureTest:Or,fetchData:Sf,getDocument:By,getFilenameFromUrl:_D,getPdfFilenameFromUrl:xD,getUuid:Dy,getXfaPageViewport:yD,GlobalWorkerOptions:Sl,ImageKind:wd,InvalidPDFException:Jm,isDataScheme:lp,isPdfFile:Vg,isValidExplicitDest:AD,MathClamp:ti,noContextMenu:Hs,normalizeUnicode:gD,OPS:kd,OutputScale:ca,PasswordResponses:pD,PDFDataRangeTransport:zy,PDFDateString:Ry,PDFWorker:df,PermissionFlag:dD,PixelsPerInch:Rc,RenderingCancelledException:Gg,ResponseException:Ld,setLayerDimensions:Nl,shadow:Xe,SignatureExtractor:gc,stopEvent:er,SupportedImageMimeTypes:tg,TextLayer:Id,TouchManager:up,updateUrlHash:Cy,Util:ye,VerbosityLevel:sp,version:UD,XfaLayer:jy};const E6=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Bo,AnnotationEditorLayer:Ua,AnnotationEditorParamsType:Ke,AnnotationEditorType:Be,AnnotationEditorUIManager:Uo,AnnotationLayer:$y,AnnotationMode:Ha,AnnotationType:Jn,ColorPicker:is,DOMSVGFactory:Pd,DrawLayer:Cr,FeatureTest:Or,GlobalWorkerOptions:Sl,ImageKind:wd,InvalidPDFException:Jm,MathClamp:ti,OPS:kd,OutputScale:ca,PDFDataRangeTransport:zy,PDFDateString:Ry,PDFWorker:df,PasswordResponses:pD,PermissionFlag:dD,PixelsPerInch:Rc,RenderingCancelledException:Gg,ResponseException:Ld,SignatureExtractor:gc,SupportedImageMimeTypes:tg,TextLayer:Id,TouchManager:up,Util:ye,VerbosityLevel:sp,XfaLayer:jy,build:zD,createValidAbsoluteUrl:Ty,fetchData:Sf,getDocument:By,getFilenameFromUrl:_D,getPdfFilenameFromUrl:xD,getUuid:Dy,getXfaPageViewport:yD,isDataScheme:lp,isPdfFile:Vg,isValidExplicitDest:AD,noContextMenu:Hs,normalizeUnicode:gD,setLayerDimensions:Nl,shadow:Xe,stopEvent:er,updateUrlHash:Cy,version:UD},Symbol.toStringTag,{value:"Module"})),A6=["onCopy","onCut","onPaste"],S6=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],T6=["onFocus","onBlur"],C6=["onInput","onInvalid","onReset","onSubmit"],D6=["onLoad","onError"],O6=["onKeyDown","onKeyPress","onKeyUp"],R6=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],N6=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],k6=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],L6=["onSelect"],I6=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],M6=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],P6=["onScroll"],F6=["onWheel"],B6=["onAnimationStart","onAnimationEnd","onAnimationIteration"],U6=["onTransitionEnd"],z6=["onToggle"],j6=["onChange"],H6=[...A6,...S6,...T6,...C6,...D6,...O6,...R6,...N6,...k6,...L6,...I6,...M6,...P6,...F6,...B6,...U6,...j6,...z6];function KD(n,t){const e={};for(const r of H6){const i=n[r];i&&(t?e[r]=s=>i(s,t(r)):e[r]=i)}return e}function pp(n){let t=!1;return{promise:new Promise((r,i)=>{n.then(s=>!t&&r(s)).catch(s=>!t&&i(s))}),cancel(){t=!0}}}function ZD(n){var t,e,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(t=0;t<i;t++)n[t]&&(e=ZD(n[t]))&&(r&&(r+=" "),r+=e)}else for(e in n)n[e]&&(r&&(r+=" "),r+=e);return r}function Yg(){for(var n,t,e=0,r="",i=arguments.length;e<i;e++)(n=arguments[e])&&(t=ZD(n))&&(r&&(r+=" "),r+=t);return r}var $6="Invariant failed";function An(n,t){if(!n)throw new Error($6)}var v_,DS;function G6(){if(DS)return v_;DS=1;var n=function(){};return v_=n,v_}var V6=G6();const ii=bf(V6);var OS=Object.prototype.hasOwnProperty;function RS(n,t,e){for(e of n.keys())if(Ku(e,t))return e}function Ku(n,t){var e,r,i;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((r=n.length)===t.length)for(;r--&&Ku(n[r],t[r]););return r===-1}if(e===Set){if(n.size!==t.size)return!1;for(r of n)if(i=r,i&&typeof i=="object"&&(i=RS(t,i),!i)||!t.has(i))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(r of n)if(i=r[0],i&&typeof i=="object"&&(i=RS(t,i),!i)||!Ku(r[1],t.get(i)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((r=n.byteLength)===t.byteLength)for(;r--&&n.getInt8(r)===t.getInt8(r););return r===-1}if(ArrayBuffer.isView(n)){if((r=n.byteLength)===t.byteLength)for(;r--&&n[r]===t[r];);return r===-1}if(!e||typeof n=="object"){r=0;for(e in n)if(OS.call(n,e)&&++r&&!OS.call(t,e)||!(e in t)||!Ku(n[e],t[e]))return!1;return Object.keys(t).length===r}}return n!==n&&t!==t}const QD=_t.createContext(null);function Zu({children:n,type:t}){return nt.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:n})}const W6="noopener noreferrer nofollow";class q6{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return An(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){An(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}goToDestination(t){return new Promise(e=>{An(this.pdfDocument),An(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{An(Array.isArray(e));const r=e[0];new Promise(i=>{An(this.pdfDocument),r instanceof Object?this.pdfDocument.getPageIndex(r).then(s=>{i(s)}).catch(()=>{An(!1)}):typeof r=="number"?i(r):An(!1)}).then(i=>{const s=i+1;An(this.pdfViewer),An(s>=1&&s<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:i,pageNumber:s})})})}navigateTo(t){this.goToDestination(t)}goToPage(t){const e=t-1;An(this.pdfViewer),An(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}addLinkAttributes(t,e,r){t.href=e,t.rel=this.externalLinkRel||W6,t.target=r?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const NS={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Xg=typeof window<"u",JD=Xg&&window.location.protocol==="file:";function Y6(n){return typeof n<"u"}function hc(n){return Y6(n)&&n!==null}function X6(n){return typeof n=="string"}function K6(n){return n instanceof ArrayBuffer}function Z6(n){return An(Xg),n instanceof Blob}function Px(n){return X6(n)&&/^data:/.test(n)}function kS(n){An(Px(n));const[t="",e=""]=n.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function Q6(){return Xg&&window.devicePixelRatio||1}const tO="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function LS(){ii(!JD,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${tO}`)}function J6(){ii(!JD,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${tO}`)}function kc(n){n?.cancel&&n.cancel()}function Fx(n,t){return Object.defineProperty(n,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function t5(n){return n.name==="RenderingCancelledException"}function e5(n){return new Promise((t,e)=>{const r=new FileReader;r.onload=()=>{if(!r.result)return e(new Error("Error while reading a file."));t(r.result)},r.onerror=i=>{if(!i.target)return e(new Error("Error while reading a file."));const{error:s}=i.target;if(!s)return e(new Error("Error while reading a file."));switch(s.code){case s.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case s.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case s.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},r.readAsArrayBuffer(n)})}function n5(n,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function pf(){return _t.useReducer(n5,{value:void 0,error:void 0})}var IS=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const{PDFDataRangeTransport:r5}=E6,i5=(n,t)=>{switch(t){case NS.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");n(e);break}case NS.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");n(e);break}}};function MS(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const s5=_t.forwardRef(function(t,e){var{children:r,className:i,error:s="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:l,file:u,inputRef:f,imageResourcesPath:d,loading:p="Loading PDF…",noData:m="No PDF file specified.",onItemClick:v,onLoadError:x,onLoadProgress:_,onLoadSuccess:y,onPassword:w=i5,onSourceError:S,onSourceSuccess:T,options:C,renderMode:R,rotate:N,scale:D}=t,I=IS(t,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[M,B]=pf(),{value:H,error:F}=M,[rt,L]=pf(),{value:it,error:Z}=rt,q=_t.useRef(new q6),Ct=_t.useRef([]),at=_t.useRef(void 0),P=_t.useRef(void 0);u&&u!==at.current&&MS(u)&&(ii(!Ku(u,at.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),at.current=u),C&&C!==P.current&&(ii(!Ku(C,P.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),P.current=C);const V=_t.useRef({scrollPageIntoView:O=>{const{dest:gt,pageNumber:ut,pageIndex:K=ut-1}=O;if(v){v({dest:gt,pageIndex:K,pageNumber:ut});return}const X=Ct.current[K];if(X){X.scrollIntoView();return}ii(!1,`An internal link leading to page ${ut} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});_t.useImperativeHandle(e,()=>({linkService:q,pages:Ct,viewer:V}),[]);function j(){T&&T()}function et(){F&&(ii(!1,F.toString()),S&&S(F))}function dt(){B({type:"RESET"})}_t.useEffect(dt,[u,B]);const xt=_t.useCallback(async()=>{if(!u)return null;if(typeof u=="string")return Px(u)?{data:kS(u)}:(LS(),{url:u});if(u instanceof r5)return{range:u};if(K6(u))return{data:u};if(Xg&&Z6(u))return{data:await e5(u)};if(An(typeof u=="object"),An(MS(u)),"url"in u&&typeof u.url=="string"){if(Px(u.url)){const{url:O}=u,gt=IS(u,["url"]),ut=kS(O);return Object.assign({data:ut},gt)}LS()}return u},[u]);_t.useEffect(()=>{const O=pp(xt());return O.promise.then(gt=>{B({type:"RESOLVE",value:gt})}).catch(gt=>{B({type:"REJECT",error:gt})}),()=>{kc(O)}},[xt,B]),_t.useEffect(()=>{if(!(typeof H>"u")){if(H===!1){et();return}j()}},[H]);function Nt(){it&&(y&&y(it),Ct.current=new Array(it.numPages),q.current.setDocument(it))}function Rt(){Z&&(ii(!1,Z.toString()),x&&x(Z))}_t.useEffect(function(){L({type:"RESET"})},[L,H]),_t.useEffect(function(){if(!H)return;const gt=C?Object.assign(Object.assign({},H),C):H,ut=By(gt);_&&(ut.onProgress=_),w&&(ut.onPassword=w);const K=ut,X=K.promise.then(pt=>{L({type:"RESOLVE",value:pt})}).catch(pt=>{K.destroyed||L({type:"REJECT",error:pt})});return()=>{X.finally(()=>K.destroy())}},[C,L,H]),_t.useEffect(()=>{if(!(typeof it>"u")){if(it===!1){Rt();return}Nt()}},[it]),_t.useEffect(function(){q.current.setViewer(V.current),q.current.setExternalLinkRel(a),q.current.setExternalLinkTarget(l)},[a,l]);const z=_t.useCallback((O,gt)=>{Ct.current[O]=gt},[]),lt=_t.useCallback(O=>{delete Ct.current[O]},[]),J=_t.useMemo(()=>({imageResourcesPath:d,linkService:q.current,onItemClick:v,pdf:it,registerPage:z,renderMode:R,rotate:N,scale:D,unregisterPage:lt}),[d,v,it,z,R,N,D,lt]),ot=_t.useMemo(()=>KD(I,()=>it),[I,it]);function yt(){return nt.jsx(QD.Provider,{value:J,children:r})}function At(){return u?it==null?nt.jsx(Zu,{type:"loading",children:typeof p=="function"?p():p}):it===!1?nt.jsx(Zu,{type:"error",children:typeof s=="function"?s():s}):yt():nt.jsx(Zu,{type:"no-data",children:typeof m=="function"?m():m})}return nt.jsx("div",Object.assign({className:Yg("react-pdf__Document",i),ref:f},ot,{children:At()}))});function eO(){return _t.useContext(QD)}function nO(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var e=n.filter(Boolean);if(e.length<=1){var r=e[0];return r||null}return function(s){for(var a=0,l=e;a<l.length;a++){var u=l[a];typeof u=="function"?u(s):u&&(u.current=s)}}}const rO=_t.createContext(null),iO={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},a5=/^H(\d+)$/;function o5(n){return n in iO}function Kg(n){return"children"in n}function sO(n){return Kg(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function l5(n){const t={};if(Kg(n)){const{role:e}=n,r=e.match(a5);if(r)t.role="heading",t["aria-level"]=Number(r[1]);else if(o5(e)){const i=iO[e];i&&(t.role=i)}}return t}function aO(n){const t={};if(Kg(n)){if(n.alt!==void 0&&(t["aria-label"]=n.alt),n.lang!==void 0&&(t.lang=n.lang),sO(n)){const[e]=n.children;if(e){const r=aO(e);return Object.assign(Object.assign({},t),r)}}}else"id"in n&&(t["aria-owns"]=n.id);return t}function c5(n){return n?Object.assign(Object.assign({},l5(n)),aO(n)):null}function oO({className:n,node:t}){const e=_t.useMemo(()=>c5(t),[t]),r=_t.useMemo(()=>!Kg(t)||sO(t)?null:t.children.map((i,s)=>nt.jsx(oO,{node:i},s)),[t]);return nt.jsx("span",Object.assign({className:n},e,{children:r}))}function Zg(){return _t.useContext(rO)}function u5(){const n=Zg();An(n);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=n,[r,i]=pf(),{value:s,error:a}=r,{customTextRenderer:l,page:u}=n;function f(){s&&e&&e(s)}function d(){a&&(ii(!1,a.toString()),t&&t(a))}return _t.useEffect(function(){i({type:"RESET"})},[i,u]),_t.useEffect(function(){if(l||!u)return;const m=pp(u.getStructTree()),v=m;return m.promise.then(x=>{i({type:"RESOLVE",value:x})}).catch(x=>{i({type:"REJECT",error:x})}),()=>kc(v)},[l,u,i]),_t.useEffect(()=>{if(s!==void 0){if(s===!1){d();return}f()}},[s]),s?nt.jsx(oO,{className:"react-pdf__Page__structTree structTree",node:s}):null}const PS=Ha;function f5(n){const t=Zg();An(t);const e=Object.assign(Object.assign({},t),n),{_className:r,canvasBackground:i,devicePixelRatio:s=Q6(),onRenderError:a,onRenderSuccess:l,page:u,renderForms:f,renderTextLayer:d,rotate:p,scale:m}=e,{canvasRef:v}=n;An(u);const x=_t.useRef(null);function _(){u&&l&&l(Fx(u,m))}function y(C){t5(C)||(ii(!1,C.toString()),a&&a(C))}const w=_t.useMemo(()=>u.getViewport({scale:m*s,rotation:p}),[s,u,p,m]),S=_t.useMemo(()=>u.getViewport({scale:m,rotation:p}),[u,p,m]);_t.useEffect(function(){if(!u)return;u.cleanup();const{current:R}=x;if(!R)return;R.width=w.width,R.height=w.height,R.style.width=`${Math.floor(S.width)}px`,R.style.height=`${Math.floor(S.height)}px`,R.style.visibility="hidden";const N={annotationMode:f?PS.ENABLE_FORMS:PS.ENABLE,canvasContext:R.getContext("2d",{alpha:!1}),viewport:w};i&&(N.background=i);const D=u.render(N),I=D;return D.promise.then(()=>{R.style.visibility="",_()}).catch(y),()=>kc(I)},[i,u,f,w,S]);const T=_t.useCallback(()=>{const{current:C}=x;C&&(C.width=0,C.height=0)},[]);return _t.useEffect(()=>T,[T]),nt.jsx("canvas",{className:`${r}__canvas`,dir:"ltr",ref:nO(v,x),style:{display:"block",userSelect:"none"},children:d?nt.jsx(u5,{}):null})}function h5(n){return"str"in n}function d5(){const n=Zg();An(n);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:r,onRenderTextLayerError:i,onRenderTextLayerSuccess:s,page:a,pageIndex:l,pageNumber:u,rotate:f,scale:d}=n;An(a);const[p,m]=pf(),{value:v,error:x}=p,_=_t.useRef(null);ii(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function y(){v&&r&&r(v)}function w(){x&&(ii(!1,x.toString()),e&&e(x))}_t.useEffect(function(){m({type:"RESET"})},[a,m]),_t.useEffect(function(){if(!a)return;const I=pp(a.getTextContent()),M=I;return I.promise.then(B=>{m({type:"RESOLVE",value:B})}).catch(B=>{m({type:"REJECT",error:B})}),()=>kc(M)},[a,m]),_t.useEffect(()=>{if(v!==void 0){if(v===!1){w();return}y()}},[v]);const S=_t.useCallback(()=>{s&&s()},[s]),T=_t.useCallback(D=>{ii(!1,D.toString()),i&&i(D)},[i]);function C(){const D=_.current;D&&D.classList.add("selecting")}function R(){const D=_.current;D&&D.classList.remove("selecting")}const N=_t.useMemo(()=>a.getViewport({scale:d,rotation:f}),[a,f,d]);return _t.useLayoutEffect(function(){if(!a||!v)return;const{current:I}=_;if(!I)return;I.innerHTML="";const M=a.streamTextContent({includeMarkedContent:!0}),B={container:I,textContentSource:M,viewport:N},H=new Id(B),F=H;return H.render().then(()=>{const rt=document.createElement("div");rt.className="endOfContent",I.append(rt);const L=I.querySelectorAll('[role="presentation"]');if(t){let it=0;v.items.forEach((Z,q)=>{if(!h5(Z))return;const Ct=L[it];if(!Ct)return;const at=t(Object.assign({pageIndex:l,pageNumber:u,itemIndex:q},Z));Ct.innerHTML=at,it+=Z.str&&Z.hasEOL?2:1})}S()}).catch(T),()=>kc(F)},[t,T,S,a,l,u,v,N]),nt.jsx("div",{className:Yg("react-pdf__Page__textContent","textLayer"),onMouseUp:R,onMouseDown:C,ref:_})}function p5(){const n=eO(),t=Zg();An(t);const e=Object.assign(Object.assign({},n),t),{imageResourcesPath:r,linkService:i,onGetAnnotationsError:s,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:u,page:f,pdf:d,renderForms:p,rotate:m,scale:v=1}=e;An(d),An(f),An(i);const[x,_]=pf(),{value:y,error:w}=x,S=_t.useRef(null);ii(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function T(){y&&a&&a(y)}function C(){w&&(ii(!1,w.toString()),s&&s(w))}_t.useEffect(function(){_({type:"RESET"})},[_,f]),_t.useEffect(function(){if(!f)return;const M=pp(f.getAnnotations()),B=M;return M.promise.then(H=>{_({type:"RESOLVE",value:H})}).catch(H=>{_({type:"REJECT",error:H})}),()=>{kc(B)}},[_,f]),_t.useEffect(()=>{if(y!==void 0){if(y===!1){C();return}T()}},[y]);function R(){u&&u()}function N(I){ii(!1,`${I}`),l&&l(I)}const D=_t.useMemo(()=>f.getViewport({scale:v,rotation:m}),[f,m,v]);return _t.useEffect(function(){if(!d||!f||!i||!y)return;const{current:M}=S;if(!M)return;const B=D.clone({dontFlip:!0}),H={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:M,l10n:null,page:f,structTreeLayer:null,viewport:B},F={annotations:y,annotationStorage:d.annotationStorage,div:M,imageResourcesPath:r,linkService:i,page:f,renderForms:p,viewport:B};M.innerHTML="";try{new $y(H).render(F),R()}catch(rt){N(rt)}return()=>{}},[y,r,i,f,d,p,D]),nt.jsx("div",{className:Yg("react-pdf__Page__annotations","annotationLayer"),ref:S})}var m5=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};const FS=1;function g5(n){const t=eO(),e=Object.assign(Object.assign({},t),n),{_className:r="react-pdf__Page",_enableRegisterUnregisterPage:i=!0,canvasBackground:s,canvasRef:a,children:l,className:u,customRenderer:f,customTextRenderer:d,devicePixelRatio:p,error:m="Failed to load the page.",height:v,inputRef:x,loading:_="Loading page…",noData:y="No page specified.",onGetAnnotationsError:w,onGetAnnotationsSuccess:S,onGetStructTreeError:T,onGetStructTreeSuccess:C,onGetTextError:R,onGetTextSuccess:N,onLoadError:D,onLoadSuccess:I,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:B,onRenderError:H,onRenderSuccess:F,onRenderTextLayerError:rt,onRenderTextLayerSuccess:L,pageIndex:it,pageNumber:Z,pdf:q,registerPage:Ct,renderAnnotationLayer:at=!0,renderForms:P=!1,renderMode:V="canvas",renderTextLayer:j=!0,rotate:et,scale:dt=FS,unregisterPage:xt,width:Nt}=e,Rt=m5(e,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[z,lt]=pf(),{value:J,error:ot}=z,yt=_t.useRef(null);An(q);const At=hc(Z)?Z-1:it??null,O=Z??(hc(it)?it+1:null),gt=et??(J?J.rotate:null),ut=_t.useMemo(()=>{if(!J)return null;let ae=1;const ne=dt??FS;if(Nt||v){const Re=J.getViewport({scale:1,rotation:gt});Nt?ae=Nt/Re.width:v&&(ae=v/Re.height)}return ne*ae},[v,J,gt,dt,Nt]);_t.useEffect(function(){return()=>{hc(At)&&i&&xt&&xt(At)}},[i,q,At,xt]);function K(){if(I){if(!J||!ut)return;I(Fx(J,ut))}if(i&&Ct){if(!hc(At)||!yt.current)return;Ct(At,yt.current)}}function X(){ot&&(ii(!1,ot.toString()),D&&D(ot))}_t.useEffect(function(){lt({type:"RESET"})},[lt,q,At]),_t.useEffect(function(){if(!q||!O)return;const ne=pp(q.getPage(O)),Re=ne;return ne.promise.then(rn=>{lt({type:"RESOLVE",value:rn})}).catch(rn=>{lt({type:"REJECT",error:rn})}),()=>kc(Re)},[lt,q,O]),_t.useEffect(()=>{if(J!==void 0){if(J===!1){X();return}K()}},[J,ut]);const pt=_t.useMemo(()=>J&&hc(At)&&O&&hc(gt)&&hc(ut)?{_className:r,canvasBackground:s,customTextRenderer:d,devicePixelRatio:p,onGetAnnotationsError:w,onGetAnnotationsSuccess:S,onGetStructTreeError:T,onGetStructTreeSuccess:C,onGetTextError:R,onGetTextSuccess:N,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:B,onRenderError:H,onRenderSuccess:F,onRenderTextLayerError:rt,onRenderTextLayerSuccess:L,page:J,pageIndex:At,pageNumber:O,renderForms:P,renderTextLayer:j,rotate:gt,scale:ut}:null,[r,s,d,p,w,S,T,C,R,N,M,B,H,F,rt,L,J,At,O,P,j,gt,ut]),Bt=_t.useMemo(()=>KD(Rt,()=>J&&(ut?Fx(J,ut):void 0)),[Rt,J,ut]),Ht=`${At}@${ut}/${gt}`;function St(){switch(V){case"custom":return An(f),nt.jsx(f,{},`${Ht}_custom`);case"none":return null;case"canvas":default:return nt.jsx(f5,{canvasRef:a},`${Ht}_canvas`)}}function It(){return j?nt.jsx(d5,{},`${Ht}_text`):null}function Tt(){return at?nt.jsx(p5,{},`${Ht}_annotations`):null}function vt(){return nt.jsxs(rO.Provider,{value:pt,children:[St(),It(),Tt(),l]})}function te(){return O?q===null||J===void 0||J===null?nt.jsx(Zu,{type:"loading",children:typeof _=="function"?_():_}):q===!1||J===!1?nt.jsx(Zu,{type:"error",children:typeof m=="function"?m():m}):vt():nt.jsx(Zu,{type:"no-data",children:typeof y=="function"?y():y})}return nt.jsx("div",Object.assign({className:Yg(r,u),"data-page-number":O,ref:nO(x,yt),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${ut}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:s||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Bt,{children:te()}))}J6();Sl.workerSrc="pdf.worker.mjs";const dm=3,vd=(n,t,e,r)=>({x:n.x*e/t,width:n.width*e/t,y:r.height-n.y*e/t-n.height*e/t,height:n.height*e/t}),pm=(n,t)=>n.items.filter(e=>{const r=e.transform[4],i=e.transform[5],s=e.transform[4]+e.width,a=e.transform[5]+e.height;return r>=t.x-dm&&s<=t.x+t.width+dm&&i>=t.y-dm&&a<=t.y+t.height+dm}),BS=n=>{const t=n.filter(l=>{const u=l.str.trim();return/^(P|\d+)(\/\d+)?(\*+)?$|^-$/.test(u)});if(t.length===0)return[];const e=t.filter(l=>qy(l.str.trim()));if(e.length<2)return t.map(l=>l.str.trim());const r=[];for(let l=0;l+1<e.length;l++)r.push(Math.abs(e[l].transform[5]-e[l+1].transform[5]));r.sort((l,u)=>l-u);const i=e.length<4?e[0].height*1.2:r[r.length-1]-r[0]<=r[0]*1.2?0:r[0]*1.1,s=[],a=[];return t.forEach((l,u)=>{if(a.length>0){a.push(l.str.trim()),s.push(a.join("/")),a.length=0;return}if(l.str.trim()==="-"){s.push(l.str.trim());return}if(u+1<t.length&&Math.abs(l.transform[5]-t[u+1].transform[5])<=i){a.push(l.str.trim());return}s.push(l.str.trim())}),a.length>0&&s.push(a.join("/")),s},mm=(n,t)=>{const e=Array(),r=Array();let i=!1;return n.sort((s,a)=>{const l=a.transform[5]-s.transform[5],f=(s.height+a.height)/2*.5;return Math.abs(l)<=f?s.transform[4]-a.transform[4]:l}),n.forEach((s,a)=>{if(s.str.trim()=="")return;const l=s.height*1.5;if(i){e.push(s.str.trim());const u=e.join("/");r.push(u),e.length=0,i=!1;return}if(a<n.length-1){const u={x:s.transform[4]+s.width/5,y:s.transform[5]-s.height/2,width:s.width*.6,height:Math.min(Math.abs(s.transform[5]-n[a+1].transform[5]),s.height/2)},f={x:s.transform[4]+s.width/5,width:s.width*(3/5),y:s.transform[5]-s.height,height:s.height};if(Math.abs(s.transform[5]-n[a+1].transform[5])<=l&&!US(u,t))e.push(s.str.trim());else if(US(f,t,!0)&&qy(s.str.trim())&&v5(n,a)&&Math.abs(s.transform[5]-n[a+1].transform[5])<=l&&e.length<1)e.push(s.str.trim()),i=!0;else if(e.length>0){e.push(s.str.trim());const d=e.join(" ");r.push(d),e.length=0}else r.push(s.str.trim())}else{e.push(s.str.trim());const u=e.join(" ");r.push(u),e.length=0}}),e.length>0&&r.push(e.join(" ")),r},__=(n,t,e)=>Math.max(Math.min(n,e),t),US=(n,t,e=!1)=>{const r=n.x,i=n.x+n.width,s=n.y,a=n.y+n.height;return t.some(l=>l.x1<=i&&l.x2>=r&&l.y>=s&&l.y<=a&&(Math.abs(l.x2-l.x1)<=15||!e))},qy=n=>/^\d+(\.\d+)?$/.test(n.trim()),v5=(n,t)=>{for(let e=t+1;e<n.length;e++){const r=n[e].str.trim();if(r.trim())return qy(r)}return!1},hs=(n,t=0)=>{if(!n)return t;if(/^\d+\.\d+$/.test(n.trim()))return parseFloat(n.trim());const e=n.match(/\d+(?:[.,]\d+)*/);if(!e)return t;const r=e[0].trim().replaceAll(".","").replace(",","."),i=parseFloat(r);return isNaN(i)?t:i},Tf=n=>{const t=new Map;return n.forEach(e=>{e.dataType&&t.set(e.dataType,e.name)}),t},Gi=(n,t,e)=>{const r=t.get(e);return!r||!n[r]?e==="z"?"0":"":n[r][0]},No=(n,t,e)=>{const r=t.get(e);return!r||!n[r]?[]:n[r]},Qg=(n,t)=>{const e=t.get("depth");if(e&&n[e])return hs(n[e][0]);const r=t.get("depth_from_to");if(r&&n[r]){const i=n[r];return Math.max(...i.map(s=>hs(s)))}return 0},_5=n=>{if(!n||n.length===0)return"-";if(n.length===1)return`${n[0]}`;const t=[...n].sort((e,r)=>e-r);return x5(t)?`${t[0]}-${t[t.length-1]}`:`${t.join(", ")}`},x5=n=>{for(let t=1;t<n.length;t++)if(n[t]!==n[t-1]+1)return!1;return!0},lO=n=>n?["hole_id","x","y","z","depth","date","campaign","water_level"].includes(n):!1,y5=n=>n?["x","y","z","depth"].includes(n):!1,zS=(n,t)=>{if(!n||n.length===0)return[];const e=n.filter(r=>r.trim()!=="");if(e.length===0)return[];if(lO(t)){const r=e.join(" ").trim();if(t==="water_level"){const i=hs(r,-1);return[i===-1?"Seco":i.toString()]}return y5(t)?[hs(r).toString()]:[r]}return e},b5=(n,t)=>{const e=n/1e3,r=Math.floor(n/1e3),i=Math.floor((e-r)*t),s=r%60,l=Math.floor(r/60).toString(),u=s.toString().padStart(2,"0"),f=i.toString().padStart(t.toString().length-1,"0");return`${l}:${u},${f}`},w5=({areas:n,zoomScale:t,activeAreaId:e})=>nt.jsx(nt.Fragment,{children:n.map(r=>!r.coordinates||r.id===e?null:nt.jsx("div",{className:"position-absolute border",style:{left:r.coordinates.x*t,top:r.coordinates.y*t,width:r.coordinates.width*t,height:r.coordinates.height*t,backgroundColor:`${r.color}20`,borderColor:r.color,borderWidth:"2px",zIndex:10},title:r.name},`selected-${r.id}`))});/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E5=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),A5=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,r)=>r?r.toUpperCase():e.toLowerCase()),jS=n=>{const t=A5(n);return t.charAt(0).toUpperCase()+t.slice(1)},cO=(...n)=>n.filter((t,e,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===e).join(" ").trim(),S5=n=>{for(const t in n)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var T5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C5=_t.forwardRef(({color:n="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...l},u)=>_t.createElement("svg",{ref:u,...T5,width:t,height:t,stroke:n,strokeWidth:r?Number(e)*24/Number(t):e,className:cO("lucide",i),...!s&&!S5(l)&&{"aria-hidden":"true"},...l},[...a.map(([f,d])=>_t.createElement(f,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=(n,t)=>{const e=_t.forwardRef(({className:r,...i},s)=>_t.createElement(C5,{ref:s,iconNode:t,className:cO(`lucide-${E5(jS(n))}`,`lucide-${n}`,r),...i}));return e.displayName=jS(n),e};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D5=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],O5=Gr("check",D5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R5=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],N5=Gr("chevron-left",R5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],L5=Gr("chevron-right",k5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I5=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],M5=Gr("circle-question-mark",I5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P5=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Bx=Gr("download",P5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F5=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],B5=Gr("eraser",F5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U5=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],z5=Gr("eye",U5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j5=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],H5=Gr("folder",j5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $5=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],G5=Gr("play",$5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V5=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],W5=Gr("plus",V5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q5=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Y5=Gr("save",q5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X5=[["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 14v1",key:"169vum"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M7 16h6",key:"1vyc9m"}],["path",{d:"M7 8h8",key:"1jbsf9"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M9 3h1",key:"1yesri"}]],K5=Gr("text-select",X5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z5=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Q5=Gr("trash-2",Z5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J5=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],t8=Gr("trash",J5);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Yy=Gr("x",e8);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n8=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],r8=Gr("zoom-in",n8);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i8=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],s8=Gr("zoom-out",i8);Sl.workerSrc=new URL("/extrator-dados-pdf/assets/pdf.worker.min-BFAMBS4k.mjs",import.meta.url).toString();const x_=.5,y_=3,a8=_t.forwardRef(({file:n,isSelectingActive:t,activeAreaId:e,onFinishSelection:r,areas:i},s)=>{const a=_t.useRef(null),[l,u]=_t.useState(),[f,d]=_t.useState(1),[p,m]=_t.useState(!1),[v,x]=_t.useState(f),[_,y]=_t.useState(!1),[w,S]=_t.useState(null),[T,C]=_t.useState(null),R=_t.useRef(null),N=_t.useRef(null),[D,I]=_t.useState(1),[M,B]=_t.useState(null),H=()=>{I(At=>Math.min(At+.25,y_)),yt(0,0)},F=()=>{yt(0,0),I(At=>Math.max(At-.25,x_))},[rt,L]=_t.useState({x:0,y:0}),[it,Z]=_t.useState(null),[q,Ct]=_t.useState(!1);function at(At){d(O=>O+At)}function P(){at(-1)}function V(){at(1)}const j=()=>{x(f),m(!0)},et=()=>{v>=1&&v<=(l||1)&&d(v),m(!1)},dt=()=>{x(f),m(!1)},xt=At=>{At.key==="Enter"&&et(),At.key==="Escape"&&dt()};_t.useEffect(()=>{p&&R.current&&(R.current.focus(),R.current.select())},[p]);const Nt=At=>{if(N.current){if(_&&T&&T.x>=10&&T.y>=10)y(!1),C(null),r(T);else if(!_){const O=N.current.getBoundingClientRect(),gt=(At.clientX-O.left)/D,ut=(At.clientY-O.top)/D;S({x:gt,y:ut}),y(!0),C(null)}}},Rt=At=>{if(!N.current)return;const O=N.current.getBoundingClientRect();Z({x:At.clientX-O.left,y:At.clientY-O.top}),Ct(!0)},z=_t.useCallback(At=>{N.current&&(At.currentTarget.setPointerCapture(At.pointerId),t?Nt(At):Rt(At))},[_,T,D,t]),lt=_t.useCallback(At=>{if(!N.current)return;const O=N.current.getBoundingClientRect();if(q){if(q&&it){const X=At.clientX-O.left-it.x,pt=At.clientY-O.top-it.y;yt(X,pt)}return}if(!_||!w)return;const gt=(At.clientX-O.left)/D,ut=(At.clientY-O.top)/D,K={x:Math.min(w.x,gt),y:Math.min(w.y,ut),width:Math.abs(w.x-gt),height:Math.abs(w.y-ut)};C(K)},[_,w,q,it]),J=_t.useCallback(At=>{At.currentTarget.releasePointerCapture(At.pointerId),q&&Ct(!1)},[q,Rt]);_t.useEffect(()=>{t||ot()},[t]);const ot=()=>{y(!1),C(null),S(null)},yt=_t.useCallback((At,O)=>{const gt=document.querySelector(".pdf-container"),ut=gt?.getBoundingClientRect().width||600,K=gt?parseInt(getComputedStyle(gt).height):800,X=N.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().width||ut,pt=N.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().height||K,Bt=document.querySelector(".pdf-nav")?.getBoundingClientRect().height||40,Ht=X>=ut,St=pt>=K-Bt,It=Math.max(0,X-ut),Tt=Math.max(0,pt-K+Bt);L(vt=>({x:Ht?__(vt.x+At,-It,0):0,y:St?__(vt.y+O,-Tt,0):0}))},[]);return _t.useEffect(()=>{if(!n)return;const At=document.querySelector(".pdf-container");if(!At)return;const O=gt=>{gt.preventDefault();const ut=At.getBoundingClientRect(),K=(gt.clientX-ut.left)/ut.width,X=(gt.clientY-ut.top)/ut.height,pt=.1;I(Bt=>{const Ht=gt.deltaY>0?-pt:pt,St=__(Bt+Ht,x_,y_),It=N.current?.querySelector(".react-pdf__Page"),Tt=It?.getBoundingClientRect().width||0,vt=It?.getBoundingClientRect().height||0,te=St-Bt,ae=Tt*te,ne=vt*te,Re=ae*K,rn=ne*X;return B({x:-Re,y:-rn}),St})};return At.addEventListener("wheel",O,{passive:!1}),()=>{At.removeEventListener("wheel",O)}},[n,D]),_t.useEffect(()=>{M&&(yt(M.x,M.y),B(null))},[D]),_t.useImperativeHandle(s,()=>({getDocument:()=>a.current})),n?nt.jsx(nt.Fragment,{children:nt.jsxs("div",{className:"pdf-container mt-2",style:{height:"min(800px, 80vh)",overflow:"hidden",position:"relative",border:"2px solid black",marginBottom:"15px"},children:[nt.jsxs("div",{ref:N,className:`position-relative d-inline-block ${t?"pdf-cursor-crosshair":q?"pdf-cursor-grabbing":"pdf-cursor-grab"}`,onPointerDown:z,onPointerMove:lt,onPointerUp:J,style:{userSelect:"none",transform:`translate(${rt.x}px, ${rt.y}px)`},children:[nt.jsx(s5,{file:n,onLoadSuccess:At=>{u(At.numPages),d(1),I(1),a.current=At},children:nt.jsx(g5,{pageNumber:f,renderTextLayer:!1,renderAnnotationLayer:!1,scale:D})}),nt.jsx(w5,{areas:i,zoomScale:D,activeAreaId:e}),T&&nt.jsx("div",{className:"position-absolute border border-secondary",style:{left:T.x*D,top:T.y*D,width:T.width*D,height:T.height*D,backgroundColor:"rgba(134, 142, 135, 0.2)",zIndex:10}})]}),nt.jsxs("div",{className:"pdf-nav position-absolute bottom-0 start-0 end-0 d-flex align-items-center",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",padding:"4px 12px"},children:[nt.jsx("div",{className:"flex-grow-1 d-flex justify-content-center",children:p?nt.jsxs("div",{className:"d-flex align-items-center gap-1",children:[nt.jsx("input",{ref:R,type:"number",className:"form-control form-control-sm text-center",style:{width:"40px",fontSize:"12px",backgroundColor:"rgba(108, 108, 108, 0.8)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"2px",color:"white"},value:v,min:1,max:l||1,onChange:At=>x(parseInt(At.target.value)||1),onKeyDown:xt,onBlur:dt,autoFocus:!0}),nt.jsxs("span",{className:"text-white small",children:["de ",l||1]})]}):nt.jsxs("span",{onClick:j,className:"text-white small",title:"Selecionar página",style:{cursor:"pointer"},children:["Página ",f||1," ",l&&`de ${l}`]})}),nt.jsxs("div",{className:"d-flex gap-1",children:[nt.jsx("button",{className:"pdf-nav-button",title:"Página anterior",onClick:P,disabled:f<=1,children:nt.jsx(N5,{size:24,color:"#d0d0d0"})}),nt.jsx("button",{className:"pdf-nav-button",title:"Próxima página",onClick:V,disabled:f>=(l??0),children:nt.jsx(L5,{size:24,color:"#d0d0d0"})}),nt.jsx("button",{className:"pdf-nav-button",onClick:F,disabled:D<=x_,children:nt.jsx(s8,{size:24,color:"#d0d0d0"})}),nt.jsx("button",{className:"pdf-nav-button",onClick:H,disabled:D>=y_,children:nt.jsx(r8,{size:24,color:"#d0d0d0"})})]})]})]})}):nt.jsx(nt.Fragment,{children:nt.jsx("div",{className:"row",children:nt.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",style:{minHeight:"50vh"},children:nt.jsx("p",{className:"text-muted",children:"Carregue um pdf para ser exibido aqui"})})})})}),o8=["default","hole_id","x","y","z","depth","date","depth_from_to","water_level","geology","nspt","campaign","interp","generic_info"],Lc={default:"Padrão",hole_id:"ID da Sondagem",x:"Coordenada X",y:"Coordenada Y",z:"Cota",depth:"Profundidade Total",date:"Data",depth_from_to:"Profundidades",water_level:"Nível d'Água",geology:"Descrição Geológica",nspt:"NSPT",campaign:"Campanha",interp:"Interpretação Geológica",generic_info:"Outras Informações"},uO=["hole_id","x","y","z","depth","date","water_level","campaign"],fO=["hole_id"],l8=["hole_id","x","y","z","depth"],b_=["hole_id","x","y","z","depth","depth_from_to","geology","nspt","water_level","interp"],Vm=["collar","nspt","na","geology","interp"],c8={collar:"Collar",nspt:"NSPT",na:"NA",geology:"Geologia",interp:"Interpretação"},u8={collar:["hole_id","x","y"],nspt:["hole_id","nspt"],na:["hole_id","water_level"],geology:["hole_id","geology","depth_from_to"],interp:["hole_id","interp","depth_from_to"]},f8=({hasFile:n,area:t,areas:e,extractionMode:r,onStartSelection:i,onClearArea:s,onDeleteArea:a,onRenameArea:l,onToggleMandatory:u,onToggleRepeat:f,onToggleAreaOCR:d,onChangeAreaType:p})=>{const[m,v]=_t.useState(!1),[x,_]=_t.useState(t.name),y=_t.useRef(null);_t.useEffect(()=>{const I=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));return I.forEach(M=>new js(M)),()=>{I.forEach(M=>{const B=js.getInstance(M);B&&B.dispose()})}},[t]),_t.useEffect(()=>{m&&y.current&&(y.current.focus(),y.current.select())},[m]);const w=()=>{i(t.id)},S=()=>{a(t.id)},T=()=>{s(t.id)},C=()=>{_(t.name),v(!0)},R=I=>{I.key==="Enter"&&N(),I.key==="Escape"&&D()},N=()=>{x.trim()&&x.trim()!==t.name?(l(t.id,x.trim()),v(!1)):D()},D=()=>{_(t.name),v(!1)};return nt.jsx(nt.Fragment,{children:nt.jsxs("div",{className:"border rounded mb-1",children:[nt.jsxs("div",{className:"d-flex align-items-center gap-1 pt-2 px-2 pb-1",children:[nt.jsx("div",{className:"drag-handle",style:{cursor:"grab"},children:"⋮⋮"}),nt.jsx("div",{className:"d-flex align-items-center",children:nt.jsxs("span",{className:"badge me-2",style:{backgroundColor:t.color,color:"white"},children:["#",t.order]})}),m?nt.jsxs("div",{className:"d-flex align-items-center flex-grow-1",children:[nt.jsx("input",{ref:y,type:"text",className:"form-control form-control-sm me-2",value:x,onChange:I=>_(I.target.value),onKeyDown:R,onBlur:N}),nt.jsxs("div",{className:"d-flex gap-2",children:[nt.jsx("button",{className:"menu-btn menu-btn-cta",title:"Confirmar",onClick:N,children:nt.jsx(O5,{size:16})}),nt.jsx("button",{className:"menu-btn menu-btn-warning",title:"Cancelar",onClick:D,children:nt.jsx(Yy,{size:16})})]})]}):nt.jsxs(nt.Fragment,{children:[nt.jsx("div",{className:"flex-grow-1 text-start area-name-section",style:{minWidth:0},children:nt.jsx("span",{onClick:C,style:{width:"calc(100% - 10px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},title:t.name,children:t.name})}),nt.jsx("button",{className:"menu-btn menu-btn-cta",disabled:!n,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Selecionar área",onClick:w,children:nt.jsx(K5,{size:16})}),t.coordinates&&nt.jsx("button",{className:"menu-btn menu-btn-alert",onClick:T,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Limpar seleção",children:nt.jsx(B5,{size:16})}),nt.jsx("button",{className:"menu-btn menu-btn-warning area-delete",onClick:S,"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Excluir área",children:nt.jsx(t8,{size:14})})]})]}),nt.jsxs("div",{className:"d-flex align-items-center gap-2 px-2 pb-2 justify-content-between",children:[nt.jsx("div",{className:"flex-grow-1 me-2",children:nt.jsxs("select",{className:"form-select form-select-sm w-100",value:t.dataType||"",onChange:I=>p(t.id,I.target.value),children:[nt.jsx("option",{value:"default",children:"Tipo padrão"}),o8.filter(I=>I!=="default"&&(!l8.includes(I)||!e.find(M=>M.dataType===I&&M.id!==t.id))).map(I=>nt.jsx("option",{value:I,children:Lc[I]},I))]})}),nt.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Extrair textos com OCR",children:[nt.jsx("input",{className:"form-check-input",type:"checkbox",id:`ocr-${t.id}`,disabled:r!=="both",checked:t.ocr,onChange:I=>d(t.id,I.target.checked)}),nt.jsx("label",{className:"form-check-label small",children:"OCR"})]}),nt.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Pular páginas sem texto nesta área",children:[nt.jsx("input",{className:"form-check-input",type:"checkbox",id:`mandatory-${t.id}`,checked:t.isMandatory,onChange:I=>u(t.id,I.target.checked)}),nt.jsx("label",{className:"form-check-label small",children:"Obrig."})]}),nt.jsxs("div",{className:"form-check form-switch","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":e.find(I=>I.dataType==="hole_id")?"Usar um único valor por sondagem":"Adicione uma área como ID da Sondagem para utilizar essa opção",children:[nt.jsx("input",{className:"form-check-input",type:"checkbox",id:`repeat-${t.id}`,checked:t.repeatInPages,onChange:I=>f(t.id,I.target.checked),disabled:!e.find(I=>I.dataType==="hole_id")}),nt.jsx("label",{className:"form-check-label small",children:"Único"})]})]})]})})};var w_={exports:{}},E_,HS;function h8(){if(HS)return E_;HS=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return E_=n,E_}var A_,$S;function d8(){if($S)return A_;$S=1;var n=h8();function t(){}function e(){}return e.resetWarningCache=t,A_=function(){function r(a,l,u,f,d,p){if(p!==n){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}r.isRequired=r;function i(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:e,resetWarningCache:t};return s.PropTypes=s,s},A_}var GS;function p8(){return GS||(GS=1,w_.exports=d8()()),w_.exports}var m8=p8();const On=bf(m8);function Vc(n,t,e,r){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function l(d){try{f(r.next(d))}catch(p){a(p)}}function u(d){try{f(r.throw(d))}catch(p){a(p)}}function f(d){d.done?s(d.value):i(d.value).then(l,u)}f((r=r.apply(n,t||[])).next())})}const g8=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function mf(n,t,e){const r=v8(n),{webkitRelativePath:i}=n,s=typeof t=="string"?t:typeof i=="string"&&i.length>0?i:`./${n.name}`;return typeof r.path!="string"&&VS(r,"path",s),VS(r,"relativePath",s),r}function v8(n){const{name:t}=n;if(t&&t.lastIndexOf(".")!==-1&&!n.type){const r=t.split(".").pop().toLowerCase(),i=g8.get(r);i&&Object.defineProperty(n,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return n}function VS(n,t,e){Object.defineProperty(n,t,{value:e,writable:!1,configurable:!1,enumerable:!0})}const _8=[".DS_Store","Thumbs.db"];function x8(n){return Vc(this,void 0,void 0,function*(){return eg(n)&&y8(n.dataTransfer)?A8(n.dataTransfer,n.type):b8(n)?w8(n):Array.isArray(n)&&n.every(t=>"getFile"in t&&typeof t.getFile=="function")?E8(n):[]})}function y8(n){return eg(n)}function b8(n){return eg(n)&&eg(n.target)}function eg(n){return typeof n=="object"&&n!==null}function w8(n){return Ux(n.target.files).map(t=>mf(t))}function E8(n){return Vc(this,void 0,void 0,function*(){return(yield Promise.all(n.map(e=>e.getFile()))).map(e=>mf(e))})}function A8(n,t){return Vc(this,void 0,void 0,function*(){if(n.items){const e=Ux(n.items).filter(i=>i.kind==="file");if(t!=="drop")return e;const r=yield Promise.all(e.map(S8));return WS(hO(r))}return WS(Ux(n.files).map(e=>mf(e)))})}function WS(n){return n.filter(t=>_8.indexOf(t.name)===-1)}function Ux(n){if(n===null)return[];const t=[];for(let e=0;e<n.length;e++){const r=n[e];t.push(r)}return t}function S8(n){if(typeof n.webkitGetAsEntry!="function")return qS(n);const t=n.webkitGetAsEntry();return t&&t.isDirectory?dO(t):qS(n,t)}function hO(n){return n.reduce((t,e)=>[...t,...Array.isArray(e)?hO(e):[e]],[])}function qS(n,t){return Vc(this,void 0,void 0,function*(){var e;if(globalThis.isSecureContext&&typeof n.getAsFileSystemHandle=="function"){const s=yield n.getAsFileSystemHandle();if(s===null)throw new Error(`${n} is not a File`);if(s!==void 0){const a=yield s.getFile();return a.handle=s,mf(a)}}const r=n.getAsFile();if(!r)throw new Error(`${n} is not a File`);return mf(r,(e=t?.fullPath)!==null&&e!==void 0?e:void 0)})}function T8(n){return Vc(this,void 0,void 0,function*(){return n.isDirectory?dO(n):C8(n)})}function dO(n){const t=n.createReader();return new Promise((e,r)=>{const i=[];function s(){t.readEntries(a=>Vc(this,void 0,void 0,function*(){if(a.length){const l=Promise.all(a.map(T8));i.push(l),s()}else try{const l=yield Promise.all(i);e(l)}catch(l){r(l)}}),a=>{r(a)})}s()})}function C8(n){return Vc(this,void 0,void 0,function*(){return new Promise((t,e)=>{n.file(r=>{const i=mf(r,n.fullPath);t(i)},r=>{e(r)})})})}var gm={},YS;function D8(){return YS||(YS=1,gm.__esModule=!0,gm.default=function(n,t){if(n&&t){var e=Array.isArray(t)?t:t.split(",");if(e.length===0)return!0;var r=n.name||"",i=(n.type||"").toLowerCase(),s=i.replace(/\/.*$/,"");return e.some(function(a){var l=a.trim().toLowerCase();return l.charAt(0)==="."?r.toLowerCase().endsWith(l):l.endsWith("/*")?s===l.replace(/\/.*$/,""):i===l})}return!0}),gm}var O8=D8();const S_=bf(O8);function XS(n){return k8(n)||N8(n)||mO(n)||R8()}function R8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N8(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function k8(n){if(Array.isArray(n))return zx(n)}function KS(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,r)}return e}function ZS(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?KS(Object(e),!0).forEach(function(r){pO(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):KS(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function pO(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function Fd(n,t){return M8(n)||I8(n,t)||mO(n,t)||L8()}function L8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mO(n,t){if(n){if(typeof n=="string")return zx(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return zx(n,t)}}function zx(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function I8(n,t){var e=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(e!=null){var r=[],i=!0,s=!1,a,l;try{for(e=e.call(n);!(i=(a=e.next()).done)&&(r.push(a.value),!(t&&r.length===t));i=!0);}catch(u){s=!0,l=u}finally{try{!i&&e.return!=null&&e.return()}finally{if(s)throw l}}return r}}function M8(n){if(Array.isArray(n))return n}var P8=typeof S_=="function"?S_:S_.default,F8="file-invalid-type",B8="file-too-large",U8="file-too-small",z8="too-many-files",j8=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=t.split(","),r=e.length>1?"one of ".concat(e.join(", ")):e[0];return{code:F8,message:"File type must be ".concat(r)}},QS=function(t){return{code:B8,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},JS=function(t){return{code:U8,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},H8={code:z8,message:"Too many files"};function gO(n,t){var e=n.type==="application/x-moz-file"||P8(n,t);return[e,e?null:j8(t)]}function vO(n,t,e){if(vc(n.size))if(vc(t)&&vc(e)){if(n.size>e)return[!1,QS(e)];if(n.size<t)return[!1,JS(t)]}else{if(vc(t)&&n.size<t)return[!1,JS(t)];if(vc(e)&&n.size>e)return[!1,QS(e)]}return[!0,null]}function vc(n){return n!=null}function $8(n){var t=n.files,e=n.accept,r=n.minSize,i=n.maxSize,s=n.multiple,a=n.maxFiles,l=n.validator;return!s&&t.length>1||s&&a>=1&&t.length>a?!1:t.every(function(u){var f=gO(u,e),d=Fd(f,1),p=d[0],m=vO(u,r,i),v=Fd(m,1),x=v[0],_=l?l(u):null;return p&&x&&!_})}function ng(n){return typeof n.isPropagationStopped=="function"?n.isPropagationStopped():typeof n.cancelBubble<"u"?n.cancelBubble:!1}function vm(n){return n.dataTransfer?Array.prototype.some.call(n.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!n.target&&!!n.target.files}function t2(n){n.preventDefault()}function G8(n){return n.indexOf("MSIE")!==-1||n.indexOf("Trident/")!==-1}function V8(n){return n.indexOf("Edge/")!==-1}function W8(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return G8(n)||V8(n)}function Ia(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return t.some(function(l){return!ng(r)&&l&&l.apply(void 0,[r].concat(s)),ng(r)})}}function q8(){return"showOpenFilePicker"in window}function Y8(n){if(vc(n)){var t=Object.entries(n).filter(function(e){var r=Fd(e,2),i=r[0],s=r[1],a=!0;return _O(i)||(console.warn('Skipped "'.concat(i,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),a=!1),(!Array.isArray(s)||!s.every(xO))&&(console.warn('Skipped "'.concat(i,'" because an invalid file extension was provided.')),a=!1),a}).reduce(function(e,r){var i=Fd(r,2),s=i[0],a=i[1];return ZS(ZS({},e),{},pO({},s,a))},{});return[{description:"Files",accept:t}]}return n}function X8(n){if(vc(n))return Object.entries(n).reduce(function(t,e){var r=Fd(e,2),i=r[0],s=r[1];return[].concat(XS(t),[i],XS(s))},[]).filter(function(t){return _O(t)||xO(t)}).join(",")}function K8(n){return n instanceof DOMException&&(n.name==="AbortError"||n.code===n.ABORT_ERR)}function Z8(n){return n instanceof DOMException&&(n.name==="SecurityError"||n.code===n.SECURITY_ERR)}function _O(n){return n==="audio/*"||n==="video/*"||n==="image/*"||n==="text/*"||n==="application/*"||/\w+\/[-+.\w]+/g.test(n)}function xO(n){return/^.*\.[\w]+$/.test(n)}var Q8=["children"],J8=["open"],tB=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],eB=["refKey","onChange","onClick"];function nB(n){return sB(n)||iB(n)||yO(n)||rB()}function rB(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iB(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function sB(n){if(Array.isArray(n))return jx(n)}function T_(n,t){return lB(n)||oB(n,t)||yO(n,t)||aB()}function aB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yO(n,t){if(n){if(typeof n=="string")return jx(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if(e==="Object"&&n.constructor&&(e=n.constructor.name),e==="Map"||e==="Set")return Array.from(n);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return jx(n,t)}}function jx(n,t){(t==null||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}function oB(n,t){var e=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(e!=null){var r=[],i=!0,s=!1,a,l;try{for(e=e.call(n);!(i=(a=e.next()).done)&&(r.push(a.value),!(t&&r.length===t));i=!0);}catch(u){s=!0,l=u}finally{try{!i&&e.return!=null&&e.return()}finally{if(s)throw l}}return r}}function lB(n){if(Array.isArray(n))return n}function e2(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,r)}return e}function Gn(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?e2(Object(e),!0).forEach(function(r){Hx(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):e2(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function Hx(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function rg(n,t){if(n==null)return{};var e=cB(n,t),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(e[r]=n[r])}return e}function cB(n,t){if(n==null)return{};var e={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(t.indexOf(i)>=0)&&(e[i]=n[i]);return e}var Xy=_t.forwardRef(function(n,t){var e=n.children,r=rg(n,Q8),i=wO(r),s=i.open,a=rg(i,J8);return _t.useImperativeHandle(t,function(){return{open:s}},[s]),Yn.createElement(_t.Fragment,null,e(Gn(Gn({},a),{},{open:s})))});Xy.displayName="Dropzone";var bO={disabled:!1,getFilesFromEvent:x8,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Xy.defaultProps=bO;Xy.propTypes={children:On.func,accept:On.objectOf(On.arrayOf(On.string)),multiple:On.bool,preventDropOnDocument:On.bool,noClick:On.bool,noKeyboard:On.bool,noDrag:On.bool,noDragEventsBubbling:On.bool,minSize:On.number,maxSize:On.number,maxFiles:On.number,disabled:On.bool,getFilesFromEvent:On.func,onFileDialogCancel:On.func,onFileDialogOpen:On.func,useFsAccessApi:On.bool,autoFocus:On.bool,onDragEnter:On.func,onDragLeave:On.func,onDragOver:On.func,onDrop:On.func,onDropAccepted:On.func,onDropRejected:On.func,onError:On.func,validator:On.func};var $x={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function wO(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=Gn(Gn({},bO),n),e=t.accept,r=t.disabled,i=t.getFilesFromEvent,s=t.maxSize,a=t.minSize,l=t.multiple,u=t.maxFiles,f=t.onDragEnter,d=t.onDragLeave,p=t.onDragOver,m=t.onDrop,v=t.onDropAccepted,x=t.onDropRejected,_=t.onFileDialogCancel,y=t.onFileDialogOpen,w=t.useFsAccessApi,S=t.autoFocus,T=t.preventDropOnDocument,C=t.noClick,R=t.noKeyboard,N=t.noDrag,D=t.noDragEventsBubbling,I=t.onError,M=t.validator,B=_t.useMemo(function(){return X8(e)},[e]),H=_t.useMemo(function(){return Y8(e)},[e]),F=_t.useMemo(function(){return typeof y=="function"?y:n2},[y]),rt=_t.useMemo(function(){return typeof _=="function"?_:n2},[_]),L=_t.useRef(null),it=_t.useRef(null),Z=_t.useReducer(uB,$x),q=T_(Z,2),Ct=q[0],at=q[1],P=Ct.isFocused,V=Ct.isFileDialogActive,j=_t.useRef(typeof window<"u"&&window.isSecureContext&&w&&q8()),et=function(){!j.current&&V&&setTimeout(function(){if(it.current){var vt=it.current.files;vt.length||(at({type:"closeDialog"}),rt())}},300)};_t.useEffect(function(){return window.addEventListener("focus",et,!1),function(){window.removeEventListener("focus",et,!1)}},[it,V,rt,j]);var dt=_t.useRef([]),xt=function(vt){L.current&&L.current.contains(vt.target)||(vt.preventDefault(),dt.current=[])};_t.useEffect(function(){return T&&(document.addEventListener("dragover",t2,!1),document.addEventListener("drop",xt,!1)),function(){T&&(document.removeEventListener("dragover",t2),document.removeEventListener("drop",xt))}},[L,T]),_t.useEffect(function(){return!r&&S&&L.current&&L.current.focus(),function(){}},[L,S,r]);var Nt=_t.useCallback(function(Tt){I?I(Tt):console.error(Tt)},[I]),Rt=_t.useCallback(function(Tt){Tt.preventDefault(),Tt.persist(),Bt(Tt),dt.current=[].concat(nB(dt.current),[Tt.target]),vm(Tt)&&Promise.resolve(i(Tt)).then(function(vt){if(!(ng(Tt)&&!D)){var te=vt.length,ae=te>0&&$8({files:vt,accept:B,minSize:a,maxSize:s,multiple:l,maxFiles:u,validator:M}),ne=te>0&&!ae;at({isDragAccept:ae,isDragReject:ne,isDragActive:!0,type:"setDraggedFiles"}),f&&f(Tt)}}).catch(function(vt){return Nt(vt)})},[i,f,Nt,D,B,a,s,l,u,M]),z=_t.useCallback(function(Tt){Tt.preventDefault(),Tt.persist(),Bt(Tt);var vt=vm(Tt);if(vt&&Tt.dataTransfer)try{Tt.dataTransfer.dropEffect="copy"}catch{}return vt&&p&&p(Tt),!1},[p,D]),lt=_t.useCallback(function(Tt){Tt.preventDefault(),Tt.persist(),Bt(Tt);var vt=dt.current.filter(function(ae){return L.current&&L.current.contains(ae)}),te=vt.indexOf(Tt.target);te!==-1&&vt.splice(te,1),dt.current=vt,!(vt.length>0)&&(at({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),vm(Tt)&&d&&d(Tt))},[L,d,D]),J=_t.useCallback(function(Tt,vt){var te=[],ae=[];Tt.forEach(function(ne){var Re=gO(ne,B),rn=T_(Re,2),be=rn[0],ln=rn[1],Ve=vO(ne,a,s),zn=T_(Ve,2),Cn=zn[0],yn=zn[1],mr=M?M(ne):null;if(be&&Cn&&!mr)te.push(ne);else{var _s=[ln,yn];mr&&(_s=_s.concat(mr)),ae.push({file:ne,errors:_s.filter(function(Vs){return Vs})})}}),(!l&&te.length>1||l&&u>=1&&te.length>u)&&(te.forEach(function(ne){ae.push({file:ne,errors:[H8]})}),te.splice(0)),at({acceptedFiles:te,fileRejections:ae,isDragReject:ae.length>0,type:"setFiles"}),m&&m(te,ae,vt),ae.length>0&&x&&x(ae,vt),te.length>0&&v&&v(te,vt)},[at,l,B,a,s,u,m,v,x,M]),ot=_t.useCallback(function(Tt){Tt.preventDefault(),Tt.persist(),Bt(Tt),dt.current=[],vm(Tt)&&Promise.resolve(i(Tt)).then(function(vt){ng(Tt)&&!D||J(vt,Tt)}).catch(function(vt){return Nt(vt)}),at({type:"reset"})},[i,J,Nt,D]),yt=_t.useCallback(function(){if(j.current){at({type:"openDialog"}),F();var Tt={multiple:l,types:H};window.showOpenFilePicker(Tt).then(function(vt){return i(vt)}).then(function(vt){J(vt,null),at({type:"closeDialog"})}).catch(function(vt){K8(vt)?(rt(vt),at({type:"closeDialog"})):Z8(vt)?(j.current=!1,it.current?(it.current.value=null,it.current.click()):Nt(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):Nt(vt)});return}it.current&&(at({type:"openDialog"}),F(),it.current.value=null,it.current.click())},[at,F,rt,w,J,Nt,H,l]),At=_t.useCallback(function(Tt){!L.current||!L.current.isEqualNode(Tt.target)||(Tt.key===" "||Tt.key==="Enter"||Tt.keyCode===32||Tt.keyCode===13)&&(Tt.preventDefault(),yt())},[L,yt]),O=_t.useCallback(function(){at({type:"focus"})},[]),gt=_t.useCallback(function(){at({type:"blur"})},[]),ut=_t.useCallback(function(){C||(W8()?setTimeout(yt,0):yt())},[C,yt]),K=function(vt){return r?null:vt},X=function(vt){return R?null:K(vt)},pt=function(vt){return N?null:K(vt)},Bt=function(vt){D&&vt.stopPropagation()},Ht=_t.useMemo(function(){return function(){var Tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},vt=Tt.refKey,te=vt===void 0?"ref":vt,ae=Tt.role,ne=Tt.onKeyDown,Re=Tt.onFocus,rn=Tt.onBlur,be=Tt.onClick,ln=Tt.onDragEnter,Ve=Tt.onDragOver,zn=Tt.onDragLeave,Cn=Tt.onDrop,yn=rg(Tt,tB);return Gn(Gn(Hx({onKeyDown:X(Ia(ne,At)),onFocus:X(Ia(Re,O)),onBlur:X(Ia(rn,gt)),onClick:K(Ia(be,ut)),onDragEnter:pt(Ia(ln,Rt)),onDragOver:pt(Ia(Ve,z)),onDragLeave:pt(Ia(zn,lt)),onDrop:pt(Ia(Cn,ot)),role:typeof ae=="string"&&ae!==""?ae:"presentation"},te,L),!r&&!R?{tabIndex:0}:{}),yn)}},[L,At,O,gt,ut,Rt,z,lt,ot,R,N,r]),St=_t.useCallback(function(Tt){Tt.stopPropagation()},[]),It=_t.useMemo(function(){return function(){var Tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},vt=Tt.refKey,te=vt===void 0?"ref":vt,ae=Tt.onChange,ne=Tt.onClick,Re=rg(Tt,eB),rn=Hx({accept:B,multiple:l,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:K(Ia(ae,ot)),onClick:K(Ia(ne,St)),tabIndex:-1},te,it);return Gn(Gn({},rn),Re)}},[it,e,l,ot,r]);return Gn(Gn({},Ct),{},{isFocused:P&&!r,getRootProps:Ht,getInputProps:It,rootRef:L,inputRef:it,open:K(yt)})}function uB(n,t){switch(t.type){case"focus":return Gn(Gn({},n),{},{isFocused:!0});case"blur":return Gn(Gn({},n),{},{isFocused:!1});case"openDialog":return Gn(Gn({},$x),{},{isFileDialogActive:!0});case"closeDialog":return Gn(Gn({},n),{},{isFileDialogActive:!1});case"setDraggedFiles":return Gn(Gn({},n),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return Gn(Gn({},n),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case"reset":return Gn({},$x);default:return n}}function n2(){}const fB=100*1024*1024;function hB({onFileSelect:n}){const[t,e]=_t.useState(null),[r,i]=_t.useState(null),s=async T=>{if(T){const C=T[0],R=await l(C);if(!R.isValid){e({type:"error",message:`${R.error} - O arquivo pode estar corrompido ou não ser um PDF real.`});return}i(C),e({type:"success",message:`PDF "${C.name}" carregado com sucesso! (${(C.size/1024/1024).toFixed(2)} MB)`}),n(C)}};_t.useEffect(()=>{if(t?.type==="success"){const T=setTimeout(()=>{e(null)},5e3);return()=>clearTimeout(T)}},[t]);const a=()=>{e(null)},l=async T=>new Promise(C=>{const R=new FileReader;R.onload=N=>{if(!N.target?.result){C({isValid:!1,error:"Não foi possível ler o arquivo"});return}const D=new Uint8Array(N.target.result),M=[37,80,68,70,45].every((B,H)=>D[H]===B);C(M?{isValid:!0}:{isValid:!1,error:"Arquivo não é um PDF válido"})},R.onerror=()=>{C({isValid:!1,error:"Erro ao ler arquivo"})},R.readAsArrayBuffer(T.slice(0,5))}),u=T=>{if(T.length>0){const C=T[0],R=C.file,N=C.errors;N.some(D=>D.code==="file-invalid-type")?e({type:"error",message:`Arquivo "${R.name}" não é um PDF válido. Apenas arquivos PDF são permitidos!`}):N.some(D=>D.code==="file-too-large")?e({type:"error",message:`Arquivo "${R.name}" muito grande! Limite máximo: 100MB. Seu arquivo: ${(R.size/1024/1024).toFixed(1)}MB`}):N.some(D=>D.code==="too-many-files")?e({type:"error",message:"Apenas um arquivo por vez é permitido!"}):e({type:"error",message:`Erro ao carregar "${R.name}": ${N[0]?.message||"Arquivo inválido"}`})}},f={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"10px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},d={borderColor:"#2196f3"},p={borderColor:"#00e676"},m={borderColor:"#ff1744"},{getRootProps:v,getInputProps:x,isFocused:_,isDragAccept:y,isDragReject:w}=wO({accept:{"application/pdf":[".pdf"]},onDropAccepted:s,onDropRejected:u,maxFiles:1,maxSize:fB}),S=_t.useMemo(()=>({...f,..._?d:{},...y?p:{},...w?m:{}}),[_,y,w,r]);return nt.jsxs("div",{children:[t&&nt.jsxs("div",{className:`alert alert-${t.type==="success"?"success":"danger"} alert-dismissible fade show`,role:"alert",children:[nt.jsx("strong",{children:t.type==="success"?"Sucesso!":"Erro!"})," ",t.message,nt.jsx("button",{type:"button",className:"btn-close",onClick:a,"aria-label":"Close"})]}),nt.jsx("div",{className:"container",children:nt.jsxs("div",{...v({style:S}),children:[nt.jsx("input",{...x()}),r?nt.jsxs("div",{style:{color:"#4caf50",textAlign:"center"},children:[nt.jsx("p",{style:{margin:0,wordBreak:"break-all",wordWrap:"break-word",overflowWrap:"break-word",maxWidth:"100%",fontSize:14},children:nt.jsx("strong",{children:r.name})}),nt.jsx("p",{className:"m-0 small",children:"Clique ou arraste para trocar o arquivo"})]}):nt.jsx("p",{className:"m-0",children:"Arraste seu PDF aqui, ou clique para selecionar arquivos"})]})})]})}const r2="extrator-dados-pdf-presets",dB=({isOpen:n,onClose:t,currentAreas:e,onLoadPreset:r})=>{const[i,s]=_t.useState(""),[a,l]=_t.useState([]);_t.useEffect(()=>{u()},[]);const u=()=>{try{const _=localStorage.getItem(r2);if(_){const y=JSON.parse(_);l(y)}}catch(_){console.error("Erro ao carregar presets:",_)}},f=_=>{try{localStorage.setItem(r2,JSON.stringify(_))}catch(y){console.error("Erro ao salvar presets:",y)}},d=()=>{if(!i.trim())return;if(e.length<=0){alert("Não é possível salvar um preset sem áreas");return}const _={name:i.trim(),areas:e},y=[...a,_];l(y),f(y),s("")},p=_=>{confirm("Isso vai substituir todas as áreas atuais. Continuar?")&&(r(_.areas),t())},m=_=>{if(!confirm("Tem certeza que deseja excluir este preset?"))return;const y=a.filter((w,S)=>S!==_);l(y),f(y)},v=_=>{const y=JSON.stringify(_,null,2),w=new Blob([y],{type:"application/json"}),S=URL.createObjectURL(w),T=document.createElement("a");T.href=S,T.download=`${_.name}.json`,T.click(),URL.revokeObjectURL(S)},x=_=>{const y=_.target.files?.[0];if(!y)return;const w=new FileReader;w.onload=S=>{try{const T=S.target?.result,C=JSON.parse(T);if(!C.name||!Array.isArray(C.areas)){alert("Arquivo JSON inválido!");return}const R=[...a,C];l(R),f(R),_.target.value="",alert(`Preset "${C.name}" importado com sucesso!`)}catch(T){alert("Erro ao ler arquivo JSON!"),console.error(T)}},w.readAsText(y)};return n?nt.jsxs(nt.Fragment,{children:[nt.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50",style:{zIndex:1050},onClick:t}),nt.jsxs("div",{className:"position-fixed top-50 start-50 translate-middle bg-white rounded shadow-lg p-4",style:{zIndex:1051,width:"500px",maxHeight:"80vh",overflowY:"auto"},children:[nt.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[nt.jsx("h5",{className:"mb-0",children:"Gerenciar Presets"}),nt.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:t,children:nt.jsx(Yy,{size:16})})]}),nt.jsxs("div",{className:"mb-4 p-3 border rounded",children:[nt.jsx("h6",{children:"Salvar Preset Atual"}),nt.jsxs("div",{className:"d-flex gap-2",children:[nt.jsx("input",{type:"text",className:"form-control",placeholder:"Nome do preset...",value:i,onChange:_=>s(_.target.value),onKeyDown:_=>_.key==="Enter"&&d()}),nt.jsxs("button",{className:"btn btn-success",onClick:d,disabled:!i.trim()||e.length===0,children:[nt.jsx(Y5,{size:16,className:"me-1"}),"Salvar"]})]}),nt.jsx("small",{className:"text-muted",children:e.length===0?"Nenhuma área para salvar":e.length===1?"1 área será salva":`${e.length} áreas serão salvas`})]}),nt.jsxs("div",{className:"mb-4",children:[nt.jsx("h6",{children:"Presets Salvos"}),a.length===0?nt.jsx("p",{className:"text-muted",children:"Nenhum preset salvo ainda."}):a.map((_,y)=>nt.jsxs("div",{className:"d-flex justify-content-between align-items-center p-2 border rounded mb-2",children:[nt.jsxs("div",{children:[nt.jsx("strong",{children:_.name}),nt.jsx("br",{}),nt.jsxs("small",{className:"text-muted",children:[_.areas.length," área(s)"]})]}),nt.jsxs("div",{className:"d-flex gap-1",children:[nt.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>p(_),title:"Carregar preset",children:nt.jsx(G5,{size:14})}),nt.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>v(_),title:"Download JSON",children:nt.jsx(Bx,{size:14})}),nt.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>m(y),title:"Excluir preset",children:nt.jsx(Q5,{size:14})})]})]},y))]}),nt.jsxs("div",{className:"p-3 border rounded",children:[nt.jsx("h6",{children:"Importar Preset"}),nt.jsx("input",{type:"file",className:"form-control",accept:".json",onChange:_=>{x(_)}})]})]})]}):null};var Ky=lC();const pB=bf(Ky);function xi(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var mB=typeof Symbol=="function"&&Symbol.observable||"@@observable",i2=mB,s2=()=>Math.random().toString(36).substring(7).split("").join("."),gB={INIT:`@@redux/INIT${s2()}`,REPLACE:`@@redux/REPLACE${s2()}`},a2=gB;function vB(n){if(typeof n!="object"||n===null)return!1;let t=n;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(n)===t||Object.getPrototypeOf(n)===null}function EO(n,t,e){if(typeof n!="function")throw new Error(xi(2));if(typeof t=="function"&&typeof e=="function"||typeof e=="function"&&typeof arguments[3]=="function")throw new Error(xi(0));if(typeof t=="function"&&typeof e>"u"&&(e=t,t=void 0),typeof e<"u"){if(typeof e!="function")throw new Error(xi(1));return e(EO)(n,t)}let r=n,i=t,s=new Map,a=s,l=0,u=!1;function f(){a===s&&(a=new Map,s.forEach((y,w)=>{a.set(w,y)}))}function d(){if(u)throw new Error(xi(3));return i}function p(y){if(typeof y!="function")throw new Error(xi(4));if(u)throw new Error(xi(5));let w=!0;f();const S=l++;return a.set(S,y),function(){if(w){if(u)throw new Error(xi(6));w=!1,f(),a.delete(S),s=null}}}function m(y){if(!vB(y))throw new Error(xi(7));if(typeof y.type>"u")throw new Error(xi(8));if(typeof y.type!="string")throw new Error(xi(17));if(u)throw new Error(xi(9));try{u=!0,i=r(i,y)}finally{u=!1}return(s=a).forEach(S=>{S()}),y}function v(y){if(typeof y!="function")throw new Error(xi(10));r=y,m({type:a2.REPLACE})}function x(){const y=p;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(xi(11));function S(){const C=w;C.next&&C.next(d())}return S(),{unsubscribe:y(S)}},[i2](){return this}}}return m({type:a2.INIT}),{dispatch:m,subscribe:p,getState:d,replaceReducer:v,[i2]:x}}function o2(n,t){return function(...e){return t(n.apply(this,e))}}function l2(n,t){if(typeof n=="function")return o2(n,t);if(typeof n!="object"||n===null)throw new Error(xi(16));const e={};for(const r in n){const i=n[r];typeof i=="function"&&(e[r]=o2(i,t))}return e}function AO(...n){return n.length===0?t=>t:n.length===1?n[0]:n.reduce((t,e)=>(...r)=>t(e(...r)))}function _B(...n){return t=>(e,r)=>{const i=t(e,r);let s=()=>{throw new Error(xi(15))};const a={getState:i.getState,dispatch:(u,...f)=>s(u,...f)},l=n.map(u=>u(a));return s=AO(...l)(i.dispatch),{...i,dispatch:s}}}var C_={exports:{}},D_={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c2;function xB(){if(c2)return D_;c2=1;var n=Lg();function t(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var e=typeof Object.is=="function"?Object.is:t,r=n.useSyncExternalStore,i=n.useRef,s=n.useEffect,a=n.useMemo,l=n.useDebugValue;return D_.useSyncExternalStoreWithSelector=function(u,f,d,p,m){var v=i(null);if(v.current===null){var x={hasValue:!1,value:null};v.current=x}else x=v.current;v=a(function(){function y(R){if(!w){if(w=!0,S=R,R=p(R),m!==void 0&&x.hasValue){var N=x.value;if(m(N,R))return T=N}return T=R}if(N=T,e(S,R))return N;var D=p(R);return m!==void 0&&m(N,D)?(S=R,N):(S=R,T=D)}var w=!1,S,T,C=d===void 0?null:d;return[function(){return y(f())},C===null?void 0:function(){return y(C())}]},[f,d,p,m]);var _=r(u,v[0],v[1]);return s(function(){x.hasValue=!0,x.value=_},[_]),l(_),_},D_}var u2;function yB(){return u2||(u2=1,C_.exports=xB()),C_.exports}yB();var bB=_t.version.startsWith("19"),wB=Symbol.for(bB?"react.transitional.element":"react.element"),EB=Symbol.for("react.portal"),AB=Symbol.for("react.fragment"),SB=Symbol.for("react.strict_mode"),TB=Symbol.for("react.profiler"),CB=Symbol.for("react.consumer"),DB=Symbol.for("react.context"),SO=Symbol.for("react.forward_ref"),OB=Symbol.for("react.suspense"),RB=Symbol.for("react.suspense_list"),Zy=Symbol.for("react.memo"),NB=Symbol.for("react.lazy"),kB=SO,LB=Zy;function IB(n){if(typeof n=="object"&&n!==null){const{$$typeof:t}=n;switch(t){case wB:switch(n=n.type,n){case AB:case TB:case SB:case OB:case RB:return n;default:switch(n=n&&n.$$typeof,n){case DB:case SO:case NB:case Zy:return n;case CB:return n;default:return t}}case EB:return t}}}function MB(n){return IB(n)===Zy}function PB(n,t,e,r,{areStatesEqual:i,areOwnPropsEqual:s,areStatePropsEqual:a}){let l=!1,u,f,d,p,m;function v(S,T){return u=S,f=T,d=n(u,f),p=t(r,f),m=e(d,p,f),l=!0,m}function x(){return d=n(u,f),t.dependsOnOwnProps&&(p=t(r,f)),m=e(d,p,f),m}function _(){return n.dependsOnOwnProps&&(d=n(u,f)),t.dependsOnOwnProps&&(p=t(r,f)),m=e(d,p,f),m}function y(){const S=n(u,f),T=!a(S,d);return d=S,T&&(m=e(d,p,f)),m}function w(S,T){const C=!s(T,f),R=!i(S,u,T,f);return u=S,f=T,C&&R?x():C?_():R?y():m}return function(T,C){return l?w(T,C):v(T,C)}}function FB(n,{initMapStateToProps:t,initMapDispatchToProps:e,initMergeProps:r,...i}){const s=t(n,i),a=e(n,i),l=r(n,i);return PB(s,a,l,n,i)}function BB(n,t){const e={};for(const r in n){const i=n[r];typeof i=="function"&&(e[r]=(...s)=>t(i(...s)))}return e}function Gx(n){return function(e){const r=n(e);function i(){return r}return i.dependsOnOwnProps=!1,i}}function f2(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function TO(n,t){return function(r,{displayName:i}){const s=function(l,u){return s.dependsOnOwnProps?s.mapToProps(l,u):s.mapToProps(l,void 0)};return s.dependsOnOwnProps=!0,s.mapToProps=function(l,u){s.mapToProps=n,s.dependsOnOwnProps=f2(n);let f=s(l,u);return typeof f=="function"&&(s.mapToProps=f,s.dependsOnOwnProps=f2(f),f=s(l,u)),f},s}}function Qy(n,t){return(e,r)=>{throw new Error(`Invalid value of type ${typeof n} for ${t} argument when connecting component ${r.wrappedComponentName}.`)}}function UB(n){return n&&typeof n=="object"?Gx(t=>BB(n,t)):n?typeof n=="function"?TO(n):Qy(n,"mapDispatchToProps"):Gx(t=>({dispatch:t}))}function zB(n){return n?typeof n=="function"?TO(n):Qy(n,"mapStateToProps"):Gx(()=>({}))}function jB(n,t,e){return{...e,...n,...t}}function HB(n){return function(e,{displayName:r,areMergedPropsEqual:i}){let s=!1,a;return function(u,f,d){const p=n(u,f,d);return s?i(p,a)||(a=p):(s=!0,a=p),a}}}function $B(n){return n?typeof n=="function"?HB(n):Qy(n,"mergeProps"):()=>jB}function GB(n){n()}function VB(){let n=null,t=null;return{clear(){n=null,t=null},notify(){GB(()=>{let e=n;for(;e;)e.callback(),e=e.next})},get(){const e=[];let r=n;for(;r;)e.push(r),r=r.next;return e},subscribe(e){let r=!0;const i=t={callback:e,next:null,prev:t};return i.prev?i.prev.next=i:n=i,function(){!r||n===null||(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:n=i.next)}}}}var h2={notify(){},get:()=>[]};function CO(n,t){let e,r=h2,i=0,s=!1;function a(_){d();const y=r.subscribe(_);let w=!1;return()=>{w||(w=!0,y(),p())}}function l(){r.notify()}function u(){x.onStateChange&&x.onStateChange()}function f(){return s}function d(){i++,e||(e=t?t.addNestedSub(u):n.subscribe(u),r=VB())}function p(){i--,e&&i===0&&(e(),e=void 0,r.clear(),r=h2)}function m(){s||(s=!0,d())}function v(){s&&(s=!1,p())}const x={addNestedSub:a,notifyNestedSubs:l,handleChangeWrapper:u,isSubscribed:f,trySubscribe:m,tryUnsubscribe:v,getListeners:()=>r};return x}var WB=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",qB=WB(),YB=()=>typeof navigator<"u"&&navigator.product==="ReactNative",XB=YB(),KB=()=>qB||XB?_t.useLayoutEffect:_t.useEffect,ig=KB();function d2(n,t){return n===t?n!==0||t!==0||1/n===1/t:n!==n&&t!==t}function O_(n,t){if(d2(n,t))return!0;if(typeof n!="object"||n===null||typeof t!="object"||t===null)return!1;const e=Object.keys(n),r=Object.keys(t);if(e.length!==r.length)return!1;for(let i=0;i<e.length;i++)if(!Object.prototype.hasOwnProperty.call(t,e[i])||!d2(n[e[i]],t[e[i]]))return!1;return!0}var ZB={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},QB={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},JB={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},DO={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},tU={[kB]:JB,[LB]:DO};function p2(n){return MB(n)?DO:tU[n.$$typeof]||ZB}var eU=Object.defineProperty,nU=Object.getOwnPropertyNames,m2=Object.getOwnPropertySymbols,rU=Object.getOwnPropertyDescriptor,iU=Object.getPrototypeOf,g2=Object.prototype;function Vx(n,t){if(typeof t!="string"){if(g2){const s=iU(t);s&&s!==g2&&Vx(n,s)}let e=nU(t);m2&&(e=e.concat(m2(t)));const r=p2(n),i=p2(t);for(let s=0;s<e.length;++s){const a=e[s];if(!QB[a]&&!(i&&i[a])&&!(r&&r[a])){const l=rU(t,a);try{eU(n,a,l)}catch{}}}}return n}var sU=Symbol.for("react-redux-context"),aU=typeof globalThis<"u"?globalThis:{};function oU(){if(!_t.createContext)return{};const n=aU[sU]??=new Map;let t=n.get(_t.createContext);return t||(t=_t.createContext(null),n.set(_t.createContext,t)),t}var OO=oU(),lU=[null,null];function cU(n,t,e){ig(()=>n(...t),e)}function uU(n,t,e,r,i,s){n.current=r,e.current=!1,i.current&&(i.current=null,s())}function fU(n,t,e,r,i,s,a,l,u,f,d){if(!n)return()=>{};let p=!1,m=null;const v=()=>{if(p||!l.current)return;const _=t.getState();let y,w;try{y=r(_,i.current)}catch(S){w=S,m=S}w||(m=null),y===s.current?a.current||f():(s.current=y,u.current=y,a.current=!0,d())};return e.onStateChange=v,e.trySubscribe(),v(),()=>{if(p=!0,e.tryUnsubscribe(),e.onStateChange=null,m)throw m}}function hU(n,t){return n===t}function dU(n,t,e,{pure:r,areStatesEqual:i=hU,areOwnPropsEqual:s=O_,areStatePropsEqual:a=O_,areMergedPropsEqual:l=O_,forwardRef:u=!1,context:f=OO}={}){const d=f,p=zB(n),m=UB(t),v=$B(e),x=!!n;return y=>{const w=y.displayName||y.name||"Component",S=`Connect(${w})`,T={shouldHandleStateChanges:x,displayName:S,wrappedComponentName:w,WrappedComponent:y,initMapStateToProps:p,initMapDispatchToProps:m,initMergeProps:v,areStatesEqual:i,areStatePropsEqual:a,areOwnPropsEqual:s,areMergedPropsEqual:l};function C(D){const[I,M,B]=_t.useMemo(()=>{const{reactReduxForwardedRef:yt,...At}=D;return[D.context,yt,At]},[D]),H=_t.useMemo(()=>{let yt=d;return I?.Consumer,yt},[I,d]),F=_t.useContext(H),rt=!!D.store&&!!D.store.getState&&!!D.store.dispatch,L=!!F&&!!F.store,it=rt?D.store:F.store,Z=L?F.getServerState:it.getState,q=_t.useMemo(()=>FB(it.dispatch,T),[it]),[Ct,at]=_t.useMemo(()=>{if(!x)return lU;const yt=CO(it,rt?void 0:F.subscription),At=yt.notifyNestedSubs.bind(yt);return[yt,At]},[it,rt,F]),P=_t.useMemo(()=>rt?F:{...F,subscription:Ct},[rt,F,Ct]),V=_t.useRef(void 0),j=_t.useRef(B),et=_t.useRef(void 0),dt=_t.useRef(!1),xt=_t.useRef(!1),Nt=_t.useRef(void 0);ig(()=>(xt.current=!0,()=>{xt.current=!1}),[]);const Rt=_t.useMemo(()=>()=>et.current&&B===j.current?et.current:q(it.getState(),B),[it,B]),z=_t.useMemo(()=>At=>Ct?fU(x,it,Ct,q,j,V,dt,xt,et,at,At):()=>{},[Ct]);cU(uU,[j,V,dt,B,et,at]);let lt;try{lt=_t.useSyncExternalStore(z,Rt,Z?()=>q(Z(),B):Rt)}catch(yt){throw Nt.current&&(yt.message+=`
The error may be correlated with this previous error:
${Nt.current.stack}

`),yt}ig(()=>{Nt.current=void 0,et.current=void 0,V.current=lt});const J=_t.useMemo(()=>_t.createElement(y,{...lt,ref:M}),[M,y,lt]);return _t.useMemo(()=>x?_t.createElement(H.Provider,{value:P},J):J,[H,J,P])}const N=_t.memo(C);if(N.WrappedComponent=y,N.displayName=C.displayName=S,u){const I=_t.forwardRef(function(B,H){return _t.createElement(N,{...B,reactReduxForwardedRef:H})});return I.displayName=S,I.WrappedComponent=y,Vx(I,y)}return Vx(N,y)}}var RO=dU;function pU(n){const{children:t,context:e,serverState:r,store:i}=n,s=_t.useMemo(()=>{const u=CO(i);return{store:i,subscription:u,getServerState:r?()=>r:void 0}},[i,r]),a=_t.useMemo(()=>i.getState(),[i]);ig(()=>{const{subscription:u}=s;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),a!==i.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[s,a]);const l=e||OO;return _t.createElement(l.Provider,{value:s},t)}var mU=pU,aa=function(t){var e=t.top,r=t.right,i=t.bottom,s=t.left,a=r-s,l=i-e,u={top:e,right:r,bottom:i,left:s,width:a,height:l,x:s,y:e,center:{x:(r+s)/2,y:(i+e)/2}};return u},Jy=function(t,e){return{top:t.top-e.top,left:t.left-e.left,bottom:t.bottom+e.bottom,right:t.right+e.right}},v2=function(t,e){return{top:t.top+e.top,left:t.left+e.left,bottom:t.bottom-e.bottom,right:t.right-e.right}},gU=function(t,e){return{top:t.top+e.y,left:t.left+e.x,bottom:t.bottom+e.y,right:t.right+e.x}},R_={top:0,right:0,bottom:0,left:0},tb=function(t){var e=t.borderBox,r=t.margin,i=r===void 0?R_:r,s=t.border,a=s===void 0?R_:s,l=t.padding,u=l===void 0?R_:l,f=aa(Jy(e,i)),d=aa(v2(e,a)),p=aa(v2(d,u));return{marginBox:f,borderBox:aa(e),paddingBox:d,contentBox:p,margin:i,border:a,padding:u}},Ns=function(t){var e=t.slice(0,-2),r=t.slice(-2);if(r!=="px")return 0;var i=Number(e);return isNaN(i)&&An(!1),i},vU=function(){return{x:window.pageXOffset,y:window.pageYOffset}},sg=function(t,e){var r=t.borderBox,i=t.border,s=t.margin,a=t.padding,l=gU(r,e);return tb({borderBox:l,border:i,margin:s,padding:a})},ag=function(t,e){return e===void 0&&(e=vU()),sg(t,e)},NO=function(t,e){var r={top:Ns(e.marginTop),right:Ns(e.marginRight),bottom:Ns(e.marginBottom),left:Ns(e.marginLeft)},i={top:Ns(e.paddingTop),right:Ns(e.paddingRight),bottom:Ns(e.paddingBottom),left:Ns(e.paddingLeft)},s={top:Ns(e.borderTopWidth),right:Ns(e.borderRightWidth),bottom:Ns(e.borderBottomWidth),left:Ns(e.borderLeftWidth)};return tb({borderBox:t,margin:r,padding:i,border:s})},kO=function(t){var e=t.getBoundingClientRect(),r=window.getComputedStyle(t);return NO(e,r)},Bd=function(t){var e=[],r=null,i=function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];e=l,!r&&(r=requestAnimationFrame(function(){r=null,t.apply(void 0,e)}))};return i.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},i};function og(){return og=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)({}).hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},og.apply(null,arguments)}function LO(n,t){}LO.bind(null,"warn");LO.bind(null,"error");function Tl(){}function _U(n,t){return{...n,...t}}function Ps(n,t,e){const r=t.map(i=>{const s=_U(e,i.options);return n.addEventListener(i.eventName,i.fn,s),function(){n.removeEventListener(i.eventName,i.fn,s)}});return function(){r.forEach(s=>{s()})}}const xU="Invariant failed";class lg extends Error{}lg.prototype.toString=function(){return this.message};function oe(n,t){throw new lg(xU)}class yU extends Yn.Component{constructor(...t){super(...t),this.callbacks=null,this.unbind=Tl,this.onWindowError=e=>{const r=this.getCallbacks();r.isDragging()&&r.tryAbort(),e.error instanceof lg&&e.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=e=>{this.callbacks=e}}componentDidMount(){this.unbind=Ps(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(t){if(t instanceof lg){this.setState({});return}throw t}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const bU=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,cg=n=>n+1,wU=n=>`
  You have lifted an item in position ${cg(n.source.index)}
`,IO=(n,t)=>{const e=n.droppableId===t.droppableId,r=cg(n.index),i=cg(t.index);return e?`
      You have moved the item from position ${r}
      to position ${i}
    `:`
    You have moved the item from position ${r}
    in list ${n.droppableId}
    to list ${t.droppableId}
    in position ${i}
  `},MO=(n,t,e)=>t.droppableId===e.droppableId?`
      The item ${n}
      has been combined with ${e.draggableId}`:`
      The item ${n}
      in list ${t.droppableId}
      has been combined with ${e.draggableId}
      in list ${e.droppableId}
    `,EU=n=>{const t=n.destination;if(t)return IO(n.source,t);const e=n.combine;return e?MO(n.draggableId,n.source,e):"You are over an area that cannot be dropped on"},_2=n=>`
  The item has returned to its starting position
  of ${cg(n.index)}
`,AU=n=>{if(n.reason==="CANCEL")return`
      Movement cancelled.
      ${_2(n.source)}
    `;const t=n.destination,e=n.combine;return t?`
      You have dropped the item.
      ${IO(n.source,t)}
    `:e?`
      You have dropped the item.
      ${MO(n.draggableId,n.source,e)}
    `:`
    The item has been dropped while not over a drop area.
    ${_2(n.source)}
  `},Wm={dragHandleUsageInstructions:bU,onDragStart:wU,onDragUpdate:EU,onDragEnd:AU};function SU(n,t){return!!(n===t||Number.isNaN(n)&&Number.isNaN(t))}function PO(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!SU(n[e],t[e]))return!1;return!0}function nn(n,t){const e=_t.useState(()=>({inputs:t,result:n()}))[0],r=_t.useRef(!0),i=_t.useRef(e),a=r.current||!!(t&&i.current.inputs&&PO(t,i.current.inputs))?i.current:{inputs:t,result:n()};return _t.useEffect(()=>{r.current=!1,i.current=a},[a]),a.result}function xe(n,t){return nn(()=>n,t)}const Nr={x:0,y:0},jr=(n,t)=>({x:n.x+t.x,y:n.y+t.y}),us=(n,t)=>({x:n.x-t.x,y:n.y-t.y}),Cl=(n,t)=>n.x===t.x&&n.y===t.y,Cf=n=>({x:n.x!==0?-n.x:0,y:n.y!==0?-n.y:0}),Ic=(n,t,e=0)=>n==="x"?{x:t,y:e}:{x:e,y:t},Ud=(n,t)=>Math.sqrt((t.x-n.x)**2+(t.y-n.y)**2),x2=(n,t)=>Math.min(...t.map(e=>Ud(n,e))),FO=n=>t=>({x:n(t.x),y:n(t.y)});var TU=(n,t)=>{const e=aa({top:Math.max(t.top,n.top),right:Math.min(t.right,n.right),bottom:Math.min(t.bottom,n.bottom),left:Math.max(t.left,n.left)});return e.width<=0||e.height<=0?null:e};const mp=(n,t)=>({top:n.top+t.y,left:n.left+t.x,bottom:n.bottom+t.y,right:n.right+t.x}),y2=n=>[{x:n.left,y:n.top},{x:n.right,y:n.top},{x:n.left,y:n.bottom},{x:n.right,y:n.bottom}],CU={top:0,right:0,bottom:0,left:0},DU=(n,t)=>t?mp(n,t.scroll.diff.displacement):n,OU=(n,t,e)=>e&&e.increasedBy?{...n,[t.end]:n[t.end]+e.increasedBy[t.line]}:n,RU=(n,t)=>t&&t.shouldClipSubject?TU(t.pageMarginBox,n):aa(n);var gf=({page:n,withPlaceholder:t,axis:e,frame:r})=>{const i=DU(n.marginBox,r),s=OU(i,e,t),a=RU(s,r);return{page:n,withPlaceholder:t,active:a}},eb=(n,t)=>{n.frame||oe();const e=n.frame,r=us(t,e.scroll.initial),i=Cf(r),s={...e,scroll:{initial:e.scroll.initial,current:t,diff:{value:r,displacement:i},max:e.scroll.max}},a=gf({page:n.subject.page,withPlaceholder:n.subject.withPlaceholder,axis:n.axis,frame:s});return{...n,frame:s,subject:a}};function Rr(n,t=PO){let e=null;function r(...i){if(e&&e.lastThis===this&&t(i,e.lastArgs))return e.lastResult;const s=n.apply(this,i);return e={lastResult:s,lastArgs:i,lastThis:this},s}return r.clear=function(){e=null},r}const BO=Rr(n=>n.reduce((t,e)=>(t[e.descriptor.id]=e,t),{})),UO=Rr(n=>n.reduce((t,e)=>(t[e.descriptor.id]=e,t),{})),Jg=Rr(n=>Object.values(n)),NU=Rr(n=>Object.values(n));var Df=Rr((n,t)=>NU(t).filter(r=>n===r.descriptor.droppableId).sort((r,i)=>r.descriptor.index-i.descriptor.index));function nb(n){return n.at&&n.at.type==="REORDER"?n.at.destination:null}function tv(n){return n.at&&n.at.type==="COMBINE"?n.at.combine:null}var ev=Rr((n,t)=>t.filter(e=>e.descriptor.id!==n.descriptor.id)),kU=({isMovingForward:n,draggable:t,destination:e,insideDestination:r,previousImpact:i})=>{if(!e.isCombineEnabled||!nb(i))return null;function a(v){const x={type:"COMBINE",combine:{draggableId:v,droppableId:e.descriptor.id}};return{...i,at:x}}const l=i.displaced.all,u=l.length?l[0]:null;if(n)return u?a(u):null;const f=ev(t,r);if(!u){if(!f.length)return null;const v=f[f.length-1];return a(v.descriptor.id)}const d=f.findIndex(v=>v.descriptor.id===u);d===-1&&oe();const p=d-1;if(p<0)return null;const m=f[p];return a(m.descriptor.id)},Of=(n,t)=>n.descriptor.droppableId===t.descriptor.id;const zO={point:Nr,value:0},zd={invisible:{},visible:{},all:[]},LU={displaced:zd,displacedBy:zO,at:null};var Bs=(n,t)=>e=>n<=e&&e<=t,jO=n=>{const t=Bs(n.top,n.bottom),e=Bs(n.left,n.right);return r=>{if(t(r.top)&&t(r.bottom)&&e(r.left)&&e(r.right))return!0;const s=t(r.top)||t(r.bottom),a=e(r.left)||e(r.right);if(s&&a)return!0;const u=r.top<n.top&&r.bottom>n.bottom,f=r.left<n.left&&r.right>n.right;return u&&f?!0:u&&a||f&&s}},IU=n=>{const t=Bs(n.top,n.bottom),e=Bs(n.left,n.right);return r=>t(r.top)&&t(r.bottom)&&e(r.left)&&e(r.right)};const rb={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},HO={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var MU=n=>t=>{const e=Bs(t.top,t.bottom),r=Bs(t.left,t.right);return i=>n===rb?e(i.top)&&e(i.bottom):r(i.left)&&r(i.right)};const PU=(n,t)=>{const e=t.frame?t.frame.scroll.diff.displacement:Nr;return mp(n,e)},FU=(n,t,e)=>t.subject.active?e(t.subject.active)(n):!1,BU=(n,t,e)=>e(t)(n),ib=({target:n,destination:t,viewport:e,withDroppableDisplacement:r,isVisibleThroughFrameFn:i})=>{const s=r?PU(n,t):n;return FU(s,t,i)&&BU(s,e,i)},UU=n=>ib({...n,isVisibleThroughFrameFn:jO}),$O=n=>ib({...n,isVisibleThroughFrameFn:IU}),zU=n=>ib({...n,isVisibleThroughFrameFn:MU(n.destination.axis)}),jU=(n,t,e)=>{if(typeof e=="boolean")return e;if(!t)return!0;const{invisible:r,visible:i}=t;if(r[n])return!1;const s=i[n];return s?s.shouldAnimate:!0};function HU(n,t){const e=n.page.marginBox,r={top:t.point.y,right:0,bottom:0,left:t.point.x};return aa(Jy(e,r))}function jd({afterDragging:n,destination:t,displacedBy:e,viewport:r,forceShouldAnimate:i,last:s}){return n.reduce(function(l,u){const f=HU(u,e),d=u.descriptor.id;if(l.all.push(d),!UU({target:f,destination:t,viewport:r,withDroppableDisplacement:!0}))return l.invisible[u.descriptor.id]=!0,l;const m=jU(d,s,i),v={draggableId:d,shouldAnimate:m};return l.visible[d]=v,l},{all:[],visible:{},invisible:{}})}function $U(n,t){if(!n.length)return 0;const e=n[n.length-1].descriptor.index;return t.inHomeList?e:e+1}function b2({insideDestination:n,inHomeList:t,displacedBy:e,destination:r}){const i=$U(n,{inHomeList:t});return{displaced:zd,displacedBy:e,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:i}}}}function ug({draggable:n,insideDestination:t,destination:e,viewport:r,displacedBy:i,last:s,index:a,forceShouldAnimate:l}){const u=Of(n,e);if(a==null)return b2({insideDestination:t,inHomeList:u,displacedBy:i,destination:e});const f=t.find(x=>x.descriptor.index===a);if(!f)return b2({insideDestination:t,inHomeList:u,displacedBy:i,destination:e});const d=ev(n,t),p=t.indexOf(f),m=d.slice(p);return{displaced:jd({afterDragging:m,destination:e,displacedBy:i,last:s,viewport:r.frame,forceShouldAnimate:l}),displacedBy:i,at:{type:"REORDER",destination:{droppableId:e.descriptor.id,index:a}}}}function kl(n,t){return!!t.effected[n]}var GU=({isMovingForward:n,destination:t,draggables:e,combine:r,afterCritical:i})=>{if(!t.isCombineEnabled)return null;const s=r.draggableId,l=e[s].descriptor.index;return kl(s,i)?n?l:l-1:n?l+1:l},VU=({isMovingForward:n,isInHomeList:t,insideDestination:e,location:r})=>{if(!e.length)return null;const i=r.index,s=n?i+1:i-1,a=e[0].descriptor.index,l=e[e.length-1].descriptor.index,u=t?l:l+1;return s<a||s>u?null:s},WU=({isMovingForward:n,isInHomeList:t,draggable:e,draggables:r,destination:i,insideDestination:s,previousImpact:a,viewport:l,afterCritical:u})=>{const f=a.at;if(f||oe(),f.type==="REORDER"){const p=VU({isMovingForward:n,isInHomeList:t,location:f.destination,insideDestination:s});return p==null?null:ug({draggable:e,insideDestination:s,destination:i,viewport:l,last:a.displaced,displacedBy:a.displacedBy,index:p})}const d=GU({isMovingForward:n,destination:i,displaced:a.displaced,draggables:r,combine:f.combine,afterCritical:u});return d==null?null:ug({draggable:e,insideDestination:s,destination:i,viewport:l,last:a.displaced,displacedBy:a.displacedBy,index:d})},qU=({displaced:n,afterCritical:t,combineWith:e,displacedBy:r})=>{const i=!!(n.visible[e]||n.invisible[e]);return kl(e,t)?i?Nr:Cf(r.point):i?r.point:Nr},YU=({afterCritical:n,impact:t,draggables:e})=>{const r=tv(t);r||oe();const i=r.draggableId,s=e[i].page.borderBox.center,a=qU({displaced:t.displaced,afterCritical:n,combineWith:i,displacedBy:t.displacedBy});return jr(s,a)};const GO=(n,t)=>t.margin[n.start]+t.borderBox[n.size]/2,XU=(n,t)=>t.margin[n.end]+t.borderBox[n.size]/2,sb=(n,t,e)=>t[n.crossAxisStart]+e.margin[n.crossAxisStart]+e.borderBox[n.crossAxisSize]/2,w2=({axis:n,moveRelativeTo:t,isMoving:e})=>Ic(n.line,t.marginBox[n.end]+GO(n,e),sb(n,t.marginBox,e)),E2=({axis:n,moveRelativeTo:t,isMoving:e})=>Ic(n.line,t.marginBox[n.start]-XU(n,e),sb(n,t.marginBox,e)),KU=({axis:n,moveInto:t,isMoving:e})=>Ic(n.line,t.contentBox[n.start]+GO(n,e),sb(n,t.contentBox,e));var ZU=({impact:n,draggable:t,draggables:e,droppable:r,afterCritical:i})=>{const s=Df(r.descriptor.id,e),a=t.page,l=r.axis;if(!s.length)return KU({axis:l,moveInto:r.page,isMoving:a});const{displaced:u,displacedBy:f}=n,d=u.all[0];if(d){const m=e[d];if(kl(d,i))return E2({axis:l,moveRelativeTo:m.page,isMoving:a});const v=sg(m.page,f.point);return E2({axis:l,moveRelativeTo:v,isMoving:a})}const p=s[s.length-1];if(p.descriptor.id===t.descriptor.id)return a.borderBox.center;if(kl(p.descriptor.id,i)){const m=sg(p.page,Cf(i.displacedBy.point));return w2({axis:l,moveRelativeTo:m,isMoving:a})}return w2({axis:l,moveRelativeTo:p.page,isMoving:a})},Wx=(n,t)=>{const e=n.frame;return e?jr(t,e.scroll.diff.displacement):t};const QU=({impact:n,draggable:t,droppable:e,draggables:r,afterCritical:i})=>{const s=t.page.borderBox.center,a=n.at;return!e||!a?s:a.type==="REORDER"?ZU({impact:n,draggable:t,draggables:r,droppable:e,afterCritical:i}):YU({impact:n,draggables:r,afterCritical:i})};var nv=n=>{const t=QU(n),e=n.droppable;return e?Wx(e,t):t},VO=(n,t)=>{const e=us(t,n.scroll.initial),r=Cf(e);return{frame:aa({top:t.y,bottom:t.y+n.frame.height,left:t.x,right:t.x+n.frame.width}),scroll:{initial:n.scroll.initial,max:n.scroll.max,current:t,diff:{value:e,displacement:r}}}};function A2(n,t){return n.map(e=>t[e])}function JU(n,t){for(let e=0;e<t.length;e++){const r=t[e].visible[n];if(r)return r}return null}var tz=({impact:n,viewport:t,destination:e,draggables:r,maxScrollChange:i})=>{const s=VO(t,jr(t.scroll.current,i)),a=e.frame?eb(e,jr(e.frame.scroll.current,i)):e,l=n.displaced,u=jd({afterDragging:A2(l.all,r),destination:e,displacedBy:n.displacedBy,viewport:s.frame,last:l,forceShouldAnimate:!1}),f=jd({afterDragging:A2(l.all,r),destination:a,displacedBy:n.displacedBy,viewport:t.frame,last:l,forceShouldAnimate:!1}),d={},p={},m=[l,u,f];return l.all.forEach(x=>{const _=JU(x,m);if(_){p[x]=_;return}d[x]=!0}),{...n,displaced:{all:l.all,invisible:d,visible:p}}},ez=(n,t)=>jr(n.scroll.diff.displacement,t),ab=({pageBorderBoxCenter:n,draggable:t,viewport:e})=>{const r=ez(e,n),i=us(r,t.page.borderBox.center);return jr(t.client.borderBox.center,i)},WO=({draggable:n,destination:t,newPageBorderBoxCenter:e,viewport:r,withDroppableDisplacement:i,onlyOnMainAxis:s=!1})=>{const a=us(e,n.page.borderBox.center),u={target:mp(n.page.borderBox,a),destination:t,withDroppableDisplacement:i,viewport:r};return s?zU(u):$O(u)},nz=({isMovingForward:n,draggable:t,destination:e,draggables:r,previousImpact:i,viewport:s,previousPageBorderBoxCenter:a,previousClientSelection:l,afterCritical:u})=>{if(!e.isEnabled)return null;const f=Df(e.descriptor.id,r),d=Of(t,e),p=kU({isMovingForward:n,draggable:t,destination:e,insideDestination:f,previousImpact:i})||WU({isMovingForward:n,isInHomeList:d,draggable:t,draggables:r,destination:e,insideDestination:f,previousImpact:i,viewport:s,afterCritical:u});if(!p)return null;const m=nv({impact:p,draggable:t,droppable:e,draggables:r,afterCritical:u});if(WO({draggable:t,destination:e,newPageBorderBoxCenter:m,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:ab({pageBorderBoxCenter:m,draggable:t,viewport:s}),impact:p,scrollJumpRequest:null};const x=us(m,a),_=tz({impact:p,viewport:s,destination:e,draggables:r,maxScrollChange:x});return{clientSelection:l,impact:_,scrollJumpRequest:x}};const _i=n=>{const t=n.subject.active;return t||oe(),t};var rz=({isMovingForward:n,pageBorderBoxCenter:t,source:e,droppables:r,viewport:i})=>{const s=e.subject.active;if(!s)return null;const a=e.axis,l=Bs(s[a.start],s[a.end]),u=Jg(r).filter(d=>d!==e).filter(d=>d.isEnabled).filter(d=>!!d.subject.active).filter(d=>jO(i.frame)(_i(d))).filter(d=>{const p=_i(d);return n?s[a.crossAxisEnd]<p[a.crossAxisEnd]:p[a.crossAxisStart]<s[a.crossAxisStart]}).filter(d=>{const p=_i(d),m=Bs(p[a.start],p[a.end]);return l(p[a.start])||l(p[a.end])||m(s[a.start])||m(s[a.end])}).sort((d,p)=>{const m=_i(d)[a.crossAxisStart],v=_i(p)[a.crossAxisStart];return n?m-v:v-m}).filter((d,p,m)=>_i(d)[a.crossAxisStart]===_i(m[0])[a.crossAxisStart]);if(!u.length)return null;if(u.length===1)return u[0];const f=u.filter(d=>Bs(_i(d)[a.start],_i(d)[a.end])(t[a.line]));return f.length===1?f[0]:f.length>1?f.sort((d,p)=>_i(d)[a.start]-_i(p)[a.start])[0]:u.sort((d,p)=>{const m=x2(t,y2(_i(d))),v=x2(t,y2(_i(p)));return m!==v?m-v:_i(d)[a.start]-_i(p)[a.start]})[0]};const S2=(n,t)=>{const e=n.page.borderBox.center;return kl(n.descriptor.id,t)?us(e,t.displacedBy.point):e},iz=(n,t)=>{const e=n.page.borderBox;return kl(n.descriptor.id,t)?mp(e,Cf(t.displacedBy.point)):e};var sz=({pageBorderBoxCenter:n,viewport:t,destination:e,insideDestination:r,afterCritical:i})=>r.filter(a=>$O({target:iz(a,i),destination:e,viewport:t.frame,withDroppableDisplacement:!0})).sort((a,l)=>{const u=Ud(n,Wx(e,S2(a,i))),f=Ud(n,Wx(e,S2(l,i)));return u<f?-1:f<u?1:a.descriptor.index-l.descriptor.index})[0]||null,gp=Rr(function(t,e){const r=e[t.line];return{value:r,point:Ic(t.line,r)}});const az=(n,t,e)=>{const r=n.axis;if(n.descriptor.mode==="virtual")return Ic(r.line,t[r.line]);const i=n.subject.page.contentBox[r.size],u=Df(n.descriptor.id,e).reduce((f,d)=>f+d.client.marginBox[r.size],0)+t[r.line]-i;return u<=0?null:Ic(r.line,u)},qO=(n,t)=>({...n,scroll:{...n.scroll,max:t}}),YO=(n,t,e)=>{const r=n.frame;Of(t,n)&&oe(),n.subject.withPlaceholder&&oe();const i=gp(n.axis,t.displaceBy).point,s=az(n,i,e),a={placeholderSize:i,increasedBy:s,oldFrameMaxScroll:n.frame?n.frame.scroll.max:null};if(!r){const d=gf({page:n.subject.page,withPlaceholder:a,axis:n.axis,frame:n.frame});return{...n,subject:d}}const l=s?jr(r.scroll.max,s):r.scroll.max,u=qO(r,l),f=gf({page:n.subject.page,withPlaceholder:a,axis:n.axis,frame:u});return{...n,subject:f,frame:u}},oz=n=>{const t=n.subject.withPlaceholder;t||oe();const e=n.frame;if(!e){const a=gf({page:n.subject.page,axis:n.axis,frame:null,withPlaceholder:null});return{...n,subject:a}}const r=t.oldFrameMaxScroll;r||oe();const i=qO(e,r),s=gf({page:n.subject.page,axis:n.axis,frame:i,withPlaceholder:null});return{...n,subject:s,frame:i}};var lz=({previousPageBorderBoxCenter:n,moveRelativeTo:t,insideDestination:e,draggable:r,draggables:i,destination:s,viewport:a,afterCritical:l})=>{if(!t){if(e.length)return null;const p={displaced:zd,displacedBy:zO,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:0}}},m=nv({impact:p,draggable:r,droppable:s,draggables:i,afterCritical:l}),v=Of(r,s)?s:YO(s,r,i);return WO({draggable:r,destination:v,newPageBorderBoxCenter:m,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?p:null}const u=n[s.axis.line]<=t.page.borderBox.center[s.axis.line],f=(()=>{const p=t.descriptor.index;return t.descriptor.id===r.descriptor.id||u?p:p+1})(),d=gp(s.axis,r.displaceBy);return ug({draggable:r,insideDestination:e,destination:s,viewport:a,displacedBy:d,last:zd,index:f})},cz=({isMovingForward:n,previousPageBorderBoxCenter:t,draggable:e,isOver:r,draggables:i,droppables:s,viewport:a,afterCritical:l})=>{const u=rz({isMovingForward:n,pageBorderBoxCenter:t,source:r,droppables:s,viewport:a});if(!u)return null;const f=Df(u.descriptor.id,i),d=sz({pageBorderBoxCenter:t,viewport:a,destination:u,insideDestination:f,afterCritical:l}),p=lz({previousPageBorderBoxCenter:t,destination:u,draggable:e,draggables:i,moveRelativeTo:d,insideDestination:f,viewport:a,afterCritical:l});if(!p)return null;const m=nv({impact:p,draggable:e,droppable:u,draggables:i,afterCritical:l});return{clientSelection:ab({pageBorderBoxCenter:m,draggable:e,viewport:a}),impact:p,scrollJumpRequest:null}},ds=n=>{const t=n.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null};const uz=(n,t)=>{const e=ds(n);return e?t[e]:null};var fz=({state:n,type:t})=>{const e=uz(n.impact,n.dimensions.droppables),r=!!e,i=n.dimensions.droppables[n.critical.droppable.id],s=e||i,a=s.axis.direction,l=a==="vertical"&&(t==="MOVE_UP"||t==="MOVE_DOWN")||a==="horizontal"&&(t==="MOVE_LEFT"||t==="MOVE_RIGHT");if(l&&!r)return null;const u=t==="MOVE_DOWN"||t==="MOVE_RIGHT",f=n.dimensions.draggables[n.critical.draggable.id],d=n.current.page.borderBoxCenter,{draggables:p,droppables:m}=n.dimensions;return l?nz({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:f,destination:s,draggables:p,viewport:n.viewport,previousClientSelection:n.current.client.selection,previousImpact:n.impact,afterCritical:n.afterCritical}):cz({isMovingForward:u,previousPageBorderBoxCenter:d,draggable:f,isOver:s,draggables:p,droppables:m,viewport:n.viewport,afterCritical:n.afterCritical})};function mc(n){return n.phase==="DRAGGING"||n.phase==="COLLECTING"}function XO(n){const t=Bs(n.top,n.bottom),e=Bs(n.left,n.right);return function(i){return t(i.y)&&e(i.x)}}function hz(n,t){return n.left<t.right&&n.right>t.left&&n.top<t.bottom&&n.bottom>t.top}function dz({pageBorderBox:n,draggable:t,candidates:e}){const r=t.page.borderBox.center,i=e.map(s=>{const a=s.axis,l=Ic(s.axis.line,n.center[a.line],s.page.borderBox.center[a.crossAxisLine]);return{id:s.descriptor.id,distance:Ud(r,l)}}).sort((s,a)=>a.distance-s.distance);return i[0]?i[0].id:null}function pz({pageBorderBox:n,draggable:t,droppables:e}){const r=Jg(e).filter(i=>{if(!i.isEnabled)return!1;const s=i.subject.active;if(!s||!hz(n,s))return!1;if(XO(s)(n.center))return!0;const a=i.axis,l=s.center[a.crossAxisLine],u=n[a.crossAxisStart],f=n[a.crossAxisEnd],d=Bs(s[a.crossAxisStart],s[a.crossAxisEnd]),p=d(u),m=d(f);return!p&&!m?!0:p?u<l:f>l});return r.length?r.length===1?r[0].descriptor.id:dz({pageBorderBox:n,draggable:t,candidates:r}):null}const KO=(n,t)=>aa(mp(n,t));var mz=(n,t)=>{const e=n.frame;return e?KO(t,e.scroll.diff.value):t};function ZO({displaced:n,id:t}){return!!(n.visible[t]||n.invisible[t])}function gz({draggable:n,closest:t,inHomeList:e}){return t?e&&t.descriptor.index>n.descriptor.index?t.descriptor.index-1:t.descriptor.index:null}var vz=({pageBorderBoxWithDroppableScroll:n,draggable:t,destination:e,insideDestination:r,last:i,viewport:s,afterCritical:a})=>{const l=e.axis,u=gp(e.axis,t.displaceBy),f=u.value,d=n[l.start],p=n[l.end],v=ev(t,r).find(_=>{const y=_.descriptor.id,w=_.page.borderBox.center[l.line],S=kl(y,a),T=ZO({displaced:i,id:y});return S?T?p<=w:d<w-f:T?p<=w+f:d<w})||null,x=gz({draggable:t,closest:v,inHomeList:Of(t,e)});return ug({draggable:t,insideDestination:r,destination:e,viewport:s,last:i,displacedBy:u,index:x})};const _z=4;var xz=({draggable:n,pageBorderBoxWithDroppableScroll:t,previousImpact:e,destination:r,insideDestination:i,afterCritical:s})=>{if(!r.isCombineEnabled)return null;const a=r.axis,l=gp(r.axis,n.displaceBy),u=l.value,f=t[a.start],d=t[a.end],m=ev(n,i).find(x=>{const _=x.descriptor.id,y=x.page.borderBox,S=y[a.size]/_z,T=kl(_,s),C=ZO({displaced:e.displaced,id:_});return T?C?d>y[a.start]+S&&d<y[a.end]-S:f>y[a.start]-u+S&&f<y[a.end]-u-S:C?d>y[a.start]+u+S&&d<y[a.end]+u-S:f>y[a.start]+S&&f<y[a.end]-S});return m?{displacedBy:l,displaced:e.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:r.descriptor.id}}}:null},QO=({pageOffset:n,draggable:t,draggables:e,droppables:r,previousImpact:i,viewport:s,afterCritical:a})=>{const l=KO(t.page.borderBox,n),u=pz({pageBorderBox:l,draggable:t,droppables:r});if(!u)return LU;const f=r[u],d=Df(f.descriptor.id,e),p=mz(f,l);return xz({pageBorderBoxWithDroppableScroll:p,draggable:t,previousImpact:i,destination:f,insideDestination:d,afterCritical:a})||vz({pageBorderBoxWithDroppableScroll:p,draggable:t,destination:f,insideDestination:d,last:i.displaced,viewport:s,afterCritical:a})},ob=(n,t)=>({...n,[t.descriptor.id]:t});const yz=({previousImpact:n,impact:t,droppables:e})=>{const r=ds(n),i=ds(t);if(!r||r===i)return e;const s=e[r];if(!s.subject.withPlaceholder)return e;const a=oz(s);return ob(e,a)};var bz=({draggable:n,draggables:t,droppables:e,previousImpact:r,impact:i})=>{const s=yz({previousImpact:r,impact:i,droppables:e}),a=ds(i);if(!a)return s;const l=e[a];if(Of(n,l)||l.subject.withPlaceholder)return s;const u=YO(l,n,t);return ob(s,u)},Ad=({state:n,clientSelection:t,dimensions:e,viewport:r,impact:i,scrollJumpRequest:s})=>{const a=r||n.viewport,l=e||n.dimensions,u=t||n.current.client.selection,f=us(u,n.initial.client.selection),d={offset:f,selection:u,borderBoxCenter:jr(n.initial.client.borderBoxCenter,f)},p={selection:jr(d.selection,a.scroll.current),borderBoxCenter:jr(d.borderBoxCenter,a.scroll.current),offset:jr(d.offset,a.scroll.diff.value)},m={client:d,page:p};if(n.phase==="COLLECTING")return{...n,dimensions:l,viewport:a,current:m};const v=l.draggables[n.critical.draggable.id],x=i||QO({pageOffset:p.offset,draggable:v,draggables:l.draggables,droppables:l.droppables,previousImpact:n.impact,viewport:a,afterCritical:n.afterCritical}),_=bz({draggable:v,impact:x,previousImpact:n.impact,draggables:l.draggables,droppables:l.droppables});return{...n,current:m,dimensions:{draggables:l.draggables,droppables:_},impact:x,viewport:a,scrollJumpRequest:s||null,forceShouldAnimate:s?!1:null}};function wz(n,t){return n.map(e=>t[e])}var JO=({impact:n,viewport:t,draggables:e,destination:r,forceShouldAnimate:i})=>{const s=n.displaced,a=wz(s.all,e),l=jd({afterDragging:a,destination:r,displacedBy:n.displacedBy,viewport:t.frame,forceShouldAnimate:i,last:s});return{...n,displaced:l}},tR=({impact:n,draggable:t,droppable:e,draggables:r,viewport:i,afterCritical:s})=>{const a=nv({impact:n,draggable:t,draggables:r,droppable:e,afterCritical:s});return ab({pageBorderBoxCenter:a,draggable:t,viewport:i})},eR=({state:n,dimensions:t,viewport:e})=>{n.movementMode!=="SNAP"&&oe();const r=n.impact,i=e||n.viewport,s=t||n.dimensions,{draggables:a,droppables:l}=s,u=a[n.critical.draggable.id],f=ds(r);f||oe();const d=l[f],p=JO({impact:r,viewport:i,destination:d,draggables:a}),m=tR({impact:p,draggable:u,droppable:d,draggables:a,viewport:i,afterCritical:n.afterCritical});return Ad({impact:p,clientSelection:m,state:n,dimensions:s,viewport:i})},Ez=n=>({index:n.index,droppableId:n.droppableId}),nR=({draggable:n,home:t,draggables:e,viewport:r})=>{const i=gp(t.axis,n.displaceBy),s=Df(t.descriptor.id,e),a=s.indexOf(n);a===-1&&oe();const l=s.slice(a+1),u=l.reduce((m,v)=>(m[v.descriptor.id]=!0,m),{}),f={inVirtualList:t.descriptor.mode==="virtual",displacedBy:i,effected:u};return{impact:{displaced:jd({afterDragging:l,destination:t,displacedBy:i,last:null,viewport:r.frame,forceShouldAnimate:!1}),displacedBy:i,at:{type:"REORDER",destination:Ez(n.descriptor)}},afterCritical:f}},Az=(n,t)=>({draggables:n.draggables,droppables:ob(n.droppables,t)}),Sz=({draggable:n,offset:t,initialWindowScroll:e})=>{const r=sg(n.client,t),i=ag(r,e);return{...n,placeholder:{...n.placeholder,client:r},client:r,page:i}},Tz=n=>{const t=n.frame;return t||oe(),t},Cz=({additions:n,updatedDroppables:t,viewport:e})=>{const r=e.scroll.diff.value;return n.map(i=>{const s=i.descriptor.droppableId,a=t[s],u=Tz(a).scroll.diff.value,f=jr(r,u);return Sz({draggable:i,offset:f,initialWindowScroll:e.scroll.initial})})},Dz=({state:n,published:t})=>{const e=t.modified.map(w=>{const S=n.dimensions.droppables[w.droppableId];return eb(S,w.scroll)}),r={...n.dimensions.droppables,...BO(e)},i=UO(Cz({additions:t.additions,updatedDroppables:r,viewport:n.viewport})),s={...n.dimensions.draggables,...i};t.removals.forEach(w=>{delete s[w]});const a={droppables:r,draggables:s},l=ds(n.impact),u=l?a.droppables[l]:null,f=a.draggables[n.critical.draggable.id],d=a.droppables[n.critical.droppable.id],{impact:p,afterCritical:m}=nR({draggable:f,home:d,draggables:s,viewport:n.viewport}),v=u&&u.isCombineEnabled?n.impact:p,x=QO({pageOffset:n.current.page.offset,draggable:a.draggables[n.critical.draggable.id],draggables:a.draggables,droppables:a.droppables,previousImpact:v,viewport:n.viewport,afterCritical:m}),_={...n,phase:"DRAGGING",impact:x,onLiftImpact:p,dimensions:a,afterCritical:m,forceShouldAnimate:!1};return n.phase==="COLLECTING"?_:{..._,phase:"DROP_PENDING",reason:n.reason,isWaiting:!1}};const qx=n=>n.movementMode==="SNAP",N_=(n,t,e)=>{const r=Az(n.dimensions,t);return!qx(n)||e?Ad({state:n,dimensions:r}):eR({state:n,dimensions:r})};function k_(n){return n.isDragging&&n.movementMode==="SNAP"?{...n,scrollJumpRequest:null}:n}const T2={phase:"IDLE",completed:null,shouldFlush:!1};var Oz=(n=T2,t)=>{if(t.type==="FLUSH")return{...T2,shouldFlush:!0};if(t.type==="INITIAL_PUBLISH"){n.phase!=="IDLE"&&oe();const{critical:e,clientSelection:r,viewport:i,dimensions:s,movementMode:a}=t.payload,l=s.draggables[e.draggable.id],u=s.droppables[e.droppable.id],f={selection:r,borderBoxCenter:l.client.borderBox.center,offset:Nr},d={client:f,page:{selection:jr(f.selection,i.scroll.initial),borderBoxCenter:jr(f.selection,i.scroll.initial),offset:jr(f.selection,i.scroll.diff.value)}},p=Jg(s.droppables).every(_=>!_.isFixedOnPage),{impact:m,afterCritical:v}=nR({draggable:l,home:u,draggables:s.draggables,viewport:i});return{phase:"DRAGGING",isDragging:!0,critical:e,movementMode:a,dimensions:s,initial:d,current:d,isWindowScrollAllowed:p,impact:m,afterCritical:v,onLiftImpact:m,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null}}if(t.type==="COLLECTION_STARTING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"?n:(n.phase!=="DRAGGING"&&oe(),{...n,phase:"COLLECTING"});if(t.type==="PUBLISH_WHILE_DRAGGING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"||oe(),Dz({state:n,published:t.payload});if(t.type==="MOVE"){if(n.phase==="DROP_PENDING")return n;mc(n)||oe();const{client:e}=t.payload;return Cl(e,n.current.client.selection)?n:Ad({state:n,clientSelection:e,impact:qx(n)?n.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="COLLECTING")return k_(n);mc(n)||oe();const{id:e,newScroll:r}=t.payload,i=n.dimensions.droppables[e];if(!i)return n;const s=eb(i,r);return N_(n,s,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(n.phase==="DROP_PENDING")return n;mc(n)||oe();const{id:e,isEnabled:r}=t.payload,i=n.dimensions.droppables[e];i||oe(),i.isEnabled===r&&oe();const s={...i,isEnabled:r};return N_(n,s,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(n.phase==="DROP_PENDING")return n;mc(n)||oe();const{id:e,isCombineEnabled:r}=t.payload,i=n.dimensions.droppables[e];i||oe(),i.isCombineEnabled===r&&oe();const s={...i,isCombineEnabled:r};return N_(n,s,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="DROP_ANIMATING")return n;mc(n)||oe(),n.isWindowScrollAllowed||oe();const e=t.payload.newScroll;if(Cl(n.viewport.scroll.current,e))return k_(n);const r=VO(n.viewport,e);return qx(n)?eR({state:n,viewport:r}):Ad({state:n,viewport:r})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!mc(n))return n;const e=t.payload.maxScroll;if(Cl(e,n.viewport.scroll.max))return n;const r={...n.viewport,scroll:{...n.viewport.scroll,max:e}};return{...n,viewport:r}}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(n.phase==="COLLECTING"||n.phase==="DROP_PENDING")return n;n.phase!=="DRAGGING"&&oe();const e=fz({state:n,type:t.type});return e?Ad({state:n,impact:e.impact,clientSelection:e.clientSelection,scrollJumpRequest:e.scrollJumpRequest}):n}if(t.type==="DROP_PENDING"){const e=t.payload.reason;return n.phase!=="COLLECTING"&&oe(),{...n,phase:"DROP_PENDING",isWaiting:!0,reason:e}}if(t.type==="DROP_ANIMATE"){const{completed:e,dropDuration:r,newHomeClientOffset:i}=t.payload;return n.phase==="DRAGGING"||n.phase==="DROP_PENDING"||oe(),{phase:"DROP_ANIMATING",completed:e,dropDuration:r,newHomeClientOffset:i,dimensions:n.dimensions}}if(t.type==="DROP_COMPLETE"){const{completed:e}=t.payload;return{phase:"IDLE",completed:e,shouldFlush:!1}}return n};function hn(n,t){return n instanceof Object&&"type"in n&&n.type===t}const Rz=n=>({type:"BEFORE_INITIAL_CAPTURE",payload:n}),Nz=n=>({type:"LIFT",payload:n}),kz=n=>({type:"INITIAL_PUBLISH",payload:n}),Lz=n=>({type:"PUBLISH_WHILE_DRAGGING",payload:n}),Iz=()=>({type:"COLLECTION_STARTING",payload:null}),Mz=n=>({type:"UPDATE_DROPPABLE_SCROLL",payload:n}),Pz=n=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:n}),Fz=n=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:n}),rR=n=>({type:"MOVE",payload:n}),Bz=n=>({type:"MOVE_BY_WINDOW_SCROLL",payload:n}),Uz=n=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:n}),zz=()=>({type:"MOVE_UP",payload:null}),jz=()=>({type:"MOVE_DOWN",payload:null}),Hz=()=>({type:"MOVE_RIGHT",payload:null}),$z=()=>({type:"MOVE_LEFT",payload:null}),lb=()=>({type:"FLUSH",payload:null}),Gz=n=>({type:"DROP_ANIMATE",payload:n}),cb=n=>({type:"DROP_COMPLETE",payload:n}),iR=n=>({type:"DROP",payload:n}),Vz=n=>({type:"DROP_PENDING",payload:n}),sR=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var Wz=n=>({getState:t,dispatch:e})=>r=>i=>{if(!hn(i,"LIFT")){r(i);return}const{id:s,clientSelection:a,movementMode:l}=i.payload,u=t();u.phase==="DROP_ANIMATING"&&e(cb({completed:u.completed})),t().phase!=="IDLE"&&oe(),e(lb()),e(Rz({draggableId:s,movementMode:l}));const d={draggableId:s,scrollOptions:{shouldPublishImmediately:l==="SNAP"}},{critical:p,dimensions:m,viewport:v}=n.startPublishing(d);e(kz({critical:p,dimensions:m,clientSelection:a,movementMode:l,viewport:v}))},qz=n=>()=>t=>e=>{hn(e,"INITIAL_PUBLISH")&&n.dragging(),hn(e,"DROP_ANIMATE")&&n.dropping(e.payload.completed.result.reason),(hn(e,"FLUSH")||hn(e,"DROP_COMPLETE"))&&n.resting(),t(e)};const ub={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},Hd={opacity:{drop:0,combining:.7},scale:{drop:.75}},aR={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},dc=`${aR.outOfTheWay}s ${ub.outOfTheWay}`,Sd={fluid:`opacity ${dc}`,snap:`transform ${dc}, opacity ${dc}`,drop:n=>{const t=`${n}s ${ub.drop}`;return`transform ${t}, opacity ${t}`},outOfTheWay:`transform ${dc}`,placeholder:`height ${dc}, width ${dc}, margin ${dc}`},C2=n=>Cl(n,Nr)?void 0:`translate(${n.x}px, ${n.y}px)`,Yx={moveTo:C2,drop:(n,t)=>{const e=C2(n);if(e)return t?`${e} scale(${Hd.scale.drop})`:e}},{minDropTime:Xx,maxDropTime:oR}=aR,Yz=oR-Xx,D2=1500,Xz=.6;var Kz=({current:n,destination:t,reason:e})=>{const r=Ud(n,t);if(r<=0)return Xx;if(r>=D2)return oR;const i=r/D2,s=Xx+Yz*i,a=e==="CANCEL"?s*Xz:s;return Number(a.toFixed(2))},Zz=({impact:n,draggable:t,dimensions:e,viewport:r,afterCritical:i})=>{const{draggables:s,droppables:a}=e,l=ds(n),u=l?a[l]:null,f=a[t.descriptor.droppableId],d=tR({impact:n,draggable:t,draggables:s,afterCritical:i,droppable:u||f,viewport:r});return us(d,t.client.borderBox.center)},Qz=({draggables:n,reason:t,lastImpact:e,home:r,viewport:i,onLiftImpact:s})=>!e.at||t!=="DROP"?{impact:JO({draggables:n,impact:s,destination:r,viewport:i,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:e.at.type==="REORDER"?{impact:e,didDropInsideDroppable:!0}:{impact:{...e,displaced:zd},didDropInsideDroppable:!0};const Jz=({getState:n,dispatch:t})=>e=>r=>{if(!hn(r,"DROP")){e(r);return}const i=n(),s=r.payload.reason;if(i.phase==="COLLECTING"){t(Vz({reason:s}));return}if(i.phase==="IDLE")return;i.phase==="DROP_PENDING"&&i.isWaiting&&oe(),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||oe();const l=i.critical,u=i.dimensions,f=u.draggables[i.critical.draggable.id],{impact:d,didDropInsideDroppable:p}=Qz({reason:s,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),m=p?nb(d):null,v=p?tv(d):null,x={index:l.draggable.index,droppableId:l.droppable.id},_={draggableId:f.descriptor.id,type:f.descriptor.type,source:x,reason:s,mode:i.movementMode,destination:m,combine:v},y=Zz({impact:d,draggable:f,dimensions:u,viewport:i.viewport,afterCritical:i.afterCritical}),w={critical:i.critical,afterCritical:i.afterCritical,result:_,impact:d};if(!(!Cl(i.current.client.offset,y)||!!_.combine)){t(cb({completed:w}));return}const T=Kz({current:i.current.client.offset,destination:y,reason:s});t(Gz({newHomeClientOffset:y,dropDuration:T,completed:w}))};var lR=()=>({x:window.pageXOffset,y:window.pageYOffset});function tj(n){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:t=>{t.target!==window&&t.target!==window.document||n()}}}function ej({onWindowScroll:n}){function t(){n(lR())}const e=Bd(t),r=tj(e);let i=Tl;function s(){return i!==Tl}function a(){s()&&oe(),i=Ps(window,[r])}function l(){s()||oe(),e.cancel(),i(),i=Tl}return{start:a,stop:l,isActive:s}}const nj=n=>hn(n,"DROP_COMPLETE")||hn(n,"DROP_ANIMATE")||hn(n,"FLUSH"),rj=n=>{const t=ej({onWindowScroll:e=>{n.dispatch(Bz({newScroll:e}))}});return e=>r=>{!t.isActive()&&hn(r,"INITIAL_PUBLISH")&&t.start(),t.isActive()&&nj(r)&&t.stop(),e(r)}};var ij=n=>{let t=!1,e=!1;const r=setTimeout(()=>{e=!0}),i=s=>{t||e||(t=!0,n(s),clearTimeout(r))};return i.wasCalled=()=>t,i},sj=()=>{const n=[],t=i=>{const s=n.findIndex(l=>l.timerId===i);s===-1&&oe();const[a]=n.splice(s,1);a.callback()};return{add:i=>{const s=setTimeout(()=>t(s)),a={timerId:s,callback:i};n.push(a)},flush:()=>{if(!n.length)return;const i=[...n];n.length=0,i.forEach(s=>{clearTimeout(s.timerId),s.callback()})}}};const aj=(n,t)=>n==null&&t==null?!0:n==null||t==null?!1:n.droppableId===t.droppableId&&n.index===t.index,oj=(n,t)=>n==null&&t==null?!0:n==null||t==null?!1:n.draggableId===t.draggableId&&n.droppableId===t.droppableId,lj=(n,t)=>{if(n===t)return!0;const e=n.draggable.id===t.draggable.id&&n.draggable.droppableId===t.draggable.droppableId&&n.draggable.type===t.draggable.type&&n.draggable.index===t.draggable.index,r=n.droppable.id===t.droppable.id&&n.droppable.type===t.droppable.type;return e&&r},od=(n,t)=>{t()},_m=(n,t)=>({draggableId:n.draggable.id,type:n.droppable.type,source:{droppableId:n.droppable.id,index:n.draggable.index},mode:t});function L_(n,t,e,r){if(!n){e(r(t));return}const i=ij(e);n(t,{announce:i}),i.wasCalled()||e(r(t))}var cj=(n,t)=>{const e=sj();let r=null;const i=(p,m)=>{r&&oe(),od("onBeforeCapture",()=>{const v=n().onBeforeCapture;v&&v({draggableId:p,mode:m})})},s=(p,m)=>{r&&oe(),od("onBeforeDragStart",()=>{const v=n().onBeforeDragStart;v&&v(_m(p,m))})},a=(p,m)=>{r&&oe();const v=_m(p,m);r={mode:m,lastCritical:p,lastLocation:v.source,lastCombine:null},e.add(()=>{od("onDragStart",()=>L_(n().onDragStart,v,t,Wm.onDragStart))})},l=(p,m)=>{const v=nb(m),x=tv(m);r||oe();const _=!lj(p,r.lastCritical);_&&(r.lastCritical=p);const y=!aj(r.lastLocation,v);y&&(r.lastLocation=v);const w=!oj(r.lastCombine,x);if(w&&(r.lastCombine=x),!_&&!y&&!w)return;const S={..._m(p,r.mode),combine:x,destination:v};e.add(()=>{od("onDragUpdate",()=>L_(n().onDragUpdate,S,t,Wm.onDragUpdate))})},u=()=>{r||oe(),e.flush()},f=p=>{r||oe(),r=null,od("onDragEnd",()=>L_(n().onDragEnd,p,t,Wm.onDragEnd))};return{beforeCapture:i,beforeStart:s,start:a,update:l,flush:u,drop:f,abort:()=>{if(!r)return;const p={..._m(r.lastCritical,r.mode),combine:null,destination:null,reason:"CANCEL"};f(p)}}},uj=(n,t)=>{const e=cj(n,t);return r=>i=>s=>{if(hn(s,"BEFORE_INITIAL_CAPTURE")){e.beforeCapture(s.payload.draggableId,s.payload.movementMode);return}if(hn(s,"INITIAL_PUBLISH")){const l=s.payload.critical;e.beforeStart(l,s.payload.movementMode),i(s),e.start(l,s.payload.movementMode);return}if(hn(s,"DROP_COMPLETE")){const l=s.payload.completed.result;e.flush(),i(s),e.drop(l);return}if(i(s),hn(s,"FLUSH")){e.abort();return}const a=r.getState();a.phase==="DRAGGING"&&e.update(a.critical,a.impact)}};const fj=n=>t=>e=>{if(!hn(e,"DROP_ANIMATION_FINISHED")){t(e);return}const r=n.getState();r.phase!=="DROP_ANIMATING"&&oe(),n.dispatch(cb({completed:r.completed}))},hj=n=>{let t=null,e=null;function r(){e&&(cancelAnimationFrame(e),e=null),t&&(t(),t=null)}return i=>s=>{if((hn(s,"FLUSH")||hn(s,"DROP_COMPLETE")||hn(s,"DROP_ANIMATION_FINISHED"))&&r(),i(s),!hn(s,"DROP_ANIMATE"))return;const a={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){n.getState().phase==="DROP_ANIMATING"&&n.dispatch(sR())}};e=requestAnimationFrame(()=>{e=null,t=Ps(window,[a])})}};var dj=n=>()=>t=>e=>{(hn(e,"DROP_COMPLETE")||hn(e,"FLUSH")||hn(e,"DROP_ANIMATE"))&&n.stopPublishing(),t(e)},pj=n=>{let t=!1;return()=>e=>r=>{if(hn(r,"INITIAL_PUBLISH")){t=!0,n.tryRecordFocus(r.payload.critical.draggable.id),e(r),n.tryRestoreFocusRecorded();return}if(e(r),!!t){if(hn(r,"FLUSH")){t=!1,n.tryRestoreFocusRecorded();return}if(hn(r,"DROP_COMPLETE")){t=!1;const i=r.payload.completed.result;i.combine&&n.tryShiftRecord(i.draggableId,i.combine.draggableId),n.tryRestoreFocusRecorded()}}}};const mj=n=>hn(n,"DROP_COMPLETE")||hn(n,"DROP_ANIMATE")||hn(n,"FLUSH");var gj=n=>t=>e=>r=>{if(mj(r)){n.stop(),e(r);return}if(hn(r,"INITIAL_PUBLISH")){e(r);const i=t.getState();i.phase!=="DRAGGING"&&oe(),n.start(i);return}e(r),n.scroll(t.getState())};const vj=n=>t=>e=>{if(t(e),!hn(e,"PUBLISH_WHILE_DRAGGING"))return;const r=n.getState();r.phase==="DROP_PENDING"&&(r.isWaiting||n.dispatch(iR({reason:r.reason})))},_j=AO;var xj=({dimensionMarshal:n,focusMarshal:t,styleMarshal:e,getResponders:r,announce:i,autoScroller:s})=>EO(Oz,_j(_B(qz(e),dj(n),Wz(n),Jz,fj,hj,vj,gj(s),rj,pj(t),uj(r,i))));const I_=()=>({additions:{},removals:{},modified:{}});function yj({registry:n,callbacks:t}){let e=I_(),r=null;const i=()=>{r||(t.collectionStarting(),r=requestAnimationFrame(()=>{r=null;const{additions:u,removals:f,modified:d}=e,p=Object.keys(u).map(x=>n.draggable.getById(x).getDimension(Nr)).sort((x,_)=>x.descriptor.index-_.descriptor.index),m=Object.keys(d).map(x=>{const y=n.droppable.getById(x).callbacks.getScrollWhileDragging();return{droppableId:x,scroll:y}}),v={additions:p,removals:Object.keys(f),modified:m};e=I_(),t.publish(v)}))};return{add:u=>{const f=u.descriptor.id;e.additions[f]=u,e.modified[u.descriptor.droppableId]=!0,e.removals[f]&&delete e.removals[f],i()},remove:u=>{const f=u.descriptor;e.removals[f.id]=!0,e.modified[f.droppableId]=!0,e.additions[f.id]&&delete e.additions[f.id],i()},stop:()=>{r&&(cancelAnimationFrame(r),r=null,e=I_())}}}var cR=({scrollHeight:n,scrollWidth:t,height:e,width:r})=>{const i=us({x:t,y:n},{x:r,y:e});return{x:Math.max(0,i.x),y:Math.max(0,i.y)}},uR=()=>{const n=document.documentElement;return n||oe(),n},fR=()=>{const n=uR();return cR({scrollHeight:n.scrollHeight,scrollWidth:n.scrollWidth,width:n.clientWidth,height:n.clientHeight})},bj=()=>{const n=lR(),t=fR(),e=n.y,r=n.x,i=uR(),s=i.clientWidth,a=i.clientHeight,l=r+s,u=e+a;return{frame:aa({top:e,left:r,right:l,bottom:u}),scroll:{initial:n,current:n,max:t,diff:{value:Nr,displacement:Nr}}}},wj=({critical:n,scrollOptions:t,registry:e})=>{const r=bj(),i=r.scroll.current,s=n.droppable,a=e.droppable.getAllByType(s.type).map(d=>d.callbacks.getDimensionAndWatchScroll(i,t)),l=e.draggable.getAllByType(n.draggable.type).map(d=>d.getDimension(i));return{dimensions:{draggables:UO(l),droppables:BO(a)},critical:n,viewport:r}};function O2(n,t,e){return!(e.descriptor.id===t.id||e.descriptor.type!==t.type||n.droppable.getById(e.descriptor.droppableId).descriptor.mode!=="virtual")}var Ej=(n,t)=>{let e=null;const r=yj({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:n}),i=(m,v)=>{n.droppable.exists(m)||oe(),e&&t.updateDroppableIsEnabled({id:m,isEnabled:v})},s=(m,v)=>{e&&(n.droppable.exists(m)||oe(),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:v}))},a=(m,v)=>{e&&(n.droppable.exists(m)||oe(),t.updateDroppableScroll({id:m,newScroll:v}))},l=(m,v)=>{e&&n.droppable.getById(m).callbacks.scroll(v)},u=()=>{if(!e)return;r.stop();const m=e.critical.droppable;n.droppable.getAllByType(m.type).forEach(v=>v.callbacks.dragStopped()),e.unsubscribe(),e=null},f=m=>{e||oe();const v=e.critical.draggable;m.type==="ADDITION"&&O2(n,v,m.value)&&r.add(m.value),m.type==="REMOVAL"&&O2(n,v,m.value)&&r.remove(m.value)};return{updateDroppableIsEnabled:i,updateDroppableIsCombineEnabled:s,scrollDroppable:l,updateDroppableScroll:a,startPublishing:m=>{e&&oe();const v=n.draggable.getById(m.draggableId),x=n.droppable.getById(v.descriptor.droppableId),_={draggable:v.descriptor,droppable:x.descriptor},y=n.subscribe(f);return e={critical:_,unsubscribe:y},wj({critical:_,registry:n,scrollOptions:m.scrollOptions})},stopPublishing:u}},hR=(n,t)=>n.phase==="IDLE"?!0:n.phase!=="DROP_ANIMATING"||n.completed.result.draggableId===t?!1:n.completed.result.reason==="DROP",Aj=n=>{window.scrollBy(n.x,n.y)};const Sj=Rr(n=>Jg(n).filter(t=>!(!t.isEnabled||!t.frame))),Tj=(n,t)=>Sj(t).find(r=>(r.frame||oe(),XO(r.frame.pageMarginBox)(n)))||null;var Cj=({center:n,destination:t,droppables:e})=>{if(t){const i=e[t];return i.frame?i:null}return Tj(n,e)};const $d={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:n=>n**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var Dj=(n,t,e=()=>$d)=>{const r=e(),i=n[t.size]*r.startFromPercentage,s=n[t.size]*r.maxScrollAtPercentage;return{startScrollingFrom:i,maxScrollValueAt:s}},dR=({startOfRange:n,endOfRange:t,current:e})=>{const r=t-n;return r===0?0:(e-n)/r},fb=1,Oj=(n,t,e=()=>$d)=>{const r=e();if(n>t.startScrollingFrom)return 0;if(n<=t.maxScrollValueAt)return r.maxPixelScroll;if(n===t.startScrollingFrom)return fb;const s=1-dR({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:n}),a=r.maxPixelScroll*r.ease(s);return Math.ceil(a)},Rj=(n,t,e)=>{const r=e(),i=r.durationDampening.accelerateAt,s=r.durationDampening.stopDampeningAt,a=t,l=s,f=Date.now()-a;if(f>=s)return n;if(f<i)return fb;const d=dR({startOfRange:i,endOfRange:l,current:f}),p=n*r.ease(d);return Math.ceil(p)},R2=({distanceToEdge:n,thresholds:t,dragStartTime:e,shouldUseTimeDampening:r,getAutoScrollerOptions:i})=>{const s=Oj(n,t,i);return s===0?0:r?Math.max(Rj(s,e,i),fb):s},N2=({container:n,distanceToEdges:t,dragStartTime:e,axis:r,shouldUseTimeDampening:i,getAutoScrollerOptions:s})=>{const a=Dj(n,r,s);return t[r.end]<t[r.start]?R2({distanceToEdge:t[r.end],thresholds:a,dragStartTime:e,shouldUseTimeDampening:i,getAutoScrollerOptions:s}):-1*R2({distanceToEdge:t[r.start],thresholds:a,dragStartTime:e,shouldUseTimeDampening:i,getAutoScrollerOptions:s})},Nj=({container:n,subject:t,proposedScroll:e})=>{const r=t.height>n.height,i=t.width>n.width;return!i&&!r?e:i&&r?null:{x:i?0:e.x,y:r?0:e.y}};const kj=FO(n=>n===0?0:n);var pR=({dragStartTime:n,container:t,subject:e,center:r,shouldUseTimeDampening:i,getAutoScrollerOptions:s})=>{const a={top:r.y-t.top,right:t.right-r.x,bottom:t.bottom-r.y,left:r.x-t.left},l=N2({container:t,distanceToEdges:a,dragStartTime:n,axis:rb,shouldUseTimeDampening:i,getAutoScrollerOptions:s}),u=N2({container:t,distanceToEdges:a,dragStartTime:n,axis:HO,shouldUseTimeDampening:i,getAutoScrollerOptions:s}),f=kj({x:u,y:l});if(Cl(f,Nr))return null;const d=Nj({container:t,subject:e,proposedScroll:f});return d?Cl(d,Nr)?null:d:null};const Lj=FO(n=>n===0?0:n>0?1:-1),hb=(()=>{const n=(t,e)=>t<0?t:t>e?t-e:0;return({current:t,max:e,change:r})=>{const i=jr(t,r),s={x:n(i.x,e.x),y:n(i.y,e.y)};return Cl(s,Nr)?null:s}})(),mR=({max:n,current:t,change:e})=>{const r={x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)},i=Lj(e),s=hb({max:r,current:t,change:i});return!s||i.x!==0&&s.x===0||i.y!==0&&s.y===0},db=(n,t)=>mR({current:n.scroll.current,max:n.scroll.max,change:t}),Ij=(n,t)=>{if(!db(n,t))return null;const e=n.scroll.max,r=n.scroll.current;return hb({current:r,max:e,change:t})},pb=(n,t)=>{const e=n.frame;return e?mR({current:e.scroll.current,max:e.scroll.max,change:t}):!1},Mj=(n,t)=>{const e=n.frame;return!e||!pb(n,t)?null:hb({current:e.scroll.current,max:e.scroll.max,change:t})};var Pj=({viewport:n,subject:t,center:e,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:s})=>{const a=pR({dragStartTime:r,container:n.frame,subject:t,center:e,shouldUseTimeDampening:i,getAutoScrollerOptions:s});return a&&db(n,a)?a:null},Fj=({droppable:n,subject:t,center:e,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:s})=>{const a=n.frame;if(!a)return null;const l=pR({dragStartTime:r,container:a.pageMarginBox,subject:t,center:e,shouldUseTimeDampening:i,getAutoScrollerOptions:s});return l&&pb(n,l)?l:null},k2=({state:n,dragStartTime:t,shouldUseTimeDampening:e,scrollWindow:r,scrollDroppable:i,getAutoScrollerOptions:s})=>{const a=n.current.page.borderBoxCenter,u=n.dimensions.draggables[n.critical.draggable.id].page.marginBox;if(n.isWindowScrollAllowed){const p=n.viewport,m=Pj({dragStartTime:t,viewport:p,subject:u,center:a,shouldUseTimeDampening:e,getAutoScrollerOptions:s});if(m){r(m);return}}const f=Cj({center:a,destination:ds(n.impact),droppables:n.dimensions.droppables});if(!f)return;const d=Fj({dragStartTime:t,droppable:f,subject:u,center:a,shouldUseTimeDampening:e,getAutoScrollerOptions:s});d&&i(f.descriptor.id,d)},Bj=({scrollWindow:n,scrollDroppable:t,getAutoScrollerOptions:e=()=>$d})=>{const r=Bd(n),i=Bd(t);let s=null;const a=f=>{s||oe();const{shouldUseTimeDampening:d,dragStartTime:p}=s;k2({state:f,scrollWindow:r,scrollDroppable:i,dragStartTime:p,shouldUseTimeDampening:d,getAutoScrollerOptions:e})};return{start:f=>{s&&oe();const d=Date.now();let p=!1;const m=()=>{p=!0};k2({state:f,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m,getAutoScrollerOptions:e}),s={dragStartTime:d,shouldUseTimeDampening:p},p&&a(f)},stop:()=>{s&&(r.cancel(),i.cancel(),s=null)},scroll:a}},Uj=({move:n,scrollDroppable:t,scrollWindow:e})=>{const r=(l,u)=>{const f=jr(l.current.client.selection,u);n({client:f})},i=(l,u)=>{if(!pb(l,u))return u;const f=Mj(l,u);if(!f)return t(l.descriptor.id,u),null;const d=us(u,f);return t(l.descriptor.id,d),us(u,d)},s=(l,u,f)=>{if(!l||!db(u,f))return f;const d=Ij(u,f);if(!d)return e(f),null;const p=us(f,d);return e(p),us(f,p)};return l=>{const u=l.scrollJumpRequest;if(!u)return;const f=ds(l.impact);f||oe();const d=i(l.dimensions.droppables[f],u);if(!d)return;const p=l.viewport,m=s(l.isWindowScrollAllowed,p,d);m&&r(l,m)}},zj=({scrollDroppable:n,scrollWindow:t,move:e,getAutoScrollerOptions:r})=>{const i=Bj({scrollWindow:t,scrollDroppable:n,getAutoScrollerOptions:r}),s=Uj({move:e,scrollWindow:t,scrollDroppable:n});return{scroll:u=>{if(!(r().disabled||u.phase!=="DRAGGING")){if(u.movementMode==="FLUID"){i.scroll(u);return}u.scrollJumpRequest&&s(u)}},start:i.start,stop:i.stop}};const vf="data-rfd",_f=(()=>{const n=`${vf}-drag-handle`;return{base:n,draggableId:`${n}-draggable-id`,contextId:`${n}-context-id`}})(),Kx=(()=>{const n=`${vf}-draggable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),jj=(()=>{const n=`${vf}-droppable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),L2={contextId:`${vf}-scroll-container-context-id`},Hj=n=>t=>`[${t}="${n}"]`,ld=(n,t)=>n.map(e=>{const r=e.styles[t];return r?`${e.selector} { ${r} }`:""}).join(" "),$j="pointer-events: none;";var Gj=n=>{const t=Hj(n),e=(()=>{const l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(_f.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:$j,dropAnimating:l}}})(),r=(()=>{const l=`
      transition: ${Sd.outOfTheWay};
    `;return{selector:t(Kx.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}})(),i={selector:t(jj.contextId),styles:{always:"overflow-anchor: none;"}},a=[r,e,i,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:ld(a,"always"),resting:ld(a,"resting"),dragging:ld(a,"dragging"),dropAnimating:ld(a,"dropAnimating"),userCancel:ld(a,"userCancel")}};const ps=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?_t.useLayoutEffect:_t.useEffect,M_=()=>{const n=document.querySelector("head");return n||oe(),n},I2=n=>{const t=document.createElement("style");return n&&t.setAttribute("nonce",n),t.type="text/css",t};function Vj(n,t){const e=nn(()=>Gj(n),[n]),r=_t.useRef(null),i=_t.useRef(null),s=xe(Rr(p=>{const m=i.current;m||oe(),m.textContent=p}),[]),a=xe(p=>{const m=r.current;m||oe(),m.textContent=p},[]);ps(()=>{!r.current&&!i.current||oe();const p=I2(t),m=I2(t);return r.current=p,i.current=m,p.setAttribute(`${vf}-always`,n),m.setAttribute(`${vf}-dynamic`,n),M_().appendChild(p),M_().appendChild(m),a(e.always),s(e.resting),()=>{const v=x=>{const _=x.current;_||oe(),M_().removeChild(_),x.current=null};v(r),v(i)}},[t,a,s,e.always,e.resting,n]);const l=xe(()=>s(e.dragging),[s,e.dragging]),u=xe(p=>{if(p==="DROP"){s(e.dropAnimating);return}s(e.userCancel)},[s,e.dropAnimating,e.userCancel]),f=xe(()=>{i.current&&s(e.resting)},[s,e.resting]);return nn(()=>({dragging:l,dropping:u,resting:f}),[l,u,f])}function gR(n,t){return Array.from(n.querySelectorAll(t))}var vR=n=>n&&n.ownerDocument&&n.ownerDocument.defaultView?n.ownerDocument.defaultView:window;function rv(n){return n instanceof vR(n).HTMLElement}function Wj(n,t){const e=`[${_f.contextId}="${n}"]`,r=gR(document,e);if(!r.length)return null;const i=r.find(s=>s.getAttribute(_f.draggableId)===t);return!i||!rv(i)?null:i}function qj(n){const t=_t.useRef({}),e=_t.useRef(null),r=_t.useRef(null),i=_t.useRef(!1),s=xe(function(m,v){const x={id:m,focus:v};return t.current[m]=x,function(){const y=t.current;y[m]!==x&&delete y[m]}},[]),a=xe(function(m){const v=Wj(n,m);v&&v!==document.activeElement&&v.focus()},[n]),l=xe(function(m,v){e.current===m&&(e.current=v)},[]),u=xe(function(){r.current||i.current&&(r.current=requestAnimationFrame(()=>{r.current=null;const m=e.current;m&&a(m)}))},[a]),f=xe(function(m){e.current=null;const v=document.activeElement;v&&v.getAttribute(_f.draggableId)===m&&(e.current=m)},[]);return ps(()=>(i.current=!0,function(){i.current=!1;const m=r.current;m&&cancelAnimationFrame(m)}),[]),nn(()=>({register:s,tryRecordFocus:f,tryRestoreFocusRecorded:u,tryShiftRecord:l}),[s,f,u,l])}function Yj(){const n={draggables:{},droppables:{}},t=[];function e(p){return t.push(p),function(){const v=t.indexOf(p);v!==-1&&t.splice(v,1)}}function r(p){t.length&&t.forEach(m=>m(p))}function i(p){return n.draggables[p]||null}function s(p){const m=i(p);return m||oe(),m}const a={register:p=>{n.draggables[p.descriptor.id]=p,r({type:"ADDITION",value:p})},update:(p,m)=>{const v=n.draggables[m.descriptor.id];v&&v.uniqueId===p.uniqueId&&(delete n.draggables[m.descriptor.id],n.draggables[p.descriptor.id]=p)},unregister:p=>{const m=p.descriptor.id,v=i(m);v&&p.uniqueId===v.uniqueId&&(delete n.draggables[m],n.droppables[p.descriptor.droppableId]&&r({type:"REMOVAL",value:p}))},getById:s,findById:i,exists:p=>!!i(p),getAllByType:p=>Object.values(n.draggables).filter(m=>m.descriptor.type===p)};function l(p){return n.droppables[p]||null}function u(p){const m=l(p);return m||oe(),m}const f={register:p=>{n.droppables[p.descriptor.id]=p},unregister:p=>{const m=l(p.descriptor.id);m&&p.uniqueId===m.uniqueId&&delete n.droppables[p.descriptor.id]},getById:u,findById:l,exists:p=>!!l(p),getAllByType:p=>Object.values(n.droppables).filter(m=>m.descriptor.type===p)};function d(){n.draggables={},n.droppables={},t.length=0}return{draggable:a,droppable:f,subscribe:e,clean:d}}function Xj(){const n=nn(Yj,[]);return _t.useEffect(()=>function(){n.clean()},[n]),n}var mb=Yn.createContext(null),fg=()=>{const n=document.body;return n||oe(),n};const Kj={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},Zj=n=>`rfd-announcement-${n}`;function Qj(n){const t=nn(()=>Zj(n),[n]),e=_t.useRef(null);return _t.useEffect(function(){const s=document.createElement("div");return e.current=s,s.id=t,s.setAttribute("aria-live","assertive"),s.setAttribute("aria-atomic","true"),og(s.style,Kj),fg().appendChild(s),function(){setTimeout(function(){const u=fg();u.contains(s)&&u.removeChild(s),s===e.current&&(e.current=null)})}},[t]),xe(i=>{const s=e.current;if(s){s.textContent=i;return}},[])}const Jj={separator:"::"};function gb(n,t=Jj){const e=Yn.useId();return nn(()=>`${n}${t.separator}${e}`,[t.separator,n,e])}function t7({contextId:n,uniqueId:t}){return`rfd-hidden-text-${n}-${t}`}function e7({contextId:n,text:t}){const e=gb("hidden-text",{separator:"-"}),r=nn(()=>t7({contextId:n,uniqueId:e}),[e,n]);return _t.useEffect(function(){const s=document.createElement("div");return s.id=r,s.textContent=t,s.style.display="none",fg().appendChild(s),function(){const l=fg();l.contains(s)&&l.removeChild(s)}},[r,t]),r}var iv=Yn.createContext(null);function _R(n){const t=_t.useRef(n);return _t.useEffect(()=>{t.current=n}),t}function n7(){let n=null;function t(){return!!n}function e(a){return a===n}function r(a){n&&oe();const l={abandon:a};return n=l,l}function i(){n||oe(),n=null}function s(){n&&(n.abandon(),i())}return{isClaimed:t,isActive:e,claim:r,release:i,tryAbandon:s}}function Gd(n){return n.phase==="IDLE"||n.phase==="DROP_ANIMATING"?!1:n.isDragging}const r7=9,i7=13,vb=27,xR=32,s7=33,a7=34,o7=35,l7=36,c7=37,u7=38,f7=39,h7=40,d7={[i7]:!0,[r7]:!0};var yR=n=>{d7[n.keyCode]&&n.preventDefault()};const sv=(()=>{const n="visibilitychange";return typeof document>"u"?n:[n,`ms${n}`,`webkit${n}`,`moz${n}`,`o${n}`].find(r=>`on${r}`in document)||n})(),bR=0,M2=5;function p7(n,t){return Math.abs(t.x-n.x)>=M2||Math.abs(t.y-n.y)>=M2}const P2={type:"IDLE"};function m7({cancel:n,completed:t,getPhase:e,setPhase:r}){return[{eventName:"mousemove",fn:i=>{const{button:s,clientX:a,clientY:l}=i;if(s!==bR)return;const u={x:a,y:l},f=e();if(f.type==="DRAGGING"){i.preventDefault(),f.actions.move(u);return}f.type!=="PENDING"&&oe();const d=f.point;if(!p7(d,u))return;i.preventDefault();const p=f.actions.fluidLift(u);r({type:"DRAGGING",actions:p})}},{eventName:"mouseup",fn:i=>{const s=e();if(s.type!=="DRAGGING"){n();return}i.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"mousedown",fn:i=>{e().type==="DRAGGING"&&i.preventDefault(),n()}},{eventName:"keydown",fn:i=>{if(e().type==="PENDING"){n();return}if(i.keyCode===vb){i.preventDefault(),n();return}yR(i)}},{eventName:"resize",fn:n},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{e().type==="PENDING"&&n()}},{eventName:"webkitmouseforcedown",fn:i=>{const s=e();if(s.type==="IDLE"&&oe(),s.actions.shouldRespectForcePress()){n();return}i.preventDefault()}},{eventName:sv,fn:n}]}function g7(n){const t=_t.useRef(P2),e=_t.useRef(Tl),r=nn(()=>({eventName:"mousedown",fn:function(p){if(p.defaultPrevented||p.button!==bR||p.ctrlKey||p.metaKey||p.shiftKey||p.altKey)return;const m=n.findClosestDraggableId(p);if(!m)return;const v=n.tryGetLock(m,a,{sourceEvent:p});if(!v)return;p.preventDefault();const x={x:p.clientX,y:p.clientY};e.current(),f(v,x)}}),[n]),i=nn(()=>({eventName:"webkitmouseforcewillbegin",fn:d=>{if(d.defaultPrevented)return;const p=n.findClosestDraggableId(d);if(!p)return;const m=n.findOptionsForDraggable(p);m&&(m.shouldRespectForcePress||n.canGetLock(p)&&d.preventDefault())}}),[n]),s=xe(function(){const p={passive:!1,capture:!0};e.current=Ps(window,[i,r],p)},[i,r]),a=xe(()=>{t.current.type!=="IDLE"&&(t.current=P2,e.current(),s())},[s]),l=xe(()=>{const d=t.current;a(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[a]),u=xe(function(){const p={capture:!0,passive:!1},m=m7({cancel:l,completed:a,getPhase:()=>t.current,setPhase:v=>{t.current=v}});e.current=Ps(window,m,p)},[l,a]),f=xe(function(p,m){t.current.type!=="IDLE"&&oe(),t.current={type:"PENDING",point:m,actions:p},u()},[u]);ps(function(){return s(),function(){e.current()}},[s])}function v7(){}const _7={[a7]:!0,[s7]:!0,[l7]:!0,[o7]:!0};function x7(n,t){function e(){t(),n.cancel()}function r(){t(),n.drop()}return[{eventName:"keydown",fn:i=>{if(i.keyCode===vb){i.preventDefault(),e();return}if(i.keyCode===xR){i.preventDefault(),r();return}if(i.keyCode===h7){i.preventDefault(),n.moveDown();return}if(i.keyCode===u7){i.preventDefault(),n.moveUp();return}if(i.keyCode===f7){i.preventDefault(),n.moveRight();return}if(i.keyCode===c7){i.preventDefault(),n.moveLeft();return}if(_7[i.keyCode]){i.preventDefault();return}yR(i)}},{eventName:"mousedown",fn:e},{eventName:"mouseup",fn:e},{eventName:"click",fn:e},{eventName:"touchstart",fn:e},{eventName:"resize",fn:e},{eventName:"wheel",fn:e,options:{passive:!0}},{eventName:sv,fn:e}]}function y7(n){const t=_t.useRef(v7),e=nn(()=>({eventName:"keydown",fn:function(s){if(s.defaultPrevented||s.keyCode!==xR)return;const a=n.findClosestDraggableId(s);if(!a)return;const l=n.tryGetLock(a,d,{sourceEvent:s});if(!l)return;s.preventDefault();let u=!0;const f=l.snapLift();t.current();function d(){u||oe(),u=!1,t.current(),r()}t.current=Ps(window,x7(f,d),{capture:!0,passive:!1})}}),[n]),r=xe(function(){const s={passive:!1,capture:!0};t.current=Ps(window,[e],s)},[e]);ps(function(){return r(),function(){t.current()}},[r])}const P_={type:"IDLE"},b7=120,w7=.15;function E7({cancel:n,getPhase:t}){return[{eventName:"orientationchange",fn:n},{eventName:"resize",fn:n},{eventName:"contextmenu",fn:e=>{e.preventDefault()}},{eventName:"keydown",fn:e=>{if(t().type!=="DRAGGING"){n();return}e.keyCode===vb&&e.preventDefault(),n()}},{eventName:sv,fn:n}]}function A7({cancel:n,completed:t,getPhase:e}){return[{eventName:"touchmove",options:{capture:!1},fn:r=>{const i=e();if(i.type!=="DRAGGING"){n();return}i.hasMoved=!0;const{clientX:s,clientY:a}=r.touches[0],l={x:s,y:a};r.preventDefault(),i.actions.move(l)}},{eventName:"touchend",fn:r=>{const i=e();if(i.type!=="DRAGGING"){n();return}r.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),t()}},{eventName:"touchcancel",fn:r=>{if(e().type!=="DRAGGING"){n();return}r.preventDefault(),n()}},{eventName:"touchforcechange",fn:r=>{const i=e();i.type==="IDLE"&&oe();const s=r.touches[0];if(!s||!(s.force>=w7))return;const l=i.actions.shouldRespectForcePress();if(i.type==="PENDING"){l&&n();return}if(l){if(i.hasMoved){r.preventDefault();return}n();return}r.preventDefault()}},{eventName:sv,fn:n}]}function S7(n){const t=_t.useRef(P_),e=_t.useRef(Tl),r=xe(function(){return t.current},[]),i=xe(function(v){t.current=v},[]),s=nn(()=>({eventName:"touchstart",fn:function(v){if(v.defaultPrevented)return;const x=n.findClosestDraggableId(v);if(!x)return;const _=n.tryGetLock(x,l,{sourceEvent:v});if(!_)return;const y=v.touches[0],{clientX:w,clientY:S}=y,T={x:w,y:S};e.current(),p(_,T)}}),[n]),a=xe(function(){const v={capture:!0,passive:!1};e.current=Ps(window,[s],v)},[s]),l=xe(()=>{const m=t.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),i(P_),e.current(),a())},[a,i]),u=xe(()=>{const m=t.current;l(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[l]),f=xe(function(){const v={capture:!0,passive:!1},x={cancel:u,completed:l,getPhase:r},_=Ps(window,A7(x),v),y=Ps(window,E7(x),v);e.current=function(){_(),y()}},[u,r,l]),d=xe(function(){const v=r();v.type!=="PENDING"&&oe();const x=v.actions.fluidLift(v.point);i({type:"DRAGGING",actions:x,hasMoved:!1})},[r,i]),p=xe(function(v,x){r().type!=="IDLE"&&oe();const _=setTimeout(d,b7);i({type:"PENDING",point:x,actions:v,longPressTimerId:_}),f()},[f,r,i,d]);ps(function(){return a(),function(){e.current();const x=r();x.type==="PENDING"&&(clearTimeout(x.longPressTimerId),i(P_))}},[r,a,i]),ps(function(){return Ps(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const T7=["input","button","textarea","select","option","optgroup","video","audio"];function wR(n,t){if(t==null)return!1;if(T7.includes(t.tagName.toLowerCase()))return!0;const r=t.getAttribute("contenteditable");return r==="true"||r===""?!0:t===n?!1:wR(n,t.parentElement)}function C7(n,t){const e=t.target;return rv(e)?wR(n,e):!1}var D7=n=>aa(n.getBoundingClientRect()).center;function O7(n){return n instanceof vR(n).Element}const R7=(()=>{const n="matches";return typeof document>"u"?n:[n,"msMatchesSelector","webkitMatchesSelector"].find(r=>r in Element.prototype)||n})();function ER(n,t){return n==null?null:n[R7](t)?n:ER(n.parentElement,t)}function N7(n,t){return n.closest?n.closest(t):ER(n,t)}function k7(n){return`[${_f.contextId}="${n}"]`}function L7(n,t){const e=t.target;if(!O7(e))return null;const r=k7(n),i=N7(e,r);return!i||!rv(i)?null:i}function I7(n,t){const e=L7(n,t);return e?e.getAttribute(_f.draggableId):null}function M7(n,t){const e=`[${Kx.contextId}="${n}"]`,i=gR(document,e).find(s=>s.getAttribute(Kx.id)===t);return!i||!rv(i)?null:i}function P7(n){n.preventDefault()}function xm({expected:n,phase:t,isLockActive:e,shouldWarn:r}){return!(!e()||n!==t)}function AR({lockAPI:n,store:t,registry:e,draggableId:r}){if(n.isClaimed())return!1;const i=e.draggable.findById(r);return!(!i||!i.options.isEnabled||!hR(t.getState(),r))}function F7({lockAPI:n,contextId:t,store:e,registry:r,draggableId:i,forceSensorStop:s,sourceEvent:a}){if(!AR({lockAPI:n,store:e,registry:r,draggableId:i}))return null;const u=r.draggable.getById(i),f=M7(t,u.descriptor.id);if(!f||a&&!u.options.canDragInteractiveElements&&C7(f,a))return null;const d=n.claim(s||Tl);let p="PRE_DRAG";function m(){return u.options.shouldRespectForcePress}function v(){return n.isActive(d)}function x(R,N){xm({expected:R,phase:p,isLockActive:v,shouldWarn:!0})&&e.dispatch(N())}const _=x.bind(null,"DRAGGING");function y(R){function N(){n.release(),p="COMPLETED"}p!=="PRE_DRAG"&&(N(),oe()),e.dispatch(Nz(R.liftActionArgs)),p="DRAGGING";function D(I,M={shouldBlockNextClick:!1}){if(R.cleanup(),M.shouldBlockNextClick){const B=Ps(window,[{eventName:"click",fn:P7,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(B)}N(),e.dispatch(iR({reason:I}))}return{isActive:()=>xm({expected:"DRAGGING",phase:p,isLockActive:v,shouldWarn:!1}),shouldRespectForcePress:m,drop:I=>D("DROP",I),cancel:I=>D("CANCEL",I),...R.actions}}function w(R){const N=Bd(I=>{_(()=>rR({client:I}))});return{...y({liftActionArgs:{id:i,clientSelection:R,movementMode:"FLUID"},cleanup:()=>N.cancel(),actions:{move:N}}),move:N}}function S(){const R={moveUp:()=>_(zz),moveRight:()=>_(Hz),moveDown:()=>_(jz),moveLeft:()=>_($z)};return y({liftActionArgs:{id:i,clientSelection:D7(f),movementMode:"SNAP"},cleanup:Tl,actions:R})}function T(){xm({expected:"PRE_DRAG",phase:p,isLockActive:v,shouldWarn:!0})&&n.release()}return{isActive:()=>xm({expected:"PRE_DRAG",phase:p,isLockActive:v,shouldWarn:!1}),shouldRespectForcePress:m,fluidLift:w,snapLift:S,abort:T}}const B7=[g7,y7,S7];function U7({contextId:n,store:t,registry:e,customSensors:r,enableDefaultSensors:i}){const s=[...i?B7:[],...r||[]],a=_t.useState(()=>n7())[0],l=xe(function(y,w){Gd(y)&&!Gd(w)&&a.tryAbandon()},[a]);ps(function(){let y=t.getState();return t.subscribe(()=>{const S=t.getState();l(y,S),y=S})},[a,t,l]),ps(()=>a.tryAbandon,[a.tryAbandon]);const u=xe(_=>AR({lockAPI:a,registry:e,store:t,draggableId:_}),[a,e,t]),f=xe((_,y,w)=>F7({lockAPI:a,registry:e,contextId:n,store:t,draggableId:_,forceSensorStop:y||null,sourceEvent:w&&w.sourceEvent?w.sourceEvent:null}),[n,a,e,t]),d=xe(_=>I7(n,_),[n]),p=xe(_=>{const y=e.draggable.findById(_);return y?y.options:null},[e.draggable]),m=xe(function(){a.isClaimed()&&(a.tryAbandon(),t.getState().phase!=="IDLE"&&t.dispatch(lb()))},[a,t]),v=xe(()=>a.isClaimed(),[a]),x=nn(()=>({canGetLock:u,tryGetLock:f,findClosestDraggableId:d,findOptionsForDraggable:p,tryReleaseLock:m,isLockClaimed:v}),[u,f,d,p,m,v]);for(let _=0;_<s.length;_++)s[_](x)}const z7=n=>({onBeforeCapture:t=>{const e=()=>{n.onBeforeCapture&&n.onBeforeCapture(t)};Ky.flushSync(e)},onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd,onDragUpdate:n.onDragUpdate}),j7=n=>({...$d,...n.autoScrollerOptions,durationDampening:{...$d.durationDampening,...n.autoScrollerOptions}});function cd(n){return n.current||oe(),n.current}function H7(n){const{contextId:t,setCallbacks:e,sensors:r,nonce:i,dragHandleUsageInstructions:s}=n,a=_t.useRef(null),l=_R(n),u=xe(()=>z7(l.current),[l]),f=xe(()=>j7(l.current),[l]),d=Qj(t),p=e7({contextId:t,text:s}),m=Vj(t,i),v=xe(B=>{cd(a).dispatch(B)},[]),x=nn(()=>l2({publishWhileDragging:Lz,updateDroppableScroll:Mz,updateDroppableIsEnabled:Pz,updateDroppableIsCombineEnabled:Fz,collectionStarting:Iz},v),[v]),_=Xj(),y=nn(()=>Ej(_,x),[_,x]),w=nn(()=>zj({scrollWindow:Aj,scrollDroppable:y.scrollDroppable,getAutoScrollerOptions:f,...l2({move:rR},v)}),[y.scrollDroppable,v,f]),S=qj(t),T=nn(()=>xj({announce:d,autoScroller:w,dimensionMarshal:y,focusMarshal:S,getResponders:u,styleMarshal:m}),[d,w,y,S,u,m]);a.current=T;const C=xe(()=>{const B=cd(a);B.getState().phase!=="IDLE"&&B.dispatch(lb())},[]),R=xe(()=>{const B=cd(a).getState();return B.phase==="DROP_ANIMATING"?!0:B.phase==="IDLE"?!1:B.isDragging},[]),N=nn(()=>({isDragging:R,tryAbort:C}),[R,C]);e(N);const D=xe(B=>hR(cd(a).getState(),B),[]),I=xe(()=>mc(cd(a).getState()),[]),M=nn(()=>({marshal:y,focus:S,contextId:t,canLift:D,isMovementAllowed:I,dragHandleUsageInstructionsId:p,registry:_}),[t,y,p,S,D,I,_]);return U7({contextId:t,store:T,registry:_,customSensors:r||null,enableDefaultSensors:n.enableDefaultSensors!==!1}),_t.useEffect(()=>C,[C]),Yn.createElement(iv.Provider,{value:M},Yn.createElement(mU,{context:mb,store:T},n.children))}function $7(){return Yn.useId()}function G7(n){const t=$7(),e=n.dragHandleUsageInstructions||Wm.dragHandleUsageInstructions;return Yn.createElement(yU,null,r=>Yn.createElement(H7,{nonce:n.nonce,contextId:t,setCallbacks:r,dragHandleUsageInstructions:e,enableDefaultSensors:n.enableDefaultSensors,sensors:n.sensors,onBeforeCapture:n.onBeforeCapture,onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragUpdate:n.onDragUpdate,onDragEnd:n.onDragEnd,autoScrollerOptions:n.autoScrollerOptions},n.children))}const F2={dragging:5e3,dropAnimating:4500},V7=(n,t)=>t?Sd.drop(t.duration):n?Sd.snap:Sd.fluid,W7=(n,t)=>{if(n)return t?Hd.opacity.drop:Hd.opacity.combining},q7=n=>n.forceShouldAnimate!=null?n.forceShouldAnimate:n.mode==="SNAP";function Y7(n){const e=n.dimension.client,{offset:r,combineWith:i,dropping:s}=n,a=!!i,l=q7(n),u=!!s,f=u?Yx.drop(r,a):Yx.moveTo(r);return{position:"fixed",top:e.marginBox.top,left:e.marginBox.left,boxSizing:"border-box",width:e.borderBox.width,height:e.borderBox.height,transition:V7(l,s),transform:f,opacity:W7(a,u),zIndex:u?F2.dropAnimating:F2.dragging,pointerEvents:"none"}}function X7(n){return{transform:Yx.moveTo(n.offset),transition:n.shouldAnimateDisplacement?void 0:"none"}}function K7(n){return n.type==="DRAGGING"?Y7(n):X7(n)}function Z7(n,t,e=Nr){const r=window.getComputedStyle(t),i=t.getBoundingClientRect(),s=NO(i,r),a=ag(s,e),l={client:s,tagName:t.tagName.toLowerCase(),display:r.display},u={x:s.marginBox.width,y:s.marginBox.height};return{descriptor:n,placeholder:l,displaceBy:u,client:s,page:a}}function Q7(n){const t=gb("draggable"),{descriptor:e,registry:r,getDraggableRef:i,canDragInteractiveElements:s,shouldRespectForcePress:a,isEnabled:l}=n,u=nn(()=>({canDragInteractiveElements:s,shouldRespectForcePress:a,isEnabled:l}),[s,l,a]),f=xe(v=>{const x=i();return x||oe(),Z7(e,x,v)},[e,i]),d=nn(()=>({uniqueId:t,descriptor:e,options:u,getDimension:f}),[e,f,u,t]),p=_t.useRef(d),m=_t.useRef(!0);ps(()=>(r.draggable.register(p.current),()=>r.draggable.unregister(p.current)),[r.draggable]),ps(()=>{if(m.current){m.current=!1;return}const v=p.current;p.current=d,r.draggable.update(d,v)},[d,r.draggable])}var _b=Yn.createContext(null);function hg(n){const t=_t.useContext(n);return t||oe(),t}function J7(n){n.preventDefault()}const t9=n=>{const t=_t.useRef(null),e=xe((N=null)=>{t.current=N},[]),r=xe(()=>t.current,[]),{contextId:i,dragHandleUsageInstructionsId:s,registry:a}=hg(iv),{type:l,droppableId:u}=hg(_b),f=nn(()=>({id:n.draggableId,index:n.index,type:l,droppableId:u}),[n.draggableId,n.index,l,u]),{children:d,draggableId:p,isEnabled:m,shouldRespectForcePress:v,canDragInteractiveElements:x,isClone:_,mapped:y,dropAnimationFinished:w}=n;if(!_){const N=nn(()=>({descriptor:f,registry:a,getDraggableRef:r,canDragInteractiveElements:x,shouldRespectForcePress:v,isEnabled:m}),[f,a,r,x,v,m]);Q7(N)}const S=nn(()=>m?{tabIndex:0,role:"button","aria-describedby":s,"data-rfd-drag-handle-draggable-id":p,"data-rfd-drag-handle-context-id":i,draggable:!1,onDragStart:J7}:null,[i,s,p,m]),T=xe(N=>{y.type==="DRAGGING"&&y.dropping&&N.propertyName==="transform"&&Ky.flushSync(w)},[w,y]),C=nn(()=>{const N=K7(y),D=y.type==="DRAGGING"&&y.dropping?T:void 0;return{innerRef:e,draggableProps:{"data-rfd-draggable-context-id":i,"data-rfd-draggable-id":p,style:N,onTransitionEnd:D},dragHandleProps:S}},[i,S,p,y,T,e]),R=nn(()=>({draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}),[f.droppableId,f.id,f.index,f.type]);return Yn.createElement(Yn.Fragment,null,d(C,y.snapshot,R))};var SR=(n,t)=>n===t,TR=n=>{const{combine:t,destination:e}=n;return e?e.droppableId:t?t.droppableId:null};const e9=n=>n.combine?n.combine.draggableId:null,n9=n=>n.at&&n.at.type==="COMBINE"?n.at.combine.draggableId:null;function r9(){const n=Rr((i,s)=>({x:i,y:s})),t=Rr((i,s,a=null,l=null,u=null)=>({isDragging:!0,isClone:s,isDropAnimating:!!u,dropAnimation:u,mode:i,draggingOver:a,combineWith:l,combineTargetFor:null})),e=Rr((i,s,a,l,u=null,f=null,d=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:u,combineWith:f,mode:s,offset:i,dimension:a,forceShouldAnimate:d,snapshot:t(s,l,u,f,null)}}));return(i,s)=>{if(Gd(i)){if(i.critical.draggable.id!==s.draggableId)return null;const a=i.current.client.offset,l=i.dimensions.draggables[s.draggableId],u=ds(i.impact),f=n9(i.impact),d=i.forceShouldAnimate;return e(n(a.x,a.y),i.movementMode,l,s.isClone,u,f,d)}if(i.phase==="DROP_ANIMATING"){const a=i.completed;if(a.result.draggableId!==s.draggableId)return null;const l=s.isClone,u=i.dimensions.draggables[s.draggableId],f=a.result,d=f.mode,p=TR(f),m=e9(f),x={duration:i.dropDuration,curve:ub.drop,moveTo:i.newHomeClientOffset,opacity:m?Hd.opacity.drop:null,scale:m?Hd.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:u,dropping:x,draggingOver:p,combineWith:m,mode:d,forceShouldAnimate:null,snapshot:t(d,l,p,m,x)}}}return null}}function CR(n=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:n,combineWith:null}}const i9={mapped:{type:"SECONDARY",offset:Nr,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:CR(null)}};function s9(){const n=Rr((a,l)=>({x:a,y:l})),t=Rr(CR),e=Rr((a,l=null,u)=>({mapped:{type:"SECONDARY",offset:a,combineTargetFor:l,shouldAnimateDisplacement:u,snapshot:t(l)}})),r=a=>a?e(Nr,a,!0):null,i=(a,l,u,f)=>{const d=u.displaced.visible[a],p=!!(f.inVirtualList&&f.effected[a]),m=tv(u),v=m&&m.draggableId===a?l:null;if(!d){if(!p)return r(v);if(u.displaced.invisible[a])return null;const y=Cf(f.displacedBy.point),w=n(y.x,y.y);return e(w,v,!0)}if(p)return r(v);const x=u.displacedBy.point,_=n(x.x,x.y);return e(_,v,d.shouldAnimate)};return(a,l)=>{if(Gd(a))return a.critical.draggable.id===l.draggableId?null:i(l.draggableId,a.critical.draggable.id,a.impact,a.afterCritical);if(a.phase==="DROP_ANIMATING"){const u=a.completed;return u.result.draggableId===l.draggableId?null:i(l.draggableId,u.result.draggableId,u.impact,u.afterCritical)}return null}}const a9=()=>{const n=r9(),t=s9();return(r,i)=>n(r,i)||t(r,i)||i9},o9={dropAnimationFinished:sR},l9=RO(a9,o9,null,{context:mb,areStatePropsEqual:SR})(t9);function DR(n){return hg(_b).isUsingCloneFor===n.draggableId&&!n.isClone?null:Yn.createElement(l9,n)}function c9(n){const t=typeof n.isDragDisabled=="boolean"?!n.isDragDisabled:!0,e=!!n.disableInteractiveElementBlocking,r=!!n.shouldRespectForcePress;return Yn.createElement(DR,og({},n,{isClone:!1,isEnabled:t,canDragInteractiveElements:e,shouldRespectForcePress:r}))}const OR=n=>t=>n===t,u9=OR("scroll"),f9=OR("auto"),B2=(n,t)=>t(n.overflowX)||t(n.overflowY),h9=n=>{const t=window.getComputedStyle(n),e={overflowX:t.overflowX,overflowY:t.overflowY};return B2(e,u9)||B2(e,f9)},d9=()=>!1,RR=n=>n==null?null:n===document.body?d9()?n:null:n===document.documentElement?null:h9(n)?n:RR(n.parentElement);var Zx=n=>({x:n.scrollLeft,y:n.scrollTop});const NR=n=>n?window.getComputedStyle(n).position==="fixed"?!0:NR(n.parentElement):!1;var p9=n=>{const t=RR(n),e=NR(n);return{closestScrollable:t,isFixedOnPage:e}},m9=({descriptor:n,isEnabled:t,isCombineEnabled:e,isFixedOnPage:r,direction:i,client:s,page:a,closest:l})=>{const u=(()=>{if(!l)return null;const{scrollSize:m,client:v}=l,x=cR({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:v,scrollSize:m,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:x,diff:{value:Nr,displacement:Nr}}}})(),f=i==="vertical"?rb:HO,d=gf({page:a,withPlaceholder:null,axis:f,frame:u});return{descriptor:n,isCombineEnabled:e,isFixedOnPage:r,axis:f,isEnabled:t,client:s,page:a,frame:u,subject:d}};const g9=(n,t)=>{const e=kO(n);if(!t||n!==t)return e;const r=e.paddingBox.top-t.scrollTop,i=e.paddingBox.left-t.scrollLeft,s=r+t.scrollHeight,a=i+t.scrollWidth,u=Jy({top:r,right:a,bottom:s,left:i},e.border);return tb({borderBox:u,margin:e.margin,border:e.border,padding:e.padding})};var v9=({ref:n,descriptor:t,env:e,windowScroll:r,direction:i,isDropDisabled:s,isCombineEnabled:a,shouldClipSubject:l})=>{const u=e.closestScrollable,f=g9(n,u),d=ag(f,r),p=(()=>{if(!u)return null;const v=kO(u),x={scrollHeight:u.scrollHeight,scrollWidth:u.scrollWidth};return{client:v,page:ag(v,r),scroll:Zx(u),scrollSize:x,shouldClipSubject:l}})();return m9({descriptor:t,isEnabled:!s,isCombineEnabled:a,isFixedOnPage:e.isFixedOnPage,direction:i,client:f,page:d,closest:p})};const _9={passive:!1},x9={passive:!0};var U2=n=>n.shouldPublishImmediately?_9:x9;const ym=n=>n&&n.env.closestScrollable||null;function y9(n){const t=_t.useRef(null),e=hg(iv),r=gb("droppable"),{registry:i,marshal:s}=e,a=_R(n),l=nn(()=>({id:n.droppableId,type:n.type,mode:n.mode}),[n.droppableId,n.mode,n.type]),u=_t.useRef(l),f=nn(()=>Rr((C,R)=>{t.current||oe();const N={x:C,y:R};s.updateDroppableScroll(l.id,N)}),[l.id,s]),d=xe(()=>{const C=t.current;return!C||!C.env.closestScrollable?Nr:Zx(C.env.closestScrollable)},[]),p=xe(()=>{const C=d();f(C.x,C.y)},[d,f]),m=nn(()=>Bd(p),[p]),v=xe(()=>{const C=t.current,R=ym(C);if(C&&R||oe(),C.scrollOptions.shouldPublishImmediately){p();return}m()},[m,p]),x=xe((C,R)=>{t.current&&oe();const N=a.current,D=N.getDroppableRef();D||oe();const I=p9(D),M={ref:D,descriptor:l,env:I,scrollOptions:R};t.current=M;const B=v9({ref:D,descriptor:l,env:I,windowScroll:C,direction:N.direction,isDropDisabled:N.isDropDisabled,isCombineEnabled:N.isCombineEnabled,shouldClipSubject:!N.ignoreContainerClipping}),H=I.closestScrollable;return H&&(H.setAttribute(L2.contextId,e.contextId),H.addEventListener("scroll",v,U2(M.scrollOptions))),B},[e.contextId,l,v,a]),_=xe(()=>{const C=t.current,R=ym(C);return C&&R||oe(),Zx(R)},[]),y=xe(()=>{const C=t.current;C||oe();const R=ym(C);t.current=null,R&&(m.cancel(),R.removeAttribute(L2.contextId),R.removeEventListener("scroll",v,U2(C.scrollOptions)))},[v,m]),w=xe(C=>{const R=t.current;R||oe();const N=ym(R);N||oe(),N.scrollTop+=C.y,N.scrollLeft+=C.x},[]),S=nn(()=>({getDimensionAndWatchScroll:x,getScrollWhileDragging:_,dragStopped:y,scroll:w}),[y,x,_,w]),T=nn(()=>({uniqueId:r,descriptor:l,callbacks:S}),[S,l,r]);ps(()=>(u.current=T.descriptor,i.droppable.register(T),()=>{t.current&&y(),i.droppable.unregister(T)}),[S,l,y,T,s,i.droppable]),ps(()=>{t.current&&s.updateDroppableIsEnabled(u.current.id,!n.isDropDisabled)},[n.isDropDisabled,s]),ps(()=>{t.current&&s.updateDroppableIsCombineEnabled(u.current.id,n.isCombineEnabled)},[n.isCombineEnabled,s])}function F_(){}const z2={width:0,height:0,margin:CU},b9=({isAnimatingOpenOnMount:n,placeholder:t,animate:e})=>n||e==="close"?z2:{height:t.client.borderBox.height,width:t.client.borderBox.width,margin:t.client.margin},w9=({isAnimatingOpenOnMount:n,placeholder:t,animate:e})=>{const r=b9({isAnimatingOpenOnMount:n,placeholder:t,animate:e});return{display:t.display,boxSizing:"border-box",width:r.width,height:r.height,marginTop:r.margin.top,marginRight:r.margin.right,marginBottom:r.margin.bottom,marginLeft:r.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:e!=="none"?Sd.placeholder:null}},E9=n=>{const t=_t.useRef(null),e=xe(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),{animate:r,onTransitionEnd:i,onClose:s,contextId:a}=n,[l,u]=_t.useState(n.animate==="open");_t.useEffect(()=>l?r!=="open"?(e(),u(!1),F_):t.current?F_:(t.current=setTimeout(()=>{t.current=null,u(!1)}),e):F_,[r,l,e]);const f=xe(p=>{p.propertyName==="height"&&(i(),r==="close"&&s())},[r,s,i]),d=w9({isAnimatingOpenOnMount:l,animate:n.animate,placeholder:n.placeholder});return Yn.createElement(n.placeholder.tagName,{style:d,"data-rfd-placeholder-context-id":a,onTransitionEnd:f,ref:n.innerRef})};var A9=Yn.memo(E9);class S9 extends Yn.PureComponent{constructor(...t){super(...t),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(t,e){return t.shouldAnimate?t.on?{isVisible:!0,data:t.on,animate:"open"}:e.isVisible?{isVisible:!0,data:e.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!t.on,data:t.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const t={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(t)}}const T9=n=>{const t=_t.useContext(iv);t||oe();const{contextId:e,isMovementAllowed:r}=t,i=_t.useRef(null),s=_t.useRef(null),{children:a,droppableId:l,type:u,mode:f,direction:d,ignoreContainerClipping:p,isDropDisabled:m,isCombineEnabled:v,snapshot:x,useClone:_,updateViewportMaxScroll:y,getContainerForClone:w}=n,S=xe(()=>i.current,[]),T=xe((H=null)=>{i.current=H},[]);xe(()=>s.current,[]);const C=xe((H=null)=>{s.current=H},[]),R=xe(()=>{r()&&y({maxScroll:fR()})},[r,y]);y9({droppableId:l,type:u,mode:f,direction:d,isDropDisabled:m,isCombineEnabled:v,ignoreContainerClipping:p,getDroppableRef:S});const N=nn(()=>Yn.createElement(S9,{on:n.placeholder,shouldAnimate:n.shouldAnimatePlaceholder},({onClose:H,data:F,animate:rt})=>Yn.createElement(A9,{placeholder:F,onClose:H,innerRef:C,animate:rt,contextId:e,onTransitionEnd:R})),[e,R,n.placeholder,n.shouldAnimatePlaceholder,C]),D=nn(()=>({innerRef:T,placeholder:N,droppableProps:{"data-rfd-droppable-id":l,"data-rfd-droppable-context-id":e}}),[e,l,N,T]),I=_?_.dragging.draggableId:null,M=nn(()=>({droppableId:l,type:u,isUsingCloneFor:I}),[l,I,u]);function B(){if(!_)return null;const{dragging:H,render:F}=_,rt=Yn.createElement(DR,{draggableId:H.draggableId,index:H.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(L,it)=>F(L,it,H));return pB.createPortal(rt,w())}return Yn.createElement(_b.Provider,{value:M},a(D,x),B())};function C9(){return document.body||oe(),document.body}const j2={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:C9},kR=n=>{let t={...n},e;for(e in j2)n[e]===void 0&&(t={...t,[e]:j2[e]});return t},B_=(n,t)=>n===t.droppable.type,H2=(n,t)=>t.draggables[n.draggable.id],D9=()=>{const n={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},t={...n,shouldAnimatePlaceholder:!1},e=Rr(s=>({draggableId:s.id,type:s.type,source:{index:s.index,droppableId:s.droppableId}})),r=Rr((s,a,l,u,f,d)=>{const p=f.descriptor.id;if(f.descriptor.droppableId===s){const x=d?{render:d,dragging:e(f.descriptor)}:null,_={isDraggingOver:l,draggingOverWith:l?p:null,draggingFromThisWith:p,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!1,snapshot:_,useClone:x}}if(!a)return t;if(!u)return n;const v={isDraggingOver:l,draggingOverWith:p,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:f.placeholder,shouldAnimatePlaceholder:!0,snapshot:v,useClone:null}});return(s,a)=>{const l=kR(a),u=l.droppableId,f=l.type,d=!l.isDropDisabled,p=l.renderClone;if(Gd(s)){const m=s.critical;if(!B_(f,m))return t;const v=H2(m,s.dimensions),x=ds(s.impact)===u;return r(u,d,x,x,v,p)}if(s.phase==="DROP_ANIMATING"){const m=s.completed;if(!B_(f,m.critical))return t;const v=H2(m.critical,s.dimensions);return r(u,d,TR(m.result)===u,ds(m.impact)===u,v,p)}if(s.phase==="IDLE"&&s.completed&&!s.shouldFlush){const m=s.completed;if(!B_(f,m.critical))return t;const v=ds(m.impact)===u,x=!!(m.impact.at&&m.impact.at.type==="COMBINE"),_=m.critical.droppable.id===u;return v?x?n:t:_?n:t}return t}},O9={updateViewportMaxScroll:Uz},R9=RO(D9,O9,(n,t,e)=>({...kR(e),...n,...t}),{context:mb,areStatePropsEqual:SR})(T9),N9=({showOnLoad:n,onToggleShowOnLoad:t})=>nt.jsx(nt.Fragment,{children:nt.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:nt.jsxs("div",{className:"modal-content",children:[nt.jsxs("div",{className:"modal-header",children:[nt.jsx("img",{src:"js_logo_simbolo.png",alt:"JS Geologia Aplicada",style:{maxWidth:"50px"}}),nt.jsx("h5",{className:"modal-title flex-grow-1 text-center",children:"Extrator de dados de PDFs"}),nt.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),nt.jsxs("div",{className:"modal-body text-start",children:[nt.jsx("p",{className:"lead text-muted mb-3",children:"O Extrator de Dados de PDF da JS Geologia Aplicada é uma ferramenta desenvolvida para automatizar a extração de informações de relatórios de sondagem e outros documentos técnicos, facilitando a organização e análise de dados geológicos."}),nt.jsxs("div",{className:"mt-3 px-3 text-start",children:[nt.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Como usar"}),nt.jsxs("ol",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[nt.jsxs("li",{className:"mb-1 text-start",children:[nt.jsx("strong",{children:"Carregue um PDF"}),' clicando em "Escolher arquivo"']}),nt.jsxs("li",{className:"mb-1 text-start",children:[nt.jsx("strong",{children:"Adicione áreas"})," para marcar regiões que deseja extrair texto"]}),nt.jsxs("li",{className:"mb-1 text-start",children:[nt.jsx("strong",{children:"Renomeie as áreas"})," clicando no nome para facilitar identificação"]}),nt.jsxs("li",{className:"mb-1 text-start",children:[nt.jsx("strong",{children:"Selecione as áreas"})," clicando no ícone de seleção e arrastando no PDF"]}),nt.jsxs("li",{className:"mb-1 text-start",children:[nt.jsx("strong",{children:"Extraia os dados"})," e exporte em JSON, CSV ou Excel"]})]})]}),nt.jsxs("div",{className:"mt-3 px-3 text-start",children:[nt.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Recursos disponíveis"}),nt.jsxs("ul",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[nt.jsxs("li",{className:"mb-1 text-start",children:[nt.jsx("strong",{children:"Até 10 áreas"})," de extração com cores diferentes"]}),nt.jsxs("li",{className:"mb-1 text-start",children:[nt.jsx("strong",{children:"Sistema de presets"})," para salvar configurações"]}),nt.jsxs("li",{className:"mb-1 text-start",children:[nt.jsx("strong",{children:"Campos obrigatórios"})," para ignorar páginas que não contenham dados essenciais"]})]})]}),nt.jsx("div",{className:"alert alert-warning mt-3 mb-0 text-start",role:"alert",children:nt.jsx("p",{className:"mb-0 text-start",children:"A JS Geologia Aplicada não se responsabiliza por eventuais erros na leitura automática dos dados."})})]}),nt.jsxs("div",{className:"modal-footer d-flex justify-content-between",children:[nt.jsxs("div",{className:"form-check form-switch",children:[nt.jsx("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:n,onChange:e=>{t(e.target.checked)}}),nt.jsx("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Mostrar ao abrir"})]}),nt.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Fechar"})]})]})})});function k9({onFileSelect:n,onStartAreaSelection:t,onDeleteArea:e,onRenameArea:r,onClearArea:i,onAddNewArea:s,onLoadPreset:a,onDragEnd:l,onToggleMandatory:u,onToggleRepeat:f,onChangeAreaType:d,onToggleAreaOCR:p,areas:m,hasFile:v,extractionMode:x,onChangeExtractionMode:_}){_t.useEffect(()=>{const I=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));return I.forEach(M=>new js(M)),()=>{I.forEach(M=>{const B=js.getInstance(M);B&&B.dispose()})}},[m.length]);const[y,w]=_t.useState(!1),S=()=>{w(!0)},[T,C]=_t.useState(()=>localStorage.getItem("showHelpOnLoad")!=="false");_t.useEffect(()=>{const I=()=>{new Oc("#helpModal").show()};if(T)if(document.readyState==="complete")I();else return window.addEventListener("load",I),()=>window.removeEventListener("load",I)},[]);const R=I=>{C(I),localStorage.setItem("showHelpOnLoad",I.toString())},N=()=>{confirm("Deseja remover todas as áreas?")&&m.forEach(I=>{e(I.id)})},D=()=>{b_.forEach(I=>{m.find(M=>M.dataType===I)||s(I)})};return nt.jsxs(nt.Fragment,{children:[nt.jsx(hB,{onFileSelect:n}),nt.jsx("div",{className:"modal fade",id:"helpModal",tabIndex:-1,children:nt.jsx(N9,{showOnLoad:T,onToggleShowOnLoad:R})}),nt.jsxs("div",{className:"d-flex justify-content-end gap-2 my-3",children:[nt.jsxs("select",{className:"form-select form-select-sm",defaultValue:"text",onChange:I=>_(I.target.value),children:[nt.jsx("option",{value:"text",children:"Extração de texto"}),nt.jsx("option",{value:"ocr",children:"Extração OCR (em implementação)"}),nt.jsx("option",{value:"both",children:"Escolha por área"})]}),m.length>0&&nt.jsx("button",{"data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"Excluir todas as áreas",className:"menu-btn menu-btn-warning",onClick:N,children:nt.jsx(Yy,{size:24})}),nt.jsx("span",{"data-bs-placement":"top","data-bs-toggle":"tooltip","data-bs-title":"Ajuda",children:nt.jsx("button",{className:"menu-btn","data-bs-toggle":"modal","data-bs-target":"#helpModal",children:nt.jsx(M5,{size:24})})}),nt.jsx("button",{"data-bs-title":"Presets","data-bs-toggle":"tooltip","data-bs-target":"tooltip",className:"menu-btn",onClick:S,children:nt.jsx(H5,{size:24})}),nt.jsxs("div",{className:"btn-group",children:[nt.jsx("button",{type:"button","data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-trigger":"hover","data-bs-title":"Adicionar área",className:"menu-btn",onClick:()=>s(),children:nt.jsx(W5,{size:24})}),nt.jsx("button",{className:"menu-btn dropdown-toggle dropdown-toggle-split",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:nt.jsx("span",{className:"visually-hidden",children:"Toggle Dropdown"})}),nt.jsxs("ul",{className:"dropdown-menu",id:"add-area-dropdown",style:{zIndex:1001},children:[b_.filter(I=>!m.find(M=>M.dataType===I)).map((I,M)=>nt.jsx("li",{children:nt.jsx("button",{className:"dropdown-item",type:"button","data-bs-dismiss":"dropdown",onClick:()=>s(I),children:Lc[I]})},`list-item${M}`)),nt.jsx("div",{className:"dropdown-divider"}),nt.jsx("li",{children:nt.jsx("button",{className:"dropdown-item",onClick:D,disabled:b_.some(I=>m.find(M=>M.dataType===I)),children:"Criar todos ausentes"})})]})]})]}),m.length===0&&nt.jsx("p",{className:"text-muted",children:"Adicione uma área para começar!"}),nt.jsx(G7,{onDragEnd:l,children:nt.jsx(R9,{droppableId:"areas",children:I=>nt.jsxs("div",{className:"areas-container",...I.droppableProps,ref:I.innerRef,children:[m.map((M,B)=>nt.jsx(c9,{draggableId:M.id,index:B,children:H=>nt.jsx("div",{ref:H.innerRef,...H.draggableProps,...H.dragHandleProps,children:nt.jsx(f8,{area:M,areas:m,hasFile:v,extractionMode:x,onStartSelection:t,onClearArea:i,onDeleteArea:e,onRenameArea:r,onToggleMandatory:u,onToggleRepeat:f,onChangeAreaType:d,onToggleAreaOCR:p},M.id)})},M.id)),I.placeholder]})})}),nt.jsx(dB,{isOpen:y,onClose:()=>w(!1),currentAreas:m,onLoadPreset:a})]})}const L9=(n,t,e)=>{const i={id:`area-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,name:Vd(e?Lc[e]:"Nova Área",n),order:n.length+1,color:U9(n),coordinates:null,isMandatory:e?fO.includes(e):!1,repeatInPages:e?uO.includes(e):!1,dataType:e,ocr:t};return[...n,i]},I9=(n,t)=>n.filter(e=>e.id!==t).map((e,r)=>({...e,order:r+1})),M9=(n,t,e)=>{if(e.trim().toLowerCase()==="pagenumber")return alert('Nome "pageNumber" é reservado. Use outro nome.'),n;const r=Vd(e,n);return n.map(i=>i.id===t?{...i,name:r}:i)},P9=(n,t)=>n.map(e=>e.id===t?{...e,coordinates:null}:e),$2=n=>Object.values(Lc).includes(n)||/^Nova Área( \(\d+\))?$/.test(n),F9=(n,t,e)=>n.map(r=>r.id===t?{...r,coordinates:e}:r),Vd=(n,t)=>{let e=2,r=n;for(;t.some(i=>i.name===r);)r=`${n} (${e})`,e++;return r},B9=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F97316","#84CC16","#6B7280","#DC2626","#059669","#7C3AED","#BE123C","#0369A1"],U9=n=>{const t=n.map(e=>e.color);return B9.find(e=>!t.includes(e))??"#000000"},G2=(n,t)=>{const e=n.map(i=>({id:i.id,name:i.name,dataType:i.dataType,coordinates:i.coordinates,isMandatory:i.isMandatory,repeatInPages:i.repeatInPages,ocr:i.ocr})),r=t?{name:t.name,size:t.size,lastModified:t.lastModified,type:t.type}:null;return JSON.stringify({areas:e,file:r})},z9=({areasMenu:n,extractMenu:t,areas:e})=>nt.jsxs("div",{className:"card mt-2",children:[nt.jsx("div",{className:"card-header",children:nt.jsx("h4",{className:"card-title",children:"Extrator de dados de PDF"})}),nt.jsx("div",{className:"card-body",children:n}),e.length>0&&nt.jsx("div",{className:"card-footer",children:t})]});var U_={exports:{}},V2;function j9(){return V2||(V2=1,function(n){var t=function(e){var r=Object.prototype,i=r.hasOwnProperty,s=Object.defineProperty||function(at,P,V){at[P]=V.value},a,l=typeof Symbol=="function"?Symbol:{},u=l.iterator||"@@iterator",f=l.asyncIterator||"@@asyncIterator",d=l.toStringTag||"@@toStringTag";function p(at,P,V){return Object.defineProperty(at,P,{value:V,enumerable:!0,configurable:!0,writable:!0}),at[P]}try{p({},"")}catch{p=function(P,V,j){return P[V]=j}}function m(at,P,V,j){var et=P&&P.prototype instanceof T?P:T,dt=Object.create(et.prototype),xt=new Z(j||[]);return s(dt,"_invoke",{value:F(at,V,xt)}),dt}e.wrap=m;function v(at,P,V){try{return{type:"normal",arg:at.call(P,V)}}catch(j){return{type:"throw",arg:j}}}var x="suspendedStart",_="suspendedYield",y="executing",w="completed",S={};function T(){}function C(){}function R(){}var N={};p(N,u,function(){return this});var D=Object.getPrototypeOf,I=D&&D(D(q([])));I&&I!==r&&i.call(I,u)&&(N=I);var M=R.prototype=T.prototype=Object.create(N);C.prototype=R,s(M,"constructor",{value:R,configurable:!0}),s(R,"constructor",{value:C,configurable:!0}),C.displayName=p(R,d,"GeneratorFunction");function B(at){["next","throw","return"].forEach(function(P){p(at,P,function(V){return this._invoke(P,V)})})}e.isGeneratorFunction=function(at){var P=typeof at=="function"&&at.constructor;return P?P===C||(P.displayName||P.name)==="GeneratorFunction":!1},e.mark=function(at){return Object.setPrototypeOf?Object.setPrototypeOf(at,R):(at.__proto__=R,p(at,d,"GeneratorFunction")),at.prototype=Object.create(M),at},e.awrap=function(at){return{__await:at}};function H(at,P){function V(dt,xt,Nt,Rt){var z=v(at[dt],at,xt);if(z.type==="throw")Rt(z.arg);else{var lt=z.arg,J=lt.value;return J&&typeof J=="object"&&i.call(J,"__await")?P.resolve(J.__await).then(function(ot){V("next",ot,Nt,Rt)},function(ot){V("throw",ot,Nt,Rt)}):P.resolve(J).then(function(ot){lt.value=ot,Nt(lt)},function(ot){return V("throw",ot,Nt,Rt)})}}var j;function et(dt,xt){function Nt(){return new P(function(Rt,z){V(dt,xt,Rt,z)})}return j=j?j.then(Nt,Nt):Nt()}s(this,"_invoke",{value:et})}B(H.prototype),p(H.prototype,f,function(){return this}),e.AsyncIterator=H,e.async=function(at,P,V,j,et){et===void 0&&(et=Promise);var dt=new H(m(at,P,V,j),et);return e.isGeneratorFunction(P)?dt:dt.next().then(function(xt){return xt.done?xt.value:dt.next()})};function F(at,P,V){var j=x;return function(dt,xt){if(j===y)throw new Error("Generator is already running");if(j===w){if(dt==="throw")throw xt;return Ct()}for(V.method=dt,V.arg=xt;;){var Nt=V.delegate;if(Nt){var Rt=rt(Nt,V);if(Rt){if(Rt===S)continue;return Rt}}if(V.method==="next")V.sent=V._sent=V.arg;else if(V.method==="throw"){if(j===x)throw j=w,V.arg;V.dispatchException(V.arg)}else V.method==="return"&&V.abrupt("return",V.arg);j=y;var z=v(at,P,V);if(z.type==="normal"){if(j=V.done?w:_,z.arg===S)continue;return{value:z.arg,done:V.done}}else z.type==="throw"&&(j=w,V.method="throw",V.arg=z.arg)}}}function rt(at,P){var V=P.method,j=at.iterator[V];if(j===a)return P.delegate=null,V==="throw"&&at.iterator.return&&(P.method="return",P.arg=a,rt(at,P),P.method==="throw")||V!=="return"&&(P.method="throw",P.arg=new TypeError("The iterator does not provide a '"+V+"' method")),S;var et=v(j,at.iterator,P.arg);if(et.type==="throw")return P.method="throw",P.arg=et.arg,P.delegate=null,S;var dt=et.arg;if(!dt)return P.method="throw",P.arg=new TypeError("iterator result is not an object"),P.delegate=null,S;if(dt.done)P[at.resultName]=dt.value,P.next=at.nextLoc,P.method!=="return"&&(P.method="next",P.arg=a);else return dt;return P.delegate=null,S}B(M),p(M,d,"Generator"),p(M,u,function(){return this}),p(M,"toString",function(){return"[object Generator]"});function L(at){var P={tryLoc:at[0]};1 in at&&(P.catchLoc=at[1]),2 in at&&(P.finallyLoc=at[2],P.afterLoc=at[3]),this.tryEntries.push(P)}function it(at){var P=at.completion||{};P.type="normal",delete P.arg,at.completion=P}function Z(at){this.tryEntries=[{tryLoc:"root"}],at.forEach(L,this),this.reset(!0)}e.keys=function(at){var P=Object(at),V=[];for(var j in P)V.push(j);return V.reverse(),function et(){for(;V.length;){var dt=V.pop();if(dt in P)return et.value=dt,et.done=!1,et}return et.done=!0,et}};function q(at){if(at){var P=at[u];if(P)return P.call(at);if(typeof at.next=="function")return at;if(!isNaN(at.length)){var V=-1,j=function et(){for(;++V<at.length;)if(i.call(at,V))return et.value=at[V],et.done=!1,et;return et.value=a,et.done=!0,et};return j.next=j}}return{next:Ct}}e.values=q;function Ct(){return{value:a,done:!0}}return Z.prototype={constructor:Z,reset:function(at){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(it),!at)for(var P in this)P.charAt(0)==="t"&&i.call(this,P)&&!isNaN(+P.slice(1))&&(this[P]=a)},stop:function(){this.done=!0;var at=this.tryEntries[0],P=at.completion;if(P.type==="throw")throw P.arg;return this.rval},dispatchException:function(at){if(this.done)throw at;var P=this;function V(Rt,z){return dt.type="throw",dt.arg=at,P.next=Rt,z&&(P.method="next",P.arg=a),!!z}for(var j=this.tryEntries.length-1;j>=0;--j){var et=this.tryEntries[j],dt=et.completion;if(et.tryLoc==="root")return V("end");if(et.tryLoc<=this.prev){var xt=i.call(et,"catchLoc"),Nt=i.call(et,"finallyLoc");if(xt&&Nt){if(this.prev<et.catchLoc)return V(et.catchLoc,!0);if(this.prev<et.finallyLoc)return V(et.finallyLoc)}else if(xt){if(this.prev<et.catchLoc)return V(et.catchLoc,!0)}else if(Nt){if(this.prev<et.finallyLoc)return V(et.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(at,P){for(var V=this.tryEntries.length-1;V>=0;--V){var j=this.tryEntries[V];if(j.tryLoc<=this.prev&&i.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var et=j;break}}et&&(at==="break"||at==="continue")&&et.tryLoc<=P&&P<=et.finallyLoc&&(et=null);var dt=et?et.completion:{};return dt.type=at,dt.arg=P,et?(this.method="next",this.next=et.finallyLoc,S):this.complete(dt)},complete:function(at,P){if(at.type==="throw")throw at.arg;return at.type==="break"||at.type==="continue"?this.next=at.arg:at.type==="return"?(this.rval=this.arg=at.arg,this.method="return",this.next="end"):at.type==="normal"&&P&&(this.next=P),S},finish:function(at){for(var P=this.tryEntries.length-1;P>=0;--P){var V=this.tryEntries[P];if(V.finallyLoc===at)return this.complete(V.completion,V.afterLoc),it(V),S}},catch:function(at){for(var P=this.tryEntries.length-1;P>=0;--P){var V=this.tryEntries[P];if(V.tryLoc===at){var j=V.completion;if(j.type==="throw"){var et=j.arg;it(V)}return et}}throw new Error("illegal catch attempt")},delegateYield:function(at,P,V){return this.delegate={iterator:q(at),resultName:P,nextLoc:V},this.method==="next"&&(this.arg=a),S}},e}(n.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(U_)),U_.exports}var z_,W2;function xb(){return W2||(W2=1,z_=(n,t)=>`${n}-${t}-${Math.random().toString(16).slice(3,8)}`),z_}var j_,q2;function LR(){if(q2)return j_;q2=1;const n=xb();let t=0;return j_=({id:e,action:r,payload:i={}})=>{let s=e;return typeof s>"u"&&(s=n("Job",t),t+=1),{id:s,action:r,payload:i}},j_}var ud={},Y2;function yb(){if(Y2)return ud;Y2=1;let n=!1;return ud.logging=n,ud.setLogging=t=>{n=t},ud.log=(...t)=>n?console.log.apply(this,t):null,ud}var H_,X2;function H9(){if(X2)return H_;X2=1;const n=LR(),{log:t}=yb(),e=xb();let r=0;return H_=()=>{const i=e("Scheduler",r),s={},a={};let l=[];r+=1;const u=()=>l.length,f=()=>Object.keys(s).length,d=()=>{if(l.length!==0){const _=Object.keys(s);for(let y=0;y<_.length;y+=1)if(typeof a[_[y]]>"u"){l[0](s[_[y]]);break}}},p=(_,y)=>new Promise((w,S)=>{const T=n({action:_,payload:y});l.push(async C=>{l.shift(),a[C.id]=T;try{w(await C[_].apply(this,[...y,T.id]))}catch(R){S(R)}finally{delete a[C.id],d()}}),t(`[${i}]: Add ${T.id} to JobQueue`),t(`[${i}]: JobQueue length=${l.length}`),d()});return{addWorker:_=>(s[_.id]=_,t(`[${i}]: Add ${_.id}`),t(`[${i}]: Number of workers=${f()}`),d(),_.id),addJob:async(_,...y)=>{if(f()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return p(_,y)},terminate:async()=>{Object.keys(s).forEach(async _=>{await s[_].terminate()}),l=[]},getQueueLen:u,getNumWorkers:f}},H_}function _d(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $_,K2;function $9(){return K2||(K2=1,$_=n=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof _d=="function"&&(t.type="node"),typeof n>"u"?t:t[n]}),$_}var G_,Z2;function G9(){if(Z2)return G_;Z2=1;const t=$9()("type")==="browser"?e=>new URL(e,window.location.href).href:e=>e;return G_=e=>{const r={...e};return["corePath","workerPath","langPath"].forEach(i=>{e[i]&&(r[i]=t(r[i]))}),r},G_}var V_,Q2;function IR(){return Q2||(Q2=1,V_={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),V_}const V9="6.0.1",W9={version:V9};var W_,J2;function q9(){return J2||(J2=1,W_={workerBlobURL:!0,logger:()=>{}}),W_}var q_,tT;function Y9(){if(tT)return q_;tT=1;const n=W9.version;return q_={...q9(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},q_}var Y_,eT;function X9(){return eT||(eT=1,Y_=({workerPath:n,workerBlobURL:t})=>{let e;if(Blob&&URL&&t){const r=new Blob([`importScripts("${n}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(r))}else e=new Worker(n);return e}),Y_}var X_,nT;function K9(){return nT||(nT=1,X_=n=>{n.terminate()}),X_}var K_,rT;function Z9(){return rT||(rT=1,K_=(n,t)=>{n.onmessage=({data:e})=>{t(e)}}),K_}var Z_,iT;function Q9(){return iT||(iT=1,Z_=async(n,t)=>{n.postMessage(t)}),Z_}var Q_,sT;function J9(){if(sT)return Q_;sT=1;const n=e=>new Promise((r,i)=>{const s=new FileReader;s.onload=()=>{r(s.result)},s.onerror=({target:{error:{code:a}}})=>{i(Error(`File could not be read! Code=${a}`))},s.readAsArrayBuffer(e)}),t=async e=>{let r=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?r=atob(e.split(",")[1]).split("").map(i=>i.charCodeAt(0)):r=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(r=await t(e.src)),e.tagName==="VIDEO"&&(r=await t(e.poster)),e.tagName==="CANVAS"&&await new Promise(i=>{e.toBlob(async s=>{r=await n(s),i()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const i=await e.convertToBlob();r=await n(i)}else(e instanceof File||e instanceof Blob)&&(r=await n(e));return new Uint8Array(r)};return Q_=t,Q_}var J_,aT;function tH(){if(aT)return J_;aT=1;const n=Y9(),t=X9(),e=K9(),r=Z9(),i=Q9(),s=J9();return J_={defaultOptions:n,spawnWorker:t,terminateWorker:e,onMessage:r,send:i,loadImage:s},J_}var tx,oT;function MR(){if(oT)return tx;oT=1;const n=G9(),t=LR(),{log:e}=yb(),r=xb(),i=IR(),{defaultOptions:s,spawnWorker:a,terminateWorker:l,onMessage:u,loadImage:f,send:d}=tH();let p=0;return tx=async(m="eng",v=i.LSTM_ONLY,x={},_={})=>{const y=r("Worker",p),{logger:w,errorHandler:S,...T}=n({...s,...x}),C={},R=typeof m=="string"?m.split("+"):m;let N=v,D=_;const I=[i.DEFAULT,i.LSTM_ONLY].includes(v)&&!T.legacyCore;let M,B;const H=new Promise((lt,J)=>{B=lt,M=J}),F=lt=>{M(lt.message)};let rt=a(T);rt.onerror=F,p+=1;const L=({id:lt,action:J,payload:ot})=>new Promise((yt,At)=>{e(`[${y}]: Start ${lt}, action=${J}`);const O=`${J}-${lt}`;C[O]={resolve:yt,reject:At},d(rt,{workerId:y,jobId:lt,action:J,payload:ot})}),it=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Z=lt=>L(t({id:lt,action:"load",payload:{options:{lstmOnly:I,corePath:T.corePath,logging:T.logging}}})),q=(lt,J,ot)=>L(t({id:ot,action:"FS",payload:{method:"writeFile",args:[lt,J]}})),Ct=(lt,J)=>L(t({id:J,action:"FS",payload:{method:"readFile",args:[lt,{encoding:"utf8"}]}})),at=(lt,J)=>L(t({id:J,action:"FS",payload:{method:"unlink",args:[lt]}})),P=(lt,J,ot)=>L(t({id:ot,action:"FS",payload:{method:lt,args:J}})),V=(lt,J)=>L(t({id:J,action:"loadLanguage",payload:{langs:lt,options:{langPath:T.langPath,dataPath:T.dataPath,cachePath:T.cachePath,cacheMethod:T.cacheMethod,gzip:T.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(N)&&!T.legacyLang}}})),j=(lt,J,ot,yt)=>L(t({id:yt,action:"initialize",payload:{langs:lt,oem:J,config:ot}})),et=(lt="eng",J,ot,yt)=>{if(I&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(J))throw Error("Legacy model requested but code missing.");const At=J||N;N=At;const O=ot||D;D=O;const ut=(typeof lt=="string"?lt.split("+"):lt).filter(K=>!R.includes(K));return R.push(...ut),ut.length>0?V(ut,yt).then(()=>j(lt,At,O,yt)):j(lt,At,O,yt)},dt=(lt={},J)=>L(t({id:J,action:"setParameters",payload:{params:lt}})),xt=async(lt,J={},ot={text:!0},yt)=>L(t({id:yt,action:"recognize",payload:{image:await f(lt),options:J,output:ot}})),Nt=async(lt,J)=>{if(I)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return L(t({id:J,action:"detect",payload:{image:await f(lt)}}))},Rt=async()=>(rt!==null&&(l(rt),rt=null),Promise.resolve());u(rt,({workerId:lt,jobId:J,status:ot,action:yt,data:At})=>{const O=`${yt}-${J}`;if(ot==="resolve")e(`[${lt}]: Complete ${J}`),C[O].resolve({jobId:J,data:At}),delete C[O];else if(ot==="reject")if(C[O].reject(At),delete C[O],yt==="load"&&M(At),S)S(At);else throw Error(At);else ot==="progress"&&w({...At,userJobId:J})});const z={id:y,worker:rt,load:it,writeText:q,readText:Ct,removeFile:at,FS:P,reinitialize:et,setParameters:dt,recognize:xt,detect:Nt,terminate:Rt};return Z().then(()=>V(m)).then(()=>j(m,v,_)).then(()=>B(z)).catch(()=>{}),H},tx}var ex,lT;function eH(){if(lT)return ex;lT=1;const n=MR();return ex={recognize:async(r,i,s)=>{const a=await n(i,1,s);return a.recognize(r).finally(async()=>{await a.terminate()})},detect:async(r,i)=>{const s=await n("osd",0,i);return s.detect(r).finally(async()=>{await s.terminate()})}},ex}var nx,cT;function nH(){return cT||(cT=1,nx={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),nx}var rx,uT;function rH(){return uT||(uT=1,rx={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),rx}var ix,fT;function iH(){if(fT)return ix;fT=1,j9();const n=H9(),t=MR(),e=eH(),r=nH(),i=IR(),s=rH(),{setLogging:a}=yb();return ix={languages:r,OEM:i,PSM:s,createScheduler:n,createWorker:t,setLogging:a,...e},ix}var sH=iH();const qm=async(n,t)=>{const e=document.createElement("canvas"),r=e.getContext("2d");return e.width=t.width,e.height=t.height,await n.render({canvasContext:r,viewport:t}).promise,e},aH=(n,t)=>{const e=document.createElement("canvas"),r=e.getContext("2d");return e.width=t.width,e.height=t.height,r.drawImage(n,t.x,t.y,t.width,t.height,0,0,t.width,t.height),e},oH=async(n,t)=>{const{data:e}=await t.recognize(n,{},{blocks:!0,text:!0});return e.blocks?.flatMap(i=>i.paragraphs)?.flatMap(i=>i.lines)??[]},lH=n=>{const e=[],r=[];return n.forEach((i,s)=>{const a=i.rowAttributes.rowHeight||20,l=n[s+1];r.push(i.text.trim());const u=s===n.length-1||i.baseline.y0+a*1.3<=l?.baseline.y0;console.log(`Linha ${s}: "${i.text.trim()}" | y0: ${i.baseline.y0} | altura: ${a} | quebra: ${u}`),u&&(e.push(r.join(" ")),console.log("📦 Bloco criado:",r.join(" ")),r.length=0)}),console.log("📋 Resultado final:",e),e},hT=(n,t)=>{let e=[];return t==="geology"?e=lH(n):n.forEach(r=>{e.push(r.text.trim())}),e},bm=async(n,t,e,r)=>{const i=t.getViewport({scale:2}),s=r||await qm(t,i),a=vd(n,1,2,i),l=aH(s,{x:a.x,y:i.height-a.y-a.height,width:a.width,height:a.height});return await oH(l,e)},cH=async(n,t,e,r)=>{const i=()=>{if(e?.aborted)throw new Error("Extração cancelada pelo usuário")};r?.({stage:"starting",message:"Iniciando extração..."});const s=[],a=n.filter(m=>m.isMandatory&&m.coordinates),l=t.numPages,u=n.find(m=>m.dataType==="hole_id"),f=n.filter(m=>!m.repeatInPages&&m.dataType!=="hole_id"),d=n.some(m=>m.ocr),p=d?await sH.createWorker("por"):null;i();try{let m=null,v=null;d&&(m=new Map,v=async(y,w)=>{if(m.has(w))return m.get(w);const S=y.getViewport({scale:2}),T=await qm(y,S);return m.set(w,T),T}),i();const x=async y=>{if(a.length===0)return!0;const w=await t.getPage(y),S=w.getViewport({scale:1}),T=await w.getTextContent();for(const C of a)if(C.ocr){if(!w||!p||!C.coordinates)continue;if((await bm(C.coordinates,w,p)).every(N=>!N.text.trim()))return!1}else{const R=vd(C.coordinates,1,1,S),N=pm(T,R);if(!mm(N,[]).join(" ").trim())return!1}return!0},_=[];for(let y=1;y<=l;y++)i(),r?.({stage:"validating",message:`Verificando páginas obrigatórias ${y}/${l}`}),await x(y)&&_.push(y);if(u&&u.coordinates){const y=u.name,w=[],S=[],T=[];let C=0;for(const N of _){i(),C++,r?.({stage:"hole_ids",message:`Extraindo IDs de sondagem da página ${C}/${_.length}`});const D=await t.getPage(N);let I="";if(u.ocr){if(!p)continue;I=(await bm(u.coordinates,D,p)).map(B=>B.text.trim()).filter(B=>B).join(" ").trim()}else{const M=await D.getTextContent(),B=D.getViewport({scale:1}),H=vd(u.coordinates,1,1,B),F=pm(M,H);F.sort((rt,L)=>L.transform[5]-rt.transform[5]),I=mm(F,[]).join(" ").trim()}if(w.push({page:N,holeId:I}),I){const M=s.find(B=>B[y]&&Array.isArray(B[y])&&B[y][0]===I);M?M.pageNumber.push(N):(T.push(I),s.push({pageNumber:[N],[y]:[I]}))}else S.push(N)}const R=n.filter(N=>N.repeatInPages);if(R.length>0){let N=0;for(const D of s){i(),N++,r?.({stage:"repeat_areas",message:`Processando áreas únicas da sondagem ${N}/${s.length}`});const I=D.pageNumber[0],M=await t.getPage(I),B=await M.getOperatorList(),H=await M.getTextContent(),F=M.getViewport({scale:1}),rt=dT(B),L=M.getViewport({scale:2}),it=v?await v(M,I):await qm(M,L);for(const Z of R)if(Z.coordinates)try{let q=[];if(Z.ocr){if(!p)continue;const Ct=await bm(Z.coordinates,M,p,it);q=hT(Ct,Z.dataType)}else{const Ct=vd(Z.coordinates,1,1,F),at=pm(H,Ct);at.sort((P,V)=>V.transform[5]-P.transform[5]),q=Z.dataType==="nspt"?BS(at):mm(at,rt)}D[Z.name]=zS(q,Z.dataType)}catch(q){console.error(`Erro ao processar área ${Z.name}: ${q}`),D[Z.name]=[]}}}}else for(const y of _)s.push({pageNumber:[y]});if(f.length>0){let y=0;for(const w of s){y++;let S=0;for(const T of w.pageNumber){i(),S++,r?.({stage:"non_repeat_areas",message:`Processando áreas não únicas da sondagem ${y}/${s.length}, página ${S}/${w.pageNumber.length} ...`});const C=await t.getPage(T),R=await C.getOperatorList(),N=await C.getTextContent(),D=C.getViewport({scale:1}),I=dT(R),M=C.getViewport({scale:2}),B=v?await v(C,T):await qm(C,M);for(const H of f)if(H.coordinates)try{let F=[];if(H.ocr){if(!p)continue;const it=await bm(H.coordinates,C,p,B);F=hT(it,H.dataType)}else{const it=vd(H.coordinates,1,1,D),Z=pm(N,it);Z.sort((q,Ct)=>Ct.transform[5]-q.transform[5]),F=H.dataType==="nspt"?BS(Z):mm(Z,I)}const rt=zS(F,H.dataType);w[H.name]||(w[H.name]=[]);const L=w[H.name];if(lO(H.dataType))rt.length>0&&(w[H.name]=rt);else{const it=[...rt];if(L.length>0&&it.length>0){const Z=L[L.length-1].trim().toLowerCase().replace(/\s+/g," "),q=it[0].trim().toLowerCase().replace(/\s+/g," ");Z===q&&it.shift()}L.push(...it)}}catch(F){console.error(`Erro ao processar área ${H.name}:`,F)}}}}return r?.({stage:"complete",message:"Finalizando extração..."}),s}finally{p&&await p.terminate()}},dT=n=>{const t=[];for(let e=0;e<n.fnArray.length;e++)if(n.fnArray[e]===91){const r=n.argsArray[e][1][0];for(let i=0;i<r.length;i++)if(r[i]===1&&i>=2){const s=r[i-2],a=r[i-1],l=r[i+1],u=r[i+2];Math.abs(a-u)<2&&t.push({x1:Math.min(s,l),x2:Math.max(s,l),y:a})}}return t},uH=({extractedTexts:n,isExtracting:t,fileName:e})=>{const r=n.length>0?Object.keys(n[0]).filter(i=>i!=="pageNumber"):[];return nt.jsx("div",{className:"data-panel mt-2",children:t?nt.jsxs(nt.Fragment,{children:[nt.jsx("span",{className:"spinner-border spinner-border-sm me-1"}),e?`Extraindo dados do arquivo ${e}`:"Extraindo..."]}):!n||n.length<=0?nt.jsx("div",{children:nt.jsx("p",{className:"text-muted",children:"Os dados extraídos serão exibidos aqui"})}):nt.jsxs(nt.Fragment,{children:[nt.jsx("h5",{className:"mb-3 pb-2 border-bottom",children:"Dados Extraídos"}),nt.jsx("div",{className:"data-table mb-3",style:{maxHeight:"65vh",overflowY:"auto"},children:nt.jsxs("table",{className:"table table-hover",children:[nt.jsx("thead",{children:nt.jsxs("tr",{children:[nt.jsx("th",{scope:"col",style:{minWidth:"100px"},children:"Páginas"}),r.map((i,s)=>nt.jsx("th",{scope:"col",style:{minWidth:"100px"},children:i.toString()},`coluna${s}`))]})}),nt.jsx("tbody",{children:n.map((i,s)=>nt.jsxs("tr",{children:[nt.jsx("th",{scope:"row",children:_5(i.pageNumber)}),r.map((a,l)=>{const u=i[a];return nt.jsx("td",{children:Array.isArray(u)?u.join(", "):"-"},`area-${l}`)})]},`coluna-pag-${s}`))})]})})]})})},fH=()=>nt.jsxs(nt.Fragment,{children:[nt.jsx("header",{children:nt.jsxs("div",{className:"d-flex align-items-center justify-content-between py-3",children:[nt.jsxs("div",{className:"d-flex gap-3",children:[nt.jsx("a",{href:"https://www.instagram.com/js.geologia/",target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none",title:"Instagram",children:nt.jsx("i",{className:"bi bi-instagram"})}),nt.jsx("a",{href:"https://www.linkedin.com/company/js-geologia-aplicada",target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none",title:"LinkedIn",children:nt.jsx("i",{className:"bi bi-linkedin"})})]}),nt.jsx("div",{className:"flex-grow-1 text-center",children:nt.jsx("a",{href:"https://www.jsgeo.com.br/",target:"_blank",rel:"noopener noreferrer",children:nt.jsx("img",{src:"js_logo_horizontal.png",alt:"JS Geologia Aplicada",style:{maxHeight:"60px"}})})}),nt.jsx("div",{style:{width:"56px"}})]})}),nt.jsx("hr",{style:{borderColor:"rgb(33,33,33)",borderWidth:"0.88px",padding:"0px 15px 0px 15px",margin:"4px 0px 4px 0px"}})]});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var dg={};dg.version="0.20.3";var Ro=1200,Wd=function(n){Ro=n};function hH(){Wd(1200)}var wm=function(t){return String.fromCharCode(t)},pT=function(t){return String.fromCharCode(t)},si="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function pg(n){for(var t="",e=0,r=0,i=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n.charCodeAt(f++),s=e>>2,r=n.charCodeAt(f++),a=(e&3)<<4|r>>4,i=n.charCodeAt(f++),l=(r&15)<<2|i>>6,u=i&63,isNaN(r)?l=u=64:isNaN(i)&&(u=64),t+=si.charAt(s)+si.charAt(a)+si.charAt(l)+si.charAt(u);return t}function dH(n){for(var t="",e=0,r=0,i=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n.charCodeAt(f++),e>255&&(e=95),s=e>>2,r=n.charCodeAt(f++),r>255&&(r=95),a=(e&3)<<4|r>>4,i=n.charCodeAt(f++),i>255&&(i=95),l=(r&15)<<2|i>>6,u=i&63,isNaN(r)?l=u=64:isNaN(i)&&(u=64),t+=si.charAt(s)+si.charAt(a)+si.charAt(l)+si.charAt(u);return t}function pH(n){for(var t="",e=0,r=0,i=0,s=0,a=0,l=0,u=0,f=0;f<n.length;)e=n[f++],s=e>>2,r=n[f++],a=(e&3)<<4|r>>4,i=n[f++],l=(r&15)<<2|i>>6,u=i&63,isNaN(r)?l=u=64:isNaN(i)&&(u=64),t+=si.charAt(s)+si.charAt(a)+si.charAt(l)+si.charAt(u);return t}function Ll(n){var t="",e=0,r=0,i=0,s=0,a=0,l=0,u=0;if(n.slice(0,5)=="data:"){var f=n.slice(0,1024).indexOf(";base64,");f>-1&&(n=n.slice(f+8))}n=n.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<n.length;)s=si.indexOf(n.charAt(f++)),a=si.indexOf(n.charAt(f++)),e=s<<2|a>>4,t+=String.fromCharCode(e),l=si.indexOf(n.charAt(f++)),r=(a&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(r)),u=si.indexOf(n.charAt(f++)),i=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var fn=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ya=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}(),mg=function(){if(typeof Buffer>"u")return!1;var n=Ya([65,0]);if(!n)return!1;var t=n.toString("utf16le");return t.length==1}();function Mc(n){return fn?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function mT(n){return fn?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var os=function(t){return fn?Ya(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function av(n){if(typeof ArrayBuffer>"u")return os(n);for(var t=new ArrayBuffer(n.length),e=new Uint8Array(t),r=0;r!=n.length;++r)e[r]=n.charCodeAt(r)&255;return t}function Pc(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],e=0;e<n.length;++e)t[e]=String.fromCharCode(n[e]);return t.join("")}function mH(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var fr=fn?function(n){return Buffer.concat(n.map(function(t){return Buffer.isBuffer(t)?t:Ya(t)}))}:function(n){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<n.length;++t)e+=n[t].length;var r=new Uint8Array(e),i=0;for(t=0,e=0;t<n.length;e+=i,++t)i=n[t].length,n[t]instanceof Uint8Array?r.set(n[t],e):typeof n[t]=="string"?r.set(new Uint8Array(os(n[t])),e):r.set(new Uint8Array(n[t]),e);return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function gH(n){for(var t=[],e=0,r=n.length+250,i=Mc(n.length+255),s=0;s<n.length;++s){var a=n.charCodeAt(s);if(a<128)i[e++]=a;else if(a<2048)i[e++]=192|a>>6&31,i[e++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=n.charCodeAt(++s)&1023;i[e++]=240|a>>8&7,i[e++]=128|a>>2&63,i[e++]=128|l>>6&15|(a&3)<<4,i[e++]=128|l&63}else i[e++]=224|a>>12&15,i[e++]=128|a>>6&63,i[e++]=128|a&63;e>r&&(t.push(i.slice(0,e)),e=0,i=Mc(65535),r=65530)}return t.push(i.slice(0,e)),fr(t)}var Td=/\u0000/g,Em=/[\u0001-\u0006]/g;function Qu(n){for(var t="",e=n.length-1;e>=0;)t+=n.charAt(e--);return t}function oa(n,t){var e=""+n;return e.length>=t?e:Bn("0",t-e.length)+e}function bb(n,t){var e=""+n;return e.length>=t?e:Bn(" ",t-e.length)+e}function gg(n,t){var e=""+n;return e.length>=t?e:e+Bn(" ",t-e.length)}function vH(n,t){var e=""+Math.round(n);return e.length>=t?e:Bn("0",t-e.length)+e}function _H(n,t){var e=""+n;return e.length>=t?e:Bn("0",t-e.length)+e}var gT=Math.pow(2,32);function Bu(n,t){if(n>gT||n<-gT)return vH(n,t);var e=Math.round(n);return _H(e,t)}function vg(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var vT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],sx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function xH(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',n}var Ln={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},_T={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yH={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _g(n,t,e){for(var r=n<0?-1:1,i=n*r,s=0,a=1,l=0,u=1,f=0,d=0,p=Math.floor(i);f<t&&(p=Math.floor(i),l=p*a+s,d=p*f+u,!(i-p<5e-8));)i=1/(i-p),s=a,a=l,u=f,f=d;if(d>t&&(f>t?(d=u,l=s):(d=f,l=a)),!e)return[0,r*l,d];var m=Math.floor(r*l/d);return[m,r*l-m*d,d]}function bH(n){var t=n.toPrecision(16);if(t.indexOf("e")>-1){var e=t.slice(0,t.indexOf("e"));return e=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+Bn("0",e.length-15),e+t.slice(t.indexOf("e"))}var r=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Bn("0",t.length-15);return Number(r)}function Uu(n,t,e){if(n>2958465||n<0)return null;n=bH(n);var r=n|0,i=Math.floor(86400*(n-r)),s=0,a=[],l={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(r+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++r,++l.D)),r===60)a=e?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=e?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),a=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),r<60&&(s=(s+6)%7),e&&(s=TH(u,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}function wb(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function wH(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function EH(n){var t=n<0?12:11,e=wb(n.toFixed(12));return e.length<=t||(e=n.toPrecision(10),e.length<=t)?e:n.toExponential(5)}function AH(n){var t=wb(n.toFixed(11));return t.length>(n<0?12:11)||t==="0"||t==="-0"?n.toPrecision(6):t}function SH(n){if(!isFinite(n))return isNaN(n)?"#NUM!":"#DIV/0!";var t=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),e;return t>=-4&&t<=-1?e=n.toPrecision(10+t):Math.abs(t)<=9?e=EH(n):t===10?e=n.toFixed(10).substr(0,12):e=AH(n),wb(wH(e.toUpperCase()))}function Qx(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):SH(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return zo(14,$r(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}function TH(n,t){t[0]-=581;var e=n.getDay();return n<60&&(e=(e+6)%7),e}function CH(n,t,e,r){var i="",s=0,a=0,l=e.y,u,f=0;switch(n){case 98:l=e.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=e.m,f=t.length;break;case 3:return sx[e.m-1][1];case 5:return sx[e.m-1][0];default:return sx[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=e.d,f=t.length;break;case 3:return vT[e.q][0];default:return vT[e.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(e.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=e.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=e.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?oa(e.S,t.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(e.S+e.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=oa(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=e.D*24+e.H;break;case"[m]":case"[mm]":u=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":u=((e.D*24+e.H)*60+e.M)*60+(r==0?Math.round(e.S+e.u):e.S);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var d=f>0?oa(u,f):"";return d}function Al(n){var t=3;if(n.length<=t)return n;for(var e=n.length%t,r=n.substr(0,e);e!=n.length;e+=t)r+=(r.length>0?",":"")+n.substr(e,t);return r}var PR=/%/g;function DH(n,t,e){var r=t.replace(PR,""),i=t.length-r.length;return Io(n,r,e*Math.pow(10,2*i))+Bn("%",i)}function OH(n,t,e){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Io(n,t.substr(0,r),e/Math.pow(10,3*(t.length-r)))}function FR(n,t){var e,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+FR(n,-t);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),e=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),e.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else e=t.toExponential(r);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var BR=/# (\?+)( ?)\/( ?)(\d+)/;function RH(n,t,e){var r=parseInt(n[4],10),i=Math.round(t*r),s=Math.floor(i/r),a=i-s*r,l=r;return e+(s===0?"":""+s)+" "+(a===0?Bn(" ",n[1].length+1+n[4].length):bb(a,n[1].length)+n[2]+"/"+n[3]+oa(l,n[4].length))}function NH(n,t,e){return e+(t===0?"":""+t)+Bn(" ",n[1].length+2+n[4].length)}var UR=/^#*0*\.([0#]+)/,zR=/\)[^)]*[0#]/,jR=/\(###\) ###\\?-####/;function wi(n){for(var t="",e,r=0;r!=n.length;++r)switch(e=n.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function xT(n,t){var e=Math.pow(10,t);return""+Math.round(n*e)/e}function yT(n,t){var e=n-Math.floor(n),r=Math.pow(10,t);return t<(""+Math.round(e*r)).length?0:Math.round(e*r)}function kH(n,t){return t<(""+Math.round((n-Math.floor(n))*Math.pow(10,t))).length?1:0}function LH(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ls(n,t,e){if(n.charCodeAt(0)===40&&!t.match(zR)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ls("n",r,e):"("+Ls("n",r,-e)+")"}if(t.charCodeAt(t.length-1)===44)return OH(n,t,e);if(t.indexOf("%")!==-1)return DH(n,t,e);if(t.indexOf("E")!==-1)return FR(t,e);if(t.charCodeAt(0)===36)return"$"+Ls(n,t.substr(t.charAt(1)==" "?2:1),e);var i,s,a,l,u=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+Bu(u,t.length);if(t.match(/^[#?]+$/))return i=Bu(e,0),i==="0"&&(i=""),i.length>t.length?i:wi(t.substr(0,t.length-i.length))+i;if(s=t.match(BR))return RH(s,u,f);if(t.match(/^#+0+$/))return f+Bu(u,t.length-t.indexOf("0"));if(s=t.match(UR))return i=xT(e,s[1].length).replace(/^([^\.]+)$/,"$1."+wi(s[1])).replace(/\.$/,"."+wi(s[1])).replace(/\.(\d*)$/,function(x,_){return"."+_+Bn("0",wi(s[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+xT(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+Al(Bu(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ls(n,t,-e):Al(""+(Math.floor(e)+kH(e,s[1].length)))+"."+oa(yT(e,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ls(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qu(Ls(n,t.replace(/[\\-]/g,""),e)),a=0,Qu(Qu(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(t.match(jR))return i=Ls(n,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=_g(u,Math.pow(10,a)-1,!1),i=""+f,d=Io("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=gg(l[2],a),d.length<s[4].length&&(d=wi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=_g(u,Math.pow(10,a)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?bb(l[1],a)+s[2]+"/"+s[3]+gg(l[2],a):Bn(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Bu(e,0),t.length<=i.length?i:wi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=t.indexOf(".")-a,m=t.length-i.length-p;return wi(t.substr(0,p)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=yT(e,s[1].length),e<0?"-"+Ls(n,t,-e):Al(LH(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?oa(0,3-x.length):"")+x})+"."+oa(a,s[1].length);switch(t){case"###,##0.00":return Ls(n,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var v=Al(Bu(u,0));return v!=="0"?f+v:"";case"###,###.00":return Ls(n,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Ls(n,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function IH(n,t,e){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Io(n,t.substr(0,r),e/Math.pow(10,3*(t.length-r)))}function MH(n,t,e){var r=t.replace(PR,""),i=t.length-r.length;return Io(n,r,e*Math.pow(10,2*i))+Bn("%",i)}function HR(n,t){var e,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+HR(n,-t);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),e=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!e.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+s):e+="E+"+(a-s),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else e=t.toExponential(r);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Ma(n,t,e){if(n.charCodeAt(0)===40&&!t.match(zR)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ma("n",r,e):"("+Ma("n",r,-e)+")"}if(t.charCodeAt(t.length-1)===44)return IH(n,t,e);if(t.indexOf("%")!==-1)return MH(n,t,e);if(t.indexOf("E")!==-1)return HR(t,e);if(t.charCodeAt(0)===36)return"$"+Ma(n,t.substr(t.charAt(1)==" "?2:1),e);var i,s,a,l,u=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+oa(u,t.length);if(t.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>t.length?i:wi(t.substr(0,t.length-i.length))+i;if(s=t.match(BR))return NH(s,u,f);if(t.match(/^#+0+$/))return f+oa(u,t.length-t.indexOf("0"));if(s=t.match(UR))return i=(""+e).replace(/^([^\.]+)$/,"$1."+wi(s[1])).replace(/\.$/,"."+wi(s[1])),i=i.replace(/\.(\d*)$/,function(x,_){return"."+_+Bn("0",wi(s[1]).length-_.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+Al(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ma(n,t,-e):Al(""+e)+"."+Bn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ma(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Qu(Ma(n,t.replace(/[\\-]/g,""),e)),a=0,Qu(Qu(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<i.length?i.charAt(a++):x==="0"?"0":""}));if(t.match(jR))return i=Ma(n,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),l=_g(u,Math.pow(10,a)-1,!1),i=""+f,d=Io("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=gg(l[2],a),d.length<s[4].length&&(d=wi(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),l=_g(u,Math.pow(10,a)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?bb(l[1],a)+s[2]+"/"+s[3]+gg(l[2],a):Bn(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+e,t.length<=i.length?i:wi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var p=t.indexOf(".")-a,m=t.length-i.length-p;return wi(t.substr(0,p)+i+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Ma(n,t,-e):Al(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?oa(0,3-x.length):"")+x})+"."+oa(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=Al(""+u);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return Ma(n,t.slice(0,t.lastIndexOf(".")),e)+wi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Io(n,t,e){return(e|0)===e?Ma(n,t,e):Ls(n,t,e)}function PH(n){for(var t=[],e=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:e=!e;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=n.substr(i,r-i),i=r+1}if(t[t.length]=n.substr(i),e===!0)throw new Error("Format |"+n+"| unterminated string ");return t}var $R=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fc(n){for(var t=0,e="",r="";t<n.length;)switch(e=n.charAt(t)){case"G":vg(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(r=e;n.charAt(t++)!=="]"&&t<n.length;)r+=n.charAt(t);if(r.match($R))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(e=n.charAt(++t))>-1||e=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===e;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function FH(n,t,e,r){for(var i=[],s="",a=0,l="",u="t",f,d,p,m="H";a<n.length;)switch(l=n.charAt(a)){case"G":if(!vg(n,a))throw new Error("unrecognized character "+l+" in "+n);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(p=n.charCodeAt(++a))!==34&&a<n.length;)s+=String.fromCharCode(p);i[i.length]={t:"t",v:s},++a;break;case"\\":var v=n.charAt(++a),x=v==="("||v===")"?v:"t";i[i.length]={t:x,v},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(n.charAt(a+1)==="1"||n.charAt(a+1)==="2"){if(f==null&&(f=Uu(t,e,n.charAt(a+1)==="2"),f==null))return"";i[i.length]={t:"X",v:n.substr(a,2)},u=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Uu(t,e),f==null))return"";for(s=l;++a<n.length&&n.charAt(a).toLowerCase()===l;)s+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=m),i[i.length]={t:l,v:s},u=l;break;case"A":case"a":case"上":var _={t:l,v:l};if(f==null&&(f=Uu(t,e)),n.substr(a,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?n.charAt(a+2):l),_.t="T",m="h",a+=3):n.substr(a,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",a+=5,m="h"):n.substr(a,5).toUpperCase()==="上午/下午"?(f!=null&&(_.v=f.H>=12?"下午":"上午"),_.t="T",a+=5,m="h"):(_.t="t",++a),f==null&&_.t==="T")return"";i[i.length]=_,u=l;break;case"[":for(s=l;n.charAt(a++)!=="]"&&a<n.length;)s+=n.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($R)){if(f==null&&(f=Uu(t,e),f==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fc(n)||(i[i.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=l;++a<n.length&&(l=n.charAt(a))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++a<n.length&&"0#?.,E+-%".indexOf(l=n.charAt(a))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;n.charAt(++a)===l;)s+=l;i[i.length]={t:l,v:s},u=l;break;case"*":++a,(n.charAt(a)==" "||n.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;a<n.length&&"0123456789".indexOf(n.charAt(++a))>-1;)s+=n.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+n);i[i.length]={t:"t",v:l},++a;break}var y=0,w=0,S;for(a=i.length-1,u="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,u="h",y<1&&(y=1);break;case"s":(S=i[a].v.match(/\.0+$/))&&(w=Math.max(w,S[0].length-1),y=4),y<3&&(y=3);case"d":case"y":case"e":u=i[a].t;break;case"M":u=i[a].t,y<2&&(y=2);break;case"m":u==="s"&&(i[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[a].v.match(/[Hh]/)&&(y=1),y<2&&i[a].v.match(/[Mm]/)&&(y=2),y<3&&i[a].v.match(/[Ss]/)&&(y=3)}var T;switch(y){case 0:break;case 1:case 2:case 3:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H),f.H>=24&&(f.H=0,++f.D,T=Uu(f.D),T.u=f.u,T.S=f.S,T.M=f.M,T.H=f.H,f=T);break;case 4:switch(w){case 1:f.u=Math.round(f.u*10)/10;break;case 2:f.u=Math.round(f.u*100)/100;break;case 3:f.u=Math.round(f.u*1e3)/1e3;break}f.u>=1&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H),f.H>=24&&(f.H=0,++f.D,T=Uu(f.D),T.u=f.u,T.S=f.S,T.M=f.M,T.H=f.H,f=T);break}var C="",R;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=CH(i[a].t.charCodeAt(0),i[a].v,f,w),i[a].t="t";break;case"n":case"?":for(R=a+1;i[R]!=null&&((l=i[R].t)==="?"||l==="D"||(l===" "||l==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[a].v+=i[R].v,i[R]={v:"",t:";"},++R;C+=i[a].v,a=R-1;break;case"G":i[a].t="t",i[a].v=Qx(t,e);break}var N="",D,I;if(C.length>0){C.charCodeAt(0)==40?(D=t<0&&C.charCodeAt(0)===45?-t:t,I=Io("n",C,D)):(D=t<0&&r>1?-t:t,I=Io("n",C,D),D<0&&i[0]&&i[0].t=="t"&&(I=I.substr(1),i[0].v="-"+i[0].v)),R=I.length-1;var M=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){M=a;break}var B=i.length;if(M===i.length&&I.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(R>=i[a].v.length-1?(R-=i[a].v.length,i[a].v=I.substr(R+1,i[a].v.length)):R<0?i[a].v="":(i[a].v=I.substr(0,R+1),R=-1),i[a].t="t",B=a);R>=0&&B<i.length&&(i[B].v=I.substr(0,R+1)+i[B].v)}else if(M!==i.length&&I.indexOf("E")===-1){for(R=I.indexOf(".")-1,a=M;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(d=i[a].v.indexOf(".")>-1&&a===M?i[a].v.indexOf(".")-1:i[a].v.length-1,N=i[a].v.substr(d+1);d>=0;--d)R>=0&&(i[a].v.charAt(d)==="0"||i[a].v.charAt(d)==="#")&&(N=I.charAt(R--)+N);i[a].v=N,i[a].t="t",B=a}for(R>=0&&B<i.length&&(i[B].v=I.substr(0,R+1)+i[B].v),R=I.indexOf(".")+1,a=M;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==M)){for(d=i[a].v.indexOf(".")>-1&&a===M?i[a].v.indexOf(".")+1:0,N=i[a].v.substr(0,d);d<i[a].v.length;++d)R<I.length&&(N+=I.charAt(R++));i[a].v=N,i[a].t="t",B=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(D=r>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Io(i[a].t,i[a].v,D),i[a].t="t");var H="";for(a=0;a!==i.length;++a)i[a]!=null&&(H+=i[a].v);return H}var bT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function wT(n,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(n==e)return!0;break;case">":if(n>e)return!0;break;case"<":if(n<e)return!0;break;case"<>":if(n!=e)return!0;break;case">=":if(n>=e)return!0;break;case"<=":if(n<=e)return!0;break}return!1}function BH(n,t){var e=PH(n),r=e.length,i=e[r-1].indexOf("@");if(r<4&&i>-1&&--r,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(typeof t=="number"&&!isFinite(t)&&(t=0),e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var s=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[r,s];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var a=e[0].match(bT),l=e[1].match(bT);return wT(t,a)?[r,e[0]]:wT(t,l)?[r,e[1]]:[r,e[a!=null&&l!=null?2:1]]}return[r,s]}function zo(n,t,e){e==null&&(e={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&e.dateNF?r=e.dateNF:r=n;break;case"number":n==14&&e.dateNF?r=e.dateNF:r=(e.table!=null?e.table:Ln)[n],r==null&&(r=e.table&&e.table[_T[n]]||Ln[_T[n]]),r==null&&(r=yH[n]||"General");break}if(vg(r,0))return Qx(t,e);t instanceof Date&&(t=$r(t,e.date1904));var i=BH(r,t);if(vg(i[1]))return Qx(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else{if(t===""||t==null)return"";if(isNaN(t)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(t)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return FH(i[1],t,e,i[0])}function GR(n,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(Ln[e]==null){t<0&&(t=e);continue}if(Ln[e]==n){t=e;break}}t<0&&(t=391)}return Ln[t]=n,t}function ov(n){for(var t=0;t!=392;++t)n[t]!==void 0&&GR(n[t],t)}function lv(){Ln=xH()}var xg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function UH(n){var t=typeof n=="number"?Ln[n]:n;return t=t.replace(xg,"(\\d+)"),xg.lastIndex=0,new RegExp("^"+t+"$")}function zH(n,t,e){var r=-1,i=-1,s=-1,a=-1,l=-1,u=-1;(t.match(xg)||[]).forEach(function(p,m){var v=parseInt(e[m+1],10);switch(p.toLowerCase().charAt(0)){case"y":r=v;break;case"d":s=v;break;case"h":a=v;break;case"s":u=v;break;case"m":a>=0?l=v:i=v;break}}),xg.lastIndex=0,u>=0&&l==-1&&i>=0&&(l=i,i=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return a==-1&&l==-1&&u==-1?f:r==-1&&i==-1&&s==-1?d:f+"T"+d}var jH={"d.m":"d\\.m"};function HH(n,t){return GR(jH[n]||n,t)}var ET=function(){var n={};n.version="1.2.0";function t(){for(var D=0,I=new Array(256),M=0;M!=256;++M)D=M,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,I[M]=D;return typeof Int32Array<"u"?new Int32Array(I):I}var e=t();function r(D){var I=0,M=0,B=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)H[B]=D[B];for(B=0;B!=256;++B)for(M=D[B],I=256+B;I<4096;I+=256)M=H[I]=M>>>8^D[M&255];var F=[];for(B=1;B!=16;++B)F[B-1]=typeof Int32Array<"u"&&typeof H.subarray=="function"?H.subarray(B*256,B*256+256):H.slice(B*256,B*256+256);return F}var i=r(e),s=i[0],a=i[1],l=i[2],u=i[3],f=i[4],d=i[5],p=i[6],m=i[7],v=i[8],x=i[9],_=i[10],y=i[11],w=i[12],S=i[13],T=i[14];function C(D,I){for(var M=I^-1,B=0,H=D.length;B<H;)M=M>>>8^e[(M^D.charCodeAt(B++))&255];return~M}function R(D,I){for(var M=I^-1,B=D.length-15,H=0;H<B;)M=T[D[H++]^M&255]^S[D[H++]^M>>8&255]^w[D[H++]^M>>16&255]^y[D[H++]^M>>>24]^_[D[H++]]^x[D[H++]]^v[D[H++]]^m[D[H++]]^p[D[H++]]^d[D[H++]]^f[D[H++]]^u[D[H++]]^l[D[H++]]^a[D[H++]]^s[D[H++]]^e[D[H++]];for(B+=15;H<B;)M=M>>>8^e[(M^D[H++])&255];return~M}function N(D,I){for(var M=I^-1,B=0,H=D.length,F=0,rt=0;B<H;)F=D.charCodeAt(B++),F<128?M=M>>>8^e[(M^F)&255]:F<2048?(M=M>>>8^e[(M^(192|F>>6&31))&255],M=M>>>8^e[(M^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,rt=D.charCodeAt(B++)&1023,M=M>>>8^e[(M^(240|F>>8&7))&255],M=M>>>8^e[(M^(128|F>>2&63))&255],M=M>>>8^e[(M^(128|rt>>6&15|(F&3)<<4))&255],M=M>>>8^e[(M^(128|rt&63))&255]):(M=M>>>8^e[(M^(224|F>>12&15))&255],M=M>>>8^e[(M^(128|F>>6&63))&255],M=M>>>8^e[(M^(128|F&63))&255]);return~M}return n.table=e,n.bstr=C,n.buf=R,n.str=N,n}(),Rn=function(){var t={};t.version="1.2.2";function e(W,ft){for(var tt=W.split("/"),st=ft.split("/"),ct=0,ht=0,Pt=Math.min(tt.length,st.length);ct<Pt;++ct){if(ht=tt[ct].length-st[ct].length)return ht;if(tt[ct]!=st[ct])return tt[ct]<st[ct]?-1:1}return tt.length-st.length}function r(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:r(W.slice(0,-1));var ft=W.lastIndexOf("/");return ft===-1?W:W.slice(0,ft+1)}function i(W){if(W.charAt(W.length-1)=="/")return i(W.slice(0,-1));var ft=W.lastIndexOf("/");return ft===-1?W:W.slice(ft+1)}function s(W,ft){typeof ft=="string"&&(ft=new Date(ft));var tt=ft.getHours();tt=tt<<6|ft.getMinutes(),tt=tt<<5|ft.getSeconds()>>>1,W.write_shift(2,tt);var st=ft.getFullYear()-1980;st=st<<4|ft.getMonth()+1,st=st<<5|ft.getDate(),W.write_shift(2,st)}function a(W){var ft=W.read_shift(2)&65535,tt=W.read_shift(2)&65535,st=new Date,ct=tt&31;tt>>>=5;var ht=tt&15;tt>>>=4,st.setMilliseconds(0),st.setFullYear(tt+1980),st.setMonth(ht-1),st.setDate(ct);var Pt=ft&31;ft>>>=5;var $t=ft&63;return ft>>>=6,st.setHours(ft),st.setMinutes($t),st.setSeconds(Pt<<1),st}function l(W){Ei(W,0);for(var ft={},tt=0;W.l<=W.length-4;){var st=W.read_shift(2),ct=W.read_shift(2),ht=W.l+ct,Pt={};switch(st){case 21589:tt=W.read_shift(1),tt&1&&(Pt.mtime=W.read_shift(4)),ct>5&&(tt&2&&(Pt.atime=W.read_shift(4)),tt&4&&(Pt.ctime=W.read_shift(4))),Pt.mtime&&(Pt.mt=new Date(Pt.mtime*1e3));break;case 1:{var $t=W.read_shift(4),Et=W.read_shift(4);Pt.usz=Et*Math.pow(2,32)+$t,$t=W.read_shift(4),Et=W.read_shift(4),Pt.csz=Et*Math.pow(2,32)+$t}break}W.l=ht,ft[st]=Pt}return ft}var u;function f(){return u||(u=$H)}function d(W,ft){if(W[0]==80&&W[1]==75)return Xa(W,ft);if((W[0]|32)==109&&(W[1]|32)==105)return fa(W,ft);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var tt=3,st=512,ct=0,ht=0,Pt=0,$t=0,Et=0,kt=[],Lt=W.slice(0,512);Ei(Lt,0);var Wt=p(Lt);switch(tt=Wt[0],tt){case 3:st=512;break;case 4:st=4096;break;case 0:if(Wt[1]==0)return Xa(W,ft);default:throw new Error("Major Version: Expected 3 or 4 saw "+tt)}st!==512&&(Lt=W.slice(0,st),Ei(Lt,28));var ee=W.slice(0,st);m(Lt,tt);var le=Lt.read_shift(4,"i");if(tt===3&&le!==0)throw new Error("# Directory Sectors: Expected 0 saw "+le);Lt.l+=4,Pt=Lt.read_shift(4,"i"),Lt.l+=4,Lt.chk("00100000","Mini Stream Cutoff Size: "),$t=Lt.read_shift(4,"i"),ct=Lt.read_shift(4,"i"),Et=Lt.read_shift(4,"i"),ht=Lt.read_shift(4,"i");for(var Qt=-1,re=0;re<109&&(Qt=Lt.read_shift(4,"i"),!(Qt<0));++re)kt[re]=Qt;var Ie=v(W,st);y(Et,ht,Ie,st,kt);var sn=S(Ie,Pt,kt,st);Pt<sn.length&&(sn[Pt].name="!Directory"),ct>0&&$t!==rt&&(sn[$t].name="!MiniFAT"),sn[kt[0]].name="!FAT",sn.fat_addrs=kt,sn.ssz=st;var Ze={},dn=[],qi=[],xs=[];T(Pt,sn,Ie,dn,ct,Ze,qi,$t),x(qi,xs,dn),dn.shift();var ci={FileIndex:qi,FullPaths:xs};return ft&&ft.raw&&(ci.raw={header:ee,sectors:Ie}),ci}function p(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(L,"Header Signature: "),W.l+=16;var ft=W.read_shift(2,"u");return[W.read_shift(2,"u"),ft]}function m(W,ft){var tt=9;switch(W.l+=2,tt=W.read_shift(2)){case 9:if(ft!=3)throw new Error("Sector Shift: Expected 9 saw "+tt);break;case 12:if(ft!=4)throw new Error("Sector Shift: Expected 12 saw "+tt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+tt)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function v(W,ft){for(var tt=Math.ceil(W.length/ft)-1,st=[],ct=1;ct<tt;++ct)st[ct-1]=W.slice(ct*ft,(ct+1)*ft);return st[tt-1]=W.slice(tt*ft),st}function x(W,ft,tt){for(var st=0,ct=0,ht=0,Pt=0,$t=0,Et=tt.length,kt=[],Lt=[];st<Et;++st)kt[st]=Lt[st]=st,ft[st]=tt[st];for(;$t<Lt.length;++$t)st=Lt[$t],ct=W[st].L,ht=W[st].R,Pt=W[st].C,kt[st]===st&&(ct!==-1&&kt[ct]!==ct&&(kt[st]=kt[ct]),ht!==-1&&kt[ht]!==ht&&(kt[st]=kt[ht])),Pt!==-1&&(kt[Pt]=st),ct!==-1&&st!=kt[st]&&(kt[ct]=kt[st],Lt.lastIndexOf(ct)<$t&&Lt.push(ct)),ht!==-1&&st!=kt[st]&&(kt[ht]=kt[st],Lt.lastIndexOf(ht)<$t&&Lt.push(ht));for(st=1;st<Et;++st)kt[st]===st&&(ht!==-1&&kt[ht]!==ht?kt[st]=kt[ht]:ct!==-1&&kt[ct]!==ct&&(kt[st]=kt[ct]));for(st=1;st<Et;++st)if(W[st].type!==0){if($t=st,$t!=kt[$t])do $t=kt[$t],ft[st]=ft[$t]+"/"+ft[st];while($t!==0&&kt[$t]!==-1&&$t!=kt[$t]);kt[st]=-1}for(ft[0]+="/",st=1;st<Et;++st)W[st].type!==2&&(ft[st]+="/")}function _(W,ft,tt){for(var st=W.start,ct=W.size,ht=[],Pt=st;tt&&ct>0&&Pt>=0;)ht.push(ft.slice(Pt*F,Pt*F+F)),ct-=F,Pt=_c(tt,Pt*4);return ht.length===0?Ut(0):fr(ht).slice(0,W.size)}function y(W,ft,tt,st,ct){var ht=rt;if(W===rt){if(ft!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var Pt=tt[W],$t=(st>>>2)-1;if(!Pt)return;for(var Et=0;Et<$t&&(ht=_c(Pt,Et*4))!==rt;++Et)ct.push(ht);ft>=1&&y(_c(Pt,st-4),ft-1,tt,st,ct)}}function w(W,ft,tt,st,ct){var ht=[],Pt=[];ct||(ct=[]);var $t=st-1,Et=0,kt=0;for(Et=ft;Et>=0;){ct[Et]=!0,ht[ht.length]=Et,Pt.push(W[Et]);var Lt=tt[Math.floor(Et*4/st)];if(kt=Et*4&$t,st<4+kt)throw new Error("FAT boundary crossed: "+Et+" 4 "+st);if(!W[Lt])break;Et=_c(W[Lt],kt)}return{nodes:ht,data:RT([Pt])}}function S(W,ft,tt,st){var ct=W.length,ht=[],Pt=[],$t=[],Et=[],kt=st-1,Lt=0,Wt=0,ee=0,le=0;for(Lt=0;Lt<ct;++Lt)if($t=[],ee=Lt+ft,ee>=ct&&(ee-=ct),!Pt[ee]){Et=[];var Qt=[];for(Wt=ee;Wt>=0;){Qt[Wt]=!0,Pt[Wt]=!0,$t[$t.length]=Wt,Et.push(W[Wt]);var re=tt[Math.floor(Wt*4/st)];if(le=Wt*4&kt,st<4+le)throw new Error("FAT boundary crossed: "+Wt+" 4 "+st);if(!W[re]||(Wt=_c(W[re],le),Qt[Wt]))break}ht[ee]={nodes:$t,data:RT([Et])}}return ht}function T(W,ft,tt,st,ct,ht,Pt,$t){for(var Et=0,kt=st.length?2:0,Lt=ft[W].data,Wt=0,ee=0,le;Wt<Lt.length;Wt+=128){var Qt=Lt.slice(Wt,Wt+128);Ei(Qt,64),ee=Qt.read_shift(2),le=Db(Qt,0,ee-kt),st.push(le);var re={name:le,type:Qt.read_shift(1),color:Qt.read_shift(1),L:Qt.read_shift(4,"i"),R:Qt.read_shift(4,"i"),C:Qt.read_shift(4,"i"),clsid:Qt.read_shift(16),state:Qt.read_shift(4,"i"),start:0,size:0},Ie=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);Ie!==0&&(re.ct=C(Qt,Qt.l-8));var sn=Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2)+Qt.read_shift(2);sn!==0&&(re.mt=C(Qt,Qt.l-8)),re.start=Qt.read_shift(4,"i"),re.size=Qt.read_shift(4,"i"),re.size<0&&re.start<0&&(re.size=re.type=0,re.start=rt,re.name=""),re.type===5?(Et=re.start,ct>0&&Et!==rt&&(ft[Et].name="!StreamData")):re.size>=4096?(re.storage="fat",ft[re.start]===void 0&&(ft[re.start]=w(tt,re.start,ft.fat_addrs,ft.ssz)),ft[re.start].name=re.name,re.content=ft[re.start].data.slice(0,re.size)):(re.storage="minifat",re.size<0?re.size=0:Et!==rt&&re.start!==rt&&ft[Et]&&(re.content=_(re,ft[Et].data,(ft[$t]||{}).data))),re.content&&Ei(re.content,0),ht[le]=re,Pt.push(re)}}function C(W,ft){return new Date((cs(W,ft+4)/1e7*Math.pow(2,32)+cs(W,ft)/1e7-11644473600)*1e3)}function R(W,ft){return f(),d(u.readFileSync(W),ft)}function N(W,ft){var tt=ft&&ft.type;switch(tt||fn&&Buffer.isBuffer(W)&&(tt="buffer"),tt||"base64"){case"file":return R(W,ft);case"base64":return d(os(Ll(W)),ft);case"binary":return d(os(W),ft)}return d(W,ft)}function D(W,ft){var tt=ft||{},st=tt.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=st+"/",W.FileIndex[0]={name:st,type:5}),tt.CLSID&&(W.FileIndex[0].clsid=tt.CLSID),I(W)}function I(W){var ft="Sh33tJ5";if(!Rn.find(W,"/"+ft)){var tt=Ut(4);tt[0]=55,tt[1]=tt[3]=50,tt[2]=54,W.FileIndex.push({name:ft,type:2,content:tt,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+ft),M(W)}}function M(W,ft){D(W);for(var tt=!1,st=!1,ct=W.FullPaths.length-1;ct>=0;--ct){var ht=W.FileIndex[ct];switch(ht.type){case 0:st?tt=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:st=!0,isNaN(ht.R*ht.L*ht.C)&&(tt=!0),ht.R>-1&&ht.L>-1&&ht.R==ht.L&&(tt=!0);break;default:tt=!0;break}}if(!(!tt&&!ft)){var Pt=new Date(1987,1,19),$t=0,Et=Object.create?Object.create(null):{},kt=[];for(ct=0;ct<W.FullPaths.length;++ct)Et[W.FullPaths[ct]]=!0,W.FileIndex[ct].type!==0&&kt.push([W.FullPaths[ct],W.FileIndex[ct]]);for(ct=0;ct<kt.length;++ct){var Lt=r(kt[ct][0]);for(st=Et[Lt];!st;){for(;r(Lt)&&!Et[r(Lt)];)Lt=r(Lt);kt.push([Lt,{name:i(Lt).replace("/",""),type:1,clsid:Z,ct:Pt,mt:Pt,content:null}]),Et[Lt]=!0,Lt=r(kt[ct][0]),st=Et[Lt]}}for(kt.sort(function(le,Qt){return e(le[0],Qt[0])}),W.FullPaths=[],W.FileIndex=[],ct=0;ct<kt.length;++ct)W.FullPaths[ct]=kt[ct][0],W.FileIndex[ct]=kt[ct][1];for(ct=0;ct<kt.length;++ct){var Wt=W.FileIndex[ct],ee=W.FullPaths[ct];if(Wt.name=i(ee).replace("/",""),Wt.L=Wt.R=Wt.C=-(Wt.color=1),Wt.size=Wt.content?Wt.content.length:0,Wt.start=0,Wt.clsid=Wt.clsid||Z,ct===0)Wt.C=kt.length>1?1:-1,Wt.size=0,Wt.type=5;else if(ee.slice(-1)=="/"){for($t=ct+1;$t<kt.length&&r(W.FullPaths[$t])!=ee;++$t);for(Wt.C=$t>=kt.length?-1:$t,$t=ct+1;$t<kt.length&&r(W.FullPaths[$t])!=r(ee);++$t);Wt.R=$t>=kt.length?-1:$t,Wt.type=1}else r(W.FullPaths[ct+1]||"")==r(ee)&&(Wt.R=ct+1),Wt.type=2}}}function B(W,ft){var tt=ft||{};if(tt.fileType=="mad")return Vr(W,tt);switch(M(W),tt.fileType){case"zip":return Er(W,tt)}var st=function(le){for(var Qt=0,re=0,Ie=0;Ie<le.FileIndex.length;++Ie){var sn=le.FileIndex[Ie];if(sn.content){var Ze=sn.content.length;Ze>0&&(Ze<4096?Qt+=Ze+63>>6:re+=Ze+511>>9)}}for(var dn=le.FullPaths.length+3>>2,qi=Qt+7>>3,xs=Qt+127>>7,ci=qi+re+dn+xs,Ri=ci+127>>7,da=Ri<=109?0:Math.ceil((Ri-109)/127);ci+Ri+da+127>>7>Ri;)da=++Ri<=109?0:Math.ceil((Ri-109)/127);var Ni=[1,da,Ri,xs,dn,re,Qt,0];return le.FileIndex[0].size=Qt<<6,Ni[7]=(le.FileIndex[0].start=Ni[0]+Ni[1]+Ni[2]+Ni[3]+Ni[4]+Ni[5])+(Ni[6]+7>>3),Ni}(W),ct=Ut(st[7]<<9),ht=0,Pt=0;{for(ht=0;ht<8;++ht)ct.write_shift(1,it[ht]);for(ht=0;ht<8;++ht)ct.write_shift(2,0);for(ct.write_shift(2,62),ct.write_shift(2,3),ct.write_shift(2,65534),ct.write_shift(2,9),ct.write_shift(2,6),ht=0;ht<3;++ht)ct.write_shift(2,0);for(ct.write_shift(4,0),ct.write_shift(4,st[2]),ct.write_shift(4,st[0]+st[1]+st[2]+st[3]-1),ct.write_shift(4,0),ct.write_shift(4,4096),ct.write_shift(4,st[3]?st[0]+st[1]+st[2]-1:rt),ct.write_shift(4,st[3]),ct.write_shift(-4,st[1]?st[0]-1:rt),ct.write_shift(4,st[1]),ht=0;ht<109;++ht)ct.write_shift(-4,ht<st[2]?st[1]+ht:-1)}if(st[1])for(Pt=0;Pt<st[1];++Pt){for(;ht<236+Pt*127;++ht)ct.write_shift(-4,ht<st[2]?st[1]+ht:-1);ct.write_shift(-4,Pt===st[1]-1?rt:Pt+1)}var $t=function(le){for(Pt+=le;ht<Pt-1;++ht)ct.write_shift(-4,ht+1);le&&(++ht,ct.write_shift(-4,rt))};for(Pt=ht=0,Pt+=st[1];ht<Pt;++ht)ct.write_shift(-4,q.DIFSECT);for(Pt+=st[2];ht<Pt;++ht)ct.write_shift(-4,q.FATSECT);$t(st[3]),$t(st[4]);for(var Et=0,kt=0,Lt=W.FileIndex[0];Et<W.FileIndex.length;++Et)Lt=W.FileIndex[Et],Lt.content&&(kt=Lt.content.length,!(kt<4096)&&(Lt.start=Pt,$t(kt+511>>9)));for($t(st[6]+7>>3);ct.l&511;)ct.write_shift(-4,q.ENDOFCHAIN);for(Pt=ht=0,Et=0;Et<W.FileIndex.length;++Et)Lt=W.FileIndex[Et],Lt.content&&(kt=Lt.content.length,!(!kt||kt>=4096)&&(Lt.start=Pt,$t(kt+63>>6)));for(;ct.l&511;)ct.write_shift(-4,q.ENDOFCHAIN);for(ht=0;ht<st[4]<<2;++ht){var Wt=W.FullPaths[ht];if(!Wt||Wt.length===0){for(Et=0;Et<17;++Et)ct.write_shift(4,0);for(Et=0;Et<3;++Et)ct.write_shift(4,-1);for(Et=0;Et<12;++Et)ct.write_shift(4,0);continue}Lt=W.FileIndex[ht],ht===0&&(Lt.start=Lt.size?Lt.start-1:rt);var ee=ht===0&&tt.root||Lt.name;if(ee.length>31&&(console.error("Name "+ee+" will be truncated to "+ee.slice(0,31)),ee=ee.slice(0,31)),kt=2*(ee.length+1),ct.write_shift(64,ee,"utf16le"),ct.write_shift(2,kt),ct.write_shift(1,Lt.type),ct.write_shift(1,Lt.color),ct.write_shift(-4,Lt.L),ct.write_shift(-4,Lt.R),ct.write_shift(-4,Lt.C),Lt.clsid)ct.write_shift(16,Lt.clsid,"hex");else for(Et=0;Et<4;++Et)ct.write_shift(4,0);ct.write_shift(4,Lt.state||0),ct.write_shift(4,0),ct.write_shift(4,0),ct.write_shift(4,0),ct.write_shift(4,0),ct.write_shift(4,Lt.start),ct.write_shift(4,Lt.size),ct.write_shift(4,0)}for(ht=1;ht<W.FileIndex.length;++ht)if(Lt=W.FileIndex[ht],Lt.size>=4096)if(ct.l=Lt.start+1<<9,fn&&Buffer.isBuffer(Lt.content))Lt.content.copy(ct,ct.l,0,Lt.size),ct.l+=Lt.size+511&-512;else{for(Et=0;Et<Lt.size;++Et)ct.write_shift(1,Lt.content[Et]);for(;Et&511;++Et)ct.write_shift(1,0)}for(ht=1;ht<W.FileIndex.length;++ht)if(Lt=W.FileIndex[ht],Lt.size>0&&Lt.size<4096)if(fn&&Buffer.isBuffer(Lt.content))Lt.content.copy(ct,ct.l,0,Lt.size),ct.l+=Lt.size+63&-64;else{for(Et=0;Et<Lt.size;++Et)ct.write_shift(1,Lt.content[Et]);for(;Et&63;++Et)ct.write_shift(1,0)}if(fn)ct.l=ct.length;else for(;ct.l<ct.length;)ct.write_shift(1,0);return ct}function H(W,ft){var tt=W.FullPaths.map(function(Et){return Et.toUpperCase()}),st=tt.map(function(Et){var kt=Et.split("/");return kt[kt.length-(Et.slice(-1)=="/"?2:1)]}),ct=!1;ft.charCodeAt(0)===47?(ct=!0,ft=tt[0].slice(0,-1)+ft):ct=ft.indexOf("/")!==-1;var ht=ft.toUpperCase(),Pt=ct===!0?tt.indexOf(ht):st.indexOf(ht);if(Pt!==-1)return W.FileIndex[Pt];var $t=!ht.match(Em);for(ht=ht.replace(Td,""),$t&&(ht=ht.replace(Em,"!")),Pt=0;Pt<tt.length;++Pt)if(($t?tt[Pt].replace(Em,"!"):tt[Pt]).replace(Td,"")==ht||($t?st[Pt].replace(Em,"!"):st[Pt]).replace(Td,"")==ht)return W.FileIndex[Pt];return null}var F=64,rt=-2,L="d0cf11e0a1b11ae1",it=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:rt,FREESECT:-1,HEADER_SIGNATURE:L,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ct(W,ft,tt){f();var st=B(W,tt);u.writeFileSync(ft,st)}function at(W){for(var ft=new Array(W.length),tt=0;tt<W.length;++tt)ft[tt]=String.fromCharCode(W[tt]);return ft.join("")}function P(W,ft){var tt=B(W,ft);switch(ft&&ft.type||"buffer"){case"file":return f(),u.writeFileSync(ft.filename,tt),tt;case"binary":return typeof tt=="string"?tt:at(tt);case"base64":return pg(typeof tt=="string"?tt:at(tt));case"buffer":if(fn)return Buffer.isBuffer(tt)?tt:Ya(tt);case"array":return typeof tt=="string"?os(tt):tt}return tt}var V;function j(W){try{var ft=W.InflateRaw,tt=new ft;if(tt._processChunk(new Uint8Array([3,0]),tt._finishFlushFlag),tt.bytesRead)V=W;else throw new Error("zlib does not expose bytesRead")}catch(st){console.error("cannot use native zlib: "+(st.message||st))}}function et(W,ft){if(!V)return _s(W,ft);var tt=V.InflateRaw,st=new tt,ct=st._processChunk(W.slice(W.l),st._finishFlushFlag);return W.l+=st.bytesRead,ct}function dt(W){return V?V.deflateRawSync(W):rn(W)}var xt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Nt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Rt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function z(W){var ft=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(ft>>16|ft>>8|ft)&255}for(var lt=typeof Uint8Array<"u",J=lt?new Uint8Array(256):[],ot=0;ot<256;++ot)J[ot]=z(ot);function yt(W,ft){var tt=J[W&255];return ft<=8?tt>>>8-ft:(tt=tt<<8|J[W>>8&255],ft<=16?tt>>>16-ft:(tt=tt<<8|J[W>>16&255],tt>>>24-ft))}function At(W,ft){var tt=ft&7,st=ft>>>3;return(W[st]|(tt<=6?0:W[st+1]<<8))>>>tt&3}function O(W,ft){var tt=ft&7,st=ft>>>3;return(W[st]|(tt<=5?0:W[st+1]<<8))>>>tt&7}function gt(W,ft){var tt=ft&7,st=ft>>>3;return(W[st]|(tt<=4?0:W[st+1]<<8))>>>tt&15}function ut(W,ft){var tt=ft&7,st=ft>>>3;return(W[st]|(tt<=3?0:W[st+1]<<8))>>>tt&31}function K(W,ft){var tt=ft&7,st=ft>>>3;return(W[st]|(tt<=1?0:W[st+1]<<8))>>>tt&127}function X(W,ft,tt){var st=ft&7,ct=ft>>>3,ht=(1<<tt)-1,Pt=W[ct]>>>st;return tt<8-st||(Pt|=W[ct+1]<<8-st,tt<16-st)||(Pt|=W[ct+2]<<16-st,tt<24-st)||(Pt|=W[ct+3]<<24-st),Pt&ht}function pt(W,ft,tt){var st=ft&7,ct=ft>>>3;return st<=5?W[ct]|=(tt&7)<<st:(W[ct]|=tt<<st&255,W[ct+1]=(tt&7)>>8-st),ft+3}function Bt(W,ft,tt){var st=ft&7,ct=ft>>>3;return tt=(tt&1)<<st,W[ct]|=tt,ft+1}function Ht(W,ft,tt){var st=ft&7,ct=ft>>>3;return tt<<=st,W[ct]|=tt&255,tt>>>=8,W[ct+1]=tt,ft+8}function St(W,ft,tt){var st=ft&7,ct=ft>>>3;return tt<<=st,W[ct]|=tt&255,tt>>>=8,W[ct+1]=tt&255,W[ct+2]=tt>>>8,ft+16}function It(W,ft){var tt=W.length,st=2*tt>ft?2*tt:ft+5,ct=0;if(tt>=ft)return W;if(fn){var ht=mT(st);if(W.copy)W.copy(ht);else for(;ct<W.length;++ct)ht[ct]=W[ct];return ht}else if(lt){var Pt=new Uint8Array(st);if(Pt.set)Pt.set(W);else for(;ct<tt;++ct)Pt[ct]=W[ct];return Pt}return W.length=st,W}function Tt(W){for(var ft=new Array(W),tt=0;tt<W;++tt)ft[tt]=0;return ft}function vt(W,ft,tt){var st=1,ct=0,ht=0,Pt=0,$t=0,Et=W.length,kt=lt?new Uint16Array(32):Tt(32);for(ht=0;ht<32;++ht)kt[ht]=0;for(ht=Et;ht<tt;++ht)W[ht]=0;Et=W.length;var Lt=lt?new Uint16Array(Et):Tt(Et);for(ht=0;ht<Et;++ht)kt[ct=W[ht]]++,st<ct&&(st=ct),Lt[ht]=0;for(kt[0]=0,ht=1;ht<=st;++ht)kt[ht+16]=$t=$t+kt[ht-1]<<1;for(ht=0;ht<Et;++ht)$t=W[ht],$t!=0&&(Lt[ht]=kt[$t+16]++);var Wt=0;for(ht=0;ht<Et;++ht)if(Wt=W[ht],Wt!=0)for($t=yt(Lt[ht],st)>>st-Wt,Pt=(1<<st+4-Wt)-1;Pt>=0;--Pt)ft[$t|Pt<<Wt]=Wt&15|ht<<4;return st}var te=lt?new Uint16Array(512):Tt(512),ae=lt?new Uint16Array(32):Tt(32);if(!lt){for(var ne=0;ne<512;++ne)te[ne]=0;for(ne=0;ne<32;++ne)ae[ne]=0}(function(){for(var W=[],ft=0;ft<32;ft++)W.push(5);vt(W,ae,32);var tt=[];for(ft=0;ft<=143;ft++)tt.push(8);for(;ft<=255;ft++)tt.push(9);for(;ft<=279;ft++)tt.push(7);for(;ft<=287;ft++)tt.push(8);vt(tt,te,288)})();var Re=function(){for(var ft=lt?new Uint8Array(32768):[],tt=0,st=0;tt<Rt.length-1;++tt)for(;st<Rt[tt+1];++st)ft[st]=tt;for(;st<32768;++st)ft[st]=29;var ct=lt?new Uint8Array(259):[];for(tt=0,st=0;tt<Nt.length-1;++tt)for(;st<Nt[tt+1];++st)ct[st]=tt;function ht($t,Et){for(var kt=0;kt<$t.length;){var Lt=Math.min(65535,$t.length-kt),Wt=kt+Lt==$t.length;for(Et.write_shift(1,+Wt),Et.write_shift(2,Lt),Et.write_shift(2,~Lt&65535);Lt-- >0;)Et[Et.l++]=$t[kt++]}return Et.l}function Pt($t,Et){for(var kt=0,Lt=0,Wt=lt?new Uint16Array(32768):[];Lt<$t.length;){var ee=Math.min(65535,$t.length-Lt);if(ee<10){for(kt=pt(Et,kt,+(Lt+ee==$t.length)),kt&7&&(kt+=8-(kt&7)),Et.l=kt/8|0,Et.write_shift(2,ee),Et.write_shift(2,~ee&65535);ee-- >0;)Et[Et.l++]=$t[Lt++];kt=Et.l*8;continue}kt=pt(Et,kt,+(Lt+ee==$t.length)+2);for(var le=0;ee-- >0;){var Qt=$t[Lt];le=(le<<5^Qt)&32767;var re=-1,Ie=0;if((re=Wt[le])&&(re|=Lt&-32768,re>Lt&&(re-=32768),re<Lt))for(;$t[re+Ie]==$t[Lt+Ie]&&Ie<250;)++Ie;if(Ie>2){Qt=ct[Ie],Qt<=22?kt=Ht(Et,kt,J[Qt+1]>>1)-1:(Ht(Et,kt,3),kt+=5,Ht(Et,kt,J[Qt-23]>>5),kt+=3);var sn=Qt<8?0:Qt-4>>2;sn>0&&(St(Et,kt,Ie-Nt[Qt]),kt+=sn),Qt=ft[Lt-re],kt=Ht(Et,kt,J[Qt]>>3),kt-=3;var Ze=Qt<4?0:Qt-2>>1;Ze>0&&(St(Et,kt,Lt-re-Rt[Qt]),kt+=Ze);for(var dn=0;dn<Ie;++dn)Wt[le]=Lt&32767,le=(le<<5^$t[Lt])&32767,++Lt;ee-=Ie-1}else Qt<=143?Qt=Qt+48:kt=Bt(Et,kt,1),kt=Ht(Et,kt,J[Qt]),Wt[le]=Lt&32767,++Lt}kt=Ht(Et,kt,0)-1}return Et.l=(kt+7)/8|0,Et.l}return function(Et,kt){return Et.length<8?ht(Et,kt):Pt(Et,kt)}}();function rn(W){var ft=Ut(50+Math.floor(W.length*1.1)),tt=Re(W,ft);return ft.slice(0,tt)}var be=lt?new Uint16Array(32768):Tt(32768),ln=lt?new Uint16Array(32768):Tt(32768),Ve=lt?new Uint16Array(128):Tt(128),zn=1,Cn=1;function yn(W,ft){var tt=ut(W,ft)+257;ft+=5;var st=ut(W,ft)+1;ft+=5;var ct=gt(W,ft)+4;ft+=4;for(var ht=0,Pt=lt?new Uint8Array(19):Tt(19),$t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Et=1,kt=lt?new Uint8Array(8):Tt(8),Lt=lt?new Uint8Array(8):Tt(8),Wt=Pt.length,ee=0;ee<ct;++ee)Pt[xt[ee]]=ht=O(W,ft),Et<ht&&(Et=ht),kt[ht]++,ft+=3;var le=0;for(kt[0]=0,ee=1;ee<=Et;++ee)Lt[ee]=le=le+kt[ee-1]<<1;for(ee=0;ee<Wt;++ee)(le=Pt[ee])!=0&&($t[ee]=Lt[le]++);var Qt=0;for(ee=0;ee<Wt;++ee)if(Qt=Pt[ee],Qt!=0){le=J[$t[ee]]>>8-Qt;for(var re=(1<<7-Qt)-1;re>=0;--re)Ve[le|re<<Qt]=Qt&7|ee<<3}var Ie=[];for(Et=1;Ie.length<tt+st;)switch(le=Ve[K(W,ft)],ft+=le&7,le>>>=3){case 16:for(ht=3+At(W,ft),ft+=2,le=Ie[Ie.length-1];ht-- >0;)Ie.push(le);break;case 17:for(ht=3+O(W,ft),ft+=3;ht-- >0;)Ie.push(0);break;case 18:for(ht=11+K(W,ft),ft+=7;ht-- >0;)Ie.push(0);break;default:Ie.push(le),Et<le&&(Et=le);break}var sn=Ie.slice(0,tt),Ze=Ie.slice(tt);for(ee=tt;ee<286;++ee)sn[ee]=0;for(ee=st;ee<30;++ee)Ze[ee]=0;return zn=vt(sn,be,286),Cn=vt(Ze,ln,30),ft}function mr(W,ft){if(W[0]==3&&!(W[1]&3))return[Mc(ft),2];for(var tt=0,st=0,ct=mT(ft||1<<18),ht=0,Pt=ct.length>>>0,$t=0,Et=0;(st&1)==0;){if(st=O(W,tt),tt+=3,st>>>1)st>>1==1?($t=9,Et=5):(tt=yn(W,tt),$t=zn,Et=Cn);else{tt&7&&(tt+=8-(tt&7));var kt=W[tt>>>3]|W[(tt>>>3)+1]<<8;if(tt+=32,kt>0)for(!ft&&Pt<ht+kt&&(ct=It(ct,ht+kt),Pt=ct.length);kt-- >0;)ct[ht++]=W[tt>>>3],tt+=8;continue}for(;;){!ft&&Pt<ht+32767&&(ct=It(ct,ht+32767),Pt=ct.length);var Lt=X(W,tt,$t),Wt=st>>>1==1?te[Lt]:be[Lt];if(tt+=Wt&15,Wt>>>=4,(Wt>>>8&255)===0)ct[ht++]=Wt;else{if(Wt==256)break;Wt-=257;var ee=Wt<8?0:Wt-4>>2;ee>5&&(ee=0);var le=ht+Nt[Wt];ee>0&&(le+=X(W,tt,ee),tt+=ee),Lt=X(W,tt,Et),Wt=st>>>1==1?ae[Lt]:ln[Lt],tt+=Wt&15,Wt>>>=4;var Qt=Wt<4?0:Wt-2>>1,re=Rt[Wt];for(Qt>0&&(re+=X(W,tt,Qt),tt+=Qt),!ft&&Pt<le&&(ct=It(ct,le+100),Pt=ct.length);ht<le;)ct[ht]=ct[ht-re],++ht}}}return ft?[ct,tt+7>>>3]:[ct.slice(0,ht),tt+7>>>3]}function _s(W,ft){var tt=W.slice(W.l||0),st=mr(tt,ft);return W.l+=st[1],st[0]}function Vs(W,ft){if(W)typeof console<"u"&&console.error(ft);else throw new Error(ft)}function Xa(W,ft){var tt=W;Ei(tt,0);var st=[],ct=[],ht={FileIndex:st,FullPaths:ct};D(ht,{root:ft.root});for(var Pt=tt.length-4;(tt[Pt]!=80||tt[Pt+1]!=75||tt[Pt+2]!=5||tt[Pt+3]!=6)&&Pt>=0;)--Pt;tt.l=Pt+4,tt.l+=4;var $t=tt.read_shift(2);tt.l+=6;var Et=tt.read_shift(4);for(tt.l=Et,Pt=0;Pt<$t;++Pt){tt.l+=20;var kt=tt.read_shift(4),Lt=tt.read_shift(4),Wt=tt.read_shift(2),ee=tt.read_shift(2),le=tt.read_shift(2);tt.l+=8;var Qt=tt.read_shift(4),re=l(tt.slice(tt.l+Wt,tt.l+Wt+ee));tt.l+=Wt+ee+le;var Ie=tt.l;tt.l=Qt+4,re&&re[1]&&((re[1]||{}).usz&&(Lt=re[1].usz),(re[1]||{}).csz&&(kt=re[1].csz)),Ws(tt,kt,Lt,ht,re),tt.l=Ie}return ht}function Ws(W,ft,tt,st,ct){W.l+=2;var ht=W.read_shift(2),Pt=W.read_shift(2),$t=a(W);if(ht&8257)throw new Error("Unsupported ZIP encryption");for(var Et=W.read_shift(4),kt=W.read_shift(4),Lt=W.read_shift(4),Wt=W.read_shift(2),ee=W.read_shift(2),le="",Qt=0;Qt<Wt;++Qt)le+=String.fromCharCode(W[W.l++]);if(ee){var re=l(W.slice(W.l,W.l+ee));(re[21589]||{}).mt&&($t=re[21589].mt),(re[1]||{}).usz&&(Lt=re[1].usz),(re[1]||{}).csz&&(kt=re[1].csz),ct&&((ct[21589]||{}).mt&&($t=ct[21589].mt),(ct[1]||{}).usz&&(Lt=ct[1].usz),(ct[1]||{}).csz&&(kt=ct[1].csz))}W.l+=ee;var Ie=W.slice(W.l,W.l+kt);switch(Pt){case 8:Ie=et(W,Lt);break;case 0:W.l+=kt;break;default:throw new Error("Unsupported ZIP Compression method "+Pt)}var sn=!1;ht&8&&(Et=W.read_shift(4),Et==134695760&&(Et=W.read_shift(4),sn=!0),kt=W.read_shift(4),Lt=W.read_shift(4)),kt!=ft&&Vs(sn,"Bad compressed size: "+ft+" != "+kt),Lt!=tt&&Vs(sn,"Bad uncompressed size: "+tt+" != "+Lt),ir(st,le,Ie,{unsafe:!0,mt:$t})}function Er(W,ft){var tt=ft||{},st=[],ct=[],ht=Ut(1),Pt=tt.compression?8:0,$t=0,Et=0,kt=0,Lt=0,Wt=0,ee=W.FullPaths[0],le=ee,Qt=W.FileIndex[0],re=[],Ie=0;for(Et=1;Et<W.FullPaths.length;++Et)if(le=W.FullPaths[Et].slice(ee.length),Qt=W.FileIndex[Et],!(!Qt.size||!Qt.content||Array.isArray(Qt.content)&&Qt.content.length==0||le=="Sh33tJ5")){var sn=Lt,Ze=Ut(le.length);for(kt=0;kt<le.length;++kt)Ze.write_shift(1,le.charCodeAt(kt)&127);Ze=Ze.slice(0,Ze.l),re[Wt]=typeof Qt.content=="string"?ET.bstr(Qt.content,0):ET.buf(Qt.content,0);var dn=typeof Qt.content=="string"?os(Qt.content):Qt.content;Pt==8&&(dn=dt(dn)),ht=Ut(30),ht.write_shift(4,67324752),ht.write_shift(2,20),ht.write_shift(2,$t),ht.write_shift(2,Pt),Qt.mt?s(ht,Qt.mt):ht.write_shift(4,0),ht.write_shift(-4,re[Wt]),ht.write_shift(4,dn.length),ht.write_shift(4,Qt.content.length),ht.write_shift(2,Ze.length),ht.write_shift(2,0),Lt+=ht.length,st.push(ht),Lt+=Ze.length,st.push(Ze),Lt+=dn.length,st.push(dn),ht=Ut(46),ht.write_shift(4,33639248),ht.write_shift(2,0),ht.write_shift(2,20),ht.write_shift(2,$t),ht.write_shift(2,Pt),ht.write_shift(4,0),ht.write_shift(-4,re[Wt]),ht.write_shift(4,dn.length),ht.write_shift(4,Qt.content.length),ht.write_shift(2,Ze.length),ht.write_shift(2,0),ht.write_shift(2,0),ht.write_shift(2,0),ht.write_shift(2,0),ht.write_shift(4,0),ht.write_shift(4,sn),Ie+=ht.l,ct.push(ht),Ie+=Ze.length,ct.push(Ze),++Wt}return ht=Ut(22),ht.write_shift(4,101010256),ht.write_shift(2,0),ht.write_shift(2,0),ht.write_shift(2,Wt),ht.write_shift(2,Wt),ht.write_shift(4,Ie),ht.write_shift(4,Lt),ht.write_shift(2,0),fr([fr(st),fr(ct),ht])}var Oi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zl(W,ft){if(W.ctype)return W.ctype;var tt=W.name||"",st=tt.match(/\.([^\.]+)$/);return st&&Oi[st[1]]||ft&&(st=(tt=ft).match(/[\.\\]([^\.\\])+$/),st&&Oi[st[1]])?Oi[st[1]]:"application/octet-stream"}function Kc(W){for(var ft=pg(W),tt=[],st=0;st<ft.length;st+=76)tt.push(ft.slice(st,st+76));return tt.join(`\r
`)+`\r
`}function jl(W){var ft=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(kt){var Lt=kt.charCodeAt(0).toString(16).toUpperCase();return"="+(Lt.length==1?"0"+Lt:Lt)});ft=ft.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ft.charAt(0)==`
`&&(ft="=0D"+ft.slice(1)),ft=ft.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var tt=[],st=ft.split(`\r
`),ct=0;ct<st.length;++ct){var ht=st[ct];if(ht.length==0){tt.push("");continue}for(var Pt=0;Pt<ht.length;){var $t=76,Et=ht.slice(Pt,Pt+$t);Et.charAt($t-1)=="="?$t--:Et.charAt($t-2)=="="?$t-=2:Et.charAt($t-3)=="="&&($t-=3),Et=ht.slice(Pt,Pt+$t),Pt+=$t,Pt<ht.length&&(Et+="="),tt.push(Et)}}return tt.join(`\r
`)}function Hl(W){for(var ft=[],tt=0;tt<W.length;++tt){for(var st=W[tt];tt<=W.length&&st.charAt(st.length-1)=="=";)st=st.slice(0,st.length-1)+W[++tt];ft.push(st)}for(var ct=0;ct<ft.length;++ct)ft[ct]=ft[ct].replace(/[=][0-9A-Fa-f]{2}/g,function(ht){return String.fromCharCode(parseInt(ht.slice(1),16))});return os(ft.join(`\r
`))}function Zc(W,ft,tt){for(var st="",ct="",ht="",Pt,$t=0;$t<10;++$t){var Et=ft[$t];if(!Et||Et.match(/^\s*$/))break;var kt=Et.match(/^([^:]*?):\s*([^\s].*)$/);if(kt)switch(kt[1].toLowerCase()){case"content-location":st=kt[2].trim();break;case"content-type":ht=kt[2].trim();break;case"content-transfer-encoding":ct=kt[2].trim();break}}switch(++$t,ct.toLowerCase()){case"base64":Pt=os(Ll(ft.slice($t).join("")));break;case"quoted-printable":Pt=Hl(ft.slice($t));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ct)}var Lt=ir(W,st.slice(tt.length),Pt,{unsafe:!0});ht&&(Lt.ctype=ht)}function fa(W,ft){if(at(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var tt=ft&&ft.root||"",st=(fn&&Buffer.isBuffer(W)?W.toString("binary"):at(W)).split(`\r
`),ct=0,ht="";for(ct=0;ct<st.length;++ct)if(ht=st[ct],!!/^Content-Location:/i.test(ht)&&(ht=ht.slice(ht.indexOf("file")),tt||(tt=ht.slice(0,ht.lastIndexOf("/")+1)),ht.slice(0,tt.length)!=tt))for(;tt.length>0&&(tt=tt.slice(0,tt.length-1),tt=tt.slice(0,tt.lastIndexOf("/")+1),ht.slice(0,tt.length)!=tt););var Pt=(st[1]||"").match(/boundary="(.*?)"/);if(!Pt)throw new Error("MAD cannot find boundary");var $t="--"+(Pt[1]||""),Et=[],kt=[],Lt={FileIndex:Et,FullPaths:kt};D(Lt);var Wt,ee=0;for(ct=0;ct<st.length;++ct){var le=st[ct];le!==$t&&le!==$t+"--"||(ee++&&Zc(Lt,st.slice(Wt,ct),tt),Wt=ct)}return Lt}function Vr(W,ft){var tt=ft||{},st=tt.boundary||"SheetJS";st="------="+st;for(var ct=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+st.slice(2)+'"',"","",""],ht=W.FullPaths[0],Pt=ht,$t=W.FileIndex[0],Et=1;Et<W.FullPaths.length;++Et)if(Pt=W.FullPaths[Et].slice(ht.length),$t=W.FileIndex[Et],!(!$t.size||!$t.content||Pt=="Sh33tJ5")){Pt=Pt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var kt=$t.content,Lt=fn&&Buffer.isBuffer(kt)?kt.toString("binary"):at(kt),Wt=0,ee=Math.min(1024,Lt.length),le=0,Qt=0;Qt<=ee;++Qt)(le=Lt.charCodeAt(Qt))>=32&&le<128&&++Wt;var re=Wt>=ee*4/5;ct.push(st),ct.push("Content-Location: "+(tt.root||"file:///C:/SheetJS/")+Pt),ct.push("Content-Transfer-Encoding: "+(re?"quoted-printable":"base64")),ct.push("Content-Type: "+zl($t,Pt)),ct.push(""),ct.push(re?jl(Lt):Kc(Lt))}return ct.push(st+`--\r
`),ct.join(`\r
`)}function rr(W){var ft={};return D(ft,W),ft}function ir(W,ft,tt,st){var ct=st&&st.unsafe;ct||D(W);var ht=!ct&&Rn.find(W,ft);if(!ht){var Pt=W.FullPaths[0];ft.slice(0,Pt.length)==Pt?Pt=ft:(Pt.slice(-1)!="/"&&(Pt+="/"),Pt=(Pt+ft).replace("//","/")),ht={name:i(ft),type:2},W.FileIndex.push(ht),W.FullPaths.push(Pt),ct||Rn.utils.cfb_gc(W)}return ht.content=tt,ht.size=tt?tt.length:0,st&&(st.CLSID&&(ht.clsid=st.CLSID),st.mt&&(ht.mt=st.mt),st.ct&&(ht.ct=st.ct)),ht}function ha(W,ft){D(W);var tt=Rn.find(W,ft);if(tt){for(var st=0;st<W.FileIndex.length;++st)if(W.FileIndex[st]==tt)return W.FileIndex.splice(st,1),W.FullPaths.splice(st,1),!0}return!1}function $l(W,ft,tt){D(W);var st=Rn.find(W,ft);if(st){for(var ct=0;ct<W.FileIndex.length;++ct)if(W.FileIndex[ct]==st)return W.FileIndex[ct].name=i(tt),W.FullPaths[ct]=tt,!0}return!1}function Mf(W){M(W,!0)}return t.find=H,t.read=N,t.parse=d,t.write=P,t.writeFile=Ct,t.utils={cfb_new:rr,cfb_add:ir,cfb_del:ha,cfb_mov:$l,cfb_gc:Mf,ReadShift:Cd,CheckField:oN,prep_blob:Ei,bconcat:fr,use_zlib:j,_deflateRaw:rn,_inflateRaw:_s,consts:q},t}(),$H;function AT(n){return typeof n=="string"?av(n):Array.isArray(n)?mH(n):n}function vp(n,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=av(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(n,t)}var r=e=="utf8"?qd(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([AT(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:n,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=n,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+pH(new Uint8Array(AT(r)));return chrome.downloads.download({url:l,filename:n,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(n);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=Pc(t)),u.write(t),u.close(),t}catch(f){if(!f.message||f.message.indexOf("onstruct")==-1)throw f}throw new Error("cannot save file "+n)}function hr(n){for(var t=Object.keys(n),e=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(n,t[r])&&e.push(t[r]);return e}function ST(n,t){for(var e=[],r=hr(n),i=0;i!==r.length;++i)e[n[r[i]][t]]==null&&(e[n[r[i]][t]]=r[i]);return e}function Eb(n){for(var t=[],e=hr(n),r=0;r!==e.length;++r)t[n[e[r]]]=e[r];return t}function cv(n){for(var t=[],e=hr(n),r=0;r!==e.length;++r)t[n[e[r]]]=parseInt(e[r],10);return t}function GH(n){for(var t=[],e=hr(n),r=0;r!==e.length;++r)t[n[e[r]]]==null&&(t[n[e[r]]]=[]),t[n[e[r]]].push(e[r]);return t}var VR=Date.UTC(1899,11,30,0,0,0),VH=Date.UTC(1899,11,31,0,0,0),WH=Date.UTC(1904,0,1,0,0,0);function $r(n,t){var e=n.getTime(),r=(e-VR)/(24*60*60*1e3);return t?(r-=1462,r<-1402?r-1:r):r<60?r-1:r}function Ju(n){if(n>=60&&n<61)return n;var t=new Date;return t.setTime((n>60?n:n+1)*24*60*60*1e3+VR),t}var qH=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,YH=/^(\d+)-(\d+)-(\d+)$/,WR=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Wi(n,t){if(n instanceof Date)return n;var e=n.match(qH);if(e)return new Date((t?WH:VH)+((parseInt(e[1],10)*60+parseInt(e[2],10))*60+(e[3]?parseInt(e[3].slice(1),10):0))*1e3+(e[4]?parseInt((e[4]+"000").slice(1,4),10):0));if(e=n.match(YH),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],0,0,0,0));if(e=n.match(WR),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5],e[6]&&parseInt(e[6].slice(1),10)||0,e[7]&&parseInt((e[7]+"0000").slice(1,4),10)||0));var r=new Date(n);return r}function Ab(n,t){if(fn&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return e[s]||s})}catch{}var r=[],i=0;try{for(i=0;i<n.length-65536;i+=65536)r.push(String.fromCharCode.apply(0,n.slice(i,i+65536)));r.push(String.fromCharCode.apply(0,n.slice(i)))}catch{try{for(;i<n.length-16384;i+=16384)r.push(String.fromCharCode.apply(0,n.slice(i,i+16384)));r.push(String.fromCharCode.apply(0,n.slice(i)))}catch{for(;i!=n.length;++i)r.push(String.fromCharCode(n[i]))}}return r.join("")}function li(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var t={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=li(n[e]));return t}function Bn(n,t){for(var e="";e.length<t;)e+=n;return e}function Mo(n){var t=Number(n);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(n))return t;var e=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(]([^()]*)[)]/,function(i,s){return e=-e,s}),!isNaN(t=Number(r)))?t/e:t}var XH=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,KH=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,ZH=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,QH=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function JH(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,n[7]=="p"?12:0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),0,0,0))}function t$(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1],+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1],0,0,0))}var e$=["january","february","march","april","may","june","july","august","september","october","november","december"];function yg(n){if(ZH.test(n))return n.indexOf("Z")==-1?uv(new Date(n)):new Date(n);var t=n.toLowerCase(),e=t.replace(/\s+/g," ").trim(),r=e.match(XH);if(r)return JH(r);if(r=e.match(KH),r)return t$(r);if(r=e.match(WR),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var i=new Date(QH&&n.indexOf("UTC")==-1?n+" UTC":n),s=new Date(NaN),a=i.getYear();i.getMonth();var l=i.getDate();if(isNaN(l))return s;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),t.length>3&&e$.indexOf(t)==-1)return s}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return s;return a<0||a>8099||n.match(/[^-0-9:,\/\\\ ]/)?s:i}function xf(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds())}function uv(n){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()))}function He(n,t,e){if(n.FullPaths){if(Array.isArray(e)&&typeof e[0]=="string"&&(e=e.join("")),typeof e=="string"){var r;return fn?r=Ya(e):r=gH(e),Rn.utils.cfb_add(n,t,r)}Rn.utils.cfb_add(n,t,e)}else n.file(t,e)}function Sb(){return Rn.utils.cfb_new()}var pr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,n$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Tb=Eb(n$),Cb=/[&<>'"]/g,r$=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function $e(n){var t=n+"";return t.replace(Cb,function(e){return Tb[e]}).replace(r$,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function TT(n){return $e(n).replace(/ /g,"_x0020_")}var qR=/[\u0000-\u001f]/g;function ax(n){var t=n+"";return t.replace(Cb,function(e){return Tb[e]}).replace(/\n/g,"<br/>").replace(qR,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function i$(n){var t=n+"";return t.replace(Cb,function(e){return Tb[e]}).replace(qR,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function s$(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function a$(n){switch(n){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function ox(n){for(var t="",e=0,r=0,i=0,s=0,a=0,l=0;e<n.length;){if(r=n.charCodeAt(e++),r<128){t+=String.fromCharCode(r);continue}if(i=n.charCodeAt(e++),r>191&&r<224){a=(r&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=n.charCodeAt(e++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=n.charCodeAt(e++),l=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function CT(n){var t=Mc(2*n.length),e,r,i=1,s=0,a=0,l;for(r=0;r<n.length;r+=i)i=1,(l=n.charCodeAt(r))<128?e=l:l<224?(e=(l&31)*64+(n.charCodeAt(r+1)&63),i=2):l<240?(e=(l&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,e=(l&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),e-=65536,a=55296+(e>>>10&1023),e=56320+(e&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=e%256,t[s++]=e>>>8;return t.slice(0,s).toString("ucs2")}function DT(n){return Ya(n,"binary").toString("utf8")}var Am="foo bar bazâð£",tf=fn&&(DT(Am)==ox(Am)&&DT||CT(Am)==ox(Am)&&CT)||ox,qd=fn?function(n){return Ya(n,"utf8").toString("binary")}:function(n){for(var t=[],e=0,r=0,i=0;e<n.length;)switch(r=n.charCodeAt(e++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(e++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},o$=function(){var n=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var r=e.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}}(),YR=/(^\s|\s$|\n)/;function zr(n,t){return"<"+n+(t.match(YR)?' xml:space="preserve"':"")+">"+t+"</"+n+">"}function Yd(n){return hr(n).map(function(t){return" "+t+'="'+n[t]+'"'}).join("")}function se(n,t,e){return"<"+n+(e!=null?Yd(e):"")+(t!=null?(t.match(YR)?' xml:space="preserve"':"")+">"+t+"</"+n:"/")+">"}function Jx(n,t){try{return n.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function l$(n,t){switch(typeof n){case"string":var e=se("vt:lpwstr",$e(n));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return se((n|0)==n?"vt:i4":"vt:r8",$e(String(n)));case"boolean":return se("vt:bool",n?"true":"false")}if(n instanceof Date)return se("vt:filetime",Jx(n));throw new Error("Unable to serialize "+n)}var Dr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Rf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ls={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function c$(n,t){for(var e=1-2*(n[t+7]>>>7),r=((n[t+7]&127)<<4)+(n[t+6]>>>4&15),i=n[t+6]&15,s=5;s>=0;--s)i=i*256+n[t+s];return r==2047?i==0?e*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),e*Math.pow(2,r-52)*i)}function u$(n,t,e){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=r?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)n[e+l]=s&255;n[e+6]=(i&15)<<4|s&15,n[e+7]=i>>4|r}var OT=function(n){for(var t=[],e=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,s=n[0][r].length;i<s;i+=e)t.push.apply(t,n[0][r].slice(i,i+e));return t},RT=fn?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(t){return Buffer.isBuffer(t)?t:Ya(t)})):OT(n)}:OT,NT=function(n,t,e){for(var r=[],i=t;i<e;i+=2)r.push(String.fromCharCode(xd(n,i)));return r.join("").replace(Td,"")},Db=fn?function(n,t,e){return!Buffer.isBuffer(n)||!mg?NT(n,t,e):n.toString("utf16le",t,e).replace(Td,"")}:NT,kT=function(n,t,e){for(var r=[],i=t;i<t+e;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},XR=fn?function(n,t,e){return Buffer.isBuffer(n)?n.toString("hex",t,t+e):kT(n,t,e)}:kT,LT=function(n,t,e){for(var r=[],i=t;i<e;i++)r.push(String.fromCharCode(Vu(n,i)));return r.join("")},_p=fn?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf8",e,r):LT(t,e,r)}:LT,KR=function(n,t){var e=cs(n,t);return e>0?_p(n,t+4,t+4+e-1):""},ZR=KR,QR=function(n,t){var e=cs(n,t);return e>0?_p(n,t+4,t+4+e-1):""},JR=QR,tN=function(n,t){var e=2*cs(n,t);return e>0?_p(n,t+4,t+4+e-1):""},eN=tN,nN=function(t,e){var r=cs(t,e);return r>0?Db(t,e+4,e+4+r):""},rN=nN,iN=function(n,t){var e=cs(n,t);return e>0?_p(n,t+4,t+4+e):""},sN=iN,aN=function(n,t){return c$(n,t)},bg=aN,Ob=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};fn&&(ZR=function(t,e){if(!Buffer.isBuffer(t))return KR(t,e);var r=t.readUInt32LE(e);return r>0?t.toString("utf8",e+4,e+4+r-1):""},JR=function(t,e){if(!Buffer.isBuffer(t))return QR(t,e);var r=t.readUInt32LE(e);return r>0?t.toString("utf8",e+4,e+4+r-1):""},eN=function(t,e){if(!Buffer.isBuffer(t)||!mg)return tN(t,e);var r=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+r-1)},rN=function(t,e){if(!Buffer.isBuffer(t)||!mg)return nN(t,e);var r=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+r)},sN=function(t,e){if(!Buffer.isBuffer(t))return iN(t,e);var r=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+r)},bg=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):aN(t,e)},Ob=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Vu=function(n,t){return n[t]},xd=function(n,t){return n[t+1]*256+n[t]},f$=function(n,t){var e=n[t+1]*256+n[t];return e<32768?e:(65535-e+1)*-1},cs=function(n,t){return n[t+3]*(1<<24)+(n[t+2]<<16)+(n[t+1]<<8)+n[t]},_c=function(n,t){return n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]},h$=function(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]};function Cd(n,t){var e="",r,i,s=[],a,l,u,f;switch(t){case"dbcs":if(f=this.l,fn&&Buffer.isBuffer(this)&&mg)e=this.slice(this.l,this.l+2*n).toString("utf16le");else for(u=0;u<n;++u)e+=String.fromCharCode(xd(this,f)),f+=2;n*=2;break;case"utf8":e=_p(this,this.l,this.l+n);break;case"utf16le":n*=2,e=Db(this,this.l,this.l+n);break;case"wstr":return Cd.call(this,n,"dbcs");case"lpstr-ansi":e=ZR(this,this.l),n=4+cs(this,this.l);break;case"lpstr-cp":e=JR(this,this.l),n=4+cs(this,this.l);break;case"lpwstr":e=eN(this,this.l),n=4+2*cs(this,this.l);break;case"lpp4":n=4+cs(this,this.l),e=rN(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+cs(this,this.l),e=sN(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,e="";(a=Vu(this,this.l+n++))!==0;)s.push(wm(a));e=s.join("");break;case"_wstr":for(n=0,e="";(a=xd(this,this.l+n))!==0;)s.push(wm(a)),n+=2;n+=2,e=s.join("");break;case"dbcs-cont":for(e="",f=this.l,u=0;u<n;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return a=Vu(this,f),this.l=f+1,l=Cd.call(this,n-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(wm(xd(this,f))),f+=2}e=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(e="",f=this.l,u=0;u!=n;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return a=Vu(this,f),this.l=f+1,l=Cd.call(this,n-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(wm(Vu(this,f))),f+=1}e=s.join("");break;default:switch(n){case 1:return r=Vu(this,this.l),this.l++,r;case 2:return r=(t==="i"?f$:xd)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(n>0?_c:h$)(this,this.l),this.l+=4,r):(i=cs(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return n==8?i=bg(this,this.l):i=bg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:e=XR(this,this.l,n);break}}return this.l+=n,e}var d$=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},p$=function(n,t,e){n[e]=t&255,n[e+1]=t>>8&255,n[e+2]=t>>16&255,n[e+3]=t>>24&255},m$=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255};function g$(n,t,e){var r=0,i=0;if(e==="dbcs"){for(i=0;i!=t.length;++i)m$(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(e==="sbcs"||e=="cpstr"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(e==="hex"){for(;i<n;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+n,this.length);for(i=0;i<Math.min(t.length,n);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,d$(this,t,this.l);break;case 8:if(r=8,e==="f"){u$(this,t,this.l);break}case 16:break;case-4:r=4,p$(this,t,this.l);break}return this.l+=r,this}function oN(n,t){var e=XR(this,this.l,n.length>>1);if(e!==n)throw new Error(t+"Expected "+n+" saw "+e);this.l+=n.length>>1}function Ei(n,t){n.l=t,n.read_shift=Cd,n.chk=oN,n.write_shift=g$}function qa(n,t){n.l+=t}function Ut(n){var t=Mc(n);return Ei(t,0),t}function ai(){var n=[],t=fn?16384:2048;fn&&Ut(t).copy;var e=function(d){var p=Ut(d);return Ei(p,0),p},r=e(t),i=function(){r&&(r.l&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r)),r=null)},s=function(d){return r&&d<r.length-r.l?r:(i(),r=e(Math.max(d+1,t)))},a=function(){return i(),fr(n)},l=function(){return i(),n},u=function(d){i(),r=d,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:u,end:a,_bufs:n,end2:l}}function Xt(n,t,e,r){var i=+t,s;if(!isNaN(i)){r||(r=EX[i].p||(e||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=n.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&Ob(e)&&n.push(e)}}function Dd(n,t,e){var r=li(n);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!e||e.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function IT(n,t,e){var r=li(n);return r.s=Dd(r.s,t.s,e),r.e=Dd(r.e,t.s,e),r}function Od(n,t){if(n.cRel&&n.c<0)for(n=li(n);n.c<0;)n.c+=t>8?16384:256;if(n.rRel&&n.r<0)for(n=li(n);n.r<0;)n.r+=t>8?1048576:t>5?65536:16384;var e=Vn(n);return!n.cRel&&n.cRel!=null&&(e=x$(e)),!n.rRel&&n.rRel!=null&&(e=v$(e)),e}function lx(n,t){return n.s.r==0&&!n.s.rRel&&n.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+xn(n.s.c)+":"+(n.e.cRel?"":"$")+xn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(t.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Sn(n.s.r)+":"+(n.e.rRel?"":"$")+Sn(n.e.r):Od(n.s,t.biff)+":"+Od(n.e,t.biff)}function Rb(n){return parseInt(_$(n),10)-1}function Sn(n){return""+(n+1)}function v$(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _$(n){return n.replace(/\$(\d+)$/,"$1")}function Nb(n){for(var t=y$(n),e=0,r=0;r!==t.length;++r)e=26*e+t.charCodeAt(r)-64;return e-1}function xn(n){if(n<0)throw new Error("invalid column "+n);var t="";for(++n;n;n=Math.floor((n-1)/26))t=String.fromCharCode((n-1)%26+65)+t;return t}function x$(n){return n.replace(/^([A-Z])/,"$$$1")}function y$(n){return n.replace(/^\$([A-Z])/,"$1")}function b$(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Un(n){for(var t=0,e=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:t-1}}function Vn(n){for(var t=n.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(n.r+1)}function Hr(n){var t=n.indexOf(":");return t==-1?{s:Un(n),e:Un(n)}:{s:Un(n.slice(0,t)),e:Un(n.slice(t+1))}}function dr(n,t){return typeof t>"u"||typeof t=="number"?dr(n.s,n.e):(typeof n!="string"&&(n=Vn(n)),typeof t!="string"&&(t=Vn(t)),n==t?n:n+":"+t)}function Xd(n){var t=Hr(n);return"$"+xn(t.s.c)+"$"+Sn(t.s.r)+":$"+xn(t.e.c)+"$"+Sn(t.e.r)}function Kd(n,t){if(!n&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n.replace(/'/g,"''")+"'":n}function In(n){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,r=0,i=0,s=n.length;for(e=0;r<s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)e=26*e+i;for(t.s.c=--e,e=0;r<s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)e=10*e+i;if(t.s.r=--e,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,e=0;r!=s&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)e=26*e+i;for(t.e.c=--e,e=0;r!=s&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)e=10*e+i;return t.e.r=--e,t}function MT(n,t){var e=n.t=="d"&&t instanceof Date;if(n.z!=null)try{return n.w=zo(n.z,e?$r(t):t)}catch{}try{return n.w=zo((n.XF||{}).numFmtId||(e?14:0),e?$r(t):t)}catch{return""+t}}function jo(n,t,e){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&e&&e.dateNF&&(n.z=e.dateNF),n.t=="e"?Di[n.v]||n.v:t==null?MT(n,n.v):MT(n,t))}function Nf(n,t){var e=t&&t.sheet?t.sheet:"Sheet1",r={};return r[e]=n,{SheetNames:[e],Sheets:r}}function w$(n){var t={},e=n||{};return e.dense&&(t["!data"]=[]),t}function lN(n,t,e){var r=e||{},i=n?n["!data"]!=null:r.dense,s=n||(i?{"!data":[]}:{});i&&!s["!data"]&&(s["!data"]=[]);var a=0,l=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Un(r.origin):r.origin;a=u.r,l=u.c}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=In(s["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),a==-1&&(f.e.r=a=s["!ref"]?d.e.r+1:0)}else f.s.c=f.e.c=f.s.r=f.e.r=0;for(var p=[],m=!1,v=0;v!=t.length;++v)if(t[v]){if(!Array.isArray(t[v]))throw new Error("aoa_to_sheet expects an array of arrays");var x=a+v;i&&(s["!data"][x]||(s["!data"][x]=[]),p=s["!data"][x]);for(var _=t[v],y=0;y!=_.length;++y)if(!(typeof _[y]>"u")){var w={v:_[y],t:""},S=l+y;if(f.s.r>x&&(f.s.r=x),f.s.c>S&&(f.s.c=S),f.e.r<x&&(f.e.r=x),f.e.c<S&&(f.e.c=S),m=!0,_[y]&&typeof _[y]=="object"&&!Array.isArray(_[y])&&!(_[y]instanceof Date))w=_[y];else if(Array.isArray(w.v)&&(w.f=_[y][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(r.nullError)w.t="e",w.v=0;else if(r.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?isFinite(w.v)?w.t="n":isNaN(w.v)?(w.t="e",w.v=15):(w.t="e",w.v=7):typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=r.dateNF||Ln[14],r.UTC||(w.v=uv(w.v)),r.cellDates?(w.t="d",w.w=zo(w.z,$r(w.v,r.date1904))):(w.t="n",w.v=$r(w.v,r.date1904),w.w=zo(w.z,w.v))):w.t="s";if(i)p[S]&&p[S].z&&(w.z=p[S].z),p[S]=w;else{var T=xn(S)+(x+1);s[T]&&s[T].z&&(w.z=s[T].z),s[T]=w}}}return m&&f.s.c<104e5&&(s["!ref"]=dr(f)),s}function kf(n,t){return lN(null,n,t)}function E$(n){return n.read_shift(4,"i")}function la(n,t){return t||(t=Ut(4)),t.write_shift(4,n),t}function oi(n){var t=n.read_shift(4);return t===0?"":n.read_shift(t,"dbcs")}function wr(n,t){var e=!1;return t==null&&(e=!0,t=Ut(4+2*n.length)),t.write_shift(4,n.length),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}function A$(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function S$(n,t){return t||(t=Ut(4)),t.write_shift(2,0),t.write_shift(2,0),t}function kb(n,t){var e=n.l,r=n.read_shift(1),i=oi(n),s=[],a={t:i,h:i};if((r&1)!==0){for(var l=n.read_shift(4),u=0;u!=l;++u)s.push(A$(n));a.r=s}else a.r=[{ich:0,ifnt:0}];return n.l=e+t,a}function T$(n,t){var e=!1;return t==null&&(e=!0,t=Ut(15+4*n.t.length)),t.write_shift(1,0),wr(n.t,t),e?t.slice(0,t.l):t}var C$=kb;function D$(n,t){var e=!1;return t==null&&(e=!0,t=Ut(23+4*n.t.length)),t.write_shift(1,1),wr(n.t,t),t.write_shift(4,1),S$({},t),e?t.slice(0,t.l):t}function Gs(n){var t=n.read_shift(4),e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:t,iStyleRef:e}}function Wc(n,t){return t==null&&(t=Ut(8)),t.write_shift(-4,n.c),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}function qc(n){var t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:t}}function Yc(n,t){return t==null&&(t=Ut(4)),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}var O$=oi,cN=wr;function fv(n){var t=n.read_shift(4);return t===0||t===4294967295?"":n.read_shift(t,"dbcs")}function Zd(n,t){var e=!1;return t==null&&(e=!0,t=Ut(127)),t.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}var R$=oi,ty=fv,Lb=Zd;function Ib(n){var t=n.slice(n.l,n.l+4),e=t[0]&1,r=t[0]&2;n.l+=4;var i=r===0?bg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):_c(t,0)>>2;return e?i/100:i}function uN(n,t){t==null&&(t=Ut(4));var e=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,e=1),r)t.write_shift(-4,((e?i:n)<<2)+(e+2));else throw new Error("unsupported RkNumber "+n)}function fN(n){var t={s:{},e:{}};return t.s.r=n.read_shift(4),t.e.r=n.read_shift(4),t.s.c=n.read_shift(4),t.e.c=n.read_shift(4),t}function N$(n,t){return t||(t=Ut(16)),t.write_shift(4,n.s.r),t.write_shift(4,n.e.r),t.write_shift(4,n.s.c),t.write_shift(4,n.e.c),t}var Xc=fN,Lf=N$;function If(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Bc(n,t){return(t||Ut(8)).write_shift(8,n,"f")}function k$(n){var t={},e=n.read_shift(1),r=e>>>1,i=n.read_shift(1),s=n.read_shift(2,"i"),a=n.read_shift(1),l=n.read_shift(1),u=n.read_shift(1);switch(n.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var f=j$[i];f&&(t.rgb=qT(f));break;case 2:t.rgb=qT([a,l,u]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function wg(n,t){if(t||(t=Ut(8)),!n||n.auto)return t.write_shift(4,0),t.write_shift(4,0),t;n.index!=null?(t.write_shift(1,2),t.write_shift(1,n.index)):n.theme!=null?(t.write_shift(1,6),t.write_shift(1,n.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=n.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!n.rgb||n.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function L$(n){var t=n.read_shift(1);n.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function I$(n,t){t||(t=Ut(2));var e=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var hN=2,ss=3,Sm=11,Eg=19,Tm=64,M$=65,P$=71,F$=4108,B$=4126,Br=80,PT={1:{n:"CodePage",t:hN},2:{n:"Category",t:Br},3:{n:"PresentationFormat",t:Br},4:{n:"ByteCount",t:ss},5:{n:"LineCount",t:ss},6:{n:"ParagraphCount",t:ss},7:{n:"SlideCount",t:ss},8:{n:"NoteCount",t:ss},9:{n:"HiddenCount",t:ss},10:{n:"MultimediaClipCount",t:ss},11:{n:"ScaleCrop",t:Sm},12:{n:"HeadingPairs",t:F$},13:{n:"TitlesOfParts",t:B$},14:{n:"Manager",t:Br},15:{n:"Company",t:Br},16:{n:"LinksUpToDate",t:Sm},17:{n:"CharacterCount",t:ss},19:{n:"SharedDoc",t:Sm},22:{n:"HyperlinksChanged",t:Sm},23:{n:"AppVersion",t:ss,p:"version"},24:{n:"DigSig",t:M$},26:{n:"ContentType",t:Br},27:{n:"ContentStatus",t:Br},28:{n:"Language",t:Br},29:{n:"Version",t:Br},255:{},2147483648:{n:"Locale",t:Eg},2147483651:{n:"Behavior",t:Eg},1919054434:{}},FT={1:{n:"CodePage",t:hN},2:{n:"Title",t:Br},3:{n:"Subject",t:Br},4:{n:"Author",t:Br},5:{n:"Keywords",t:Br},6:{n:"Comments",t:Br},7:{n:"Template",t:Br},8:{n:"LastAuthor",t:Br},9:{n:"RevNumber",t:Br},10:{n:"EditTime",t:Tm},11:{n:"LastPrinted",t:Tm},12:{n:"CreatedDate",t:Tm},13:{n:"ModifiedDate",t:Tm},14:{n:"PageCount",t:ss},15:{n:"WordCount",t:ss},16:{n:"CharCount",t:ss},17:{n:"Thumbnail",t:P$},18:{n:"Application",t:Br},19:{n:"DocSecurity",t:ss},255:{},2147483648:{n:"Locale",t:Eg},2147483651:{n:"Behavior",t:Eg},1919054434:{}};function U$(n){return n.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var z$=U$([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),j$=li(z$),Di={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$a={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},H$=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],$$={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Cm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function dN(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pN(n,t,e){var r=GH($$),i=[],s;i[i.length]=pr,i[i.length]=se("Types",null,{xmlns:Dr.CT,"xmlns:xsd":Dr.xsd,"xmlns:xsi":Dr.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return se("Default",null,{Extension:f[0],ContentType:f[1]})}));var a=function(f){n[f]&&n[f].length>0&&(s=n[f][0],i[i.length]=se("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Cm[f][t.bookType]||Cm[f].xlsx}))},l=function(f){(n[f]||[]).forEach(function(d){i[i.length]=se("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Cm[f][t.bookType]||Cm[f].xlsx})})},u=function(f){(n[f]||[]).forEach(function(d){i[i.length]=se("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return a("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var en={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function mN(n){var t=n.lastIndexOf("/");return n.slice(0,t+1)+"_rels/"+n.slice(t+1)+".rels"}function ef(n){var t=[pr,se("Relationships",null,{xmlns:Dr.RELS})];return hr(n["!id"]).forEach(function(e){t[t.length]=se("Relationship",null,n["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function un(n,t,e,r,i,s){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),t<0)for(t=n["!idx"];n["!id"]["rId"+t];++t);if(n["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=e,[en.HLINK,en.XPATH,en.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,t}function G$(n){var t=[pr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<n.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+n[e][0]+'" manifest:media-type="'+n[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function BT(n,t,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function V$(n,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function W$(n){var t=[pr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=n.length;++e)t.push(BT(n[e][0],n[e][1])),t.push(V$("",n[e][0]));return t.push(BT("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function gN(n,t){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dg.version+"</meta:generator></office:meta></office:document-meta>"}var Tc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function cx(n,t,e,r,i){i[n]!=null||t==null||t===""||(i[n]=t,t=$e(t),r[r.length]=e?se(n,t,e):zr(n,t))}function vN(n,t){var e=t||{},r=[pr,se("cp:coreProperties",null,{"xmlns:cp":Dr.CORE_PROPS,"xmlns:dc":Dr.dc,"xmlns:dcterms":Dr.dcterms,"xmlns:dcmitype":Dr.dcmitype,"xmlns:xsi":Dr.xsi})],i={};if(!n&&!e.Props)return r.join("");n&&(n.CreatedDate!=null&&cx("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Jx(n.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&cx("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Jx(n.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Tc.length;++s){var a=Tc[s],l=e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:n?n[a[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&cx(a[0],l,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var nf=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],_N=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function xN(n){var t=[],e=se;return n||(n={}),n.Application="SheetJS",t[t.length]=pr,t[t.length]=se("Properties",null,{xmlns:Dr.EXT_PROPS,"xmlns:vt":Dr.vt}),nf.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=$e(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=e(r[0],i))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+$e(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function yN(n){var t=[pr,se("Properties",null,{xmlns:Dr.CUST_PROPS,"xmlns:vt":Dr.vt})];if(!n)return t.join("");var e=1;return hr(n).forEach(function(i){++e,t[t.length]=se("property",l$(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:$e(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var UT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function q$(n,t){var e=[];return hr(UT).map(function(r){for(var i=0;i<Tc.length;++i)if(Tc[i][1]==r)return Tc[i];for(i=0;i<nf.length;++i)if(nf[i][1]==r)return nf[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),e.push(zr(UT[r[1]]||r[1],i))}}),se("DocumentProperties",e.join(""),{xmlns:ls.o})}function Y$(n,t){var e=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&hr(n).forEach(function(s){if(Object.prototype.hasOwnProperty.call(n,s)){for(var a=0;a<Tc.length;++a)if(s==Tc[a][1])return;for(a=0;a<nf.length;++a)if(s==nf[a][1])return;for(a=0;a<e.length;++a)if(s==e[a])return;var l=n[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l=String(l),i.push(se(TT(s),l,{"dt:dt":u}))}}),t&&hr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(n&&Object.prototype.hasOwnProperty.call(n,s))){var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a instanceof Date?(l="dateTime.tz",a=a.toISOString()):a=String(a),i.push(se(TT(s),a,{"dt:dt":l}))}}),"<"+r+' xmlns="'+ls.o+'">'+i.join("")+"</"+r+">"}function X$(n){var t=typeof n=="string"?new Date(Date.parse(n)):n,e=t.getTime()/1e3+11644473600,r=e%Math.pow(2,32),i=(e-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=Ut(8);return a.write_shift(4,r),a.write_shift(4,i),a}function zT(n,t){var e=Ut(4),r=Ut(4);switch(e.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,t);break;case 5:r=Ut(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=X$(t);break;case 31:case 80:for(r=Ut(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+t)}return fr([e,r])}var bN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function K$(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function jT(n,t,e){var r=Ut(8),i=[],s=[],a=8,l=0,u=Ut(8),f=Ut(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),s.push(u),i.push(f),a+=8+u.length,!t){f=Ut(8),f.write_shift(4,0),i.unshift(f);var d=[Ut(4)];for(d[0].write_shift(4,n.length),l=0;l<n.length;++l){var p=n[l][0];for(u=Ut(8+2*(p.length+1)+(p.length%2?0:2)),u.write_shift(4,l+2),u.write_shift(4,p.length+1),u.write_shift(0,p,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=fr(d),s.unshift(u),a+=8+u.length}for(l=0;l<n.length;++l)if(!(t&&!t[n[l][0]])&&!(bN.indexOf(n[l][0])>-1||_N.indexOf(n[l][0])>-1)&&n[l][1]!=null){var m=n[l][1],v=0;if(t){v=+t[n[l][0]];var x=e[v];if(x.p=="version"&&typeof m=="string"){var _=m.split(".");m=(+_[0]<<16)+(+_[1]||0)}u=zT(x.t,m)}else{var y=K$(m);y==-1&&(y=31,m=String(m)),u=zT(y,m)}s.push(u),f=Ut(8),f.write_shift(4,t?v:2+l),i.push(f),a+=8+u.length}var w=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,w),w+=s[l].length;return r.write_shift(4,a),r.write_shift(4,s.length),fr([r].concat(i).concat(s))}function HT(n,t,e,r,i,s){var a=Ut(i?68:48),l=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Rn.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var u=jT(n,e,r);if(l.push(u),i){var f=jT(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+u.length),l.push(f)}return fr(l)}function Z$(n,t){t||(t=Ut(n));for(var e=0;e<n;++e)t.write_shift(1,0);return t}function Q$(n,t){return n.read_shift(t)===1}function ri(n,t){return t||(t=Ut(2)),t.write_shift(2,+!!n),t}function Ym(n){return n.read_shift(2,"u")}function Ms(n,t){return t||(t=Ut(2)),t.write_shift(2,n),t}function wN(n,t,e){return e||(e=Ut(2)),e.write_shift(1,t=="e"?+n:+!!n),e.write_shift(1,t=="e"?1:0),e}function EN(n,t,e){var r=n.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont",s=Ro;if(e&&e.biff>=8&&(Ro=1200),!e||e.biff==8){var a=n.read_shift(1);a&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var l=r?n.read_shift(r,i):"";return Ro=s,l}function J$(n){var t=n.t||"",e=Ut(3);e.write_shift(2,t.length),e.write_shift(1,1);var r=Ut(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[e,r];return fr(i)}function tG(n,t,e){var r;if(e){if(e.biff>=2&&e.biff<=5)return n.read_shift(t,"cpstr");if(e.biff>=12)return n.read_shift(t,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(t,"sbcs-cont"):r=n.read_shift(t,"dbcs-cont"),r}function eG(n,t,e){var r=n.read_shift(e&&e.biff==2?1:2);return r===0?(n.l++,""):tG(n,r,e)}function nG(n,t,e){if(e.biff>5)return eG(n,t,e);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,e.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function AN(n,t,e){return e||(e=Ut(3+2*n.length)),e.write_shift(2,n.length),e.write_shift(1,1),e.write_shift(31,n,"utf16le"),e}function $T(n,t){t||(t=Ut(6+n.length*2)),t.write_shift(4,1+n.length);for(var e=0;e<n.length;++e)t.write_shift(2,n.charCodeAt(e));return t.write_shift(2,0),t}function rG(n){var t=Ut(512),e=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)t.write_shift(4,a[e]);if(s==28)r=r.slice(1),$T(r,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));var l=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)t.write_shift(2,l.charCodeAt(e));t.write_shift(2,0),s&8&&$T(i>-1?r.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)t.write_shift(1,parseInt(a[e],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,r.length-3*u+1),e=0;e<r.length-3*u;++e)t.write_shift(1,r.charCodeAt(e+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function Uc(n,t,e,r){return r||(r=Ut(6)),r.write_shift(2,n),r.write_shift(2,t),r.write_shift(2,e||0),r}function iG(n,t,e){var r=e.biff>8?4:2,i=n.read_shift(r),s=n.read_shift(r,"i"),a=n.read_shift(r,"i");return[i,s,a]}function sG(n){var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:e}}}function SN(n,t){return t||(t=Ut(8)),t.write_shift(2,n.s.r),t.write_shift(2,n.e.r),t.write_shift(2,n.s.c),t.write_shift(2,n.e.c),t}function Mb(n,t,e){var r=1536,i=16;switch(e.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Ut(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function aG(n,t){var e=!t||t.biff==8,r=Ut(e?112:54);for(r.write_shift(t.biff==8?2:1,7),e&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(e?0:536870912));r.l<r.length;)r.write_shift(1,e?0:32);return r}function oG(n,t){var e=!t||t.biff>=8?2:1,r=Ut(8+e*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(e*n.name.length,n.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function lG(n,t){var e=Ut(8);e.write_shift(4,n.Count),e.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=J$(n[i]);var s=fr([e].concat(r));return s.parts=[e.length].concat(r.map(function(a){return a.length})),s}function cG(){var n=Ut(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function uG(n){var t=Ut(18),e=1718;return n&&n.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function fG(n,t){var e=n.name||"Arial",r=t&&t.biff==5,i=r?15+e.length:16+2*e.length,s=Ut(i);return s.write_shift(2,n.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,e.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*e.length,e,r?"sbcs":"utf16le"),s}function hG(n,t,e,r){var i=Ut(10);return Uc(n,t,r,i),i.write_shift(4,e),i}function dG(n,t,e,r,i){var s=!i||i.biff==8,a=Ut(8+ +s+(1+s)*e.length);return Uc(n,t,r,a),a.write_shift(2,e.length),s&&a.write_shift(1,1),a.write_shift((1+s)*e.length,e,s?"utf16le":"sbcs"),a}function pG(n,t,e,r){var i=e&&e.biff==5;r||(r=Ut(i?3+t.length:5+2*t.length)),r.write_shift(2,n),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function mG(n){var t=Ut(1+n.length);return t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t}function gG(n){var t=Ut(3+n.length);return t.l+=2,t.write_shift(1,n.length),t.write_shift(n.length,n,"sbcs"),t}function vG(n,t){var e=t.biff==8||!t.biff?4:2,r=Ut(2*e+6);return r.write_shift(e,n.s.r),r.write_shift(e,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function GT(n,t,e,r){var i=e&&e.biff==5;r||(r=Ut(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,t<<4));var s=0;return n.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function _G(n){var t=Ut(4);return t.l+=2,t.write_shift(1,n.numFmtId),t.l++,t}function TN(n){var t=Ut(12);return t.l++,t.write_shift(1,n.numFmtId),t.l+=10,t}var xG=TN;function yG(n){var t=Ut(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function ux(n,t,e,r,i,s){var a=Ut(8);return Uc(n,t,r,a),wN(e,s,a),a}function bG(n,t,e,r){var i=Ut(14);return Uc(n,t,r,i),Bc(e,i),i}function wG(n,t,e){if(e.biff<8||!(e.biff>8)&&t==n[n.l]+(n[n.l+1]==3?1:0)+1)return VT(n,t,e);for(var r=[],i=n.l+t,s=n.read_shift(e.biff>8?4:2);s--!==0;)r.push(iG(n,e.biff>8?12:6,e));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function VT(n,t,e){n[n.l+1]==3&&n[n.l]++;var r=EN(n,t,e);return r.charCodeAt(0)==3?r.slice(1):r}function fx(n,t,e,r){var i=Ut(6+(r||n.length));return i.write_shift(2,t),i.write_shift(2,e),i.write_shift(2,r||n.length),i.write_shift(n.length,n,"sbcs"),i}function EG(n){var t=Ut(2+n.length*8);t.write_shift(2,n.length);for(var e=0;e<n.length;++e)SN(n[e],t);return t}function AG(n){var t=Ut(24),e=Un(n[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return fr([t,rG(n[1])])}function SG(n){var t=n[1].Tooltip,e=Ut(10+2*(t.length+1));e.write_shift(2,2048);var r=Un(n[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var i=0;i<t.length;++i)e.write_shift(2,t.charCodeAt(i));return e.write_shift(2,0),e}function TG(n){return n||(n=Ut(4)),n.write_shift(2,1),n.write_shift(2,1),n}function CG(n,t,e){if(!e.cellStyles)return qa(n,t);var r=e&&e.biff>=12?4:2,i=n.read_shift(r),s=n.read_shift(r),a=n.read_shift(r),l=n.read_shift(r),u=n.read_shift(2);r==2&&(n.l+=2);var f={s:i,e:s,w:a,ixfe:l,flags:u};return(e.biff>=5||!e.biff)&&(f.level=u>>8&7),f}function DG(n,t){var e=Ut(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,n.width*256),e.write_shift(2,0);var r=0;return n.hidden&&(r|=1),e.write_shift(1,r),r=n.level||0,e.write_shift(1,r),e.write_shift(2,0),e}function OG(n){for(var t=Ut(2*n),e=0;e<n;++e)t.write_shift(2,e+1);return t}function xp(n,t,e,r,i){return n||(n=Ut(7)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,r||0),n.write_shift(1,i||0),n.write_shift(1,0),n}function RG(n,t,e,r,i){var s=Ut(15);return xp(s,n,t,r||0,i||0),s.write_shift(8,e,"f"),s}function NG(n,t,e,r,i){var s=Ut(9);return xp(s,n,t,r||0,i||0),s.write_shift(2,e),s}var kG=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Eb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,u){var f=[],d=Mc(1);switch(u.type){case"base64":d=os(Ll(l));break;case"binary":d=os(l);break;case"buffer":case"array":d=l;break}Ei(d,0);var p=d.read_shift(1),m=!!(p&136),v=!1,x=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var _=0,y=521;p==2&&(_=d.read_shift(2)),d.l+=3,p!=2&&(_=d.read_shift(4)),_>1048576&&(_=1e6),p!=2&&(y=d.read_shift(2));var w=d.read_shift(2);u.codepage,p!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&n[d[d.l]],d.l+=1,d.l+=2),x&&(d.l+=36);for(var S=[],T={},C=Math.min(d.length,p==2?521:y-10-(v?264:0)),R=x?32:11;d.l<C&&d[d.l]!=13;)switch(T={},T.name=Pc(d.slice(d.l,d.l+R)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=R,T.type=String.fromCharCode(d.read_shift(1)),p!=2&&!x&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),p==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&S.push(T),p!=2&&(d.l+=x?13:14),T.type){case"B":(!v||T.len!=8)&&u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var N=0,D=0;for(f[0]=[],D=0;D!=S.length;++D)f[0][D]=S[D].name;for(;_-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,f[++N]=[],D=0,D=0;D!=S.length;++D){var I=d.slice(d.l,d.l+S[D].len);d.l+=S[D].len,Ei(I,0);var M=Pc(I);switch(S[D].type){case"C":M.trim().length&&(f[N][D]=M.replace(/([^\s])\s+$/,"$1"));break;case"D":M.length===8?(f[N][D]=new Date(Date.UTC(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8),0,0,0,0)),u&&u.UTC||(f[N][D]=xf(f[N][D]))):f[N][D]=M;break;case"F":f[N][D]=parseFloat(M.trim());break;case"+":case"I":f[N][D]=x?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":f[N][D]=!0;break;case"N":case"F":f[N][D]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[N][D]="##MEMO##"+(x?parseInt(M.trim(),10):I.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(f[N][D]=+M||0);break;case"@":f[N][D]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":{var B=I.read_shift(4),H=I.read_shift(4);if(B==0&&H==0)break;f[N][D]=new Date((B-2440588)*864e5+H),u&&u.UTC||(f[N][D]=xf(f[N][D]))}break;case"Y":f[N][D]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[N][D]=-I.read_shift(-8,"f");break;case"B":if(v&&S[D].len==8){f[N][D]=I.read_shift(8,"f");break}case"G":case"P":I.l+=S[D].len;break;case"0":if(S[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[D].type)}}}if(p!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=S,f}function r(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=kf(e(l,f),f);return d["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,d}function i(l,u){try{var f=Nf(r(l,u),u);return f.bookType="dbf",f}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,u){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var f=u||{},d=Ro;if(+f.codepage>=0&&Wd(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=ai(),m=iy(l,{header:1,raw:!0,cellDates:!0}),v=m[0],x=m.slice(1),_=l["!cols"]||[],y=0,w=0,S=0,T=1;for(y=0;y<v.length;++y){if(((_[y]||{}).DBF||{}).name){v[y]=_[y].DBF.name,++S;continue}if(v[y]!=null){if(++S,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(w=0;w<1024;++w)if(v.indexOf(v[y]+"_"+w)==-1){v[y]+="_"+w;break}}}}var C=In(l["!ref"]),R=[],N=[],D=[];for(y=0;y<=C.e.c-C.s.c;++y){var I="",M="",B=0,H=[];for(w=0;w<x.length;++w)x[w][y]!=null&&H.push(x[w][y]);if(H.length==0||v[y]==null){R[y]="?";continue}for(w=0;w<H.length;++w){switch(typeof H[w]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=H[w]instanceof Date?"D":"C";break;default:M="C"}B=Math.max(B,String(H[w]).length),I=I&&I!=M?"C":M}B>250&&(B=250),M=((_[y]||{}).DBF||{}).type,M=="C"&&_[y].DBF.len>B&&(B=_[y].DBF.len),I=="B"&&M=="N"&&(I="N",D[y]=_[y].DBF.dec,B=_[y].DBF.len),N[y]=I=="C"||M=="N"?B:s[I]||0,T+=N[y],R[y]=I}var F=p.next(32);for(F.write_shift(4,318902576),F.write_shift(4,x.length),F.write_shift(2,296+32*S),F.write_shift(2,T),y=0;y<4;++y)F.write_shift(4,0);var rt=+t[Ro]||3;for(F.write_shift(4,0|rt<<8),n[rt]!=+f.codepage&&(f.codepage&&console.error("DBF Unsupported codepage "+Ro+", using 1252"),Ro=1252),y=0,w=0;y<v.length;++y)if(v[y]!=null){var L=p.next(32),it=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,it,"sbcs"),L.write_shift(1,R[y]=="?"?"C":R[y],"sbcs"),L.write_shift(4,w),L.write_shift(1,N[y]||s[R[y]]||0),L.write_shift(1,D[y]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),w+=N[y]||s[R[y]]||0}var Z=p.next(264);for(Z.write_shift(4,13),y=0;y<65;++y)Z.write_shift(4,0);for(y=0;y<x.length;++y){var q=p.next(T);for(q.write_shift(1,0),w=0;w<v.length;++w)if(v[w]!=null)switch(R[w]){case"L":q.write_shift(1,x[y][w]==null?63:x[y][w]?84:70);break;case"B":q.write_shift(8,x[y][w]||0,"f");break;case"N":var Ct="0";for(typeof x[y][w]=="number"&&(Ct=x[y][w].toFixed(D[w]||0)),Ct.length>N[w]&&(Ct=Ct.slice(0,N[w])),S=0;S<N[w]-Ct.length;++S)q.write_shift(1,32);q.write_shift(1,Ct,"sbcs");break;case"D":x[y][w]?(q.write_shift(4,("0000"+x[y][w].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(x[y][w].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+x[y][w].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var at=q.l,P=String(x[y][w]!=null?x[y][w]:"").slice(0,N[w]);for(q.write_shift(1,P,"cpstr"),at+=N[w]-q.l,S=0;S<at;++S)q.write_shift(1,32);break}}return Ro=d,p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}}(),LG=function(){var n={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+hr(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{t=new RegExp("\x1BN("+hr(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var e=function(v,x){var _=n[x];return typeof _=="number"?pT(_):_},r=function(v,x,_){var y=x.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return y==59?v:pT(y)};n["|"]=254;var i=function(v){return v.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function s(v,x){switch(x.type){case"base64":return a(Ll(v),x);case"binary":return a(v,x);case"buffer":return a(fn&&Buffer.isBuffer(v)?v.toString("binary"):Pc(v),x);case"array":return a(Ab(v),x)}throw new Error("Unrecognized type "+x.type)}function a(v,x){var _=v.split(/[\n\r]+/),y=-1,w=-1,S=0,T=0,C=[],R=[],N=null,D={},I=[],M=[],B=[],H=0,F,rt={Workbook:{WBProps:{},Names:[]}};for(+x.codepage>=0&&Wd(+x.codepage);S!==_.length;++S){H=0;var L=_[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,e),it=L.replace(/;;/g,"\0").split(";").map(function(ot){return ot.replace(/\u0000/g,";")}),Z=it[0],q;if(L.length>0)switch(Z){case"ID":break;case"E":break;case"B":break;case"O":for(T=1;T<it.length;++T)switch(it[T].charAt(0)){case"V":{var Ct=parseInt(it[T].slice(1),10);Ct>=1&&Ct<=4&&(rt.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(it[1].charAt(0)){case"P":R.push(L.slice(3).replace(/;;/g,";"));break}break;case"NN":{var at={Sheet:0};for(T=1;T<it.length;++T)switch(it[T].charAt(0)){case"N":at.Name=it[T].slice(1);break;case"E":at.Ref=(x&&x.sheet||"Sheet1")+"!"+KT(it[T].slice(1));break}rt.Workbook.Names.push(at)}break;case"C":var P=!1,V=!1,j=!1,et=!1,dt=-1,xt=-1,Nt="",Rt="z",z="";for(T=1;T<it.length;++T)switch(it[T].charAt(0)){case"A":z=it[T].slice(1);break;case"X":w=parseInt(it[T].slice(1),10)-1,V=!0;break;case"Y":for(y=parseInt(it[T].slice(1),10)-1,V||(w=0),F=C.length;F<=y;++F)C[F]=[];break;case"K":q=it[T].slice(1),q.charAt(0)==='"'?(q=q.slice(1,q.length-1),Rt="s"):q==="TRUE"||q==="FALSE"?(q=q==="TRUE",Rt="b"):q.charAt(0)=="#"&&$a[q]!=null?(Rt="e",q=$a[q]):isNaN(Mo(q))||(q=Mo(q),Rt="n",N!==null&&Fc(N)&&x.cellDates&&(q=Ju(rt.Workbook.WBProps.date1904?q+1462:q),Rt=typeof q=="number"?"n":"d")),P=!0;break;case"E":et=!0,Nt=KT(it[T].slice(1),{r:y,c:w});break;case"S":j=!0;break;case"G":break;case"R":dt=parseInt(it[T].slice(1),10)-1;break;case"C":xt=parseInt(it[T].slice(1),10)-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}if(P&&(C[y][w]?(C[y][w].t=Rt,C[y][w].v=q):C[y][w]={t:Rt,v:q},N&&(C[y][w].z=N),x.cellText!==!1&&N&&(C[y][w].w=zo(C[y][w].z,C[y][w].v,{date1904:rt.Workbook.WBProps.date1904})),N=null),j){if(et)throw new Error("SYLK shared formula cannot have own formula");var lt=dt>-1&&C[dt][xt];if(!lt||!lt[1])throw new Error("SYLK shared formula cannot find base");Nt=IV(lt[1],{r:y-dt,c:w-xt})}Nt&&(C[y][w]?C[y][w].f=Nt:C[y][w]={t:"n",f:Nt}),z&&(C[y][w]||(C[y][w]={t:"z"}),C[y][w].c=[{a:"SheetJSYLK",t:z}]);break;case"F":var J=0;for(T=1;T<it.length;++T)switch(it[T].charAt(0)){case"X":w=parseInt(it[T].slice(1),10)-1,++J;break;case"Y":for(y=parseInt(it[T].slice(1),10)-1,F=C.length;F<=y;++F)C[F]=[];break;case"M":H=parseInt(it[T].slice(1),10)/20;break;case"F":break;case"G":break;case"P":N=R[parseInt(it[T].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(B=it[T].slice(1).split(" "),F=parseInt(B[0],10);F<=parseInt(B[1],10);++F)H=parseInt(B[2],10),M[F-1]=H===0?{hidden:!0}:{wch:H};break;case"C":w=parseInt(it[T].slice(1),10)-1,M[w]||(M[w]={});break;case"R":y=parseInt(it[T].slice(1),10)-1,I[y]||(I[y]={}),H>0?(I[y].hpt=H,I[y].hpx=RN(H)):H===0&&(I[y].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}J<1&&(N=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}}return I.length>0&&(D["!rows"]=I),M.length>0&&(D["!cols"]=M),M.forEach(function(ot){Pb(ot)}),x&&x.sheetRows&&(C=C.slice(0,x.sheetRows)),[C,D,rt]}function l(v,x){var _=s(v,x),y=_[0],w=_[1],S=_[2],T=li(x);T.date1904=(((S||{}).Workbook||{}).WBProps||{}).date1904;var C=kf(y,T);hr(w).forEach(function(N){C[N]=w[N]});var R=Nf(C,x);return hr(S).forEach(function(N){R[N]=S[N]}),R.bookType="sylk",R}function u(v,x,_,y,w,S){var T="C;Y"+(_+1)+";X"+(y+1)+";K";switch(v.t){case"n":T+=isFinite(v.v)?v.v||0:Di[isNaN(v.v)?36:7],v.f&&!v.F&&(T+=";E"+dv(v.f,{r:_,c:y}));break;case"b":T+=v.v?"TRUE":"FALSE";break;case"e":T+=v.w||Di[v.v]||v.v;break;case"d":T+=$r(Wi(v.v,S),S);break;case"s":T+='"'+(v.v==null?"":String(v.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function f(v,x,_){var y="C;Y"+(x+1)+";X"+(_+1)+";A";return y+=i(v.map(function(w){return w.t}).join("")),y}function d(v,x){x.forEach(function(_,y){var w="F;W"+(y+1)+" "+(y+1)+" ";_.hidden?w+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=Ag(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=Sg(_.wpx)),typeof _.wch=="number"&&(w+=Math.round(_.wch))),w.charAt(w.length-1)!=" "&&v.push(w)})}function p(v,x){x.forEach(function(_,y){var w="F;";_.hidden?w+="M0;":_.hpt?w+="M"+20*_.hpt+";":_.hpx&&(w+="M"+20*Tg(_.hpx)+";"),w.length>2&&v.push(w+"R"+(y+1))})}function m(v,x,_){x||(x={}),x._formats=["General"];var y=["ID;PSheetJS;N;E"],w=[],S=In(v["!ref"]||"A1"),T,C=v["!data"]!=null,R=`\r
`,N=(((_||{}).Workbook||{}).WBProps||{}).date1904,D="General";y.push("P;PGeneral");var I=S.s.r,M=S.s.c,B=[];if(v["!ref"]){for(I=S.s.r;I<=S.e.r;++I)if(!(C&&!v["!data"][I])){for(B=[],M=S.s.c;M<=S.e.c;++M)T=C?v["!data"][I][M]:v[xn(M)+Sn(I)],!(!T||!T.c)&&B.push(f(T.c,I,M));B.length&&w.push(B.join(R))}}if(v["!ref"]){for(I=S.s.r;I<=S.e.r;++I)if(!(C&&!v["!data"][I])){for(B=[],M=S.s.c;M<=S.e.c;++M)if(T=C?v["!data"][I][M]:v[xn(M)+Sn(I)],!(!T||T.v==null&&(!T.f||T.F))){if((T.z||(T.t=="d"?Ln[14]:"General"))!=D){var H=x._formats.indexOf(T.z);H==-1&&(x._formats.push(T.z),H=x._formats.length-1,y.push("P;P"+T.z.replace(/;/g,";;"))),B.push("F;P"+H+";Y"+(I+1)+";X"+(M+1))}B.push(u(T,v,I,M,x,N))}w.push(B.join(R))}}return y.push("F;P0;DG0G8;M255"),v["!cols"]&&d(y,v["!cols"]),v["!rows"]&&p(y,v["!rows"]),v["!ref"]&&y.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" ")),y.push("O;L;D;B"+(N?";V4":"")+";K47;G100 0.001"),delete x._formats,y.join(R)+R+w.join(R)+R+"E"+R}return{to_workbook:l,from_sheet:m}}(),IG=function(){function n(l,u){switch(u.type){case"base64":return t(Ll(l),u);case"binary":return t(l,u);case"buffer":return t(fn&&Buffer.isBuffer(l)?l.toString("binary"):Pc(l),u);case"array":return t(Ab(l),u)}throw new Error("Unrecognized type "+u.type)}function t(l,u){for(var f=l.split(`
`),d=-1,p=-1,m=0,v=[];m!==f.length;++m){if(f[m].trim()==="BOT"){v[++d]=[],p=0;continue}if(!(d<0)){var x=f[m].trim().split(","),_=x[0],y=x[1];++m;for(var w=f[m]||"";(w.match(/["]/g)||[]).length&1&&m<f.length-1;)w+=`
`+f[++m];switch(w=w.trim(),+_){case-1:if(w==="BOT"){v[++d]=[],p=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[d][p]=!0:w==="FALSE"?v[d][p]=!1:isNaN(Mo(y))?isNaN(yg(y).getDate())?v[d][p]=y:(v[d][p]=Wi(y),u&&u.UTC||(v[d][p]=xf(v[d][p]))):v[d][p]=Mo(y),++p;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[d][p++]=w!==""?w:null;break}if(w==="EOD")break}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function e(l,u){return kf(n(l,u),u)}function r(l,u){var f=Nf(e(l,u),u);return f.bookType="dif",f}function i(l,u){return"0,"+String(l)+`\r
`+u}function s(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function a(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var u=In(l["!ref"]),f=l["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(u.e.r-u.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(u.e.c-u.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],p=u.s.r;p<=u.e.r;++p){for(var m=f?l["!data"][p]:[],v=`-1,0\r
BOT\r
`,x=u.s.c;x<=u.e.c;++x){var _=f?m&&m[x]:l[Vn({r:p,c:x})];if(_==null){v+=`1,0\r
""\r
`;continue}switch(_.t){case"n":_.w!=null?v+="0,"+_.w+`\r
V`:_.v!=null?v+=i(_.v,"V"):_.f!=null&&!_.F?v+=s("="+_.f):v+=`1,0\r
""`;break;case"b":v+=_.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":v+=s(isNaN(+_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=zo(_.z||Ln[14],$r(Wi(_.v)))),v+=i(_.w,"V");break;default:v+=`1,0\r
""`}v+=`\r
`}d.push(v)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:r,to_sheet:e,from_sheet:a}}(),CN=function(){function n(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,m){for(var v=p.split(`
`),x=-1,_=-1,y=0,w=[];y!==v.length;++y){var S=v[y].trim().split(":");if(S[0]==="cell"){var T=Un(S[1]);if(w.length<=T.r)for(x=w.length;x<=T.r;++x)w[x]||(w[x]=[]);switch(x=T.r,_=T.c,S[2]){case"t":w[x][_]=n(S[3]);break;case"v":w[x][_]=+S[3];break;case"vtf":var C=S[S.length-1];case"vtc":switch(S[3]){case"nl":w[x][_]=!!+S[4];break;default:w[x][_]=S[S.length-1].charAt(0)=="#"?{t:"e",v:$a[S[S.length-1]]}:+S[4];break}S[2]=="vtf"&&(w[x][_]=[w[x][_],C])}}}return m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),w}function r(p,m){return kf(e(p,m),m)}function i(p,m){return Nf(r(p,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var m=[],v=[],x,_="",y=Hr(p["!ref"]),w=p["!data"]!=null,S=y.s.r;S<=y.e.r;++S)for(var T=y.s.c;T<=y.e.c;++T)if(_=Vn({r:S,c:T}),x=w?(p["!data"][S]||[])[T]:p[_],!(!x||x.v==null||x.t==="z")){switch(v=["cell",_,"t"],x.t){case"s":v.push(t(x.v));break;case"b":v[2]="vt"+(x.f?"f":"c"),v[3]="nl",v[4]=x.v?"1":"0",v[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var C=$r(Wi(x.v));v[2]="vtc",v[3]="nd",v[4]=""+C,v[5]=x.w||zo(x.z||Ln[14],C);break;case"n":isFinite(x.v)?x.f?(v[2]="vtf",v[3]="n",v[4]=x.v,v[5]=t(x.f)):(v[2]="v",v[3]=x.v):(v[2]="vt"+(x.f?"f":"c"),v[3]="e"+Di[isNaN(x.v)?36:7],v[4]="0",v[5]=x.f||v[3].slice(1),v[6]="e",v[7]=v[3].slice(1));break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(p){return[s,a,l,a,f(p),u].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:d}}(),MG=function(){function n(d,p,m,v,x){x.raw?p[m][v]=d:d===""||(d==="TRUE"?p[m][v]=!0:d==="FALSE"?p[m][v]=!1:isNaN(Mo(d))?isNaN(yg(d).getDate())?d.charCodeAt(0)==35&&$a[d]!=null?p[m][v]={t:"e",v:$a[d],w:d}:p[m][v]=d:p[m][v]=Wi(d):p[m][v]=Mo(d))}function t(d,p){var m=p||{},v=[];if(!d||d.length===0)return v;for(var x=d.split(/[\r\n]/),_=x.length-1;_>=0&&x[_].length===0;)--_;for(var y=10,w=0,S=0;S<=_;++S)w=x[S].indexOf(" "),w==-1?w=x[S].length:w++,y=Math.max(y,w);for(S=0;S<=_;++S){v[S]=[];var T=0;for(n(x[S].slice(0,y).trim(),v,S,T,m),T=1;T<=(x[S].length-y)/10+1;++T)n(x[S].slice(y+(T-1)*10,y+T*10).trim(),v,S,T,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var e={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(d){for(var p={},m=!1,v=0,x=0;v<d.length;++v)(x=d.charCodeAt(v))==34?m=!m:!m&&x in e&&(p[x]=(p[x]||0)+1);x=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&x.push([p[v],v]);if(!x.length){p=r;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&x.push([p[v],v])}return x.sort(function(_,y){return _[0]-y[0]||r[_[1]]-r[y[1]]}),e[x.pop()[1]]||44}function s(d,p){var m=p||{},v="",x={};m.dense&&(x["!data"]=[]);var _={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):m&&m.FS?v=m.FS:v=i(d.slice(0,1024));var y=0,w=0,S=0,T=0,C=0,R=v.charCodeAt(0),N=!1,D=0,I=d.charCodeAt(0),M=m.dateNF!=null?UH(m.dateNF):null;function B(){var H=d.slice(T,C);H.slice(-1)=="\r"&&(H=H.slice(0,-1));var F={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),m.cellText!==!1&&(F.w=H),H.length===0)F.t="z";else if(m.raw)F.t="s",F.v=H;else if(H.trim().length===0)F.t="s",F.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(F.t="s",F.v=H.slice(2,-1).replace(/""/g,'"')):MV(H)?(F.t="s",F.f=H.slice(1),F.v=H):(F.t="s",F.v=H);else if(H=="TRUE")F.t="b",F.v=!0;else if(H=="FALSE")F.t="b",F.v=!1;else if(!isNaN(S=Mo(H)))F.t="n",F.v=S;else if(!isNaN((S=yg(H)).getDate())||M&&H.match(M)){if(F.z=m.dateNF||Ln[14],M&&H.match(M)){var rt=zH(H,m.dateNF,H.match(M)||[]);S=Wi(rt),m&&m.UTC===!1&&(S=xf(S))}else m&&m.UTC===!1?S=xf(S):m.cellText!==!1&&m.dateNF&&(F.w=zo(F.z,S));m.cellDates?(F.t="d",F.v=S):(F.t="n",F.v=$r(S)),m.cellNF||delete F.z}else H.charCodeAt(0)==35&&$a[H]!=null?(F.t="e",F.w=H,F.v=$a[H]):(F.t="s",F.v=H);if(F.t=="z"||(m.dense?(x["!data"][y]||(x["!data"][y]=[]),x["!data"][y][w]=F):x[Vn({c:w,r:y})]=F),T=C+1,I=d.charCodeAt(T),_.e.c<w&&(_.e.c=w),_.e.r<y&&(_.e.r=y),D==R)++w;else if(w=0,++y,m.sheetRows&&m.sheetRows<=y)return!0}t:for(;C<d.length;++C)switch(D=d.charCodeAt(C)){case 34:I===34&&(N=!N);break;case 13:if(N)break;d.charCodeAt(C+1)==10&&++C;case R:case 10:if(!N&&B())break t;break}return C-T>0&&B(),x["!ref"]=dr(_),x}function a(d,p){return!(p&&p.PRN)||p.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,p):kf(t(d,p),p)}function l(d,p){var m="",v=p.type=="string"?[0,0,0,0]:lK(d,p);switch(p.type){case"base64":m=Ll(d);break;case"binary":m=d;break;case"buffer":p.codepage==65001?m=d.toString("utf8"):(p.codepage,m=fn&&Buffer.isBuffer(d)?d.toString("binary"):Pc(d));break;case"array":m=Ab(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=tf(m.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?m=tf(m):p.type=="binary",m.slice(0,19)=="socialcalc:version:"?CN.to_sheet(p.type=="string"?m:tf(m),p):a(m,p)}function u(d,p){return Nf(l(d,p),p)}function f(d){var p=[];if(!d["!ref"])return"";for(var m=In(d["!ref"]),v,x=d["!data"]!=null,_=m.s.r;_<=m.e.r;++_){for(var y=[],w=m.s.c;w<=m.e.c;++w){var S=Vn({r:_,c:w});if(v=x?(d["!data"][_]||[])[w]:d[S],!v||v.v==null){y.push("          ");continue}for(var T=(v.w||(jo(v),v.w)||"").slice(0,10);T.length<10;)T+=" ";y.push(T+(w===0?" ":""))}p.push(y.join(""))}return p.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}(),WT=function(){function n(z,lt,J){if(z){Ei(z,z.l||0);for(var ot=J.Enum||et;z.l<z.length;){var yt=z.read_shift(2),At=ot[yt]||ot[65535],O=z.read_shift(2),gt=z.l+O,ut=At.f&&At.f(z,O,J);if(z.l=gt,lt(ut,At,yt))return}}}function t(z,lt){switch(lt.type){case"base64":return r(os(Ll(z)),lt);case"binary":return r(os(z),lt);case"buffer":case"array":return r(z,lt)}throw"Unsupported type "+lt.type}var e=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function r(z,lt){if(!z)return z;var J=lt||{},ot={},yt="Sheet1",At="",O=0,gt={},ut=[],K=[],X=[];J.dense&&(X=ot["!data"]=[]);var pt={s:{r:0,c:0},e:{r:0,c:0}},Bt=J.sheetRows||0,Ht={};if(z[4]==81&&z[5]==80&&z[6]==87)return Rt(z,lt);if(z[2]==0&&(z[3]==8||z[3]==9)&&z.length>=16&&z[14]==5&&z[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(z[2]==2)J.Enum=et,n(z,function(vt,te,ae){switch(ae){case 0:J.vers=vt,vt>=4096&&(J.qpro=!0);break;case 255:J.vers=vt,J.works=!0;break;case 6:pt=vt;break;case 204:vt&&(At=vt);break;case 222:At=vt;break;case 15:case 51:(!J.qpro&&!J.works||ae==51)&&vt[1].v.charCodeAt(0)<48&&(vt[1].v=vt[1].v.slice(1)),(J.works||J.works2)&&(vt[1].v=vt[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(vt[2]&112)==112&&(vt[2]&15)>1&&(vt[2]&15)<15&&(vt[1].z=J.dateNF||e[(vt[2]&15)-1]||Ln[14],J.cellDates&&(vt[1].v=Ju(vt[1].v),vt[1].t=typeof vt[1].v=="number"?"n":"d")),J.qpro&&vt[3]>O&&(ot["!ref"]=dr(pt),gt[yt]=ot,ut.push(yt),ot={},J.dense&&(X=ot["!data"]=[]),pt={s:{r:0,c:0},e:{r:0,c:0}},O=vt[3],yt=At||"Sheet"+(O+1),At="");var ne=J.dense?(X[vt[0].r]||[])[vt[0].c]:ot[Vn(vt[0])];if(ne){ne.t=vt[1].t,ne.v=vt[1].v,vt[1].z!=null&&(ne.z=vt[1].z),vt[1].f!=null&&(ne.f=vt[1].f),Ht=ne;break}J.dense?(X[vt[0].r]||(X[vt[0].r]=[]),X[vt[0].r][vt[0].c]=vt[1]):ot[Vn(vt[0])]=vt[1],Ht=vt[1];break;case 21509:J.works2=!0;break;case 21506:vt==5281&&(Ht.z="hh:mm:ss",J.cellDates&&Ht.t=="n"&&(Ht.v=Ju(Ht.v),Ht.t=typeof Ht.v=="number"?"n":"d"));break}},J);else if(z[2]==26||z[2]==14)J.Enum=dt,z[2]==14&&(J.qpro=!0,z.l=0),n(z,function(vt,te,ae){switch(ae){case 204:yt=vt;break;case 22:vt[1].v.charCodeAt(0)<48&&(vt[1].v=vt[1].v.slice(1)),vt[1].v=vt[1].v.replace(/\x0F./g,function(ne){return String.fromCharCode(ne.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(vt[3]>O&&(ot["!ref"]=dr(pt),gt[yt]=ot,ut.push(yt),ot={},J.dense&&(X=ot["!data"]=[]),pt={s:{r:0,c:0},e:{r:0,c:0}},O=vt[3],yt="Sheet"+(O+1)),Bt>0&&vt[0].r>=Bt)break;J.dense?(X[vt[0].r]||(X[vt[0].r]=[]),X[vt[0].r][vt[0].c]=vt[1]):ot[Vn(vt[0])]=vt[1],pt.e.c<vt[0].c&&(pt.e.c=vt[0].c),pt.e.r<vt[0].r&&(pt.e.r=vt[0].r);break;case 27:vt[14e3]&&(K[vt[14e3][0]]=vt[14e3][1]);break;case 1537:K[vt[0]]=vt[1],vt[0]==O&&(yt=vt[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+z[2]);if(ot["!ref"]=dr(pt),gt[At||yt]=ot,ut.push(At||yt),!K.length)return{SheetNames:ut,Sheets:gt};for(var St={},It=[],Tt=0;Tt<K.length;++Tt)gt[ut[Tt]]?(It.push(K[Tt]||ut[Tt]),St[K[Tt]]=gt[K[Tt]]||gt[ut[Tt]]):(It.push(K[Tt]),St[K[Tt]]={"!ref":"A1"});return{SheetNames:It,Sheets:St}}function i(z,lt){var J=lt||{};if(+J.codepage>=0&&Wd(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var ot=ai();if(!z["!ref"])throw new Error("Cannot export empty sheet to WK1");var yt=In(z["!ref"]),At=z["!data"]!=null,O=[];Zt(ot,0,a(1030)),Zt(ot,6,f(yt));for(var gt=Math.min(yt.e.r,8191),ut=yt.s.c;ut<=yt.e.c;++ut)O[ut]=xn(ut);for(var K=yt.s.r;K<=gt;++K){var X=Sn(K);for(ut=yt.s.c;ut<=yt.e.c;++ut){var pt=At?(z["!data"][K]||[])[ut]:z[O[ut]+X];if(!(!pt||pt.t=="z"))switch(pt.t){case"n":(pt.v|0)==pt.v&&pt.v>=-32768&&pt.v<=32767?Zt(ot,13,y(K,ut,pt)):Zt(ot,14,S(K,ut,pt));break;case"d":var Bt=$r(pt.v);(Bt|0)==Bt&&Bt>=-32768&&Bt<=32767?Zt(ot,13,y(K,ut,{v:Bt,z:pt.z||Ln[14]})):Zt(ot,14,S(K,ut,{v:Bt,z:pt.z||Ln[14]}));break;default:var Ht=jo(pt);Zt(ot,15,v(K,ut,Ht.slice(0,239)))}}}return Zt(ot,1),ot.end()}function s(z,lt){var J=lt||{};if(+J.codepage>=0&&Wd(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var ot=ai();Zt(ot,0,l(z));for(var yt=0,At=0;yt<z.SheetNames.length;++yt)(z.Sheets[z.SheetNames[yt]]||{})["!ref"]&&Zt(ot,27,j(z.SheetNames[yt],At++));var O=0;for(yt=0;yt<z.SheetNames.length;++yt){var gt=z.Sheets[z.SheetNames[yt]];if(!(!gt||!gt["!ref"])){for(var ut=In(gt["!ref"]),K=gt["!data"]!=null,X=[],pt=Math.min(ut.e.r,8191),Bt=ut.s.r;Bt<=pt;++Bt)for(var Ht=Sn(Bt),St=ut.s.c;St<=ut.e.c;++St){Bt===ut.s.r&&(X[St]=xn(St));var It=X[St]+Ht,Tt=K?(gt["!data"][Bt]||[])[St]:gt[It];if(!(!Tt||Tt.t=="z"))if(Tt.t=="n")Zt(ot,23,rt(Bt,St,O,Tt.v));else{var vt=jo(Tt);Zt(ot,22,B(Bt,St,O,vt.slice(0,239)))}}++O}}return Zt(ot,1),ot.end()}function a(z){var lt=Ut(2);return lt.write_shift(2,z),lt}function l(z){var lt=Ut(26);lt.write_shift(2,4096),lt.write_shift(2,4),lt.write_shift(4,0);for(var J=0,ot=0,yt=0,At=0;At<z.SheetNames.length;++At){var O=z.SheetNames[At],gt=z.Sheets[O];if(!(!gt||!gt["!ref"])){++yt;var ut=Hr(gt["!ref"]);J<ut.e.r&&(J=ut.e.r),ot<ut.e.c&&(ot=ut.e.c)}}return J>8191&&(J=8191),lt.write_shift(2,J),lt.write_shift(1,yt),lt.write_shift(1,ot),lt.write_shift(2,0),lt.write_shift(2,0),lt.write_shift(1,1),lt.write_shift(1,2),lt.write_shift(4,0),lt.write_shift(4,0),lt}function u(z,lt,J){var ot={s:{c:0,r:0},e:{c:0,r:0}};return lt==8&&J.qpro?(ot.s.c=z.read_shift(1),z.l++,ot.s.r=z.read_shift(2),ot.e.c=z.read_shift(1),z.l++,ot.e.r=z.read_shift(2),ot):(ot.s.c=z.read_shift(2),ot.s.r=z.read_shift(2),lt==12&&J.qpro&&(z.l+=2),ot.e.c=z.read_shift(2),ot.e.r=z.read_shift(2),lt==12&&J.qpro&&(z.l+=2),ot.s.c==65535&&(ot.s.c=ot.e.c=ot.s.r=ot.e.r=0),ot)}function f(z){var lt=Ut(8);return lt.write_shift(2,z.s.c),lt.write_shift(2,z.s.r),lt.write_shift(2,z.e.c),lt.write_shift(2,z.e.r),lt}function d(z,lt,J){var ot=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(ot[0].c=z.read_shift(1),ot[3]=z.read_shift(1),ot[0].r=z.read_shift(2),z.l+=2):J.works?(ot[0].c=z.read_shift(2),ot[0].r=z.read_shift(2),ot[2]=z.read_shift(2)):(ot[2]=z.read_shift(1),ot[0].c=z.read_shift(2),ot[0].r=z.read_shift(2)),ot}function p(z){return z.z&&Fc(z.z)?240|(e.indexOf(z.z)+1||2):255}function m(z,lt,J){var ot=z.l+lt,yt=d(z,lt,J);if(yt[1].t="s",(J.vers&65534)==20768){z.l++;var At=z.read_shift(1);return yt[1].v=z.read_shift(At,"utf8"),yt}return J.qpro&&z.l++,yt[1].v=z.read_shift(ot-z.l,"cstr"),yt}function v(z,lt,J){var ot=Ut(7+J.length);ot.write_shift(1,255),ot.write_shift(2,lt),ot.write_shift(2,z),ot.write_shift(1,39);for(var yt=0;yt<ot.length;++yt){var At=J.charCodeAt(yt);ot.write_shift(1,At>=128?95:At)}return ot.write_shift(1,0),ot}function x(z,lt,J){var ot=z.l+lt,yt=d(z,lt,J);if(yt[1].t="s",J.vers==20768){var At=z.read_shift(1);return yt[1].v=z.read_shift(At,"utf8"),yt}return yt[1].v=z.read_shift(ot-z.l,"cstr"),yt}function _(z,lt,J){var ot=d(z,lt,J);return ot[1].v=z.read_shift(2,"i"),ot}function y(z,lt,J){var ot=Ut(7);return ot.write_shift(1,p(J)),ot.write_shift(2,lt),ot.write_shift(2,z),ot.write_shift(2,J.v,"i"),ot}function w(z,lt,J){var ot=d(z,lt,J);return ot[1].v=z.read_shift(8,"f"),ot}function S(z,lt,J){var ot=Ut(13);return ot.write_shift(1,p(J)),ot.write_shift(2,lt),ot.write_shift(2,z),ot.write_shift(8,J.v,"f"),ot}function T(z,lt,J){var ot=z.l+lt,yt=d(z,lt,J);if(yt[1].v=z.read_shift(8,"f"),J.qpro)z.l=ot;else{var At=z.read_shift(2);D(z.slice(z.l,z.l+At),yt),z.l+=At}return yt}function C(z,lt,J){var ot=lt&32768;return lt&=-32769,lt=(ot?z:0)+(lt>=8192?lt-16384:lt),(ot?"":"$")+(J?xn(lt):Sn(lt))}var R={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(z,lt){Ei(z,0);for(var J=[],ot=0,yt="",At="",O="",gt="";z.l<z.length;){var ut=z[z.l++];switch(ut){case 0:J.push(z.read_shift(8,"f"));break;case 1:At=C(lt[0].c,z.read_shift(2),!0),yt=C(lt[0].r,z.read_shift(2),!1),J.push(At+yt);break;case 2:{var K=C(lt[0].c,z.read_shift(2),!0),X=C(lt[0].r,z.read_shift(2),!1);At=C(lt[0].c,z.read_shift(2),!0),yt=C(lt[0].r,z.read_shift(2),!1),J.push(K+X+":"+At+yt)}break;case 3:if(z.l<z.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(z.read_shift(2));break;case 6:{for(var pt="";ut=z[z.l++];)pt+=String.fromCharCode(ut);J.push('"'+pt.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:gt=J.pop(),O=J.pop(),J.push(["AND","OR"][ut-20]+"("+O+","+gt+")");break;default:if(ut<32&&N[ut])gt=J.pop(),O=J.pop(),J.push(O+N[ut]+gt);else if(R[ut]){if(ot=R[ut][1],ot==69&&(ot=z[z.l++]),ot>J.length){console.error("WK1 bad formula parse 0x"+ut.toString(16)+":|"+J.join("|")+"|");return}var Bt=J.slice(-ot);J.length-=ot,J.push(R[ut][0]+"("+Bt.join(",")+")")}else return ut<=7?console.error("WK1 invalid opcode "+ut.toString(16)):ut<=24?console.error("WK1 unsupported op "+ut.toString(16)):ut<=30?console.error("WK1 invalid opcode "+ut.toString(16)):ut<=115?console.error("WK1 unsupported function opcode "+ut.toString(16)):console.error("WK1 unrecognized opcode "+ut.toString(16))}}J.length==1?lt[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function I(z){var lt=[{c:0,r:0},{t:"n",v:0},0];return lt[0].r=z.read_shift(2),lt[3]=z[z.l++],lt[0].c=z[z.l++],lt}function M(z,lt){var J=I(z);return J[1].t="s",J[1].v=z.read_shift(lt-4,"cstr"),J}function B(z,lt,J,ot){var yt=Ut(6+ot.length);yt.write_shift(2,z),yt.write_shift(1,J),yt.write_shift(1,lt),yt.write_shift(1,39);for(var At=0;At<ot.length;++At){var O=ot.charCodeAt(At);yt.write_shift(1,O>=128?95:O)}return yt.write_shift(1,0),yt}function H(z,lt){var J=I(z);J[1].v=z.read_shift(2);var ot=J[1].v>>1;if(J[1].v&1)switch(ot&7){case 0:ot=(ot>>3)*5e3;break;case 1:ot=(ot>>3)*500;break;case 2:ot=(ot>>3)/20;break;case 3:ot=(ot>>3)/200;break;case 4:ot=(ot>>3)/2e3;break;case 5:ot=(ot>>3)/2e4;break;case 6:ot=(ot>>3)/16;break;case 7:ot=(ot>>3)/64;break}return J[1].v=ot,J}function F(z,lt){var J=I(z),ot=z.read_shift(4),yt=z.read_shift(4),At=z.read_shift(2);if(At==65535)return ot===0&&yt===3221225472?(J[1].t="e",J[1].v=15):ot===0&&yt===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var O=At&32768;return At=(At&32767)-16446,J[1].v=(1-O*2)*(yt*Math.pow(2,At+32)+ot*Math.pow(2,At)),J}function rt(z,lt,J,ot){var yt=Ut(14);if(yt.write_shift(2,z),yt.write_shift(1,J),yt.write_shift(1,lt),ot==0)return yt.write_shift(4,0),yt.write_shift(4,0),yt.write_shift(2,65535),yt;var At=0,O=0,gt=0,ut=0;return ot<0&&(At=1,ot=-ot),O=Math.log2(ot)|0,ot/=Math.pow(2,O-31),ut=ot>>>0,(ut&2147483648)==0&&(ot/=2,++O,ut=ot>>>0),ot-=ut,ut|=2147483648,ut>>>=0,ot*=Math.pow(2,32),gt=ot>>>0,yt.write_shift(4,gt),yt.write_shift(4,ut),O+=16383+(At?32768:0),yt.write_shift(2,O),yt}function L(z,lt){var J=F(z);return z.l+=lt-14,J}function it(z,lt){var J=I(z),ot=z.read_shift(4);return J[1].v=ot>>6,J}function Z(z,lt){var J=I(z),ot=z.read_shift(8,"f");return J[1].v=ot,J}function q(z,lt){var J=Z(z);return z.l+=lt-12,J}function Ct(z,lt){return z[z.l+lt-1]==0?z.read_shift(lt,"cstr"):""}function at(z,lt){var J=z[z.l++];J>lt-1&&(J=lt-1);for(var ot="";ot.length<J;)ot+=String.fromCharCode(z[z.l++]);return ot}function P(z,lt,J){if(!(!J.qpro||lt<21)){var ot=z.read_shift(1);z.l+=17,z.l+=1,z.l+=2;var yt=z.read_shift(lt-21,"cstr");return[ot,yt]}}function V(z,lt){for(var J={},ot=z.l+lt;z.l<ot;){var yt=z.read_shift(2);if(yt==14e3){for(J[yt]=[0,""],J[yt][0]=z.read_shift(2);z[z.l];)J[yt][1]+=String.fromCharCode(z[z.l]),z.l++;z.l++}}return J}function j(z,lt){var J=Ut(5+z.length);J.write_shift(2,14e3),J.write_shift(2,lt);for(var ot=0;ot<z.length;++ot){var yt=z.charCodeAt(ot);J[J.l++]=yt>127?95:yt}return J[J.l++]=0,J}var et={0:{n:"BOF",f:Ym},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ct},222:{n:"SHEETNAMELP",f:at},255:{n:"BOF",f:Ym},21506:{n:"WKSNF",f:Ym},65535:{n:""}},dt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:it},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ct},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:P},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},xt={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Nt(z){var lt=z.read_shift(2),J=z.read_shift(1);if(J!=0)throw"unsupported QPW string type "+J.toString(16);return z.read_shift(lt,"sbcs-cont")}function Rt(z,lt){Ei(z,0);var J=lt||{},ot={};J.dense&&(ot["!data"]=[]);var yt=[],At="",O={s:{r:-1,c:-1},e:{r:-1,c:-1}},gt=0,ut=0,K=0,X=0,pt={SheetNames:[],Sheets:{}},Bt=[];t:for(;z.l<z.length;){var Ht=z.read_shift(2),St=z.read_shift(2),It=z.slice(z.l,z.l+St);switch(Ei(It,0),Ht){case 1:if(It.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break t;case 8:break;case 10:for(var Tt=It.read_shift(4),vt=(It.length-It.l)/Tt|0,te=0;te<Tt;++te){var ae=It.l+vt,ne={};It.l+=2,ne.numFmtId=It.read_shift(2),xt[ne.numFmtId]&&(ne.z=xt[ne.numFmtId]),It.l=ae,Bt.push(ne)}break;case 1025:break;case 1026:break;case 1031:for(It.l+=12;It.l<It.length;)gt=It.read_shift(2),ut=It.read_shift(1),yt.push(It.read_shift(gt,"cstr"));break;case 1032:break;case 1537:{var Re=It.read_shift(2);ot={},J.dense&&(ot["!data"]=[]),O.s.c=It.read_shift(2),O.e.c=It.read_shift(2),O.s.r=It.read_shift(4),O.e.r=It.read_shift(4),It.l+=4,It.l+2<It.length&&(gt=It.read_shift(2),ut=It.read_shift(1),At=gt==0?"":It.read_shift(gt,"cstr")),At||(At=xn(Re))}break;case 1538:{if(O.s.c>255||O.s.r>999999)break;O.e.c<O.s.c&&(O.e.c=O.s.c),O.e.r<O.s.r&&(O.e.r=O.s.r),ot["!ref"]=dr(O),jb(pt,ot,At)}break;case 2561:K=It.read_shift(2),O.e.c<K&&(O.e.c=K),O.s.c>K&&(O.s.c=K),X=It.read_shift(4),O.s.r>X&&(O.s.r=X),X=It.read_shift(4),O.e.r<X&&(O.e.r=X);break;case 3073:{X=It.read_shift(4),gt=It.read_shift(4),O.s.r>X&&(O.s.r=X),O.e.r<X+gt-1&&(O.e.r=X+gt-1);for(var rn=xn(K);It.l<It.length;){var be={t:"z"},ln=It.read_shift(1),Ve=-1;ln&128&&(Ve=It.read_shift(2));var zn=ln&64?It.read_shift(2)-1:0;switch(ln&31){case 0:break;case 1:break;case 2:be={t:"n",v:It.read_shift(2)};break;case 3:be={t:"n",v:It.read_shift(2,"i")};break;case 4:be={t:"n",v:Ib(It)};break;case 5:be={t:"n",v:It.read_shift(8,"f")};break;case 7:be={t:"s",v:yt[ut=It.read_shift(4)-1]};break;case 8:be={t:"n",v:It.read_shift(8,"f")},It.l+=2,It.l+=4,isNaN(be.v)&&(be={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(ln&31)}Ve!=-1&&(Bt[Ve-1]||{}).z&&(be.z=Bt[Ve-1].z);var Cn=0;if(ln&32)switch(ln&31){case 2:Cn=It.read_shift(2);break;case 3:Cn=It.read_shift(2,"i");break;case 7:Cn=It.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(ln&31)}if(!(!J.sheetStubs&&be.t=="z")){var yn=li(be);be.t=="n"&&be.z&&Fc(be.z)&&J.cellDates&&(yn.v=Ju(be.v),yn.t=typeof yn.v=="number"?"n":"d"),ot["!data"]!=null?(ot["!data"][X]||(ot["!data"][X]=[]),ot["!data"][X][K]=yn):ot[rn+Sn(X)]=yn}for(++X,--gt;zn-- >0&&gt>=0;){if(ln&32)switch(ln&31){case 2:be={t:"n",v:be.v+Cn&65535};break;case 3:be={t:"n",v:be.v+Cn&65535},be.v>32767&&(be.v-=65536);break;case 7:be={t:"s",v:yt[ut=ut+Cn>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(ln&31)}else switch(ln&31){case 1:be={t:"z"};break;case 2:be={t:"n",v:It.read_shift(2)};break;case 7:be={t:"s",v:yt[ut=It.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(ln&31)}!J.sheetStubs&&be.t=="z"||(ot["!data"]!=null?(ot["!data"][X]||(ot["!data"][X]=[]),ot["!data"][X][K]=be):ot[rn+Sn(X)]=be),++X,--gt}}}break;case 3074:{K=It.read_shift(2),X=It.read_shift(4);var mr=Nt(It);ot["!data"]!=null?(ot["!data"][X]||(ot["!data"][X]=[]),ot["!data"][X][K]={t:"s",v:mr}):ot[xn(K)+Sn(X)]={t:"s",v:mr}}break}z.l+=St}return pt}return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:t}}(),PG=/^\s|\s$|[\t\n\r]/;function FG(n,t){if(!t.bookSST)return"";var e=[pr];e[e.length]=se("sst",null,{xmlns:Rf[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),typeof i.t!="string"&&(i.t=String(i.t)),i.t.match(PG)&&(s+=' xml:space="preserve"'),s+=">"+$e(i.t)+"</t>"),s+="</si>",e[e.length]=s}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function BG(n){return[n.read_shift(4),n.read_shift(4)]}function UG(n,t){return t||(t=Ut(8)),t.write_shift(4,n.Count),t.write_shift(4,n.Unique),t}var zG=T$;function jG(n){var t=ai();Xt(t,159,UG(n));for(var e=0;e<n.length;++e)Xt(t,19,zG(n[e]));return Xt(t,160),t.end()}function HG(n){for(var t=[],e=n.split(""),r=0;r<e.length;++r)t[r]=e[r].charCodeAt(0);return t}function DN(n){var t=0,e,r=HG(n),i=r.length+1,s,a,l,u,f;for(e=Mc(i),e[0]=r.length,s=1;s!=i;++s)e[s]=r[s-1];for(s=i-1;s>=0;--s)a=e[s],l=(t&16384)===0?0:1,u=t<<1&32767,f=l|u,t=f^a;return t^52811}function $G(n,t){var e=["{\\rtf1\\ansi"];if(!n["!ref"])return e[0]+"}";for(var r=In(n["!ref"]),i,s=n["!data"]!=null,a=[],l=r.s.r;l<=r.e.r;++l){e.push("\\trowd\\trautofit1");for(var u=r.s.c;u<=r.e.c;++u)e.push("\\cellx"+(u+1));for(e.push("\\pard\\intbl"),s&&(a=n["!data"][l]||[]),u=r.s.c;u<=r.e.c;++u){var f=Vn({r:l,c:u});if(i=s?a[u]:n[f],!i||i.v==null&&(!i.f||i.F)){e.push(" \\cell");continue}e.push(" "+(i.w||(jo(i),i.w)||"").replace(/[\r\n]/g,"\\par ")),e.push("\\cell")}e.push("\\pard\\intbl\\row")}return e.join("")+"}"}function qT(n){for(var t=0,e=1;t!=3;++t)e=e*256+(n[t]>255?255:n[t]<0?0:n[t]);return e.toString(16).toUpperCase().slice(1)}var GG=6,Po=GG;function Ag(n){return Math.floor((n+Math.round(128/Po)/256)*Po)}function Sg(n){return Math.floor((n-5)/Po*100+.5)/100}function ey(n){return Math.round((n*Po+5)/Po*256)/256}function Pb(n){n.width?(n.wpx=Ag(n.width),n.wch=Sg(n.wpx),n.MDW=Po):n.wpx?(n.wch=Sg(n.wpx),n.width=ey(n.wch),n.MDW=Po):typeof n.wch=="number"&&(n.width=ey(n.wch),n.wpx=Ag(n.width),n.MDW=Po),n.customWidth&&delete n.customWidth}var VG=96,ON=VG;function Tg(n){return n*96/ON}function RN(n){return n*ON/96}function WG(n){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)n[r]!=null&&(t[t.length]=se("numFmt",null,{numFmtId:r,formatCode:$e(n[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function qG(n){var t=[];return t[t.length]=se("cellXfs",null),n.forEach(function(e){t[t.length]=se("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function YG(n,t){var e=[pr,se("styleSheet",null,{xmlns:Rf[0],"xmlns:vt":Dr.vt})],r;return n.SSF&&(r=WG(n.SSF))!=null&&(e[e.length]=r),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=qG(t.cellXfs))&&(e[e.length]=r),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function XG(n,t){var e=n.read_shift(2),r=oi(n);return[e,r]}function KG(n,t,e){e||(e=Ut(6+4*t.length)),e.write_shift(2,n),wr(t,e);var r=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),r}function ZG(n,t,e){var r={};r.sz=n.read_shift(2)/20;var i=L$(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=n.read_shift(1);a!=0&&(r.underline=a);var l=n.read_shift(1);l>0&&(r.family=l);var u=n.read_shift(1);switch(u>0&&(r.charset=u),n.l++,r.color=k$(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=oi(n),r}function QG(n,t){t||(t=Ut(25+4*32)),t.write_shift(2,n.sz*20),I$(n,t),t.write_shift(2,n.bold?700:400);var e=0;n.vertAlign=="superscript"?e=1:n.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,n.underline||0),t.write_shift(1,n.family||0),t.write_shift(1,n.charset||0),t.write_shift(1,0),wg(n.color,t);var r=0;return r=2,t.write_shift(1,r),wr(n.name,t),t.length>t.l?t.slice(0,t.l):t}var JG=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],hx,tV=qa;function YT(n,t){t||(t=Ut(4*3+8*7+16*1)),hx||(hx=Eb(JG));var e=hx[n.patternType];e==null&&(e=40),t.write_shift(4,e);var r=0;if(e!=40)for(wg({auto:1},t),wg({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function eV(n,t){var e=n.l+t,r=n.read_shift(2),i=n.read_shift(2);return n.l=e,{ixfe:r,numFmtId:i}}function NN(n,t,e){e||(e=Ut(16)),e.write_shift(2,t||0),e.write_shift(2,n.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var r=0;return e.write_shift(1,r),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function fd(n,t){return t||(t=Ut(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var nV=qa;function rV(n,t){return t||(t=Ut(51)),t.write_shift(1,0),fd(null,t),fd(null,t),fd(null,t),fd(null,t),fd(null,t),t.length>t.l?t.slice(0,t.l):t}function iV(n,t){return t||(t=Ut(12+4*10)),t.write_shift(4,n.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Zd(n.name||"",t),t.length>t.l?t.slice(0,t.l):t}function sV(n,t,e){var r=Ut(2052);return r.write_shift(4,n),Zd(t,r),Zd(e,r),r.length>r.l?r.slice(0,r.l):r}function aV(n,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++e}),e!=0&&(Xt(n,615,la(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Xt(n,44,KG(i,t[i]))}),Xt(n,616))}}function oV(n){var t=1;Xt(n,611,la(t)),Xt(n,43,QG({sz:12,color:{theme:1},name:"Calibri",family:2})),Xt(n,612)}function lV(n){var t=2;Xt(n,603,la(t)),Xt(n,45,YT({patternType:"none"})),Xt(n,45,YT({patternType:"gray125"})),Xt(n,604)}function cV(n){var t=1;Xt(n,613,la(t)),Xt(n,46,rV()),Xt(n,614)}function uV(n){var t=1;Xt(n,626,la(t)),Xt(n,47,NN({numFmtId:0},65535)),Xt(n,627)}function fV(n,t){Xt(n,617,la(t.length)),t.forEach(function(e){Xt(n,47,NN(e,0))}),Xt(n,618)}function hV(n){var t=1;Xt(n,619,la(t)),Xt(n,48,iV({xfId:0,name:"Normal"})),Xt(n,620)}function dV(n){var t=0;Xt(n,505,la(t)),Xt(n,506)}function pV(n){var t=0;Xt(n,508,sV(t,"TableStyleMedium9","PivotStyleMedium4")),Xt(n,509)}function mV(n,t){var e=ai();return Xt(e,278),aV(e,n.SSF),oV(e),lV(e),cV(e),uV(e),fV(e,t.cellXfs),hV(e),dV(e),pV(e),Xt(e,279),e.end()}function kN(n,t){if(t&&t.themeXLSX)return t.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var e=[pr];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function gV(n,t){return{flags:n.read_shift(4),version:n.read_shift(4),name:oi(n)}}function vV(n){var t=Ut(12+2*n.name.length);return t.write_shift(4,n.flags),t.write_shift(4,n.version),wr(n.name,t),t.slice(0,t.l)}function _V(n){for(var t=[],e=n.read_shift(4);e-- >0;)t.push([n.read_shift(4),n.read_shift(4)]);return t}function xV(n){var t=Ut(4+8*n.length);t.write_shift(4,n.length);for(var e=0;e<n.length;++e)t.write_shift(4,n[e][0]),t.write_shift(4,n[e][1]);return t}function yV(n,t){var e=Ut(8+2*t.length);return e.write_shift(4,n),wr(t,e),e.slice(0,e.l)}function bV(n){return n.l+=4,n.read_shift(4)!=0}function wV(n,t){var e=Ut(8);return e.write_shift(4,n),e.write_shift(4,1),e}function EV(){var n=ai();return Xt(n,332),Xt(n,334,la(1)),Xt(n,335,vV({name:"XLDAPR",version:12e4,flags:3496657072})),Xt(n,336),Xt(n,339,yV(1,"XLDAPR")),Xt(n,52),Xt(n,35,la(514)),Xt(n,4096,la(0)),Xt(n,4097,Ms(1)),Xt(n,36),Xt(n,53),Xt(n,340),Xt(n,337,wV(1)),Xt(n,51,xV([[1,0]])),Xt(n,338),Xt(n,333),n.end()}function AV(){var n=[pr];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function SV(n){var t={};t.i=n.read_shift(4);var e={};e.r=n.read_shift(4),e.c=n.read_shift(4),t.r=Vn(e);var r=n.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function LN(n,t,e){var r=[21600,21600],i=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[se("xml",null,{"xmlns:v":ls.v,"xmlns:o":ls.o,"xmlns:x":ls.x,"xmlns:mv":ls.mv}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"})],a=65536*n,l=t||[];return l.length>0&&s.push(se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:r.join(","),"o:spt":202,path:i})),l.forEach(function(u){++a,s.push(TV(u,a))}),s.push("</xml>"),s.join("")}function TV(n,t,e){var r=Un(n[0]),i={color2:"#BEFF82",type:"gradient"};i.type=="gradient"&&(i.angle="-180");var s=i.type=="gradient"?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=se("v:fill",s,i),l={on:"t",obscured:"t"};return["<v:shape"+Yd({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,se("v:shadow",null,l),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zr("x:Anchor",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(",")),zr("x:AutoFill","False"),zr("x:Row",String(r.r)),zr("x:Column",String(r.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function CV(n){var t=[pr,se("comments",null,{xmlns:Rf[0]})],e=[];return t.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var s=$e(i.a);e.indexOf(s)==-1&&(e.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),n.forEach(function(r){var i=0,s=[],a=0;if(r[1][0]&&r[1][0].T&&r[1][0].ID&&(i=e.indexOf("tc="+r[1][0].ID)),r[1].forEach(function(f){f.a&&(i=e.indexOf($e(f.a))),f.T&&++a,s.push(f.t==null?"":$e(f.t))}),a===0)r[1].forEach(function(f){t.push('<comment ref="'+r[0]+'" authorId="'+e.indexOf($e(f.a))+'"><text>'),t.push(zr("t",f.t==null?"":$e(f.t))),t.push("</text></comment>")});else{r[1][0]&&r[1][0].T&&r[1][0].ID&&(i=e.indexOf("tc="+r[1][0].ID)),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>');for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;t.push(zr("t",$e(l))),t.push("</text></comment>")}}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function IN(n,t,e){var r=[pr,se("ThreadedComments",null,{xmlns:Dr.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,l){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var u={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};l==0?s=u.id:u.parentId=s,a.ID=u.id,a.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),r.push(se("threadedComment",zr("text",a.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function MN(n){var t=[pr,se("personList",null,{xmlns:Dr.TCMNT,"xmlns:x":Rf[0]}).replace(/[\/]>/,">")];return n.forEach(function(e,r){t.push(se("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function DV(n){var t={};t.iauthor=n.read_shift(4);var e=Xc(n);return t.rfx=e.s,t.ref=Vn(e.s),n.l+=16,t}function OV(n,t){return t==null&&(t=Ut(36)),t.write_shift(4,n[1].iauthor),Lf(n[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var RV=oi;function XT(n){return wr(n.slice(0,54))}function NV(n){var t=ai(),e=[];return Xt(t,628),Xt(t,630),n.forEach(function(r){r[1].forEach(function(i){e.indexOf(i.a)>-1||(e.push(i.a.slice(0,54)),Xt(t,632,XT(i.a)),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),Xt(t,632,XT("tc="+i.ID))))})}),Xt(t,631),Xt(t,633),n.forEach(function(r){r[1].forEach(function(i){var s=-1;i.ID&&(s=e.indexOf("tc="+i.ID)),s==-1&&r[1][0].T&&r[1][0].ID&&(s=e.indexOf("tc="+r[1][0].ID)),s==-1&&(s=e.indexOf(i.a)),i.iauthor=s;var a={s:Un(r[0]),e:Un(r[0])};Xt(t,635,OV([a,i])),i.t&&i.t.length>0&&Xt(t,637,D$(i)),Xt(t,636),delete i.iauthor})}),Xt(t,634),Xt(t,629),t.end()}function kV(n,t){t.FullPaths.forEach(function(e,r){if(r!=0){var i=e.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Rn.utils.cfb_add(n,i,t.FileIndex[r].content)}})}var LV=["xlsb","xlsm","xlam","biff8","xla"],KT=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(r,i,s,a){var l=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return l?d+=t.c:--d,u?f+=t.r:--f,i+(l?"":"$")+xn(d)+(u?"":"$")+Sn(f)}return function(i,s){return t=s,i.replace(n,e)}}(),hv=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{hv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var dv=function(){return function(t,e){return t.replace(hv,function(r,i,s,a,l,u){var f=Nb(a)-(s?0:e.c),d=Rb(u)-(l?0:e.r),p=l=="$"?d+1:d==0?"":"["+d+"]",m=s=="$"?f+1:f==0?"":"["+f+"]";return i+"R"+p+"C"+m})}}();function IV(n,t){return n.replace(hv,function(e,r,i,s,a,l){return r+(i=="$"?i+s:xn(Nb(s)+t.c))+(a=="$"?a+l:Sn(Rb(l)+t.r))})}function MV(n){return n.length!=1}function lr(n){n.l+=1}function Il(n,t){var e=n.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function PN(n,t,e){var r=2;if(e){if(e.biff>=2&&e.biff<=5)return FN(n);e.biff==12&&(r=4)}var i=n.read_shift(r),s=n.read_shift(r),a=Il(n),l=Il(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function FN(n){var t=Il(n),e=Il(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function PV(n,t,e){if(e.biff<8)return FN(n);var r=n.read_shift(e.biff==12?4:2),i=n.read_shift(e.biff==12?4:2),s=Il(n),a=Il(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function BN(n,t,e){if(e&&e.biff>=2&&e.biff<=5)return FV(n);var r=n.read_shift(e&&e.biff==12?4:2),i=Il(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function FV(n){var t=Il(n),e=n.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function BV(n){var t=n.read_shift(2),e=n.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function UV(n,t,e){var r=e&&e.biff?e.biff:8;if(r>=2&&r<=5)return zV(n);var i=n.read_shift(r>=12?4:2),s=n.read_shift(2),a=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:l}}function zV(n){var t=n.read_shift(2),e=n.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:i,rRel:r}}function jV(n,t,e){var r=(n[n.l++]&96)>>5,i=PN(n,e.biff>=2&&e.biff<=5?6:8,e);return[r,i]}function HV(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var a=PN(n,s,e);return[r,i,a]}function $V(n,t,e){var r=(n[n.l++]&96)>>5;return n.l+=e&&e.biff>8?12:e.biff<8?6:8,[r]}function GV(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,i]}function VV(n,t,e){var r=(n[n.l++]&96)>>5,i=PV(n,t-1,e);return[r,i]}function WV(n,t,e){var r=(n[n.l++]&96)>>5;return n.l+=e.biff==2?6:e.biff==12?14:7,[r]}function ZT(n){var t=n[n.l+1]&1,e=1;return n.l+=4,[t,e]}function qV(n,t,e){n.l+=2;for(var r=n.read_shift(e&&e.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(n.read_shift(e&&e.biff==2?1:2));return i}function YV(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(e&&e.biff==2?1:2)]}function XV(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(e&&e.biff==2?1:2)]}function KV(n){var t=n[n.l+1]&255?1:0;return n.l+=2,[t,n.read_shift(2)]}function ZV(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=e&&e.biff==2?3:4,[r]}function UN(n){var t=n.read_shift(1),e=n.read_shift(1);return[t,e]}function QV(n){return n.read_shift(2),UN(n)}function JV(n){return n.read_shift(2),UN(n)}function tW(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=BN(n,0,e);return[r,i]}function eW(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=UV(n,0,e);return[r,i]}function nW(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);e&&e.biff==5&&(n.l+=12);var s=BN(n,0,e);return[r,i,s]}function rW(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(e&&e.biff<=3?1:2);return[pq[i],HN[i],r]}function iW(n,t,e){var r=n[n.l++],i=n.read_shift(1),s=e&&e.biff<=3?[r==88?-1:0,n.read_shift(1)]:sW(n);return[i,(s[0]===0?HN:dq)[s[1]]]}function sW(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function aW(n,t,e){n.l+=e&&e.biff==2?3:4}function oW(n,t,e){if(n.l++,e&&e.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function lW(n){return n.l++,Di[n.read_shift(1)]}function cW(n){return n.l++,n.read_shift(2)}function uW(n){return n.l++,n.read_shift(1)!==0}function fW(n){return n.l++,If(n)}function hW(n,t,e){return n.l++,EN(n,t-1,e)}function dW(n,t){var e=[n.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Q$(n,1)?"TRUE":"FALSE",t!=12&&(n.l+=7);break;case 37:case 16:e[1]=Di[n[n.l]],n.l+=t==12?4:8;break;case 0:n.l+=8;break;case 1:e[1]=If(n);break;case 2:e[1]=nG(n,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function pW(n,t,e){for(var r=n.read_shift(e.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((e.biff==12?Xc:sG)(n));return i}function mW(n,t,e){var r=0,i=0;e.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),e.biff>=2&&e.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var l=0;l!=i;++l)a[s][l]=dW(n,e.biff);return a}function gW(n,t,e){var r=n.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,s=n.read_shift(i);switch(e.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function vW(n,t,e){if(e.biff==5)return _W(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),s=n.read_shift(4);return[r,i,s]}function _W(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[t,e,r]}function xW(n,t,e){var r=n.read_shift(1)>>>5&3;n.l+=e&&e.biff==2?3:4;var i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function yW(n,t,e){var r=n.read_shift(1)>>>5&3,i=n.read_shift(e&&e.biff==2?1:2);return[r,i]}function bW(n,t,e){var r=n.read_shift(1)>>>5&3;return n.l+=4,e.biff<8&&n.l--,e.biff==12&&(n.l+=2),[r]}function wW(n,t,e){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),s=4;if(e)switch(e.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,i]}var EW=qa,AW=qa,SW=qa;function yp(n,t,e){return n.l+=2,[BV(n)]}function Fb(n){return n.l+=6,[]}var TW=yp,CW=Fb,DW=Fb,OW=yp;function zN(n){return n.l+=2,[Ym(n),n.read_shift(2)&1]}var RW=yp,NW=zN,kW=Fb,LW=yp,IW=yp,MW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function PW(n){n.l+=2;var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),s=n.read_shift(2),a=MW[e>>2&31];return{ixti:t,coltype:e&3,rt:a,idx:r,c:i,C:s}}function FW(n){return n.l+=2,[n.read_shift(4)]}function BW(n,t,e){return n.l+=5,n.l+=2,n.l+=e.biff==2?1:4,["PTGSHEET"]}function UW(n,t,e){return n.l+=e.biff==2?4:5,["PTGENDSHEET"]}function zW(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function jW(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function HW(n){return n.l+=4,[0,0]}var QT={1:{n:"PtgExp",f:oW},2:{n:"PtgTbl",f:SW},3:{n:"PtgAdd",f:lr},4:{n:"PtgSub",f:lr},5:{n:"PtgMul",f:lr},6:{n:"PtgDiv",f:lr},7:{n:"PtgPower",f:lr},8:{n:"PtgConcat",f:lr},9:{n:"PtgLt",f:lr},10:{n:"PtgLe",f:lr},11:{n:"PtgEq",f:lr},12:{n:"PtgGe",f:lr},13:{n:"PtgGt",f:lr},14:{n:"PtgNe",f:lr},15:{n:"PtgIsect",f:lr},16:{n:"PtgUnion",f:lr},17:{n:"PtgRange",f:lr},18:{n:"PtgUplus",f:lr},19:{n:"PtgUminus",f:lr},20:{n:"PtgPercent",f:lr},21:{n:"PtgParen",f:lr},22:{n:"PtgMissArg",f:lr},23:{n:"PtgStr",f:hW},26:{n:"PtgSheet",f:BW},27:{n:"PtgEndSheet",f:UW},28:{n:"PtgErr",f:lW},29:{n:"PtgBool",f:uW},30:{n:"PtgInt",f:cW},31:{n:"PtgNum",f:fW},32:{n:"PtgArray",f:WV},33:{n:"PtgFunc",f:rW},34:{n:"PtgFuncVar",f:iW},35:{n:"PtgName",f:gW},36:{n:"PtgRef",f:tW},37:{n:"PtgArea",f:jV},38:{n:"PtgMemArea",f:xW},39:{n:"PtgMemErr",f:EW},40:{n:"PtgMemNoMem",f:AW},41:{n:"PtgMemFunc",f:yW},42:{n:"PtgRefErr",f:bW},43:{n:"PtgAreaErr",f:$V},44:{n:"PtgRefN",f:eW},45:{n:"PtgAreaN",f:VV},46:{n:"PtgMemAreaN",f:zW},47:{n:"PtgMemNoMemN",f:jW},57:{n:"PtgNameX",f:vW},58:{n:"PtgRef3d",f:nW},59:{n:"PtgArea3d",f:HV},60:{n:"PtgRefErr3d",f:wW},61:{n:"PtgAreaErr3d",f:GV},255:{}},$W={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},GW={1:{n:"PtgElfLel",f:zN},2:{n:"PtgElfRw",f:LW},3:{n:"PtgElfCol",f:TW},6:{n:"PtgElfRwV",f:IW},7:{n:"PtgElfColV",f:OW},10:{n:"PtgElfRadical",f:RW},11:{n:"PtgElfRadicalS",f:kW},13:{n:"PtgElfColS",f:CW},15:{n:"PtgElfColSV",f:DW},16:{n:"PtgElfRadicalLel",f:NW},25:{n:"PtgList",f:PW},29:{n:"PtgSxName",f:FW},255:{}},VW={0:{n:"PtgAttrNoop",f:HW},1:{n:"PtgAttrSemi",f:ZV},2:{n:"PtgAttrIf",f:XV},4:{n:"PtgAttrChoose",f:qV},8:{n:"PtgAttrGoto",f:YV},16:{n:"PtgAttrSum",f:aW},32:{n:"PtgAttrBaxcel",f:ZT},33:{n:"PtgAttrBaxcel",f:ZT},64:{n:"PtgAttrSpace",f:QV},65:{n:"PtgAttrSpaceSemi",f:JV},128:{n:"PtgAttrIfError",f:KV},255:{}};function WW(n,t,e,r){if(r.biff<8)return qa(n,t);for(var i=n.l+t,s=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=mW(n,0,r),s.push(e[a][1]);break;case"PtgMemArea":e[a][2]=pW(n,e[a][1],r),s.push(e[a][2]);break;case"PtgExp":r&&r.biff==12&&(e[a][1][1]=n.read_shift(4),s.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0]}return t=i-n.l,t!==0&&s.push(qa(n,t)),s}function qW(n,t,e){for(var r=n.l+t,i,s,a=[];r!=n.l;)t=r-n.l,s=n[n.l],i=QT[s]||QT[$W[s]],(s===24||s===25)&&(i=(s===24?GW:VW)[n[n.l+1]]),!i||!i.f?qa(n,t):a.push([i.n,i.f(n,t,e)]);return a}function YW(n){for(var t=[],e=0;e<n.length;++e){for(var r=n[e],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var XW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KW(n,t){var e=n.lastIndexOf("!"),r=t.lastIndexOf("!");return e==-1&&r==-1?n+":"+t:e>0&&r>0&&n.slice(0,e).toLowerCase()==t.slice(0,r).toLowerCase()?n+":"+t.slice(r+1):(console.error("Cannot hydrate range",n,t),n+":"+t)}function jN(n,t,e){if(!n)return"SH33TJSERR0";if(e.biff>8&&(!n.XTI||!n.XTI[t]))return n.SheetNames[t];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":n.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(e.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return e.SID!=null?n.SheetNames[e.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function JT(n,t,e){var r=jN(n,t,e);return r=="#REF"?r:Kd(r,e)}function yf(n,t,e,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},l=[],u,f,d,p=0,m=0,v,x="";if(!n[0]||!n[0][0])return"";for(var _=-1,y="",w=0,S=n[0].length;w<S;++w){var T=n[0][w];switch(T[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),_>=0){switch(n[0][_][1][0]){case 0:y=Bn(" ",n[0][_][1][1]);break;case 1:y=Bn("\r",n[0][_][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}f=f+y,_=-1}l.push(f+XW[T[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(KW(f,u));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Dd(T[1][1],a,i),l.push(Od(d,s));break;case"PtgRefN":d=e?Dd(T[1][1],e,i):T[1][1],l.push(Od(d,s));break;case"PtgRef3d":p=T[1][1],d=Dd(T[1][2],a,i),x=JT(r,p,i),l.push(x+"!"+Od(d,s));break;case"PtgFunc":case"PtgFuncVar":var C=T[1][0],R=T[1][1];C||(C=0),C&=127;var N=C==0?[]:l.slice(-C);l.length-=C,R==="User"&&(R=N.shift()),l.push(R+"("+N.join(",")+")");break;case"PtgBool":l.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(T[1]);break;case"PtgNum":l.push(String(T[1]));break;case"PtgStr":l.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(T[1]);break;case"PtgAreaN":v=IT(T[1][1],e?{s:e}:a,i),l.push(lx(v,i));break;case"PtgArea":v=IT(T[1][1],a,i),l.push(lx(v,i));break;case"PtgArea3d":p=T[1][1],v=T[1][2],x=JT(r,p,i),l.push(x+"!"+lx(v,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=T[1][2];var D=(r.names||[])[m-1]||(r[0]||[])[m],I=D?D.Name:"SH33TJSNAME"+String(m);I&&I.slice(0,6)=="_xlfn."&&!i.xlfn&&(I=I.slice(6)),l.push(I);break;case"PtgNameX":var M=T[1][1];m=T[1][2];var B;if(i.biff<=5)M<0&&(M=-M),r[M]&&(B=r[M][m]);else{var H="";if(((r[M]||[])[0]||[])[0]==14849||(((r[M]||[])[0]||[])[0]==1025?r[M][m]&&r[M][m].itab>0&&(H=r.SheetNames[r[M][m].itab-1]+"!"):H=r.SheetNames[m-1]+"!"),r[M]&&r[M][m])H+=r[M][m].Name;else if(r[0]&&r[0][m])H+=r[0][m].Name;else{var F=(jN(r,M,i)||"").split(";;");F[m-1]?H=F[m-1]:H+="SH33TJSERRX"}l.push(H);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var rt="(",L=")";if(_>=0){switch(y="",n[0][_][1][0]){case 2:rt=Bn(" ",n[0][_][1][1])+rt;break;case 3:rt=Bn("\r",n[0][_][1][1])+rt;break;case 4:L=Bn(" ",n[0][_][1][1])+L;break;case 5:L=Bn("\r",n[0][_][1][1])+L;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}l.push(rt+l.pop()+L);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:T[1][1],r:T[1][0]};var it={c:e.c,r:e.r};if(r.sharedf[Vn(d)]){var Z=r.sharedf[Vn(d)];l.push(yf(Z,a,it,r,i))}else{var q=!1;for(u=0;u!=r.arrayf.length;++u)if(f=r.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(yf(f[1],a,it,r,i)),q=!0;break}q||l.push(T[1])}break;case"PtgArray":l.push("{"+YW(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var Ct=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&_>=0&&Ct.indexOf(n[0][w][0])==-1){T=n[0][_];var at=!0;switch(T[1][0]){case 4:at=!1;case 0:y=Bn(" ",T[1][1]);break;case 5:at=!1;case 1:y=Bn("\r",T[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}l.push((at?y:"")+l.pop()+(at?"":y)),_=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function ZW(n){if(n==null){var t=Ut(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof n=="number")return Bc(n);return Bc(0)}function QW(n,t,e,r,i){var s=Uc(t,e,i),a=ZW(n.v),l=Ut(6),u=33;l.write_shift(2,u),l.write_shift(4,0);for(var f=Ut(n.bf.length),d=0;d<n.bf.length;++d)f[d]=n.bf[d];var p=fr([s,a,l,f]);return p}function pv(n,t,e){var r=n.read_shift(4),i=qW(n,r,e),s=n.read_shift(4),a=s>0?WW(n,s,i,e):null;return[i,a]}var JW=pv,mv=pv,tq=pv,eq=pv;function tC(n){if((n|0)==n&&n<Math.pow(2,16)&&n>=0){var t=Ut(11);return t.write_shift(4,3),t.write_shift(1,30),t.write_shift(2,n),t.write_shift(4,0),t}var e=Ut(17);return e.write_shift(4,11),e.write_shift(1,31),e.write_shift(8,n),e.write_shift(4,0),e}function nq(n){var t=Ut(10);return t.write_shift(4,2),t.write_shift(1,28),t.write_shift(1,n),t.write_shift(4,0),t}function rq(n){var t=Ut(10);return t.write_shift(4,2),t.write_shift(1,29),t.write_shift(1,n?1:0),t.write_shift(4,0),t}function iq(n){var t=Ut(7);t.write_shift(4,3+2*n.length),t.write_shift(1,23),t.write_shift(2,n.length);var e=Ut(2*n.length);e.write_shift(2*n.length,n,"utf16le");var r=Ut(4);return r.write_shift(4,0),fr([t,e,r])}function sq(n){var t=Un(n),e=Ut(15);return e.write_shift(4,7),e.write_shift(1,36),e.write_shift(4,t.r),e.write_shift(2,t.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),e.write_shift(4,0),e}function aq(n,t){var e=n.lastIndexOf("!"),r=n.slice(0,e);n=n.slice(e+1);var i=Un(n);r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var s=Ut(17);return s.write_shift(4,9),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(r.toLowerCase())),s.write_shift(4,i.r),s.write_shift(2,i.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s}function oq(n,t){var e=n.lastIndexOf("!"),r=n.slice(0,e);n=n.slice(e+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=Ut(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+t.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(r.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}function lq(n){var t=n.split(":"),e=t[0],r=Ut(23);r.write_shift(4,15),e=t[0];var i=Un(e);return r.write_shift(1,36),r.write_shift(4,i.r),r.write_shift(2,i.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),e=t[1],i=Un(e),r.write_shift(1,36),r.write_shift(4,i.r),r.write_shift(2,i.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r.write_shift(1,17),r.write_shift(4,0),r}function cq(n,t){var e=n.lastIndexOf("!"),r=n.slice(0,e);n=n.slice(e+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=n.split(":"),s=Ut(27);s.write_shift(4,19);var a=i[0],l=Un(a);return s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(u){return u.toLowerCase()}).indexOf(r.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),a=i[1],l=Un(a),s.write_shift(1,58),s.write_shift(2,2+t.SheetNames.map(function(u){return u.toLowerCase()}).indexOf(r.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),s.write_shift(1,17),s.write_shift(4,0),s}function uq(n,t){var e=n.lastIndexOf("!"),r=n.slice(0,e);n=n.slice(e+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=Hr(n),s=Ut(23);return s.write_shift(4,15),s.write_shift(1,59),s.write_shift(2,2+t.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(r.toLowerCase())),s.write_shift(4,i.s.r),s.write_shift(4,i.e.r),s.write_shift(2,i.s.c),s.write_shift(2,i.e.c),s.write_shift(4,0),s}function fq(n,t){if(typeof n=="number")return tC(n);if(typeof n=="boolean")return rq(n);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(n))return nq(+$a[n]);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return sq(n);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return lq(n);if(n.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return uq(n,t);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return aq(n,t);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return cq(n,t);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(n))return oq(n,t);if(/^".*"$/.test(n))return iq(n);if(/^[+-]\d+$/.test(n))return tC(parseInt(n,10));throw"Formula |"+n+"| not supported for XLSB"}var hq=fq,dq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},HN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},pq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function mq(n){var t="of:="+n.replace(hv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function $N(n){return n.replace(/!/,".").replace(/:/,":.")}var Rd=typeof Map<"u";function Bb(n,t,e){var r=0,i=n.length;if(e){if(Rd?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var s=Rd?e.get(t):e[t];r<s.length;++r)if(n[s[r]].t===t)return n.Count++,s[r]}}else for(;r<i;++r)if(n[r].t===t)return n.Count++,r;return n[i]={t},n.Count++,n.Unique++,e&&(Rd?(e.has(t)||e.set(t,[]),e.get(t).push(i)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(i))),i}function gv(n,t){var e={min:n+1,max:n+1},r=-1;return t.MDW&&(Po=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?r=Sg(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(e.width=ey(r),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function GN(n,t){if(n){var e=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=e[0]),n.right==null&&(n.right=e[1]),n.top==null&&(n.top=e[2]),n.bottom==null&&(n.bottom=e[3]),n.header==null&&(n.header=e[4]),n.footer==null&&(n.footer=e[5])}}function Ul(n,t,e){var r=e.revssf[t.z!=null?t.z:"General"],i=60,s=n.length;if(r==null&&e.ssf){for(;i<392;++i)if(e.ssf[i]==null){HH(t.z,i),e.ssf[i]=t.z,e.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(n[i].numFmtId===r)return i;return n[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function gq(n,t,e){if(n&&n["!ref"]){var r=In(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+e+"): "+n["!ref"])}}function vq(n){if(n.length===0)return"";for(var t='<mergeCells count="'+n.length+'">',e=0;e!=n.length;++e)t+='<mergeCell ref="'+dr(n[e])+'"/>';return t+"</mergeCells>"}function _q(n,t,e,r,i){var s=!1,a={},l=null;if(r.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[e];try{t.Workbook&&(u=t.Workbook.Sheets[e].CodeName||u)}catch{}s=!0,a.codeName=qd($e(u))}if(n&&n["!outline"]){var f={summaryBelow:1,summaryRight:1};n["!outline"].above&&(f.summaryBelow=0),n["!outline"].left&&(f.summaryRight=0),l=(l||"")+se("outlinePr",null,f)}!s&&!l||(i[i.length]=se("sheetPr",l,a))}var xq=["objects","scenarios","selectLockedCells","selectUnlockedCells"],yq=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function bq(n){var t={sheet:1};return xq.forEach(function(e){n[e]!=null&&n[e]&&(t[e]="1")}),yq.forEach(function(e){n[e]!=null&&!n[e]&&(t[e]="0")}),n.password&&(t.password=DN(n.password).toString(16).toUpperCase()),se("sheetProtection",null,t)}function wq(n){return GN(n),se("pageMargins",null,n)}function Eq(n,t){for(var e=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(e[e.length]=se("col",null,gv(i,r)));return e[e.length]="</cols>",e.join("")}function Aq(n,t,e,r){var i=typeof n.ref=="string"?n.ref:dr(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,a=Hr(i);a.s.r==a.e.r&&(a.e.r=Hr(t["!ref"]).e.r,i=dr(a));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref=Kd(e.SheetNames[r])+"!"+Xd(i);break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+e.SheetNames[r]+"'!"+i}),se("autoFilter",null,{ref:i})}function Sq(n,t,e,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,i),{})}function Tq(n,t,e,r,i,s,a){if(n.c&&e["!comments"].push([t,n.c]),(n.v===void 0||n.t==="z"&&!(r||{}).sheetStubs)&&typeof n.f!="string"&&typeof n.z>"u")return"";var l="",u=n.t,f=n.v;if(n.t!=="z")switch(n.t){case"b":l=n.v?"1":"0";break;case"n":isNaN(n.v)?(n.t="e",l=Di[n.v=36]):isFinite(n.v)?l=""+n.v:(n.t="e",l=Di[n.v=7]);break;case"e":l=Di[n.v];break;case"d":if(r&&r.cellDates){var d=Wi(n.v,a);l=d.toISOString(),d.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else n=li(n),n.t="n",l=""+(n.v=$r(Wi(n.v,a),a));typeof n.z>"u"&&(n.z=Ln[14]);break;default:l=n.v;break}var p=n.t=="z"||n.v==null?"":zr("v",$e(l)),m={r:t},v=Ul(r.cellXfs,n,r);switch(v!==0&&(m.s=v),n.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){p=zr("v",""+Bb(r.Strings,n.v,r.revStrings)),m.t="s";break}else m.t="str";break}if(n.t!=u&&(n.t=u,n.v=f),typeof n.f=="string"&&n.f){var x=n.F&&n.F.slice(0,t.length)==t?{t:"array",ref:n.F}:null;p=se("f",$e(n.f),x)+(n.v!=null?p:"")}return n.l&&(n.l.display=$e(l),e["!links"].push([t,n.l])),n.D&&(m.cm=1),se("c",p,m)}function Cq(n,t,e,r){var i=[],s=[],a=In(n["!ref"]),l="",u,f="",d=[],p=0,m=0,v=n["!rows"],x=n["!data"]!=null,_=x?n["!data"]:[],y={r:f},w,S=-1,T=(((r||{}).Workbook||{}).WBProps||{}).date1904;for(m=a.s.c;m<=a.e.c;++m)d[m]=xn(m);for(p=a.s.r;p<=a.e.r;++p){s=[],f=Sn(p);var C=x?_[p]:[];for(m=a.s.c;m<=a.e.c;++m){u=d[m]+f;var R=x?C[m]:n[u];R!==void 0&&(l=Tq(R,u,n,t,e,r,T))!=null&&s.push(l)}(s.length>0||v&&v[p])&&(y={r:f},v&&v[p]&&(w=v[p],w.hidden&&(y.hidden=1),S=-1,w.hpx?S=Tg(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(y.ht=S,y.customHeight=1),w.level&&(y.outlineLevel=w.level)),i[i.length]=se("row",s.join(""),y))}if(v)for(;p<v.length;++p)v&&v[p]&&(y={r:p+1},w=v[p],w.hidden&&(y.hidden=1),S=-1,w.hpx?S=Tg(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(y.ht=S,y.customHeight=1),w.level&&(y.outlineLevel=w.level),i[i.length]=se("row","",y));return i.join("")}function Dq(n,t,e,r){var i=[pr,se("worksheet",null,{xmlns:Rf[0],"xmlns:r":Dr.r})],s=e.SheetNames[n],a=0,l="",u=e.Sheets[s];u==null&&(u={});var f=u["!ref"]||"A1",d=In(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=dr(d)}r||(r={}),u["!comments"]=[];var p=[];_q(u,e,n,t,i),i[i.length]=se("dimension",null,{ref:f}),i[i.length]=Sq(u,t,n,e),t.sheetFormat&&(i[i.length]=se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(i[i.length]=Eq(u,u["!cols"])),i[a=i.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(l=Cq(u,t,n,e),l.length>0&&(i[i.length]=l)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),u["!protect"]&&(i[i.length]=bq(u["!protect"])),u["!autofilter"]!=null&&(i[i.length]=Aq(u["!autofilter"],u,e,n)),u["!merges"]!=null&&u["!merges"].length>0&&(i[i.length]=vq(u["!merges"]));var m=-1,v,x=-1;return u["!links"].length>0&&(i[i.length]="<hyperlinks>",u["!links"].forEach(function(_){_[1].Target&&(v={ref:_[0]},_[1].Target.charAt(0)!="#"&&(x=un(r,-1,$e(_[1].Target).replace(/#[\s\S]*$/,""),en.HLINK),v["r:id"]="rId"+x),(m=_[1].Target.indexOf("#"))>-1&&(v.location=$e(_[1].Target.slice(m+1))),_[1].Tooltip&&(v.tooltip=$e(_[1].Tooltip)),v.display=_[1].display,i[i.length]=se("hyperlink",null,v))}),i[i.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(i[i.length]=wq(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=zr("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(x=un(r,-1,"../drawings/drawing"+(n+1)+".xml",en.DRAW),i[i.length]=se("drawing",null,{"r:id":"rId"+x}),u["!drawing"]=p),u["!comments"].length>0&&(x=un(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",en.VML),i[i.length]=se("legacyDrawing",null,{"r:id":"rId"+x}),u["!legacy"]=x),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Oq(n,t){var e={},r=n.l+t;e.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(e.level=s&7),s&16&&(e.hidden=!0),s&32&&(e.hpt=i/20),e}function Rq(n,t,e){var r=Ut(145),i=(e["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var s=320;i.hpx?s=Tg(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var l=0,u=r.l;r.l+=4;for(var f={r:n,c:0},d=e["!data"]!=null,p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var m=-1,v=-1,x=p<<10;x<p+1<<10;++x){f.c=x;var _=d?(e["!data"][f.r]||[])[f.c]:e[Vn(f)];_&&(m<0&&(m=x),v=x)}m<0||(++l,r.write_shift(4,m),r.write_shift(4,v))}var y=r.l;return r.l=u,r.write_shift(4,l),r.l=y,r.length>r.l?r.slice(0,r.l):r}function Nq(n,t,e,r){var i=Rq(r,e,t);(i.length>17||(t["!rows"]||[])[r])&&Xt(n,0,i)}var kq=Xc,Lq=Lf;function Iq(){}function Mq(n,t){var e={},r=n[n.l];return++n.l,e.above=!(r&64),e.left=!(r&128),n.l+=18,e.name=O$(n),e}function Pq(n,t,e){e==null&&(e=Ut(84+4*n.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),e.write_shift(1,r);for(var i=1;i<3;++i)e.write_shift(1,0);return wg({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),cN(n,e),e.slice(0,e.l)}function Fq(n){var t=Gs(n);return[t]}function Bq(n,t,e){return e==null&&(e=Ut(8)),Wc(t,e)}function Uq(n){var t=qc(n);return[t]}function zq(n,t,e){return e==null&&(e=Ut(4)),Yc(t,e)}function jq(n){var t=Gs(n),e=n.read_shift(1);return[t,e,"b"]}function Hq(n,t,e){return e==null&&(e=Ut(9)),Wc(t,e),e.write_shift(1,n.v?1:0),e}function $q(n){var t=qc(n),e=n.read_shift(1);return[t,e,"b"]}function Gq(n,t,e){return e==null&&(e=Ut(5)),Yc(t,e),e.write_shift(1,n.v?1:0),e}function Vq(n){var t=Gs(n),e=n.read_shift(1);return[t,e,"e"]}function dx(n,t,e){return e==null&&(e=Ut(9)),Wc(t,e),e.write_shift(1,n.v),e}function Wq(n){var t=qc(n),e=n.read_shift(1);return[t,e,"e"]}function px(n,t,e){return e==null&&(e=Ut(8)),Yc(t,e),e.write_shift(1,n.v),e.write_shift(2,0),e.write_shift(1,0),e}function qq(n){var t=Gs(n),e=n.read_shift(4);return[t,e,"s"]}function Yq(n,t,e){return e==null&&(e=Ut(12)),Wc(t,e),e.write_shift(4,t.v),e}function Xq(n){var t=qc(n),e=n.read_shift(4);return[t,e,"s"]}function Kq(n,t,e){return e==null&&(e=Ut(8)),Yc(t,e),e.write_shift(4,t.v),e}function Zq(n){var t=Gs(n),e=If(n);return[t,e,"n"]}function Qq(n,t,e){return e==null&&(e=Ut(16)),Wc(t,e),Bc(n.v,e),e}function Jq(n){var t=qc(n),e=If(n);return[t,e,"n"]}function tY(n,t,e){return e==null&&(e=Ut(12)),Yc(t,e),Bc(n.v,e),e}function eY(n){var t=Gs(n),e=Ib(n);return[t,e,"n"]}function nY(n,t,e){return e==null&&(e=Ut(12)),Wc(t,e),uN(n.v,e),e}function rY(n){var t=qc(n),e=Ib(n);return[t,e,"n"]}function iY(n,t,e){return e==null&&(e=Ut(8)),Yc(t,e),uN(n.v,e),e}function sY(n){var t=Gs(n),e=kb(n);return[t,e,"is"]}function aY(n){var t=Gs(n),e=oi(n);return[t,e,"str"]}function oY(n,t,e){var r=n.v==null?"":String(n.v);return e==null&&(e=Ut(12+4*n.v.length)),Wc(t,e),wr(r,e),e.length>e.l?e.slice(0,e.l):e}function lY(n){var t=qc(n),e=oi(n);return[t,e,"str"]}function cY(n,t,e){var r=n.v==null?"":String(n.v);return e==null&&(e=Ut(8+4*r.length)),Yc(t,e),wr(r,e),e.length>e.l?e.slice(0,e.l):e}function uY(n,t,e){var r=n.l+t,i=Gs(n);i.r=e["!row"];var s=n.read_shift(1),a=[i,s,"b"];if(e.cellFormula){n.l+=2;var l=mv(n,r-n.l,e);a[3]=yf(l,null,i,e.supbooks,e)}else n.l=r;return a}function fY(n,t,e){var r=n.l+t,i=Gs(n);i.r=e["!row"];var s=n.read_shift(1),a=[i,s,"e"];if(e.cellFormula){n.l+=2;var l=mv(n,r-n.l,e);a[3]=yf(l,null,i,e.supbooks,e)}else n.l=r;return a}function hY(n,t,e){var r=n.l+t,i=Gs(n);i.r=e["!row"];var s=If(n),a=[i,s,"n"];if(e.cellFormula){n.l+=2;var l=mv(n,r-n.l,e);a[3]=yf(l,null,i,e.supbooks,e)}else n.l=r;return a}function dY(n,t,e){var r=n.l+t,i=Gs(n);i.r=e["!row"];var s=oi(n),a=[i,s,"str"];if(e.cellFormula){n.l+=2;var l=mv(n,r-n.l,e);a[3]=yf(l,null,i,e.supbooks,e)}else n.l=r;return a}var pY=Xc,mY=Lf;function gY(n,t){return t==null&&(t=Ut(4)),t.write_shift(4,n),t}function vY(n,t){var e=n.l+t,r=Xc(n),i=fv(n),s=oi(n),a=oi(n),l=oi(n);n.l=e;var u={rfx:r,relId:i,loc:s,display:l};return a&&(u.Tooltip=a),u}function _Y(n,t){var e=Ut(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Lf({s:Un(n[0]),e:Un(n[0])},e),Lb("rId"+t,e);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return wr(i||"",e),wr(n[1].Tooltip||"",e),wr("",e),e.slice(0,e.l)}function xY(){}function yY(n,t,e){var r=n.l+t,i=fN(n),s=n.read_shift(1),a=[i];if(a[2]=s,e.cellFormula){var l=JW(n,r-n.l,e);a[1]=l}else n.l=r;return a}function bY(n,t,e){var r=n.l+t,i=Xc(n),s=[i];if(e.cellFormula){var a=eq(n,r-n.l,e);s[1]=a,n.l=r}else n.l=r;return s}function wY(n,t,e){e==null&&(e=Ut(18));var r=gv(n,t);e.write_shift(-4,n),e.write_shift(-4,n),e.write_shift(4,(r.width||10)*256),e.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),e.write_shift(2,i),e}var VN=["left","right","top","bottom","header","footer"];function EY(n){var t={};return VN.forEach(function(e){t[e]=If(n)}),t}function AY(n,t){return t==null&&(t=Ut(6*8)),GN(n),VN.forEach(function(e){Bc(n[e],t)}),t}function SY(n){var t=n.read_shift(2);return n.l+=28,{RTL:t&32}}function TY(n,t,e){e==null&&(e=Ut(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function CY(n){var t=Ut(24);return t.write_shift(4,4),t.write_shift(4,1),Lf(n,t),t}function DY(n,t){return t==null&&(t=Ut(16*4+2)),t.write_shift(2,n.password?DN(n.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,n[e[0]]!=null&&!n[e[0]]?1:0):t.write_shift(4,n[e[0]]!=null&&n[e[0]]?0:1)}),t}function OY(){}function RY(){}function NY(n,t,e,r,i,s,a,l){var u={r:e,c:r};if(t.c&&s["!comments"].push([Vn(u),t.c]),t.v===void 0)return!1;var f="";switch(t.t){case"b":f=t.v?"1":"0";break;case"d":t=li(t),t.z=t.z||Ln[14],t.v=$r(Wi(t.v,l),l),t.t="n";break;case"n":case"e":f=""+t.v;break;default:f=t.v;break}switch(u.s=Ul(i.cellXfs,t,i),t.l&&s["!links"].push([Vn(u),t.l]),t.t){case"s":case"str":return i.bookSST?(f=Bb(i.Strings,t.v==null?"":String(t.v),i.revStrings),u.t="s",u.v=f,a?Xt(n,18,Kq(t,u)):Xt(n,7,Yq(t,u))):(u.t="str",a?Xt(n,17,cY(t,u)):Xt(n,6,oY(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Xt(n,13,iY(t,u)):Xt(n,2,nY(t,u)):isFinite(t.v)?a?Xt(n,16,tY(t,u)):Xt(n,5,Qq(t,u)):(u.t="e",isNaN(t.v)?a?Xt(n,14,px({v:36},u)):Xt(n,3,dx({v:36},u)):a?Xt(n,14,px({v:7},u)):Xt(n,3,dx({v:7},u))),!0;case"b":return u.t="b",a?Xt(n,15,Gq(t,u)):Xt(n,4,Hq(t,u)),!0;case"e":return u.t="e",a?Xt(n,14,px(t,u)):Xt(n,3,dx(t,u)),!0}return a?Xt(n,12,zq(t,u)):Xt(n,1,Bq(t,u)),!0}function kY(n,t,e,r,i){var s=In(t["!ref"]||"A1"),a="",l=[],u=(((i||{}).Workbook||{}).WBProps||{}).date1904;Xt(n,145);var f=t["!data"]!=null,d=f?t["!data"][s.s.r]:[],p=s.e.r;t["!rows"]&&(p=Math.max(s.e.r,t["!rows"].length-1));for(var m=s.s.r;m<=p;++m)if(a=Sn(m),f&&(d=t["!data"][m]),Nq(n,t,s,m),!(f&&!d)){var v=!1;if(m<=s.e.r)for(var x=s.s.c;x<=s.e.c;++x){m===s.s.r&&(l[x]=xn(x));var _=f?d[x]:t[l[x]+a];if(!_){v=!1;continue}v=NY(n,_,m,x,r,t,v,u)}}Xt(n,146)}function LY(n,t){!t||!t["!merges"]||(Xt(n,177,gY(t["!merges"].length)),t["!merges"].forEach(function(e){Xt(n,176,mY(e))}),Xt(n,178))}function IY(n,t){!t||!t["!cols"]||(Xt(n,390),t["!cols"].forEach(function(e,r){e&&Xt(n,60,wY(r,e))}),Xt(n,391))}function MY(n,t){!t||!t["!ref"]||(Xt(n,648),Xt(n,649,CY(In(t["!ref"]))),Xt(n,650))}function PY(n,t,e){t["!links"].forEach(function(r){if(r[1].Target){var i=un(e,-1,r[1].Target.replace(/#[\s\S]*$/,""),en.HLINK);Xt(n,494,_Y(r,i))}}),delete t["!links"]}function FY(n,t,e,r){if(t["!comments"].length>0){var i=un(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",en.VML);Xt(n,551,Lb("rId"+i)),t["!legacy"]=i}}function BY(n,t,e,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:dr(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,l=Hr(s);l.s.r==l.e.r&&(l.e.r=Hr(t["!ref"]).e.r,s=dr(l));for(var u=0;u<a.length;++u){var f=a[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==r){f.Ref=Kd(e.SheetNames[r])+"!"+Xd(s);break}}u==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:Kd(e.SheetNames[r])+"!"+Xd(s)}),Xt(n,161,Lf(In(s))),Xt(n,162)}}function UY(n,t,e){Xt(n,133),Xt(n,137,TY(t,e)),Xt(n,138),Xt(n,134)}function zY(n,t){t["!protect"]&&Xt(n,535,DY(t["!protect"]))}function jY(n,t,e,r){var i=ai(),s=e.SheetNames[n],a=e.Sheets[s]||{},l=s;try{e&&e.Workbook&&(l=e.Workbook.Sheets[n].CodeName||l)}catch{}var u=In(a["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Xt(i,129),(e.vbaraw||a["!outline"])&&Xt(i,147,Pq(l,a["!outline"])),Xt(i,148,Lq(u)),UY(i,a,e.Workbook),IY(i,a),kY(i,a,n,t,e),zY(i,a),BY(i,a,e,n),LY(i,a),PY(i,a,r),a["!margins"]&&Xt(i,476,AY(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&MY(i,a),FY(i,a,n,r),Xt(i,130),i.end()}function HY(n,t){n.l+=10;var e=oi(n);return{name:e}}var $Y=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function GY(n){return!n.Workbook||!n.Workbook.WBProps?"false":a$(n.Workbook.WBProps.date1904)?"true":"false"}var VY=":][*?/\\".split("");function WN(n,t){try{if(n=="")throw new Error("Sheet name cannot be blank");if(n.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(n.charCodeAt(0)==39||n.charCodeAt(n.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(n.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");VY.forEach(function(e){if(n.indexOf(e)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(e){throw e}return!0}function WY(n,t,e){n.forEach(function(r,i){WN(r);for(var s=0;s<i;++s)if(r==n[s])throw new Error("Duplicate Sheet Name: "+r);if(e){var a=t&&t[i]&&t[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function qY(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var t=n.Workbook&&n.Workbook.Sheets||[];WY(n.SheetNames,t,!!n.vbaraw);for(var e=0;e<n.SheetNames.length;++e)gq(n.Sheets[n.SheetNames[e]],n.SheetNames[e],e);n.SheetNames.forEach(function(r,i){var s=n.Sheets[r];if(!(!s||!s["!autofilter"])){var a;n.Workbook||(n.Workbook={}),n.Workbook.Names||(n.Workbook.Names=[]),n.Workbook.Names.forEach(function(u){u.Name=="_xlnm._FilterDatabase"&&u.Sheet==i&&(a=u)});var l=Kd(r)+"!"+Xd(s["!autofilter"].ref);a?a.Ref=l:n.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:l})}})}function YY(n){var t=[pr];t[t.length]=se("workbook",null,{xmlns:Rf[0],"xmlns:r":Dr.r});var e=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&($Y.forEach(function(l){n.Workbook.WBProps[l[0]]!=null&&n.Workbook.WBProps[l[0]]!=l[1]&&(r[l[0]]=n.Workbook.WBProps[l[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=se("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=n.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==n.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=n.SheetNames.length;++s){var a={name:$e(n.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=se("sheet",null,a)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(l){var u={name:l.Name};l.Comment&&(u.comment=l.Comment),l.Sheet!=null&&(u.localSheetId=""+l.Sheet),l.Hidden&&(u.hidden="1"),l.Ref&&(t[t.length]=se("definedName",$e(l.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function XY(n,t){var e={};return e.Hidden=n.read_shift(4),e.iTabID=n.read_shift(4),e.strRelID=ty(n),e.name=oi(n),e}function KY(n,t){return t||(t=Ut(127)),t.write_shift(4,n.Hidden),t.write_shift(4,n.iTabID),Lb(n.strRelID,t),wr(n.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function ZY(n,t){var e={},r=n.read_shift(4);e.defaultThemeVersion=n.read_shift(4);var i=t>8?oi(n):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(r&65536),e.backupFile=!!(r&64),e.checkCompatibility=!!(r&4096),e.date1904=!!(r&1),e.filterPrivacy=!!(r&8),e.hidePivotFieldList=!!(r&1024),e.promptedSolutions=!!(r&16),e.publishItems=!!(r&2048),e.refreshAllConnections=!!(r&262144),e.saveExternalLinkValues=!!(r&128),e.showBorderUnselectedTables=!!(r&4),e.showInkAnnotation=!!(r&32),e.showObjects=["all","placeholders","none"][r>>13&3],e.showPivotChartFilter=!!(r&32768),e.updateLinks=["userSet","never","always"][r>>8&3],e}function QY(n,t){t||(t=Ut(72));var e=0;return n&&(n.date1904&&(e|=1),n.filterPrivacy&&(e|=8)),t.write_shift(4,e),t.write_shift(4,0),cN(n&&n.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function JY(n,t,e){var r=n.l+t,i=n.read_shift(4);n.l+=1;var s=n.read_shift(4),a=R$(n),l,u="";try{l=tq(n,0,e);try{u=fv(n)}catch{}}catch{console.error("Could not parse defined name "+a)}i&32&&(a="_xlnm."+a),n.l=r;var f={Name:a,Ptg:l,Flags:i};return s<268435455&&(f.Sheet=s),u&&(f.Comment=u),f}function tX(n,t){var e=Ut(9),r=0,i=n.Name;H$.indexOf(i)>-1&&(r|=32,i=i.slice(6)),e.write_shift(4,r),e.write_shift(1,0),e.write_shift(4,n.Sheet==null?4294967295:n.Sheet);var s=[e,wr(i),hq(n.Ref,t)];if(n.Comment)s.push(Zd(n.Comment));else{var a=Ut(4);a.write_shift(4,4294967295),s.push(a)}return fr(s)}function eX(n,t){Xt(n,143);for(var e=0;e!=t.SheetNames.length;++e){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,i={Hidden:r,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};Xt(n,156,KY(i))}Xt(n,144)}function nX(n,t){t||(t=Ut(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return wr("SheetJS",t),wr(dg.version,t),wr(dg.version,t),wr("7262",t),t.length>t.l?t.slice(0,t.l):t}function rX(n,t){t||(t=Ut(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,n),t.write_shift(4,n);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function iX(n,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,r=0,i=-1,s=-1;r<e.length;++r)!e[r]||!e[r].Hidden&&i==-1?i=r:e[r].Hidden==1&&s==-1&&(s=r);s>i||(Xt(n,135),Xt(n,158,rX(i)),Xt(n,136))}}function sX(n,t){!t.Workbook||!t.Workbook.Names||t.Workbook.Names.forEach(function(e){try{if(e.Flags&14)return;Xt(n,39,tX(e,t))}catch{console.error("Could not serialize defined name "+JSON.stringify(e))}})}function aX(n){var t=n.SheetNames.length,e=Ut(12*t+28);e.write_shift(4,t+2),e.write_shift(4,0),e.write_shift(4,-2),e.write_shift(4,-2),e.write_shift(4,0),e.write_shift(4,-1),e.write_shift(4,-1);for(var r=0;r<t;++r)e.write_shift(4,0),e.write_shift(4,r),e.write_shift(4,r);return e}function oX(n,t){Xt(n,353),Xt(n,357),Xt(n,362,aX(t)),Xt(n,354)}function lX(n,t){var e=ai();return Xt(e,131),Xt(e,128,nX()),Xt(e,153,QY(n.Workbook&&n.Workbook.WBProps||null)),iX(e,n),eX(e,n),oX(e,n),(n.Workbook||{}).Names&&sX(e,n),Xt(e,132),e.end()}function cX(n,t){var e=[];return n.Props&&e.push(q$(n.Props,t)),n.Custprops&&e.push(Y$(n.Props,n.Custprops)),e.join("")}function uX(n){return(((n||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function fX(n,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(se("NumberFormat",null,{"ss:Format":$e(Ln[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};e.push(se("Style",s.join(""),a))}),se("Styles",e.join(""))}function qN(n){return se("NamedRange",null,{"ss:Name":n.Name.slice(0,6)=="_xlnm."?n.Name.slice(6):n.Name,"ss:RefersTo":"="+dv(n.Ref,{r:0,c:0})})}function hX(n){if(!((n||{}).Workbook||{}).Names)return"";for(var t=n.Workbook.Names,e=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||e.push(qN(i)))}return se("Names",e.join(""))}function dX(n,t,e,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var l=i[a];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||s.push(qN(l)))}return s.join("")}function pX(n,t,e,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(se("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(se("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(se("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e])if(r.Workbook.Sheets[e].Hidden)i.push(se("Visible",r.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<e&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==e&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(zr("ProtectContents","True")),n["!protect"].objects&&i.push(zr("ProtectObjects","True")),n["!protect"].scenarios&&i.push(zr("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(zr("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(zr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){n["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":se("WorksheetOptions",i.join(""),{xmlns:ls.x})}function mX(n){return n.map(function(t){var e=s$(t.t||""),r=se("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"}),i={};return t.a&&(i["ss:Author"]=t.a),n.hidden||(i["ss:ShowAlways"]="1"),se("Comment",r,i)}).join("")}function gX(n,t,e,r,i,s,a){if(!n||n.v==null&&n.f==null)return"";var l={};if(n.f&&(l["ss:Formula"]="="+$e(dv(n.f,a))),n.F&&n.F.slice(0,t.length)==t){var u=Un(n.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(u.r==a.r?"":"["+(u.r-a.r)+"]")+"C"+(u.c==a.c?"":"["+(u.c-a.c)+"]")}if(n.l&&n.l.Target&&(l["ss:HRef"]=$e(n.l.Target),n.l.Tooltip&&(l["x:HRefScreenTip"]=$e(n.l.Tooltip))),e["!merges"])for(var f=e["!merges"],d=0;d!=f.length;++d)f[d].s.c!=a.c||f[d].s.r!=a.r||(f[d].e.c>f[d].s.c&&(l["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(l["ss:MergeDown"]=f[d].e.r-f[d].s.r));var p="",m="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":isFinite(n.v)?(p="Number",m=String(n.v)):(p="Error",m=Di[isNaN(n.v)?36:7]);break;case"b":p="Boolean",m=n.v?"1":"0";break;case"e":p="Error",m=Di[n.v];break;case"d":p="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Ln[14]);break;case"s":p="String",m=i$(n.v||"");break}var v=Ul(r.cellXfs,n,r);l["ss:StyleID"]="s"+(21+v),l["ss:Index"]=a.c+1;var x=n.v!=null?m:"",_=n.t=="z"?"":'<Data ss:Type="'+p+'">'+x+"</Data>";return(n.c||[]).length>0&&(_+=mX(n.c)),se("Cell",_,l)}function vX(n,t){var e='<Row ss:Index="'+(n+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=RN(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function _X(n,t,e,r){if(!n["!ref"])return"";var i=In(n["!ref"]),s=n["!merges"]||[],a=0,l=[];n["!cols"]&&n["!cols"].forEach(function(y,w){Pb(y);var S=!!y.width,T=gv(w,y),C={"ss:Index":w+1};S&&(C["ss:Width"]=Ag(T.width)),y.hidden&&(C["ss:Hidden"]="1"),l.push(se("Column",null,C))});for(var u=n["!data"]!=null,f={r:0,c:0},d=i.s.r;d<=i.e.r;++d){var p=[vX(d,(n["!rows"]||[])[d])];f.r=d;for(var m=i.s.c;m<=i.e.c;++m){f.c=m;var v=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>m)&&!(s[a].s.r>d)&&!(s[a].e.c<m)&&!(s[a].e.r<d)){(s[a].s.c!=m||s[a].s.r!=d)&&(v=!0);break}if(!v){var x=xn(m)+Sn(d),_=u?(n["!data"][d]||[])[m]:n[x];p.push(gX(_,x,n,t,e,r,f))}}p.push("</Row>"),p.length>2&&l.push(p.join(""))}return l.join("")}function xX(n,t,e){var r=[],i=e.SheetNames[n],s=e.Sheets[i],a=s?dX(s,t,n,e):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?_X(s,t,n,e):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(pX(s,t,n,e)),s&&s["!autofilter"]&&r.push('<AutoFilter x:Range="'+dv(Xd(s["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),r.join("")}function yX(n,t){t||(t={}),n.SSF||(n.SSF=li(Ln)),n.SSF&&(lv(),ov(n.SSF),t.revssf=cv(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF,t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(cX(n,t)),e.push(uX(n)),e.push(""),e.push(hX(n));for(var r=0;r<n.SheetNames.length;++r)e.push(se("Worksheet",xX(r,t,n),{"ss:Name":$e(n.SheetNames[r])}));return e[2]=fX(n,t),pr+se("Workbook",e.join(""),{xmlns:ls.ss,"xmlns:o":ls.o,"xmlns:x":ls.x,"xmlns:ss":ls.ss,"xmlns:dt":ls.dt,"xmlns:html":ls.html})}var mx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bX(n,t){var e=[],r=[],i=[],s=0,a,l=ST(PT,"n"),u=ST(FT,"n");if(n.Props)for(a=hr(n.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(l,a[s])?e:Object.prototype.hasOwnProperty.call(u,a[s])?r:i).push([a[s],n.Props[a[s]]]);if(n.Custprops)for(a=hr(n.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(n.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(l,a[s])?e:Object.prototype.hasOwnProperty.call(u,a[s])?r:i).push([a[s],n.Custprops[a[s]]]);var f=[];for(s=0;s<i.length;++s)bN.indexOf(i[s][0])>-1||_N.indexOf(i[s][0])>-1||i[s][1]!=null&&f.push(i[s]);r.length&&Rn.utils.cfb_add(t,"/SummaryInformation",HT(r,mx.SI,u,FT)),(e.length||f.length)&&Rn.utils.cfb_add(t,"/DocumentSummaryInformation",HT(e,mx.DSI,l,PT,f.length?f:null,mx.UDI))}function wX(n,t){var e=t||{},r=Rn.utils.cfb_new({root:"R"}),i="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":i="/Workbook",e.biff=8;break;case"biff5":i="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Rn.utils.cfb_add(r,i,XN(n,e)),e.biff==8&&(n.Props||n.Custprops)&&bX(n,r),e.biff==8&&n.vbaraw&&kV(r,Rn.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var EX={0:{f:Oq},1:{f:Fq},2:{f:eY},3:{f:Vq},4:{f:jq},5:{f:Zq},6:{f:aY},7:{f:qq},8:{f:dY},9:{f:hY},10:{f:uY},11:{f:fY},12:{f:Uq},13:{f:rY},14:{f:Wq},15:{f:$q},16:{f:Jq},17:{f:lY},18:{f:Xq},19:{f:kb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:JY},40:{},42:{},43:{f:ZG},44:{f:XG},45:{f:tV},46:{f:nV},47:{f:eV},48:{},49:{f:E$},50:{},51:{f:_V},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:CG},62:{f:sY},63:{f:SV},64:{f:OY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:SY},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Mq},148:{f:kq,p:16},151:{f:xY},152:{},153:{f:ZY},154:{},155:{},156:{f:XY},157:{},158:{},159:{T:1,f:BG},160:{T:-1},161:{T:1,f:Xc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:pY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gV},336:{T:-1},337:{f:bV,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ty},357:{},358:{},359:{},360:{T:1},361:{},362:{f:wG},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yY},427:{f:bY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:EY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Iq},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vY},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ty},551:{f:fv},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:RV},633:{T:1},634:{T:-1},635:{T:1,f:DV},636:{T:-1},637:{f:C$},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:HY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:RY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Zt(n,t,e,r){var i=t;if(!isNaN(i)){var s=r||(e||[]).length||0,a=n.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Ob(e)&&n.push(e)}}function AX(n,t,e,r){var i=(e||[]).length||0;if(i<=8224)return Zt(n,t,e,i);var s=t;if(!isNaN(s)){for(var a=e.parts||[],l=0,u=0,f=0;f+(a[l]||8224)<=8224;)f+=a[l]||8224,l++;var d=n.next(4);for(d.write_shift(2,s),d.write_shift(2,f),n.push(e.slice(u,u+f)),u+=f;u<i;){for(d=n.next(4),d.write_shift(2,60),f=0;f+(a[l]||8224)<=8224;)f+=a[l]||8224,l++;d.write_shift(2,f),n.push(e.slice(u,u+f)),u+=f}}}function gx(n,t,e,r){var i=Ut(9);return xp(i,n,t),wN(e,r||"b",i),i}function SX(n,t,e){var r=Ut(8+2*e.length);return xp(r,n,t),r.write_shift(1,e.length),r.write_shift(e.length,e,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function YN(n,t){t.forEach(function(e){var r=e[0].map(function(s){return s.t}).join("");if(r.length<=2048)return Zt(n,28,fx(r,e[1],e[2]));Zt(n,28,fx(r.slice(0,2048),e[1],e[2],r.length));for(var i=2048;i<r.length;i+=2048)Zt(n,28,fx(r.slice(i,Math.min(i+2048,r.length)),-1,-1,Math.min(2048,r.length-i)))})}function TX(n,t,e,r,i,s){var a=0;t.z!=null&&(a=i._BIFF2FmtTable.indexOf(t.z),a==-1&&(i._BIFF2FmtTable.push(t.z),a=i._BIFF2FmtTable.length-1));var l=0;if(t.z!=null){for(;l<i.cellXfs.length&&i.cellXfs[l].numFmtId!=a;++l);l==i.cellXfs.length&&i.cellXfs.push({numFmtId:a})}if(t.v!=null)switch(t.t){case"d":case"n":var u=t.t=="d"?$r(Wi(t.v,s),s):t.v;i.biff==2&&u==(u|0)&&u>=0&&u<65536?Zt(n,2,NG(e,r,u,l,a)):isNaN(u)?Zt(n,5,gx(e,r,36,"e")):isFinite(u)?Zt(n,3,RG(e,r,u,l,a)):Zt(n,5,gx(e,r,7,"e"));return;case"b":case"e":Zt(n,5,gx(e,r,t.v,t.t));return;case"s":case"str":Zt(n,4,SX(e,r,t.v==null?"":String(t.v).slice(0,255)));return}Zt(n,1,xp(null,e,r))}function CX(n,t,e,r,i){var s=t["!data"]!=null,a=In(t["!ref"]||"A1"),l="",u=[];if(a.e.c>255||a.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.r,16383)}for(var f=(((i||{}).Workbook||{}).WBProps||{}).date1904,d=[],p=[],m=a.s.c;m<=a.e.c;++m)u[m]=xn(m);for(var v=a.s.r;v<=a.e.r;++v)for(s&&(d=t["!data"][v]||[]),l=Sn(v),m=a.s.c;m<=a.e.c;++m){var x=s?d[m]:t[u[m]+l];x&&(TX(n,x,v,m,r,f),x.c&&p.push([x.c,v,m]))}YN(n,p)}function DX(n,t){for(var e=t||{},r=ai(),i=0,s=0;s<n.SheetNames.length;++s)n.SheetNames[s]==e.sheet&&(i=s);if(i==0&&e.sheet&&n.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);Zt(r,e.biff==4?1033:e.biff==3?521:9,Mb(n,16,e)),((n.Workbook||{}).WBProps||{}).date1904&&Zt(r,34,ri(!0)),e.cellXfs=[{numFmtId:0}],e._BIFF2FmtTable=["General"],e._Fonts=[];var a=ai();return CX(a,n.Sheets[n.SheetNames[i]],i,e,n),e._BIFF2FmtTable.forEach(function(l){e.biff<=3?Zt(r,30,mG(l)):Zt(r,1054,gG(l))}),e.cellXfs.forEach(function(l){switch(e.biff){case 2:Zt(r,67,_G(l));break;case 3:Zt(r,579,TN(l));break;case 4:Zt(r,1091,xG(l));break}}),delete e._BIFF2FmtTable,delete e.cellXfs,delete e._Fonts,r.push(a.end()),Zt(r,10),r.end()}var ia=1,Is=[];function OX(){var n=Ut(82+8*Is.length);n.write_shift(2,15),n.write_shift(2,61440),n.write_shift(4,74+8*Is.length);{n.write_shift(2,0),n.write_shift(2,61446),n.write_shift(4,16+8*Is.length);{n.write_shift(4,ia),n.write_shift(4,Is.length+1);for(var t=0,e=0;e<Is.length;++e)t+=Is[e]&&Is[e][1]||0;n.write_shift(4,t),n.write_shift(4,Is.length)}Is.forEach(function(r){n.write_shift(4,r[0]),n.write_shift(4,r[2])})}return n.write_shift(2,51),n.write_shift(2,61451),n.write_shift(4,18),n.write_shift(2,191),n.write_shift(4,524296),n.write_shift(2,385),n.write_shift(4,134217793),n.write_shift(2,448),n.write_shift(4,134217792),n.write_shift(2,64),n.write_shift(2,61726),n.write_shift(4,16),n.write_shift(4,134217741),n.write_shift(4,134217740),n.write_shift(4,134217751),n.write_shift(4,268435703),n}function RX(n,t){var e=[],r=0,i=ai(),s=ia,a;t.forEach(function(u,f){var d="",p=u[0].map(function(T){return T.a&&!d&&(d=T.a),T.t}).join("");++ia;{var m=Ut(150);m.write_shift(2,15),m.write_shift(2,61444),m.write_shift(4,150),m.write_shift(2,3234),m.write_shift(2,61450),m.write_shift(4,8),m.write_shift(4,ia),m.write_shift(4,2560),m.write_shift(2,227),m.write_shift(2,61451),m.write_shift(4,84),m.write_shift(2,128),m.write_shift(4,0),m.write_shift(2,139),m.write_shift(4,2),m.write_shift(2,191),m.write_shift(4,524296),m.write_shift(2,344),m.l+=4,m.write_shift(2,385),m.write_shift(4,134217808),m.write_shift(2,387),m.write_shift(4,134217808),m.write_shift(2,389),m.write_shift(4,268435700),m.write_shift(2,447),m.write_shift(4,1048592),m.write_shift(2,448),m.write_shift(4,134217809),m.write_shift(2,451),m.write_shift(4,268435700),m.write_shift(2,513),m.write_shift(4,134217809),m.write_shift(2,515),m.write_shift(4,268435700),m.write_shift(2,575),m.write_shift(4,196609),m.write_shift(2,959),m.write_shift(4,131072|(u[0].hidden?2:0)),m.l+=2,m.write_shift(2,61456),m.write_shift(4,18),m.write_shift(2,3),m.write_shift(2,u[2]+2),m.l+=2,m.write_shift(2,u[1]+1),m.l+=2,m.write_shift(2,u[2]+4),m.l+=2,m.write_shift(2,u[1]+5),m.l+=2,m.l+=2,m.write_shift(2,61457),m.l+=4,m.l=150,f==0?a=m:Zt(i,236,m)}r+=150;{var v=Ut(52);v.write_shift(2,21),v.write_shift(2,18),v.write_shift(2,25),v.write_shift(2,ia),v.write_shift(2,0),v.l=22,v.write_shift(2,13),v.write_shift(2,22),v.write_shift(4,1651663474),v.write_shift(4,2503426821),v.write_shift(4,2150634280),v.write_shift(4,1768515844+ia*256),v.write_shift(2,0),v.write_shift(4,0),v.l+=4,Zt(i,93,v)}{var x=Ut(8);x.l+=2,x.write_shift(2,61453),x.l+=4,Zt(i,236,x)}r+=8;{var _=Ut(18);_.write_shift(2,18),_.l+=8,_.write_shift(2,p.length),_.write_shift(2,16),_.l+=4,Zt(i,438,_);{var y=Ut(1+p.length);y.write_shift(1,0),y.write_shift(p.length,p,"sbcs"),Zt(i,60,y)}{var w=Ut(16);w.l+=8,w.write_shift(2,p.length),w.l+=6,Zt(i,60,w)}}{var S=Ut(12+d.length);S.write_shift(2,u[1]),S.write_shift(2,u[2]),S.write_shift(2,0|(u[0].hidden?0:2)),S.write_shift(2,ia),S.write_shift(2,d.length),S.write_shift(1,0),S.write_shift(d.length,d,"sbcs"),S.l++,e.push(S)}});{var l=Ut(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,r+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,t.length+1),l.write_shift(4,ia),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,r+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,s),l.write_shift(4,5),Zt(n,236,a?fr([l,a]):l)}n.push(i.end()),e.forEach(function(u){Zt(n,28,u)}),Is.push([s,t.length+1,ia]),++ia}function NX(n,t,e){Zt(n,49,fG({sz:12,name:"Arial"},e))}function kX(n,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Zt(n,1054,pG(i,t[i],e))})}function LX(n,t){var e=Ut(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Zt(n,2151,e),e=Ut(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),SN(In(t["!ref"]||"A1"),e),e.write_shift(4,4),Zt(n,2152,e)}function IX(n,t){for(var e=0;e<16;++e)Zt(n,224,GT({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){Zt(n,224,GT(r,0,t))})}function MX(n,t){for(var e=0;e<t["!links"].length;++e){var r=t["!links"][e];Zt(n,440,AG(r)),r[1].Tooltip&&Zt(n,2048,SG(r))}delete t["!links"]}function PX(n,t){if(t){var e=0;t.forEach(function(r,i){++e<=256&&r&&Zt(n,125,DG(gv(i,r),i))})}}function FX(n,t,e,r,i,s){var a=16+Ul(i.cellXfs,t,i);if(t.v==null&&!t.bf){Zt(n,513,Uc(e,r,a));return}if(t.bf)Zt(n,6,QW(t,e,r,i,a));else switch(t.t){case"d":case"n":var l=t.t=="d"?$r(Wi(t.v,s),s):t.v;isNaN(l)?Zt(n,517,ux(e,r,36,a,i,"e")):isFinite(l)?Zt(n,515,bG(e,r,l,a)):Zt(n,517,ux(e,r,7,a,i,"e"));break;case"b":case"e":Zt(n,517,ux(e,r,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var u=Bb(i.Strings,t.v==null?"":String(t.v),i.revStrings);Zt(n,253,hG(e,r,u,a))}else Zt(n,516,dG(e,r,(t.v==null?"":String(t.v)).slice(0,255),a,i));break;default:Zt(n,513,Uc(e,r,a))}}function BX(n,t,e){var r=ai(),i=e.SheetNames[n],s=e.Sheets[i]||{},a=(e||{}).Workbook||{},l=(a.Sheets||[])[n]||{},u=s["!data"]!=null,f=t.biff==8,d="",p=[],m=In(s["!ref"]||"A1"),v=f?65536:16384;if(m.e.c>255||m.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV"+v);m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.r,v-1)}Zt(r,2057,Mb(e,16,t)),Zt(r,13,Ms(1)),Zt(r,12,Ms(100)),Zt(r,15,ri(!0)),Zt(r,17,ri(!1)),Zt(r,16,Bc(.001)),Zt(r,95,ri(!0)),Zt(r,42,ri(!1)),Zt(r,43,ri(!1)),Zt(r,130,Ms(1)),Zt(r,128,yG()),Zt(r,131,ri(!1)),Zt(r,132,ri(!1)),f&&PX(r,s["!cols"]),Zt(r,512,vG(m,t));var x=(((e||{}).Workbook||{}).WBProps||{}).date1904;f&&(s["!links"]=[]);for(var _=m.s.c;_<=m.e.c;++_)p[_]=xn(_);for(var y=[],w=[],S=m.s.r;S<=m.e.r;++S)for(u&&(w=s["!data"][S]||[]),d=Sn(S),_=m.s.c;_<=m.e.c;++_){var T=u?w[_]:s[p[_]+d];T&&(FX(r,T,S,_,t,x),f&&T.l&&s["!links"].push([p[_]+d,T.l]),T.c&&y.push([T.c,S,_]))}var C=l.CodeName||l.name||i;return f?RX(r,y):YN(r,y),f&&Zt(r,574,uG((a.Views||[])[0])),f&&(s["!merges"]||[]).length&&Zt(r,229,EG(s["!merges"])),f&&MX(r,s),Zt(r,442,AN(C)),f&&LX(r,s),Zt(r,10),r.end()}function UX(n,t,e){var r=ai(),i=(n||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},l=e.biff==8,u=e.biff==5;if(Zt(r,2057,Mb(n,5,e)),e.bookType=="xla"&&Zt(r,135),Zt(r,225,l?Ms(1200):null),Zt(r,193,Z$(2)),u&&Zt(r,191),u&&Zt(r,192),Zt(r,226),Zt(r,92,aG("SheetJS",e)),Zt(r,66,Ms(l?1200:1252)),l&&Zt(r,353,Ms(0)),l&&Zt(r,448),Zt(r,317,OG(n.SheetNames.length)),l&&n.vbaraw&&Zt(r,211),l&&n.vbaraw){var f=a.CodeName||"ThisWorkbook";Zt(r,442,AN(f))}Zt(r,156,Ms(17)),Zt(r,25,ri(!1)),Zt(r,18,ri(!1)),Zt(r,19,Ms(0)),l&&Zt(r,431,ri(!1)),l&&Zt(r,444,Ms(0)),Zt(r,61,cG()),Zt(r,64,ri(!1)),Zt(r,141,Ms(0)),Zt(r,34,ri(GY(n)=="true")),Zt(r,14,ri(!0)),l&&Zt(r,439,ri(!1)),Zt(r,218,Ms(0)),NX(r,n,e),kX(r,n.SSF,e),IX(r,e),l&&Zt(r,352,ri(!1));var d=r.end(),p=ai();l&&Zt(p,140,TG()),l&&Is.length&&Zt(p,235,OX()),l&&e.Strings&&AX(p,252,lG(e.Strings)),Zt(p,10);var m=p.end(),v=ai(),x=0,_=0;for(_=0;_<n.SheetNames.length;++_)x+=(l?12:11)+(l?2:1)*n.SheetNames[_].length;var y=d.length+x+m.length;for(_=0;_<n.SheetNames.length;++_){var w=s[_]||{};Zt(v,133,oG({pos:y,hs:w.Hidden||0,dt:0,name:n.SheetNames[_]},e)),y+=t[_].length}var S=v.end();if(x!=S.length)throw new Error("BS8 "+x+" != "+S.length);var T=[];return d.length&&T.push(d),S.length&&T.push(S),m.length&&T.push(m),fr(T)}function zX(n,t){var e=t||{},r=[];n&&!n.SSF&&(n.SSF=li(Ln)),n&&n.SSF&&(lv(),ov(n.SSF),e.revssf=cv(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),ia=1,Is=[],e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ub(e),e.cellXfs=[],Ul(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=BX(i,e,n);return r.unshift(UX(n,r,e)),fr(r)}function XN(n,t){for(var e=0;e<=n.SheetNames.length;++e){var r=n.Sheets[n.SheetNames[e]];if(!(!r||!r["!ref"])){var i=Hr(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost."),i.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond row 65536.  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return zX(n,t);case 4:case 3:case 2:return DX(n,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function jX(n,t,e,r){for(var i=n["!merges"]||[],s=[],a={},l=n["!data"]!=null,u=t.s.c;u<=t.e.c;++u){for(var f=0,d=0,p=0;p<i.length;++p)if(!(i[p].s.r>e||i[p].s.c>u)&&!(i[p].e.r<e||i[p].e.c<u)){if(i[p].s.r<e||i[p].s.c<u){f=-1;break}f=i[p].e.r-i[p].s.r+1,d=i[p].e.c-i[p].s.c+1;break}if(!(f<0)){var m=xn(u)+Sn(e),v=l?(n["!data"][e]||[])[u]:n[m];v&&v.t=="n"&&v.v!=null&&!isFinite(v.v)&&(isNaN(v.v)?v={t:"e",v:36,w:Di[36]}:v={t:"e",v:7,w:Di[7]});var x=v&&v.v!=null&&(v.h||ax(v.w||(jo(v),v.w)||""))||"";a={},f>1&&(a.rowspan=f),d>1&&(a.colspan=d),r.editable?x='<span contenteditable="true">'+x+"</span>":v&&(a["data-t"]=v&&v.t||"z",v.v!=null&&(a["data-v"]=ax(v.v instanceof Date?v.v.toISOString():v.v)),v.z!=null&&(a["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+ax(v.l.Target)+'">'+x+"</a>")),a.id=(r.id||"sjs")+"-"+m,s.push(se("td",x,a))}}var _="<tr>";return _+s.join("")+"</tr>"}var HX='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$X="</body></html>";function GX(n,t,e){var r=[];return r.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function KN(n,t){var e=t||{},r=e.header!=null?e.header:HX,i=e.footer!=null?e.footer:$X,s=[r],a=Hr(n["!ref"]||"A1");if(s.push(GX(n,a,e)),n["!ref"])for(var l=a.s.r;l<=a.e.r;++l)s.push(jX(n,a,l,e));return s.push("</table>"+i),s.join("")}function ZN(n,t,e){var r=t.rows;if(!r)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var i=e||{},s=n["!data"]!=null,a=0,l=0;if(i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var u=typeof i.origin=="string"?Un(i.origin):i.origin;a=u.r,l=u.c}var f=Math.min(i.sheetRows||1e7,r.length),d={s:{r:0,c:0},e:{r:a,c:l}};if(n["!ref"]){var p=Hr(n["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),a==-1&&(d.e.r=a=p.e.r+1)}var m=[],v=0,x=n["!rows"]||(n["!rows"]=[]),_=0,y=0,w=0,S=0,T=0,C=0;for(n["!cols"]||(n["!cols"]=[]);_<r.length&&y<f;++_){var R=r[_];if(eC(R)){if(i.display)continue;x[y]={hidden:!0}}var N=R.cells;for(w=S=0;w<N.length;++w){var D=N[w];if(!(i.display&&eC(D))){var I=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):o$(D.innerHTML),M=D.getAttribute("data-z")||D.getAttribute("z");for(v=0;v<m.length;++v){var B=m[v];B.s.c==S+l&&B.s.r<y+a&&y+a<=B.e.r&&(S=B.e.c+1-l,v=-1)}C=+D.getAttribute("colspan")||1,((T=+D.getAttribute("rowspan")||1)>1||C>1)&&m.push({s:{r:y+a,c:S+l},e:{r:y+a+(T||1)-1,c:S+l+(C||1)-1}});var H={t:"s",v:I},F=D.getAttribute("data-t")||D.getAttribute("t")||"";I!=null&&(I.length==0?H.t=F||"z":i.raw||I.trim().length==0||F=="s"||(F=="e"&&Di[+I]?H={t:"e",v:+I,w:Di[+I]}:I==="TRUE"?H={t:"b",v:!0}:I==="FALSE"?H={t:"b",v:!1}:isNaN(Mo(I))?isNaN(yg(I).getDate())?I.charCodeAt(0)==35&&$a[I]!=null&&(H={t:"e",v:$a[I],w:I}):(H={t:"d",v:Wi(I)},i.UTC&&(H.v=uv(H.v)),i.cellDates||(H={t:"n",v:$r(H.v)}),H.z=i.dateNF||Ln[14]):H={t:"n",v:Mo(I)})),H.z===void 0&&M!=null&&(H.z=M);var rt="",L=D.getElementsByTagName("A");if(L&&L.length)for(var it=0;it<L.length&&!(L[it].hasAttribute("href")&&(rt=L[it].getAttribute("href"),rt.charAt(0)!="#"));++it);rt&&rt.charAt(0)!="#"&&rt.slice(0,11).toLowerCase()!="javascript:"&&(H.l={Target:rt}),s?(n["!data"][y+a]||(n["!data"][y+a]=[]),n["!data"][y+a][S+l]=H):n[Vn({c:S+l,r:y+a})]=H,d.e.c<S+l&&(d.e.c=S+l),S+=C}}++y}return m.length&&(n["!merges"]=(n["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,y-1+a),n["!ref"]=dr(d),y>=f&&(n["!fullref"]=dr((d.e.r=r.length-_+y-1+a,d))),n}function QN(n,t){var e=t||{},r={};return e.dense&&(r["!data"]=[]),ZN(r,n,t)}function VX(n,t){var e=Nf(QN(n,t),t);return e}function eC(n){var t="",e=WX(n);return e&&(t=e(n).getPropertyValue("display")),t||(t=n.style&&n.style.display),t==="none"}function WX(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var qX=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Yd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return pr+t}}();function YX(n,t){var e="number",r="",i={"style:name":t},s="",a=0;n=n.replace(/"[$]"/g,"$");t:{if(n.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+n),n=n.slice(0,n.indexOf(";"))),n=="@"){e="text",r="<number:text-content/>";break t}if(n.indexOf(/\$/)>-1&&(e="currency"),n[a]=='"'){for(s="";n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,n[a+1]=="*"?(a++,r+="<number:fill-character>"+$e(s.replace(/""/g,'"'))+"</number:fill-character>"):r+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>",n=n.slice(a+1),a=0}var l=n.match(/# (\?+)\/(\?+)/);if(l){r+=se("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break t}if(l=n.match(/# (\?+)\/(\d+)/)){r+=se("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break t}if(l=n.match(/\b(\d+)(|\.\d+)%/)){e="percentage",r+=se("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break t}var u=!1;if(["y","m","d"].indexOf(n[0])>-1){e="date";e:for(;a<n.length;++a)switch(s=n[a].toLowerCase()){case"h":case"s":u=!0,--a;break e;case"m":n:for(var f=a+1;f<n.length;++f)switch(n[f]){case"y":case"d":break n;case"h":case"s":u=!0,--a;break e}case"y":case"d":for(;(n[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"y":case"yy":r+="<number:year/>";break;case"yyy":case"yyyy":r+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":r+='<number:month number:style="'+(s.length%2?"short":"long")+'" number:textual="'+(s.length>=3?"true":"false")+'"/>';break;case"d":case"dd":r+='<number:day number:style="'+(s.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":r+='<number:day-of-week number:style="'+(s.length%2?"short":"long")+'"/>';break}break;case'"':for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,r+="<number:text>"+$e(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":s=n[++a],r+="<number:text>"+$e(s)+"</number:text>";break;case"/":case":":r+="<number:text>"+$e(s)+"</number:text>";break;default:console.error("unrecognized character "+s+" in ODF format "+n)}if(!u)break t;n=n.slice(a+1),a=0}if(n.match(/^\[?[hms]/)){for(e=="number"&&(e="time"),n.match(/\[/)&&(n=n.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");a<n.length;++a)switch(s=n[a].toLowerCase()){case"h":case"m":case"s":for(;(n[++a]||"").toLowerCase()==s[0];)s+=s[0];switch(--a,s){case"h":case"hh":r+='<number:hours number:style="'+(s.length%2?"short":"long")+'"/>';break;case"m":case"mm":r+='<number:minutes number:style="'+(s.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(n[a+1]==".")do s+=n[a+1],++a;while(n[a+1]=="0");r+='<number:seconds number:style="'+(s.match("ss")?"long":"short")+'"'+(s.match(/\./)?' number:decimal-places="'+(s.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,r+="<number:text>"+$e(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":r+="<number:text>"+$e(s)+"</number:text>";break;case"a":if(n.slice(a,a+3).toLowerCase()=="a/p"){r+="<number:am-pm/>",a+=2;break}if(n.slice(a,a+5).toLowerCase()=="am/pm"){r+="<number:am-pm/>",a+=4;break}default:console.error("unrecognized character "+s+" in ODF format "+n)}break t}if(n.indexOf(/\$/)>-1&&(e="currency"),n[0]=="$"&&(r+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',n=n.slice(1),a=0),a=0,n[a]=='"'){for(;n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,n[a+1]=="*"?(a++,r+="<number:fill-character>"+$e(s.replace(/""/g,'"'))+"</number:fill-character>"):r+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>",n=n.slice(a+1),a=0}var d=n.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+n);else{var p=d[1].replace(/,/g,"");r+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(p.indexOf("0")==-1?"0":p.length-p.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",a=d.index+d[0].length}if(n[a]=='"'){for(s="";n[++a]!='"'||n[++a]=='"';)s+=n[a];--a,r+="<number:text>"+$e(s.replace(/""/g,'"'))+"</number:text>"}}return r?se("number:"+e+"-style",r,i):(console.error("Could not generate ODS number format for |"+n+"|"),"")}function nC(n,t,e){for(var r=[],i=0;i<n.length;++i){var s=n[i];s&&s.Sheet==(e==-1?null:e)&&r.push(s)}return r.length?`      <table:named-expressions>
`+r.map(function(a){var l=(e==-1?"$":"")+$N(a.Ref);return"        "+se("table:named-range",null,{"table:name":a.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var rC=function(){var n=function(i,s){return $e(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=function(i,s,a,l,u,f){var d=[];d.push('      <table:table table:name="'+$e(s.SheetNames[a])+`" table:style-name="ta1">
`);var p=0,m=0,v=Hr(i["!ref"]||"A1"),x=i["!merges"]||[],_=0,y=i["!data"]!=null;if(i["!cols"])for(m=0;m<=v.e.c;++m)d.push("        <table:table-column"+(i["!cols"][m]?' table:style-name="co'+i["!cols"][m].ods+'"':"")+`></table:table-column>
`);var w="",S=i["!rows"]||[];for(p=0;p<v.s.r;++p)w=S[p]?' table:style-name="ro'+S[p].ods+'"':"",d.push("        <table:table-row"+w+`></table:table-row>
`);for(;p<=v.e.r;++p){for(w=S[p]?' table:style-name="ro'+S[p].ods+'"':"",d.push("        <table:table-row"+w+`>
`),m=0;m<v.s.c;++m)d.push(t);for(;m<=v.e.c;++m){var T=!1,C={},R="";for(_=0;_!=x.length;++_)if(!(x[_].s.c>m)&&!(x[_].s.r>p)&&!(x[_].e.c<m)&&!(x[_].e.r<p)){(x[_].s.c!=m||x[_].s.r!=p)&&(T=!0),C["table:number-columns-spanned"]=x[_].e.c-x[_].s.c+1,C["table:number-rows-spanned"]=x[_].e.r-x[_].s.r+1;break}if(T){d.push(`          <table:covered-table-cell/>
`);continue}var N=Vn({r:p,c:m}),D=y?(i["!data"][p]||[])[m]:i[N];if(D&&D.f&&(C["table:formula"]=$e(mq(D.f)),D.F&&D.F.slice(0,N.length)==N)){var I=Hr(D.F);C["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,C["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!D){d.push(t);continue}switch(D.t){case"b":R=D.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=D.v?"true":"false";break;case"n":isFinite(D.v)?(R=D.w||String(D.v||0),C["office:value-type"]="float",C["office:value"]=D.v||0):(isNaN(D.v)?(R="#NUM!",C["table:formula"]="of:=#NUM!"):(R="#DIV/0!",C["table:formula"]="of:="+(D.v<0?"-":"")+"1/0"),C["office:string-value"]="",C["office:value-type"]="string",C["calcext:value-type"]="error");break;case"s":case"str":R=D.v==null?"":D.v,C["office:value-type"]="string";break;case"d":R=D.w||Wi(D.v,f).toISOString(),C["office:value-type"]="date",C["office:date-value"]=Wi(D.v,f).toISOString(),C["table:style-name"]="ce1";break;default:d.push(t);continue}var M=n(R);if(D.l&&D.l.Target){var B=D.l.Target;B=B.charAt(0)=="#"?"#"+$N(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),M=se("text:a",M,{"xlink:href":B.replace(/&/g,"&amp;")})}u[D.z]&&(C["table:style-name"]="ce"+u[D.z].slice(1));var H=se("text:p",M,{});if(D.c){for(var F="",rt="",L={},it=0;it<D.c.length;++it)!F&&D.c[it].a&&(F=D.c[it].a),rt+="<text:p>"+n(D.c[it].t)+"</text:p>";D.c.hidden||(L["office:display"]=!0),H=se("office:annotation",rt,L)+H}d.push("          "+se("table:table-cell",H,C)+`
`)}d.push(`        </table:table-row>
`)}return(s.Workbook||{}).Names&&d.push(nC(s.Workbook.Names,s.SheetNames,a)),d.push(`      </table:table>
`),d.join("")},r=function(i,s){i.push(` <office:automatic-styles>
`);var a=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var m=d["!cols"][p];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Pb(m),m.ods=a;var v=d["!cols"][p].wpx+"px";i.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),i.push(`  </style:style>
`),++a}}});var l=0;s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=l;var m=d["!rows"][p].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u={},f=69;return s.SheetNames.map(function(d){return s.Sheets[d]}).forEach(function(d){if(d){var p=d["!data"]!=null;if(d["!ref"])for(var m=Hr(d["!ref"]),v=0;v<=m.e.r;++v)for(var x=0;x<=m.e.c;++x){var _=p?(d["!data"][v]||[])[x]:d[Vn({r:v,c:x})];if(!(!_||!_.z||_.z.toLowerCase()=="general")&&!u[_.z]){var y=YX(_.z,"N"+f);y&&(u[_.z]="N"+f,++f,i.push(y+`
`))}}}}),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),hr(u).forEach(function(d){i.push('<style:style style:name="ce'+u[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+u[d]+`"/>
`)}),i.push(` </office:automatic-styles>
`),u};return function(s,a){var l=[pr],u=Yd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Yd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(gN().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+u+`>
`);var d=r(l,s);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((s.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var p=0;p!=s.SheetNames.length;++p)l.push(e(s.Sheets[s.SheetNames[p]],s,p,a,d,((s.Workbook||{}).WBProps||{}).date1904));return(s.Workbook||{}).Names&&l.push(nC(s.Workbook.Names,s.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function JN(n,t){if(t.bookType=="fods")return rC(n,t);var e=Sb(),r="",i=[],s=[];return r="mimetype",He(e,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",He(e,r,rC(n,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",He(e,r,qX(n,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",He(e,r,pr+gN()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",He(e,r,W$(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",He(e,r,G$(i)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var Ai=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function Cg(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function Qd(n){return typeof TextDecoder<"u"?new TextDecoder().decode(n):tf(Pc(n))}function bi(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):os(qd(n))}function Ml(n){for(var t=0,e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0;e<n.length;++e){var s=n[e],a=s.length;if(a<250)for(var l=0;l<a;++l)r[i++]=s[l];else r.set(s,i),i+=a}return r}function XX(n,t,e){var r=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-16,i=e/Math.pow(10,r-6176);n[t+15]|=r>>7,n[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)n[t+s]=i&255;n[t+15]|=e>=0?0:128}function Jd(n,t){var e=t.l,r=n[e]&127;t:if(n[e++]>=128&&(r|=(n[e]&127)<<7,n[e++]<128||(r|=(n[e]&127)<<14,n[e++]<128)||(r|=(n[e]&127)<<21,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,28),++e,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,35),++e,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,42),++e,n[e++]<128)))break t;return t.l=e,r}function me(n){var t=new Uint8Array(7);t[0]=n&127;var e=1;t:if(n>127){if(t[e-1]|=128,t[e]=n>>7&127,++e,n<=16383||(t[e-1]|=128,t[e]=n>>14&127,++e,n<=2097151)||(t[e-1]|=128,t[e]=n>>21&127,++e,n<=268435455)||(t[e-1]|=128,t[e]=n/256>>>21&127,++e,n<=34359738367)||(t[e-1]|=128,t[e]=n/65536>>>21&127,++e,n<=4398046511103))break t;t[e-1]|=128,t[e]=n/16777216>>>21&127,++e}return t[Ai](0,e)}function tk(n){for(var t={l:0},e=[];t.l<n.length;)e.push(Jd(n,t));return e}function ek(n){return Ml(n.map(function(t){return me(t)}))}function fs(n){var t=0,e=n[t]&127;return n[t++]<128||(e|=(n[t]&127)<<7,n[t++]<128)||(e|=(n[t]&127)<<14,n[t++]<128)||(e|=(n[t]&127)<<21,n[t++]<128)||(e|=(n[t]&15)<<28),e}function Ee(n){for(var t=[],e={l:0};e.l<n.length;){var r=e.l,i=Jd(n,e),s=i&7;i=i/8|0;var a,l=e.l;switch(s){case 0:{for(;n[l++]>=128;);a=n[Ai](e.l,l),e.l=l}break;case 1:a=n[Ai](l,l+8),e.l=l+8;break;case 2:{var u=Jd(n,e);a=n[Ai](e.l,e.l+u),e.l+=u}break;case 5:a=n[Ai](l,l+4),e.l=l+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var f={data:a,type:s};t[i]==null&&(t[i]=[]),t[i].push(f)}return t}function ge(n){var t=[];return n.forEach(function(e,r){r!=0&&e.forEach(function(i){i.data&&(t.push(me(r*8+i.type)),i.type==2&&t.push(me(i.data.length)),t.push(i.data))})}),Ml(t)}function Dg(n,t){return n?.map(function(e){return t(e.data)})||[]}function Og(n){for(var t,e=[],r={l:0};r.l<n.length;){var i=Jd(n,r),s=Ee(n[Ai](r.l,r.l+i));r.l+=i;var a={id:fs(s[1][0].data),messages:[]};s[2].forEach(function(l){var u=Ee(l.data),f=fs(u[3][0].data);a.messages.push({meta:u,data:n[Ai](r.l,r.l+f)}),r.l+=f}),(t=s[3])!=null&&t[0]&&(a.merge=fs(s[3][0].data)>>>0>0),e.push(a)}return e}function rf(n){var t=[];return n.forEach(function(e){var r=[[],[{data:me(e.id),type:0}],[]];e.merge!=null&&(r[3]=[{data:me(+!!e.merge),type:0}]);var i=[];e.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:me(a.data.length)}],r[2].push({data:ge(a.meta),type:2})});var s=ge(r);t.push(me(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),Ml(t)}function KX(n,t){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var e={l:0},r=Jd(t,e),i=[],s=e.l;s<t.length;){var a=t[s]&3;if(a==0){var l=t[s++]>>2;if(l<60)++l;else{var u=l-59;l=t[s],u>1&&(l|=t[s+1]<<8),u>2&&(l|=t[s+2]<<16),u>3&&(l|=t[s+3]<<24),l>>>=0,l++,s+=u}i.push(t[Ai](s,s+l)),s+=l;continue}else{var f=0,d=0;if(a==1?(d=(t[s]>>2&7)+4,f=(t[s++]&224)<<3,f|=t[s++]):(d=(t[s++]>>2)+1,a==2?(f=t[s]|t[s+1]<<8,s+=2):(f=(t[s]|t[s+1]<<8|t[s+2]<<16|t[s+3]<<24)>>>0,s+=4)),f==0)throw new Error("Invalid offset 0");for(var p=i.length-1,m=f;p>=0&&m>=i[p].length;)m-=i[p].length,--p;if(p<0)if(m==0)m=i[p=0].length;else throw new Error("Invalid offset beyond length");if(d<m)i.push(i[p][Ai](i[p].length-m,i[p].length-m+d));else{for(m>0&&(i.push(i[p][Ai](i[p].length-m)),d-=m),++p;d>=i[p].length;)i.push(i[p]),d-=i[p].length,++p;d&&i.push(i[p][Ai](0,d))}i.length>25&&(i=[Ml(i)])}}for(var v=0,x=0;x<i.length;++x)v+=i[x].length;if(v!=r)throw new Error("Unexpected length: ".concat(v," != ").concat(r));return i}function Rg(n){Array.isArray(n)&&(n=new Uint8Array(n));for(var t=[],e=0;e<n.length;){var r=n[e++],i=n[e]|n[e+1]<<8|n[e+2]<<16;e+=3,t.push.apply(t,KX(r,n[Ai](e,e+i))),e+=i}if(e!==n.length)throw new Error("data is not a valid framed stream!");return t.length==1?t[0]:Ml(t)}function sf(n){for(var t=[],e=0;e<n.length;){var r=Math.min(n.length-e,268435455),i=new Uint8Array(4);t.push(i);var s=me(r),a=s.length;t.push(s),r<=60?(a++,t.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(n[Ai](e,e+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,e+=r}return Ml(t)}function vx(n,t){var e=new Uint8Array(32),r=Cg(e),i=12,s=0;switch(e[0]=5,n.t){case"n":if(n.z&&Fc(n.z)){e[1]=5,r.setFloat64(i,(Ju(n.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,i+=8;break}else e[1]=2,XX(e,i,n.v),s|=1,i+=16;break;case"b":e[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=2,i+=8;break;case"s":{var a=n.v==null?"":String(n.v);if(n.l){var l=t.rsst.findIndex(function(f){var d;return f.v==a&&f.l==((d=n.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:a,l:n.l.Target}),e[1]=9,r.setUint32(i,l,!0),s|=16,i+=4}else{var u=t.sst.indexOf(a);u==-1&&(t.sst[u=t.sst.length]=a),e[1]=3,r.setUint32(i,u,!0),s|=8,i+=4}}break;case"d":e[1]=5,r.setFloat64(i,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,i+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+n.t}return n.c&&(t.cmnt.push(ZX(n.c)),r.setUint32(i,t.cmnt.length-1,!0),s|=524288,i+=4),r.setUint32(8,s,!0),e[Ai](0,i)}function _x(n,t){var e=new Uint8Array(32),r=Cg(e),i=12,s=0,a="";switch(e[0]=4,n.t){case"n":break;case"b":break;case"s":if(a=n.v==null?"":String(n.v),n.l){var l=t.rsst.findIndex(function(f){var d;return f.v==a&&f.l==((d=n.l)==null?void 0:d.Target)});l==-1&&(t.rsst[l=t.rsst.length]={v:a,l:n.l.Target}),e[1]=9,r.setUint32(i,l,!0),s|=512,i+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+n.t}switch(n.c&&(r.setUint32(i,t.cmnt.length-1,!0),s|=4096,i+=4),n.t){case"n":e[1]=2,r.setFloat64(i,n.v,!0),s|=32,i+=8;break;case"b":e[1]=6,r.setFloat64(i,n.v?1:0,!0),s|=32,i+=8;break;case"s":if(a=n.v==null?"":String(n.v),!n.l){var u=t.sst.indexOf(a);u==-1&&(t.sst[u=t.sst.length]=a),e[1]=3,r.setUint32(i,u,!0),s|=16,i+=4}break;case"d":e[1]=5,r.setFloat64(i,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=64,i+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,s,!0),e[Ai](0,i)}function cr(n){var t=Ee(n);return fs(t[1][0].data)}function ni(n){return ge([[],[{type:0,data:me(n)}]])}function ei(n,t){var e,r=(e=n.messages[0].meta[5])!=null&&e[0]?tk(n.messages[0].meta[5][0].data):[],i=r.indexOf(t);i==-1&&(r.push(t),n.messages[0].meta[5]=[{type:2,data:ek(r)}])}function Do(n,t){var e,r=(e=n.messages[0].meta[5])!=null&&e[0]?tk(n.messages[0].meta[5][0].data):[];n.messages[0].meta[5]=[{type:2,data:ek(r.filter(function(i){return i!=t}))}]}function ZX(n){for(var t={a:"",t:"",replies:[]},e=0;e<n.length;++e)e==0?(t.a=n[e].a,t.t=n[e].t):t.replies.push({a:n[e].a,t:n[e].t});return t}function QX(n,t,e){var r,i,s,a=[[],[{type:0,data:me(0)}],[{type:0,data:me(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:me(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:me(1)}]];if(!((r=a[6])!=null&&r[0])||!((i=a[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(a[7][0].data.length<2*n.length){var u=new Uint8Array(2*n.length);u.set(a[7][0].data),a[7][0].data=u}if(a[4][0].data.length<2*n.length){var f=new Uint8Array(2*n.length);f.set(a[4][0].data),a[4][0].data=f}for(var d=Cg(a[7][0].data),p=0,m=[],v=Cg(a[4][0].data),x=0,_=[],y=4,w=0;w<n.length;++w){if(n[w]==null||n[w].t=="z"&&!((s=n[w].c)!=null&&s.length)||n[w].t=="e"){d.setUint16(w*2,65535,!0),v.setUint16(w*2,65535);continue}d.setUint16(w*2,p/y,!0),v.setUint16(w*2,x/y,!0);var S,T;switch(n[w].t){case"d":if(n[w].v instanceof Date){S=vx(n[w],t),T=_x(n[w],t);break}S=vx(n[w],t),T=_x(n[w],t);break;case"s":case"n":case"b":case"z":S=vx(n[w],t),T=_x(n[w],t);break;default:throw new Error("Unsupported value "+n[w])}m.push(S),p+=S.length,_.push(T),x+=T.length,++l}for(a[2][0].data=me(l),a[5][0].data=me(5);w<a[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),v.setUint16(w*2,65535,!0);return a[6][0].data=Ml(m),a[3][0].data=Ml(_),a[8]=[{type:0,data:me(1)}],a}function ny(n,t){return{meta:[[],[{type:0,data:me(n)}]],data:t}}function za(n,t){t.last||(t.last=927262);for(var e=t.last;e<2e6;++e)if(!t[e])return t[t.last=e]=n,e;throw new Error("Too many messages")}function JX(n){var t={},e=[];return n.FileIndex.map(function(r,i){return[r,n.FullPaths[i]]}).forEach(function(r){var i=r[0],s=r[1];i.type==2&&i.name.match(/\.iwa/)&&i.content[0]==0&&Og(Rg(i.content)).forEach(function(a){e.push(a.id),t[a.id]={deps:[],location:s,type:fs(a.messages[0].meta[1][0].data)}})}),n.FileIndex.forEach(function(r){r.name.match(/\.iwa/)&&r.content[0]==0&&Og(Rg(r.content)).forEach(function(i){i.messages.forEach(function(s){[5,6].forEach(function(a){s.meta[a]&&s.meta[a].forEach(function(l){t[i.id].deps.push(fs(l.data))})})})})}),t}function Dm(n,t,e){return ge([[],[{type:0,data:me(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([n/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:me(1)}]])}function iC(n){switch(n){case 0:return Dm(99,222,171);case 1:return Dm(162,197,240);case 2:return Dm(255,189,189)}return Dm(Math.random()*255,Math.random()*255,Math.random()*255)}function tK(n,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=Rn.read(t.numbers,{type:"base64"}),r=JX(e),i=ja(e,r,1);if(i==null)throw"Could not find message ".concat(1," in Numbers template");var s=Dg(Ee(i.messages[0].data)[1],cr);if(s.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return n.SheetNames.forEach(function(a,l){l>=1&&(nK(e,r,l+1),i=ja(e,r,1),s=Dg(Ee(i.messages[0].data)[1],cr)),rK(e,r,n.Sheets[a],a,l,s[l])}),e}function _n(n,t,e,r){var i=Rn.find(n,t[e].location);if(!i)throw"Could not find ".concat(t[e].location," in Numbers template");var s=Og(Rg(i.content)),a=s.find(function(l){return l.id==e});r(a,s),i.content=sf(rf(s)),i.size=i.content.length}function ja(n,t,e){var r=Rn.find(n,t[e].location);if(!r)throw"Could not find ".concat(t[e].location," in Numbers template");var i=Og(Rg(r.content)),s=i.find(function(a){return a.id==e});return s}function ry(n,t,e){n[3].push({type:2,data:ge([[],[{type:0,data:me(t)}],[{type:2,data:bi(e.replace(/-[\s\S]*$/,""))}],[{type:2,data:bi(e)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(0)}]])}),n[1]=[{type:0,data:me(Math.max(t+1,fs(n[1][0].data)))}]}function pc(n,t,e,r,i,s){s||(s=za({deps:[],location:"",type:t},i));var a="".concat(r,"-").concat(s,".iwa");i[s].location="Root Entry"+a,Rn.utils.cfb_add(n,a,sf(rf([{id:s,messages:[ny(t,ge(e))]}])));var l=a.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return _n(n,i,2,function(u){var f=Ee(u.messages[0].data);ry(f,s||0,l),u.messages[0].data=ge(f)}),s}function Hi(n,t,e,r){var i=t[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=n[3].findIndex(function(l){var u,f,d=Ee(l.data);return(u=d[3])!=null&&u[0]?Qd(d[3][0].data)==i:!!((f=d[2])!=null&&f[0]&&Qd(d[2][0].data)==i)}),a=Ee(n[3][s].data);a[6]||(a[6]=[]),(Array.isArray(r)?r:[r]).forEach(function(l){a[6].push({type:2,data:ge([[],[{type:0,data:me(l)}]])})}),n[3][s].data=ge(a)}function eK(n,t,e,r){var i=t[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=n[3].findIndex(function(l){var u,f,d=Ee(l.data);return(u=d[3])!=null&&u[0]?Qd(d[3][0].data)==i:!!((f=d[2])!=null&&f[0]&&Qd(d[2][0].data)==i)}),a=Ee(n[3][s].data);a[6]||(a[6]=[]),a[6]=a[6].filter(function(l){return fs(Ee(l.data)[1][0].data)!=r}),n[3][s].data=ge(a)}function nK(n,t,e){var r=-1,i=-1,s={};_n(n,t,1,function(u,f){var d=Ee(u.messages[0].data);r=cr(Ee(u.messages[0].data)[1][0].data),i=za({deps:[1],location:t[r].location,type:2},t),s[r]=i,ei(u,i),d[1].push({type:2,data:ni(i)});var p=ja(n,t,r);p.id=i,t[1].location==t[i].location?f.push(p):_n(n,t,i,function(m,v){return v.push(p)}),u.messages[0].data=ge(d)});var a=-1;_n(n,t,i,function(u,f){for(var d=Ee(u.messages[0].data),p=3;p<=69;++p)delete d[p];var m=Dg(d[2],cr);m.forEach(function(x){return Do(u,x)}),a=za({deps:[i],location:t[m[0]].location,type:t[m[0]].type},t),ei(u,a),s[m[0]]=a,d[2]=[{type:2,data:ni(a)}];var v=ja(n,t,m[0]);v.id=a,t[m[0]].location==t[i].location?f.push(v):(_n(n,t,2,function(x){var _=Ee(x.messages[0].data);Hi(_,t,i,a),x.messages[0].data=ge(_)}),_n(n,t,a,function(x,_){return _.push(v)})),u.messages[0].data=ge(d)});var l=-1;_n(n,t,a,function(u,f){for(var d=Ee(u.messages[0].data),p=Ee(d[1][0].data),m=3;m<=69;++m)delete p[m];var v=cr(p[2][0].data);p[2][0].data=ni(s[v]),d[1][0].data=ge(p);var x=cr(d[2][0].data);Do(u,x),l=za({deps:[a],location:t[x].location,type:t[x].type},t),ei(u,l),s[x]=l,d[2][0].data=ni(l);var _=ja(n,t,x);_.id=l,t[a].location==t[l].location?f.push(_):_n(n,t,l,function(y,w){return w.push(_)}),u.messages[0].data=ge(d)}),_n(n,t,l,function(u,f){var d,p,m=Ee(u.messages[0].data),v=Qd(m[1][0].data),x=v.replace(/-[A-Z0-9]*/,"-".concat(("0000"+e.toString(16)).slice(-4)));if(m[1][0].data=bi(x),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(R){return delete m[R]}),m[45]){var _=Ee(m[45][0].data),y=cr(_[1][0].data);Do(u,y),delete m[45]}if(m[70]){var w=Ee(m[70][0].data);(d=w[2])==null||d.forEach(function(R){var N=Ee(R.data);[2,3].map(function(D){return N[D][0]}).forEach(function(D){var I=Ee(D.data);if(I[8]){var M=cr(I[8][0].data);Do(u,M)}})}),delete m[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(R){if(m[R]){var N=cr(m[R][0].data);delete m[R],Do(u,N)}});var S=Ee(m[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(R){var N;if((N=S[R])!=null&&N[0]){var D=cr(S[R][0].data),I=za({deps:[l],location:t[D].location,type:t[D].type},t);Do(u,D),ei(u,I),s[D]=I;var M=ja(n,t,D);if(M.id=I,t[D].location==t[l].location)f.push(M);else{t[I].location=t[D].location.replace(D.toString(),I.toString()),t[I].location==t[D].location&&(t[I].location=t[I].location.replace(/\.iwa/,"-".concat(I,".iwa"))),Rn.utils.cfb_add(n,t[I].location,sf(rf([M])));var B=t[I].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");_n(n,t,2,function(H){var F=Ee(H.messages[0].data);ry(F,I,B),Hi(F,t,l,I),H.messages[0].data=ge(F)})}S[R][0].data=ni(I)}});var T=Ee(S[1][0].data);(p=T[2])==null||p.forEach(function(R){var N=cr(R.data),D=za({deps:[l],location:t[N].location,type:t[N].type},t);Do(u,N),ei(u,D),s[N]=D;var I=ja(n,t,N);if(I.id=D,t[N].location==t[l].location)f.push(I);else{t[D].location=t[N].location.replace(N.toString(),D.toString()),t[D].location==t[N].location&&(t[D].location=t[D].location.replace(/\.iwa/,"-".concat(D,".iwa"))),Rn.utils.cfb_add(n,t[D].location,sf(rf([I])));var M=t[D].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");_n(n,t,2,function(B){var H=Ee(B.messages[0].data);ry(H,D,M),Hi(H,t,l,D),B.messages[0].data=ge(H)})}R.data=ni(D)}),S[1][0].data=ge(T);var C=Ee(S[3][0].data);C[1].forEach(function(R){var N=Ee(R.data),D=cr(N[2][0].data),I=s[D];if(!s[D]){I=za({deps:[l],location:"",type:t[D].type},t),t[I].location="Root Entry/Index/Tables/Tile-".concat(I,".iwa"),s[D]=I;var M=ja(n,t,D);M.id=I,Do(u,D),ei(u,I),Rn.utils.cfb_add(n,"/Index/Tables/Tile-".concat(I,".iwa"),sf(rf([M]))),_n(n,t,2,function(B){var H=Ee(B.messages[0].data);H[3].push({type:2,data:ge([[],[{type:0,data:me(I)}],[{type:2,data:bi("Tables/Tile")}],[{type:2,data:bi("Tables/Tile-".concat(I))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(0)}]])}),H[1]=[{type:0,data:me(Math.max(I+1,fs(H[1][0].data)))}],Hi(H,t,l,I),B.messages[0].data=ge(H)})}N[2][0].data=ni(I),R.data=ge(N)}),S[3][0].data=ge(C)}m[4][0].data=ge(S),u.messages[0].data=ge(m)})}function rK(n,t,e,r,i,s){var a=[];_n(n,t,s,function(f){var d=Ee(f.messages[0].data);d[1]=[{type:2,data:bi(r)}],a=Dg(d[2],cr),f.messages[0].data=ge(d)});var l=ja(n,t,a[0]),u=cr(Ee(l.messages[0].data)[2][0].data);_n(n,t,u,function(f,d){return iK(n,t,e,f,d,u)})}function iK(n,t,e,r,i,s){if(!e["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var a=Hr(e["!ref"]);a.s.r=a.s.c=0;var l=!1;a.e.c>999&&(l=!0,a.e.c=999),a.e.r>999999&&(l=!0,a.e.r=999999),l&&console.error("Truncating to ".concat(dr(a)));var u=[];if(e["!data"])u=e["!data"];else{for(var f=[],d=0;d<=a.e.c;++d)f[d]=xn(d);for(var p=0;p<=a.e.r;++p){u[p]=[];var m=""+(p+1);for(d=0;d<=a.e.c;++d){var v=e[f[d]+m];v&&(u[p][d]=v)}}}var x={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},_=Ee(r.messages[0].data);{_[6][0].data=me(a.e.r+1),_[7][0].data=me(a.e.c+1),delete _[46];var y=Ee(_[4][0].data);{var w=cr(Ee(y[1][0].data)[2][0].data);_n(n,t,w,function(j,et){var dt,xt=Ee(j.messages[0].data);if((dt=xt?.[2])!=null&&dt[0])for(var Nt=0;Nt<u.length;++Nt){var Rt=Ee(xt[2][0].data);Rt[1][0].data=me(Nt),Rt[4][0].data=me(u[Nt].length),xt[2][Nt]={type:xt[2][0].type,data:ge(Rt)}}j.messages[0].data=ge(xt)});var S=cr(y[2][0].data);_n(n,t,S,function(j,et){for(var dt=Ee(j.messages[0].data),xt=0;xt<=a.e.c;++xt){var Nt=Ee(dt[2][0].data);Nt[1][0].data=me(xt),Nt[4][0].data=me(a.e.r+1),dt[2][xt]={type:dt[2][0].type,data:ge(Nt)}}j.messages[0].data=ge(dt)});var T=Ee(y[9][0].data);T[1]=[];var C=Ee(y[3][0].data);{var R=256;C[2]=[{type:0,data:me(R)}];var N=cr(Ee(C[1][0].data)[2][0].data),D=function(){var j=ja(n,t,2),et=Ee(j.messages[0].data),dt=et[3].filter(function(xt){return fs(Ee(xt.data)[1][0].data)==N});return dt?.length?fs(Ee(dt[0].data)[12][0].data):0}();Rn.utils.cfb_del(n,t[N].location),_n(n,t,2,function(j){var et=Ee(j.messages[0].data);et[3]=et[3].filter(function(dt){return fs(Ee(dt.data)[1][0].data)!=N}),eK(et,t,s,N),j.messages[0].data=ge(et)}),Do(r,N),C[1]=[];for(var I=Math.ceil((a.e.r+1)/R),M=0;M<I;++M){var B=za({deps:[],location:"",type:6002},t);t[B].location="Root Entry/Index/Tables/Tile-".concat(B,".iwa");for(var H=[[],[{type:0,data:me(0)}],[{type:0,data:me(Math.min(a.e.r+1,(M+1)*R))}],[{type:0,data:me(0)}],[{type:0,data:me(Math.min((M+1)*R,a.e.r+1)-M*R)}],[],[{type:0,data:me(5)}],[{type:0,data:me(1)}],[{type:0,data:me(1)}]],F=M*R;F<=Math.min(a.e.r,(M+1)*R-1);++F){var rt=QX(u[F],x);rt[1][0].data=me(F-M*R),H[5].push({data:ge(rt),type:2})}C[1].push({type:2,data:ge([[],[{type:0,data:me(M)}],[{type:2,data:ni(B)}]])});var L={id:B,messages:[ny(6002,ge(H))]},it=sf(rf([L]));Rn.utils.cfb_add(n,"/Index/Tables/Tile-".concat(B,".iwa"),it),_n(n,t,2,function(j){var et=Ee(j.messages[0].data);et[3].push({type:2,data:ge([[],[{type:0,data:me(B)}],[{type:2,data:bi("Tables/Tile")}],[{type:2,data:bi("Tables/Tile-".concat(B))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:me(0)}],[],[{type:0,data:me(D)}]])}),et[1]=[{type:0,data:me(Math.max(B+1,fs(et[1][0].data)))}],Hi(et,t,s,B),j.messages[0].data=ge(et)}),ei(r,B),T[1].push({type:2,data:ge([[],[{type:0,data:me(M*R)}],[{type:0,data:me(M)}]])})}}if(y[3][0].data=ge(C),y[9][0].data=ge(T),y[10]=[{type:2,data:new Uint8Array([])}],e["!merges"]){var Z=za({type:6144,deps:[s],location:t[s].location},t);i.push({id:Z,messages:[ny(6144,ge([[],e["!merges"].map(function(j){return{type:2,data:ge([[],[{type:2,data:ge([[],[{type:5,data:new Uint8Array(new Uint16Array([j.s.r,j.s.c]).buffer)}]])}],[{type:2,data:ge([[],[{type:5,data:new Uint8Array(new Uint16Array([j.e.r-j.s.r+1,j.e.c-j.s.c+1]).buffer)}]])}]])}})]))]}),y[13]=[{type:2,data:ni(Z)}],_n(n,t,2,function(j){var et=Ee(j.messages[0].data);Hi(et,t,s,Z),j.messages[0].data=ge(et)}),ei(r,Z)}else delete y[13];var q=cr(y[4][0].data);_n(n,t,q,function(j){var et=Ee(j.messages[0].data);et[3]=[],x.sst.forEach(function(dt,xt){xt!=0&&et[3].push({type:2,data:ge([[],[{type:0,data:me(xt)}],[{type:0,data:me(1)}],[{type:2,data:bi(dt)}]])})}),j.messages[0].data=ge(et)});var Ct=cr(y[17][0].data);if(_n(n,t,Ct,function(j){var et=Ee(j.messages[0].data);et[3]=[];var dt=[904980,903835,903815,903845];x.rsst.forEach(function(xt,Nt){if(Nt!=0){var Rt=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:bi(xt.v)}]];Rt[10]=[{type:0,data:new Uint8Array([1])}],Rt[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Rt[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Rt[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Rt[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Rt[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Rt[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Rt[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Rt[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var z=za({deps:[],location:"",type:2001},t),lt=[];if(xt.l){var J=pc(n,2032,[[],[],[{type:2,data:bi(xt.l)}]],"/Index/Tables/DataList",t);Rt[11]=[];var ot=[[],[]];ot[1]||(ot[1]=[]),ot[1].push({type:2,data:ge([[],[{type:0,data:me(0)}],[{type:2,data:ni(J)}]])}),Rt[11][0]={type:2,data:ge(ot)},lt.push(J)}pc(n,2001,Rt,"/Index/Tables/DataList",t,z),_n(n,t,z,function(At){dt.forEach(function(O){return ei(At,O)}),lt.forEach(function(O){return ei(At,O)})});var yt=pc(n,6218,[[],[{type:2,data:ni(z)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",t);_n(n,t,yt,function(At){return ei(At,z)}),et[3].push({type:2,data:ge([[],[{type:0,data:me(Nt)}],[{type:0,data:me(1)}],[],[],[],[],[],[],[{type:2,data:ni(yt)}]])}),ei(j,yt),_n(n,t,2,function(At){var O=Ee(At.messages[0].data);Hi(O,t,Ct,yt),Hi(O,t,yt,z),Hi(O,t,z,lt),Hi(O,t,z,dt),At.messages[0].data=ge(O)})}}),j.messages[0].data=ge(et)}),x.cmnt.length>1){var at=cr(y[19][0].data),P={},V=0;_n(n,t,at,function(j){var et=Ee(j.messages[0].data);et[3]=[],x.cmnt.forEach(function(dt,xt){if(xt!=0){var Nt=[];dt.replies&&dt.replies.forEach(function(lt){P[lt.a||""]||(P[lt.a||""]=pc(n,212,[[],[{type:2,data:bi(lt.a||"")}],[{type:2,data:iC(++V)}],[],[{type:0,data:me(0)}]],"/Index/Tables/DataList",t));var J=P[lt.a||""],ot=pc(n,3056,[[],[{type:2,data:bi(lt.t||"")}],[{type:2,data:ge([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:ni(J)}]],"/Index/Tables/DataList",t);_n(n,t,ot,function(yt){return ei(yt,J)}),Nt.push(ot),_n(n,t,2,function(yt){var At=Ee(yt.messages[0].data);Hi(At,t,ot,J),yt.messages[0].data=ge(At)})}),P[dt.a||""]||(P[dt.a||""]=pc(n,212,[[],[{type:2,data:bi(dt.a||"")}],[{type:2,data:iC(++V)}],[],[{type:0,data:me(0)}]],"/Index/Tables/DataList",t));var Rt=P[dt.a||""],z=pc(n,3056,[[],[{type:2,data:bi(dt.t||"")}],[{type:2,data:ge([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:ni(Rt)}],Nt.map(function(lt){return{type:2,data:ni(lt)}}),[{type:2,data:ge([[],[{type:0,data:me(xt)}],[{type:0,data:me(0)}]])}]],"/Index/Tables/DataList",t);_n(n,t,z,function(lt){ei(lt,Rt),Nt.forEach(function(J){return ei(lt,J)})}),et[3].push({type:2,data:ge([[],[{type:0,data:me(xt)}],[{type:0,data:me(1)}],[],[],[],[],[],[],[],[{type:2,data:ni(z)}]])}),ei(j,z),_n(n,t,2,function(lt){var J=Ee(lt.messages[0].data);Hi(J,t,at,z),Hi(J,t,z,Rt),Nt.length&&Hi(J,t,z,Nt),lt.messages[0].data=ge(J)})}}),et[2][0].data=me(x.cmnt.length+1),j.messages[0].data=ge(et)})}}_[4][0].data=ge(y)}r.messages[0].data=ge(_)}function sK(n){return function(e){for(var r=0;r!=n.length;++r){var i=n[r];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function Ub(n){sK([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function aK(n,t){n&&!n.SSF&&(n.SSF=li(Ln)),n&&n.SSF&&(lv(),ov(n.SSF),t.revssf=cv(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="bin",r=!0,i=dN();Ub(t=t||{});var s=Sb(),a="",l=0;if(t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",He(s,a,vN(n.Props,t)),i.coreprops.push(a),un(t.rels,2,a,en.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var u=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(n.SheetNames[f]);n.Props.SheetNames=u}n.Props.Worksheets=n.Props.SheetNames.length,He(s,a,xN(n.Props)),i.extprops.push(a),un(t.rels,3,a,en.EXT_PROPS),n.Custprops!==n.Props&&hr(n.Custprops||{}).length>0&&(a="docProps/custom.xml",He(s,a,yN(n.Custprops)),i.custprops.push(a),un(t.rels,4,a,en.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=n.SheetNames.length;++l){var p={"!id":{}},m=n.Sheets[n.SheetNames[l-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:a="xl/worksheets/sheet"+l+"."+e,He(s,a,jY(l-1,t,n,p)),i.sheets.push(a),un(t.wbrels,-1,"worksheets/sheet"+l+"."+e,en.WS[0])}if(m){var x=m["!comments"],_=!1,y="";if(x&&x.length>0){var w=!1;x.forEach(function(T){T[1].forEach(function(C){C.T==!0&&(w=!0)})}),w&&(y="xl/threadedComments/threadedComment"+l+".xml",He(s,y,IN(x,d,t)),i.threadedcomments.push(y),un(p,-1,"../threadedComments/threadedComment"+l+".xml",en.TCMNT)),y="xl/comments"+l+"."+e,He(s,y,NV(x)),i.comments.push(y),un(p,-1,"../comments"+l+"."+e,en.CMNT),_=!0}m["!legacy"]&&_&&He(s,"xl/drawings/vmlDrawing"+l+".vml",LN(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&He(s,mN(a),ef(p))}t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,He(s,a,jG(t.Strings)),i.strs.push(a),un(t.wbrels,-1,"sharedStrings."+e,en.SST)),a="xl/workbook."+e,He(s,a,lX(n)),i.workbooks.push(a),un(t.rels,1,a,en.WB),a="xl/theme/theme1.xml";var S=kN(n.Themes,t);return He(s,a,S),i.themes.push(a),un(t.wbrels,-1,"theme/theme1.xml",en.THEME),a="xl/styles."+e,He(s,a,mV(n,t)),i.styles.push(a),un(t.wbrels,-1,"styles."+e,en.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",He(s,a,n.vbaraw),i.vba.push(a),un(t.wbrels,-1,"vbaProject.bin",en.VBA)),a="xl/metadata."+e,He(s,a,EV()),i.metadata.push(a),un(t.wbrels,-1,"metadata."+e,en.XLMETA),d.length>1&&(a="xl/persons/person.xml",He(s,a,MN(d)),i.people.push(a),un(t.wbrels,-1,"persons/person.xml",en.PEOPLE)),He(s,"[Content_Types].xml",pN(i,t)),He(s,"_rels/.rels",ef(t.rels)),He(s,"xl/_rels/workbook."+e+".rels",ef(t.wbrels)),delete t.revssf,delete t.ssf,s}function oK(n,t){n&&!n.SSF&&(n.SSF=li(Ln)),n&&n.SSF&&(lv(),ov(n.SSF),t.revssf=cv(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",r=LV.indexOf(t.bookType)>-1,i=dN();Ub(t=t||{});var s=Sb(),a="",l=0;if(t.cellXfs=[],Ul(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),a="docProps/core.xml",He(s,a,vN(n.Props,t)),i.coreprops.push(a),un(t.rels,2,a,en.CORE_PROPS),a="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var u=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(n.SheetNames[f]);n.Props.SheetNames=u}n.Props.Worksheets=n.Props.SheetNames.length,He(s,a,xN(n.Props)),i.extprops.push(a),un(t.rels,3,a,en.EXT_PROPS),n.Custprops!==n.Props&&hr(n.Custprops||{}).length>0&&(a="docProps/custom.xml",He(s,a,yN(n.Custprops)),i.custprops.push(a),un(t.rels,4,a,en.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=n.SheetNames.length;++l){var p={"!id":{}},m=n.Sheets[n.SheetNames[l-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:a="xl/worksheets/sheet"+l+"."+e,He(s,a,Dq(l-1,t,n,p)),i.sheets.push(a),un(t.wbrels,-1,"worksheets/sheet"+l+"."+e,en.WS[0])}if(m){var x=m["!comments"],_=!1,y="";if(x&&x.length>0){var w=!1;x.forEach(function(S){S[1].forEach(function(T){T.T==!0&&(w=!0)})}),w&&(y="xl/threadedComments/threadedComment"+l+".xml",He(s,y,IN(x,d,t)),i.threadedcomments.push(y),un(p,-1,"../threadedComments/threadedComment"+l+".xml",en.TCMNT)),y="xl/comments"+l+"."+e,He(s,y,CV(x)),i.comments.push(y),un(p,-1,"../comments"+l+"."+e,en.CMNT),_=!0}m["!legacy"]&&_&&He(s,"xl/drawings/vmlDrawing"+l+".vml",LN(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&He(s,mN(a),ef(p))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+e,He(s,a,FG(t.Strings,t)),i.strs.push(a),un(t.wbrels,-1,"sharedStrings."+e,en.SST)),a="xl/workbook."+e,He(s,a,YY(n)),i.workbooks.push(a),un(t.rels,1,a,en.WB),a="xl/theme/theme1.xml",He(s,a,kN(n.Themes,t)),i.themes.push(a),un(t.wbrels,-1,"theme/theme1.xml",en.THEME),a="xl/styles."+e,He(s,a,YG(n,t)),i.styles.push(a),un(t.wbrels,-1,"styles."+e,en.STY),n.vbaraw&&r&&(a="xl/vbaProject.bin",He(s,a,n.vbaraw),i.vba.push(a),un(t.wbrels,-1,"vbaProject.bin",en.VBA)),a="xl/metadata."+e,He(s,a,AV()),i.metadata.push(a),un(t.wbrels,-1,"metadata."+e,en.XLMETA),d.length>1&&(a="xl/persons/person.xml",He(s,a,MN(d)),i.people.push(a),un(t.wbrels,-1,"persons/person.xml",en.PEOPLE)),He(s,"[Content_Types].xml",pN(i,t)),He(s,"_rels/.rels",ef(t.rels)),He(s,"xl/_rels/workbook."+e+".rels",ef(t.wbrels)),delete t.revssf,delete t.ssf,s}function lK(n,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":e=Ll(n.slice(0,12));break;case"binary":e=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function nk(n,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return vp(t.file,Rn.write(n,{type:fn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Rn.write(n,t)}function cK(n,t){switch(t.bookType){case"ods":return JN(n,t);case"numbers":return tK(n,t);case"xlsb":return aK(n,t);default:return oK(n,t)}}function uK(n,t){var e=li(t||{}),r=cK(n,e);return fK(r,e)}function fK(n,t){var e={},r=fn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=r;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=n.FullPaths?Rn.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):n.generate(e);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(av(i))}return t.password&&typeof encrypt_agile<"u"?nk(encrypt_agile(i,t.password),t):t.type==="file"?vp(t.file,i):t.type=="string"?tf(i):i}function hK(n,t){var e=t||{},r=wX(n,e);return nk(r,e)}function Pa(n,t,e){e||(e="");var r=e+n;switch(t.type){case"base64":return pg(qd(r));case"binary":return qd(r);case"string":return n;case"file":return vp(t.file,r,"utf8");case"buffer":return fn?Ya(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Pa(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function dK(n,t){switch(t.type){case"base64":return dH(n);case"binary":return n;case"string":return n;case"file":return vp(t.file,n,"binary");case"buffer":return fn?Ya(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Om(n,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",r=0;r<n.length;++r)e+=String.fromCharCode(n[r]);return t.type=="base64"?pg(e):t.type=="string"?tf(e):e;case"file":return vp(t.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+t.type)}}function rk(n,t){hH(),qY(n);var e=li(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var r=rk(n,e);return e.type="array",av(r)}var i=0;if(e.sheet&&(typeof e.sheet=="number"?i=e.sheet:i=n.SheetNames.indexOf(e.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Pa(yX(n,e),e);case"slk":case"sylk":return Pa(LG.from_sheet(n.Sheets[n.SheetNames[i]],e,n),e);case"htm":case"html":return Pa(KN(n.Sheets[n.SheetNames[i]],e),e);case"txt":return dK(ik(n.Sheets[n.SheetNames[i]],e),e);case"csv":return Pa(zb(n.Sheets[n.SheetNames[i]],e),e,"\uFEFF");case"dif":return Pa(IG.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"dbf":return Om(kG.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"prn":return Pa(MG.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"rtf":return Pa($G(n.Sheets[n.SheetNames[i]]),e);case"eth":return Pa(CN.from_sheet(n.Sheets[n.SheetNames[i]],e),e);case"fods":return Pa(JN(n,e),e);case"wk1":return Om(WT.sheet_to_wk1(n.Sheets[n.SheetNames[i]],e),e);case"wk3":return Om(WT.book_to_wk3(n,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),Om(XN(n,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),hK(n,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return uK(n,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function pK(n){if(!n.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(n.bookType=e.slice(1)),n.bookType=t[n.bookType]||n.bookType}}function mK(n,t,e){var r=e||{};return r.type="file",r.file=t,pK(r),rk(n,r)}function gK(n,t,e,r,i,s,a){var l=Sn(e),u=a.defval,f=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,p=n["!data"]!=null,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:e,enumerable:!1})}catch{m.__rowNum__=e}else m.__rowNum__=e;if(!p||n["!data"][e])for(var v=t.s.c;v<=t.e.c;++v){var x=p?(n["!data"][e]||[])[v]:n[r[v]+l];if(x==null||x.t===void 0){if(u===void 0)continue;s[v]!=null&&(m[s[v]]=u);continue}var _=x.v;switch(x.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"b":case"n":if(!x.z||!Fc(x.z)||(_=Ju(_),typeof _=="number"))break;case"d":a&&(a.UTC||a.raw===!1)||(_=xf(new Date(_)));break;default:throw new Error("unrecognized type "+x.t)}if(s[v]!=null){if(_==null)if(x.t=="e"&&_===null)m[s[v]]=null;else if(u!==void 0)m[s[v]]=u;else if(f&&_===null)m[s[v]]=null;else continue;else m[s[v]]=(x.t==="n"&&typeof a.rawNumbers=="boolean"?a.rawNumbers:f)?_:jo(x,_,a);_!=null&&(d=!1)}}return{row:m,isempty:d}}function iy(n,t){if(n==null||n["!ref"]==null)return[];var e={t:"n",v:0},r=0,i=1,s=[],a=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:n["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof d){case"string":u=In(d);break;case"number":u=In(n["!ref"]),u.s.r=d;break;default:u=d}r>0&&(i=0);var p=Sn(u.s.r),m=[],v=[],x=0,_=0,y=n["!data"]!=null,w=u.s.r,S=0,T={};y&&!n["!data"][w]&&(n["!data"][w]=[]);var C=f.skipHidden&&n["!cols"]||[],R=f.skipHidden&&n["!rows"]||[];for(S=u.s.c;S<=u.e.c;++S)if(!(C[S]||{}).hidden)switch(m[S]=xn(S),e=y?n["!data"][w][S]:n[m[S]+p],r){case 1:s[S]=S-u.s.c;break;case 2:s[S]=m[S];break;case 3:s[S]=f.header[S-u.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=a=jo(e,null,f),_=T[a]||0,!_)T[a]=1;else{do l=a+"_"+_++;while(T[l]);T[a]=_,T[l]=1}s[S]=l}for(w=u.s.r+i;w<=u.e.r;++w)if(!(R[w]||{}).hidden){var N=gK(n,u,w,m,r,s,f);(N.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(v[x++]=N.row)}return v.length=x,v}var sC=/"/g;function vK(n,t,e,r,i,s,a,l,u){for(var f=!0,d=[],p="",m=Sn(e),v=n["!data"]!=null,x=v&&n["!data"][e]||[],_=t.s.c;_<=t.e.c;++_)if(r[_]){var y=v?x[_]:n[r[_]+m];if(y==null)p="";else if(y.v!=null){f=!1,p=""+(u.rawNumbers&&y.t=="n"?y.v:jo(y,null,u));for(var w=0,S=0;w!==p.length;++w)if((S=p.charCodeAt(w))===i||S===s||S===34||u.forceQuotes){p='"'+p.replace(sC,'""')+'"';break}p=="ID"&&l==0&&d.length==0&&(p='"ID"')}else y.f!=null&&!y.F?(f=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(sC,'""')+'"')):p="";d.push(p)}if(u.strip)for(;d[d.length-1]==="";)--d.length;return u.blankrows===!1&&f?null:d.join(a)}function zb(n,t){var e=[],r=t??{};if(n==null||n["!ref"]==null)return"";for(var i=In(n["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),l=r.RS!==void 0?r.RS:`
`,u=l.charCodeAt(0),f="",d=[],p=r.skipHidden&&n["!cols"]||[],m=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(d[v]=xn(v));for(var x=0,_=i.s.r;_<=i.e.r;++_)(m[_]||{}).hidden||(f=vK(n,i,_,d,a,u,s,x,r),f!=null&&(f||r.blankrows!==!1)&&e.push((x++?l:"")+f));return e.join("")}function ik(n,t){t||(t={}),t.FS="	",t.RS=`
`;var e=zb(n,t);return e}function _K(n,t){var e="",r,i="";if(n==null||n["!ref"]==null)return[];var s=In(n["!ref"]),a="",l=[],u,f=[],d=n["!data"]!=null;for(u=s.s.c;u<=s.e.c;++u)l[u]=xn(u);for(var p=s.s.r;p<=s.e.r;++p)for(a=Sn(p),u=s.s.c;u<=s.e.c;++u)if(e=l[u]+a,r=d?(n["!data"][p]||[])[u]:n[e],i="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;i=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)i=r.f;else{if(t&&t.values===!1)continue;if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)i=""+r.v;else if(r.t=="b")i=r.v?"TRUE":"FALSE";else if(r.w!==void 0)i="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?i="'"+r.v:i=""+r.v}}f[f.length]=e+"="+i}return f}function sk(n,t,e){var r=e||{},i=n?n["!data"]!=null:r.dense,s=+!r.skipHeader,a=n||{};!n&&i&&(a["!data"]=[]);var l=0,u=0;if(a&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var f=typeof r.origin=="string"?Un(r.origin):r.origin;l=f.r,u=f.c}var d={s:{c:0,r:0},e:{c:u,r:l+t.length-1+s}};if(a["!ref"]){var p=In(a["!ref"]);d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),l==-1&&(l=p.e.r+1,d.e.r=l+t.length-1+s)}else l==-1&&(l=0,d.e.r=t.length-1+s);var m=r.header||[],v=0,x=[];t.forEach(function(y,w){i&&!a["!data"][l+w+s]&&(a["!data"][l+w+s]=[]),i&&(x=a["!data"][l+w+s]),hr(y).forEach(function(S){(v=m.indexOf(S))==-1&&(m[v=m.length]=S);var T=y[S],C="z",R="",N=i?"":xn(u+v)+Sn(l+w+s),D=i?x[u+v]:a[N];T&&typeof T=="object"&&!(T instanceof Date)?i?x[u+v]=T:a[N]=T:(typeof T=="number"?C="n":typeof T=="boolean"?C="b":typeof T=="string"?C="s":T instanceof Date?(C="d",r.UTC||(T=uv(T)),r.cellDates||(C="n",T=$r(T)),R=D!=null&&D.z&&Fc(D.z)?D.z:r.dateNF||Ln[14]):T===null&&r.nullError&&(C="e",T=0),D?(D.t=C,D.v=T,delete D.w,delete D.R,R&&(D.z=R)):i?x[u+v]=D={t:C,v:T}:a[N]=D={t:C,v:T},R&&(D.z=R))})}),d.e.c=Math.max(d.e.c,u+m.length-1);var _=Sn(l);if(i&&!a["!data"][l]&&(a["!data"][l]=[]),s)for(v=0;v<m.length;++v)i?a["!data"][l][v+u]={t:"s",v:m[v]}:a[xn(v+u)+_]={t:"s",v:m[v]};return a["!ref"]=dr(d),a}function xK(n,t){return sk(null,n,t)}function Ng(n,t,e){if(typeof t=="string"){if(n["!data"]!=null){var r=Un(t);return n["!data"][r.r]||(n["!data"][r.r]=[]),n["!data"][r.r][r.c]||(n["!data"][r.r][r.c]={t:"z"})}return n[t]||(n[t]={t:"z"})}return typeof t!="number"?Ng(n,Vn(t)):Ng(n,xn(e||0)+Sn(t))}function yK(n,t){if(typeof t=="number"){if(t>=0&&n.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=n.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function bK(n,t){var e={SheetNames:[],Sheets:{}};return n&&jb(e,n,t||"Sheet1"),e}function jb(n,t,e,r){var i=1;if(!e)for(;i<=65535&&n.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(e)>=0&&e.length<32){var s=e.match(/\d+$/);i=s&&+s[0]||0;var a=s&&e.slice(0,s.index)||e;for(++i;i<=65535&&n.SheetNames.indexOf(e=a+i)!=-1;++i);}if(WN(e),n.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return n.SheetNames.push(e),n.Sheets[e]=t,e}function wK(n,t,e){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=yK(n,t);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}n.Workbook.Sheets[r].Hidden=e}function EK(n,t){return n.z=t,n}function ak(n,t,e){return t?(n.l={Target:t},e&&(n.l.Tooltip=e)):delete n.l,n}function AK(n,t,e){return ak(n,"#"+t,e)}function SK(n,t,e){n.c||(n.c=[]),n.c.push({t,a:e||"SheetJS"})}function TK(n,t,e,r){for(var i=typeof t!="string"?t:In(t),s=typeof t=="string"?t:dr(t),a=i.s.r;a<=i.e.r;++a)for(var l=i.s.c;l<=i.e.c;++l){var u=Ng(n,a,l);u.t="n",u.F=s,delete u.v,a==i.s.r&&l==i.s.c&&(u.f=e,r&&(u.D=!0))}var f=Hr(n["!ref"]);return f.s.r>i.s.r&&(f.s.r=i.s.r),f.s.c>i.s.c&&(f.s.c=i.s.c),f.e.r<i.e.r&&(f.e.r=i.e.r),f.e.c<i.e.c&&(f.e.c=i.e.c),n["!ref"]=dr(f),n}var xx={encode_col:xn,encode_row:Sn,encode_cell:Vn,encode_range:dr,decode_col:Nb,decode_row:Rb,split_cell:b$,decode_cell:Un,decode_range:Hr,format_cell:jo,sheet_new:w$,sheet_add_aoa:lN,sheet_add_json:sk,sheet_add_dom:ZN,aoa_to_sheet:kf,json_to_sheet:xK,table_to_sheet:QN,table_to_book:VX,sheet_to_csv:zb,sheet_to_txt:ik,sheet_to_json:iy,sheet_to_html:KN,sheet_to_formulae:_K,sheet_to_row_object_array:iy,sheet_get_cell:Ng,book_new:bK,book_append_sheet:jb,book_set_sheet_visibility:wK,cell_set_number_format:EK,cell_set_hyperlink:ak,cell_set_internal_link:AK,cell_add_comment:SK,sheet_set_array_formula:TK,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const CK=(n,t)=>{const e=Tf(t),r=[];return n.forEach(i=>{const s=Gi(i,e,"date"),a=Gi(i,e,"campaign");r.push({"HOLE ID":Gi(i,e,"hole_id"),X:hs(Gi(i,e,"x")),Y:hs(Gi(i,e,"y")),Z:hs(Gi(i,e,"z")),DEPTH:Qg(i,e),...s&&{DATA:s},...a&&{CAMPANHA:a}})}),r},DK=(n,t)=>{const e=Tf(t),r=[];return n.forEach(i=>{const s=Gi(i,e,"hole_id"),a=No(i,e,"nspt"),l=Qg(i,e),u=Math.ceil(l)-a.length+1;let f=0;a.forEach((d,p)=>{const m=p===0?u:p===a.length-1?l:f+1;r.push({"HOLE ID":s,from:f,to:m,NSPT:d}),f=m})}),r},OK=(n,t)=>{const e=Tf(t),r=[];return n.forEach(i=>{const s=Gi(i,e,"hole_id"),a=Qg(i,e),l=Gi(i,e,"water_level"),u=hs(l,-1);typeof u=="number"&&u>=0?u!==0?r.push({"HOLE ID":s,from:0,to:u,cond:"SECO"},{"HOLE ID":s,from:u,to:a,cond:"ÁGUA"}):r.push({"HOLE ID":s,from:0,to:a,cond:"ÁGUA"}):r.push({"HOLE ID":s,from:0,to:a,cond:"SECO"})}),r},RK=(n,t)=>{const e=Tf(t),r=[];return n.forEach(i=>{const s=Gi(i,e,"hole_id"),l=No(i,e,"depth_from_to").map(d=>hs(d)).sort((d,p)=>d-p);l.includes(0)||l.unshift(0);const f=No(i,e,"geology").filter(d=>!d.toUpperCase().startsWith("LIMITE DE SONDAGEM"));if(f.length>0){const d=f.length-1,p=f[d],m=p.toUpperCase().indexOf("LIMITE DE SONDAGEM");m!==-1&&(f[d]=p.substring(0,m).trim())}for(let d=0;d<l.length-1;d++)r.push({"HOLE ID":s,from:l[d],to:l[d+1],Descrição:f[d]||""})}),r},NK=(n,t)=>{const e=Tf(t),r=[];return n.forEach(i=>{const s=Gi(i,e,"hole_id"),l=No(i,e,"depth_from_to").map(d=>hs(d)).sort((d,p)=>d-p);l.includes(0)||l.unshift(0);const u=No(i,e,"interp"),f=[];for(let d=0;d<l.length-1;d++)f.push({"HOLE ID":s,from:l[d],to:l[d+1],"interp. geol":u[d]||""});r.push(...f)}),r},ok=(n,t)=>[t.join(";"),...n.map(r=>t.map(i=>`"${r[i]??""}"`).join(";"))].join(`
`),lk=(n,t,e)=>{switch(e){case"collar":const r=["HOLE ID","X","Y","Z","DEPTH"];return t.find(i=>i.dataType==="date")&&r.push("DATA"),t.find(i=>i.dataType==="campaign")&&r.push("CAMPANHA"),{data:CK(n,t),headers:r,filename:"collar.csv"};case"nspt":return{data:DK(n,t),headers:["HOLE ID","from","to","NSPT"],filename:"nspt.csv"};case"na":return{data:OK(n,t),headers:["HOLE ID","from","to","cond"],filename:"na.csv"};case"geology":return{data:RK(n,t),headers:["HOLE ID","from","to","Descrição"],filename:"geology.csv"};case"interp":return{data:NK(n,t),headers:["HOLE ID","from","to","interp. geol"],filename:"interp.csv"};default:return}},vv=(n,t)=>{const e=u8[t];if(!e)return{isValid:!1,missingFields:[],errorMessage:`Tipo de exportação '${t}' não reconhecido`};const r=[],i=n.filter(s=>s.dataType&&s.coordinates).map(s=>s.dataType);if(e.forEach(s=>{i.includes(s)||r.push(s)}),t==="nspt"||t==="collar"||t==="na"){const s=i.includes("depth"),a=i.includes("depth_from_to");!s&&!a&&r.unshift("depth")}return{isValid:r.length===0,missingFields:r,errorMessage:r.length>0?`Campos obrigatórios ausentes: ${r.join(", ")}`:void 0}};var yx={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var aC;function kK(){return aC||(aC=1,function(n,t){(function(e){n.exports=e()})(function(){return function e(r,i,s){function a(f,d){if(!i[f]){if(!r[f]){var p=typeof _d=="function"&&_d;if(!d&&p)return p(f,!0);if(l)return l(f,!0);var m=new Error("Cannot find module '"+f+"'");throw m.code="MODULE_NOT_FOUND",m}var v=i[f]={exports:{}};r[f][0].call(v.exports,function(x){var _=r[f][1][x];return a(_||x)},v,v.exports,e,r,i,s)}return i[f].exports}for(var l=typeof _d=="function"&&_d,u=0;u<s.length;u++)a(s[u]);return a}({1:[function(e,r,i){var s=e("./utils"),a=e("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(u){for(var f,d,p,m,v,x,_,y=[],w=0,S=u.length,T=S,C=s.getTypeOf(u)!=="string";w<u.length;)T=S-w,p=C?(f=u[w++],d=w<S?u[w++]:0,w<S?u[w++]:0):(f=u.charCodeAt(w++),d=w<S?u.charCodeAt(w++):0,w<S?u.charCodeAt(w++):0),m=f>>2,v=(3&f)<<4|d>>4,x=1<T?(15&d)<<2|p>>6:64,_=2<T?63&p:64,y.push(l.charAt(m)+l.charAt(v)+l.charAt(x)+l.charAt(_));return y.join("")},i.decode=function(u){var f,d,p,m,v,x,_=0,y=0,w="data:";if(u.substr(0,w.length)===w)throw new Error("Invalid base64 input, it looks like a data url.");var S,T=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===l.charAt(64)&&T--,u.charAt(u.length-2)===l.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(S=a.uint8array?new Uint8Array(0|T):new Array(0|T);_<u.length;)f=l.indexOf(u.charAt(_++))<<2|(m=l.indexOf(u.charAt(_++)))>>4,d=(15&m)<<4|(v=l.indexOf(u.charAt(_++)))>>2,p=(3&v)<<6|(x=l.indexOf(u.charAt(_++))),S[y++]=f,v!==64&&(S[y++]=d),x!==64&&(S[y++]=p);return S}},{"./support":30,"./utils":32}],2:[function(e,r,i){var s=e("./external"),a=e("./stream/DataWorker"),l=e("./stream/Crc32Probe"),u=e("./stream/DataLengthProbe");function f(d,p,m,v,x){this.compressedSize=d,this.uncompressedSize=p,this.crc32=m,this.compression=v,this.compressedContent=x}f.prototype={getContentWorker:function(){var d=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(d,p,m){return d.pipe(new l).pipe(new u("uncompressedSize")).pipe(p.compressWorker(m)).pipe(new u("compressedSize")).withStreamInfo("compression",p)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,i){var s=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,i){var s=e("./utils"),a=function(){for(var l,u=[],f=0;f<256;f++){l=f;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;u[f]=l}return u}();r.exports=function(l,u){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(f,d,p,m){var v=a,x=m+p;f^=-1;for(var _=m;_<x;_++)f=f>>>8^v[255&(f^d[_])];return-1^f}(0|u,l,l.length,0):function(f,d,p,m){var v=a,x=m+p;f^=-1;for(var _=m;_<x;_++)f=f>>>8^v[255&(f^d.charCodeAt(_))];return-1^f}(0|u,l,l.length,0):0}},{"./utils":32}],5:[function(e,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,r,i){var s=null;s=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:s}},{lie:37}],7:[function(e,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),l=e("./utils"),u=e("./stream/GenericWorker"),f=s?"uint8array":"array";function d(p,m){u.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=m,this.meta={}}i.magic="\b\0",l.inherits(d,u),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(f,p.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(m){p.push({data:m,meta:p.meta})}},i.compressWorker=function(p){return new d("Deflate",p)},i.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,i){function s(v,x){var _,y="";for(_=0;_<x;_++)y+=String.fromCharCode(255&v),v>>>=8;return y}function a(v,x,_,y,w,S){var T,C,R=v.file,N=v.compression,D=S!==f.utf8encode,I=l.transformTo("string",S(R.name)),M=l.transformTo("string",f.utf8encode(R.name)),B=R.comment,H=l.transformTo("string",S(B)),F=l.transformTo("string",f.utf8encode(B)),rt=M.length!==R.name.length,L=F.length!==B.length,it="",Z="",q="",Ct=R.dir,at=R.date,P={crc32:0,compressedSize:0,uncompressedSize:0};x&&!_||(P.crc32=v.crc32,P.compressedSize=v.compressedSize,P.uncompressedSize=v.uncompressedSize);var V=0;x&&(V|=8),D||!rt&&!L||(V|=2048);var j=0,et=0;Ct&&(j|=16),w==="UNIX"?(et=798,j|=function(xt,Nt){var Rt=xt;return xt||(Rt=Nt?16893:33204),(65535&Rt)<<16}(R.unixPermissions,Ct)):(et=20,j|=function(xt){return 63&(xt||0)}(R.dosPermissions)),T=at.getUTCHours(),T<<=6,T|=at.getUTCMinutes(),T<<=5,T|=at.getUTCSeconds()/2,C=at.getUTCFullYear()-1980,C<<=4,C|=at.getUTCMonth()+1,C<<=5,C|=at.getUTCDate(),rt&&(Z=s(1,1)+s(d(I),4)+M,it+="up"+s(Z.length,2)+Z),L&&(q=s(1,1)+s(d(H),4)+F,it+="uc"+s(q.length,2)+q);var dt="";return dt+=`
\0`,dt+=s(V,2),dt+=N.magic,dt+=s(T,2),dt+=s(C,2),dt+=s(P.crc32,4),dt+=s(P.compressedSize,4),dt+=s(P.uncompressedSize,4),dt+=s(I.length,2),dt+=s(it.length,2),{fileRecord:p.LOCAL_FILE_HEADER+dt+I+it,dirRecord:p.CENTRAL_FILE_HEADER+s(et,2)+dt+s(H.length,2)+"\0\0\0\0"+s(j,4)+s(y,4)+I+it+H}}var l=e("../utils"),u=e("../stream/GenericWorker"),f=e("../utf8"),d=e("../crc32"),p=e("../signature");function m(v,x,_,y){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=_,this.encodeFileName=y,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(m,u),m.prototype.push=function(v){var x=v.meta.percent||0,_=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,u.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:_?(x+100*(_-y-1))/_:100}}))},m.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var x=this.streamFiles&&!v.file.dir;if(x){var _=a(v,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(v){this.accumulate=!1;var x=this.streamFiles&&!v.file.dir,_=a(v,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),x)this.push({data:function(y){return p.DATA_DESCRIPTOR+s(y.crc32,4)+s(y.compressedSize,4)+s(y.uncompressedSize,4)}(v),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var v=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var _=this.bytesWritten-v,y=function(w,S,T,C,R){var N=l.transformTo("string",R(C));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(w,2)+s(w,2)+s(S,4)+s(T,4)+s(N.length,2)+N}(this.dirRecords.length,_,v,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(v){this._sources.push(v);var x=this;return v.on("data",function(_){x.processChunk(_)}),v.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),v.on("error",function(_){x.error(_)}),this},m.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(v){var x=this._sources;if(!u.prototype.error.call(this,v))return!1;for(var _=0;_<x.length;_++)try{x[_].error(v)}catch{}return!0},m.prototype.lock=function(){u.prototype.lock.call(this);for(var v=this._sources,x=0;x<v.length;x++)v[x].lock()},r.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,i){var s=e("../compressions"),a=e("./ZipFileWorker");i.generateWorker=function(l,u,f){var d=new a(u.streamFiles,f,u.platform,u.encodeFileName),p=0;try{l.forEach(function(m,v){p++;var x=function(S,T){var C=S||T,R=s[C];if(!R)throw new Error(C+" is not a valid compression method !");return R}(v.options.compression,u.compression),_=v.options.compressionOptions||u.compressionOptions||{},y=v.dir,w=v.date;v._compressWorker(x,_).withStreamInfo("file",{name:m,dir:y,date:w,comment:v.comment||"",unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions}).pipe(d)}),d.entriesCount=p}catch(m){d.error(m)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var l in this)typeof this[l]!="function"&&(a[l]=this[l]);return a}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(a,l){return new s().loadAsync(a,l)},s.external=e("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,i){var s=e("./utils"),a=e("./external"),l=e("./utf8"),u=e("./zipEntries"),f=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function p(m){return new a.Promise(function(v,x){var _=m.decompressed.getContentWorker().pipe(new f);_.on("error",function(y){x(y)}).on("end",function(){_.streamInfo.crc32!==m.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):v()}).resume()})}r.exports=function(m,v){var x=this;return v=s.extend(v||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(m)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",m,!0,v.optimizedBinaryString,v.base64).then(function(_){var y=new u(v);return y.load(_),y}).then(function(_){var y=[a.Promise.resolve(_)],w=_.files;if(v.checkCRC32)for(var S=0;S<w.length;S++)y.push(p(w[S]));return a.Promise.all(y)}).then(function(_){for(var y=_.shift(),w=y.files,S=0;S<w.length;S++){var T=w[S],C=T.fileNameStr,R=s.resolve(T.fileNameStr);x.file(R,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:v.createFolders}),T.dir||(x.file(R).unsafeOriginalName=C)}return y.zipComment.length&&(x.comment=y.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,i){var s=e("../utils"),a=e("../stream/GenericWorker");function l(u,f){a.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}s.inherits(l,a),l.prototype._bindStream=function(u){var f=this;(this._stream=u).pause(),u.on("data",function(d){f.push({data:d,meta:{percent:0}})}).on("error",function(d){f.isPaused?this.generatedError=d:f.error(d)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},l.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,i){var s=e("readable-stream").Readable;function a(l,u,f){s.call(this,u),this._helper=l;var d=this;l.on("data",function(p,m){d.push(p)||d._helper.pause(),f&&f(m)}).on("error",function(p){d.emit("error",p)}).on("end",function(){d.push(null)})}e("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,r,i){function s(R,N,D){var I,M=l.getTypeOf(N),B=l.extend(D||{},d);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(R=w(R)),B.createFolders&&(I=y(R))&&S.call(this,I,!0);var H=M==="string"&&B.binary===!1&&B.base64===!1;D&&D.binary!==void 0||(B.binary=!H),(N instanceof p&&N.uncompressedSize===0||B.dir||!N||N.length===0)&&(B.base64=!1,B.binary=!0,N="",B.compression="STORE",M="string");var F=null;F=N instanceof p||N instanceof u?N:x.isNode&&x.isStream(N)?new _(R,N):l.prepareContent(R,N,B.binary,B.optimizedBinaryString,B.base64);var rt=new m(R,F,B);this.files[R]=rt}var a=e("./utf8"),l=e("./utils"),u=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),d=e("./defaults"),p=e("./compressedObject"),m=e("./zipObject"),v=e("./generate"),x=e("./nodejsUtils"),_=e("./nodejs/NodejsStreamInputAdapter"),y=function(R){R.slice(-1)==="/"&&(R=R.substring(0,R.length-1));var N=R.lastIndexOf("/");return 0<N?R.substring(0,N):""},w=function(R){return R.slice(-1)!=="/"&&(R+="/"),R},S=function(R,N){return N=N!==void 0?N:d.createFolders,R=w(R),this.files[R]||s.call(this,R,null,{dir:!0,createFolders:N}),this.files[R]};function T(R){return Object.prototype.toString.call(R)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(R){var N,D,I;for(N in this.files)I=this.files[N],(D=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&R(D,I)},filter:function(R){var N=[];return this.forEach(function(D,I){R(D,I)&&N.push(I)}),N},file:function(R,N,D){if(arguments.length!==1)return R=this.root+R,s.call(this,R,N,D),this;if(T(R)){var I=R;return this.filter(function(B,H){return!H.dir&&I.test(B)})}var M=this.files[this.root+R];return M&&!M.dir?M:null},folder:function(R){if(!R)return this;if(T(R))return this.filter(function(M,B){return B.dir&&R.test(M)});var N=this.root+R,D=S.call(this,N),I=this.clone();return I.root=D.name,I},remove:function(R){R=this.root+R;var N=this.files[R];if(N||(R.slice(-1)!=="/"&&(R+="/"),N=this.files[R]),N&&!N.dir)delete this.files[R];else for(var D=this.filter(function(M,B){return B.name.slice(0,R.length)===R}),I=0;I<D.length;I++)delete this.files[D[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(R){var N,D={};try{if((D=l.extend(R||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=D.type.toLowerCase(),D.compression=D.compression.toUpperCase(),D.type==="binarystring"&&(D.type="string"),!D.type)throw new Error("No output type specified.");l.checkSupport(D.type),D.platform!=="darwin"&&D.platform!=="freebsd"&&D.platform!=="linux"&&D.platform!=="sunos"||(D.platform="UNIX"),D.platform==="win32"&&(D.platform="DOS");var I=D.comment||this.comment||"";N=v.generateWorker(this,D,I)}catch(M){(N=new u("error")).error(M)}return new f(N,D.type||"string",D.mimeType)},generateAsync:function(R,N){return this.generateInternalStream(R).accumulate(N)},generateNodeStream:function(R,N){return(R=R||{}).type||(R.type="nodebuffer"),this.generateInternalStream(R).toNodejsStream(N)}};r.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,i){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,i){var s=e("./DataReader");function a(l){s.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=255&l[u]}e("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===u&&this.data[m+1]===f&&this.data[m+2]===d&&this.data[m+3]===p)return m-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),m=this.readData(4);return u===m[0]&&f===m[1]&&d===m[2]&&p===m[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,r,i){var s=e("../utils");function a(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var u,f=0;for(this.checkOffset(l),u=this.index+l-1;u>=this.index;u--)f=(f<<8)+this.byteAt(u);return this.index+=l,f},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=a},{"../utils":32}],19:[function(e,r,i){var s=e("./Uint8ArrayReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,i){var s=e("./DataReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},a.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,r,i){var s=e("./ArrayReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,i){var s=e("../utils"),a=e("../support"),l=e("./ArrayReader"),u=e("./StringReader"),f=e("./NodeBufferReader"),d=e("./Uint8ArrayReader");r.exports=function(p){var m=s.getTypeOf(p);return s.checkSupport(m),m!=="string"||a.uint8array?m==="nodebuffer"?new f(p):a.uint8array?new d(s.transformTo("uint8array",p)):new l(s.transformTo("array",p)):new u(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,i){var s=e("./GenericWorker"),a=e("../utils");function l(u){s.call(this,"ConvertWorker to "+u),this.destType=u}a.inherits(l,s),l.prototype.processChunk=function(u){this.push({data:a.transformTo(this.destType,u.data),meta:u.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,i){var s=e("./GenericWorker"),a=e("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,s),l.prototype.processChunk=function(u){this.streamInfo.crc32=a(u.data,this.streamInfo.crc32||0),this.push(u)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,i){var s=e("../utils"),a=e("./GenericWorker");function l(u){a.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}s.inherits(l,a),l.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}a.prototype.processChunk.call(this,u)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,i){var s=e("../utils"),a=e("./GenericWorker");function l(u){a.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){f.dataIsReady=!0,f.data=d,f.max=d&&d.length||0,f.type=s.getTypeOf(d),f.isPaused||f._tickAndRepeat()},function(d){f.error(d)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,f);break;case"uint8array":u=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":u=this.data.slice(this.index,f)}return this.index=f,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,l){return this._listeners[a].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,l){if(this._listeners[a])for(var u=0;u<this._listeners[a].length;u++)this._listeners[a][u].call(this,l)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var l=this;return a.on("data",function(u){l.processChunk(u)}),a.on("end",function(){l.end()}),a.on("error",function(u){l.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,l){return this.extraStreamInfo[a]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(e,r,i){var s=e("../utils"),a=e("./ConvertWorker"),l=e("./GenericWorker"),u=e("../base64"),f=e("../support"),d=e("../external"),p=null;if(f.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(x,_){return new d.Promise(function(y,w){var S=[],T=x._internalType,C=x._outputType,R=x._mimeType;x.on("data",function(N,D){S.push(N),_&&_(D)}).on("error",function(N){S=[],w(N)}).on("end",function(){try{var N=function(D,I,M){switch(D){case"blob":return s.newBlob(s.transformTo("arraybuffer",I),M);case"base64":return u.encode(I);default:return s.transformTo(D,I)}}(C,function(D,I){var M,B=0,H=null,F=0;for(M=0;M<I.length;M++)F+=I[M].length;switch(D){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(H=new Uint8Array(F),M=0;M<I.length;M++)H.set(I[M],B),B+=I[M].length;return H;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+D+"'")}}(T,S),R);y(N)}catch(D){w(D)}S=[]}).resume()})}function v(x,_,y){var w=_;switch(_){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string"}try{this._internalType=w,this._outputType=_,this._mimeType=y,s.checkSupport(w),this._worker=x.pipe(new a(w)),x.lock()}catch(S){this._worker=new l("error"),this._worker.error(S)}}v.prototype={accumulate:function(x){return m(this,x)},on:function(x,_){var y=this;return x==="data"?this._worker.on(x,function(w){_.call(y,w.data,w.meta)}):this._worker.on(x,function(){s.delay(_,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},x)}},r.exports=v},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,i){for(var s=e("./utils"),a=e("./support"),l=e("./nodejsUtils"),u=e("./stream/GenericWorker"),f=new Array(256),d=0;d<256;d++)f[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;f[254]=f[254]=1;function p(){u.call(this,"utf-8 decode"),this.leftOver=null}function m(){u.call(this,"utf-8 encode")}i.utf8encode=function(v){return a.nodebuffer?l.newBufferFrom(v,"utf-8"):function(x){var _,y,w,S,T,C=x.length,R=0;for(S=0;S<C;S++)(64512&(y=x.charCodeAt(S)))==55296&&S+1<C&&(64512&(w=x.charCodeAt(S+1)))==56320&&(y=65536+(y-55296<<10)+(w-56320),S++),R+=y<128?1:y<2048?2:y<65536?3:4;for(_=a.uint8array?new Uint8Array(R):new Array(R),S=T=0;T<R;S++)(64512&(y=x.charCodeAt(S)))==55296&&S+1<C&&(64512&(w=x.charCodeAt(S+1)))==56320&&(y=65536+(y-55296<<10)+(w-56320),S++),y<128?_[T++]=y:(y<2048?_[T++]=192|y>>>6:(y<65536?_[T++]=224|y>>>12:(_[T++]=240|y>>>18,_[T++]=128|y>>>12&63),_[T++]=128|y>>>6&63),_[T++]=128|63&y);return _}(v)},i.utf8decode=function(v){return a.nodebuffer?s.transformTo("nodebuffer",v).toString("utf-8"):function(x){var _,y,w,S,T=x.length,C=new Array(2*T);for(_=y=0;_<T;)if((w=x[_++])<128)C[y++]=w;else if(4<(S=f[w]))C[y++]=65533,_+=S-1;else{for(w&=S===2?31:S===3?15:7;1<S&&_<T;)w=w<<6|63&x[_++],S--;1<S?C[y++]=65533:w<65536?C[y++]=w:(w-=65536,C[y++]=55296|w>>10&1023,C[y++]=56320|1023&w)}return C.length!==y&&(C.subarray?C=C.subarray(0,y):C.length=y),s.applyFromCharCode(C)}(v=s.transformTo(a.uint8array?"uint8array":"array",v))},s.inherits(p,u),p.prototype.processChunk=function(v){var x=s.transformTo(a.uint8array?"uint8array":"array",v.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var _=x;(x=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),x.set(_,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var y=function(S,T){var C;for((T=T||S.length)>S.length&&(T=S.length),C=T-1;0<=C&&(192&S[C])==128;)C--;return C<0||C===0?T:C+f[S[C]]>T?C:T}(x),w=x;y!==x.length&&(a.uint8array?(w=x.subarray(0,y),this.leftOver=x.subarray(y,x.length)):(w=x.slice(0,y),this.leftOver=x.slice(y,x.length))),this.push({data:i.utf8decode(w),meta:v.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=p,s.inherits(m,u),m.prototype.processChunk=function(v){this.push({data:i.utf8encode(v.data),meta:v.meta})},i.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,i){var s=e("./support"),a=e("./base64"),l=e("./nodejsUtils"),u=e("./external");function f(_){return _}function d(_,y){for(var w=0;w<_.length;++w)y[w]=255&_.charCodeAt(w);return y}e("setimmediate"),i.newBlob=function(_,y){i.checkSupport("blob");try{return new Blob([_],{type:y})}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return w.append(_),w.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(_,y,w){var S=[],T=0,C=_.length;if(C<=w)return String.fromCharCode.apply(null,_);for(;T<C;)y==="array"||y==="nodebuffer"?S.push(String.fromCharCode.apply(null,_.slice(T,Math.min(T+w,C)))):S.push(String.fromCharCode.apply(null,_.subarray(T,Math.min(T+w,C)))),T+=w;return S.join("")},stringifyByChar:function(_){for(var y="",w=0;w<_.length;w++)y+=String.fromCharCode(_[w]);return y},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function m(_){var y=65536,w=i.getTypeOf(_),S=!0;if(w==="uint8array"?S=p.applyCanBeUsed.uint8array:w==="nodebuffer"&&(S=p.applyCanBeUsed.nodebuffer),S)for(;1<y;)try{return p.stringifyByChunk(_,w,y)}catch{y=Math.floor(y/2)}return p.stringifyByChar(_)}function v(_,y){for(var w=0;w<_.length;w++)y[w]=_[w];return y}i.applyFromCharCode=m;var x={};x.string={string:f,array:function(_){return d(_,new Array(_.length))},arraybuffer:function(_){return x.string.uint8array(_).buffer},uint8array:function(_){return d(_,new Uint8Array(_.length))},nodebuffer:function(_){return d(_,l.allocBuffer(_.length))}},x.array={string:m,array:f,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return l.newBufferFrom(_)}},x.arraybuffer={string:function(_){return m(new Uint8Array(_))},array:function(_){return v(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:f,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return l.newBufferFrom(new Uint8Array(_))}},x.uint8array={string:m,array:function(_){return v(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:f,nodebuffer:function(_){return l.newBufferFrom(_)}},x.nodebuffer={string:m,array:function(_){return v(_,new Array(_.length))},arraybuffer:function(_){return x.nodebuffer.uint8array(_).buffer},uint8array:function(_){return v(_,new Uint8Array(_.length))},nodebuffer:f},i.transformTo=function(_,y){if(y=y||"",!_)return y;i.checkSupport(_);var w=i.getTypeOf(y);return x[w][_](y)},i.resolve=function(_){for(var y=_.split("/"),w=[],S=0;S<y.length;S++){var T=y[S];T==="."||T===""&&S!==0&&S!==y.length-1||(T===".."?w.pop():w.push(T))}return w.join("/")},i.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(_)?"nodebuffer":s.uint8array&&_ instanceof Uint8Array?"uint8array":s.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(_){if(!s[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(_){var y,w,S="";for(w=0;w<(_||"").length;w++)S+="\\x"+((y=_.charCodeAt(w))<16?"0":"")+y.toString(16).toUpperCase();return S},i.delay=function(_,y,w){setImmediate(function(){_.apply(w||null,y||[])})},i.inherits=function(_,y){function w(){}w.prototype=y.prototype,_.prototype=new w},i.extend=function(){var _,y,w={};for(_=0;_<arguments.length;_++)for(y in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],y)&&w[y]===void 0&&(w[y]=arguments[_][y]);return w},i.prepareContent=function(_,y,w,S,T){return u.Promise.resolve(y).then(function(C){return s.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new u.Promise(function(R,N){var D=new FileReader;D.onload=function(I){R(I.target.result)},D.onerror=function(I){N(I.target.error)},D.readAsArrayBuffer(C)}):C}).then(function(C){var R=i.getTypeOf(C);return R?(R==="arraybuffer"?C=i.transformTo("uint8array",C):R==="string"&&(T?C=a.decode(C):w&&S!==!0&&(C=function(N){return d(N,s.uint8array?new Uint8Array(N.length):new Array(N.length))}(C))),C):u.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,i){var s=e("./reader/readerFor"),a=e("./utils"),l=e("./signature"),u=e("./zipEntry"),f=e("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(m)+", expected "+a.pretty(p)+")")}},isSignature:function(p,m){var v=this.reader.index;this.reader.setIndex(p);var x=this.reader.readString(4)===m;return this.reader.setIndex(v),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),m=f.uint8array?"uint8array":"array",v=a.transformTo(m,p);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,m,v,x=this.zip64EndOfCentralSize-44;0<x;)p=this.reader.readInt(2),m=this.reader.readInt(4),v=this.reader.readData(m),this.zip64ExtensibleData[p]={id:p,length:m,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,m;for(p=0;p<this.files.length;p++)m=this.files[p],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var m=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var x=m-v;if(0<x)this.isSignature(m,l.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,i){var s=e("./reader/readerFor"),a=e("./utils"),l=e("./compressedObject"),u=e("./crc32"),f=e("./utf8"),d=e("./compressions"),p=e("./support");function m(v,x){this.options=v,this.loadOptions=x}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(v){var x,_;if(v.skip(22),this.fileNameLength=v.readInt(2),_=v.readInt(2),this.fileName=v.readData(this.fileNameLength),v.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(y){for(var w in d)if(Object.prototype.hasOwnProperty.call(d,w)&&d[w].magic===y)return d[w];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,x,v.readData(this.compressedSize))},readCentralPart:function(v){this.versionMadeBy=v.readInt(2),v.skip(2),this.bitFlag=v.readInt(2),this.compressionMethod=v.readString(2),this.date=v.readDate(),this.crc32=v.readInt(4),this.compressedSize=v.readInt(4),this.uncompressedSize=v.readInt(4);var x=v.readInt(2);if(this.extraFieldsLength=v.readInt(2),this.fileCommentLength=v.readInt(2),this.diskNumberStart=v.readInt(2),this.internalFileAttributes=v.readInt(2),this.externalFileAttributes=v.readInt(4),this.localHeaderOffset=v.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");v.skip(x),this.readExtraFields(v),this.parseZIP64ExtraField(v),this.fileComment=v.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var v=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),v==0&&(this.dosPermissions=63&this.externalFileAttributes),v==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var v=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=v.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=v.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=v.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=v.readInt(4))}},readExtraFields:function(v){var x,_,y,w=v.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});v.index+4<w;)x=v.readInt(2),_=v.readInt(2),y=v.readData(_),this.extraFields[x]={id:x,length:_,value:y};v.setIndex(w)},handleUTF8:function(){var v=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var _=a.transformTo(v,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var w=a.transformTo(v,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(w)}}},findExtraFieldUnicodePath:function(){var v=this.extraFields[28789];if(v){var x=s(v.value);return x.readInt(1)!==1||u(this.fileName)!==x.readInt(4)?null:f.utf8decode(x.readData(v.length-5))}return null},findExtraFieldUnicodeComment:function(){var v=this.extraFields[25461];if(v){var x=s(v.value);return x.readInt(1)!==1||u(this.fileComment)!==x.readInt(4)?null:f.utf8decode(x.readData(v.length-5))}return null}},r.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,i){function s(x,_,y){this.name=x,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=_,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var a=e("./stream/StreamHelper"),l=e("./stream/DataWorker"),u=e("./utf8"),f=e("./compressedObject"),d=e("./stream/GenericWorker");s.prototype={internalStream:function(x){var _=null,y="string";try{if(!x)throw new Error("No output type specified.");var w=(y=x.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),_=this._decompressWorker();var S=!this._dataBinary;S&&!w&&(_=_.pipe(new u.Utf8EncodeWorker)),!S&&w&&(_=_.pipe(new u.Utf8DecodeWorker))}catch(T){(_=new d("error")).error(T)}return new a(_,y,"")},async:function(x,_){return this.internalStream(x).accumulate(_)},nodeStream:function(x,_){return this.internalStream(x||"nodebuffer").toNodejsStream(_)},_compressWorker:function(x,_){if(this._data instanceof f&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new u.Utf8EncodeWorker)),f.createWorkerFrom(y,x,_)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},v=0;v<p.length;v++)s.prototype[p[v]]=m;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,i){(function(s){var a,l,u=s.MutationObserver||s.WebKitMutationObserver;if(u){var f=0,d=new u(x),p=s.document.createTextNode("");d.observe(p,{characterData:!0}),a=function(){p.data=f=++f%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var _=s.document.createElement("script");_.onreadystatechange=function(){x(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},s.document.documentElement.appendChild(_)}:function(){setTimeout(x,0)};else{var m=new s.MessageChannel;m.port1.onmessage=x,a=function(){m.port2.postMessage(0)}}var v=[];function x(){var _,y;l=!0;for(var w=v.length;w;){for(y=v,v=[],_=-1;++_<w;)y[_]();w=v.length}l=!1}r.exports=function(_){v.push(_)!==1||l||a()}}).call(this,typeof Q0<"u"?Q0:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,i){var s=e("immediate");function a(){}var l={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];function p(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,w!==a&&_(this,w)}function m(w,S,T){this.promise=w,typeof S=="function"&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function v(w,S,T){s(function(){var C;try{C=S(T)}catch(R){return l.reject(w,R)}C===w?l.reject(w,new TypeError("Cannot resolve promise with itself")):l.resolve(w,C)})}function x(w){var S=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof S=="function")return function(){S.apply(w,arguments)}}function _(w,S){var T=!1;function C(D){T||(T=!0,l.reject(w,D))}function R(D){T||(T=!0,l.resolve(w,D))}var N=y(function(){S(R,C)});N.status==="error"&&C(N.value)}function y(w,S){var T={};try{T.value=w(S),T.status="success"}catch(C){T.status="error",T.value=C}return T}(r.exports=p).prototype.finally=function(w){if(typeof w!="function")return this;var S=this.constructor;return this.then(function(T){return S.resolve(w()).then(function(){return T})},function(T){return S.resolve(w()).then(function(){throw T})})},p.prototype.catch=function(w){return this.then(null,w)},p.prototype.then=function(w,S){if(typeof w!="function"&&this.state===f||typeof S!="function"&&this.state===u)return this;var T=new this.constructor(a);return this.state!==d?v(T,this.state===f?w:S,this.outcome):this.queue.push(new m(T,w,S)),T},m.prototype.callFulfilled=function(w){l.resolve(this.promise,w)},m.prototype.otherCallFulfilled=function(w){v(this.promise,this.onFulfilled,w)},m.prototype.callRejected=function(w){l.reject(this.promise,w)},m.prototype.otherCallRejected=function(w){v(this.promise,this.onRejected,w)},l.resolve=function(w,S){var T=y(x,S);if(T.status==="error")return l.reject(w,T.value);var C=T.value;if(C)_(w,C);else{w.state=f,w.outcome=S;for(var R=-1,N=w.queue.length;++R<N;)w.queue[R].callFulfilled(S)}return w},l.reject=function(w,S){w.state=u,w.outcome=S;for(var T=-1,C=w.queue.length;++T<C;)w.queue[T].callRejected(S);return w},p.resolve=function(w){return w instanceof this?w:l.resolve(new this(a),w)},p.reject=function(w){var S=new this(a);return l.reject(S,w)},p.all=function(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=w.length,C=!1;if(!T)return this.resolve([]);for(var R=new Array(T),N=0,D=-1,I=new this(a);++D<T;)M(w[D],D);return I;function M(B,H){S.resolve(B).then(function(F){R[H]=F,++N!==T||C||(C=!0,l.resolve(I,R))},function(F){C||(C=!0,l.reject(I,F))})}},p.race=function(w){var S=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=w.length,C=!1;if(!T)return this.resolve([]);for(var R=-1,N=new this(a);++R<T;)D=w[R],S.resolve(D).then(function(I){C||(C=!0,l.resolve(N,I))},function(I){C||(C=!0,l.reject(N,I))});var D;return N}},{immediate:36}],38:[function(e,r,i){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,i){var s=e("./zlib/deflate"),a=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/messages"),f=e("./zlib/zstream"),d=Object.prototype.toString,p=0,m=-1,v=0,x=8;function _(w){if(!(this instanceof _))return new _(w);this.options=a.assign({level:m,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},w||{});var S=this.options;S.raw&&0<S.windowBits?S.windowBits=-S.windowBits:S.gzip&&0<S.windowBits&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var T=s.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(T!==p)throw new Error(u[T]);if(S.header&&s.deflateSetHeader(this.strm,S.header),S.dictionary){var C;if(C=typeof S.dictionary=="string"?l.string2buf(S.dictionary):d.call(S.dictionary)==="[object ArrayBuffer]"?new Uint8Array(S.dictionary):S.dictionary,(T=s.deflateSetDictionary(this.strm,C))!==p)throw new Error(u[T]);this._dict_set=!0}}function y(w,S){var T=new _(S);if(T.push(w,!0),T.err)throw T.msg||u[T.err];return T.result}_.prototype.push=function(w,S){var T,C,R=this.strm,N=this.options.chunkSize;if(this.ended)return!1;C=S===~~S?S:S===!0?4:0,typeof w=="string"?R.input=l.string2buf(w):d.call(w)==="[object ArrayBuffer]"?R.input=new Uint8Array(w):R.input=w,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(N),R.next_out=0,R.avail_out=N),(T=s.deflate(R,C))!==1&&T!==p)return this.onEnd(T),!(this.ended=!0);R.avail_out!==0&&(R.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(a.shrinkBuf(R.output,R.next_out))):this.onData(a.shrinkBuf(R.output,R.next_out)))}while((0<R.avail_in||R.avail_out===0)&&T!==1);return C===4?(T=s.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===p):C!==2||(this.onEnd(p),!(R.avail_out=0))},_.prototype.onData=function(w){this.chunks.push(w)},_.prototype.onEnd=function(w){w===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},i.Deflate=_,i.deflate=y,i.deflateRaw=function(w,S){return(S=S||{}).raw=!0,y(w,S)},i.gzip=function(w,S){return(S=S||{}).gzip=!0,y(w,S)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,i){var s=e("./zlib/inflate"),a=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/constants"),f=e("./zlib/messages"),d=e("./zlib/zstream"),p=e("./zlib/gzheader"),m=Object.prototype.toString;function v(_){if(!(this instanceof v))return new v(_);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},_||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||_&&_.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&(15&y.windowBits)==0&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var w=s.inflateInit2(this.strm,y.windowBits);if(w!==u.Z_OK)throw new Error(f[w]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function x(_,y){var w=new v(y);if(w.push(_,!0),w.err)throw w.msg||f[w.err];return w.result}v.prototype.push=function(_,y){var w,S,T,C,R,N,D=this.strm,I=this.options.chunkSize,M=this.options.dictionary,B=!1;if(this.ended)return!1;S=y===~~y?y:y===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof _=="string"?D.input=l.binstring2buf(_):m.call(_)==="[object ArrayBuffer]"?D.input=new Uint8Array(_):D.input=_,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new a.Buf8(I),D.next_out=0,D.avail_out=I),(w=s.inflate(D,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&M&&(N=typeof M=="string"?l.string2buf(M):m.call(M)==="[object ArrayBuffer]"?new Uint8Array(M):M,w=s.inflateSetDictionary(this.strm,N)),w===u.Z_BUF_ERROR&&B===!0&&(w=u.Z_OK,B=!1),w!==u.Z_STREAM_END&&w!==u.Z_OK)return this.onEnd(w),!(this.ended=!0);D.next_out&&(D.avail_out!==0&&w!==u.Z_STREAM_END&&(D.avail_in!==0||S!==u.Z_FINISH&&S!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(T=l.utf8border(D.output,D.next_out),C=D.next_out-T,R=l.buf2string(D.output,T),D.next_out=C,D.avail_out=I-C,C&&a.arraySet(D.output,D.output,T,C,0),this.onData(R)):this.onData(a.shrinkBuf(D.output,D.next_out)))),D.avail_in===0&&D.avail_out===0&&(B=!0)}while((0<D.avail_in||D.avail_out===0)&&w!==u.Z_STREAM_END);return w===u.Z_STREAM_END&&(S=u.Z_FINISH),S===u.Z_FINISH?(w=s.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===u.Z_OK):S!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(D.avail_out=0))},v.prototype.onData=function(_){this.chunks.push(_)},v.prototype.onEnd=function(_){_===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},i.Inflate=v,i.inflate=x,i.inflateRaw=function(_,y){return(y=y||{}).raw=!0,x(_,y)},i.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var d=f.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(u[p]=d[p])}}return u},i.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var a={arraySet:function(u,f,d,p,m){if(f.subarray&&u.subarray)u.set(f.subarray(d,d+p),m);else for(var v=0;v<p;v++)u[m+v]=f[d+v]},flattenChunks:function(u){var f,d,p,m,v,x;for(f=p=0,d=u.length;f<d;f++)p+=u[f].length;for(x=new Uint8Array(p),f=m=0,d=u.length;f<d;f++)v=u[f],x.set(v,m),m+=v.length;return x}},l={arraySet:function(u,f,d,p,m){for(var v=0;v<p;v++)u[m+v]=f[d+v]},flattenChunks:function(u){return[].concat.apply([],u)}};i.setTyped=function(u){u?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(s)},{}],42:[function(e,r,i){var s=e("./common"),a=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var u=new s.Buf8(256),f=0;f<256;f++)u[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function d(p,m){if(m<65537&&(p.subarray&&l||!p.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(p,m));for(var v="",x=0;x<m;x++)v+=String.fromCharCode(p[x]);return v}u[254]=u[254]=1,i.string2buf=function(p){var m,v,x,_,y,w=p.length,S=0;for(_=0;_<w;_++)(64512&(v=p.charCodeAt(_)))==55296&&_+1<w&&(64512&(x=p.charCodeAt(_+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),_++),S+=v<128?1:v<2048?2:v<65536?3:4;for(m=new s.Buf8(S),_=y=0;y<S;_++)(64512&(v=p.charCodeAt(_)))==55296&&_+1<w&&(64512&(x=p.charCodeAt(_+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),_++),v<128?m[y++]=v:(v<2048?m[y++]=192|v>>>6:(v<65536?m[y++]=224|v>>>12:(m[y++]=240|v>>>18,m[y++]=128|v>>>12&63),m[y++]=128|v>>>6&63),m[y++]=128|63&v);return m},i.buf2binstring=function(p){return d(p,p.length)},i.binstring2buf=function(p){for(var m=new s.Buf8(p.length),v=0,x=m.length;v<x;v++)m[v]=p.charCodeAt(v);return m},i.buf2string=function(p,m){var v,x,_,y,w=m||p.length,S=new Array(2*w);for(v=x=0;v<w;)if((_=p[v++])<128)S[x++]=_;else if(4<(y=u[_]))S[x++]=65533,v+=y-1;else{for(_&=y===2?31:y===3?15:7;1<y&&v<w;)_=_<<6|63&p[v++],y--;1<y?S[x++]=65533:_<65536?S[x++]=_:(_-=65536,S[x++]=55296|_>>10&1023,S[x++]=56320|1023&_)}return d(S,x)},i.utf8border=function(p,m){var v;for((m=m||p.length)>p.length&&(m=p.length),v=m-1;0<=v&&(192&p[v])==128;)v--;return v<0||v===0?m:v+u[p[v]]>m?v:m}},{"./common":41}],43:[function(e,r,i){r.exports=function(s,a,l,u){for(var f=65535&s|0,d=s>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;d=d+(f=f+a[u++]|0)|0,--p;);f%=65521,d%=65521}return f|d<<16|0}},{}],44:[function(e,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,i){var s=function(){for(var a,l=[],u=0;u<256;u++){a=u;for(var f=0;f<8;f++)a=1&a?3988292384^a>>>1:a>>>1;l[u]=a}return l}();r.exports=function(a,l,u,f){var d=s,p=f+u;a^=-1;for(var m=f;m<p;m++)a=a>>>8^d[255&(a^l[m])];return-1^a}},{}],46:[function(e,r,i){var s,a=e("../utils/common"),l=e("./trees"),u=e("./adler32"),f=e("./crc32"),d=e("./messages"),p=0,m=4,v=0,x=-2,_=-1,y=4,w=2,S=8,T=9,C=286,R=30,N=19,D=2*C+1,I=15,M=3,B=258,H=B+M+1,F=42,rt=113,L=1,it=2,Z=3,q=4;function Ct(O,gt){return O.msg=d[gt],gt}function at(O){return(O<<1)-(4<O?9:0)}function P(O){for(var gt=O.length;0<=--gt;)O[gt]=0}function V(O){var gt=O.state,ut=gt.pending;ut>O.avail_out&&(ut=O.avail_out),ut!==0&&(a.arraySet(O.output,gt.pending_buf,gt.pending_out,ut,O.next_out),O.next_out+=ut,gt.pending_out+=ut,O.total_out+=ut,O.avail_out-=ut,gt.pending-=ut,gt.pending===0&&(gt.pending_out=0))}function j(O,gt){l._tr_flush_block(O,0<=O.block_start?O.block_start:-1,O.strstart-O.block_start,gt),O.block_start=O.strstart,V(O.strm)}function et(O,gt){O.pending_buf[O.pending++]=gt}function dt(O,gt){O.pending_buf[O.pending++]=gt>>>8&255,O.pending_buf[O.pending++]=255&gt}function xt(O,gt){var ut,K,X=O.max_chain_length,pt=O.strstart,Bt=O.prev_length,Ht=O.nice_match,St=O.strstart>O.w_size-H?O.strstart-(O.w_size-H):0,It=O.window,Tt=O.w_mask,vt=O.prev,te=O.strstart+B,ae=It[pt+Bt-1],ne=It[pt+Bt];O.prev_length>=O.good_match&&(X>>=2),Ht>O.lookahead&&(Ht=O.lookahead);do if(It[(ut=gt)+Bt]===ne&&It[ut+Bt-1]===ae&&It[ut]===It[pt]&&It[++ut]===It[pt+1]){pt+=2,ut++;do;while(It[++pt]===It[++ut]&&It[++pt]===It[++ut]&&It[++pt]===It[++ut]&&It[++pt]===It[++ut]&&It[++pt]===It[++ut]&&It[++pt]===It[++ut]&&It[++pt]===It[++ut]&&It[++pt]===It[++ut]&&pt<te);if(K=B-(te-pt),pt=te-B,Bt<K){if(O.match_start=gt,Ht<=(Bt=K))break;ae=It[pt+Bt-1],ne=It[pt+Bt]}}while((gt=vt[gt&Tt])>St&&--X!=0);return Bt<=O.lookahead?Bt:O.lookahead}function Nt(O){var gt,ut,K,X,pt,Bt,Ht,St,It,Tt,vt=O.w_size;do{if(X=O.window_size-O.lookahead-O.strstart,O.strstart>=vt+(vt-H)){for(a.arraySet(O.window,O.window,vt,vt,0),O.match_start-=vt,O.strstart-=vt,O.block_start-=vt,gt=ut=O.hash_size;K=O.head[--gt],O.head[gt]=vt<=K?K-vt:0,--ut;);for(gt=ut=vt;K=O.prev[--gt],O.prev[gt]=vt<=K?K-vt:0,--ut;);X+=vt}if(O.strm.avail_in===0)break;if(Bt=O.strm,Ht=O.window,St=O.strstart+O.lookahead,It=X,Tt=void 0,Tt=Bt.avail_in,It<Tt&&(Tt=It),ut=Tt===0?0:(Bt.avail_in-=Tt,a.arraySet(Ht,Bt.input,Bt.next_in,Tt,St),Bt.state.wrap===1?Bt.adler=u(Bt.adler,Ht,Tt,St):Bt.state.wrap===2&&(Bt.adler=f(Bt.adler,Ht,Tt,St)),Bt.next_in+=Tt,Bt.total_in+=Tt,Tt),O.lookahead+=ut,O.lookahead+O.insert>=M)for(pt=O.strstart-O.insert,O.ins_h=O.window[pt],O.ins_h=(O.ins_h<<O.hash_shift^O.window[pt+1])&O.hash_mask;O.insert&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[pt+M-1])&O.hash_mask,O.prev[pt&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=pt,pt++,O.insert--,!(O.lookahead+O.insert<M)););}while(O.lookahead<H&&O.strm.avail_in!==0)}function Rt(O,gt){for(var ut,K;;){if(O.lookahead<H){if(Nt(O),O.lookahead<H&&gt===p)return L;if(O.lookahead===0)break}if(ut=0,O.lookahead>=M&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+M-1])&O.hash_mask,ut=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),ut!==0&&O.strstart-ut<=O.w_size-H&&(O.match_length=xt(O,ut)),O.match_length>=M)if(K=l._tr_tally(O,O.strstart-O.match_start,O.match_length-M),O.lookahead-=O.match_length,O.match_length<=O.max_lazy_match&&O.lookahead>=M){for(O.match_length--;O.strstart++,O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+M-1])&O.hash_mask,ut=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart,--O.match_length!=0;);O.strstart++}else O.strstart+=O.match_length,O.match_length=0,O.ins_h=O.window[O.strstart],O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+1])&O.hash_mask;else K=l._tr_tally(O,0,O.window[O.strstart]),O.lookahead--,O.strstart++;if(K&&(j(O,!1),O.strm.avail_out===0))return L}return O.insert=O.strstart<M-1?O.strstart:M-1,gt===m?(j(O,!0),O.strm.avail_out===0?Z:q):O.last_lit&&(j(O,!1),O.strm.avail_out===0)?L:it}function z(O,gt){for(var ut,K,X;;){if(O.lookahead<H){if(Nt(O),O.lookahead<H&&gt===p)return L;if(O.lookahead===0)break}if(ut=0,O.lookahead>=M&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+M-1])&O.hash_mask,ut=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),O.prev_length=O.match_length,O.prev_match=O.match_start,O.match_length=M-1,ut!==0&&O.prev_length<O.max_lazy_match&&O.strstart-ut<=O.w_size-H&&(O.match_length=xt(O,ut),O.match_length<=5&&(O.strategy===1||O.match_length===M&&4096<O.strstart-O.match_start)&&(O.match_length=M-1)),O.prev_length>=M&&O.match_length<=O.prev_length){for(X=O.strstart+O.lookahead-M,K=l._tr_tally(O,O.strstart-1-O.prev_match,O.prev_length-M),O.lookahead-=O.prev_length-1,O.prev_length-=2;++O.strstart<=X&&(O.ins_h=(O.ins_h<<O.hash_shift^O.window[O.strstart+M-1])&O.hash_mask,ut=O.prev[O.strstart&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=O.strstart),--O.prev_length!=0;);if(O.match_available=0,O.match_length=M-1,O.strstart++,K&&(j(O,!1),O.strm.avail_out===0))return L}else if(O.match_available){if((K=l._tr_tally(O,0,O.window[O.strstart-1]))&&j(O,!1),O.strstart++,O.lookahead--,O.strm.avail_out===0)return L}else O.match_available=1,O.strstart++,O.lookahead--}return O.match_available&&(K=l._tr_tally(O,0,O.window[O.strstart-1]),O.match_available=0),O.insert=O.strstart<M-1?O.strstart:M-1,gt===m?(j(O,!0),O.strm.avail_out===0?Z:q):O.last_lit&&(j(O,!1),O.strm.avail_out===0)?L:it}function lt(O,gt,ut,K,X){this.good_length=O,this.max_lazy=gt,this.nice_length=ut,this.max_chain=K,this.func=X}function J(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=S,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*D),this.dyn_dtree=new a.Buf16(2*(2*R+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),P(this.dyn_ltree),P(this.dyn_dtree),P(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(I+1),this.heap=new a.Buf16(2*C+1),P(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*C+1),P(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ot(O){var gt;return O&&O.state?(O.total_in=O.total_out=0,O.data_type=w,(gt=O.state).pending=0,gt.pending_out=0,gt.wrap<0&&(gt.wrap=-gt.wrap),gt.status=gt.wrap?F:rt,O.adler=gt.wrap===2?0:1,gt.last_flush=p,l._tr_init(gt),v):Ct(O,x)}function yt(O){var gt=ot(O);return gt===v&&function(ut){ut.window_size=2*ut.w_size,P(ut.head),ut.max_lazy_match=s[ut.level].max_lazy,ut.good_match=s[ut.level].good_length,ut.nice_match=s[ut.level].nice_length,ut.max_chain_length=s[ut.level].max_chain,ut.strstart=0,ut.block_start=0,ut.lookahead=0,ut.insert=0,ut.match_length=ut.prev_length=M-1,ut.match_available=0,ut.ins_h=0}(O.state),gt}function At(O,gt,ut,K,X,pt){if(!O)return x;var Bt=1;if(gt===_&&(gt=6),K<0?(Bt=0,K=-K):15<K&&(Bt=2,K-=16),X<1||T<X||ut!==S||K<8||15<K||gt<0||9<gt||pt<0||y<pt)return Ct(O,x);K===8&&(K=9);var Ht=new J;return(O.state=Ht).strm=O,Ht.wrap=Bt,Ht.gzhead=null,Ht.w_bits=K,Ht.w_size=1<<Ht.w_bits,Ht.w_mask=Ht.w_size-1,Ht.hash_bits=X+7,Ht.hash_size=1<<Ht.hash_bits,Ht.hash_mask=Ht.hash_size-1,Ht.hash_shift=~~((Ht.hash_bits+M-1)/M),Ht.window=new a.Buf8(2*Ht.w_size),Ht.head=new a.Buf16(Ht.hash_size),Ht.prev=new a.Buf16(Ht.w_size),Ht.lit_bufsize=1<<X+6,Ht.pending_buf_size=4*Ht.lit_bufsize,Ht.pending_buf=new a.Buf8(Ht.pending_buf_size),Ht.d_buf=1*Ht.lit_bufsize,Ht.l_buf=3*Ht.lit_bufsize,Ht.level=gt,Ht.strategy=pt,Ht.method=ut,yt(O)}s=[new lt(0,0,0,0,function(O,gt){var ut=65535;for(ut>O.pending_buf_size-5&&(ut=O.pending_buf_size-5);;){if(O.lookahead<=1){if(Nt(O),O.lookahead===0&&gt===p)return L;if(O.lookahead===0)break}O.strstart+=O.lookahead,O.lookahead=0;var K=O.block_start+ut;if((O.strstart===0||O.strstart>=K)&&(O.lookahead=O.strstart-K,O.strstart=K,j(O,!1),O.strm.avail_out===0)||O.strstart-O.block_start>=O.w_size-H&&(j(O,!1),O.strm.avail_out===0))return L}return O.insert=0,gt===m?(j(O,!0),O.strm.avail_out===0?Z:q):(O.strstart>O.block_start&&(j(O,!1),O.strm.avail_out),L)}),new lt(4,4,8,4,Rt),new lt(4,5,16,8,Rt),new lt(4,6,32,32,Rt),new lt(4,4,16,16,z),new lt(8,16,32,32,z),new lt(8,16,128,128,z),new lt(8,32,128,256,z),new lt(32,128,258,1024,z),new lt(32,258,258,4096,z)],i.deflateInit=function(O,gt){return At(O,gt,S,15,8,0)},i.deflateInit2=At,i.deflateReset=yt,i.deflateResetKeep=ot,i.deflateSetHeader=function(O,gt){return O&&O.state?O.state.wrap!==2?x:(O.state.gzhead=gt,v):x},i.deflate=function(O,gt){var ut,K,X,pt;if(!O||!O.state||5<gt||gt<0)return O?Ct(O,x):x;if(K=O.state,!O.output||!O.input&&O.avail_in!==0||K.status===666&&gt!==m)return Ct(O,O.avail_out===0?-5:x);if(K.strm=O,ut=K.last_flush,K.last_flush=gt,K.status===F)if(K.wrap===2)O.adler=0,et(K,31),et(K,139),et(K,8),K.gzhead?(et(K,(K.gzhead.text?1:0)+(K.gzhead.hcrc?2:0)+(K.gzhead.extra?4:0)+(K.gzhead.name?8:0)+(K.gzhead.comment?16:0)),et(K,255&K.gzhead.time),et(K,K.gzhead.time>>8&255),et(K,K.gzhead.time>>16&255),et(K,K.gzhead.time>>24&255),et(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),et(K,255&K.gzhead.os),K.gzhead.extra&&K.gzhead.extra.length&&(et(K,255&K.gzhead.extra.length),et(K,K.gzhead.extra.length>>8&255)),K.gzhead.hcrc&&(O.adler=f(O.adler,K.pending_buf,K.pending,0)),K.gzindex=0,K.status=69):(et(K,0),et(K,0),et(K,0),et(K,0),et(K,0),et(K,K.level===9?2:2<=K.strategy||K.level<2?4:0),et(K,3),K.status=rt);else{var Bt=S+(K.w_bits-8<<4)<<8;Bt|=(2<=K.strategy||K.level<2?0:K.level<6?1:K.level===6?2:3)<<6,K.strstart!==0&&(Bt|=32),Bt+=31-Bt%31,K.status=rt,dt(K,Bt),K.strstart!==0&&(dt(K,O.adler>>>16),dt(K,65535&O.adler)),O.adler=1}if(K.status===69)if(K.gzhead.extra){for(X=K.pending;K.gzindex<(65535&K.gzhead.extra.length)&&(K.pending!==K.pending_buf_size||(K.gzhead.hcrc&&K.pending>X&&(O.adler=f(O.adler,K.pending_buf,K.pending-X,X)),V(O),X=K.pending,K.pending!==K.pending_buf_size));)et(K,255&K.gzhead.extra[K.gzindex]),K.gzindex++;K.gzhead.hcrc&&K.pending>X&&(O.adler=f(O.adler,K.pending_buf,K.pending-X,X)),K.gzindex===K.gzhead.extra.length&&(K.gzindex=0,K.status=73)}else K.status=73;if(K.status===73)if(K.gzhead.name){X=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>X&&(O.adler=f(O.adler,K.pending_buf,K.pending-X,X)),V(O),X=K.pending,K.pending===K.pending_buf_size)){pt=1;break}pt=K.gzindex<K.gzhead.name.length?255&K.gzhead.name.charCodeAt(K.gzindex++):0,et(K,pt)}while(pt!==0);K.gzhead.hcrc&&K.pending>X&&(O.adler=f(O.adler,K.pending_buf,K.pending-X,X)),pt===0&&(K.gzindex=0,K.status=91)}else K.status=91;if(K.status===91)if(K.gzhead.comment){X=K.pending;do{if(K.pending===K.pending_buf_size&&(K.gzhead.hcrc&&K.pending>X&&(O.adler=f(O.adler,K.pending_buf,K.pending-X,X)),V(O),X=K.pending,K.pending===K.pending_buf_size)){pt=1;break}pt=K.gzindex<K.gzhead.comment.length?255&K.gzhead.comment.charCodeAt(K.gzindex++):0,et(K,pt)}while(pt!==0);K.gzhead.hcrc&&K.pending>X&&(O.adler=f(O.adler,K.pending_buf,K.pending-X,X)),pt===0&&(K.status=103)}else K.status=103;if(K.status===103&&(K.gzhead.hcrc?(K.pending+2>K.pending_buf_size&&V(O),K.pending+2<=K.pending_buf_size&&(et(K,255&O.adler),et(K,O.adler>>8&255),O.adler=0,K.status=rt)):K.status=rt),K.pending!==0){if(V(O),O.avail_out===0)return K.last_flush=-1,v}else if(O.avail_in===0&&at(gt)<=at(ut)&&gt!==m)return Ct(O,-5);if(K.status===666&&O.avail_in!==0)return Ct(O,-5);if(O.avail_in!==0||K.lookahead!==0||gt!==p&&K.status!==666){var Ht=K.strategy===2?function(St,It){for(var Tt;;){if(St.lookahead===0&&(Nt(St),St.lookahead===0)){if(It===p)return L;break}if(St.match_length=0,Tt=l._tr_tally(St,0,St.window[St.strstart]),St.lookahead--,St.strstart++,Tt&&(j(St,!1),St.strm.avail_out===0))return L}return St.insert=0,It===m?(j(St,!0),St.strm.avail_out===0?Z:q):St.last_lit&&(j(St,!1),St.strm.avail_out===0)?L:it}(K,gt):K.strategy===3?function(St,It){for(var Tt,vt,te,ae,ne=St.window;;){if(St.lookahead<=B){if(Nt(St),St.lookahead<=B&&It===p)return L;if(St.lookahead===0)break}if(St.match_length=0,St.lookahead>=M&&0<St.strstart&&(vt=ne[te=St.strstart-1])===ne[++te]&&vt===ne[++te]&&vt===ne[++te]){ae=St.strstart+B;do;while(vt===ne[++te]&&vt===ne[++te]&&vt===ne[++te]&&vt===ne[++te]&&vt===ne[++te]&&vt===ne[++te]&&vt===ne[++te]&&vt===ne[++te]&&te<ae);St.match_length=B-(ae-te),St.match_length>St.lookahead&&(St.match_length=St.lookahead)}if(St.match_length>=M?(Tt=l._tr_tally(St,1,St.match_length-M),St.lookahead-=St.match_length,St.strstart+=St.match_length,St.match_length=0):(Tt=l._tr_tally(St,0,St.window[St.strstart]),St.lookahead--,St.strstart++),Tt&&(j(St,!1),St.strm.avail_out===0))return L}return St.insert=0,It===m?(j(St,!0),St.strm.avail_out===0?Z:q):St.last_lit&&(j(St,!1),St.strm.avail_out===0)?L:it}(K,gt):s[K.level].func(K,gt);if(Ht!==Z&&Ht!==q||(K.status=666),Ht===L||Ht===Z)return O.avail_out===0&&(K.last_flush=-1),v;if(Ht===it&&(gt===1?l._tr_align(K):gt!==5&&(l._tr_stored_block(K,0,0,!1),gt===3&&(P(K.head),K.lookahead===0&&(K.strstart=0,K.block_start=0,K.insert=0))),V(O),O.avail_out===0))return K.last_flush=-1,v}return gt!==m?v:K.wrap<=0?1:(K.wrap===2?(et(K,255&O.adler),et(K,O.adler>>8&255),et(K,O.adler>>16&255),et(K,O.adler>>24&255),et(K,255&O.total_in),et(K,O.total_in>>8&255),et(K,O.total_in>>16&255),et(K,O.total_in>>24&255)):(dt(K,O.adler>>>16),dt(K,65535&O.adler)),V(O),0<K.wrap&&(K.wrap=-K.wrap),K.pending!==0?v:1)},i.deflateEnd=function(O){var gt;return O&&O.state?(gt=O.state.status)!==F&&gt!==69&&gt!==73&&gt!==91&&gt!==103&&gt!==rt&&gt!==666?Ct(O,x):(O.state=null,gt===rt?Ct(O,-3):v):x},i.deflateSetDictionary=function(O,gt){var ut,K,X,pt,Bt,Ht,St,It,Tt=gt.length;if(!O||!O.state||(pt=(ut=O.state).wrap)===2||pt===1&&ut.status!==F||ut.lookahead)return x;for(pt===1&&(O.adler=u(O.adler,gt,Tt,0)),ut.wrap=0,Tt>=ut.w_size&&(pt===0&&(P(ut.head),ut.strstart=0,ut.block_start=0,ut.insert=0),It=new a.Buf8(ut.w_size),a.arraySet(It,gt,Tt-ut.w_size,ut.w_size,0),gt=It,Tt=ut.w_size),Bt=O.avail_in,Ht=O.next_in,St=O.input,O.avail_in=Tt,O.next_in=0,O.input=gt,Nt(ut);ut.lookahead>=M;){for(K=ut.strstart,X=ut.lookahead-(M-1);ut.ins_h=(ut.ins_h<<ut.hash_shift^ut.window[K+M-1])&ut.hash_mask,ut.prev[K&ut.w_mask]=ut.head[ut.ins_h],ut.head[ut.ins_h]=K,K++,--X;);ut.strstart=K,ut.lookahead=M-1,Nt(ut)}return ut.strstart+=ut.lookahead,ut.block_start=ut.strstart,ut.insert=ut.lookahead,ut.lookahead=0,ut.match_length=ut.prev_length=M-1,ut.match_available=0,O.next_in=Ht,O.input=St,O.avail_in=Bt,ut.wrap=pt,v},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,i){r.exports=function(s,a){var l,u,f,d,p,m,v,x,_,y,w,S,T,C,R,N,D,I,M,B,H,F,rt,L,it;l=s.state,u=s.next_in,L=s.input,f=u+(s.avail_in-5),d=s.next_out,it=s.output,p=d-(a-s.avail_out),m=d+(s.avail_out-257),v=l.dmax,x=l.wsize,_=l.whave,y=l.wnext,w=l.window,S=l.hold,T=l.bits,C=l.lencode,R=l.distcode,N=(1<<l.lenbits)-1,D=(1<<l.distbits)-1;t:do{T<15&&(S+=L[u++]<<T,T+=8,S+=L[u++]<<T,T+=8),I=C[S&N];e:for(;;){if(S>>>=M=I>>>24,T-=M,(M=I>>>16&255)===0)it[d++]=65535&I;else{if(!(16&M)){if((64&M)==0){I=C[(65535&I)+(S&(1<<M)-1)];continue e}if(32&M){l.mode=12;break t}s.msg="invalid literal/length code",l.mode=30;break t}B=65535&I,(M&=15)&&(T<M&&(S+=L[u++]<<T,T+=8),B+=S&(1<<M)-1,S>>>=M,T-=M),T<15&&(S+=L[u++]<<T,T+=8,S+=L[u++]<<T,T+=8),I=R[S&D];n:for(;;){if(S>>>=M=I>>>24,T-=M,!(16&(M=I>>>16&255))){if((64&M)==0){I=R[(65535&I)+(S&(1<<M)-1)];continue n}s.msg="invalid distance code",l.mode=30;break t}if(H=65535&I,T<(M&=15)&&(S+=L[u++]<<T,(T+=8)<M&&(S+=L[u++]<<T,T+=8)),v<(H+=S&(1<<M)-1)){s.msg="invalid distance too far back",l.mode=30;break t}if(S>>>=M,T-=M,(M=d-p)<H){if(_<(M=H-M)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break t}if(rt=w,(F=0)===y){if(F+=x-M,M<B){for(B-=M;it[d++]=w[F++],--M;);F=d-H,rt=it}}else if(y<M){if(F+=x+y-M,(M-=y)<B){for(B-=M;it[d++]=w[F++],--M;);if(F=0,y<B){for(B-=M=y;it[d++]=w[F++],--M;);F=d-H,rt=it}}}else if(F+=y-M,M<B){for(B-=M;it[d++]=w[F++],--M;);F=d-H,rt=it}for(;2<B;)it[d++]=rt[F++],it[d++]=rt[F++],it[d++]=rt[F++],B-=3;B&&(it[d++]=rt[F++],1<B&&(it[d++]=rt[F++]))}else{for(F=d-H;it[d++]=it[F++],it[d++]=it[F++],it[d++]=it[F++],2<(B-=3););B&&(it[d++]=it[F++],1<B&&(it[d++]=it[F++]))}break}}break}}while(u<f&&d<m);u-=B=T>>3,S&=(1<<(T-=B<<3))-1,s.next_in=u,s.next_out=d,s.avail_in=u<f?f-u+5:5-(u-f),s.avail_out=d<m?m-d+257:257-(d-m),l.hold=S,l.bits=T}},{}],49:[function(e,r,i){var s=e("../utils/common"),a=e("./adler32"),l=e("./crc32"),u=e("./inffast"),f=e("./inftrees"),d=1,p=2,m=0,v=-2,x=1,_=852,y=592;function w(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function S(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(F){var rt;return F&&F.state?(rt=F.state,F.total_in=F.total_out=rt.total=0,F.msg="",rt.wrap&&(F.adler=1&rt.wrap),rt.mode=x,rt.last=0,rt.havedict=0,rt.dmax=32768,rt.head=null,rt.hold=0,rt.bits=0,rt.lencode=rt.lendyn=new s.Buf32(_),rt.distcode=rt.distdyn=new s.Buf32(y),rt.sane=1,rt.back=-1,m):v}function C(F){var rt;return F&&F.state?((rt=F.state).wsize=0,rt.whave=0,rt.wnext=0,T(F)):v}function R(F,rt){var L,it;return F&&F.state?(it=F.state,rt<0?(L=0,rt=-rt):(L=1+(rt>>4),rt<48&&(rt&=15)),rt&&(rt<8||15<rt)?v:(it.window!==null&&it.wbits!==rt&&(it.window=null),it.wrap=L,it.wbits=rt,C(F))):v}function N(F,rt){var L,it;return F?(it=new S,(F.state=it).window=null,(L=R(F,rt))!==m&&(F.state=null),L):v}var D,I,M=!0;function B(F){if(M){var rt;for(D=new s.Buf32(512),I=new s.Buf32(32),rt=0;rt<144;)F.lens[rt++]=8;for(;rt<256;)F.lens[rt++]=9;for(;rt<280;)F.lens[rt++]=7;for(;rt<288;)F.lens[rt++]=8;for(f(d,F.lens,0,288,D,0,F.work,{bits:9}),rt=0;rt<32;)F.lens[rt++]=5;f(p,F.lens,0,32,I,0,F.work,{bits:5}),M=!1}F.lencode=D,F.lenbits=9,F.distcode=I,F.distbits=5}function H(F,rt,L,it){var Z,q=F.state;return q.window===null&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=0,q.window=new s.Buf8(q.wsize)),it>=q.wsize?(s.arraySet(q.window,rt,L-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(it<(Z=q.wsize-q.wnext)&&(Z=it),s.arraySet(q.window,rt,L-it,Z,q.wnext),(it-=Z)?(s.arraySet(q.window,rt,L-it,it,0),q.wnext=it,q.whave=q.wsize):(q.wnext+=Z,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=Z))),0}i.inflateReset=C,i.inflateReset2=R,i.inflateResetKeep=T,i.inflateInit=function(F){return N(F,15)},i.inflateInit2=N,i.inflate=function(F,rt){var L,it,Z,q,Ct,at,P,V,j,et,dt,xt,Nt,Rt,z,lt,J,ot,yt,At,O,gt,ut,K,X=0,pt=new s.Buf8(4),Bt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return v;(L=F.state).mode===12&&(L.mode=13),Ct=F.next_out,Z=F.output,P=F.avail_out,q=F.next_in,it=F.input,at=F.avail_in,V=L.hold,j=L.bits,et=at,dt=P,gt=m;t:for(;;)switch(L.mode){case x:if(L.wrap===0){L.mode=13;break}for(;j<16;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if(2&L.wrap&&V===35615){pt[L.check=0]=255&V,pt[1]=V>>>8&255,L.check=l(L.check,pt,2,0),j=V=0,L.mode=2;break}if(L.flags=0,L.head&&(L.head.done=!1),!(1&L.wrap)||(((255&V)<<8)+(V>>8))%31){F.msg="incorrect header check",L.mode=30;break}if((15&V)!=8){F.msg="unknown compression method",L.mode=30;break}if(j-=4,O=8+(15&(V>>>=4)),L.wbits===0)L.wbits=O;else if(O>L.wbits){F.msg="invalid window size",L.mode=30;break}L.dmax=1<<O,F.adler=L.check=1,L.mode=512&V?10:12,j=V=0;break;case 2:for(;j<16;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if(L.flags=V,(255&L.flags)!=8){F.msg="unknown compression method",L.mode=30;break}if(57344&L.flags){F.msg="unknown header flags set",L.mode=30;break}L.head&&(L.head.text=V>>8&1),512&L.flags&&(pt[0]=255&V,pt[1]=V>>>8&255,L.check=l(L.check,pt,2,0)),j=V=0,L.mode=3;case 3:for(;j<32;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}L.head&&(L.head.time=V),512&L.flags&&(pt[0]=255&V,pt[1]=V>>>8&255,pt[2]=V>>>16&255,pt[3]=V>>>24&255,L.check=l(L.check,pt,4,0)),j=V=0,L.mode=4;case 4:for(;j<16;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}L.head&&(L.head.xflags=255&V,L.head.os=V>>8),512&L.flags&&(pt[0]=255&V,pt[1]=V>>>8&255,L.check=l(L.check,pt,2,0)),j=V=0,L.mode=5;case 5:if(1024&L.flags){for(;j<16;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}L.length=V,L.head&&(L.head.extra_len=V),512&L.flags&&(pt[0]=255&V,pt[1]=V>>>8&255,L.check=l(L.check,pt,2,0)),j=V=0}else L.head&&(L.head.extra=null);L.mode=6;case 6:if(1024&L.flags&&(at<(xt=L.length)&&(xt=at),xt&&(L.head&&(O=L.head.extra_len-L.length,L.head.extra||(L.head.extra=new Array(L.head.extra_len)),s.arraySet(L.head.extra,it,q,xt,O)),512&L.flags&&(L.check=l(L.check,it,xt,q)),at-=xt,q+=xt,L.length-=xt),L.length))break t;L.length=0,L.mode=7;case 7:if(2048&L.flags){if(at===0)break t;for(xt=0;O=it[q+xt++],L.head&&O&&L.length<65536&&(L.head.name+=String.fromCharCode(O)),O&&xt<at;);if(512&L.flags&&(L.check=l(L.check,it,xt,q)),at-=xt,q+=xt,O)break t}else L.head&&(L.head.name=null);L.length=0,L.mode=8;case 8:if(4096&L.flags){if(at===0)break t;for(xt=0;O=it[q+xt++],L.head&&O&&L.length<65536&&(L.head.comment+=String.fromCharCode(O)),O&&xt<at;);if(512&L.flags&&(L.check=l(L.check,it,xt,q)),at-=xt,q+=xt,O)break t}else L.head&&(L.head.comment=null);L.mode=9;case 9:if(512&L.flags){for(;j<16;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if(V!==(65535&L.check)){F.msg="header crc mismatch",L.mode=30;break}j=V=0}L.head&&(L.head.hcrc=L.flags>>9&1,L.head.done=!0),F.adler=L.check=0,L.mode=12;break;case 10:for(;j<32;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}F.adler=L.check=w(V),j=V=0,L.mode=11;case 11:if(L.havedict===0)return F.next_out=Ct,F.avail_out=P,F.next_in=q,F.avail_in=at,L.hold=V,L.bits=j,2;F.adler=L.check=1,L.mode=12;case 12:if(rt===5||rt===6)break t;case 13:if(L.last){V>>>=7&j,j-=7&j,L.mode=27;break}for(;j<3;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}switch(L.last=1&V,j-=1,3&(V>>>=1)){case 0:L.mode=14;break;case 1:if(B(L),L.mode=20,rt!==6)break;V>>>=2,j-=2;break t;case 2:L.mode=17;break;case 3:F.msg="invalid block type",L.mode=30}V>>>=2,j-=2;break;case 14:for(V>>>=7&j,j-=7&j;j<32;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if((65535&V)!=(V>>>16^65535)){F.msg="invalid stored block lengths",L.mode=30;break}if(L.length=65535&V,j=V=0,L.mode=15,rt===6)break t;case 15:L.mode=16;case 16:if(xt=L.length){if(at<xt&&(xt=at),P<xt&&(xt=P),xt===0)break t;s.arraySet(Z,it,q,xt,Ct),at-=xt,q+=xt,P-=xt,Ct+=xt,L.length-=xt;break}L.mode=12;break;case 17:for(;j<14;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if(L.nlen=257+(31&V),V>>>=5,j-=5,L.ndist=1+(31&V),V>>>=5,j-=5,L.ncode=4+(15&V),V>>>=4,j-=4,286<L.nlen||30<L.ndist){F.msg="too many length or distance symbols",L.mode=30;break}L.have=0,L.mode=18;case 18:for(;L.have<L.ncode;){for(;j<3;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}L.lens[Bt[L.have++]]=7&V,V>>>=3,j-=3}for(;L.have<19;)L.lens[Bt[L.have++]]=0;if(L.lencode=L.lendyn,L.lenbits=7,ut={bits:L.lenbits},gt=f(0,L.lens,0,19,L.lencode,0,L.work,ut),L.lenbits=ut.bits,gt){F.msg="invalid code lengths set",L.mode=30;break}L.have=0,L.mode=19;case 19:for(;L.have<L.nlen+L.ndist;){for(;lt=(X=L.lencode[V&(1<<L.lenbits)-1])>>>16&255,J=65535&X,!((z=X>>>24)<=j);){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if(J<16)V>>>=z,j-=z,L.lens[L.have++]=J;else{if(J===16){for(K=z+2;j<K;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if(V>>>=z,j-=z,L.have===0){F.msg="invalid bit length repeat",L.mode=30;break}O=L.lens[L.have-1],xt=3+(3&V),V>>>=2,j-=2}else if(J===17){for(K=z+3;j<K;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}j-=z,O=0,xt=3+(7&(V>>>=z)),V>>>=3,j-=3}else{for(K=z+7;j<K;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}j-=z,O=0,xt=11+(127&(V>>>=z)),V>>>=7,j-=7}if(L.have+xt>L.nlen+L.ndist){F.msg="invalid bit length repeat",L.mode=30;break}for(;xt--;)L.lens[L.have++]=O}}if(L.mode===30)break;if(L.lens[256]===0){F.msg="invalid code -- missing end-of-block",L.mode=30;break}if(L.lenbits=9,ut={bits:L.lenbits},gt=f(d,L.lens,0,L.nlen,L.lencode,0,L.work,ut),L.lenbits=ut.bits,gt){F.msg="invalid literal/lengths set",L.mode=30;break}if(L.distbits=6,L.distcode=L.distdyn,ut={bits:L.distbits},gt=f(p,L.lens,L.nlen,L.ndist,L.distcode,0,L.work,ut),L.distbits=ut.bits,gt){F.msg="invalid distances set",L.mode=30;break}if(L.mode=20,rt===6)break t;case 20:L.mode=21;case 21:if(6<=at&&258<=P){F.next_out=Ct,F.avail_out=P,F.next_in=q,F.avail_in=at,L.hold=V,L.bits=j,u(F,dt),Ct=F.next_out,Z=F.output,P=F.avail_out,q=F.next_in,it=F.input,at=F.avail_in,V=L.hold,j=L.bits,L.mode===12&&(L.back=-1);break}for(L.back=0;lt=(X=L.lencode[V&(1<<L.lenbits)-1])>>>16&255,J=65535&X,!((z=X>>>24)<=j);){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if(lt&&(240&lt)==0){for(ot=z,yt=lt,At=J;lt=(X=L.lencode[At+((V&(1<<ot+yt)-1)>>ot)])>>>16&255,J=65535&X,!(ot+(z=X>>>24)<=j);){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}V>>>=ot,j-=ot,L.back+=ot}if(V>>>=z,j-=z,L.back+=z,L.length=J,lt===0){L.mode=26;break}if(32&lt){L.back=-1,L.mode=12;break}if(64&lt){F.msg="invalid literal/length code",L.mode=30;break}L.extra=15&lt,L.mode=22;case 22:if(L.extra){for(K=L.extra;j<K;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}L.length+=V&(1<<L.extra)-1,V>>>=L.extra,j-=L.extra,L.back+=L.extra}L.was=L.length,L.mode=23;case 23:for(;lt=(X=L.distcode[V&(1<<L.distbits)-1])>>>16&255,J=65535&X,!((z=X>>>24)<=j);){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if((240&lt)==0){for(ot=z,yt=lt,At=J;lt=(X=L.distcode[At+((V&(1<<ot+yt)-1)>>ot)])>>>16&255,J=65535&X,!(ot+(z=X>>>24)<=j);){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}V>>>=ot,j-=ot,L.back+=ot}if(V>>>=z,j-=z,L.back+=z,64&lt){F.msg="invalid distance code",L.mode=30;break}L.offset=J,L.extra=15&lt,L.mode=24;case 24:if(L.extra){for(K=L.extra;j<K;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}L.offset+=V&(1<<L.extra)-1,V>>>=L.extra,j-=L.extra,L.back+=L.extra}if(L.offset>L.dmax){F.msg="invalid distance too far back",L.mode=30;break}L.mode=25;case 25:if(P===0)break t;if(xt=dt-P,L.offset>xt){if((xt=L.offset-xt)>L.whave&&L.sane){F.msg="invalid distance too far back",L.mode=30;break}Nt=xt>L.wnext?(xt-=L.wnext,L.wsize-xt):L.wnext-xt,xt>L.length&&(xt=L.length),Rt=L.window}else Rt=Z,Nt=Ct-L.offset,xt=L.length;for(P<xt&&(xt=P),P-=xt,L.length-=xt;Z[Ct++]=Rt[Nt++],--xt;);L.length===0&&(L.mode=21);break;case 26:if(P===0)break t;Z[Ct++]=L.length,P--,L.mode=21;break;case 27:if(L.wrap){for(;j<32;){if(at===0)break t;at--,V|=it[q++]<<j,j+=8}if(dt-=P,F.total_out+=dt,L.total+=dt,dt&&(F.adler=L.check=L.flags?l(L.check,Z,dt,Ct-dt):a(L.check,Z,dt,Ct-dt)),dt=P,(L.flags?V:w(V))!==L.check){F.msg="incorrect data check",L.mode=30;break}j=V=0}L.mode=28;case 28:if(L.wrap&&L.flags){for(;j<32;){if(at===0)break t;at--,V+=it[q++]<<j,j+=8}if(V!==(4294967295&L.total)){F.msg="incorrect length check",L.mode=30;break}j=V=0}L.mode=29;case 29:gt=1;break t;case 30:gt=-3;break t;case 31:return-4;case 32:default:return v}return F.next_out=Ct,F.avail_out=P,F.next_in=q,F.avail_in=at,L.hold=V,L.bits=j,(L.wsize||dt!==F.avail_out&&L.mode<30&&(L.mode<27||rt!==4))&&H(F,F.output,F.next_out,dt-F.avail_out)?(L.mode=31,-4):(et-=F.avail_in,dt-=F.avail_out,F.total_in+=et,F.total_out+=dt,L.total+=dt,L.wrap&&dt&&(F.adler=L.check=L.flags?l(L.check,Z,dt,F.next_out-dt):a(L.check,Z,dt,F.next_out-dt)),F.data_type=L.bits+(L.last?64:0)+(L.mode===12?128:0)+(L.mode===20||L.mode===15?256:0),(et==0&&dt===0||rt===4)&&gt===m&&(gt=-5),gt)},i.inflateEnd=function(F){if(!F||!F.state)return v;var rt=F.state;return rt.window&&(rt.window=null),F.state=null,m},i.inflateGetHeader=function(F,rt){var L;return F&&F.state?(2&(L=F.state).wrap)==0?v:((L.head=rt).done=!1,m):v},i.inflateSetDictionary=function(F,rt){var L,it=rt.length;return F&&F.state?(L=F.state).wrap!==0&&L.mode!==11?v:L.mode===11&&a(1,rt,it,0)!==L.check?-3:H(F,rt,it,it)?(L.mode=31,-4):(L.havedict=1,m):v},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,i){var s=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(d,p,m,v,x,_,y,w){var S,T,C,R,N,D,I,M,B,H=w.bits,F=0,rt=0,L=0,it=0,Z=0,q=0,Ct=0,at=0,P=0,V=0,j=null,et=0,dt=new s.Buf16(16),xt=new s.Buf16(16),Nt=null,Rt=0;for(F=0;F<=15;F++)dt[F]=0;for(rt=0;rt<v;rt++)dt[p[m+rt]]++;for(Z=H,it=15;1<=it&&dt[it]===0;it--);if(it<Z&&(Z=it),it===0)return x[_++]=20971520,x[_++]=20971520,w.bits=1,0;for(L=1;L<it&&dt[L]===0;L++);for(Z<L&&(Z=L),F=at=1;F<=15;F++)if(at<<=1,(at-=dt[F])<0)return-1;if(0<at&&(d===0||it!==1))return-1;for(xt[1]=0,F=1;F<15;F++)xt[F+1]=xt[F]+dt[F];for(rt=0;rt<v;rt++)p[m+rt]!==0&&(y[xt[p[m+rt]]++]=rt);if(D=d===0?(j=Nt=y,19):d===1?(j=a,et-=257,Nt=l,Rt-=257,256):(j=u,Nt=f,-1),F=L,N=_,Ct=rt=V=0,C=-1,R=(P=1<<(q=Z))-1,d===1&&852<P||d===2&&592<P)return 1;for(;;){for(I=F-Ct,B=y[rt]<D?(M=0,y[rt]):y[rt]>D?(M=Nt[Rt+y[rt]],j[et+y[rt]]):(M=96,0),S=1<<F-Ct,L=T=1<<q;x[N+(V>>Ct)+(T-=S)]=I<<24|M<<16|B|0,T!==0;);for(S=1<<F-1;V&S;)S>>=1;if(S!==0?(V&=S-1,V+=S):V=0,rt++,--dt[F]==0){if(F===it)break;F=p[m+y[rt]]}if(Z<F&&(V&R)!==C){for(Ct===0&&(Ct=Z),N+=L,at=1<<(q=F-Ct);q+Ct<it&&!((at-=dt[q+Ct])<=0);)q++,at<<=1;if(P+=1<<q,d===1&&852<P||d===2&&592<P)return 1;x[C=V&R]=Z<<24|q<<16|N-_|0}}return V!==0&&(x[N+V]=F-Ct<<24|64<<16|0),w.bits=Z,0}},{"../utils/common":41}],51:[function(e,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,i){var s=e("../utils/common"),a=0,l=1;function u(X){for(var pt=X.length;0<=--pt;)X[pt]=0}var f=0,d=29,p=256,m=p+1+d,v=30,x=19,_=2*m+1,y=15,w=16,S=7,T=256,C=16,R=17,N=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(m+2));u(H);var F=new Array(2*v);u(F);var rt=new Array(512);u(rt);var L=new Array(256);u(L);var it=new Array(d);u(it);var Z,q,Ct,at=new Array(v);function P(X,pt,Bt,Ht,St){this.static_tree=X,this.extra_bits=pt,this.extra_base=Bt,this.elems=Ht,this.max_length=St,this.has_stree=X&&X.length}function V(X,pt){this.dyn_tree=X,this.max_code=0,this.stat_desc=pt}function j(X){return X<256?rt[X]:rt[256+(X>>>7)]}function et(X,pt){X.pending_buf[X.pending++]=255&pt,X.pending_buf[X.pending++]=pt>>>8&255}function dt(X,pt,Bt){X.bi_valid>w-Bt?(X.bi_buf|=pt<<X.bi_valid&65535,et(X,X.bi_buf),X.bi_buf=pt>>w-X.bi_valid,X.bi_valid+=Bt-w):(X.bi_buf|=pt<<X.bi_valid&65535,X.bi_valid+=Bt)}function xt(X,pt,Bt){dt(X,Bt[2*pt],Bt[2*pt+1])}function Nt(X,pt){for(var Bt=0;Bt|=1&X,X>>>=1,Bt<<=1,0<--pt;);return Bt>>>1}function Rt(X,pt,Bt){var Ht,St,It=new Array(y+1),Tt=0;for(Ht=1;Ht<=y;Ht++)It[Ht]=Tt=Tt+Bt[Ht-1]<<1;for(St=0;St<=pt;St++){var vt=X[2*St+1];vt!==0&&(X[2*St]=Nt(It[vt]++,vt))}}function z(X){var pt;for(pt=0;pt<m;pt++)X.dyn_ltree[2*pt]=0;for(pt=0;pt<v;pt++)X.dyn_dtree[2*pt]=0;for(pt=0;pt<x;pt++)X.bl_tree[2*pt]=0;X.dyn_ltree[2*T]=1,X.opt_len=X.static_len=0,X.last_lit=X.matches=0}function lt(X){8<X.bi_valid?et(X,X.bi_buf):0<X.bi_valid&&(X.pending_buf[X.pending++]=X.bi_buf),X.bi_buf=0,X.bi_valid=0}function J(X,pt,Bt,Ht){var St=2*pt,It=2*Bt;return X[St]<X[It]||X[St]===X[It]&&Ht[pt]<=Ht[Bt]}function ot(X,pt,Bt){for(var Ht=X.heap[Bt],St=Bt<<1;St<=X.heap_len&&(St<X.heap_len&&J(pt,X.heap[St+1],X.heap[St],X.depth)&&St++,!J(pt,Ht,X.heap[St],X.depth));)X.heap[Bt]=X.heap[St],Bt=St,St<<=1;X.heap[Bt]=Ht}function yt(X,pt,Bt){var Ht,St,It,Tt,vt=0;if(X.last_lit!==0)for(;Ht=X.pending_buf[X.d_buf+2*vt]<<8|X.pending_buf[X.d_buf+2*vt+1],St=X.pending_buf[X.l_buf+vt],vt++,Ht===0?xt(X,St,pt):(xt(X,(It=L[St])+p+1,pt),(Tt=D[It])!==0&&dt(X,St-=it[It],Tt),xt(X,It=j(--Ht),Bt),(Tt=I[It])!==0&&dt(X,Ht-=at[It],Tt)),vt<X.last_lit;);xt(X,T,pt)}function At(X,pt){var Bt,Ht,St,It=pt.dyn_tree,Tt=pt.stat_desc.static_tree,vt=pt.stat_desc.has_stree,te=pt.stat_desc.elems,ae=-1;for(X.heap_len=0,X.heap_max=_,Bt=0;Bt<te;Bt++)It[2*Bt]!==0?(X.heap[++X.heap_len]=ae=Bt,X.depth[Bt]=0):It[2*Bt+1]=0;for(;X.heap_len<2;)It[2*(St=X.heap[++X.heap_len]=ae<2?++ae:0)]=1,X.depth[St]=0,X.opt_len--,vt&&(X.static_len-=Tt[2*St+1]);for(pt.max_code=ae,Bt=X.heap_len>>1;1<=Bt;Bt--)ot(X,It,Bt);for(St=te;Bt=X.heap[1],X.heap[1]=X.heap[X.heap_len--],ot(X,It,1),Ht=X.heap[1],X.heap[--X.heap_max]=Bt,X.heap[--X.heap_max]=Ht,It[2*St]=It[2*Bt]+It[2*Ht],X.depth[St]=(X.depth[Bt]>=X.depth[Ht]?X.depth[Bt]:X.depth[Ht])+1,It[2*Bt+1]=It[2*Ht+1]=St,X.heap[1]=St++,ot(X,It,1),2<=X.heap_len;);X.heap[--X.heap_max]=X.heap[1],function(ne,Re){var rn,be,ln,Ve,zn,Cn,yn=Re.dyn_tree,mr=Re.max_code,_s=Re.stat_desc.static_tree,Vs=Re.stat_desc.has_stree,Xa=Re.stat_desc.extra_bits,Ws=Re.stat_desc.extra_base,Er=Re.stat_desc.max_length,Oi=0;for(Ve=0;Ve<=y;Ve++)ne.bl_count[Ve]=0;for(yn[2*ne.heap[ne.heap_max]+1]=0,rn=ne.heap_max+1;rn<_;rn++)Er<(Ve=yn[2*yn[2*(be=ne.heap[rn])+1]+1]+1)&&(Ve=Er,Oi++),yn[2*be+1]=Ve,mr<be||(ne.bl_count[Ve]++,zn=0,Ws<=be&&(zn=Xa[be-Ws]),Cn=yn[2*be],ne.opt_len+=Cn*(Ve+zn),Vs&&(ne.static_len+=Cn*(_s[2*be+1]+zn)));if(Oi!==0){do{for(Ve=Er-1;ne.bl_count[Ve]===0;)Ve--;ne.bl_count[Ve]--,ne.bl_count[Ve+1]+=2,ne.bl_count[Er]--,Oi-=2}while(0<Oi);for(Ve=Er;Ve!==0;Ve--)for(be=ne.bl_count[Ve];be!==0;)mr<(ln=ne.heap[--rn])||(yn[2*ln+1]!==Ve&&(ne.opt_len+=(Ve-yn[2*ln+1])*yn[2*ln],yn[2*ln+1]=Ve),be--)}}(X,pt),Rt(It,ae,X.bl_count)}function O(X,pt,Bt){var Ht,St,It=-1,Tt=pt[1],vt=0,te=7,ae=4;for(Tt===0&&(te=138,ae=3),pt[2*(Bt+1)+1]=65535,Ht=0;Ht<=Bt;Ht++)St=Tt,Tt=pt[2*(Ht+1)+1],++vt<te&&St===Tt||(vt<ae?X.bl_tree[2*St]+=vt:St!==0?(St!==It&&X.bl_tree[2*St]++,X.bl_tree[2*C]++):vt<=10?X.bl_tree[2*R]++:X.bl_tree[2*N]++,It=St,ae=(vt=0)===Tt?(te=138,3):St===Tt?(te=6,3):(te=7,4))}function gt(X,pt,Bt){var Ht,St,It=-1,Tt=pt[1],vt=0,te=7,ae=4;for(Tt===0&&(te=138,ae=3),Ht=0;Ht<=Bt;Ht++)if(St=Tt,Tt=pt[2*(Ht+1)+1],!(++vt<te&&St===Tt)){if(vt<ae)for(;xt(X,St,X.bl_tree),--vt!=0;);else St!==0?(St!==It&&(xt(X,St,X.bl_tree),vt--),xt(X,C,X.bl_tree),dt(X,vt-3,2)):vt<=10?(xt(X,R,X.bl_tree),dt(X,vt-3,3)):(xt(X,N,X.bl_tree),dt(X,vt-11,7));It=St,ae=(vt=0)===Tt?(te=138,3):St===Tt?(te=6,3):(te=7,4)}}u(at);var ut=!1;function K(X,pt,Bt,Ht){dt(X,(f<<1)+(Ht?1:0),3),function(St,It,Tt,vt){lt(St),et(St,Tt),et(St,~Tt),s.arraySet(St.pending_buf,St.window,It,Tt,St.pending),St.pending+=Tt}(X,pt,Bt)}i._tr_init=function(X){ut||(function(){var pt,Bt,Ht,St,It,Tt=new Array(y+1);for(St=Ht=0;St<d-1;St++)for(it[St]=Ht,pt=0;pt<1<<D[St];pt++)L[Ht++]=St;for(L[Ht-1]=St,St=It=0;St<16;St++)for(at[St]=It,pt=0;pt<1<<I[St];pt++)rt[It++]=St;for(It>>=7;St<v;St++)for(at[St]=It<<7,pt=0;pt<1<<I[St]-7;pt++)rt[256+It++]=St;for(Bt=0;Bt<=y;Bt++)Tt[Bt]=0;for(pt=0;pt<=143;)H[2*pt+1]=8,pt++,Tt[8]++;for(;pt<=255;)H[2*pt+1]=9,pt++,Tt[9]++;for(;pt<=279;)H[2*pt+1]=7,pt++,Tt[7]++;for(;pt<=287;)H[2*pt+1]=8,pt++,Tt[8]++;for(Rt(H,m+1,Tt),pt=0;pt<v;pt++)F[2*pt+1]=5,F[2*pt]=Nt(pt,5);Z=new P(H,D,p+1,m,y),q=new P(F,I,0,v,y),Ct=new P(new Array(0),M,0,x,S)}(),ut=!0),X.l_desc=new V(X.dyn_ltree,Z),X.d_desc=new V(X.dyn_dtree,q),X.bl_desc=new V(X.bl_tree,Ct),X.bi_buf=0,X.bi_valid=0,z(X)},i._tr_stored_block=K,i._tr_flush_block=function(X,pt,Bt,Ht){var St,It,Tt=0;0<X.level?(X.strm.data_type===2&&(X.strm.data_type=function(vt){var te,ae=4093624447;for(te=0;te<=31;te++,ae>>>=1)if(1&ae&&vt.dyn_ltree[2*te]!==0)return a;if(vt.dyn_ltree[18]!==0||vt.dyn_ltree[20]!==0||vt.dyn_ltree[26]!==0)return l;for(te=32;te<p;te++)if(vt.dyn_ltree[2*te]!==0)return l;return a}(X)),At(X,X.l_desc),At(X,X.d_desc),Tt=function(vt){var te;for(O(vt,vt.dyn_ltree,vt.l_desc.max_code),O(vt,vt.dyn_dtree,vt.d_desc.max_code),At(vt,vt.bl_desc),te=x-1;3<=te&&vt.bl_tree[2*B[te]+1]===0;te--);return vt.opt_len+=3*(te+1)+5+5+4,te}(X),St=X.opt_len+3+7>>>3,(It=X.static_len+3+7>>>3)<=St&&(St=It)):St=It=Bt+5,Bt+4<=St&&pt!==-1?K(X,pt,Bt,Ht):X.strategy===4||It===St?(dt(X,2+(Ht?1:0),3),yt(X,H,F)):(dt(X,4+(Ht?1:0),3),function(vt,te,ae,ne){var Re;for(dt(vt,te-257,5),dt(vt,ae-1,5),dt(vt,ne-4,4),Re=0;Re<ne;Re++)dt(vt,vt.bl_tree[2*B[Re]+1],3);gt(vt,vt.dyn_ltree,te-1),gt(vt,vt.dyn_dtree,ae-1)}(X,X.l_desc.max_code+1,X.d_desc.max_code+1,Tt+1),yt(X,X.dyn_ltree,X.dyn_dtree)),z(X),Ht&&lt(X)},i._tr_tally=function(X,pt,Bt){return X.pending_buf[X.d_buf+2*X.last_lit]=pt>>>8&255,X.pending_buf[X.d_buf+2*X.last_lit+1]=255&pt,X.pending_buf[X.l_buf+X.last_lit]=255&Bt,X.last_lit++,pt===0?X.dyn_ltree[2*Bt]++:(X.matches++,pt--,X.dyn_ltree[2*(L[Bt]+p+1)]++,X.dyn_dtree[2*j(pt)]++),X.last_lit===X.lit_bufsize-1},i._tr_align=function(X){dt(X,2,3),xt(X,T,H),function(pt){pt.bi_valid===16?(et(pt,pt.bi_buf),pt.bi_buf=0,pt.bi_valid=0):8<=pt.bi_valid&&(pt.pending_buf[pt.pending++]=255&pt.bi_buf,pt.bi_buf>>=8,pt.bi_valid-=8)}(X)}},{"../utils/common":41}],53:[function(e,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,i){(function(s){(function(a,l){if(!a.setImmediate){var u,f,d,p,m=1,v={},x=!1,_=a.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(a);y=y&&y.setTimeout?y:a,u={}.toString.call(a.process)==="[object process]"?function(C){process.nextTick(function(){S(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,R=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=R,C}}()?(p="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",T,!1):a.attachEvent("onmessage",T),function(C){a.postMessage(p+C,"*")}):a.MessageChannel?((d=new MessageChannel).port1.onmessage=function(C){S(C.data)},function(C){d.port2.postMessage(C)}):_&&"onreadystatechange"in _.createElement("script")?(f=_.documentElement,function(C){var R=_.createElement("script");R.onreadystatechange=function(){S(C),R.onreadystatechange=null,f.removeChild(R),R=null},f.appendChild(R)}):function(C){setTimeout(S,0,C)},y.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var R=new Array(arguments.length-1),N=0;N<R.length;N++)R[N]=arguments[N+1];var D={callback:C,args:R};return v[m]=D,u(m),m++},y.clearImmediate=w}function w(C){delete v[C]}function S(C){if(x)setTimeout(S,0,C);else{var R=v[C];if(R){x=!0;try{(function(N){var D=N.callback,I=N.args;switch(I.length){case 0:D();break;case 1:D(I[0]);break;case 2:D(I[0],I[1]);break;case 3:D(I[0],I[1],I[2]);break;default:D.apply(l,I)}})(R)}finally{w(C),x=!1}}}}function T(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(p)===0&&S(+C.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Q0<"u"?Q0:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(yx)),yx.exports}var LK=kK();const IK=bf(LK),MK=(n,t)=>{const e=Tf(n),r=[];t.forEach(u=>{const f={hole_id:Gi(u,e,"hole_id"),nspt:{start_depth:1,interval:1,values:[]},depths:[],geology:[]},d=Qg(u,e);d>0&&(f.max_depth=d);const p=hs(Gi(u,e,"z"));p!==-1&&(f.z=p);const m=Gi(u,e,"water_level");if(m){const w=hs(m,-1);w>=0&&(f.water_level=w)}const v=No(u,e,"depth_from_to").map(w=>hs(w)).filter(w=>w!==-1).sort((w,S)=>w-S);v.length>0&&!v.includes(0)&&v.unshift(0),v.length>0&&(f.depths=v);const x=No(u,e,"geology");x.length>0&&(f.geology=x);const _=No(u,e,"interp");_.length>0&&(f.interp=_);const y=No(u,e,"nspt");y.length>0&&(f.nspt={start_depth:1,interval:1,values:y}),r.push(f)});const i=JSON.stringify(r,null,2),s=new Blob([i],{type:"application/json"}),a=URL.createObjectURL(s),l=document.createElement("a");l.href=a,l.download="dados-estruturados.json",l.click(),URL.revokeObjectURL(a)},PK=(n,t)=>{const e=n.map(p=>p.name),r=["Página",...e],i=t.map(p=>{const m=[p.pageNumber.join(", ")];return e.forEach(v=>{const x=p[v];Array.isArray(x)?m.push(x.join("; ")):m.push(x||"")}),m}),l="\uFEFF"+[r,...i].map(p=>p.map(m=>`"${m}"`).join(",")).join(`
`),u=new Blob([l],{type:"text/csv;charset=utf-8;"}),f=URL.createObjectURL(u),d=document.createElement("a");d.href=f,d.download="dados-extraidos.csv",d.click(),URL.revokeObjectURL(f)},FK=(n,t)=>{const e=n.map(a=>a.name),r=t.map(a=>{const l={Página:a.pageNumber};return e.forEach(u=>{const f=a[u];Array.isArray(f)?l[u]=f.join("; "):l[u]=f||""}),l});var i=xx.json_to_sheet(r),s=xx.book_new();xx.book_append_sheet(s,i,"Dados extraídos"),mK(s,"dados-pdf.xlsx")},BK=(n,t,e)=>{const r=lk(t,n,e);if(!r){alert("Não existem todas as áreas necessárias para gerar esse arquivo");return}const s="\uFEFF"+ok(r.data,r.headers),a=new Blob([s],{type:"text/csv"}),l=URL.createObjectURL(a),u=document.createElement("a");u.href=l,u.download=r.filename,u.click(),URL.revokeObjectURL(l)},UK=async(n,t,e)=>{const r=new IK,i="\uFEFF";["collar","nspt","na","geology","interp"].forEach(f=>{if(vv(n,f).isValid||e){const d=lk(t,n,f);if(d){const p=i+ok(d.data,d.headers);r.file(d.filename,p)}}});const a=await r.generateAsync({type:"blob"}),l=URL.createObjectURL(a),u=document.createElement("a");u.href=l,u.download="leapfrog-data.zip",u.click(),URL.revokeObjectURL(l)},zK=(n,t,e)=>`dropdown-item${vv(n,t).isValid||e?"":" disabled"}`,oC=n=>{const t=Vm.filter(e=>vv(n,e).isValid);return{validExports:t,nonValidExports:Vm.filter(e=>!t.includes(e)),someValid:t.length>0,allValid:t.length===Vm.length}},jK=({areas:n,hasFile:t,isExtracting:e,extractionProgress:r,extractionStartTime:i,fileName:s,onPreview:a,onExtractTexts:l,onCancelExtraction:u})=>{const[f,d]=_t.useState(oC(n)),[p,m]=_t.useState(!1),[v,x]=_t.useState("");_t.useEffect(()=>{d(oC(n)),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(R=>{const N=js.getInstance(R);N&&N.dispose(),new js(R)})},[n,p]);const _=async()=>{try{const C=await l();FK(n,C)}catch(C){console.error("Download cancelado:",C)}},y=async()=>{try{const C=await l();PK(n,C)}catch(C){console.error("Download cancelado:",C)}},w=async()=>{try{const C=await l();MK(n,C)}catch(C){console.error("Download cancelado:",C)}},S=async()=>{try{const C=await l();UK(n,C,p)}catch(C){console.error("Download cancelado:",C)}},T=async C=>{try{const R=await l();BK(n,R,C)}catch(R){console.error("Download cancelado:",R)}};return _t.useEffect(()=>{if(!e){x("");return}const C=setInterval(()=>{const R=Date.now()-i;x(b5(R,10))},100);return()=>clearInterval(C)},[e,i]),e?nt.jsxs("div",{className:"d-flex align-items-center justify-content-between p-1",children:[nt.jsxs("div",{className:"d-flex flex-column text-start",children:[s&&nt.jsxs("small",{className:"text-muted",children:["Extraindo dados do arquivo ",nt.jsx("strong",{children:s})]}),nt.jsx("small",{className:"text-muted",children:r&&r.message}),nt.jsxs("small",{className:"text-secondary",children:["Tempo decorrido: ",nt.jsx("strong",{children:v})]})]}),nt.jsx("button",{className:"btn btn-outline-danger btn-sm ms-3",onClick:u,children:"Cancelar"})]}):nt.jsxs("div",{className:"d-flex align-items-start gap-3",children:[nt.jsx("div",{children:nt.jsxs("button",{className:"btn btn-outline-primary",onClick:a,disabled:!(n.length>0&&t&&n.some(C=>C.coordinates)),children:[nt.jsx(z5,{className:"me-1",size:16}),"Visualizar"]})}),nt.jsxs("div",{className:"btn-group dropup",children:[nt.jsxs("button",{className:"btn btn-secondary",type:"button",onClick:_,"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"top","data-bs-title":"Download XLS",children:[nt.jsx(Bx,{className:"me-1",size:16}),"Excel"]}),nt.jsx("button",{className:"btn btn-secondary dropdown-toggle dropdown-toggle-split",type:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:nt.jsx("span",{className:"visually-hidden",children:"Mais opções"})}),nt.jsxs("ul",{className:"dropdown-menu",children:[nt.jsx("li",{children:nt.jsx("button",{className:"dropdown-item",type:"button",onClick:w,children:"JSON"})}),nt.jsx("li",{children:nt.jsx("button",{className:"dropdown-item",type:"button",onClick:y,children:"CSV"})})]})]}),nt.jsxs("div",{className:"d-flex flex-column align-items-start",children:[nt.jsx("div",{children:nt.jsxs("div",{className:"btn-group dropup",children:[nt.jsxs("button",{className:"btn btn-secondary",type:"button",onClick:S,disabled:!f.someValid,"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"top","data-bs-title":f.allValid?"Exportar todos os arquivos":p&&f.someValid?`Exportar ${f.validExports.join(", ")} completo(s) e ${f.nonValidExports.join(", ")} incompleto(s)`:p?"Exportar todos incompletos":f.someValid?`Exportar ${f.validExports.join(", ")}`:"Dados insuficientes para gerar arquivos",children:[nt.jsx(Bx,{className:"me-1",size:16}),"Leapfrog"]}),nt.jsx("button",{type:"button",className:"btn btn-secondary dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:nt.jsx("span",{className:"visually-hidden",children:"Mais opções"})}),nt.jsx("ul",{className:"dropdown-menu",style:{zIndex:"1001"},children:Vm.map(C=>{const R=vv(n,C);return nt.jsx("li",{"data-bs-toggle":"tooltip","data-bs-target":"tooltip","data-bs-placement":"left","data-bs-title":R.isValid?`Exportar ${C}.csv`:p?`Exportar ${C}.csv incompleto (dados ausentes: ${R.missingFields.map(N=>N==="depth"?"Profundidades ou Profundidade Total":Lc[N]).join(", ")})`:`Campos faltantes: ${R.missingFields.map(N=>N==="depth"?"Profundidades ou Profundidade Total":Lc[N]).join(", ")}`,children:nt.jsx("button",{className:zK(n,C,p),onClick:()=>T(C),children:c8[C]})},`export-leapfrog-${C}`)})})]})}),nt.jsxs("div",{className:"form-check form-switch mt-2",children:[nt.jsx("input",{className:"form-check-input",type:"checkbox",role:"switch",id:"switchCheckDefault",checked:p,onChange:C=>m(C.target.checked)}),nt.jsx("label",{className:"form-check-label small",htmlFor:"switchCheckDefault",children:"Aceitar dados incompletos"})]})]})]})};function HK(){const n=_t.useRef(null),[t,e]=_t.useState(null),[r,i]=_t.useState(!1),[s,a]=_t.useState(null),[l,u]=_t.useState(0),[f,d]=_t.useState(null),[p,m]=_t.useState([]),[v,x]=_t.useState("text"),[_,y]=_t.useState([]),[w,S]=_t.useState(!1),[T,C]=_t.useState(null),R=Rt=>{if(_.length>=15){alert("Limite de 15 áreas atingido");return}const z=v==="ocr";y(lt=>L9(lt,z,Rt))},N=Rt=>{y(z=>I9(z,Rt))},D=(Rt,z)=>{y(lt=>M9(lt,Rt,z))},I=Rt=>{y(z=>P9(z,Rt))},M=Rt=>{C(Rt),S(!0)},B=Rt=>{T&&y(z=>F9(z,T,Rt)),S(!1),C(null)},[H,F]=_t.useState(""),[rt,L]=_t.useState([]),it=()=>G2(_,t)!==H||rt.length===0,Z=async()=>{if(console.log(it()),!it())return rt;const Rt=new AbortController;d(Rt),i(!0),u(Date.now());const z=n.current?.getDocument(),lt=_.some(At=>At.repeatInPages),J=_.find(At=>At.dataType==="hole_id"),ot=_.filter(At=>!At.coordinates).map(At=>At.name);if(ot.length>0&&!confirm(`A(s) seguinte(s) área(s) não possue(m) coordenadas:
`+ot.join(", ")+`
Deseja continuar mesmo assim?`))throw new Error("Extração cancelada pelo usuário");if(!J&&lt&&!confirm("Algumas áreas estão configuradas como 'Único' mas não há uma área de ID da Sondagem. A função não vai funcionar corretamente. Deseja continuar mesmo assim?"))throw new Error("Extração cancelada pelo usuário");if(!z)throw new Error("PDF não carregado");const yt=await cH(_,z,Rt.signal,a);return m(yt),L(yt),F(G2(_,t)),yt},q=async()=>{try{i(!0),await Z()}catch(Rt){console.error("Erro na extração: ",Rt)}finally{i(!1)}},Ct=Rt=>{y(Rt)},at=()=>{S(!1),C(null)};_t.useEffect(()=>{const Rt=lt=>{lt.key==="Escape"&&w&&at()},z=lt=>{const J=document.querySelector(".pdf-container");w&&!J?.contains(lt.target)&&at()};return document.addEventListener("keydown",Rt),document.addEventListener("mousedown",z),()=>{document.removeEventListener("keydown",Rt),document.removeEventListener("mousedown",z)}},[w]);const P=Rt=>{if(!Rt.destination)return;const z=Rt.source.index,lt=Rt.destination.index;if(z===lt)return;const J=Array.from(_),[ot]=J.splice(z,1);J.splice(lt,0,ot);const yt=J.map((At,O)=>({...At,order:O+1}));y(yt)},V=(Rt,z)=>{y(lt=>lt.map(J=>J.id===Rt?{...J,isMandatory:z}:J))},j=(Rt,z)=>{y(lt=>lt.map(J=>J.id===Rt?{...J,repeatInPages:z}:J))},et=(Rt,z)=>{y(lt=>lt.map(J=>J.id===Rt?{...J,ocr:z}:J))},dt=Rt=>{if(x(Rt),Rt!=="both"){const z=Rt==="ocr";y(lt=>lt.map(J=>({...J,ocr:z})))}},xt=(Rt,z)=>{const lt=uO.includes(z),J=fO.includes(z);y(ot=>ot.map(yt=>yt.id===Rt?{...yt,dataType:z,repeatInPages:lt,isMandatory:J,name:$2(yt.name)&&z==="default"?Vd("Nova Área",ot):$2(yt.name)?Vd(Lc[z],ot):yt.name}:yt))},Nt=()=>{f&&f.abort()};return nt.jsxs(nt.Fragment,{children:[w&&nt.jsx("div",{className:"selection-mode-overlay"}),nt.jsxs("div",{className:"container-fluid text-center px-xl-5",children:[nt.jsx("div",{className:"row justify-content-center",children:nt.jsx(fH,{})}),nt.jsxs("div",{className:"row justify-content-center",children:[nt.jsx("div",{className:"col-12 col-lg-6 col-xxl-4 col-xxxl-4",style:{maxWidth:"450px",minWidth:"300px"},children:nt.jsx(z9,{areas:_,areasMenu:nt.jsx(k9,{onFileSelect:e,onStartAreaSelection:M,onClearArea:I,onDeleteArea:N,onRenameArea:D,onAddNewArea:R,onLoadPreset:Ct,onDragEnd:P,onToggleMandatory:V,onToggleRepeat:j,onChangeAreaType:xt,onToggleAreaOCR:et,areas:_,hasFile:!!t,extractionMode:v,onChangeExtractionMode:dt}),extractMenu:nt.jsx(jK,{onPreview:q,onExtractTexts:Z,onCancelExtraction:Nt,areas:_,hasFile:!!t,isExtracting:r,extractionProgress:s,extractionStartTime:l,fileName:t?.name})})}),nt.jsx("div",{className:"col-12 col-lg-6 col-xxl-5 col-xxxl-4",children:nt.jsx(a8,{ref:n,file:t,isSelectingActive:w,activeAreaId:T,onFinishSelection:B,areas:_})}),nt.jsx("div",{className:"col-12 col-lg-6 col-xxl-3 col-xxxl-4",children:nt.jsx(uH,{extractedTexts:p,areas:_,isExtracting:r,fileName:t?.name||void 0})})]})]})]})}function $K(){return nt.jsx("div",{children:nt.jsx(HK,{})})}AL.createRoot(document.getElementById("root")).render(nt.jsx(_t.StrictMode,{children:nt.jsx($K,{})}));
