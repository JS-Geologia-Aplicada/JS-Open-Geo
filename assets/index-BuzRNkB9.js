var RE=n=>{throw TypeError(n)};var ev=(n,e,t)=>e.has(n)||RE("Cannot "+t);var Rn=(n,e,t)=>(ev(n,e,"read from private field"),t?t.call(n):e.get(n)),ba=(n,e,t)=>e.has(n)?RE("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Ii=(n,e,t,r)=>(ev(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Ea=(n,e,t)=>(ev(n,e,"access private method"),t);var NE=(n,e,t,r)=>({set _(i){Ii(n,e,i,t)},get _(){return Rn(n,e,r)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function H_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var tv={exports:{}},Hh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LE;function bR(){if(LE)return Hh;LE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:o,ref:i!==void 0?i:null,props:a}}return Hh.Fragment=e,Hh.jsx=t,Hh.jsxs=t,Hh}var ME;function ER(){return ME||(ME=1,tv.exports=bR()),tv.exports}var K=ER(),nv={exports:{}},Ut={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IE;function AR(){if(IE)return Ut;IE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function m(P){return P===null||typeof P!="object"?null:(P=g&&P[g]||P["@@iterator"],typeof P=="function"?P:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function A(P,ye,ve){this.props=P,this.context=ye,this.refs=b,this.updater=ve||v}A.prototype.isReactComponent={},A.prototype.setState=function(P,ye){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,ye,"setState")},A.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function w(){}w.prototype=A.prototype;function C(P,ye,ve){this.props=P,this.context=ye,this.refs=b,this.updater=ve||v}var T=C.prototype=new w;T.constructor=C,y(T,A.prototype),T.isPureReactComponent=!0;var R=Array.isArray,N={H:null,A:null,T:null,S:null,V:null},I=Object.prototype.hasOwnProperty;function D(P,ye,ve,ge,Ce,He){return ve=He.ref,{$$typeof:n,type:P,key:ye,ref:ve!==void 0?ve:null,props:He}}function B(P,ye){return D(P.type,ye,void 0,void 0,void 0,P.props)}function U(P){return typeof P=="object"&&P!==null&&P.$$typeof===n}function Y(P){var ye={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(ve){return ye[ve]})}var W=/\/+/g;function re(P,ye){return typeof P=="object"&&P!==null&&P.key!=null?Y(""+P.key):ye.toString(36)}function Te(){}function Fe(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(Te,Te):(P.status="pending",P.then(function(ye){P.status==="pending"&&(P.status="fulfilled",P.value=ye)},function(ye){P.status==="pending"&&(P.status="rejected",P.reason=ye)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function we(P,ye,ve,ge,Ce){var He=typeof P;(He==="undefined"||He==="boolean")&&(P=null);var Ie=!1;if(P===null)Ie=!0;else switch(He){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(P.$$typeof){case n:case e:Ie=!0;break;case d:return Ie=P._init,we(Ie(P._payload),ye,ve,ge,Ce)}}if(Ie)return Ce=Ce(P),Ie=ge===""?"."+re(P,0):ge,R(Ce)?(ve="",Ie!=null&&(ve=Ie.replace(W,"$&/")+"/"),we(Ce,ye,ve,"",function(se){return se})):Ce!=null&&(U(Ce)&&(Ce=B(Ce,ve+(Ce.key==null||P&&P.key===Ce.key?"":(""+Ce.key).replace(W,"$&/")+"/")+Ie)),ye.push(Ce)),1;Ie=0;var Ge=ge===""?".":ge+":";if(R(P))for(var k=0;k<P.length;k++)ge=P[k],He=Ge+re(ge,k),Ie+=we(ge,ye,ve,He,Ce);else if(k=m(P),typeof k=="function")for(P=k.call(P),k=0;!(ge=P.next()).done;)ge=ge.value,He=Ge+re(ge,k++),Ie+=we(ge,ye,ve,He,Ce);else if(He==="object"){if(typeof P.then=="function")return we(Fe(P),ye,ve,ge,Ce);throw ye=String(P),Error("Objects are not valid as a React child (found: "+(ye==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":ye)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function q(P,ye,ve){if(P==null)return P;var ge=[],Ce=0;return we(P,ge,"","",function(He){return ye.call(ve,He,Ce++)}),ge}function ee(P){if(P._status===-1){var ye=P._result;ye=ye(),ye.then(function(ve){(P._status===0||P._status===-1)&&(P._status=1,P._result=ve)},function(ve){(P._status===0||P._status===-1)&&(P._status=2,P._result=ve)}),P._status===-1&&(P._status=0,P._result=ye)}if(P._status===1)return P._result.default;throw P._result}var Pe=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ye=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(ye))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function qe(){}return Ut.Children={map:q,forEach:function(P,ye,ve){q(P,function(){ye.apply(this,arguments)},ve)},count:function(P){var ye=0;return q(P,function(){ye++}),ye},toArray:function(P){return q(P,function(ye){return ye})||[]},only:function(P){if(!U(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},Ut.Component=A,Ut.Fragment=t,Ut.Profiler=i,Ut.PureComponent=C,Ut.StrictMode=r,Ut.Suspense=f,Ut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Ut.__COMPILER_RUNTIME={__proto__:null,c:function(P){return N.H.useMemoCache(P)}},Ut.cache=function(P){return function(){return P.apply(null,arguments)}},Ut.cloneElement=function(P,ye,ve){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var ge=y({},P.props),Ce=P.key,He=void 0;if(ye!=null)for(Ie in ye.ref!==void 0&&(He=void 0),ye.key!==void 0&&(Ce=""+ye.key),ye)!I.call(ye,Ie)||Ie==="key"||Ie==="__self"||Ie==="__source"||Ie==="ref"&&ye.ref===void 0||(ge[Ie]=ye[Ie]);var Ie=arguments.length-2;if(Ie===1)ge.children=ve;else if(1<Ie){for(var Ge=Array(Ie),k=0;k<Ie;k++)Ge[k]=arguments[k+2];ge.children=Ge}return D(P.type,Ce,void 0,void 0,He,ge)},Ut.createContext=function(P){return P={$$typeof:o,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:a,_context:P},P},Ut.createElement=function(P,ye,ve){var ge,Ce={},He=null;if(ye!=null)for(ge in ye.key!==void 0&&(He=""+ye.key),ye)I.call(ye,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(Ce[ge]=ye[ge]);var Ie=arguments.length-2;if(Ie===1)Ce.children=ve;else if(1<Ie){for(var Ge=Array(Ie),k=0;k<Ie;k++)Ge[k]=arguments[k+2];Ce.children=Ge}if(P&&P.defaultProps)for(ge in Ie=P.defaultProps,Ie)Ce[ge]===void 0&&(Ce[ge]=Ie[ge]);return D(P,He,void 0,void 0,null,Ce)},Ut.createRef=function(){return{current:null}},Ut.forwardRef=function(P){return{$$typeof:c,render:P}},Ut.isValidElement=U,Ut.lazy=function(P){return{$$typeof:d,_payload:{_status:-1,_result:P},_init:ee}},Ut.memo=function(P,ye){return{$$typeof:h,type:P,compare:ye===void 0?null:ye}},Ut.startTransition=function(P){var ye=N.T,ve={};N.T=ve;try{var ge=P(),Ce=N.S;Ce!==null&&Ce(ve,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(qe,Pe)}catch(He){Pe(He)}finally{N.T=ye}},Ut.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Ut.use=function(P){return N.H.use(P)},Ut.useActionState=function(P,ye,ve){return N.H.useActionState(P,ye,ve)},Ut.useCallback=function(P,ye){return N.H.useCallback(P,ye)},Ut.useContext=function(P){return N.H.useContext(P)},Ut.useDebugValue=function(){},Ut.useDeferredValue=function(P,ye){return N.H.useDeferredValue(P,ye)},Ut.useEffect=function(P,ye,ve){var ge=N.H;if(typeof ve=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ge.useEffect(P,ye)},Ut.useId=function(){return N.H.useId()},Ut.useImperativeHandle=function(P,ye,ve){return N.H.useImperativeHandle(P,ye,ve)},Ut.useInsertionEffect=function(P,ye){return N.H.useInsertionEffect(P,ye)},Ut.useLayoutEffect=function(P,ye){return N.H.useLayoutEffect(P,ye)},Ut.useMemo=function(P,ye){return N.H.useMemo(P,ye)},Ut.useOptimistic=function(P,ye){return N.H.useOptimistic(P,ye)},Ut.useReducer=function(P,ye,ve){return N.H.useReducer(P,ye,ve)},Ut.useRef=function(P){return N.H.useRef(P)},Ut.useState=function(P){return N.H.useState(P)},Ut.useSyncExternalStore=function(P,ye,ve){return N.H.useSyncExternalStore(P,ye,ve)},Ut.useTransition=function(){return N.H.useTransition()},Ut.version="19.1.0",Ut}var kE;function qg(){return kE||(kE=1,nv.exports=AR()),nv.exports}var le=qg();const Yn=H_(le);var rv={exports:{}},zh={},iv={exports:{}},sv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FE;function wR(){return FE||(FE=1,function(n){function e(q,ee){var Pe=q.length;q.push(ee);e:for(;0<Pe;){var qe=Pe-1>>>1,P=q[qe];if(0<i(P,ee))q[qe]=ee,q[Pe]=P,Pe=qe;else break e}}function t(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var ee=q[0],Pe=q.pop();if(Pe!==ee){q[0]=Pe;e:for(var qe=0,P=q.length,ye=P>>>1;qe<ye;){var ve=2*(qe+1)-1,ge=q[ve],Ce=ve+1,He=q[Ce];if(0>i(ge,Pe))Ce<P&&0>i(He,ge)?(q[qe]=He,q[Ce]=Pe,qe=Ce):(q[qe]=ge,q[ve]=Pe,qe=ve);else if(Ce<P&&0>i(He,Pe))q[qe]=He,q[Ce]=Pe,qe=Ce;else break e}}return ee}function i(q,ee){var Pe=q.sortIndex-ee.sortIndex;return Pe!==0?Pe:q.id-ee.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var f=[],h=[],d=1,g=null,m=3,v=!1,y=!1,b=!1,A=!1,w=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function R(q){for(var ee=t(h);ee!==null;){if(ee.callback===null)r(h);else if(ee.startTime<=q)r(h),ee.sortIndex=ee.expirationTime,e(f,ee);else break;ee=t(h)}}function N(q){if(b=!1,R(q),!y)if(t(f)!==null)y=!0,I||(I=!0,re());else{var ee=t(h);ee!==null&&we(N,ee.startTime-q)}}var I=!1,D=-1,B=5,U=-1;function Y(){return A?!0:!(n.unstable_now()-U<B)}function W(){if(A=!1,I){var q=n.unstable_now();U=q;var ee=!0;try{e:{y=!1,b&&(b=!1,C(D),D=-1),v=!0;var Pe=m;try{t:{for(R(q),g=t(f);g!==null&&!(g.expirationTime>q&&Y());){var qe=g.callback;if(typeof qe=="function"){g.callback=null,m=g.priorityLevel;var P=qe(g.expirationTime<=q);if(q=n.unstable_now(),typeof P=="function"){g.callback=P,R(q),ee=!0;break t}g===t(f)&&r(f),R(q)}else r(f);g=t(f)}if(g!==null)ee=!0;else{var ye=t(h);ye!==null&&we(N,ye.startTime-q),ee=!1}}break e}finally{g=null,m=Pe,v=!1}ee=void 0}}finally{ee?re():I=!1}}}var re;if(typeof T=="function")re=function(){T(W)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,Fe=Te.port2;Te.port1.onmessage=W,re=function(){Fe.postMessage(null)}}else re=function(){w(W,0)};function we(q,ee){D=w(function(){q(n.unstable_now())},ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(q){switch(m){case 1:case 2:case 3:var ee=3;break;default:ee=m}var Pe=m;m=ee;try{return q()}finally{m=Pe}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(q,ee){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Pe=m;m=q;try{return ee()}finally{m=Pe}},n.unstable_scheduleCallback=function(q,ee,Pe){var qe=n.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?qe+Pe:qe):Pe=qe,q){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=Pe+P,q={id:d++,callback:ee,priorityLevel:q,startTime:Pe,expirationTime:P,sortIndex:-1},Pe>qe?(q.sortIndex=Pe,e(h,q),t(f)===null&&q===t(h)&&(b?(C(D),D=-1):b=!0,we(N,Pe-qe))):(q.sortIndex=P,e(f,q),y||v||(y=!0,I||(I=!0,re()))),q},n.unstable_shouldYield=Y,n.unstable_wrapCallback=function(q){var ee=m;return function(){var Pe=m;m=ee;try{return q.apply(this,arguments)}finally{m=Pe}}}}(sv)),sv}var PE;function SR(){return PE||(PE=1,iv.exports=wR()),iv.exports}var av={exports:{}},Vr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BE;function TR(){if(BE)return Vr;BE=1;var n=qg();function e(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(f,h,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:g==null?null:""+g,children:f,containerInfo:h,implementation:d}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Vr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Vr.createPortal=function(f,h){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(f,h,null,d)},Vr.flushSync=function(f){var h=o.T,d=r.p;try{if(o.T=null,r.p=2,f)return f()}finally{o.T=h,r.p=d,r.d.f()}},Vr.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(f,h))},Vr.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Vr.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var d=h.as,g=c(d,h.crossOrigin),m=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;d==="style"?r.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:g,integrity:m,fetchPriority:v}):d==="script"&&r.d.X(f,{crossOrigin:g,integrity:m,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Vr.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var d=c(h.as,h.crossOrigin);r.d.M(f,{crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(f)},Vr.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var d=h.as,g=c(d,h.crossOrigin);r.d.L(f,d,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Vr.preloadModule=function(f,h){if(typeof f=="string")if(h){var d=c(h.as,h.crossOrigin);r.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(f)},Vr.requestFormReset=function(f){r.d.r(f)},Vr.unstable_batchedUpdates=function(f,h){return f(h)},Vr.useFormState=function(f,h,d){return o.H.useFormState(f,h,d)},Vr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Vr.version="19.1.0",Vr}var UE;function FS(){if(UE)return av.exports;UE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),av.exports=TR(),av.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HE;function CR(){if(HE)return zh;HE=1;var n=SR(),e=qg(),t=FS();function r(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,u=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(u=l.return),s=l.return;while(s)}return l.tag===3?u:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(a(s)!==s)throw Error(r(188))}function f(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(r(188));return l!==s?null:s}for(var u=s,p=l;;){var _=u.return;if(_===null)break;var E=_.alternate;if(E===null){if(p=_.return,p!==null){u=p;continue}break}if(_.child===E.child){for(E=_.child;E;){if(E===u)return c(_),s;if(E===p)return c(_),l;E=E.sibling}throw Error(r(188))}if(u.return!==p.return)u=_,p=E;else{for(var O=!1,F=_.child;F;){if(F===u){O=!0,u=_,p=E;break}if(F===p){O=!0,p=_,u=E;break}F=F.sibling}if(!O){for(F=E.child;F;){if(F===u){O=!0,u=E,p=_;break}if(F===p){O=!0,p=E,u=_;break}F=F.sibling}if(!O)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var d=Object.assign,g=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),T=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),Y=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function re(s){return s===null||typeof s!="object"?null:(s=W&&s[W]||s["@@iterator"],typeof s=="function"?s:null)}var Te=Symbol.for("react.client.reference");function Fe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Te?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case y:return"Fragment";case A:return"Profiler";case b:return"StrictMode";case N:return"Suspense";case I:return"SuspenseList";case U:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case v:return"Portal";case T:return(s.displayName||"Context")+".Provider";case C:return(s._context.displayName||"Context")+".Consumer";case R:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case D:return l=s.displayName||null,l!==null?l:Fe(s.type)||"Memo";case B:l=s._payload,s=s._init;try{return Fe(s(l))}catch{}}return null}var we=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe={pending:!1,data:null,method:null,action:null},qe=[],P=-1;function ye(s){return{current:s}}function ve(s){0>P||(s.current=qe[P],qe[P]=null,P--)}function ge(s,l){P++,qe[P]=s.current,s.current=l}var Ce=ye(null),He=ye(null),Ie=ye(null),Ge=ye(null);function k(s,l){switch(ge(Ie,l),ge(He,s),ge(Ce,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?iE(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=iE(l),s=sE(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ve(Ce),ge(Ce,s)}function se(){ve(Ce),ve(He),ve(Ie)}function Z(s){s.memoizedState!==null&&ge(Ge,s);var l=Ce.current,u=sE(l,s.type);l!==u&&(ge(He,s),ge(Ce,u))}function J(s){He.current===s&&(ve(Ce),ve(He)),Ge.current===s&&(ve(Ge),kh._currentValue=Pe)}var xe=Object.prototype.hasOwnProperty,be=n.unstable_scheduleCallback,Se=n.unstable_cancelCallback,Ye=n.unstable_shouldYield,De=n.unstable_requestPaint,nt=n.unstable_now,rt=n.unstable_getCurrentPriorityLevel,ht=n.unstable_ImmediatePriority,Rt=n.unstable_UserBlockingPriority,kt=n.unstable_NormalPriority,nn=n.unstable_LowPriority,Qe=n.unstable_IdlePriority,Ct=n.log,je=n.unstable_setDisableYieldValue,Tn=null,zt=null;function It(s){if(typeof Ct=="function"&&je(s),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(Tn,s)}catch{}}var on=Math.clz32?Math.clz32:Bn,Kn=Math.log,Ht=Math.LN2;function Bn(s){return s>>>=0,s===0?32:31-(Kn(s)/Ht|0)|0}var Ei=256,Hi=4194304;function cr(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ai(s,l,u){var p=s.pendingLanes;if(p===0)return 0;var _=0,E=s.suspendedLanes,O=s.pingedLanes;s=s.warmLanes;var F=p&134217727;return F!==0?(p=F&~E,p!==0?_=cr(p):(O&=F,O!==0?_=cr(O):u||(u=F&~s,u!==0&&(_=cr(u))))):(F=p&~E,F!==0?_=cr(F):O!==0?_=cr(O):u||(u=p&~s,u!==0&&(_=cr(u)))),_===0?0:l!==0&&l!==_&&(l&E)===0&&(E=_&-_,u=l&-l,E>=u||E===32&&(u&4194048)!==0)?l:_}function fs(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Bc(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rl(){var s=Ei;return Ei<<=1,(Ei&4194048)===0&&(Ei=256),s}function Nl(){var s=Hi;return Hi<<=1,(Hi&62914560)===0&&(Hi=4194304),s}function Lo(s){for(var l=[],u=0;31>u;u++)l.push(s);return l}function hs(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ua(s,l,u,p,_,E){var O=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var F=s.entanglements,Q=s.expirationTimes,de=s.hiddenUpdates;for(u=O&~u;0<u;){var Oe=31-on(u),ke=1<<Oe;F[Oe]=0,Q[Oe]=-1;var me=de[Oe];if(me!==null)for(de[Oe]=null,Oe=0;Oe<me.length;Oe++){var _e=me[Oe];_e!==null&&(_e.lane&=-536870913)}u&=~ke}p!==0&&Ll(s,p,0),E!==0&&_===0&&s.tag!==0&&(s.suspendedLanes|=E&~(O&~l))}function Ll(s,l,u){s.pendingLanes|=l,s.suspendedLanes&=~l;var p=31-on(l);s.entangledLanes|=l,s.entanglements[p]=s.entanglements[p]|1073741824|u&4194090}function Uc(s,l){var u=s.entangledLanes|=l;for(s=s.entanglements;u;){var p=31-on(u),_=1<<p;_&l|s[p]&l&&(s[p]|=l),u&=~_}}function Ml(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Il(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Hc(){var s=ee.p;return s!==0?s:(s=window.event,s===void 0?32:wE(s.type))}function na(s,l){var u=ee.p;try{return ee.p=s,l()}finally{ee.p=u}}var Br=Math.random().toString(36).slice(2),Qn="__reactFiber$"+Br,Zn="__reactProps$"+Br,ra="__reactContainer$"+Br,kl="__reactEvents$"+Br,Ef="__reactListeners$"+Br,M="__reactHandles$"+Br,V="__reactResources$"+Br,z="__reactMarker$"+Br;function j(s){delete s[Qn],delete s[Zn],delete s[kl],delete s[Ef],delete s[M]}function G(s){var l=s[Qn];if(l)return l;for(var u=s.parentNode;u;){if(l=u[ra]||u[Qn]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(s=cE(s);s!==null;){if(u=s[Qn])return u;s=cE(s)}return l}s=u,u=s.parentNode}return null}function X(s){if(s=s[Qn]||s[ra]){var l=s.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return s}return null}function he(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(r(33))}function Ee(s){var l=s[V];return l||(l=s[V]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function ie(s){s[z]=!0}var ce=new Set,ue={};function Re(s,l){$e(s,l),$e(s+"Capture",l)}function $e(s,l){for(ue[s]=l,s=0;s<l.length;s++)ce.add(l[s])}var Ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ue={},Ve={};function St(s){return xe.call(Ve,s)?!0:xe.call(Ue,s)?!1:Ze.test(s)?Ve[s]=!0:(Ue[s]=!0,!1)}function Jt(s,l,u){if(St(l))if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var p=l.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+u)}}function Xt(s,l,u){if(u===null)s.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+u)}}function cn(s,l,u,p){if(p===null)s.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(l,u,""+p)}}var zi,ds;function ni(s){if(zi===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);zi=l&&l[1]||"",ds=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zi+s+ds}var wi=!1;function ia(s,l){if(!s||wi)return"";wi=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(l){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(_e){var me=_e}Reflect.construct(s,[],ke)}else{try{ke.call()}catch(_e){me=_e}s.call(ke.prototype)}}else{try{throw Error()}catch(_e){me=_e}(ke=s())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(_e){if(_e&&me&&typeof _e.stack=="string")return[_e.stack,me.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=p.DetermineComponentFrameRoot(),O=E[0],F=E[1];if(O&&F){var Q=O.split(`
`),de=F.split(`
`);for(_=p=0;p<Q.length&&!Q[p].includes("DetermineComponentFrameRoot");)p++;for(;_<de.length&&!de[_].includes("DetermineComponentFrameRoot");)_++;if(p===Q.length||_===de.length)for(p=Q.length-1,_=de.length-1;1<=p&&0<=_&&Q[p]!==de[_];)_--;for(;1<=p&&0<=_;p--,_--)if(Q[p]!==de[_]){if(p!==1||_!==1)do if(p--,_--,0>_||Q[p]!==de[_]){var Oe=`
`+Q[p].replace(" at new "," at ");return s.displayName&&Oe.includes("<anonymous>")&&(Oe=Oe.replace("<anonymous>",s.displayName)),Oe}while(1<=p&&0<=_);break}}}finally{wi=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?ni(u):""}function Si(s){switch(s.tag){case 26:case 27:case 5:return ni(s.type);case 16:return ni("Lazy");case 13:return ni("Suspense");case 19:return ni("SuspenseList");case 0:case 15:return ia(s.type,!1);case 11:return ia(s.type.render,!1);case 1:return ia(s.type,!0);case 31:return ni("Activity");default:return""}}function Af(s){try{var l="";do l+=Si(s),s=s.return;while(s);return l}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function ri(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function wf(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function n0(s){var l=wf(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),p=""+s[l];if(!s.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var _=u.get,E=u.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return _.call(this)},set:function(O){p=""+O,E.call(this,O)}}),Object.defineProperty(s,l,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(O){p=""+O},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Fl(s){s._valueTracker||(s._valueTracker=n0(s))}function Sf(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var u=l.getValue(),p="";return s&&(p=wf(s)?s.checked?"true":"false":s.value),s=p,s!==u?(l.setValue(s),!0):!1}function ii(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var si=/[\n"\\]/g;function Jn(s){return s.replace(si,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Ur(s,l,u,p,_,E,O,F){s.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?s.type=O:s.removeAttribute("type"),l!=null?O==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+ri(l)):s.value!==""+ri(l)&&(s.value=""+ri(l)):O!=="submit"&&O!=="reset"||s.removeAttribute("value"),l!=null?Pl(s,O,ri(l)):u!=null?Pl(s,O,ri(u)):p!=null&&s.removeAttribute("value"),_==null&&E!=null&&(s.defaultChecked=!!E),_!=null&&(s.checked=_&&typeof _!="function"&&typeof _!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+ri(F):s.removeAttribute("name")}function zc(s,l,u,p,_,E,O,F){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(s.type=E),l!=null||u!=null){if(!(E!=="submit"&&E!=="reset"||l!=null))return;u=u!=null?""+ri(u):"",l=l!=null?""+ri(l):u,F||l===s.value||(s.value=l),s.defaultValue=l}p=p??_,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=F?s.checked:!!p,s.defaultChecked=!!p,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(s.name=O)}function Pl(s,l,u){l==="number"&&ii(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Tr(s,l,u,p){if(s=s.options,l){l={};for(var _=0;_<u.length;_++)l["$"+u[_]]=!0;for(u=0;u<s.length;u++)_=l.hasOwnProperty("$"+s[u].value),s[u].selected!==_&&(s[u].selected=_),_&&p&&(s[u].defaultSelected=!0)}else{for(u=""+ri(u),l=null,_=0;_<s.length;_++){if(s[_].value===u){s[_].selected=!0,p&&(s[_].defaultSelected=!0);return}l!==null||s[_].disabled||(l=s[_])}l!==null&&(l.selected=!0)}}function sa(s,l,u){if(l!=null&&(l=""+ri(l),l!==s.value&&(s.value=l),u==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=u!=null?""+ri(u):""}function Bl(s,l,u,p){if(l==null){if(p!=null){if(u!=null)throw Error(r(92));if(we(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),l=u}u=ri(l),s.defaultValue=u,p=s.textContent,p===u&&p!==""&&p!==null&&(s.value=p)}function ji(s,l){if(l){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=l;return}}s.textContent=l}var Tf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cf(s,l,u){var p=l.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":p?s.setProperty(l,u):typeof u!="number"||u===0||Tf.has(l)?l==="float"?s.cssFloat=u:s[l]=(""+u).trim():s[l]=u+"px"}function Ha(s,l,u){if(l!=null&&typeof l!="object")throw Error(r(62));if(s=s.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||l!=null&&l.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var _ in l)p=l[_],l.hasOwnProperty(_)&&u[_]!==p&&Cf(s,_,p)}else for(var E in l)l.hasOwnProperty(E)&&Cf(s,E,l[E])}function Ul(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var r0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Bs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function jc(s){return Bs.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ps=null;function Mo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var za=null,gs=null;function $c(s){var l=X(s);if(l&&(s=l.stateNode)){var u=s[Zn]||null;e:switch(s=l.stateNode,l.type){case"input":if(Ur(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),l=u.name,u.type==="radio"&&l!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Jn(""+l)+'"][type="radio"]'),l=0;l<u.length;l++){var p=u[l];if(p!==s&&p.form===s.form){var _=p[Zn]||null;if(!_)throw Error(r(90));Ur(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(l=0;l<u.length;l++)p=u[l],p.form===s.form&&Sf(p)}break e;case"textarea":sa(s,u.value,u.defaultValue);break e;case"select":l=u.value,l!=null&&Tr(s,!!u.multiple,l,!1)}}}var ja=!1;function Df(s,l,u){if(ja)return s(l,u);ja=!0;try{var p=s(l);return p}finally{if(ja=!1,(za!==null||gs!==null)&&(hp(),za&&(l=za,s=gs,gs=za=null,$c(l),s)))for(l=0;l<s.length;l++)$c(s[l])}}function Io(s,l){var u=s.stateNode;if(u===null)return null;var p=u[Zn]||null;if(p===null)return null;u=p[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(r(231,l,typeof u));return u}var ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),aa=!1;if(ms)try{var Hl={};Object.defineProperty(Hl,"passive",{get:function(){aa=!0}}),window.addEventListener("test",Hl,Hl),window.removeEventListener("test",Hl,Hl)}catch{aa=!1}var Us=null,zl=null,$a=null;function Gc(){if($a)return $a;var s,l=zl,u=l.length,p,_="value"in Us?Us.value:Us.textContent,E=_.length;for(s=0;s<u&&l[s]===_[s];s++);var O=u-s;for(p=1;p<=O&&l[u-p]===_[E-p];p++);return $a=_.slice(s,1<p?1-p:void 0)}function Vc(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Ga(){return!0}function i0(){return!1}function Cr(s){function l(u,p,_,E,O){this._reactName=u,this._targetInst=_,this.type=p,this.nativeEvent=E,this.target=O,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(u=s[F],this[F]=u?u(E):E[F]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?Ga:i0,this.isPropagationStopped=i0,this}return d(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ga)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ga)},persist:function(){},isPersistent:Ga}),l}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ko=Cr(Hs),Va=d({},Hs,{view:0,detail:0}),s0=Cr(Va),Wa,jl,Fo,$l=d({},Va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rf,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Fo&&(Fo&&s.type==="mousemove"?(Wa=s.screenX-Fo.screenX,jl=s.screenY-Fo.screenY):jl=Wa=0,Fo=s),Wa)},movementY:function(s){return"movementY"in s?s.movementY:jl}}),Xa=Cr($l),Lm=d({},$l,{dataTransfer:0}),a0=Cr(Lm),o0=d({},Va,{relatedTarget:0}),Wc=Cr(o0),l0=d({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),c0=Cr(l0),Of=d({},Hs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),u0=Cr(Of),Mm=d({},Hs,{data:0}),f0=Cr(Mm),h0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},d0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Im(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=Xc[s])?!!l[s]:!1}function Rf(){return Im}var Nf=d({},Va,{key:function(s){if(s.key){var l=h0[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Vc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?d0[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rf,charCode:function(s){return s.type==="keypress"?Vc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Vc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),p0=Cr(Nf),g0=d({},$l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oa=Cr(g0),Lf=d({},Va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rf}),km=Cr(Lf),m0=d({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fm=Cr(m0),Pm=d({},$l,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Bm=Cr(Pm),Um=d({},Hs,{newState:0,oldState:0}),v0=Cr(Um),_0=[9,13,27,32],Mf=ms&&"CompositionEvent"in window,vs=null;ms&&"documentMode"in document&&(vs=document.documentMode);var Ya=ms&&"TextEvent"in window&&!vs,x0=ms&&(!Mf||vs&&8<vs&&11>=vs),Gl=" ",y0=!1;function b0(s,l){switch(s){case"keyup":return _0.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function E0(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Po=!1;function Hm(s,l){switch(s){case"compositionend":return E0(l);case"keypress":return l.which!==32?null:(y0=!0,Gl);case"textInput":return s=l.data,s===Gl&&y0?null:s;default:return null}}function zm(s,l){if(Po)return s==="compositionend"||!Mf&&b0(s,l)?(s=Gc(),$a=zl=Us=null,Po=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return x0&&l.locale!=="ko"?null:l.data;default:return null}}var jm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function A0(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!jm[s.type]:l==="textarea"}function Ti(s,l,u,p){za?gs?gs.push(p):gs=[p]:za=p,l=_p(l,"onChange"),0<l.length&&(u=new ko("onChange","change",null,u,p),s.push({event:u,listeners:l}))}var Bo=null,Uo=null;function w0(s){Jb(s,0)}function Yc(s){var l=he(s);if(Sf(l))return s}function S0(s,l){if(s==="change")return l}var If=!1;if(ms){var Ho;if(ms){var kf="oninput"in document;if(!kf){var T0=document.createElement("div");T0.setAttribute("oninput","return;"),kf=typeof T0.oninput=="function"}Ho=kf}else Ho=!1;If=Ho&&(!document.documentMode||9<document.documentMode)}function Ff(){Bo&&(Bo.detachEvent("onpropertychange",C0),Uo=Bo=null)}function C0(s){if(s.propertyName==="value"&&Yc(Uo)){var l=[];Ti(l,Uo,s,Mo(s)),Df(w0,l)}}function $m(s,l,u){s==="focusin"?(Ff(),Bo=l,Uo=u,Bo.attachEvent("onpropertychange",C0)):s==="focusout"&&Ff()}function D0(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Yc(Uo)}function O0(s,l){if(s==="click")return Yc(l)}function R0(s,l){if(s==="input"||s==="change")return Yc(l)}function qc(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Hr=typeof Object.is=="function"?Object.is:qc;function qa(s,l){if(Hr(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var u=Object.keys(s),p=Object.keys(l);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var _=u[p];if(!xe.call(l,_)||!Hr(s[_],l[_]))return!1}return!0}function ai(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function N0(s,l){var u=ai(s);s=0;for(var p;u;){if(u.nodeType===3){if(p=s+u.textContent.length,s<=l&&p>=l)return{node:u,offset:l-s};s=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=ai(u)}}function L0(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?L0(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function Pf(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=ii(s.document);l instanceof s.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)s=l.contentWindow;else break;l=ii(s.document)}return l}function Kc(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var Gm=ms&&"documentMode"in document&&11>=document.documentMode,zo=null,Bf=null,Vl=null,Uf=!1;function M0(s,l,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Uf||zo==null||zo!==ii(p)||(p=zo,"selectionStart"in p&&Kc(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Vl&&qa(Vl,p)||(Vl=p,p=_p(Bf,"onSelect"),0<p.length&&(l=new ko("onSelect","select",null,l,u),s.push({event:l,listeners:p}),l.target=zo)))}function la(s,l){var u={};return u[s.toLowerCase()]=l.toLowerCase(),u["Webkit"+s]="webkit"+l,u["Moz"+s]="moz"+l,u}var Ka={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionrun:la("Transition","TransitionRun"),transitionstart:la("Transition","TransitionStart"),transitioncancel:la("Transition","TransitionCancel"),transitionend:la("Transition","TransitionEnd")},Wl={},I0={};ms&&(I0=document.createElement("div").style,"AnimationEvent"in window||(delete Ka.animationend.animation,delete Ka.animationiteration.animation,delete Ka.animationstart.animation),"TransitionEvent"in window||delete Ka.transitionend.transition);function Qa(s){if(Wl[s])return Wl[s];if(!Ka[s])return s;var l=Ka[s],u;for(u in l)if(l.hasOwnProperty(u)&&u in I0)return Wl[s]=l[u];return s}var ca=Qa("animationend"),_s=Qa("animationiteration"),Hf=Qa("animationstart"),Vm=Qa("transitionrun"),k0=Qa("transitionstart"),F0=Qa("transitioncancel"),zf=Qa("transitionend"),jf=new Map,$f="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");$f.push("scrollEnd");function $i(s,l){jf.set(s,l),Re(l,[s])}var P0=new WeakMap;function oi(s,l){if(typeof s=="object"&&s!==null){var u=P0.get(s);return u!==void 0?u:(l={value:s,source:l,stack:Af(l)},P0.set(s,l),l)}return{value:s,source:l,stack:Af(l)}}var li=[],jo=0,Gf=0;function Qc(){for(var s=jo,l=Gf=jo=0;l<s;){var u=li[l];li[l++]=null;var p=li[l];li[l++]=null;var _=li[l];li[l++]=null;var E=li[l];if(li[l++]=null,p!==null&&_!==null){var O=p.pending;O===null?_.next=_:(_.next=O.next,O.next=_),p.pending=_}E!==0&&Wf(u,_,E)}}function Zc(s,l,u,p){li[jo++]=s,li[jo++]=l,li[jo++]=u,li[jo++]=p,Gf|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function Vf(s,l,u,p){return Zc(s,l,u,p),Jc(s)}function zr(s,l){return Zc(s,null,null,l),Jc(s)}function Wf(s,l,u){s.lanes|=u;var p=s.alternate;p!==null&&(p.lanes|=u);for(var _=!1,E=s.return;E!==null;)E.childLanes|=u,p=E.alternate,p!==null&&(p.childLanes|=u),E.tag===22&&(s=E.stateNode,s===null||s._visibility&1||(_=!0)),s=E,E=E.return;return s.tag===3?(E=s.stateNode,_&&l!==null&&(_=31-on(u),s=E.hiddenUpdates,p=s[_],p===null?s[_]=[l]:p.push(l),l.lane=u|536870912),E):null}function Jc(s){if(50<Ch)throw Ch=0,w1=null,Error(r(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var $o={};function Wm(s,l,u,p){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(s,l,u,p){return new Wm(s,l,u,p)}function Xf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function zs(s,l){var u=s.alternate;return u===null?(u=ci(s.tag,l,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=l,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,l=s.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function B0(s,l){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,l=u.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function eu(s,l,u,p,_,E){var O=0;if(p=s,typeof s=="function")Xf(s)&&(O=1);else if(typeof s=="string")O=lR(s,u,Ce.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case U:return s=ci(31,u,l,_),s.elementType=U,s.lanes=E,s;case y:return js(u.children,_,E,l);case b:O=8,_|=24;break;case A:return s=ci(12,u,l,_|2),s.elementType=A,s.lanes=E,s;case N:return s=ci(13,u,l,_),s.elementType=N,s.lanes=E,s;case I:return s=ci(19,u,l,_),s.elementType=I,s.lanes=E,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case w:case T:O=10;break e;case C:O=9;break e;case R:O=11;break e;case D:O=14;break e;case B:O=16,p=null;break e}O=29,u=Error(r(130,s===null?"null":typeof s,"")),p=null}return l=ci(O,u,l,_),l.elementType=s,l.type=p,l.lanes=E,l}function js(s,l,u,p){return s=ci(7,s,p,l),s.lanes=u,s}function Go(s,l,u){return s=ci(6,s,null,l),s.lanes=u,s}function Yf(s,l,u){return l=ci(4,s.children!==null?s.children:[],s.key,l),l.lanes=u,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var Za=[],Ja=0,ua=null,Vo=0,jr=[],Ci=0,eo=null,$s=1,Dr="";function to(s,l){Za[Ja++]=Vo,Za[Ja++]=ua,ua=s,Vo=l}function U0(s,l,u){jr[Ci++]=$s,jr[Ci++]=Dr,jr[Ci++]=eo,eo=s;var p=$s;s=Dr;var _=32-on(p)-1;p&=~(1<<_),u+=1;var E=32-on(l)+_;if(30<E){var O=_-_%5;E=(p&(1<<O)-1).toString(32),p>>=O,_-=O,$s=1<<32-on(l)+_|u<<_|p,Dr=E+s}else $s=1<<E|u<<_|p,Dr=s}function qf(s){s.return!==null&&(to(s,1),U0(s,1,0))}function Kf(s){for(;s===ua;)ua=Za[--Ja],Za[Ja]=null,Vo=Za[--Ja],Za[Ja]=null;for(;s===eo;)eo=jr[--Ci],jr[Ci]=null,Dr=jr[--Ci],jr[Ci]=null,$s=jr[--Ci],jr[Ci]=null}var er=null,wn=null,en=!1,fa=null,xs=!1,ha=Error(r(519));function Gs(s){var l=Error(r(418,""));throw Gi(oi(l,s)),ha}function Qf(s){var l=s.stateNode,u=s.type,p=s.memoizedProps;switch(l[Qn]=s,l[Zn]=p,u){case"dialog":Gt("cancel",l),Gt("close",l);break;case"iframe":case"object":case"embed":Gt("load",l);break;case"video":case"audio":for(u=0;u<Oh.length;u++)Gt(Oh[u],l);break;case"source":Gt("error",l);break;case"img":case"image":case"link":Gt("error",l),Gt("load",l);break;case"details":Gt("toggle",l);break;case"input":Gt("invalid",l),zc(l,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Fl(l);break;case"select":Gt("invalid",l);break;case"textarea":Gt("invalid",l),Bl(l,p.value,p.defaultValue,p.children),Fl(l)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||l.textContent===""+u||p.suppressHydrationWarning===!0||rE(l.textContent,u)?(p.popover!=null&&(Gt("beforetoggle",l),Gt("toggle",l)),p.onScroll!=null&&Gt("scroll",l),p.onScrollEnd!=null&&Gt("scrollend",l),p.onClick!=null&&(l.onclick=xp),l=!0):l=!1,l||Gs(s)}function H0(s){for(er=s.return;er;)switch(er.tag){case 5:case 13:xs=!1;return;case 27:case 3:xs=!0;return;default:er=er.return}}function Xl(s){if(s!==er)return!1;if(!en)return H0(s),en=!0,!1;var l=s.tag,u;if((u=l!==3&&l!==27)&&((u=l===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||H1(s.type,s.memoizedProps)),u=!u),u&&wn&&Gs(s),H0(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(l===0){wn=Ys(s.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++;s=s.nextSibling}wn=null}}else l===27?(l=wn,al(s.type)?(s=G1,G1=null,wn=s):wn=l):wn=er?Ys(s.stateNode.nextSibling):null;return!0}function Yl(){wn=er=null,en=!1}function Wo(){var s=fa;return s!==null&&(Mi===null?Mi=s:Mi.push.apply(Mi,s),fa=null),s}function Gi(s){fa===null?fa=[s]:fa.push(s)}var Zf=ye(null),no=null,Vs=null;function da(s,l,u){ge(Zf,l._currentValue),l._currentValue=u}function Ws(s){s._currentValue=Zf.current,ve(Zf)}function Jf(s,l,u){for(;s!==null;){var p=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),s===u)break;s=s.return}}function eh(s,l,u,p){var _=s.child;for(_!==null&&(_.return=s);_!==null;){var E=_.dependencies;if(E!==null){var O=_.child;E=E.firstContext;e:for(;E!==null;){var F=E;E=_;for(var Q=0;Q<l.length;Q++)if(F.context===l[Q]){E.lanes|=u,F=E.alternate,F!==null&&(F.lanes|=u),Jf(E.return,u,s),p||(O=null);break e}E=F.next}}else if(_.tag===18){if(O=_.return,O===null)throw Error(r(341));O.lanes|=u,E=O.alternate,E!==null&&(E.lanes|=u),Jf(O,u,s),O=null}else O=_.child;if(O!==null)O.return=_;else for(O=_;O!==null;){if(O===s){O=null;break}if(_=O.sibling,_!==null){_.return=O.return,O=_;break}O=O.return}_=O}}function ql(s,l,u,p){s=null;for(var _=l,E=!1;_!==null;){if(!E){if((_.flags&524288)!==0)E=!0;else if((_.flags&262144)!==0)break}if(_.tag===10){var O=_.alternate;if(O===null)throw Error(r(387));if(O=O.memoizedProps,O!==null){var F=_.type;Hr(_.pendingProps.value,O.value)||(s!==null?s.push(F):s=[F])}}else if(_===Ge.current){if(O=_.alternate,O===null)throw Error(r(387));O.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(s!==null?s.push(kh):s=[kh])}_=_.return}s!==null&&eh(l,s,u,p),l.flags|=262144}function Kl(s){for(s=s.firstContext;s!==null;){if(!Hr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ro(s){no=s,Vs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ur(s){return th(no,s)}function Xo(s,l){return no===null&&ro(s),th(s,l)}function th(s,l){var u=l._currentValue;if(l={context:l,memoizedValue:u,next:null},Vs===null){if(s===null)throw Error(r(308));Vs=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else Vs=Vs.next=l;return u}var io=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(u,p){s.push(p)}};this.abort=function(){l.aborted=!0,s.forEach(function(u){return u()})}},z0=n.unstable_scheduleCallback,nh=n.unstable_NormalPriority,Un={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ql(){return{controller:new io,data:new Map,refCount:0}}function Yo(s){s.refCount--,s.refCount===0&&z0(nh,function(){s.controller.abort()})}var so=null,rh=0,Di=0,ui=null;function Xm(s,l){if(so===null){var u=so=[];rh=0,Di=N1(),ui={status:"pending",value:void 0,then:function(p){u.push(p)}}}return rh++,l.then(j0,j0),l}function j0(){if(--rh===0&&so!==null){ui!==null&&(ui.status="fulfilled");var s=so;so=null,Di=0,ui=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function Ym(s,l){var u=[],p={status:"pending",value:null,reason:null,then:function(_){u.push(_)}};return s.then(function(){p.status="fulfilled",p.value=l;for(var _=0;_<u.length;_++)(0,u[_])(l)},function(_){for(p.status="rejected",p.reason=_,_=0;_<u.length;_++)(0,u[_])(void 0)}),p}var $0=q.S;q.S=function(s,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&Xm(s,l),$0!==null&&$0(s,l)};var ao=ye(null);function ih(){var s=ao.current;return s!==null?s:Sn.pooledCache}function tu(s,l){l===null?ge(ao,ao.current):ge(ao,l.pool)}function G0(){var s=ih();return s===null?null:{parent:Un._currentValue,pool:s}}var qo=Error(r(460)),Zl=Error(r(474)),oo=Error(r(542)),sh={then:function(){}};function V0(s){return s=s.status,s==="fulfilled"||s==="rejected"}function pa(){}function L(s,l,u){switch(u=s[u],u===void 0?s.push(l):u!==l&&(l.then(pa,pa),l=u),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,H(s),s;default:if(typeof l.status=="string")l.then(pa,pa);else{if(s=Sn,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=l,s.status="pending",s.then(function(p){if(l.status==="pending"){var _=l;_.status="fulfilled",_.value=p}},function(p){if(l.status==="pending"){var _=l;_.status="rejected",_.reason=p}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,H(s),s}throw x=l,qo}}var x=null;function S(){if(x===null)throw Error(r(459));var s=x;return x=null,s}function H(s){if(s===qo||s===oo)throw Error(r(483))}var ne=!1;function ae(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ae(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ne(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function We(s,l,u){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(hn&2)!==0){var _=p.pending;return _===null?l.next=l:(l.next=_.next,_.next=l),p.pending=l,l=Jc(s),Wf(s,null,u),l}return Zc(s,p,l,u),Jc(s)}function tt(s,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194048)!==0)){var p=l.lanes;p&=s.pendingLanes,u|=p,l.lanes=u,Uc(s,u)}}function it(s,l){var u=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var _=null,E=null;if(u=u.firstBaseUpdate,u!==null){do{var O={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};E===null?_=E=O:E=E.next=O,u=u.next}while(u!==null);E===null?_=E=l:E=E.next=l}else _=E=l;u={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:E,shared:p.shared,callbacks:p.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=l}var Je=!1;function Dt(){if(Je){var s=ui;if(s!==null)throw s}}function pt(s,l,u,p){Je=!1;var _=s.updateQueue;ne=!1;var E=_.firstBaseUpdate,O=_.lastBaseUpdate,F=_.shared.pending;if(F!==null){_.shared.pending=null;var Q=F,de=Q.next;Q.next=null,O===null?E=de:O.next=de,O=Q;var Oe=s.alternate;Oe!==null&&(Oe=Oe.updateQueue,F=Oe.lastBaseUpdate,F!==O&&(F===null?Oe.firstBaseUpdate=de:F.next=de,Oe.lastBaseUpdate=Q))}if(E!==null){var ke=_.baseState;O=0,Oe=de=Q=null,F=E;do{var me=F.lane&-536870913,_e=me!==F.lane;if(_e?(Kt&me)===me:(p&me)===me){me!==0&&me===Di&&(Je=!0),Oe!==null&&(Oe=Oe.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var Tt=s,xt=F;me=l;var _n=u;switch(xt.tag){case 1:if(Tt=xt.payload,typeof Tt=="function"){ke=Tt.call(_n,ke,me);break e}ke=Tt;break e;case 3:Tt.flags=Tt.flags&-65537|128;case 0:if(Tt=xt.payload,me=typeof Tt=="function"?Tt.call(_n,ke,me):Tt,me==null)break e;ke=d({},ke,me);break e;case 2:ne=!0}}me=F.callback,me!==null&&(s.flags|=64,_e&&(s.flags|=8192),_e=_.callbacks,_e===null?_.callbacks=[me]:_e.push(me))}else _e={lane:me,tag:F.tag,payload:F.payload,callback:F.callback,next:null},Oe===null?(de=Oe=_e,Q=ke):Oe=Oe.next=_e,O|=me;if(F=F.next,F===null){if(F=_.shared.pending,F===null)break;_e=F,F=_e.next,_e.next=null,_.lastBaseUpdate=_e,_.shared.pending=null}}while(!0);Oe===null&&(Q=ke),_.baseState=Q,_.firstBaseUpdate=de,_.lastBaseUpdate=Oe,E===null&&(_.shared.lanes=0),nl|=O,s.lanes=O,s.memoizedState=ke}}function Ot(s,l){if(typeof s!="function")throw Error(r(191,s));s.call(l)}function Et(s,l){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)Ot(u[s],l)}var _t=ye(null),tn=ye(0);function un(s,l){s=go,ge(tn,s),ge(_t,l),go=s|l.baseLanes}function Ft(){ge(tn,go),ge(_t,_t.current)}function Yt(){go=tn.current,ve(_t),ve(tn)}var At=0,et=null,ct=null,wt=null,qt=!1,mn=!1,zn=!1,$r=0,jn=0,fr=null,Oi=0;function Lt(){throw Error(r(321))}function Ri(s,l){if(l===null)return!1;for(var u=0;u<l.length&&u<s.length;u++)if(!Hr(s[u],l[u]))return!1;return!0}function Ni(s,l,u,p,_,E){return At=E,et=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,q.H=s===null||s.memoizedState===null?Py:By,zn=!1,E=u(p,_),zn=!1,mn&&(E=$n(l,u,p,_)),lo(s),E}function lo(s){q.H=J0;var l=ct!==null&&ct.next!==null;if(At=0,wt=ct=et=null,qt=!1,jn=0,fr=null,l)throw Error(r(300));s===null||_r||(s=s.dependencies,s!==null&&Kl(s)&&(_r=!0))}function $n(s,l,u,p){et=s;var _=0;do{if(mn&&(fr=null),jn=0,mn=!1,25<=_)throw Error(r(301));if(_+=1,wt=ct=null,s.updateQueue!=null){var E=s.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}q.H=xO,E=l(u,p)}while(mn);return E}function fn(){var s=q.H,l=s.useState()[0];return l=typeof l.then=="function"?ga(l):l,s=s.useState()[0],(ct!==null?ct.memoizedState:null)!==s&&(et.flags|=1024),l}function hr(){var s=$r!==0;return $r=0,s}function Gr(s,l,u){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~u}function ys(s){if(qt){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}qt=!1}At=0,wt=ct=et=null,mn=!1,jn=$r=0,fr=null}function dr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?et.memoizedState=wt=s:wt=wt.next=s,wt}function In(){if(ct===null){var s=et.alternate;s=s!==null?s.memoizedState:null}else s=ct.next;var l=wt===null?et.memoizedState:wt.next;if(l!==null)wt=l,ct=s;else{if(s===null)throw et.alternate===null?Error(r(467)):Error(r(310));ct=s,s={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},wt===null?et.memoizedState=wt=s:wt=wt.next=s}return wt}function nu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ga(s){var l=jn;return jn+=1,fr===null&&(fr=[]),s=L(fr,s,l),l=et,(wt===null?l.memoizedState:wt.next)===null&&(l=l.alternate,q.H=l===null||l.memoizedState===null?Py:By),s}function ru(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return ga(s);if(s.$$typeof===T)return ur(s)}throw Error(r(438,String(s)))}function ah(s){var l=null,u=et.updateQueue;if(u!==null&&(l=u.memoCache),l==null){var p=et.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(l={data:p.data.map(function(_){return _.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),u===null&&(u=nu(),et.updateQueue=u),u.memoCache=l,u=l.data[l.index],u===void 0)for(u=l.data[l.index]=Array(s),p=0;p<s;p++)u[p]=Y;return l.index++,u}function Vi(s,l){return typeof l=="function"?l(s):l}function iu(s){var l=In();return su(l,ct,s)}function su(s,l,u){var p=s.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var _=s.baseQueue,E=p.pending;if(E!==null){if(_!==null){var O=_.next;_.next=E.next,E.next=O}l.baseQueue=_=E,p.pending=null}if(E=s.baseState,_===null)s.memoizedState=E;else{l=_.next;var F=O=null,Q=null,de=l,Oe=!1;do{var ke=de.lane&-536870913;if(ke!==de.lane?(Kt&ke)===ke:(At&ke)===ke){var me=de.revertLane;if(me===0)Q!==null&&(Q=Q.next={lane:0,revertLane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),ke===Di&&(Oe=!0);else if((At&me)===me){de=de.next,me===Di&&(Oe=!0);continue}else ke={lane:0,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},Q===null?(F=Q=ke,O=E):Q=Q.next=ke,et.lanes|=me,nl|=me;ke=de.action,zn&&u(E,ke),E=de.hasEagerState?de.eagerState:u(E,ke)}else me={lane:ke,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},Q===null?(F=Q=me,O=E):Q=Q.next=me,et.lanes|=ke,nl|=ke;de=de.next}while(de!==null&&de!==l);if(Q===null?O=E:Q.next=F,!Hr(E,s.memoizedState)&&(_r=!0,Oe&&(u=ui,u!==null)))throw u;s.memoizedState=E,s.baseState=O,s.baseQueue=Q,p.lastRenderedState=E}return _===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function oh(s){var l=In(),u=l.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var p=u.dispatch,_=u.pending,E=l.memoizedState;if(_!==null){u.pending=null;var O=_=_.next;do E=s(E,O.action),O=O.next;while(O!==_);Hr(E,l.memoizedState)||(_r=!0),l.memoizedState=E,l.baseQueue===null&&(l.baseState=E),u.lastRenderedState=E}return[E,p]}function lh(s,l,u){var p=et,_=In(),E=en;if(E){if(u===void 0)throw Error(r(407));u=u()}else u=l();var O=!Hr((ct||_).memoizedState,u);O&&(_.memoizedState=u,_r=!0),_=_.queue;var F=X0.bind(null,p,_,s);if(mh(2048,8,F,[s]),_.getSnapshot!==l||O||wt!==null&&wt.memoizedState.tag&1){if(p.flags|=2048,cu(9,K0(),W0.bind(null,p,_,u,l),null),Sn===null)throw Error(r(349));E||(At&124)!==0||ch(p,l,u)}return u}function ch(s,l,u){s.flags|=16384,s={getSnapshot:l,value:u},l=et.updateQueue,l===null?(l=nu(),et.updateQueue=l,l.stores=[s]):(u=l.stores,u===null?l.stores=[s]:u.push(s))}function W0(s,l,u,p){l.value=u,l.getSnapshot=p,ma(l)&&Jl(s)}function X0(s,l,u){return u(function(){ma(l)&&Jl(s)})}function ma(s){var l=s.getSnapshot;s=s.value;try{var u=l();return!Hr(s,u)}catch{return!0}}function Jl(s){var l=zr(s,2);l!==null&&Ki(l,s,2)}function au(s){var l=dr();if(typeof s=="function"){var u=s;if(s=u(),zn){It(!0);try{u()}finally{It(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:s},l}function uh(s,l,u,p){return s.baseState=u,su(s,ct,typeof p=="function"?p:Vi)}function fh(s,l,u,p,_){if(Z0(s))throw Error(r(485));if(s=l.action,s!==null){var E={payload:_,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){E.listeners.push(O)}};q.T!==null?u(!0):E.isTransition=!1,p(E),u=l.pending,u===null?(E.next=l.pending=E,hh(l,E)):(E.next=u.next,l.pending=u.next=E)}}function hh(s,l){var u=l.action,p=l.payload,_=s.state;if(l.isTransition){var E=q.T,O={};q.T=O;try{var F=u(_,p),Q=q.S;Q!==null&&Q(O,F),dh(s,l,F)}catch(de){ou(s,l,de)}finally{q.T=E}}else try{E=u(_,p),dh(s,l,E)}catch(de){ou(s,l,de)}}function dh(s,l,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){ph(s,l,p)},function(p){return ou(s,l,p)}):ph(s,l,u)}function ph(s,l,u){l.status="fulfilled",l.value=u,Y0(l),s.state=u,l=s.pending,l!==null&&(u=l.next,u===l?s.pending=null:(u=u.next,l.next=u,hh(s,u)))}function ou(s,l,u){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do l.status="rejected",l.reason=u,Y0(l),l=l.next;while(l!==p)}s.action=null}function Y0(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function q0(s,l){return l}function lu(s,l){if(en){var u=Sn.formState;if(u!==null){e:{var p=et;if(en){if(wn){t:{for(var _=wn,E=xs;_.nodeType!==8;){if(!E){_=null;break t}if(_=Ys(_.nextSibling),_===null){_=null;break t}}E=_.data,_=E==="F!"||E==="F"?_:null}if(_){wn=Ys(_.nextSibling),p=_.data==="F!";break e}}Gs(p)}p=!1}p&&(l=u[0])}}return u=dr(),u.memoizedState=u.baseState=l,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:q0,lastRenderedState:l},u.queue=p,u=Iy.bind(null,et,p),p.dispatch=u,p=au(!1),E=Jm.bind(null,et,!1,p.queue),p=dr(),_={state:l,dispatch:null,action:s,pending:null},p.queue=_,u=fh.bind(null,et,_,E,u),_.dispatch=u,p.memoizedState=s,[l,u,!1]}function gh(s){var l=In();return vy(l,ct,s)}function vy(s,l,u){if(l=su(s,l,q0)[0],s=iu(Vi)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var p=ga(l)}catch(O){throw O===qo?oo:O}else p=l;l=In();var _=l.queue,E=_.dispatch;return u!==l.memoizedState&&(et.flags|=2048,cu(9,K0(),gO.bind(null,_,u),null)),[p,E,s]}function gO(s,l){s.action=l}function _y(s){var l=In(),u=ct;if(u!==null)return vy(l,u,s);In(),l=l.memoizedState,u=In();var p=u.queue.dispatch;return u.memoizedState=s,[l,p,!1]}function cu(s,l,u,p){return s={tag:s,create:u,deps:p,inst:l,next:null},l=et.updateQueue,l===null&&(l=nu(),et.updateQueue=l),u=l.lastEffect,u===null?l.lastEffect=s.next=s:(p=u.next,u.next=s,s.next=p,l.lastEffect=s),s}function K0(){return{destroy:void 0,resource:void 0}}function xy(){return In().memoizedState}function Q0(s,l,u,p){var _=dr();p=p===void 0?null:p,et.flags|=s,_.memoizedState=cu(1|l,K0(),u,p)}function mh(s,l,u,p){var _=In();p=p===void 0?null:p;var E=_.memoizedState.inst;ct!==null&&p!==null&&Ri(p,ct.memoizedState.deps)?_.memoizedState=cu(l,E,u,p):(et.flags|=s,_.memoizedState=cu(1|l,E,u,p))}function yy(s,l){Q0(8390656,8,s,l)}function by(s,l){mh(2048,8,s,l)}function Ey(s,l){return mh(4,2,s,l)}function Ay(s,l){return mh(4,4,s,l)}function wy(s,l){if(typeof l=="function"){s=s();var u=l(s);return function(){typeof u=="function"?u():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function Sy(s,l,u){u=u!=null?u.concat([s]):null,mh(4,4,wy.bind(null,l,s),u)}function qm(){}function Ty(s,l){var u=In();l=l===void 0?null:l;var p=u.memoizedState;return l!==null&&Ri(l,p[1])?p[0]:(u.memoizedState=[s,l],s)}function Cy(s,l){var u=In();l=l===void 0?null:l;var p=u.memoizedState;if(l!==null&&Ri(l,p[1]))return p[0];if(p=s(),zn){It(!0);try{s()}finally{It(!1)}}return u.memoizedState=[p,l],p}function Km(s,l,u){return u===void 0||(At&1073741824)!==0?s.memoizedState=l:(s.memoizedState=u,s=Rb(),et.lanes|=s,nl|=s,u)}function Dy(s,l,u,p){return Hr(u,l)?u:_t.current!==null?(s=Km(s,u,p),Hr(s,l)||(_r=!0),s):(At&42)===0?(_r=!0,s.memoizedState=u):(s=Rb(),et.lanes|=s,nl|=s,l)}function Oy(s,l,u,p,_){var E=ee.p;ee.p=E!==0&&8>E?E:8;var O=q.T,F={};q.T=F,Jm(s,!1,l,u);try{var Q=_(),de=q.S;if(de!==null&&de(F,Q),Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var Oe=Ym(Q,p);vh(s,l,Oe,qi(s))}else vh(s,l,p,qi(s))}catch(ke){vh(s,l,{then:function(){},status:"rejected",reason:ke},qi())}finally{ee.p=E,q.T=O}}function mO(){}function Qm(s,l,u,p){if(s.tag!==5)throw Error(r(476));var _=Ry(s).queue;Oy(s,_,l,Pe,u===null?mO:function(){return Ny(s),u(p)})}function Ry(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:Pe,baseState:Pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:Pe},next:null};var u={};return l.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:u},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function Ny(s){var l=Ry(s).next.queue;vh(s,l,{},qi())}function Zm(){return ur(kh)}function Ly(){return In().memoizedState}function My(){return In().memoizedState}function vO(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var u=qi();s=Ne(u);var p=We(l,s,u);p!==null&&(Ki(p,l,u),tt(p,l,u)),l={cache:Ql()},s.payload=l;return}l=l.return}}function _O(s,l,u){var p=qi();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Z0(s)?ky(l,u):(u=Vf(s,l,u,p),u!==null&&(Ki(u,s,p),Fy(u,l,p)))}function Iy(s,l,u){var p=qi();vh(s,l,u,p)}function vh(s,l,u,p){var _={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Z0(s))ky(l,_);else{var E=s.alternate;if(s.lanes===0&&(E===null||E.lanes===0)&&(E=l.lastRenderedReducer,E!==null))try{var O=l.lastRenderedState,F=E(O,u);if(_.hasEagerState=!0,_.eagerState=F,Hr(F,O))return Zc(s,l,_,0),Sn===null&&Qc(),!1}catch{}finally{}if(u=Vf(s,l,_,p),u!==null)return Ki(u,s,p),Fy(u,l,p),!0}return!1}function Jm(s,l,u,p){if(p={lane:2,revertLane:N1(),action:p,hasEagerState:!1,eagerState:null,next:null},Z0(s)){if(l)throw Error(r(479))}else l=Vf(s,u,p,2),l!==null&&Ki(l,s,2)}function Z0(s){var l=s.alternate;return s===et||l!==null&&l===et}function ky(s,l){mn=qt=!0;var u=s.pending;u===null?l.next=l:(l.next=u.next,u.next=l),s.pending=l}function Fy(s,l,u){if((u&4194048)!==0){var p=l.lanes;p&=s.pendingLanes,u|=p,l.lanes=u,Uc(s,u)}}var J0={readContext:ur,use:ru,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useLayoutEffect:Lt,useInsertionEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useSyncExternalStore:Lt,useId:Lt,useHostTransitionStatus:Lt,useFormState:Lt,useActionState:Lt,useOptimistic:Lt,useMemoCache:Lt,useCacheRefresh:Lt},Py={readContext:ur,use:ru,useCallback:function(s,l){return dr().memoizedState=[s,l===void 0?null:l],s},useContext:ur,useEffect:yy,useImperativeHandle:function(s,l,u){u=u!=null?u.concat([s]):null,Q0(4194308,4,wy.bind(null,l,s),u)},useLayoutEffect:function(s,l){return Q0(4194308,4,s,l)},useInsertionEffect:function(s,l){Q0(4,2,s,l)},useMemo:function(s,l){var u=dr();l=l===void 0?null:l;var p=s();if(zn){It(!0);try{s()}finally{It(!1)}}return u.memoizedState=[p,l],p},useReducer:function(s,l,u){var p=dr();if(u!==void 0){var _=u(l);if(zn){It(!0);try{u(l)}finally{It(!1)}}}else _=l;return p.memoizedState=p.baseState=_,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:_},p.queue=s,s=s.dispatch=_O.bind(null,et,s),[p.memoizedState,s]},useRef:function(s){var l=dr();return s={current:s},l.memoizedState=s},useState:function(s){s=au(s);var l=s.queue,u=Iy.bind(null,et,l);return l.dispatch=u,[s.memoizedState,u]},useDebugValue:qm,useDeferredValue:function(s,l){var u=dr();return Km(u,s,l)},useTransition:function(){var s=au(!1);return s=Oy.bind(null,et,s.queue,!0,!1),dr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,u){var p=et,_=dr();if(en){if(u===void 0)throw Error(r(407));u=u()}else{if(u=l(),Sn===null)throw Error(r(349));(Kt&124)!==0||ch(p,l,u)}_.memoizedState=u;var E={value:u,getSnapshot:l};return _.queue=E,yy(X0.bind(null,p,E,s),[s]),p.flags|=2048,cu(9,K0(),W0.bind(null,p,E,u,l),null),u},useId:function(){var s=dr(),l=Sn.identifierPrefix;if(en){var u=Dr,p=$s;u=(p&~(1<<32-on(p)-1)).toString(32)+u,l=""+l+"R"+u,u=$r++,0<u&&(l+="H"+u.toString(32)),l+=""}else u=Oi++,l=""+l+"r"+u.toString(32)+"";return s.memoizedState=l},useHostTransitionStatus:Zm,useFormState:lu,useActionState:lu,useOptimistic:function(s){var l=dr();l.memoizedState=l.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=u,l=Jm.bind(null,et,!0,u),u.dispatch=l,[s,l]},useMemoCache:ah,useCacheRefresh:function(){return dr().memoizedState=vO.bind(null,et)}},By={readContext:ur,use:ru,useCallback:Ty,useContext:ur,useEffect:by,useImperativeHandle:Sy,useInsertionEffect:Ey,useLayoutEffect:Ay,useMemo:Cy,useReducer:iu,useRef:xy,useState:function(){return iu(Vi)},useDebugValue:qm,useDeferredValue:function(s,l){var u=In();return Dy(u,ct.memoizedState,s,l)},useTransition:function(){var s=iu(Vi)[0],l=In().memoizedState;return[typeof s=="boolean"?s:ga(s),l]},useSyncExternalStore:lh,useId:Ly,useHostTransitionStatus:Zm,useFormState:gh,useActionState:gh,useOptimistic:function(s,l){var u=In();return uh(u,ct,s,l)},useMemoCache:ah,useCacheRefresh:My},xO={readContext:ur,use:ru,useCallback:Ty,useContext:ur,useEffect:by,useImperativeHandle:Sy,useInsertionEffect:Ey,useLayoutEffect:Ay,useMemo:Cy,useReducer:oh,useRef:xy,useState:function(){return oh(Vi)},useDebugValue:qm,useDeferredValue:function(s,l){var u=In();return ct===null?Km(u,s,l):Dy(u,ct.memoizedState,s,l)},useTransition:function(){var s=oh(Vi)[0],l=In().memoizedState;return[typeof s=="boolean"?s:ga(s),l]},useSyncExternalStore:lh,useId:Ly,useHostTransitionStatus:Zm,useFormState:_y,useActionState:_y,useOptimistic:function(s,l){var u=In();return ct!==null?uh(u,ct,s,l):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:ah,useCacheRefresh:My},uu=null,_h=0;function ep(s){var l=_h;return _h+=1,uu===null&&(uu=[]),L(uu,s,l)}function xh(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function tp(s,l){throw l.$$typeof===g?Error(r(525)):(s=Object.prototype.toString.call(l),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function Uy(s){var l=s._init;return l(s._payload)}function Hy(s){function l(oe,te){if(s){var fe=oe.deletions;fe===null?(oe.deletions=[te],oe.flags|=16):fe.push(te)}}function u(oe,te){if(!s)return null;for(;te!==null;)l(oe,te),te=te.sibling;return null}function p(oe){for(var te=new Map;oe!==null;)oe.key!==null?te.set(oe.key,oe):te.set(oe.index,oe),oe=oe.sibling;return te}function _(oe,te){return oe=zs(oe,te),oe.index=0,oe.sibling=null,oe}function E(oe,te,fe){return oe.index=fe,s?(fe=oe.alternate,fe!==null?(fe=fe.index,fe<te?(oe.flags|=67108866,te):fe):(oe.flags|=67108866,te)):(oe.flags|=1048576,te)}function O(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function F(oe,te,fe,Le){return te===null||te.tag!==6?(te=Go(fe,oe.mode,Le),te.return=oe,te):(te=_(te,fe),te.return=oe,te)}function Q(oe,te,fe,Le){var at=fe.type;return at===y?Oe(oe,te,fe.props.children,Le,fe.key):te!==null&&(te.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===B&&Uy(at)===te.type)?(te=_(te,fe.props),xh(te,fe),te.return=oe,te):(te=eu(fe.type,fe.key,fe.props,null,oe.mode,Le),xh(te,fe),te.return=oe,te)}function de(oe,te,fe,Le){return te===null||te.tag!==4||te.stateNode.containerInfo!==fe.containerInfo||te.stateNode.implementation!==fe.implementation?(te=Yf(fe,oe.mode,Le),te.return=oe,te):(te=_(te,fe.children||[]),te.return=oe,te)}function Oe(oe,te,fe,Le,at){return te===null||te.tag!==7?(te=js(fe,oe.mode,Le,at),te.return=oe,te):(te=_(te,fe),te.return=oe,te)}function ke(oe,te,fe){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=Go(""+te,oe.mode,fe),te.return=oe,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case m:return fe=eu(te.type,te.key,te.props,null,oe.mode,fe),xh(fe,te),fe.return=oe,fe;case v:return te=Yf(te,oe.mode,fe),te.return=oe,te;case B:var Le=te._init;return te=Le(te._payload),ke(oe,te,fe)}if(we(te)||re(te))return te=js(te,oe.mode,fe,null),te.return=oe,te;if(typeof te.then=="function")return ke(oe,ep(te),fe);if(te.$$typeof===T)return ke(oe,Xo(oe,te),fe);tp(oe,te)}return null}function me(oe,te,fe,Le){var at=te!==null?te.key:null;if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return at!==null?null:F(oe,te,""+fe,Le);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case m:return fe.key===at?Q(oe,te,fe,Le):null;case v:return fe.key===at?de(oe,te,fe,Le):null;case B:return at=fe._init,fe=at(fe._payload),me(oe,te,fe,Le)}if(we(fe)||re(fe))return at!==null?null:Oe(oe,te,fe,Le,null);if(typeof fe.then=="function")return me(oe,te,ep(fe),Le);if(fe.$$typeof===T)return me(oe,te,Xo(oe,fe),Le);tp(oe,fe)}return null}function _e(oe,te,fe,Le,at){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return oe=oe.get(fe)||null,F(te,oe,""+Le,at);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case m:return oe=oe.get(Le.key===null?fe:Le.key)||null,Q(te,oe,Le,at);case v:return oe=oe.get(Le.key===null?fe:Le.key)||null,de(te,oe,Le,at);case B:var jt=Le._init;return Le=jt(Le._payload),_e(oe,te,fe,Le,at)}if(we(Le)||re(Le))return oe=oe.get(fe)||null,Oe(te,oe,Le,at,null);if(typeof Le.then=="function")return _e(oe,te,fe,ep(Le),at);if(Le.$$typeof===T)return _e(oe,te,fe,Xo(te,Le),at);tp(te,Le)}return null}function Tt(oe,te,fe,Le){for(var at=null,jt=null,ut=te,yt=te=0,yr=null;ut!==null&&yt<fe.length;yt++){ut.index>yt?(yr=ut,ut=null):yr=ut.sibling;var rn=me(oe,ut,fe[yt],Le);if(rn===null){ut===null&&(ut=yr);break}s&&ut&&rn.alternate===null&&l(oe,ut),te=E(rn,te,yt),jt===null?at=rn:jt.sibling=rn,jt=rn,ut=yr}if(yt===fe.length)return u(oe,ut),en&&to(oe,yt),at;if(ut===null){for(;yt<fe.length;yt++)ut=ke(oe,fe[yt],Le),ut!==null&&(te=E(ut,te,yt),jt===null?at=ut:jt.sibling=ut,jt=ut);return en&&to(oe,yt),at}for(ut=p(ut);yt<fe.length;yt++)yr=_e(ut,oe,yt,fe[yt],Le),yr!==null&&(s&&yr.alternate!==null&&ut.delete(yr.key===null?yt:yr.key),te=E(yr,te,yt),jt===null?at=yr:jt.sibling=yr,jt=yr);return s&&ut.forEach(function(fl){return l(oe,fl)}),en&&to(oe,yt),at}function xt(oe,te,fe,Le){if(fe==null)throw Error(r(151));for(var at=null,jt=null,ut=te,yt=te=0,yr=null,rn=fe.next();ut!==null&&!rn.done;yt++,rn=fe.next()){ut.index>yt?(yr=ut,ut=null):yr=ut.sibling;var fl=me(oe,ut,rn.value,Le);if(fl===null){ut===null&&(ut=yr);break}s&&ut&&fl.alternate===null&&l(oe,ut),te=E(fl,te,yt),jt===null?at=fl:jt.sibling=fl,jt=fl,ut=yr}if(rn.done)return u(oe,ut),en&&to(oe,yt),at;if(ut===null){for(;!rn.done;yt++,rn=fe.next())rn=ke(oe,rn.value,Le),rn!==null&&(te=E(rn,te,yt),jt===null?at=rn:jt.sibling=rn,jt=rn);return en&&to(oe,yt),at}for(ut=p(ut);!rn.done;yt++,rn=fe.next())rn=_e(ut,oe,yt,rn.value,Le),rn!==null&&(s&&rn.alternate!==null&&ut.delete(rn.key===null?yt:rn.key),te=E(rn,te,yt),jt===null?at=rn:jt.sibling=rn,jt=rn);return s&&ut.forEach(function(yR){return l(oe,yR)}),en&&to(oe,yt),at}function _n(oe,te,fe,Le){if(typeof fe=="object"&&fe!==null&&fe.type===y&&fe.key===null&&(fe=fe.props.children),typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case m:e:{for(var at=fe.key;te!==null;){if(te.key===at){if(at=fe.type,at===y){if(te.tag===7){u(oe,te.sibling),Le=_(te,fe.props.children),Le.return=oe,oe=Le;break e}}else if(te.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===B&&Uy(at)===te.type){u(oe,te.sibling),Le=_(te,fe.props),xh(Le,fe),Le.return=oe,oe=Le;break e}u(oe,te);break}else l(oe,te);te=te.sibling}fe.type===y?(Le=js(fe.props.children,oe.mode,Le,fe.key),Le.return=oe,oe=Le):(Le=eu(fe.type,fe.key,fe.props,null,oe.mode,Le),xh(Le,fe),Le.return=oe,oe=Le)}return O(oe);case v:e:{for(at=fe.key;te!==null;){if(te.key===at)if(te.tag===4&&te.stateNode.containerInfo===fe.containerInfo&&te.stateNode.implementation===fe.implementation){u(oe,te.sibling),Le=_(te,fe.children||[]),Le.return=oe,oe=Le;break e}else{u(oe,te);break}else l(oe,te);te=te.sibling}Le=Yf(fe,oe.mode,Le),Le.return=oe,oe=Le}return O(oe);case B:return at=fe._init,fe=at(fe._payload),_n(oe,te,fe,Le)}if(we(fe))return Tt(oe,te,fe,Le);if(re(fe)){if(at=re(fe),typeof at!="function")throw Error(r(150));return fe=at.call(fe),xt(oe,te,fe,Le)}if(typeof fe.then=="function")return _n(oe,te,ep(fe),Le);if(fe.$$typeof===T)return _n(oe,te,Xo(oe,fe),Le);tp(oe,fe)}return typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint"?(fe=""+fe,te!==null&&te.tag===6?(u(oe,te.sibling),Le=_(te,fe),Le.return=oe,oe=Le):(u(oe,te),Le=Go(fe,oe.mode,Le),Le.return=oe,oe=Le),O(oe)):u(oe,te)}return function(oe,te,fe,Le){try{_h=0;var at=_n(oe,te,fe,Le);return uu=null,at}catch(ut){if(ut===qo||ut===oo)throw ut;var jt=ci(29,ut,null,oe.mode);return jt.lanes=Le,jt.return=oe,jt}finally{}}}var fu=Hy(!0),zy=Hy(!1),bs=ye(null),va=null;function Ko(s){var l=s.alternate;ge(pr,pr.current&1),ge(bs,s),va===null&&(l===null||_t.current!==null||l.memoizedState!==null)&&(va=s)}function jy(s){if(s.tag===22){if(ge(pr,pr.current),ge(bs,s),va===null){var l=s.alternate;l!==null&&l.memoizedState!==null&&(va=s)}}else Qo()}function Qo(){ge(pr,pr.current),ge(bs,bs.current)}function co(s){ve(bs),va===s&&(va=null),ve(pr)}var pr=ye(0);function np(s){for(var l=s;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||$1(u)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}function e1(s,l,u,p){l=s.memoizedState,u=u(p,l),u=u==null?l:d({},l,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var t1={enqueueSetState:function(s,l,u){s=s._reactInternals;var p=qi(),_=Ne(p);_.payload=l,u!=null&&(_.callback=u),l=We(s,_,p),l!==null&&(Ki(l,s,p),tt(l,s,p))},enqueueReplaceState:function(s,l,u){s=s._reactInternals;var p=qi(),_=Ne(p);_.tag=1,_.payload=l,u!=null&&(_.callback=u),l=We(s,_,p),l!==null&&(Ki(l,s,p),tt(l,s,p))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var u=qi(),p=Ne(u);p.tag=2,l!=null&&(p.callback=l),l=We(s,p,u),l!==null&&(Ki(l,s,u),tt(l,s,u))}};function $y(s,l,u,p,_,E,O){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,E,O):l.prototype&&l.prototype.isPureReactComponent?!qa(u,p)||!qa(_,E):!0}function Gy(s,l,u,p){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,p),l.state!==s&&t1.enqueueReplaceState(l,l.state,null)}function ec(s,l){var u=l;if("ref"in l){u={};for(var p in l)p!=="ref"&&(u[p]=l[p])}if(s=s.defaultProps){u===l&&(u=d({},u));for(var _ in s)u[_]===void 0&&(u[_]=s[_])}return u}var rp=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Vy(s){rp(s)}function Wy(s){console.error(s)}function Xy(s){rp(s)}function ip(s,l){try{var u=s.onUncaughtError;u(l.value,{componentStack:l.stack})}catch(p){setTimeout(function(){throw p})}}function Yy(s,l,u){try{var p=s.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function n1(s,l,u){return u=Ne(u),u.tag=3,u.payload={element:null},u.callback=function(){ip(s,l)},u}function qy(s){return s=Ne(s),s.tag=3,s}function Ky(s,l,u,p){var _=u.type.getDerivedStateFromError;if(typeof _=="function"){var E=p.value;s.payload=function(){return _(E)},s.callback=function(){Yy(l,u,p)}}var O=u.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(s.callback=function(){Yy(l,u,p),typeof _!="function"&&(rl===null?rl=new Set([this]):rl.add(this));var F=p.stack;this.componentDidCatch(p.value,{componentStack:F!==null?F:""})})}function yO(s,l,u,p,_){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(l=u.alternate,l!==null&&ql(l,u,_,!0),u=bs.current,u!==null){switch(u.tag){case 13:return va===null?T1():u.alternate===null&&Hn===0&&(Hn=3),u.flags&=-257,u.flags|=65536,u.lanes=_,p===sh?u.flags|=16384:(l=u.updateQueue,l===null?u.updateQueue=new Set([p]):l.add(p),D1(s,p,_)),!1;case 22:return u.flags|=65536,p===sh?u.flags|=16384:(l=u.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=l):(u=l.retryQueue,u===null?l.retryQueue=new Set([p]):u.add(p)),D1(s,p,_)),!1}throw Error(r(435,u.tag))}return D1(s,p,_),T1(),!1}if(en)return l=bs.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=_,p!==ha&&(s=Error(r(422),{cause:p}),Gi(oi(s,u)))):(p!==ha&&(l=Error(r(423),{cause:p}),Gi(oi(l,u))),s=s.current.alternate,s.flags|=65536,_&=-_,s.lanes|=_,p=oi(p,u),_=n1(s.stateNode,p,_),it(s,_),Hn!==4&&(Hn=2)),!1;var E=Error(r(520),{cause:p});if(E=oi(E,u),Th===null?Th=[E]:Th.push(E),Hn!==4&&(Hn=2),l===null)return!0;p=oi(p,u),u=l;do{switch(u.tag){case 3:return u.flags|=65536,s=_&-_,u.lanes|=s,s=n1(u.stateNode,p,s),it(u,s),!1;case 1:if(l=u.type,E=u.stateNode,(u.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(rl===null||!rl.has(E))))return u.flags|=65536,_&=-_,u.lanes|=_,_=qy(_),Ky(_,s,u,p),it(u,_),!1}u=u.return}while(u!==null);return!1}var Qy=Error(r(461)),_r=!1;function Or(s,l,u,p){l.child=s===null?zy(l,null,u,p):fu(l,s.child,u,p)}function Zy(s,l,u,p,_){u=u.render;var E=l.ref;if("ref"in p){var O={};for(var F in p)F!=="ref"&&(O[F]=p[F])}else O=p;return ro(l),p=Ni(s,l,u,O,E,_),F=hr(),s!==null&&!_r?(Gr(s,l,_),uo(s,l,_)):(en&&F&&qf(l),l.flags|=1,Or(s,l,p,_),l.child)}function Jy(s,l,u,p,_){if(s===null){var E=u.type;return typeof E=="function"&&!Xf(E)&&E.defaultProps===void 0&&u.compare===null?(l.tag=15,l.type=E,eb(s,l,E,p,_)):(s=eu(u.type,null,p,l,l.mode,_),s.ref=l.ref,s.return=l,l.child=s)}if(E=s.child,!u1(s,_)){var O=E.memoizedProps;if(u=u.compare,u=u!==null?u:qa,u(O,p)&&s.ref===l.ref)return uo(s,l,_)}return l.flags|=1,s=zs(E,p),s.ref=l.ref,s.return=l,l.child=s}function eb(s,l,u,p,_){if(s!==null){var E=s.memoizedProps;if(qa(E,p)&&s.ref===l.ref)if(_r=!1,l.pendingProps=p=E,u1(s,_))(s.flags&131072)!==0&&(_r=!0);else return l.lanes=s.lanes,uo(s,l,_)}return r1(s,l,u,p,_)}function tb(s,l,u){var p=l.pendingProps,_=p.children,E=s!==null?s.memoizedState:null;if(p.mode==="hidden"){if((l.flags&128)!==0){if(p=E!==null?E.baseLanes|u:u,s!==null){for(_=l.child=s.child,E=0;_!==null;)E=E|_.lanes|_.childLanes,_=_.sibling;l.childLanes=E&~p}else l.childLanes=0,l.child=null;return nb(s,l,p,u)}if((u&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&tu(l,E!==null?E.cachePool:null),E!==null?un(l,E):Ft(),jy(l);else return l.lanes=l.childLanes=536870912,nb(s,l,E!==null?E.baseLanes|u:u,u)}else E!==null?(tu(l,E.cachePool),un(l,E),Qo(),l.memoizedState=null):(s!==null&&tu(l,null),Ft(),Qo());return Or(s,l,_,u),l.child}function nb(s,l,u,p){var _=ih();return _=_===null?null:{parent:Un._currentValue,pool:_},l.memoizedState={baseLanes:u,cachePool:_},s!==null&&tu(l,null),Ft(),jy(l),s!==null&&ql(s,l,p,!0),null}function sp(s,l){var u=l.ref;if(u===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(s===null||s.ref!==u)&&(l.flags|=4194816)}}function r1(s,l,u,p,_){return ro(l),u=Ni(s,l,u,p,void 0,_),p=hr(),s!==null&&!_r?(Gr(s,l,_),uo(s,l,_)):(en&&p&&qf(l),l.flags|=1,Or(s,l,u,_),l.child)}function rb(s,l,u,p,_,E){return ro(l),l.updateQueue=null,u=$n(l,p,u,_),lo(s),p=hr(),s!==null&&!_r?(Gr(s,l,E),uo(s,l,E)):(en&&p&&qf(l),l.flags|=1,Or(s,l,u,E),l.child)}function ib(s,l,u,p,_){if(ro(l),l.stateNode===null){var E=$o,O=u.contextType;typeof O=="object"&&O!==null&&(E=ur(O)),E=new u(p,E),l.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=t1,l.stateNode=E,E._reactInternals=l,E=l.stateNode,E.props=p,E.state=l.memoizedState,E.refs={},ae(l),O=u.contextType,E.context=typeof O=="object"&&O!==null?ur(O):$o,E.state=l.memoizedState,O=u.getDerivedStateFromProps,typeof O=="function"&&(e1(l,u,O,p),E.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(O=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),O!==E.state&&t1.enqueueReplaceState(E,E.state,null),pt(l,p,E,_),Dt(),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308),p=!0}else if(s===null){E=l.stateNode;var F=l.memoizedProps,Q=ec(u,F);E.props=Q;var de=E.context,Oe=u.contextType;O=$o,typeof Oe=="object"&&Oe!==null&&(O=ur(Oe));var ke=u.getDerivedStateFromProps;Oe=typeof ke=="function"||typeof E.getSnapshotBeforeUpdate=="function",F=l.pendingProps!==F,Oe||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(F||de!==O)&&Gy(l,E,p,O),ne=!1;var me=l.memoizedState;E.state=me,pt(l,p,E,_),Dt(),de=l.memoizedState,F||me!==de||ne?(typeof ke=="function"&&(e1(l,u,ke,p),de=l.memoizedState),(Q=ne||$y(l,u,Q,p,me,de,O))?(Oe||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=de),E.props=p,E.state=de,E.context=O,p=Q):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{E=l.stateNode,Ae(s,l),O=l.memoizedProps,Oe=ec(u,O),E.props=Oe,ke=l.pendingProps,me=E.context,de=u.contextType,Q=$o,typeof de=="object"&&de!==null&&(Q=ur(de)),F=u.getDerivedStateFromProps,(de=typeof F=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(O!==ke||me!==Q)&&Gy(l,E,p,Q),ne=!1,me=l.memoizedState,E.state=me,pt(l,p,E,_),Dt();var _e=l.memoizedState;O!==ke||me!==_e||ne||s!==null&&s.dependencies!==null&&Kl(s.dependencies)?(typeof F=="function"&&(e1(l,u,F,p),_e=l.memoizedState),(Oe=ne||$y(l,u,Oe,p,me,_e,Q)||s!==null&&s.dependencies!==null&&Kl(s.dependencies))?(de||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(p,_e,Q),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(p,_e,Q)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||O===s.memoizedProps&&me===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||O===s.memoizedProps&&me===s.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=_e),E.props=p,E.state=_e,E.context=Q,p=Oe):(typeof E.componentDidUpdate!="function"||O===s.memoizedProps&&me===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||O===s.memoizedProps&&me===s.memoizedState||(l.flags|=1024),p=!1)}return E=p,sp(s,l),p=(l.flags&128)!==0,E||p?(E=l.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:E.render(),l.flags|=1,s!==null&&p?(l.child=fu(l,s.child,null,_),l.child=fu(l,null,u,_)):Or(s,l,u,_),l.memoizedState=E.state,s=l.child):s=uo(s,l,_),s}function sb(s,l,u,p){return Yl(),l.flags|=256,Or(s,l,u,p),l.child}var i1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function s1(s){return{baseLanes:s,cachePool:G0()}}function a1(s,l,u){return s=s!==null?s.childLanes&~u:0,l&&(s|=Es),s}function ab(s,l,u){var p=l.pendingProps,_=!1,E=(l.flags&128)!==0,O;if((O=E)||(O=s!==null&&s.memoizedState===null?!1:(pr.current&2)!==0),O&&(_=!0,l.flags&=-129),O=(l.flags&32)!==0,l.flags&=-33,s===null){if(en){if(_?Ko(l):Qo(),en){var F=wn,Q;if(Q=F){e:{for(Q=F,F=xs;Q.nodeType!==8;){if(!F){F=null;break e}if(Q=Ys(Q.nextSibling),Q===null){F=null;break e}}F=Q}F!==null?(l.memoizedState={dehydrated:F,treeContext:eo!==null?{id:$s,overflow:Dr}:null,retryLane:536870912,hydrationErrors:null},Q=ci(18,null,null,0),Q.stateNode=F,Q.return=l,l.child=Q,er=l,wn=null,Q=!0):Q=!1}Q||Gs(l)}if(F=l.memoizedState,F!==null&&(F=F.dehydrated,F!==null))return $1(F)?l.lanes=32:l.lanes=536870912,null;co(l)}return F=p.children,p=p.fallback,_?(Qo(),_=l.mode,F=ap({mode:"hidden",children:F},_),p=js(p,_,u,null),F.return=l,p.return=l,F.sibling=p,l.child=F,_=l.child,_.memoizedState=s1(u),_.childLanes=a1(s,O,u),l.memoizedState=i1,p):(Ko(l),o1(l,F))}if(Q=s.memoizedState,Q!==null&&(F=Q.dehydrated,F!==null)){if(E)l.flags&256?(Ko(l),l.flags&=-257,l=l1(s,l,u)):l.memoizedState!==null?(Qo(),l.child=s.child,l.flags|=128,l=null):(Qo(),_=p.fallback,F=l.mode,p=ap({mode:"visible",children:p.children},F),_=js(_,F,u,null),_.flags|=2,p.return=l,_.return=l,p.sibling=_,l.child=p,fu(l,s.child,null,u),p=l.child,p.memoizedState=s1(u),p.childLanes=a1(s,O,u),l.memoizedState=i1,l=_);else if(Ko(l),$1(F)){if(O=F.nextSibling&&F.nextSibling.dataset,O)var de=O.dgst;O=de,p=Error(r(419)),p.stack="",p.digest=O,Gi({value:p,source:null,stack:null}),l=l1(s,l,u)}else if(_r||ql(s,l,u,!1),O=(u&s.childLanes)!==0,_r||O){if(O=Sn,O!==null&&(p=u&-u,p=(p&42)!==0?1:Ml(p),p=(p&(O.suspendedLanes|u))!==0?0:p,p!==0&&p!==Q.retryLane))throw Q.retryLane=p,zr(s,p),Ki(O,s,p),Qy;F.data==="$?"||T1(),l=l1(s,l,u)}else F.data==="$?"?(l.flags|=192,l.child=s.child,l=null):(s=Q.treeContext,wn=Ys(F.nextSibling),er=l,en=!0,fa=null,xs=!1,s!==null&&(jr[Ci++]=$s,jr[Ci++]=Dr,jr[Ci++]=eo,$s=s.id,Dr=s.overflow,eo=l),l=o1(l,p.children),l.flags|=4096);return l}return _?(Qo(),_=p.fallback,F=l.mode,Q=s.child,de=Q.sibling,p=zs(Q,{mode:"hidden",children:p.children}),p.subtreeFlags=Q.subtreeFlags&65011712,de!==null?_=zs(de,_):(_=js(_,F,u,null),_.flags|=2),_.return=l,p.return=l,p.sibling=_,l.child=p,p=_,_=l.child,F=s.child.memoizedState,F===null?F=s1(u):(Q=F.cachePool,Q!==null?(de=Un._currentValue,Q=Q.parent!==de?{parent:de,pool:de}:Q):Q=G0(),F={baseLanes:F.baseLanes|u,cachePool:Q}),_.memoizedState=F,_.childLanes=a1(s,O,u),l.memoizedState=i1,p):(Ko(l),u=s.child,s=u.sibling,u=zs(u,{mode:"visible",children:p.children}),u.return=l,u.sibling=null,s!==null&&(O=l.deletions,O===null?(l.deletions=[s],l.flags|=16):O.push(s)),l.child=u,l.memoizedState=null,u)}function o1(s,l){return l=ap({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function ap(s,l){return s=ci(22,s,null,l),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function l1(s,l,u){return fu(l,s.child,null,u),s=o1(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function ob(s,l,u){s.lanes|=l;var p=s.alternate;p!==null&&(p.lanes|=l),Jf(s.return,l,u)}function c1(s,l,u,p,_){var E=s.memoizedState;E===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:_}:(E.isBackwards=l,E.rendering=null,E.renderingStartTime=0,E.last=p,E.tail=u,E.tailMode=_)}function lb(s,l,u){var p=l.pendingProps,_=p.revealOrder,E=p.tail;if(Or(s,l,p.children,u),p=pr.current,(p&2)!==0)p=p&1|2,l.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&ob(s,u,l);else if(s.tag===19)ob(s,u,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}p&=1}switch(ge(pr,p),_){case"forwards":for(u=l.child,_=null;u!==null;)s=u.alternate,s!==null&&np(s)===null&&(_=u),u=u.sibling;u=_,u===null?(_=l.child,l.child=null):(_=u.sibling,u.sibling=null),c1(l,!1,_,u,E);break;case"backwards":for(u=null,_=l.child,l.child=null;_!==null;){if(s=_.alternate,s!==null&&np(s)===null){l.child=_;break}s=_.sibling,_.sibling=u,u=_,_=s}c1(l,!0,u,null,E);break;case"together":c1(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function uo(s,l,u){if(s!==null&&(l.dependencies=s.dependencies),nl|=l.lanes,(u&l.childLanes)===0)if(s!==null){if(ql(s,l,u,!1),(u&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(r(153));if(l.child!==null){for(s=l.child,u=zs(s,s.pendingProps),l.child=u,u.return=l;s.sibling!==null;)s=s.sibling,u=u.sibling=zs(s,s.pendingProps),u.return=l;u.sibling=null}return l.child}function u1(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Kl(s)))}function bO(s,l,u){switch(l.tag){case 3:k(l,l.stateNode.containerInfo),da(l,Un,s.memoizedState.cache),Yl();break;case 27:case 5:Z(l);break;case 4:k(l,l.stateNode.containerInfo);break;case 10:da(l,l.type,l.memoizedProps.value);break;case 13:var p=l.memoizedState;if(p!==null)return p.dehydrated!==null?(Ko(l),l.flags|=128,null):(u&l.child.childLanes)!==0?ab(s,l,u):(Ko(l),s=uo(s,l,u),s!==null?s.sibling:null);Ko(l);break;case 19:var _=(s.flags&128)!==0;if(p=(u&l.childLanes)!==0,p||(ql(s,l,u,!1),p=(u&l.childLanes)!==0),_){if(p)return lb(s,l,u);l.flags|=128}if(_=l.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),ge(pr,pr.current),p)break;return null;case 22:case 23:return l.lanes=0,tb(s,l,u);case 24:da(l,Un,s.memoizedState.cache)}return uo(s,l,u)}function cb(s,l,u){if(s!==null)if(s.memoizedProps!==l.pendingProps)_r=!0;else{if(!u1(s,u)&&(l.flags&128)===0)return _r=!1,bO(s,l,u);_r=(s.flags&131072)!==0}else _r=!1,en&&(l.flags&1048576)!==0&&U0(l,Vo,l.index);switch(l.lanes=0,l.tag){case 16:e:{s=l.pendingProps;var p=l.elementType,_=p._init;if(p=_(p._payload),l.type=p,typeof p=="function")Xf(p)?(s=ec(p,s),l.tag=1,l=ib(null,l,p,s,u)):(l.tag=0,l=r1(null,l,p,s,u));else{if(p!=null){if(_=p.$$typeof,_===R){l.tag=11,l=Zy(null,l,p,s,u);break e}else if(_===D){l.tag=14,l=Jy(null,l,p,s,u);break e}}throw l=Fe(p)||p,Error(r(306,l,""))}}return l;case 0:return r1(s,l,l.type,l.pendingProps,u);case 1:return p=l.type,_=ec(p,l.pendingProps),ib(s,l,p,_,u);case 3:e:{if(k(l,l.stateNode.containerInfo),s===null)throw Error(r(387));p=l.pendingProps;var E=l.memoizedState;_=E.element,Ae(s,l),pt(l,p,null,u);var O=l.memoizedState;if(p=O.cache,da(l,Un,p),p!==E.cache&&eh(l,[Un],u,!0),Dt(),p=O.element,E.isDehydrated)if(E={element:p,isDehydrated:!1,cache:O.cache},l.updateQueue.baseState=E,l.memoizedState=E,l.flags&256){l=sb(s,l,p,u);break e}else if(p!==_){_=oi(Error(r(424)),l),Gi(_),l=sb(s,l,p,u);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(wn=Ys(s.firstChild),er=l,en=!0,fa=null,xs=!0,u=zy(l,null,p,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Yl(),p===_){l=uo(s,l,u);break e}Or(s,l,p,u)}l=l.child}return l;case 26:return sp(s,l),s===null?(u=dE(l.type,null,l.pendingProps,null))?l.memoizedState=u:en||(u=l.type,s=l.pendingProps,p=yp(Ie.current).createElement(u),p[Qn]=l,p[Zn]=s,Nr(p,u,s),ie(p),l.stateNode=p):l.memoizedState=dE(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Z(l),s===null&&en&&(p=l.stateNode=uE(l.type,l.pendingProps,Ie.current),er=l,xs=!0,_=wn,al(l.type)?(G1=_,wn=Ys(p.firstChild)):wn=_),Or(s,l,l.pendingProps.children,u),sp(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&en&&((_=p=wn)&&(p=qO(p,l.type,l.pendingProps,xs),p!==null?(l.stateNode=p,er=l,wn=Ys(p.firstChild),xs=!1,_=!0):_=!1),_||Gs(l)),Z(l),_=l.type,E=l.pendingProps,O=s!==null?s.memoizedProps:null,p=E.children,H1(_,E)?p=null:O!==null&&H1(_,O)&&(l.flags|=32),l.memoizedState!==null&&(_=Ni(s,l,fn,null,null,u),kh._currentValue=_),sp(s,l),Or(s,l,p,u),l.child;case 6:return s===null&&en&&((s=u=wn)&&(u=KO(u,l.pendingProps,xs),u!==null?(l.stateNode=u,er=l,wn=null,s=!0):s=!1),s||Gs(l)),null;case 13:return ab(s,l,u);case 4:return k(l,l.stateNode.containerInfo),p=l.pendingProps,s===null?l.child=fu(l,null,p,u):Or(s,l,p,u),l.child;case 11:return Zy(s,l,l.type,l.pendingProps,u);case 7:return Or(s,l,l.pendingProps,u),l.child;case 8:return Or(s,l,l.pendingProps.children,u),l.child;case 12:return Or(s,l,l.pendingProps.children,u),l.child;case 10:return p=l.pendingProps,da(l,l.type,p.value),Or(s,l,p.children,u),l.child;case 9:return _=l.type._context,p=l.pendingProps.children,ro(l),_=ur(_),p=p(_),l.flags|=1,Or(s,l,p,u),l.child;case 14:return Jy(s,l,l.type,l.pendingProps,u);case 15:return eb(s,l,l.type,l.pendingProps,u);case 19:return lb(s,l,u);case 31:return p=l.pendingProps,u=l.mode,p={mode:p.mode,children:p.children},s===null?(u=ap(p,u),u.ref=l.ref,l.child=u,u.return=l,l=u):(u=zs(s.child,p),u.ref=l.ref,l.child=u,u.return=l,l=u),l;case 22:return tb(s,l,u);case 24:return ro(l),p=ur(Un),s===null?(_=ih(),_===null&&(_=Sn,E=Ql(),_.pooledCache=E,E.refCount++,E!==null&&(_.pooledCacheLanes|=u),_=E),l.memoizedState={parent:p,cache:_},ae(l),da(l,Un,_)):((s.lanes&u)!==0&&(Ae(s,l),pt(l,null,null,u),Dt()),_=s.memoizedState,E=l.memoizedState,_.parent!==p?(_={parent:p,cache:p},l.memoizedState=_,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=_),da(l,Un,p)):(p=E.cache,da(l,Un,p),p!==_.cache&&eh(l,[Un],u,!0))),Or(s,l,l.pendingProps.children,u),l.child;case 29:throw l.pendingProps}throw Error(r(156,l.tag))}function fo(s){s.flags|=4}function ub(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!_E(l)){if(l=bs.current,l!==null&&((Kt&4194048)===Kt?va!==null:(Kt&62914560)!==Kt&&(Kt&536870912)===0||l!==va))throw x=sh,Zl;s.flags|=8192}}function op(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?Nl():536870912,s.lanes|=l,gu|=l)}function yh(s,l){if(!en)switch(s.tailMode){case"hidden":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function kn(s){var l=s.alternate!==null&&s.alternate.child===s.child,u=0,p=0;if(l)for(var _=s.child;_!==null;)u|=_.lanes|_.childLanes,p|=_.subtreeFlags&65011712,p|=_.flags&65011712,_.return=s,_=_.sibling;else for(_=s.child;_!==null;)u|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=s,_=_.sibling;return s.subtreeFlags|=p,s.childLanes=u,l}function EO(s,l,u){var p=l.pendingProps;switch(Kf(l),l.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kn(l),null;case 1:return kn(l),null;case 3:return u=l.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),Ws(Un),se(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Xl(l)?fo(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Wo())),kn(l),null;case 26:return u=l.memoizedState,s===null?(fo(l),u!==null?(kn(l),ub(l,u)):(kn(l),l.flags&=-16777217)):u?u!==s.memoizedState?(fo(l),kn(l),ub(l,u)):(kn(l),l.flags&=-16777217):(s.memoizedProps!==p&&fo(l),kn(l),l.flags&=-16777217),null;case 27:J(l),u=Ie.current;var _=l.type;if(s!==null&&l.stateNode!=null)s.memoizedProps!==p&&fo(l);else{if(!p){if(l.stateNode===null)throw Error(r(166));return kn(l),null}s=Ce.current,Xl(l)?Qf(l):(s=uE(_,p,u),l.stateNode=s,fo(l))}return kn(l),null;case 5:if(J(l),u=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==p&&fo(l);else{if(!p){if(l.stateNode===null)throw Error(r(166));return kn(l),null}if(s=Ce.current,Xl(l))Qf(l);else{switch(_=yp(Ie.current),s){case 1:s=_.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=_.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=_.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=_.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=_.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof p.is=="string"?_.createElement("select",{is:p.is}):_.createElement("select"),p.multiple?s.multiple=!0:p.size&&(s.size=p.size);break;default:s=typeof p.is=="string"?_.createElement(u,{is:p.is}):_.createElement(u)}}s[Qn]=l,s[Zn]=p;e:for(_=l.child;_!==null;){if(_.tag===5||_.tag===6)s.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===l)break e;for(;_.sibling===null;){if(_.return===null||_.return===l)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}l.stateNode=s;e:switch(Nr(s,u,p),u){case"button":case"input":case"select":case"textarea":s=!!p.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&fo(l)}}return kn(l),l.flags&=-16777217,null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==p&&fo(l);else{if(typeof p!="string"&&l.stateNode===null)throw Error(r(166));if(s=Ie.current,Xl(l)){if(s=l.stateNode,u=l.memoizedProps,p=null,_=er,_!==null)switch(_.tag){case 27:case 5:p=_.memoizedProps}s[Qn]=l,s=!!(s.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||rE(s.nodeValue,u)),s||Gs(l)}else s=yp(s).createTextNode(p),s[Qn]=l,l.stateNode=s}return kn(l),null;case 13:if(p=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(_=Xl(l),p!==null&&p.dehydrated!==null){if(s===null){if(!_)throw Error(r(318));if(_=l.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(r(317));_[Qn]=l}else Yl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;kn(l),_=!1}else _=Wo(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=_),_=!0;if(!_)return l.flags&256?(co(l),l):(co(l),null)}if(co(l),(l.flags&128)!==0)return l.lanes=u,l;if(u=p!==null,s=s!==null&&s.memoizedState!==null,u){p=l.child,_=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(_=p.alternate.memoizedState.cachePool.pool);var E=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(E=p.memoizedState.cachePool.pool),E!==_&&(p.flags|=2048)}return u!==s&&u&&(l.child.flags|=8192),op(l,l.updateQueue),kn(l),null;case 4:return se(),s===null&&k1(l.stateNode.containerInfo),kn(l),null;case 10:return Ws(l.type),kn(l),null;case 19:if(ve(pr),_=l.memoizedState,_===null)return kn(l),null;if(p=(l.flags&128)!==0,E=_.rendering,E===null)if(p)yh(_,!1);else{if(Hn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=np(s),E!==null){for(l.flags|=128,yh(_,!1),s=E.updateQueue,l.updateQueue=s,op(l,s),l.subtreeFlags=0,s=u,u=l.child;u!==null;)B0(u,s),u=u.sibling;return ge(pr,pr.current&1|2),l.child}s=s.sibling}_.tail!==null&&nt()>up&&(l.flags|=128,p=!0,yh(_,!1),l.lanes=4194304)}else{if(!p)if(s=np(E),s!==null){if(l.flags|=128,p=!0,s=s.updateQueue,l.updateQueue=s,op(l,s),yh(_,!0),_.tail===null&&_.tailMode==="hidden"&&!E.alternate&&!en)return kn(l),null}else 2*nt()-_.renderingStartTime>up&&u!==536870912&&(l.flags|=128,p=!0,yh(_,!1),l.lanes=4194304);_.isBackwards?(E.sibling=l.child,l.child=E):(s=_.last,s!==null?s.sibling=E:l.child=E,_.last=E)}return _.tail!==null?(l=_.tail,_.rendering=l,_.tail=l.sibling,_.renderingStartTime=nt(),l.sibling=null,s=pr.current,ge(pr,p?s&1|2:s&1),l):(kn(l),null);case 22:case 23:return co(l),Yt(),p=l.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(l.flags|=8192):p&&(l.flags|=8192),p?(u&536870912)!==0&&(l.flags&128)===0&&(kn(l),l.subtreeFlags&6&&(l.flags|=8192)):kn(l),u=l.updateQueue,u!==null&&op(l,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),p=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),p!==u&&(l.flags|=2048),s!==null&&ve(ao),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),l.memoizedState.cache!==u&&(l.flags|=2048),Ws(Un),kn(l),null;case 25:return null;case 30:return null}throw Error(r(156,l.tag))}function AO(s,l){switch(Kf(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Ws(Un),se(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return J(l),null;case 13:if(co(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(r(340));Yl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return ve(pr),null;case 4:return se(),null;case 10:return Ws(l.type),null;case 22:case 23:return co(l),Yt(),s!==null&&ve(ao),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return Ws(Un),null;case 25:return null;default:return null}}function fb(s,l){switch(Kf(l),l.tag){case 3:Ws(Un),se();break;case 26:case 27:case 5:J(l);break;case 4:se();break;case 13:co(l);break;case 19:ve(pr);break;case 10:Ws(l.type);break;case 22:case 23:co(l),Yt(),s!==null&&ve(ao);break;case 24:Ws(Un)}}function bh(s,l){try{var u=l.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var _=p.next;u=_;do{if((u.tag&s)===s){p=void 0;var E=u.create,O=u.inst;p=E(),O.destroy=p}u=u.next}while(u!==_)}}catch(F){En(l,l.return,F)}}function Zo(s,l,u){try{var p=l.updateQueue,_=p!==null?p.lastEffect:null;if(_!==null){var E=_.next;p=E;do{if((p.tag&s)===s){var O=p.inst,F=O.destroy;if(F!==void 0){O.destroy=void 0,_=l;var Q=u,de=F;try{de()}catch(Oe){En(_,Q,Oe)}}}p=p.next}while(p!==E)}}catch(Oe){En(l,l.return,Oe)}}function hb(s){var l=s.updateQueue;if(l!==null){var u=s.stateNode;try{Et(l,u)}catch(p){En(s,s.return,p)}}}function db(s,l,u){u.props=ec(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(p){En(s,l,p)}}function Eh(s,l){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof u=="function"?s.refCleanup=u(p):u.current=p}}catch(_){En(s,l,_)}}function _a(s,l){var u=s.ref,p=s.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(_){En(s,l,_)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(_){En(s,l,_)}else u.current=null}function pb(s){var l=s.type,u=s.memoizedProps,p=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(_){En(s,s.return,_)}}function f1(s,l,u){try{var p=s.stateNode;GO(p,s.type,u,l),p[Zn]=l}catch(_){En(s,s.return,_)}}function gb(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&al(s.type)||s.tag===4}function h1(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||gb(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&al(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function d1(s,l,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,l?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,l):(l=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,l.appendChild(s),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=xp));else if(p!==4&&(p===27&&al(s.type)&&(u=s.stateNode,l=null),s=s.child,s!==null))for(d1(s,l,u),s=s.sibling;s!==null;)d1(s,l,u),s=s.sibling}function lp(s,l,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,l?u.insertBefore(s,l):u.appendChild(s);else if(p!==4&&(p===27&&al(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(lp(s,l,u),s=s.sibling;s!==null;)lp(s,l,u),s=s.sibling}function mb(s){var l=s.stateNode,u=s.memoizedProps;try{for(var p=s.type,_=l.attributes;_.length;)l.removeAttributeNode(_[0]);Nr(l,p,u),l[Qn]=s,l[Zn]=u}catch(E){En(s,s.return,E)}}var ho=!1,Gn=!1,p1=!1,vb=typeof WeakSet=="function"?WeakSet:Set,xr=null;function wO(s,l){if(s=s.containerInfo,B1=Tp,s=Pf(s),Kc(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var _=p.anchorOffset,E=p.focusNode;p=p.focusOffset;try{u.nodeType,E.nodeType}catch{u=null;break e}var O=0,F=-1,Q=-1,de=0,Oe=0,ke=s,me=null;t:for(;;){for(var _e;ke!==u||_!==0&&ke.nodeType!==3||(F=O+_),ke!==E||p!==0&&ke.nodeType!==3||(Q=O+p),ke.nodeType===3&&(O+=ke.nodeValue.length),(_e=ke.firstChild)!==null;)me=ke,ke=_e;for(;;){if(ke===s)break t;if(me===u&&++de===_&&(F=O),me===E&&++Oe===p&&(Q=O),(_e=ke.nextSibling)!==null)break;ke=me,me=ke.parentNode}ke=_e}u=F===-1||Q===-1?null:{start:F,end:Q}}else u=null}u=u||{start:0,end:0}}else u=null;for(U1={focusedElem:s,selectionRange:u},Tp=!1,xr=l;xr!==null;)if(l=xr,s=l.child,(l.subtreeFlags&1024)!==0&&s!==null)s.return=l,xr=s;else for(;xr!==null;){switch(l=xr,E=l.alternate,s=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&E!==null){s=void 0,u=l,_=E.memoizedProps,E=E.memoizedState,p=u.stateNode;try{var Tt=ec(u.type,_,u.elementType===u.type);s=p.getSnapshotBeforeUpdate(Tt,E),p.__reactInternalSnapshotBeforeUpdate=s}catch(xt){En(u,u.return,xt)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,u=s.nodeType,u===9)j1(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":j1(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=l.sibling,s!==null){s.return=l.return,xr=s;break}xr=l.return}}function _b(s,l,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Jo(s,u),p&4&&bh(5,u);break;case 1:if(Jo(s,u),p&4)if(s=u.stateNode,l===null)try{s.componentDidMount()}catch(O){En(u,u.return,O)}else{var _=ec(u.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(_,l,s.__reactInternalSnapshotBeforeUpdate)}catch(O){En(u,u.return,O)}}p&64&&hb(u),p&512&&Eh(u,u.return);break;case 3:if(Jo(s,u),p&64&&(s=u.updateQueue,s!==null)){if(l=null,u.child!==null)switch(u.child.tag){case 27:case 5:l=u.child.stateNode;break;case 1:l=u.child.stateNode}try{Et(s,l)}catch(O){En(u,u.return,O)}}break;case 27:l===null&&p&4&&mb(u);case 26:case 5:Jo(s,u),l===null&&p&4&&pb(u),p&512&&Eh(u,u.return);break;case 12:Jo(s,u);break;case 13:Jo(s,u),p&4&&bb(s,u),p&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=MO.bind(null,u),QO(s,u))));break;case 22:if(p=u.memoizedState!==null||ho,!p){l=l!==null&&l.memoizedState!==null||Gn,_=ho;var E=Gn;ho=p,(Gn=l)&&!E?el(s,u,(u.subtreeFlags&8772)!==0):Jo(s,u),ho=_,Gn=E}break;case 30:break;default:Jo(s,u)}}function xb(s){var l=s.alternate;l!==null&&(s.alternate=null,xb(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&j(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var On=null,Li=!1;function po(s,l,u){for(u=u.child;u!==null;)yb(s,l,u),u=u.sibling}function yb(s,l,u){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(Tn,u)}catch{}switch(u.tag){case 26:Gn||_a(u,l),po(s,l,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Gn||_a(u,l);var p=On,_=Li;al(u.type)&&(On=u.stateNode,Li=!1),po(s,l,u),Nh(u.stateNode),On=p,Li=_;break;case 5:Gn||_a(u,l);case 6:if(p=On,_=Li,On=null,po(s,l,u),On=p,Li=_,On!==null)if(Li)try{(On.nodeType===9?On.body:On.nodeName==="HTML"?On.ownerDocument.body:On).removeChild(u.stateNode)}catch(E){En(u,l,E)}else try{On.removeChild(u.stateNode)}catch(E){En(u,l,E)}break;case 18:On!==null&&(Li?(s=On,lE(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),Uh(s)):lE(On,u.stateNode));break;case 4:p=On,_=Li,On=u.stateNode.containerInfo,Li=!0,po(s,l,u),On=p,Li=_;break;case 0:case 11:case 14:case 15:Gn||Zo(2,u,l),Gn||Zo(4,u,l),po(s,l,u);break;case 1:Gn||(_a(u,l),p=u.stateNode,typeof p.componentWillUnmount=="function"&&db(u,l,p)),po(s,l,u);break;case 21:po(s,l,u);break;case 22:Gn=(p=Gn)||u.memoizedState!==null,po(s,l,u),Gn=p;break;default:po(s,l,u)}}function bb(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Uh(s)}catch(u){En(l,l.return,u)}}function SO(s){switch(s.tag){case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new vb),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new vb),l;default:throw Error(r(435,s.tag))}}function g1(s,l){var u=SO(s);l.forEach(function(p){var _=IO.bind(null,s,p);u.has(p)||(u.add(p),p.then(_,_))})}function Wi(s,l){var u=l.deletions;if(u!==null)for(var p=0;p<u.length;p++){var _=u[p],E=s,O=l,F=O;e:for(;F!==null;){switch(F.tag){case 27:if(al(F.type)){On=F.stateNode,Li=!1;break e}break;case 5:On=F.stateNode,Li=!1;break e;case 3:case 4:On=F.stateNode.containerInfo,Li=!0;break e}F=F.return}if(On===null)throw Error(r(160));yb(E,O,_),On=null,Li=!1,E=_.alternate,E!==null&&(E.return=null),_.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)Eb(l,s),l=l.sibling}var Xs=null;function Eb(s,l){var u=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Wi(l,s),Xi(s),p&4&&(Zo(3,s,s.return),bh(3,s),Zo(5,s,s.return));break;case 1:Wi(l,s),Xi(s),p&512&&(Gn||u===null||_a(u,u.return)),p&64&&ho&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var _=Xs;if(Wi(l,s),Xi(s),p&512&&(Gn||u===null||_a(u,u.return)),p&4){var E=u!==null?u.memoizedState:null;if(p=s.memoizedState,u===null)if(p===null)if(s.stateNode===null){e:{p=s.type,u=s.memoizedProps,_=_.ownerDocument||_;t:switch(p){case"title":E=_.getElementsByTagName("title")[0],(!E||E[z]||E[Qn]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=_.createElement(p),_.head.insertBefore(E,_.querySelector("head > title"))),Nr(E,p,u),E[Qn]=s,ie(E),p=E;break e;case"link":var O=mE("link","href",_).get(p+(u.href||""));if(O){for(var F=0;F<O.length;F++)if(E=O[F],E.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&E.getAttribute("rel")===(u.rel==null?null:u.rel)&&E.getAttribute("title")===(u.title==null?null:u.title)&&E.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){O.splice(F,1);break t}}E=_.createElement(p),Nr(E,p,u),_.head.appendChild(E);break;case"meta":if(O=mE("meta","content",_).get(p+(u.content||""))){for(F=0;F<O.length;F++)if(E=O[F],E.getAttribute("content")===(u.content==null?null:""+u.content)&&E.getAttribute("name")===(u.name==null?null:u.name)&&E.getAttribute("property")===(u.property==null?null:u.property)&&E.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&E.getAttribute("charset")===(u.charSet==null?null:u.charSet)){O.splice(F,1);break t}}E=_.createElement(p),Nr(E,p,u),_.head.appendChild(E);break;default:throw Error(r(468,p))}E[Qn]=s,ie(E),p=E}s.stateNode=p}else vE(_,s.type,s.stateNode);else s.stateNode=gE(_,p,s.memoizedProps);else E!==p?(E===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):E.count--,p===null?vE(_,s.type,s.stateNode):gE(_,p,s.memoizedProps)):p===null&&s.stateNode!==null&&f1(s,s.memoizedProps,u.memoizedProps)}break;case 27:Wi(l,s),Xi(s),p&512&&(Gn||u===null||_a(u,u.return)),u!==null&&p&4&&f1(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Wi(l,s),Xi(s),p&512&&(Gn||u===null||_a(u,u.return)),s.flags&32){_=s.stateNode;try{ji(_,"")}catch(_e){En(s,s.return,_e)}}p&4&&s.stateNode!=null&&(_=s.memoizedProps,f1(s,_,u!==null?u.memoizedProps:_)),p&1024&&(p1=!0);break;case 6:if(Wi(l,s),Xi(s),p&4){if(s.stateNode===null)throw Error(r(162));p=s.memoizedProps,u=s.stateNode;try{u.nodeValue=p}catch(_e){En(s,s.return,_e)}}break;case 3:if(Ap=null,_=Xs,Xs=bp(l.containerInfo),Wi(l,s),Xs=_,Xi(s),p&4&&u!==null&&u.memoizedState.isDehydrated)try{Uh(l.containerInfo)}catch(_e){En(s,s.return,_e)}p1&&(p1=!1,Ab(s));break;case 4:p=Xs,Xs=bp(s.stateNode.containerInfo),Wi(l,s),Xi(s),Xs=p;break;case 12:Wi(l,s),Xi(s);break;case 13:Wi(l,s),Xi(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(b1=nt()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,g1(s,p)));break;case 22:_=s.memoizedState!==null;var Q=u!==null&&u.memoizedState!==null,de=ho,Oe=Gn;if(ho=de||_,Gn=Oe||Q,Wi(l,s),Gn=Oe,ho=de,Xi(s),p&8192)e:for(l=s.stateNode,l._visibility=_?l._visibility&-2:l._visibility|1,_&&(u===null||Q||ho||Gn||tc(s)),u=null,l=s;;){if(l.tag===5||l.tag===26){if(u===null){Q=u=l;try{if(E=Q.stateNode,_)O=E.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{F=Q.stateNode;var ke=Q.memoizedProps.style,me=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;F.style.display=me==null||typeof me=="boolean"?"":(""+me).trim()}}catch(_e){En(Q,Q.return,_e)}}}else if(l.tag===6){if(u===null){Q=l;try{Q.stateNode.nodeValue=_?"":Q.memoizedProps}catch(_e){En(Q,Q.return,_e)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;u===l&&(u=null),l=l.return}u===l&&(u=null),l.sibling.return=l.return,l=l.sibling}p&4&&(p=s.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,g1(s,u))));break;case 19:Wi(l,s),Xi(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,g1(s,p)));break;case 30:break;case 21:break;default:Wi(l,s),Xi(s)}}function Xi(s){var l=s.flags;if(l&2){try{for(var u,p=s.return;p!==null;){if(gb(p)){u=p;break}p=p.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var _=u.stateNode,E=h1(s);lp(s,E,_);break;case 5:var O=u.stateNode;u.flags&32&&(ji(O,""),u.flags&=-33);var F=h1(s);lp(s,F,O);break;case 3:case 4:var Q=u.stateNode.containerInfo,de=h1(s);d1(s,de,Q);break;default:throw Error(r(161))}}catch(Oe){En(s,s.return,Oe)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function Ab(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;Ab(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function Jo(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)_b(s,l.alternate,l),l=l.sibling}function tc(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:Zo(4,l,l.return),tc(l);break;case 1:_a(l,l.return);var u=l.stateNode;typeof u.componentWillUnmount=="function"&&db(l,l.return,u),tc(l);break;case 27:Nh(l.stateNode);case 26:case 5:_a(l,l.return),tc(l);break;case 22:l.memoizedState===null&&tc(l);break;case 30:tc(l);break;default:tc(l)}s=s.sibling}}function el(s,l,u){for(u=u&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var p=l.alternate,_=s,E=l,O=E.flags;switch(E.tag){case 0:case 11:case 15:el(_,E,u),bh(4,E);break;case 1:if(el(_,E,u),p=E,_=p.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(de){En(p,p.return,de)}if(p=E,_=p.updateQueue,_!==null){var F=p.stateNode;try{var Q=_.shared.hiddenCallbacks;if(Q!==null)for(_.shared.hiddenCallbacks=null,_=0;_<Q.length;_++)Ot(Q[_],F)}catch(de){En(p,p.return,de)}}u&&O&64&&hb(E),Eh(E,E.return);break;case 27:mb(E);case 26:case 5:el(_,E,u),u&&p===null&&O&4&&pb(E),Eh(E,E.return);break;case 12:el(_,E,u);break;case 13:el(_,E,u),u&&O&4&&bb(_,E);break;case 22:E.memoizedState===null&&el(_,E,u),Eh(E,E.return);break;case 30:break;default:el(_,E,u)}l=l.sibling}}function m1(s,l){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Yo(u))}function v1(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Yo(s))}function xa(s,l,u,p){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)wb(s,l,u,p),l=l.sibling}function wb(s,l,u,p){var _=l.flags;switch(l.tag){case 0:case 11:case 15:xa(s,l,u,p),_&2048&&bh(9,l);break;case 1:xa(s,l,u,p);break;case 3:xa(s,l,u,p),_&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Yo(s)));break;case 12:if(_&2048){xa(s,l,u,p),s=l.stateNode;try{var E=l.memoizedProps,O=E.id,F=E.onPostCommit;typeof F=="function"&&F(O,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Q){En(l,l.return,Q)}}else xa(s,l,u,p);break;case 13:xa(s,l,u,p);break;case 23:break;case 22:E=l.stateNode,O=l.alternate,l.memoizedState!==null?E._visibility&2?xa(s,l,u,p):Ah(s,l):E._visibility&2?xa(s,l,u,p):(E._visibility|=2,hu(s,l,u,p,(l.subtreeFlags&10256)!==0)),_&2048&&m1(O,l);break;case 24:xa(s,l,u,p),_&2048&&v1(l.alternate,l);break;default:xa(s,l,u,p)}}function hu(s,l,u,p,_){for(_=_&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var E=s,O=l,F=u,Q=p,de=O.flags;switch(O.tag){case 0:case 11:case 15:hu(E,O,F,Q,_),bh(8,O);break;case 23:break;case 22:var Oe=O.stateNode;O.memoizedState!==null?Oe._visibility&2?hu(E,O,F,Q,_):Ah(E,O):(Oe._visibility|=2,hu(E,O,F,Q,_)),_&&de&2048&&m1(O.alternate,O);break;case 24:hu(E,O,F,Q,_),_&&de&2048&&v1(O.alternate,O);break;default:hu(E,O,F,Q,_)}l=l.sibling}}function Ah(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var u=s,p=l,_=p.flags;switch(p.tag){case 22:Ah(u,p),_&2048&&m1(p.alternate,p);break;case 24:Ah(u,p),_&2048&&v1(p.alternate,p);break;default:Ah(u,p)}l=l.sibling}}var wh=8192;function du(s){if(s.subtreeFlags&wh)for(s=s.child;s!==null;)Sb(s),s=s.sibling}function Sb(s){switch(s.tag){case 26:du(s),s.flags&wh&&s.memoizedState!==null&&uR(Xs,s.memoizedState,s.memoizedProps);break;case 5:du(s);break;case 3:case 4:var l=Xs;Xs=bp(s.stateNode.containerInfo),du(s),Xs=l;break;case 22:s.memoizedState===null&&(l=s.alternate,l!==null&&l.memoizedState!==null?(l=wh,wh=16777216,du(s),wh=l):du(s));break;default:du(s)}}function Tb(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Sh(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var u=0;u<l.length;u++){var p=l[u];xr=p,Db(p,s)}Tb(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Cb(s),s=s.sibling}function Cb(s){switch(s.tag){case 0:case 11:case 15:Sh(s),s.flags&2048&&Zo(9,s,s.return);break;case 3:Sh(s);break;case 12:Sh(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,cp(s)):Sh(s);break;default:Sh(s)}}function cp(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var u=0;u<l.length;u++){var p=l[u];xr=p,Db(p,s)}Tb(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:Zo(8,l,l.return),cp(l);break;case 22:u=l.stateNode,u._visibility&2&&(u._visibility&=-3,cp(l));break;default:cp(l)}s=s.sibling}}function Db(s,l){for(;xr!==null;){var u=xr;switch(u.tag){case 0:case 11:case 15:Zo(8,u,l);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Yo(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,xr=p;else e:for(u=s;xr!==null;){p=xr;var _=p.sibling,E=p.return;if(xb(p),p===u){xr=null;break e}if(_!==null){_.return=E,xr=_;break e}xr=E}}}var TO={getCacheForType:function(s){var l=ur(Un),u=l.data.get(s);return u===void 0&&(u=s(),l.data.set(s,u)),u}},CO=typeof WeakMap=="function"?WeakMap:Map,hn=0,Sn=null,$t=null,Kt=0,dn=0,Yi=null,tl=!1,pu=!1,_1=!1,go=0,Hn=0,nl=0,nc=0,x1=0,Es=0,gu=0,Th=null,Mi=null,y1=!1,b1=0,up=1/0,fp=null,rl=null,Rr=0,il=null,mu=null,vu=0,E1=0,A1=null,Ob=null,Ch=0,w1=null;function qi(){if((hn&2)!==0&&Kt!==0)return Kt&-Kt;if(q.T!==null){var s=Di;return s!==0?s:N1()}return Hc()}function Rb(){Es===0&&(Es=(Kt&536870912)===0||en?Rl():536870912);var s=bs.current;return s!==null&&(s.flags|=32),Es}function Ki(s,l,u){(s===Sn&&(dn===2||dn===9)||s.cancelPendingCommit!==null)&&(_u(s,0),sl(s,Kt,Es,!1)),hs(s,u),((hn&2)===0||s!==Sn)&&(s===Sn&&((hn&2)===0&&(nc|=u),Hn===4&&sl(s,Kt,Es,!1)),ya(s))}function Nb(s,l,u){if((hn&6)!==0)throw Error(r(327));var p=!u&&(l&124)===0&&(l&s.expiredLanes)===0||fs(s,l),_=p?RO(s,l):C1(s,l,!0),E=p;do{if(_===0){pu&&!p&&sl(s,l,0,!1);break}else{if(u=s.current.alternate,E&&!DO(u)){_=C1(s,l,!1),E=!1;continue}if(_===2){if(E=l,s.errorRecoveryDisabledLanes&E)var O=0;else O=s.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){l=O;e:{var F=s;_=Th;var Q=F.current.memoizedState.isDehydrated;if(Q&&(_u(F,O).flags|=256),O=C1(F,O,!1),O!==2){if(_1&&!Q){F.errorRecoveryDisabledLanes|=E,nc|=E,_=4;break e}E=Mi,Mi=_,E!==null&&(Mi===null?Mi=E:Mi.push.apply(Mi,E))}_=O}if(E=!1,_!==2)continue}}if(_===1){_u(s,0),sl(s,l,0,!0);break}e:{switch(p=s,E=_,E){case 0:case 1:throw Error(r(345));case 4:if((l&4194048)!==l)break;case 6:sl(p,l,Es,!tl);break e;case 2:Mi=null;break;case 3:case 5:break;default:throw Error(r(329))}if((l&62914560)===l&&(_=b1+300-nt(),10<_)){if(sl(p,l,Es,!tl),Ai(p,0,!0)!==0)break e;p.timeoutHandle=aE(Lb.bind(null,p,u,Mi,fp,y1,l,Es,nc,gu,tl,E,2,-0,0),_);break e}Lb(p,u,Mi,fp,y1,l,Es,nc,gu,tl,E,0,-0,0)}}break}while(!0);ya(s)}function Lb(s,l,u,p,_,E,O,F,Q,de,Oe,ke,me,_e){if(s.timeoutHandle=-1,ke=l.subtreeFlags,(ke&8192||(ke&16785408)===16785408)&&(Ih={stylesheets:null,count:0,unsuspend:cR},Sb(l),ke=fR(),ke!==null)){s.cancelPendingCommit=ke(Ub.bind(null,s,l,E,u,p,_,O,F,Q,Oe,1,me,_e)),sl(s,E,O,!de);return}Ub(s,l,E,u,p,_,O,F,Q)}function DO(s){for(var l=s;;){var u=l.tag;if((u===0||u===11||u===15)&&l.flags&16384&&(u=l.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var _=u[p],E=_.getSnapshot;_=_.value;try{if(!Hr(E(),_))return!1}catch{return!1}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function sl(s,l,u,p){l&=~x1,l&=~nc,s.suspendedLanes|=l,s.pingedLanes&=~l,p&&(s.warmLanes|=l),p=s.expirationTimes;for(var _=l;0<_;){var E=31-on(_),O=1<<E;p[E]=-1,_&=~O}u!==0&&Ll(s,u,l)}function hp(){return(hn&6)===0?(Dh(0),!1):!0}function S1(){if($t!==null){if(dn===0)var s=$t.return;else s=$t,Vs=no=null,ys(s),uu=null,_h=0,s=$t;for(;s!==null;)fb(s.alternate,s),s=s.return;$t=null}}function _u(s,l){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,WO(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),S1(),Sn=s,$t=u=zs(s.current,null),Kt=l,dn=0,Yi=null,tl=!1,pu=fs(s,l),_1=!1,gu=Es=x1=nc=nl=Hn=0,Mi=Th=null,y1=!1,(l&8)!==0&&(l|=l&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=l;0<p;){var _=31-on(p),E=1<<_;l|=s[_],p&=~E}return go=l,Qc(),u}function Mb(s,l){et=null,q.H=J0,l===qo||l===oo?(l=S(),dn=3):l===Zl?(l=S(),dn=4):dn=l===Qy?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Yi=l,$t===null&&(Hn=1,ip(s,oi(l,s.current)))}function Ib(){var s=q.H;return q.H=J0,s===null?J0:s}function kb(){var s=q.A;return q.A=TO,s}function T1(){Hn=4,tl||(Kt&4194048)!==Kt&&bs.current!==null||(pu=!0),(nl&134217727)===0&&(nc&134217727)===0||Sn===null||sl(Sn,Kt,Es,!1)}function C1(s,l,u){var p=hn;hn|=2;var _=Ib(),E=kb();(Sn!==s||Kt!==l)&&(fp=null,_u(s,l)),l=!1;var O=Hn;e:do try{if(dn!==0&&$t!==null){var F=$t,Q=Yi;switch(dn){case 8:S1(),O=6;break e;case 3:case 2:case 9:case 6:bs.current===null&&(l=!0);var de=dn;if(dn=0,Yi=null,xu(s,F,Q,de),u&&pu){O=0;break e}break;default:de=dn,dn=0,Yi=null,xu(s,F,Q,de)}}OO(),O=Hn;break}catch(Oe){Mb(s,Oe)}while(!0);return l&&s.shellSuspendCounter++,Vs=no=null,hn=p,q.H=_,q.A=E,$t===null&&(Sn=null,Kt=0,Qc()),O}function OO(){for(;$t!==null;)Fb($t)}function RO(s,l){var u=hn;hn|=2;var p=Ib(),_=kb();Sn!==s||Kt!==l?(fp=null,up=nt()+500,_u(s,l)):pu=fs(s,l);e:do try{if(dn!==0&&$t!==null){l=$t;var E=Yi;t:switch(dn){case 1:dn=0,Yi=null,xu(s,l,E,1);break;case 2:case 9:if(V0(E)){dn=0,Yi=null,Pb(l);break}l=function(){dn!==2&&dn!==9||Sn!==s||(dn=7),ya(s)},E.then(l,l);break e;case 3:dn=7;break e;case 4:dn=5;break e;case 7:V0(E)?(dn=0,Yi=null,Pb(l)):(dn=0,Yi=null,xu(s,l,E,7));break;case 5:var O=null;switch($t.tag){case 26:O=$t.memoizedState;case 5:case 27:var F=$t;if(!O||_E(O)){dn=0,Yi=null;var Q=F.sibling;if(Q!==null)$t=Q;else{var de=F.return;de!==null?($t=de,dp(de)):$t=null}break t}}dn=0,Yi=null,xu(s,l,E,5);break;case 6:dn=0,Yi=null,xu(s,l,E,6);break;case 8:S1(),Hn=6;break e;default:throw Error(r(462))}}NO();break}catch(Oe){Mb(s,Oe)}while(!0);return Vs=no=null,q.H=p,q.A=_,hn=u,$t!==null?0:(Sn=null,Kt=0,Qc(),Hn)}function NO(){for(;$t!==null&&!Ye();)Fb($t)}function Fb(s){var l=cb(s.alternate,s,go);s.memoizedProps=s.pendingProps,l===null?dp(s):$t=l}function Pb(s){var l=s,u=l.alternate;switch(l.tag){case 15:case 0:l=rb(u,l,l.pendingProps,l.type,void 0,Kt);break;case 11:l=rb(u,l,l.pendingProps,l.type.render,l.ref,Kt);break;case 5:ys(l);default:fb(u,l),l=$t=B0(l,go),l=cb(u,l,go)}s.memoizedProps=s.pendingProps,l===null?dp(s):$t=l}function xu(s,l,u,p){Vs=no=null,ys(l),uu=null,_h=0;var _=l.return;try{if(yO(s,_,l,u,Kt)){Hn=1,ip(s,oi(u,s.current)),$t=null;return}}catch(E){if(_!==null)throw $t=_,E;Hn=1,ip(s,oi(u,s.current)),$t=null;return}l.flags&32768?(en||p===1?s=!0:pu||(Kt&536870912)!==0?s=!1:(tl=s=!0,(p===2||p===9||p===3||p===6)&&(p=bs.current,p!==null&&p.tag===13&&(p.flags|=16384))),Bb(l,s)):dp(l)}function dp(s){var l=s;do{if((l.flags&32768)!==0){Bb(l,tl);return}s=l.return;var u=EO(l.alternate,l,go);if(u!==null){$t=u;return}if(l=l.sibling,l!==null){$t=l;return}$t=l=s}while(l!==null);Hn===0&&(Hn=5)}function Bb(s,l){do{var u=AO(s.alternate,s);if(u!==null){u.flags&=32767,$t=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!l&&(s=s.sibling,s!==null)){$t=s;return}$t=s=u}while(s!==null);Hn=6,$t=null}function Ub(s,l,u,p,_,E,O,F,Q){s.cancelPendingCommit=null;do pp();while(Rr!==0);if((hn&6)!==0)throw Error(r(327));if(l!==null){if(l===s.current)throw Error(r(177));if(E=l.lanes|l.childLanes,E|=Gf,Ua(s,u,E,O,F,Q),s===Sn&&($t=Sn=null,Kt=0),mu=l,il=s,vu=u,E1=E,A1=_,Ob=p,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,kO(kt,function(){return Gb(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||p){p=q.T,q.T=null,_=ee.p,ee.p=2,O=hn,hn|=4;try{wO(s,l,u)}finally{hn=O,ee.p=_,q.T=p}}Rr=1,Hb(),zb(),jb()}}function Hb(){if(Rr===1){Rr=0;var s=il,l=mu,u=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||u){u=q.T,q.T=null;var p=ee.p;ee.p=2;var _=hn;hn|=4;try{Eb(l,s);var E=U1,O=Pf(s.containerInfo),F=E.focusedElem,Q=E.selectionRange;if(O!==F&&F&&F.ownerDocument&&L0(F.ownerDocument.documentElement,F)){if(Q!==null&&Kc(F)){var de=Q.start,Oe=Q.end;if(Oe===void 0&&(Oe=de),"selectionStart"in F)F.selectionStart=de,F.selectionEnd=Math.min(Oe,F.value.length);else{var ke=F.ownerDocument||document,me=ke&&ke.defaultView||window;if(me.getSelection){var _e=me.getSelection(),Tt=F.textContent.length,xt=Math.min(Q.start,Tt),_n=Q.end===void 0?xt:Math.min(Q.end,Tt);!_e.extend&&xt>_n&&(O=_n,_n=xt,xt=O);var oe=N0(F,xt),te=N0(F,_n);if(oe&&te&&(_e.rangeCount!==1||_e.anchorNode!==oe.node||_e.anchorOffset!==oe.offset||_e.focusNode!==te.node||_e.focusOffset!==te.offset)){var fe=ke.createRange();fe.setStart(oe.node,oe.offset),_e.removeAllRanges(),xt>_n?(_e.addRange(fe),_e.extend(te.node,te.offset)):(fe.setEnd(te.node,te.offset),_e.addRange(fe))}}}}for(ke=[],_e=F;_e=_e.parentNode;)_e.nodeType===1&&ke.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<ke.length;F++){var Le=ke[F];Le.element.scrollLeft=Le.left,Le.element.scrollTop=Le.top}}Tp=!!B1,U1=B1=null}finally{hn=_,ee.p=p,q.T=u}}s.current=l,Rr=2}}function zb(){if(Rr===2){Rr=0;var s=il,l=mu,u=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||u){u=q.T,q.T=null;var p=ee.p;ee.p=2;var _=hn;hn|=4;try{_b(s,l.alternate,l)}finally{hn=_,ee.p=p,q.T=u}}Rr=3}}function jb(){if(Rr===4||Rr===3){Rr=0,De();var s=il,l=mu,u=vu,p=Ob;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Rr=5:(Rr=0,mu=il=null,$b(s,s.pendingLanes));var _=s.pendingLanes;if(_===0&&(rl=null),Il(u),l=l.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(Tn,l,void 0,(l.current.flags&128)===128)}catch{}if(p!==null){l=q.T,_=ee.p,ee.p=2,q.T=null;try{for(var E=s.onRecoverableError,O=0;O<p.length;O++){var F=p[O];E(F.value,{componentStack:F.stack})}}finally{q.T=l,ee.p=_}}(vu&3)!==0&&pp(),ya(s),_=s.pendingLanes,(u&4194090)!==0&&(_&42)!==0?s===w1?Ch++:(Ch=0,w1=s):Ch=0,Dh(0)}}function $b(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,Yo(l)))}function pp(s){return Hb(),zb(),jb(),Gb()}function Gb(){if(Rr!==5)return!1;var s=il,l=E1;E1=0;var u=Il(vu),p=q.T,_=ee.p;try{ee.p=32>u?32:u,q.T=null,u=A1,A1=null;var E=il,O=vu;if(Rr=0,mu=il=null,vu=0,(hn&6)!==0)throw Error(r(331));var F=hn;if(hn|=4,Cb(E.current),wb(E,E.current,O,u),hn=F,Dh(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(Tn,E)}catch{}return!0}finally{ee.p=_,q.T=p,$b(s,l)}}function Vb(s,l,u){l=oi(u,l),l=n1(s.stateNode,l,2),s=We(s,l,2),s!==null&&(hs(s,2),ya(s))}function En(s,l,u){if(s.tag===3)Vb(s,s,u);else for(;l!==null;){if(l.tag===3){Vb(l,s,u);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(rl===null||!rl.has(p))){s=oi(u,s),u=qy(2),p=We(l,u,2),p!==null&&(Ky(u,p,l,s),hs(p,2),ya(p));break}}l=l.return}}function D1(s,l,u){var p=s.pingCache;if(p===null){p=s.pingCache=new CO;var _=new Set;p.set(l,_)}else _=p.get(l),_===void 0&&(_=new Set,p.set(l,_));_.has(u)||(_1=!0,_.add(u),s=LO.bind(null,s,l,u),l.then(s,s))}function LO(s,l,u){var p=s.pingCache;p!==null&&p.delete(l),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Sn===s&&(Kt&u)===u&&(Hn===4||Hn===3&&(Kt&62914560)===Kt&&300>nt()-b1?(hn&2)===0&&_u(s,0):x1|=u,gu===Kt&&(gu=0)),ya(s)}function Wb(s,l){l===0&&(l=Nl()),s=zr(s,l),s!==null&&(hs(s,l),ya(s))}function MO(s){var l=s.memoizedState,u=0;l!==null&&(u=l.retryLane),Wb(s,u)}function IO(s,l){var u=0;switch(s.tag){case 13:var p=s.stateNode,_=s.memoizedState;_!==null&&(u=_.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(l),Wb(s,u)}function kO(s,l){return be(s,l)}var gp=null,yu=null,O1=!1,mp=!1,R1=!1,rc=0;function ya(s){s!==yu&&s.next===null&&(yu===null?gp=yu=s:yu=yu.next=s),mp=!0,O1||(O1=!0,PO())}function Dh(s,l){if(!R1&&mp){R1=!0;do for(var u=!1,p=gp;p!==null;){if(s!==0){var _=p.pendingLanes;if(_===0)var E=0;else{var O=p.suspendedLanes,F=p.pingedLanes;E=(1<<31-on(42|s)+1)-1,E&=_&~(O&~F),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(u=!0,Kb(p,E))}else E=Kt,E=Ai(p,p===Sn?E:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(E&3)===0||fs(p,E)||(u=!0,Kb(p,E));p=p.next}while(u);R1=!1}}function FO(){Xb()}function Xb(){mp=O1=!1;var s=0;rc!==0&&(VO()&&(s=rc),rc=0);for(var l=nt(),u=null,p=gp;p!==null;){var _=p.next,E=Yb(p,l);E===0?(p.next=null,u===null?gp=_:u.next=_,_===null&&(yu=u)):(u=p,(s!==0||(E&3)!==0)&&(mp=!0)),p=_}Dh(s)}function Yb(s,l){for(var u=s.suspendedLanes,p=s.pingedLanes,_=s.expirationTimes,E=s.pendingLanes&-62914561;0<E;){var O=31-on(E),F=1<<O,Q=_[O];Q===-1?((F&u)===0||(F&p)!==0)&&(_[O]=Bc(F,l)):Q<=l&&(s.expiredLanes|=F),E&=~F}if(l=Sn,u=Kt,u=Ai(s,s===l?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,u===0||s===l&&(dn===2||dn===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&Se(p),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||fs(s,u)){if(l=u&-u,l===s.callbackPriority)return l;switch(p!==null&&Se(p),Il(u)){case 2:case 8:u=Rt;break;case 32:u=kt;break;case 268435456:u=Qe;break;default:u=kt}return p=qb.bind(null,s),u=be(u,p),s.callbackPriority=l,s.callbackNode=u,l}return p!==null&&p!==null&&Se(p),s.callbackPriority=2,s.callbackNode=null,2}function qb(s,l){if(Rr!==0&&Rr!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(pp()&&s.callbackNode!==u)return null;var p=Kt;return p=Ai(s,s===Sn?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(Nb(s,p,l),Yb(s,nt()),s.callbackNode!=null&&s.callbackNode===u?qb.bind(null,s):null)}function Kb(s,l){if(pp())return null;Nb(s,l,!0)}function PO(){XO(function(){(hn&6)!==0?be(ht,FO):Xb()})}function N1(){return rc===0&&(rc=Rl()),rc}function Qb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:jc(""+s)}function Zb(s,l){var u=l.ownerDocument.createElement("input");return u.name=l.name,u.value=l.value,s.id&&u.setAttribute("form",s.id),l.parentNode.insertBefore(u,l),s=new FormData(s),u.parentNode.removeChild(u),s}function BO(s,l,u,p,_){if(l==="submit"&&u&&u.stateNode===_){var E=Qb((_[Zn]||null).action),O=p.submitter;O&&(l=(l=O[Zn]||null)?Qb(l.formAction):O.getAttribute("formAction"),l!==null&&(E=l,O=null));var F=new ko("action","action",null,p,_);s.push({event:F,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(rc!==0){var Q=O?Zb(_,O):new FormData(_);Qm(u,{pending:!0,data:Q,method:_.method,action:E},null,Q)}}else typeof E=="function"&&(F.preventDefault(),Q=O?Zb(_,O):new FormData(_),Qm(u,{pending:!0,data:Q,method:_.method,action:E},E,Q))},currentTarget:_}]})}}for(var L1=0;L1<$f.length;L1++){var M1=$f[L1],UO=M1.toLowerCase(),HO=M1[0].toUpperCase()+M1.slice(1);$i(UO,"on"+HO)}$i(ca,"onAnimationEnd"),$i(_s,"onAnimationIteration"),$i(Hf,"onAnimationStart"),$i("dblclick","onDoubleClick"),$i("focusin","onFocus"),$i("focusout","onBlur"),$i(Vm,"onTransitionRun"),$i(k0,"onTransitionStart"),$i(F0,"onTransitionCancel"),$i(zf,"onTransitionEnd"),$e("onMouseEnter",["mouseout","mouseover"]),$e("onMouseLeave",["mouseout","mouseover"]),$e("onPointerEnter",["pointerout","pointerover"]),$e("onPointerLeave",["pointerout","pointerover"]),Re("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Re("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Re("onBeforeInput",["compositionend","keypress","textInput","paste"]),Re("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zO=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oh));function Jb(s,l){l=(l&4)!==0;for(var u=0;u<s.length;u++){var p=s[u],_=p.event;p=p.listeners;e:{var E=void 0;if(l)for(var O=p.length-1;0<=O;O--){var F=p[O],Q=F.instance,de=F.currentTarget;if(F=F.listener,Q!==E&&_.isPropagationStopped())break e;E=F,_.currentTarget=de;try{E(_)}catch(Oe){rp(Oe)}_.currentTarget=null,E=Q}else for(O=0;O<p.length;O++){if(F=p[O],Q=F.instance,de=F.currentTarget,F=F.listener,Q!==E&&_.isPropagationStopped())break e;E=F,_.currentTarget=de;try{E(_)}catch(Oe){rp(Oe)}_.currentTarget=null,E=Q}}}}function Gt(s,l){var u=l[kl];u===void 0&&(u=l[kl]=new Set);var p=s+"__bubble";u.has(p)||(eE(l,s,2,!1),u.add(p))}function I1(s,l,u){var p=0;l&&(p|=4),eE(u,s,p,l)}var vp="_reactListening"+Math.random().toString(36).slice(2);function k1(s){if(!s[vp]){s[vp]=!0,ce.forEach(function(u){u!=="selectionchange"&&(zO.has(u)||I1(u,!1,s),I1(u,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[vp]||(l[vp]=!0,I1("selectionchange",!1,l))}}function eE(s,l,u,p){switch(wE(l)){case 2:var _=pR;break;case 8:_=gR;break;default:_=q1}u=_.bind(null,l,u,s),_=void 0,!aa||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(_=!0),p?_!==void 0?s.addEventListener(l,u,{capture:!0,passive:_}):s.addEventListener(l,u,!0):_!==void 0?s.addEventListener(l,u,{passive:_}):s.addEventListener(l,u,!1)}function F1(s,l,u,p,_){var E=p;if((l&1)===0&&(l&2)===0&&p!==null)e:for(;;){if(p===null)return;var O=p.tag;if(O===3||O===4){var F=p.stateNode.containerInfo;if(F===_)break;if(O===4)for(O=p.return;O!==null;){var Q=O.tag;if((Q===3||Q===4)&&O.stateNode.containerInfo===_)return;O=O.return}for(;F!==null;){if(O=G(F),O===null)return;if(Q=O.tag,Q===5||Q===6||Q===26||Q===27){p=E=O;continue e}F=F.parentNode}}p=p.return}Df(function(){var de=E,Oe=Mo(u),ke=[];e:{var me=jf.get(s);if(me!==void 0){var _e=ko,Tt=s;switch(s){case"keypress":if(Vc(u)===0)break e;case"keydown":case"keyup":_e=p0;break;case"focusin":Tt="focus",_e=Wc;break;case"focusout":Tt="blur",_e=Wc;break;case"beforeblur":case"afterblur":_e=Wc;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=Xa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=a0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=km;break;case ca:case _s:case Hf:_e=c0;break;case zf:_e=Fm;break;case"scroll":case"scrollend":_e=s0;break;case"wheel":_e=Bm;break;case"copy":case"cut":case"paste":_e=u0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=oa;break;case"toggle":case"beforetoggle":_e=v0}var xt=(l&4)!==0,_n=!xt&&(s==="scroll"||s==="scrollend"),oe=xt?me!==null?me+"Capture":null:me;xt=[];for(var te=de,fe;te!==null;){var Le=te;if(fe=Le.stateNode,Le=Le.tag,Le!==5&&Le!==26&&Le!==27||fe===null||oe===null||(Le=Io(te,oe),Le!=null&&xt.push(Rh(te,Le,fe))),_n)break;te=te.return}0<xt.length&&(me=new _e(me,Tt,null,u,Oe),ke.push({event:me,listeners:xt}))}}if((l&7)===0){e:{if(me=s==="mouseover"||s==="pointerover",_e=s==="mouseout"||s==="pointerout",me&&u!==ps&&(Tt=u.relatedTarget||u.fromElement)&&(G(Tt)||Tt[ra]))break e;if((_e||me)&&(me=Oe.window===Oe?Oe:(me=Oe.ownerDocument)?me.defaultView||me.parentWindow:window,_e?(Tt=u.relatedTarget||u.toElement,_e=de,Tt=Tt?G(Tt):null,Tt!==null&&(_n=a(Tt),xt=Tt.tag,Tt!==_n||xt!==5&&xt!==27&&xt!==6)&&(Tt=null)):(_e=null,Tt=de),_e!==Tt)){if(xt=Xa,Le="onMouseLeave",oe="onMouseEnter",te="mouse",(s==="pointerout"||s==="pointerover")&&(xt=oa,Le="onPointerLeave",oe="onPointerEnter",te="pointer"),_n=_e==null?me:he(_e),fe=Tt==null?me:he(Tt),me=new xt(Le,te+"leave",_e,u,Oe),me.target=_n,me.relatedTarget=fe,Le=null,G(Oe)===de&&(xt=new xt(oe,te+"enter",Tt,u,Oe),xt.target=fe,xt.relatedTarget=_n,Le=xt),_n=Le,_e&&Tt)t:{for(xt=_e,oe=Tt,te=0,fe=xt;fe;fe=bu(fe))te++;for(fe=0,Le=oe;Le;Le=bu(Le))fe++;for(;0<te-fe;)xt=bu(xt),te--;for(;0<fe-te;)oe=bu(oe),fe--;for(;te--;){if(xt===oe||oe!==null&&xt===oe.alternate)break t;xt=bu(xt),oe=bu(oe)}xt=null}else xt=null;_e!==null&&tE(ke,me,_e,xt,!1),Tt!==null&&_n!==null&&tE(ke,_n,Tt,xt,!0)}}e:{if(me=de?he(de):window,_e=me.nodeName&&me.nodeName.toLowerCase(),_e==="select"||_e==="input"&&me.type==="file")var at=S0;else if(A0(me))if(If)at=R0;else{at=D0;var jt=$m}else _e=me.nodeName,!_e||_e.toLowerCase()!=="input"||me.type!=="checkbox"&&me.type!=="radio"?de&&Ul(de.elementType)&&(at=S0):at=O0;if(at&&(at=at(s,de))){Ti(ke,at,u,Oe);break e}jt&&jt(s,me,de),s==="focusout"&&de&&me.type==="number"&&de.memoizedProps.value!=null&&Pl(me,"number",me.value)}switch(jt=de?he(de):window,s){case"focusin":(A0(jt)||jt.contentEditable==="true")&&(zo=jt,Bf=de,Vl=null);break;case"focusout":Vl=Bf=zo=null;break;case"mousedown":Uf=!0;break;case"contextmenu":case"mouseup":case"dragend":Uf=!1,M0(ke,u,Oe);break;case"selectionchange":if(Gm)break;case"keydown":case"keyup":M0(ke,u,Oe)}var ut;if(Mf)e:{switch(s){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else Po?b0(s,u)&&(yt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(yt="onCompositionStart");yt&&(x0&&u.locale!=="ko"&&(Po||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&Po&&(ut=Gc()):(Us=Oe,zl="value"in Us?Us.value:Us.textContent,Po=!0)),jt=_p(de,yt),0<jt.length&&(yt=new f0(yt,s,null,u,Oe),ke.push({event:yt,listeners:jt}),ut?yt.data=ut:(ut=E0(u),ut!==null&&(yt.data=ut)))),(ut=Ya?Hm(s,u):zm(s,u))&&(yt=_p(de,"onBeforeInput"),0<yt.length&&(jt=new f0("onBeforeInput","beforeinput",null,u,Oe),ke.push({event:jt,listeners:yt}),jt.data=ut)),BO(ke,s,de,u,Oe)}Jb(ke,l)})}function Rh(s,l,u){return{instance:s,listener:l,currentTarget:u}}function _p(s,l){for(var u=l+"Capture",p=[];s!==null;){var _=s,E=_.stateNode;if(_=_.tag,_!==5&&_!==26&&_!==27||E===null||(_=Io(s,u),_!=null&&p.unshift(Rh(s,_,E)),_=Io(s,l),_!=null&&p.push(Rh(s,_,E))),s.tag===3)return p;s=s.return}return[]}function bu(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function tE(s,l,u,p,_){for(var E=l._reactName,O=[];u!==null&&u!==p;){var F=u,Q=F.alternate,de=F.stateNode;if(F=F.tag,Q!==null&&Q===p)break;F!==5&&F!==26&&F!==27||de===null||(Q=de,_?(de=Io(u,E),de!=null&&O.unshift(Rh(u,de,Q))):_||(de=Io(u,E),de!=null&&O.push(Rh(u,de,Q)))),u=u.return}O.length!==0&&s.push({event:l,listeners:O})}var jO=/\r\n?/g,$O=/\u0000|\uFFFD/g;function nE(s){return(typeof s=="string"?s:""+s).replace(jO,`
`).replace($O,"")}function rE(s,l){return l=nE(l),nE(s)===l}function xp(){}function vn(s,l,u,p,_,E){switch(u){case"children":typeof p=="string"?l==="body"||l==="textarea"&&p===""||ji(s,p):(typeof p=="number"||typeof p=="bigint")&&l!=="body"&&ji(s,""+p);break;case"className":Xt(s,"class",p);break;case"tabIndex":Xt(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Xt(s,u,p);break;case"style":Ha(s,p,E);break;case"data":if(l!=="object"){Xt(s,"data",p);break}case"src":case"href":if(p===""&&(l!=="a"||u!=="href")){s.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=jc(""+p),s.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(u==="formAction"?(l!=="input"&&vn(s,l,"name",_.name,_,null),vn(s,l,"formEncType",_.formEncType,_,null),vn(s,l,"formMethod",_.formMethod,_,null),vn(s,l,"formTarget",_.formTarget,_,null)):(vn(s,l,"encType",_.encType,_,null),vn(s,l,"method",_.method,_,null),vn(s,l,"target",_.target,_,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=jc(""+p),s.setAttribute(u,p);break;case"onClick":p!=null&&(s.onclick=xp);break;case"onScroll":p!=null&&Gt("scroll",s);break;case"onScrollEnd":p!=null&&Gt("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(_.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}u=jc(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""+p):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":p===!0?s.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,p):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(u,p):s.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(u):s.setAttribute(u,p);break;case"popover":Gt("beforetoggle",s),Gt("toggle",s),Jt(s,"popover",p);break;case"xlinkActuate":cn(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":cn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":cn(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":cn(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":cn(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":cn(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":cn(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":cn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":cn(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Jt(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=r0.get(u)||u,Jt(s,u,p))}}function P1(s,l,u,p,_,E){switch(u){case"style":Ha(s,p,E);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(_.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"children":typeof p=="string"?ji(s,p):(typeof p=="number"||typeof p=="bigint")&&ji(s,""+p);break;case"onScroll":p!=null&&Gt("scroll",s);break;case"onScrollEnd":p!=null&&Gt("scrollend",s);break;case"onClick":p!=null&&(s.onclick=xp);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ue.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(_=u.endsWith("Capture"),l=u.slice(2,_?u.length-7:void 0),E=s[Zn]||null,E=E!=null?E[u]:null,typeof E=="function"&&s.removeEventListener(l,E,_),typeof p=="function")){typeof E!="function"&&E!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(l,p,_);break e}u in s?s[u]=p:p===!0?s.setAttribute(u,""):Jt(s,u,p)}}}function Nr(s,l,u){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Gt("error",s),Gt("load",s);var p=!1,_=!1,E;for(E in u)if(u.hasOwnProperty(E)){var O=u[E];if(O!=null)switch(E){case"src":p=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:vn(s,l,E,O,u,null)}}_&&vn(s,l,"srcSet",u.srcSet,u,null),p&&vn(s,l,"src",u.src,u,null);return;case"input":Gt("invalid",s);var F=E=O=_=null,Q=null,de=null;for(p in u)if(u.hasOwnProperty(p)){var Oe=u[p];if(Oe!=null)switch(p){case"name":_=Oe;break;case"type":O=Oe;break;case"checked":Q=Oe;break;case"defaultChecked":de=Oe;break;case"value":E=Oe;break;case"defaultValue":F=Oe;break;case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(r(137,l));break;default:vn(s,l,p,Oe,u,null)}}zc(s,E,F,Q,de,O,_,!1),Fl(s);return;case"select":Gt("invalid",s),p=O=E=null;for(_ in u)if(u.hasOwnProperty(_)&&(F=u[_],F!=null))switch(_){case"value":E=F;break;case"defaultValue":O=F;break;case"multiple":p=F;default:vn(s,l,_,F,u,null)}l=E,u=O,s.multiple=!!p,l!=null?Tr(s,!!p,l,!1):u!=null&&Tr(s,!!p,u,!0);return;case"textarea":Gt("invalid",s),E=_=p=null;for(O in u)if(u.hasOwnProperty(O)&&(F=u[O],F!=null))switch(O){case"value":p=F;break;case"defaultValue":_=F;break;case"children":E=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(91));break;default:vn(s,l,O,F,u,null)}Bl(s,p,_,E),Fl(s);return;case"option":for(Q in u)if(u.hasOwnProperty(Q)&&(p=u[Q],p!=null))switch(Q){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:vn(s,l,Q,p,u,null)}return;case"dialog":Gt("beforetoggle",s),Gt("toggle",s),Gt("cancel",s),Gt("close",s);break;case"iframe":case"object":Gt("load",s);break;case"video":case"audio":for(p=0;p<Oh.length;p++)Gt(Oh[p],s);break;case"image":Gt("error",s),Gt("load",s);break;case"details":Gt("toggle",s);break;case"embed":case"source":case"link":Gt("error",s),Gt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in u)if(u.hasOwnProperty(de)&&(p=u[de],p!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,l));default:vn(s,l,de,p,u,null)}return;default:if(Ul(l)){for(Oe in u)u.hasOwnProperty(Oe)&&(p=u[Oe],p!==void 0&&P1(s,l,Oe,p,u,void 0));return}}for(F in u)u.hasOwnProperty(F)&&(p=u[F],p!=null&&vn(s,l,F,p,u,null))}function GO(s,l,u,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,E=null,O=null,F=null,Q=null,de=null,Oe=null;for(_e in u){var ke=u[_e];if(u.hasOwnProperty(_e)&&ke!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":Q=ke;default:p.hasOwnProperty(_e)||vn(s,l,_e,null,p,ke)}}for(var me in p){var _e=p[me];if(ke=u[me],p.hasOwnProperty(me)&&(_e!=null||ke!=null))switch(me){case"type":E=_e;break;case"name":_=_e;break;case"checked":de=_e;break;case"defaultChecked":Oe=_e;break;case"value":O=_e;break;case"defaultValue":F=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(r(137,l));break;default:_e!==ke&&vn(s,l,me,_e,p,ke)}}Ur(s,O,F,Q,de,Oe,E,_);return;case"select":_e=O=F=me=null;for(E in u)if(Q=u[E],u.hasOwnProperty(E)&&Q!=null)switch(E){case"value":break;case"multiple":_e=Q;default:p.hasOwnProperty(E)||vn(s,l,E,null,p,Q)}for(_ in p)if(E=p[_],Q=u[_],p.hasOwnProperty(_)&&(E!=null||Q!=null))switch(_){case"value":me=E;break;case"defaultValue":F=E;break;case"multiple":O=E;default:E!==Q&&vn(s,l,_,E,p,Q)}l=F,u=O,p=_e,me!=null?Tr(s,!!u,me,!1):!!p!=!!u&&(l!=null?Tr(s,!!u,l,!0):Tr(s,!!u,u?[]:"",!1));return;case"textarea":_e=me=null;for(F in u)if(_=u[F],u.hasOwnProperty(F)&&_!=null&&!p.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:vn(s,l,F,null,p,_)}for(O in p)if(_=p[O],E=u[O],p.hasOwnProperty(O)&&(_!=null||E!=null))switch(O){case"value":me=_;break;case"defaultValue":_e=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(r(91));break;default:_!==E&&vn(s,l,O,_,p,E)}sa(s,me,_e);return;case"option":for(var Tt in u)if(me=u[Tt],u.hasOwnProperty(Tt)&&me!=null&&!p.hasOwnProperty(Tt))switch(Tt){case"selected":s.selected=!1;break;default:vn(s,l,Tt,null,p,me)}for(Q in p)if(me=p[Q],_e=u[Q],p.hasOwnProperty(Q)&&me!==_e&&(me!=null||_e!=null))switch(Q){case"selected":s.selected=me&&typeof me!="function"&&typeof me!="symbol";break;default:vn(s,l,Q,me,p,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var xt in u)me=u[xt],u.hasOwnProperty(xt)&&me!=null&&!p.hasOwnProperty(xt)&&vn(s,l,xt,null,p,me);for(de in p)if(me=p[de],_e=u[de],p.hasOwnProperty(de)&&me!==_e&&(me!=null||_e!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(r(137,l));break;default:vn(s,l,de,me,p,_e)}return;default:if(Ul(l)){for(var _n in u)me=u[_n],u.hasOwnProperty(_n)&&me!==void 0&&!p.hasOwnProperty(_n)&&P1(s,l,_n,void 0,p,me);for(Oe in p)me=p[Oe],_e=u[Oe],!p.hasOwnProperty(Oe)||me===_e||me===void 0&&_e===void 0||P1(s,l,Oe,me,p,_e);return}}for(var oe in u)me=u[oe],u.hasOwnProperty(oe)&&me!=null&&!p.hasOwnProperty(oe)&&vn(s,l,oe,null,p,me);for(ke in p)me=p[ke],_e=u[ke],!p.hasOwnProperty(ke)||me===_e||me==null&&_e==null||vn(s,l,ke,me,p,_e)}var B1=null,U1=null;function yp(s){return s.nodeType===9?s:s.ownerDocument}function iE(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sE(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function H1(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var z1=null;function VO(){var s=window.event;return s&&s.type==="popstate"?s===z1?!1:(z1=s,!0):(z1=null,!1)}var aE=typeof setTimeout=="function"?setTimeout:void 0,WO=typeof clearTimeout=="function"?clearTimeout:void 0,oE=typeof Promise=="function"?Promise:void 0,XO=typeof queueMicrotask=="function"?queueMicrotask:typeof oE<"u"?function(s){return oE.resolve(null).then(s).catch(YO)}:aE;function YO(s){setTimeout(function(){throw s})}function al(s){return s==="head"}function lE(s,l){var u=l,p=0,_=0;do{var E=u.nextSibling;if(s.removeChild(u),E&&E.nodeType===8)if(u=E.data,u==="/$"){if(0<p&&8>p){u=p;var O=s.ownerDocument;if(u&1&&Nh(O.documentElement),u&2&&Nh(O.body),u&4)for(u=O.head,Nh(u),O=u.firstChild;O;){var F=O.nextSibling,Q=O.nodeName;O[z]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&O.rel.toLowerCase()==="stylesheet"||u.removeChild(O),O=F}}if(_===0){s.removeChild(E),Uh(l);return}_--}else u==="$"||u==="$?"||u==="$!"?_++:p=u.charCodeAt(0)-48;else p=0;u=E}while(u);Uh(l)}function j1(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var u=l;switch(l=l.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":j1(u),j(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function qO(s,l,u,p){for(;s.nodeType===1;){var _=u;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[z])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(E=s.getAttribute("rel"),E==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(E!==_.rel||s.getAttribute("href")!==(_.href==null||_.href===""?null:_.href)||s.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||s.getAttribute("title")!==(_.title==null?null:_.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(E=s.getAttribute("src"),(E!==(_.src==null?null:_.src)||s.getAttribute("type")!==(_.type==null?null:_.type)||s.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&E&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var E=_.name==null?null:""+_.name;if(_.type==="hidden"&&s.getAttribute("name")===E)return s}else return s;if(s=Ys(s.nextSibling),s===null)break}return null}function KO(s,l,u){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=Ys(s.nextSibling),s===null))return null;return s}function $1(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function QO(s,l){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")l();else{var p=function(){l(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function Ys(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return s}var G1=null;function cE(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return s;l--}else u==="/$"&&l++}s=s.previousSibling}return null}function uE(s,l,u){switch(l=yp(u),s){case"html":if(s=l.documentElement,!s)throw Error(r(452));return s;case"head":if(s=l.head,!s)throw Error(r(453));return s;case"body":if(s=l.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Nh(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);j(s)}var As=new Map,fE=new Set;function bp(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var mo=ee.d;ee.d={f:ZO,r:JO,D:eR,C:tR,L:nR,m:rR,X:sR,S:iR,M:aR};function ZO(){var s=mo.f(),l=hp();return s||l}function JO(s){var l=X(s);l!==null&&l.tag===5&&l.type==="form"?Ny(l):mo.r(s)}var Eu=typeof document>"u"?null:document;function hE(s,l,u){var p=Eu;if(p&&typeof l=="string"&&l){var _=Jn(l);_='link[rel="'+s+'"][href="'+_+'"]',typeof u=="string"&&(_+='[crossorigin="'+u+'"]'),fE.has(_)||(fE.add(_),s={rel:s,crossOrigin:u,href:l},p.querySelector(_)===null&&(l=p.createElement("link"),Nr(l,"link",s),ie(l),p.head.appendChild(l)))}}function eR(s){mo.D(s),hE("dns-prefetch",s,null)}function tR(s,l){mo.C(s,l),hE("preconnect",s,l)}function nR(s,l,u){mo.L(s,l,u);var p=Eu;if(p&&s&&l){var _='link[rel="preload"][as="'+Jn(l)+'"]';l==="image"&&u&&u.imageSrcSet?(_+='[imagesrcset="'+Jn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(_+='[imagesizes="'+Jn(u.imageSizes)+'"]')):_+='[href="'+Jn(s)+'"]';var E=_;switch(l){case"style":E=Au(s);break;case"script":E=wu(s)}As.has(E)||(s=d({rel:"preload",href:l==="image"&&u&&u.imageSrcSet?void 0:s,as:l},u),As.set(E,s),p.querySelector(_)!==null||l==="style"&&p.querySelector(Lh(E))||l==="script"&&p.querySelector(Mh(E))||(l=p.createElement("link"),Nr(l,"link",s),ie(l),p.head.appendChild(l)))}}function rR(s,l){mo.m(s,l);var u=Eu;if(u&&s){var p=l&&typeof l.as=="string"?l.as:"script",_='link[rel="modulepreload"][as="'+Jn(p)+'"][href="'+Jn(s)+'"]',E=_;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=wu(s)}if(!As.has(E)&&(s=d({rel:"modulepreload",href:s},l),As.set(E,s),u.querySelector(_)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Mh(E)))return}p=u.createElement("link"),Nr(p,"link",s),ie(p),u.head.appendChild(p)}}}function iR(s,l,u){mo.S(s,l,u);var p=Eu;if(p&&s){var _=Ee(p).hoistableStyles,E=Au(s);l=l||"default";var O=_.get(E);if(!O){var F={loading:0,preload:null};if(O=p.querySelector(Lh(E)))F.loading=5;else{s=d({rel:"stylesheet",href:s,"data-precedence":l},u),(u=As.get(E))&&V1(s,u);var Q=O=p.createElement("link");ie(Q),Nr(Q,"link",s),Q._p=new Promise(function(de,Oe){Q.onload=de,Q.onerror=Oe}),Q.addEventListener("load",function(){F.loading|=1}),Q.addEventListener("error",function(){F.loading|=2}),F.loading|=4,Ep(O,l,p)}O={type:"stylesheet",instance:O,count:1,state:F},_.set(E,O)}}}function sR(s,l){mo.X(s,l);var u=Eu;if(u&&s){var p=Ee(u).hoistableScripts,_=wu(s),E=p.get(_);E||(E=u.querySelector(Mh(_)),E||(s=d({src:s,async:!0},l),(l=As.get(_))&&W1(s,l),E=u.createElement("script"),ie(E),Nr(E,"link",s),u.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},p.set(_,E))}}function aR(s,l){mo.M(s,l);var u=Eu;if(u&&s){var p=Ee(u).hoistableScripts,_=wu(s),E=p.get(_);E||(E=u.querySelector(Mh(_)),E||(s=d({src:s,async:!0,type:"module"},l),(l=As.get(_))&&W1(s,l),E=u.createElement("script"),ie(E),Nr(E,"link",s),u.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},p.set(_,E))}}function dE(s,l,u,p){var _=(_=Ie.current)?bp(_):null;if(!_)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(l=Au(u.href),u=Ee(_).hoistableStyles,p=u.get(l),p||(p={type:"style",instance:null,count:0,state:null},u.set(l,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Au(u.href);var E=Ee(_).hoistableStyles,O=E.get(s);if(O||(_=_.ownerDocument||_,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(s,O),(E=_.querySelector(Lh(s)))&&!E._p&&(O.instance=E,O.state.loading=5),As.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},As.set(s,u),E||oR(_,s,u,O.state))),l&&p===null)throw Error(r(528,""));return O}if(l&&p!==null)throw Error(r(529,""));return null;case"script":return l=u.async,u=u.src,typeof u=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=wu(u),u=Ee(_).hoistableScripts,p=u.get(l),p||(p={type:"script",instance:null,count:0,state:null},u.set(l,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Au(s){return'href="'+Jn(s)+'"'}function Lh(s){return'link[rel="stylesheet"]['+s+"]"}function pE(s){return d({},s,{"data-precedence":s.precedence,precedence:null})}function oR(s,l,u,p){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?p.loading=1:(l=s.createElement("link"),p.preload=l,l.addEventListener("load",function(){return p.loading|=1}),l.addEventListener("error",function(){return p.loading|=2}),Nr(l,"link",u),ie(l),s.head.appendChild(l))}function wu(s){return'[src="'+Jn(s)+'"]'}function Mh(s){return"script[async]"+s}function gE(s,l,u){if(l.count++,l.instance===null)switch(l.type){case"style":var p=s.querySelector('style[data-href~="'+Jn(u.href)+'"]');if(p)return l.instance=p,ie(p),p;var _=d({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),ie(p),Nr(p,"style",_),Ep(p,u.precedence,s),l.instance=p;case"stylesheet":_=Au(u.href);var E=s.querySelector(Lh(_));if(E)return l.state.loading|=4,l.instance=E,ie(E),E;p=pE(u),(_=As.get(_))&&V1(p,_),E=(s.ownerDocument||s).createElement("link"),ie(E);var O=E;return O._p=new Promise(function(F,Q){O.onload=F,O.onerror=Q}),Nr(E,"link",p),l.state.loading|=4,Ep(E,u.precedence,s),l.instance=E;case"script":return E=wu(u.src),(_=s.querySelector(Mh(E)))?(l.instance=_,ie(_),_):(p=u,(_=As.get(E))&&(p=d({},u),W1(p,_)),s=s.ownerDocument||s,_=s.createElement("script"),ie(_),Nr(_,"link",p),s.head.appendChild(_),l.instance=_);case"void":return null;default:throw Error(r(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(p=l.instance,l.state.loading|=4,Ep(p,u.precedence,s));return l.instance}function Ep(s,l,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=p.length?p[p.length-1]:null,E=_,O=0;O<p.length;O++){var F=p[O];if(F.dataset.precedence===l)E=F;else if(E!==_)break}E?E.parentNode.insertBefore(s,E.nextSibling):(l=u.nodeType===9?u.head:u,l.insertBefore(s,l.firstChild))}function V1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function W1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var Ap=null;function mE(s,l,u){if(Ap===null){var p=new Map,_=Ap=new Map;_.set(u,p)}else _=Ap,p=_.get(u),p||(p=new Map,_.set(u,p));if(p.has(s))return p;for(p.set(s,null),u=u.getElementsByTagName(s),_=0;_<u.length;_++){var E=u[_];if(!(E[z]||E[Qn]||s==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var O=E.getAttribute(l)||"";O=s+O;var F=p.get(O);F?F.push(E):p.set(O,[E])}}return p}function vE(s,l,u){s=s.ownerDocument||s,s.head.insertBefore(u,l==="title"?s.querySelector("head > title"):null)}function lR(s,l,u){if(u===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function _E(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Ih=null;function cR(){}function uR(s,l,u){if(Ih===null)throw Error(r(475));var p=Ih;if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var _=Au(u.href),E=s.querySelector(Lh(_));if(E){s=E._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(p.count++,p=wp.bind(p),s.then(p,p)),l.state.loading|=4,l.instance=E,ie(E);return}E=s.ownerDocument||s,u=pE(u),(_=As.get(_))&&V1(u,_),E=E.createElement("link"),ie(E);var O=E;O._p=new Promise(function(F,Q){O.onload=F,O.onerror=Q}),Nr(E,"link",u),l.instance=E}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(l,s),(s=l.state.preload)&&(l.state.loading&3)===0&&(p.count++,l=wp.bind(p),s.addEventListener("load",l),s.addEventListener("error",l))}}function fR(){if(Ih===null)throw Error(r(475));var s=Ih;return s.stylesheets&&s.count===0&&X1(s,s.stylesheets),0<s.count?function(l){var u=setTimeout(function(){if(s.stylesheets&&X1(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(u)}}:null}function wp(){if(this.count--,this.count===0){if(this.stylesheets)X1(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Sp=null;function X1(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Sp=new Map,l.forEach(hR,s),Sp=null,wp.call(s))}function hR(s,l){if(!(l.state.loading&4)){var u=Sp.get(s);if(u)var p=u.get(null);else{u=new Map,Sp.set(s,u);for(var _=s.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<_.length;E++){var O=_[E];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(u.set(O.dataset.precedence,O),p=O)}p&&u.set(null,p)}_=l.instance,O=_.getAttribute("data-precedence"),E=u.get(O)||p,E===p&&u.set(null,_),u.set(O,_),this.count++,p=wp.bind(this),_.addEventListener("load",p),_.addEventListener("error",p),E?E.parentNode.insertBefore(_,E.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(_,s.firstChild)),l.state.loading|=4}}var kh={$$typeof:T,Provider:null,Consumer:null,_currentValue:Pe,_currentValue2:Pe,_threadCount:0};function dR(s,l,u,p,_,E,O,F){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Lo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lo(0),this.hiddenUpdates=Lo(null),this.identifierPrefix=p,this.onUncaughtError=_,this.onCaughtError=E,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function xE(s,l,u,p,_,E,O,F,Q,de,Oe,ke){return s=new dR(s,l,u,O,F,Q,de,ke),l=1,E===!0&&(l|=24),E=ci(3,null,null,l),s.current=E,E.stateNode=s,l=Ql(),l.refCount++,s.pooledCache=l,l.refCount++,E.memoizedState={element:p,isDehydrated:u,cache:l},ae(E),s}function yE(s){return s?(s=$o,s):$o}function bE(s,l,u,p,_,E){_=yE(_),p.context===null?p.context=_:p.pendingContext=_,p=Ne(l),p.payload={element:u},E=E===void 0?null:E,E!==null&&(p.callback=E),u=We(s,p,l),u!==null&&(Ki(u,s,l),tt(u,s,l))}function EE(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<l?u:l}}function Y1(s,l){EE(s,l),(s=s.alternate)&&EE(s,l)}function AE(s){if(s.tag===13){var l=zr(s,67108864);l!==null&&Ki(l,s,67108864),Y1(s,67108864)}}var Tp=!0;function pR(s,l,u,p){var _=q.T;q.T=null;var E=ee.p;try{ee.p=2,q1(s,l,u,p)}finally{ee.p=E,q.T=_}}function gR(s,l,u,p){var _=q.T;q.T=null;var E=ee.p;try{ee.p=8,q1(s,l,u,p)}finally{ee.p=E,q.T=_}}function q1(s,l,u,p){if(Tp){var _=K1(p);if(_===null)F1(s,l,p,Cp,u),SE(s,p);else if(vR(_,s,l,u,p))p.stopPropagation();else if(SE(s,p),l&4&&-1<mR.indexOf(s)){for(;_!==null;){var E=X(_);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var O=cr(E.pendingLanes);if(O!==0){var F=E;for(F.pendingLanes|=2,F.entangledLanes|=2;O;){var Q=1<<31-on(O);F.entanglements[1]|=Q,O&=~Q}ya(E),(hn&6)===0&&(up=nt()+500,Dh(0))}}break;case 13:F=zr(E,2),F!==null&&Ki(F,E,2),hp(),Y1(E,2)}if(E=K1(p),E===null&&F1(s,l,p,Cp,u),E===_)break;_=E}_!==null&&p.stopPropagation()}else F1(s,l,p,null,u)}}function K1(s){return s=Mo(s),Q1(s)}var Cp=null;function Q1(s){if(Cp=null,s=G(s),s!==null){var l=a(s);if(l===null)s=null;else{var u=l.tag;if(u===13){if(s=o(l),s!==null)return s;s=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return Cp=s,null}function wE(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rt()){case ht:return 2;case Rt:return 8;case kt:case nn:return 32;case Qe:return 268435456;default:return 32}default:return 32}}var Z1=!1,ol=null,ll=null,cl=null,Fh=new Map,Ph=new Map,ul=[],mR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function SE(s,l){switch(s){case"focusin":case"focusout":ol=null;break;case"dragenter":case"dragleave":ll=null;break;case"mouseover":case"mouseout":cl=null;break;case"pointerover":case"pointerout":Fh.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ph.delete(l.pointerId)}}function Bh(s,l,u,p,_,E){return s===null||s.nativeEvent!==E?(s={blockedOn:l,domEventName:u,eventSystemFlags:p,nativeEvent:E,targetContainers:[_]},l!==null&&(l=X(l),l!==null&&AE(l)),s):(s.eventSystemFlags|=p,l=s.targetContainers,_!==null&&l.indexOf(_)===-1&&l.push(_),s)}function vR(s,l,u,p,_){switch(l){case"focusin":return ol=Bh(ol,s,l,u,p,_),!0;case"dragenter":return ll=Bh(ll,s,l,u,p,_),!0;case"mouseover":return cl=Bh(cl,s,l,u,p,_),!0;case"pointerover":var E=_.pointerId;return Fh.set(E,Bh(Fh.get(E)||null,s,l,u,p,_)),!0;case"gotpointercapture":return E=_.pointerId,Ph.set(E,Bh(Ph.get(E)||null,s,l,u,p,_)),!0}return!1}function TE(s){var l=G(s.target);if(l!==null){var u=a(l);if(u!==null){if(l=u.tag,l===13){if(l=o(u),l!==null){s.blockedOn=l,na(s.priority,function(){if(u.tag===13){var p=qi();p=Ml(p);var _=zr(u,p);_!==null&&Ki(_,u,p),Y1(u,p)}});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Dp(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var u=K1(s.nativeEvent);if(u===null){u=s.nativeEvent;var p=new u.constructor(u.type,u);ps=p,u.target.dispatchEvent(p),ps=null}else return l=X(u),l!==null&&AE(l),s.blockedOn=u,!1;l.shift()}return!0}function CE(s,l,u){Dp(s)&&u.delete(l)}function _R(){Z1=!1,ol!==null&&Dp(ol)&&(ol=null),ll!==null&&Dp(ll)&&(ll=null),cl!==null&&Dp(cl)&&(cl=null),Fh.forEach(CE),Ph.forEach(CE)}function Op(s,l){s.blockedOn===l&&(s.blockedOn=null,Z1||(Z1=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,_R)))}var Rp=null;function DE(s){Rp!==s&&(Rp=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Rp===s&&(Rp=null);for(var l=0;l<s.length;l+=3){var u=s[l],p=s[l+1],_=s[l+2];if(typeof p!="function"){if(Q1(p||u)===null)continue;break}var E=X(u);E!==null&&(s.splice(l,3),l-=3,Qm(E,{pending:!0,data:_,method:u.method,action:p},p,_))}}))}function Uh(s){function l(Q){return Op(Q,s)}ol!==null&&Op(ol,s),ll!==null&&Op(ll,s),cl!==null&&Op(cl,s),Fh.forEach(l),Ph.forEach(l);for(var u=0;u<ul.length;u++){var p=ul[u];p.blockedOn===s&&(p.blockedOn=null)}for(;0<ul.length&&(u=ul[0],u.blockedOn===null);)TE(u),u.blockedOn===null&&ul.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var _=u[p],E=u[p+1],O=_[Zn]||null;if(typeof E=="function")O||DE(u);else if(O){var F=null;if(E&&E.hasAttribute("formAction")){if(_=E,O=E[Zn]||null)F=O.formAction;else if(Q1(_)!==null)continue}else F=O.action;typeof F=="function"?u[p+1]=F:(u.splice(p,3),p-=3),DE(u)}}}function J1(s){this._internalRoot=s}Np.prototype.render=J1.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(r(409));var u=l.current,p=qi();bE(u,p,s,l,null,null)},Np.prototype.unmount=J1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;bE(s.current,2,null,s,null,null),hp(),l[ra]=null}};function Np(s){this._internalRoot=s}Np.prototype.unstable_scheduleHydration=function(s){if(s){var l=Hc();s={blockedOn:null,target:s,priority:l};for(var u=0;u<ul.length&&l!==0&&l<ul[u].priority;u++);ul.splice(u,0,s),u===0&&TE(s)}};var OE=e.version;if(OE!=="19.1.0")throw Error(r(527,OE,"19.1.0"));ee.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=f(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var xR={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lp.isDisabled&&Lp.supportsFiber)try{Tn=Lp.inject(xR),zt=Lp}catch{}}return zh.createRoot=function(s,l){if(!i(s))throw Error(r(299));var u=!1,p="",_=Vy,E=Wy,O=Xy,F=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(_=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(O=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(F=l.unstable_transitionCallbacks)),l=xE(s,1,!1,null,null,u,p,_,E,O,F,null),s[ra]=l.current,k1(s),new J1(l)},zh.hydrateRoot=function(s,l,u){if(!i(s))throw Error(r(299));var p=!1,_="",E=Vy,O=Wy,F=Xy,Q=null,de=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onUncaughtError!==void 0&&(E=u.onUncaughtError),u.onCaughtError!==void 0&&(O=u.onCaughtError),u.onRecoverableError!==void 0&&(F=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(Q=u.unstable_transitionCallbacks),u.formState!==void 0&&(de=u.formState)),l=xE(s,1,!0,l,u??null,p,_,E,O,F,Q,de),l.context=yE(null),u=l.current,p=qi(),p=Ml(p),_=Ne(p),_.callback=null,We(u,_,p),u=p,l.current.lanes=u,hs(l,u),ya(l),s[ra]=l.current,k1(s),new Np(l)},zh.version="19.1.0",zh}var zE;function DR(){if(zE)return rv.exports;zE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),rv.exports=CR(),rv.exports}var OR=DR(),sg={exports:{}};/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var RR=sg.exports,jE;function NR(){return jE||(jE=1,function(n,e){(function(t,r){n.exports=r()})(RR,function(){const t=new Map,r={set(L,x,S){t.has(L)||t.set(L,new Map);const H=t.get(L);H.has(x)||H.size===0?H.set(x,S):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(H.keys())[0]}.`)},get:(L,x)=>t.has(L)&&t.get(L).get(x)||null,remove(L,x){if(!t.has(L))return;const S=t.get(L);S.delete(x),S.size===0&&t.delete(L)}},i="transitionend",a=L=>(L&&window.CSS&&window.CSS.escape&&(L=L.replace(/#([^\s"#']+)/g,(x,S)=>`#${CSS.escape(S)}`)),L),o=L=>{L.dispatchEvent(new Event(i))},c=L=>!(!L||typeof L!="object")&&(L.jquery!==void 0&&(L=L[0]),L.nodeType!==void 0),f=L=>c(L)?L.jquery?L[0]:L:typeof L=="string"&&L.length>0?document.querySelector(a(L)):null,h=L=>{if(!c(L)||L.getClientRects().length===0)return!1;const x=getComputedStyle(L).getPropertyValue("visibility")==="visible",S=L.closest("details:not([open])");if(!S)return x;if(S!==L){const H=L.closest("summary");if(H&&H.parentNode!==S||H===null)return!1}return x},d=L=>!L||L.nodeType!==Node.ELEMENT_NODE||!!L.classList.contains("disabled")||(L.disabled!==void 0?L.disabled:L.hasAttribute("disabled")&&L.getAttribute("disabled")!=="false"),g=L=>{if(!document.documentElement.attachShadow)return null;if(typeof L.getRootNode=="function"){const x=L.getRootNode();return x instanceof ShadowRoot?x:null}return L instanceof ShadowRoot?L:L.parentNode?g(L.parentNode):null},m=()=>{},v=L=>{L.offsetHeight},y=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,b=[],A=()=>document.documentElement.dir==="rtl",w=L=>{var x;x=()=>{const S=y();if(S){const H=L.NAME,ne=S.fn[H];S.fn[H]=L.jQueryInterface,S.fn[H].Constructor=L,S.fn[H].noConflict=()=>(S.fn[H]=ne,L.jQueryInterface)}},document.readyState==="loading"?(b.length||document.addEventListener("DOMContentLoaded",()=>{for(const S of b)S()}),b.push(x)):x()},C=(L,x=[],S=L)=>typeof L=="function"?L.call(...x):S,T=(L,x,S=!0)=>{if(!S)return void C(L);const H=(Ae=>{if(!Ae)return 0;let{transitionDuration:Ne,transitionDelay:We}=window.getComputedStyle(Ae);const tt=Number.parseFloat(Ne),it=Number.parseFloat(We);return tt||it?(Ne=Ne.split(",")[0],We=We.split(",")[0],1e3*(Number.parseFloat(Ne)+Number.parseFloat(We))):0})(x)+5;let ne=!1;const ae=({target:Ae})=>{Ae===x&&(ne=!0,x.removeEventListener(i,ae),C(L))};x.addEventListener(i,ae),setTimeout(()=>{ne||o(x)},H)},R=(L,x,S,H)=>{const ne=L.length;let ae=L.indexOf(x);return ae===-1?!S&&H?L[ne-1]:L[0]:(ae+=S?1:-1,H&&(ae=(ae+ne)%ne),L[Math.max(0,Math.min(ae,ne-1))])},N=/[^.]*(?=\..*)\.|.*/,I=/\..*/,D=/::\d+$/,B={};let U=1;const Y={mouseenter:"mouseover",mouseleave:"mouseout"},W=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function re(L,x){return x&&`${x}::${U++}`||L.uidEvent||U++}function Te(L){const x=re(L);return L.uidEvent=x,B[x]=B[x]||{},B[x]}function Fe(L,x,S=null){return Object.values(L).find(H=>H.callable===x&&H.delegationSelector===S)}function we(L,x,S){const H=typeof x=="string",ne=H?S:x||S;let ae=qe(L);return W.has(ae)||(ae=L),[H,ne,ae]}function q(L,x,S,H,ne){if(typeof x!="string"||!L)return;let[ae,Ae,Ne]=we(x,S,H);x in Y&&(Ae=(Ot=>function(Et){if(!Et.relatedTarget||Et.relatedTarget!==Et.delegateTarget&&!Et.delegateTarget.contains(Et.relatedTarget))return Ot.call(this,Et)})(Ae));const We=Te(L),tt=We[Ne]||(We[Ne]={}),it=Fe(tt,Ae,ae?S:null);if(it)return void(it.oneOff=it.oneOff&&ne);const Je=re(Ae,x.replace(N,"")),Dt=ae?function(pt,Ot,Et){return function _t(tn){const un=pt.querySelectorAll(Ot);for(let{target:Ft}=tn;Ft&&Ft!==this;Ft=Ft.parentNode)for(const Yt of un)if(Yt===Ft)return ye(tn,{delegateTarget:Ft}),_t.oneOff&&P.off(pt,tn.type,Ot,Et),Et.apply(Ft,[tn])}}(L,S,Ae):function(pt,Ot){return function Et(_t){return ye(_t,{delegateTarget:pt}),Et.oneOff&&P.off(pt,_t.type,Ot),Ot.apply(pt,[_t])}}(L,Ae);Dt.delegationSelector=ae?S:null,Dt.callable=Ae,Dt.oneOff=ne,Dt.uidEvent=Je,tt[Je]=Dt,L.addEventListener(Ne,Dt,ae)}function ee(L,x,S,H,ne){const ae=Fe(x[S],H,ne);ae&&(L.removeEventListener(S,ae,!!ne),delete x[S][ae.uidEvent])}function Pe(L,x,S,H){const ne=x[S]||{};for(const[ae,Ae]of Object.entries(ne))ae.includes(H)&&ee(L,x,S,Ae.callable,Ae.delegationSelector)}function qe(L){return L=L.replace(I,""),Y[L]||L}const P={on(L,x,S,H){q(L,x,S,H,!1)},one(L,x,S,H){q(L,x,S,H,!0)},off(L,x,S,H){if(typeof x!="string"||!L)return;const[ne,ae,Ae]=we(x,S,H),Ne=Ae!==x,We=Te(L),tt=We[Ae]||{},it=x.startsWith(".");if(ae===void 0){if(it)for(const Je of Object.keys(We))Pe(L,We,Je,x.slice(1));for(const[Je,Dt]of Object.entries(tt)){const pt=Je.replace(D,"");Ne&&!x.includes(pt)||ee(L,We,Ae,Dt.callable,Dt.delegationSelector)}}else{if(!Object.keys(tt).length)return;ee(L,We,Ae,ae,ne?S:null)}},trigger(L,x,S){if(typeof x!="string"||!L)return null;const H=y();let ne=null,ae=!0,Ae=!0,Ne=!1;x!==qe(x)&&H&&(ne=H.Event(x,S),H(L).trigger(ne),ae=!ne.isPropagationStopped(),Ae=!ne.isImmediatePropagationStopped(),Ne=ne.isDefaultPrevented());const We=ye(new Event(x,{bubbles:ae,cancelable:!0}),S);return Ne&&We.preventDefault(),Ae&&L.dispatchEvent(We),We.defaultPrevented&&ne&&ne.preventDefault(),We}};function ye(L,x={}){for(const[S,H]of Object.entries(x))try{L[S]=H}catch{Object.defineProperty(L,S,{configurable:!0,get:()=>H})}return L}function ve(L){if(L==="true")return!0;if(L==="false")return!1;if(L===Number(L).toString())return Number(L);if(L===""||L==="null")return null;if(typeof L!="string")return L;try{return JSON.parse(decodeURIComponent(L))}catch{return L}}function ge(L){return L.replace(/[A-Z]/g,x=>`-${x.toLowerCase()}`)}const Ce={setDataAttribute(L,x,S){L.setAttribute(`data-bs-${ge(x)}`,S)},removeDataAttribute(L,x){L.removeAttribute(`data-bs-${ge(x)}`)},getDataAttributes(L){if(!L)return{};const x={},S=Object.keys(L.dataset).filter(H=>H.startsWith("bs")&&!H.startsWith("bsConfig"));for(const H of S){let ne=H.replace(/^bs/,"");ne=ne.charAt(0).toLowerCase()+ne.slice(1),x[ne]=ve(L.dataset[H])}return x},getDataAttribute:(L,x)=>ve(L.getAttribute(`data-bs-${ge(x)}`))};class He{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(x){return x=this._mergeConfigObj(x),x=this._configAfterMerge(x),this._typeCheckConfig(x),x}_configAfterMerge(x){return x}_mergeConfigObj(x,S){const H=c(S)?Ce.getDataAttribute(S,"config"):{};return{...this.constructor.Default,...typeof H=="object"?H:{},...c(S)?Ce.getDataAttributes(S):{},...typeof x=="object"?x:{}}}_typeCheckConfig(x,S=this.constructor.DefaultType){for(const[ne,ae]of Object.entries(S)){const Ae=x[ne],Ne=c(Ae)?"element":(H=Ae)==null?`${H}`:Object.prototype.toString.call(H).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(ae).test(Ne))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${ne}" provided type "${Ne}" but expected type "${ae}".`)}var H}}class Ie extends He{constructor(x,S){super(),(x=f(x))&&(this._element=x,this._config=this._getConfig(S),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),P.off(this._element,this.constructor.EVENT_KEY);for(const x of Object.getOwnPropertyNames(this))this[x]=null}_queueCallback(x,S,H=!0){T(x,S,H)}_getConfig(x){return x=this._mergeConfigObj(x,this._element),x=this._configAfterMerge(x),this._typeCheckConfig(x),x}static getInstance(x){return r.get(f(x),this.DATA_KEY)}static getOrCreateInstance(x,S={}){return this.getInstance(x)||new this(x,typeof S=="object"?S:null)}static get VERSION(){return"5.3.7"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(x){return`${x}${this.EVENT_KEY}`}}const Ge=L=>{let x=L.getAttribute("data-bs-target");if(!x||x==="#"){let S=L.getAttribute("href");if(!S||!S.includes("#")&&!S.startsWith("."))return null;S.includes("#")&&!S.startsWith("#")&&(S=`#${S.split("#")[1]}`),x=S&&S!=="#"?S.trim():null}return x?x.split(",").map(S=>a(S)).join(","):null},k={find:(L,x=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(x,L)),findOne:(L,x=document.documentElement)=>Element.prototype.querySelector.call(x,L),children:(L,x)=>[].concat(...L.children).filter(S=>S.matches(x)),parents(L,x){const S=[];let H=L.parentNode.closest(x);for(;H;)S.push(H),H=H.parentNode.closest(x);return S},prev(L,x){let S=L.previousElementSibling;for(;S;){if(S.matches(x))return[S];S=S.previousElementSibling}return[]},next(L,x){let S=L.nextElementSibling;for(;S;){if(S.matches(x))return[S];S=S.nextElementSibling}return[]},focusableChildren(L){const x=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(S=>`${S}:not([tabindex^="-"])`).join(",");return this.find(x,L).filter(S=>!d(S)&&h(S))},getSelectorFromElement(L){const x=Ge(L);return x&&k.findOne(x)?x:null},getElementFromSelector(L){const x=Ge(L);return x?k.findOne(x):null},getMultipleElementsFromSelector(L){const x=Ge(L);return x?k.find(x):[]}},se=(L,x="hide")=>{const S=`click.dismiss${L.EVENT_KEY}`,H=L.NAME;P.on(document,S,`[data-bs-dismiss="${H}"]`,function(ne){if(["A","AREA"].includes(this.tagName)&&ne.preventDefault(),d(this))return;const ae=k.getElementFromSelector(this)||this.closest(`.${H}`);L.getOrCreateInstance(ae)[x]()})},Z=".bs.alert",J=`close${Z}`,xe=`closed${Z}`;class be extends Ie{static get NAME(){return"alert"}close(){if(P.trigger(this._element,J).defaultPrevented)return;this._element.classList.remove("show");const x=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,x)}_destroyElement(){this._element.remove(),P.trigger(this._element,xe),this.dispose()}static jQueryInterface(x){return this.each(function(){const S=be.getOrCreateInstance(this);if(typeof x=="string"){if(S[x]===void 0||x.startsWith("_")||x==="constructor")throw new TypeError(`No method named "${x}"`);S[x](this)}})}}se(be,"close"),w(be);const Se='[data-bs-toggle="button"]';class Ye extends Ie{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(x){return this.each(function(){const S=Ye.getOrCreateInstance(this);x==="toggle"&&S[x]()})}}P.on(document,"click.bs.button.data-api",Se,L=>{L.preventDefault();const x=L.target.closest(Se);Ye.getOrCreateInstance(x).toggle()}),w(Ye);const De=".bs.swipe",nt=`touchstart${De}`,rt=`touchmove${De}`,ht=`touchend${De}`,Rt=`pointerdown${De}`,kt=`pointerup${De}`,nn={endCallback:null,leftCallback:null,rightCallback:null},Qe={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Ct extends He{constructor(x,S){super(),this._element=x,x&&Ct.isSupported()&&(this._config=this._getConfig(S),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return nn}static get DefaultType(){return Qe}static get NAME(){return"swipe"}dispose(){P.off(this._element,De)}_start(x){this._supportPointerEvents?this._eventIsPointerPenTouch(x)&&(this._deltaX=x.clientX):this._deltaX=x.touches[0].clientX}_end(x){this._eventIsPointerPenTouch(x)&&(this._deltaX=x.clientX-this._deltaX),this._handleSwipe(),C(this._config.endCallback)}_move(x){this._deltaX=x.touches&&x.touches.length>1?0:x.touches[0].clientX-this._deltaX}_handleSwipe(){const x=Math.abs(this._deltaX);if(x<=40)return;const S=x/this._deltaX;this._deltaX=0,S&&C(S>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(P.on(this._element,Rt,x=>this._start(x)),P.on(this._element,kt,x=>this._end(x)),this._element.classList.add("pointer-event")):(P.on(this._element,nt,x=>this._start(x)),P.on(this._element,rt,x=>this._move(x)),P.on(this._element,ht,x=>this._end(x)))}_eventIsPointerPenTouch(x){return this._supportPointerEvents&&(x.pointerType==="pen"||x.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const je=".bs.carousel",Tn=".data-api",zt="ArrowLeft",It="ArrowRight",on="next",Kn="prev",Ht="left",Bn="right",Ei=`slide${je}`,Hi=`slid${je}`,cr=`keydown${je}`,Ai=`mouseenter${je}`,fs=`mouseleave${je}`,Bc=`dragstart${je}`,Rl=`load${je}${Tn}`,Nl=`click${je}${Tn}`,Lo="carousel",hs="active",Ua=".active",Ll=".carousel-item",Uc=Ua+Ll,Ml={[zt]:Bn,[It]:Ht},Il={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Hc={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class na extends Ie{constructor(x,S){super(x,S),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=k.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Lo&&this.cycle()}static get Default(){return Il}static get DefaultType(){return Hc}static get NAME(){return"carousel"}next(){this._slide(on)}nextWhenVisible(){!document.hidden&&h(this._element)&&this.next()}prev(){this._slide(Kn)}pause(){this._isSliding&&o(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?P.one(this._element,Hi,()=>this.cycle()):this.cycle())}to(x){const S=this._getItems();if(x>S.length-1||x<0)return;if(this._isSliding)return void P.one(this._element,Hi,()=>this.to(x));const H=this._getItemIndex(this._getActive());if(H===x)return;const ne=x>H?on:Kn;this._slide(ne,S[x])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(x){return x.defaultInterval=x.interval,x}_addEventListeners(){this._config.keyboard&&P.on(this._element,cr,x=>this._keydown(x)),this._config.pause==="hover"&&(P.on(this._element,Ai,()=>this.pause()),P.on(this._element,fs,()=>this._maybeEnableCycle())),this._config.touch&&Ct.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const S of k.find(".carousel-item img",this._element))P.on(S,Bc,H=>H.preventDefault());const x={leftCallback:()=>this._slide(this._directionToOrder(Ht)),rightCallback:()=>this._slide(this._directionToOrder(Bn)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new Ct(this._element,x)}_keydown(x){if(/input|textarea/i.test(x.target.tagName))return;const S=Ml[x.key];S&&(x.preventDefault(),this._slide(this._directionToOrder(S)))}_getItemIndex(x){return this._getItems().indexOf(x)}_setActiveIndicatorElement(x){if(!this._indicatorsElement)return;const S=k.findOne(Ua,this._indicatorsElement);S.classList.remove(hs),S.removeAttribute("aria-current");const H=k.findOne(`[data-bs-slide-to="${x}"]`,this._indicatorsElement);H&&(H.classList.add(hs),H.setAttribute("aria-current","true"))}_updateInterval(){const x=this._activeElement||this._getActive();if(!x)return;const S=Number.parseInt(x.getAttribute("data-bs-interval"),10);this._config.interval=S||this._config.defaultInterval}_slide(x,S=null){if(this._isSliding)return;const H=this._getActive(),ne=x===on,ae=S||R(this._getItems(),H,ne,this._config.wrap);if(ae===H)return;const Ae=this._getItemIndex(ae),Ne=Je=>P.trigger(this._element,Je,{relatedTarget:ae,direction:this._orderToDirection(x),from:this._getItemIndex(H),to:Ae});if(Ne(Ei).defaultPrevented||!H||!ae)return;const We=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(Ae),this._activeElement=ae;const tt=ne?"carousel-item-start":"carousel-item-end",it=ne?"carousel-item-next":"carousel-item-prev";ae.classList.add(it),v(ae),H.classList.add(tt),ae.classList.add(tt),this._queueCallback(()=>{ae.classList.remove(tt,it),ae.classList.add(hs),H.classList.remove(hs,it,tt),this._isSliding=!1,Ne(Hi)},H,this._isAnimated()),We&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return k.findOne(Uc,this._element)}_getItems(){return k.find(Ll,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(x){return A()?x===Ht?Kn:on:x===Ht?on:Kn}_orderToDirection(x){return A()?x===Kn?Ht:Bn:x===Kn?Bn:Ht}static jQueryInterface(x){return this.each(function(){const S=na.getOrCreateInstance(this,x);if(typeof x!="number"){if(typeof x=="string"){if(S[x]===void 0||x.startsWith("_")||x==="constructor")throw new TypeError(`No method named "${x}"`);S[x]()}}else S.to(x)})}}P.on(document,Nl,"[data-bs-slide], [data-bs-slide-to]",function(L){const x=k.getElementFromSelector(this);if(!x||!x.classList.contains(Lo))return;L.preventDefault();const S=na.getOrCreateInstance(x),H=this.getAttribute("data-bs-slide-to");return H?(S.to(H),void S._maybeEnableCycle()):Ce.getDataAttribute(this,"slide")==="next"?(S.next(),void S._maybeEnableCycle()):(S.prev(),void S._maybeEnableCycle())}),P.on(window,Rl,()=>{const L=k.find('[data-bs-ride="carousel"]');for(const x of L)na.getOrCreateInstance(x)}),w(na);const Br=".bs.collapse",Qn=`show${Br}`,Zn=`shown${Br}`,ra=`hide${Br}`,kl=`hidden${Br}`,Ef=`click${Br}.data-api`,M="show",V="collapse",z="collapsing",j=`:scope .${V} .${V}`,G='[data-bs-toggle="collapse"]',X={parent:null,toggle:!0},he={parent:"(null|element)",toggle:"boolean"};class Ee extends Ie{constructor(x,S){super(x,S),this._isTransitioning=!1,this._triggerArray=[];const H=k.find(G);for(const ne of H){const ae=k.getSelectorFromElement(ne),Ae=k.find(ae).filter(Ne=>Ne===this._element);ae!==null&&Ae.length&&this._triggerArray.push(ne)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return X}static get DefaultType(){return he}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let x=[];if(this._config.parent&&(x=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(ne=>ne!==this._element).map(ne=>Ee.getOrCreateInstance(ne,{toggle:!1}))),x.length&&x[0]._isTransitioning||P.trigger(this._element,Qn).defaultPrevented)return;for(const ne of x)ne.hide();const S=this._getDimension();this._element.classList.remove(V),this._element.classList.add(z),this._element.style[S]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const H=`scroll${S[0].toUpperCase()+S.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(z),this._element.classList.add(V,M),this._element.style[S]="",P.trigger(this._element,Zn)},this._element,!0),this._element.style[S]=`${this._element[H]}px`}hide(){if(this._isTransitioning||!this._isShown()||P.trigger(this._element,ra).defaultPrevented)return;const x=this._getDimension();this._element.style[x]=`${this._element.getBoundingClientRect()[x]}px`,v(this._element),this._element.classList.add(z),this._element.classList.remove(V,M);for(const S of this._triggerArray){const H=k.getElementFromSelector(S);H&&!this._isShown(H)&&this._addAriaAndCollapsedClass([S],!1)}this._isTransitioning=!0,this._element.style[x]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(z),this._element.classList.add(V),P.trigger(this._element,kl)},this._element,!0)}_isShown(x=this._element){return x.classList.contains(M)}_configAfterMerge(x){return x.toggle=!!x.toggle,x.parent=f(x.parent),x}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const x=this._getFirstLevelChildren(G);for(const S of x){const H=k.getElementFromSelector(S);H&&this._addAriaAndCollapsedClass([S],this._isShown(H))}}_getFirstLevelChildren(x){const S=k.find(j,this._config.parent);return k.find(x,this._config.parent).filter(H=>!S.includes(H))}_addAriaAndCollapsedClass(x,S){if(x.length)for(const H of x)H.classList.toggle("collapsed",!S),H.setAttribute("aria-expanded",S)}static jQueryInterface(x){const S={};return typeof x=="string"&&/show|hide/.test(x)&&(S.toggle=!1),this.each(function(){const H=Ee.getOrCreateInstance(this,S);if(typeof x=="string"){if(H[x]===void 0)throw new TypeError(`No method named "${x}"`);H[x]()}})}}P.on(document,Ef,G,function(L){(L.target.tagName==="A"||L.delegateTarget&&L.delegateTarget.tagName==="A")&&L.preventDefault();for(const x of k.getMultipleElementsFromSelector(this))Ee.getOrCreateInstance(x,{toggle:!1}).toggle()}),w(Ee);var ie="top",ce="bottom",ue="right",Re="left",$e="auto",Ze=[ie,ce,ue,Re],Ue="start",Ve="end",St="clippingParents",Jt="viewport",Xt="popper",cn="reference",zi=Ze.reduce(function(L,x){return L.concat([x+"-"+Ue,x+"-"+Ve])},[]),ds=[].concat(Ze,[$e]).reduce(function(L,x){return L.concat([x,x+"-"+Ue,x+"-"+Ve])},[]),ni="beforeRead",wi="read",ia="afterRead",Si="beforeMain",Af="main",ri="afterMain",wf="beforeWrite",n0="write",Fl="afterWrite",Sf=[ni,wi,ia,Si,Af,ri,wf,n0,Fl];function ii(L){return L?(L.nodeName||"").toLowerCase():null}function si(L){if(L==null)return window;if(L.toString()!=="[object Window]"){var x=L.ownerDocument;return x&&x.defaultView||window}return L}function Jn(L){return L instanceof si(L).Element||L instanceof Element}function Ur(L){return L instanceof si(L).HTMLElement||L instanceof HTMLElement}function zc(L){return typeof ShadowRoot<"u"&&(L instanceof si(L).ShadowRoot||L instanceof ShadowRoot)}const Pl={name:"applyStyles",enabled:!0,phase:"write",fn:function(L){var x=L.state;Object.keys(x.elements).forEach(function(S){var H=x.styles[S]||{},ne=x.attributes[S]||{},ae=x.elements[S];Ur(ae)&&ii(ae)&&(Object.assign(ae.style,H),Object.keys(ne).forEach(function(Ae){var Ne=ne[Ae];Ne===!1?ae.removeAttribute(Ae):ae.setAttribute(Ae,Ne===!0?"":Ne)}))})},effect:function(L){var x=L.state,S={popper:{position:x.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(x.elements.popper.style,S.popper),x.styles=S,x.elements.arrow&&Object.assign(x.elements.arrow.style,S.arrow),function(){Object.keys(x.elements).forEach(function(H){var ne=x.elements[H],ae=x.attributes[H]||{},Ae=Object.keys(x.styles.hasOwnProperty(H)?x.styles[H]:S[H]).reduce(function(Ne,We){return Ne[We]="",Ne},{});Ur(ne)&&ii(ne)&&(Object.assign(ne.style,Ae),Object.keys(ae).forEach(function(Ne){ne.removeAttribute(Ne)}))})}},requires:["computeStyles"]};function Tr(L){return L.split("-")[0]}var sa=Math.max,Bl=Math.min,ji=Math.round;function Tf(){var L=navigator.userAgentData;return L!=null&&L.brands&&Array.isArray(L.brands)?L.brands.map(function(x){return x.brand+"/"+x.version}).join(" "):navigator.userAgent}function Cf(){return!/^((?!chrome|android).)*safari/i.test(Tf())}function Ha(L,x,S){x===void 0&&(x=!1),S===void 0&&(S=!1);var H=L.getBoundingClientRect(),ne=1,ae=1;x&&Ur(L)&&(ne=L.offsetWidth>0&&ji(H.width)/L.offsetWidth||1,ae=L.offsetHeight>0&&ji(H.height)/L.offsetHeight||1);var Ae=(Jn(L)?si(L):window).visualViewport,Ne=!Cf()&&S,We=(H.left+(Ne&&Ae?Ae.offsetLeft:0))/ne,tt=(H.top+(Ne&&Ae?Ae.offsetTop:0))/ae,it=H.width/ne,Je=H.height/ae;return{width:it,height:Je,top:tt,right:We+it,bottom:tt+Je,left:We,x:We,y:tt}}function Ul(L){var x=Ha(L),S=L.offsetWidth,H=L.offsetHeight;return Math.abs(x.width-S)<=1&&(S=x.width),Math.abs(x.height-H)<=1&&(H=x.height),{x:L.offsetLeft,y:L.offsetTop,width:S,height:H}}function r0(L,x){var S=x.getRootNode&&x.getRootNode();if(L.contains(x))return!0;if(S&&zc(S)){var H=x;do{if(H&&L.isSameNode(H))return!0;H=H.parentNode||H.host}while(H)}return!1}function Bs(L){return si(L).getComputedStyle(L)}function jc(L){return["table","td","th"].indexOf(ii(L))>=0}function ps(L){return((Jn(L)?L.ownerDocument:L.document)||window.document).documentElement}function Mo(L){return ii(L)==="html"?L:L.assignedSlot||L.parentNode||(zc(L)?L.host:null)||ps(L)}function za(L){return Ur(L)&&Bs(L).position!=="fixed"?L.offsetParent:null}function gs(L){for(var x=si(L),S=za(L);S&&jc(S)&&Bs(S).position==="static";)S=za(S);return S&&(ii(S)==="html"||ii(S)==="body"&&Bs(S).position==="static")?x:S||function(H){var ne=/firefox/i.test(Tf());if(/Trident/i.test(Tf())&&Ur(H)&&Bs(H).position==="fixed")return null;var ae=Mo(H);for(zc(ae)&&(ae=ae.host);Ur(ae)&&["html","body"].indexOf(ii(ae))<0;){var Ae=Bs(ae);if(Ae.transform!=="none"||Ae.perspective!=="none"||Ae.contain==="paint"||["transform","perspective"].indexOf(Ae.willChange)!==-1||ne&&Ae.willChange==="filter"||ne&&Ae.filter&&Ae.filter!=="none")return ae;ae=ae.parentNode}return null}(L)||x}function $c(L){return["top","bottom"].indexOf(L)>=0?"x":"y"}function ja(L,x,S){return sa(L,Bl(x,S))}function Df(L){return Object.assign({},{top:0,right:0,bottom:0,left:0},L)}function Io(L,x){return x.reduce(function(S,H){return S[H]=L,S},{})}const ms={name:"arrow",enabled:!0,phase:"main",fn:function(L){var x,S=L.state,H=L.name,ne=L.options,ae=S.elements.arrow,Ae=S.modifiersData.popperOffsets,Ne=Tr(S.placement),We=$c(Ne),tt=[Re,ue].indexOf(Ne)>=0?"height":"width";if(ae&&Ae){var it=function(wt,qt){return Df(typeof(wt=typeof wt=="function"?wt(Object.assign({},qt.rects,{placement:qt.placement})):wt)!="number"?wt:Io(wt,Ze))}(ne.padding,S),Je=Ul(ae),Dt=We==="y"?ie:Re,pt=We==="y"?ce:ue,Ot=S.rects.reference[tt]+S.rects.reference[We]-Ae[We]-S.rects.popper[tt],Et=Ae[We]-S.rects.reference[We],_t=gs(ae),tn=_t?We==="y"?_t.clientHeight||0:_t.clientWidth||0:0,un=Ot/2-Et/2,Ft=it[Dt],Yt=tn-Je[tt]-it[pt],At=tn/2-Je[tt]/2+un,et=ja(Ft,At,Yt),ct=We;S.modifiersData[H]=((x={})[ct]=et,x.centerOffset=et-At,x)}},effect:function(L){var x=L.state,S=L.options.element,H=S===void 0?"[data-popper-arrow]":S;H!=null&&(typeof H!="string"||(H=x.elements.popper.querySelector(H)))&&r0(x.elements.popper,H)&&(x.elements.arrow=H)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function aa(L){return L.split("-")[1]}var Hl={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Us(L){var x,S=L.popper,H=L.popperRect,ne=L.placement,ae=L.variation,Ae=L.offsets,Ne=L.position,We=L.gpuAcceleration,tt=L.adaptive,it=L.roundOffsets,Je=L.isFixed,Dt=Ae.x,pt=Dt===void 0?0:Dt,Ot=Ae.y,Et=Ot===void 0?0:Ot,_t=typeof it=="function"?it({x:pt,y:Et}):{x:pt,y:Et};pt=_t.x,Et=_t.y;var tn=Ae.hasOwnProperty("x"),un=Ae.hasOwnProperty("y"),Ft=Re,Yt=ie,At=window;if(tt){var et=gs(S),ct="clientHeight",wt="clientWidth";et===si(S)&&Bs(et=ps(S)).position!=="static"&&Ne==="absolute"&&(ct="scrollHeight",wt="scrollWidth"),(ne===ie||(ne===Re||ne===ue)&&ae===Ve)&&(Yt=ce,Et-=(Je&&et===At&&At.visualViewport?At.visualViewport.height:et[ct])-H.height,Et*=We?1:-1),ne!==Re&&(ne!==ie&&ne!==ce||ae!==Ve)||(Ft=ue,pt-=(Je&&et===At&&At.visualViewport?At.visualViewport.width:et[wt])-H.width,pt*=We?1:-1)}var qt,mn=Object.assign({position:Ne},tt&&Hl),zn=it===!0?function($r,jn){var fr=$r.x,Oi=$r.y,Lt=jn.devicePixelRatio||1;return{x:ji(fr*Lt)/Lt||0,y:ji(Oi*Lt)/Lt||0}}({x:pt,y:Et},si(S)):{x:pt,y:Et};return pt=zn.x,Et=zn.y,We?Object.assign({},mn,((qt={})[Yt]=un?"0":"",qt[Ft]=tn?"0":"",qt.transform=(At.devicePixelRatio||1)<=1?"translate("+pt+"px, "+Et+"px)":"translate3d("+pt+"px, "+Et+"px, 0)",qt)):Object.assign({},mn,((x={})[Yt]=un?Et+"px":"",x[Ft]=tn?pt+"px":"",x.transform="",x))}const zl={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(L){var x=L.state,S=L.options,H=S.gpuAcceleration,ne=H===void 0||H,ae=S.adaptive,Ae=ae===void 0||ae,Ne=S.roundOffsets,We=Ne===void 0||Ne,tt={placement:Tr(x.placement),variation:aa(x.placement),popper:x.elements.popper,popperRect:x.rects.popper,gpuAcceleration:ne,isFixed:x.options.strategy==="fixed"};x.modifiersData.popperOffsets!=null&&(x.styles.popper=Object.assign({},x.styles.popper,Us(Object.assign({},tt,{offsets:x.modifiersData.popperOffsets,position:x.options.strategy,adaptive:Ae,roundOffsets:We})))),x.modifiersData.arrow!=null&&(x.styles.arrow=Object.assign({},x.styles.arrow,Us(Object.assign({},tt,{offsets:x.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:We})))),x.attributes.popper=Object.assign({},x.attributes.popper,{"data-popper-placement":x.placement})},data:{}};var $a={passive:!0};const Gc={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(L){var x=L.state,S=L.instance,H=L.options,ne=H.scroll,ae=ne===void 0||ne,Ae=H.resize,Ne=Ae===void 0||Ae,We=si(x.elements.popper),tt=[].concat(x.scrollParents.reference,x.scrollParents.popper);return ae&&tt.forEach(function(it){it.addEventListener("scroll",S.update,$a)}),Ne&&We.addEventListener("resize",S.update,$a),function(){ae&&tt.forEach(function(it){it.removeEventListener("scroll",S.update,$a)}),Ne&&We.removeEventListener("resize",S.update,$a)}},data:{}};var Vc={left:"right",right:"left",bottom:"top",top:"bottom"};function Ga(L){return L.replace(/left|right|bottom|top/g,function(x){return Vc[x]})}var i0={start:"end",end:"start"};function Cr(L){return L.replace(/start|end/g,function(x){return i0[x]})}function Hs(L){var x=si(L);return{scrollLeft:x.pageXOffset,scrollTop:x.pageYOffset}}function ko(L){return Ha(ps(L)).left+Hs(L).scrollLeft}function Va(L){var x=Bs(L),S=x.overflow,H=x.overflowX,ne=x.overflowY;return/auto|scroll|overlay|hidden/.test(S+ne+H)}function s0(L){return["html","body","#document"].indexOf(ii(L))>=0?L.ownerDocument.body:Ur(L)&&Va(L)?L:s0(Mo(L))}function Wa(L,x){var S;x===void 0&&(x=[]);var H=s0(L),ne=H===((S=L.ownerDocument)==null?void 0:S.body),ae=si(H),Ae=ne?[ae].concat(ae.visualViewport||[],Va(H)?H:[]):H,Ne=x.concat(Ae);return ne?Ne:Ne.concat(Wa(Mo(Ae)))}function jl(L){return Object.assign({},L,{left:L.x,top:L.y,right:L.x+L.width,bottom:L.y+L.height})}function Fo(L,x,S){return x===Jt?jl(function(H,ne){var ae=si(H),Ae=ps(H),Ne=ae.visualViewport,We=Ae.clientWidth,tt=Ae.clientHeight,it=0,Je=0;if(Ne){We=Ne.width,tt=Ne.height;var Dt=Cf();(Dt||!Dt&&ne==="fixed")&&(it=Ne.offsetLeft,Je=Ne.offsetTop)}return{width:We,height:tt,x:it+ko(H),y:Je}}(L,S)):Jn(x)?function(H,ne){var ae=Ha(H,!1,ne==="fixed");return ae.top=ae.top+H.clientTop,ae.left=ae.left+H.clientLeft,ae.bottom=ae.top+H.clientHeight,ae.right=ae.left+H.clientWidth,ae.width=H.clientWidth,ae.height=H.clientHeight,ae.x=ae.left,ae.y=ae.top,ae}(x,S):jl(function(H){var ne,ae=ps(H),Ae=Hs(H),Ne=(ne=H.ownerDocument)==null?void 0:ne.body,We=sa(ae.scrollWidth,ae.clientWidth,Ne?Ne.scrollWidth:0,Ne?Ne.clientWidth:0),tt=sa(ae.scrollHeight,ae.clientHeight,Ne?Ne.scrollHeight:0,Ne?Ne.clientHeight:0),it=-Ae.scrollLeft+ko(H),Je=-Ae.scrollTop;return Bs(Ne||ae).direction==="rtl"&&(it+=sa(ae.clientWidth,Ne?Ne.clientWidth:0)-We),{width:We,height:tt,x:it,y:Je}}(ps(L)))}function $l(L){var x,S=L.reference,H=L.element,ne=L.placement,ae=ne?Tr(ne):null,Ae=ne?aa(ne):null,Ne=S.x+S.width/2-H.width/2,We=S.y+S.height/2-H.height/2;switch(ae){case ie:x={x:Ne,y:S.y-H.height};break;case ce:x={x:Ne,y:S.y+S.height};break;case ue:x={x:S.x+S.width,y:We};break;case Re:x={x:S.x-H.width,y:We};break;default:x={x:S.x,y:S.y}}var tt=ae?$c(ae):null;if(tt!=null){var it=tt==="y"?"height":"width";switch(Ae){case Ue:x[tt]=x[tt]-(S[it]/2-H[it]/2);break;case Ve:x[tt]=x[tt]+(S[it]/2-H[it]/2)}}return x}function Xa(L,x){x===void 0&&(x={});var S=x,H=S.placement,ne=H===void 0?L.placement:H,ae=S.strategy,Ae=ae===void 0?L.strategy:ae,Ne=S.boundary,We=Ne===void 0?St:Ne,tt=S.rootBoundary,it=tt===void 0?Jt:tt,Je=S.elementContext,Dt=Je===void 0?Xt:Je,pt=S.altBoundary,Ot=pt!==void 0&&pt,Et=S.padding,_t=Et===void 0?0:Et,tn=Df(typeof _t!="number"?_t:Io(_t,Ze)),un=Dt===Xt?cn:Xt,Ft=L.rects.popper,Yt=L.elements[Ot?un:Dt],At=function(jn,fr,Oi,Lt){var Ri=fr==="clippingParents"?function(fn){var hr=Wa(Mo(fn)),Gr=["absolute","fixed"].indexOf(Bs(fn).position)>=0&&Ur(fn)?gs(fn):fn;return Jn(Gr)?hr.filter(function(ys){return Jn(ys)&&r0(ys,Gr)&&ii(ys)!=="body"}):[]}(jn):[].concat(fr),Ni=[].concat(Ri,[Oi]),lo=Ni[0],$n=Ni.reduce(function(fn,hr){var Gr=Fo(jn,hr,Lt);return fn.top=sa(Gr.top,fn.top),fn.right=Bl(Gr.right,fn.right),fn.bottom=Bl(Gr.bottom,fn.bottom),fn.left=sa(Gr.left,fn.left),fn},Fo(jn,lo,Lt));return $n.width=$n.right-$n.left,$n.height=$n.bottom-$n.top,$n.x=$n.left,$n.y=$n.top,$n}(Jn(Yt)?Yt:Yt.contextElement||ps(L.elements.popper),We,it,Ae),et=Ha(L.elements.reference),ct=$l({reference:et,element:Ft,placement:ne}),wt=jl(Object.assign({},Ft,ct)),qt=Dt===Xt?wt:et,mn={top:At.top-qt.top+tn.top,bottom:qt.bottom-At.bottom+tn.bottom,left:At.left-qt.left+tn.left,right:qt.right-At.right+tn.right},zn=L.modifiersData.offset;if(Dt===Xt&&zn){var $r=zn[ne];Object.keys(mn).forEach(function(jn){var fr=[ue,ce].indexOf(jn)>=0?1:-1,Oi=[ie,ce].indexOf(jn)>=0?"y":"x";mn[jn]+=$r[Oi]*fr})}return mn}function Lm(L,x){x===void 0&&(x={});var S=x,H=S.placement,ne=S.boundary,ae=S.rootBoundary,Ae=S.padding,Ne=S.flipVariations,We=S.allowedAutoPlacements,tt=We===void 0?ds:We,it=aa(H),Je=it?Ne?zi:zi.filter(function(Ot){return aa(Ot)===it}):Ze,Dt=Je.filter(function(Ot){return tt.indexOf(Ot)>=0});Dt.length===0&&(Dt=Je);var pt=Dt.reduce(function(Ot,Et){return Ot[Et]=Xa(L,{placement:Et,boundary:ne,rootBoundary:ae,padding:Ae})[Tr(Et)],Ot},{});return Object.keys(pt).sort(function(Ot,Et){return pt[Ot]-pt[Et]})}const a0={name:"flip",enabled:!0,phase:"main",fn:function(L){var x=L.state,S=L.options,H=L.name;if(!x.modifiersData[H]._skip){for(var ne=S.mainAxis,ae=ne===void 0||ne,Ae=S.altAxis,Ne=Ae===void 0||Ae,We=S.fallbackPlacements,tt=S.padding,it=S.boundary,Je=S.rootBoundary,Dt=S.altBoundary,pt=S.flipVariations,Ot=pt===void 0||pt,Et=S.allowedAutoPlacements,_t=x.options.placement,tn=Tr(_t),un=We||(tn!==_t&&Ot?function(fn){if(Tr(fn)===$e)return[];var hr=Ga(fn);return[Cr(fn),hr,Cr(hr)]}(_t):[Ga(_t)]),Ft=[_t].concat(un).reduce(function(fn,hr){return fn.concat(Tr(hr)===$e?Lm(x,{placement:hr,boundary:it,rootBoundary:Je,padding:tt,flipVariations:Ot,allowedAutoPlacements:Et}):hr)},[]),Yt=x.rects.reference,At=x.rects.popper,et=new Map,ct=!0,wt=Ft[0],qt=0;qt<Ft.length;qt++){var mn=Ft[qt],zn=Tr(mn),$r=aa(mn)===Ue,jn=[ie,ce].indexOf(zn)>=0,fr=jn?"width":"height",Oi=Xa(x,{placement:mn,boundary:it,rootBoundary:Je,altBoundary:Dt,padding:tt}),Lt=jn?$r?ue:Re:$r?ce:ie;Yt[fr]>At[fr]&&(Lt=Ga(Lt));var Ri=Ga(Lt),Ni=[];if(ae&&Ni.push(Oi[zn]<=0),Ne&&Ni.push(Oi[Lt]<=0,Oi[Ri]<=0),Ni.every(function(fn){return fn})){wt=mn,ct=!1;break}et.set(mn,Ni)}if(ct)for(var lo=function(fn){var hr=Ft.find(function(Gr){var ys=et.get(Gr);if(ys)return ys.slice(0,fn).every(function(dr){return dr})});if(hr)return wt=hr,"break"},$n=Ot?3:1;$n>0&&lo($n)!=="break";$n--);x.placement!==wt&&(x.modifiersData[H]._skip=!0,x.placement=wt,x.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function o0(L,x,S){return S===void 0&&(S={x:0,y:0}),{top:L.top-x.height-S.y,right:L.right-x.width+S.x,bottom:L.bottom-x.height+S.y,left:L.left-x.width-S.x}}function Wc(L){return[ie,ue,ce,Re].some(function(x){return L[x]>=0})}const l0={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(L){var x=L.state,S=L.name,H=x.rects.reference,ne=x.rects.popper,ae=x.modifiersData.preventOverflow,Ae=Xa(x,{elementContext:"reference"}),Ne=Xa(x,{altBoundary:!0}),We=o0(Ae,H),tt=o0(Ne,ne,ae),it=Wc(We),Je=Wc(tt);x.modifiersData[S]={referenceClippingOffsets:We,popperEscapeOffsets:tt,isReferenceHidden:it,hasPopperEscaped:Je},x.attributes.popper=Object.assign({},x.attributes.popper,{"data-popper-reference-hidden":it,"data-popper-escaped":Je})}},c0={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(L){var x=L.state,S=L.options,H=L.name,ne=S.offset,ae=ne===void 0?[0,0]:ne,Ae=ds.reduce(function(it,Je){return it[Je]=function(Dt,pt,Ot){var Et=Tr(Dt),_t=[Re,ie].indexOf(Et)>=0?-1:1,tn=typeof Ot=="function"?Ot(Object.assign({},pt,{placement:Dt})):Ot,un=tn[0],Ft=tn[1];return un=un||0,Ft=(Ft||0)*_t,[Re,ue].indexOf(Et)>=0?{x:Ft,y:un}:{x:un,y:Ft}}(Je,x.rects,ae),it},{}),Ne=Ae[x.placement],We=Ne.x,tt=Ne.y;x.modifiersData.popperOffsets!=null&&(x.modifiersData.popperOffsets.x+=We,x.modifiersData.popperOffsets.y+=tt),x.modifiersData[H]=Ae}},Of={name:"popperOffsets",enabled:!0,phase:"read",fn:function(L){var x=L.state,S=L.name;x.modifiersData[S]=$l({reference:x.rects.reference,element:x.rects.popper,placement:x.placement})},data:{}},u0={name:"preventOverflow",enabled:!0,phase:"main",fn:function(L){var x=L.state,S=L.options,H=L.name,ne=S.mainAxis,ae=ne===void 0||ne,Ae=S.altAxis,Ne=Ae!==void 0&&Ae,We=S.boundary,tt=S.rootBoundary,it=S.altBoundary,Je=S.padding,Dt=S.tether,pt=Dt===void 0||Dt,Ot=S.tetherOffset,Et=Ot===void 0?0:Ot,_t=Xa(x,{boundary:We,rootBoundary:tt,padding:Je,altBoundary:it}),tn=Tr(x.placement),un=aa(x.placement),Ft=!un,Yt=$c(tn),At=Yt==="x"?"y":"x",et=x.modifiersData.popperOffsets,ct=x.rects.reference,wt=x.rects.popper,qt=typeof Et=="function"?Et(Object.assign({},x.rects,{placement:x.placement})):Et,mn=typeof qt=="number"?{mainAxis:qt,altAxis:qt}:Object.assign({mainAxis:0,altAxis:0},qt),zn=x.modifiersData.offset?x.modifiersData.offset[x.placement]:null,$r={x:0,y:0};if(et){if(ae){var jn,fr=Yt==="y"?ie:Re,Oi=Yt==="y"?ce:ue,Lt=Yt==="y"?"height":"width",Ri=et[Yt],Ni=Ri+_t[fr],lo=Ri-_t[Oi],$n=pt?-wt[Lt]/2:0,fn=un===Ue?ct[Lt]:wt[Lt],hr=un===Ue?-wt[Lt]:-ct[Lt],Gr=x.elements.arrow,ys=pt&&Gr?Ul(Gr):{width:0,height:0},dr=x.modifiersData["arrow#persistent"]?x.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},In=dr[fr],nu=dr[Oi],ga=ja(0,ct[Lt],ys[Lt]),ru=Ft?ct[Lt]/2-$n-ga-In-mn.mainAxis:fn-ga-In-mn.mainAxis,ah=Ft?-ct[Lt]/2+$n+ga+nu+mn.mainAxis:hr+ga+nu+mn.mainAxis,Vi=x.elements.arrow&&gs(x.elements.arrow),iu=Vi?Yt==="y"?Vi.clientTop||0:Vi.clientLeft||0:0,su=(jn=zn?.[Yt])!=null?jn:0,oh=Ri+ah-su,lh=ja(pt?Bl(Ni,Ri+ru-su-iu):Ni,Ri,pt?sa(lo,oh):lo);et[Yt]=lh,$r[Yt]=lh-Ri}if(Ne){var ch,W0=Yt==="x"?ie:Re,X0=Yt==="x"?ce:ue,ma=et[At],Jl=At==="y"?"height":"width",au=ma+_t[W0],uh=ma-_t[X0],fh=[ie,Re].indexOf(tn)!==-1,hh=(ch=zn?.[At])!=null?ch:0,dh=fh?au:ma-ct[Jl]-wt[Jl]-hh+mn.altAxis,ph=fh?ma+ct[Jl]+wt[Jl]-hh-mn.altAxis:uh,ou=pt&&fh?function(Y0,q0,lu){var gh=ja(Y0,q0,lu);return gh>lu?lu:gh}(dh,ma,ph):ja(pt?dh:au,ma,pt?ph:uh);et[At]=ou,$r[At]=ou-ma}x.modifiersData[H]=$r}},requiresIfExists:["offset"]};function Mm(L,x,S){S===void 0&&(S=!1);var H,ne,ae=Ur(x),Ae=Ur(x)&&function(Je){var Dt=Je.getBoundingClientRect(),pt=ji(Dt.width)/Je.offsetWidth||1,Ot=ji(Dt.height)/Je.offsetHeight||1;return pt!==1||Ot!==1}(x),Ne=ps(x),We=Ha(L,Ae,S),tt={scrollLeft:0,scrollTop:0},it={x:0,y:0};return(ae||!ae&&!S)&&((ii(x)!=="body"||Va(Ne))&&(tt=(H=x)!==si(H)&&Ur(H)?{scrollLeft:(ne=H).scrollLeft,scrollTop:ne.scrollTop}:Hs(H)),Ur(x)?((it=Ha(x,!0)).x+=x.clientLeft,it.y+=x.clientTop):Ne&&(it.x=ko(Ne))),{x:We.left+tt.scrollLeft-it.x,y:We.top+tt.scrollTop-it.y,width:We.width,height:We.height}}function f0(L){var x=new Map,S=new Set,H=[];function ne(ae){S.add(ae.name),[].concat(ae.requires||[],ae.requiresIfExists||[]).forEach(function(Ae){if(!S.has(Ae)){var Ne=x.get(Ae);Ne&&ne(Ne)}}),H.push(ae)}return L.forEach(function(ae){x.set(ae.name,ae)}),L.forEach(function(ae){S.has(ae.name)||ne(ae)}),H}var h0={placement:"bottom",modifiers:[],strategy:"absolute"};function d0(){for(var L=arguments.length,x=new Array(L),S=0;S<L;S++)x[S]=arguments[S];return!x.some(function(H){return!(H&&typeof H.getBoundingClientRect=="function")})}function Xc(L){L===void 0&&(L={});var x=L,S=x.defaultModifiers,H=S===void 0?[]:S,ne=x.defaultOptions,ae=ne===void 0?h0:ne;return function(Ae,Ne,We){We===void 0&&(We=ae);var tt,it,Je={placement:"bottom",orderedModifiers:[],options:Object.assign({},h0,ae),modifiersData:{},elements:{reference:Ae,popper:Ne},attributes:{},styles:{}},Dt=[],pt=!1,Ot={state:Je,setOptions:function(_t){var tn=typeof _t=="function"?_t(Je.options):_t;Et(),Je.options=Object.assign({},ae,Je.options,tn),Je.scrollParents={reference:Jn(Ae)?Wa(Ae):Ae.contextElement?Wa(Ae.contextElement):[],popper:Wa(Ne)};var un,Ft,Yt=function(At){var et=f0(At);return Sf.reduce(function(ct,wt){return ct.concat(et.filter(function(qt){return qt.phase===wt}))},[])}((un=[].concat(H,Je.options.modifiers),Ft=un.reduce(function(At,et){var ct=At[et.name];return At[et.name]=ct?Object.assign({},ct,et,{options:Object.assign({},ct.options,et.options),data:Object.assign({},ct.data,et.data)}):et,At},{}),Object.keys(Ft).map(function(At){return Ft[At]})));return Je.orderedModifiers=Yt.filter(function(At){return At.enabled}),Je.orderedModifiers.forEach(function(At){var et=At.name,ct=At.options,wt=ct===void 0?{}:ct,qt=At.effect;if(typeof qt=="function"){var mn=qt({state:Je,name:et,instance:Ot,options:wt});Dt.push(mn||function(){})}}),Ot.update()},forceUpdate:function(){if(!pt){var _t=Je.elements,tn=_t.reference,un=_t.popper;if(d0(tn,un)){Je.rects={reference:Mm(tn,gs(un),Je.options.strategy==="fixed"),popper:Ul(un)},Je.reset=!1,Je.placement=Je.options.placement,Je.orderedModifiers.forEach(function(qt){return Je.modifiersData[qt.name]=Object.assign({},qt.data)});for(var Ft=0;Ft<Je.orderedModifiers.length;Ft++)if(Je.reset!==!0){var Yt=Je.orderedModifiers[Ft],At=Yt.fn,et=Yt.options,ct=et===void 0?{}:et,wt=Yt.name;typeof At=="function"&&(Je=At({state:Je,options:ct,name:wt,instance:Ot})||Je)}else Je.reset=!1,Ft=-1}}},update:(tt=function(){return new Promise(function(_t){Ot.forceUpdate(),_t(Je)})},function(){return it||(it=new Promise(function(_t){Promise.resolve().then(function(){it=void 0,_t(tt())})})),it}),destroy:function(){Et(),pt=!0}};if(!d0(Ae,Ne))return Ot;function Et(){Dt.forEach(function(_t){return _t()}),Dt=[]}return Ot.setOptions(We).then(function(_t){!pt&&We.onFirstUpdate&&We.onFirstUpdate(_t)}),Ot}}var Im=Xc(),Rf=Xc({defaultModifiers:[Gc,Of,zl,Pl]}),Nf=Xc({defaultModifiers:[Gc,Of,zl,Pl,c0,a0,u0,ms,l0]});const p0=Object.freeze(Object.defineProperty({__proto__:null,afterMain:ri,afterRead:ia,afterWrite:Fl,applyStyles:Pl,arrow:ms,auto:$e,basePlacements:Ze,beforeMain:Si,beforeRead:ni,beforeWrite:wf,bottom:ce,clippingParents:St,computeStyles:zl,createPopper:Nf,createPopperBase:Im,createPopperLite:Rf,detectOverflow:Xa,end:Ve,eventListeners:Gc,flip:a0,hide:l0,left:Re,main:Af,modifierPhases:Sf,offset:c0,placements:ds,popper:Xt,popperGenerator:Xc,popperOffsets:Of,preventOverflow:u0,read:wi,reference:cn,right:ue,start:Ue,top:ie,variationPlacements:zi,viewport:Jt,write:n0},Symbol.toStringTag,{value:"Module"})),g0="dropdown",oa=".bs.dropdown",Lf=".data-api",km="ArrowUp",m0="ArrowDown",Fm=`hide${oa}`,Pm=`hidden${oa}`,Bm=`show${oa}`,Um=`shown${oa}`,v0=`click${oa}${Lf}`,_0=`keydown${oa}${Lf}`,Mf=`keyup${oa}${Lf}`,vs="show",Ya='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',x0=`${Ya}.${vs}`,Gl=".dropdown-menu",y0=A()?"top-end":"top-start",b0=A()?"top-start":"top-end",E0=A()?"bottom-end":"bottom-start",Po=A()?"bottom-start":"bottom-end",Hm=A()?"left-start":"right-start",zm=A()?"right-start":"left-start",jm={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},A0={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ti extends Ie{constructor(x,S){super(x,S),this._popper=null,this._parent=this._element.parentNode,this._menu=k.next(this._element,Gl)[0]||k.prev(this._element,Gl)[0]||k.findOne(Gl,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return jm}static get DefaultType(){return A0}static get NAME(){return g0}toggle(){return this._isShown()?this.hide():this.show()}show(){if(d(this._element)||this._isShown())return;const x={relatedTarget:this._element};if(!P.trigger(this._element,Bm,x).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const S of[].concat(...document.body.children))P.on(S,"mouseover",m);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(vs),this._element.classList.add(vs),P.trigger(this._element,Um,x)}}hide(){if(d(this._element)||!this._isShown())return;const x={relatedTarget:this._element};this._completeHide(x)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(x){if(!P.trigger(this._element,Fm,x).defaultPrevented){if("ontouchstart"in document.documentElement)for(const S of[].concat(...document.body.children))P.off(S,"mouseover",m);this._popper&&this._popper.destroy(),this._menu.classList.remove(vs),this._element.classList.remove(vs),this._element.setAttribute("aria-expanded","false"),Ce.removeDataAttribute(this._menu,"popper"),P.trigger(this._element,Pm,x),this._element.focus()}}_getConfig(x){if(typeof(x=super._getConfig(x)).reference=="object"&&!c(x.reference)&&typeof x.reference.getBoundingClientRect!="function")throw new TypeError(`${g0.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return x}_createPopper(){if(p0===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let x=this._element;this._config.reference==="parent"?x=this._parent:c(this._config.reference)?x=f(this._config.reference):typeof this._config.reference=="object"&&(x=this._config.reference);const S=this._getPopperConfig();this._popper=Nf(x,this._menu,S)}_isShown(){return this._menu.classList.contains(vs)}_getPlacement(){const x=this._parent;if(x.classList.contains("dropend"))return Hm;if(x.classList.contains("dropstart"))return zm;if(x.classList.contains("dropup-center"))return"top";if(x.classList.contains("dropdown-center"))return"bottom";const S=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return x.classList.contains("dropup")?S?b0:y0:S?Po:E0}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:x}=this._config;return typeof x=="string"?x.split(",").map(S=>Number.parseInt(S,10)):typeof x=="function"?S=>x(S,this._element):x}_getPopperConfig(){const x={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ce.setDataAttribute(this._menu,"popper","static"),x.modifiers=[{name:"applyStyles",enabled:!1}]),{...x,...C(this._config.popperConfig,[void 0,x])}}_selectMenuItem({key:x,target:S}){const H=k.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(ne=>h(ne));H.length&&R(H,S,x===m0,!H.includes(S)).focus()}static jQueryInterface(x){return this.each(function(){const S=Ti.getOrCreateInstance(this,x);if(typeof x=="string"){if(S[x]===void 0)throw new TypeError(`No method named "${x}"`);S[x]()}})}static clearMenus(x){if(x.button===2||x.type==="keyup"&&x.key!=="Tab")return;const S=k.find(x0);for(const H of S){const ne=Ti.getInstance(H);if(!ne||ne._config.autoClose===!1)continue;const ae=x.composedPath(),Ae=ae.includes(ne._menu);if(ae.includes(ne._element)||ne._config.autoClose==="inside"&&!Ae||ne._config.autoClose==="outside"&&Ae||ne._menu.contains(x.target)&&(x.type==="keyup"&&x.key==="Tab"||/input|select|option|textarea|form/i.test(x.target.tagName)))continue;const Ne={relatedTarget:ne._element};x.type==="click"&&(Ne.clickEvent=x),ne._completeHide(Ne)}}static dataApiKeydownHandler(x){const S=/input|textarea/i.test(x.target.tagName),H=x.key==="Escape",ne=[km,m0].includes(x.key);if(!ne&&!H||S&&!H)return;x.preventDefault();const ae=this.matches(Ya)?this:k.prev(this,Ya)[0]||k.next(this,Ya)[0]||k.findOne(Ya,x.delegateTarget.parentNode),Ae=Ti.getOrCreateInstance(ae);if(ne)return x.stopPropagation(),Ae.show(),void Ae._selectMenuItem(x);Ae._isShown()&&(x.stopPropagation(),Ae.hide(),ae.focus())}}P.on(document,_0,Ya,Ti.dataApiKeydownHandler),P.on(document,_0,Gl,Ti.dataApiKeydownHandler),P.on(document,v0,Ti.clearMenus),P.on(document,Mf,Ti.clearMenus),P.on(document,v0,Ya,function(L){L.preventDefault(),Ti.getOrCreateInstance(this).toggle()}),w(Ti);const Bo="backdrop",Uo="show",w0=`mousedown.bs.${Bo}`,Yc={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},S0={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class If extends He{constructor(x){super(),this._config=this._getConfig(x),this._isAppended=!1,this._element=null}static get Default(){return Yc}static get DefaultType(){return S0}static get NAME(){return Bo}show(x){if(!this._config.isVisible)return void C(x);this._append();const S=this._getElement();this._config.isAnimated&&v(S),S.classList.add(Uo),this._emulateAnimation(()=>{C(x)})}hide(x){this._config.isVisible?(this._getElement().classList.remove(Uo),this._emulateAnimation(()=>{this.dispose(),C(x)})):C(x)}dispose(){this._isAppended&&(P.off(this._element,w0),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const x=document.createElement("div");x.className=this._config.className,this._config.isAnimated&&x.classList.add("fade"),this._element=x}return this._element}_configAfterMerge(x){return x.rootElement=f(x.rootElement),x}_append(){if(this._isAppended)return;const x=this._getElement();this._config.rootElement.append(x),P.on(x,w0,()=>{C(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(x){T(x,this._getElement(),this._config.isAnimated)}}const Ho=".bs.focustrap",kf=`focusin${Ho}`,T0=`keydown.tab${Ho}`,Ff="backward",C0={autofocus:!0,trapElement:null},$m={autofocus:"boolean",trapElement:"element"};class D0 extends He{constructor(x){super(),this._config=this._getConfig(x),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return C0}static get DefaultType(){return $m}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),P.off(document,Ho),P.on(document,kf,x=>this._handleFocusin(x)),P.on(document,T0,x=>this._handleKeydown(x)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,P.off(document,Ho))}_handleFocusin(x){const{trapElement:S}=this._config;if(x.target===document||x.target===S||S.contains(x.target))return;const H=k.focusableChildren(S);H.length===0?S.focus():this._lastTabNavDirection===Ff?H[H.length-1].focus():H[0].focus()}_handleKeydown(x){x.key==="Tab"&&(this._lastTabNavDirection=x.shiftKey?Ff:"forward")}}const O0=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",R0=".sticky-top",qc="padding-right",Hr="margin-right";class qa{constructor(){this._element=document.body}getWidth(){const x=document.documentElement.clientWidth;return Math.abs(window.innerWidth-x)}hide(){const x=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,qc,S=>S+x),this._setElementAttributes(O0,qc,S=>S+x),this._setElementAttributes(R0,Hr,S=>S-x)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,qc),this._resetElementAttributes(O0,qc),this._resetElementAttributes(R0,Hr)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(x,S,H){const ne=this.getWidth();this._applyManipulationCallback(x,ae=>{if(ae!==this._element&&window.innerWidth>ae.clientWidth+ne)return;this._saveInitialAttribute(ae,S);const Ae=window.getComputedStyle(ae).getPropertyValue(S);ae.style.setProperty(S,`${H(Number.parseFloat(Ae))}px`)})}_saveInitialAttribute(x,S){const H=x.style.getPropertyValue(S);H&&Ce.setDataAttribute(x,S,H)}_resetElementAttributes(x,S){this._applyManipulationCallback(x,H=>{const ne=Ce.getDataAttribute(H,S);ne!==null?(Ce.removeDataAttribute(H,S),H.style.setProperty(S,ne)):H.style.removeProperty(S)})}_applyManipulationCallback(x,S){if(c(x))S(x);else for(const H of k.find(x,this._element))S(H)}}const ai=".bs.modal",N0=`hide${ai}`,L0=`hidePrevented${ai}`,Pf=`hidden${ai}`,Kc=`show${ai}`,Gm=`shown${ai}`,zo=`resize${ai}`,Bf=`click.dismiss${ai}`,Vl=`mousedown.dismiss${ai}`,Uf=`keydown.dismiss${ai}`,M0=`click${ai}.data-api`,la="modal-open",Ka="show",Wl="modal-static",I0={backdrop:!0,focus:!0,keyboard:!0},Qa={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ca extends Ie{constructor(x,S){super(x,S),this._dialog=k.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new qa,this._addEventListeners()}static get Default(){return I0}static get DefaultType(){return Qa}static get NAME(){return"modal"}toggle(x){return this._isShown?this.hide():this.show(x)}show(x){this._isShown||this._isTransitioning||P.trigger(this._element,Kc,{relatedTarget:x}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(la),this._adjustDialog(),this._backdrop.show(()=>this._showElement(x)))}hide(){this._isShown&&!this._isTransitioning&&(P.trigger(this._element,N0).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Ka),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){P.off(window,ai),P.off(this._dialog,ai),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new If({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new D0({trapElement:this._element})}_showElement(x){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const S=k.findOne(".modal-body",this._dialog);S&&(S.scrollTop=0),v(this._element),this._element.classList.add(Ka),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,P.trigger(this._element,Gm,{relatedTarget:x})},this._dialog,this._isAnimated())}_addEventListeners(){P.on(this._element,Uf,x=>{x.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),P.on(window,zo,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),P.on(this._element,Vl,x=>{P.one(this._element,Bf,S=>{this._element===x.target&&this._element===S.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(la),this._resetAdjustments(),this._scrollBar.reset(),P.trigger(this._element,Pf)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(P.trigger(this._element,L0).defaultPrevented)return;const x=this._element.scrollHeight>document.documentElement.clientHeight,S=this._element.style.overflowY;S==="hidden"||this._element.classList.contains(Wl)||(x||(this._element.style.overflowY="hidden"),this._element.classList.add(Wl),this._queueCallback(()=>{this._element.classList.remove(Wl),this._queueCallback(()=>{this._element.style.overflowY=S},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const x=this._element.scrollHeight>document.documentElement.clientHeight,S=this._scrollBar.getWidth(),H=S>0;if(H&&!x){const ne=A()?"paddingLeft":"paddingRight";this._element.style[ne]=`${S}px`}if(!H&&x){const ne=A()?"paddingRight":"paddingLeft";this._element.style[ne]=`${S}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(x,S){return this.each(function(){const H=ca.getOrCreateInstance(this,x);if(typeof x=="string"){if(H[x]===void 0)throw new TypeError(`No method named "${x}"`);H[x](S)}})}}P.on(document,M0,'[data-bs-toggle="modal"]',function(L){const x=k.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&L.preventDefault(),P.one(x,Kc,H=>{H.defaultPrevented||P.one(x,Pf,()=>{h(this)&&this.focus()})});const S=k.findOne(".modal.show");S&&ca.getInstance(S).hide(),ca.getOrCreateInstance(x).toggle(this)}),se(ca),w(ca);const _s=".bs.offcanvas",Hf=".data-api",Vm=`load${_s}${Hf}`,k0="show",F0="showing",zf="hiding",jf=".offcanvas.show",$f=`show${_s}`,$i=`shown${_s}`,P0=`hide${_s}`,oi=`hidePrevented${_s}`,li=`hidden${_s}`,jo=`resize${_s}`,Gf=`click${_s}${Hf}`,Qc=`keydown.dismiss${_s}`,Zc={backdrop:!0,keyboard:!0,scroll:!1},Vf={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class zr extends Ie{constructor(x,S){super(x,S),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Zc}static get DefaultType(){return Vf}static get NAME(){return"offcanvas"}toggle(x){return this._isShown?this.hide():this.show(x)}show(x){this._isShown||P.trigger(this._element,$f,{relatedTarget:x}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new qa().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(F0),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(k0),this._element.classList.remove(F0),P.trigger(this._element,$i,{relatedTarget:x})},this._element,!0))}hide(){this._isShown&&(P.trigger(this._element,P0).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(zf),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(k0,zf),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new qa().reset(),P.trigger(this._element,li)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const x=!!this._config.backdrop;return new If({className:"offcanvas-backdrop",isVisible:x,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:x?()=>{this._config.backdrop!=="static"?this.hide():P.trigger(this._element,oi)}:null})}_initializeFocusTrap(){return new D0({trapElement:this._element})}_addEventListeners(){P.on(this._element,Qc,x=>{x.key==="Escape"&&(this._config.keyboard?this.hide():P.trigger(this._element,oi))})}static jQueryInterface(x){return this.each(function(){const S=zr.getOrCreateInstance(this,x);if(typeof x=="string"){if(S[x]===void 0||x.startsWith("_")||x==="constructor")throw new TypeError(`No method named "${x}"`);S[x](this)}})}}P.on(document,Gf,'[data-bs-toggle="offcanvas"]',function(L){const x=k.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&L.preventDefault(),d(this))return;P.one(x,li,()=>{h(this)&&this.focus()});const S=k.findOne(jf);S&&S!==x&&zr.getInstance(S).hide(),zr.getOrCreateInstance(x).toggle(this)}),P.on(window,Vm,()=>{for(const L of k.find(jf))zr.getOrCreateInstance(L).show()}),P.on(window,jo,()=>{for(const L of k.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(L).position!=="fixed"&&zr.getOrCreateInstance(L).hide()}),se(zr),w(zr);const Wf={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Jc=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),$o=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Wm=(L,x)=>{const S=L.nodeName.toLowerCase();return x.includes(S)?!Jc.has(S)||!!$o.test(L.nodeValue):x.filter(H=>H instanceof RegExp).some(H=>H.test(S))},ci={allowList:Wf,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Xf={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},zs={entry:"(string|element|function|null)",selector:"(string|element)"};class B0 extends He{constructor(x){super(),this._config=this._getConfig(x)}static get Default(){return ci}static get DefaultType(){return Xf}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(x=>this._resolvePossibleFunction(x)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(x){return this._checkContent(x),this._config.content={...this._config.content,...x},this}toHtml(){const x=document.createElement("div");x.innerHTML=this._maybeSanitize(this._config.template);for(const[ne,ae]of Object.entries(this._config.content))this._setContent(x,ae,ne);const S=x.children[0],H=this._resolvePossibleFunction(this._config.extraClass);return H&&S.classList.add(...H.split(" ")),S}_typeCheckConfig(x){super._typeCheckConfig(x),this._checkContent(x.content)}_checkContent(x){for(const[S,H]of Object.entries(x))super._typeCheckConfig({selector:S,entry:H},zs)}_setContent(x,S,H){const ne=k.findOne(H,x);ne&&((S=this._resolvePossibleFunction(S))?c(S)?this._putElementInTemplate(f(S),ne):this._config.html?ne.innerHTML=this._maybeSanitize(S):ne.textContent=S:ne.remove())}_maybeSanitize(x){return this._config.sanitize?function(S,H,ne){if(!S.length)return S;if(ne&&typeof ne=="function")return ne(S);const ae=new window.DOMParser().parseFromString(S,"text/html"),Ae=[].concat(...ae.body.querySelectorAll("*"));for(const Ne of Ae){const We=Ne.nodeName.toLowerCase();if(!Object.keys(H).includes(We)){Ne.remove();continue}const tt=[].concat(...Ne.attributes),it=[].concat(H["*"]||[],H[We]||[]);for(const Je of tt)Wm(Je,it)||Ne.removeAttribute(Je.nodeName)}return ae.body.innerHTML}(x,this._config.allowList,this._config.sanitizeFn):x}_resolvePossibleFunction(x){return C(x,[void 0,this])}_putElementInTemplate(x,S){if(this._config.html)return S.innerHTML="",void S.append(x);S.textContent=x.textContent}}const eu=new Set(["sanitize","allowList","sanitizeFn"]),js="fade",Go="show",Yf=".tooltip-inner",Za=".modal",Ja="hide.bs.modal",ua="hover",Vo="focus",jr="click",Ci={AUTO:"auto",TOP:"top",RIGHT:A()?"left":"right",BOTTOM:"bottom",LEFT:A()?"right":"left"},eo={allowList:Wf,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},$s={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Dr extends Ie{constructor(x,S){if(p0===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(x,S),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return eo}static get DefaultType(){return $s}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),P.off(this._element.closest(Za),Ja,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const x=P.trigger(this._element,this.constructor.eventName("show")),S=(g(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(x.defaultPrevented||!S)return;this._disposePopper();const H=this._getTipElement();this._element.setAttribute("aria-describedby",H.getAttribute("id"));const{container:ne}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(ne.append(H),P.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(H),H.classList.add(Go),"ontouchstart"in document.documentElement)for(const ae of[].concat(...document.body.children))P.on(ae,"mouseover",m);this._queueCallback(()=>{P.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!P.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Go),"ontouchstart"in document.documentElement)for(const x of[].concat(...document.body.children))P.off(x,"mouseover",m);this._activeTrigger[jr]=!1,this._activeTrigger[Vo]=!1,this._activeTrigger[ua]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),P.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(x){const S=this._getTemplateFactory(x).toHtml();if(!S)return null;S.classList.remove(js,Go),S.classList.add(`bs-${this.constructor.NAME}-auto`);const H=(ne=>{do ne+=Math.floor(1e6*Math.random());while(document.getElementById(ne));return ne})(this.constructor.NAME).toString();return S.setAttribute("id",H),this._isAnimated()&&S.classList.add(js),S}setContent(x){this._newContent=x,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(x){return this._templateFactory?this._templateFactory.changeContent(x):this._templateFactory=new B0({...this._config,content:x,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Yf]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(x){return this.constructor.getOrCreateInstance(x.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(js)}_isShown(){return this.tip&&this.tip.classList.contains(Go)}_createPopper(x){const S=C(this._config.placement,[this,x,this._element]),H=Ci[S.toUpperCase()];return Nf(this._element,x,this._getPopperConfig(H))}_getOffset(){const{offset:x}=this._config;return typeof x=="string"?x.split(",").map(S=>Number.parseInt(S,10)):typeof x=="function"?S=>x(S,this._element):x}_resolvePossibleFunction(x){return C(x,[this._element,this._element])}_getPopperConfig(x){const S={placement:x,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:H=>{this._getTipElement().setAttribute("data-popper-placement",H.state.placement)}}]};return{...S,...C(this._config.popperConfig,[void 0,S])}}_setListeners(){const x=this._config.trigger.split(" ");for(const S of x)if(S==="click")P.on(this._element,this.constructor.eventName("click"),this._config.selector,H=>{const ne=this._initializeOnDelegatedTarget(H);ne._activeTrigger[jr]=!(ne._isShown()&&ne._activeTrigger[jr]),ne.toggle()});else if(S!=="manual"){const H=S===ua?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),ne=S===ua?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");P.on(this._element,H,this._config.selector,ae=>{const Ae=this._initializeOnDelegatedTarget(ae);Ae._activeTrigger[ae.type==="focusin"?Vo:ua]=!0,Ae._enter()}),P.on(this._element,ne,this._config.selector,ae=>{const Ae=this._initializeOnDelegatedTarget(ae);Ae._activeTrigger[ae.type==="focusout"?Vo:ua]=Ae._element.contains(ae.relatedTarget),Ae._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},P.on(this._element.closest(Za),Ja,this._hideModalHandler)}_fixTitle(){const x=this._element.getAttribute("title");x&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",x),this._element.setAttribute("data-bs-original-title",x),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(x,S){clearTimeout(this._timeout),this._timeout=setTimeout(x,S)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(x){const S=Ce.getDataAttributes(this._element);for(const H of Object.keys(S))eu.has(H)&&delete S[H];return x={...S,...typeof x=="object"&&x?x:{}},x=this._mergeConfigObj(x),x=this._configAfterMerge(x),this._typeCheckConfig(x),x}_configAfterMerge(x){return x.container=x.container===!1?document.body:f(x.container),typeof x.delay=="number"&&(x.delay={show:x.delay,hide:x.delay}),typeof x.title=="number"&&(x.title=x.title.toString()),typeof x.content=="number"&&(x.content=x.content.toString()),x}_getDelegateConfig(){const x={};for(const[S,H]of Object.entries(this._config))this.constructor.Default[S]!==H&&(x[S]=H);return x.selector=!1,x.trigger="manual",x}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(x){return this.each(function(){const S=Dr.getOrCreateInstance(this,x);if(typeof x=="string"){if(S[x]===void 0)throw new TypeError(`No method named "${x}"`);S[x]()}})}}w(Dr);const to=".popover-header",U0=".popover-body",qf={...Dr.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Kf={...Dr.DefaultType,content:"(null|string|element|function)"};class er extends Dr{static get Default(){return qf}static get DefaultType(){return Kf}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[to]:this._getTitle(),[U0]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(x){return this.each(function(){const S=er.getOrCreateInstance(this,x);if(typeof x=="string"){if(S[x]===void 0)throw new TypeError(`No method named "${x}"`);S[x]()}})}}w(er);const wn=".bs.scrollspy",en=`activate${wn}`,fa=`click${wn}`,xs=`load${wn}.data-api`,ha="active",Gs="[href]",Qf=".nav-link",H0=`${Qf}, .nav-item > ${Qf}, .list-group-item`,Xl={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Yl={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Wo extends Ie{constructor(x,S){super(x,S),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Xl}static get DefaultType(){return Yl}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const x of this._observableSections.values())this._observer.observe(x)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(x){return x.target=f(x.target)||document.body,x.rootMargin=x.offset?`${x.offset}px 0px -30%`:x.rootMargin,typeof x.threshold=="string"&&(x.threshold=x.threshold.split(",").map(S=>Number.parseFloat(S))),x}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(P.off(this._config.target,fa),P.on(this._config.target,fa,Gs,x=>{const S=this._observableSections.get(x.target.hash);if(S){x.preventDefault();const H=this._rootElement||window,ne=S.offsetTop-this._element.offsetTop;if(H.scrollTo)return void H.scrollTo({top:ne,behavior:"smooth"});H.scrollTop=ne}}))}_getNewObserver(){const x={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(S=>this._observerCallback(S),x)}_observerCallback(x){const S=Ae=>this._targetLinks.get(`#${Ae.target.id}`),H=Ae=>{this._previousScrollData.visibleEntryTop=Ae.target.offsetTop,this._process(S(Ae))},ne=(this._rootElement||document.documentElement).scrollTop,ae=ne>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=ne;for(const Ae of x){if(!Ae.isIntersecting){this._activeTarget=null,this._clearActiveClass(S(Ae));continue}const Ne=Ae.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(ae&&Ne){if(H(Ae),!ne)return}else ae||Ne||H(Ae)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const x=k.find(Gs,this._config.target);for(const S of x){if(!S.hash||d(S))continue;const H=k.findOne(decodeURI(S.hash),this._element);h(H)&&(this._targetLinks.set(decodeURI(S.hash),S),this._observableSections.set(S.hash,H))}}_process(x){this._activeTarget!==x&&(this._clearActiveClass(this._config.target),this._activeTarget=x,x.classList.add(ha),this._activateParents(x),P.trigger(this._element,en,{relatedTarget:x}))}_activateParents(x){if(x.classList.contains("dropdown-item"))k.findOne(".dropdown-toggle",x.closest(".dropdown")).classList.add(ha);else for(const S of k.parents(x,".nav, .list-group"))for(const H of k.prev(S,H0))H.classList.add(ha)}_clearActiveClass(x){x.classList.remove(ha);const S=k.find(`${Gs}.${ha}`,x);for(const H of S)H.classList.remove(ha)}static jQueryInterface(x){return this.each(function(){const S=Wo.getOrCreateInstance(this,x);if(typeof x=="string"){if(S[x]===void 0||x.startsWith("_")||x==="constructor")throw new TypeError(`No method named "${x}"`);S[x]()}})}}P.on(window,xs,()=>{for(const L of k.find('[data-bs-spy="scroll"]'))Wo.getOrCreateInstance(L)}),w(Wo);const Gi=".bs.tab",Zf=`hide${Gi}`,no=`hidden${Gi}`,Vs=`show${Gi}`,da=`shown${Gi}`,Ws=`click${Gi}`,Jf=`keydown${Gi}`,eh=`load${Gi}`,ql="ArrowLeft",Kl="ArrowRight",ro="ArrowUp",ur="ArrowDown",Xo="Home",th="End",io="active",z0="fade",nh="show",Un=".dropdown-toggle",Ql=`:not(${Un})`,Yo='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',so=`.nav-link${Ql}, .list-group-item${Ql}, [role="tab"]${Ql}, ${Yo}`,rh=`.${io}[data-bs-toggle="tab"], .${io}[data-bs-toggle="pill"], .${io}[data-bs-toggle="list"]`;class Di extends Ie{constructor(x){super(x),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),P.on(this._element,Jf,S=>this._keydown(S)))}static get NAME(){return"tab"}show(){const x=this._element;if(this._elemIsActive(x))return;const S=this._getActiveElem(),H=S?P.trigger(S,Zf,{relatedTarget:x}):null;P.trigger(x,Vs,{relatedTarget:S}).defaultPrevented||H&&H.defaultPrevented||(this._deactivate(S,x),this._activate(x,S))}_activate(x,S){x&&(x.classList.add(io),this._activate(k.getElementFromSelector(x)),this._queueCallback(()=>{x.getAttribute("role")==="tab"?(x.removeAttribute("tabindex"),x.setAttribute("aria-selected",!0),this._toggleDropDown(x,!0),P.trigger(x,da,{relatedTarget:S})):x.classList.add(nh)},x,x.classList.contains(z0)))}_deactivate(x,S){x&&(x.classList.remove(io),x.blur(),this._deactivate(k.getElementFromSelector(x)),this._queueCallback(()=>{x.getAttribute("role")==="tab"?(x.setAttribute("aria-selected",!1),x.setAttribute("tabindex","-1"),this._toggleDropDown(x,!1),P.trigger(x,no,{relatedTarget:S})):x.classList.remove(nh)},x,x.classList.contains(z0)))}_keydown(x){if(![ql,Kl,ro,ur,Xo,th].includes(x.key))return;x.stopPropagation(),x.preventDefault();const S=this._getChildren().filter(ne=>!d(ne));let H;if([Xo,th].includes(x.key))H=S[x.key===Xo?0:S.length-1];else{const ne=[Kl,ur].includes(x.key);H=R(S,x.target,ne,!0)}H&&(H.focus({preventScroll:!0}),Di.getOrCreateInstance(H).show())}_getChildren(){return k.find(so,this._parent)}_getActiveElem(){return this._getChildren().find(x=>this._elemIsActive(x))||null}_setInitialAttributes(x,S){this._setAttributeIfNotExists(x,"role","tablist");for(const H of S)this._setInitialAttributesOnChild(H)}_setInitialAttributesOnChild(x){x=this._getInnerElement(x);const S=this._elemIsActive(x),H=this._getOuterElement(x);x.setAttribute("aria-selected",S),H!==x&&this._setAttributeIfNotExists(H,"role","presentation"),S||x.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(x,"role","tab"),this._setInitialAttributesOnTargetPanel(x)}_setInitialAttributesOnTargetPanel(x){const S=k.getElementFromSelector(x);S&&(this._setAttributeIfNotExists(S,"role","tabpanel"),x.id&&this._setAttributeIfNotExists(S,"aria-labelledby",`${x.id}`))}_toggleDropDown(x,S){const H=this._getOuterElement(x);if(!H.classList.contains("dropdown"))return;const ne=(ae,Ae)=>{const Ne=k.findOne(ae,H);Ne&&Ne.classList.toggle(Ae,S)};ne(Un,io),ne(".dropdown-menu",nh),H.setAttribute("aria-expanded",S)}_setAttributeIfNotExists(x,S,H){x.hasAttribute(S)||x.setAttribute(S,H)}_elemIsActive(x){return x.classList.contains(io)}_getInnerElement(x){return x.matches(so)?x:k.findOne(so,x)}_getOuterElement(x){return x.closest(".nav-item, .list-group-item")||x}static jQueryInterface(x){return this.each(function(){const S=Di.getOrCreateInstance(this);if(typeof x=="string"){if(S[x]===void 0||x.startsWith("_")||x==="constructor")throw new TypeError(`No method named "${x}"`);S[x]()}})}}P.on(document,Ws,Yo,function(L){["A","AREA"].includes(this.tagName)&&L.preventDefault(),d(this)||Di.getOrCreateInstance(this).show()}),P.on(window,eh,()=>{for(const L of k.find(rh))Di.getOrCreateInstance(L)}),w(Di);const ui=".bs.toast",Xm=`mouseover${ui}`,j0=`mouseout${ui}`,Ym=`focusin${ui}`,$0=`focusout${ui}`,ao=`hide${ui}`,ih=`hidden${ui}`,tu=`show${ui}`,G0=`shown${ui}`,qo="hide",Zl="show",oo="showing",sh={animation:"boolean",autohide:"boolean",delay:"number"},V0={animation:!0,autohide:!0,delay:5e3};class pa extends Ie{constructor(x,S){super(x,S),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return V0}static get DefaultType(){return sh}static get NAME(){return"toast"}show(){P.trigger(this._element,tu).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(qo),v(this._element),this._element.classList.add(Zl,oo),this._queueCallback(()=>{this._element.classList.remove(oo),P.trigger(this._element,G0),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(P.trigger(this._element,ao).defaultPrevented||(this._element.classList.add(oo),this._queueCallback(()=>{this._element.classList.add(qo),this._element.classList.remove(oo,Zl),P.trigger(this._element,ih)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Zl),super.dispose()}isShown(){return this._element.classList.contains(Zl)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(x,S){switch(x.type){case"mouseover":case"mouseout":this._hasMouseInteraction=S;break;case"focusin":case"focusout":this._hasKeyboardInteraction=S}if(S)return void this._clearTimeout();const H=x.relatedTarget;this._element===H||this._element.contains(H)||this._maybeScheduleHide()}_setListeners(){P.on(this._element,Xm,x=>this._onInteraction(x,!0)),P.on(this._element,j0,x=>this._onInteraction(x,!1)),P.on(this._element,Ym,x=>this._onInteraction(x,!0)),P.on(this._element,$0,x=>this._onInteraction(x,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(x){return this.each(function(){const S=pa.getOrCreateInstance(this,x);if(typeof x=="string"){if(S[x]===void 0)throw new TypeError(`No method named "${x}"`);S[x](this)}})}}return se(pa),w(pa),{Alert:be,Button:Ye,Carousel:na,Collapse:Ee,Dropdown:Ti,Modal:ca,Offcanvas:zr,Popover:er,ScrollSpy:Wo,Tab:Di,Toast:pa,Tooltip:Dr}})}(sg)),sg.exports}NR();var xi="top",ls="bottom",cs="right",yi="left",Kg="auto",cf=[xi,ls,cs,yi],_c="start",qu="end",PS="clippingParents",z_="viewport",Ou="popper",BS="reference",l_=cf.reduce(function(n,e){return n.concat([e+"-"+_c,e+"-"+qu])},[]),j_=[].concat(cf,[Kg]).reduce(function(n,e){return n.concat([e,e+"-"+_c,e+"-"+qu])},[]),US="beforeRead",HS="read",zS="afterRead",jS="beforeMain",$S="main",GS="afterMain",VS="beforeWrite",WS="write",XS="afterWrite",YS=[US,HS,zS,jS,$S,GS,VS,WS,XS];function Fa(n){return n?(n.nodeName||"").toLowerCase():null}function us(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function xc(n){var e=us(n).Element;return n instanceof e||n instanceof Element}function Ns(n){var e=us(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function $_(n){if(typeof ShadowRoot>"u")return!1;var e=us(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function LR(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Ns(a)||!Fa(a)||(Object.assign(a.style,r),Object.keys(i).forEach(function(o){var c=i[o];c===!1?a.removeAttribute(o):a.setAttribute(o,c===!0?"":c)}))})}function MR(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],a=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),c=o.reduce(function(f,h){return f[h]="",f},{});!Ns(i)||!Fa(i)||(Object.assign(i.style,c),Object.keys(a).forEach(function(f){i.removeAttribute(f)}))})}}const G_={name:"applyStyles",enabled:!0,phase:"write",fn:LR,effect:MR,requires:["computeStyles"]};function Ia(n){return n.split("-")[0]}var mc=Math.max,dg=Math.min,Ku=Math.round;function c_(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function qS(){return!/^((?!chrome|android).)*safari/i.test(c_())}function Qu(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),i=1,a=1;e&&Ns(n)&&(i=n.offsetWidth>0&&Ku(r.width)/n.offsetWidth||1,a=n.offsetHeight>0&&Ku(r.height)/n.offsetHeight||1);var o=xc(n)?us(n):window,c=o.visualViewport,f=!qS()&&t,h=(r.left+(f&&c?c.offsetLeft:0))/i,d=(r.top+(f&&c?c.offsetTop:0))/a,g=r.width/i,m=r.height/a;return{width:g,height:m,top:d,right:h+g,bottom:d+m,left:h,x:h,y:d}}function V_(n){var e=Qu(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function KS(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&$_(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function To(n){return us(n).getComputedStyle(n)}function IR(n){return["table","td","th"].indexOf(Fa(n))>=0}function Tl(n){return((xc(n)?n.ownerDocument:n.document)||window.document).documentElement}function Qg(n){return Fa(n)==="html"?n:n.assignedSlot||n.parentNode||($_(n)?n.host:null)||Tl(n)}function $E(n){return!Ns(n)||To(n).position==="fixed"?null:n.offsetParent}function kR(n){var e=/firefox/i.test(c_()),t=/Trident/i.test(c_());if(t&&Ns(n)){var r=To(n);if(r.position==="fixed")return null}var i=Qg(n);for($_(i)&&(i=i.host);Ns(i)&&["html","body"].indexOf(Fa(i))<0;){var a=To(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function kd(n){for(var e=us(n),t=$E(n);t&&IR(t)&&To(t).position==="static";)t=$E(t);return t&&(Fa(t)==="html"||Fa(t)==="body"&&To(t).position==="static")?e:t||kR(n)||e}function W_(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function nd(n,e,t){return mc(n,dg(e,t))}function FR(n,e,t){var r=nd(n,e,t);return r>t?t:r}function QS(){return{top:0,right:0,bottom:0,left:0}}function ZS(n){return Object.assign({},QS(),n)}function JS(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var PR=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,ZS(typeof e!="number"?e:JS(e,cf))};function BR(n){var e,t=n.state,r=n.name,i=n.options,a=t.elements.arrow,o=t.modifiersData.popperOffsets,c=Ia(t.placement),f=W_(c),h=[yi,cs].indexOf(c)>=0,d=h?"height":"width";if(!(!a||!o)){var g=PR(i.padding,t),m=V_(a),v=f==="y"?xi:yi,y=f==="y"?ls:cs,b=t.rects.reference[d]+t.rects.reference[f]-o[f]-t.rects.popper[d],A=o[f]-t.rects.reference[f],w=kd(a),C=w?f==="y"?w.clientHeight||0:w.clientWidth||0:0,T=b/2-A/2,R=g[v],N=C-m[d]-g[y],I=C/2-m[d]/2+T,D=nd(R,I,N),B=f;t.modifiersData[r]=(e={},e[B]=D,e.centerOffset=D-I,e)}}function UR(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||KS(e.elements.popper,i)&&(e.elements.arrow=i))}const e2={name:"arrow",enabled:!0,phase:"main",fn:BR,effect:UR,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Zu(n){return n.split("-")[1]}var HR={top:"auto",right:"auto",bottom:"auto",left:"auto"};function zR(n,e){var t=n.x,r=n.y,i=e.devicePixelRatio||1;return{x:Ku(t*i)/i||0,y:Ku(r*i)/i||0}}function GE(n){var e,t=n.popper,r=n.popperRect,i=n.placement,a=n.variation,o=n.offsets,c=n.position,f=n.gpuAcceleration,h=n.adaptive,d=n.roundOffsets,g=n.isFixed,m=o.x,v=m===void 0?0:m,y=o.y,b=y===void 0?0:y,A=typeof d=="function"?d({x:v,y:b}):{x:v,y:b};v=A.x,b=A.y;var w=o.hasOwnProperty("x"),C=o.hasOwnProperty("y"),T=yi,R=xi,N=window;if(h){var I=kd(t),D="clientHeight",B="clientWidth";if(I===us(t)&&(I=Tl(t),To(I).position!=="static"&&c==="absolute"&&(D="scrollHeight",B="scrollWidth")),I=I,i===xi||(i===yi||i===cs)&&a===qu){R=ls;var U=g&&I===N&&N.visualViewport?N.visualViewport.height:I[D];b-=U-r.height,b*=f?1:-1}if(i===yi||(i===xi||i===ls)&&a===qu){T=cs;var Y=g&&I===N&&N.visualViewport?N.visualViewport.width:I[B];v-=Y-r.width,v*=f?1:-1}}var W=Object.assign({position:c},h&&HR),re=d===!0?zR({x:v,y:b},us(t)):{x:v,y:b};if(v=re.x,b=re.y,f){var Te;return Object.assign({},W,(Te={},Te[R]=C?"0":"",Te[T]=w?"0":"",Te.transform=(N.devicePixelRatio||1)<=1?"translate("+v+"px, "+b+"px)":"translate3d("+v+"px, "+b+"px, 0)",Te))}return Object.assign({},W,(e={},e[R]=C?b+"px":"",e[T]=w?v+"px":"",e.transform="",e))}function jR(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,a=t.adaptive,o=a===void 0?!0:a,c=t.roundOffsets,f=c===void 0?!0:c,h={placement:Ia(e.placement),variation:Zu(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,GE(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:f})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,GE(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const X_={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:jR,data:{}};var Mp={passive:!0};function $R(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,a=i===void 0?!0:i,o=r.resize,c=o===void 0?!0:o,f=us(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&h.forEach(function(d){d.addEventListener("scroll",t.update,Mp)}),c&&f.addEventListener("resize",t.update,Mp),function(){a&&h.forEach(function(d){d.removeEventListener("scroll",t.update,Mp)}),c&&f.removeEventListener("resize",t.update,Mp)}}const Y_={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:$R,data:{}};var GR={left:"right",right:"left",bottom:"top",top:"bottom"};function ag(n){return n.replace(/left|right|bottom|top/g,function(e){return GR[e]})}var VR={start:"end",end:"start"};function VE(n){return n.replace(/start|end/g,function(e){return VR[e]})}function q_(n){var e=us(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function K_(n){return Qu(Tl(n)).left+q_(n).scrollLeft}function WR(n,e){var t=us(n),r=Tl(n),i=t.visualViewport,a=r.clientWidth,o=r.clientHeight,c=0,f=0;if(i){a=i.width,o=i.height;var h=qS();(h||!h&&e==="fixed")&&(c=i.offsetLeft,f=i.offsetTop)}return{width:a,height:o,x:c+K_(n),y:f}}function XR(n){var e,t=Tl(n),r=q_(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=mc(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=mc(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),c=-r.scrollLeft+K_(n),f=-r.scrollTop;return To(i||t).direction==="rtl"&&(c+=mc(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:o,x:c,y:f}}function Q_(n){var e=To(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function t2(n){return["html","body","#document"].indexOf(Fa(n))>=0?n.ownerDocument.body:Ns(n)&&Q_(n)?n:t2(Qg(n))}function rd(n,e){var t;e===void 0&&(e=[]);var r=t2(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),a=us(r),o=i?[a].concat(a.visualViewport||[],Q_(r)?r:[]):r,c=e.concat(o);return i?c:c.concat(rd(Qg(o)))}function u_(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function YR(n,e){var t=Qu(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function WE(n,e,t){return e===z_?u_(WR(n,t)):xc(e)?YR(e,t):u_(XR(Tl(n)))}function qR(n){var e=rd(Qg(n)),t=["absolute","fixed"].indexOf(To(n).position)>=0,r=t&&Ns(n)?kd(n):n;return xc(r)?e.filter(function(i){return xc(i)&&KS(i,r)&&Fa(i)!=="body"}):[]}function KR(n,e,t,r){var i=e==="clippingParents"?qR(n):[].concat(e),a=[].concat(i,[t]),o=a[0],c=a.reduce(function(f,h){var d=WE(n,h,r);return f.top=mc(d.top,f.top),f.right=dg(d.right,f.right),f.bottom=dg(d.bottom,f.bottom),f.left=mc(d.left,f.left),f},WE(n,o,r));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function n2(n){var e=n.reference,t=n.element,r=n.placement,i=r?Ia(r):null,a=r?Zu(r):null,o=e.x+e.width/2-t.width/2,c=e.y+e.height/2-t.height/2,f;switch(i){case xi:f={x:o,y:e.y-t.height};break;case ls:f={x:o,y:e.y+e.height};break;case cs:f={x:e.x+e.width,y:c};break;case yi:f={x:e.x-t.width,y:c};break;default:f={x:e.x,y:e.y}}var h=i?W_(i):null;if(h!=null){var d=h==="y"?"height":"width";switch(a){case _c:f[h]=f[h]-(e[d]/2-t[d]/2);break;case qu:f[h]=f[h]+(e[d]/2-t[d]/2);break}}return f}function Ju(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,a=t.strategy,o=a===void 0?n.strategy:a,c=t.boundary,f=c===void 0?PS:c,h=t.rootBoundary,d=h===void 0?z_:h,g=t.elementContext,m=g===void 0?Ou:g,v=t.altBoundary,y=v===void 0?!1:v,b=t.padding,A=b===void 0?0:b,w=ZS(typeof A!="number"?A:JS(A,cf)),C=m===Ou?BS:Ou,T=n.rects.popper,R=n.elements[y?C:m],N=KR(xc(R)?R:R.contextElement||Tl(n.elements.popper),f,d,o),I=Qu(n.elements.reference),D=n2({reference:I,element:T,placement:i}),B=u_(Object.assign({},T,D)),U=m===Ou?B:I,Y={top:N.top-U.top+w.top,bottom:U.bottom-N.bottom+w.bottom,left:N.left-U.left+w.left,right:U.right-N.right+w.right},W=n.modifiersData.offset;if(m===Ou&&W){var re=W[i];Object.keys(Y).forEach(function(Te){var Fe=[cs,ls].indexOf(Te)>=0?1:-1,we=[xi,ls].indexOf(Te)>=0?"y":"x";Y[Te]+=re[we]*Fe})}return Y}function QR(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,a=t.rootBoundary,o=t.padding,c=t.flipVariations,f=t.allowedAutoPlacements,h=f===void 0?j_:f,d=Zu(r),g=d?c?l_:l_.filter(function(y){return Zu(y)===d}):cf,m=g.filter(function(y){return h.indexOf(y)>=0});m.length===0&&(m=g);var v=m.reduce(function(y,b){return y[b]=Ju(n,{placement:b,boundary:i,rootBoundary:a,padding:o})[Ia(b)],y},{});return Object.keys(v).sort(function(y,b){return v[y]-v[b]})}function ZR(n){if(Ia(n)===Kg)return[];var e=ag(n);return[VE(n),e,VE(e)]}function JR(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,o=t.altAxis,c=o===void 0?!0:o,f=t.fallbackPlacements,h=t.padding,d=t.boundary,g=t.rootBoundary,m=t.altBoundary,v=t.flipVariations,y=v===void 0?!0:v,b=t.allowedAutoPlacements,A=e.options.placement,w=Ia(A),C=w===A,T=f||(C||!y?[ag(A)]:ZR(A)),R=[A].concat(T).reduce(function(Ce,He){return Ce.concat(Ia(He)===Kg?QR(e,{placement:He,boundary:d,rootBoundary:g,padding:h,flipVariations:y,allowedAutoPlacements:b}):He)},[]),N=e.rects.reference,I=e.rects.popper,D=new Map,B=!0,U=R[0],Y=0;Y<R.length;Y++){var W=R[Y],re=Ia(W),Te=Zu(W)===_c,Fe=[xi,ls].indexOf(re)>=0,we=Fe?"width":"height",q=Ju(e,{placement:W,boundary:d,rootBoundary:g,altBoundary:m,padding:h}),ee=Fe?Te?cs:yi:Te?ls:xi;N[we]>I[we]&&(ee=ag(ee));var Pe=ag(ee),qe=[];if(a&&qe.push(q[re]<=0),c&&qe.push(q[ee]<=0,q[Pe]<=0),qe.every(function(Ce){return Ce})){U=W,B=!1;break}D.set(W,qe)}if(B)for(var P=y?3:1,ye=function(He){var Ie=R.find(function(Ge){var k=D.get(Ge);if(k)return k.slice(0,He).every(function(se){return se})});if(Ie)return U=Ie,"break"},ve=P;ve>0;ve--){var ge=ye(ve);if(ge==="break")break}e.placement!==U&&(e.modifiersData[r]._skip=!0,e.placement=U,e.reset=!0)}}const r2={name:"flip",enabled:!0,phase:"main",fn:JR,requiresIfExists:["offset"],data:{_skip:!1}};function XE(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function YE(n){return[xi,cs,ls,yi].some(function(e){return n[e]>=0})}function eN(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,o=Ju(e,{elementContext:"reference"}),c=Ju(e,{altBoundary:!0}),f=XE(o,r),h=XE(c,i,a),d=YE(f),g=YE(h);e.modifiersData[t]={referenceClippingOffsets:f,popperEscapeOffsets:h,isReferenceHidden:d,hasPopperEscaped:g},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":g})}const i2={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:eN};function tN(n,e,t){var r=Ia(n),i=[yi,xi].indexOf(r)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,o=a[0],c=a[1];return o=o||0,c=(c||0)*i,[yi,cs].indexOf(r)>=0?{x:c,y:o}:{x:o,y:c}}function nN(n){var e=n.state,t=n.options,r=n.name,i=t.offset,a=i===void 0?[0,0]:i,o=j_.reduce(function(d,g){return d[g]=tN(g,e.rects,a),d},{}),c=o[e.placement],f=c.x,h=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=f,e.modifiersData.popperOffsets.y+=h),e.modifiersData[r]=o}const s2={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:nN};function rN(n){var e=n.state,t=n.name;e.modifiersData[t]=n2({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Z_={name:"popperOffsets",enabled:!0,phase:"read",fn:rN,data:{}};function iN(n){return n==="x"?"y":"x"}function sN(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,a=i===void 0?!0:i,o=t.altAxis,c=o===void 0?!1:o,f=t.boundary,h=t.rootBoundary,d=t.altBoundary,g=t.padding,m=t.tether,v=m===void 0?!0:m,y=t.tetherOffset,b=y===void 0?0:y,A=Ju(e,{boundary:f,rootBoundary:h,padding:g,altBoundary:d}),w=Ia(e.placement),C=Zu(e.placement),T=!C,R=W_(w),N=iN(R),I=e.modifiersData.popperOffsets,D=e.rects.reference,B=e.rects.popper,U=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,Y=typeof U=="number"?{mainAxis:U,altAxis:U}:Object.assign({mainAxis:0,altAxis:0},U),W=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,re={x:0,y:0};if(I){if(a){var Te,Fe=R==="y"?xi:yi,we=R==="y"?ls:cs,q=R==="y"?"height":"width",ee=I[R],Pe=ee+A[Fe],qe=ee-A[we],P=v?-B[q]/2:0,ye=C===_c?D[q]:B[q],ve=C===_c?-B[q]:-D[q],ge=e.elements.arrow,Ce=v&&ge?V_(ge):{width:0,height:0},He=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:QS(),Ie=He[Fe],Ge=He[we],k=nd(0,D[q],Ce[q]),se=T?D[q]/2-P-k-Ie-Y.mainAxis:ye-k-Ie-Y.mainAxis,Z=T?-D[q]/2+P+k+Ge+Y.mainAxis:ve+k+Ge+Y.mainAxis,J=e.elements.arrow&&kd(e.elements.arrow),xe=J?R==="y"?J.clientTop||0:J.clientLeft||0:0,be=(Te=W?.[R])!=null?Te:0,Se=ee+se-be-xe,Ye=ee+Z-be,De=nd(v?dg(Pe,Se):Pe,ee,v?mc(qe,Ye):qe);I[R]=De,re[R]=De-ee}if(c){var nt,rt=R==="x"?xi:yi,ht=R==="x"?ls:cs,Rt=I[N],kt=N==="y"?"height":"width",nn=Rt+A[rt],Qe=Rt-A[ht],Ct=[xi,yi].indexOf(w)!==-1,je=(nt=W?.[N])!=null?nt:0,Tn=Ct?nn:Rt-D[kt]-B[kt]-je+Y.altAxis,zt=Ct?Rt+D[kt]+B[kt]-je-Y.altAxis:Qe,It=v&&Ct?FR(Tn,Rt,zt):nd(v?Tn:nn,Rt,v?zt:Qe);I[N]=It,re[N]=It-Rt}e.modifiersData[r]=re}}const a2={name:"preventOverflow",enabled:!0,phase:"main",fn:sN,requiresIfExists:["offset"]};function aN(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function oN(n){return n===us(n)||!Ns(n)?q_(n):aN(n)}function lN(n){var e=n.getBoundingClientRect(),t=Ku(e.width)/n.offsetWidth||1,r=Ku(e.height)/n.offsetHeight||1;return t!==1||r!==1}function cN(n,e,t){t===void 0&&(t=!1);var r=Ns(e),i=Ns(e)&&lN(e),a=Tl(e),o=Qu(n,i,t),c={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(r||!r&&!t)&&((Fa(e)!=="body"||Q_(a))&&(c=oN(e)),Ns(e)?(f=Qu(e,!0),f.x+=e.clientLeft,f.y+=e.clientTop):a&&(f.x=K_(a))),{x:o.left+c.scrollLeft-f.x,y:o.top+c.scrollTop-f.y,width:o.width,height:o.height}}function uN(n){var e=new Map,t=new Set,r=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var o=[].concat(a.requires||[],a.requiresIfExists||[]);o.forEach(function(c){if(!t.has(c)){var f=e.get(c);f&&i(f)}}),r.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),r}function fN(n){var e=uN(n);return YS.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function hN(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function dN(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var qE={placement:"bottom",modifiers:[],strategy:"absolute"};function KE(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Zg(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?qE:i;return function(c,f,h){h===void 0&&(h=a);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},qE,a),modifiersData:{},elements:{reference:c,popper:f},attributes:{},styles:{}},g=[],m=!1,v={state:d,setOptions:function(w){var C=typeof w=="function"?w(d.options):w;b(),d.options=Object.assign({},a,d.options,C),d.scrollParents={reference:xc(c)?rd(c):c.contextElement?rd(c.contextElement):[],popper:rd(f)};var T=fN(dN([].concat(r,d.options.modifiers)));return d.orderedModifiers=T.filter(function(R){return R.enabled}),y(),v.update()},forceUpdate:function(){if(!m){var w=d.elements,C=w.reference,T=w.popper;if(KE(C,T)){d.rects={reference:cN(C,kd(T),d.options.strategy==="fixed"),popper:V_(T)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(Y){return d.modifiersData[Y.name]=Object.assign({},Y.data)});for(var R=0;R<d.orderedModifiers.length;R++){if(d.reset===!0){d.reset=!1,R=-1;continue}var N=d.orderedModifiers[R],I=N.fn,D=N.options,B=D===void 0?{}:D,U=N.name;typeof I=="function"&&(d=I({state:d,options:B,name:U,instance:v})||d)}}}},update:hN(function(){return new Promise(function(A){v.forceUpdate(),A(d)})}),destroy:function(){b(),m=!0}};if(!KE(c,f))return v;v.setOptions(h).then(function(A){!m&&h.onFirstUpdate&&h.onFirstUpdate(A)});function y(){d.orderedModifiers.forEach(function(A){var w=A.name,C=A.options,T=C===void 0?{}:C,R=A.effect;if(typeof R=="function"){var N=R({state:d,name:w,instance:v,options:T}),I=function(){};g.push(N||I)}})}function b(){g.forEach(function(A){return A()}),g=[]}return v}}var pN=Zg(),gN=[Y_,Z_,X_,G_],mN=Zg({defaultModifiers:gN}),vN=[Y_,Z_,X_,G_,s2,r2,a2,e2,i2],J_=Zg({defaultModifiers:vN});const o2=Object.freeze(Object.defineProperty({__proto__:null,afterMain:GS,afterRead:zS,afterWrite:XS,applyStyles:G_,arrow:e2,auto:Kg,basePlacements:cf,beforeMain:jS,beforeRead:US,beforeWrite:VS,bottom:ls,clippingParents:PS,computeStyles:X_,createPopper:J_,createPopperBase:pN,createPopperLite:mN,detectOverflow:Ju,end:qu,eventListeners:Y_,flip:r2,hide:i2,left:yi,main:$S,modifierPhases:YS,offset:s2,placements:j_,popper:Ou,popperGenerator:Zg,popperOffsets:Z_,preventOverflow:a2,read:HS,reference:BS,right:cs,start:_c,top:xi,variationPlacements:l_,viewport:z_,write:WS},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.7 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const hl=new Map,ov={set(n,e,t){hl.has(n)||hl.set(n,new Map);const r=hl.get(n);if(!r.has(e)&&r.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`);return}r.set(e,t)},get(n,e){return hl.has(n)&&hl.get(n).get(e)||null},remove(n,e){if(!hl.has(n))return;const t=hl.get(n);t.delete(e),t.size===0&&hl.delete(n)}},_N=1e6,xN=1e3,f_="transitionend",l2=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),yN=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),bN=n=>{do n+=Math.floor(Math.random()*_N);while(document.getElementById(n));return n},EN=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const r=Number.parseFloat(e),i=Number.parseFloat(t);return!r&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*xN)},c2=n=>{n.dispatchEvent(new Event(f_))},bo=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),_l=n=>bo(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(l2(n)):null,uf=n=>{if(!bo(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const r=n.closest("summary");if(r&&r.parentNode!==t||r===null)return!1}return e},xl=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",u2=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?u2(n.parentNode):null},pg=()=>{},Fd=n=>{n.offsetHeight},f2=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,lv=[],AN=n=>{document.readyState==="loading"?(lv.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of lv)e()}),lv.push(n)):n()},Ms=()=>document.documentElement.dir==="rtl",Fs=n=>{AN(()=>{const e=f2();if(e){const t=n.NAME,r=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=r,n.jQueryInterface)}})},Bi=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,h2=(n,e,t=!0)=>{if(!t){Bi(n);return}const i=EN(e)+5;let a=!1;const o=({target:c})=>{c===e&&(a=!0,e.removeEventListener(f_,o),Bi(n))};e.addEventListener(f_,o),setTimeout(()=>{a||c2(e)},i)},ex=(n,e,t,r)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&r?n[i-1]:n[0]:(a+=t?1:-1,r&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},wN=/[^.]*(?=\..*)\.|.*/,SN=/\..*/,TN=/::\d+$/,cv={};let QE=1;const d2={mouseenter:"mouseover",mouseleave:"mouseout"},CN=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function p2(n,e){return e&&`${e}::${QE++}`||n.uidEvent||QE++}function g2(n){const e=p2(n);return n.uidEvent=e,cv[e]=cv[e]||{},cv[e]}function DN(n,e){return function t(r){return tx(r,{delegateTarget:n}),t.oneOff&&ze.off(n,r.type,e),e.apply(n,[r])}}function ON(n,e,t){return function r(i){const a=n.querySelectorAll(e);for(let{target:o}=i;o&&o!==this;o=o.parentNode)for(const c of a)if(c===o)return tx(i,{delegateTarget:o}),r.oneOff&&ze.off(n,i.type,e,t),t.apply(o,[i])}}function m2(n,e,t=null){return Object.values(n).find(r=>r.callable===e&&r.delegationSelector===t)}function v2(n,e,t){const r=typeof e=="string",i=r?t:e||t;let a=_2(n);return CN.has(a)||(a=n),[r,i,a]}function ZE(n,e,t,r,i){if(typeof e!="string"||!n)return;let[a,o,c]=v2(e,t,r);e in d2&&(o=(y=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return y.call(this,b)})(o));const f=g2(n),h=f[c]||(f[c]={}),d=m2(h,o,a?t:null);if(d){d.oneOff=d.oneOff&&i;return}const g=p2(o,e.replace(wN,"")),m=a?ON(n,t,o):DN(n,o);m.delegationSelector=a?t:null,m.callable=o,m.oneOff=i,m.uidEvent=g,h[g]=m,n.addEventListener(c,m,a)}function h_(n,e,t,r,i){const a=m2(e[t],r,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function RN(n,e,t,r){const i=e[t]||{};for(const[a,o]of Object.entries(i))a.includes(r)&&h_(n,e,t,o.callable,o.delegationSelector)}function _2(n){return n=n.replace(SN,""),d2[n]||n}const ze={on(n,e,t,r){ZE(n,e,t,r,!1)},one(n,e,t,r){ZE(n,e,t,r,!0)},off(n,e,t,r){if(typeof e!="string"||!n)return;const[i,a,o]=v2(e,t,r),c=o!==e,f=g2(n),h=f[o]||{},d=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(h).length)return;h_(n,f,o,a,i?t:null);return}if(d)for(const g of Object.keys(f))RN(n,f,g,e.slice(1));for(const[g,m]of Object.entries(h)){const v=g.replace(TN,"");(!c||e.includes(v))&&h_(n,f,o,m.callable,m.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const r=f2(),i=_2(e),a=e!==i;let o=null,c=!0,f=!0,h=!1;a&&r&&(o=r.Event(e,t),r(n).trigger(o),c=!o.isPropagationStopped(),f=!o.isImmediatePropagationStopped(),h=o.isDefaultPrevented());const d=tx(new Event(e,{bubbles:c,cancelable:!0}),t);return h&&d.preventDefault(),f&&n.dispatchEvent(d),d.defaultPrevented&&o&&o.preventDefault(),d}};function tx(n,e={}){for(const[t,r]of Object.entries(e))try{n[t]=r}catch{Object.defineProperty(n,t,{configurable:!0,get(){return r}})}return n}function JE(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function uv(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Eo={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${uv(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${uv(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(r=>r.startsWith("bs")&&!r.startsWith("bsConfig"));for(const r of t){let i=r.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=JE(n.dataset[r])}return e},getDataAttribute(n,e){return JE(n.getAttribute(`data-bs-${uv(e)}`))}};class Pd{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const r=bo(t)?Eo.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof r=="object"?r:{},...bo(t)?Eo.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[r,i]of Object.entries(t)){const a=e[r],o=bo(a)?"element":yN(a);if(!new RegExp(i).test(o))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${r}" provided type "${o}" but expected type "${i}".`)}}}const NN="5.3.7";class ta extends Pd{constructor(e,t){super(),e=_l(e),e&&(this._element=e,this._config=this._getConfig(t),ov.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ov.remove(this._element,this.constructor.DATA_KEY),ze.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,r=!0){h2(e,t,r)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ov.get(_l(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return NN}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const fv=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>l2(t)).join(","):null},mt={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let r=n.parentNode.closest(e);for(;r;)t.push(r),r=r.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!xl(t)&&uf(t))},getSelectorFromElement(n){const e=fv(n);return e&&mt.findOne(e)?e:null},getElementFromSelector(n){const e=fv(n);return e?mt.findOne(e):null},getMultipleElementsFromSelector(n){const e=fv(n);return e?mt.find(e):[]}},Jg=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,r=n.NAME;ze.on(document,t,`[data-bs-dismiss="${r}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),xl(this))return;const a=mt.getElementFromSelector(this)||this.closest(`.${r}`);n.getOrCreateInstance(a)[e]()})},LN="alert",MN="bs.alert",x2=`.${MN}`,IN=`close${x2}`,kN=`closed${x2}`,FN="fade",PN="show";class em extends ta{static get NAME(){return LN}close(){if(ze.trigger(this._element,IN).defaultPrevented)return;this._element.classList.remove(PN);const t=this._element.classList.contains(FN);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),ze.trigger(this._element,kN),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=em.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}Jg(em,"close");Fs(em);const BN="button",UN="bs.button",HN=`.${UN}`,zN=".data-api",jN="active",eA='[data-bs-toggle="button"]',$N=`click${HN}${zN}`;class tm extends ta{static get NAME(){return BN}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(jN))}static jQueryInterface(e){return this.each(function(){const t=tm.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}ze.on(document,$N,eA,n=>{n.preventDefault();const e=n.target.closest(eA);tm.getOrCreateInstance(e).toggle()});Fs(tm);const GN="swipe",ff=".bs.swipe",VN=`touchstart${ff}`,WN=`touchmove${ff}`,XN=`touchend${ff}`,YN=`pointerdown${ff}`,qN=`pointerup${ff}`,KN="touch",QN="pen",ZN="pointer-event",JN=40,e4={endCallback:null,leftCallback:null,rightCallback:null},t4={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class gg extends Pd{constructor(e,t){super(),this._element=e,!(!e||!gg.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return e4}static get DefaultType(){return t4}static get NAME(){return GN}dispose(){ze.off(this._element,ff)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Bi(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=JN)return;const t=e/this._deltaX;this._deltaX=0,t&&Bi(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(ze.on(this._element,YN,e=>this._start(e)),ze.on(this._element,qN,e=>this._end(e)),this._element.classList.add(ZN)):(ze.on(this._element,VN,e=>this._start(e)),ze.on(this._element,WN,e=>this._move(e)),ze.on(this._element,XN,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===QN||e.pointerType===KN)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const n4="carousel",r4="bs.carousel",Cl=`.${r4}`,y2=".data-api",i4="ArrowLeft",s4="ArrowRight",a4=500,jh="next",Su="prev",Ru="left",og="right",o4=`slide${Cl}`,hv=`slid${Cl}`,l4=`keydown${Cl}`,c4=`mouseenter${Cl}`,u4=`mouseleave${Cl}`,f4=`dragstart${Cl}`,h4=`load${Cl}${y2}`,d4=`click${Cl}${y2}`,b2="carousel",Ip="active",p4="slide",g4="carousel-item-end",m4="carousel-item-start",v4="carousel-item-next",_4="carousel-item-prev",E2=".active",A2=".carousel-item",x4=E2+A2,y4=".carousel-item img",b4=".carousel-indicators",E4="[data-bs-slide], [data-bs-slide-to]",A4='[data-bs-ride="carousel"]',w4={[i4]:og,[s4]:Ru},S4={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},T4={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Bd extends ta{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=mt.findOne(b4,this._element),this._addEventListeners(),this._config.ride===b2&&this.cycle()}static get Default(){return S4}static get DefaultType(){return T4}static get NAME(){return n4}next(){this._slide(jh)}nextWhenVisible(){!document.hidden&&uf(this._element)&&this.next()}prev(){this._slide(Su)}pause(){this._isSliding&&c2(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){ze.one(this._element,hv,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){ze.one(this._element,hv,()=>this.to(e));return}const r=this._getItemIndex(this._getActive());if(r===e)return;const i=e>r?jh:Su;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&ze.on(this._element,l4,e=>this._keydown(e)),this._config.pause==="hover"&&(ze.on(this._element,c4,()=>this.pause()),ze.on(this._element,u4,()=>this._maybeEnableCycle())),this._config.touch&&gg.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const r of mt.find(y4,this._element))ze.on(r,f4,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(Ru)),rightCallback:()=>this._slide(this._directionToOrder(og)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),a4+this._config.interval))}};this._swipeHelper=new gg(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=w4[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=mt.findOne(E2,this._indicatorsElement);t.classList.remove(Ip),t.removeAttribute("aria-current");const r=mt.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);r&&(r.classList.add(Ip),r.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const r=this._getActive(),i=e===jh,a=t||ex(this._getItems(),r,i,this._config.wrap);if(a===r)return;const o=this._getItemIndex(a),c=v=>ze.trigger(this._element,v,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(r),to:o});if(c(o4).defaultPrevented||!r||!a)return;const h=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(o),this._activeElement=a;const d=i?m4:g4,g=i?v4:_4;a.classList.add(g),Fd(a),r.classList.add(d),a.classList.add(d);const m=()=>{a.classList.remove(d,g),a.classList.add(Ip),r.classList.remove(Ip,g,d),this._isSliding=!1,c(hv)};this._queueCallback(m,r,this._isAnimated()),h&&this.cycle()}_isAnimated(){return this._element.classList.contains(p4)}_getActive(){return mt.findOne(x4,this._element)}_getItems(){return mt.find(A2,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ms()?e===Ru?Su:jh:e===Ru?jh:Su}_orderToDirection(e){return Ms()?e===Su?Ru:og:e===Su?og:Ru}static jQueryInterface(e){return this.each(function(){const t=Bd.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}ze.on(document,d4,E4,function(n){const e=mt.getElementFromSelector(this);if(!e||!e.classList.contains(b2))return;n.preventDefault();const t=Bd.getOrCreateInstance(e),r=this.getAttribute("data-bs-slide-to");if(r){t.to(r),t._maybeEnableCycle();return}if(Eo.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});ze.on(window,h4,()=>{const n=mt.find(A4);for(const e of n)Bd.getOrCreateInstance(e)});Fs(Bd);const C4="collapse",D4="bs.collapse",Ud=`.${D4}`,O4=".data-api",R4=`show${Ud}`,N4=`shown${Ud}`,L4=`hide${Ud}`,M4=`hidden${Ud}`,I4=`click${Ud}${O4}`,dv="show",ku="collapse",kp="collapsing",k4="collapsed",F4=`:scope .${ku} .${ku}`,P4="collapse-horizontal",B4="width",U4="height",H4=".collapse.show, .collapse.collapsing",d_='[data-bs-toggle="collapse"]',z4={parent:null,toggle:!0},j4={parent:"(null|element)",toggle:"boolean"};class pd extends ta{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const r=mt.find(d_);for(const i of r){const a=mt.getSelectorFromElement(i),o=mt.find(a).filter(c=>c===this._element);a!==null&&o.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return z4}static get DefaultType(){return j4}static get NAME(){return C4}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(H4).filter(c=>c!==this._element).map(c=>pd.getOrCreateInstance(c,{toggle:!1}))),e.length&&e[0]._isTransitioning||ze.trigger(this._element,R4).defaultPrevented)return;for(const c of e)c.hide();const r=this._getDimension();this._element.classList.remove(ku),this._element.classList.add(kp),this._element.style[r]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(kp),this._element.classList.add(ku,dv),this._element.style[r]="",ze.trigger(this._element,N4)},o=`scroll${r[0].toUpperCase()+r.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[r]=`${this._element[o]}px`}hide(){if(this._isTransitioning||!this._isShown()||ze.trigger(this._element,L4).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Fd(this._element),this._element.classList.add(kp),this._element.classList.remove(ku,dv);for(const i of this._triggerArray){const a=mt.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const r=()=>{this._isTransitioning=!1,this._element.classList.remove(kp),this._element.classList.add(ku),ze.trigger(this._element,M4)};this._element.style[t]="",this._queueCallback(r,this._element,!0)}_isShown(e=this._element){return e.classList.contains(dv)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=_l(e.parent),e}_getDimension(){return this._element.classList.contains(P4)?B4:U4}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(d_);for(const t of e){const r=mt.getElementFromSelector(t);r&&this._addAriaAndCollapsedClass([t],this._isShown(r))}}_getFirstLevelChildren(e){const t=mt.find(F4,this._config.parent);return mt.find(e,this._config.parent).filter(r=>!t.includes(r))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const r of e)r.classList.toggle(k4,!t),r.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const r=pd.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e]()}})}}ze.on(document,I4,d_,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of mt.getMultipleElementsFromSelector(this))pd.getOrCreateInstance(e,{toggle:!1}).toggle()});Fs(pd);const tA="dropdown",$4="bs.dropdown",Rc=`.${$4}`,nx=".data-api",G4="Escape",nA="Tab",V4="ArrowUp",rA="ArrowDown",W4=2,X4=`hide${Rc}`,Y4=`hidden${Rc}`,q4=`show${Rc}`,K4=`shown${Rc}`,w2=`click${Rc}${nx}`,S2=`keydown${Rc}${nx}`,Q4=`keyup${Rc}${nx}`,Nu="show",Z4="dropup",J4="dropend",eL="dropstart",tL="dropup-center",nL="dropdown-center",uc='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',rL=`${uc}.${Nu}`,lg=".dropdown-menu",iL=".navbar",sL=".navbar-nav",aL=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",oL=Ms()?"top-end":"top-start",lL=Ms()?"top-start":"top-end",cL=Ms()?"bottom-end":"bottom-start",uL=Ms()?"bottom-start":"bottom-end",fL=Ms()?"left-start":"right-start",hL=Ms()?"right-start":"left-start",dL="top",pL="bottom",gL={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},mL={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ka extends ta{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=mt.next(this._element,lg)[0]||mt.prev(this._element,lg)[0]||mt.findOne(lg,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return gL}static get DefaultType(){return mL}static get NAME(){return tA}toggle(){return this._isShown()?this.hide():this.show()}show(){if(xl(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!ze.trigger(this._element,q4,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(sL))for(const r of[].concat(...document.body.children))ze.on(r,"mouseover",pg);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Nu),this._element.classList.add(Nu),ze.trigger(this._element,K4,e)}}hide(){if(xl(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!ze.trigger(this._element,X4,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))ze.off(r,"mouseover",pg);this._popper&&this._popper.destroy(),this._menu.classList.remove(Nu),this._element.classList.remove(Nu),this._element.setAttribute("aria-expanded","false"),Eo.removeDataAttribute(this._menu,"popper"),ze.trigger(this._element,Y4,e),this._element.focus()}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!bo(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${tA.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof o2>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:bo(this._config.reference)?e=_l(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=J_(e,this._menu,t)}_isShown(){return this._menu.classList.contains(Nu)}_getPlacement(){const e=this._parent;if(e.classList.contains(J4))return fL;if(e.classList.contains(eL))return hL;if(e.classList.contains(tL))return dL;if(e.classList.contains(nL))return pL;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Z4)?t?lL:oL:t?uL:cL}_detectNavbar(){return this._element.closest(iL)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Eo.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Bi(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const r=mt.find(aL,this._menu).filter(i=>uf(i));r.length&&ex(r,t,e===rA,!r.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=ka.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===W4||e.type==="keyup"&&e.key!==nA)return;const t=mt.find(rL);for(const r of t){const i=ka.getInstance(r);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),o=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!o||i._config.autoClose==="outside"&&o||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===nA||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const c={relatedTarget:i._element};e.type==="click"&&(c.clickEvent=e),i._completeHide(c)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),r=e.key===G4,i=[V4,rA].includes(e.key);if(!i&&!r||t&&!r)return;e.preventDefault();const a=this.matches(uc)?this:mt.prev(this,uc)[0]||mt.next(this,uc)[0]||mt.findOne(uc,e.delegateTarget.parentNode),o=ka.getOrCreateInstance(a);if(i){e.stopPropagation(),o.show(),o._selectMenuItem(e);return}o._isShown()&&(e.stopPropagation(),o.hide(),a.focus())}}ze.on(document,S2,uc,ka.dataApiKeydownHandler);ze.on(document,S2,lg,ka.dataApiKeydownHandler);ze.on(document,w2,ka.clearMenus);ze.on(document,Q4,ka.clearMenus);ze.on(document,w2,uc,function(n){n.preventDefault(),ka.getOrCreateInstance(this).toggle()});Fs(ka);const T2="backdrop",vL="fade",iA="show",sA=`mousedown.bs.${T2}`,_L={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},xL={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class C2 extends Pd{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return _L}static get DefaultType(){return xL}static get NAME(){return T2}show(e){if(!this._config.isVisible){Bi(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Fd(t),t.classList.add(iA),this._emulateAnimation(()=>{Bi(e)})}hide(e){if(!this._config.isVisible){Bi(e);return}this._getElement().classList.remove(iA),this._emulateAnimation(()=>{this.dispose(),Bi(e)})}dispose(){this._isAppended&&(ze.off(this._element,sA),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(vL),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=_l(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),ze.on(e,sA,()=>{Bi(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){h2(e,this._getElement(),this._config.isAnimated)}}const yL="focustrap",bL="bs.focustrap",mg=`.${bL}`,EL=`focusin${mg}`,AL=`keydown.tab${mg}`,wL="Tab",SL="forward",aA="backward",TL={autofocus:!0,trapElement:null},CL={autofocus:"boolean",trapElement:"element"};class D2 extends Pd{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return TL}static get DefaultType(){return CL}static get NAME(){return yL}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),ze.off(document,mg),ze.on(document,EL,e=>this._handleFocusin(e)),ze.on(document,AL,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,ze.off(document,mg))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const r=mt.focusableChildren(t);r.length===0?t.focus():this._lastTabNavDirection===aA?r[r.length-1].focus():r[0].focus()}_handleKeydown(e){e.key===wL&&(this._lastTabNavDirection=e.shiftKey?aA:SL)}}const oA=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",lA=".sticky-top",Fp="padding-right",cA="margin-right";class p_{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Fp,t=>t+e),this._setElementAttributes(oA,Fp,t=>t+e),this._setElementAttributes(lA,cA,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Fp),this._resetElementAttributes(oA,Fp),this._resetElementAttributes(lA,cA)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,r){const i=this.getWidth(),a=o=>{if(o!==this._element&&window.innerWidth>o.clientWidth+i)return;this._saveInitialAttribute(o,t);const c=window.getComputedStyle(o).getPropertyValue(t);o.style.setProperty(t,`${r(Number.parseFloat(c))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const r=e.style.getPropertyValue(t);r&&Eo.setDataAttribute(e,t,r)}_resetElementAttributes(e,t){const r=i=>{const a=Eo.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}Eo.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,r)}_applyManipulationCallback(e,t){if(bo(e)){t(e);return}for(const r of mt.find(e,this._element))t(r)}}const DL="modal",OL="bs.modal",Is=`.${OL}`,RL=".data-api",NL="Escape",LL=`hide${Is}`,ML=`hidePrevented${Is}`,O2=`hidden${Is}`,R2=`show${Is}`,IL=`shown${Is}`,kL=`resize${Is}`,FL=`click.dismiss${Is}`,PL=`mousedown.dismiss${Is}`,BL=`keydown.dismiss${Is}`,UL=`click${Is}${RL}`,uA="modal-open",HL="fade",fA="show",pv="modal-static",zL=".modal.show",jL=".modal-dialog",$L=".modal-body",GL='[data-bs-toggle="modal"]',VL={backdrop:!0,focus:!0,keyboard:!0},WL={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class yc extends ta{constructor(e,t){super(e,t),this._dialog=mt.findOne(jL,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new p_,this._addEventListeners()}static get Default(){return VL}static get DefaultType(){return WL}static get NAME(){return DL}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||ze.trigger(this._element,R2,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(uA),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||ze.trigger(this._element,LL).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(fA),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){ze.off(window,Is),ze.off(this._dialog,Is),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new C2({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new D2({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=mt.findOne($L,this._dialog);t&&(t.scrollTop=0),Fd(this._element),this._element.classList.add(fA);const r=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,ze.trigger(this._element,IL,{relatedTarget:e})};this._queueCallback(r,this._dialog,this._isAnimated())}_addEventListeners(){ze.on(this._element,BL,e=>{if(e.key===NL){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),ze.on(window,kL,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),ze.on(this._element,PL,e=>{ze.one(this._element,FL,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(uA),this._resetAdjustments(),this._scrollBar.reset(),ze.trigger(this._element,O2)})}_isAnimated(){return this._element.classList.contains(HL)}_triggerBackdropTransition(){if(ze.trigger(this._element,ML).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,r=this._element.style.overflowY;r==="hidden"||this._element.classList.contains(pv)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(pv),this._queueCallback(()=>{this._element.classList.remove(pv),this._queueCallback(()=>{this._element.style.overflowY=r},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),r=t>0;if(r&&!e){const i=Ms()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!r&&e){const i=Ms()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const r=yc.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof r[e]>"u")throw new TypeError(`No method named "${e}"`);r[e](t)}})}}ze.on(document,UL,GL,function(n){const e=mt.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),ze.one(e,R2,i=>{i.defaultPrevented||ze.one(e,O2,()=>{uf(this)&&this.focus()})});const t=mt.findOne(zL);t&&yc.getInstance(t).hide(),yc.getOrCreateInstance(e).toggle(this)});Jg(yc);Fs(yc);const XL="offcanvas",YL="bs.offcanvas",No=`.${YL}`,N2=".data-api",qL=`load${No}${N2}`,KL="Escape",hA="show",dA="showing",pA="hiding",QL="offcanvas-backdrop",L2=".offcanvas.show",ZL=`show${No}`,JL=`shown${No}`,eM=`hide${No}`,gA=`hidePrevented${No}`,M2=`hidden${No}`,tM=`resize${No}`,nM=`click${No}${N2}`,rM=`keydown.dismiss${No}`,iM='[data-bs-toggle="offcanvas"]',sM={backdrop:!0,keyboard:!0,scroll:!1},aM={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class yl extends ta{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return sM}static get DefaultType(){return aM}static get NAME(){return XL}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||ze.trigger(this._element,ZL,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new p_().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(dA);const r=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(hA),this._element.classList.remove(dA),ze.trigger(this._element,JL,{relatedTarget:e})};this._queueCallback(r,this._element,!0)}hide(){if(!this._isShown||ze.trigger(this._element,eM).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(pA),this._backdrop.hide();const t=()=>{this._element.classList.remove(hA,pA),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new p_().reset(),ze.trigger(this._element,M2)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){ze.trigger(this._element,gA);return}this.hide()},t=!!this._config.backdrop;return new C2({className:QL,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new D2({trapElement:this._element})}_addEventListeners(){ze.on(this._element,rM,e=>{if(e.key===KL){if(this._config.keyboard){this.hide();return}ze.trigger(this._element,gA)}})}static jQueryInterface(e){return this.each(function(){const t=yl.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ze.on(document,nM,iM,function(n){const e=mt.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),xl(this))return;ze.one(e,M2,()=>{uf(this)&&this.focus()});const t=mt.findOne(L2);t&&t!==e&&yl.getInstance(t).hide(),yl.getOrCreateInstance(e).toggle(this)});ze.on(window,qL,()=>{for(const n of mt.find(L2))yl.getOrCreateInstance(n).show()});ze.on(window,tM,()=>{for(const n of mt.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&yl.getOrCreateInstance(n).hide()});Jg(yl);Fs(yl);const oM=/^aria-[\w-]*$/i,I2={"*":["class","dir","id","lang","role",oM],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},lM=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),cM=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,uM=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?lM.has(t)?!!cM.test(n.nodeValue):!0:e.filter(r=>r instanceof RegExp).some(r=>r.test(t))};function fM(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const o of a){const c=o.nodeName.toLowerCase();if(!Object.keys(e).includes(c)){o.remove();continue}const f=[].concat(...o.attributes),h=[].concat(e["*"]||[],e[c]||[]);for(const d of f)uM(d,h)||o.removeAttribute(d.nodeName)}return i.body.innerHTML}const hM="TemplateFactory",dM={allowList:I2,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},pM={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},gM={entry:"(string|element|function|null)",selector:"(string|element)"};class mM extends Pd{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return dM}static get DefaultType(){return pM}static get NAME(){return hM}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],r=this._resolvePossibleFunction(this._config.extraClass);return r&&t.classList.add(...r.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,r]of Object.entries(e))super._typeCheckConfig({selector:t,entry:r},gM)}_setContent(e,t,r){const i=mt.findOne(r,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(bo(t)){this._putElementInTemplate(_l(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?fM(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Bi(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const vM="tooltip",_M=new Set(["sanitize","allowList","sanitizeFn"]),gv="fade",xM="modal",Pp="show",yM=".tooltip-inner",mA=`.${xM}`,vA="hide.bs.modal",$h="hover",mv="focus",vv="click",bM="manual",EM="hide",AM="hidden",wM="show",SM="shown",TM="inserted",CM="click",DM="focusin",OM="focusout",RM="mouseenter",NM="mouseleave",LM={AUTO:"auto",TOP:"top",RIGHT:Ms()?"left":"right",BOTTOM:"bottom",LEFT:Ms()?"right":"left"},MM={allowList:I2,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},IM={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class hf extends ta{constructor(e,t){if(typeof o2>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return MM}static get DefaultType(){return IM}static get NAME(){return vM}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),ze.off(this._element.closest(mA),vA,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=ze.trigger(this._element,this.constructor.eventName(wM)),r=(u2(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!r)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),ze.trigger(this._element,this.constructor.eventName(TM))),this._popper=this._createPopper(i),i.classList.add(Pp),"ontouchstart"in document.documentElement)for(const c of[].concat(...document.body.children))ze.on(c,"mouseover",pg);const o=()=>{ze.trigger(this._element,this.constructor.eventName(SM)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(o,this.tip,this._isAnimated())}hide(){if(!this._isShown()||ze.trigger(this._element,this.constructor.eventName(EM)).defaultPrevented)return;if(this._getTipElement().classList.remove(Pp),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))ze.off(i,"mouseover",pg);this._activeTrigger[vv]=!1,this._activeTrigger[mv]=!1,this._activeTrigger[$h]=!1,this._isHovered=null;const r=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),ze.trigger(this._element,this.constructor.eventName(AM)))};this._queueCallback(r,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(gv,Pp),t.classList.add(`bs-${this.constructor.NAME}-auto`);const r=bN(this.constructor.NAME).toString();return t.setAttribute("id",r),this._isAnimated()&&t.classList.add(gv),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new mM({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[yM]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(gv)}_isShown(){return this.tip&&this.tip.classList.contains(Pp)}_createPopper(e){const t=Bi(this._config.placement,[this,e,this._element]),r=LM[t.toUpperCase()];return J_(this._element,e,this._getPopperConfig(r))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Bi(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:r=>{this._getTipElement().setAttribute("data-popper-placement",r.state.placement)}}]};return{...t,...Bi(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")ze.on(this._element,this.constructor.eventName(CM),this._config.selector,r=>{const i=this._initializeOnDelegatedTarget(r);i._activeTrigger[vv]=!(i._isShown()&&i._activeTrigger[vv]),i.toggle()});else if(t!==bM){const r=t===$h?this.constructor.eventName(RM):this.constructor.eventName(DM),i=t===$h?this.constructor.eventName(NM):this.constructor.eventName(OM);ze.on(this._element,r,this._config.selector,a=>{const o=this._initializeOnDelegatedTarget(a);o._activeTrigger[a.type==="focusin"?mv:$h]=!0,o._enter()}),ze.on(this._element,i,this._config.selector,a=>{const o=this._initializeOnDelegatedTarget(a);o._activeTrigger[a.type==="focusout"?mv:$h]=o._element.contains(a.relatedTarget),o._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},ze.on(this._element.closest(mA),vA,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Eo.getDataAttributes(this._element);for(const r of Object.keys(t))_M.has(r)&&delete t[r];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:_l(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,r]of Object.entries(this._config))this.constructor.Default[t]!==r&&(e[t]=r);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=hf.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Fs(hf);const kM="popover",FM=".popover-header",PM=".popover-body",BM={...hf.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},UM={...hf.DefaultType,content:"(null|string|element|function)"};class rx extends hf{static get Default(){return BM}static get DefaultType(){return UM}static get NAME(){return kM}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[FM]:this._getTitle(),[PM]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=rx.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Fs(rx);const HM="scrollspy",zM="bs.scrollspy",ix=`.${zM}`,jM=".data-api",$M=`activate${ix}`,_A=`click${ix}`,GM=`load${ix}${jM}`,VM="dropdown-item",Tu="active",WM='[data-bs-spy="scroll"]',_v="[href]",XM=".nav, .list-group",xA=".nav-link",YM=".nav-item",qM=".list-group-item",KM=`${xA}, ${YM} > ${xA}, ${qM}`,QM=".dropdown",ZM=".dropdown-toggle",JM={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},e3={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class nm extends ta{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return JM}static get DefaultType(){return e3}static get NAME(){return HM}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=_l(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(ze.off(this._config.target,_A),ze.on(this._config.target,_A,_v,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const r=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(r.scrollTo){r.scrollTo({top:i,behavior:"smooth"});return}r.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=o=>this._targetLinks.get(`#${o.target.id}`),r=o=>{this._previousScrollData.visibleEntryTop=o.target.offsetTop,this._process(t(o))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const o of e){if(!o.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(o));continue}const c=o.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&c){if(r(o),!i)return;continue}!a&&!c&&r(o)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=mt.find(_v,this._config.target);for(const t of e){if(!t.hash||xl(t))continue;const r=mt.findOne(decodeURI(t.hash),this._element);uf(r)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,r))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Tu),this._activateParents(e),ze.trigger(this._element,$M,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(VM)){mt.findOne(ZM,e.closest(QM)).classList.add(Tu);return}for(const t of mt.parents(e,XM))for(const r of mt.prev(t,KM))r.classList.add(Tu)}_clearActiveClass(e){e.classList.remove(Tu);const t=mt.find(`${_v}.${Tu}`,e);for(const r of t)r.classList.remove(Tu)}static jQueryInterface(e){return this.each(function(){const t=nm.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}ze.on(window,GM,()=>{for(const n of mt.find(WM))nm.getOrCreateInstance(n)});Fs(nm);const t3="tab",n3="bs.tab",Nc=`.${n3}`,r3=`hide${Nc}`,i3=`hidden${Nc}`,s3=`show${Nc}`,a3=`shown${Nc}`,o3=`click${Nc}`,l3=`keydown${Nc}`,c3=`load${Nc}`,u3="ArrowLeft",yA="ArrowRight",f3="ArrowUp",bA="ArrowDown",xv="Home",EA="End",fc="active",AA="fade",yv="show",h3="dropdown",k2=".dropdown-toggle",d3=".dropdown-menu",bv=`:not(${k2})`,p3='.list-group, .nav, [role="tablist"]',g3=".nav-item, .list-group-item",m3=`.nav-link${bv}, .list-group-item${bv}, [role="tab"]${bv}`,F2='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ev=`${m3}, ${F2}`,v3=`.${fc}[data-bs-toggle="tab"], .${fc}[data-bs-toggle="pill"], .${fc}[data-bs-toggle="list"]`;class ef extends ta{constructor(e){super(e),this._parent=this._element.closest(p3),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),ze.on(this._element,l3,t=>this._keydown(t)))}static get NAME(){return t3}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),r=t?ze.trigger(t,r3,{relatedTarget:e}):null;ze.trigger(e,s3,{relatedTarget:t}).defaultPrevented||r&&r.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(fc),this._activate(mt.getElementFromSelector(e));const r=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(yv);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),ze.trigger(e,a3,{relatedTarget:t})};this._queueCallback(r,e,e.classList.contains(AA))}_deactivate(e,t){if(!e)return;e.classList.remove(fc),e.blur(),this._deactivate(mt.getElementFromSelector(e));const r=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(yv);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),ze.trigger(e,i3,{relatedTarget:t})};this._queueCallback(r,e,e.classList.contains(AA))}_keydown(e){if(![u3,yA,f3,bA,xv,EA].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!xl(i));let r;if([xv,EA].includes(e.key))r=t[e.key===xv?0:t.length-1];else{const i=[yA,bA].includes(e.key);r=ex(t,e.target,i,!0)}r&&(r.focus({preventScroll:!0}),ef.getOrCreateInstance(r).show())}_getChildren(){return mt.find(Ev,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const r of t)this._setInitialAttributesOnChild(r)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),r=this._getOuterElement(e);e.setAttribute("aria-selected",t),r!==e&&this._setAttributeIfNotExists(r,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=mt.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const r=this._getOuterElement(e);if(!r.classList.contains(h3))return;const i=(a,o)=>{const c=mt.findOne(a,r);c&&c.classList.toggle(o,t)};i(k2,fc),i(d3,yv),r.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,r){e.hasAttribute(t)||e.setAttribute(t,r)}_elemIsActive(e){return e.classList.contains(fc)}_getInnerElement(e){return e.matches(Ev)?e:mt.findOne(Ev,e)}_getOuterElement(e){return e.closest(g3)||e}static jQueryInterface(e){return this.each(function(){const t=ef.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}ze.on(document,o3,F2,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!xl(this)&&ef.getOrCreateInstance(this).show()});ze.on(window,c3,()=>{for(const n of mt.find(v3))ef.getOrCreateInstance(n)});Fs(ef);const _3="toast",x3="bs.toast",Dl=`.${x3}`,y3=`mouseover${Dl}`,b3=`mouseout${Dl}`,E3=`focusin${Dl}`,A3=`focusout${Dl}`,w3=`hide${Dl}`,S3=`hidden${Dl}`,T3=`show${Dl}`,C3=`shown${Dl}`,D3="fade",wA="hide",Bp="show",Up="showing",O3={animation:"boolean",autohide:"boolean",delay:"number"},R3={animation:!0,autohide:!0,delay:5e3};class rm extends ta{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return R3}static get DefaultType(){return O3}static get NAME(){return _3}show(){if(ze.trigger(this._element,T3).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(D3);const t=()=>{this._element.classList.remove(Up),ze.trigger(this._element,C3),this._maybeScheduleHide()};this._element.classList.remove(wA),Fd(this._element),this._element.classList.add(Bp,Up),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||ze.trigger(this._element,w3).defaultPrevented)return;const t=()=>{this._element.classList.add(wA),this._element.classList.remove(Up,Bp),ze.trigger(this._element,S3)};this._element.classList.add(Up),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Bp),super.dispose()}isShown(){return this._element.classList.contains(Bp)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const r=e.relatedTarget;this._element===r||this._element.contains(r)||this._maybeScheduleHide()}_setListeners(){ze.on(this._element,y3,e=>this._onInteraction(e,!0)),ze.on(this._element,b3,e=>this._onInteraction(e,!1)),ze.on(this._element,E3,e=>this._onInteraction(e,!0)),ze.on(this._element,A3,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=rm.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}Jg(rm);Fs(rm);const di=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),g_=[.001,0,0,.001,0,0],Av=1.35,Qi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},La={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},N3="pdfjs_internal_editor_",Nt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},Wt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},P2={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Wr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},id={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Vn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Lu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Hd={ERRORS:0,WARNINGS:1,INFOS:5},gd={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Hp={moveTo:0,lineTo:1,curveTo:2,closePath:3},B2={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let im=Hd.WARNINGS;function L3(n){Number.isInteger(n)&&(im=n)}function M3(){return im}function sm(n){im>=Hd.INFOS&&console.log(`Info: ${n}`)}function Mt(n){im>=Hd.WARNINGS&&console.log(`Warning: ${n}`)}function bn(n){throw new Error(n)}function ir(n,e){n||bn(e)}function I3(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function sx(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=U3(n)}catch{}const r=e?URL.parse(n,e):URL.parse(n);return I3(r)?r:null}function ax(n,e,t=!1){const r=URL.parse(n);return r?(r.hash=e,r.href):t&&sx(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Vt(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const Lc=function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e}();class SA extends Lc{constructor(e,t){super(e,"PasswordException"),this.code=t}}class wv extends Lc{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class vg extends Lc{constructor(e){super(e,"InvalidPDFException")}}class md extends Lc{constructor(e,t,r){super(e,"ResponseException"),this.status=t,this.missing=r}}class k3 extends Lc{constructor(e){super(e,"FormatError")}}class Co extends Lc{constructor(e){super(e,"AbortException")}}function U2(n){(typeof n!="object"||n?.length===void 0)&&bn("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const r=[];for(let i=0;i<e;i+=t){const a=Math.min(i+t,e),o=n.subarray(i,a);r.push(String.fromCharCode.apply(null,o))}return r.join("")}function zd(n){typeof n!="string"&&bn("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function F3(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function P3(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function B3(){try{return new Function(""),!0}catch{return!1}}class Ar{static get isLittleEndian(){return Vt(this,"isLittleEndian",P3())}static get isEvalSupported(){return Vt(this,"isEvalSupported",B3())}static get isOffscreenCanvasSupported(){return Vt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Vt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Vt(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return Vt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Sv=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));class dt{static makeHexColor(e,t,r){return`#${Sv[e]}${Sv[t]}${Sv[r]}`}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,r=0){const i=e[r],a=e[r+1];e[r]=i*t[0]+a*t[2]+t[4],e[r+1]=i*t[1]+a*t[3]+t[5]}static applyTransformToBezier(e,t,r=0){const i=t[0],a=t[1],o=t[2],c=t[3],f=t[4],h=t[5];for(let d=0;d<6;d+=2){const g=e[r+d],m=e[r+d+1];e[r+d]=g*i+m*o+f,e[r+d+1]=g*a+m*c+h}}static applyInverseTransform(e,t){const r=e[0],i=e[1],a=t[0]*t[3]-t[1]*t[2];e[0]=(r*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/a,e[1]=(-r*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/a}static axialAlignedBoundingBox(e,t,r){const i=t[0],a=t[1],o=t[2],c=t[3],f=t[4],h=t[5],d=e[0],g=e[1],m=e[2],v=e[3];let y=i*d+f,b=y,A=i*m+f,w=A,C=c*g+h,T=C,R=c*v+h,N=R;if(a!==0||o!==0){const I=a*d,D=a*m,B=o*g,U=o*v;y+=B,w+=B,A+=U,b+=U,C+=I,N+=I,R+=D,T+=D}r[0]=Math.min(r[0],y,A,b,w),r[1]=Math.min(r[1],C,R,T,N),r[2]=Math.max(r[2],y,A,b,w),r[3]=Math.max(r[3],C,R,T,N)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const r=e[0],i=e[1],a=e[2],o=e[3],c=r**2+i**2,f=r*a+i*o,h=a**2+o**2,d=(c+h)/2,g=Math.sqrt(d**2-(c*h-f**2));t[0]=Math.sqrt(d+g||1),t[1]=Math.sqrt(d-g||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>i)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>o?null:[r,a,i,o]}static pointBoundingBox(e,t,r){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}static rectBoundingBox(e,t,r,i,a){a[0]=Math.min(a[0],e,r),a[1]=Math.min(a[1],t,i),a[2]=Math.max(a[2],e,r),a[3]=Math.max(a[3],t,i)}static#e(e,t,r,i,a,o,c,f,h,d){if(h<=0||h>=1)return;const g=1-h,m=h*h,v=m*h,y=g*(g*(g*e+3*h*t)+3*m*r)+v*i,b=g*(g*(g*a+3*h*o)+3*m*c)+v*f;d[0]=Math.min(d[0],y),d[1]=Math.min(d[1],b),d[2]=Math.max(d[2],y),d[3]=Math.max(d[3],b)}static#t(e,t,r,i,a,o,c,f,h,d,g,m){if(Math.abs(h)<1e-12){Math.abs(d)>=1e-12&&this.#e(e,t,r,i,a,o,c,f,-g/d,m);return}const v=d**2-4*g*h;if(v<0)return;const y=Math.sqrt(v),b=2*h;this.#e(e,t,r,i,a,o,c,f,(-d+y)/b,m),this.#e(e,t,r,i,a,o,c,f,(-d-y)/b,m)}static bezierBoundingBox(e,t,r,i,a,o,c,f,h){h[0]=Math.min(h[0],e,c),h[1]=Math.min(h[1],t,f),h[2]=Math.max(h[2],e,c),h[3]=Math.max(h[3],t,f),this.#t(e,r,a,c,t,i,o,f,3*(-e+3*(r-a)+c),6*(e-2*r+a),3*(r-e),h),this.#t(e,r,a,c,t,i,o,f,3*(-t+3*(i-o)+f),6*(t-2*i+o),3*(i-t),h)}}function U3(n){return decodeURIComponent(escape(n))}let Tv=null,TA=null;function H2(n){return Tv||(Tv=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,TA=new Map([["","t"]])),n.replaceAll(Tv,(e,t,r)=>t?t.normalize("NFKC"):TA.get(r))}function ox(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),U2(n)}const lx="pdfjs_internal_id_";function H3(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[r,i,...a]=t;if(!n(r)&&!Number.isInteger(r)||!e(i))return!1;const o=a.length;let c=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;c=!1;break;default:return!1}for(const f of a)if(!(typeof f=="number"||c&&f===null))return!1;return!0}function Xr(n,e,t){return Math.min(Math.max(n,e),t)}function z2(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(U2(n))}function z3(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):zd(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const vo="http://www.w3.org/2000/svg";class bc{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function df(n,e="text"){if(Zh(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}r(new Error(i.statusText))}},i.send(null)})}class jd{constructor({viewBox:e,userUnit:t,scale:r,rotation:i,offsetX:a=0,offsetY:o=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=i,this.offsetX=a,this.offsetY=o,r*=t;const f=(e[2]+e[0])/2,h=(e[3]+e[1])/2;let d,g,m,v;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,g=0,m=0,v=1;break;case 90:d=0,g=1,m=1,v=0;break;case 270:d=0,g=-1,m=-1,v=0;break;case 0:d=1,g=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(m=-m,v=-v);let y,b,A,w;d===0?(y=Math.abs(h-e[1])*r+a,b=Math.abs(f-e[0])*r+o,A=(e[3]-e[1])*r,w=(e[2]-e[0])*r):(y=Math.abs(f-e[0])*r+a,b=Math.abs(h-e[1])*r+o,A=(e[2]-e[0])*r,w=(e[3]-e[1])*r),this.transform=[d*r,g*r,m*r,v*r,y-d*r*f-m*r*h,b-g*r*f-v*r*h],this.width=A,this.height=w}get rawDims(){const e=this.viewBox;return Vt(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new jd({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:a})}convertToViewportPoint(e,t){const r=[e,t];return dt.applyTransform(r,this.transform),r}convertToViewportRectangle(e){const t=[e[0],e[1]];dt.applyTransform(t,this.transform);const r=[e[2],e[3]];return dt.applyTransform(r,this.transform),[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){const r=[e,t];return dt.applyInverseTransform(r,this.transform),r}}class am extends Lc{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function $d(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function om(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function j2(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function $2(n,e="document.pdf"){if(typeof n!="string")return e;if($d(n))return Mt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let a=r.exec(i[1])||r.exec(i[2])||r.exec(i[3]);if(a&&(a=a[0],a.includes("%")))try{a=r.exec(decodeURIComponent(a))[0]}catch{}return a||e}class CA{started=Object.create(null);times=[];time(e){e in this.started&&Mt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Mt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:i,end:a}of this.times)e.push(`${r.padEnd(t)} ${a-i}ms
`);return e.join("")}}function Zh(n,e){const t=e?URL.parse(n,e):URL.parse(n);return t?.protocol==="http:"||t?.protocol==="https:"}function ks(n){n.preventDefault()}function Xn(n){n.preventDefault(),n.stopPropagation()}function j3(n){console.log("Deprecated API usage: "+n)}class cx{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const r=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let f=parseInt(t[6],10);f=f>=0&&f<=59?f:0;const h=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let g=parseInt(t[9],10)||0;return g=g>=0&&g<=59?g:0,h==="-"?(o+=d,c+=g):h==="+"&&(o-=d,c-=g),new Date(Date.UTC(r,i,a,o,c,f))}}function G2(n,{scale:e=1,rotation:t=0}){const{width:r,height:i}=n.attributes.style,a=[0,0,parseInt(r),parseInt(i)];return new jd({viewBox:a,userUnit:1,scale:e,rotation:t})}function ux(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Mt(`Not a valid color format: "${n}"`),[0,0,0])}function $3(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;n.set(t,ux(r))}e.remove()}function Fn(n){const{a:e,b:t,c:r,d:i,e:a,f:o}=n.getTransform();return[e,t,r,i,a,o]}function Aa(n){const{a:e,b:t,c:r,d:i,e:a,f:o}=n.getTransform().invertSelf();return[e,t,r,i,a,o]}function bl(n,e,t=!1,r=!0){if(e instanceof jd){const{pageWidth:i,pageHeight:a}=e.rawDims,{style:o}=n,c=Ar.isCSSRoundSupported,f=`var(--total-scale-factor) * ${i}px`,h=`var(--total-scale-factor) * ${a}px`,d=c?`round(down, ${f}, var(--scale-round-x))`:`calc(${f})`,g=c?`round(down, ${h}, var(--scale-round-y))`:`calc(${h})`;!t||e.rotation%180===0?(o.width=d,o.height=g):(o.width=g,o.height=d)}r&&n.setAttribute("data-main-rotation",e.rotation)}class ea{constructor(){const{pixelRatio:e}=ea;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,r,i,a=-1){let o=1/0,c=1/0,f=1/0;r=ea.capPixels(r,a),r>0&&(o=Math.sqrt(r/(e*t))),i!==-1&&(c=i/e,f=i/t);const h=Math.min(o,c,f);return this.sx>h||this.sy>h?(this.sx=h,this.sy=h,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,r):r}return e}}const _g=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class sd{#e=null;#t=null;#n;#r=null;#s=null;#i=null;static#l=null;constructor(e){this.#n=e,sd.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;e.addEventListener("contextmenu",ks,{signal:t}),e.addEventListener("pointerdown",sd.#o,{signal:t});const r=this.#r=document.createElement("div");r.className="buttons",e.append(r);const i=this.#n.toolbarPosition;if(i){const{style:a}=e,o=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];a.insetInlineEnd=`${100*o}%`,a.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),e}get div(){return this.#e}static#o(e){e.stopPropagation()}#f(e){this.#n._focusEventsAllowed=!1,Xn(e)}#c(e){this.#n._focusEventsAllowed=!0,Xn(e)}#h(e){const t=this.#n._uiManager._signal;e.addEventListener("focusin",this.#f.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#c.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ks,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#s?.shown()}#u(){const{editorType:e,_uiManager:t}=this.#n,r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",sd.#l[e]),this.#h(r),r.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#r.append(r)}get#d(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#h(t),this.#r.prepend(t,this.#d),this.#s=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#h(t),this.#r.prepend(t,this.#d)}async addEditSignatureButton(e){const t=this.#i=await e.renderEditButton(this.#n);this.#h(t),this.#r.prepend(t,this.#d)}updateEditSignatureButton(e){this.#i&&(this.#i.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class G3{#e=null;#t=null;#n;constructor(e){this.#n=e}#r(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ks,{signal:this.#n._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#i(),e}#s(e,t){let r=0,i=0;for(const a of e){const o=a.y+a.height;if(o<r)continue;const c=a.x+(t?a.width:0);if(o>r){i=c,r=o;continue}t?c>i&&(i=c):c<i&&(i=c)}return[t?1-i:i,r]}show(e,t,r){const[i,a]=this.#s(t,r),{style:o}=this.#t||=this.#r();e.append(this.#t),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#i(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const r=this.#n._signal;e.addEventListener("contextmenu",ks,{signal:r}),e.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:r}),this.#e.append(e)}}function V2(n,e,t){for(const r of t)e.addEventListener(r,n[r].bind(n))}class V3{#e=0;get id(){return`${N3}${this.#e++}`}}class fx{#e=ox();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const a=i.decode().then(()=>(r.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Vt(this,"_isSVGFittingCanvas",a)}async#r(e,t){this.#n||=new Map;let r=this.#n.get(e);if(r===null)return null;if(r?.bitmap)return r.refCounter+=1,r;try{r||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(r.url=t,i=await df(t,"blob")):t instanceof File?i=r.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const a=fx._isSVGFittingCanvas,o=new FileReader,c=new Image,f=new Promise((h,d)=>{c.onload=()=>{r.bitmap=c,r.isSvg=!0,h()},o.onload=async()=>{const g=r.svgUrl=o.result;c.src=await a?`${g}#svgView(preserveAspectRatio(none))`:g},c.onerror=o.onerror=d});o.readAsDataURL(i),await f}else r.bitmap=await createImageBitmap(i);r.refCounter=1}catch(i){Mt(i),r=null}return this.#n.set(e,r),r&&this.#n.set(r.id,r),r}async getFromFile(e){const{lastModified:t,name:r,size:i,type:a}=e;return this.#r(`${t}_${r}_${i}_${a}`,e)}async getFromUrl(e){return this.#r(e,e)}async getFromBlob(e,t){const r=await t;return this.#r(e,r)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let r=this.#n.get(e);if(r?.bitmap)return r.refCounter+=1,r;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),r={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,r),this.#n.set(r.id,r),r}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=i.convertToBlob()}r.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class W3{#e=[];#t=!1;#n;#r=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:r,mustExec:i,type:a=NaN,overwriteIfSameType:o=!1,keepUndo:c=!1}){if(i&&e(),this.#t)return;const f={cmd:e,undo:t,post:r,type:a};if(this.#r===-1){this.#e.length>0&&(this.#e.length=0),this.#r=0,this.#e.push(f);return}if(o&&this.#e[this.#r].type===a){c&&(f.undo=this.#e[this.#r].undo),this.#e[this.#r]=f;return}const h=this.#r+1;h===this.#n?this.#e.splice(0,1):(this.#r=h,h<this.#e.length&&this.#e.splice(h)),this.#e.push(f)}undo(){if(this.#r===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1,this.#r-=1}redo(){if(this.#r<this.#e.length-1){this.#r+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#e.length-1}cleanType(e){if(this.#r!==-1){for(let t=this.#r;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#r-t),this.#r=t;return}this.#e.length=0,this.#r=-1}}destroy(){this.#e=null}}class Gd{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Ar.platform;for(const[r,i,a={}]of e)for(const o of r){const c=o.startsWith("mac+");t&&c?(this.callbacks.set(o.slice(4),{callback:i,options:a}),this.allKeys.add(o.split("+").at(-1))):!t&&!c&&(this.callbacks.set(o,{callback:i,options:a}),this.allKeys.add(o.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(this.#e(t));if(!r)return;const{callback:i,options:{bubbles:a=!1,args:o=[],checker:c=null}}=r;c&&!c(e,t)||(i.bind(e,...o,t)(),a||Xn(t))}}class hx{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return $3(e),Vt(this,"_colors",e)}convert(e){const t=ux(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,i]of this._colors)if(i.every((a,o)=>a===t[o]))return hx._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?dt.makeHexColor(...t):e}}class Do{#e=new AbortController;#t=null;#n=new Map;#r=new Map;#s=null;#i=null;#l=null;#o=new W3;#f=null;#c=null;#h=0;#u=new Set;#d=null;#a=null;#p=new Set;_editorUndoBar=null;#m=!1;#g=!1;#v=!1;#_=null;#x=null;#b=null;#A=null;#S=!1;#C=null;#O=new V3;#E=!1;#D=!1;#T=null;#N=null;#L=null;#M=null;#H=null;#w=Nt.NONE;#y=new Set;#P=null;#B=null;#$=null;#G=null;#V={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#I=null;#k=null;#j=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Do.prototype,t=o=>o.#k.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),r=(o,{target:c})=>{if(c instanceof HTMLInputElement){const{type:f}=c;return f!=="text"&&f!=="number"}return!0},i=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Vt(this,"_keyboardManager",new Gd([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#k.contains(c)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:c})=>!(c instanceof HTMLButtonElement)&&o.#k.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}constructor(e,t,r,i,a,o,c,f,h,d,g,m,v,y){const b=this._signal=this.#e.signal;this.#k=e,this.#j=t,this.#s=r,this.#B=i,this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:b}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),a._on("setpreference",this.onSetPreference.bind(this),{signal:b}),a._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:b}),this.#re(),this.#oe(),this.#K(),this.#i=o.annotationStorage,this.#_=o.filterFactory,this.#$=c,this.#A=f||null,this.#m=h,this.#g=d,this.#v=g,this.#H=m||null,this.viewParameters={realScale:bc.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=v||null,this._supportsPinchToZoom=y!==!1}destroy(){this.#F?.resolve(),this.#F=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#r.values())e.destroy();this.#r.clear(),this.#n.clear(),this.#p.clear(),this.#M?.clear(),this.#t=null,this.#y.clear(),this.#o.destroy(),this.#s?.destroy(),this.#B?.destroy(),this.#C?.hide(),this.#C=null,this.#L?.destroy(),this.#L=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#I&&(clearTimeout(this.#I),this.#I=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#H}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Vt(this,"hcmFilter",this.#$?this.#_.addHCMFilter(this.#$.foreground,this.#$.background):"none")}get direction(){return Vt(this,"direction",getComputedStyle(this.#k).direction)}get highlightColors(){return Vt(this,"highlightColors",this.#A?new Map(this.#A.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Vt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=e}setMainHighlightColorPicker(e){this.#L=e}editAltText(e,t=!1){this.#s?.editAltText(this,e,t)}getSignature(e){this.#B?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#B}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#v=t;break}}onPageChanging({pageNumber:e}){this.#h=e-1}focusMainContainer(){this.#k.focus()}findParent(e,t){for(const r of this.#r.values()){const{x:i,y:a,width:o,height:c}=r.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=a&&t<=a+c)return r}return null}disableUserSelect(e=!1){this.#j.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*bc.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#X({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#q(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of this.#r.values())if(r.hasTextLayer(e))return r;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:r,anchorOffset:i,focusNode:a,focusOffset:o}=t,c=t.toString(),h=this.#X(t).closest(".textLayer"),d=this.getSelectionBoxes(h);if(!d)return;t.empty();const g=this.#q(h),m=this.#w===Nt.NONE,v=()=>{g?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:r,anchorOffset:i,focusNode:a,focusOffset:o,text:c}),m&&this.showAllEditors("highlight",!0,!0)};if(m){this.switchToMode(Nt.HIGHLIGHT,v);return}v()}#te(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=this.#X(e).closest(".textLayer"),i=this.getSelectionBoxes(r);i&&(this.#C||=new G3(this),this.#C.show(r,i,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#i&&!this.#i.has(e.id)&&this.#i.setValue(e.id,e)}#ne(){const e=document.getSelection();if(!e||e.isCollapsed){this.#P&&(this.#C?.hide(),this.#P=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#P)return;const i=this.#X(e).closest(".textLayer");if(!i){this.#P&&(this.#C?.hide(),this.#P=null,this.#R({hasSelectedText:!1}));return}if(this.#C?.hide(),this.#P=t,this.#R({hasSelectedText:!0}),!(this.#w!==Nt.HIGHLIGHT&&this.#w!==Nt.NONE)&&(this.#w===Nt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#w===Nt.HIGHLIGHT?this.#q(i):null;a?.toggleDrawing();const o=new AbortController,c=this.combinedSignal(o),f=h=>{h.type==="pointerup"&&h.button!==0||(o.abort(),a?.toggleDrawing(!0),h.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}}#Y(e=""){this.#w===Nt.HIGHLIGHT?this.highlightSelection(e):this.#m&&this.#te()}#re(){document.addEventListener("selectionchange",this.#ne.bind(this),{signal:this._signal})}#ie(){if(this.#b)return;this.#b=new AbortController;const e=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#se(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#y)if(t.div.contains(e)){this.#N=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[e,t]=this.#N;this.#N=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#K(){if(this.#T)return;this.#T=new AbortController;const e=this.combinedSignal(this.#T);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ae(){this.#T?.abort(),this.#T=null}#Q(){if(this.#f)return;this.#f=new AbortController;const e=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#Z(){this.#f?.abort(),this.#f=null}#oe(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#K(),this.#Q()}removeEditListeners(){this.#ae(),this.#Z()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of this.#a)if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of this.#a)if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of this.#y){const i=r.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const o of this.#a)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(a){Mt(`paste: "${a.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const i=this.currentLayer;try{const a=[];for(const f of r){const h=await i.deserialize(f);if(!h)return;a.push(h)}const o=()=>{for(const f of a)this.#J(f);this.#ee(a)},c=()=>{for(const f of a)f.remove()};this.addCommands({cmd:o,undo:c,mustExec:!0})}catch(a){Mt(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#w!==Nt.NONE&&!this.isEditorHandlingKeyboard&&Do._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#Y("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#R(e){Object.entries(e).some(([r,i])=>this.#V[r]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#V,e)}),this.#w===Nt.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#U([[Wt.HIGHLIGHT_FREE,!0]]))}#U(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ie(),this.#Q(),this.#R({isEditing:this.#w!==Nt.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#se(),this.#Z(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#a){this.#a=e;for(const t of this.#a)this.#U(t.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#r.get(this.#h)}getLayer(e){return this.#r.get(e)}get currentPageIndex(){return this.#h}addLayer(e){this.#r.set(e.pageIndex,e),this.#E?e.enable():e.disable()}removeLayer(e){this.#r.delete(e.pageIndex)}async updateMode(e,t=null,r=!1){if(this.#w!==e&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#c?.commitOrRemove(),this.#w=e,e===Nt.NONE){this.setEditingState(!1),this.#ce(),this._editorUndoBar?.hide(),this.#F.resolve();return}e===Nt.SIGNATURE&&await this.#B?.loadSignatures(),this.setEditingState(!0),await this.#le(),this.unselectAll();for(const i of this.#r.values())i.updateMode(e);if(!t){r&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const i of this.#n.values())i.annotationElementId===t||i.id===t?(this.setSelected(i),i.enterInEditMode()):i.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#w&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#a){switch(e){case Wt.CREATE:this.currentLayer.addNewEditor(t);return;case Wt.HIGHLIGHT_DEFAULT_COLOR:this.#L?.updateColor(t);break;case Wt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#G||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const r of this.#y)r.updateParams(e,t);for(const r of this.#a)r.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){for(const a of this.#n.values())a.editorType===e&&a.show(t);(this.#G?.get(Wt.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#U([[Wt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#D!==e){this.#D=e;for(const t of this.#r.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#le(){if(!this.#E){this.#E=!0;const e=[];for(const t of this.#r.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#ce(){if(this.unselectAll(),this.#E){this.#E=!1;for(const e of this.#r.values())e.disable();for(const e of this.#n.values())e.disable()}}getEditors(e){const t=[];for(const r of this.#n.values())r.pageIndex===e&&t.push(r);return t}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#M?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#u.has(e.annotationElementId))&&this.#i?.remove(e.id)}addDeletedAnnotationElement(e){this.#u.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#u.has(e)}removeDeletedAnnotationElement(e){this.#u.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#J(e){const t=this.#r.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#U(e.propertiesToUpdate))}get#ue(){let e=null;for(e of this.#y);return e}updateUI(e){this.#ue===e&&this.#U(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#U(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#y.has(e)){this.#y.delete(e),e.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#y.add(e),e.select(),this.#U(e.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(e){this.#c?.commitOrRemove();for(const t of this.#y)t!==e&&t.unselect();this.#y.clear(),this.#y.add(e),e.select(),this.#U(e.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(e){return this.#y.has(e)}get firstSelectedEditor(){return this.#y.values().next().value}unselect(e){e.unselect(),this.#y.delete(e),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#y.size!==0}get isEnterHandled(){return this.#y.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#R({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(e){this.#o.add(e),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(e){this.#o.cleanType(e)}#W(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#y],r=()=>{this._editorUndoBar?.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const a of t)this.#J(a)};this.addCommands({cmd:r,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ee(e){for(const t of this.#y)t.unselect();this.#y.clear();for(const t of e)t.isEmpty()||(this.#y.add(t),t.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#y)e.commit();this.#ee(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#w!==Nt.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const e of this.#y)e.unselect();this.#y.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=e,this.#z[1]+=t;const[i,a]=this.#z,o=[...this.#y],c=1e3;this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const f of o)this.#n.has(f.id)&&(f.translateInPage(i,a),f.translationDone())},undo:()=>{for(const f of o)this.#n.has(f.id)&&(f.translateInPage(-i,-a),f.translationDone())},mustExec:!1})},c);for(const f of o)f.translateInPage(e,t),f.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#d=new Map;for(const e of this.#y)this.#d.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#d)return!1;this.disableUserSelect(!1);const e=this.#d;this.#d=null;let t=!1;for(const[{x:i,y:a,pageIndex:o},c]of e)c.newX=i,c.newY=a,c.newPageIndex=o,t||=i!==c.savedX||a!==c.savedY||o!==c.savedPageIndex;if(!t)return!1;const r=(i,a,o,c)=>{if(this.#n.has(i.id)){const f=this.#r.get(c);f?i._setParentAndPosition(f,a,o):(i.pageIndex=c,i.x=a,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:a,newY:o,newPageIndex:c}]of e)r(i,a,o,c)},undo:()=>{for(const[i,{savedX:a,savedY:o,savedPageIndex:c}]of e)r(i,a,o,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#d)for(const r of this.#d.keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#y.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#w}get imageManager(){return Vt(this,"imageManager",new fx)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,d=t.rangeCount;h<d;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:r,y:i,width:a,height:o}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(h,d,g,m)=>({x:(d-i)/o,y:1-(h+g-r)/a,width:m/o,height:g/a});break;case"180":c=(h,d,g,m)=>({x:1-(h+g-r)/a,y:1-(d+m-i)/o,width:g/a,height:m/o});break;case"270":c=(h,d,g,m)=>({x:1-(d+m-i)/o,y:(h-r)/a,width:m/o,height:g/a});break;default:c=(h,d,g,m)=>({x:(h-r)/a,y:(d-i)/o,width:g/a,height:m/o});break}const f=[];for(let h=0,d=t.rangeCount;h<d;h++){const g=t.getRangeAt(h);if(!g.collapsed)for(const{x:m,y:v,width:y,height:b}of g.getClientRects())y===0||b===0||f.push(c(m,v,y,b))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#l||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#l?.delete(e)}renderAnnotationElement(e){const t=this.#l?.get(e.data.id);if(!t)return;const r=this.#i.getRawValue(t);r&&(this.#w===Nt.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}setMissingCanvas(e,t,r){const i=this.#M?.get(e);i&&(i.setCanvas(t,r),this.#M.delete(e))}addMissingCanvas(e,t){(this.#M||=new Map).set(e,t)}}class Da{#e=null;#t=!1;#n=null;#r=null;#s=null;#i=null;#l=!1;#o=null;#f=null;#c=null;#h=null;#u=!1;static#d=null;static _l10n=null;constructor(e){this.#f=e,this.#u=e._uiManager.useNewAltTextFlow,Da.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Da._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#r=document.createElement("span");e.append(t),this.#u?(e.classList.add("new"),e.setAttribute("data-l10n-id",Da.#d.missing),t.setAttribute("data-l10n-id",Da.#d["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=this.#f._uiManager._signal;e.addEventListener("contextmenu",ks,{signal:r}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:r});const i=a=>{a.preventDefault(),this.#f._uiManager.editAltText(this.#f),this.#u&&this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return e.addEventListener("click",i,{capture:!0,signal:r}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#l=!0,i(a))},{signal:r}),await this.#p(),e}get#a(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#u?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#u?this.#e!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(e){this.#e===null&&(this.#c=e,this.#h=await Da._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#u||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#f.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#c===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#c,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:i,cancel:a=!1}){r&&(this.#c=r,this.#h=i),!(this.#e===e&&this.#t===t)&&(a||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#n&&(!e&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#n.disabled=!e)}shown(){this.#f._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#n?.remove(),this.#n=null,this.#r=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const e=this.#n;if(!e)return;if(this.#u){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Da.#d[this.#a]),this.#r?.setAttribute("data-l10n-id",Da.#d[`${this.#a}-label`]),!this.#e){this.#s?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#s?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#s;if(!t){this.#s=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#f.id}`;const i=100,a=this.#f._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#s.classList.add("show"),this.#f._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:a}),e.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#s?.classList.remove("show")},{signal:a})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#f.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Vd{#e;#t=!1;#n=null;#r;#s;#i;#l;#o=null;#f;#c=null;#h;#u=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:i=null,onPinching:a=null,onPinchEnd:o=null,signal:c}){this.#e=e,this.#n=r,this.#r=t,this.#s=i,this.#i=a,this.#l=o,this.#h=new AbortController,this.#f=AbortSignal.any([c,this.#h.signal]),e.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#f})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ea.pixelRatio}#d(e){if(this.#r?.())return;if(e.touches.length===1){if(this.#o)return;const i=this.#o=new AbortController,a=AbortSignal.any([this.#f,i.signal]),o=this.#e,c={capture:!0,signal:a,passive:!1},f=h=>{h.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",h=>{h.pointerType==="touch"&&(Xn(h),f(h))},c),o.addEventListener("pointerup",f,c),o.addEventListener("pointercancel",f,c);return}if(!this.#u){this.#u=new AbortController;const i=AbortSignal.any([this.#f,this.#u.signal]),a=this.#e,o={signal:i,capture:!1,passive:!1};a.addEventListener("touchmove",this.#a.bind(this),o);const c=this.#p.bind(this);a.addEventListener("touchend",c,o),a.addEventListener("touchcancel",c,o),o.capture=!0,a.addEventListener("pointerdown",Xn,o),a.addEventListener("pointermove",Xn,o),a.addEventListener("pointercancel",Xn,o),a.addEventListener("pointerup",Xn,o),this.#s?.()}if(Xn(e),e.touches.length!==2||this.#n?.()){this.#c=null;return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),this.#c={touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY}}#a(e){if(!this.#c||e.touches.length!==2)return;Xn(e);let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:i,screenY:a}=t,{screenX:o,screenY:c}=r,f=this.#c,{touch0X:h,touch0Y:d,touch1X:g,touch1Y:m}=f,v=g-h,y=m-d,b=o-i,A=c-a,w=Math.hypot(b,A)||1,C=Math.hypot(v,y)||1;if(!this.#t&&Math.abs(C-w)<=Vd.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=i,f.touch0Y=a,f.touch1X=o,f.touch1Y=c,!this.#t){this.#t=!0;return}const T=[(i+o)/2,(a+c)/2];this.#i?.(T,C,w)}#p(e){e.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#l?.()),this.#c&&(Xn(e),this.#c=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class vt{#e=null;#t=null;#n=null;#r=!1;#s=null;#i="";#l=!1;#o=null;#f=null;#c=null;#h=null;#u="";#d=!1;#a=null;#p=!1;#m=!1;#g=!1;#v=null;#_=0;#x=0;#b=null;#A=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#C=vt._zIndex++;static _borderLineWidth=-1;static _colorManager=new hx;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=vt.prototype._resizeWithKeyboard,t=Do.TRANSLATE_SMALL,r=Do.TRANSLATE_BIG;return Vt(this,"_resizerKeyboardManager",new Gd([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],vt.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:r,pageHeight:i,pageX:a,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,i],this.pageTranslation=[a,o];const[c,f]=this.parentDimensions;this.x=e.x/c,this.y=e.y/f,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Vt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new X3({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(vt._l10n??=e,vt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),vt._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);vt._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){bn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(e){this.#S=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#C}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#j(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#d?this.#d=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,i){const[a,o]=this.parentDimensions;[r,i]=this.screenToPageTranslation(r,i),this.x=(e+r)/a,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[r,i]=this.parentDimensions;this.setAt(e*r,t*i,this.width*r,this.height*i),this._onTranslated()}#O([e,t],r,i){[r,i]=this.screenToPageTranslation(r,i),this.x+=r/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#O(this.parentDimensions,e,t)}translateInPage(e,t){this.#a||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#a||=[this.x,this.y,this.width,this.height];const{div:r,parentDimensions:[i,a]}=this;if(this.x+=e/i,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:c}=this;const[f,h]=this.getBaseTranslation();o+=f,c+=h;const{style:d}=r;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*c).toFixed(2)}%`,this._onTranslating(o,c),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=vt,i=r/e,a=r/t;switch(this.rotation){case 90:return[-i,a];case 180:return[i,a];case 270:return[i,-a];default:return[-i,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,i]}=this;let{x:a,y:o,width:c,height:f}=this;if(c*=r,f*=i,a*=r,o*=i,this._mustFixPosition)switch(e){case 0:a=Xr(a,0,r-c),o=Xr(o,0,i-f);break;case 90:a=Xr(a,0,r-f),o=Xr(o,c,i);break;case 180:a=Xr(a,c,r),o=Xr(o,f,i);break;case 270:a=Xr(a,f,r),o=Xr(o,0,i-c);break}this.x=a/=r,this.y=o/=i;const[h,d]=this.getBaseTranslation();a+=h,o+=d,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#E(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return vt.#E(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return vt.#E(e,t,360-this.parentRotation)}#D(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(e,t){const[r,i]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*e/r).toFixed(2)}%`,this.#l||(a.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:r}=e,i=r.endsWith("%"),a=!this.#l&&t.endsWith("%");if(i&&a)return;const[o,c]=this.parentDimensions;i||(e.width=`${(100*parseFloat(r)/o).toFixed(2)}%`),!this.#l&&!a&&(e.height=`${(100*parseFloat(t)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#T(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const i=document.createElement("div");this.#o.append(i),i.classList.add("resizer",r),i.setAttribute("data-resizer-name",r),i.addEventListener("pointerdown",this.#N.bind(this,r),{signal:t}),i.addEventListener("contextmenu",ks,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#o)}#N(e,t){t.preventDefault();const{isMac:r}=Ar.platform;if(t.button!==0||t.ctrlKey&&r)return;this.#n?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#f=[t.screenX,t.screenY];const a=new AbortController,o=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#H.bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Xn,{passive:!1,signal:o}),window.addEventListener("contextmenu",ks,{signal:o}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const h=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=c,this.div.style.cursor=f,this.#M()};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}#L(e,t,r,i){this.width=r,this.height=i,this.x=e,this.y=t;const[a,o]=this.parentDimensions;this.setDims(a*r,o*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#M(){if(!this.#c)return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:i}=this.#c;this.#c=null;const a=this.x,o=this.y,c=this.width,f=this.height;a===e&&o===t&&c===r&&f===i||this.addCommands({cmd:this.#L.bind(this,a,o,c,f),undo:this.#L.bind(this,e,t,r,i),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#H(e,t){const[r,i]=this.parentDimensions,a=this.x,o=this.y,c=this.width,f=this.height,h=vt.MIN_SIZE/r,d=vt.MIN_SIZE/i,g=this.#D(this.rotation),m=(q,ee)=>[g[0]*q+g[2]*ee,g[1]*q+g[3]*ee],v=this.#D(360-this.rotation),y=(q,ee)=>[v[0]*q+v[2]*ee,v[1]*q+v[3]*ee];let b,A,w=!1,C=!1;switch(e){case"topLeft":w=!0,b=(q,ee)=>[0,0],A=(q,ee)=>[q,ee];break;case"topMiddle":b=(q,ee)=>[q/2,0],A=(q,ee)=>[q/2,ee];break;case"topRight":w=!0,b=(q,ee)=>[q,0],A=(q,ee)=>[0,ee];break;case"middleRight":C=!0,b=(q,ee)=>[q,ee/2],A=(q,ee)=>[0,ee/2];break;case"bottomRight":w=!0,b=(q,ee)=>[q,ee],A=(q,ee)=>[0,0];break;case"bottomMiddle":b=(q,ee)=>[q/2,ee],A=(q,ee)=>[q/2,0];break;case"bottomLeft":w=!0,b=(q,ee)=>[0,ee],A=(q,ee)=>[q,0];break;case"middleLeft":C=!0,b=(q,ee)=>[0,ee/2],A=(q,ee)=>[q,ee/2];break}const T=b(c,f),R=A(c,f);let N=m(...R);const I=vt._round(a+N[0]),D=vt._round(o+N[1]);let B=1,U=1,Y,W;if(t.fromKeyboard)({deltaX:Y,deltaY:W}=t);else{const{screenX:q,screenY:ee}=t,[Pe,qe]=this.#f;[Y,W]=this.screenToPageTranslation(q-Pe,ee-qe),this.#f[0]=q,this.#f[1]=ee}if([Y,W]=y(Y/r,W/i),w){const q=Math.hypot(c,f);B=U=Math.max(Math.min(Math.hypot(R[0]-T[0]-Y,R[1]-T[1]-W)/q,1/c,1/f),h/c,d/f)}else C?B=Xr(Math.abs(R[0]-T[0]-Y),h,1)/c:U=Xr(Math.abs(R[1]-T[1]-W),d,1)/f;const re=vt._round(c*B),Te=vt._round(f*U);N=m(...A(re,Te));const Fe=I-N[0],we=D-N[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=re,this.height=Te,this.x=Fe,this.y=we,this.setDims(r*re,i*Te),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#m?this._editToolbar:(this._editToolbar=new sd(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(Da.initialize(vt._l10n),this.#n=new Da(this),this.#e&&(this.#n.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#r?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#G();const[t,r]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*r/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/r).toFixed(2)}%`);const[i,a]=this.getInitialTranslation();return this.translate(i,a),V2(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#A||=new Vd({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#w.bind(this),onPinching:this.#y.bind(this),onPinchEnd:this.#P.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),e}#w(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#y(e,t,r){let a=.7*(r/t)+1-.7;if(a===1)return;const o=this.#D(this.rotation),c=(I,D)=>[o[0]*I+o[2]*D,o[1]*I+o[3]*D],[f,h]=this.parentDimensions,d=this.x,g=this.y,m=this.width,v=this.height,y=vt.MIN_SIZE/f,b=vt.MIN_SIZE/h;a=Math.max(Math.min(a,1/m,1/v),y/m,b/v);const A=vt._round(m*a),w=vt._round(v*a);if(A===m&&w===v)return;this.#a||=[d,g,m,v];const C=c(m/2,v/2),T=vt._round(d+C[0]),R=vt._round(g+C[1]),N=c(A/2,w/2);this.x=T-N[0],this.y=R-N[1],this.width=A,this.height=w,this.setDims(f*A,h*w),this.fixAndSetPosition(),this._onResizing()}#P(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#M()}pointerdown(e){const{isMac:t}=Ar.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#d=!0,this._isDraggable){this.#$(e);return}this.#B(e)}#B(e){const{isMac:t}=Ar.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const i=new AbortController,a=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:a},c=h=>{i.abort(),this.#s=null,this.#d=!1,this._uiManager.endDragSession()||this.#B(h),r&&this._onStopDragging()};t&&(this.#_=e.clientX,this.#x=e.clientY,this.#s=e.pointerId,this.#i=e.pointerType,window.addEventListener("pointermove",h=>{r||(r=!0,this._onStartDragging());const{clientX:d,clientY:g,pointerId:m}=h;if(m!==this.#s){Xn(h);return}const[v,y]=this.screenToPageTranslation(d-this.#_,g-this.#x);this.#_=d,this.#x=g,this._uiManager.dragSelectedEditors(v,y)},o),window.addEventListener("touchmove",Xn,o),window.addEventListener("pointerdown",h=>{h.pointerType===this.#i&&(this.#A||h.isPrimary)&&c(h),Xn(h)},o));const f=h=>{if(!this.#s||this.#s===h.pointerId){c(h);return}Xn(h)};window.addEventListener("pointerup",f,{signal:a}),window.addEventListener("blur",f,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const i=this.parentScale,[a,o]=this.pageDimensions,[c,f]=this.pageTranslation,h=e/i,d=t/i,g=this.x*a,m=this.y*o,v=this.width*a,y=this.height*o;switch(r){case 0:return[g+h+c,o-m-d-y+f,g+h+v+c,o-m-d+f];case 90:return[g+d+c,o-m+h+f,g+d+y+c,o-m+h+v+f];case 180:return[g-h-v+c,o-m+d+f,g-h+c,o-m+d+y+f];case 270:return[g-d-y+c,o-m-h-v+f,g-d+c,o-m-h+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,i,a,o]=e,c=a-r,f=o-i;switch(this.rotation){case 0:return[r,t-o,c,f];case 90:return[r,t-i,f,c];case 180:return[a,t-i,c,f];case 270:return[a,t-o,f,c];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:i}=this.getClientDimensions(),{innerHeight:a,innerWidth:o}=window;return t<o&&i>0&&e<a&&r>0}#G(){if(this.#h||!this.div)return;this.#h=new AbortController;const e=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#G()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){bn("An editor must be serializable")}static async deserialize(e,t,r){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r});i.rotation=e.rotation,i.#e=e.accessibilityData,i._isCopy=e.isCopy||!1;const[a,o]=i.pageDimensions,[c,f,h,d]=i.getRectInCurrentCoords(e.rect,o);return i.x=c/a,i.y=f/o,i.width=h/a,i.height=d/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#j(),this.removeEditToolbar(),this.#b){for(const e of this.#b.values())clearTimeout(e);this.#b=null}this.parent=null,this.#A?.destroy(),this.#A=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#T(),this.#o.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#o.children;if(!this.#t){this.#t=Array.from(t);const o=this.#V.bind(this),c=this.#z.bind(this),f=this._uiManager._signal;for(const h of this.#t){const d=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",o,{signal:f}),h.addEventListener("blur",c,{signal:f}),h.addEventListener("focus",this.#I.bind(this,d),{signal:f}),h.setAttribute("data-l10n-id",vt._l10nResizer[d])}}const r=this.#t[0];let i=0;for(const o of t){if(o===r)break;i++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(a!==i){if(a<i)for(let c=0;c<i-a;c++)this.#o.append(this.#o.firstChild);else if(a>i)for(let c=0;c<a-i;c++)this.#o.firstChild.before(this.#o.lastChild);let o=0;for(const c of t){const h=this.#t[o++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",vt._l10nResizer[h])}}this.#k(0),this.#g=!0,this.#o.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#V(e){vt._resizerKeyboardManager.exec(this,e)}#z(e){this.#g&&e.relatedTarget?.parentNode!==this.#o&&this.#j()}#I(e){this.#u=this.#g?e:""}#k(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#g&&this.#H(this.#u,{deltaX:e,deltaY:t,fromKeyboard:!0})}#j(){this.#g=!1,this.#k(-1),this.#M()}_stopResizingWithKeyboard(){this.#j(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#l=!0;const r=e/t,{style:i}=this.div;i.aspectRatio=r,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#b||=new Map;const{action:r}=e;let i=this.#b.get(r);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#b.delete(r),this.#b.size===0&&(this.#b=null)},vt._telemetryTimeout),this.#b.set(r,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class X3 extends vt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const DA=3285377520,ws=4294901760,wa=65535;class W2{constructor(e){this.h1=e?e&4294967295:DA,this.h2=e?e&4294967295:DA}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let b=0,A=e.length;b<A;b++){const w=e.charCodeAt(b);w<=255?t[r++]=w:(t[r++]=w>>>8,t[r++]=w&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=r>>2,a=r-i*4,o=new Uint32Array(t.buffer,0,i);let c=0,f=0,h=this.h1,d=this.h2;const g=3432918353,m=461845907,v=g&wa,y=m&wa;for(let b=0;b<i;b++)b&1?(c=o[b],c=c*g&ws|c*v&wa,c=c<<15|c>>>17,c=c*m&ws|c*y&wa,h^=c,h=h<<13|h>>>19,h=h*5+3864292196):(f=o[b],f=f*g&ws|f*v&wa,f=f<<15|f>>>17,f=f*m&ws|f*y&wa,d^=f,d=d<<13|d>>>19,d=d*5+3864292196);switch(c=0,a){case 3:c^=t[i*4+2]<<16;case 2:c^=t[i*4+1]<<8;case 1:c^=t[i*4],c=c*g&ws|c*v&wa,c=c<<15|c>>>17,c=c*m&ws|c*y&wa,i&1?h^=c:d^=c}this.h1=h,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ws|e*36045&wa,t=t*4283543511&ws|((t<<16|e>>>16)*2950163797&ws)>>>16,e^=t>>>1,e=e*444984403&ws|e*60499&wa,t=t*3301882366&ws|((t<<16|e>>>16)*3120437893&ws)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const m_=Object.freeze({map:null,hash:"",transfer:void 0});class dx{#e=!1;#t=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=this.#n.get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return this.#n.get(e)}remove(e){if(this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#n.values())if(t instanceof vt)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=this.#n.get(e);let i=!1;if(r!==void 0)for(const[a,o]of Object.entries(t))r[a]!==o&&(i=!0,r[a]=o);else i=!0,this.#n.set(e,t);i&&this.#r(),t instanceof vt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#n.has(e)}get size(){return this.#n.size}#r(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new X2(this)}get serializable(){if(this.#n.size===0)return m_;const e=new Map,t=new W2,r=[],i=Object.create(null);let a=!1;for(const[o,c]of this.#n){const f=c instanceof vt?c.serialize(!1,i):c;f&&(e.set(o,f),t.update(`${o}:${JSON.stringify(f)}`),a||=!!f.bitmap)}if(a)for(const o of e.values())o.bitmap&&r.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:m_}get editorStats(){let e=null;const t=new Map;for(const r of this.#n.values()){if(!(r instanceof vt))continue;const i=r.telemetryFinalData;if(!i)continue;const{type:a}=i;t.has(a)||t.set(a,Object.getPrototypeOf(r).constructor),e||=Object.create(null);const o=e[a]||=new Map;for(const[c,f]of Object.entries(i)){if(c==="type")continue;let h=o.get(c);h||(h=new Map,o.set(c,h));const d=h.get(f)??0;h.set(f,d+1)}}for(const[r,i]of t)e[r]=i.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#n.values())!(t instanceof vt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class X2 extends dx{#e;constructor(e){super();const{map:t,hash:r,transfer:i}=e.serializable,a=structuredClone(t,i?{transfer:i}:null);this.#e={map:a,hash:r,transfer:i}}get print(){bn("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Vt(this,"modifiedIds",{ids:new Set,hash:""})}}class Y3{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:r}){if(!(!e||this.#e.has(e.loadedName))){if(ir(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:a,style:o}=e,c=new FontFace(i,a,o);this.addNativeFontFace(c);try{await c.load(),this.#e.add(i),r?.(e)}catch{Mt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}bn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(i){throw Mt(`Failed to load font '${r.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const i=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Vt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Vt(this,"isSyncFontLoadingSupported",di||Ar.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(ir(!i.done,"completeRequest() cannot be called twice."),i.done=!0;r.length>0&&r[0].done;){const a=r.shift();setTimeout(a.callback,0)}}const{loadingRequests:r}=this,i={done:!1,complete:t,callback:e};return r.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Vt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(R,N){return R.charCodeAt(N)<<24|R.charCodeAt(N+1)<<16|R.charCodeAt(N+2)<<8|R.charCodeAt(N+3)&255}function i(R,N,I,D){const B=R.substring(0,N),U=R.substring(N+I);return B+D+U}let a,o;const c=this._document.createElement("canvas");c.width=1,c.height=1;const f=c.getContext("2d");let h=0;function d(R,N){if(++h>30){Mt("Load test font never loaded."),N();return}if(f.font="30px "+R,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){N();return}setTimeout(d.bind(null,R,N))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,g.length,g);const y=16,b=1482184792;let A=r(m,y);for(a=0,o=g.length-3;a<o;a+=4)A=A-b+r(g,a)|0;a<g.length&&(A=A-b+r(g+"XXX",a)|0),m=i(m,y,4,F3(A));const w=`url(data:font/opentype;base64,${btoa(m)});`,C=`@font-face {font-family:"${g}";src:${w}}`;this.insertRule(C);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const R of[e.loadedName,g]){const N=this._document.createElement("span");N.textContent="Hi",N.style.fontFamily=R,T.append(N)}this._document.body.append(T),d(g,()=>{T.remove(),t.complete()})}}class q3{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this._inspectFont=t}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${z2(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let i;try{i=e.get(r)}catch(o){Mt(`getPathGenerator - ignoring character: "${o}".`)}const a=new Path2D(i||"");return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=a}}function K3(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(di)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Q3(n){if(di&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return zd(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function zp(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const v_=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,Z3=n=>typeof n=="object"&&typeof n?.name=="string",Y2=H3.bind(null,v_,Z3);class J3{#e=new Map;#t=Promise.resolve();postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[i]of this.#e)i.call(this,r)})}addEventListener(e,t,r=null){let i=null;if(r?.signal instanceof AbortSignal){const{signal:a}=r;if(a.aborted){Mt("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const jp={DATA:1,ERROR:2},tr={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function OA(){}function ki(n){if(n instanceof Co||n instanceof vg||n instanceof SA||n instanceof md||n instanceof wv)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||bn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Co(n.message);case"InvalidPDFException":return new vg(n.message);case"PasswordException":return new SA(n.message,n.code);case"ResponseException":return new md(n.message,n.status,n.missing);case"UnknownErrorException":return new wv(n.message,n.details)}return new wv(n.message,n.toString())}class Jh{#e=new AbortController;constructor(e,t,r){this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#r(e);return}if(e.callback){const r=e.callbackId,i=this.callbackCapabilities[r];if(!i)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===jp.DATA)i.resolve(e.data);else if(e.callback===jp.ERROR)i.reject(ki(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,i=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(o){a.postMessage({sourceName:r,targetName:i,callback:jp.DATA,callbackId:e.callbackId,data:o})},function(o){a.postMessage({sourceName:r,targetName:i,callback:jp.ERROR,callbackId:e.callbackId,reason:ki(o)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const i=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[i]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(o){a.reject(o)}return a.promise}sendWithStream(e,t,r,i){const a=this.streamId++,o=this.sourceName,c=this.targetName,f=this.comObj;return new ReadableStream({start:h=>{const d=Promise.withResolvers();return this.streamControllers[a]={controller:h,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:o,targetName:c,action:e,streamId:a,data:t,desiredSize:h.desiredSize},i),d.promise},pull:h=>{const d=Promise.withResolvers();return this.streamControllers[a].pullCall=d,f.postMessage({sourceName:o,targetName:c,stream:tr.PULL,streamId:a,desiredSize:h.desiredSize}),d.promise},cancel:h=>{ir(h instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[a].cancelCall=d,this.streamControllers[a].isClosed=!0,f.postMessage({sourceName:o,targetName:c,stream:tr.CANCEL,streamId:a,reason:ki(h)}),d.promise}},r)}#n(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,a=this.comObj,o=this,c=this.actionHandler[e.action],f={enqueue(h,d=1,g){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=d,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:r,targetName:i,stream:tr.ENQUEUE,streamId:t,chunk:h},g)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:r,targetName:i,stream:tr.CLOSE,streamId:t}),delete o.streamSinks[t])},error(h){ir(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:r,targetName:i,stream:tr.ERROR,streamId:t,reason:ki(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[t]=f,Promise.try(c,e.data,f).then(function(){a.postMessage({sourceName:r,targetName:i,stream:tr.START_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:r,targetName:i,stream:tr.START_COMPLETE,streamId:t,reason:ki(h)})})}#r(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,a=this.comObj,o=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case tr.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(ki(e.reason));break;case tr.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(ki(e.reason));break;case tr.PULL:if(!c){a.postMessage({sourceName:r,targetName:i,stream:tr.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||OA).then(function(){a.postMessage({sourceName:r,targetName:i,stream:tr.PULL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:r,targetName:i,stream:tr.PULL_COMPLETE,streamId:t,reason:ki(h)})});break;case tr.ENQUEUE:if(ir(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case tr.CLOSE:if(ir(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#s(o,t);break;case tr.ERROR:ir(o,"error should have stream controller"),o.controller.error(ki(e.reason)),this.#s(o,t);break;case tr.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(ki(e.reason)),this.#s(o,t);break;case tr.CANCEL:if(!c)break;const f=ki(e.reason);Promise.try(c.onCancel||OA,f).then(function(){a.postMessage({sourceName:r,targetName:i,stream:tr.CANCEL_COMPLETE,streamId:t,success:!0})},function(h){a.postMessage({sourceName:r,targetName:i,stream:tr.CANCEL_COMPLETE,streamId:t,reason:ki(h)})}),c.sinkCapability.reject(f),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#s(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class q2{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){bn("Abstract method `_createCanvas` called.")}}class eI extends q2{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class K2{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){bn("Abstract method `_fetch` called.")}}class RA extends K2{async _fetch(e){const t=await df(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):zd(t)}}class Q2{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,i,a){return"none"}destroy(e=!1){}}class tI extends Q2{#e;#t;#n;#r;#s;#i;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#r=e,this.#s=t}get#o(){return this.#t||=new Map}get#f(){return this.#i||=new Map}get#c(){if(!this.#n){const e=this.#s.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const r=this.#s.createElementNS(vo,"svg");r.setAttribute("width",0),r.setAttribute("height",0),this.#n=this.#s.createElementNS(vo,"defs"),e.append(r),r.append(this.#n),this.#s.body.append(e)}return this.#n}#h(e){if(e.length===1){const f=e[0],h=new Array(256);for(let g=0;g<256;g++)h[g]=f[g]/255;const d=h.join(",");return[d,d,d]}const[t,r,i]=e,a=new Array(256),o=new Array(256),c=new Array(256);for(let f=0;f<256;f++)a[f]=t[f]/255,o[f]=r[f]/255,c[f]=i[f]/255;return[a.join(","),o.join(","),c.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#s.URL;t!==this.#s.baseURI&&($d(t)?Mt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=ax(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[r,i,a]=this.#h(e),o=e.length===1?r:`${r}${i}${a}`;if(t=this.#o.get(o),t)return this.#o.set(e,t),t;const c=`g_${this.#r}_transfer_map_${this.#l++}`,f=this.#u(c);this.#o.set(e,f),this.#o.set(o,f);const h=this.#p(c);return this.#g(r,i,a,h),f}addHCMFilter(e,t){const r=`${e}-${t}`,i="base";let a=this.#f.get(i);if(a?.key===r||(a?(a.filter?.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},this.#f.set(i,a)),!e||!t))return a.url;const o=this.#_(e);e=dt.makeHexColor(...o);const c=this.#_(t);if(t=dt.makeHexColor(...c),this.#c.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return a.url;const f=new Array(256);for(let v=0;v<=255;v++){const y=v/255;f[v]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const h=f.join(","),d=`g_${this.#r}_hcm_filter`,g=a.filter=this.#p(d);this.#g(h,h,h,g),this.#a(g);const m=(v,y)=>{const b=o[v]/255,A=c[v]/255,w=new Array(y+1);for(let C=0;C<=y;C++)w[C]=b+C/y*(A-b);return w.join(",")};return this.#g(m(0,5),m(1,5),m(2,5),g),a.url=this.#u(d),a.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[r]=this.#h([e]),i=`alpha_${r}`;if(t=this.#o.get(i),t)return this.#o.set(e,t),t;const a=`g_${this.#r}_alpha_map_${this.#l++}`,o=this.#u(a);this.#o.set(e,o),this.#o.set(i,o);const c=this.#p(a);return this.#v(r,c),o}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let r,i;if(e?([r]=this.#h([e]),i=`luminosity_${r}`):i="luminosity",t=this.#o.get(i),t)return this.#o.set(e,t),t;const a=`g_${this.#r}_luminosity_map_${this.#l++}`,o=this.#u(a);this.#o.set(e,o),this.#o.set(i,o);const c=this.#p(a);return this.#d(c),e&&this.#v(r,c),o}addHighlightHCMFilter(e,t,r,i,a){const o=`${t}-${r}-${i}-${a}`;let c=this.#f.get(e);if(c?.key===o||(c?(c.filter?.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},this.#f.set(e,c)),!t||!r))return c.url;const[f,h]=[t,r].map(this.#_.bind(this));let d=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,v]=[i,a].map(this.#_.bind(this));g<d&&([d,g,m,v]=[g,d,v,m]),this.#c.style.color="";const y=(w,C,T)=>{const R=new Array(256),N=(g-d)/T,I=w/255,D=(C-w)/(255*T);let B=0;for(let U=0;U<=T;U++){const Y=Math.round(d+U*N),W=I+U*D;for(let re=B;re<=Y;re++)R[re]=W;B=Y+1}for(let U=B;U<256;U++)R[U]=R[B-1];return R.join(",")},b=`g_${this.#r}_hcm_${e}_filter`,A=c.filter=this.#p(b);return this.#a(A),this.#g(y(m[0],v[0],5),y(m[1],v[1],5),y(m[2],v[2],5),A),c.url=this.#u(b),c.url}destroy(e=!1){e&&this.#i?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#t?.clear(),this.#t=null,this.#i?.clear(),this.#i=null,this.#l=0)}#d(e){const t=this.#s.createElementNS(vo,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#a(e){const t=this.#s.createElementNS(vo,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#s.createElementNS(vo,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#c.append(t),t}#m(e,t,r){const i=this.#s.createElementNS(vo,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),e.append(i)}#g(e,t,r,i){const a=this.#s.createElementNS(vo,"feComponentTransfer");i.append(a),this.#m(a,"feFuncR",e),this.#m(a,"feFuncG",t),this.#m(a,"feFuncB",r)}#v(e,t){const r=this.#s.createElementNS(vo,"feComponentTransfer");t.append(r),this.#m(r,"feFuncA",e)}#_(e){return this.#c.style.color=e,ux(getComputedStyle(this.#c).getPropertyValue("color"))}}class Z2{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){bn("Abstract method `_fetch` called.")}}class NA extends Z2{async _fetch(e){const t=await df(e,"arraybuffer");return new Uint8Array(t)}}class J2{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){bn("Abstract method `_fetch` called.")}}class LA extends J2{async _fetch(e){const t=await df(e,"arraybuffer");return new Uint8Array(t)}}di&&Mt("Please use the `legacy` build in Node.js environments.");async function px(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class nI extends Q2{}class rI extends q2{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class iI extends K2{async _fetch(e){return px(e)}}class sI extends Z2{async _fetch(e){return px(e)}}class aI extends J2{async _fetch(e){return px(e)}}const Mr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function __(n,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,r),n.clip(i)}class gx{isModifyingCurrentTransform(){return!1}getPattern(){bn("Abstract method `getPattern` called.")}}class oI extends gx{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,i){let a;if(i===Mr.STROKE||i===Mr.FILL){const o=t.current.getClippedPathBoundingBox(i,Fn(e))||[0,0,0,0],c=Math.ceil(o[2]-o[0])||1,f=Math.ceil(o[3]-o[1])||1,h=t.cachedCanvases.getCanvas("pattern",c,f),d=h.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),r=dt.transform(r,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),__(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),a=e.createPattern(h.canvas,"no-repeat");const g=new DOMMatrix(r);a.setTransform(g)}else __(e,this._bbox),a=this._createGradient(e);return a}}function Cv(n,e,t,r,i,a,o,c){const f=e.coords,h=e.colors,d=n.data,g=n.width*4;let m;f[t+1]>f[r+1]&&(m=t,t=r,r=m,m=a,a=o,o=m),f[r+1]>f[i+1]&&(m=r,r=i,i=m,m=o,o=c,c=m),f[t+1]>f[r+1]&&(m=t,t=r,r=m,m=a,a=o,o=m);const v=(f[t]+e.offsetX)*e.scaleX,y=(f[t+1]+e.offsetY)*e.scaleY,b=(f[r]+e.offsetX)*e.scaleX,A=(f[r+1]+e.offsetY)*e.scaleY,w=(f[i]+e.offsetX)*e.scaleX,C=(f[i+1]+e.offsetY)*e.scaleY;if(y>=C)return;const T=h[a],R=h[a+1],N=h[a+2],I=h[o],D=h[o+1],B=h[o+2],U=h[c],Y=h[c+1],W=h[c+2],re=Math.round(y),Te=Math.round(C);let Fe,we,q,ee,Pe,qe,P,ye;for(let ve=re;ve<=Te;ve++){if(ve<A){const Ge=ve<y?0:(y-ve)/(y-A);Fe=v-(v-b)*Ge,we=T-(T-I)*Ge,q=R-(R-D)*Ge,ee=N-(N-B)*Ge}else{let Ge;ve>C?Ge=1:A===C?Ge=0:Ge=(A-ve)/(A-C),Fe=b-(b-w)*Ge,we=I-(I-U)*Ge,q=D-(D-Y)*Ge,ee=B-(B-W)*Ge}let ge;ve<y?ge=0:ve>C?ge=1:ge=(y-ve)/(y-C),Pe=v-(v-w)*ge,qe=T-(T-U)*ge,P=R-(R-Y)*ge,ye=N-(N-W)*ge;const Ce=Math.round(Math.min(Fe,Pe)),He=Math.round(Math.max(Fe,Pe));let Ie=g*ve+Ce*4;for(let Ge=Ce;Ge<=He;Ge++)ge=(Fe-Ge)/(Fe-Pe),ge<0?ge=0:ge>1&&(ge=1),d[Ie++]=we-(we-qe)*ge|0,d[Ie++]=q-(q-P)*ge|0,d[Ie++]=ee-(ee-ye)*ge|0,d[Ie++]=255}}function lI(n,e,t){const r=e.coords,i=e.colors;let a,o;switch(e.type){case"lattice":const c=e.verticesPerRow,f=Math.floor(r.length/c)-1,h=c-1;for(a=0;a<f;a++){let d=a*c;for(let g=0;g<h;g++,d++)Cv(n,t,r[d],r[d+1],r[d+c],i[d],i[d+1],i[d+c]),Cv(n,t,r[d+c+1],r[d+1],r[d+c],i[d+c+1],i[d+1],i[d+c])}break;case"triangles":for(a=0,o=r.length;a<o;a+=3)Cv(n,t,r[a],r[a+1],r[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class cI extends gx{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,r){const c=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-c,d=Math.ceil(this._bounds[3])-f,g=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),v=h/g,y=d/m,b={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-f,scaleX:1/v,scaleY:1/y},A=g+2*2,w=m+2*2,C=r.getCanvas("mesh",A,w),T=C.context,R=T.createImageData(g,m);if(t){const I=R.data;for(let D=0,B=I.length;D<B;D+=4)I[D]=t[0],I[D+1]=t[1],I[D+2]=t[2],I[D+3]=255}for(const I of this._figures)lI(R,I,b);return T.putImageData(R,2,2),{canvas:C.canvas,offsetX:c-2*v,offsetY:f-2*y,scaleX:v,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,t,r,i){__(e,this._bbox);const a=new Float32Array(2);if(i===Mr.SHADING)dt.singularValueDecompose2dScale(Fn(e),a);else if(this.matrix){dt.singularValueDecompose2dScale(this.matrix,a);const[c,f]=a;dt.singularValueDecompose2dScale(t.baseTransform,a),a[0]*=c,a[1]*=f}else dt.singularValueDecompose2dScale(t.baseTransform,a);const o=this._createMeshCanvas(a,i===Mr.SHADING?null:this._background,t.cachedCanvases);return i!==Mr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class uI extends gx{getPattern(){return"hotpink"}}function fI(n){switch(n[0]){case"RadialAxial":return new oI(n);case"Mesh":return new cI(n);case"Dummy":return new uI}throw new Error(`Unknown IR type: ${n[0]}`)}const MA={COLORED:1,UNCOLORED:2};class mx{static MAX_PATTERN_SIZE=3e3;constructor(e,t,r,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:r,paintType:i,tilingType:a,color:o,canvasGraphicsFactory:c}=this;let{xstep:f,ystep:h}=this;f=Math.abs(f),h=Math.abs(h),sm("TilingType: "+a);const d=t[0],g=t[1],m=t[2],v=t[3],y=m-d,b=v-g,A=new Float32Array(2);dt.singularValueDecompose2dScale(this.matrix,A);const[w,C]=A;dt.singularValueDecompose2dScale(this.baseTransform,A);const T=w*A[0],R=C*A[1];let N=y,I=b,D=!1,B=!1;const U=Math.ceil(f*T),Y=Math.ceil(h*R),W=Math.ceil(y*T),re=Math.ceil(b*R);U>=W?N=f:D=!0,Y>=re?I=h:B=!0;const Te=this.getSizeAndScale(N,this.ctx.canvas.width,T),Fe=this.getSizeAndScale(I,this.ctx.canvas.height,R),we=e.cachedCanvases.getCanvas("pattern",Te.size,Fe.size),q=we.context,ee=c.createCanvasGraphics(q);if(ee.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ee,i,o),q.translate(-Te.scale*d,-Fe.scale*g),ee.transform(Te.scale,0,0,Fe.scale,0,0),q.save(),this.clipBbox(ee,d,g,m,v),ee.baseTransform=Fn(ee.ctx),ee.executeOperatorList(r),ee.endDrawing(),q.restore(),D||B){const Pe=we.canvas;D&&(N=f),B&&(I=h);const qe=this.getSizeAndScale(N,this.ctx.canvas.width,T),P=this.getSizeAndScale(I,this.ctx.canvas.height,R),ye=qe.size,ve=P.size,ge=e.cachedCanvases.getCanvas("pattern-workaround",ye,ve),Ce=ge.context,He=D?Math.floor(y/f):0,Ie=B?Math.floor(b/h):0;for(let Ge=0;Ge<=He;Ge++)for(let k=0;k<=Ie;k++)Ce.drawImage(Pe,ye*Ge,ve*k,ye,ve,0,0,ye,ve);return{canvas:ge.canvas,scaleX:qe.scale,scaleY:P.scale,offsetX:d,offsetY:g}}return{canvas:we.canvas,scaleX:Te.scale,scaleY:Fe.scale,offsetX:d,offsetY:g}}getSizeAndScale(e,t,r){const i=Math.max(mx.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*r);return a>=i?a=i:r=a/e,{scale:r,size:a}}clipBbox(e,t,r,i,a){const o=i-t,c=a-r;e.ctx.rect(t,r,o,c),dt.axialAlignedBoundingBox([t,r,i,a],Fn(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const i=e.ctx,a=e.current;switch(t){case MA.COLORED:const{fillStyle:o,strokeStyle:c}=this.ctx;i.fillStyle=a.fillColor=o,i.strokeStyle=a.strokeColor=c;break;case MA.UNCOLORED:i.fillStyle=i.strokeStyle=r,a.fillColor=a.strokeColor=r;break;default:throw new k3(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,r,i){let a=r;i!==Mr.SHADING&&(a=dt.transform(a,t.baseTransform),this.matrix&&(a=dt.transform(a,this.matrix)));const o=this.createPatternCanvas(t);let c=new DOMMatrix(a);c=c.translate(o.offsetX,o.offsetY),c=c.scale(1/o.scaleX,1/o.scaleY);const f=e.createPattern(o.canvas,"repeat");return f.setTransform(c),f}}function hI({src:n,srcPos:e=0,dest:t,width:r,height:i,nonBlackColor:a=4294967295,inverseDecode:o=!1}){const c=Ar.isLittleEndian?4278190080:255,[f,h]=o?[a,c]:[c,a],d=r>>3,g=r&7,m=n.length;t=new Uint32Array(t.buffer);let v=0;for(let y=0;y<i;y++){for(const A=e+d;e<A;e++){const w=e<m?n[e]:255;t[v++]=w&128?h:f,t[v++]=w&64?h:f,t[v++]=w&32?h:f,t[v++]=w&16?h:f,t[v++]=w&8?h:f,t[v++]=w&4?h:f,t[v++]=w&2?h:f,t[v++]=w&1?h:f}if(g===0)continue;const b=e<m?n[e++]:255;for(let A=0;A<g;A++)t[v++]=b&1<<7-A?h:f}return{srcPos:e,destPos:v}}const IA=16,kA=100,dI=15,FA=10,Pi=16,Dv=new DOMMatrix,es=new Float32Array(2),Fu=new Float32Array([1/0,1/0,-1/0,-1/0]);function pI(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,r){e.translate(t,r),this.__originalTranslate(t,r)},n.scale=function(t,r){e.scale(t,r),this.__originalScale(t,r)},n.transform=function(t,r,i,a,o,c){e.transform(t,r,i,a,o,c),this.__originalTransform(t,r,i,a,o,c)},n.setTransform=function(t,r,i,a,o,c){e.setTransform(t,r,i,a,o,c),this.__originalSetTransform(t,r,i,a,o,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,i,a,o,c){e.bezierCurveTo(t,r,i,a,o,c),this.__originalBezierCurveTo(t,r,i,a,o,c)},n.rect=function(t,r,i,a){e.rect(t,r,i,a),this.__originalRect(t,r,i,a)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class gI{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,r)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function $p(n,e,t,r,i,a,o,c,f,h){const[d,g,m,v,y,b]=Fn(n);if(g===0&&m===0){const C=o*d+y,T=Math.round(C),R=c*v+b,N=Math.round(R),I=(o+f)*d+y,D=Math.abs(Math.round(I)-T)||1,B=(c+h)*v+b,U=Math.abs(Math.round(B)-N)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(v),T,N),n.drawImage(e,t,r,i,a,0,0,D,U),n.setTransform(d,g,m,v,y,b),[D,U]}if(d===0&&v===0){const C=c*m+y,T=Math.round(C),R=o*g+b,N=Math.round(R),I=(c+h)*m+y,D=Math.abs(Math.round(I)-T)||1,B=(o+f)*g+b,U=Math.abs(Math.round(B)-N)||1;return n.setTransform(0,Math.sign(g),Math.sign(m),0,T,N),n.drawImage(e,t,r,i,a,0,0,U,D),n.setTransform(d,g,m,v,y,b),[U,D]}n.drawImage(e,t,r,i,a,o,c,f,h);const A=Math.hypot(d,g),w=Math.hypot(m,v);return[A*f,w*h]}class PA{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=g_;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Wr.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t){this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Fu.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Mr.FILL,t=null){const r=this.minMax.slice();if(e===Mr.STROKE){t||bn("Stroke bounding box must include transform."),dt.singularValueDecompose2dScale(t,es);const i=es[0]*this.lineWidth/2,a=es[1]*this.lineWidth/2;r[0]-=i,r[1]-=a,r[2]+=i,r[3]+=a}return r}updateClipFromPath(){const e=dt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Fu,0)}getClippedPathBoundingBox(e=Mr.FILL,t=null){return dt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function BA(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,r=e.width,i=t%Pi,a=(t-i)/Pi,o=i===0?a:a+1,c=n.createImageData(r,Pi);let f=0,h;const d=e.data,g=c.data;let m,v,y,b;if(e.kind===id.GRAYSCALE_1BPP){const A=d.byteLength,w=new Uint32Array(g.buffer,0,g.byteLength>>2),C=w.length,T=r+7>>3,R=4294967295,N=Ar.isLittleEndian?4278190080:255;for(m=0;m<o;m++){for(y=m<a?Pi:i,h=0,v=0;v<y;v++){const I=A-f;let D=0;const B=I>T?r:I*8-7,U=B&-8;let Y=0,W=0;for(;D<U;D+=8)W=d[f++],w[h++]=W&128?R:N,w[h++]=W&64?R:N,w[h++]=W&32?R:N,w[h++]=W&16?R:N,w[h++]=W&8?R:N,w[h++]=W&4?R:N,w[h++]=W&2?R:N,w[h++]=W&1?R:N;for(;D<B;D++)Y===0&&(W=d[f++],Y=128),w[h++]=W&Y?R:N,Y>>=1}for(;h<C;)w[h++]=0;n.putImageData(c,0,m*Pi)}}else if(e.kind===id.RGBA_32BPP){for(v=0,b=r*Pi*4,m=0;m<a;m++)g.set(d.subarray(f,f+b)),f+=b,n.putImageData(c,0,v),v+=Pi;m<o&&(b=r*i*4,g.set(d.subarray(f,f+b)),n.putImageData(c,0,v))}else if(e.kind===id.RGB_24BPP)for(y=Pi,b=r*y,m=0;m<o;m++){for(m>=a&&(y=i,b=r*y),h=0,v=b;v--;)g[h++]=d[f++],g[h++]=d[f++],g[h++]=d[f++],g[h++]=255;n.putImageData(c,0,m*Pi)}else throw new Error(`bad image kind: ${e.kind}`)}function UA(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,i=t%Pi,a=(t-i)/Pi,o=i===0?a:a+1,c=n.createImageData(r,Pi);let f=0;const h=e.data,d=c.data;for(let g=0;g<o;g++){const m=g<a?Pi:i;({srcPos:f}=hI({src:h,srcPos:f,dest:d,width:r,height:m,nonBlackColor:0})),n.putImageData(c,0,g*Pi)}}function Gh(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Gp(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function HA(n,e){if(e)return!0;dt.singularValueDecompose2dScale(n,es);const t=Math.fround(ea.pixelRatio*bc.PDF_TO_CSS_UNITS);return es[0]<=t&&es[1]<=t}const mI=["butt","round","square"],vI=["miter","round","bevel"],_I={},zA={};class Bu{constructor(e,t,r,i,a,{optionalContentConfig:o,markedContentStack:c=null},f,h){this.ctx=e,this.current=new PA(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=i,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=o,this.cachedCanvases=new gI(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:i=null}){const a=this.ctx.canvas.width,o=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,a,o),this.ctx.fillStyle=c,r){const f=this.cachedCanvases.getCanvas("transparent",a,o);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(...Fn(this.compositeCtx))}this.ctx.save(),Gp(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Fn(this.ctx)}executeOperatorList(e,t,r,i){const a=e.argsArray,o=e.fnArray;let c=t||0;const f=a.length;if(f===c)return c;const h=f-c>FA&&typeof r=="function",d=h?Date.now()+dI:0;let g=0;const m=this.commonObjs,v=this.objs;let y;for(;;){if(i!==void 0&&c===i.nextBreakPoint)return i.breakIt(c,r),c;if(y=o[c],y!==gd.dependency)this[y].apply(this,a[c]);else for(const b of a[c]){const A=b.startsWith("g_")?m:v;if(!A.has(b))return A.get(b,r),c}if(c++,c===f)return c;if(h&&++g>FA){if(Date.now()>d)return r(),c;g=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const r=e.width??e.displayWidth,i=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),c=r,f=i,h="prescale1",d,g;for(;a>2&&c>1||o>2&&f>1;){let m=c,v=f;a>2&&c>1&&(m=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/m),o>2&&f>1&&(v=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,o/=f/v),d=this.cachedCanvases.getCanvas(h,m,v),g=d.context,g.clearRect(0,0,m,v),g.drawImage(e,0,0,c,f,0,0,m,v),e=d.canvas,c=m,f=v,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:f}}_createMaskCanvas(e){const t=this.ctx,{width:r,height:i}=e,a=this.current.fillColor,o=this.current.patternFill,c=Fn(t);let f,h,d,g;if((e.bitmap||e.data)&&e.count>1){const U=e.bitmap||e.data.buffer;h=JSON.stringify(o?c:[c.slice(0,4),a]),f=this._cachedBitmapsMap.get(U),f||(f=new Map,this._cachedBitmapsMap.set(U,f));const Y=f.get(h);if(Y&&!o){const W=Math.round(Math.min(c[0],c[2])+c[4]),re=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:Y,offsetX:W,offsetY:re}}d=Y}d||(g=this.cachedCanvases.getCanvas("maskCanvas",r,i),UA(g.context,e));let m=dt.transform(c,[1/r,0,0,-1/i,0,0]);m=dt.transform(m,[1,0,0,1,0,-i]);const v=Fu.slice();dt.axialAlignedBoundingBox([0,0,r,i],m,v);const[y,b,A,w]=v,C=Math.round(A-y)||1,T=Math.round(w-b)||1,R=this.cachedCanvases.getCanvas("fillCanvas",C,T),N=R.context,I=y,D=b;N.translate(-I,-D),N.transform(...m),d||(d=this._scaleImage(g.canvas,Aa(N)),d=d.img,f&&o&&f.set(h,d)),N.imageSmoothingEnabled=HA(Fn(N),e.interpolate),$p(N,d,0,0,d.width,d.height,0,0,r,i),N.globalCompositeOperation="source-in";const B=dt.transform(Aa(N),[1,0,0,1,-I,-D]);return N.fillStyle=o?a.getPattern(t,this,B,Mr.FILL):a,N.fillRect(0,0,r,i),f&&!o&&(this.cachedCanvases.delete("fillCanvas"),f.set(h,R.canvas)),{canvas:R.canvas,offsetX:Math.round(I),offsetY:Math.round(D)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=mI[e]}setLineJoin(e){this.ctx.lineJoin=vI[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,r]of e)switch(t){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,e,t);this.suspendedCtx=this.ctx;const a=this.ctx=i.context;a.setTransform(this.suspendedCtx.getTransform()),Gh(this.suspendedCtx,a),pI(a,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Gh(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,i){const a=i[0],o=i[1],c=i[2]-a,f=i[3]-o;c===0||f===0||(this.genericComposeSMask(t.context,r,c,f,t.subtype,t.backdrop,t.transferMap,a,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,i,a,o,c,f,h,d,g){let m=e.canvas,v=f-d,y=h-g;if(o)if(v<0||y<0||v+r>m.width||y+i>m.height){const A=this.cachedCanvases.getCanvas("maskExtension",r,i),w=A.context;w.drawImage(m,-v,-y),w.globalCompositeOperation="destination-atop",w.fillStyle=o,w.fillRect(0,0,r,i),w.globalCompositeOperation="source-over",m=A.canvas,v=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(v,y,r,i),e.clip(A),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(v,y,r,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const b=new Path2D;b.rect(f,h,r,i),t.clip(b),t.globalCompositeOperation="destination-in",t.drawImage(m,v,y,r,i,f,h,r,i),t.restore()}save(){this.inSMaskMode&&Gh(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Gh(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,r,i,a,o){this.ctx.transform(e,t,r,i,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r){let[i]=t;if(!r){i||=t[0]=new Path2D,this[e](i);return}if(!(i instanceof Path2D)){const a=t[0]=new Path2D;for(let o=0,c=i.length;o<c;)switch(i[o++]){case Hp.moveTo:a.moveTo(i[o++],i[o++]);break;case Hp.lineTo:a.lineTo(i[o++],i[o++]);break;case Hp.curveTo:a.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case Hp.closePath:a.closePath();break;default:Mt(`Unrecognized drawing path operator: ${i[o-1]}`);break}i=a}dt.axialAlignedBoundingBox(r,Fn(this.ctx),this.current.minMax),this[e](i)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&i?.getPattern){const a=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=i.getPattern(r,this,Aa(r),Mr.STROKE),a){const o=new Path2D;o.addPath(e,r.getTransform().invertSelf().multiplySelf(a)),e=o}this.rescaleAndStroke(e,!1),r.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(Mr.STROKE,Fn(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const r=this.ctx,i=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const f=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.fillStyle=i.getPattern(r,this,Aa(r),Mr.FILL),f){const h=new Path2D;h.addPath(e,r.getTransform().invertSelf().multiplySelf(f)),e=h}o=!0}const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(r.fill(e,"evenodd"),this.pendingEOFill=!1):r.fill(e)),o&&r.restore(),t&&this.consumePath(e,c)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=_I}eoClip(){this.pendingClip=zA}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const r=new Path2D,i=t.getTransform().invertSelf();for(const{transform:a,x:o,y:c,fontSize:f,path:h}of e)r.addPath(h,new DOMMatrix(a).preMultiplySelf(i).translate(o,c).scale(f,-f));t.clip(r),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const r=this.commonObjs.get(e),i=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=r.fontMatrix||g_,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Mt("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=t,r.isType3Font)return;const a=r.loadedName||"sans-serif",o=r.systemFontInfo?.css||`"${a}", ${r.fallbackName}`;let c="normal";r.black?c="900":r.bold&&(c="bold");const f=r.italic?"italic":"normal";let h=t;t<IA?h=IA:t>kA&&(h=kA),this.current.fontSizeScale=t/h,this.ctx.font=`${f} ${c} ${h}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(e,t,r){const i=new Path2D;return i.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),i}paintChar(e,t,r,i,a){const o=this.ctx,c=this.current,f=c.font,h=c.textRenderingMode,d=c.fontSize/c.fontSizeScale,g=h&Wr.FILL_STROKE_MASK,m=!!(h&Wr.ADD_TO_PATH_FLAG),v=c.patternFill&&!f.missingFile,y=c.patternStroke&&!f.missingFile;let b;if((f.disableFontFace||m||v||y)&&(b=f.getPathGenerator(this.commonObjs,e)),f.disableFontFace||v||y){o.save(),o.translate(t,r),o.scale(d,-d);let A;if((g===Wr.FILL||g===Wr.FILL_STROKE)&&(i?(A=o.getTransform(),o.setTransform(...i),o.fill(this.#n(b,A,i))):o.fill(b)),g===Wr.STROKE||g===Wr.FILL_STROKE)if(a){A||=o.getTransform(),o.setTransform(...a);const{a:w,b:C,c:T,d:R}=A,N=dt.inverseTransform(a),I=dt.transform([w,C,T,R,0,0],N);dt.singularValueDecompose2dScale(I,es),o.lineWidth*=Math.max(es[0],es[1])/d,o.stroke(this.#n(b,A,a))}else o.lineWidth/=d,o.stroke(b);o.restore()}else(g===Wr.FILL||g===Wr.FILL_STROKE)&&o.fillText(e,t,r),(g===Wr.STROKE||g===Wr.FILL_STROKE)&&o.strokeText(e,t,r);m&&(this.pendingTextPaths||=[]).push({transform:Fn(o),x:t,y:r,fontSize:d,path:b})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return Vt(this,"isFontSubpixelAAEnabled",r)}showText(e){const t=this.current,r=t.font;if(r.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const a=this.ctx,o=t.fontSizeScale,c=t.charSpacing,f=t.wordSpacing,h=t.fontDirection,d=t.textHScale*h,g=e.length,m=r.vertical,v=m?1:-1,y=r.defaultVMetrics,b=i*t.fontMatrix[0],A=t.textRenderingMode===Wr.FILL&&!r.disableFontFace&&!t.patternFill;a.save(),t.textMatrix&&a.transform(...t.textMatrix),a.translate(t.x,t.y+t.textRise),h>0?a.scale(d,-1):a.scale(d,1);let w,C;if(t.patternFill){a.save();const D=t.fillColor.getPattern(a,this,Aa(a),Mr.FILL);w=Fn(a),a.restore(),a.fillStyle=D}if(t.patternStroke){a.save();const D=t.strokeColor.getPattern(a,this,Aa(a),Mr.STROKE);C=Fn(a),a.restore(),a.strokeStyle=D}let T=t.lineWidth;const R=t.textMatrixScale;if(R===0||T===0){const D=t.textRenderingMode&Wr.FILL_STROKE_MASK;(D===Wr.STROKE||D===Wr.FILL_STROKE)&&(T=this.getSinglePixelWidth())}else T/=R;if(o!==1&&(a.scale(o,o),T/=o),a.lineWidth=T,r.isInvalidPDFjsFont){const D=[];let B=0;for(const U of e)D.push(U.unicode),B+=U.width;a.fillText(D.join(""),0,0),t.x+=B*b*d,a.restore(),this.compose();return}let N=0,I;for(I=0;I<g;++I){const D=e[I];if(typeof D=="number"){N+=v*D*i/1e3;continue}let B=!1;const U=(D.isSpace?f:0)+c,Y=D.fontChar,W=D.accent;let re,Te,Fe=D.width;if(m){const q=D.vmetric||y,ee=-(D.vmetric?q[1]:Fe*.5)*b,Pe=q[2]*b;Fe=q?-q[0]:Fe,re=ee/o,Te=(N+Pe)/o}else re=N/o,Te=0;if(r.remeasure&&Fe>0){const q=a.measureText(Y).width*1e3/i*o;if(Fe<q&&this.isFontSubpixelAAEnabled){const ee=Fe/q;B=!0,a.save(),a.scale(ee,1),re/=ee}else Fe!==q&&(re+=(Fe-q)/2e3*i/o)}if(this.contentVisible&&(D.isInFont||r.missingFile)){if(A&&!W)a.fillText(Y,re,Te);else if(this.paintChar(Y,re,Te,w,C),W){const q=re+i*W.offset.x/o,ee=Te-i*W.offset.y/o;this.paintChar(W.fontChar,q,ee,w,C)}}const we=m?Fe*b-U*h:Fe*b+U*h;N+=we,B&&a.restore()}m?t.y-=N:t.x+=N*d,a.restore(),this.compose()}showType3Text(e){const t=this.ctx,r=this.current,i=r.font,a=r.fontSize,o=r.fontDirection,c=i.vertical?1:-1,f=r.charSpacing,h=r.wordSpacing,d=r.textHScale*o,g=r.fontMatrix||g_,m=e.length,v=r.textRenderingMode===Wr.INVISIBLE;let y,b,A,w;if(!(v||a===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),r.textMatrix&&t.transform(...r.textMatrix),t.translate(r.x,r.y+r.textRise),t.scale(d,o),y=0;y<m;++y){if(b=e[y],typeof b=="number"){w=c*b*a/1e3,this.ctx.translate(w,0),r.x+=w*d;continue}const C=(b.isSpace?h:0)+f,T=i.charProcOperatorList[b.operatorListId];T?this.contentVisible&&(this.save(),t.scale(a,a),t.transform(...g),this.executeOperatorList(T),this.restore()):Mt(`Type3 character "${b.operatorListId}" is not available.`);const R=[b.width,0];dt.applyTransform(R,g),A=R[0]*a+C,t.translate(A,0),r.x+=A*d}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,r,i,a,o){const c=new Path2D;c.rect(r,i,a-r,o-i),this.ctx.clip(c),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const r=this.baseTransform||Fn(this.ctx),i={createCanvasGraphics:a=>new Bu(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new mx(e,this.ctx,i,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=fI(this.getObject(e)),this.cachedPatterns.set(e,r)),t&&(r.matrix=t),r}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const r=this._getPattern(e);t.fillStyle=r.getPattern(t,this,Aa(t),Mr.SHADING);const i=Aa(t);if(i){const{width:a,height:o}=t.canvas,c=Fu.slice();dt.axialAlignedBoundingBox([0,0,a,o],i,c);const[f,h,d,g]=c;this.ctx.fillRect(f,h,d-f,g-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){bn("Should not call beginInlineImage")}beginImageData(){bn("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Fn(this.ctx),t)){dt.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[r,i,a,o]=t,c=new Path2D;c.rect(r,i,a-r,o-i),this.ctx.clip(c),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||sm("TODO: Support non-isolated groups."),e.knockout&&Mt("Knockout groups not supported.");const r=Fn(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Fu.slice();dt.axialAlignedBoundingBox(e.bbox,Fn(t),i);const a=[0,0,t.canvas.width,t.canvas.height];i=dt.intersect(i,a)||[0,0,0,0];const o=Math.floor(i[0]),c=Math.floor(i[1]),f=Math.max(Math.ceil(i[2])-o,1),h=Math.max(Math.ceil(i[3])-c,1);this.current.startNewPathAndClipBox([0,0,f,h]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(d,f,h),m=g.context;m.translate(-o,-c),m.transform(...r);let v=new Path2D;const[y,b,A,w]=e.bbox;if(v.rect(y,b,A-y,w-b),e.matrix){const C=new Path2D;C.addPath(v,new DOMMatrix(e.matrix)),v=C}m.clip(v),e.smask?this.smaskStack.push({canvas:g.canvas,context:m,offsetX:o,offsetY:c,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,c),t.save()),Gh(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Fn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const a=Fu.slice();dt.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i,a),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,r,i,a){if(this.#e(),Gp(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],c=t[3]-t[1];if(a&&this.annotationCanvasMap){r=r.slice(),r[4]-=t[0],r[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=c,dt.singularValueDecompose2dScale(Fn(this.ctx),es);const{viewportScale:f}=this,h=Math.ceil(o*this.outputScaleX*f),d=Math.ceil(c*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(h,d);const{canvas:g,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(es[0],0,0,-es[1],0,c*es[1]),Gp(this.ctx)}else{Gp(this.ctx),this.endPath();const f=new Path2D;f.rect(t[0],t[1],o,c),this.ctx.clip(f)}}this.current=new PA(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const r=this.ctx,i=this._createMaskCanvas(e),a=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(a,i.offsetX,i.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r=0,i=0,a,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const c=this.ctx;c.save();const f=Fn(c);c.transform(t,r,i,a,0,0);const h=this._createMaskCanvas(e);c.setTransform(1,0,0,1,h.offsetX-f[4],h.offsetY-f[5]);for(let d=0,g=o.length;d<g;d+=2){const m=dt.transform(f,[t,r,i,a,o[d],o[d+1]]);c.drawImage(h.canvas,m[4],m[5])}c.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,r=this.current.fillColor,i=this.current.patternFill;for(const a of e){const{data:o,width:c,height:f,transform:h}=a,d=this.cachedCanvases.getCanvas("maskCanvas",c,f),g=d.context;g.save();const m=this.getObject(o,a);UA(g,m),g.globalCompositeOperation="source-in",g.fillStyle=i?r.getPattern(g,this,Aa(t),Mr.FILL):r,g.fillRect(0,0,c,f),g.restore(),t.save(),t.transform(...h),t.scale(1,-1),$p(t,d.canvas,0,0,c,f,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Mt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,r,i){if(!this.contentVisible)return;const a=this.getObject(e);if(!a){Mt("Dependent image isn't ready yet");return}const o=a.width,c=a.height,f=[];for(let h=0,d=i.length;h<d;h+=2)f.push({transform:[t,0,0,r,i[h],i[h+1]],x:0,y:0,w:o,h:c});this.paintInlineImageXObjectGroup(a,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:i}=e,a=this.cachedCanvases.getCanvas("inlineImage",r,i),o=a.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",a.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,r=e.height,i=this.ctx;this.save();const{filter:a}=i;a!=="none"&&a!==""&&(i.filter="none"),i.scale(1/t,-1/r);let o;if(e.bitmap)o=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)o=e;else{const h=this.cachedCanvases.getCanvas("inlineImage",t,r).context;BA(h,e),o=this.applyTransferMapsToCanvas(h)}const c=this._scaleImage(o,Aa(i));i.imageSmoothingEnabled=HA(Fn(i),e.interpolate),$p(i,c.img,0,0,c.paintWidth,c.paintHeight,0,-r,t,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const r=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const a=e.width,o=e.height,f=this.cachedCanvases.getCanvas("inlineImage",a,o).context;BA(f,e),i=this.applyTransferMapsToCanvas(f)}for(const a of t)r.save(),r.transform(...a.transform),r.scale(1,-1),$p(r,i,a.x,a.y,a.w,a.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(r||(this.pendingClip===zA?i.clip(e,"evenodd"):i.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Fn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:i,d:a}=this.ctx.getTransform();let o,c;if(r===0&&i===0){const f=Math.abs(t),h=Math.abs(a);if(f===h)if(e===0)o=c=1/f;else{const d=f*e;o=c=d<1?1/d:1}else if(e===0)o=1/f,c=1/h;else{const d=f*e,g=h*e;o=d<1?1/d:1,c=g<1?1/g:1}}else{const f=Math.abs(t*a-r*i),h=Math.hypot(t,r),d=Math.hypot(i,a);if(e===0)o=d/f,c=h/f;else{const g=e*f;o=d>g?d/g:1,c=h>g?h/g:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:r,current:{lineWidth:i}}=this,[a,o]=this.getScaleForStroking();if(a===o){r.lineWidth=(i||1)*a,r.stroke(e);return}const c=r.getLineDash();t&&r.save(),r.scale(a,o),Dv.a=1/a,Dv.d=1/o;const f=new Path2D;if(f.addPath(e,Dv),c.length>0){const h=Math.max(a,o);r.setLineDash(c.map(d=>d/h)),r.lineDashOffset/=h}r.lineWidth=i||1,r.stroke(f),t&&r.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const n in gd)Bu.prototype[n]!==void 0&&(Bu.prototype[gd[n]]=Bu.prototype[n]);class gl{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class xI{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const Mu=Symbol("INTERNAL");class yI{#e=!1;#t=!1;#n=!1;#r=!0;constructor(e,{name:t,intent:r,usage:i,rbGroups:a}){this.#e=!!(e&Qi.DISPLAY),this.#t=!!(e&Qi.PRINT),this.name=t,this.intent=r,this.usage=i,this.rbGroups=a}get visible(){if(this.#n)return this.#r;if(!this.#r)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,r=!1){e!==Mu&&bn("Internal method `_setVisible` called."),this.#n=r,this.#r=t}}class bI{#e=null;#t=new Map;#n=null;#r=null;constructor(e,t=Qi.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#r=e.order;for(const r of e.groups)this.#t.set(r.id,new yI(t,r));if(e.baseState==="OFF")for(const r of this.#t.values())r._setVisible(Mu,!1);for(const r of e.on)this.#t.get(r)._setVisible(Mu,!0);for(const r of e.off)this.#t.get(r)._setVisible(Mu,!1);this.#n=this.getHash()}}#s(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let i=1;i<t;i++){const a=e[i];let o;if(Array.isArray(a))o=this.#s(a);else if(this.#t.has(a))o=this.#t.get(a).visible;else return Mt(`Optional content group not found: ${a}`),!0;switch(r){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return r==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return sm("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Mt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#s(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Mt(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Mt(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Mt(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Mt(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Mt(`Unknown optional content policy ${e.policy}.`),!0}return Mt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){const i=this.#t.get(e);if(!i){Mt(`Optional content group not found: ${e}`);return}if(r&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&this.#t.get(o)?._setVisible(Mu,!1,!0);i._setVisible(Mu,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let r;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":r=i;continue}const a=this.#t.get(i);if(a)switch(r){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!a.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#r?this.#r.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new W2;for(const[t,r]of this.#t)e.update(`${t}:${r.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class EI{constructor(e,{disableRange:t=!1,disableStream:r=!1}){ir(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:a,progressiveDone:o,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=c,a?.length>0){const f=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((f,h)=>{this._onReceiveData({begin:f,chunk:h})}),e.addProgressListener((f,h)=>{this._onProgress({loaded:f,total:h})}),e.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const i=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(r),!0)});ir(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ir(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new AI(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new wI(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class AI{constructor(e,t,r=!1,i=null){this._stream=e,this._done=r||!1,this._filename=om(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class wI{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function SI(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let d=c(t);return d=unescape(d),d=f(d),d=h(d),a(d)}if(t=o(n),t){const d=h(t);return a(d)}if(t=r("filename","i").exec(n),t){t=t[1];let d=c(t);return d=h(d),a(d)}function r(d,g){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function i(d,g){if(d){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const m=new TextDecoder(d,{fatal:!0}),v=zd(g);g=m.decode(v),e=!1}catch{}}return g}function a(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function o(d){const g=[];let m;const v=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(d))!==null;){let[,b,A,w]=m;if(b=parseInt(b,10),b in g){if(b===0)break;continue}g[b]=[A,w]}const y=[];for(let b=0;b<g.length&&b in g;++b){let[A,w]=g[b];w=c(w),A&&(w=unescape(w),b===0&&(w=f(w))),y.push(w)}return y.join("")}function c(d){if(d.startsWith('"')){const g=d.slice(1).split('\\"');for(let m=0;m<g.length;++m){const v=g[m].indexOf('"');v!==-1&&(g[m]=g[m].slice(0,v),g.length=m+1),g[m]=g[m].replaceAll(/\\(.)/g,"$1")}d=g.join('"')}return d}function f(d){const g=d.indexOf("'");if(g===-1)return d;const m=d.slice(0,g),y=d.slice(g+1).replace(/^[^']*'/,"");return i(m,y)}function h(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,m,v,y){if(v==="q"||v==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(b,A){return String.fromCharCode(parseInt(A,16))}),i(m,y);try{y=atob(y)}catch{}return i(m,y)})}return""}function eT(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const r in e){const i=e[r];i!==void 0&&t.append(r,i)}return t}function lm(n){return URL.parse(n)?.origin??null}function tT({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){const i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(n.get("Content-Length"),10);return!Number.isInteger(a)||(i.suggestedLength=a,a<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function nT(n){const e=n.get("Content-Disposition");if(e){let t=SI(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(om(t))return t}return null}function Wd(n,e){return new md(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function rT(n){return n===200||n===206}function iT(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function sT(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Mt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class TI{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=eT(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ir(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new CI(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new DI(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class CI{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),i=t.url;fetch(i,iT(r,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=lm(a.url),!rT(a.status))throw Wd(a.status,i);this._reader=a.body.getReader(),this._headersCapability.resolve();const o=a.headers,{allowRangeRequests:c,suggestedLength:f}=tT({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=f||this._contentLength,this._filename=nT(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Co("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:sT(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class DI{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${r-1}`);const o=i.url;fetch(o,iT(a,this._withCredentials,this._abortController)).then(c=>{const f=lm(c.url);if(f!==e._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${e._responseOrigin}".`);if(!rT(c.status))throw Wd(c.status,o);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:sT(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const Ov=200,Rv=206;function OI(n){const e=n.response;return typeof e!="string"?e:zd(e).buffer}class RI{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:r}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=eT(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,i=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,o]of this.headers)t.setRequestHeader(a,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Rv):i.expectedStatus=Ov,t.responseType="arraybuffer",ir(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){const r=this.pendingRequests[e];r&&r.onProgress?.(t)}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){r.onError(i.status);return}const a=i.status||Ov;if(!(a===Ov&&r.expectedStatus===Rv)&&a!==r.expectedStatus){r.onError(i.status);return}const c=OI(i);if(a===Rv){const f=i.getResponseHeader("Content-Range"),h=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);h?r.onDone({begin:parseInt(h[1],10),chunk:c}):(Mt('Missing or invalid "Content-Range" header.'),r.onError(0))}else c?r.onDone({begin:0,chunk:c}):r.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class NI{constructor(e){this._source=e,this._manager=new RI(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ir(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new LI(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new MI(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class LI{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=lm(t.responseURL);const r=t.getAllResponseHeaders(),i=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[f,...h]=c.split(": ");return[f,h.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:o}=tT({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=nT(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Wd(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class MI{constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=lm(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Wd(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const II=/^[a-z][a-z0-9\-+.]+:/i;function kI(n){if(II.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class FI{constructor(e){this.source=e,this.url=kI(e.url),ir(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ir(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new PI(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new BI(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class PI{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=Wd(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Co("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class BI{constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Vh=Symbol("INITIAL_DATA");class aT{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Vh}}get(e,t=null){if(t){const i=this.#t(e);return i.promise.then(()=>t(i.data)),null}const r=this.#e[e];if(!r||r.data===Vh)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=this.#e[e];return!!t&&t.data!==Vh}delete(e){const t=this.#e[e];return!t||t.data===Vh?!1:(delete this.#e[e],!0)}resolve(e,t=null){const r=this.#t(e);r.data=t,r.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Vh&&(yield[e,t])}}}const UI=1e5,jA=30;let vd=class Ts{#e=Promise.withResolvers();#t=null;#n=!1;#r=!!globalThis.FontInspector?.enabled;#s=null;#i=null;#l=0;#o=0;#f=null;#c=null;#h=0;#u=0;#d=Object.create(null);#a=[];#p=null;#m=[];#g=new WeakMap;#v=null;static#_=new Map;static#x=new Map;static#b=new WeakMap;static#A=null;static#S=new Set;constructor({textContentSource:e,container:t,viewport:r}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(f){f.enqueue(e),f.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#c=t,this.#u=r.scale*ea.pixelRatio,this.#h=r.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:a,pageX:o,pageY:c}=r.rawDims;this.#v=[1,0,0,-1,-o,c+a],this.#o=i,this.#l=a,Ts.#N(),bl(t,r),this.#e.promise.finally(()=>{Ts.#S.delete(this),this.#i=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Ar.platform;return Vt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#f.read().then(({value:t,done:r})=>{if(r){this.#e.resolve();return}this.#s??=t.lang,Object.assign(this.#d,t.styles),this.#C(t.items),e()},this.#e.reject)};return this.#f=this.#p.getReader(),Ts.#S.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const r=e.scale*ea.pixelRatio,i=e.rotation;if(i!==this.#h&&(t?.(),this.#h=i,bl(this.#c,{rotation:i})),r!==this.#u){t?.(),this.#u=r;const a={div:null,properties:null,ctx:Ts.#D(this.#s)};for(const o of this.#m)a.properties=this.#g.get(o),a.div=o,this.#E(a)}}cancel(){const e=new Co("TextLayer task cancelled.");this.#f?.cancel(e).catch(()=>{}),this.#f=null,this.#e.reject(e)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#a}#C(e){if(this.#n)return;this.#i.ctx??=Ts.#D(this.#s);const t=this.#m,r=this.#a;for(const i of e){if(t.length>UI){Mt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const a=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id!==null&&this.#t.setAttribute("id",`${i.id}`),a.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}r.push(i.str),this.#O(i)}}#O(e){const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#m.push(t);const i=dt.transform(this.#v,e.transform);let a=Math.atan2(i[1],i[0]);const o=this.#d[e.fontName];o.vertical&&(a+=Math.PI/2);let c=this.#r&&o.fontSubstitution||o.fontFamily;c=Ts.fontFamilyMap.get(c)||c;const f=Math.hypot(i[2],i[3]),h=f*Ts.#L(c,o,this.#s);let d,g;a===0?(d=i[4],g=i[5]-h):(d=i[4]+h*Math.sin(a),g=i[5]-h*Math.cos(a));const m="calc(var(--total-scale-factor) *",v=t.style;this.#t===this.#c?(v.left=`${(100*d/this.#o).toFixed(2)}%`,v.top=`${(100*g/this.#l).toFixed(2)}%`):(v.left=`${m}${d.toFixed(2)}px)`,v.top=`${m}${g.toFixed(2)}px)`),v.fontSize=`${m}${(Ts.#A*f).toFixed(2)}px)`,v.fontFamily=c,r.fontSize=f,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#r&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),a!==0&&(r.angle=a*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const b=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);b!==A&&Math.max(b,A)/Math.min(b,A)>1.5&&(y=!0)}if(y&&(r.canvasWidth=o.vertical?e.height:e.width),this.#g.set(t,r),this.#i.div=t,this.#i.properties=r,this.#E(this.#i),r.hasText&&this.#t.append(t),r.hasEOL){const b=document.createElement("br");b.setAttribute("role","presentation"),this.#t.append(b)}}#E(e){const{div:t,properties:r,ctx:i}=e,{style:a}=t;let o="";if(Ts.#A>1&&(o=`scale(${1/Ts.#A})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:c}=a,{canvasWidth:f,fontSize:h}=r;Ts.#T(i,h*this.#u,c);const{width:d}=i.measureText(t.textContent);d>0&&(o=`scaleX(${f*this.#u/d}) ${o}`)}r.angle!==0&&(o=`rotate(${r.angle}deg) ${o}`),o.length>0&&(a.transform=o)}static cleanup(){if(!(this.#S.size>0)){this.#_.clear();for(const{canvas:e}of this.#x.values())e.remove();this.#x.clear()}}static#D(e=null){let t=this.#x.get(e||="");if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#x.set(e,t),this.#b.set(t,{size:0,family:""})}return t}static#T(e,t,r){const i=this.#b.get(e);t===i.size&&r===i.family||(e.font=`${t}px ${r}`,i.size=t,i.family=r)}static#N(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#L(e,t,r){const i=this.#_.get(e);if(i)return i;const a=this.#D(r);a.canvas.width=a.canvas.height=jA,this.#T(a,jA,e);const o=a.measureText(""),c=o.fontBoundingBoxAscent,f=Math.abs(o.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let h=.8;return c?h=c/(c+f):(Ar.platform.isFirefox&&Mt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?h=t.ascent:t.descent&&(h=1+t.descent)),this.#_.set(e,h),h}};class _d{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function i(a){if(!a)return;let o=null;const c=a.name;if(c==="#text")o=a.value;else if(_d.shouldBuildText(c))a?.attributes?.textContent?o=a.attributes.textContent:a.value&&(o=a.value);else return;if(o!==null&&t.push({str:o}),!!a.children)for(const f of a.children)i(f)}return i(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const HI=100;function vx(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new _x,{docId:t}=e,r=n.url?K3(n.url):null,i=n.data?Q3(n.data):null,a=n.httpHeaders||null,o=n.withCredentials===!0,c=n.password??null,f=n.range instanceof xx?n.range:null,h=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof tf?n.worker:null;const g=n.verbosity,m=typeof n.docBaseUrl=="string"&&!$d(n.docBaseUrl)?n.docBaseUrl:null,v=zp(n.cMapUrl),y=n.cMapPacked!==!1,b=n.CMapReaderFactory||(di?iI:RA),A=zp(n.iccUrl),w=zp(n.standardFontDataUrl),C=n.StandardFontDataFactory||(di?sI:NA),T=zp(n.wasmUrl),R=n.WasmFactory||(di?aI:LA),N=n.stopAtErrors!==!0,I=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,D=n.isEvalSupported!==!1,B=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!di,U=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!di&&(Ar.platform.isFirefox||!globalThis.chrome),Y=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,W=typeof n.disableFontFace=="boolean"?n.disableFontFace:di,re=n.fontExtraProperties===!0,Te=n.enableXfa===!0,Fe=n.ownerDocument||globalThis.document,we=n.disableRange===!0,q=n.disableStream===!0,ee=n.disableAutoFetch===!0,Pe=n.pdfBug===!0,qe=n.CanvasFactory||(di?rI:eI),P=n.FilterFactory||(di?nI:tI),ye=n.enableHWA===!0,ve=n.useWasm!==!1,ge=f?f.length:n.length??NaN,Ce=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!di&&!W,He=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(b===RA&&C===NA&&R===LA&&v&&w&&T&&Zh(v,document.baseURI)&&Zh(w,document.baseURI)&&Zh(T,document.baseURI)),Ie=null;L3(g);const Ge={canvasFactory:new qe({ownerDocument:Fe,enableHWA:ye}),filterFactory:new P({docId:t,ownerDocument:Fe}),cMapReaderFactory:He?null:new b({baseUrl:v,isCompressed:y}),standardFontDataFactory:He?null:new C({baseUrl:w}),wasmFactory:He?null:new R({baseUrl:T})};d||(d=tf.create({verbosity:g,port:gl.workerPort}),e._worker=d);const k={docId:t,apiVersion:"5.3.31",data:i,password:c,disableAutoFetch:ee,rangeChunkSize:h,length:ge,docBaseUrl:m,enableXfa:Te,evaluatorOptions:{maxImageSize:I,disableFontFace:W,ignoreErrors:N,isEvalSupported:D,isOffscreenCanvasSupported:B,isImageDecoderSupported:U,canvasMaxAreaInBytes:Y,fontExtraProperties:re,useSystemFonts:Ce,useWasm:ve,useWorkerFetch:He,cMapUrl:v,iccUrl:A,standardFontDataUrl:w,wasmUrl:T}},se={ownerDocument:Fe,pdfBug:Pe,styleElement:Ie,loadingParams:{disableAutoFetch:ee,enableXfa:Te}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Z=d.messageHandler.sendWithPromise("GetDocRequest",k,i?[i.buffer]:null);let J;if(f)J=new EI(f,{disableRange:we,disableStream:q});else if(!i){if(!r)throw new Error("getDocument - no `url` parameter provided.");const xe=Zh(r)?TI:di?FI:NI;J=new xe({url:r,length:ge,httpHeaders:a,withCredentials:o,rangeChunkSize:h,disableRange:we,disableStream:q})}return Z.then(xe=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const be=new Jh(t,xe,d.port),Se=new $I(be,e,J,se,Ge);e._transport=Se,be.send("Ready",null)})}).catch(e._capability.reject),e}class _x{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${_x.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let xx=class{#e=Promise.withResolvers();#t=[];#n=[];#r=[];#s=[];constructor(e,t,r=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=i}addRangeListener(e){this.#s.push(e)}addProgressListener(e){this.#r.push(e)}addProgressiveReadListener(e){this.#n.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const r of this.#s)r(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const r of this.#r)r(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#n)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){bn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class zI{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Vt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class jI{#e=!1;constructor(e,t,r,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=i?new CA:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new aT,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:i=0,dontFlip:a=!1}={}){return new jd({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:i,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Vt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:r="display",annotationMode:i=La.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:c=null,annotationCanvasMap:f=null,pageColors:h=null,printAnnotationStorage:d=null,isEditing:g=!1}){this._stats?.time("Overall");const m=this._transport.getRenderingIntent(r,i,d,g),{renderingIntent:v,cacheKey:y}=m;this.#e=!1,c||=this._transport.getOptionalContentConfig(v);let b=this._intentStates.get(y);b||(b=Object.create(null),this._intentStates.set(y,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const A=!!(v&Qi.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(m));const w=R=>{b.renderTasks.delete(C),A&&(this.#e=!0),this.#t(),R?(C.capability.reject(R),this._abortOperatorList({intentState:b,reason:R instanceof Error?R:new Error(R)})):C.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},C=new Pu({callback:w,params:{canvasContext:e,viewport:t,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:h});(b.renderTasks||=new Set).add(C);const T=C.task;return Promise.all([b.displayReadyCapability.promise,c]).then(([R,N])=>{if(this.destroyed){w();return}if(this._stats?.time("Rendering"),!(N.renderingIntent&v))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");C.initializeGraphics({transparency:R,optionalContentConfig:N}),C.operatorListChanged()}).catch(w),T}getOperatorList({intent:e="display",annotationMode:t=La.ENABLE,printAnnotationStorage:r=null,isEditing:i=!1}={}){function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(f))}const o=this._transport.getRenderingIntent(e,t,r,i,!0);let c=this._intentStates.get(o.cacheKey);c||(c=Object.create(null),this._intentStates.set(o.cacheKey,c));let f;return c.opListReadCapability||(f=Object.create(null),f.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(f),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_d.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,i){function a(){o.read().then(function({value:f,done:h}){if(h){r(c);return}c.lang??=f.lang,Object.assign(c.styles,f.styles),c.items.push(...f.items),a()},i)}const o=t.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new CA),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const r=this._intentStates.get(t);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let r=0,i=e.length;r<i;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:i}){const{map:a,transfer:o}=r,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:i},o).getReader(),h=this._intentStates.get(t);h.streamReader=f;const d=()=>{f.read().then(({value:g,done:m})=>{if(m){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,h),d())},g=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const m of h.renderTasks)m.operatorListChanged();this.#t()}if(h.displayReadyCapability)h.displayReadyCapability.reject(g);else if(h.opListReadCapability)h.opListReadCapability.reject(g);else throw g}})};d()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof am){let i=HI;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Co(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,a]of this._intentStates)if(a===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var dl,Ks,xo,dc,Yg,pc,gc,_i,cg,oT,lT,ed,Yu,ug;const Nn=class Nn{constructor({name:e=null,port:t=null,verbosity:r=M3()}={}){ba(this,_i);ba(this,dl,Promise.withResolvers());ba(this,Ks,null);ba(this,xo,null);ba(this,dc,null);if(this.name=e,this.destroyed=!1,this.verbosity=r,t){if(Rn(Nn,gc).has(t))throw new Error("Cannot use more than one PDFWorker per port.");Rn(Nn,gc).set(t,this),Ea(this,_i,oT).call(this,t)}else Ea(this,_i,lT).call(this)}get promise(){return Rn(this,dl).promise}get port(){return Rn(this,xo)}get messageHandler(){return Rn(this,Ks)}destroy(){this.destroyed=!0,Rn(this,dc)?.terminate(),Ii(this,dc,null),Rn(Nn,gc).delete(Rn(this,xo)),Ii(this,xo,null),Rn(this,Ks)?.destroy(),Ii(this,Ks,null)}static create(e){const t=Rn(this,gc).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Nn(e)}static get workerSrc(){if(gl.workerSrc)return gl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Vt(this,"_setupFakeWorkerGlobal",(async()=>Rn(this,Yu,ug)?Rn(this,Yu,ug):(await import(this.workerSrc)).WorkerMessageHandler)())}};dl=new WeakMap,Ks=new WeakMap,xo=new WeakMap,dc=new WeakMap,Yg=new WeakMap,pc=new WeakMap,gc=new WeakMap,_i=new WeakSet,cg=function(){Rn(this,dl).resolve(),Rn(this,Ks).send("configure",{verbosity:this.verbosity})},oT=function(e){Ii(this,xo,e),Ii(this,Ks,new Jh("main","worker",e)),Rn(this,Ks).on("ready",()=>{}),Ea(this,_i,cg).call(this)},lT=function(){if(Rn(Nn,pc)||Rn(Nn,Yu,ug)){Ea(this,_i,ed).call(this);return}let{workerSrc:e}=Nn;try{Nn._isSameOrigin(window.location,e)||(e=Nn._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new Jh("main","worker",t),i=()=>{a.abort(),r.destroy(),t.terminate(),this.destroyed?Rn(this,dl).reject(new Error("Worker was destroyed")):Ea(this,_i,ed).call(this)},a=new AbortController;t.addEventListener("error",()=>{Rn(this,dc)||i()},{signal:a.signal}),r.on("test",c=>{if(a.abort(),this.destroyed||!c){i();return}Ii(this,Ks,r),Ii(this,xo,t),Ii(this,dc,t),Ea(this,_i,cg).call(this)}),r.on("ready",c=>{if(a.abort(),this.destroyed){i();return}try{o()}catch{Ea(this,_i,ed).call(this)}});const o=()=>{const c=new Uint8Array;r.send("test",c,[c.buffer])};o();return}catch{sm("The worker has been disabled.")}Ea(this,_i,ed).call(this)},ed=function(){Rn(Nn,pc)||(Mt("Setting up fake worker."),Ii(Nn,pc,!0)),Nn._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){Rn(this,dl).reject(new Error("Worker was destroyed"));return}const t=new J3;Ii(this,xo,t);const r=`fake${NE(Nn,Yg)._++}`,i=new Jh(r+"_worker",r,t);e.setup(i,t),Ii(this,Ks,new Jh(r,r+"_worker",t)),Ea(this,_i,cg).call(this)}).catch(e=>{Rn(this,dl).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Yu=new WeakSet,ug=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},ba(Nn,Yu),ba(Nn,Yg,0),ba(Nn,pc,!1),ba(Nn,gc,new WeakMap),di&&(Ii(Nn,pc,!0),gl.workerSrc||="./pdf.worker.mjs"),Nn._isSameOrigin=(e,t)=>{const r=URL.parse(e);if(!r?.origin||r.origin==="null")return!1;const i=new URL(t,r);return r.origin===i.origin},Nn._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Nn.fromPort=e=>{if(j3("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Nn.create(e)};let tf=Nn;class $I{#e=new Map;#t=new Map;#n=new Map;#r=new Map;#s=null;constructor(e,t,r,i,a){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new aT,this.fontLoader=new Y3({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#i(e,t=null){const r=this.#e.get(e);if(r)return r;const i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return Vt(this,"annotationStorage",new dx)}getRenderingIntent(e,t=La.ENABLE,r=null,i=!1,a=!1){let o=Qi.DISPLAY,c=m_;switch(e){case"any":o=Qi.ANY;break;case"display":break;case"print":o=Qi.PRINT;break;default:Mt(`getRenderingIntent - invalid intent: ${e}`)}const f=o&Qi.PRINT&&r instanceof X2?r:this.annotationStorage;switch(t){case La.DISABLE:o+=Qi.ANNOTATIONS_DISABLE;break;case La.ENABLE:break;case La.ENABLE_FORMS:o+=Qi.ANNOTATIONS_FORMS;break;case La.ENABLE_STORAGE:o+=Qi.ANNOTATIONS_STORAGE,c=f.serializable;break;default:Mt(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=Qi.IS_EDITING),a&&(o+=Qi.OPLIST);const{ids:h,hash:d}=f.modifiedIds,g=[o,c.hash,d];return{renderingIntent:o,cacheKey:g.join("_"),annotationStorageSerializable:c,modifiedIds:h}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of this.#t.values())e.push(r._destroy());this.#t.clear(),this.#n.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),vd.cleanup(),this._networkStream?.cancelAllRequests(new Co("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,i)=>{ir(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},i.onPull=()=>{this._fullReader.read().then(function({value:a,done:o}){if(o){i.close();return}ir(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{this._fullReader.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async r=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:a,contentLength:o}=this._fullReader;return(!i||!a)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:a,contentLength:o}}),e.on("GetRangeReader",(r,i)=>{ir(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(r.begin,r.end);if(!a){i.close();return}i.onPull=()=>{a.read().then(function({value:o,done:c}){if(c){i.close();return}ir(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{a.cancel(o),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new zI(r,this))}),e.on("DocException",r=>{t._capability.reject(ki(r))}),e.on("PasswordRequest",r=>{this.#s=Promise.withResolvers();try{if(!t.onPassword)throw ki(r);const i=a=>{a instanceof Error?this.#s.reject(a):this.#s.resolve({password:a})};t.onPassword(i,r.code)}catch(i){this.#s.reject(i)}return this.#s.promise}),e.on("DataLoaded",r=>{t.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;this.#t.get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,i,a])=>{if(this.destroyed||this.commonObjs.has(r))return null;switch(i){case"Font":if("error"in a){const h=a.error;Mt(`Error during font loading: ${h}`),this.commonObjs.resolve(r,h);break}const o=this._params.pdfBug&&globalThis.FontInspector?.enabled?(h,d)=>globalThis.FontInspector.fontAdded(h,d):null,c=new q3(a,o);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(r,c)});break;case"CopyLocalImage":const{imageRef:f}=a;ir(f,"The imageRef must be defined.");for(const h of this.#t.values())for(const[,d]of h.objs)if(d?.ref===f)return d.dataLen?(this.commonObjs.resolve(r,structuredClone(d)),d.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,a);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([r,i,a,o])=>{if(this.destroyed)return;const c=this.#t.get(i);if(!c.objs.has(r)){if(c._intentStates.size===0){o?.bitmap?.close();return}switch(a){case"Image":case"Pattern":c.objs.resolve(r,o);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",r=>{this.destroyed||t.onProgress?.({loaded:r.loaded,total:r.total})}),e.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[r.type];if(!i)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Mt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=this.#n.get(t);if(r)return r;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#r.set(a.refStr,e);const o=new jI(t,a,this,this._params.pdfBug);return this.#t.set(t,o),o});return this.#n.set(t,i),i}getPageIndex(e){return v_(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#i("GetOptionalContentConfig").then(t=>new bI(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new xI(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),vd.cleanup()}}cachedPageNumber(e){if(!v_(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#r.get(t)??null}}class GI{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class Pu{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:r,commonObjs:i,annotationCanvasMap:a,operatorList:o,pageIndex:c,canvasFactory:f,filterFactory:h,useRequestAnimationFrame:d=!1,pdfBug:g=!1,pageColors:m=null}){this.callback=e,this.params=t,this.objs=r,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=c,this.canvasFactory=f,this.filterFactory=h,this._pdfBug=g,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new GI(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(Pu.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Pu.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:i,transform:a,background:o}=this.params;this.gfx=new Bu(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:i,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),Pu.#t.delete(this._canvas),e||=new am(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Pu.#t.delete(this._canvas),this.callback())))}}const cT="5.3.31",uT="47ad820d9";function $A(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Wh(n){return Math.max(0,Math.min(255,255*n))}class GA{static CMYK_G([e,t,r,i]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Wh(e),[e,e,e]}static G_HTML([e]){const t=$A(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(Wh)}static RGB_HTML(e){return`#${e.map($A).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,r+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,r,i]){return[Wh(1-Math.min(1,e+i)),Wh(1-Math.min(1,r+i)),Wh(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const i=1-e,a=1-t,o=1-r,c=Math.min(i,a,o);return["CMYK",i,a,o,c]}}class VI{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),r||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){bn("Abstract method `_createSVG` called.")}}class xd extends VI{_createSVG(e){return document.createElementNS(vo,e)}}class yx{static setupStorage(e,t,r,i,a){const o=i.getValue(t,{value:null});switch(r.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),a==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(o.value===r.attributes.xfaOn?e.setAttribute("checked",!0):o.value===r.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",c=>{i.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),a==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const c of r.children)c.attributes.value===o.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const f=c.target.options,h=f.selectedIndex===-1?"":f[f.selectedIndex].value;i.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:i,linkService:a}){const{attributes:o}=t,c=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[f,h]of Object.entries(o))if(h!=null)switch(f){case"class":h.length&&e.setAttribute(f,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!c||f!=="href"&&f!=="newWindow")&&e.setAttribute(f,h)}c&&a.addLinkAttributes(e,o.href,o.newWindow),r&&o.dataId&&this.setupStorage(e,o.dataId,t,r)}static render(e){const t=e.annotationStorage,r=e.linkService,i=e.xfaHtml,a=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:a,linkService:r});const c=a!=="richText",f=e.div;if(f.append(o),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;f.style.transform=g}c&&f.setAttribute("class","xfaLayer xfaFont");const h=[];if(i.children.length===0){if(i.value){const g=document.createTextNode(i.value);o.append(g),c&&_d.shouldBuildText(i.name)&&h.push(g)}return{textDivs:h}}const d=[[i,-1,o]];for(;d.length>0;){const[g,m,v]=d.at(-1);if(m+1===g.children.length){d.pop();continue}const y=g.children[++d.at(-1)[1]];if(y===null)continue;const{name:b}=y;if(b==="#text"){const w=document.createTextNode(y.value);h.push(w),v.append(w);continue}const A=y?.attributes?.xmlns?document.createElementNS(y.attributes.xmlns,b):document.createElement(b);if(v.append(A),y.attributes&&this.setAttributes({html:A,element:y,storage:t,intent:a,linkService:r}),y.children?.length>0)d.push([y,-1,A]);else if(y.value){const w=document.createTextNode(y.value);c&&_d.shouldBuildText(b)&&h.push(w),A.append(w)}}for(const g of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Xd=1e3,WI=9,Ec=new WeakSet;class VA{static create(e){switch(e.data.annotationType){case Vn.LINK:return new fT(e);case Vn.TEXT:return new XI(e);case Vn.WIDGET:switch(e.data.fieldType){case"Tx":return new YI(e);case"Btn":return e.data.radioButton?new hT(e):e.data.checkBox?new KI(e):new QI(e);case"Ch":return new ZI(e);case"Sig":return new qI(e)}return new Mc(e);case Vn.POPUP:return new x_(e);case Vn.FREETEXT:return new dT(e);case Vn.LINE:return new ek(e);case Vn.SQUARE:return new tk(e);case Vn.CIRCLE:return new nk(e);case Vn.POLYLINE:return new pT(e);case Vn.CARET:return new ik(e);case Vn.INK:return new bx(e);case Vn.POLYGON:return new rk(e);case Vn.HIGHLIGHT:return new gT(e);case Vn.UNDERLINE:return new sk(e);case Vn.SQUIGGLY:return new ak(e);case Vn.STRIKEOUT:return new ok(e);case Vn.STAMP:return new mT(e);case Vn.FILEATTACHMENT:return new lk(e);default:return new qn(e)}}}class qn{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(r)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:r}){return!!(e?.str||t?.str||r?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return qn._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#r(t),this.#n?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#r(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#r(e){const{container:{style:t},data:{rect:r,rotation:i},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:o,pageX:c,pageY:f}}}}=this;r?.splice(0,4,...e),t.left=`${100*(e[0]-c)/a}%`,t.top=`${100*(o-e[3]+f)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/a}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)}_createContainer(e){const{data:t,parent:{page:r,viewport:i}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),this instanceof Mc||(a.tabIndex=Xd);const{style:o}=a;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof x_){const{rotation:b}=t;return!t.hasOwnCanvas&&b!==0&&this.setRotation(b,a),a}const{width:c,height:f}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const b=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(b>0||A>0){const C=`calc(${b}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;o.borderRadius=C}else if(this instanceof hT){const C=`calc(${c}px * var(--total-scale-factor)) / calc(${f}px * var(--total-scale-factor))`;o.borderRadius=C}switch(t.borderStyle.style){case Lu.SOLID:o.borderStyle="solid";break;case Lu.DASHED:o.borderStyle="dashed";break;case Lu.BEVELED:Mt("Unimplemented border style: beveled");break;case Lu.INSET:Mt("Unimplemented border style: inset");break;case Lu.UNDERLINE:o.borderBottomStyle="solid";break}const w=t.borderColor||null;w?(this.#t=!0,o.borderColor=dt.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):o.borderWidth=0}const h=dt.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:d,pageHeight:g,pageX:m,pageY:v}=i.rawDims;o.left=`${100*(h[0]-m)/d}%`,o.top=`${100*(h[1]-v)/g}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*c/d}%`,o.height=`${100*f/g}%`):this.setRotation(y,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:i}=this.parent.viewport.rawDims;let{width:a,height:o}=this;e%180!==0&&([a,o]=[o,a]),t.style.width=`${100*a/r}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,i)=>{const a=i.detail[t],o=a[0],c=a.slice(1);i.target.style[r]=GA[`${o}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[r]:GA[`${o}_rgb`](c)})};return Vt(this,"_commonActions",{display:t=>{const{display:r}=t.detail,i=r%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const i of Object.keys(t.detail))(e[i]||r[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[i,a]of Object.entries(t)){const o=r[i];if(o){const c={detail:{[i]:a},target:e};o(c),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,i,a]=this.data.rect.map(b=>Math.fround(b));if(e.length===8){const[b,A,w,C]=e.subarray(2,6);if(i===b&&a===A&&t===w&&r===C)return}const{style:o}=this.container;let c;if(this.#t){const{borderColor:b,borderWidth:A}=o;o.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${b}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const f=i-t,h=a-r,{svgFactory:d}=this,g=d.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0);const m=d.createElement("defs");g.append(m);const v=d.createElement("clipPath"),y=`clippath_${this.data.id}`;v.setAttribute("id",y),v.setAttribute("clipPathUnits","objectBoundingBox"),m.append(v);for(let b=2,A=e.length;b<A;b+=8){const w=e[b],C=e[b+1],T=e[b+2],R=e[b+3],N=d.createElement("rect"),I=(T-t)/f,D=(a-C)/h,B=(w-T)/f,U=(C-R)/h;N.setAttribute("x",I),N.setAttribute("y",D),N.setAttribute("width",B),N.setAttribute("height",U),v.append(N),c?.push(`<rect vector-effect="non-scaling-stroke" x="${I}" y="${D}" width="${B}" height="${U}"/>`)}this.#t&&(c.push("</g></svg>')"),o.backgroundImage=c.join("")),this.container.append(g),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=this.#n=new x_({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){bn("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:a,id:o,exportValues:c}of i){if(a===-1||o===t)continue;const f=typeof c=="string"?c:null,h=document.querySelector(`[data-element-id="${o}"]`);if(h&&!Ec.has(h)){Mt(`_getElementsByName - element not allowed: ${o}`);continue}r.push({id:o,exportValue:f,domElement:h})}return r}for(const i of document.getElementsByName(e)){const{exportValue:a}=i,o=i.getAttribute("data-element-id");o!==t&&Ec.has(i)&&r.push({id:o,exportValue:a,domElement:i})}return r}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class fT extends qn{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,r=document.createElement("a");r.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(r,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(r,e.action),i=!0):e.attachment?(this.#t(r,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(this.#n(r,e.setOCGState),i=!0):e.dest?(this._bindLink(r,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,e),i=!0),e.resetForm?(this._bindResetFormAction(r,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(r),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,r=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,r),!1),this.#e()}#n(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const a=r.get(i);a&&(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const r=e.onclick;if(r||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Mt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(e.onclick=()=>!1);return}e.onclick=()=>{r?.();const{fields:i,refs:a,include:o}=t,c=[];if(i.length!==0||a.length!==0){const d=new Set(a);for(const g of i){const m=this._fieldObjects[g]||[];for(const{id:v}of m)d.add(v)}for(const g of Object.values(this._fieldObjects))for(const m of g)d.has(m.id)===o&&c.push(m)}else for(const d of Object.values(this._fieldObjects))c.push(...d);const f=this.annotationStorage,h=[];for(const d of c){const{id:g}=d;switch(h.push(g),d.type){case"text":{const v=d.defaultValue||"";f.setValue(g,{value:v});break}case"checkbox":case"radiobutton":{const v=d.defaultValue===d.exportValues;f.setValue(g,{value:v});break}case"combobox":case"listbox":{const v=d.defaultValue||"";f.setValue(g,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${g}"]`);if(m){if(!Ec.has(m)){Mt(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}}),!1}}}class XI extends qn{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Mc extends qn{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Ar.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,i,a){r.includes("mouse")?e.addEventListener(r,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(r,o=>{if(r==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:a(o)}})})}_setEventListeners(e,t,r,i){for(const[a,o]of r)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,a,o,i),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":dt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||WI,a=e.style;let o;const c=2,f=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c),d=Math.round(h/(Av*i))||1,g=h/d;o=Math.min(i,f(g/Av))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-c);o=Math.min(i,f(h/Av))}a.fontSize=`calc(${o}px * var(--total-scale-factor))`,a.color=dt.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class YI extends Mc{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,i){const a=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=r),a.setValue(o.id,{[i]:r})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let a=i.value||"";const o=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;o&&a.length>o&&(a=a.slice(0,o));let c=i.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const f={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=c??a,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",c??a),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Ec.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=Xd,this._setRequired(r,this.data.required),o&&(r.maxLength=o),r.addEventListener("input",d=>{e.setValue(t,{value:d.target.value}),this.setPropertyOnSiblings(r,"value",d.target.value,"value"),f.formattedValue=null}),r.addEventListener("resetform",d=>{const g=this.data.defaultFieldValue??"";r.value=f.userValue=g,f.formattedValue=null});let h=d=>{const{formattedValue:g}=f;g!=null&&(d.target.value=g),d.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",g=>{if(f.focused)return;const{target:m}=g;f.userValue&&(m.value=f.userValue),f.lastCommittedValue=m.value,f.commitKey=1,this.data.actions?.Focus||(f.focused=!0)}),r.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(v){f.userValue=v.detail.value??"",e.setValue(t,{value:f.userValue.toString()}),v.target.value=f.userValue},formattedValue(v){const{formattedValue:y}=v.detail;f.formattedValue=y,y!=null&&v.target!==document.activeElement&&(v.target.value=y),e.setValue(t,{formattedValue:y})},selRange(v){v.target.setSelectionRange(...v.detail.selRange)},charLimit:v=>{const{charLimit:y}=v.detail,{target:b}=v;if(y===0){b.removeAttribute("maxLength");return}b.setAttribute("maxLength",y);let A=f.userValue;!A||A.length<=y||(A=A.slice(0,y),b.value=f.userValue=A,e.setValue(t,{value:A}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:1,selStart:b.selectionStart,selEnd:b.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),r.addEventListener("keydown",g=>{f.commitKey=1;let m=-1;if(g.key==="Escape"?m=0:g.key==="Enter"&&!this.data.multiLine?m=2:g.key==="Tab"&&(f.commitKey=3),m===-1)return;const{value:v}=g.target;f.lastCommittedValue!==v&&(f.lastCommittedValue=v,f.userValue=v,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:m,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const d=h;h=null,r.addEventListener("blur",g=>{if(!f.focused||!g.relatedTarget)return;this.data.actions?.Blur||(f.focused=!1);const{value:m}=g.target;f.userValue=m,f.lastCommittedValue!==m&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:f.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}),d(g)}),this.data.actions?.Keystroke&&r.addEventListener("beforeinput",g=>{f.lastCommittedValue=null;const{data:m,target:v}=g,{value:y,selectionStart:b,selectionEnd:A}=v;let w=b,C=A;switch(g.inputType){case"deleteWordBackward":{const T=y.substring(0,b).match(/\w*[^\w]*$/);T&&(w-=T[0].length);break}case"deleteWordForward":{const T=y.substring(b).match(/^[^\w]*\w*/);T&&(C+=T[0].length);break}case"deleteContentBackward":b===A&&(w-=1);break;case"deleteContentForward":b===A&&(C+=1);break}g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,change:m||"",willCommit:!1,selStart:w,selEnd:C}})}),this._setEventListeners(r,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(h&&r.addEventListener("blur",h),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/o;r.classList.add("comb"),r.style.letterSpacing=`calc(${g}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class qI extends Mc{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class KI extends Mc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(r,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return Ec.add(a),a.setAttribute("data-element-id",r),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=Xd,a.addEventListener("change",o=>{const{name:c,checked:f}=o.target;for(const h of this._getElementsByName(c,r)){const d=f&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=d),e.setValue(h.id,{value:d})}e.setValue(r,{value:f})}),a.addEventListener("resetform",o=>{const c=t.defaultFieldValue||"Off";o.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",o=>{const c={value(f){f.target.checked=f.detail.value!=="Off",e.setValue(r,{value:f.target.checked})}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class hT extends Mc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let i=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(r,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,r))e.setValue(o.id,{value:!1});const a=document.createElement("input");if(Ec.add(a),a.setAttribute("data-element-id",r),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.tabIndex=Xd,a.addEventListener("change",o=>{const{name:c,checked:f}=o.target;for(const h of this._getElementsByName(c,r))e.setValue(h.id,{value:!1});e.setValue(r,{value:f})}),a.addEventListener("resetform",o=>{const c=t.defaultFieldValue;o.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;a.addEventListener("updatefromsandbox",c=>{const f={value:h=>{const d=o===h.detail.value;for(const g of this._getElementsByName(h.target.name)){const m=d&&g.id===r;g.domElement&&(g.domElement.checked=m),e.setValue(g.id,{value:m})}}};this._dispatchEventFromSandbox(f,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class QI extends fT{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class ZI extends Mc{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Ec.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Xd;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const g=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===g});for(const d of this.data.options){const g=document.createElement("option");g.textContent=d.displayValue,g.value=d.exportValue,r.value.includes(d.exportValue)&&(g.setAttribute("selected",!0),a=!1),i.append(g)}let o=null;if(a){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),o=()=>{d.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const c=d=>{const g=d?"value":"textContent",{options:m,multiple:v}=i;return v?Array.prototype.filter.call(m,y=>y.selected).map(y=>y[g]):m.selectedIndex===-1?null:m[m.selectedIndex][g]};let f=c(!1);const h=d=>{const g=d.target.options;return Array.prototype.map.call(g,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const g={value(m){o?.();const v=m.detail.value,y=new Set(Array.isArray(v)?v:[v]);for(const b of i.options)b.selected=y.has(b.value);e.setValue(t,{value:c(!0)}),f=c(!1)},multipleSelection(m){i.multiple=!0},remove(m){const v=i.options,y=m.detail.remove;v[y].selected=!1,i.remove(y),v.length>0&&Array.prototype.findIndex.call(v,A=>A.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:c(!0),items:h(m)}),f=c(!1)},clear(m){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),f=c(!1)},insert(m){const{index:v,displayValue:y,exportValue:b}=m.detail.insert,A=i.children[v],w=document.createElement("option");w.textContent=y,w.value=b,A?A.before(w):i.append(w),e.setValue(t,{value:c(!0),items:h(m)}),f=c(!1)},items(m){const{items:v}=m.detail;for(;i.length!==0;)i.remove(0);for(const y of v){const{displayValue:b,exportValue:A}=y,w=document.createElement("option");w.textContent=b,w.value=A,i.append(w)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:c(!0),items:h(m)}),f=c(!1)},indices(m){const v=new Set(m.detail.indices);for(const y of m.target.options)y.selected=v.has(y.index);e.setValue(t,{value:c(!0)}),f=c(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(g,d)}),i.addEventListener("input",d=>{const g=c(!0),m=c(!1);e.setValue(t,{value:g}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,change:m,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class x_ extends qn{constructor(e){const{data:t,elements:r}=e;super(e,{isRenderable:qn._hasPopupData(t)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new JI({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",t.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(r=>`${lx}${r}`).join(",")),this.container}}class JI{#e=this.#C.bind(this);#t=this.#T.bind(this);#n=this.#D.bind(this);#r=this.#E.bind(this);#s=null;#i=null;#l=null;#o=null;#f=null;#c=null;#h=null;#u=!1;#d=null;#a=null;#p=null;#m=null;#g=null;#v=null;#_=!1;constructor({container:e,color:t,elements:r,titleObj:i,modificationDate:a,contentsObj:o,richText:c,parent:f,rect:h,parentRect:d,open:g}){this.#i=e,this.#g=i,this.#l=o,this.#m=c,this.#c=f,this.#s=t,this.#p=h,this.#h=d,this.#f=r,this.#o=cx.toDateObject(a),this.trigger=r.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",this.#r),m.addEventListener("mouseenter",this.#n),m.addEventListener("mouseleave",this.#t),m.classList.add("popupTriggerArea");for(const m of r)m.container?.addEventListener("keydown",this.#e);this.#i.hidden=!0,g&&this.#E()}render(){if(this.#d)return;const e=this.#d=document.createElement("div");if(e.className="popup",this.#s){const a=e.style.outlineColor=dt.makeHexColor(...this.#s);e.style.backgroundColor=`color-mix(in srgb, ${a} 30%, white)`}const t=document.createElement("span");t.className="header";const r=document.createElement("h1");if(t.append(r),{dir:r.dir,str:r.textContent}=this.#g,e.append(t),this.#o){const a=document.createElement("span");a.classList.add("popupDate"),a.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),a.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),t.append(a)}const i=this.#x;if(i)yx.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const a=this._formatContents(this.#l);e.append(a)}this.#i.append(e)}get#x(){const e=this.#m,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#m.html||null}get#b(){return this.#x?.attributes?.style?.fontSize||0}get#A(){return this.#x?.attributes?.style?.color||null}#S(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#A,fontSize:this.#b?`calc(${this.#b}px * var(--total-scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:i});return r}_formatContents({str:e,dir:t}){const r=document.createElement("p");r.classList.add("popupContent"),r.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let a=0,o=i.length;a<o;++a){const c=i[a];r.append(document.createTextNode(c)),a<o-1&&r.append(document.createElement("br"))}return r}#C(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#u)&&this.#E()}updateEdited({rect:e,popupContent:t}){this.#v||={contentsObj:this.#l,richText:this.#m},e&&(this.#a=null),t&&(this.#m=this.#S(t),this.#l=null),this.#d?.remove(),this.#d=null}resetEdited(){this.#v&&({contentsObj:this.#l,richText:this.#m}=this.#v,this.#v=null,this.#d?.remove(),this.#d=null,this.#a=null)}#O(){if(this.#a!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:i,pageY:a}}}=this.#c;let o=!!this.#h,c=o?this.#h:this.#p;for(const y of this.#f)if(!c||dt.intersect(y.data.rect,c)!==null){c=y.data.rect,o=!0;break}const f=dt.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),d=o?c[2]-c[0]+5:0,g=f[0]+d,m=f[1];this.#a=[100*(g-i)/t,100*(m-a)/r];const{style:v}=this.#i;v.left=`${this.#a[0]}%`,v.top=`${this.#a[1]}%`}#E(){this.#u=!this.#u,this.#u?(this.#D(),this.#i.addEventListener("click",this.#r),this.#i.addEventListener("keydown",this.#e)):(this.#T(),this.#i.removeEventListener("click",this.#r),this.#i.removeEventListener("keydown",this.#e))}#D(){this.#d||this.render(),this.isVisible?this.#u&&this.#i.classList.add("focused"):(this.#O(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#T(){this.#i.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#i.hidden=!0)}maybeShow(){this.#_&&(this.#d||this.#D(),this.#_=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class dT extends qn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Nt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class ek extends qn{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:r}=this,i=this.svgFactory.create(t,r,!0),a=this.#e=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class tk extends qn{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:r}=this,i=this.svgFactory.create(t,r,!0),a=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",t-a),o.setAttribute("height",r-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class nk extends qn{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:r}=this,i=this.svgFactory.create(t,r,!0),a=e.borderStyle.width,o=this.#e=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",r/2),o.setAttribute("rx",t/2-a/2),o.setAttribute("ry",r/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class pT extends qn{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:r,popupRef:i},width:a,height:o}=this;if(!t)return this.container;const c=this.svgFactory.create(a,o,!0);let f=[];for(let d=0,g=t.length;d<g;d+=2){const m=t[d]-e[0],v=e[3]-t[d+1];f.push(`${m},${v}`)}f=f.join(" ");const h=this.#e=this.svgFactory.createElement(this.svgElementName);return h.setAttribute("points",f),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class rk extends pT{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ik extends qn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class bx extends qn{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Nt.HIGHLIGHT:Nt.INK}#n(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:r,borderStyle:i,popupRef:a}}=this,{transform:o,width:c,height:f}=this.#n(t,e),h=this.svgFactory.create(c,f,!0),d=this.#e=this.svgFactory.createElement("svg:g");h.append(d),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let g=0,m=r.length;g<m;g++){const v=this.svgFactory.createElement(this.svgElementName);this.#t.push(v),v.setAttribute("points",r[g].join(",")),d.append(v)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:r,rect:i}=e,a=this.#e;if(t>=0&&a.setAttribute("stroke-width",t||1),r)for(let o=0,c=this.#t.length;o<c;o++)this.#t[o].setAttribute("points",r[o].join(","));if(i){const{transform:o,width:c,height:f}=this.#n(this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${f}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class gT extends qn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Nt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class sk extends qn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ak extends qn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ok extends qn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class mT extends qn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Nt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class lk extends qn{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let r;t.hasAppearance||t.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),r.addEventListener("dblclick",this.#t.bind(this)),this.#e=r;const{isMac:i}=Ar.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),e.append(r),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let Ex=class vT{#e=null;#t=null;#n=new Map;#r=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:i,page:a,viewport:o,structTreeLayer:c}){this.div=e,this.#e=t,this.#t=r,this.#r=c||null,this.page=a,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#n.size>0}async#s(e,t){const r=e.firstChild||e,i=r.id=`${lx}${t}`,a=await this.#r?.getAriaAttributes(i);if(a)for(const[o,c]of a)r.setAttribute(o,c);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,r,!1)}async render(e){const{annotations:t}=e,r=this.div;bl(r,this.viewport);const i=new Map,a={data:null,layer:r,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new xd,annotationStorage:e.annotationStorage||new dx,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===Vn.POPUP;if(c){const d=i.get(o.id);if(!d)continue;a.elements=d}else if(o.rect[2]===o.rect[0]||o.rect[3]===o.rect[1])continue;a.data=o;const f=VA.create(a);if(!f.isRenderable)continue;if(!c&&o.popupRef){const d=i.get(o.popupRef);d?d.push(f):i.set(o.popupRef,[f])}const h=f.render();o.hidden&&(h.style.visibility="hidden"),await this.#s(h,o.id),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}this.#i()}async addLinkAnnotations(e,t){const r={data:null,layer:this.div,linkService:t,svgFactory:new xd,parent:this};for(const i of e){i.borderStyle||=vT._defaultBorderStyle,r.data=i;const a=VA.create(r);if(!a.isRenderable)continue;const o=a.render();await this.#s(o,i.id)}}update({viewport:e}){const t=this.div;this.viewport=e,bl(t,{rotation:e.rotation}),this.#i(),t.hidden=!1}#i(){if(!this.#t)return;const e=this.div;for(const[t,r]of this.#t){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;r.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(r):a.classList.contains("annotationContent")?a.after(r):a.before(r):i.append(r);const o=this.#n.get(t);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,i.id,r),o._hasNoCanvas=!1):o.canvas=r)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}static get _defaultBorderStyle(){return Vt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Lu.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const Vp=/\r\n?|\n/g;class gr extends vt{#e;#t="";#n=`${this.id}-editor`;#r=null;#s;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=gr.prototype,t=a=>a.isEmpty(),r=Do.TRANSLATE_SMALL,i=Do.TRANSLATE_BIG;return Vt(this,"_keyboardManager",new Gd([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=Nt.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||gr._defaultColor||vt._defaultLineColor,this.#s=e.fontSize||gr._defaultFontSize}static initialize(e,t){vt.initialize(e,t);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Wt.FREETEXT_SIZE:gr._defaultFontSize=t;break;case Wt.FREETEXT_COLOR:gr._defaultColor=t;break}}updateParams(e,t){switch(e){case Wt.FREETEXT_SIZE:this.#i(t);break;case Wt.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[Wt.FREETEXT_SIZE,gr._defaultFontSize],[Wt.FREETEXT_COLOR,gr._defaultColor||vt._defaultLineColor]]}get propertiesToUpdate(){return[[Wt.FREETEXT_SIZE,this.#s],[Wt.FREETEXT_COLOR,this.#e]]}#i(e){const t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#s)*this.parentScale),this.#s=i,this.#f()},r=this.#s;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Wt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){const t=i=>{this.#e=this.editorDiv.style.color=i},r=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Wt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-gr._internalPadding*e,-(gr._internalPadding+this.#s)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#r=new AbortController;const e=this._uiManager.combinedSignal(this.#r);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#r?.abort(),this.#r=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const e=[];this.editorDiv.normalize();let t=null;for(const r of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&r.nodeName==="BR"||(e.push(gr.#c(r)),t=r);return e.join(`
`)}#f(){const[e,t]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),r=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=r.width/e,this.height=r.height/t):(this.width=r.height/e,this.height=r.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#o().trimEnd();if(e===t)return;const r=i=>{if(this.#t=i,!i){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#f()};this.addCommands({cmd:()=>{r(t)},undo:()=>{r(e)},mustExec:!1}),this.#f()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){gr._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,r.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,f]=this.getInitialTranslation();[c,f]=this.pageTranslationToScreen(c,f);const[h,d]=this.pageDimensions,[g,m]=this.pageTranslation;let v,y;switch(this.rotation){case 0:v=e+(o[0]-g)/h,y=t+this.height-(o[1]-m)/d;break;case 90:v=e+(o[0]-g)/h,y=t-(o[1]-m)/d,[c,f]=[f,-c];break;case 180:v=e-this.width+(o[0]-g)/h,y=t-(o[1]-m)/d,[c,f]=[-c,-f];break;case 270:v=e+(o[0]-g-this.height*d)/h,y=t+(o[1]-m-this.width*h)/d,[c,f]=[-f,c];break}this.setAt(v*i,y*a,c,f)}else this._moveAfterPaste(e,t);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Vp,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:r}=t;if(r.length===1&&r[0]==="text/plain")return;e.preventDefault();const i=gr.#d(t.getData("text")||"").replaceAll(Vp,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:f}=o,h=[],d=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(d.push(c.nodeValue.slice(f).replaceAll(Vp,"")),v!==this.editorDiv){let y=h;for(const b of this.editorDiv.childNodes){if(b===v){y=d;continue}y.push(gr.#c(b))}}h.push(c.nodeValue.slice(0,f).replaceAll(Vp,""))}else if(c===this.editorDiv){let v=h,y=0;for(const b of this.editorDiv.childNodes)y++===f&&(v=d),v.push(gr.#c(b))}this.#t=`${h.join(`
`)}${i}${d.join(`
`)}`,this.#h();const g=new Range;let m=Math.sumPrecise(h.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const y=v.nodeValue.length;if(m<=y){g.setStart(v,m),g.setEnd(v,m);break}m-=y}a.removeAllRanges(),a.addRange(g)}#h(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#u(){return this.#t.replaceAll(""," ")}static#d(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,r){let i=null;if(e instanceof dT){const{data:{defaultAppearanceData:{fontSize:o,fontColor:c},rect:f,rotation:h,id:d,popupRef:g},textContent:m,textPosition:v,parent:{page:{pageNumber:y}}}=e;if(!m||m.length===0)return null;i=e={annotationType:Nt.FREETEXT,color:Array.from(c),fontSize:o,value:m.join(`
`),position:v,pageIndex:y-1,rect:f.slice(0),rotation:h,id:d,deleted:!1,popupRef:g}}const a=await super.deserialize(e,t,r);return a.#s=e.fontSize,a.#e=dt.makeHexColor(...e.color),a.#t=gr.#d(e.value),a.annotationElementId=e.id||null,a._initialData=i,a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=gr._internalPadding*this.parentScale,r=this.getRect(t,t),i=vt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),a={annotationType:Nt.FREETEXT,color:i,fontSize:this.#s,value:this.#u(),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(a.isCopy=!0,a):this.annotationElementId&&!this.#a(a)?null:(a.id=this.annotationElementId,a)}#a(e){const{value:t,fontSize:r,color:i,pageIndex:a}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==r||e.color.some((o,c)=>o!==i[c])||e.pageIndex!==a}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:r}=t;r.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,r.color=this.#e,t.replaceChildren();for(const a of this.#t.split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),t.append(o)}const i=gr._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(i,i),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class st{static PRECISION=1e-4;toSVGPath(){bn("Abstract method `toSVGPath` must be implemented.")}get box(){bn("Abstract getter `box` must be implemented.")}serialize(e,t){bn("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,i,a,o){o||=new Float32Array(e.length);for(let c=0,f=e.length;c<f;c+=2)o[c]=t+e[c]*i,o[c+1]=r+e[c+1]*a;return o}static _rescaleAndSwap(e,t,r,i,a,o){o||=new Float32Array(e.length);for(let c=0,f=e.length;c<f;c+=2)o[c]=t+e[c+1]*i,o[c+1]=r+e[c]*a;return o}static _translate(e,t,r,i){i||=new Float32Array(e.length);for(let a=0,o=e.length;a<o;a+=2)i[a]=t+e[a],i[a+1]=r+e[a+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,i,a){switch(a){case 90:return[1-t/r,e/i];case 180:return[1-e/r,1-t/i];case 270:return[t/r,1-e/i];default:return[e/r,t/i]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,i,a,o){return[(e+5*r)/6,(t+5*i)/6,(5*r+a)/6,(5*i+o)/6,(r+a)/2,(i+o)/2]}}class hc{#e;#t=[];#n;#r;#s=[];#i=new Float32Array(18);#l;#o;#f;#c;#h;#u;#d=[];static#a=8;static#p=2;static#m=hc.#a+hc.#p;constructor({x:e,y:t},r,i,a,o,c=0){this.#e=r,this.#u=a*i,this.#r=o,this.#i.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=c,this.#c=hc.#a*i,this.#f=hc.#m*i,this.#h=i,this.#d.push(e,t)}isEmpty(){return isNaN(this.#i[8])}#g(){const e=this.#i.subarray(4,6),t=this.#i.subarray(16,18),[r,i,a,o]=this.#e;return[(this.#l+(e[0]-t[0])/2-r)/a,(this.#o+(e[1]-t[1])/2-i)/o,(this.#l+(t[0]-e[0])/2-r)/a,(this.#o+(t[1]-e[1])/2-i)/o]}add({x:e,y:t}){this.#l=e,this.#o=t;const[r,i,a,o]=this.#e;let[c,f,h,d]=this.#i.subarray(8,12);const g=e-h,m=t-d,v=Math.hypot(g,m);if(v<this.#f)return!1;const y=v-this.#c,b=y/v,A=b*g,w=b*m;let C=c,T=f;c=h,f=d,h+=A,d+=w,this.#d?.push(e,t);const R=-w/y,N=A/y,I=R*this.#u,D=N*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([h+I,d+D],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([h-I,d-D],16),isNaN(this.#i[6])?(this.#s.length===0&&(this.#i.set([c+I,f+D],2),this.#s.push(NaN,NaN,NaN,NaN,(c+I-r)/a,(f+D-i)/o),this.#i.set([c-I,f-D],14),this.#t.push(NaN,NaN,NaN,NaN,(c-I-r)/a,(f-D-i)/o)),this.#i.set([C,T,c,f,h,d],6),!this.isEmpty()):(this.#i.set([C,T,c,f,h,d],6),Math.abs(Math.atan2(T-f,C-c)-Math.atan2(w,A))<Math.PI/2?([c,f,h,d]=this.#i.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((c+h)/2-r)/a,((f+d)/2-i)/o),[c,f,C,T]=this.#i.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((C+c)/2-r)/a,((T+f)/2-i)/o),!0):([C,T,c,f,h,d]=this.#i.subarray(0,6),this.#s.push(((C+5*c)/6-r)/a,((T+5*f)/6-i)/o,((5*c+h)/6-r)/a,((5*f+d)/6-i)/o,((c+h)/2-r)/a,((f+d)/2-i)/o),[h,d,c,f,C,T]=this.#i.subarray(12,18),this.#t.push(((C+5*c)/6-r)/a,((T+5*f)/6-i)/o,((5*c+h)/6-r)/a,((5*f+d)/6-i)/o,((c+h)/2-r)/a,((f+d)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#s,t=this.#t;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#v();const r=[];r.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?r.push(`L${e[i+4]} ${e[i+5]}`):r.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#x(r);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?r.push(`L${t[i+4]} ${t[i+5]}`):r.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#_(r),r.join(" ")}#v(){const[e,t,r,i]=this.#e,[a,o,c,f]=this.#g();return`M${(this.#i[2]-e)/r} ${(this.#i[3]-t)/i} L${(this.#i[4]-e)/r} ${(this.#i[5]-t)/i} L${a} ${o} L${c} ${f} L${(this.#i[16]-e)/r} ${(this.#i[17]-t)/i} L${(this.#i[14]-e)/r} ${(this.#i[15]-t)/i} Z`}#_(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#x(e){const[t,r,i,a]=this.#e,o=this.#i.subarray(4,6),c=this.#i.subarray(16,18),[f,h,d,g]=this.#g();e.push(`L${(o[0]-t)/i} ${(o[1]-r)/a} L${f} ${h} L${d} ${g} L${(c[0]-t)/i} ${(c[1]-r)/a}`)}newFreeDrawOutline(e,t,r,i,a,o){return new _T(e,t,r,i,a,o)}getOutlines(){const e=this.#s,t=this.#t,r=this.#i,[i,a,o,c]=this.#e,f=new Float32Array((this.#d?.length??0)+2);for(let g=0,m=f.length-2;g<m;g+=2)f[g]=(this.#d[g]-i)/o,f[g+1]=(this.#d[g+1]-a)/c;if(f[f.length-2]=(this.#l-i)/o,f[f.length-1]=(this.#o-a)/c,isNaN(r[6])&&!this.isEmpty())return this.#b(f);const h=new Float32Array(this.#s.length+24+this.#t.length);let d=e.length;for(let g=0;g<d;g+=2){if(isNaN(e[g])){h[g]=h[g+1]=NaN;continue}h[g]=e[g],h[g+1]=e[g+1]}d=this.#S(h,d);for(let g=t.length-6;g>=6;g-=6)for(let m=0;m<6;m+=2){if(isNaN(t[g+m])){h[d]=h[d+1]=NaN,d+=2;continue}h[d]=t[g+m],h[d+1]=t[g+m+1],d+=2}return this.#A(h,d),this.newFreeDrawOutline(h,f,this.#e,this.#h,this.#n,this.#r)}#b(e){const t=this.#i,[r,i,a,o]=this.#e,[c,f,h,d]=this.#g(),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(t[2]-r)/a,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-r)/a,(t[5]-i)/o,NaN,NaN,NaN,NaN,c,f,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(t[16]-r)/a,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-r)/a,(t[15]-i)/o],0),this.newFreeDrawOutline(g,e,this.#e,this.#h,this.#n,this.#r)}#A(e,t){const r=this.#t;return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6}#S(e,t){const r=this.#i.subarray(4,6),i=this.#i.subarray(16,18),[a,o,c,f]=this.#e,[h,d,g,m]=this.#g();return e.set([NaN,NaN,NaN,NaN,(r[0]-a)/c,(r[1]-o)/f,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,g,m,NaN,NaN,NaN,NaN,(i[0]-a)/c,(i[1]-o)/f],t),t+=24}}class _T extends st{#e;#t=new Float32Array(4);#n;#r;#s;#i;#l;constructor(e,t,r,i,a,o){super(),this.#l=e,this.#s=t,this.#e=r,this.#i=i,this.#n=a,this.#r=o,this.lastPoint=[NaN,NaN],this.#o(o);const[c,f,h,d]=this.#t;for(let g=0,m=e.length;g<m;g+=2)e[g]=(e[g]-c)/h,e[g+1]=(e[g+1]-f)/d;for(let g=0,m=t.length;g<m;g+=2)t[g]=(t[g]-c)/h,t[g+1]=(t[g+1]-f)/d}toSVGPath(){const e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,r=this.#l.length;t<r;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,r,i],a){const o=r-e,c=i-t;let f,h;switch(a){case 0:f=st._rescale(this.#l,e,i,o,-c),h=st._rescale(this.#s,e,i,o,-c);break;case 90:f=st._rescaleAndSwap(this.#l,e,t,o,c),h=st._rescaleAndSwap(this.#s,e,t,o,c);break;case 180:f=st._rescale(this.#l,r,t,-o,c),h=st._rescale(this.#s,r,t,-o,c);break;case 270:f=st._rescaleAndSwap(this.#l,r,i,-o,-c),h=st._rescaleAndSwap(this.#s,r,i,-o,-c);break}return{outline:Array.from(f),points:[Array.from(h)]}}#o(e){const t=this.#l;let r=t[4],i=t[5];const a=[r,i,r,i];let o=r,c=i;const f=e?Math.max:Math.min;for(let d=6,g=t.length;d<g;d+=6){const m=t[d+4],v=t[d+5];if(isNaN(t[d]))dt.pointBoundingBox(m,v,a),c<v?(o=m,c=v):c===v&&(o=f(o,m));else{const y=[1/0,1/0,-1/0,-1/0];dt.bezierBoundingBox(r,i,...t.slice(d,d+6),y),dt.rectBoundingBox(...y,a),c<y[3]?(o=y[2],c=y[3]):c===y[3]&&(o=f(o,y[2]))}r=m,i=v}const h=this.#t;h[0]=a[0]-this.#n,h[1]=a[1]-this.#n,h[2]=a[2]-a[0]+2*this.#n,h[3]=a[3]-a[1]+2*this.#n,this.lastPoint=[o,c]}get box(){return this.#t}newOutliner(e,t,r,i,a,o=0){return new hc(e,t,r,i,a,o)}getNewOutline(e,t){const[r,i,a,o]=this.#t,[c,f,h,d]=this.#e,g=a*h,m=o*d,v=r*h+c,y=i*d+f,b=this.newOutliner({x:this.#s[0]*g+v,y:this.#s[1]*m+y},this.#e,this.#i,e,this.#r,t??this.#n);for(let A=2;A<this.#s.length;A+=2)b.add({x:this.#s[A]*g+v,y:this.#s[A+1]*m+y});return b.getOutlines()}}class y_{#e;#t;#n=[];#r=[];constructor(e,t=0,r=0,i=!0){const a=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:v,y,width:b,height:A}of e){const w=Math.floor((v-t)/o)*o,C=Math.ceil((v+b+t)/o)*o,T=Math.floor((y-t)/o)*o,R=Math.ceil((y+A+t)/o)*o,N=[w,T,R,!0],I=[C,T,R,!1];this.#n.push(N,I),dt.rectBoundingBox(w,T,C,R,a)}const c=a[2]-a[0]+2*r,f=a[3]-a[1]+2*r,h=a[0]-r,d=a[1]-r,g=this.#n.at(i?-1:-2),m=[g[0],g[2]];for(const v of this.#n){const[y,b,A]=v;v[0]=(y-h)/c,v[1]=(b-d)/f,v[2]=(A-d)/f}this.#e=new Float32Array([h,d,c,f]),this.#t=m}getOutlines(){this.#n.sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#f(t)),this.#l(t)):(this.#o(t),e.push(...this.#f(t)));return this.#s(e)}#s(e){const t=[],r=new Set;for(const o of e){const[c,f,h]=o;t.push([c,f,o],[c,h,o])}t.sort((o,c)=>o[1]-c[1]||o[0]-c[0]);for(let o=0,c=t.length;o<c;o+=2){const f=t[o][2],h=t[o+1][2];f.push(h),h.push(f),r.add(f),r.add(h)}const i=[];let a;for(;r.size>0;){const o=r.values().next().value;let[c,f,h,d,g]=o;r.delete(o);let m=c,v=f;for(a=[c,h],i.push(a);;){let y;if(r.has(d))y=d;else if(r.has(g))y=g;else break;r.delete(y),[c,f,h,d,g]=y,m!==c&&(a.push(m,v,c,v===f?f:h),m=c),v=v===f?h:f}a.push(m,v)}return new ck(i,this.#e,this.#t)}#i(e){const t=this.#r;let r=0,i=t.length-1;for(;r<=i;){const a=r+i>>1,o=t[a][0];if(o===e)return a;o<e?r=a+1:i=a-1}return i+1}#l([,e,t]){const r=this.#i(e);this.#r.splice(r,0,[e,t])}#o([,e,t]){const r=this.#i(e);for(let i=r;i<this.#r.length;i++){const[a,o]=this.#r[i];if(a!==e)break;if(a===e&&o===t){this.#r.splice(i,1);return}}for(let i=r-1;i>=0;i--){const[a,o]=this.#r[i];if(a!==e)break;if(a===e&&o===t){this.#r.splice(i,1);return}}}#f(e){const[t,r,i]=e,a=[[t,r,i]],o=this.#i(i);for(let c=0;c<o;c++){const[f,h]=this.#r[c];for(let d=0,g=a.length;d<g;d++){const[,m,v]=a[d];if(!(h<=m||v<=f)){if(m>=f){if(v>h)a[d][1]=h;else{if(g===1)return[];a.splice(d,1),d--,g--}continue}a[d][2]=f,v>h&&a.push([t,h,v])}}}return a}}class ck extends st{#e;#t;constructor(e,t,r){super(),this.#t=e,this.#e=t,this.lastPoint=r}toSVGPath(){const e=[];for(const t of this.#t){let[r,i]=t;e.push(`M${r} ${i}`);for(let a=2;a<t.length;a+=2){const o=t[a],c=t[a+1];o===r?(e.push(`V${c}`),i=c):c===i&&(e.push(`H${o}`),r=o)}e.push("Z")}return e.join(" ")}serialize([e,t,r,i],a){const o=[],c=r-e,f=i-t;for(const h of this.#t){const d=new Array(h.length);for(let g=0;g<h.length;g+=2)d[g]=e+h[g]*c,d[g+1]=i-h[g+1]*f;o.push(d)}return o}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class b_ extends hc{newFreeDrawOutline(e,t,r,i,a,o){return new uk(e,t,r,i,a,o)}}class uk extends _T{newOutliner(e,t,r,i,a,o=0){return new b_(e,t,r,i,a,o)}}class Zi{#e=null;#t=null;#n;#r=null;#s=!1;#i=!1;#l=null;#o;#f=null;#c=null;#h;static#u=null;static get _keyboardManager(){return Vt(this,"_keyboardManager",new Gd([[["Escape","mac+Escape"],Zi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Zi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Zi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Zi.prototype._moveToPrevious],[["Home","mac+Home"],Zi.prototype._moveToBeginning],[["End","mac+End"],Zi.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#i=!1,this.#h=Wt.HIGHLIGHT_COLOR,this.#l=e):(this.#i=!0,this.#h=Wt.HIGHLIGHT_DEFAULT_COLOR),this.#c=e?._uiManager||t,this.#o=this.#c._eventBus,this.#n=e?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",Zi.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#c._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const r=this.#t=document.createElement("span");return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=this.#n,e.append(r),e}renderMainDropdown(){const e=this.#r=this.#d();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#d(){const e=document.createElement("div"),t=this.#c._signal;e.addEventListener("contextmenu",ks,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[r,i]of this.#c.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",i),a.title=r,a.setAttribute("data-l10n-id",Zi.#u[r]);const o=document.createElement("span");a.append(o),o.className="swatch",o.style.backgroundColor=i,a.setAttribute("aria-selected",i===this.#n),a.addEventListener("click",this.#a.bind(this,i),{signal:t}),e.append(a)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#a(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#m(e);return}const t=e.target.getAttribute("data-color");t&&this.#a(t,e)}_moveToNext(e){if(!this.#v){this.#m(e);return}if(e.target===this.#e){this.#r.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#r?.firstChild||e.target===this.#e){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#v){this.#m(e);return}this.#r.firstChild?.focus()}_moveToEnd(e){if(!this.#v){this.#m(e);return}this.#r.lastChild?.focus()}#p(e){Zi._keyboardManager.exec(this,e)}#m(e){if(this.#v){this.hideDropdown();return}if(this.#s=e.detail===0,this.#f||(this.#f=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#c.combinedSignal(this.#f)})),this.#r){this.#r.classList.remove("hidden");return}const t=this.#r=this.#d();this.#e.append(t)}#g(e){this.#r?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#r?.classList.add("hidden"),this.#f?.abort(),this.#f=null}get#v(){return this.#r&&!this.#r.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#v){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#r)return;const t=this.#c.highlightColors.values();for(const r of this.#r.children)r.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#r?.remove(),this.#r=null}}class Wn extends vt{#e=null;#t=0;#n;#r=null;#s=null;#i=null;#l=null;#o=0;#f=null;#c=null;#h=null;#u=!1;#d=null;#a;#p=null;#m="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Nt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Wn.prototype;return Vt(this,"_keyboardManager",new Gd([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Wn._defaultColor,this.#g=e.thickness||Wn._defaultThickness,this.#a=e.opacity||Wn._defaultOpacity,this.#n=e.boxes||null,this.#v=e.methodOfCreation||"",this.#m=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#u=!0,this.#x(e),this.#O()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#o=e.focusOffset,this.#_(),this.#O(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#_(){const e=new y_(this.#n,.001);this.#c=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const t=new y_(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#i=t.getOutlines();const{lastPoint:r}=this.#i;this.#d=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#x({highlightOutlines:e,highlightId:t,clipPathId:r}){this.#c=e;const i=1.5;if(this.#i=e.getNewOutline(this.#g/2+i,.0025),t>=0)this.#h=t,this.#r=r,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const d=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:Wn.#E(this.#c.box,(d-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Wn.#E(this.#i.box,d),path:{d:this.#i.toSVGPath()}})}const[a,o,c,f]=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=f;break;case 90:{const[d,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*g/d,this.height=f*d/g;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=f;break;case 270:{const[d,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*g/d,this.height=f*d/g;break}}const{lastPoint:h}=this.#i;this.#d=[(h[0]-a)/c,(h[1]-o)/f]}static initialize(e,t){vt.initialize(e,t),Wn._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Wt.HIGHLIGHT_DEFAULT_COLOR:Wn._defaultColor=t;break;case Wt.HIGHLIGHT_THICKNESS:Wn._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#d}updateParams(e,t){switch(e){case Wt.HIGHLIGHT_COLOR:this.#b(t);break;case Wt.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[Wt.HIGHLIGHT_DEFAULT_COLOR,Wn._defaultColor],[Wt.HIGHLIGHT_THICKNESS,Wn._defaultThickness]]}get propertiesToUpdate(){return[[Wt.HIGHLIGHT_COLOR,this.color||Wn._defaultColor],[Wt.HIGHLIGHT_THICKNESS,this.#g||Wn._defaultThickness],[Wt.HIGHLIGHT_FREE,this.#u]]}#b(e){const t=(a,o)=>{this.color=a,this.#a=o,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:a,"fill-opacity":o}}),this.#s?.updateColor(a)},r=this.color,i=this.#a;this.addCommands({cmd:t.bind(this,e,Wn._defaultOpacity),undo:t.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Wt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#A(e){const t=this.#g,r=i=>{this.#g=i,this.#S(i)};this.addCommands({cmd:r.bind(this,e),undo:r.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Wt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#s=new Zi({editor:this}),e.addColorPicker(this.#s)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#N())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#N())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#O(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#C():e&&(this.#O(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#S(e){if(!this.#u)return;this.#x({highlightOutlines:this.#c.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,r]=this.parentDimensions;this.setDims(this.width*t,this.height*r)}#C(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#O(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#r}=e.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#u),this.#f&&(this.#f.style.clipPath=this.#r))}static#E([e,t,r,i],a){switch(a){case 90:return[1-t-i,e,i,r];case 180:return[1-e-r,1-t-i,r,i];case 270:return[t,1-e-r,i,r]}return[e,t,r,i]}rotate(e){const{drawLayer:t}=this.parent;let r;this.#u?(e=(e-this.rotation+360)%360,r=Wn.#E(this.#c.box,e)):r=Wn.#E([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:r,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:Wn.#E(this.#i.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#m&&(e.setAttribute("aria-label",this.#m),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const t=this.#f=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#r;const[r,i]=this.parentDimensions;return this.setDims(this.width*r,this.height*i),V2(this,this.#f,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#D(e){Wn._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#T(!0);break;case 1:case 3:this.#T(!1);break}}#T(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#T(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#N(){return this.#u?this.rotation:0}#L(){if(this.#u)return null;const[e,t]=this.pageDimensions,[r,i]=this.pageTranslation,a=this.#n,o=new Float32Array(a.length*8);let c=0;for(const{x:f,y:h,width:d,height:g}of a){const m=f*e+r,v=(1-h)*t+i;o[c]=o[c+4]=m,o[c+1]=o[c+3]=v,o[c+2]=o[c+6]=m+d*e,o[c+5]=o[c+7]=v-g*t,c+=8}return o}#M(e){return this.#c.serialize(e,this.#N())}static startHighlighting(e,t,{target:r,x:i,y:a}){const{x:o,y:c,width:f,height:h}=r.getBoundingClientRect(),d=new AbortController,g=e.combinedSignal(d),m=v=>{d.abort(),this.#w(e,v)};window.addEventListener("blur",m,{signal:g}),window.addEventListener("pointerup",m,{signal:g}),window.addEventListener("pointerdown",Xn,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",ks,{signal:g}),r.addEventListener("pointermove",this.#H.bind(this,e),{signal:g}),this._freeHighlight=new b_({x:i,y:a},[o,c,f,h],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#H(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#w(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,r){let i=null;if(e instanceof gT){const{data:{quadPoints:y,rect:b,rotation:A,id:w,color:C,opacity:T,popupRef:R},parent:{page:{pageNumber:N}}}=e;i=e={annotationType:Nt.HIGHLIGHT,color:Array.from(C),opacity:T,quadPoints:y,boxes:null,pageIndex:N-1,rect:b.slice(0),rotation:A,id:w,deleted:!1,popupRef:R}}else if(e instanceof bx){const{data:{inkLists:y,rect:b,rotation:A,id:w,color:C,borderStyle:{rawWidth:T},popupRef:R},parent:{page:{pageNumber:N}}}=e;i=e={annotationType:Nt.HIGHLIGHT,color:Array.from(C),thickness:T,inkLists:y,boxes:null,pageIndex:N-1,rect:b.slice(0),rotation:A,id:w,deleted:!1,popupRef:R}}const{color:a,quadPoints:o,inkLists:c,opacity:f}=e,h=await super.deserialize(e,t,r);h.color=dt.makeHexColor(...a),h.#a=f||1,c&&(h.#g=e.thickness),h.annotationElementId=e.id||null,h._initialData=i;const[d,g]=h.pageDimensions,[m,v]=h.pageTranslation;if(o){const y=h.#n=[];for(let b=0;b<o.length;b+=8)y.push({x:(o[b]-m)/d,y:1-(o[b+1]-v)/g,width:(o[b+2]-o[b])/d,height:(o[b+1]-o[b+5])/g});h.#_(),h.#O(),h.rotate(h.rotation)}else if(c){h.#u=!0;const y=c[0],b={x:y[0]-m,y:g-(y[1]-v)},A=new b_(b,[0,0,d,g],1,h.#g/2,!0,.001);for(let T=0,R=y.length;T<R;T+=2)b.x=y[T]-m,b.y=g-(y[T+1]-v),A.add(b);const{id:w,clipPathId:C}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);h.#x({highlightOutlines:A.getOutlines(),highlightId:w,clipPathId:C}),h.#O(),h.rotate(h.parentRotation)}return h}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),r=vt._colorManager.convert(this.color),i={annotationType:Nt.HIGHLIGHT,color:r,opacity:this.#a,thickness:this.#g,quadPoints:this.#L(),outlines:this.#M(t),pageIndex:this.pageIndex,rect:t,rotation:this.#N(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#y(i)?null:(i.id=this.annotationElementId,i)}#y(e){const{color:t}=this._initialData;return e.color.some((r,i)=>r!==t[i])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class xT{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,r)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){bn("Not implemented")}}class bt extends vt{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#r=null;static#s=null;static#i=NaN;static#l=null;static#o=null;static#f=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}_addOutlines(e){e.drawOutlines&&(this.#c(e),this.#d())}#c({drawOutlines:e,drawId:t,drawingOptions:r}){this.#e=e,this._drawingOptions||=r,t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#h(e,this.parent),this.#m(e.box)}#h(e,t){const{id:r}=t.drawLayer.draw(bt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return r}static _mergeSVGProperties(e,t){const r=new Set(Object.keys(e));for(const[i,a]of Object.entries(t))r.has(i)?Object.assign(e[i],a):e[i]=a;return e}static getDefaultDrawingOptions(e){bn("Not implemented")}static get typesMap(){bn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const r=this.typesMap.get(e);r&&this._defaultDrawingOptions.updateProperty(r,t),this._currentParent&&(bt.#n.updateProperty(r,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const r=this.constructor.typesMap.get(e);r&&this._updateProperty(e,r,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[r,i]of this.typesMap)e.push([r,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[r,i]of this.constructor.typesMap)e.push([r,t[i]]);return e}_updateProperty(e,t,r){const i=this._drawingOptions,a=i[t],o=c=>{i.updateProperty(t,c);const f=this.#e.updateProperty(t,c);f&&this.#m(f),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:o.bind(this,r),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,bt._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,bt._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,bt._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#d(),this.#m(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#u()):e&&(this._uiManager.addShouldRescale(this),this.#d(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#d(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#e,e)}}#a([e,t,r,i]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[t,1-e,r*(o/a),i*(a/o)];case 180:return[1-e,1-t,r,i];case 270:return[1-t,e,r*(o/a),i*(a/o)];default:return[e,t,r,i]}}#p(){const{x:e,y:t,width:r,height:i,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-t,e,r*(a/o),i*(o/a)];case 180:return[1-e,1-t,r,i];case 270:return[t,1-e,r*(a/o),i*(o/a)];default:return[e,t,r,i]}}#m(e){if([this.x,this.y,this.width,this.height]=this.#a(e),this.div){this.fixAndSetPosition();const[t,r]=this.parentDimensions;this.setDims(this.width*t,this.height*r)}this._onResized()}#g(){const{x:e,y:t,width:r,height:i,rotation:a,parentRotation:o,parentDimensions:[c,f]}=this;switch((a*4+o)/90){case 1:return[1-t-i,e,i,r];case 2:return[1-e-r,1-t-i,r,i];case 3:return[t,1-e-r,i,r];case 4:return[e,t-r*(c/f),i*(f/c),r*(c/f)];case 5:return[1-t,e,r*(c/f),i*(f/c)];case 6:return[1-e-i*(f/c),1-t,i*(f/c),r*(c/f)];case 7:return[t-r*(c/f),1-e-i*(f/c),r*(c/f),i*(f/c)];case 8:return[e-r,t-i,r,i];case 9:return[1-t,e-r,i,r];case 10:return[1-e,1-t,r,i];case 11:return[t-i,1-e,i,r];case 12:return[e-i*(f/c),t,i*(f/c),r*(c/f)];case 13:return[1-t-r*(c/f),e-i*(f/c),r*(c/f),i*(f/c)];case 14:return[1-e,1-t-r*(c/f),i*(f/c),r*(c/f)];case 15:return[t,1-e,r*(c/f),i*(f/c)];default:return[e,t,r,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,bt._mergeSVGProperties({bbox:this.#g()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#m(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const r=super.render();r.classList.add("draw");const i=document.createElement("div");r.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[a,o]=this.parentDimensions;return this.setDims(this.width*a,this.height*o),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),r}static createDrawerInstance(e,t,r,i,a){bn("Not implemented")}static startDrawing(e,t,r,i){const{target:a,offsetX:o,offsetY:c,pointerId:f,pointerType:h}=i;if(bt.#l&&bt.#l!==h)return;const{viewport:{rotation:d}}=e,{width:g,height:m}=a.getBoundingClientRect(),v=bt.#r=new AbortController,y=e.combinedSignal(v);if(bt.#i||=f,bt.#l??=h,window.addEventListener("pointerup",b=>{bt.#i===b.pointerId?this._endDraw(b):bt.#o?.delete(b.pointerId)},{signal:y}),window.addEventListener("pointercancel",b=>{bt.#i===b.pointerId?this._currentParent.endDrawingSession():bt.#o?.delete(b.pointerId)},{signal:y}),window.addEventListener("pointerdown",b=>{bt.#l===b.pointerType&&((bt.#o||=new Set).add(b.pointerId),bt.#n.isCancellable()&&(bt.#n.removeLastElement(),bt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",ks,{signal:y}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),a.addEventListener("touchmove",b=>{b.timeStamp===bt.#f&&Xn(b)},{signal:y}),e.toggleDrawing(),t._editorUndoBar?.hide(),bt.#n){e.drawLayer.updateProperties(this._currentDrawId,bt.#n.startNew(o,c,g,m,d));return}t.updateUIForDefaultProperties(this),bt.#n=this.createDrawerInstance(o,c,g,m,d),bt.#s=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(bt.#s.toSVGProperties(),bt.#n.defaultSVGProperties),!0,!1)}static _drawMove(e){if(bt.#f=-1,!bt.#n)return;const{offsetX:t,offsetY:r,pointerId:i}=e;if(bt.#i===i){if(bt.#o?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,bt.#n.add(t,r)),bt.#f=e.timeStamp,Xn(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,bt.#n=null,bt.#s=null,bt.#l=null,bt.#f=NaN),bt.#r&&(bt.#r.abort(),bt.#r=null,bt.#i=NaN,bt.#o=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,bt.#n.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const r=bt.#n,i=this._currentDrawId,a=r.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(i,r.setLastElement(a))},undo:()=>{t.drawLayer.updateProperties(i,r.removeLastElement())},mustExec:!1,type:Wt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Wt.DRAW_STEP),!bt.#n.isEmpty()){const{pageDimensions:[r,i],scale:a}=t,o=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:bt.#n.getOutlines(r*a,i*a,a,this._INNER_MARGIN),drawingOptions:bt.#s,mustBeCommitted:!e});return this._cleanup(!0),o}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,r,i,a,o){bn("Not implemented")}static async deserialize(e,t,r){const{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:c}}=t.viewport,f=this.deserializeDraw(o,c,i,a,this._INNER_MARGIN,e),h=await super.deserialize(e,t,r);return h.createDrawingOptions(e),h.#c({drawOutlines:f}),h.#d(),h.onScaleChanging(),h.rotate(),h}serializeDraw(e){const[t,r]=this.pageTranslation,[i,a]=this.pageDimensions;return this.#e.serialize([t,r,i,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class fk{#e=new Float64Array(6);#t;#n;#r;#s;#i;#l="";#o=0;#f=new Yd;#c;#h;constructor(e,t,r,i,a,o){this.#c=r,this.#h=i,this.#r=a,this.#s=o,[e,t]=this.#u(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t],this.#n=[{line:c,points:this.#i}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#s=t)}#u(e,t){return st._normalizePoint(e,t,this.#c,this.#h,this.#r)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#i.length<=10}add(e,t){[e,t]=this.#u(e,t);const[r,i,a,o]=this.#e.subarray(2,6),c=e-a,f=t-o;return Math.hypot(this.#c*c,this.#h*f)<=2?null:(this.#i.push(e,t),isNaN(r)?(this.#e.set([a,o,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([r,i,a,o,e,t],0),this.#t.push(...st.createBezierPoints(r,i,a,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,i,a){this.#c=r,this.#h=i,this.#r=a,[e,t]=this.#u(e,t);const o=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t];const c=this.#n.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#n.push({line:o,points:this.#i}),this.#e.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(e){return this.#n?(this.#n.push(e),this.#t=e.line,this.#i=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#f.setLastElement(e)}removeLastElement(){if(!this.#n)return this.#f.removeLastElement();this.#n.pop(),this.#l="";for(let e=0,t=this.#n.length;e<t;e++){const{line:r,points:i}=this.#n[e];this.#t=r,this.#i=i,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const e=st.svgRound(this.#t[4]),t=st.svgRound(this.#t[5]);if(this.#i.length===2)return this.#l=`${this.#l} M ${e} ${t} Z`,this.#l;if(this.#i.length<=6){const i=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,i)} M ${e} ${t}`,this.#o=6}if(this.#i.length===4){const i=st.svgRound(this.#t[10]),a=st.svgRound(this.#t[11]);return this.#l=`${this.#l} L ${i} ${a}`,this.#o=12,this.#l}const r=[];this.#o===0&&(r.push(`M ${e} ${t}`),this.#o=6);for(let i=this.#o,a=this.#t.length;i<a;i+=6){const[o,c,f,h,d,g]=this.#t.slice(i,i+6).map(st.svgRound);r.push(`C${o} ${c} ${f} ${h} ${d} ${g}`)}return this.#l+=r.join(" "),this.#o=this.#t.length,this.#l}getOutlines(e,t,r,i){const a=this.#n.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#f.build(this.#n,e,t,r,this.#r,this.#s,i),this.#e=null,this.#t=null,this.#n=null,this.#l=null,this.#f}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Yd extends st{#e;#t=0;#n;#r;#s;#i;#l;#o;#f;build(e,t,r,i,a,o,c){this.#s=t,this.#i=r,this.#l=i,this.#o=a,this.#f=o,this.#n=c??0,this.#r=e,this.#u()}get thickness(){return this.#f}setLastElement(e){return this.#r.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#r.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#r){if(e.push(`M${st.svgRound(t[4])} ${st.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${st.svgRound(t[10])} ${st.svgRound(t[11])}`);continue}for(let r=6,i=t.length;r<i;r+=6){const[a,o,c,f,h,d]=t.subarray(r,r+6).map(st.svgRound);e.push(`C${a} ${o} ${c} ${f} ${h} ${d}`)}}return e.join("")}serialize([e,t,r,i],a){const o=[],c=[],[f,h,d,g]=this.#h();let m,v,y,b,A,w,C,T,R;switch(this.#o){case 0:R=st._rescale,m=e,v=t+i,y=r,b=-i,A=e+f*r,w=t+(1-h-g)*i,C=e+(f+d)*r,T=t+(1-h)*i;break;case 90:R=st._rescaleAndSwap,m=e,v=t,y=r,b=i,A=e+h*r,w=t+f*i,C=e+(h+g)*r,T=t+(f+d)*i;break;case 180:R=st._rescale,m=e+r,v=t,y=-r,b=i,A=e+(1-f-d)*r,w=t+h*i,C=e+(1-f)*r,T=t+(h+g)*i;break;case 270:R=st._rescaleAndSwap,m=e+r,v=t+i,y=-r,b=-i,A=e+(1-h-g)*r,w=t+(1-f-d)*i,C=e+(1-h)*r,T=t+(1-f)*i;break}for(const{line:N,points:I}of this.#r)o.push(R(N,m,v,y,b,a?new Array(N.length):null)),c.push(R(I,m,v,y,b,a?new Array(I.length):null));return{lines:o,points:c,rect:[A,w,C,T]}}static deserialize(e,t,r,i,a,{paths:{lines:o,points:c},rotation:f,thickness:h}){const d=[];let g,m,v,y,b;switch(f){case 0:b=st._rescale,g=-e/r,m=t/i+1,v=1/r,y=-1/i;break;case 90:b=st._rescaleAndSwap,g=-t/i,m=-e/r,v=1/i,y=1/r;break;case 180:b=st._rescale,g=e/r+1,m=-t/i,v=-1/r,y=1/i;break;case 270:b=st._rescaleAndSwap,g=t/i+1,m=e/r+1,v=-1/i,y=-1/r;break}if(!o){o=[];for(const w of c){const C=w.length;if(C===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(C===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const T=new Float32Array(3*(C-2));o.push(T);let[R,N,I,D]=w.subarray(0,4);T.set([NaN,NaN,NaN,NaN,R,N],0);for(let B=4;B<C;B+=2){const U=w[B],Y=w[B+1];T.set(st.createBezierPoints(R,N,I,D,U,Y),(B-2)*3),[R,N,I,D]=[I,D,U,Y]}}}for(let w=0,C=o.length;w<C;w++)d.push({line:b(o[w].map(T=>T??NaN),g,m,v,y),points:b(c[w].map(T=>T??NaN),g,m,v,y)});const A=new this.prototype.constructor;return A.build(d,r,i,1,f,h,a),A}#c(e=this.#f){const t=this.#n+e/2*this.#l;return this.#o%180===0?[t/this.#s,t/this.#i]:[t/this.#i,t/this.#s]}#h(){const[e,t,r,i]=this.#e,[a,o]=this.#c(0);return[e+a,t+o,r-2*a,i-2*o]}#u(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#r){if(i.length<=12){for(let c=4,f=i.length;c<f;c+=6)dt.pointBoundingBox(i[c],i[c+1],e);continue}let a=i[4],o=i[5];for(let c=6,f=i.length;c<f;c+=6){const[h,d,g,m,v,y]=i.subarray(c,c+6);dt.bezierBoundingBox(a,o,h,d,g,m,v,y,e),a=v,o=y}}const[t,r]=this.#c();e[0]=Xr(e[0]-t,0,1),e[1]=Xr(e[1]-r,0,1),e[2]=Xr(e[2]+t,0,1),e[3]=Xr(e[3]+r,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#d(t):null}#d(e){const[t,r]=this.#c();this.#f=e;const[i,a]=this.#c(),[o,c]=[i-t,a-r],f=this.#e;return f[0]-=o,f[1]-=c,f[2]+=2*o,f[3]+=2*c,f}updateParentDimensions([e,t],r){const[i,a]=this.#c();this.#s=e,this.#i=t,this.#l=r;const[o,c]=this.#c(),f=o-i,h=c-a,d=this.#e;return d[0]-=f,d[1]-=h,d[2]+=2*f,d[3]+=2*h,d}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(st.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${st.svgRound(e)} ${st.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let r=0,i=0,a=0,o=0,c=0,f=0;switch(this.#t){case 90:i=t/e,a=-e/t,c=e;break;case 180:r=-1,o=-1,c=e,f=t;break;case 270:i=-t/e,a=e/t,f=t;break;default:return""}return`matrix(${r} ${i} ${a} ${o} ${st.svgRound(c)} ${st.svgRound(f)})`}getPathResizingSVGProperties([e,t,r,i]){const[a,o]=this.#c(),[c,f,h,d]=this.#e;if(Math.abs(h-a)<=st.PRECISION||Math.abs(d-o)<=st.PRECISION){const b=e+r/2-(c+h/2),A=t+i/2-(f+d/2);return{path:{"transform-origin":`${st.svgRound(e)} ${st.svgRound(t)}`,transform:`${this.rotationTransform} translate(${b} ${A})`}}}const g=(r-2*a)/(h-2*a),m=(i-2*o)/(d-2*o),v=h/r,y=d/i;return{path:{"transform-origin":`${st.svgRound(c)} ${st.svgRound(f)}`,transform:`${this.rotationTransform} scale(${v} ${y}) translate(${st.svgRound(a)} ${st.svgRound(o)}) scale(${g} ${m}) translate(${st.svgRound(-a)} ${st.svgRound(-o)})`}}}getPathResizedSVGProperties([e,t,r,i]){const[a,o]=this.#c(),c=this.#e,[f,h,d,g]=c;if(c[0]=e,c[1]=t,c[2]=r,c[3]=i,Math.abs(d-a)<=st.PRECISION||Math.abs(g-o)<=st.PRECISION){const A=e+r/2-(f+d/2),w=t+i/2-(h+g/2);for(const{line:C,points:T}of this.#r)st._translate(C,A,w,C),st._translate(T,A,w,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${st.svgRound(e)} ${st.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(r-2*a)/(d-2*a),v=(i-2*o)/(g-2*o),y=-m*(f+a)+e+a,b=-v*(h+o)+t+o;if(m!==1||v!==1||y!==0||b!==0)for(const{line:A,points:w}of this.#r)st._rescale(A,y,b,m,v,A),st._rescale(w,y,b,m,v,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${st.svgRound(e)} ${st.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],r){const[i,a]=r,o=this.#e,c=e-o[0],f=t-o[1];if(this.#s===i&&this.#i===a)for(const{line:h,points:d}of this.#r)st._translate(h,c,f,h),st._translate(d,c,f,d);else{const h=this.#s/i,d=this.#i/a;this.#s=i,this.#i=a;for(const{line:g,points:m}of this.#r)st._rescale(g,c,f,h,d,g),st._rescale(m,c,f,h,d,m);o[2]*=h,o[3]*=d}return o[0]=e,o[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${st.svgRound(e)} ${st.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${st.svgRound(e[0])} ${st.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class cm extends xT{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:vt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new cm(this._viewParameters);return e.updateAll(this),e}}class Ax extends bt{static _type="ink";static _editorType=Nt.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){vt.initialize(e,t),this._defaultDrawingOptions=new cm(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Vt(this,"typesMap",new Map([[Wt.INK_THICKNESS,"stroke-width"],[Wt.INK_COLOR,"stroke"],[Wt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,r,i,a){return new fk(e,t,r,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,r,i,a,o){return Yd.deserialize(e,t,r,i,a,o)}static async deserialize(e,t,r){let i=null;if(e instanceof bx){const{data:{inkLists:o,rect:c,rotation:f,id:h,color:d,opacity:g,borderStyle:{rawWidth:m},popupRef:v},parent:{page:{pageNumber:y}}}=e;i=e={annotationType:Nt.INK,color:Array.from(d),thickness:m,opacity:g,paths:{points:o},boxes:null,pageIndex:y-1,rect:c.slice(0),rotation:f,id:h,deleted:!1,popupRef:v}}const a=await super.deserialize(e,t,r);return a.annotationElementId=e.id||null,a._initialData=i,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:r}=this;t.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:r}){this._drawingOptions=Ax.getDefaultDrawingOptions({stroke:dt.makeHexColor(...e),"stroke-width":t,"stroke-opacity":r})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:r,rect:i}=this.serializeDraw(e),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":c}}=this,f={annotationType:Nt.INK,color:vt._colorManager.convert(a),opacity:o,thickness:c,paths:{lines:t,points:r},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(f.isCopy=!0,f):this.annotationElementId&&!this.#e(f)?null:(f.id=this.annotationElementId,f)}#e(e){const{color:t,thickness:r,opacity:i,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((o,c)=>o!==t[c])||e.thickness!==r||e.opacity!==i||e.pageIndex!==a}renderAnnotationElement(e){const{points:t,rect:r}=this.serializeDraw(!1);return e.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class E_ extends Yd{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Wp=8,Xh=3;class lc{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,r,i){return r-=e,i-=t,r===0?i>0?0:4:r===1?i+6:2-i}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#r(e,t,r,i,a,o,c){const f=this.#t(r,i,a,o);for(let h=0;h<8;h++){const d=(-h+f-c+16)%8,g=this.#n[2*d],m=this.#n[2*d+1];if(e[(r+g)*t+(i+m)]!==0)return d}return-1}static#s(e,t,r,i,a,o,c){const f=this.#t(r,i,a,o);for(let h=0;h<8;h++){const d=(h+f+c+16)%8,g=this.#n[2*d],m=this.#n[2*d+1];if(e[(r+g)*t+(i+m)]!==0)return d}return-1}static#i(e,t,r,i){const a=e.length,o=new Int32Array(a);for(let d=0;d<a;d++)o[d]=e[d]<=i?1:0;for(let d=1;d<r-1;d++)o[d*t]=o[d*t+t-1]=0;for(let d=0;d<t;d++)o[d]=o[t*r-1-d]=0;let c=1,f;const h=[];for(let d=1;d<r-1;d++){f=1;for(let g=1;g<t-1;g++){const m=d*t+g,v=o[m];if(v===0)continue;let y=d,b=g;if(v===1&&o[m-1]===0)c+=1,b-=1;else if(v>=1&&o[m+1]===0)c+=1,b+=1,v>1&&(f=v);else{v!==1&&(f=Math.abs(v));continue}const A=[g,d],w=b===g+1,C={isHole:w,points:A,id:c,parent:0};h.push(C);let T;for(const W of h)if(W.id===f){T=W;break}T?T.isHole?C.parent=w?T.parent:f:C.parent=w?f:T.parent:C.parent=w?f:0;const R=this.#r(o,t,d,g,y,b,0);if(R===-1){o[m]=-c,o[m]!==1&&(f=Math.abs(o[m]));continue}let N=this.#n[2*R],I=this.#n[2*R+1];const D=d+N,B=g+I;y=D,b=B;let U=d,Y=g;for(;;){const W=this.#s(o,t,U,Y,y,b,1);N=this.#n[2*W],I=this.#n[2*W+1];const re=U+N,Te=Y+I;A.push(Te,re);const Fe=U*t+Y;if(o[Fe+1]===0?o[Fe]=-c:o[Fe]===1&&(o[Fe]=c),re===d&&Te===g&&U===D&&Y===B){o[m]!==1&&(f=Math.abs(o[m]));break}else y=U,b=Y,U=re,Y=Te}}}return h}static#l(e,t,r,i){if(r-t<=4){for(let D=t;D<r-2;D+=2)i.push(e[D],e[D+1]);return}const a=e[t],o=e[t+1],c=e[r-4]-a,f=e[r-3]-o,h=Math.hypot(c,f),d=c/h,g=f/h,m=d*o-g*a,v=f/c,y=1/h,b=Math.atan(v),A=Math.cos(b),w=Math.sin(b),C=y*(Math.abs(A)+Math.abs(w)),T=y*(1-C+C**2),R=Math.max(Math.atan(Math.abs(w+A)*T),Math.atan(Math.abs(w-A)*T));let N=0,I=t;for(let D=t+2;D<r-2;D+=2){const B=Math.abs(m-d*e[D+1]+g*e[D]);B>N&&(I=D,N=B)}N>(h*R)**2?(this.#l(e,t,I+2,i),this.#l(e,I,r,i)):i.push(a,o)}static#o(e){const t=[],r=e.length;return this.#l(e,0,r,t),t.push(e[r-2],e[r-1]),t.length<=4?null:t}static#f(e,t,r,i,a,o){const c=new Float32Array(o**2),f=-2*i**2,h=o>>1;for(let b=0;b<o;b++){const A=(b-h)**2;for(let w=0;w<o;w++)c[b*o+w]=Math.exp((A+(w-h)**2)/f)}const d=new Float32Array(256),g=-2*a**2;for(let b=0;b<256;b++)d[b]=Math.exp(b**2/g);const m=e.length,v=new Uint8Array(m),y=new Uint32Array(256);for(let b=0;b<r;b++)for(let A=0;A<t;A++){const w=b*t+A,C=e[w];let T=0,R=0;for(let I=0;I<o;I++){const D=b+I-h;if(!(D<0||D>=r))for(let B=0;B<o;B++){const U=A+B-h;if(U<0||U>=t)continue;const Y=e[D*t+U],W=c[I*o+B]*d[Math.abs(Y-C)];T+=Y*W,R+=W}}const N=v[w]=Math.round(T/R);y[N]++}return[v,y]}static#c(e){const t=new Uint32Array(256);for(const r of e)t[r]++;return t}static#h(e){const t=e.length,r=new Uint8ClampedArray(t>>2);let i=-1/0,a=1/0;for(let c=0,f=r.length;c<f;c++){if(e[(c<<2)+3]===0){i=r[c]=255;continue}const d=r[c]=e[c<<2];d>i&&(i=d),d<a&&(a=d)}const o=255/(i-a);for(let c=0;c<t;c++)r[c]=(r[c]-a)*o;return r}static#u(e){let t,r=-1/0,i=-1/0;const a=e.findIndex(f=>f!==0);let o=a,c=a;for(t=a;t<256;t++){const f=e[t];f>r&&(t-o>i&&(i=t-o,c=t-1),r=f,o=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#d(e){const t=e,{width:r,height:i}=e,{maxDim:a}=this.#e;let o=r,c=i;if(r>a||i>a){let m=r,v=i,y=Math.log2(Math.max(r,i)/a);const b=Math.floor(y);y=y===b?b-1:b;for(let w=0;w<y;w++){o=Math.ceil(m/2),c=Math.ceil(v/2);const C=new OffscreenCanvas(o,c);C.getContext("2d").drawImage(e,0,0,m,v,0,0,o,c),m=o,v=c,e!==t&&e.close(),e=C.transferToImageBitmap()}const A=Math.min(a/o,a/c);o=Math.round(o*A),c=Math.round(c*A)}const h=new OffscreenCanvas(o,c).getContext("2d",{willReadFrequently:!0});h.filter="grayscale(1)",h.drawImage(e,0,0,e.width,e.height,0,0,o,c);const d=h.getImageData(0,0,o,c).data;return[this.#h(d),o,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:r,fontWeight:i},a,o,c,f){let h=new OffscreenCanvas(1,1),d=h.getContext("2d",{alpha:!1});const g=200,m=d.font=`${r} ${i} ${g}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:y,actualBoundingBoxAscent:b,actualBoundingBoxDescent:A,fontBoundingBoxAscent:w,fontBoundingBoxDescent:C,width:T}=d.measureText(e),R=1.5,N=Math.ceil(Math.max(Math.abs(v)+Math.abs(y)||0,T)*R),I=Math.ceil(Math.max(Math.abs(b)+Math.abs(A)||g,Math.abs(w)+Math.abs(C)||g)*R);h=new OffscreenCanvas(N,I),d=h.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=m,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,N,I),d.fillStyle="black",d.fillText(e,N*(R-1)/2,I*(3-R)/2);const D=this.#h(d.getImageData(0,0,N,I).data),B=this.#c(D),U=this.#u(B),Y=this.#i(D,N,I,U);return this.processDrawnLines({lines:{curves:Y,width:N,height:I},pageWidth:a,pageHeight:o,rotation:c,innerMargin:f,mustSmooth:!0,areContours:!0})}static process(e,t,r,i,a){const[o,c,f]=this.#d(e),[h,d]=this.#f(o,c,f,Math.hypot(c,f)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),g=this.#u(d),m=this.#i(h,c,f,g);return this.processDrawnLines({lines:{curves:m,width:c,height:f},pageWidth:t,pageHeight:r,rotation:i,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:r,rotation:i,innerMargin:a,mustSmooth:o,areContours:c}){i%180!==0&&([t,r]=[r,t]);const{curves:f,width:h,height:d}=e,g=e.thickness??0,m=[],v=Math.min(t/h,r/d),y=v/t,b=v/r,A=[];for(const{points:C}of f){const T=o?this.#o(C):C;if(!T)continue;A.push(T);const R=T.length,N=new Float32Array(R),I=new Float32Array(3*(R===2?2:R-2));if(m.push({line:I,points:N}),R===2){N[0]=T[0]*y,N[1]=T[1]*b,I.set([NaN,NaN,NaN,NaN,N[0],N[1]],0);continue}let[D,B,U,Y]=T;D*=y,B*=b,U*=y,Y*=b,N.set([D,B,U,Y],0),I.set([NaN,NaN,NaN,NaN,D,B],0);for(let W=4;W<R;W+=2){const re=N[W]=T[W]*y,Te=N[W+1]=T[W+1]*b;I.set(st.createBezierPoints(D,B,U,Y,re,Te),(W-2)*3),[D,B,U,Y]=[U,Y,re,Te]}}if(m.length===0)return null;const w=c?new E_:new Yd;return w.build(m,t,r,1,i,c?0:g,a),{outline:w,newCurves:A,areContours:c,thickness:g,width:h,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:r,width:i,height:a}){let o=1/0,c=-1/0,f=0;for(const T of e){f+=T.length;for(let R=2,N=T.length;R<N;R++){const I=T[R]-T[R-2];o=Math.min(o,I),c=Math.max(c,I)}}let h;o>=-128&&c<=127?h=Int8Array:o>=-32768&&c<=32767?h=Int16Array:h=Int32Array;const d=e.length,g=Wp+Xh*d,m=new Uint32Array(g);let v=0;m[v++]=g*Uint32Array.BYTES_PER_ELEMENT+(f-2*d)*h.BYTES_PER_ELEMENT,m[v++]=0,m[v++]=i,m[v++]=a,m[v++]=t?0:1,m[v++]=Math.max(0,Math.floor(r??0)),m[v++]=d,m[v++]=h.BYTES_PER_ELEMENT;for(const T of e)m[v++]=T.length-2,m[v++]=T[0],m[v++]=T[1];const y=new CompressionStream("deflate-raw"),b=y.writable.getWriter();await b.ready,b.write(m);const A=h.prototype.constructor;for(const T of e){const R=new A(T.length-2);for(let N=2,I=T.length;N<I;N++)R[N-2]=T[N]-T[N-2];b.write(R)}b.close();const w=await new Response(y.readable).arrayBuffer(),C=new Uint8Array(w);return z2(C)}static async decompressSignature(e){try{const t=z3(e),{readable:r,writable:i}=new DecompressionStream("deflate-raw"),a=i.getWriter();await a.ready,a.write(t).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let o=null,c=0;for await(const T of r)o||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),o.set(T,c),c+=T.length;const f=new Uint32Array(o.buffer,0,o.length>>2),h=f[1];if(h!==0)throw new Error(`Invalid version: ${h}`);const d=f[2],g=f[3],m=f[4]===0,v=f[5],y=f[6],b=f[7],A=[],w=(Wp+Xh*y)*Uint32Array.BYTES_PER_ELEMENT;let C;switch(b){case Int8Array.BYTES_PER_ELEMENT:C=new Int8Array(o.buffer,w);break;case Int16Array.BYTES_PER_ELEMENT:C=new Int16Array(o.buffer,w);break;case Int32Array.BYTES_PER_ELEMENT:C=new Int32Array(o.buffer,w);break}c=0;for(let T=0;T<y;T++){const R=f[Xh*T+Wp],N=new Float32Array(R+2);A.push(N);for(let I=0;I<Xh-1;I++)N[I]=f[Xh*T+Wp+I+1];for(let I=0;I<R;I++)N[I+2]=N[I]+C[c++]}return{areContours:m,thickness:v,outlines:A,width:d,height:g}}catch(t){return Mt(`decompressSignature: ${t}`),null}}}class wx extends xT{constructor(){super(),super.updateProperties({fill:vt._defaultLineColor,"stroke-width":0})}clone(){const e=new wx;return e.updateAll(this),e}}class Sx extends cm{constructor(e){super(e),super.updateProperties({stroke:vt._defaultLineColor,"stroke-width":1})}clone(){const e=new Sx(this._viewParameters);return e.updateAll(this),e}}class Ca extends bt{#e=!1;#t=null;#n=null;#r=null;static _type="signature";static _editorType=Nt.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){vt.initialize(e,t),this._defaultDrawingOptions=new wx,this._defaultDrawnSignatureOptions=new Sx(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Vt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:i,mustSmooth:a,areContours:o,description:c,uuid:f,heightInPage:h}=this.#n,{rawDims:{pageWidth:d,pageHeight:g},rotation:m}=this.parent.viewport,v=lc.processDrawnLines({lines:i,pageWidth:d,pageHeight:g,rotation:m,innerMargin:Ca._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(v,h,c,f)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return r&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#r=e,this.addEditToolbar()}getUuid(){return this.#r}get description(){return this.#t}set description(e){this.#t=e,super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)})}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:r,width:i,height:a}=this.#n,o=Math.max(i,a),c=lc.processDrawnLines({lines:{curves:e.map(f=>({points:f})),thickness:r,width:i,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.signatureManager&&this.#t!==null&&(await e.addEditSignatureButton(this._uiManager.signatureManager,this.#r,this.#t),e.show()),e):null}addSignature(e,t,r,i){const{x:a,y:o}=this,{outline:c}=this.#n=e;this.#e=c instanceof E_,this.#t=r,this.div.setAttribute("data-l10n-args",JSON.stringify({description:r}));let f;this.#e?f=Ca.getDefaultDrawingOptions():(f=Ca._defaultDrawnSignatureOptions.clone(),f.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:f});const[h,d]=this.parentDimensions,[,g]=this.pageDimensions;let m=t/g;m=m>=1?.5:m,this.width*=m/this.height,this.width>=1&&(m*=.9/this.width,this.width=.9),this.height=m,this.setDims(h*this.width,d*this.height),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:r},rotation:i}=this.parent.viewport;return lc.process(e,t,r,i,Ca._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:r,pageHeight:i},rotation:a}=this.parent.viewport;return lc.extractContoursFromText(e,t,r,i,a,Ca._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:r},rotation:i}=this.parent.viewport;return lc.processDrawnLines({lines:e,pageWidth:t,pageHeight:r,rotation:i,innerMargin:Ca._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Ca.getDefaultDrawingOptions():(this._drawingOptions=Ca._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:r,rect:i}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":a}}=this,o={annotationType:Nt.SIGNATURE,isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:a,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?(o.paths={lines:t,points:r},o.uuid=this.#r,o.isCopy=!0):o.lines=t,this.#t&&(o.accessibilityData={type:"Figure",alt:this.#t}),o}static deserializeDraw(e,t,r,i,a,o){return o.areContours?E_.deserialize(e,t,r,i,a,o):Yd.deserialize(e,t,r,i,a,o)}static async deserialize(e,t,r){const i=await super.deserialize(e,t,r);return i.#e=e.areContours,i.#t=e.accessibilityData?.alt||"",i.#r=e.uuid,i}}class hk extends vt{#e=null;#t=null;#n=null;#r=null;#s=null;#i="";#l=null;#o=!1;#f=null;#c=!1;#h=!1;static _type="stamp";static _editorType=Nt.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#r=e.bitmapUrl,this.#s=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){vt.initialize(e,t)}static isHandlingMimeForPasting(e){return _g.includes(e)}static paste(e,t){t.pasteEditor({mode:Nt.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#u(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#c=e.isSvg),e.file&&(this.#i=e.file.name),this.#p()}#d(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:o}=e||this.copyCanvas(null,null,!0).imageData,c=await r.guess({name:"altText",request:{data:i,width:a,height:o,channels:i.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const f=c.output;return await this.setGuessedAltText(f),t&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}#a(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(r=>this.#u(r,!0)).finally(()=>this.#d());return}if(this.#r){const r=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(r).then(i=>this.#u(i)).finally(()=>this.#d());return}if(this.#s){const r=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(r).then(i=>this.#u(i)).finally(()=>this.#d());return}const e=document.createElement("input");e.type="file",e.accept=_g.join(",");const t=this._uiManager._signal;this.#n=new Promise(r=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(i)}r()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),r()},{signal:t})}).finally(()=>this.#d()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#f&&(clearTimeout(this.#f),this.#f=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#a();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#a(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#r||this.#s||this.#t||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),this.#o||(this.#e?this.#p():this.#a()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:r,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(this.#t=r,i&&(this.#e=i),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#f!==null&&clearTimeout(this.#f);const e=200;this.#f=setTimeout(()=>{this.#f=null,this.#g()},e)}#p(){const{div:e}=this;let{width:t,height:r}=this.#e;const[i,a]=this.pageDimensions,o=.75;if(this.width)t=this.width*i,r=this.height*a;else if(t>o*i||r>o*a){const d=Math.min(o*i/t,o*a/r);t*=d,r*=d}const[c,f]=this.parentDimensions;this.setDims(t*c/i,r*f/a),this._uiManager.enableWaiting(!1);const h=this.#l=document.createElement("canvas");h.setAttribute("role","img"),this.addContainer(h),this.width=t/i,this.height=r/a,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&this.div.setAttribute("aria-description",this.#i)}copyCanvas(e,t,r=!1){e||(e=224);const{width:i,height:a}=this.#e,o=new ea;let c=this.#e,f=i,h=a,d=null;if(t){if(i>t||a>t){const I=Math.min(t/i,t/a);f=Math.floor(i*I),h=Math.floor(a*I)}d=document.createElement("canvas");const m=d.width=Math.ceil(f*o.sx),v=d.height=Math.ceil(h*o.sy);this.#c||(c=this.#m(m,v));const y=d.getContext("2d");y.filter=this._uiManager.hcmFilter;let b="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(b="#8f8f9d",A="#42414d");const w=15,C=w*o.sx,T=w*o.sy,R=new OffscreenCanvas(C*2,T*2),N=R.getContext("2d");N.fillStyle=b,N.fillRect(0,0,C*2,T*2),N.fillStyle=A,N.fillRect(0,0,C,T),N.fillRect(C,T,C,T),y.fillStyle=y.createPattern(R,"repeat"),y.fillRect(0,0,m,v),y.drawImage(c,0,0,c.width,c.height,0,0,m,v)}let g=null;if(r){let m,v;if(o.symmetric&&c.width<e&&c.height<e)m=c.width,v=c.height;else if(c=this.#e,i>e||a>e){const A=Math.min(e/i,e/a);m=Math.floor(i*A),v=Math.floor(a*A),this.#c||(c=this.#m(m,v))}const b=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});b.drawImage(c,0,0,c.width,c.height,0,0,m,v),g={width:m,height:v,data:b.getImageData(0,0,m,v).data}}return{canvas:d,width:f,height:h,imageData:g}}#m(e,t){const{width:r,height:i}=this.#e;let a=r,o=i,c=this.#e;for(;a>2*e||o>2*t;){const f=a,h=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(a,o);d.getContext("2d").drawImage(c,0,0,f,h,0,0,a,o),c=d.transferToImageBitmap()}return c}#g(){const[e,t]=this.parentDimensions,{width:r,height:i}=this,a=new ea,o=Math.ceil(r*e*a.sx),c=Math.ceil(i*t*a.sy),f=this.#l;if(!f||f.width===o&&f.height===c)return;f.width=o,f.height=c;const h=this.#c?this.#e:this.#m(o,c),d=f.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,o,c)}#v(e){if(e){if(this.#c){const i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#c){const[t,r]=this.pageDimensions,i=Math.round(this.width*t*bc.PDF_TO_CSS_UNITS),a=Math.round(this.height*r*bc.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,a);return o.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,a),o.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,r){let i=null,a=!1;if(e instanceof mT){const{data:{rect:b,rotation:A,id:w,structParent:C,popupRef:T},container:R,parent:{page:{pageNumber:N}},canvas:I}=e;let D,B;I?(delete e.canvas,{id:D,bitmap:B}=r.imageManager.getFromCanvas(R.id,I),I.remove()):(a=!0,e._hasNoCanvas=!0);const U=(await t._structTree.getAriaAttributes(`${lx}${w}`))?.get("aria-label")||"";i=e={annotationType:Nt.STAMP,bitmapId:D,bitmap:B,pageIndex:N-1,rect:b.slice(0),rotation:A,id:w,deleted:!1,accessibilityData:{decorative:!1,altText:U},isSvg:!1,structParent:C,popupRef:T}}const o=await super.deserialize(e,t,r),{rect:c,bitmap:f,bitmapUrl:h,bitmapId:d,isSvg:g,accessibilityData:m}=e;a?(r.addMissingCanvas(e.id,o),o.#o=!0):d&&r.imageManager.isValidId(d)?(o.#t=d,f&&(o.#e=f)):o.#r=h,o.#c=g;const[v,y]=o.pageDimensions;return o.width=(c[2]-c[0])/v,o.height=(c[3]-c[1])/y,o.annotationElementId=e.id||null,m&&(o.altTextData=m),o._initialData=i,o.#h=!!i,o}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r={annotationType:Nt.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(e)return r.bitmapUrl=this.#v(!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(r.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=this.#_(r);if(c.isSame)return null;c.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,t===null)return r;t.stamps||=new Map;const o=this.#c?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:o,serialized:r}),r.bitmap=this.#v(!1);else if(this.#c){const c=t.stamps.get(this.#t);o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=this.#v(!1))}return r}#_(e){const{pageIndex:t,accessibilityData:{altText:r}}=this._initialData,i=e.pageIndex===t,a=(e.accessibilityData?.alt||"")===r;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class Oa{#e;#t=!1;#n=null;#r=null;#s=null;#i=new Map;#l=!1;#o=!1;#f=!1;#c=null;#h=null;#u=null;#d=null;#a;static _initialized=!1;static#p=new Map([gr,Ax,hk,Wn,Ca].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:i,accessibilityManager:a,annotationLayer:o,drawLayer:c,textLayer:f,viewport:h,l10n:d}){const g=[...Oa.#p.values()];if(!Oa._initialized){Oa._initialized=!0;for(const m of g)m.initialize(d,e)}e.registerEditorTypes(g),this.#a=e,this.pageIndex=t,this.div=r,this.#e=a,this.#n=o,this.viewport=h,this.#u=f,this.drawLayer=c,this._structTree=i,this.#a.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===Nt.NONE}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#x(),e){case Nt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Nt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Nt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const r of Oa.#p.values())t.toggle(`${r._type}Editing`,e===r._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}cleanUndoStack(e){this.#a.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}async enable(){this.#f=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const r of this.#i.values())r.enableEditing(),r.show(!0),r.annotationElementId&&(this.#a.removeChangedExistingAnnotation(r),e.add(r.annotationElementId));if(!this.#n){this.#f=!1;return}const t=this.#n.getEditableAnnotations();for(const r of t){if(r.hide(),this.#a.isDeletedAnnotationElement(r.data.id)||e.has(r.data.id))continue;const i=await this.deserialize(r);i&&(this.addOrRebuild(i),i.enableEditing())}this.#f=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const i of this.#i.values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()}if(this.#n){const i=this.#n.getEditableAnnotations();for(const a of i){const{id:o}=a.data;if(this.#a.isDeletedAnnotationElement(o))continue;let c=t.get(o);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=e.get(o),c&&(this.#a.addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const i of Oa.#p.values())r.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#d){this.#d=new AbortController;const e=this.#a.combinedSignal(this.#d);this.#u.div.addEventListener("pointerdown",this.#m.bind(this),{signal:e}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#u.div.classList.remove("highlighting"))}#m(e){this.#a.unselectAll();const{target:t}=e;if(t===this.#u.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#u.div.contains(t)){const{isMac:r}=Ar.platform;if(e.button!==0||e.ctrlKey&&r)return;this.#a.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Wn.startHighlighting(this,this.#a.direction==="ltr",{target:this.#u.div,x:e.x,y:e.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),e.preventDefault()}}enableClick(){if(this.#r)return;this.#r=new AbortController;const e=this.#a.combinedSignal(this.#r);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#r?.abort(),this.#r=null}attach(e){this.#i.set(e.id,e);const{annotationElementId:t}=e;t&&this.#a.isDeletedAnnotationElement(t)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#i.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),vt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#f),this.#a.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#s&&(e._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getNextId(){return this.#a.getId()}get#g(){return Oa.#p.get(this.#a.getMode())}combinedSignal(e){return this.#a.combinedSignal(e)}#v(e){const t=this.#g;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#g?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#a.updateMode(e.mode);const{offsetX:r,offsetY:i}=this.#_(),a=this.getNextId(),o=this.#v({parent:this,id:a,x:r,y:i,uiManager:this.#a,isCentered:!0,...t});o&&this.add(o)}async deserialize(e){return await Oa.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}createAndAddNewEditor(e,t,r={}){const i=this.getNextId(),a=this.#v({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:t,...r});return a&&this.add(a),a}#_(){const{x:e,y:t,width:r,height:i}=this.div.getBoundingClientRect(),a=Math.max(0,e),o=Math.max(0,t),c=Math.min(window.innerWidth,e+r),f=Math.min(window.innerHeight,t+i),h=(a+c)/2-e,d=(o+f)/2-t,[g,m]=this.viewport.rotation%180===0?[h,d]:[d,h];return{offsetX:g,offsetY:m}}addNewEditor(e={}){this.createAndAddNewEditor(this.#_(),!0,e)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}unselect(e){this.#a.unselect(e)}pointerup(e){const{isMac:t}=Ar.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#l||(this.#l=!1,this.#g?.isDrawer&&this.#g.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const r=this.#a.getMode();if(r===Nt.STAMP||r===Nt.SIGNATURE){this.#a.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#a.getMode()===Nt.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:t}=Ar.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#l=!0,this.#g?.isDrawer){this.startDrawingSession(e);return}const r=this.#a.getActive();this.#t=!r||r.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#c){this.#g.startDrawing(this,this.#a,!1,e);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const t=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#g.startDrawing(this,this.#a,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#h=null,this.#g.endDrawing(e)):null}findNewParent(e,t,r){const i=this.#a.findParent(t,r);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#g.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const e of this.#i.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#i.clear(),this.#a.removeLayer(this)}#x(){for(const e of this.#i.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,bl(this.div,e);for(const t of this.#a.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#a.commitOrRemove(),this.#x();const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,bl(this.div,{rotation:r}),t!==r)for(const i of this.#i.values())i.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#a.viewParameters.realScale}}class br{#e=null;#t=new Map;#n=new Map;static#r=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Vt(this,"_svgFactory",new xd)}static#s(e,[t,r,i,a]){const{style:o}=e;o.top=`${100*r}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*a}%`}#i(){const e=br._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#l(e,t){const r=br._svgFactory.createElement("clipPath");e.append(r);const i=`clip_${t}`;r.setAttribute("id",i),r.setAttribute("clipPathUnits","objectBoundingBox");const a=br._svgFactory.createElement("use");return r.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),i}#o(e,t){for(const[r,i]of Object.entries(t))i===null?e.removeAttribute(r):e.setAttribute(r,i)}draw(e,t=!1,r=!1){const i=br.#r++,a=this.#i(),o=br._svgFactory.createElement("defs");a.append(o);const c=br._svgFactory.createElement("path");o.append(c);const f=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",f),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(i,c);const h=r?this.#l(o,f):null,d=br._svgFactory.createElement("use");return a.append(d),d.setAttribute("href",`#${f}`),this.updateProperties(a,e),this.#t.set(i,a),{id:i,clipPathId:`url(#${h})`}}drawOutline(e,t){const r=br.#r++,i=this.#i(),a=br._svgFactory.createElement("defs");i.append(a);const o=br._svgFactory.createElement("path");a.append(o);const c=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke");let f;if(t){const g=br._svgFactory.createElement("mask");a.append(g),f=`mask_p${this.pageIndex}_${r}`,g.setAttribute("id",f),g.setAttribute("maskUnits","objectBoundingBox");const m=br._svgFactory.createElement("rect");g.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const v=br._svgFactory.createElement("use");g.append(v),v.setAttribute("href",`#${c}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const h=br._svgFactory.createElement("use");i.append(h),h.setAttribute("href",`#${c}`),f&&h.setAttribute("mask",`url(#${f})`);const d=h.cloneNode();return i.append(d),h.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),this.#t.set(r,i),r}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:r,bbox:i,rootClass:a,path:o}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(r&&this.#o(c,r),i&&br.#s(c,i),a){const{classList:f}=c;for(const[h,d]of Object.entries(a))f.toggle(h,d)}if(o){const h=c.firstChild.firstChild;this.#o(h,o)}}}updateParent(e,t){if(t===this)return;const r=this.#t.get(e);r&&(t.#e.append(r),this.#t.delete(e),t.#t.set(e,r))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:y_};globalThis.pdfjsLib={AbortException:Co,AnnotationEditorLayer:Oa,AnnotationEditorParamsType:Wt,AnnotationEditorType:Nt,AnnotationEditorUIManager:Do,AnnotationLayer:Ex,AnnotationMode:La,AnnotationType:Vn,build:uT,ColorPicker:Zi,createValidAbsoluteUrl:sx,DOMSVGFactory:xd,DrawLayer:br,FeatureTest:Ar,fetchData:df,getDocument:vx,getFilenameFromUrl:j2,getPdfFilenameFromUrl:$2,getUuid:ox,getXfaPageViewport:G2,GlobalWorkerOptions:gl,ImageKind:id,InvalidPDFException:vg,isDataScheme:$d,isPdfFile:om,isValidExplicitDest:Y2,MathClamp:Xr,noContextMenu:ks,normalizeUnicode:H2,OPS:gd,OutputScale:ea,PasswordResponses:B2,PDFDataRangeTransport:xx,PDFDateString:cx,PDFWorker:tf,PermissionFlag:P2,PixelsPerInch:bc,RenderingCancelledException:am,ResponseException:md,setLayerDimensions:bl,shadow:Vt,SignatureExtractor:lc,stopEvent:Xn,SupportedImageMimeTypes:_g,TextLayer:vd,TouchManager:Vd,updateUrlHash:ax,Util:dt,VerbosityLevel:Hd,version:cT,XfaLayer:yx};const dk=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Co,AnnotationEditorLayer:Oa,AnnotationEditorParamsType:Wt,AnnotationEditorType:Nt,AnnotationEditorUIManager:Do,AnnotationLayer:Ex,AnnotationMode:La,AnnotationType:Vn,ColorPicker:Zi,DOMSVGFactory:xd,DrawLayer:br,FeatureTest:Ar,GlobalWorkerOptions:gl,ImageKind:id,InvalidPDFException:vg,MathClamp:Xr,OPS:gd,OutputScale:ea,PDFDataRangeTransport:xx,PDFDateString:cx,PDFWorker:tf,PasswordResponses:B2,PermissionFlag:P2,PixelsPerInch:bc,RenderingCancelledException:am,ResponseException:md,SignatureExtractor:lc,SupportedImageMimeTypes:_g,TextLayer:vd,TouchManager:Vd,Util:dt,VerbosityLevel:Hd,XfaLayer:yx,build:uT,createValidAbsoluteUrl:sx,fetchData:df,getDocument:vx,getFilenameFromUrl:j2,getPdfFilenameFromUrl:$2,getUuid:ox,getXfaPageViewport:G2,isDataScheme:$d,isPdfFile:om,isValidExplicitDest:Y2,noContextMenu:ks,normalizeUnicode:H2,setLayerDimensions:bl,shadow:Vt,stopEvent:Xn,updateUrlHash:ax,version:cT},Symbol.toStringTag,{value:"Module"})),pk=["onCopy","onCut","onPaste"],gk=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],mk=["onFocus","onBlur"],vk=["onInput","onInvalid","onReset","onSubmit"],_k=["onLoad","onError"],xk=["onKeyDown","onKeyPress","onKeyUp"],yk=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],bk=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],Ek=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],Ak=["onSelect"],wk=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],Sk=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],Tk=["onScroll"],Ck=["onWheel"],Dk=["onAnimationStart","onAnimationEnd","onAnimationIteration"],Ok=["onTransitionEnd"],Rk=["onToggle"],Nk=["onChange"],Lk=[...pk,...gk,...mk,...vk,..._k,...xk,...yk,...bk,...Ek,...Ak,...wk,...Sk,...Tk,...Ck,...Dk,...Ok,...Nk,...Rk];function yT(n,e){const t={};for(const r of Lk){const i=n[r];i&&(e?t[r]=a=>i(a,e(r)):t[r]=i)}return t}function qd(n){let e=!1;return{promise:new Promise((r,i)=>{n.then(a=>!e&&r(a)).catch(a=>!e&&i(a))}),cancel(){e=!0}}}function bT(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=bT(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function um(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=bT(n))&&(r&&(r+=" "),r+=e);return r}var Mk="Invariant failed";function xn(n,e){if(!n)throw new Error(Mk)}var Nv,WA;function Ik(){if(WA)return Nv;WA=1;var n=function(){};return Nv=n,Nv}var kk=Ik();const Qr=H_(kk);var XA=Object.prototype.hasOwnProperty;function YA(n,e,t){for(t of n.keys())if(Uu(t,e))return t}function Uu(n,e){var t,r,i;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((r=n.length)===e.length)for(;r--&&Uu(n[r],e[r]););return r===-1}if(t===Set){if(n.size!==e.size)return!1;for(r of n)if(i=r,i&&typeof i=="object"&&(i=YA(e,i),!i)||!e.has(i))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(r of n)if(i=r[0],i&&typeof i=="object"&&(i=YA(e,i),!i)||!Uu(r[1],e.get(i)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((r=n.byteLength)===e.byteLength)for(;r--&&n.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(n)){if((r=n.byteLength)===e.byteLength)for(;r--&&n[r]===e[r];);return r===-1}if(!t||typeof n=="object"){r=0;for(t in n)if(XA.call(n,t)&&++r&&!XA.call(e,t)||!(t in e)||!Uu(n[t],e[t]))return!1;return Object.keys(e).length===r}}return n!==n&&e!==e}const ET=le.createContext(null);function Hu({children:n,type:e}){return K.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:n})}const Fk="noopener noreferrer nofollow";class Pk{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return xn(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){xn(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{xn(this.pdfDocument),xn(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{xn(Array.isArray(t));const r=t[0];new Promise(i=>{xn(this.pdfDocument),r instanceof Object?this.pdfDocument.getPageIndex(r).then(a=>{i(a)}).catch(()=>{xn(!1)}):typeof r=="number"?i(r):xn(!1)}).then(i=>{const a=i+1;xn(this.pdfViewer),xn(a>=1&&a<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:i,pageNumber:a})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;xn(this.pdfViewer),xn(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,r){e.href=t,e.rel=this.externalLinkRel||Fk,e.target=r?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const qA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},fm=typeof window<"u",AT=fm&&window.location.protocol==="file:";function Bk(n){return typeof n<"u"}function ic(n){return Bk(n)&&n!==null}function Uk(n){return typeof n=="string"}function Hk(n){return n instanceof ArrayBuffer}function zk(n){return xn(fm),n instanceof Blob}function A_(n){return Uk(n)&&/^data:/.test(n)}function KA(n){xn(A_(n));const[e="",t=""]=n.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function jk(){return fm&&window.devicePixelRatio||1}const wT="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function QA(){Qr(!AT,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${wT}`)}function $k(){Qr(!AT,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${wT}`)}function Ac(n){n?.cancel&&n.cancel()}function w_(n,e){return Object.defineProperty(n,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function Gk(n){return n.name==="RenderingCancelledException"}function Vk(n){return new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{if(!r.result)return t(new Error("Error while reading a file."));e(r.result)},r.onerror=i=>{if(!i.target)return t(new Error("Error while reading a file."));const{error:a}=i.target;if(!a)return t(new Error("Error while reading a file."));switch(a.code){case a.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case a.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case a.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},r.readAsArrayBuffer(n)})}function Wk(n,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function nf(){return le.useReducer(Wk,{value:void 0,error:void 0})}var ZA=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const{PDFDataRangeTransport:Xk}=dk,Yk=(n,e)=>{switch(e){case qA.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");n(t);break}case qA.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");n(t);break}}};function JA(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const qk=le.forwardRef(function(e,t){var{children:r,className:i,error:a="Failed to load PDF file.",externalLinkRel:o,externalLinkTarget:c,file:f,inputRef:h,imageResourcesPath:d,loading:g="Loading PDF",noData:m="No PDF file specified.",onItemClick:v,onLoadError:y,onLoadProgress:b,onLoadSuccess:A,onPassword:w=Yk,onSourceError:C,onSourceSuccess:T,options:R,renderMode:N,rotate:I,scale:D}=e,B=ZA(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[U,Y]=nf(),{value:W,error:re}=U,[Te,Fe]=nf(),{value:we,error:q}=Te,ee=le.useRef(new Pk),Pe=le.useRef([]),qe=le.useRef(void 0),P=le.useRef(void 0);f&&f!==qe.current&&JA(f)&&(Qr(!Uu(f,qe.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),qe.current=f),R&&R!==P.current&&(Qr(!Uu(R,P.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),P.current=R);const ye=le.useRef({scrollPageIntoView:Se=>{const{dest:Ye,pageNumber:De,pageIndex:nt=De-1}=Se;if(v){v({dest:Ye,pageIndex:nt,pageNumber:De});return}const rt=Pe.current[nt];if(rt){rt.scrollIntoView();return}Qr(!1,`An internal link leading to page ${De} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});le.useImperativeHandle(t,()=>({linkService:ee,pages:Pe,viewer:ye}),[]);function ve(){T&&T()}function ge(){re&&(Qr(!1,re.toString()),C&&C(re))}function Ce(){Y({type:"RESET"})}le.useEffect(Ce,[f,Y]);const He=le.useCallback(async()=>{if(!f)return null;if(typeof f=="string")return A_(f)?{data:KA(f)}:(QA(),{url:f});if(f instanceof Xk)return{range:f};if(Hk(f))return{data:f};if(fm&&zk(f))return{data:await Vk(f)};if(xn(typeof f=="object"),xn(JA(f)),"url"in f&&typeof f.url=="string"){if(A_(f.url)){const{url:Se}=f,Ye=ZA(f,["url"]),De=KA(Se);return Object.assign({data:De},Ye)}QA()}return f},[f]);le.useEffect(()=>{const Se=qd(He());return Se.promise.then(Ye=>{Y({type:"RESOLVE",value:Ye})}).catch(Ye=>{Y({type:"REJECT",error:Ye})}),()=>{Ac(Se)}},[He,Y]),le.useEffect(()=>{if(!(typeof W>"u")){if(W===!1){ge();return}ve()}},[W]);function Ie(){we&&(A&&A(we),Pe.current=new Array(we.numPages),ee.current.setDocument(we))}function Ge(){q&&(Qr(!1,q.toString()),y&&y(q))}le.useEffect(function(){Fe({type:"RESET"})},[Fe,W]),le.useEffect(function(){if(!W)return;const Ye=R?Object.assign(Object.assign({},W),R):W,De=vx(Ye);b&&(De.onProgress=b),w&&(De.onPassword=w);const nt=De,rt=nt.promise.then(ht=>{Fe({type:"RESOLVE",value:ht})}).catch(ht=>{nt.destroyed||Fe({type:"REJECT",error:ht})});return()=>{rt.finally(()=>nt.destroy())}},[R,Fe,W]),le.useEffect(()=>{if(!(typeof we>"u")){if(we===!1){Ge();return}Ie()}},[we]),le.useEffect(function(){ee.current.setViewer(ye.current),ee.current.setExternalLinkRel(o),ee.current.setExternalLinkTarget(c)},[o,c]);const k=le.useCallback((Se,Ye)=>{Pe.current[Se]=Ye},[]),se=le.useCallback(Se=>{delete Pe.current[Se]},[]),Z=le.useMemo(()=>({imageResourcesPath:d,linkService:ee.current,onItemClick:v,pdf:we,registerPage:k,renderMode:N,rotate:I,scale:D,unregisterPage:se}),[d,v,we,k,N,I,D,se]),J=le.useMemo(()=>yT(B,()=>we),[B,we]);function xe(){return K.jsx(ET.Provider,{value:Z,children:r})}function be(){return f?we==null?K.jsx(Hu,{type:"loading",children:typeof g=="function"?g():g}):we===!1?K.jsx(Hu,{type:"error",children:typeof a=="function"?a():a}):xe():K.jsx(Hu,{type:"no-data",children:typeof m=="function"?m():m})}return K.jsx("div",Object.assign({className:um("react-pdf__Document",i),ref:h},J,{children:be()}))});function ST(){return le.useContext(ET)}function TT(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.filter(Boolean);if(t.length<=1){var r=t[0];return r||null}return function(a){for(var o=0,c=t;o<c.length;o++){var f=c[o];typeof f=="function"?f(a):f&&(f.current=a)}}}const CT=le.createContext(null),DT={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},Kk=/^H(\d+)$/;function Qk(n){return n in DT}function hm(n){return"children"in n}function OT(n){return hm(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function Zk(n){const e={};if(hm(n)){const{role:t}=n,r=t.match(Kk);if(r)e.role="heading",e["aria-level"]=Number(r[1]);else if(Qk(t)){const i=DT[t];i&&(e.role=i)}}return e}function RT(n){const e={};if(hm(n)){if(n.alt!==void 0&&(e["aria-label"]=n.alt),n.lang!==void 0&&(e.lang=n.lang),OT(n)){const[t]=n.children;if(t){const r=RT(t);return Object.assign(Object.assign({},e),r)}}}else"id"in n&&(e["aria-owns"]=n.id);return e}function Jk(n){return n?Object.assign(Object.assign({},Zk(n)),RT(n)):null}function NT({className:n,node:e}){const t=le.useMemo(()=>Jk(e),[e]),r=le.useMemo(()=>!hm(e)||OT(e)?null:e.children.map((i,a)=>K.jsx(NT,{node:i},a)),[e]);return K.jsx("span",Object.assign({className:n},t,{children:r}))}function dm(){return le.useContext(CT)}function eF(){const n=dm();xn(n);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=n,[r,i]=nf(),{value:a,error:o}=r,{customTextRenderer:c,page:f}=n;function h(){a&&t&&t(a)}function d(){o&&(Qr(!1,o.toString()),e&&e(o))}return le.useEffect(function(){i({type:"RESET"})},[i,f]),le.useEffect(function(){if(c||!f)return;const m=qd(f.getStructTree()),v=m;return m.promise.then(y=>{i({type:"RESOLVE",value:y})}).catch(y=>{i({type:"REJECT",error:y})}),()=>Ac(v)},[c,f,i]),le.useEffect(()=>{if(a!==void 0){if(a===!1){d();return}h()}},[a]),a?K.jsx(NT,{className:"react-pdf__Page__structTree structTree",node:a}):null}const ew=La;function tF(n){const e=dm();xn(e);const t=Object.assign(Object.assign({},e),n),{_className:r,canvasBackground:i,devicePixelRatio:a=jk(),onRenderError:o,onRenderSuccess:c,page:f,renderForms:h,renderTextLayer:d,rotate:g,scale:m}=t,{canvasRef:v}=n;xn(f);const y=le.useRef(null);function b(){f&&c&&c(w_(f,m))}function A(R){Gk(R)||(Qr(!1,R.toString()),o&&o(R))}const w=le.useMemo(()=>f.getViewport({scale:m*a,rotation:g}),[a,f,g,m]),C=le.useMemo(()=>f.getViewport({scale:m,rotation:g}),[f,g,m]);le.useEffect(function(){if(!f)return;f.cleanup();const{current:N}=y;if(!N)return;N.width=w.width,N.height=w.height,N.style.width=`${Math.floor(C.width)}px`,N.style.height=`${Math.floor(C.height)}px`,N.style.visibility="hidden";const I={annotationMode:h?ew.ENABLE_FORMS:ew.ENABLE,canvasContext:N.getContext("2d",{alpha:!1}),viewport:w};i&&(I.background=i);const D=f.render(I),B=D;return D.promise.then(()=>{N.style.visibility="",b()}).catch(A),()=>Ac(B)},[i,f,h,w,C]);const T=le.useCallback(()=>{const{current:R}=y;R&&(R.width=0,R.height=0)},[]);return le.useEffect(()=>T,[T]),K.jsx("canvas",{className:`${r}__canvas`,dir:"ltr",ref:TT(v,y),style:{display:"block",userSelect:"none"},children:d?K.jsx(eF,{}):null})}function nF(n){return"str"in n}function rF(){const n=dm();xn(n);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:r,onRenderTextLayerError:i,onRenderTextLayerSuccess:a,page:o,pageIndex:c,pageNumber:f,rotate:h,scale:d}=n;xn(o);const[g,m]=nf(),{value:v,error:y}=g,b=le.useRef(null);Qr(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function A(){v&&r&&r(v)}function w(){y&&(Qr(!1,y.toString()),t&&t(y))}le.useEffect(function(){m({type:"RESET"})},[o,m]),le.useEffect(function(){if(!o)return;const B=qd(o.getTextContent()),U=B;return B.promise.then(Y=>{m({type:"RESOLVE",value:Y})}).catch(Y=>{m({type:"REJECT",error:Y})}),()=>Ac(U)},[o,m]),le.useEffect(()=>{if(v!==void 0){if(v===!1){w();return}A()}},[v]);const C=le.useCallback(()=>{a&&a()},[a]),T=le.useCallback(D=>{Qr(!1,D.toString()),i&&i(D)},[i]);function R(){const D=b.current;D&&D.classList.add("selecting")}function N(){const D=b.current;D&&D.classList.remove("selecting")}const I=le.useMemo(()=>o.getViewport({scale:d,rotation:h}),[o,h,d]);return le.useLayoutEffect(function(){if(!o||!v)return;const{current:B}=b;if(!B)return;B.innerHTML="";const U=o.streamTextContent({includeMarkedContent:!0}),Y={container:B,textContentSource:U,viewport:I},W=new vd(Y),re=W;return W.render().then(()=>{const Te=document.createElement("div");Te.className="endOfContent",B.append(Te);const Fe=B.querySelectorAll('[role="presentation"]');if(e){let we=0;v.items.forEach((q,ee)=>{if(!nF(q))return;const Pe=Fe[we];if(!Pe)return;const qe=e(Object.assign({pageIndex:c,pageNumber:f,itemIndex:ee},q));Pe.innerHTML=qe,we+=q.str&&q.hasEOL?2:1})}C()}).catch(T),()=>Ac(re)},[e,T,C,o,c,f,v,I]),K.jsx("div",{className:um("react-pdf__Page__textContent","textLayer"),onMouseUp:N,onMouseDown:R,ref:b})}function iF(){const n=ST(),e=dm();xn(e);const t=Object.assign(Object.assign({},n),e),{imageResourcesPath:r,linkService:i,onGetAnnotationsError:a,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:c,onRenderAnnotationLayerSuccess:f,page:h,pdf:d,renderForms:g,rotate:m,scale:v=1}=t;xn(d),xn(h),xn(i);const[y,b]=nf(),{value:A,error:w}=y,C=le.useRef(null);Qr(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function T(){A&&o&&o(A)}function R(){w&&(Qr(!1,w.toString()),a&&a(w))}le.useEffect(function(){b({type:"RESET"})},[b,h]),le.useEffect(function(){if(!h)return;const U=qd(h.getAnnotations()),Y=U;return U.promise.then(W=>{b({type:"RESOLVE",value:W})}).catch(W=>{b({type:"REJECT",error:W})}),()=>{Ac(Y)}},[b,h]),le.useEffect(()=>{if(A!==void 0){if(A===!1){R();return}T()}},[A]);function N(){f&&f()}function I(B){Qr(!1,`${B}`),c&&c(B)}const D=le.useMemo(()=>h.getViewport({scale:v,rotation:m}),[h,m,v]);return le.useEffect(function(){if(!d||!h||!i||!A)return;const{current:U}=C;if(!U)return;const Y=D.clone({dontFlip:!0}),W={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:U,l10n:null,page:h,structTreeLayer:null,viewport:Y},re={annotations:A,annotationStorage:d.annotationStorage,div:U,imageResourcesPath:r,linkService:i,page:h,renderForms:g,viewport:Y};U.innerHTML="";try{new Ex(W).render(re),N()}catch(Te){I(Te)}return()=>{}},[A,r,i,h,d,g,D]),K.jsx("div",{className:um("react-pdf__Page__annotations","annotationLayer"),ref:C})}var sF=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const tw=1;function aF(n){const e=ST(),t=Object.assign(Object.assign({},e),n),{_className:r="react-pdf__Page",_enableRegisterUnregisterPage:i=!0,canvasBackground:a,canvasRef:o,children:c,className:f,customRenderer:h,customTextRenderer:d,devicePixelRatio:g,error:m="Failed to load the page.",height:v,inputRef:y,loading:b="Loading page",noData:A="No page specified.",onGetAnnotationsError:w,onGetAnnotationsSuccess:C,onGetStructTreeError:T,onGetStructTreeSuccess:R,onGetTextError:N,onGetTextSuccess:I,onLoadError:D,onLoadSuccess:B,onRenderAnnotationLayerError:U,onRenderAnnotationLayerSuccess:Y,onRenderError:W,onRenderSuccess:re,onRenderTextLayerError:Te,onRenderTextLayerSuccess:Fe,pageIndex:we,pageNumber:q,pdf:ee,registerPage:Pe,renderAnnotationLayer:qe=!0,renderForms:P=!1,renderMode:ye="canvas",renderTextLayer:ve=!0,rotate:ge,scale:Ce=tw,unregisterPage:He,width:Ie}=t,Ge=sF(t,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[k,se]=nf(),{value:Z,error:J}=k,xe=le.useRef(null);xn(ee);const be=ic(q)?q-1:we??null,Se=q??(ic(we)?we+1:null),Ye=ge??(Z?Z.rotate:null),De=le.useMemo(()=>{if(!Z)return null;let zt=1;const It=Ce??tw;if(Ie||v){const on=Z.getViewport({scale:1,rotation:Ye});Ie?zt=Ie/on.width:v&&(zt=v/on.height)}return It*zt},[v,Z,Ye,Ce,Ie]);le.useEffect(function(){return()=>{ic(be)&&i&&He&&He(be)}},[i,ee,be,He]);function nt(){if(B){if(!Z||!De)return;B(w_(Z,De))}if(i&&Pe){if(!ic(be)||!xe.current)return;Pe(be,xe.current)}}function rt(){J&&(Qr(!1,J.toString()),D&&D(J))}le.useEffect(function(){se({type:"RESET"})},[se,ee,be]),le.useEffect(function(){if(!ee||!Se)return;const It=qd(ee.getPage(Se)),on=It;return It.promise.then(Kn=>{se({type:"RESOLVE",value:Kn})}).catch(Kn=>{se({type:"REJECT",error:Kn})}),()=>Ac(on)},[se,ee,Se]),le.useEffect(()=>{if(Z!==void 0){if(Z===!1){rt();return}nt()}},[Z,De]);const ht=le.useMemo(()=>Z&&ic(be)&&Se&&ic(Ye)&&ic(De)?{_className:r,canvasBackground:a,customTextRenderer:d,devicePixelRatio:g,onGetAnnotationsError:w,onGetAnnotationsSuccess:C,onGetStructTreeError:T,onGetStructTreeSuccess:R,onGetTextError:N,onGetTextSuccess:I,onRenderAnnotationLayerError:U,onRenderAnnotationLayerSuccess:Y,onRenderError:W,onRenderSuccess:re,onRenderTextLayerError:Te,onRenderTextLayerSuccess:Fe,page:Z,pageIndex:be,pageNumber:Se,renderForms:P,renderTextLayer:ve,rotate:Ye,scale:De}:null,[r,a,d,g,w,C,T,R,N,I,U,Y,W,re,Te,Fe,Z,be,Se,P,ve,Ye,De]),Rt=le.useMemo(()=>yT(Ge,()=>Z&&(De?w_(Z,De):void 0)),[Ge,Z,De]),kt=`${be}@${De}/${Ye}`;function nn(){switch(ye){case"custom":return xn(h),K.jsx(h,{},`${kt}_custom`);case"none":return null;case"canvas":default:return K.jsx(tF,{canvasRef:o},`${kt}_canvas`)}}function Qe(){return ve?K.jsx(rF,{},`${kt}_text`):null}function Ct(){return qe?K.jsx(iF,{},`${kt}_annotations`):null}function je(){return K.jsxs(CT.Provider,{value:ht,children:[nn(),Qe(),Ct(),c]})}function Tn(){return Se?ee===null||Z===void 0||Z===null?K.jsx(Hu,{type:"loading",children:typeof b=="function"?b():b}):ee===!1||Z===!1?K.jsx(Hu,{type:"error",children:typeof m=="function"?m():m}):je():K.jsx(Hu,{type:"no-data",children:typeof A=="function"?A():A})}return K.jsx("div",Object.assign({className:um(r,f),"data-page-number":Se,ref:TT(y,xe),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${De}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:a||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Rt,{children:Tn()}))}$k();gl.workerSrc="pdf.worker.mjs";const Xp=5,oF=(n,e,t,r)=>({x:n.x*t/e,width:n.width*t/e,y:r.height-n.y*t/e-n.height*t/e,height:n.height*t/e}),lF=(n,e)=>n.items.filter(t=>{const r=t.transform[4],i=t.transform[5],a=t.transform[4]+t.width,o=t.transform[5]+t.height;return r>=e.x-Xp&&a<=e.x+e.width+Xp&&i>=e.y-Xp&&o<=e.y+e.height+Xp}),cF=n=>{console.log("items: ",n);const e=n.filter(c=>{const f=c.str.trim();return xg(f)||f==="-"});if(e.length===0)return[];const t=e.filter(c=>xg(c.str.trim()));if(t.length<2)return e.map(c=>c.str.trim());const r=[];for(let c=0;c+1<t.length;c++)r.push(Math.abs(t[c].transform[5]-t[c+1].transform[5]));r.sort((c,f)=>c-f),console.log(r);const i=t.length<4?t[0].height*1.2:r[r.length-1]-r[0]<=r[0]*1.2?0:r[0]*1.1,a=[],o=[];return e.forEach((c,f)=>{if(o.length>0){o.push(c.str.trim()),a.push(o.join("/")),o.length=0;return}if(c.str.trim()==="-"){a.push(c.str.trim());return}if(f+1<e.length&&Math.abs(c.transform[5]-e[f+1].transform[5])<=i){o.push(c.str.trim());return}a.push(c.str.trim())}),o.length>0&&a.push(o.join("/")),a},uF=(n,e)=>{const t=Array(),r=Array();let i=!1;return n.forEach((a,o)=>{if(a.str.trim()=="")return;const c=a.height*1.5;if(i){t.push(a.str.trim());const f=t.join("/");r.push(f),t.length=0,i=!1;return}if(o<n.length-1){const f={x:a.transform[4]+a.width/5,y:a.transform[5]-a.height/2,width:a.width*.6,height:Math.min(Math.abs(a.transform[5]-n[o+1].transform[5]),a.height/2)},h={x:a.transform[4]+a.width/5,width:a.width*(3/5),y:a.transform[5]-a.height,height:a.height};if(Math.abs(a.transform[5]-n[o+1].transform[5])<=c&&!nw(f,e))t.push(a.str.trim());else if(nw(h,e,!0)&&xg(a.str.trim())&&fF(n,o)&&Math.abs(a.transform[5]-n[o+1].transform[5])<=c&&t.length<1)t.push(a.str.trim()),i=!0;else if(t.length>0){t.push(a.str.trim());const d=t.join(" ");r.push(d),t.length=0}else r.push(a.str.trim())}else{t.push(a.str.trim());const f=t.join(" ");r.push(f),t.length=0}}),t.length>0&&r.push(t.join(" ")),r},Lv=(n,e,t)=>Math.max(Math.min(n,t),e),nw=(n,e,t=!1)=>{const r=n.x,i=n.x+n.width,a=n.y,o=n.y+n.height;return e.some(c=>c.x1<=i&&c.x2>=r&&c.y>=a&&c.y<=o&&(Math.abs(c.x2-c.x1)<=15||!t))},xg=n=>/^\d+(\.\d+)?$/.test(n.trim()),fF=(n,e)=>{for(let t=e+1;t<n.length;t++){const r=n[t].str.trim();if(r.trim())return xg(r)}return!1},hF=({areas:n,zoomScale:e,activeAreaId:t})=>K.jsx(K.Fragment,{children:n.map(r=>!r.coordinates||r.id===t?null:K.jsx("div",{className:"position-absolute border",style:{left:r.coordinates.x*e,top:r.coordinates.y*e,width:r.coordinates.width*e,height:r.coordinates.height*e,backgroundColor:`${r.color}20`,borderColor:r.color,borderWidth:"2px",zIndex:10},title:r.name},`selected-${r.id}`))});/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pF=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),rw=n=>{const e=pF(n);return e.charAt(0).toUpperCase()+e.slice(1)},LT=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),gF=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var mF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=le.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:a,iconNode:o,...c},f)=>le.createElement("svg",{ref:f,...mF,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:LT("lucide",i),...!a&&!gF(c)&&{"aria-hidden":"true"},...c},[...o.map(([h,d])=>le.createElement(h,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=(n,e)=>{const t=le.forwardRef(({className:r,...i},a)=>le.createElement(vF,{ref:a,iconNode:e,className:LT(`lucide-${dF(rw(n))}`,`lucide-${n}`,r),...i}));return t.displayName=rw(n),t};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],xF=vr("badge-alert",_F);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],bF=vr("check",yF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],AF=vr("chevron-down",EF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],SF=vr("chevron-left",wF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],CF=vr("chevron-right",TF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],OF=vr("chevron-up",DF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],NF=vr("circle-question-mark",RF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ad=vr("download",LF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],IF=vr("eraser",MF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],FF=vr("folder",kF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],BF=vr("play",PF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],HF=vr("plus",UF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],jF=vr("save",zF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=[["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 14v1",key:"169vum"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M7 16h6",key:"1vyc9m"}],["path",{d:"M7 8h8",key:"1jbsf9"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M9 3h1",key:"1yesri"}]],GF=vr("text-select",$F);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],WF=vr("trash-2",VF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],YF=vr("trash",XF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Tx=vr("x",qF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],QF=vr("zoom-in",KF);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],JF=vr("zoom-out",ZF);gl.workerSrc=new URL("/extrator-dados-PDF/assets/pdf.worker.min-BFAMBS4k.mjs",import.meta.url).toString();const Mv=.5,Iv=3,eP=le.forwardRef(({file:n,isSelectingActive:e,activeAreaId:t,onFinishSelection:r,areas:i},a)=>{const o=le.useRef(null),[c,f]=le.useState(),[h,d]=le.useState(1),[g,m]=le.useState(!1),[v,y]=le.useState(h),[b,A]=le.useState(!1),[w,C]=le.useState(null),[T,R]=le.useState(null),N=le.useRef(null),I=le.useRef(null),[D,B]=le.useState(1),[U,Y]=le.useState(null),W=()=>{B(be=>Math.min(be+.25,Iv)),xe(0,0)},re=()=>{xe(0,0),B(be=>Math.max(be-.25,Mv))},[Te,Fe]=le.useState({x:0,y:0}),[we,q]=le.useState(null),[ee,Pe]=le.useState(!1);function qe(be){d(Se=>Se+be)}function P(){qe(-1)}function ye(){qe(1)}const ve=()=>{y(h),m(!0)},ge=()=>{v>=1&&v<=(c||1)&&d(v),m(!1)},Ce=()=>{y(h),m(!1)},He=be=>{be.key==="Enter"&&ge(),be.key==="Escape"&&Ce()};le.useEffect(()=>{g&&N.current&&(N.current.focus(),N.current.select())},[g]);const Ie=be=>{if(I.current){if(b&&T&&T.x>=10&&T.y>=10)A(!1),R(null),r(T);else if(!b){const Se=I.current.getBoundingClientRect(),Ye=(be.clientX-Se.left)/D,De=(be.clientY-Se.top)/D;C({x:Ye,y:De}),A(!0),R(null)}}},Ge=be=>{if(!I.current)return;const Se=I.current.getBoundingClientRect();q({x:be.clientX-Se.left,y:be.clientY-Se.top}),Pe(!0)},k=le.useCallback(be=>{I.current&&(be.currentTarget.setPointerCapture(be.pointerId),e?Ie(be):Ge(be))},[b,T,D,e]),se=le.useCallback(be=>{if(!I.current)return;const Se=I.current.getBoundingClientRect();if(ee){if(ee&&we){const rt=be.clientX-Se.left-we.x,ht=be.clientY-Se.top-we.y;xe(rt,ht)}return}if(!b||!w)return;const Ye=(be.clientX-Se.left)/D,De=(be.clientY-Se.top)/D,nt={x:Math.min(w.x,Ye),y:Math.min(w.y,De),width:Math.abs(w.x-Ye),height:Math.abs(w.y-De)};R(nt)},[b,w,ee,we]),Z=le.useCallback(be=>{be.currentTarget.releasePointerCapture(be.pointerId),ee&&Pe(!1)},[ee,Ge]);le.useEffect(()=>{e||J()},[e]);const J=()=>{A(!1),R(null),C(null)},xe=le.useCallback((be,Se)=>{const Ye=document.querySelector(".pdf-container"),De=Ye?.getBoundingClientRect().width||600,nt=Ye?parseInt(getComputedStyle(Ye).height):800,rt=I.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().width||De,ht=I.current?.querySelector(".react-pdf__Page")?.getBoundingClientRect().height||nt,Rt=document.querySelector(".pdf-nav")?.getBoundingClientRect().height||40,kt=rt>=De,nn=ht>=nt-Rt,Qe=Math.max(0,rt-De),Ct=Math.max(0,ht-nt+Rt);Fe(je=>({x:kt?Lv(je.x+be,-Qe,0):0,y:nn?Lv(je.y+Se,-Ct,0):0}))},[]);return le.useEffect(()=>{if(!n)return;const be=document.querySelector(".pdf-container");if(!be)return;const Se=Ye=>{Ye.preventDefault();const De=be.getBoundingClientRect(),nt=(Ye.clientX-De.left)/De.width,rt=(Ye.clientY-De.top)/De.height,ht=.1;B(Rt=>{const kt=Ye.deltaY>0?-ht:ht,nn=Lv(Rt+kt,Mv,Iv),Qe=I.current?.querySelector(".react-pdf__Page"),Ct=Qe?.getBoundingClientRect().width||0,je=Qe?.getBoundingClientRect().height||0,Tn=nn-Rt,zt=Ct*Tn,It=je*Tn,on=zt*nt,Kn=It*rt;return Y({x:-on,y:-Kn}),nn})};return be.addEventListener("wheel",Se,{passive:!1}),()=>{be.removeEventListener("wheel",Se)}},[n,D]),le.useEffect(()=>{U&&(xe(U.x,U.y),Y(null))},[D]),le.useImperativeHandle(a,()=>({getDocument:()=>o.current})),n?K.jsx(K.Fragment,{children:K.jsxs("div",{className:"pdf-container",style:{height:"min(800px, 90vh)",overflow:"hidden",position:"relative",border:"2px solid black",marginTop:"30px",marginBottom:"15px"},children:[K.jsxs("div",{ref:I,className:`position-relative d-inline-block ${e?"pdf-cursor-crosshair":ee?"pdf-cursor-grabbing":"pdf-cursor-grab"}`,onPointerDown:k,onPointerMove:se,onPointerUp:Z,style:{userSelect:"none",transform:`translate(${Te.x}px, ${Te.y}px)`},children:[K.jsx(qk,{file:n,onLoadSuccess:be=>{f(be.numPages),d(1),B(1),o.current=be},children:K.jsx(aF,{pageNumber:h,renderTextLayer:!1,renderAnnotationLayer:!1,scale:D})}),K.jsx(hF,{areas:i,zoomScale:D,activeAreaId:t}),T&&K.jsx("div",{className:"position-absolute border border-secondary",style:{left:T.x*D,top:T.y*D,width:T.width*D,height:T.height*D,backgroundColor:"rgba(134, 142, 135, 0.2)",zIndex:10}})]}),K.jsxs("div",{className:"pdf-nav position-absolute bottom-0 start-0 end-0 d-flex align-items-center",style:{backgroundColor:"rgba(0, 0, 0, 0.7)",backdropFilter:"blur(4px)",padding:"4px 12px"},children:[K.jsx("div",{className:"flex-grow-1 d-flex justify-content-center",children:g?K.jsxs("div",{className:"d-flex align-items-center gap-1",children:[K.jsx("input",{ref:N,type:"number",className:"form-control form-control-sm text-center",style:{width:"40px",fontSize:"12px",backgroundColor:"rgba(108, 108, 108, 0.8)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"2px",color:"white"},value:v,min:1,max:c||1,onChange:be=>y(parseInt(be.target.value)||1),onKeyDown:He,onBlur:Ce,autoFocus:!0}),K.jsxs("span",{className:"text-white small",children:["de ",c||1]})]}):K.jsxs("span",{onClick:ve,className:"text-white small",title:"Selecionar pgina",style:{cursor:"pointer"},children:["Pgina ",h||1," ",c&&`de ${c}`]})}),K.jsxs("div",{className:"d-flex gap-1",children:[K.jsx("button",{className:"pdf-nav-button",title:"Pgina anterior",onClick:P,disabled:h<=1,children:K.jsx(SF,{size:24,color:"#d0d0d0"})}),K.jsx("button",{className:"pdf-nav-button",title:"Prxima pgina",onClick:ye,disabled:h>=(c??0),children:K.jsx(CF,{size:24,color:"#d0d0d0"})}),K.jsx("button",{className:"pdf-nav-button",onClick:re,disabled:D<=Mv,children:K.jsx(JF,{size:24,color:"#d0d0d0"})}),K.jsx("button",{className:"pdf-nav-button",onClick:W,disabled:D>=Iv,children:K.jsx(QF,{size:24,color:"#d0d0d0"})})]})]})]})}):K.jsx(K.Fragment,{children:K.jsx("div",{className:"row",children:K.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",style:{minHeight:"50vh"},children:K.jsx("p",{className:"text-muted",children:"Carregue um pdf para ser exibido aqui"})})})})}),tP=({hasFile:n,area:e,onStartSelection:t,onClearArea:r,onDeleteArea:i,onRenameArea:a,onToggleMandatory:o,onChangeAreaType:c})=>{const[f,h]=le.useState(!1),[d,g]=le.useState(e.name),m=le.useRef(null);le.useEffect(()=>{f&&m.current&&(m.current.focus(),m.current.select())},[f]);const[v,y]=le.useState(!1),b=()=>{o(e.id,!e.isMandatory)},A=()=>{t(e.id)},w=()=>{i(e.id)},C=()=>{r(e.id)},T=()=>{g(e.name),h(!0)},R=D=>{D.key==="Enter"&&N(),D.key==="Escape"&&I()},N=()=>{d.trim()&&d.trim()!==e.name?(a(e.id,d.trim()),h(!1)):I()},I=()=>{g(e.name),h(!1)};return K.jsx(K.Fragment,{children:K.jsxs("div",{className:"border rounded mb-1",children:[K.jsxs("div",{className:"d-flex align-items-center gap-1 p-2",children:[K.jsx("div",{className:"drag-handle",style:{cursor:"grab"},children:""}),K.jsx("div",{className:"d-flex align-items-center",children:K.jsxs("span",{className:"badge me-2",style:{backgroundColor:e.color,color:"white"},children:["#",e.order]})}),f?K.jsxs("div",{className:"d-flex align-items-center flex-grow-1",children:[K.jsx("input",{ref:m,type:"text",className:"form-control form-control-sm me-2",value:d,onChange:D=>g(D.target.value),onKeyDown:R,onBlur:N}),K.jsxs("div",{className:"d-flex gap-2",children:[K.jsx("button",{className:"menu-btn menu-btn-cta",title:"Confirmar",onClick:N,children:K.jsx(bF,{size:16})}),K.jsx("button",{className:"menu-btn menu-btn-warning",title:"Cancelar",onClick:I,children:K.jsx(Tx,{size:16})})]})]}):K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"flex-grow-1 text-start area-name-section",style:{minWidth:0},children:K.jsx("span",{onClick:T,style:{width:"calc(100% - 10px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},title:e.name,children:e.name})}),K.jsx("button",{className:"menu-btn menu-btn-cta",disabled:!n,onClick:A,children:K.jsx(GF,{size:16})}),e.coordinates&&K.jsx("button",{className:"menu-btn menu-btn-alert",onClick:C,title:"Limpar seleo",children:K.jsx(IF,{size:16})}),K.jsx("button",{className:"menu-btn menu-btn-warning area-delete",onClick:w,title:"Excluir rea",children:K.jsx(YF,{size:14})}),K.jsx("div",{className:"d-flex align-items-center m-1",children:K.jsx("span",{onClick:()=>y(!v),title:"Opes avanadas",style:{cursor:"pointer"},children:v?K.jsx(OF,{size:20}):K.jsx(AF,{size:20})})})]})]}),v&&K.jsxs("div",{className:"advanced-options mt-2 p-2 bg-light rounded",children:[K.jsx("div",{className:"d-flex align-items-center justify-content-between mb-2",children:K.jsx("small",{className:"text-muted",children:"Opes avanadas"})}),K.jsx("div",{className:"d-flex align-items-start mb-1",children:K.jsxs("div",{className:"d-flex align-items-center",title:e.isMandatory?"Campo obrigatrio":"Campo opcional",children:[K.jsx(xF,{onClick:b,size:24,strokeWidth:e.isMandatory?2.5:1.5,style:{borderRadius:20,cursor:"pointer",opacity:e.isMandatory?1:.3,color:e.isMandatory?"#dc3545":"#6c757d",backgroundColor:e.isMandatory?"#dc354520":"transparent"}}),K.jsx("span",{className:"ms-2",children:"Campo obrigatrio"})]})}),K.jsxs("div",{className:"form-check form-switch d-flex align-items-start",children:[K.jsx("input",{className:"form-check-input me-2",type:"checkbox",id:`area-${e.order}-is-nspt`,checked:e.type==="nspt",onChange:D=>c(e.id,D.target.checked?"nspt":void 0)}),K.jsx("label",{className:"form-check-label",htmlFor:`area-${e.order}-is-nspt`,children:"NSPT"})]})]})]})})},nP=100*1024*1024;function rP({onFileSelect:n}){const e=t=>{if(t.target.files){const r=t.target.files[0];if(r.size>nP){alert(`Arquivo muito grande! Limite mximo: 100MB. Seu arquivo: ${(r.size/1024/1024).toFixed(1)}MB`),t.target.value="";return}n(r)}};return K.jsx("div",{children:K.jsx("input",{className:"form-control mb-2",type:"file",id:"pdf-file",name:"pdf-file",accept:".pdf",onChange:e})})}const iw="extrator-dados-pdf-presets",iP=({isOpen:n,onClose:e,currentAreas:t,onLoadPreset:r})=>{const[i,a]=le.useState(""),[o,c]=le.useState([]);le.useEffect(()=>{f()},[]);const f=()=>{try{const b=localStorage.getItem(iw);if(b){const A=JSON.parse(b);c(A)}}catch(b){console.error("Erro ao carregar presets:",b)}},h=b=>{try{localStorage.setItem(iw,JSON.stringify(b))}catch(A){console.error("Erro ao salvar presets:",A)}},d=()=>{if(!i.trim())return;if(t.length<=0){alert("No  possvel salvar um preset sem reas");return}const b={name:i.trim(),areas:t},A=[...o,b];c(A),h(A),a("")},g=b=>{confirm("Isso vai substituir todas as reas atuais. Continuar?")&&(r(b.areas),e())},m=b=>{if(!confirm("Tem certeza que deseja excluir este preset?"))return;const A=o.filter((w,C)=>C!==b);c(A),h(A)},v=b=>{const A=JSON.stringify(b,null,2),w=new Blob([A],{type:"application/json"}),C=URL.createObjectURL(w),T=document.createElement("a");T.href=C,T.download=`${b.name}.json`,T.click(),URL.revokeObjectURL(C)},y=b=>{const A=b.target.files?.[0];if(!A)return;const w=new FileReader;w.onload=C=>{try{const T=C.target?.result,R=JSON.parse(T);if(!R.name||!Array.isArray(R.areas)){alert("Arquivo JSON invlido!");return}const N=[...o,R];c(N),h(N),b.target.value="",alert(`Preset "${R.name}" importado com sucesso!`)}catch(T){alert("Erro ao ler arquivo JSON!"),console.error(T)}},w.readAsText(A)};return n?K.jsxs(K.Fragment,{children:[K.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-50",style:{zIndex:1050},onClick:e}),K.jsxs("div",{className:"position-fixed top-50 start-50 translate-middle bg-white rounded shadow-lg p-4",style:{zIndex:1051,width:"500px",maxHeight:"80vh",overflowY:"auto"},children:[K.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[K.jsx("h5",{className:"mb-0",children:"Gerenciar Presets"}),K.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:e,children:K.jsx(Tx,{size:16})})]}),K.jsxs("div",{className:"mb-4 p-3 border rounded",children:[K.jsx("h6",{children:"Salvar Preset Atual"}),K.jsxs("div",{className:"d-flex gap-2",children:[K.jsx("input",{type:"text",className:"form-control",placeholder:"Nome do preset...",value:i,onChange:b=>a(b.target.value),onKeyDown:b=>b.key==="Enter"&&d()}),K.jsxs("button",{className:"btn btn-success",onClick:d,disabled:!i.trim()||t.length===0,children:[K.jsx(jF,{size:16,className:"me-1"}),"Salvar"]})]}),K.jsx("small",{className:"text-muted",children:t.length===0?"Nenhuma rea para salvar":t.length===1?"1 rea ser salva":`${t.length} reas sero salvas`})]}),K.jsxs("div",{className:"mb-4",children:[K.jsx("h6",{children:"Presets Salvos"}),o.length===0?K.jsx("p",{className:"text-muted",children:"Nenhum preset salvo ainda."}):o.map((b,A)=>K.jsxs("div",{className:"d-flex justify-content-between align-items-center p-2 border rounded mb-2",children:[K.jsxs("div",{children:[K.jsx("strong",{children:b.name}),K.jsx("br",{}),K.jsxs("small",{className:"text-muted",children:[b.areas.length," rea(s)"]})]}),K.jsxs("div",{className:"d-flex gap-1",children:[K.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>g(b),title:"Carregar preset",children:K.jsx(BF,{size:14})}),K.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>v(b),title:"Download JSON",children:K.jsx(ad,{size:14})}),K.jsx("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>m(A),title:"Excluir preset",children:K.jsx(WF,{size:14})})]})]},A))]}),K.jsxs("div",{className:"p-3 border rounded",children:[K.jsx("h6",{children:"Importar Preset"}),K.jsx("input",{type:"file",className:"form-control",accept:".json",onChange:b=>{y(b)}})]})]})]}):null};var Cx=FS();const sP=H_(Cx);function hi(n){return`Minified Redux error #${n}; visit https://redux.js.org/Errors?code=${n} for the full message or use the non-minified dev environment for full errors. `}var aP=typeof Symbol=="function"&&Symbol.observable||"@@observable",sw=aP,aw=()=>Math.random().toString(36).substring(7).split("").join("."),oP={INIT:`@@redux/INIT${aw()}`,REPLACE:`@@redux/REPLACE${aw()}`},ow=oP;function lP(n){if(typeof n!="object"||n===null)return!1;let e=n;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(n)===e||Object.getPrototypeOf(n)===null}function MT(n,e,t){if(typeof n!="function")throw new Error(hi(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(hi(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(hi(1));return t(MT)(n,e)}let r=n,i=e,a=new Map,o=a,c=0,f=!1;function h(){o===a&&(o=new Map,a.forEach((A,w)=>{o.set(w,A)}))}function d(){if(f)throw new Error(hi(3));return i}function g(A){if(typeof A!="function")throw new Error(hi(4));if(f)throw new Error(hi(5));let w=!0;h();const C=c++;return o.set(C,A),function(){if(w){if(f)throw new Error(hi(6));w=!1,h(),o.delete(C),a=null}}}function m(A){if(!lP(A))throw new Error(hi(7));if(typeof A.type>"u")throw new Error(hi(8));if(typeof A.type!="string")throw new Error(hi(17));if(f)throw new Error(hi(9));try{f=!0,i=r(i,A)}finally{f=!1}return(a=o).forEach(C=>{C()}),A}function v(A){if(typeof A!="function")throw new Error(hi(10));r=A,m({type:ow.REPLACE})}function y(){const A=g;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(hi(11));function C(){const R=w;R.next&&R.next(d())}return C(),{unsubscribe:A(C)}},[sw](){return this}}}return m({type:ow.INIT}),{dispatch:m,subscribe:g,getState:d,replaceReducer:v,[sw]:y}}function lw(n,e){return function(...t){return e(n.apply(this,t))}}function cw(n,e){if(typeof n=="function")return lw(n,e);if(typeof n!="object"||n===null)throw new Error(hi(16));const t={};for(const r in n){const i=n[r];typeof i=="function"&&(t[r]=lw(i,e))}return t}function IT(...n){return n.length===0?e=>e:n.length===1?n[0]:n.reduce((e,t)=>(...r)=>e(t(...r)))}function cP(...n){return e=>(t,r)=>{const i=e(t,r);let a=()=>{throw new Error(hi(15))};const o={getState:i.getState,dispatch:(f,...h)=>a(f,...h)},c=n.map(f=>f(o));return a=IT(...c)(i.dispatch),{...i,dispatch:a}}}var kv={exports:{}},Fv={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uw;function uP(){if(uw)return Fv;uw=1;var n=qg();function e(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var t=typeof Object.is=="function"?Object.is:e,r=n.useSyncExternalStore,i=n.useRef,a=n.useEffect,o=n.useMemo,c=n.useDebugValue;return Fv.useSyncExternalStoreWithSelector=function(f,h,d,g,m){var v=i(null);if(v.current===null){var y={hasValue:!1,value:null};v.current=y}else y=v.current;v=o(function(){function A(N){if(!w){if(w=!0,C=N,N=g(N),m!==void 0&&y.hasValue){var I=y.value;if(m(I,N))return T=I}return T=N}if(I=T,t(C,N))return I;var D=g(N);return m!==void 0&&m(I,D)?(C=N,I):(C=N,T=D)}var w=!1,C,T,R=d===void 0?null:d;return[function(){return A(h())},R===null?void 0:function(){return A(R())}]},[h,d,g,m]);var b=r(f,v[0],v[1]);return a(function(){y.hasValue=!0,y.value=b},[b]),c(b),b},Fv}var fw;function fP(){return fw||(fw=1,kv.exports=uP()),kv.exports}fP();var hP=le.version.startsWith("19"),dP=Symbol.for(hP?"react.transitional.element":"react.element"),pP=Symbol.for("react.portal"),gP=Symbol.for("react.fragment"),mP=Symbol.for("react.strict_mode"),vP=Symbol.for("react.profiler"),_P=Symbol.for("react.consumer"),xP=Symbol.for("react.context"),kT=Symbol.for("react.forward_ref"),yP=Symbol.for("react.suspense"),bP=Symbol.for("react.suspense_list"),Dx=Symbol.for("react.memo"),EP=Symbol.for("react.lazy"),AP=kT,wP=Dx;function SP(n){if(typeof n=="object"&&n!==null){const{$$typeof:e}=n;switch(e){case dP:switch(n=n.type,n){case gP:case vP:case mP:case yP:case bP:return n;default:switch(n=n&&n.$$typeof,n){case xP:case kT:case EP:case Dx:return n;case _P:return n;default:return e}}case pP:return e}}}function TP(n){return SP(n)===Dx}function CP(n,e,t,r,{areStatesEqual:i,areOwnPropsEqual:a,areStatePropsEqual:o}){let c=!1,f,h,d,g,m;function v(C,T){return f=C,h=T,d=n(f,h),g=e(r,h),m=t(d,g,h),c=!0,m}function y(){return d=n(f,h),e.dependsOnOwnProps&&(g=e(r,h)),m=t(d,g,h),m}function b(){return n.dependsOnOwnProps&&(d=n(f,h)),e.dependsOnOwnProps&&(g=e(r,h)),m=t(d,g,h),m}function A(){const C=n(f,h),T=!o(C,d);return d=C,T&&(m=t(d,g,h)),m}function w(C,T){const R=!a(T,h),N=!i(C,f,T,h);return f=C,h=T,R&&N?y():R?b():N?A():m}return function(T,R){return c?w(T,R):v(T,R)}}function DP(n,{initMapStateToProps:e,initMapDispatchToProps:t,initMergeProps:r,...i}){const a=e(n,i),o=t(n,i),c=r(n,i);return CP(a,o,c,n,i)}function OP(n,e){const t={};for(const r in n){const i=n[r];typeof i=="function"&&(t[r]=(...a)=>e(i(...a)))}return t}function S_(n){return function(t){const r=n(t);function i(){return r}return i.dependsOnOwnProps=!1,i}}function hw(n){return n.dependsOnOwnProps?!!n.dependsOnOwnProps:n.length!==1}function FT(n,e){return function(r,{displayName:i}){const a=function(c,f){return a.dependsOnOwnProps?a.mapToProps(c,f):a.mapToProps(c,void 0)};return a.dependsOnOwnProps=!0,a.mapToProps=function(c,f){a.mapToProps=n,a.dependsOnOwnProps=hw(n);let h=a(c,f);return typeof h=="function"&&(a.mapToProps=h,a.dependsOnOwnProps=hw(h),h=a(c,f)),h},a}}function Ox(n,e){return(t,r)=>{throw new Error(`Invalid value of type ${typeof n} for ${e} argument when connecting component ${r.wrappedComponentName}.`)}}function RP(n){return n&&typeof n=="object"?S_(e=>OP(n,e)):n?typeof n=="function"?FT(n):Ox(n,"mapDispatchToProps"):S_(e=>({dispatch:e}))}function NP(n){return n?typeof n=="function"?FT(n):Ox(n,"mapStateToProps"):S_(()=>({}))}function LP(n,e,t){return{...t,...n,...e}}function MP(n){return function(t,{displayName:r,areMergedPropsEqual:i}){let a=!1,o;return function(f,h,d){const g=n(f,h,d);return a?i(g,o)||(o=g):(a=!0,o=g),o}}}function IP(n){return n?typeof n=="function"?MP(n):Ox(n,"mergeProps"):()=>LP}function kP(n){n()}function FP(){let n=null,e=null;return{clear(){n=null,e=null},notify(){kP(()=>{let t=n;for(;t;)t.callback(),t=t.next})},get(){const t=[];let r=n;for(;r;)t.push(r),r=r.next;return t},subscribe(t){let r=!0;const i=e={callback:t,next:null,prev:e};return i.prev?i.prev.next=i:n=i,function(){!r||n===null||(r=!1,i.next?i.next.prev=i.prev:e=i.prev,i.prev?i.prev.next=i.next:n=i.next)}}}}var dw={notify(){},get:()=>[]};function PT(n,e){let t,r=dw,i=0,a=!1;function o(b){d();const A=r.subscribe(b);let w=!1;return()=>{w||(w=!0,A(),g())}}function c(){r.notify()}function f(){y.onStateChange&&y.onStateChange()}function h(){return a}function d(){i++,t||(t=e?e.addNestedSub(f):n.subscribe(f),r=FP())}function g(){i--,t&&i===0&&(t(),t=void 0,r.clear(),r=dw)}function m(){a||(a=!0,d())}function v(){a&&(a=!1,g())}const y={addNestedSub:o,notifyNestedSubs:c,handleChangeWrapper:f,isSubscribed:h,trySubscribe:m,tryUnsubscribe:v,getListeners:()=>r};return y}var PP=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",BP=PP(),UP=()=>typeof navigator<"u"&&navigator.product==="ReactNative",HP=UP(),zP=()=>BP||HP?le.useLayoutEffect:le.useEffect,yg=zP();function pw(n,e){return n===e?n!==0||e!==0||1/n===1/e:n!==n&&e!==e}function Pv(n,e){if(pw(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(!Object.prototype.hasOwnProperty.call(e,t[i])||!pw(n[t[i]],e[t[i]]))return!1;return!0}var jP={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},$P={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},GP={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},BT={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},VP={[AP]:GP,[wP]:BT};function gw(n){return TP(n)?BT:VP[n.$$typeof]||jP}var WP=Object.defineProperty,XP=Object.getOwnPropertyNames,mw=Object.getOwnPropertySymbols,YP=Object.getOwnPropertyDescriptor,qP=Object.getPrototypeOf,vw=Object.prototype;function T_(n,e){if(typeof e!="string"){if(vw){const a=qP(e);a&&a!==vw&&T_(n,a)}let t=XP(e);mw&&(t=t.concat(mw(e)));const r=gw(n),i=gw(e);for(let a=0;a<t.length;++a){const o=t[a];if(!$P[o]&&!(i&&i[o])&&!(r&&r[o])){const c=YP(e,o);try{WP(n,o,c)}catch{}}}}return n}var KP=Symbol.for("react-redux-context"),QP=typeof globalThis<"u"?globalThis:{};function ZP(){if(!le.createContext)return{};const n=QP[KP]??=new Map;let e=n.get(le.createContext);return e||(e=le.createContext(null),n.set(le.createContext,e)),e}var UT=ZP(),JP=[null,null];function e6(n,e,t){yg(()=>n(...e),t)}function t6(n,e,t,r,i,a){n.current=r,t.current=!1,i.current&&(i.current=null,a())}function n6(n,e,t,r,i,a,o,c,f,h,d){if(!n)return()=>{};let g=!1,m=null;const v=()=>{if(g||!c.current)return;const b=e.getState();let A,w;try{A=r(b,i.current)}catch(C){w=C,m=C}w||(m=null),A===a.current?o.current||h():(a.current=A,f.current=A,o.current=!0,d())};return t.onStateChange=v,t.trySubscribe(),v(),()=>{if(g=!0,t.tryUnsubscribe(),t.onStateChange=null,m)throw m}}function r6(n,e){return n===e}function i6(n,e,t,{pure:r,areStatesEqual:i=r6,areOwnPropsEqual:a=Pv,areStatePropsEqual:o=Pv,areMergedPropsEqual:c=Pv,forwardRef:f=!1,context:h=UT}={}){const d=h,g=NP(n),m=RP(e),v=IP(t),y=!!n;return A=>{const w=A.displayName||A.name||"Component",C=`Connect(${w})`,T={shouldHandleStateChanges:y,displayName:C,wrappedComponentName:w,WrappedComponent:A,initMapStateToProps:g,initMapDispatchToProps:m,initMergeProps:v,areStatesEqual:i,areStatePropsEqual:o,areOwnPropsEqual:a,areMergedPropsEqual:c};function R(D){const[B,U,Y]=le.useMemo(()=>{const{reactReduxForwardedRef:xe,...be}=D;return[D.context,xe,be]},[D]),W=le.useMemo(()=>{let xe=d;return B?.Consumer,xe},[B,d]),re=le.useContext(W),Te=!!D.store&&!!D.store.getState&&!!D.store.dispatch,Fe=!!re&&!!re.store,we=Te?D.store:re.store,q=Fe?re.getServerState:we.getState,ee=le.useMemo(()=>DP(we.dispatch,T),[we]),[Pe,qe]=le.useMemo(()=>{if(!y)return JP;const xe=PT(we,Te?void 0:re.subscription),be=xe.notifyNestedSubs.bind(xe);return[xe,be]},[we,Te,re]),P=le.useMemo(()=>Te?re:{...re,subscription:Pe},[Te,re,Pe]),ye=le.useRef(void 0),ve=le.useRef(Y),ge=le.useRef(void 0),Ce=le.useRef(!1),He=le.useRef(!1),Ie=le.useRef(void 0);yg(()=>(He.current=!0,()=>{He.current=!1}),[]);const Ge=le.useMemo(()=>()=>ge.current&&Y===ve.current?ge.current:ee(we.getState(),Y),[we,Y]),k=le.useMemo(()=>be=>Pe?n6(y,we,Pe,ee,ve,ye,Ce,He,ge,qe,be):()=>{},[Pe]);e6(t6,[ve,ye,Ce,Y,ge,qe]);let se;try{se=le.useSyncExternalStore(k,Ge,q?()=>ee(q(),Y):Ge)}catch(xe){throw Ie.current&&(xe.message+=`
The error may be correlated with this previous error:
${Ie.current.stack}

`),xe}yg(()=>{Ie.current=void 0,ge.current=void 0,ye.current=se});const Z=le.useMemo(()=>le.createElement(A,{...se,ref:U}),[U,A,se]);return le.useMemo(()=>y?le.createElement(W.Provider,{value:P},Z):Z,[W,Z,P])}const I=le.memo(R);if(I.WrappedComponent=A,I.displayName=R.displayName=C,f){const B=le.forwardRef(function(Y,W){return le.createElement(I,{...Y,reactReduxForwardedRef:W})});return B.displayName=C,B.WrappedComponent=A,T_(B,A)}return T_(I,A)}}var HT=i6;function s6(n){const{children:e,context:t,serverState:r,store:i}=n,a=le.useMemo(()=>{const f=PT(i);return{store:i,subscription:f,getServerState:r?()=>r:void 0}},[i,r]),o=le.useMemo(()=>i.getState(),[i]);yg(()=>{const{subscription:f}=a;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),o!==i.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[a,o]);const c=t||UT;return le.createElement(c.Provider,{value:a},e)}var a6=s6,Qs=function(e){var t=e.top,r=e.right,i=e.bottom,a=e.left,o=r-a,c=i-t,f={top:t,right:r,bottom:i,left:a,width:o,height:c,x:a,y:t,center:{x:(r+a)/2,y:(i+t)/2}};return f},Rx=function(e,t){return{top:e.top-t.top,left:e.left-t.left,bottom:e.bottom+t.bottom,right:e.right+t.right}},_w=function(e,t){return{top:e.top+t.top,left:e.left+t.left,bottom:e.bottom-t.bottom,right:e.right-t.right}},o6=function(e,t){return{top:e.top+t.y,left:e.left+t.x,bottom:e.bottom+t.y,right:e.right+t.x}},Bv={top:0,right:0,bottom:0,left:0},Nx=function(e){var t=e.borderBox,r=e.margin,i=r===void 0?Bv:r,a=e.border,o=a===void 0?Bv:a,c=e.padding,f=c===void 0?Bv:c,h=Qs(Rx(t,i)),d=Qs(_w(t,o)),g=Qs(_w(d,f));return{marginBox:h,borderBox:Qs(t),paddingBox:d,contentBox:g,margin:i,border:o,padding:f}},Ss=function(e){var t=e.slice(0,-2),r=e.slice(-2);if(r!=="px")return 0;var i=Number(t);return isNaN(i)&&xn(!1),i},l6=function(){return{x:window.pageXOffset,y:window.pageYOffset}},bg=function(e,t){var r=e.borderBox,i=e.border,a=e.margin,o=e.padding,c=o6(r,t);return Nx({borderBox:c,border:i,margin:a,padding:o})},Eg=function(e,t){return t===void 0&&(t=l6()),bg(e,t)},zT=function(e,t){var r={top:Ss(t.marginTop),right:Ss(t.marginRight),bottom:Ss(t.marginBottom),left:Ss(t.marginLeft)},i={top:Ss(t.paddingTop),right:Ss(t.paddingRight),bottom:Ss(t.paddingBottom),left:Ss(t.paddingLeft)},a={top:Ss(t.borderTopWidth),right:Ss(t.borderRightWidth),bottom:Ss(t.borderBottomWidth),left:Ss(t.borderLeftWidth)};return Nx({borderBox:e,margin:r,padding:i,border:a})},jT=function(e){var t=e.getBoundingClientRect(),r=window.getComputedStyle(e);return zT(t,r)},yd=function(e){var t=[],r=null,i=function(){for(var o=arguments.length,c=new Array(o),f=0;f<o;f++)c[f]=arguments[f];t=c,!r&&(r=requestAnimationFrame(function(){r=null,e.apply(void 0,t)}))};return i.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},i};function Ag(){return Ag=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ag.apply(null,arguments)}function $T(n,e){}$T.bind(null,"warn");$T.bind(null,"error");function ml(){}function c6(n,e){return{...n,...e}}function Rs(n,e,t){const r=e.map(i=>{const a=c6(t,i.options);return n.addEventListener(i.eventName,i.fn,a),function(){n.removeEventListener(i.eventName,i.fn,a)}});return function(){r.forEach(a=>{a()})}}const u6="Invariant failed";class wg extends Error{}wg.prototype.toString=function(){return this.message};function Ke(n,e){throw new wg(u6)}class f6 extends Yn.Component{constructor(...e){super(...e),this.callbacks=null,this.unbind=ml,this.onWindowError=t=>{const r=this.getCallbacks();r.isDragging()&&r.tryAbort(),t.error instanceof wg&&t.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=t=>{this.callbacks=t}}componentDidMount(){this.unbind=Rs(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(e){if(e instanceof wg){this.setState({});return}throw e}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const h6=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,Sg=n=>n+1,d6=n=>`
  You have lifted an item in position ${Sg(n.source.index)}
`,GT=(n,e)=>{const t=n.droppableId===e.droppableId,r=Sg(n.index),i=Sg(e.index);return t?`
      You have moved the item from position ${r}
      to position ${i}
    `:`
    You have moved the item from position ${r}
    in list ${n.droppableId}
    to list ${e.droppableId}
    in position ${i}
  `},VT=(n,e,t)=>e.droppableId===t.droppableId?`
      The item ${n}
      has been combined with ${t.draggableId}`:`
      The item ${n}
      in list ${e.droppableId}
      has been combined with ${t.draggableId}
      in list ${t.droppableId}
    `,p6=n=>{const e=n.destination;if(e)return GT(n.source,e);const t=n.combine;return t?VT(n.draggableId,n.source,t):"You are over an area that cannot be dropped on"},xw=n=>`
  The item has returned to its starting position
  of ${Sg(n.index)}
`,g6=n=>{if(n.reason==="CANCEL")return`
      Movement cancelled.
      ${xw(n.source)}
    `;const e=n.destination,t=n.combine;return e?`
      You have dropped the item.
      ${GT(n.source,e)}
    `:t?`
      You have dropped the item.
      ${VT(n.draggableId,n.source,t)}
    `:`
    The item has been dropped while not over a drop area.
    ${xw(n.source)}
  `},fg={dragHandleUsageInstructions:h6,onDragStart:d6,onDragUpdate:p6,onDragEnd:g6};function m6(n,e){return!!(n===e||Number.isNaN(n)&&Number.isNaN(e))}function WT(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!m6(n[t],e[t]))return!1;return!0}function Zt(n,e){const t=le.useState(()=>({inputs:e,result:n()}))[0],r=le.useRef(!0),i=le.useRef(t),o=r.current||!!(e&&i.current.inputs&&WT(e,i.current.inputs))?i.current:{inputs:e,result:n()};return le.useEffect(()=>{r.current=!1,i.current=o},[o]),o.result}function ft(n,e){return Zt(()=>n,e)}const Sr={x:0,y:0},kr=(n,e)=>({x:n.x+e.x,y:n.y+e.y}),is=(n,e)=>({x:n.x-e.x,y:n.y-e.y}),vl=(n,e)=>n.x===e.x&&n.y===e.y,pf=n=>({x:n.x!==0?-n.x:0,y:n.y!==0?-n.y:0}),wc=(n,e,t=0)=>n==="x"?{x:e,y:t}:{x:t,y:e},bd=(n,e)=>Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2),yw=(n,e)=>Math.min(...e.map(t=>bd(n,t))),XT=n=>e=>({x:n(e.x),y:n(e.y)});var v6=(n,e)=>{const t=Qs({top:Math.max(e.top,n.top),right:Math.min(e.right,n.right),bottom:Math.min(e.bottom,n.bottom),left:Math.max(e.left,n.left)});return t.width<=0||t.height<=0?null:t};const Kd=(n,e)=>({top:n.top+e.y,left:n.left+e.x,bottom:n.bottom+e.y,right:n.right+e.x}),bw=n=>[{x:n.left,y:n.top},{x:n.right,y:n.top},{x:n.left,y:n.bottom},{x:n.right,y:n.bottom}],_6={top:0,right:0,bottom:0,left:0},x6=(n,e)=>e?Kd(n,e.scroll.diff.displacement):n,y6=(n,e,t)=>t&&t.increasedBy?{...n,[e.end]:n[e.end]+t.increasedBy[e.line]}:n,b6=(n,e)=>e&&e.shouldClipSubject?v6(e.pageMarginBox,n):Qs(n);var rf=({page:n,withPlaceholder:e,axis:t,frame:r})=>{const i=x6(n.marginBox,r),a=y6(i,t,e),o=b6(a,r);return{page:n,withPlaceholder:e,active:o}},Lx=(n,e)=>{n.frame||Ke();const t=n.frame,r=is(e,t.scroll.initial),i=pf(r),a={...t,scroll:{initial:t.scroll.initial,current:e,diff:{value:r,displacement:i},max:t.scroll.max}},o=rf({page:n.subject.page,withPlaceholder:n.subject.withPlaceholder,axis:n.axis,frame:a});return{...n,frame:a,subject:o}};function wr(n,e=WT){let t=null;function r(...i){if(t&&t.lastThis===this&&e(i,t.lastArgs))return t.lastResult;const a=n.apply(this,i);return t={lastResult:a,lastArgs:i,lastThis:this},a}return r.clear=function(){t=null},r}const YT=wr(n=>n.reduce((e,t)=>(e[t.descriptor.id]=t,e),{})),qT=wr(n=>n.reduce((e,t)=>(e[t.descriptor.id]=t,e),{})),pm=wr(n=>Object.values(n)),E6=wr(n=>Object.values(n));var gf=wr((n,e)=>E6(e).filter(r=>n===r.descriptor.droppableId).sort((r,i)=>r.descriptor.index-i.descriptor.index));function Mx(n){return n.at&&n.at.type==="REORDER"?n.at.destination:null}function gm(n){return n.at&&n.at.type==="COMBINE"?n.at.combine:null}var mm=wr((n,e)=>e.filter(t=>t.descriptor.id!==n.descriptor.id)),A6=({isMovingForward:n,draggable:e,destination:t,insideDestination:r,previousImpact:i})=>{if(!t.isCombineEnabled||!Mx(i))return null;function o(v){const y={type:"COMBINE",combine:{draggableId:v,droppableId:t.descriptor.id}};return{...i,at:y}}const c=i.displaced.all,f=c.length?c[0]:null;if(n)return f?o(f):null;const h=mm(e,r);if(!f){if(!h.length)return null;const v=h[h.length-1];return o(v.descriptor.id)}const d=h.findIndex(v=>v.descriptor.id===f);d===-1&&Ke();const g=d-1;if(g<0)return null;const m=h[g];return o(m.descriptor.id)},mf=(n,e)=>n.descriptor.droppableId===e.descriptor.id;const KT={point:Sr,value:0},Ed={invisible:{},visible:{},all:[]},w6={displaced:Ed,displacedBy:KT,at:null};var Ls=(n,e)=>t=>n<=t&&t<=e,QT=n=>{const e=Ls(n.top,n.bottom),t=Ls(n.left,n.right);return r=>{if(e(r.top)&&e(r.bottom)&&t(r.left)&&t(r.right))return!0;const a=e(r.top)||e(r.bottom),o=t(r.left)||t(r.right);if(a&&o)return!0;const f=r.top<n.top&&r.bottom>n.bottom,h=r.left<n.left&&r.right>n.right;return f&&h?!0:f&&o||h&&a}},S6=n=>{const e=Ls(n.top,n.bottom),t=Ls(n.left,n.right);return r=>e(r.top)&&e(r.bottom)&&t(r.left)&&t(r.right)};const Ix={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},ZT={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var T6=n=>e=>{const t=Ls(e.top,e.bottom),r=Ls(e.left,e.right);return i=>n===Ix?t(i.top)&&t(i.bottom):r(i.left)&&r(i.right)};const C6=(n,e)=>{const t=e.frame?e.frame.scroll.diff.displacement:Sr;return Kd(n,t)},D6=(n,e,t)=>e.subject.active?t(e.subject.active)(n):!1,O6=(n,e,t)=>t(e)(n),kx=({target:n,destination:e,viewport:t,withDroppableDisplacement:r,isVisibleThroughFrameFn:i})=>{const a=r?C6(n,e):n;return D6(a,e,i)&&O6(a,t,i)},R6=n=>kx({...n,isVisibleThroughFrameFn:QT}),JT=n=>kx({...n,isVisibleThroughFrameFn:S6}),N6=n=>kx({...n,isVisibleThroughFrameFn:T6(n.destination.axis)}),L6=(n,e,t)=>{if(typeof t=="boolean")return t;if(!e)return!0;const{invisible:r,visible:i}=e;if(r[n])return!1;const a=i[n];return a?a.shouldAnimate:!0};function M6(n,e){const t=n.page.marginBox,r={top:e.point.y,right:0,bottom:0,left:e.point.x};return Qs(Rx(t,r))}function Ad({afterDragging:n,destination:e,displacedBy:t,viewport:r,forceShouldAnimate:i,last:a}){return n.reduce(function(c,f){const h=M6(f,t),d=f.descriptor.id;if(c.all.push(d),!R6({target:h,destination:e,viewport:r,withDroppableDisplacement:!0}))return c.invisible[f.descriptor.id]=!0,c;const m=L6(d,a,i),v={draggableId:d,shouldAnimate:m};return c.visible[d]=v,c},{all:[],visible:{},invisible:{}})}function I6(n,e){if(!n.length)return 0;const t=n[n.length-1].descriptor.index;return e.inHomeList?t:t+1}function Ew({insideDestination:n,inHomeList:e,displacedBy:t,destination:r}){const i=I6(n,{inHomeList:e});return{displaced:Ed,displacedBy:t,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:i}}}}function Tg({draggable:n,insideDestination:e,destination:t,viewport:r,displacedBy:i,last:a,index:o,forceShouldAnimate:c}){const f=mf(n,t);if(o==null)return Ew({insideDestination:e,inHomeList:f,displacedBy:i,destination:t});const h=e.find(y=>y.descriptor.index===o);if(!h)return Ew({insideDestination:e,inHomeList:f,displacedBy:i,destination:t});const d=mm(n,e),g=e.indexOf(h),m=d.slice(g);return{displaced:Ad({afterDragging:m,destination:t,displacedBy:i,last:a,viewport:r.frame,forceShouldAnimate:c}),displacedBy:i,at:{type:"REORDER",destination:{droppableId:t.descriptor.id,index:o}}}}function El(n,e){return!!e.effected[n]}var k6=({isMovingForward:n,destination:e,draggables:t,combine:r,afterCritical:i})=>{if(!e.isCombineEnabled)return null;const a=r.draggableId,c=t[a].descriptor.index;return El(a,i)?n?c:c-1:n?c+1:c},F6=({isMovingForward:n,isInHomeList:e,insideDestination:t,location:r})=>{if(!t.length)return null;const i=r.index,a=n?i+1:i-1,o=t[0].descriptor.index,c=t[t.length-1].descriptor.index,f=e?c:c+1;return a<o||a>f?null:a},P6=({isMovingForward:n,isInHomeList:e,draggable:t,draggables:r,destination:i,insideDestination:a,previousImpact:o,viewport:c,afterCritical:f})=>{const h=o.at;if(h||Ke(),h.type==="REORDER"){const g=F6({isMovingForward:n,isInHomeList:e,location:h.destination,insideDestination:a});return g==null?null:Tg({draggable:t,insideDestination:a,destination:i,viewport:c,last:o.displaced,displacedBy:o.displacedBy,index:g})}const d=k6({isMovingForward:n,destination:i,displaced:o.displaced,draggables:r,combine:h.combine,afterCritical:f});return d==null?null:Tg({draggable:t,insideDestination:a,destination:i,viewport:c,last:o.displaced,displacedBy:o.displacedBy,index:d})},B6=({displaced:n,afterCritical:e,combineWith:t,displacedBy:r})=>{const i=!!(n.visible[t]||n.invisible[t]);return El(t,e)?i?Sr:pf(r.point):i?r.point:Sr},U6=({afterCritical:n,impact:e,draggables:t})=>{const r=gm(e);r||Ke();const i=r.draggableId,a=t[i].page.borderBox.center,o=B6({displaced:e.displaced,afterCritical:n,combineWith:i,displacedBy:e.displacedBy});return kr(a,o)};const eC=(n,e)=>e.margin[n.start]+e.borderBox[n.size]/2,H6=(n,e)=>e.margin[n.end]+e.borderBox[n.size]/2,Fx=(n,e,t)=>e[n.crossAxisStart]+t.margin[n.crossAxisStart]+t.borderBox[n.crossAxisSize]/2,Aw=({axis:n,moveRelativeTo:e,isMoving:t})=>wc(n.line,e.marginBox[n.end]+eC(n,t),Fx(n,e.marginBox,t)),ww=({axis:n,moveRelativeTo:e,isMoving:t})=>wc(n.line,e.marginBox[n.start]-H6(n,t),Fx(n,e.marginBox,t)),z6=({axis:n,moveInto:e,isMoving:t})=>wc(n.line,e.contentBox[n.start]+eC(n,t),Fx(n,e.contentBox,t));var j6=({impact:n,draggable:e,draggables:t,droppable:r,afterCritical:i})=>{const a=gf(r.descriptor.id,t),o=e.page,c=r.axis;if(!a.length)return z6({axis:c,moveInto:r.page,isMoving:o});const{displaced:f,displacedBy:h}=n,d=f.all[0];if(d){const m=t[d];if(El(d,i))return ww({axis:c,moveRelativeTo:m.page,isMoving:o});const v=bg(m.page,h.point);return ww({axis:c,moveRelativeTo:v,isMoving:o})}const g=a[a.length-1];if(g.descriptor.id===e.descriptor.id)return o.borderBox.center;if(El(g.descriptor.id,i)){const m=bg(g.page,pf(i.displacedBy.point));return Aw({axis:c,moveRelativeTo:m,isMoving:o})}return Aw({axis:c,moveRelativeTo:g.page,isMoving:o})},C_=(n,e)=>{const t=n.frame;return t?kr(e,t.scroll.diff.displacement):e};const $6=({impact:n,draggable:e,droppable:t,draggables:r,afterCritical:i})=>{const a=e.page.borderBox.center,o=n.at;return!t||!o?a:o.type==="REORDER"?j6({impact:n,draggable:e,draggables:r,droppable:t,afterCritical:i}):U6({impact:n,draggables:r,afterCritical:i})};var vm=n=>{const e=$6(n),t=n.droppable;return t?C_(t,e):e},tC=(n,e)=>{const t=is(e,n.scroll.initial),r=pf(t);return{frame:Qs({top:e.y,bottom:e.y+n.frame.height,left:e.x,right:e.x+n.frame.width}),scroll:{initial:n.scroll.initial,max:n.scroll.max,current:e,diff:{value:t,displacement:r}}}};function Sw(n,e){return n.map(t=>e[t])}function G6(n,e){for(let t=0;t<e.length;t++){const r=e[t].visible[n];if(r)return r}return null}var V6=({impact:n,viewport:e,destination:t,draggables:r,maxScrollChange:i})=>{const a=tC(e,kr(e.scroll.current,i)),o=t.frame?Lx(t,kr(t.frame.scroll.current,i)):t,c=n.displaced,f=Ad({afterDragging:Sw(c.all,r),destination:t,displacedBy:n.displacedBy,viewport:a.frame,last:c,forceShouldAnimate:!1}),h=Ad({afterDragging:Sw(c.all,r),destination:o,displacedBy:n.displacedBy,viewport:e.frame,last:c,forceShouldAnimate:!1}),d={},g={},m=[c,f,h];return c.all.forEach(y=>{const b=G6(y,m);if(b){g[y]=b;return}d[y]=!0}),{...n,displaced:{all:c.all,invisible:d,visible:g}}},W6=(n,e)=>kr(n.scroll.diff.displacement,e),Px=({pageBorderBoxCenter:n,draggable:e,viewport:t})=>{const r=W6(t,n),i=is(r,e.page.borderBox.center);return kr(e.client.borderBox.center,i)},nC=({draggable:n,destination:e,newPageBorderBoxCenter:t,viewport:r,withDroppableDisplacement:i,onlyOnMainAxis:a=!1})=>{const o=is(t,n.page.borderBox.center),f={target:Kd(n.page.borderBox,o),destination:e,withDroppableDisplacement:i,viewport:r};return a?N6(f):JT(f)},X6=({isMovingForward:n,draggable:e,destination:t,draggables:r,previousImpact:i,viewport:a,previousPageBorderBoxCenter:o,previousClientSelection:c,afterCritical:f})=>{if(!t.isEnabled)return null;const h=gf(t.descriptor.id,r),d=mf(e,t),g=A6({isMovingForward:n,draggable:e,destination:t,insideDestination:h,previousImpact:i})||P6({isMovingForward:n,isInHomeList:d,draggable:e,draggables:r,destination:t,insideDestination:h,previousImpact:i,viewport:a,afterCritical:f});if(!g)return null;const m=vm({impact:g,draggable:e,droppable:t,draggables:r,afterCritical:f});if(nC({draggable:e,destination:t,newPageBorderBoxCenter:m,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:Px({pageBorderBoxCenter:m,draggable:e,viewport:a}),impact:g,scrollJumpRequest:null};const y=is(m,o),b=V6({impact:g,viewport:a,destination:t,draggables:r,maxScrollChange:y});return{clientSelection:c,impact:b,scrollJumpRequest:y}};const fi=n=>{const e=n.subject.active;return e||Ke(),e};var Y6=({isMovingForward:n,pageBorderBoxCenter:e,source:t,droppables:r,viewport:i})=>{const a=t.subject.active;if(!a)return null;const o=t.axis,c=Ls(a[o.start],a[o.end]),f=pm(r).filter(d=>d!==t).filter(d=>d.isEnabled).filter(d=>!!d.subject.active).filter(d=>QT(i.frame)(fi(d))).filter(d=>{const g=fi(d);return n?a[o.crossAxisEnd]<g[o.crossAxisEnd]:g[o.crossAxisStart]<a[o.crossAxisStart]}).filter(d=>{const g=fi(d),m=Ls(g[o.start],g[o.end]);return c(g[o.start])||c(g[o.end])||m(a[o.start])||m(a[o.end])}).sort((d,g)=>{const m=fi(d)[o.crossAxisStart],v=fi(g)[o.crossAxisStart];return n?m-v:v-m}).filter((d,g,m)=>fi(d)[o.crossAxisStart]===fi(m[0])[o.crossAxisStart]);if(!f.length)return null;if(f.length===1)return f[0];const h=f.filter(d=>Ls(fi(d)[o.start],fi(d)[o.end])(e[o.line]));return h.length===1?h[0]:h.length>1?h.sort((d,g)=>fi(d)[o.start]-fi(g)[o.start])[0]:f.sort((d,g)=>{const m=yw(e,bw(fi(d))),v=yw(e,bw(fi(g)));return m!==v?m-v:fi(d)[o.start]-fi(g)[o.start]})[0]};const Tw=(n,e)=>{const t=n.page.borderBox.center;return El(n.descriptor.id,e)?is(t,e.displacedBy.point):t},q6=(n,e)=>{const t=n.page.borderBox;return El(n.descriptor.id,e)?Kd(t,pf(e.displacedBy.point)):t};var K6=({pageBorderBoxCenter:n,viewport:e,destination:t,insideDestination:r,afterCritical:i})=>r.filter(o=>JT({target:q6(o,i),destination:t,viewport:e.frame,withDroppableDisplacement:!0})).sort((o,c)=>{const f=bd(n,C_(t,Tw(o,i))),h=bd(n,C_(t,Tw(c,i)));return f<h?-1:h<f?1:o.descriptor.index-c.descriptor.index})[0]||null,Qd=wr(function(e,t){const r=t[e.line];return{value:r,point:wc(e.line,r)}});const Q6=(n,e,t)=>{const r=n.axis;if(n.descriptor.mode==="virtual")return wc(r.line,e[r.line]);const i=n.subject.page.contentBox[r.size],f=gf(n.descriptor.id,t).reduce((h,d)=>h+d.client.marginBox[r.size],0)+e[r.line]-i;return f<=0?null:wc(r.line,f)},rC=(n,e)=>({...n,scroll:{...n.scroll,max:e}}),iC=(n,e,t)=>{const r=n.frame;mf(e,n)&&Ke(),n.subject.withPlaceholder&&Ke();const i=Qd(n.axis,e.displaceBy).point,a=Q6(n,i,t),o={placeholderSize:i,increasedBy:a,oldFrameMaxScroll:n.frame?n.frame.scroll.max:null};if(!r){const d=rf({page:n.subject.page,withPlaceholder:o,axis:n.axis,frame:n.frame});return{...n,subject:d}}const c=a?kr(r.scroll.max,a):r.scroll.max,f=rC(r,c),h=rf({page:n.subject.page,withPlaceholder:o,axis:n.axis,frame:f});return{...n,subject:h,frame:f}},Z6=n=>{const e=n.subject.withPlaceholder;e||Ke();const t=n.frame;if(!t){const o=rf({page:n.subject.page,axis:n.axis,frame:null,withPlaceholder:null});return{...n,subject:o}}const r=e.oldFrameMaxScroll;r||Ke();const i=rC(t,r),a=rf({page:n.subject.page,axis:n.axis,frame:i,withPlaceholder:null});return{...n,subject:a,frame:i}};var J6=({previousPageBorderBoxCenter:n,moveRelativeTo:e,insideDestination:t,draggable:r,draggables:i,destination:a,viewport:o,afterCritical:c})=>{if(!e){if(t.length)return null;const g={displaced:Ed,displacedBy:KT,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:0}}},m=vm({impact:g,draggable:r,droppable:a,draggables:i,afterCritical:c}),v=mf(r,a)?a:iC(a,r,i);return nC({draggable:r,destination:v,newPageBorderBoxCenter:m,viewport:o.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?g:null}const f=n[a.axis.line]<=e.page.borderBox.center[a.axis.line],h=(()=>{const g=e.descriptor.index;return e.descriptor.id===r.descriptor.id||f?g:g+1})(),d=Qd(a.axis,r.displaceBy);return Tg({draggable:r,insideDestination:t,destination:a,viewport:o,displacedBy:d,last:Ed,index:h})},e8=({isMovingForward:n,previousPageBorderBoxCenter:e,draggable:t,isOver:r,draggables:i,droppables:a,viewport:o,afterCritical:c})=>{const f=Y6({isMovingForward:n,pageBorderBoxCenter:e,source:r,droppables:a,viewport:o});if(!f)return null;const h=gf(f.descriptor.id,i),d=K6({pageBorderBoxCenter:e,viewport:o,destination:f,insideDestination:h,afterCritical:c}),g=J6({previousPageBorderBoxCenter:e,destination:f,draggable:t,draggables:i,moveRelativeTo:d,insideDestination:h,viewport:o,afterCritical:c});if(!g)return null;const m=vm({impact:g,draggable:t,droppable:f,draggables:i,afterCritical:c});return{clientSelection:Px({pageBorderBoxCenter:m,draggable:t,viewport:o}),impact:g,scrollJumpRequest:null}},as=n=>{const e=n.at;return e?e.type==="REORDER"?e.destination.droppableId:e.combine.droppableId:null};const t8=(n,e)=>{const t=as(n);return t?e[t]:null};var n8=({state:n,type:e})=>{const t=t8(n.impact,n.dimensions.droppables),r=!!t,i=n.dimensions.droppables[n.critical.droppable.id],a=t||i,o=a.axis.direction,c=o==="vertical"&&(e==="MOVE_UP"||e==="MOVE_DOWN")||o==="horizontal"&&(e==="MOVE_LEFT"||e==="MOVE_RIGHT");if(c&&!r)return null;const f=e==="MOVE_DOWN"||e==="MOVE_RIGHT",h=n.dimensions.draggables[n.critical.draggable.id],d=n.current.page.borderBoxCenter,{draggables:g,droppables:m}=n.dimensions;return c?X6({isMovingForward:f,previousPageBorderBoxCenter:d,draggable:h,destination:a,draggables:g,viewport:n.viewport,previousClientSelection:n.current.client.selection,previousImpact:n.impact,afterCritical:n.afterCritical}):e8({isMovingForward:f,previousPageBorderBoxCenter:d,draggable:h,isOver:a,draggables:g,droppables:m,viewport:n.viewport,afterCritical:n.afterCritical})};function oc(n){return n.phase==="DRAGGING"||n.phase==="COLLECTING"}function sC(n){const e=Ls(n.top,n.bottom),t=Ls(n.left,n.right);return function(i){return e(i.y)&&t(i.x)}}function r8(n,e){return n.left<e.right&&n.right>e.left&&n.top<e.bottom&&n.bottom>e.top}function i8({pageBorderBox:n,draggable:e,candidates:t}){const r=e.page.borderBox.center,i=t.map(a=>{const o=a.axis,c=wc(a.axis.line,n.center[o.line],a.page.borderBox.center[o.crossAxisLine]);return{id:a.descriptor.id,distance:bd(r,c)}}).sort((a,o)=>o.distance-a.distance);return i[0]?i[0].id:null}function s8({pageBorderBox:n,draggable:e,droppables:t}){const r=pm(t).filter(i=>{if(!i.isEnabled)return!1;const a=i.subject.active;if(!a||!r8(n,a))return!1;if(sC(a)(n.center))return!0;const o=i.axis,c=a.center[o.crossAxisLine],f=n[o.crossAxisStart],h=n[o.crossAxisEnd],d=Ls(a[o.crossAxisStart],a[o.crossAxisEnd]),g=d(f),m=d(h);return!g&&!m?!0:g?f<c:h>c});return r.length?r.length===1?r[0].descriptor.id:i8({pageBorderBox:n,draggable:e,candidates:r}):null}const aC=(n,e)=>Qs(Kd(n,e));var a8=(n,e)=>{const t=n.frame;return t?aC(e,t.scroll.diff.value):e};function oC({displaced:n,id:e}){return!!(n.visible[e]||n.invisible[e])}function o8({draggable:n,closest:e,inHomeList:t}){return e?t&&e.descriptor.index>n.descriptor.index?e.descriptor.index-1:e.descriptor.index:null}var l8=({pageBorderBoxWithDroppableScroll:n,draggable:e,destination:t,insideDestination:r,last:i,viewport:a,afterCritical:o})=>{const c=t.axis,f=Qd(t.axis,e.displaceBy),h=f.value,d=n[c.start],g=n[c.end],v=mm(e,r).find(b=>{const A=b.descriptor.id,w=b.page.borderBox.center[c.line],C=El(A,o),T=oC({displaced:i,id:A});return C?T?g<=w:d<w-h:T?g<=w+h:d<w})||null,y=o8({draggable:e,closest:v,inHomeList:mf(e,t)});return Tg({draggable:e,insideDestination:r,destination:t,viewport:a,last:i,displacedBy:f,index:y})};const c8=4;var u8=({draggable:n,pageBorderBoxWithDroppableScroll:e,previousImpact:t,destination:r,insideDestination:i,afterCritical:a})=>{if(!r.isCombineEnabled)return null;const o=r.axis,c=Qd(r.axis,n.displaceBy),f=c.value,h=e[o.start],d=e[o.end],m=mm(n,i).find(y=>{const b=y.descriptor.id,A=y.page.borderBox,C=A[o.size]/c8,T=El(b,a),R=oC({displaced:t.displaced,id:b});return T?R?d>A[o.start]+C&&d<A[o.end]-C:h>A[o.start]-f+C&&h<A[o.end]-f-C:R?d>A[o.start]+f+C&&d<A[o.end]+f-C:h>A[o.start]+C&&h<A[o.end]-C});return m?{displacedBy:c,displaced:t.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:r.descriptor.id}}}:null},lC=({pageOffset:n,draggable:e,draggables:t,droppables:r,previousImpact:i,viewport:a,afterCritical:o})=>{const c=aC(e.page.borderBox,n),f=s8({pageBorderBox:c,draggable:e,droppables:r});if(!f)return w6;const h=r[f],d=gf(h.descriptor.id,t),g=a8(h,c);return u8({pageBorderBoxWithDroppableScroll:g,draggable:e,previousImpact:i,destination:h,insideDestination:d,afterCritical:o})||l8({pageBorderBoxWithDroppableScroll:g,draggable:e,destination:h,insideDestination:d,last:i.displaced,viewport:a,afterCritical:o})},Bx=(n,e)=>({...n,[e.descriptor.id]:e});const f8=({previousImpact:n,impact:e,droppables:t})=>{const r=as(n),i=as(e);if(!r||r===i)return t;const a=t[r];if(!a.subject.withPlaceholder)return t;const o=Z6(a);return Bx(t,o)};var h8=({draggable:n,draggables:e,droppables:t,previousImpact:r,impact:i})=>{const a=f8({previousImpact:r,impact:i,droppables:t}),o=as(i);if(!o)return a;const c=t[o];if(mf(n,c)||c.subject.withPlaceholder)return a;const f=iC(c,n,e);return Bx(a,f)},od=({state:n,clientSelection:e,dimensions:t,viewport:r,impact:i,scrollJumpRequest:a})=>{const o=r||n.viewport,c=t||n.dimensions,f=e||n.current.client.selection,h=is(f,n.initial.client.selection),d={offset:h,selection:f,borderBoxCenter:kr(n.initial.client.borderBoxCenter,h)},g={selection:kr(d.selection,o.scroll.current),borderBoxCenter:kr(d.borderBoxCenter,o.scroll.current),offset:kr(d.offset,o.scroll.diff.value)},m={client:d,page:g};if(n.phase==="COLLECTING")return{...n,dimensions:c,viewport:o,current:m};const v=c.draggables[n.critical.draggable.id],y=i||lC({pageOffset:g.offset,draggable:v,draggables:c.draggables,droppables:c.droppables,previousImpact:n.impact,viewport:o,afterCritical:n.afterCritical}),b=h8({draggable:v,impact:y,previousImpact:n.impact,draggables:c.draggables,droppables:c.droppables});return{...n,current:m,dimensions:{draggables:c.draggables,droppables:b},impact:y,viewport:o,scrollJumpRequest:a||null,forceShouldAnimate:a?!1:null}};function d8(n,e){return n.map(t=>e[t])}var cC=({impact:n,viewport:e,draggables:t,destination:r,forceShouldAnimate:i})=>{const a=n.displaced,o=d8(a.all,t),c=Ad({afterDragging:o,destination:r,displacedBy:n.displacedBy,viewport:e.frame,forceShouldAnimate:i,last:a});return{...n,displaced:c}},uC=({impact:n,draggable:e,droppable:t,draggables:r,viewport:i,afterCritical:a})=>{const o=vm({impact:n,draggable:e,draggables:r,droppable:t,afterCritical:a});return Px({pageBorderBoxCenter:o,draggable:e,viewport:i})},fC=({state:n,dimensions:e,viewport:t})=>{n.movementMode!=="SNAP"&&Ke();const r=n.impact,i=t||n.viewport,a=e||n.dimensions,{draggables:o,droppables:c}=a,f=o[n.critical.draggable.id],h=as(r);h||Ke();const d=c[h],g=cC({impact:r,viewport:i,destination:d,draggables:o}),m=uC({impact:g,draggable:f,droppable:d,draggables:o,viewport:i,afterCritical:n.afterCritical});return od({impact:g,clientSelection:m,state:n,dimensions:a,viewport:i})},p8=n=>({index:n.index,droppableId:n.droppableId}),hC=({draggable:n,home:e,draggables:t,viewport:r})=>{const i=Qd(e.axis,n.displaceBy),a=gf(e.descriptor.id,t),o=a.indexOf(n);o===-1&&Ke();const c=a.slice(o+1),f=c.reduce((m,v)=>(m[v.descriptor.id]=!0,m),{}),h={inVirtualList:e.descriptor.mode==="virtual",displacedBy:i,effected:f};return{impact:{displaced:Ad({afterDragging:c,destination:e,displacedBy:i,last:null,viewport:r.frame,forceShouldAnimate:!1}),displacedBy:i,at:{type:"REORDER",destination:p8(n.descriptor)}},afterCritical:h}},g8=(n,e)=>({draggables:n.draggables,droppables:Bx(n.droppables,e)}),m8=({draggable:n,offset:e,initialWindowScroll:t})=>{const r=bg(n.client,e),i=Eg(r,t);return{...n,placeholder:{...n.placeholder,client:r},client:r,page:i}},v8=n=>{const e=n.frame;return e||Ke(),e},_8=({additions:n,updatedDroppables:e,viewport:t})=>{const r=t.scroll.diff.value;return n.map(i=>{const a=i.descriptor.droppableId,o=e[a],f=v8(o).scroll.diff.value,h=kr(r,f);return m8({draggable:i,offset:h,initialWindowScroll:t.scroll.initial})})},x8=({state:n,published:e})=>{const t=e.modified.map(w=>{const C=n.dimensions.droppables[w.droppableId];return Lx(C,w.scroll)}),r={...n.dimensions.droppables,...YT(t)},i=qT(_8({additions:e.additions,updatedDroppables:r,viewport:n.viewport})),a={...n.dimensions.draggables,...i};e.removals.forEach(w=>{delete a[w]});const o={droppables:r,draggables:a},c=as(n.impact),f=c?o.droppables[c]:null,h=o.draggables[n.critical.draggable.id],d=o.droppables[n.critical.droppable.id],{impact:g,afterCritical:m}=hC({draggable:h,home:d,draggables:a,viewport:n.viewport}),v=f&&f.isCombineEnabled?n.impact:g,y=lC({pageOffset:n.current.page.offset,draggable:o.draggables[n.critical.draggable.id],draggables:o.draggables,droppables:o.droppables,previousImpact:v,viewport:n.viewport,afterCritical:m}),b={...n,phase:"DRAGGING",impact:y,onLiftImpact:g,dimensions:o,afterCritical:m,forceShouldAnimate:!1};return n.phase==="COLLECTING"?b:{...b,phase:"DROP_PENDING",reason:n.reason,isWaiting:!1}};const D_=n=>n.movementMode==="SNAP",Uv=(n,e,t)=>{const r=g8(n.dimensions,e);return!D_(n)||t?od({state:n,dimensions:r}):fC({state:n,dimensions:r})};function Hv(n){return n.isDragging&&n.movementMode==="SNAP"?{...n,scrollJumpRequest:null}:n}const Cw={phase:"IDLE",completed:null,shouldFlush:!1};var y8=(n=Cw,e)=>{if(e.type==="FLUSH")return{...Cw,shouldFlush:!0};if(e.type==="INITIAL_PUBLISH"){n.phase!=="IDLE"&&Ke();const{critical:t,clientSelection:r,viewport:i,dimensions:a,movementMode:o}=e.payload,c=a.draggables[t.draggable.id],f=a.droppables[t.droppable.id],h={selection:r,borderBoxCenter:c.client.borderBox.center,offset:Sr},d={client:h,page:{selection:kr(h.selection,i.scroll.initial),borderBoxCenter:kr(h.selection,i.scroll.initial),offset:kr(h.selection,i.scroll.diff.value)}},g=pm(a.droppables).every(b=>!b.isFixedOnPage),{impact:m,afterCritical:v}=hC({draggable:c,home:f,draggables:a.draggables,viewport:i});return{phase:"DRAGGING",isDragging:!0,critical:t,movementMode:o,dimensions:a,initial:d,current:d,isWindowScrollAllowed:g,impact:m,afterCritical:v,onLiftImpact:m,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null}}if(e.type==="COLLECTION_STARTING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"?n:(n.phase!=="DRAGGING"&&Ke(),{...n,phase:"COLLECTING"});if(e.type==="PUBLISH_WHILE_DRAGGING")return n.phase==="COLLECTING"||n.phase==="DROP_PENDING"||Ke(),x8({state:n,published:e.payload});if(e.type==="MOVE"){if(n.phase==="DROP_PENDING")return n;oc(n)||Ke();const{client:t}=e.payload;return vl(t,n.current.client.selection)?n:od({state:n,clientSelection:t,impact:D_(n)?n.impact:null})}if(e.type==="UPDATE_DROPPABLE_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="COLLECTING")return Hv(n);oc(n)||Ke();const{id:t,newScroll:r}=e.payload,i=n.dimensions.droppables[t];if(!i)return n;const a=Lx(i,r);return Uv(n,a,!1)}if(e.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(n.phase==="DROP_PENDING")return n;oc(n)||Ke();const{id:t,isEnabled:r}=e.payload,i=n.dimensions.droppables[t];i||Ke(),i.isEnabled===r&&Ke();const a={...i,isEnabled:r};return Uv(n,a,!0)}if(e.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(n.phase==="DROP_PENDING")return n;oc(n)||Ke();const{id:t,isCombineEnabled:r}=e.payload,i=n.dimensions.droppables[t];i||Ke(),i.isCombineEnabled===r&&Ke();const a={...i,isCombineEnabled:r};return Uv(n,a,!0)}if(e.type==="MOVE_BY_WINDOW_SCROLL"){if(n.phase==="DROP_PENDING"||n.phase==="DROP_ANIMATING")return n;oc(n)||Ke(),n.isWindowScrollAllowed||Ke();const t=e.payload.newScroll;if(vl(n.viewport.scroll.current,t))return Hv(n);const r=tC(n.viewport,t);return D_(n)?fC({state:n,viewport:r}):od({state:n,viewport:r})}if(e.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!oc(n))return n;const t=e.payload.maxScroll;if(vl(t,n.viewport.scroll.max))return n;const r={...n.viewport,scroll:{...n.viewport.scroll,max:t}};return{...n,viewport:r}}if(e.type==="MOVE_UP"||e.type==="MOVE_DOWN"||e.type==="MOVE_LEFT"||e.type==="MOVE_RIGHT"){if(n.phase==="COLLECTING"||n.phase==="DROP_PENDING")return n;n.phase!=="DRAGGING"&&Ke();const t=n8({state:n,type:e.type});return t?od({state:n,impact:t.impact,clientSelection:t.clientSelection,scrollJumpRequest:t.scrollJumpRequest}):n}if(e.type==="DROP_PENDING"){const t=e.payload.reason;return n.phase!=="COLLECTING"&&Ke(),{...n,phase:"DROP_PENDING",isWaiting:!0,reason:t}}if(e.type==="DROP_ANIMATE"){const{completed:t,dropDuration:r,newHomeClientOffset:i}=e.payload;return n.phase==="DRAGGING"||n.phase==="DROP_PENDING"||Ke(),{phase:"DROP_ANIMATING",completed:t,dropDuration:r,newHomeClientOffset:i,dimensions:n.dimensions}}if(e.type==="DROP_COMPLETE"){const{completed:t}=e.payload;return{phase:"IDLE",completed:t,shouldFlush:!1}}return n};function ln(n,e){return n instanceof Object&&"type"in n&&n.type===e}const b8=n=>({type:"BEFORE_INITIAL_CAPTURE",payload:n}),E8=n=>({type:"LIFT",payload:n}),A8=n=>({type:"INITIAL_PUBLISH",payload:n}),w8=n=>({type:"PUBLISH_WHILE_DRAGGING",payload:n}),S8=()=>({type:"COLLECTION_STARTING",payload:null}),T8=n=>({type:"UPDATE_DROPPABLE_SCROLL",payload:n}),C8=n=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:n}),D8=n=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:n}),dC=n=>({type:"MOVE",payload:n}),O8=n=>({type:"MOVE_BY_WINDOW_SCROLL",payload:n}),R8=n=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:n}),N8=()=>({type:"MOVE_UP",payload:null}),L8=()=>({type:"MOVE_DOWN",payload:null}),M8=()=>({type:"MOVE_RIGHT",payload:null}),I8=()=>({type:"MOVE_LEFT",payload:null}),Ux=()=>({type:"FLUSH",payload:null}),k8=n=>({type:"DROP_ANIMATE",payload:n}),Hx=n=>({type:"DROP_COMPLETE",payload:n}),pC=n=>({type:"DROP",payload:n}),F8=n=>({type:"DROP_PENDING",payload:n}),gC=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var P8=n=>({getState:e,dispatch:t})=>r=>i=>{if(!ln(i,"LIFT")){r(i);return}const{id:a,clientSelection:o,movementMode:c}=i.payload,f=e();f.phase==="DROP_ANIMATING"&&t(Hx({completed:f.completed})),e().phase!=="IDLE"&&Ke(),t(Ux()),t(b8({draggableId:a,movementMode:c}));const d={draggableId:a,scrollOptions:{shouldPublishImmediately:c==="SNAP"}},{critical:g,dimensions:m,viewport:v}=n.startPublishing(d);t(A8({critical:g,dimensions:m,clientSelection:o,movementMode:c,viewport:v}))},B8=n=>()=>e=>t=>{ln(t,"INITIAL_PUBLISH")&&n.dragging(),ln(t,"DROP_ANIMATE")&&n.dropping(t.payload.completed.result.reason),(ln(t,"FLUSH")||ln(t,"DROP_COMPLETE"))&&n.resting(),e(t)};const zx={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},wd={opacity:{drop:0,combining:.7},scale:{drop:.75}},mC={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},sc=`${mC.outOfTheWay}s ${zx.outOfTheWay}`,ld={fluid:`opacity ${sc}`,snap:`transform ${sc}, opacity ${sc}`,drop:n=>{const e=`${n}s ${zx.drop}`;return`transform ${e}, opacity ${e}`},outOfTheWay:`transform ${sc}`,placeholder:`height ${sc}, width ${sc}, margin ${sc}`},Dw=n=>vl(n,Sr)?void 0:`translate(${n.x}px, ${n.y}px)`,O_={moveTo:Dw,drop:(n,e)=>{const t=Dw(n);if(t)return e?`${t} scale(${wd.scale.drop})`:t}},{minDropTime:R_,maxDropTime:vC}=mC,U8=vC-R_,Ow=1500,H8=.6;var z8=({current:n,destination:e,reason:t})=>{const r=bd(n,e);if(r<=0)return R_;if(r>=Ow)return vC;const i=r/Ow,a=R_+U8*i,o=t==="CANCEL"?a*H8:a;return Number(o.toFixed(2))},j8=({impact:n,draggable:e,dimensions:t,viewport:r,afterCritical:i})=>{const{draggables:a,droppables:o}=t,c=as(n),f=c?o[c]:null,h=o[e.descriptor.droppableId],d=uC({impact:n,draggable:e,draggables:a,afterCritical:i,droppable:f||h,viewport:r});return is(d,e.client.borderBox.center)},$8=({draggables:n,reason:e,lastImpact:t,home:r,viewport:i,onLiftImpact:a})=>!t.at||e!=="DROP"?{impact:cC({draggables:n,impact:a,destination:r,viewport:i,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:t.at.type==="REORDER"?{impact:t,didDropInsideDroppable:!0}:{impact:{...t,displaced:Ed},didDropInsideDroppable:!0};const G8=({getState:n,dispatch:e})=>t=>r=>{if(!ln(r,"DROP")){t(r);return}const i=n(),a=r.payload.reason;if(i.phase==="COLLECTING"){e(F8({reason:a}));return}if(i.phase==="IDLE")return;i.phase==="DROP_PENDING"&&i.isWaiting&&Ke(),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||Ke();const c=i.critical,f=i.dimensions,h=f.draggables[i.critical.draggable.id],{impact:d,didDropInsideDroppable:g}=$8({reason:a,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),m=g?Mx(d):null,v=g?gm(d):null,y={index:c.draggable.index,droppableId:c.droppable.id},b={draggableId:h.descriptor.id,type:h.descriptor.type,source:y,reason:a,mode:i.movementMode,destination:m,combine:v},A=j8({impact:d,draggable:h,dimensions:f,viewport:i.viewport,afterCritical:i.afterCritical}),w={critical:i.critical,afterCritical:i.afterCritical,result:b,impact:d};if(!(!vl(i.current.client.offset,A)||!!b.combine)){e(Hx({completed:w}));return}const T=z8({current:i.current.client.offset,destination:A,reason:a});e(k8({newHomeClientOffset:A,dropDuration:T,completed:w}))};var _C=()=>({x:window.pageXOffset,y:window.pageYOffset});function V8(n){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:e=>{e.target!==window&&e.target!==window.document||n()}}}function W8({onWindowScroll:n}){function e(){n(_C())}const t=yd(e),r=V8(t);let i=ml;function a(){return i!==ml}function o(){a()&&Ke(),i=Rs(window,[r])}function c(){a()||Ke(),t.cancel(),i(),i=ml}return{start:o,stop:c,isActive:a}}const X8=n=>ln(n,"DROP_COMPLETE")||ln(n,"DROP_ANIMATE")||ln(n,"FLUSH"),Y8=n=>{const e=W8({onWindowScroll:t=>{n.dispatch(O8({newScroll:t}))}});return t=>r=>{!e.isActive()&&ln(r,"INITIAL_PUBLISH")&&e.start(),e.isActive()&&X8(r)&&e.stop(),t(r)}};var q8=n=>{let e=!1,t=!1;const r=setTimeout(()=>{t=!0}),i=a=>{e||t||(e=!0,n(a),clearTimeout(r))};return i.wasCalled=()=>e,i},K8=()=>{const n=[],e=i=>{const a=n.findIndex(c=>c.timerId===i);a===-1&&Ke();const[o]=n.splice(a,1);o.callback()};return{add:i=>{const a=setTimeout(()=>e(a)),o={timerId:a,callback:i};n.push(o)},flush:()=>{if(!n.length)return;const i=[...n];n.length=0,i.forEach(a=>{clearTimeout(a.timerId),a.callback()})}}};const Q8=(n,e)=>n==null&&e==null?!0:n==null||e==null?!1:n.droppableId===e.droppableId&&n.index===e.index,Z8=(n,e)=>n==null&&e==null?!0:n==null||e==null?!1:n.draggableId===e.draggableId&&n.droppableId===e.droppableId,J8=(n,e)=>{if(n===e)return!0;const t=n.draggable.id===e.draggable.id&&n.draggable.droppableId===e.draggable.droppableId&&n.draggable.type===e.draggable.type&&n.draggable.index===e.draggable.index,r=n.droppable.id===e.droppable.id&&n.droppable.type===e.droppable.type;return t&&r},Yh=(n,e)=>{e()},Yp=(n,e)=>({draggableId:n.draggable.id,type:n.droppable.type,source:{droppableId:n.droppable.id,index:n.draggable.index},mode:e});function zv(n,e,t,r){if(!n){t(r(e));return}const i=q8(t);n(e,{announce:i}),i.wasCalled()||t(r(e))}var eB=(n,e)=>{const t=K8();let r=null;const i=(g,m)=>{r&&Ke(),Yh("onBeforeCapture",()=>{const v=n().onBeforeCapture;v&&v({draggableId:g,mode:m})})},a=(g,m)=>{r&&Ke(),Yh("onBeforeDragStart",()=>{const v=n().onBeforeDragStart;v&&v(Yp(g,m))})},o=(g,m)=>{r&&Ke();const v=Yp(g,m);r={mode:m,lastCritical:g,lastLocation:v.source,lastCombine:null},t.add(()=>{Yh("onDragStart",()=>zv(n().onDragStart,v,e,fg.onDragStart))})},c=(g,m)=>{const v=Mx(m),y=gm(m);r||Ke();const b=!J8(g,r.lastCritical);b&&(r.lastCritical=g);const A=!Q8(r.lastLocation,v);A&&(r.lastLocation=v);const w=!Z8(r.lastCombine,y);if(w&&(r.lastCombine=y),!b&&!A&&!w)return;const C={...Yp(g,r.mode),combine:y,destination:v};t.add(()=>{Yh("onDragUpdate",()=>zv(n().onDragUpdate,C,e,fg.onDragUpdate))})},f=()=>{r||Ke(),t.flush()},h=g=>{r||Ke(),r=null,Yh("onDragEnd",()=>zv(n().onDragEnd,g,e,fg.onDragEnd))};return{beforeCapture:i,beforeStart:a,start:o,update:c,flush:f,drop:h,abort:()=>{if(!r)return;const g={...Yp(r.lastCritical,r.mode),combine:null,destination:null,reason:"CANCEL"};h(g)}}},tB=(n,e)=>{const t=eB(n,e);return r=>i=>a=>{if(ln(a,"BEFORE_INITIAL_CAPTURE")){t.beforeCapture(a.payload.draggableId,a.payload.movementMode);return}if(ln(a,"INITIAL_PUBLISH")){const c=a.payload.critical;t.beforeStart(c,a.payload.movementMode),i(a),t.start(c,a.payload.movementMode);return}if(ln(a,"DROP_COMPLETE")){const c=a.payload.completed.result;t.flush(),i(a),t.drop(c);return}if(i(a),ln(a,"FLUSH")){t.abort();return}const o=r.getState();o.phase==="DRAGGING"&&t.update(o.critical,o.impact)}};const nB=n=>e=>t=>{if(!ln(t,"DROP_ANIMATION_FINISHED")){e(t);return}const r=n.getState();r.phase!=="DROP_ANIMATING"&&Ke(),n.dispatch(Hx({completed:r.completed}))},rB=n=>{let e=null,t=null;function r(){t&&(cancelAnimationFrame(t),t=null),e&&(e(),e=null)}return i=>a=>{if((ln(a,"FLUSH")||ln(a,"DROP_COMPLETE")||ln(a,"DROP_ANIMATION_FINISHED"))&&r(),i(a),!ln(a,"DROP_ANIMATE"))return;const o={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){n.getState().phase==="DROP_ANIMATING"&&n.dispatch(gC())}};t=requestAnimationFrame(()=>{t=null,e=Rs(window,[o])})}};var iB=n=>()=>e=>t=>{(ln(t,"DROP_COMPLETE")||ln(t,"FLUSH")||ln(t,"DROP_ANIMATE"))&&n.stopPublishing(),e(t)},sB=n=>{let e=!1;return()=>t=>r=>{if(ln(r,"INITIAL_PUBLISH")){e=!0,n.tryRecordFocus(r.payload.critical.draggable.id),t(r),n.tryRestoreFocusRecorded();return}if(t(r),!!e){if(ln(r,"FLUSH")){e=!1,n.tryRestoreFocusRecorded();return}if(ln(r,"DROP_COMPLETE")){e=!1;const i=r.payload.completed.result;i.combine&&n.tryShiftRecord(i.draggableId,i.combine.draggableId),n.tryRestoreFocusRecorded()}}}};const aB=n=>ln(n,"DROP_COMPLETE")||ln(n,"DROP_ANIMATE")||ln(n,"FLUSH");var oB=n=>e=>t=>r=>{if(aB(r)){n.stop(),t(r);return}if(ln(r,"INITIAL_PUBLISH")){t(r);const i=e.getState();i.phase!=="DRAGGING"&&Ke(),n.start(i);return}t(r),n.scroll(e.getState())};const lB=n=>e=>t=>{if(e(t),!ln(t,"PUBLISH_WHILE_DRAGGING"))return;const r=n.getState();r.phase==="DROP_PENDING"&&(r.isWaiting||n.dispatch(pC({reason:r.reason})))},cB=IT;var uB=({dimensionMarshal:n,focusMarshal:e,styleMarshal:t,getResponders:r,announce:i,autoScroller:a})=>MT(y8,cB(cP(B8(t),iB(n),P8(n),G8,nB,rB,lB,oB(a),Y8,sB(e),tB(r,i))));const jv=()=>({additions:{},removals:{},modified:{}});function fB({registry:n,callbacks:e}){let t=jv(),r=null;const i=()=>{r||(e.collectionStarting(),r=requestAnimationFrame(()=>{r=null;const{additions:f,removals:h,modified:d}=t,g=Object.keys(f).map(y=>n.draggable.getById(y).getDimension(Sr)).sort((y,b)=>y.descriptor.index-b.descriptor.index),m=Object.keys(d).map(y=>{const A=n.droppable.getById(y).callbacks.getScrollWhileDragging();return{droppableId:y,scroll:A}}),v={additions:g,removals:Object.keys(h),modified:m};t=jv(),e.publish(v)}))};return{add:f=>{const h=f.descriptor.id;t.additions[h]=f,t.modified[f.descriptor.droppableId]=!0,t.removals[h]&&delete t.removals[h],i()},remove:f=>{const h=f.descriptor;t.removals[h.id]=!0,t.modified[h.droppableId]=!0,t.additions[h.id]&&delete t.additions[h.id],i()},stop:()=>{r&&(cancelAnimationFrame(r),r=null,t=jv())}}}var xC=({scrollHeight:n,scrollWidth:e,height:t,width:r})=>{const i=is({x:e,y:n},{x:r,y:t});return{x:Math.max(0,i.x),y:Math.max(0,i.y)}},yC=()=>{const n=document.documentElement;return n||Ke(),n},bC=()=>{const n=yC();return xC({scrollHeight:n.scrollHeight,scrollWidth:n.scrollWidth,width:n.clientWidth,height:n.clientHeight})},hB=()=>{const n=_C(),e=bC(),t=n.y,r=n.x,i=yC(),a=i.clientWidth,o=i.clientHeight,c=r+a,f=t+o;return{frame:Qs({top:t,left:r,right:c,bottom:f}),scroll:{initial:n,current:n,max:e,diff:{value:Sr,displacement:Sr}}}},dB=({critical:n,scrollOptions:e,registry:t})=>{const r=hB(),i=r.scroll.current,a=n.droppable,o=t.droppable.getAllByType(a.type).map(d=>d.callbacks.getDimensionAndWatchScroll(i,e)),c=t.draggable.getAllByType(n.draggable.type).map(d=>d.getDimension(i));return{dimensions:{draggables:qT(c),droppables:YT(o)},critical:n,viewport:r}};function Rw(n,e,t){return!(t.descriptor.id===e.id||t.descriptor.type!==e.type||n.droppable.getById(t.descriptor.droppableId).descriptor.mode!=="virtual")}var pB=(n,e)=>{let t=null;const r=fB({callbacks:{publish:e.publishWhileDragging,collectionStarting:e.collectionStarting},registry:n}),i=(m,v)=>{n.droppable.exists(m)||Ke(),t&&e.updateDroppableIsEnabled({id:m,isEnabled:v})},a=(m,v)=>{t&&(n.droppable.exists(m)||Ke(),e.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:v}))},o=(m,v)=>{t&&(n.droppable.exists(m)||Ke(),e.updateDroppableScroll({id:m,newScroll:v}))},c=(m,v)=>{t&&n.droppable.getById(m).callbacks.scroll(v)},f=()=>{if(!t)return;r.stop();const m=t.critical.droppable;n.droppable.getAllByType(m.type).forEach(v=>v.callbacks.dragStopped()),t.unsubscribe(),t=null},h=m=>{t||Ke();const v=t.critical.draggable;m.type==="ADDITION"&&Rw(n,v,m.value)&&r.add(m.value),m.type==="REMOVAL"&&Rw(n,v,m.value)&&r.remove(m.value)};return{updateDroppableIsEnabled:i,updateDroppableIsCombineEnabled:a,scrollDroppable:c,updateDroppableScroll:o,startPublishing:m=>{t&&Ke();const v=n.draggable.getById(m.draggableId),y=n.droppable.getById(v.descriptor.droppableId),b={draggable:v.descriptor,droppable:y.descriptor},A=n.subscribe(h);return t={critical:b,unsubscribe:A},dB({critical:b,registry:n,scrollOptions:m.scrollOptions})},stopPublishing:f}},EC=(n,e)=>n.phase==="IDLE"?!0:n.phase!=="DROP_ANIMATING"||n.completed.result.draggableId===e?!1:n.completed.result.reason==="DROP",gB=n=>{window.scrollBy(n.x,n.y)};const mB=wr(n=>pm(n).filter(e=>!(!e.isEnabled||!e.frame))),vB=(n,e)=>mB(e).find(r=>(r.frame||Ke(),sC(r.frame.pageMarginBox)(n)))||null;var _B=({center:n,destination:e,droppables:t})=>{if(e){const i=t[e];return i.frame?i:null}return vB(n,t)};const Sd={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:n=>n**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var xB=(n,e,t=()=>Sd)=>{const r=t(),i=n[e.size]*r.startFromPercentage,a=n[e.size]*r.maxScrollAtPercentage;return{startScrollingFrom:i,maxScrollValueAt:a}},AC=({startOfRange:n,endOfRange:e,current:t})=>{const r=e-n;return r===0?0:(t-n)/r},jx=1,yB=(n,e,t=()=>Sd)=>{const r=t();if(n>e.startScrollingFrom)return 0;if(n<=e.maxScrollValueAt)return r.maxPixelScroll;if(n===e.startScrollingFrom)return jx;const a=1-AC({startOfRange:e.maxScrollValueAt,endOfRange:e.startScrollingFrom,current:n}),o=r.maxPixelScroll*r.ease(a);return Math.ceil(o)},bB=(n,e,t)=>{const r=t(),i=r.durationDampening.accelerateAt,a=r.durationDampening.stopDampeningAt,o=e,c=a,h=Date.now()-o;if(h>=a)return n;if(h<i)return jx;const d=AC({startOfRange:i,endOfRange:c,current:h}),g=n*r.ease(d);return Math.ceil(g)},Nw=({distanceToEdge:n,thresholds:e,dragStartTime:t,shouldUseTimeDampening:r,getAutoScrollerOptions:i})=>{const a=yB(n,e,i);return a===0?0:r?Math.max(bB(a,t,i),jx):a},Lw=({container:n,distanceToEdges:e,dragStartTime:t,axis:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const o=xB(n,r,a);return e[r.end]<e[r.start]?Nw({distanceToEdge:e[r.end],thresholds:o,dragStartTime:t,shouldUseTimeDampening:i,getAutoScrollerOptions:a}):-1*Nw({distanceToEdge:e[r.start],thresholds:o,dragStartTime:t,shouldUseTimeDampening:i,getAutoScrollerOptions:a})},EB=({container:n,subject:e,proposedScroll:t})=>{const r=e.height>n.height,i=e.width>n.width;return!i&&!r?t:i&&r?null:{x:i?0:t.x,y:r?0:t.y}};const AB=XT(n=>n===0?0:n);var wC=({dragStartTime:n,container:e,subject:t,center:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const o={top:r.y-e.top,right:e.right-r.x,bottom:e.bottom-r.y,left:r.x-e.left},c=Lw({container:e,distanceToEdges:o,dragStartTime:n,axis:Ix,shouldUseTimeDampening:i,getAutoScrollerOptions:a}),f=Lw({container:e,distanceToEdges:o,dragStartTime:n,axis:ZT,shouldUseTimeDampening:i,getAutoScrollerOptions:a}),h=AB({x:f,y:c});if(vl(h,Sr))return null;const d=EB({container:e,subject:t,proposedScroll:h});return d?vl(d,Sr)?null:d:null};const wB=XT(n=>n===0?0:n>0?1:-1),$x=(()=>{const n=(e,t)=>e<0?e:e>t?e-t:0;return({current:e,max:t,change:r})=>{const i=kr(e,r),a={x:n(i.x,t.x),y:n(i.y,t.y)};return vl(a,Sr)?null:a}})(),SC=({max:n,current:e,change:t})=>{const r={x:Math.max(e.x,n.x),y:Math.max(e.y,n.y)},i=wB(t),a=$x({max:r,current:e,change:i});return!a||i.x!==0&&a.x===0||i.y!==0&&a.y===0},Gx=(n,e)=>SC({current:n.scroll.current,max:n.scroll.max,change:e}),SB=(n,e)=>{if(!Gx(n,e))return null;const t=n.scroll.max,r=n.scroll.current;return $x({current:r,max:t,change:e})},Vx=(n,e)=>{const t=n.frame;return t?SC({current:t.scroll.current,max:t.scroll.max,change:e}):!1},TB=(n,e)=>{const t=n.frame;return!t||!Vx(n,e)?null:$x({current:t.scroll.current,max:t.scroll.max,change:e})};var CB=({viewport:n,subject:e,center:t,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const o=wC({dragStartTime:r,container:n.frame,subject:e,center:t,shouldUseTimeDampening:i,getAutoScrollerOptions:a});return o&&Gx(n,o)?o:null},DB=({droppable:n,subject:e,center:t,dragStartTime:r,shouldUseTimeDampening:i,getAutoScrollerOptions:a})=>{const o=n.frame;if(!o)return null;const c=wC({dragStartTime:r,container:o.pageMarginBox,subject:e,center:t,shouldUseTimeDampening:i,getAutoScrollerOptions:a});return c&&Vx(n,c)?c:null},Mw=({state:n,dragStartTime:e,shouldUseTimeDampening:t,scrollWindow:r,scrollDroppable:i,getAutoScrollerOptions:a})=>{const o=n.current.page.borderBoxCenter,f=n.dimensions.draggables[n.critical.draggable.id].page.marginBox;if(n.isWindowScrollAllowed){const g=n.viewport,m=CB({dragStartTime:e,viewport:g,subject:f,center:o,shouldUseTimeDampening:t,getAutoScrollerOptions:a});if(m){r(m);return}}const h=_B({center:o,destination:as(n.impact),droppables:n.dimensions.droppables});if(!h)return;const d=DB({dragStartTime:e,droppable:h,subject:f,center:o,shouldUseTimeDampening:t,getAutoScrollerOptions:a});d&&i(h.descriptor.id,d)},OB=({scrollWindow:n,scrollDroppable:e,getAutoScrollerOptions:t=()=>Sd})=>{const r=yd(n),i=yd(e);let a=null;const o=h=>{a||Ke();const{shouldUseTimeDampening:d,dragStartTime:g}=a;Mw({state:h,scrollWindow:r,scrollDroppable:i,dragStartTime:g,shouldUseTimeDampening:d,getAutoScrollerOptions:t})};return{start:h=>{a&&Ke();const d=Date.now();let g=!1;const m=()=>{g=!0};Mw({state:h,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m,getAutoScrollerOptions:t}),a={dragStartTime:d,shouldUseTimeDampening:g},g&&o(h)},stop:()=>{a&&(r.cancel(),i.cancel(),a=null)},scroll:o}},RB=({move:n,scrollDroppable:e,scrollWindow:t})=>{const r=(c,f)=>{const h=kr(c.current.client.selection,f);n({client:h})},i=(c,f)=>{if(!Vx(c,f))return f;const h=TB(c,f);if(!h)return e(c.descriptor.id,f),null;const d=is(f,h);return e(c.descriptor.id,d),is(f,d)},a=(c,f,h)=>{if(!c||!Gx(f,h))return h;const d=SB(f,h);if(!d)return t(h),null;const g=is(h,d);return t(g),is(h,g)};return c=>{const f=c.scrollJumpRequest;if(!f)return;const h=as(c.impact);h||Ke();const d=i(c.dimensions.droppables[h],f);if(!d)return;const g=c.viewport,m=a(c.isWindowScrollAllowed,g,d);m&&r(c,m)}},NB=({scrollDroppable:n,scrollWindow:e,move:t,getAutoScrollerOptions:r})=>{const i=OB({scrollWindow:e,scrollDroppable:n,getAutoScrollerOptions:r}),a=RB({move:t,scrollWindow:e,scrollDroppable:n});return{scroll:f=>{if(!(r().disabled||f.phase!=="DRAGGING")){if(f.movementMode==="FLUID"){i.scroll(f);return}f.scrollJumpRequest&&a(f)}},start:i.start,stop:i.stop}};const sf="data-rfd",af=(()=>{const n=`${sf}-drag-handle`;return{base:n,draggableId:`${n}-draggable-id`,contextId:`${n}-context-id`}})(),N_=(()=>{const n=`${sf}-draggable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),LB=(()=>{const n=`${sf}-droppable`;return{base:n,contextId:`${n}-context-id`,id:`${n}-id`}})(),Iw={contextId:`${sf}-scroll-container-context-id`},MB=n=>e=>`[${e}="${n}"]`,qh=(n,e)=>n.map(t=>{const r=t.styles[e];return r?`${t.selector} { ${r} }`:""}).join(" "),IB="pointer-events: none;";var kB=n=>{const e=MB(n),t=(()=>{const c=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:e(af.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:c,dragging:IB,dropAnimating:c}}})(),r=(()=>{const c=`
      transition: ${ld.outOfTheWay};
    `;return{selector:e(N_.contextId),styles:{dragging:c,dropAnimating:c,userCancel:c}}})(),i={selector:e(LB.contextId),styles:{always:"overflow-anchor: none;"}},o=[r,t,i,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:qh(o,"always"),resting:qh(o,"resting"),dragging:qh(o,"dragging"),dropAnimating:qh(o,"dropAnimating"),userCancel:qh(o,"userCancel")}};const os=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?le.useLayoutEffect:le.useEffect,$v=()=>{const n=document.querySelector("head");return n||Ke(),n},kw=n=>{const e=document.createElement("style");return n&&e.setAttribute("nonce",n),e.type="text/css",e};function FB(n,e){const t=Zt(()=>kB(n),[n]),r=le.useRef(null),i=le.useRef(null),a=ft(wr(g=>{const m=i.current;m||Ke(),m.textContent=g}),[]),o=ft(g=>{const m=r.current;m||Ke(),m.textContent=g},[]);os(()=>{!r.current&&!i.current||Ke();const g=kw(e),m=kw(e);return r.current=g,i.current=m,g.setAttribute(`${sf}-always`,n),m.setAttribute(`${sf}-dynamic`,n),$v().appendChild(g),$v().appendChild(m),o(t.always),a(t.resting),()=>{const v=y=>{const b=y.current;b||Ke(),$v().removeChild(b),y.current=null};v(r),v(i)}},[e,o,a,t.always,t.resting,n]);const c=ft(()=>a(t.dragging),[a,t.dragging]),f=ft(g=>{if(g==="DROP"){a(t.dropAnimating);return}a(t.userCancel)},[a,t.dropAnimating,t.userCancel]),h=ft(()=>{i.current&&a(t.resting)},[a,t.resting]);return Zt(()=>({dragging:c,dropping:f,resting:h}),[c,f,h])}function TC(n,e){return Array.from(n.querySelectorAll(e))}var CC=n=>n&&n.ownerDocument&&n.ownerDocument.defaultView?n.ownerDocument.defaultView:window;function _m(n){return n instanceof CC(n).HTMLElement}function PB(n,e){const t=`[${af.contextId}="${n}"]`,r=TC(document,t);if(!r.length)return null;const i=r.find(a=>a.getAttribute(af.draggableId)===e);return!i||!_m(i)?null:i}function BB(n){const e=le.useRef({}),t=le.useRef(null),r=le.useRef(null),i=le.useRef(!1),a=ft(function(m,v){const y={id:m,focus:v};return e.current[m]=y,function(){const A=e.current;A[m]!==y&&delete A[m]}},[]),o=ft(function(m){const v=PB(n,m);v&&v!==document.activeElement&&v.focus()},[n]),c=ft(function(m,v){t.current===m&&(t.current=v)},[]),f=ft(function(){r.current||i.current&&(r.current=requestAnimationFrame(()=>{r.current=null;const m=t.current;m&&o(m)}))},[o]),h=ft(function(m){t.current=null;const v=document.activeElement;v&&v.getAttribute(af.draggableId)===m&&(t.current=m)},[]);return os(()=>(i.current=!0,function(){i.current=!1;const m=r.current;m&&cancelAnimationFrame(m)}),[]),Zt(()=>({register:a,tryRecordFocus:h,tryRestoreFocusRecorded:f,tryShiftRecord:c}),[a,h,f,c])}function UB(){const n={draggables:{},droppables:{}},e=[];function t(g){return e.push(g),function(){const v=e.indexOf(g);v!==-1&&e.splice(v,1)}}function r(g){e.length&&e.forEach(m=>m(g))}function i(g){return n.draggables[g]||null}function a(g){const m=i(g);return m||Ke(),m}const o={register:g=>{n.draggables[g.descriptor.id]=g,r({type:"ADDITION",value:g})},update:(g,m)=>{const v=n.draggables[m.descriptor.id];v&&v.uniqueId===g.uniqueId&&(delete n.draggables[m.descriptor.id],n.draggables[g.descriptor.id]=g)},unregister:g=>{const m=g.descriptor.id,v=i(m);v&&g.uniqueId===v.uniqueId&&(delete n.draggables[m],n.droppables[g.descriptor.droppableId]&&r({type:"REMOVAL",value:g}))},getById:a,findById:i,exists:g=>!!i(g),getAllByType:g=>Object.values(n.draggables).filter(m=>m.descriptor.type===g)};function c(g){return n.droppables[g]||null}function f(g){const m=c(g);return m||Ke(),m}const h={register:g=>{n.droppables[g.descriptor.id]=g},unregister:g=>{const m=c(g.descriptor.id);m&&g.uniqueId===m.uniqueId&&delete n.droppables[g.descriptor.id]},getById:f,findById:c,exists:g=>!!c(g),getAllByType:g=>Object.values(n.droppables).filter(m=>m.descriptor.type===g)};function d(){n.draggables={},n.droppables={},e.length=0}return{draggable:o,droppable:h,subscribe:t,clean:d}}function HB(){const n=Zt(UB,[]);return le.useEffect(()=>function(){n.clean()},[n]),n}var Wx=Yn.createContext(null),Cg=()=>{const n=document.body;return n||Ke(),n};const zB={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},jB=n=>`rfd-announcement-${n}`;function $B(n){const e=Zt(()=>jB(n),[n]),t=le.useRef(null);return le.useEffect(function(){const a=document.createElement("div");return t.current=a,a.id=e,a.setAttribute("aria-live","assertive"),a.setAttribute("aria-atomic","true"),Ag(a.style,zB),Cg().appendChild(a),function(){setTimeout(function(){const f=Cg();f.contains(a)&&f.removeChild(a),a===t.current&&(t.current=null)})}},[e]),ft(i=>{const a=t.current;if(a){a.textContent=i;return}},[])}const GB={separator:"::"};function Xx(n,e=GB){const t=Yn.useId();return Zt(()=>`${n}${e.separator}${t}`,[e.separator,n,t])}function VB({contextId:n,uniqueId:e}){return`rfd-hidden-text-${n}-${e}`}function WB({contextId:n,text:e}){const t=Xx("hidden-text",{separator:"-"}),r=Zt(()=>VB({contextId:n,uniqueId:t}),[t,n]);return le.useEffect(function(){const a=document.createElement("div");return a.id=r,a.textContent=e,a.style.display="none",Cg().appendChild(a),function(){const c=Cg();c.contains(a)&&c.removeChild(a)}},[r,e]),r}var xm=Yn.createContext(null);function DC(n){const e=le.useRef(n);return le.useEffect(()=>{e.current=n}),e}function XB(){let n=null;function e(){return!!n}function t(o){return o===n}function r(o){n&&Ke();const c={abandon:o};return n=c,c}function i(){n||Ke(),n=null}function a(){n&&(n.abandon(),i())}return{isClaimed:e,isActive:t,claim:r,release:i,tryAbandon:a}}function Td(n){return n.phase==="IDLE"||n.phase==="DROP_ANIMATING"?!1:n.isDragging}const YB=9,qB=13,Yx=27,OC=32,KB=33,QB=34,ZB=35,JB=36,e5=37,t5=38,n5=39,r5=40,i5={[qB]:!0,[YB]:!0};var RC=n=>{i5[n.keyCode]&&n.preventDefault()};const ym=(()=>{const n="visibilitychange";return typeof document>"u"?n:[n,`ms${n}`,`webkit${n}`,`moz${n}`,`o${n}`].find(r=>`on${r}`in document)||n})(),NC=0,Fw=5;function s5(n,e){return Math.abs(e.x-n.x)>=Fw||Math.abs(e.y-n.y)>=Fw}const Pw={type:"IDLE"};function a5({cancel:n,completed:e,getPhase:t,setPhase:r}){return[{eventName:"mousemove",fn:i=>{const{button:a,clientX:o,clientY:c}=i;if(a!==NC)return;const f={x:o,y:c},h=t();if(h.type==="DRAGGING"){i.preventDefault(),h.actions.move(f);return}h.type!=="PENDING"&&Ke();const d=h.point;if(!s5(d,f))return;i.preventDefault();const g=h.actions.fluidLift(f);r({type:"DRAGGING",actions:g})}},{eventName:"mouseup",fn:i=>{const a=t();if(a.type!=="DRAGGING"){n();return}i.preventDefault(),a.actions.drop({shouldBlockNextClick:!0}),e()}},{eventName:"mousedown",fn:i=>{t().type==="DRAGGING"&&i.preventDefault(),n()}},{eventName:"keydown",fn:i=>{if(t().type==="PENDING"){n();return}if(i.keyCode===Yx){i.preventDefault(),n();return}RC(i)}},{eventName:"resize",fn:n},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{t().type==="PENDING"&&n()}},{eventName:"webkitmouseforcedown",fn:i=>{const a=t();if(a.type==="IDLE"&&Ke(),a.actions.shouldRespectForcePress()){n();return}i.preventDefault()}},{eventName:ym,fn:n}]}function o5(n){const e=le.useRef(Pw),t=le.useRef(ml),r=Zt(()=>({eventName:"mousedown",fn:function(g){if(g.defaultPrevented||g.button!==NC||g.ctrlKey||g.metaKey||g.shiftKey||g.altKey)return;const m=n.findClosestDraggableId(g);if(!m)return;const v=n.tryGetLock(m,o,{sourceEvent:g});if(!v)return;g.preventDefault();const y={x:g.clientX,y:g.clientY};t.current(),h(v,y)}}),[n]),i=Zt(()=>({eventName:"webkitmouseforcewillbegin",fn:d=>{if(d.defaultPrevented)return;const g=n.findClosestDraggableId(d);if(!g)return;const m=n.findOptionsForDraggable(g);m&&(m.shouldRespectForcePress||n.canGetLock(g)&&d.preventDefault())}}),[n]),a=ft(function(){const g={passive:!1,capture:!0};t.current=Rs(window,[i,r],g)},[i,r]),o=ft(()=>{e.current.type!=="IDLE"&&(e.current=Pw,t.current(),a())},[a]),c=ft(()=>{const d=e.current;o(),d.type==="DRAGGING"&&d.actions.cancel({shouldBlockNextClick:!0}),d.type==="PENDING"&&d.actions.abort()},[o]),f=ft(function(){const g={capture:!0,passive:!1},m=a5({cancel:c,completed:o,getPhase:()=>e.current,setPhase:v=>{e.current=v}});t.current=Rs(window,m,g)},[c,o]),h=ft(function(g,m){e.current.type!=="IDLE"&&Ke(),e.current={type:"PENDING",point:m,actions:g},f()},[f]);os(function(){return a(),function(){t.current()}},[a])}function l5(){}const c5={[QB]:!0,[KB]:!0,[JB]:!0,[ZB]:!0};function u5(n,e){function t(){e(),n.cancel()}function r(){e(),n.drop()}return[{eventName:"keydown",fn:i=>{if(i.keyCode===Yx){i.preventDefault(),t();return}if(i.keyCode===OC){i.preventDefault(),r();return}if(i.keyCode===r5){i.preventDefault(),n.moveDown();return}if(i.keyCode===t5){i.preventDefault(),n.moveUp();return}if(i.keyCode===n5){i.preventDefault(),n.moveRight();return}if(i.keyCode===e5){i.preventDefault(),n.moveLeft();return}if(c5[i.keyCode]){i.preventDefault();return}RC(i)}},{eventName:"mousedown",fn:t},{eventName:"mouseup",fn:t},{eventName:"click",fn:t},{eventName:"touchstart",fn:t},{eventName:"resize",fn:t},{eventName:"wheel",fn:t,options:{passive:!0}},{eventName:ym,fn:t}]}function f5(n){const e=le.useRef(l5),t=Zt(()=>({eventName:"keydown",fn:function(a){if(a.defaultPrevented||a.keyCode!==OC)return;const o=n.findClosestDraggableId(a);if(!o)return;const c=n.tryGetLock(o,d,{sourceEvent:a});if(!c)return;a.preventDefault();let f=!0;const h=c.snapLift();e.current();function d(){f||Ke(),f=!1,e.current(),r()}e.current=Rs(window,u5(h,d),{capture:!0,passive:!1})}}),[n]),r=ft(function(){const a={passive:!1,capture:!0};e.current=Rs(window,[t],a)},[t]);os(function(){return r(),function(){e.current()}},[r])}const Gv={type:"IDLE"},h5=120,d5=.15;function p5({cancel:n,getPhase:e}){return[{eventName:"orientationchange",fn:n},{eventName:"resize",fn:n},{eventName:"contextmenu",fn:t=>{t.preventDefault()}},{eventName:"keydown",fn:t=>{if(e().type!=="DRAGGING"){n();return}t.keyCode===Yx&&t.preventDefault(),n()}},{eventName:ym,fn:n}]}function g5({cancel:n,completed:e,getPhase:t}){return[{eventName:"touchmove",options:{capture:!1},fn:r=>{const i=t();if(i.type!=="DRAGGING"){n();return}i.hasMoved=!0;const{clientX:a,clientY:o}=r.touches[0],c={x:a,y:o};r.preventDefault(),i.actions.move(c)}},{eventName:"touchend",fn:r=>{const i=t();if(i.type!=="DRAGGING"){n();return}r.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),e()}},{eventName:"touchcancel",fn:r=>{if(t().type!=="DRAGGING"){n();return}r.preventDefault(),n()}},{eventName:"touchforcechange",fn:r=>{const i=t();i.type==="IDLE"&&Ke();const a=r.touches[0];if(!a||!(a.force>=d5))return;const c=i.actions.shouldRespectForcePress();if(i.type==="PENDING"){c&&n();return}if(c){if(i.hasMoved){r.preventDefault();return}n();return}r.preventDefault()}},{eventName:ym,fn:n}]}function m5(n){const e=le.useRef(Gv),t=le.useRef(ml),r=ft(function(){return e.current},[]),i=ft(function(v){e.current=v},[]),a=Zt(()=>({eventName:"touchstart",fn:function(v){if(v.defaultPrevented)return;const y=n.findClosestDraggableId(v);if(!y)return;const b=n.tryGetLock(y,c,{sourceEvent:v});if(!b)return;const A=v.touches[0],{clientX:w,clientY:C}=A,T={x:w,y:C};t.current(),g(b,T)}}),[n]),o=ft(function(){const v={capture:!0,passive:!1};t.current=Rs(window,[a],v)},[a]),c=ft(()=>{const m=e.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),i(Gv),t.current(),o())},[o,i]),f=ft(()=>{const m=e.current;c(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[c]),h=ft(function(){const v={capture:!0,passive:!1},y={cancel:f,completed:c,getPhase:r},b=Rs(window,g5(y),v),A=Rs(window,p5(y),v);t.current=function(){b(),A()}},[f,r,c]),d=ft(function(){const v=r();v.type!=="PENDING"&&Ke();const y=v.actions.fluidLift(v.point);i({type:"DRAGGING",actions:y,hasMoved:!1})},[r,i]),g=ft(function(v,y){r().type!=="IDLE"&&Ke();const b=setTimeout(d,h5);i({type:"PENDING",point:y,actions:v,longPressTimerId:b}),h()},[h,r,i,d]);os(function(){return o(),function(){t.current();const y=r();y.type==="PENDING"&&(clearTimeout(y.longPressTimerId),i(Gv))}},[r,o,i]),os(function(){return Rs(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const v5=["input","button","textarea","select","option","optgroup","video","audio"];function LC(n,e){if(e==null)return!1;if(v5.includes(e.tagName.toLowerCase()))return!0;const r=e.getAttribute("contenteditable");return r==="true"||r===""?!0:e===n?!1:LC(n,e.parentElement)}function _5(n,e){const t=e.target;return _m(t)?LC(n,t):!1}var x5=n=>Qs(n.getBoundingClientRect()).center;function y5(n){return n instanceof CC(n).Element}const b5=(()=>{const n="matches";return typeof document>"u"?n:[n,"msMatchesSelector","webkitMatchesSelector"].find(r=>r in Element.prototype)||n})();function MC(n,e){return n==null?null:n[b5](e)?n:MC(n.parentElement,e)}function E5(n,e){return n.closest?n.closest(e):MC(n,e)}function A5(n){return`[${af.contextId}="${n}"]`}function w5(n,e){const t=e.target;if(!y5(t))return null;const r=A5(n),i=E5(t,r);return!i||!_m(i)?null:i}function S5(n,e){const t=w5(n,e);return t?t.getAttribute(af.draggableId):null}function T5(n,e){const t=`[${N_.contextId}="${n}"]`,i=TC(document,t).find(a=>a.getAttribute(N_.id)===e);return!i||!_m(i)?null:i}function C5(n){n.preventDefault()}function qp({expected:n,phase:e,isLockActive:t,shouldWarn:r}){return!(!t()||n!==e)}function IC({lockAPI:n,store:e,registry:t,draggableId:r}){if(n.isClaimed())return!1;const i=t.draggable.findById(r);return!(!i||!i.options.isEnabled||!EC(e.getState(),r))}function D5({lockAPI:n,contextId:e,store:t,registry:r,draggableId:i,forceSensorStop:a,sourceEvent:o}){if(!IC({lockAPI:n,store:t,registry:r,draggableId:i}))return null;const f=r.draggable.getById(i),h=T5(e,f.descriptor.id);if(!h||o&&!f.options.canDragInteractiveElements&&_5(h,o))return null;const d=n.claim(a||ml);let g="PRE_DRAG";function m(){return f.options.shouldRespectForcePress}function v(){return n.isActive(d)}function y(N,I){qp({expected:N,phase:g,isLockActive:v,shouldWarn:!0})&&t.dispatch(I())}const b=y.bind(null,"DRAGGING");function A(N){function I(){n.release(),g="COMPLETED"}g!=="PRE_DRAG"&&(I(),Ke()),t.dispatch(E8(N.liftActionArgs)),g="DRAGGING";function D(B,U={shouldBlockNextClick:!1}){if(N.cleanup(),U.shouldBlockNextClick){const Y=Rs(window,[{eventName:"click",fn:C5,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(Y)}I(),t.dispatch(pC({reason:B}))}return{isActive:()=>qp({expected:"DRAGGING",phase:g,isLockActive:v,shouldWarn:!1}),shouldRespectForcePress:m,drop:B=>D("DROP",B),cancel:B=>D("CANCEL",B),...N.actions}}function w(N){const I=yd(B=>{b(()=>dC({client:B}))});return{...A({liftActionArgs:{id:i,clientSelection:N,movementMode:"FLUID"},cleanup:()=>I.cancel(),actions:{move:I}}),move:I}}function C(){const N={moveUp:()=>b(N8),moveRight:()=>b(M8),moveDown:()=>b(L8),moveLeft:()=>b(I8)};return A({liftActionArgs:{id:i,clientSelection:x5(h),movementMode:"SNAP"},cleanup:ml,actions:N})}function T(){qp({expected:"PRE_DRAG",phase:g,isLockActive:v,shouldWarn:!0})&&n.release()}return{isActive:()=>qp({expected:"PRE_DRAG",phase:g,isLockActive:v,shouldWarn:!1}),shouldRespectForcePress:m,fluidLift:w,snapLift:C,abort:T}}const O5=[o5,f5,m5];function R5({contextId:n,store:e,registry:t,customSensors:r,enableDefaultSensors:i}){const a=[...i?O5:[],...r||[]],o=le.useState(()=>XB())[0],c=ft(function(A,w){Td(A)&&!Td(w)&&o.tryAbandon()},[o]);os(function(){let A=e.getState();return e.subscribe(()=>{const C=e.getState();c(A,C),A=C})},[o,e,c]),os(()=>o.tryAbandon,[o.tryAbandon]);const f=ft(b=>IC({lockAPI:o,registry:t,store:e,draggableId:b}),[o,t,e]),h=ft((b,A,w)=>D5({lockAPI:o,registry:t,contextId:n,store:e,draggableId:b,forceSensorStop:A||null,sourceEvent:w&&w.sourceEvent?w.sourceEvent:null}),[n,o,t,e]),d=ft(b=>S5(n,b),[n]),g=ft(b=>{const A=t.draggable.findById(b);return A?A.options:null},[t.draggable]),m=ft(function(){o.isClaimed()&&(o.tryAbandon(),e.getState().phase!=="IDLE"&&e.dispatch(Ux()))},[o,e]),v=ft(()=>o.isClaimed(),[o]),y=Zt(()=>({canGetLock:f,tryGetLock:h,findClosestDraggableId:d,findOptionsForDraggable:g,tryReleaseLock:m,isLockClaimed:v}),[f,h,d,g,m,v]);for(let b=0;b<a.length;b++)a[b](y)}const N5=n=>({onBeforeCapture:e=>{const t=()=>{n.onBeforeCapture&&n.onBeforeCapture(e)};Cx.flushSync(t)},onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd,onDragUpdate:n.onDragUpdate}),L5=n=>({...Sd,...n.autoScrollerOptions,durationDampening:{...Sd.durationDampening,...n.autoScrollerOptions}});function Kh(n){return n.current||Ke(),n.current}function M5(n){const{contextId:e,setCallbacks:t,sensors:r,nonce:i,dragHandleUsageInstructions:a}=n,o=le.useRef(null),c=DC(n),f=ft(()=>N5(c.current),[c]),h=ft(()=>L5(c.current),[c]),d=$B(e),g=WB({contextId:e,text:a}),m=FB(e,i),v=ft(Y=>{Kh(o).dispatch(Y)},[]),y=Zt(()=>cw({publishWhileDragging:w8,updateDroppableScroll:T8,updateDroppableIsEnabled:C8,updateDroppableIsCombineEnabled:D8,collectionStarting:S8},v),[v]),b=HB(),A=Zt(()=>pB(b,y),[b,y]),w=Zt(()=>NB({scrollWindow:gB,scrollDroppable:A.scrollDroppable,getAutoScrollerOptions:h,...cw({move:dC},v)}),[A.scrollDroppable,v,h]),C=BB(e),T=Zt(()=>uB({announce:d,autoScroller:w,dimensionMarshal:A,focusMarshal:C,getResponders:f,styleMarshal:m}),[d,w,A,C,f,m]);o.current=T;const R=ft(()=>{const Y=Kh(o);Y.getState().phase!=="IDLE"&&Y.dispatch(Ux())},[]),N=ft(()=>{const Y=Kh(o).getState();return Y.phase==="DROP_ANIMATING"?!0:Y.phase==="IDLE"?!1:Y.isDragging},[]),I=Zt(()=>({isDragging:N,tryAbort:R}),[N,R]);t(I);const D=ft(Y=>EC(Kh(o).getState(),Y),[]),B=ft(()=>oc(Kh(o).getState()),[]),U=Zt(()=>({marshal:A,focus:C,contextId:e,canLift:D,isMovementAllowed:B,dragHandleUsageInstructionsId:g,registry:b}),[e,A,g,C,D,B,b]);return R5({contextId:e,store:T,registry:b,customSensors:r||null,enableDefaultSensors:n.enableDefaultSensors!==!1}),le.useEffect(()=>R,[R]),Yn.createElement(xm.Provider,{value:U},Yn.createElement(a6,{context:Wx,store:T},n.children))}function I5(){return Yn.useId()}function k5(n){const e=I5(),t=n.dragHandleUsageInstructions||fg.dragHandleUsageInstructions;return Yn.createElement(f6,null,r=>Yn.createElement(M5,{nonce:n.nonce,contextId:e,setCallbacks:r,dragHandleUsageInstructions:t,enableDefaultSensors:n.enableDefaultSensors,sensors:n.sensors,onBeforeCapture:n.onBeforeCapture,onBeforeDragStart:n.onBeforeDragStart,onDragStart:n.onDragStart,onDragUpdate:n.onDragUpdate,onDragEnd:n.onDragEnd,autoScrollerOptions:n.autoScrollerOptions},n.children))}const Bw={dragging:5e3,dropAnimating:4500},F5=(n,e)=>e?ld.drop(e.duration):n?ld.snap:ld.fluid,P5=(n,e)=>{if(n)return e?wd.opacity.drop:wd.opacity.combining},B5=n=>n.forceShouldAnimate!=null?n.forceShouldAnimate:n.mode==="SNAP";function U5(n){const t=n.dimension.client,{offset:r,combineWith:i,dropping:a}=n,o=!!i,c=B5(n),f=!!a,h=f?O_.drop(r,o):O_.moveTo(r);return{position:"fixed",top:t.marginBox.top,left:t.marginBox.left,boxSizing:"border-box",width:t.borderBox.width,height:t.borderBox.height,transition:F5(c,a),transform:h,opacity:P5(o,f),zIndex:f?Bw.dropAnimating:Bw.dragging,pointerEvents:"none"}}function H5(n){return{transform:O_.moveTo(n.offset),transition:n.shouldAnimateDisplacement?void 0:"none"}}function z5(n){return n.type==="DRAGGING"?U5(n):H5(n)}function j5(n,e,t=Sr){const r=window.getComputedStyle(e),i=e.getBoundingClientRect(),a=zT(i,r),o=Eg(a,t),c={client:a,tagName:e.tagName.toLowerCase(),display:r.display},f={x:a.marginBox.width,y:a.marginBox.height};return{descriptor:n,placeholder:c,displaceBy:f,client:a,page:o}}function $5(n){const e=Xx("draggable"),{descriptor:t,registry:r,getDraggableRef:i,canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:c}=n,f=Zt(()=>({canDragInteractiveElements:a,shouldRespectForcePress:o,isEnabled:c}),[a,c,o]),h=ft(v=>{const y=i();return y||Ke(),j5(t,y,v)},[t,i]),d=Zt(()=>({uniqueId:e,descriptor:t,options:f,getDimension:h}),[t,h,f,e]),g=le.useRef(d),m=le.useRef(!0);os(()=>(r.draggable.register(g.current),()=>r.draggable.unregister(g.current)),[r.draggable]),os(()=>{if(m.current){m.current=!1;return}const v=g.current;g.current=d,r.draggable.update(d,v)},[d,r.draggable])}var qx=Yn.createContext(null);function Dg(n){const e=le.useContext(n);return e||Ke(),e}function G5(n){n.preventDefault()}const V5=n=>{const e=le.useRef(null),t=ft((I=null)=>{e.current=I},[]),r=ft(()=>e.current,[]),{contextId:i,dragHandleUsageInstructionsId:a,registry:o}=Dg(xm),{type:c,droppableId:f}=Dg(qx),h=Zt(()=>({id:n.draggableId,index:n.index,type:c,droppableId:f}),[n.draggableId,n.index,c,f]),{children:d,draggableId:g,isEnabled:m,shouldRespectForcePress:v,canDragInteractiveElements:y,isClone:b,mapped:A,dropAnimationFinished:w}=n;if(!b){const I=Zt(()=>({descriptor:h,registry:o,getDraggableRef:r,canDragInteractiveElements:y,shouldRespectForcePress:v,isEnabled:m}),[h,o,r,y,v,m]);$5(I)}const C=Zt(()=>m?{tabIndex:0,role:"button","aria-describedby":a,"data-rfd-drag-handle-draggable-id":g,"data-rfd-drag-handle-context-id":i,draggable:!1,onDragStart:G5}:null,[i,a,g,m]),T=ft(I=>{A.type==="DRAGGING"&&A.dropping&&I.propertyName==="transform"&&Cx.flushSync(w)},[w,A]),R=Zt(()=>{const I=z5(A),D=A.type==="DRAGGING"&&A.dropping?T:void 0;return{innerRef:t,draggableProps:{"data-rfd-draggable-context-id":i,"data-rfd-draggable-id":g,style:I,onTransitionEnd:D},dragHandleProps:C}},[i,C,g,A,T,t]),N=Zt(()=>({draggableId:h.id,type:h.type,source:{index:h.index,droppableId:h.droppableId}}),[h.droppableId,h.id,h.index,h.type]);return Yn.createElement(Yn.Fragment,null,d(R,A.snapshot,N))};var kC=(n,e)=>n===e,FC=n=>{const{combine:e,destination:t}=n;return t?t.droppableId:e?e.droppableId:null};const W5=n=>n.combine?n.combine.draggableId:null,X5=n=>n.at&&n.at.type==="COMBINE"?n.at.combine.draggableId:null;function Y5(){const n=wr((i,a)=>({x:i,y:a})),e=wr((i,a,o=null,c=null,f=null)=>({isDragging:!0,isClone:a,isDropAnimating:!!f,dropAnimation:f,mode:i,draggingOver:o,combineWith:c,combineTargetFor:null})),t=wr((i,a,o,c,f=null,h=null,d=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:f,combineWith:h,mode:a,offset:i,dimension:o,forceShouldAnimate:d,snapshot:e(a,c,f,h,null)}}));return(i,a)=>{if(Td(i)){if(i.critical.draggable.id!==a.draggableId)return null;const o=i.current.client.offset,c=i.dimensions.draggables[a.draggableId],f=as(i.impact),h=X5(i.impact),d=i.forceShouldAnimate;return t(n(o.x,o.y),i.movementMode,c,a.isClone,f,h,d)}if(i.phase==="DROP_ANIMATING"){const o=i.completed;if(o.result.draggableId!==a.draggableId)return null;const c=a.isClone,f=i.dimensions.draggables[a.draggableId],h=o.result,d=h.mode,g=FC(h),m=W5(h),y={duration:i.dropDuration,curve:zx.drop,moveTo:i.newHomeClientOffset,opacity:m?wd.opacity.drop:null,scale:m?wd.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:f,dropping:y,draggingOver:g,combineWith:m,mode:d,forceShouldAnimate:null,snapshot:e(d,c,g,m,y)}}}return null}}function PC(n=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:n,combineWith:null}}const q5={mapped:{type:"SECONDARY",offset:Sr,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:PC(null)}};function K5(){const n=wr((o,c)=>({x:o,y:c})),e=wr(PC),t=wr((o,c=null,f)=>({mapped:{type:"SECONDARY",offset:o,combineTargetFor:c,shouldAnimateDisplacement:f,snapshot:e(c)}})),r=o=>o?t(Sr,o,!0):null,i=(o,c,f,h)=>{const d=f.displaced.visible[o],g=!!(h.inVirtualList&&h.effected[o]),m=gm(f),v=m&&m.draggableId===o?c:null;if(!d){if(!g)return r(v);if(f.displaced.invisible[o])return null;const A=pf(h.displacedBy.point),w=n(A.x,A.y);return t(w,v,!0)}if(g)return r(v);const y=f.displacedBy.point,b=n(y.x,y.y);return t(b,v,d.shouldAnimate)};return(o,c)=>{if(Td(o))return o.critical.draggable.id===c.draggableId?null:i(c.draggableId,o.critical.draggable.id,o.impact,o.afterCritical);if(o.phase==="DROP_ANIMATING"){const f=o.completed;return f.result.draggableId===c.draggableId?null:i(c.draggableId,f.result.draggableId,f.impact,f.afterCritical)}return null}}const Q5=()=>{const n=Y5(),e=K5();return(r,i)=>n(r,i)||e(r,i)||q5},Z5={dropAnimationFinished:gC},J5=HT(Q5,Z5,null,{context:Wx,areStatePropsEqual:kC})(V5);function BC(n){return Dg(qx).isUsingCloneFor===n.draggableId&&!n.isClone?null:Yn.createElement(J5,n)}function eU(n){const e=typeof n.isDragDisabled=="boolean"?!n.isDragDisabled:!0,t=!!n.disableInteractiveElementBlocking,r=!!n.shouldRespectForcePress;return Yn.createElement(BC,Ag({},n,{isClone:!1,isEnabled:e,canDragInteractiveElements:t,shouldRespectForcePress:r}))}const UC=n=>e=>n===e,tU=UC("scroll"),nU=UC("auto"),Uw=(n,e)=>e(n.overflowX)||e(n.overflowY),rU=n=>{const e=window.getComputedStyle(n),t={overflowX:e.overflowX,overflowY:e.overflowY};return Uw(t,tU)||Uw(t,nU)},iU=()=>!1,HC=n=>n==null?null:n===document.body?iU()?n:null:n===document.documentElement?null:rU(n)?n:HC(n.parentElement);var L_=n=>({x:n.scrollLeft,y:n.scrollTop});const zC=n=>n?window.getComputedStyle(n).position==="fixed"?!0:zC(n.parentElement):!1;var sU=n=>{const e=HC(n),t=zC(n);return{closestScrollable:e,isFixedOnPage:t}},aU=({descriptor:n,isEnabled:e,isCombineEnabled:t,isFixedOnPage:r,direction:i,client:a,page:o,closest:c})=>{const f=(()=>{if(!c)return null;const{scrollSize:m,client:v}=c,y=xC({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:v,scrollSize:m,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:y,diff:{value:Sr,displacement:Sr}}}})(),h=i==="vertical"?Ix:ZT,d=rf({page:o,withPlaceholder:null,axis:h,frame:f});return{descriptor:n,isCombineEnabled:t,isFixedOnPage:r,axis:h,isEnabled:e,client:a,page:o,frame:f,subject:d}};const oU=(n,e)=>{const t=jT(n);if(!e||n!==e)return t;const r=t.paddingBox.top-e.scrollTop,i=t.paddingBox.left-e.scrollLeft,a=r+e.scrollHeight,o=i+e.scrollWidth,f=Rx({top:r,right:o,bottom:a,left:i},t.border);return Nx({borderBox:f,margin:t.margin,border:t.border,padding:t.padding})};var lU=({ref:n,descriptor:e,env:t,windowScroll:r,direction:i,isDropDisabled:a,isCombineEnabled:o,shouldClipSubject:c})=>{const f=t.closestScrollable,h=oU(n,f),d=Eg(h,r),g=(()=>{if(!f)return null;const v=jT(f),y={scrollHeight:f.scrollHeight,scrollWidth:f.scrollWidth};return{client:v,page:Eg(v,r),scroll:L_(f),scrollSize:y,shouldClipSubject:c}})();return aU({descriptor:e,isEnabled:!a,isCombineEnabled:o,isFixedOnPage:t.isFixedOnPage,direction:i,client:h,page:d,closest:g})};const cU={passive:!1},uU={passive:!0};var Hw=n=>n.shouldPublishImmediately?cU:uU;const Kp=n=>n&&n.env.closestScrollable||null;function fU(n){const e=le.useRef(null),t=Dg(xm),r=Xx("droppable"),{registry:i,marshal:a}=t,o=DC(n),c=Zt(()=>({id:n.droppableId,type:n.type,mode:n.mode}),[n.droppableId,n.mode,n.type]),f=le.useRef(c),h=Zt(()=>wr((R,N)=>{e.current||Ke();const I={x:R,y:N};a.updateDroppableScroll(c.id,I)}),[c.id,a]),d=ft(()=>{const R=e.current;return!R||!R.env.closestScrollable?Sr:L_(R.env.closestScrollable)},[]),g=ft(()=>{const R=d();h(R.x,R.y)},[d,h]),m=Zt(()=>yd(g),[g]),v=ft(()=>{const R=e.current,N=Kp(R);if(R&&N||Ke(),R.scrollOptions.shouldPublishImmediately){g();return}m()},[m,g]),y=ft((R,N)=>{e.current&&Ke();const I=o.current,D=I.getDroppableRef();D||Ke();const B=sU(D),U={ref:D,descriptor:c,env:B,scrollOptions:N};e.current=U;const Y=lU({ref:D,descriptor:c,env:B,windowScroll:R,direction:I.direction,isDropDisabled:I.isDropDisabled,isCombineEnabled:I.isCombineEnabled,shouldClipSubject:!I.ignoreContainerClipping}),W=B.closestScrollable;return W&&(W.setAttribute(Iw.contextId,t.contextId),W.addEventListener("scroll",v,Hw(U.scrollOptions))),Y},[t.contextId,c,v,o]),b=ft(()=>{const R=e.current,N=Kp(R);return R&&N||Ke(),L_(N)},[]),A=ft(()=>{const R=e.current;R||Ke();const N=Kp(R);e.current=null,N&&(m.cancel(),N.removeAttribute(Iw.contextId),N.removeEventListener("scroll",v,Hw(R.scrollOptions)))},[v,m]),w=ft(R=>{const N=e.current;N||Ke();const I=Kp(N);I||Ke(),I.scrollTop+=R.y,I.scrollLeft+=R.x},[]),C=Zt(()=>({getDimensionAndWatchScroll:y,getScrollWhileDragging:b,dragStopped:A,scroll:w}),[A,y,b,w]),T=Zt(()=>({uniqueId:r,descriptor:c,callbacks:C}),[C,c,r]);os(()=>(f.current=T.descriptor,i.droppable.register(T),()=>{e.current&&A(),i.droppable.unregister(T)}),[C,c,A,T,a,i.droppable]),os(()=>{e.current&&a.updateDroppableIsEnabled(f.current.id,!n.isDropDisabled)},[n.isDropDisabled,a]),os(()=>{e.current&&a.updateDroppableIsCombineEnabled(f.current.id,n.isCombineEnabled)},[n.isCombineEnabled,a])}function Vv(){}const zw={width:0,height:0,margin:_6},hU=({isAnimatingOpenOnMount:n,placeholder:e,animate:t})=>n||t==="close"?zw:{height:e.client.borderBox.height,width:e.client.borderBox.width,margin:e.client.margin},dU=({isAnimatingOpenOnMount:n,placeholder:e,animate:t})=>{const r=hU({isAnimatingOpenOnMount:n,placeholder:e,animate:t});return{display:e.display,boxSizing:"border-box",width:r.width,height:r.height,marginTop:r.margin.top,marginRight:r.margin.right,marginBottom:r.margin.bottom,marginLeft:r.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:t!=="none"?ld.placeholder:null}},pU=n=>{const e=le.useRef(null),t=ft(()=>{e.current&&(clearTimeout(e.current),e.current=null)},[]),{animate:r,onTransitionEnd:i,onClose:a,contextId:o}=n,[c,f]=le.useState(n.animate==="open");le.useEffect(()=>c?r!=="open"?(t(),f(!1),Vv):e.current?Vv:(e.current=setTimeout(()=>{e.current=null,f(!1)}),t):Vv,[r,c,t]);const h=ft(g=>{g.propertyName==="height"&&(i(),r==="close"&&a())},[r,a,i]),d=dU({isAnimatingOpenOnMount:c,animate:n.animate,placeholder:n.placeholder});return Yn.createElement(n.placeholder.tagName,{style:d,"data-rfd-placeholder-context-id":o,onTransitionEnd:h,ref:n.innerRef})};var gU=Yn.memo(pU);class mU extends Yn.PureComponent{constructor(...e){super(...e),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(e,t){return e.shouldAnimate?e.on?{isVisible:!0,data:e.on,animate:"open"}:t.isVisible?{isVisible:!0,data:t.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!e.on,data:e.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const e={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(e)}}const vU=n=>{const e=le.useContext(xm);e||Ke();const{contextId:t,isMovementAllowed:r}=e,i=le.useRef(null),a=le.useRef(null),{children:o,droppableId:c,type:f,mode:h,direction:d,ignoreContainerClipping:g,isDropDisabled:m,isCombineEnabled:v,snapshot:y,useClone:b,updateViewportMaxScroll:A,getContainerForClone:w}=n,C=ft(()=>i.current,[]),T=ft((W=null)=>{i.current=W},[]);ft(()=>a.current,[]);const R=ft((W=null)=>{a.current=W},[]),N=ft(()=>{r()&&A({maxScroll:bC()})},[r,A]);fU({droppableId:c,type:f,mode:h,direction:d,isDropDisabled:m,isCombineEnabled:v,ignoreContainerClipping:g,getDroppableRef:C});const I=Zt(()=>Yn.createElement(mU,{on:n.placeholder,shouldAnimate:n.shouldAnimatePlaceholder},({onClose:W,data:re,animate:Te})=>Yn.createElement(gU,{placeholder:re,onClose:W,innerRef:R,animate:Te,contextId:t,onTransitionEnd:N})),[t,N,n.placeholder,n.shouldAnimatePlaceholder,R]),D=Zt(()=>({innerRef:T,placeholder:I,droppableProps:{"data-rfd-droppable-id":c,"data-rfd-droppable-context-id":t}}),[t,c,I,T]),B=b?b.dragging.draggableId:null,U=Zt(()=>({droppableId:c,type:f,isUsingCloneFor:B}),[c,B,f]);function Y(){if(!b)return null;const{dragging:W,render:re}=b,Te=Yn.createElement(BC,{draggableId:W.draggableId,index:W.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(Fe,we)=>re(Fe,we,W));return sP.createPortal(Te,w())}return Yn.createElement(qx.Provider,{value:U},o(D,y),Y())};function _U(){return document.body||Ke(),document.body}const jw={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:_U},jC=n=>{let e={...n},t;for(t in jw)n[t]===void 0&&(e={...e,[t]:jw[t]});return e},Wv=(n,e)=>n===e.droppable.type,$w=(n,e)=>e.draggables[n.draggable.id],xU=()=>{const n={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},e={...n,shouldAnimatePlaceholder:!1},t=wr(a=>({draggableId:a.id,type:a.type,source:{index:a.index,droppableId:a.droppableId}})),r=wr((a,o,c,f,h,d)=>{const g=h.descriptor.id;if(h.descriptor.droppableId===a){const y=d?{render:d,dragging:t(h.descriptor)}:null,b={isDraggingOver:c,draggingOverWith:c?g:null,draggingFromThisWith:g,isUsingPlaceholder:!0};return{placeholder:h.placeholder,shouldAnimatePlaceholder:!1,snapshot:b,useClone:y}}if(!o)return e;if(!f)return n;const v={isDraggingOver:c,draggingOverWith:g,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:h.placeholder,shouldAnimatePlaceholder:!0,snapshot:v,useClone:null}});return(a,o)=>{const c=jC(o),f=c.droppableId,h=c.type,d=!c.isDropDisabled,g=c.renderClone;if(Td(a)){const m=a.critical;if(!Wv(h,m))return e;const v=$w(m,a.dimensions),y=as(a.impact)===f;return r(f,d,y,y,v,g)}if(a.phase==="DROP_ANIMATING"){const m=a.completed;if(!Wv(h,m.critical))return e;const v=$w(m.critical,a.dimensions);return r(f,d,FC(m.result)===f,as(m.impact)===f,v,g)}if(a.phase==="IDLE"&&a.completed&&!a.shouldFlush){const m=a.completed;if(!Wv(h,m.critical))return e;const v=as(m.impact)===f,y=!!(m.impact.at&&m.impact.at.type==="COMBINE"),b=m.critical.droppable.id===f;return v?y?n:e:b?n:e}return e}},yU={updateViewportMaxScroll:R8},bU=HT(xU,yU,(n,e,t)=>({...jC(t),...n,...e}),{context:Wx,areStatePropsEqual:kC})(vU),EU=({showOnLoad:n,onToggleShowOnLoad:e})=>K.jsx(K.Fragment,{children:K.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:K.jsxs("div",{className:"modal-content",children:[K.jsxs("div",{className:"modal-header",children:[K.jsx("img",{src:"js_logo_simbolo.png",alt:"JS Geologia Aplicada",style:{maxWidth:"50px"}}),K.jsx("h5",{className:"modal-title flex-grow-1 text-center",children:"Extrator de dados de PDFs"}),K.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),K.jsxs("div",{className:"modal-body text-start",children:[K.jsx("p",{className:"lead text-muted mb-3",children:"O Extrator de Dados de PDF da JS Geologia Aplicada  uma ferramenta desenvolvida para automatizar a extrao de informaes de relatrios de sondagem e outros documentos tcnicos, facilitando a organizao e anlise de dados geolgicos."}),K.jsxs("div",{className:"mt-3 px-3 text-start",children:[K.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Como usar"}),K.jsxs("ol",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[K.jsxs("li",{className:"mb-1 text-start",children:[K.jsx("strong",{children:"Carregue um PDF"}),' clicando em "Escolher arquivo"']}),K.jsxs("li",{className:"mb-1 text-start",children:[K.jsx("strong",{children:"Adicione reas"})," para marcar regies que deseja extrair texto"]}),K.jsxs("li",{className:"mb-1 text-start",children:[K.jsx("strong",{children:"Renomeie as reas"})," clicando no nome para facilitar identificao"]}),K.jsxs("li",{className:"mb-1 text-start",children:[K.jsx("strong",{children:"Selecione as reas"})," clicando no cone de seleo e arrastando no PDF"]}),K.jsxs("li",{className:"mb-1 text-start",children:[K.jsx("strong",{children:"Extraia os dados"})," e exporte em JSON, CSV ou Excel"]})]})]}),K.jsxs("div",{className:"mt-3 px-3 text-start",children:[K.jsx("h6",{className:"text-dark fw-bold mb-2 text-start",children:"Recursos disponveis"}),K.jsxs("ul",{className:"mb-1 text-start",style:{lineHeight:"1.3"},children:[K.jsxs("li",{className:"mb-1 text-start",children:[K.jsx("strong",{children:"At 10 reas"})," de extrao com cores diferentes"]}),K.jsxs("li",{className:"mb-1 text-start",children:[K.jsx("strong",{children:"Sistema de presets"})," para salvar configuraes"]}),K.jsxs("li",{className:"mb-1 text-start",children:[K.jsx("strong",{children:"Campos obrigatrios"})," para ignorar pginas que no contenham dados essenciais"]})]})]}),K.jsx("div",{className:"alert alert-warning mt-3 mb-0 text-start",role:"alert",children:K.jsx("p",{className:"mb-0 text-start",children:"A JS Geologia Aplicada no se responsabiliza por eventuais erros na leitura automtica dos dados."})})]}),K.jsxs("div",{className:"modal-footer d-flex justify-content-between",children:[K.jsxs("div",{className:"form-check form-switch",children:[K.jsx("input",{className:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:n,onChange:t=>{e(t.target.checked)}}),K.jsx("label",{className:"form-check-label",htmlFor:"flexSwitchCheckDefault",children:"Mostrar ao abrir"})]}),K.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Fechar"})]})]})})});function AU({onFileSelect:n,onExtractTexts:e,onStartAreaSelection:t,onDeleteArea:r,onRenameArea:i,onClearArea:a,onAddNewArea:o,onLoadPreset:c,onDragEnd:f,onToggleMandatory:h,onChangeAreaType:d,areas:g,hasFile:m}){const[v,y]=le.useState(!1),b=()=>{y(!0)},[A,w]=le.useState(()=>localStorage.getItem("showHelpOnLoad")!=="false");le.useEffect(()=>{const R=()=>{new yc("#helpModal").show()};if(A)if(document.readyState==="complete")R();else return window.addEventListener("load",R),()=>window.removeEventListener("load",R)},[]);const C=R=>{w(R),localStorage.setItem("showHelpOnLoad",R.toString())},T=()=>{confirm("Deseja remover todas as reas?")&&g.forEach(R=>{r(R.id)})};return K.jsxs(K.Fragment,{children:[K.jsx(rP,{onFileSelect:n}),K.jsx("div",{className:"modal fade",id:"helpModal",tabIndex:-1,children:K.jsx(EU,{showOnLoad:A,onToggleShowOnLoad:C})}),K.jsxs("div",{className:"d-flex justify-content-end gap-2 my-3",children:[g.length>0&&K.jsx("button",{title:"Ajuda",className:"menu-btn menu-btn-warning",onClick:T,children:K.jsx(Tx,{size:24})}),K.jsx("button",{title:"Ajuda",className:"menu-btn","data-bs-toggle":"modal","data-bs-target":"#helpModal",children:K.jsx(NF,{size:24})}),K.jsx("button",{title:"Presets",className:"menu-btn",onClick:b,children:K.jsx(FF,{size:24})}),K.jsx("button",{title:"Adicionar rea",className:"menu-btn",onClick:o,children:K.jsx(HF,{size:24})}),K.jsx("button",{title:"Extrair texto",className:"menu-btn menu-btn-cta",disabled:!(g.length>0&&m&&g.some(R=>R.coordinates)),onClick:e,children:K.jsx(ad,{size:24})})]}),g.length===0&&K.jsx("p",{className:"text-muted",children:"Adicione uma rea para comear!"}),K.jsx(k5,{onDragEnd:f,children:K.jsx(bU,{droppableId:"areas",children:R=>K.jsxs("div",{className:"areas-container",...R.droppableProps,ref:R.innerRef,children:[g.map((N,I)=>K.jsx(eU,{draggableId:N.id,index:I,children:D=>K.jsx("div",{ref:D.innerRef,...D.draggableProps,...D.dragHandleProps,children:K.jsx(tP,{area:N,hasFile:m,onStartSelection:t,onClearArea:a,onDeleteArea:r,onRenameArea:i,onToggleMandatory:h,onChangeAreaType:d},N.id)})},N.id)),R.placeholder]})})}),K.jsx(iP,{isOpen:v,onClose:()=>y(!1),currentAreas:g,onLoadPreset:c})]})}const wU=n=>{const t={id:`area-${Date.now()}`,name:$C("Nova rea",n),order:n.length+1,color:RU(n),coordinates:null,isMandatory:!1,type:void 0};return[...n,t]},SU=(n,e)=>n.filter(t=>t.id!==e),TU=(n,e,t)=>{if(t.trim().toLowerCase()==="pagenumber")return alert('Nome "pageNumber"  reservado. Use outro nome.'),n;const r=$C(t,n);return n.map(i=>i.id===e?{...i,name:r}:i)},CU=(n,e)=>n.map(t=>t.id===e?{...t,coordinates:null}:t),DU=(n,e,t)=>n.map(r=>r.id===e?{...r,coordinates:t}:r),$C=(n,e)=>{let t=2,r=n;for(;e.some(i=>i.name===r);)r=`${n} (${t})`,t++;return r},OU=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F97316","#84CC16","#6B7280"],RU=n=>{const e=n.map(t=>t.color);return OU.find(t=>!e.includes(t))??"#000000"},NU=({children:n})=>K.jsxs("div",{className:"card mt-5",children:[K.jsx("div",{className:"card-header",children:K.jsx("img",{src:"js_logo_horizontal.png",alt:"JS Geologia Aplicada",style:{maxWidth:"200px"}})}),K.jsxs("div",{className:"card-body",children:[K.jsx("h4",{className:"card-title",children:"Extrator de dados de PDF"}),K.jsx("p",{className:"card-text",children:"Selecione reas, extraia dados"}),n]})]}),LU=async(n,e)=>{const t=[],r=e.numPages;for(let i=1;i<=r;i++){const a=await e.getPage(i),o=await a.getOperatorList(),c=await a.getTextContent(),f=a.getViewport({scale:1}),h=MU(o),d={pageNumber:i};n.forEach(m=>{if(m.coordinates){const v=oF(m.coordinates,1,1,f),y=lF(c,v);y.sort((A,w)=>w.transform[5]-A.transform[5]),console.log("filteredTexts:",y);const b=m.type==="nspt"?cF(y):uF(y,h);d[m.name]=b}else d[m.name]=[]}),n.some(m=>{if(!m.isMandatory)return!1;const v=d[m.name];return!v||v.length===0})||t.push(d)}return t},MU=n=>{const e=[];for(let t=0;t<n.fnArray.length;t++)if(n.fnArray[t]===91){const r=n.argsArray[t][1][0];for(let i=0;i<r.length;i++)if(r[i]===1&&i>=2){const a=r[i-2],o=r[i-1],c=r[i+1],f=r[i+2];Math.abs(o-f)<2&&e.push({x1:Math.min(a,c),x2:Math.max(a,c),y:o})}}return e};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Og={};Og.version="0.20.3";var yo=1200,Cd=function(n){yo=n};function IU(){Cd(1200)}var Qp=function(e){return String.fromCharCode(e)},Gw=function(e){return String.fromCharCode(e)},Zr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Rg(n){for(var e="",t=0,r=0,i=0,a=0,o=0,c=0,f=0,h=0;h<n.length;)t=n.charCodeAt(h++),a=t>>2,r=n.charCodeAt(h++),o=(t&3)<<4|r>>4,i=n.charCodeAt(h++),c=(r&15)<<2|i>>6,f=i&63,isNaN(r)?c=f=64:isNaN(i)&&(f=64),e+=Zr.charAt(a)+Zr.charAt(o)+Zr.charAt(c)+Zr.charAt(f);return e}function kU(n){for(var e="",t=0,r=0,i=0,a=0,o=0,c=0,f=0,h=0;h<n.length;)t=n.charCodeAt(h++),t>255&&(t=95),a=t>>2,r=n.charCodeAt(h++),r>255&&(r=95),o=(t&3)<<4|r>>4,i=n.charCodeAt(h++),i>255&&(i=95),c=(r&15)<<2|i>>6,f=i&63,isNaN(r)?c=f=64:isNaN(i)&&(f=64),e+=Zr.charAt(a)+Zr.charAt(o)+Zr.charAt(c)+Zr.charAt(f);return e}function FU(n){for(var e="",t=0,r=0,i=0,a=0,o=0,c=0,f=0,h=0;h<n.length;)t=n[h++],a=t>>2,r=n[h++],o=(t&3)<<4|r>>4,i=n[h++],c=(r&15)<<2|i>>6,f=i&63,isNaN(r)?c=f=64:isNaN(i)&&(f=64),e+=Zr.charAt(a)+Zr.charAt(o)+Zr.charAt(c)+Zr.charAt(f);return e}function Al(n){var e="",t=0,r=0,i=0,a=0,o=0,c=0,f=0;if(n.slice(0,5)=="data:"){var h=n.slice(0,1024).indexOf(";base64,");h>-1&&(n=n.slice(h+8))}n=n.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<n.length;)a=Zr.indexOf(n.charAt(h++)),o=Zr.indexOf(n.charAt(h++)),t=a<<2|o>>4,e+=String.fromCharCode(t),c=Zr.indexOf(n.charAt(h++)),r=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(r)),f=Zr.indexOf(n.charAt(h++)),i=(c&3)<<6|f,f!==64&&(e+=String.fromCharCode(i));return e}var an=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ba=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),Ng=function(){if(typeof Buffer>"u")return!1;var n=Ba([65,0]);if(!n)return!1;var e=n.toString("utf16le");return e.length==1}();function Sc(n){return an?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function Vw(n){return an?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var ts=function(e){return an?Ba(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function bm(n){if(typeof ArrayBuffer>"u")return ts(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),r=0;r!=n.length;++r)t[r]=n.charCodeAt(r)&255;return e}function Tc(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function PU(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var sr=an?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:Ba(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var r=new Uint8Array(t),i=0;for(e=0,t=0;e<n.length;t+=i,++e)i=n[e].length,n[e]instanceof Uint8Array?r.set(n[e],t):typeof n[e]=="string"?r.set(new Uint8Array(ts(n[e])),t):r.set(new Uint8Array(n[e]),t);return r}return[].concat.apply([],n.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function BU(n){for(var e=[],t=0,r=n.length+250,i=Sc(n.length+255),a=0;a<n.length;++a){var o=n.charCodeAt(a);if(o<128)i[t++]=o;else if(o<2048)i[t++]=192|o>>6&31,i[t++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=n.charCodeAt(++a)&1023;i[t++]=240|o>>8&7,i[t++]=128|o>>2&63,i[t++]=128|c>>6&15|(o&3)<<4,i[t++]=128|c&63}else i[t++]=224|o>>12&15,i[t++]=128|o>>6&63,i[t++]=128|o&63;t>r&&(e.push(i.slice(0,t)),t=0,i=Sc(65535),r=65530)}return e.push(i.slice(0,t)),sr(e)}var cd=/\u0000/g,Zp=/[\u0001-\u0006]/g;function zu(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function Zs(n,e){var t=""+n;return t.length>=e?t:Ln("0",e-t.length)+t}function Kx(n,e){var t=""+n;return t.length>=e?t:Ln(" ",e-t.length)+t}function Lg(n,e){var t=""+n;return t.length>=e?t:t+Ln(" ",e-t.length)}function UU(n,e){var t=""+Math.round(n);return t.length>=e?t:Ln("0",e-t.length)+t}function HU(n,e){var t=""+n;return t.length>=e?t:Ln("0",e-t.length)+t}var Ww=Math.pow(2,32);function Cu(n,e){if(n>Ww||n<-Ww)return UU(n,e);var t=Math.round(n);return HU(t,e)}function Mg(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var Xw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zU(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var Cn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Yw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},jU={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ig(n,e,t){for(var r=n<0?-1:1,i=n*r,a=0,o=1,c=0,f=1,h=0,d=0,g=Math.floor(i);h<e&&(g=Math.floor(i),c=g*o+a,d=g*h+f,!(i-g<5e-8));)i=1/(i-g),a=o,o=c,f=h,h=d;if(d>e&&(h>e?(d=f,c=a):(d=h,c=o)),!t)return[0,r*c,d];var m=Math.floor(r*c/d);return[m,r*c-m*d,d]}function $U(n){var e=n.toPrecision(16);if(e.indexOf("e")>-1){var t=e.slice(0,e.indexOf("e"));return t=t.indexOf(".")>-1?t.slice(0,t.slice(0,2)=="0."?17:16):t.slice(0,15)+Ln("0",t.length-15),t+e.slice(e.indexOf("e"))}var r=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+Ln("0",e.length-15);return Number(r)}function Du(n,e,t){if(n>2958465||n<0)return null;n=$U(n);var r=n|0,i=Math.floor(86400*(n-r)),a=0,o=[],c={D:r,T:i,u:86400*(n-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++r,++c.D)),r===60)o=t?[1317,10,29]:[1900,2,29],a=3;else if(r===0)o=t?[1317,8,29]:[1900,1,0],a=6;else{r>60&&--r;var f=new Date(1900,0,1);f.setDate(f.getDate()+r-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],a=f.getDay(),r<60&&(a=(a+6)%7),t&&(a=YU(f,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=a,c}function Qx(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function GU(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function VU(n){var e=n<0?12:11,t=Qx(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function WU(n){var e=Qx(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function XU(n){if(!isFinite(n))return isNaN(n)?"#NUM!":"#DIV/0!";var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=VU(n):e===10?t=n.toFixed(10).substr(0,12):t=WU(n),Qx(GU(t.toUpperCase()))}function M_(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):XU(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Oo(14,Pr(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function YU(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function qU(n,e,t,r){var i="",a=0,o=0,c=t.y,f,h=0;switch(n){case 98:c=t.y+543;case 121:switch(e.length){case 1:case 2:f=c%100,h=2;break;default:f=c%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:f=t.m,h=e.length;break;case 3:return Xv[t.m-1][1];case 5:return Xv[t.m-1][0];default:return Xv[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=t.d,h=e.length;break;case 3:return Xw[t.q][0];default:return Xw[t.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(t.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=t.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=t.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Zs(t.S,e.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,a=Math.round(o*(t.S+t.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(i=Zs(a,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=t.D*24+t.H;break;case"[m]":case"[mm]":f=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":f=((t.D*24+t.H)*60+t.M)*60+(r==0?Math.round(t.S+t.u):t.S);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:f=c,h=1;break}var d=h>0?Zs(f,h):"";return d}function pl(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,r=n.substr(0,t);t!=n.length;t+=e)r+=(r.length>0?",":"")+n.substr(t,e);return r}var GC=/%/g;function KU(n,e,t){var r=e.replace(GC,""),i=e.length-r.length;return Ao(n,r,t*Math.pow(10,2*i))+Ln("%",i)}function QU(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ao(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function VC(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+VC(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(e/Math.pow(10,a)).toPrecision(r+1+(i+a)%i),t.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,d){return f+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var WC=/# (\?+)( ?)\/( ?)(\d+)/;function ZU(n,e,t){var r=parseInt(n[4],10),i=Math.round(e*r),a=Math.floor(i/r),o=i-a*r,c=r;return t+(a===0?"":""+a)+" "+(o===0?Ln(" ",n[1].length+1+n[4].length):Kx(o,n[1].length)+n[2]+"/"+n[3]+Zs(c,n[4].length))}function JU(n,e,t){return t+(e===0?"":""+e)+Ln(" ",n[1].length+2+n[4].length)}var XC=/^#*0*\.([0#]+)/,YC=/\)[^)]*[0#]/,qC=/\(###\) ###\\?-####/;function gi(n){for(var e="",t,r=0;r!=n.length;++r)switch(t=n.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function qw(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function Kw(n,e){var t=n-Math.floor(n),r=Math.pow(10,e);return e<(""+Math.round(t*r)).length?0:Math.round(t*r)}function e7(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function t7(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Cs(n,e,t){if(n.charCodeAt(0)===40&&!e.match(YC)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Cs("n",r,t):"("+Cs("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return QU(n,e,t);if(e.indexOf("%")!==-1)return KU(n,e,t);if(e.indexOf("E")!==-1)return VC(e,t);if(e.charCodeAt(0)===36)return"$"+Cs(n,e.substr(e.charAt(1)==" "?2:1),t);var i,a,o,c,f=Math.abs(t),h=t<0?"-":"";if(e.match(/^00+$/))return h+Cu(f,e.length);if(e.match(/^[#?]+$/))return i=Cu(t,0),i==="0"&&(i=""),i.length>e.length?i:gi(e.substr(0,e.length-i.length))+i;if(a=e.match(WC))return ZU(a,f,h);if(e.match(/^#+0+$/))return h+Cu(f,e.length-e.indexOf("0"));if(a=e.match(XC))return i=qw(t,a[1].length).replace(/^([^\.]+)$/,"$1."+gi(a[1])).replace(/\.$/,"."+gi(a[1])).replace(/\.(\d*)$/,function(y,b){return"."+b+Ln("0",gi(a[1]).length-b.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return h+qw(f,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return h+pl(Cu(f,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Cs(n,e,-t):pl(""+(Math.floor(t)+e7(t,a[1].length)))+"."+Zs(Kw(t,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return Cs(n,e.replace(/^#,#*,/,""),t);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zu(Cs(n,e.replace(/[\\-]/g,""),t)),o=0,zu(zu(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(e.match(qC))return i=Cs(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=Ig(f,Math.pow(10,o)-1,!1),i=""+h,d=Ao("n",a[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Lg(c[2],o),d.length<a[4].length&&(d=gi(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=Ig(f,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Kx(c[1],o)+a[2]+"/"+a[3]+Lg(c[2],o):Ln(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=Cu(t,0),e.length<=i.length?i:gi(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,m=e.length-i.length-g;return gi(e.substr(0,g)+i+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=Kw(t,a[1].length),t<0?"-"+Cs(n,e,-t):pl(t7(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Zs(0,3-y.length):"")+y})+"."+Zs(o,a[1].length);switch(e){case"###,##0.00":return Cs(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var v=pl(Cu(f,0));return v!=="0"?h+v:"";case"###,###.00":return Cs(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Cs(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function n7(n,e,t){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Ao(n,e.substr(0,r),t/Math.pow(10,3*(e.length-r)))}function r7(n,e,t){var r=e.replace(GC,""),i=e.length-r.length;return Ao(n,r,t*Math.pow(10,2*i))+Ln("%",i)}function KC(n,e){var t,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+KC(n,-e);var i=n.indexOf(".");i===-1&&(i=n.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),t=(e/Math.pow(10,a)).toPrecision(r+1+(i+a)%i),!t.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+a):t+="E+"+(o-a),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,h,d){return f+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else t=e.toExponential(r);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Sa(n,e,t){if(n.charCodeAt(0)===40&&!e.match(YC)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Sa("n",r,t):"("+Sa("n",r,-t)+")"}if(e.charCodeAt(e.length-1)===44)return n7(n,e,t);if(e.indexOf("%")!==-1)return r7(n,e,t);if(e.indexOf("E")!==-1)return KC(e,t);if(e.charCodeAt(0)===36)return"$"+Sa(n,e.substr(e.charAt(1)==" "?2:1),t);var i,a,o,c,f=Math.abs(t),h=t<0?"-":"";if(e.match(/^00+$/))return h+Zs(f,e.length);if(e.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>e.length?i:gi(e.substr(0,e.length-i.length))+i;if(a=e.match(WC))return JU(a,f,h);if(e.match(/^#+0+$/))return h+Zs(f,e.length-e.indexOf("0"));if(a=e.match(XC))return i=(""+t).replace(/^([^\.]+)$/,"$1."+gi(a[1])).replace(/\.$/,"."+gi(a[1])),i=i.replace(/\.(\d*)$/,function(y,b){return"."+b+Ln("0",gi(a[1]).length-b.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return h+pl(""+f);if(a=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Sa(n,e,-t):pl(""+t)+"."+Ln("0",a[1].length);if(a=e.match(/^#,#*,#0/))return Sa(n,e.replace(/^#,#*,/,""),t);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=zu(Sa(n,e.replace(/[\\-]/g,""),t)),o=0,zu(zu(e.replace(/\\/g,"")).replace(/[0#]/g,function(y){return o<i.length?i.charAt(o++):y==="0"?"0":""}));if(e.match(qC))return i=Sa(n,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=Ig(f,Math.pow(10,o)-1,!1),i=""+h,d=Ao("n",a[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Lg(c[2],o),d.length<a[4].length&&(d=gi(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=Ig(f,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Kx(c[1],o)+a[2]+"/"+a[3]+Lg(c[2],o):Ln(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=""+t,e.length<=i.length?i:gi(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,m=e.length-i.length-g;return gi(e.substr(0,g)+i+e.substr(e.length-m))}if(a=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Sa(n,e,-t):pl(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Zs(0,3-y.length):"")+y})+"."+Zs(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var v=pl(""+f);return v!=="0"?h+v:"";default:if(e.match(/\.[0#?]*$/))return Sa(n,e.slice(0,e.lastIndexOf(".")),t)+gi(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ao(n,e,t){return(t|0)===t?Sa(n,e,t):Cs(n,e,t)}function i7(n){for(var e=[],t=!1,r=0,i=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=n.substr(i,r-i),i=r+1}if(e[e.length]=n.substr(i),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var QC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Cc(n){for(var e=0,t="",r="";e<n.length;)switch(t=n.charAt(e)){case"G":Mg(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=t;n.charAt(e++)!=="]"&&e<n.length;)r+=n.charAt(e);if(r.match(QC))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function s7(n,e,t,r){for(var i=[],a="",o=0,c="",f="t",h,d,g,m="H";o<n.length;)switch(c=n.charAt(o)){case"G":if(!Mg(n,o))throw new Error("unrecognized character "+c+" in "+n);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(g=n.charCodeAt(++o))!==34&&o<n.length;)a+=String.fromCharCode(g);i[i.length]={t:"t",v:a},++o;break;case"\\":var v=n.charAt(++o),y=v==="("||v===")"?v:"t";i[i.length]={t:y,v},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(n.charAt(o+1)==="1"||n.charAt(o+1)==="2"){if(h==null&&(h=Du(e,t,n.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:n.substr(o,2)},f=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Du(e,t),h==null))return"";for(a=c;++o<n.length&&n.charAt(o).toLowerCase()===c;)a+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=m),i[i.length]={t:c,v:a},f=c;break;case"A":case"a":case"":var b={t:c,v:c};if(h==null&&(h=Du(e,t)),n.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(b.v=h.H>=12?n.charAt(o+2):c),b.t="T",m="h",o+=3):n.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(b.v=h.H>=12?"PM":"AM"),b.t="T",o+=5,m="h"):n.substr(o,5).toUpperCase()==="/"?(h!=null&&(b.v=h.H>=12?"":""),b.t="T",o+=5,m="h"):(b.t="t",++o),h==null&&b.t==="T")return"";i[i.length]=b,f=c;break;case"[":for(a=c;n.charAt(o++)!=="]"&&o<n.length;)a+=n.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(QC)){if(h==null&&(h=Du(e,t),h==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},f=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Cc(n)||(i[i.length]={t:"t",v:a}));break;case".":if(h!=null){for(a=c;++o<n.length&&(c=n.charAt(o))==="0";)a+=c;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=c;++o<n.length&&"0#?.,E+-%".indexOf(c=n.charAt(o))>-1;)a+=c;i[i.length]={t:"n",v:a};break;case"?":for(a=c;n.charAt(++o)===c;)a+=c;i[i.length]={t:c,v:a},f=c;break;case"*":++o,(n.charAt(o)==" "||n.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=c;o<n.length&&"0123456789".indexOf(n.charAt(++o))>-1;)a+=n.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+n);i[i.length]={t:"t",v:c},++o;break}var A=0,w=0,C;for(o=i.length-1,f="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=m,f="h",A<1&&(A=1);break;case"s":(C=i[o].v.match(/\.0+$/))&&(w=Math.max(w,C[0].length-1),A=4),A<3&&(A=3);case"d":case"y":case"e":f=i[o].t;break;case"M":f=i[o].t,A<2&&(A=2);break;case"m":f==="s"&&(i[o].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&i[o].v.match(/[Hh]/)&&(A=1),A<2&&i[o].v.match(/[Mm]/)&&(A=2),A<3&&i[o].v.match(/[Ss]/)&&(A=3)}var T;switch(A){case 0:break;case 1:case 2:case 3:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,T=Du(h.D),T.u=h.u,T.S=h.S,T.M=h.M,T.H=h.H,h=T);break;case 4:switch(w){case 1:h.u=Math.round(h.u*10)/10;break;case 2:h.u=Math.round(h.u*100)/100;break;case 3:h.u=Math.round(h.u*1e3)/1e3;break}h.u>=1&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H),h.H>=24&&(h.H=0,++h.D,T=Du(h.D),T.u=h.u,T.S=h.S,T.M=h.M,T.H=h.H,h=T);break}var R="",N;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=qU(i[o].t.charCodeAt(0),i[o].v,h,w),i[o].t="t";break;case"n":case"?":for(N=o+1;i[N]!=null&&((c=i[N].t)==="?"||c==="D"||(c===" "||c==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[o].v+=i[N].v,i[N]={v:"",t:";"},++N;R+=i[o].v,o=N-1;break;case"G":i[o].t="t",i[o].v=M_(e,t);break}var I="",D,B;if(R.length>0){R.charCodeAt(0)==40?(D=e<0&&R.charCodeAt(0)===45?-e:e,B=Ao("n",R,D)):(D=e<0&&r>1?-e:e,B=Ao("n",R,D),D<0&&i[0]&&i[0].t=="t"&&(B=B.substr(1),i[0].v="-"+i[0].v)),N=B.length-1;var U=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){U=o;break}var Y=i.length;if(U===i.length&&B.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(N>=i[o].v.length-1?(N-=i[o].v.length,i[o].v=B.substr(N+1,i[o].v.length)):N<0?i[o].v="":(i[o].v=B.substr(0,N+1),N=-1),i[o].t="t",Y=o);N>=0&&Y<i.length&&(i[Y].v=B.substr(0,N+1)+i[Y].v)}else if(U!==i.length&&B.indexOf("E")===-1){for(N=B.indexOf(".")-1,o=U;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===U?i[o].v.indexOf(".")-1:i[o].v.length-1,I=i[o].v.substr(d+1);d>=0;--d)N>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(I=B.charAt(N--)+I);i[o].v=I,i[o].t="t",Y=o}for(N>=0&&Y<i.length&&(i[Y].v=B.substr(0,N+1)+i[Y].v),N=B.indexOf(".")+1,o=U;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==U)){for(d=i[o].v.indexOf(".")>-1&&o===U?i[o].v.indexOf(".")+1:0,I=i[o].v.substr(0,d);d<i[o].v.length;++d)N<B.length&&(I+=B.charAt(N++));i[o].v=I,i[o].t="t",Y=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(D=r>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=Ao(i[o].t,i[o].v,D),i[o].t="t");var W="";for(o=0;o!==i.length;++o)i[o]!=null&&(W+=i[o].v);return W}var Qw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Zw(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function a7(n,e){var t=i7(n),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(typeof e=="number"&&!isFinite(e)&&(e=0),t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var a=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,a];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var o=t[0].match(Qw),c=t[1].match(Qw);return Zw(e,o)?[r,t[0]]:Zw(e,c)?[r,t[1]]:[r,t[o!=null&&c!=null?2:1]]}return[r,a]}function Oo(n,e,t){t==null&&(t={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?r=t.dateNF:r=n;break;case"number":n==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Cn)[n],r==null&&(r=t.table&&t.table[Yw[n]]||Cn[Yw[n]]),r==null&&(r=jU[n]||"General");break}if(Mg(r,0))return M_(e,t);e instanceof Date&&(e=Pr(e,t.date1904));var i=a7(r,e);if(Mg(i[1]))return M_(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else{if(e===""||e==null)return"";if(isNaN(e)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(e)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return s7(i[1],e,t,i[0])}function ZC(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Cn[t]==null){e<0&&(e=t);continue}if(Cn[t]==n){e=t;break}}e<0&&(e=391)}return Cn[e]=n,e}function Em(n){for(var e=0;e!=392;++e)n[e]!==void 0&&ZC(n[e],e)}function Am(){Cn=zU()}var kg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function o7(n){var e=typeof n=="number"?Cn[n]:n;return e=e.replace(kg,"(\\d+)"),kg.lastIndex=0,new RegExp("^"+e+"$")}function l7(n,e,t){var r=-1,i=-1,a=-1,o=-1,c=-1,f=-1;(e.match(kg)||[]).forEach(function(g,m){var v=parseInt(t[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":r=v;break;case"d":a=v;break;case"h":o=v;break;case"s":f=v;break;case"m":o>=0?c=v:i=v;break}}),kg.lastIndex=0,f>=0&&c==-1&&i>=0&&(c=i,i=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&c==-1&&f==-1?h:r==-1&&i==-1&&a==-1?d:h+"T"+d}var c7={"d.m":"d\\.m"};function u7(n,e){return ZC(c7[n]||n,e)}var Jw=function(){var n={};n.version="1.2.0";function e(){for(var D=0,B=new Array(256),U=0;U!=256;++U)D=U,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,B[U]=D;return typeof Int32Array<"u"?new Int32Array(B):B}var t=e();function r(D){var B=0,U=0,Y=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Y=0;Y!=256;++Y)W[Y]=D[Y];for(Y=0;Y!=256;++Y)for(U=D[Y],B=256+Y;B<4096;B+=256)U=W[B]=U>>>8^D[U&255];var re=[];for(Y=1;Y!=16;++Y)re[Y-1]=typeof Int32Array<"u"&&typeof W.subarray=="function"?W.subarray(Y*256,Y*256+256):W.slice(Y*256,Y*256+256);return re}var i=r(t),a=i[0],o=i[1],c=i[2],f=i[3],h=i[4],d=i[5],g=i[6],m=i[7],v=i[8],y=i[9],b=i[10],A=i[11],w=i[12],C=i[13],T=i[14];function R(D,B){for(var U=B^-1,Y=0,W=D.length;Y<W;)U=U>>>8^t[(U^D.charCodeAt(Y++))&255];return~U}function N(D,B){for(var U=B^-1,Y=D.length-15,W=0;W<Y;)U=T[D[W++]^U&255]^C[D[W++]^U>>8&255]^w[D[W++]^U>>16&255]^A[D[W++]^U>>>24]^b[D[W++]]^y[D[W++]]^v[D[W++]]^m[D[W++]]^g[D[W++]]^d[D[W++]]^h[D[W++]]^f[D[W++]]^c[D[W++]]^o[D[W++]]^a[D[W++]]^t[D[W++]];for(Y+=15;W<Y;)U=U>>>8^t[(U^D[W++])&255];return~U}function I(D,B){for(var U=B^-1,Y=0,W=D.length,re=0,Te=0;Y<W;)re=D.charCodeAt(Y++),re<128?U=U>>>8^t[(U^re)&255]:re<2048?(U=U>>>8^t[(U^(192|re>>6&31))&255],U=U>>>8^t[(U^(128|re&63))&255]):re>=55296&&re<57344?(re=(re&1023)+64,Te=D.charCodeAt(Y++)&1023,U=U>>>8^t[(U^(240|re>>8&7))&255],U=U>>>8^t[(U^(128|re>>2&63))&255],U=U>>>8^t[(U^(128|Te>>6&15|(re&3)<<4))&255],U=U>>>8^t[(U^(128|Te&63))&255]):(U=U>>>8^t[(U^(224|re>>12&15))&255],U=U>>>8^t[(U^(128|re>>6&63))&255],U=U>>>8^t[(U^(128|re&63))&255]);return~U}return n.table=t,n.bstr=R,n.buf=N,n.str=I,n}(),An=function(){var e={};e.version="1.2.2";function t(M,V){for(var z=M.split("/"),j=V.split("/"),G=0,X=0,he=Math.min(z.length,j.length);G<he;++G){if(X=z[G].length-j[G].length)return X;if(z[G]!=j[G])return z[G]<j[G]?-1:1}return z.length-j.length}function r(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:r(M.slice(0,-1));var V=M.lastIndexOf("/");return V===-1?M:M.slice(0,V+1)}function i(M){if(M.charAt(M.length-1)=="/")return i(M.slice(0,-1));var V=M.lastIndexOf("/");return V===-1?M:M.slice(V+1)}function a(M,V){typeof V=="string"&&(V=new Date(V));var z=V.getHours();z=z<<6|V.getMinutes(),z=z<<5|V.getSeconds()>>>1,M.write_shift(2,z);var j=V.getFullYear()-1980;j=j<<4|V.getMonth()+1,j=j<<5|V.getDate(),M.write_shift(2,j)}function o(M){var V=M.read_shift(2)&65535,z=M.read_shift(2)&65535,j=new Date,G=z&31;z>>>=5;var X=z&15;z>>>=4,j.setMilliseconds(0),j.setFullYear(z+1980),j.setMonth(X-1),j.setDate(G);var he=V&31;V>>>=5;var Ee=V&63;return V>>>=6,j.setHours(V),j.setMinutes(Ee),j.setSeconds(he<<1),j}function c(M){mi(M,0);for(var V={},z=0;M.l<=M.length-4;){var j=M.read_shift(2),G=M.read_shift(2),X=M.l+G,he={};switch(j){case 21589:z=M.read_shift(1),z&1&&(he.mtime=M.read_shift(4)),G>5&&(z&2&&(he.atime=M.read_shift(4)),z&4&&(he.ctime=M.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break;case 1:{var Ee=M.read_shift(4),ie=M.read_shift(4);he.usz=ie*Math.pow(2,32)+Ee,Ee=M.read_shift(4),ie=M.read_shift(4),he.csz=ie*Math.pow(2,32)+Ee}break}M.l=X,V[j]=he}return V}var f;function h(){return f||(f=f7)}function d(M,V){if(M[0]==80&&M[1]==75)return Nl(M,V);if((M[0]|32)==109&&(M[1]|32)==105)return na(M,V);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var z=3,j=512,G=0,X=0,he=0,Ee=0,ie=0,ce=[],ue=M.slice(0,512);mi(ue,0);var Re=g(ue);switch(z=Re[0],z){case 3:j=512;break;case 4:j=4096;break;case 0:if(Re[1]==0)return Nl(M,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}j!==512&&(ue=M.slice(0,j),mi(ue,28));var $e=M.slice(0,j);m(ue,z);var Ze=ue.read_shift(4,"i");if(z===3&&Ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ze);ue.l+=4,he=ue.read_shift(4,"i"),ue.l+=4,ue.chk("00100000","Mini Stream Cutoff Size: "),Ee=ue.read_shift(4,"i"),G=ue.read_shift(4,"i"),ie=ue.read_shift(4,"i"),X=ue.read_shift(4,"i");for(var Ue=-1,Ve=0;Ve<109&&(Ue=ue.read_shift(4,"i"),!(Ue<0));++Ve)ce[Ve]=Ue;var St=v(M,j);A(ie,X,St,j,ce);var Jt=C(St,he,ce,j);he<Jt.length&&(Jt[he].name="!Directory"),G>0&&Ee!==Te&&(Jt[Ee].name="!MiniFAT"),Jt[ce[0]].name="!FAT",Jt.fat_addrs=ce,Jt.ssz=j;var Xt={},cn=[],zi=[],ds=[];T(he,Jt,St,cn,G,Xt,zi,Ee),y(zi,ds,cn),cn.shift();var ni={FileIndex:zi,FullPaths:ds};return V&&V.raw&&(ni.raw={header:$e,sectors:St}),ni}function g(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(Fe,"Header Signature: "),M.l+=16;var V=M.read_shift(2,"u");return[M.read_shift(2,"u"),V]}function m(M,V){var z=9;switch(M.l+=2,z=M.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function v(M,V){for(var z=Math.ceil(M.length/V)-1,j=[],G=1;G<z;++G)j[G-1]=M.slice(G*V,(G+1)*V);return j[z-1]=M.slice(z*V),j}function y(M,V,z){for(var j=0,G=0,X=0,he=0,Ee=0,ie=z.length,ce=[],ue=[];j<ie;++j)ce[j]=ue[j]=j,V[j]=z[j];for(;Ee<ue.length;++Ee)j=ue[Ee],G=M[j].L,X=M[j].R,he=M[j].C,ce[j]===j&&(G!==-1&&ce[G]!==G&&(ce[j]=ce[G]),X!==-1&&ce[X]!==X&&(ce[j]=ce[X])),he!==-1&&(ce[he]=j),G!==-1&&j!=ce[j]&&(ce[G]=ce[j],ue.lastIndexOf(G)<Ee&&ue.push(G)),X!==-1&&j!=ce[j]&&(ce[X]=ce[j],ue.lastIndexOf(X)<Ee&&ue.push(X));for(j=1;j<ie;++j)ce[j]===j&&(X!==-1&&ce[X]!==X?ce[j]=ce[X]:G!==-1&&ce[G]!==G&&(ce[j]=ce[G]));for(j=1;j<ie;++j)if(M[j].type!==0){if(Ee=j,Ee!=ce[Ee])do Ee=ce[Ee],V[j]=V[Ee]+"/"+V[j];while(Ee!==0&&ce[Ee]!==-1&&Ee!=ce[Ee]);ce[j]=-1}for(V[0]+="/",j=1;j<ie;++j)M[j].type!==2&&(V[j]+="/")}function b(M,V,z){for(var j=M.start,G=M.size,X=[],he=j;z&&G>0&&he>=0;)X.push(V.slice(he*re,he*re+re)),G-=re,he=cc(z,he*4);return X.length===0?pe(0):sr(X).slice(0,M.size)}function A(M,V,z,j,G){var X=Te;if(M===Te){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var he=z[M],Ee=(j>>>2)-1;if(!he)return;for(var ie=0;ie<Ee&&(X=cc(he,ie*4))!==Te;++ie)G.push(X);V>=1&&A(cc(he,j-4),V-1,z,j,G)}}function w(M,V,z,j,G){var X=[],he=[];G||(G=[]);var Ee=j-1,ie=0,ce=0;for(ie=V;ie>=0;){G[ie]=!0,X[X.length]=ie,he.push(M[ie]);var ue=z[Math.floor(ie*4/j)];if(ce=ie*4&Ee,j<4+ce)throw new Error("FAT boundary crossed: "+ie+" 4 "+j);if(!M[ue])break;ie=cc(M[ue],ce)}return{nodes:X,data:aS([he])}}function C(M,V,z,j){var G=M.length,X=[],he=[],Ee=[],ie=[],ce=j-1,ue=0,Re=0,$e=0,Ze=0;for(ue=0;ue<G;++ue)if(Ee=[],$e=ue+V,$e>=G&&($e-=G),!he[$e]){ie=[];var Ue=[];for(Re=$e;Re>=0;){Ue[Re]=!0,he[Re]=!0,Ee[Ee.length]=Re,ie.push(M[Re]);var Ve=z[Math.floor(Re*4/j)];if(Ze=Re*4&ce,j<4+Ze)throw new Error("FAT boundary crossed: "+Re+" 4 "+j);if(!M[Ve]||(Re=cc(M[Ve],Ze),Ue[Re]))break}X[$e]={nodes:Ee,data:aS([ie])}}return X}function T(M,V,z,j,G,X,he,Ee){for(var ie=0,ce=j.length?2:0,ue=V[M].data,Re=0,$e=0,Ze;Re<ue.length;Re+=128){var Ue=ue.slice(Re,Re+128);mi(Ue,64),$e=Ue.read_shift(2),Ze=ry(Ue,0,$e-ce),j.push(Ze);var Ve={name:Ze,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},St=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);St!==0&&(Ve.ct=R(Ue,Ue.l-8));var Jt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);Jt!==0&&(Ve.mt=R(Ue,Ue.l-8)),Ve.start=Ue.read_shift(4,"i"),Ve.size=Ue.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=Te,Ve.name=""),Ve.type===5?(ie=Ve.start,G>0&&ie!==Te&&(V[ie].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",V[Ve.start]===void 0&&(V[Ve.start]=w(z,Ve.start,V.fat_addrs,V.ssz)),V[Ve.start].name=Ve.name,Ve.content=V[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:ie!==Te&&Ve.start!==Te&&V[ie]&&(Ve.content=b(Ve,V[ie].data,(V[Ee]||{}).data))),Ve.content&&mi(Ve.content,0),X[Ze]=Ve,he.push(Ve)}}function R(M,V){return new Date((rs(M,V+4)/1e7*Math.pow(2,32)+rs(M,V)/1e7-11644473600)*1e3)}function N(M,V){return h(),d(f.readFileSync(M),V)}function I(M,V){var z=V&&V.type;switch(z||an&&Buffer.isBuffer(M)&&(z="buffer"),z||"base64"){case"file":return N(M,V);case"base64":return d(ts(Al(M)),V);case"binary":return d(ts(M),V)}return d(M,V)}function D(M,V){var z=V||{},j=z.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=j+"/",M.FileIndex[0]={name:j,type:5}),z.CLSID&&(M.FileIndex[0].clsid=z.CLSID),B(M)}function B(M){var V="Sh33tJ5";if(!An.find(M,"/"+V)){var z=pe(4);z[0]=55,z[1]=z[3]=50,z[2]=54,M.FileIndex.push({name:V,type:2,content:z,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+V),U(M)}}function U(M,V){D(M);for(var z=!1,j=!1,G=M.FullPaths.length-1;G>=0;--G){var X=M.FileIndex[G];switch(X.type){case 0:j?z=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(X.R*X.L*X.C)&&(z=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!V)){var he=new Date(1987,1,19),Ee=0,ie=Object.create?Object.create(null):{},ce=[];for(G=0;G<M.FullPaths.length;++G)ie[M.FullPaths[G]]=!0,M.FileIndex[G].type!==0&&ce.push([M.FullPaths[G],M.FileIndex[G]]);for(G=0;G<ce.length;++G){var ue=r(ce[G][0]);for(j=ie[ue];!j;){for(;r(ue)&&!ie[r(ue)];)ue=r(ue);ce.push([ue,{name:i(ue).replace("/",""),type:1,clsid:q,ct:he,mt:he,content:null}]),ie[ue]=!0,ue=r(ce[G][0]),j=ie[ue]}}for(ce.sort(function(Ze,Ue){return t(Ze[0],Ue[0])}),M.FullPaths=[],M.FileIndex=[],G=0;G<ce.length;++G)M.FullPaths[G]=ce[G][0],M.FileIndex[G]=ce[G][1];for(G=0;G<ce.length;++G){var Re=M.FileIndex[G],$e=M.FullPaths[G];if(Re.name=i($e).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||q,G===0)Re.C=ce.length>1?1:-1,Re.size=0,Re.type=5;else if($e.slice(-1)=="/"){for(Ee=G+1;Ee<ce.length&&r(M.FullPaths[Ee])!=$e;++Ee);for(Re.C=Ee>=ce.length?-1:Ee,Ee=G+1;Ee<ce.length&&r(M.FullPaths[Ee])!=r($e);++Ee);Re.R=Ee>=ce.length?-1:Ee,Re.type=1}else r(M.FullPaths[G+1]||"")==r($e)&&(Re.R=G+1),Re.type=2}}}function Y(M,V){var z=V||{};if(z.fileType=="mad")return Br(M,z);switch(U(M),z.fileType){case"zip":return hs(M,z)}var j=function(Ze){for(var Ue=0,Ve=0,St=0;St<Ze.FileIndex.length;++St){var Jt=Ze.FileIndex[St];if(Jt.content){var Xt=Jt.content.length;Xt>0&&(Xt<4096?Ue+=Xt+63>>6:Ve+=Xt+511>>9)}}for(var cn=Ze.FullPaths.length+3>>2,zi=Ue+7>>3,ds=Ue+127>>7,ni=zi+Ve+cn+ds,wi=ni+127>>7,ia=wi<=109?0:Math.ceil((wi-109)/127);ni+wi+ia+127>>7>wi;)ia=++wi<=109?0:Math.ceil((wi-109)/127);var Si=[1,ia,wi,ds,cn,Ve,Ue,0];return Ze.FileIndex[0].size=Ue<<6,Si[7]=(Ze.FileIndex[0].start=Si[0]+Si[1]+Si[2]+Si[3]+Si[4]+Si[5])+(Si[6]+7>>3),Si}(M),G=pe(j[7]<<9),X=0,he=0;{for(X=0;X<8;++X)G.write_shift(1,we[X]);for(X=0;X<8;++X)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),X=0;X<3;++X)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,j[2]),G.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:Te),G.write_shift(4,j[3]),G.write_shift(-4,j[1]?j[0]-1:Te),G.write_shift(4,j[1]),X=0;X<109;++X)G.write_shift(-4,X<j[2]?j[1]+X:-1)}if(j[1])for(he=0;he<j[1];++he){for(;X<236+he*127;++X)G.write_shift(-4,X<j[2]?j[1]+X:-1);G.write_shift(-4,he===j[1]-1?Te:he+1)}var Ee=function(Ze){for(he+=Ze;X<he-1;++X)G.write_shift(-4,X+1);Ze&&(++X,G.write_shift(-4,Te))};for(he=X=0,he+=j[1];X<he;++X)G.write_shift(-4,ee.DIFSECT);for(he+=j[2];X<he;++X)G.write_shift(-4,ee.FATSECT);Ee(j[3]),Ee(j[4]);for(var ie=0,ce=0,ue=M.FileIndex[0];ie<M.FileIndex.length;++ie)ue=M.FileIndex[ie],ue.content&&(ce=ue.content.length,!(ce<4096)&&(ue.start=he,Ee(ce+511>>9)));for(Ee(j[6]+7>>3);G.l&511;)G.write_shift(-4,ee.ENDOFCHAIN);for(he=X=0,ie=0;ie<M.FileIndex.length;++ie)ue=M.FileIndex[ie],ue.content&&(ce=ue.content.length,!(!ce||ce>=4096)&&(ue.start=he,Ee(ce+63>>6)));for(;G.l&511;)G.write_shift(-4,ee.ENDOFCHAIN);for(X=0;X<j[4]<<2;++X){var Re=M.FullPaths[X];if(!Re||Re.length===0){for(ie=0;ie<17;++ie)G.write_shift(4,0);for(ie=0;ie<3;++ie)G.write_shift(4,-1);for(ie=0;ie<12;++ie)G.write_shift(4,0);continue}ue=M.FileIndex[X],X===0&&(ue.start=ue.size?ue.start-1:Te);var $e=X===0&&z.root||ue.name;if($e.length>31&&(console.error("Name "+$e+" will be truncated to "+$e.slice(0,31)),$e=$e.slice(0,31)),ce=2*($e.length+1),G.write_shift(64,$e,"utf16le"),G.write_shift(2,ce),G.write_shift(1,ue.type),G.write_shift(1,ue.color),G.write_shift(-4,ue.L),G.write_shift(-4,ue.R),G.write_shift(-4,ue.C),ue.clsid)G.write_shift(16,ue.clsid,"hex");else for(ie=0;ie<4;++ie)G.write_shift(4,0);G.write_shift(4,ue.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,ue.start),G.write_shift(4,ue.size),G.write_shift(4,0)}for(X=1;X<M.FileIndex.length;++X)if(ue=M.FileIndex[X],ue.size>=4096)if(G.l=ue.start+1<<9,an&&Buffer.isBuffer(ue.content))ue.content.copy(G,G.l,0,ue.size),G.l+=ue.size+511&-512;else{for(ie=0;ie<ue.size;++ie)G.write_shift(1,ue.content[ie]);for(;ie&511;++ie)G.write_shift(1,0)}for(X=1;X<M.FileIndex.length;++X)if(ue=M.FileIndex[X],ue.size>0&&ue.size<4096)if(an&&Buffer.isBuffer(ue.content))ue.content.copy(G,G.l,0,ue.size),G.l+=ue.size+63&-64;else{for(ie=0;ie<ue.size;++ie)G.write_shift(1,ue.content[ie]);for(;ie&63;++ie)G.write_shift(1,0)}if(an)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function W(M,V){var z=M.FullPaths.map(function(ie){return ie.toUpperCase()}),j=z.map(function(ie){var ce=ie.split("/");return ce[ce.length-(ie.slice(-1)=="/"?2:1)]}),G=!1;V.charCodeAt(0)===47?(G=!0,V=z[0].slice(0,-1)+V):G=V.indexOf("/")!==-1;var X=V.toUpperCase(),he=G===!0?z.indexOf(X):j.indexOf(X);if(he!==-1)return M.FileIndex[he];var Ee=!X.match(Zp);for(X=X.replace(cd,""),Ee&&(X=X.replace(Zp,"!")),he=0;he<z.length;++he)if((Ee?z[he].replace(Zp,"!"):z[he]).replace(cd,"")==X||(Ee?j[he].replace(Zp,"!"):j[he]).replace(cd,"")==X)return M.FileIndex[he];return null}var re=64,Te=-2,Fe="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Te,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Pe(M,V,z){h();var j=Y(M,z);f.writeFileSync(V,j)}function qe(M){for(var V=new Array(M.length),z=0;z<M.length;++z)V[z]=String.fromCharCode(M[z]);return V.join("")}function P(M,V){var z=Y(M,V);switch(V&&V.type||"buffer"){case"file":return h(),f.writeFileSync(V.filename,z),z;case"binary":return typeof z=="string"?z:qe(z);case"base64":return Rg(typeof z=="string"?z:qe(z));case"buffer":if(an)return Buffer.isBuffer(z)?z:Ba(z);case"array":return typeof z=="string"?ts(z):z}return z}var ye;function ve(M){try{var V=M.InflateRaw,z=new V;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)ye=M;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function ge(M,V){if(!ye)return Bc(M,V);var z=ye.InflateRaw,j=new z,G=j._processChunk(M.slice(M.l),j._finishFlushFlag);return M.l+=j.bytesRead,G}function Ce(M){return ye?ye.deflateRawSync(M):Kn(M)}var He=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function k(M){var V=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(V>>16|V>>8|V)&255}for(var se=typeof Uint8Array<"u",Z=se?new Uint8Array(256):[],J=0;J<256;++J)Z[J]=k(J);function xe(M,V){var z=Z[M&255];return V<=8?z>>>8-V:(z=z<<8|Z[M>>8&255],V<=16?z>>>16-V:(z=z<<8|Z[M>>16&255],z>>>24-V))}function be(M,V){var z=V&7,j=V>>>3;return(M[j]|(z<=6?0:M[j+1]<<8))>>>z&3}function Se(M,V){var z=V&7,j=V>>>3;return(M[j]|(z<=5?0:M[j+1]<<8))>>>z&7}function Ye(M,V){var z=V&7,j=V>>>3;return(M[j]|(z<=4?0:M[j+1]<<8))>>>z&15}function De(M,V){var z=V&7,j=V>>>3;return(M[j]|(z<=3?0:M[j+1]<<8))>>>z&31}function nt(M,V){var z=V&7,j=V>>>3;return(M[j]|(z<=1?0:M[j+1]<<8))>>>z&127}function rt(M,V,z){var j=V&7,G=V>>>3,X=(1<<z)-1,he=M[G]>>>j;return z<8-j||(he|=M[G+1]<<8-j,z<16-j)||(he|=M[G+2]<<16-j,z<24-j)||(he|=M[G+3]<<24-j),he&X}function ht(M,V,z){var j=V&7,G=V>>>3;return j<=5?M[G]|=(z&7)<<j:(M[G]|=z<<j&255,M[G+1]=(z&7)>>8-j),V+3}function Rt(M,V,z){var j=V&7,G=V>>>3;return z=(z&1)<<j,M[G]|=z,V+1}function kt(M,V,z){var j=V&7,G=V>>>3;return z<<=j,M[G]|=z&255,z>>>=8,M[G+1]=z,V+8}function nn(M,V,z){var j=V&7,G=V>>>3;return z<<=j,M[G]|=z&255,z>>>=8,M[G+1]=z&255,M[G+2]=z>>>8,V+16}function Qe(M,V){var z=M.length,j=2*z>V?2*z:V+5,G=0;if(z>=V)return M;if(an){var X=Vw(j);if(M.copy)M.copy(X);else for(;G<M.length;++G)X[G]=M[G];return X}else if(se){var he=new Uint8Array(j);if(he.set)he.set(M);else for(;G<z;++G)he[G]=M[G];return he}return M.length=j,M}function Ct(M){for(var V=new Array(M),z=0;z<M;++z)V[z]=0;return V}function je(M,V,z){var j=1,G=0,X=0,he=0,Ee=0,ie=M.length,ce=se?new Uint16Array(32):Ct(32);for(X=0;X<32;++X)ce[X]=0;for(X=ie;X<z;++X)M[X]=0;ie=M.length;var ue=se?new Uint16Array(ie):Ct(ie);for(X=0;X<ie;++X)ce[G=M[X]]++,j<G&&(j=G),ue[X]=0;for(ce[0]=0,X=1;X<=j;++X)ce[X+16]=Ee=Ee+ce[X-1]<<1;for(X=0;X<ie;++X)Ee=M[X],Ee!=0&&(ue[X]=ce[Ee+16]++);var Re=0;for(X=0;X<ie;++X)if(Re=M[X],Re!=0)for(Ee=xe(ue[X],j)>>j-Re,he=(1<<j+4-Re)-1;he>=0;--he)V[Ee|he<<Re]=Re&15|X<<4;return j}var Tn=se?new Uint16Array(512):Ct(512),zt=se?new Uint16Array(32):Ct(32);if(!se){for(var It=0;It<512;++It)Tn[It]=0;for(It=0;It<32;++It)zt[It]=0}(function(){for(var M=[],V=0;V<32;V++)M.push(5);je(M,zt,32);var z=[];for(V=0;V<=143;V++)z.push(8);for(;V<=255;V++)z.push(9);for(;V<=279;V++)z.push(7);for(;V<=287;V++)z.push(8);je(z,Tn,288)})();var on=function(){for(var V=se?new Uint8Array(32768):[],z=0,j=0;z<Ge.length-1;++z)for(;j<Ge[z+1];++j)V[j]=z;for(;j<32768;++j)V[j]=29;var G=se?new Uint8Array(259):[];for(z=0,j=0;z<Ie.length-1;++z)for(;j<Ie[z+1];++j)G[j]=z;function X(Ee,ie){for(var ce=0;ce<Ee.length;){var ue=Math.min(65535,Ee.length-ce),Re=ce+ue==Ee.length;for(ie.write_shift(1,+Re),ie.write_shift(2,ue),ie.write_shift(2,~ue&65535);ue-- >0;)ie[ie.l++]=Ee[ce++]}return ie.l}function he(Ee,ie){for(var ce=0,ue=0,Re=se?new Uint16Array(32768):[];ue<Ee.length;){var $e=Math.min(65535,Ee.length-ue);if($e<10){for(ce=ht(ie,ce,+(ue+$e==Ee.length)),ce&7&&(ce+=8-(ce&7)),ie.l=ce/8|0,ie.write_shift(2,$e),ie.write_shift(2,~$e&65535);$e-- >0;)ie[ie.l++]=Ee[ue++];ce=ie.l*8;continue}ce=ht(ie,ce,+(ue+$e==Ee.length)+2);for(var Ze=0;$e-- >0;){var Ue=Ee[ue];Ze=(Ze<<5^Ue)&32767;var Ve=-1,St=0;if((Ve=Re[Ze])&&(Ve|=ue&-32768,Ve>ue&&(Ve-=32768),Ve<ue))for(;Ee[Ve+St]==Ee[ue+St]&&St<250;)++St;if(St>2){Ue=G[St],Ue<=22?ce=kt(ie,ce,Z[Ue+1]>>1)-1:(kt(ie,ce,3),ce+=5,kt(ie,ce,Z[Ue-23]>>5),ce+=3);var Jt=Ue<8?0:Ue-4>>2;Jt>0&&(nn(ie,ce,St-Ie[Ue]),ce+=Jt),Ue=V[ue-Ve],ce=kt(ie,ce,Z[Ue]>>3),ce-=3;var Xt=Ue<4?0:Ue-2>>1;Xt>0&&(nn(ie,ce,ue-Ve-Ge[Ue]),ce+=Xt);for(var cn=0;cn<St;++cn)Re[Ze]=ue&32767,Ze=(Ze<<5^Ee[ue])&32767,++ue;$e-=St-1}else Ue<=143?Ue=Ue+48:ce=Rt(ie,ce,1),ce=kt(ie,ce,Z[Ue]),Re[Ze]=ue&32767,++ue}ce=kt(ie,ce,0)-1}return ie.l=(ce+7)/8|0,ie.l}return function(ie,ce){return ie.length<8?X(ie,ce):he(ie,ce)}}();function Kn(M){var V=pe(50+Math.floor(M.length*1.1)),z=on(M,V);return V.slice(0,z)}var Ht=se?new Uint16Array(32768):Ct(32768),Bn=se?new Uint16Array(32768):Ct(32768),Ei=se?new Uint16Array(128):Ct(128),Hi=1,cr=1;function Ai(M,V){var z=De(M,V)+257;V+=5;var j=De(M,V)+1;V+=5;var G=Ye(M,V)+4;V+=4;for(var X=0,he=se?new Uint8Array(19):Ct(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,ce=se?new Uint8Array(8):Ct(8),ue=se?new Uint8Array(8):Ct(8),Re=he.length,$e=0;$e<G;++$e)he[He[$e]]=X=Se(M,V),ie<X&&(ie=X),ce[X]++,V+=3;var Ze=0;for(ce[0]=0,$e=1;$e<=ie;++$e)ue[$e]=Ze=Ze+ce[$e-1]<<1;for($e=0;$e<Re;++$e)(Ze=he[$e])!=0&&(Ee[$e]=ue[Ze]++);var Ue=0;for($e=0;$e<Re;++$e)if(Ue=he[$e],Ue!=0){Ze=Z[Ee[$e]]>>8-Ue;for(var Ve=(1<<7-Ue)-1;Ve>=0;--Ve)Ei[Ze|Ve<<Ue]=Ue&7|$e<<3}var St=[];for(ie=1;St.length<z+j;)switch(Ze=Ei[nt(M,V)],V+=Ze&7,Ze>>>=3){case 16:for(X=3+be(M,V),V+=2,Ze=St[St.length-1];X-- >0;)St.push(Ze);break;case 17:for(X=3+Se(M,V),V+=3;X-- >0;)St.push(0);break;case 18:for(X=11+nt(M,V),V+=7;X-- >0;)St.push(0);break;default:St.push(Ze),ie<Ze&&(ie=Ze);break}var Jt=St.slice(0,z),Xt=St.slice(z);for($e=z;$e<286;++$e)Jt[$e]=0;for($e=j;$e<30;++$e)Xt[$e]=0;return Hi=je(Jt,Ht,286),cr=je(Xt,Bn,30),V}function fs(M,V){if(M[0]==3&&!(M[1]&3))return[Sc(V),2];for(var z=0,j=0,G=Vw(V||1<<18),X=0,he=G.length>>>0,Ee=0,ie=0;(j&1)==0;){if(j=Se(M,z),z+=3,j>>>1)j>>1==1?(Ee=9,ie=5):(z=Ai(M,z),Ee=Hi,ie=cr);else{z&7&&(z+=8-(z&7));var ce=M[z>>>3]|M[(z>>>3)+1]<<8;if(z+=32,ce>0)for(!V&&he<X+ce&&(G=Qe(G,X+ce),he=G.length);ce-- >0;)G[X++]=M[z>>>3],z+=8;continue}for(;;){!V&&he<X+32767&&(G=Qe(G,X+32767),he=G.length);var ue=rt(M,z,Ee),Re=j>>>1==1?Tn[ue]:Ht[ue];if(z+=Re&15,Re>>>=4,(Re>>>8&255)===0)G[X++]=Re;else{if(Re==256)break;Re-=257;var $e=Re<8?0:Re-4>>2;$e>5&&($e=0);var Ze=X+Ie[Re];$e>0&&(Ze+=rt(M,z,$e),z+=$e),ue=rt(M,z,ie),Re=j>>>1==1?zt[ue]:Bn[ue],z+=Re&15,Re>>>=4;var Ue=Re<4?0:Re-2>>1,Ve=Ge[Re];for(Ue>0&&(Ve+=rt(M,z,Ue),z+=Ue),!V&&he<Ze&&(G=Qe(G,Ze+100),he=G.length);X<Ze;)G[X]=G[X-Ve],++X}}}return V?[G,z+7>>>3]:[G.slice(0,X),z+7>>>3]}function Bc(M,V){var z=M.slice(M.l||0),j=fs(z,V);return M.l+=j[1],j[0]}function Rl(M,V){if(M)typeof console<"u"&&console.error(V);else throw new Error(V)}function Nl(M,V){var z=M;mi(z,0);var j=[],G=[],X={FileIndex:j,FullPaths:G};D(X,{root:V.root});for(var he=z.length-4;(z[he]!=80||z[he+1]!=75||z[he+2]!=5||z[he+3]!=6)&&he>=0;)--he;z.l=he+4,z.l+=4;var Ee=z.read_shift(2);z.l+=6;var ie=z.read_shift(4);for(z.l=ie,he=0;he<Ee;++he){z.l+=20;var ce=z.read_shift(4),ue=z.read_shift(4),Re=z.read_shift(2),$e=z.read_shift(2),Ze=z.read_shift(2);z.l+=8;var Ue=z.read_shift(4),Ve=c(z.slice(z.l+Re,z.l+Re+$e));z.l+=Re+$e+Ze;var St=z.l;z.l=Ue+4,Ve&&Ve[1]&&((Ve[1]||{}).usz&&(ue=Ve[1].usz),(Ve[1]||{}).csz&&(ce=Ve[1].csz)),Lo(z,ce,ue,X,Ve),z.l=St}return X}function Lo(M,V,z,j,G){M.l+=2;var X=M.read_shift(2),he=M.read_shift(2),Ee=o(M);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ie=M.read_shift(4),ce=M.read_shift(4),ue=M.read_shift(4),Re=M.read_shift(2),$e=M.read_shift(2),Ze="",Ue=0;Ue<Re;++Ue)Ze+=String.fromCharCode(M[M.l++]);if($e){var Ve=c(M.slice(M.l,M.l+$e));(Ve[21589]||{}).mt&&(Ee=Ve[21589].mt),(Ve[1]||{}).usz&&(ue=Ve[1].usz),(Ve[1]||{}).csz&&(ce=Ve[1].csz),G&&((G[21589]||{}).mt&&(Ee=G[21589].mt),(G[1]||{}).usz&&(ue=G[1].usz),(G[1]||{}).csz&&(ce=G[1].csz))}M.l+=$e;var St=M.slice(M.l,M.l+ce);switch(he){case 8:St=ge(M,ue);break;case 0:M.l+=ce;break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Jt=!1;X&8&&(ie=M.read_shift(4),ie==134695760&&(ie=M.read_shift(4),Jt=!0),ce=M.read_shift(4),ue=M.read_shift(4)),ce!=V&&Rl(Jt,"Bad compressed size: "+V+" != "+ce),ue!=z&&Rl(Jt,"Bad uncompressed size: "+z+" != "+ue),Zn(j,Ze,St,{unsafe:!0,mt:Ee})}function hs(M,V){var z=V||{},j=[],G=[],X=pe(1),he=z.compression?8:0,Ee=0,ie=0,ce=0,ue=0,Re=0,$e=M.FullPaths[0],Ze=$e,Ue=M.FileIndex[0],Ve=[],St=0;for(ie=1;ie<M.FullPaths.length;++ie)if(Ze=M.FullPaths[ie].slice($e.length),Ue=M.FileIndex[ie],!(!Ue.size||!Ue.content||Array.isArray(Ue.content)&&Ue.content.length==0||Ze=="Sh33tJ5")){var Jt=ue,Xt=pe(Ze.length);for(ce=0;ce<Ze.length;++ce)Xt.write_shift(1,Ze.charCodeAt(ce)&127);Xt=Xt.slice(0,Xt.l),Ve[Re]=typeof Ue.content=="string"?Jw.bstr(Ue.content,0):Jw.buf(Ue.content,0);var cn=typeof Ue.content=="string"?ts(Ue.content):Ue.content;he==8&&(cn=Ce(cn)),X=pe(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,Ee),X.write_shift(2,he),Ue.mt?a(X,Ue.mt):X.write_shift(4,0),X.write_shift(-4,Ve[Re]),X.write_shift(4,cn.length),X.write_shift(4,Ue.content.length),X.write_shift(2,Xt.length),X.write_shift(2,0),ue+=X.length,j.push(X),ue+=Xt.length,j.push(Xt),ue+=cn.length,j.push(cn),X=pe(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,Ee),X.write_shift(2,he),X.write_shift(4,0),X.write_shift(-4,Ve[Re]),X.write_shift(4,cn.length),X.write_shift(4,Ue.content.length),X.write_shift(2,Xt.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Jt),St+=X.l,G.push(X),St+=Xt.length,G.push(Xt),++Re}return X=pe(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Re),X.write_shift(2,Re),X.write_shift(4,St),X.write_shift(4,ue),X.write_shift(2,0),sr([sr(j),sr(G),X])}var Ua={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ll(M,V){if(M.ctype)return M.ctype;var z=M.name||"",j=z.match(/\.([^\.]+)$/);return j&&Ua[j[1]]||V&&(j=(z=V).match(/[\.\\]([^\.\\])+$/),j&&Ua[j[1]])?Ua[j[1]]:"application/octet-stream"}function Uc(M){for(var V=Rg(M),z=[],j=0;j<V.length;j+=76)z.push(V.slice(j,j+76));return z.join(`\r
`)+`\r
`}function Ml(M){var V=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var ue=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(ue.length==1?"0"+ue:ue)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],j=V.split(`\r
`),G=0;G<j.length;++G){var X=j[G];if(X.length==0){z.push("");continue}for(var he=0;he<X.length;){var Ee=76,ie=X.slice(he,he+Ee);ie.charAt(Ee-1)=="="?Ee--:ie.charAt(Ee-2)=="="?Ee-=2:ie.charAt(Ee-3)=="="&&(Ee-=3),ie=X.slice(he,he+Ee),he+=Ee,he<X.length&&(ie+="="),z.push(ie)}}return z.join(`\r
`)}function Il(M){for(var V=[],z=0;z<M.length;++z){for(var j=M[z];z<=M.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+M[++z];V.push(j)}for(var G=0;G<V.length;++G)V[G]=V[G].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return ts(V.join(`\r
`))}function Hc(M,V,z){for(var j="",G="",X="",he,Ee=0;Ee<10;++Ee){var ie=V[Ee];if(!ie||ie.match(/^\s*$/))break;var ce=ie.match(/^([^:]*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":j=ce[2].trim();break;case"content-type":X=ce[2].trim();break;case"content-transfer-encoding":G=ce[2].trim();break}}switch(++Ee,G.toLowerCase()){case"base64":he=ts(Al(V.slice(Ee).join("")));break;case"quoted-printable":he=Il(V.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var ue=Zn(M,j.slice(z.length),he,{unsafe:!0});X&&(ue.ctype=X)}function na(M,V){if(qe(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=V&&V.root||"",j=(an&&Buffer.isBuffer(M)?M.toString("binary"):qe(M)).split(`\r
`),G=0,X="";for(G=0;G<j.length;++G)if(X=j[G],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),z||(z=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),X.slice(0,z.length)!=z););var he=(j[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var Ee="--"+(he[1]||""),ie=[],ce=[],ue={FileIndex:ie,FullPaths:ce};D(ue);var Re,$e=0;for(G=0;G<j.length;++G){var Ze=j[G];Ze!==Ee&&Ze!==Ee+"--"||($e++&&Hc(ue,j.slice(Re,G),z),Re=G)}return ue}function Br(M,V){var z=V||{},j=z.boundary||"SheetJS";j="------="+j;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],X=M.FullPaths[0],he=X,Ee=M.FileIndex[0],ie=1;ie<M.FullPaths.length;++ie)if(he=M.FullPaths[ie].slice(X.length),Ee=M.FileIndex[ie],!(!Ee.size||!Ee.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(St){return"_x"+St.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(St){return"_u"+St.charCodeAt(0).toString(16)+"_"});for(var ce=Ee.content,ue=an&&Buffer.isBuffer(ce)?ce.toString("binary"):qe(ce),Re=0,$e=Math.min(1024,ue.length),Ze=0,Ue=0;Ue<=$e;++Ue)(Ze=ue.charCodeAt(Ue))>=32&&Ze<128&&++Re;var Ve=Re>=$e*4/5;G.push(j),G.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+he),G.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),G.push("Content-Type: "+Ll(Ee,he)),G.push(""),G.push(Ve?Ml(ue):Uc(ue))}return G.push(j+`--\r
`),G.join(`\r
`)}function Qn(M){var V={};return D(V,M),V}function Zn(M,V,z,j){var G=j&&j.unsafe;G||D(M);var X=!G&&An.find(M,V);if(!X){var he=M.FullPaths[0];V.slice(0,he.length)==he?he=V:(he.slice(-1)!="/"&&(he+="/"),he=(he+V).replace("//","/")),X={name:i(V),type:2},M.FileIndex.push(X),M.FullPaths.push(he),G||An.utils.cfb_gc(M)}return X.content=z,X.size=z?z.length:0,j&&(j.CLSID&&(X.clsid=j.CLSID),j.mt&&(X.mt=j.mt),j.ct&&(X.ct=j.ct)),X}function ra(M,V){D(M);var z=An.find(M,V);if(z){for(var j=0;j<M.FileIndex.length;++j)if(M.FileIndex[j]==z)return M.FileIndex.splice(j,1),M.FullPaths.splice(j,1),!0}return!1}function kl(M,V,z){D(M);var j=An.find(M,V);if(j){for(var G=0;G<M.FileIndex.length;++G)if(M.FileIndex[G]==j)return M.FileIndex[G].name=i(z),M.FullPaths[G]=z,!0}return!1}function Ef(M){U(M,!0)}return e.find=W,e.read=I,e.parse=d,e.write=P,e.writeFile=Pe,e.utils={cfb_new:Qn,cfb_add:Zn,cfb_del:ra,cfb_mov:kl,cfb_gc:Ef,ReadShift:ud,CheckField:gD,prep_blob:mi,bconcat:sr,use_zlib:ve,_deflateRaw:Kn,_inflateRaw:Bc,consts:ee},e}(),f7;function eS(n){return typeof n=="string"?bm(n):Array.isArray(n)?PU(n):n}function Zd(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=bm(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var r=t=="utf8"?Dd(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,n);if(typeof Blob<"u"){var i=new Blob([eS(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,n);if(typeof saveAs<"u")return saveAs(i,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:n,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=n,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var c="data:application/octet-stream;base64,"+FU(new Uint8Array(eS(r)));return chrome.downloads.download({url:c,filename:n,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(n);return f.open("w"),f.encoding="binary",Array.isArray(e)&&(e=Tc(e)),f.write(e),f.close(),e}catch(h){if(!h.message||h.message.indexOf("onstruct")==-1)throw h}throw new Error("cannot save file "+n)}function ar(n){for(var e=Object.keys(n),t=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(n,e[r])&&t.push(e[r]);return t}function tS(n,e){for(var t=[],r=ar(n),i=0;i!==r.length;++i)t[n[r[i]][e]]==null&&(t[n[r[i]][e]]=r[i]);return t}function Zx(n){for(var e=[],t=ar(n),r=0;r!==t.length;++r)e[n[t[r]]]=t[r];return e}function wm(n){for(var e=[],t=ar(n),r=0;r!==t.length;++r)e[n[t[r]]]=parseInt(t[r],10);return e}function h7(n){for(var e=[],t=ar(n),r=0;r!==t.length;++r)e[n[t[r]]]==null&&(e[n[t[r]]]=[]),e[n[t[r]]].push(t[r]);return e}var JC=Date.UTC(1899,11,30,0,0,0),d7=Date.UTC(1899,11,31,0,0,0),p7=Date.UTC(1904,0,1,0,0,0);function Pr(n,e){var t=n.getTime(),r=(t-JC)/(24*60*60*1e3);return e?(r-=1462,r<-1402?r-1:r):r<60?r-1:r}function ju(n){if(n>=60&&n<61)return n;var e=new Date;return e.setTime((n>60?n:n+1)*24*60*60*1e3+JC),e}var g7=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,m7=/^(\d+)-(\d+)-(\d+)$/,eD=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Ui(n,e){if(n instanceof Date)return n;var t=n.match(g7);if(t)return new Date((e?p7:d7)+((parseInt(t[1],10)*60+parseInt(t[2],10))*60+(t[3]?parseInt(t[3].slice(1),10):0))*1e3+(t[4]?parseInt((t[4]+"000").slice(1,4),10):0));if(t=n.match(m7),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],0,0,0,0));if(t=n.match(eD),t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],t[6]&&parseInt(t[6].slice(1),10)||0,t[7]&&parseInt((t[7]+"0000").slice(1,4),10)||0));var r=new Date(n);return r}function Jx(n,e){if(an&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(a){return t[a]||a})}catch{}var r=[],i=0;try{for(i=0;i<n.length-65536;i+=65536)r.push(String.fromCharCode.apply(0,n.slice(i,i+65536)));r.push(String.fromCharCode.apply(0,n.slice(i)))}catch{try{for(;i<n.length-16384;i+=16384)r.push(String.fromCharCode.apply(0,n.slice(i,i+16384)));r.push(String.fromCharCode.apply(0,n.slice(i)))}catch{for(;i!=n.length;++i)r.push(String.fromCharCode(n[i]))}}return r.join("")}function ti(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=ti(n[t]));return e}function Ln(n,e){for(var t="";t.length<e;)t+=n;return t}function wo(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(]([^()]*)[)]/,function(i,a){return t=-t,a}),!isNaN(e=Number(r)))?e/t:e}var v7=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,_7=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,x7=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,y7=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function b7(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,n[7]=="p"?12:0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1]%12+(n[7]=="p"?12:0),0,0,0))}function E7(n){return n[2]?n[3]?n[4]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[4],parseFloat(n[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+n[1],+n[2],parseFloat(n[3])*1e3)):n[5]?new Date(Date.UTC(1899,11,31,+n[1],+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+n[1],+n[2],0,0)):new Date(Date.UTC(1899,11,31,+n[1],0,0,0))}var A7=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fg(n){if(x7.test(n))return n.indexOf("Z")==-1?Sm(new Date(n)):new Date(n);var e=n.toLowerCase(),t=e.replace(/\s+/g," ").trim(),r=t.match(v7);if(r)return b7(r);if(r=t.match(_7),r)return E7(r);if(r=t.match(eD),r)return new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],r[6]&&parseInt(r[6].slice(1),10)||0,r[7]&&parseInt((r[7]+"0000").slice(1,4),10)||0));var i=new Date(y7&&n.indexOf("UTC")==-1?n+" UTC":n),a=new Date(NaN),o=i.getYear();i.getMonth();var c=i.getDate();if(isNaN(c))return a;if(e.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(e=e.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),e.length>3&&A7.indexOf(e)==-1)return a}else if(e.replace(/[ap]m?/,"").match(/[a-z]/))return a;return o<0||o>8099||n.match(/[^-0-9:,\/\\\ ]/)?a:i}function of(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds())}function Sm(n){return new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()))}function Pt(n,e,t){if(n.FullPaths){if(Array.isArray(t)&&typeof t[0]=="string"&&(t=t.join("")),typeof t=="string"){var r;return an?r=Ba(t):r=BU(t),An.utils.cfb_add(n,e,r)}An.utils.cfb_add(n,e,t)}else n.file(e,t)}function ey(){return An.utils.cfb_new()}var lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,w7={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ty=Zx(w7),ny=/[&<>'"]/g,S7=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Bt(n){var e=n+"";return e.replace(ny,function(t){return ty[t]}).replace(S7,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function nS(n){return Bt(n).replace(/ /g,"_x0020_")}var tD=/[\u0000-\u001f]/g;function Yv(n){var e=n+"";return e.replace(ny,function(t){return ty[t]}).replace(/\n/g,"<br/>").replace(tD,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function T7(n){var e=n+"";return e.replace(ny,function(t){return ty[t]}).replace(tD,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function C7(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function D7(n){switch(n){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function qv(n){for(var e="",t=0,r=0,i=0,a=0,o=0,c=0;t<n.length;){if(r=n.charCodeAt(t++),r<128){e+=String.fromCharCode(r);continue}if(i=n.charCodeAt(t++),r>191&&r<224){o=(r&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(a=n.charCodeAt(t++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|a&63);continue}o=n.charCodeAt(t++),c=((r&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function rS(n){var e=Sc(2*n.length),t,r,i=1,a=0,o=0,c;for(r=0;r<n.length;r+=i)i=1,(c=n.charCodeAt(r))<128?t=c:c<224?(t=(c&31)*64+(n.charCodeAt(r+1)&63),i=2):c<240?(t=(c&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),i=3):(i=4,t=(c&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),t-=65536,o=55296+(t>>>10&1023),t=56320+(t&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=t%256,e[a++]=t>>>8;return e.slice(0,a).toString("ucs2")}function iS(n){return Ba(n,"binary").toString("utf8")}var Jp="foo bar baz",$u=an&&(iS(Jp)==qv(Jp)&&iS||rS(Jp)==qv(Jp)&&rS)||qv,Dd=an?function(n){return Ba(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,r=0,i=0;t<n.length;)switch(r=n.charCodeAt(t++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=n.charCodeAt(t++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},O7=function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),i=0;i<n.length;++i)r=r.replace(n[i][0],n[i][1]);return r}}(),nD=/(^\s|\s$|\n)/;function Ir(n,e){return"<"+n+(e.match(nD)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Od(n){return ar(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function Xe(n,e,t){return"<"+n+(t!=null?Od(t):"")+(e!=null?(e.match(nD)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function I_(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function R7(n,e){switch(typeof n){case"string":var t=Xe("vt:lpwstr",Bt(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Xe((n|0)==n?"vt:i4":"vt:r8",Bt(String(n)));case"boolean":return Xe("vt:bool",n?"true":"false")}if(n instanceof Date)return Xe("vt:filetime",I_(n));throw new Error("Unable to serialize "+n)}var Er={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},vf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ns={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function N7(n,e){for(var t=1-2*(n[e+7]>>>7),r=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),i=n[e+6]&15,a=5;a>=0;--a)i=i*256+n[e+a];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function L7(n,e,t){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,a=0,o=r?-e:e;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(e)?26985:0);for(var c=0;c<=5;++c,a/=256)n[t+c]=a&255;n[t+6]=(i&15)<<4|a&15,n[t+7]=i>>4|r}var sS=function(n){for(var e=[],t=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var i=0,a=n[0][r].length;i<a;i+=t)e.push.apply(e,n[0][r].slice(i,i+t));return e},aS=an?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:Ba(e)})):sS(n)}:sS,oS=function(n,e,t){for(var r=[],i=e;i<t;i+=2)r.push(String.fromCharCode(td(n,i)));return r.join("").replace(cd,"")},ry=an?function(n,e,t){return!Buffer.isBuffer(n)||!Ng?oS(n,e,t):n.toString("utf16le",e,t).replace(cd,"")}:oS,lS=function(n,e,t){for(var r=[],i=e;i<e+t;++i)r.push(("0"+n[i].toString(16)).slice(-2));return r.join("")},rD=an?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):lS(n,e,t)}:lS,cS=function(n,e,t){for(var r=[],i=e;i<t;i++)r.push(String.fromCharCode(Iu(n,i)));return r.join("")},Jd=an?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):cS(e,t,r)}:cS,iD=function(n,e){var t=rs(n,e);return t>0?Jd(n,e+4,e+4+t-1):""},sD=iD,aD=function(n,e){var t=rs(n,e);return t>0?Jd(n,e+4,e+4+t-1):""},oD=aD,lD=function(n,e){var t=2*rs(n,e);return t>0?Jd(n,e+4,e+4+t-1):""},cD=lD,uD=function(e,t){var r=rs(e,t);return r>0?ry(e,t+4,t+4+r):""},fD=uD,hD=function(n,e){var t=rs(n,e);return t>0?Jd(n,e+4,e+4+t):""},dD=hD,pD=function(n,e){return N7(n,e)},Pg=pD,iy=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};an&&(sD=function(e,t){if(!Buffer.isBuffer(e))return iD(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},oD=function(e,t){if(!Buffer.isBuffer(e))return aD(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},cD=function(e,t){if(!Buffer.isBuffer(e)||!Ng)return lD(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},fD=function(e,t){if(!Buffer.isBuffer(e)||!Ng)return uD(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},dD=function(e,t){if(!Buffer.isBuffer(e))return hD(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Pg=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):pD(e,t)},iy=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Iu=function(n,e){return n[e]},td=function(n,e){return n[e+1]*256+n[e]},M7=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},rs=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},cc=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},I7=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function ud(n,e){var t="",r,i,a=[],o,c,f,h;switch(e){case"dbcs":if(h=this.l,an&&Buffer.isBuffer(this)&&Ng)t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(f=0;f<n;++f)t+=String.fromCharCode(td(this,h)),h+=2;n*=2;break;case"utf8":t=Jd(this,this.l,this.l+n);break;case"utf16le":n*=2,t=ry(this,this.l,this.l+n);break;case"wstr":return ud.call(this,n,"dbcs");case"lpstr-ansi":t=sD(this,this.l),n=4+rs(this,this.l);break;case"lpstr-cp":t=oD(this,this.l),n=4+rs(this,this.l);break;case"lpwstr":t=cD(this,this.l),n=4+2*rs(this,this.l);break;case"lpp4":n=4+rs(this,this.l),t=fD(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+rs(this,this.l),t=dD(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(o=Iu(this,this.l+n++))!==0;)a.push(Qp(o));t=a.join("");break;case"_wstr":for(n=0,t="";(o=td(this,this.l+n))!==0;)a.push(Qp(o)),n+=2;n+=2,t=a.join("");break;case"dbcs-cont":for(t="",h=this.l,f=0;f<n;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Iu(this,h),this.l=h+1,c=ud.call(this,n-f,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Qp(td(this,h))),h+=2}t=a.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,f=0;f!=n;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Iu(this,h),this.l=h+1,c=ud.call(this,n-f,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Qp(Iu(this,h))),h+=1}t=a.join("");break;default:switch(n){case 1:return r=Iu(this,this.l),this.l++,r;case 2:return r=(e==="i"?M7:td)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(n>0?cc:I7)(this,this.l),this.l+=4,r):(i=rs(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return n==8?i=Pg(this,this.l):i=Pg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;n=8;case 16:t=rD(this,this.l,n);break}}return this.l+=n,t}var k7=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},F7=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},P7=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function B7(n,e,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=e.length;++i)P7(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(t==="sbcs"||t=="cpstr"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(t==="hex"){for(;i<n;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var a=Math.min(this.l+n,this.length);for(i=0;i<Math.min(e.length,n);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,k7(this,e,this.l);break;case 8:if(r=8,t==="f"){L7(this,e,this.l);break}case 16:break;case-4:r=4,F7(this,e,this.l);break}return this.l+=r,this}function gD(n,e){var t=rD(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function mi(n,e){n.l=e,n.read_shift=ud,n.chk=gD,n.write_shift=B7}function Pa(n,e){n.l+=e}function pe(n){var e=Sc(n);return mi(e,0),e}function Jr(){var n=[],e=an?16384:2048;an&&pe(e).copy;var t=function(d){var g=pe(d);return mi(g,0),g},r=t(e),i=function(){r&&(r.l&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r)),r=null)},a=function(d){return r&&d<r.length-r.l?r:(i(),r=t(Math.max(d+1,e)))},o=function(){return i(),sr(n)},c=function(){return i(),n},f=function(d){i(),r=d,r.l==null&&(r.l=r.length),a(e)};return{next:a,push:f,end:o,_bufs:n,end2:c}}function Me(n,e,t,r){var i=+e,a;if(!isNaN(i)){r||(r=VG[i].p||(t||[]).length||0),a=1+(i>=128?1:0)+1,r>=128&&++a,r>=16384&&++a,r>=2097152&&++a;var o=n.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var c=0;c!=4;++c)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&iy(t)&&n.push(t)}}function fd(n,e,t){var r=ti(n);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function uS(n,e,t){var r=ti(n);return r.s=fd(r.s,e.s,t),r.e=fd(r.e,e.s,t),r}function hd(n,e){if(n.cRel&&n.c<0)for(n=ti(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=ti(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=Pn(n);return!n.cRel&&n.cRel!=null&&(t=z7(t)),!n.rRel&&n.rRel!=null&&(t=U7(t)),t}function Kv(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+gn(n.s.c)+":"+(n.e.cRel?"":"$")+gn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+yn(n.s.r)+":"+(n.e.rRel?"":"$")+yn(n.e.r):hd(n.s,e.biff)+":"+hd(n.e,e.biff)}function sy(n){return parseInt(H7(n),10)-1}function yn(n){return""+(n+1)}function U7(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function H7(n){return n.replace(/\$(\d+)$/,"$1")}function ay(n){for(var e=j7(n),t=0,r=0;r!==e.length;++r)t=26*t+e.charCodeAt(r)-64;return t-1}function gn(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function z7(n){return n.replace(/^([A-Z])/,"$$$1")}function j7(n){return n.replace(/^\$([A-Z])/,"$1")}function $7(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mn(n){for(var e=0,t=0,r=0;r<n.length;++r){var i=n.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:e-1}}function Pn(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Fr(n){var e=n.indexOf(":");return e==-1?{s:Mn(n),e:Mn(n)}:{s:Mn(n.slice(0,e)),e:Mn(n.slice(e+1))}}function or(n,e){return typeof e>"u"||typeof e=="number"?or(n.s,n.e):(typeof n!="string"&&(n=Pn(n)),typeof e!="string"&&(e=Pn(e)),n==e?n:n+":"+e)}function Rd(n){var e=Fr(n);return"$"+gn(e.s.c)+"$"+yn(e.s.r)+":$"+gn(e.e.c)+"$"+yn(e.e.r)}function Nd(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n.replace(/'/g,"''")+"'":n}function Dn(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,a=n.length;for(t=0;r<a&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.s.c=--t,t=0;r<a&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(e.s.r=--t,r===a||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,t=0;r!=a&&!((i=n.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(e.e.c=--t,t=0;r!=a&&!((i=n.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return e.e.r=--t,e}function fS(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=Oo(n.z,t?Pr(e):e)}catch{}try{return n.w=Oo((n.XF||{}).numFmtId||(t?14:0),t?Pr(e):e)}catch{return""+e}}function Ro(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?bi[n.v]||n.v:e==null?fS(n,n.v):fS(n,e))}function _f(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",r={};return r[t]=n,{SheetNames:[t],Sheets:r}}function G7(n){var e={},t=n||{};return t.dense&&(e["!data"]=[]),e}function mD(n,e,t){var r=t||{},i=n?n["!data"]!=null:r.dense,a=n||(i?{"!data":[]}:{});i&&!a["!data"]&&(a["!data"]=[]);var o=0,c=0;if(a&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var f=typeof r.origin=="string"?Mn(r.origin):r.origin;o=f.r,c=f.c}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=Dn(a["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=a["!ref"]?d.e.r+1:0)}else h.s.c=h.e.c=h.s.r=h.e.r=0;for(var g=[],m=!1,v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");var y=o+v;i&&(a["!data"][y]||(a["!data"][y]=[]),g=a["!data"][y]);for(var b=e[v],A=0;A!=b.length;++A)if(!(typeof b[A]>"u")){var w={v:b[A],t:""},C=c+A;if(h.s.r>y&&(h.s.r=y),h.s.c>C&&(h.s.c=C),h.e.r<y&&(h.e.r=y),h.e.c<C&&(h.e.c=C),m=!0,b[A]&&typeof b[A]=="object"&&!Array.isArray(b[A])&&!(b[A]instanceof Date))w=b[A];else if(Array.isArray(w.v)&&(w.f=b[A][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(r.nullError)w.t="e",w.v=0;else if(r.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?isFinite(w.v)?w.t="n":isNaN(w.v)?(w.t="e",w.v=15):(w.t="e",w.v=7):typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=r.dateNF||Cn[14],r.UTC||(w.v=Sm(w.v)),r.cellDates?(w.t="d",w.w=Oo(w.z,Pr(w.v,r.date1904))):(w.t="n",w.v=Pr(w.v,r.date1904),w.w=Oo(w.z,w.v))):w.t="s";if(i)g[C]&&g[C].z&&(w.z=g[C].z),g[C]=w;else{var T=gn(C)+(y+1);a[T]&&a[T].z&&(w.z=a[T].z),a[T]=w}}}return m&&h.s.c<104e5&&(a["!ref"]=or(h)),a}function xf(n,e){return mD(null,n,e)}function V7(n){return n.read_shift(4,"i")}function Js(n,e){return e||(e=pe(4)),e.write_shift(4,n),e}function ei(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function mr(n,e){var t=!1;return e==null&&(t=!0,e=pe(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function W7(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function X7(n,e){return e||(e=pe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function oy(n,e){var t=n.l,r=n.read_shift(1),i=ei(n),a=[],o={t:i,h:i};if((r&1)!==0){for(var c=n.read_shift(4),f=0;f!=c;++f)a.push(W7(n));o.r=a}else o.r=[{ich:0,ifnt:0}];return n.l=t+e,o}function Y7(n,e){var t=!1;return e==null&&(t=!0,e=pe(15+4*n.t.length)),e.write_shift(1,0),mr(n.t,e),t?e.slice(0,e.l):e}var q7=oy;function K7(n,e){var t=!1;return e==null&&(t=!0,e=pe(23+4*n.t.length)),e.write_shift(1,1),mr(n.t,e),e.write_shift(4,1),X7({},e),t?e.slice(0,e.l):e}function Ps(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function Ic(n,e){return e==null&&(e=pe(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function kc(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function Fc(n,e){return e==null&&(e=pe(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var Q7=ei,vD=mr;function Tm(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function Ld(n,e){var t=!1;return e==null&&(t=!0,e=pe(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var Z7=ei,k_=Tm,ly=Ld;function cy(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,r=e[0]&2;n.l+=4;var i=r===0?Pg([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):cc(e,0)>>2;return t?i/100:i}function _D(n,e){e==null&&(e=pe(4));var t=0,r=0,i=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,t=1),r)e.write_shift(-4,((t?i:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function xD(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function J7(n,e){return e||(e=pe(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var Pc=xD,yf=J7;function bf(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function Dc(n,e){return(e||pe(8)).write_shift(8,n,"f")}function e9(n){var e={},t=n.read_shift(1),r=t>>>1,i=n.read_shift(1),a=n.read_shift(2,"i"),o=n.read_shift(1),c=n.read_shift(1),f=n.read_shift(1);switch(n.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var h=c9[i];h&&(e.rgb=AS(h));break;case 2:e.rgb=AS([o,c,f]);break;case 3:e.theme=i;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function Bg(n,e){if(e||(e=pe(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=n.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function t9(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function n9(n,e){e||(e=pe(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var yD=2,Ji=3,eg=11,Ug=19,tg=64,r9=65,i9=71,s9=4108,a9=4126,Lr=80,hS={1:{n:"CodePage",t:yD},2:{n:"Category",t:Lr},3:{n:"PresentationFormat",t:Lr},4:{n:"ByteCount",t:Ji},5:{n:"LineCount",t:Ji},6:{n:"ParagraphCount",t:Ji},7:{n:"SlideCount",t:Ji},8:{n:"NoteCount",t:Ji},9:{n:"HiddenCount",t:Ji},10:{n:"MultimediaClipCount",t:Ji},11:{n:"ScaleCrop",t:eg},12:{n:"HeadingPairs",t:s9},13:{n:"TitlesOfParts",t:a9},14:{n:"Manager",t:Lr},15:{n:"Company",t:Lr},16:{n:"LinksUpToDate",t:eg},17:{n:"CharacterCount",t:Ji},19:{n:"SharedDoc",t:eg},22:{n:"HyperlinksChanged",t:eg},23:{n:"AppVersion",t:Ji,p:"version"},24:{n:"DigSig",t:r9},26:{n:"ContentType",t:Lr},27:{n:"ContentStatus",t:Lr},28:{n:"Language",t:Lr},29:{n:"Version",t:Lr},255:{},2147483648:{n:"Locale",t:Ug},2147483651:{n:"Behavior",t:Ug},1919054434:{}},dS={1:{n:"CodePage",t:yD},2:{n:"Title",t:Lr},3:{n:"Subject",t:Lr},4:{n:"Author",t:Lr},5:{n:"Keywords",t:Lr},6:{n:"Comments",t:Lr},7:{n:"Template",t:Lr},8:{n:"LastAuthor",t:Lr},9:{n:"RevNumber",t:Lr},10:{n:"EditTime",t:tg},11:{n:"LastPrinted",t:tg},12:{n:"CreatedDate",t:tg},13:{n:"ModifiedDate",t:tg},14:{n:"PageCount",t:Ji},15:{n:"WordCount",t:Ji},16:{n:"CharCount",t:Ji},17:{n:"Thumbnail",t:i9},18:{n:"Application",t:Lr},19:{n:"DocSecurity",t:Ji},255:{},2147483648:{n:"Locale",t:Ug},2147483651:{n:"Behavior",t:Ug},1919054434:{}};function o9(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var l9=o9([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),c9=ti(l9),bi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ma={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},u9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],f9={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ng={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function bD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ED(n,e,t){var r=h7(f9),i=[],a;i[i.length]=lr,i[i.length]=Xe("Types",null,{xmlns:Er.CT,"xmlns:xsd":Er.xsd,"xmlns:xsi":Er.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Xe("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){n[h]&&n[h].length>0&&(a=n[h][0],i[i.length]=Xe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:ng[h][e.bookType]||ng[h].xlsx}))},c=function(h){(n[h]||[]).forEach(function(d){i[i.length]=Xe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:ng[h][e.bookType]||ng[h].xlsx})})},f=function(h){(n[h]||[]).forEach(function(d){i[i.length]=Xe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return o("workbooks"),c("sheets"),c("charts"),f("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),c("metadata"),f("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Qt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function AD(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function Gu(n){var e=[lr,Xe("Relationships",null,{xmlns:Er.RELS})];return ar(n["!id"]).forEach(function(t){e[e.length]=Xe("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function sn(n,e,t,r,i,a){if(i||(i={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=t,[Qt.HLINK,Qt.XPATH,Qt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),n["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][i.Id]=i,n[("/"+i.Target).replace("//","/")]=i,e}function h9(n){var e=[lr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function pS(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function d9(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function p9(n){var e=[lr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(pS(n[t][0],n[t][1])),e.push(d9("",n[t][0]));return e.push(pS("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function wD(n,e){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Og.version+"</meta:generator></office:meta></office:document-meta>"}var vc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Qv(n,e,t,r,i){i[n]!=null||e==null||e===""||(i[n]=e,e=Bt(e),r[r.length]=t?Xe(n,e,t):Ir(n,e))}function SD(n,e){var t=e||{},r=[lr,Xe("cp:coreProperties",null,{"xmlns:cp":Er.CORE_PROPS,"xmlns:dc":Er.dc,"xmlns:dcterms":Er.dcterms,"xmlns:dcmitype":Er.dcmitype,"xmlns:xsi":Er.xsi})],i={};if(!n&&!t.Props)return r.join("");n&&(n.CreatedDate!=null&&Qv("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:I_(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),n.ModifiedDate!=null&&Qv("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:I_(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var a=0;a!=vc.length;++a){var o=vc[a],c=t.Props&&t.Props[o[1]]!=null?t.Props[o[1]]:n?n[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Qv(o[0],c,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Vu=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],TD=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function CD(n){var e=[],t=Xe;return n||(n={}),n.Application="SheetJS",e[e.length]=lr,e[e.length]=Xe("Properties",null,{xmlns:Er.EXT_PROPS,"xmlns:vt":Er.vt}),Vu.forEach(function(r){if(n[r[1]]!==void 0){var i;switch(r[2]){case"string":i=Bt(String(n[r[1]]));break;case"bool":i=n[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=t(r[0],i))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(r){return"<vt:lpstr>"+Bt(r)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function DD(n){var e=[lr,Xe("Properties",null,{xmlns:Er.CUST_PROPS,"xmlns:vt":Er.vt})];if(!n)return e.join("");var t=1;return ar(n).forEach(function(i){++t,e[e.length]=Xe("property",R7(n[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:Bt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var gS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function g9(n,e){var t=[];return ar(gS).map(function(r){for(var i=0;i<vc.length;++i)if(vc[i][1]==r)return vc[i];for(i=0;i<Vu.length;++i)if(Vu[i][1]==r)return Vu[i];throw r}).forEach(function(r){if(n[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:n[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(Ir(gS[r[1]]||r[1],i))}}),Xe("DocumentProperties",t.join(""),{xmlns:ns.o})}function m9(n,e){var t=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return n&&ar(n).forEach(function(a){if(Object.prototype.hasOwnProperty.call(n,a)){for(var o=0;o<vc.length;++o)if(a==vc[o][1])return;for(o=0;o<Vu.length;++o)if(a==Vu[o][1])return;for(o=0;o<t.length;++o)if(a==t[o])return;var c=n[a],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),i.push(Xe(nS(a),c,{"dt:dt":f}))}}),e&&ar(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(n&&Object.prototype.hasOwnProperty.call(n,a))){var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Xe(nS(a),o,{"dt:dt":c}))}}),"<"+r+' xmlns="'+ns.o+'">'+i.join("")+"</"+r+">"}function v9(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,r=t%Math.pow(2,32),i=(t-r)/Math.pow(2,32);r*=1e7,i*=1e7;var a=r/Math.pow(2,32)|0;a>0&&(r=r%Math.pow(2,32),i+=a);var o=pe(8);return o.write_shift(4,r),o.write_shift(4,i),o}function mS(n,e){var t=pe(4),r=pe(4);switch(t.write_shift(4,n==80?31:n),n){case 3:r.write_shift(-4,e);break;case 5:r=pe(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=v9(e);break;case 31:case 80:for(r=pe(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return sr([t,r])}var OD=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function _9(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function vS(n,e,t){var r=pe(8),i=[],a=[],o=8,c=0,f=pe(8),h=pe(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),a.push(f),i.push(h),o+=8+f.length,!e){h=pe(8),h.write_shift(4,0),i.unshift(h);var d=[pe(4)];for(d[0].write_shift(4,n.length),c=0;c<n.length;++c){var g=n[c][0];for(f=pe(8+2*(g.length+1)+(g.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,g.length+1),f.write_shift(0,g,"dbcs");f.l!=f.length;)f.write_shift(1,0);d.push(f)}f=sr(d),a.unshift(f),o+=8+f.length}for(c=0;c<n.length;++c)if(!(e&&!e[n[c][0]])&&!(OD.indexOf(n[c][0])>-1||TD.indexOf(n[c][0])>-1)&&n[c][1]!=null){var m=n[c][1],v=0;if(e){v=+e[n[c][0]];var y=t[v];if(y.p=="version"&&typeof m=="string"){var b=m.split(".");m=(+b[0]<<16)+(+b[1]||0)}f=mS(y.t,m)}else{var A=_9(m);A==-1&&(A=31,m=String(m)),f=mS(A,m)}a.push(f),h=pe(8),h.write_shift(4,e?v:2+c),i.push(h),o+=8+f.length}var w=8*(a.length+1);for(c=0;c<a.length;++c)i[c].write_shift(4,w),w+=a[c].length;return r.write_shift(4,o),r.write_shift(4,a.length),sr([r].concat(i).concat(a))}function _S(n,e,t,r,i,a){var o=pe(i?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,An.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var f=vS(n,t,r);if(c.push(f),i){var h=vS(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+f.length),c.push(h)}return sr(c)}function x9(n,e){e||(e=pe(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function y9(n,e){return n.read_shift(e)===1}function Kr(n,e){return e||(e=pe(2)),e.write_shift(2,+!!n),e}function hg(n){return n.read_shift(2,"u")}function Os(n,e){return e||(e=pe(2)),e.write_shift(2,n),e}function RD(n,e,t){return t||(t=pe(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function ND(n,e,t){var r=n.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",a=yo;if(t&&t.biff>=8&&(yo=1200),!t||t.biff==8){var o=n.read_shift(1);o&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var c=r?n.read_shift(r,i):"";return yo=a,c}function b9(n){var e=n.t||"",t=pe(3);t.write_shift(2,e.length),t.write_shift(1,1);var r=pe(2*e.length);r.write_shift(2*e.length,e,"utf16le");var i=[t,r];return sr(i)}function E9(n,e,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var i=n.read_shift(1);return i===0?r=n.read_shift(e,"sbcs-cont"):r=n.read_shift(e,"dbcs-cont"),r}function A9(n,e,t){var r=n.read_shift(t&&t.biff==2?1:2);return r===0?(n.l++,""):E9(n,r,t)}function w9(n,e,t){if(t.biff>5)return A9(n,e,t);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function LD(n,e,t){return t||(t=pe(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function xS(n,e){e||(e=pe(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function S9(n){var e=pe(512),t=0,r=n.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),a=i>-1?31:23;switch(r.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)e.write_shift(4,o[t]);if(a==28)r=r.slice(1),xS(r,e);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));var c=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(c.length+1)),t=0;t<c.length;++t)e.write_shift(2,c.charCodeAt(t));e.write_shift(2,0),a&8&&xS(i>-1?r.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)e.write_shift(1,parseInt(o[t],16));for(var f=0;r.slice(f*3,f*3+3)=="../"||r.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,r.length-3*f+1),t=0;t<r.length-3*f;++t)e.write_shift(1,r.charCodeAt(t+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function Oc(n,e,t,r){return r||(r=pe(6)),r.write_shift(2,n),r.write_shift(2,e),r.write_shift(2,t||0),r}function T9(n,e,t){var r=t.biff>8?4:2,i=n.read_shift(r),a=n.read_shift(r,"i"),o=n.read_shift(r,"i");return[i,a,o]}function C9(n){var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(2),i=n.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:t}}}function MD(n,e){return e||(e=pe(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function uy(n,e,t){var r=1536,i=16;switch(t.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=pe(i);return a.write_shift(2,r),a.write_shift(2,e),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function D9(n,e){var t=!e||e.biff==8,r=pe(t?112:54);for(r.write_shift(e.biff==8?2:1,7),t&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(t?0:536870912));r.l<r.length;)r.write_shift(1,t?0:32);return r}function O9(n,e){var t=!e||e.biff>=8?2:1,r=pe(8+t*n.name.length);r.write_shift(4,n.pos),r.write_shift(1,n.hs||0),r.write_shift(1,n.dt),r.write_shift(1,n.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function R9(n,e){var t=pe(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var r=[],i=0;i<n.length;++i)r[i]=b9(n[i]);var a=sr([t].concat(r));return a.parts=[t.length].concat(r.map(function(o){return o.length})),a}function N9(){var n=pe(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function L9(n){var e=pe(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function M9(n,e){var t=n.name||"Arial",r=e&&e.biff==5,i=r?15+t.length:16+2*t.length,a=pe(i);return a.write_shift(2,n.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,t.length),r||a.write_shift(1,1),a.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le"),a}function I9(n,e,t,r){var i=pe(10);return Oc(n,e,r,i),i.write_shift(4,t),i}function k9(n,e,t,r,i){var a=!i||i.biff==8,o=pe(8+ +a+(1+a)*t.length);return Oc(n,e,r,o),o.write_shift(2,t.length),a&&o.write_shift(1,1),o.write_shift((1+a)*t.length,t,a?"utf16le":"sbcs"),o}function F9(n,e,t,r){var i=t&&t.biff==5;r||(r=pe(i?3+e.length:5+2*e.length)),r.write_shift(2,n),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var a=r.length>r.l?r.slice(0,r.l):r;return a.l==null&&(a.l=a.length),a}function P9(n){var e=pe(1+n.length);return e.write_shift(1,n.length),e.write_shift(n.length,n,"sbcs"),e}function B9(n){var e=pe(3+n.length);return e.l+=2,e.write_shift(1,n.length),e.write_shift(n.length,n,"sbcs"),e}function U9(n,e){var t=e.biff==8||!e.biff?4:2,r=pe(2*t+6);return r.write_shift(t,n.s.r),r.write_shift(t,n.e.r+1),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c+1),r.write_shift(2,0),r}function yS(n,e,t,r){var i=t&&t.biff==5;r||(r=pe(i?16:20)),r.write_shift(2,0),n.style?(r.write_shift(2,n.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,n.numFmtId||0),r.write_shift(2,e<<4));var a=0;return n.numFmtId>0&&i&&(a|=1024),r.write_shift(4,a),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function H9(n){var e=pe(4);return e.l+=2,e.write_shift(1,n.numFmtId),e.l++,e}function ID(n){var e=pe(12);return e.l++,e.write_shift(1,n.numFmtId),e.l+=10,e}var z9=ID;function j9(n){var e=pe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Zv(n,e,t,r,i,a){var o=pe(8);return Oc(n,e,r,o),RD(t,a,o),o}function $9(n,e,t,r){var i=pe(14);return Oc(n,e,r,i),Dc(t,i),i}function G9(n,e,t){if(t.biff<8||!(t.biff>8)&&e==n[n.l]+(n[n.l+1]==3?1:0)+1)return bS(n,e,t);for(var r=[],i=n.l+e,a=n.read_shift(t.biff>8?4:2);a--!==0;)r.push(T9(n,t.biff>8?12:6,t));if(n.l!=i)throw new Error("Bad ExternSheet: "+n.l+" != "+i);return r}function bS(n,e,t){n[n.l+1]==3&&n[n.l]++;var r=ND(n,e,t);return r.charCodeAt(0)==3?r.slice(1):r}function Jv(n,e,t,r){var i=pe(6+(r||n.length));return i.write_shift(2,e),i.write_shift(2,t),i.write_shift(2,r||n.length),i.write_shift(n.length,n,"sbcs"),i}function V9(n){var e=pe(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)MD(n[t],e);return e}function W9(n){var e=pe(24),t=Mn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return sr([e,S9(n[1])])}function X9(n){var e=n[1].Tooltip,t=pe(10+2*(e.length+1));t.write_shift(2,2048);var r=Mn(n[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function Y9(n){return n||(n=pe(4)),n.write_shift(2,1),n.write_shift(2,1),n}function q9(n,e,t){if(!t.cellStyles)return Pa(n,e);var r=t&&t.biff>=12?4:2,i=n.read_shift(r),a=n.read_shift(r),o=n.read_shift(r),c=n.read_shift(r),f=n.read_shift(2);r==2&&(n.l+=2);var h={s:i,e:a,w:o,ixfe:c,flags:f};return(t.biff>=5||!t.biff)&&(h.level=f>>8&7),h}function K9(n,e){var t=pe(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var r=0;return n.hidden&&(r|=1),t.write_shift(1,r),r=n.level||0,t.write_shift(1,r),t.write_shift(2,0),t}function Q9(n){for(var e=pe(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function e0(n,e,t,r,i){return n||(n=pe(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(1,r||0),n.write_shift(1,i||0),n.write_shift(1,0),n}function Z9(n,e,t,r,i){var a=pe(15);return e0(a,n,e,r||0,i||0),a.write_shift(8,t,"f"),a}function J9(n,e,t,r,i){var a=pe(9);return e0(a,n,e,r||0,i||0),a.write_shift(2,t),a}var eH=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Zx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(c,f){var h=[],d=Sc(1);switch(f.type){case"base64":d=ts(Al(c));break;case"binary":d=ts(c);break;case"buffer":case"array":d=c;break}mi(d,0);var g=d.read_shift(1),m=!!(g&136),v=!1,y=!1;switch(g){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var b=0,A=521;g==2&&(b=d.read_shift(2)),d.l+=3,g!=2&&(b=d.read_shift(4)),b>1048576&&(b=1e6),g!=2&&(A=d.read_shift(2));var w=d.read_shift(2);f.codepage,g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&n[d[d.l]],d.l+=1,d.l+=2),y&&(d.l+=36);for(var C=[],T={},R=Math.min(d.length,g==2?521:A-10-(v?264:0)),N=y?32:11;d.l<R&&d[d.l]!=13;)switch(T={},T.name=Tc(d.slice(d.l,d.l+N)).replace(/[\u0000\r\n][\S\s]*$/g,""),d.l+=N,T.type=String.fromCharCode(d.read_shift(1)),g!=2&&!y&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),g==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&C.push(T),g!=2&&(d.l+=y?13:14),T.type){case"B":(!v||T.len!=8)&&f.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=A-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=A;var I=0,D=0;for(h[0]=[],D=0;D!=C.length;++D)h[0][D]=C[D].name;for(;b-- >0;){if(d[d.l]===42){d.l+=w;continue}for(++d.l,h[++I]=[],D=0,D=0;D!=C.length;++D){var B=d.slice(d.l,d.l+C[D].len);d.l+=C[D].len,mi(B,0);var U=Tc(B);switch(C[D].type){case"C":U.trim().length&&(h[I][D]=U.replace(/([^\s])\s+$/,"$1"));break;case"D":U.length===8?(h[I][D]=new Date(Date.UTC(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8),0,0,0,0)),f&&f.UTC||(h[I][D]=of(h[I][D]))):h[I][D]=U;break;case"F":h[I][D]=parseFloat(U.trim());break;case"+":case"I":h[I][D]=y?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":h[I][D]=!0;break;case"N":case"F":h[I][D]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[I][D]="##MEMO##"+(y?parseInt(U.trim(),10):B.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(h[I][D]=+U||0);break;case"@":h[I][D]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":{var Y=B.read_shift(4),W=B.read_shift(4);if(Y==0&&W==0)break;h[I][D]=new Date((Y-2440588)*864e5+W),f&&f.UTC||(h[I][D]=of(h[I][D]))}break;case"Y":h[I][D]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[I][D]=-B.read_shift(-8,"f");break;case"B":if(v&&C[D].len==8){h[I][D]=B.read_shift(8,"f");break}case"G":case"P":B.l+=C[D].len;break;case"0":if(C[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[D].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=C,h}function r(c,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var d=xf(t(c,h),h);return d["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,d}function i(c,f){try{var h=_f(r(c,f),f);return h.bookType="dbf",h}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,f){if(!c["!ref"])throw new Error("Cannot export empty sheet to DBF");var h=f||{},d=yo;if(+h.codepage>=0&&Cd(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var g=Jr(),m=U_(c,{header:1,raw:!0,cellDates:!0}),v=m[0],y=m.slice(1),b=c["!cols"]||[],A=0,w=0,C=0,T=1;for(A=0;A<v.length;++A){if(((b[A]||{}).DBF||{}).name){v[A]=b[A].DBF.name,++C;continue}if(v[A]!=null){if(++C,typeof v[A]=="number"&&(v[A]=v[A].toString(10)),typeof v[A]!="string")throw new Error("DBF Invalid column name "+v[A]+" |"+typeof v[A]+"|");if(v.indexOf(v[A])!==A){for(w=0;w<1024;++w)if(v.indexOf(v[A]+"_"+w)==-1){v[A]+="_"+w;break}}}}var R=Dn(c["!ref"]),N=[],I=[],D=[];for(A=0;A<=R.e.c-R.s.c;++A){var B="",U="",Y=0,W=[];for(w=0;w<y.length;++w)y[w][A]!=null&&W.push(y[w][A]);if(W.length==0||v[A]==null){N[A]="?";continue}for(w=0;w<W.length;++w){switch(typeof W[w]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=W[w]instanceof Date?"D":"C";break;default:U="C"}Y=Math.max(Y,String(W[w]).length),B=B&&B!=U?"C":U}Y>250&&(Y=250),U=((b[A]||{}).DBF||{}).type,U=="C"&&b[A].DBF.len>Y&&(Y=b[A].DBF.len),B=="B"&&U=="N"&&(B="N",D[A]=b[A].DBF.dec,Y=b[A].DBF.len),I[A]=B=="C"||U=="N"?Y:a[B]||0,T+=I[A],N[A]=B}var re=g.next(32);for(re.write_shift(4,318902576),re.write_shift(4,y.length),re.write_shift(2,296+32*C),re.write_shift(2,T),A=0;A<4;++A)re.write_shift(4,0);var Te=+e[yo]||3;for(re.write_shift(4,0|Te<<8),n[Te]!=+h.codepage&&(h.codepage&&console.error("DBF Unsupported codepage "+yo+", using 1252"),yo=1252),A=0,w=0;A<v.length;++A)if(v[A]!=null){var Fe=g.next(32),we=(v[A].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Fe.write_shift(1,we,"sbcs"),Fe.write_shift(1,N[A]=="?"?"C":N[A],"sbcs"),Fe.write_shift(4,w),Fe.write_shift(1,I[A]||a[N[A]]||0),Fe.write_shift(1,D[A]||0),Fe.write_shift(1,2),Fe.write_shift(4,0),Fe.write_shift(1,0),Fe.write_shift(4,0),Fe.write_shift(4,0),w+=I[A]||a[N[A]]||0}var q=g.next(264);for(q.write_shift(4,13),A=0;A<65;++A)q.write_shift(4,0);for(A=0;A<y.length;++A){var ee=g.next(T);for(ee.write_shift(1,0),w=0;w<v.length;++w)if(v[w]!=null)switch(N[w]){case"L":ee.write_shift(1,y[A][w]==null?63:y[A][w]?84:70);break;case"B":ee.write_shift(8,y[A][w]||0,"f");break;case"N":var Pe="0";for(typeof y[A][w]=="number"&&(Pe=y[A][w].toFixed(D[w]||0)),Pe.length>I[w]&&(Pe=Pe.slice(0,I[w])),C=0;C<I[w]-Pe.length;++C)ee.write_shift(1,32);ee.write_shift(1,Pe,"sbcs");break;case"D":y[A][w]?(ee.write_shift(4,("0000"+y[A][w].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(y[A][w].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+y[A][w].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var qe=ee.l,P=String(y[A][w]!=null?y[A][w]:"").slice(0,I[w]);for(ee.write_shift(1,P,"cpstr"),qe+=I[w]-ee.l,C=0;C<qe;++C)ee.write_shift(1,32);break}}return yo=d,g.next(1).write_shift(1,26),g.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),tH=function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+ar(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{e=new RegExp("\x1BN("+ar(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var t=function(v,y){var b=n[y];return typeof b=="number"?Gw(b):b},r=function(v,y,b){var A=y.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return A==59?v:Gw(A)};n["|"]=254;var i=function(v){return v.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function a(v,y){switch(y.type){case"base64":return o(Al(v),y);case"binary":return o(v,y);case"buffer":return o(an&&Buffer.isBuffer(v)?v.toString("binary"):Tc(v),y);case"array":return o(Jx(v),y)}throw new Error("Unrecognized type "+y.type)}function o(v,y){var b=v.split(/[\n\r]+/),A=-1,w=-1,C=0,T=0,R=[],N=[],I=null,D={},B=[],U=[],Y=[],W=0,re,Te={Workbook:{WBProps:{},Names:[]}};for(+y.codepage>=0&&Cd(+y.codepage);C!==b.length;++C){W=0;var Fe=b[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,t),we=Fe.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),q=we[0],ee;if(Fe.length>0)switch(q){case"ID":break;case"E":break;case"B":break;case"O":for(T=1;T<we.length;++T)switch(we[T].charAt(0)){case"V":{var Pe=parseInt(we[T].slice(1),10);Pe>=1&&Pe<=4&&(Te.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(we[1].charAt(0)){case"P":N.push(Fe.slice(3).replace(/;;/g,";"));break}break;case"NN":{var qe={Sheet:0};for(T=1;T<we.length;++T)switch(we[T].charAt(0)){case"N":qe.Name=we[T].slice(1);break;case"E":qe.Ref=(y&&y.sheet||"Sheet1")+"!"+TS(we[T].slice(1));break}Te.Workbook.Names.push(qe)}break;case"C":var P=!1,ye=!1,ve=!1,ge=!1,Ce=-1,He=-1,Ie="",Ge="z",k="";for(T=1;T<we.length;++T)switch(we[T].charAt(0)){case"A":k=we[T].slice(1);break;case"X":w=parseInt(we[T].slice(1),10)-1,ye=!0;break;case"Y":for(A=parseInt(we[T].slice(1),10)-1,ye||(w=0),re=R.length;re<=A;++re)R[re]=[];break;case"K":ee=we[T].slice(1),ee.charAt(0)==='"'?(ee=ee.slice(1,ee.length-1),Ge="s"):ee==="TRUE"||ee==="FALSE"?(ee=ee==="TRUE",Ge="b"):ee.charAt(0)=="#"&&Ma[ee]!=null?(Ge="e",ee=Ma[ee]):isNaN(wo(ee))||(ee=wo(ee),Ge="n",I!==null&&Cc(I)&&y.cellDates&&(ee=ju(Te.Workbook.WBProps.date1904?ee+1462:ee),Ge=typeof ee=="number"?"n":"d")),P=!0;break;case"E":ge=!0,Ie=TS(we[T].slice(1),{r:A,c:w});break;case"S":ve=!0;break;case"G":break;case"R":Ce=parseInt(we[T].slice(1),10)-1;break;case"C":He=parseInt(we[T].slice(1),10)-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Fe)}if(P&&(R[A][w]?(R[A][w].t=Ge,R[A][w].v=ee):R[A][w]={t:Ge,v:ee},I&&(R[A][w].z=I),y.cellText!==!1&&I&&(R[A][w].w=Oo(R[A][w].z,R[A][w].v,{date1904:Te.Workbook.WBProps.date1904})),I=null),ve){if(ge)throw new Error("SYLK shared formula cannot have own formula");var se=Ce>-1&&R[Ce][He];if(!se||!se[1])throw new Error("SYLK shared formula cannot find base");Ie=nz(se[1],{r:A-Ce,c:w-He})}Ie&&(R[A][w]?R[A][w].f=Ie:R[A][w]={t:"n",f:Ie}),k&&(R[A][w]||(R[A][w]={t:"z"}),R[A][w].c=[{a:"SheetJSYLK",t:k}]);break;case"F":var Z=0;for(T=1;T<we.length;++T)switch(we[T].charAt(0)){case"X":w=parseInt(we[T].slice(1),10)-1,++Z;break;case"Y":for(A=parseInt(we[T].slice(1),10)-1,re=R.length;re<=A;++re)R[re]=[];break;case"M":W=parseInt(we[T].slice(1),10)/20;break;case"F":break;case"G":break;case"P":I=N[parseInt(we[T].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(Y=we[T].slice(1).split(" "),re=parseInt(Y[0],10);re<=parseInt(Y[1],10);++re)W=parseInt(Y[2],10),U[re-1]=W===0?{hidden:!0}:{wch:W};break;case"C":w=parseInt(we[T].slice(1),10)-1,U[w]||(U[w]={});break;case"R":A=parseInt(we[T].slice(1),10)-1,B[A]||(B[A]={}),W>0?(B[A].hpt=W,B[A].hpx=BD(W)):W===0&&(B[A].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Fe)}Z<1&&(I=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+Fe)}}return B.length>0&&(D["!rows"]=B),U.length>0&&(D["!cols"]=U),U.forEach(function(J){fy(J)}),y&&y.sheetRows&&(R=R.slice(0,y.sheetRows)),[R,D,Te]}function c(v,y){var b=a(v,y),A=b[0],w=b[1],C=b[2],T=ti(y);T.date1904=(((C||{}).Workbook||{}).WBProps||{}).date1904;var R=xf(A,T);ar(w).forEach(function(I){R[I]=w[I]});var N=_f(R,y);return ar(C).forEach(function(I){N[I]=C[I]}),N.bookType="sylk",N}function f(v,y,b,A,w,C){var T="C;Y"+(b+1)+";X"+(A+1)+";K";switch(v.t){case"n":T+=isFinite(v.v)?v.v||0:bi[isNaN(v.v)?36:7],v.f&&!v.F&&(T+=";E"+Dm(v.f,{r:b,c:A}));break;case"b":T+=v.v?"TRUE":"FALSE";break;case"e":T+=v.w||bi[v.v]||v.v;break;case"d":T+=Pr(Ui(v.v,C),C);break;case"s":T+='"'+(v.v==null?"":String(v.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function h(v,y,b){var A="C;Y"+(y+1)+";X"+(b+1)+";A";return A+=i(v.map(function(w){return w.t}).join("")),A}function d(v,y){y.forEach(function(b,A){var w="F;W"+(A+1)+" "+(A+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Hg(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=zg(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&v.push(w)})}function g(v,y){y.forEach(function(b,A){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*jg(b.hpx)+";"),w.length>2&&v.push(w+"R"+(A+1))})}function m(v,y,b){y||(y={}),y._formats=["General"];var A=["ID;PSheetJS;N;E"],w=[],C=Dn(v["!ref"]||"A1"),T,R=v["!data"]!=null,N=`\r
`,I=(((b||{}).Workbook||{}).WBProps||{}).date1904,D="General";A.push("P;PGeneral");var B=C.s.r,U=C.s.c,Y=[];if(v["!ref"]){for(B=C.s.r;B<=C.e.r;++B)if(!(R&&!v["!data"][B])){for(Y=[],U=C.s.c;U<=C.e.c;++U)T=R?v["!data"][B][U]:v[gn(U)+yn(B)],!(!T||!T.c)&&Y.push(h(T.c,B,U));Y.length&&w.push(Y.join(N))}}if(v["!ref"]){for(B=C.s.r;B<=C.e.r;++B)if(!(R&&!v["!data"][B])){for(Y=[],U=C.s.c;U<=C.e.c;++U)if(T=R?v["!data"][B][U]:v[gn(U)+yn(B)],!(!T||T.v==null&&(!T.f||T.F))){if((T.z||(T.t=="d"?Cn[14]:"General"))!=D){var W=y._formats.indexOf(T.z);W==-1&&(y._formats.push(T.z),W=y._formats.length-1,A.push("P;P"+T.z.replace(/;/g,";;"))),Y.push("F;P"+W+";Y"+(B+1)+";X"+(U+1))}Y.push(f(T,v,B,U,y,I))}w.push(Y.join(N))}}return A.push("F;P0;DG0G8;M255"),v["!cols"]&&d(A,v["!cols"]),v["!rows"]&&g(A,v["!rows"]),v["!ref"]&&A.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" ")),A.push("O;L;D;B"+(I?";V4":"")+";K47;G100 0.001"),delete y._formats,A.join(N)+N+w.join(N)+N+"E"+N}return{to_workbook:c,from_sheet:m}}(),nH=function(){function n(c,f){switch(f.type){case"base64":return e(Al(c),f);case"binary":return e(c,f);case"buffer":return e(an&&Buffer.isBuffer(c)?c.toString("binary"):Tc(c),f);case"array":return e(Jx(c),f)}throw new Error("Unrecognized type "+f.type)}function e(c,f){for(var h=c.split(`
`),d=-1,g=-1,m=0,v=[];m!==h.length;++m){if(h[m].trim()==="BOT"){v[++d]=[],g=0;continue}if(!(d<0)){var y=h[m].trim().split(","),b=y[0],A=y[1];++m;for(var w=h[m]||"";(w.match(/["]/g)||[]).length&1&&m<h.length-1;)w+=`
`+h[++m];switch(w=w.trim(),+b){case-1:if(w==="BOT"){v[++d]=[],g=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[d][g]=!0:w==="FALSE"?v[d][g]=!1:isNaN(wo(A))?isNaN(Fg(A).getDate())?v[d][g]=A:(v[d][g]=Ui(A),f&&f.UTC||(v[d][g]=of(v[d][g]))):v[d][g]=wo(A),++g;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[d][g++]=w!==""?w:null;break}if(w==="EOD")break}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function t(c,f){return xf(n(c,f),f)}function r(c,f){var h=_f(t(c,f),f);return h.bookType="dif",h}function i(c,f){return"0,"+String(c)+`\r
`+f}function a(c){return`1,0\r
"`+c.replace(/"/g,'""')+'"'}function o(c){if(!c["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var f=Dn(c["!ref"]),h=c["!data"]!=null,d=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(f.e.r-f.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(f.e.c-f.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],g=f.s.r;g<=f.e.r;++g){for(var m=h?c["!data"][g]:[],v=`-1,0\r
BOT\r
`,y=f.s.c;y<=f.e.c;++y){var b=h?m&&m[y]:c[Pn({r:g,c:y})];if(b==null){v+=`1,0\r
""\r
`;continue}switch(b.t){case"n":b.w!=null?v+="0,"+b.w+`\r
V`:b.v!=null?v+=i(b.v,"V"):b.f!=null&&!b.F?v+=a("="+b.f):v+=`1,0\r
""`;break;case"b":v+=b.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":v+=a(isNaN(+b.v)?b.v:'="'+b.v+'"');break;case"d":b.w||(b.w=Oo(b.z||Cn[14],Pr(Ui(b.v)))),v+=i(b.w,"V");break;default:v+=`1,0\r
""`}v+=`\r
`}d.push(v)}return d.join("")+`-1,0\r
EOD`}return{to_workbook:r,to_sheet:t,from_sheet:o}}(),kD=function(){function n(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(g,m){for(var v=g.split(`
`),y=-1,b=-1,A=0,w=[];A!==v.length;++A){var C=v[A].trim().split(":");if(C[0]==="cell"){var T=Mn(C[1]);if(w.length<=T.r)for(y=w.length;y<=T.r;++y)w[y]||(w[y]=[]);switch(y=T.r,b=T.c,C[2]){case"t":w[y][b]=n(C[3]);break;case"v":w[y][b]=+C[3];break;case"vtf":var R=C[C.length-1];case"vtc":switch(C[3]){case"nl":w[y][b]=!!+C[4];break;default:w[y][b]=C[C.length-1].charAt(0)=="#"?{t:"e",v:Ma[C[C.length-1]]}:+C[4];break}C[2]=="vtf"&&(w[y][b]=[w[y][b],R])}}}return m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),w}function r(g,m){return xf(t(g,m),m)}function i(g,m){return _f(r(g,m),m)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var m=[],v=[],y,b="",A=Fr(g["!ref"]),w=g["!data"]!=null,C=A.s.r;C<=A.e.r;++C)for(var T=A.s.c;T<=A.e.c;++T)if(b=Pn({r:C,c:T}),y=w?(g["!data"][C]||[])[T]:g[b],!(!y||y.v==null||y.t==="z")){switch(v=["cell",b,"t"],y.t){case"s":v.push(e(y.v));break;case"b":v[2]="vt"+(y.f?"f":"c"),v[3]="nl",v[4]=y.v?"1":"0",v[5]=e(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var R=Pr(Ui(y.v));v[2]="vtc",v[3]="nd",v[4]=""+R,v[5]=y.w||Oo(y.z||Cn[14],R);break;case"n":isFinite(y.v)?y.f?(v[2]="vtf",v[3]="n",v[4]=y.v,v[5]=e(y.f)):(v[2]="v",v[3]=y.v):(v[2]="vt"+(y.f?"f":"c"),v[3]="e"+bi[isNaN(y.v)?36:7],v[4]="0",v[5]=y.f||v[3].slice(1),v[6]="e",v[7]=v[3].slice(1));break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(g){return[a,o,c,o,h(g),f].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:d}}(),rH=function(){function n(d,g,m,v,y){y.raw?g[m][v]=d:d===""||(d==="TRUE"?g[m][v]=!0:d==="FALSE"?g[m][v]=!1:isNaN(wo(d))?isNaN(Fg(d).getDate())?d.charCodeAt(0)==35&&Ma[d]!=null?g[m][v]={t:"e",v:Ma[d],w:d}:g[m][v]=d:g[m][v]=Ui(d):g[m][v]=wo(d))}function e(d,g){var m=g||{},v=[];if(!d||d.length===0)return v;for(var y=d.split(/[\r\n]/),b=y.length-1;b>=0&&y[b].length===0;)--b;for(var A=10,w=0,C=0;C<=b;++C)w=y[C].indexOf(" "),w==-1?w=y[C].length:w++,A=Math.max(A,w);for(C=0;C<=b;++C){v[C]=[];var T=0;for(n(y[C].slice(0,A).trim(),v,C,T,m),T=1;T<=(y[C].length-A)/10+1;++T)n(y[C].slice(A+(T-1)*10,A+T*10).trim(),v,C,T,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(d){for(var g={},m=!1,v=0,y=0;v<d.length;++v)(y=d.charCodeAt(v))==34?m=!m:!m&&y in t&&(g[y]=(g[y]||0)+1);y=[];for(v in g)Object.prototype.hasOwnProperty.call(g,v)&&y.push([g[v],v]);if(!y.length){g=r;for(v in g)Object.prototype.hasOwnProperty.call(g,v)&&y.push([g[v],v])}return y.sort(function(b,A){return b[0]-A[0]||r[b[1]]-r[A[1]]}),t[y.pop()[1]]||44}function a(d,g){var m=g||{},v="",y={};m.dense&&(y["!data"]=[]);var b={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(v=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(v=d.charAt(4),d=d.slice(6)):v=i(d.slice(0,1024)):m&&m.FS?v=m.FS:v=i(d.slice(0,1024));var A=0,w=0,C=0,T=0,R=0,N=v.charCodeAt(0),I=!1,D=0,B=d.charCodeAt(0),U=m.dateNF!=null?o7(m.dateNF):null;function Y(){var W=d.slice(T,R);W.slice(-1)=="\r"&&(W=W.slice(0,-1));var re={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),m.cellText!==!1&&(re.w=W),W.length===0)re.t="z";else if(m.raw)re.t="s",re.v=W;else if(W.trim().length===0)re.t="s",re.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(re.t="s",re.v=W.slice(2,-1).replace(/""/g,'"')):rz(W)?(re.t="s",re.f=W.slice(1),re.v=W):(re.t="s",re.v=W);else if(W=="TRUE")re.t="b",re.v=!0;else if(W=="FALSE")re.t="b",re.v=!1;else if(!isNaN(C=wo(W)))re.t="n",re.v=C;else if(!isNaN((C=Fg(W)).getDate())||U&&W.match(U)){if(re.z=m.dateNF||Cn[14],U&&W.match(U)){var Te=l7(W,m.dateNF,W.match(U)||[]);C=Ui(Te),m&&m.UTC===!1&&(C=of(C))}else m&&m.UTC===!1?C=of(C):m.cellText!==!1&&m.dateNF&&(re.w=Oo(re.z,C));m.cellDates?(re.t="d",re.v=C):(re.t="n",re.v=Pr(C)),m.cellNF||delete re.z}else W.charCodeAt(0)==35&&Ma[W]!=null?(re.t="e",re.w=W,re.v=Ma[W]):(re.t="s",re.v=W);if(re.t=="z"||(m.dense?(y["!data"][A]||(y["!data"][A]=[]),y["!data"][A][w]=re):y[Pn({c:w,r:A})]=re),T=R+1,B=d.charCodeAt(T),b.e.c<w&&(b.e.c=w),b.e.r<A&&(b.e.r=A),D==N)++w;else if(w=0,++A,m.sheetRows&&m.sheetRows<=A)return!0}e:for(;R<d.length;++R)switch(D=d.charCodeAt(R)){case 34:B===34&&(I=!I);break;case 13:if(I)break;d.charCodeAt(R+1)==10&&++R;case N:case 10:if(!I&&Y())break e;break}return R-T>0&&Y(),y["!ref"]=or(b),y}function o(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,g):xf(e(d,g),g)}function c(d,g){var m="",v=g.type=="string"?[0,0,0,0]:RV(d,g);switch(g.type){case"base64":m=Al(d);break;case"binary":m=d;break;case"buffer":g.codepage==65001?m=d.toString("utf8"):(g.codepage,m=an&&Buffer.isBuffer(d)?d.toString("binary"):Tc(d));break;case"array":m=Jx(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+g.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=$u(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=$u(m):g.type=="binary",m.slice(0,19)=="socialcalc:version:"?kD.to_sheet(g.type=="string"?m:$u(m),g):o(m,g)}function f(d,g){return _f(c(d,g),g)}function h(d){var g=[];if(!d["!ref"])return"";for(var m=Dn(d["!ref"]),v,y=d["!data"]!=null,b=m.s.r;b<=m.e.r;++b){for(var A=[],w=m.s.c;w<=m.e.c;++w){var C=Pn({r:b,c:w});if(v=y?(d["!data"][b]||[])[w]:d[C],!v||v.v==null){A.push("          ");continue}for(var T=(v.w||(Ro(v),v.w)||"").slice(0,10);T.length<10;)T+=" ";A.push(T+(w===0?" ":""))}g.push(A.join(""))}return g.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:h}}(),ES=function(){function n(k,se,Z){if(k){mi(k,k.l||0);for(var J=Z.Enum||ge;k.l<k.length;){var xe=k.read_shift(2),be=J[xe]||J[65535],Se=k.read_shift(2),Ye=k.l+Se,De=be.f&&be.f(k,Se,Z);if(k.l=Ye,se(De,be,xe))return}}}function e(k,se){switch(se.type){case"base64":return r(ts(Al(k)),se);case"binary":return r(ts(k),se);case"buffer":case"array":return r(k,se)}throw"Unsupported type "+se.type}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function r(k,se){if(!k)return k;var Z=se||{},J={},xe="Sheet1",be="",Se=0,Ye={},De=[],nt=[],rt=[];Z.dense&&(rt=J["!data"]=[]);var ht={s:{r:0,c:0},e:{r:0,c:0}},Rt=Z.sheetRows||0,kt={};if(k[4]==81&&k[5]==80&&k[6]==87)return Ge(k,se);if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)Z.Enum=ge,n(k,function(je,Tn,zt){switch(zt){case 0:Z.vers=je,je>=4096&&(Z.qpro=!0);break;case 255:Z.vers=je,Z.works=!0;break;case 6:ht=je;break;case 204:je&&(be=je);break;case 222:be=je;break;case 15:case 51:(!Z.qpro&&!Z.works||zt==51)&&je[1].v.charCodeAt(0)<48&&(je[1].v=je[1].v.slice(1)),(Z.works||Z.works2)&&(je[1].v=je[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=Z.dateNF||t[(je[2]&15)-1]||Cn[14],Z.cellDates&&(je[1].v=ju(je[1].v),je[1].t=typeof je[1].v=="number"?"n":"d")),Z.qpro&&je[3]>Se&&(J["!ref"]=or(ht),Ye[xe]=J,De.push(xe),J={},Z.dense&&(rt=J["!data"]=[]),ht={s:{r:0,c:0},e:{r:0,c:0}},Se=je[3],xe=be||"Sheet"+(Se+1),be="");var It=Z.dense?(rt[je[0].r]||[])[je[0].c]:J[Pn(je[0])];if(It){It.t=je[1].t,It.v=je[1].v,je[1].z!=null&&(It.z=je[1].z),je[1].f!=null&&(It.f=je[1].f),kt=It;break}Z.dense?(rt[je[0].r]||(rt[je[0].r]=[]),rt[je[0].r][je[0].c]=je[1]):J[Pn(je[0])]=je[1],kt=je[1];break;case 21509:Z.works2=!0;break;case 21506:je==5281&&(kt.z="hh:mm:ss",Z.cellDates&&kt.t=="n"&&(kt.v=ju(kt.v),kt.t=typeof kt.v=="number"?"n":"d"));break}},Z);else if(k[2]==26||k[2]==14)Z.Enum=Ce,k[2]==14&&(Z.qpro=!0,k.l=0),n(k,function(je,Tn,zt){switch(zt){case 204:xe=je;break;case 22:je[1].v.charCodeAt(0)<48&&(je[1].v=je[1].v.slice(1)),je[1].v=je[1].v.replace(/\x0F./g,function(It){return String.fromCharCode(It.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>Se&&(J["!ref"]=or(ht),Ye[xe]=J,De.push(xe),J={},Z.dense&&(rt=J["!data"]=[]),ht={s:{r:0,c:0},e:{r:0,c:0}},Se=je[3],xe="Sheet"+(Se+1)),Rt>0&&je[0].r>=Rt)break;Z.dense?(rt[je[0].r]||(rt[je[0].r]=[]),rt[je[0].r][je[0].c]=je[1]):J[Pn(je[0])]=je[1],ht.e.c<je[0].c&&(ht.e.c=je[0].c),ht.e.r<je[0].r&&(ht.e.r=je[0].r);break;case 27:je[14e3]&&(nt[je[14e3][0]]=je[14e3][1]);break;case 1537:nt[je[0]]=je[1],je[0]==Se&&(xe=je[1]);break}},Z);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(J["!ref"]=or(ht),Ye[be||xe]=J,De.push(be||xe),!nt.length)return{SheetNames:De,Sheets:Ye};for(var nn={},Qe=[],Ct=0;Ct<nt.length;++Ct)Ye[De[Ct]]?(Qe.push(nt[Ct]||De[Ct]),nn[nt[Ct]]=Ye[nt[Ct]]||Ye[De[Ct]]):(Qe.push(nt[Ct]),nn[nt[Ct]]={"!ref":"A1"});return{SheetNames:Qe,Sheets:nn}}function i(k,se){var Z=se||{};if(+Z.codepage>=0&&Cd(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK1 to JS string");var J=Jr();if(!k["!ref"])throw new Error("Cannot export empty sheet to WK1");var xe=Dn(k["!ref"]),be=k["!data"]!=null,Se=[];Be(J,0,o(1030)),Be(J,6,h(xe));for(var Ye=Math.min(xe.e.r,8191),De=xe.s.c;De<=xe.e.c;++De)Se[De]=gn(De);for(var nt=xe.s.r;nt<=Ye;++nt){var rt=yn(nt);for(De=xe.s.c;De<=xe.e.c;++De){var ht=be?(k["!data"][nt]||[])[De]:k[Se[De]+rt];if(!(!ht||ht.t=="z"))switch(ht.t){case"n":(ht.v|0)==ht.v&&ht.v>=-32768&&ht.v<=32767?Be(J,13,A(nt,De,ht)):Be(J,14,C(nt,De,ht));break;case"d":var Rt=Pr(ht.v);(Rt|0)==Rt&&Rt>=-32768&&Rt<=32767?Be(J,13,A(nt,De,{v:Rt,z:ht.z||Cn[14]})):Be(J,14,C(nt,De,{v:Rt,z:ht.z||Cn[14]}));break;default:var kt=Ro(ht);Be(J,15,v(nt,De,kt.slice(0,239)))}}}return Be(J,1),J.end()}function a(k,se){var Z=se||{};if(+Z.codepage>=0&&Cd(+Z.codepage),Z.type=="string")throw new Error("Cannot write WK3 to JS string");var J=Jr();Be(J,0,c(k));for(var xe=0,be=0;xe<k.SheetNames.length;++xe)(k.Sheets[k.SheetNames[xe]]||{})["!ref"]&&Be(J,27,ve(k.SheetNames[xe],be++));var Se=0;for(xe=0;xe<k.SheetNames.length;++xe){var Ye=k.Sheets[k.SheetNames[xe]];if(!(!Ye||!Ye["!ref"])){for(var De=Dn(Ye["!ref"]),nt=Ye["!data"]!=null,rt=[],ht=Math.min(De.e.r,8191),Rt=De.s.r;Rt<=ht;++Rt)for(var kt=yn(Rt),nn=De.s.c;nn<=De.e.c;++nn){Rt===De.s.r&&(rt[nn]=gn(nn));var Qe=rt[nn]+kt,Ct=nt?(Ye["!data"][Rt]||[])[nn]:Ye[Qe];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")Be(J,23,Te(Rt,nn,Se,Ct.v));else{var je=Ro(Ct);Be(J,22,Y(Rt,nn,Se,je.slice(0,239)))}}++Se}}return Be(J,1),J.end()}function o(k){var se=pe(2);return se.write_shift(2,k),se}function c(k){var se=pe(26);se.write_shift(2,4096),se.write_shift(2,4),se.write_shift(4,0);for(var Z=0,J=0,xe=0,be=0;be<k.SheetNames.length;++be){var Se=k.SheetNames[be],Ye=k.Sheets[Se];if(!(!Ye||!Ye["!ref"])){++xe;var De=Fr(Ye["!ref"]);Z<De.e.r&&(Z=De.e.r),J<De.e.c&&(J=De.e.c)}}return Z>8191&&(Z=8191),se.write_shift(2,Z),se.write_shift(1,xe),se.write_shift(1,J),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(1,1),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(4,0),se}function f(k,se,Z){var J={s:{c:0,r:0},e:{c:0,r:0}};return se==8&&Z.qpro?(J.s.c=k.read_shift(1),k.l++,J.s.r=k.read_shift(2),J.e.c=k.read_shift(1),k.l++,J.e.r=k.read_shift(2),J):(J.s.c=k.read_shift(2),J.s.r=k.read_shift(2),se==12&&Z.qpro&&(k.l+=2),J.e.c=k.read_shift(2),J.e.r=k.read_shift(2),se==12&&Z.qpro&&(k.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function h(k){var se=pe(8);return se.write_shift(2,k.s.c),se.write_shift(2,k.s.r),se.write_shift(2,k.e.c),se.write_shift(2,k.e.r),se}function d(k,se,Z){var J=[{c:0,r:0},{t:"n",v:0},0,0];return Z.qpro&&Z.vers!=20768?(J[0].c=k.read_shift(1),J[3]=k.read_shift(1),J[0].r=k.read_shift(2),k.l+=2):Z.works?(J[0].c=k.read_shift(2),J[0].r=k.read_shift(2),J[2]=k.read_shift(2)):(J[2]=k.read_shift(1),J[0].c=k.read_shift(2),J[0].r=k.read_shift(2)),J}function g(k){return k.z&&Cc(k.z)?240|(t.indexOf(k.z)+1||2):255}function m(k,se,Z){var J=k.l+se,xe=d(k,se,Z);if(xe[1].t="s",(Z.vers&65534)==20768){k.l++;var be=k.read_shift(1);return xe[1].v=k.read_shift(be,"utf8"),xe}return Z.qpro&&k.l++,xe[1].v=k.read_shift(J-k.l,"cstr"),xe}function v(k,se,Z){var J=pe(7+Z.length);J.write_shift(1,255),J.write_shift(2,se),J.write_shift(2,k),J.write_shift(1,39);for(var xe=0;xe<J.length;++xe){var be=Z.charCodeAt(xe);J.write_shift(1,be>=128?95:be)}return J.write_shift(1,0),J}function y(k,se,Z){var J=k.l+se,xe=d(k,se,Z);if(xe[1].t="s",Z.vers==20768){var be=k.read_shift(1);return xe[1].v=k.read_shift(be,"utf8"),xe}return xe[1].v=k.read_shift(J-k.l,"cstr"),xe}function b(k,se,Z){var J=d(k,se,Z);return J[1].v=k.read_shift(2,"i"),J}function A(k,se,Z){var J=pe(7);return J.write_shift(1,g(Z)),J.write_shift(2,se),J.write_shift(2,k),J.write_shift(2,Z.v,"i"),J}function w(k,se,Z){var J=d(k,se,Z);return J[1].v=k.read_shift(8,"f"),J}function C(k,se,Z){var J=pe(13);return J.write_shift(1,g(Z)),J.write_shift(2,se),J.write_shift(2,k),J.write_shift(8,Z.v,"f"),J}function T(k,se,Z){var J=k.l+se,xe=d(k,se,Z);if(xe[1].v=k.read_shift(8,"f"),Z.qpro)k.l=J;else{var be=k.read_shift(2);D(k.slice(k.l,k.l+be),xe),k.l+=be}return xe}function R(k,se,Z){var J=se&32768;return se&=-32769,se=(J?k:0)+(se>=8192?se-16384:se),(J?"":"$")+(Z?gn(se):yn(se))}var N={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},I=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(k,se){mi(k,0);for(var Z=[],J=0,xe="",be="",Se="",Ye="";k.l<k.length;){var De=k[k.l++];switch(De){case 0:Z.push(k.read_shift(8,"f"));break;case 1:be=R(se[0].c,k.read_shift(2),!0),xe=R(se[0].r,k.read_shift(2),!1),Z.push(be+xe);break;case 2:{var nt=R(se[0].c,k.read_shift(2),!0),rt=R(se[0].r,k.read_shift(2),!1);be=R(se[0].c,k.read_shift(2),!0),xe=R(se[0].r,k.read_shift(2),!1),Z.push(nt+rt+":"+be+xe)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:Z.push("("+Z.pop()+")");break;case 5:Z.push(k.read_shift(2));break;case 6:{for(var ht="";De=k[k.l++];)ht+=String.fromCharCode(De);Z.push('"'+ht.replace(/"/g,'""')+'"')}break;case 8:Z.push("-"+Z.pop());break;case 23:Z.push("+"+Z.pop());break;case 22:Z.push("NOT("+Z.pop()+")");break;case 20:case 21:Ye=Z.pop(),Se=Z.pop(),Z.push(["AND","OR"][De-20]+"("+Se+","+Ye+")");break;default:if(De<32&&I[De])Ye=Z.pop(),Se=Z.pop(),Z.push(Se+I[De]+Ye);else if(N[De]){if(J=N[De][1],J==69&&(J=k[k.l++]),J>Z.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+Z.join("|")+"|");return}var Rt=Z.slice(-J);Z.length-=J,Z.push(N[De][0]+"("+Rt.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}Z.length==1?se[1].f=""+Z[0]:console.error("WK1 bad formula parse |"+Z.join("|")+"|")}function B(k){var se=[{c:0,r:0},{t:"n",v:0},0];return se[0].r=k.read_shift(2),se[3]=k[k.l++],se[0].c=k[k.l++],se}function U(k,se){var Z=B(k);return Z[1].t="s",Z[1].v=k.read_shift(se-4,"cstr"),Z}function Y(k,se,Z,J){var xe=pe(6+J.length);xe.write_shift(2,k),xe.write_shift(1,Z),xe.write_shift(1,se),xe.write_shift(1,39);for(var be=0;be<J.length;++be){var Se=J.charCodeAt(be);xe.write_shift(1,Se>=128?95:Se)}return xe.write_shift(1,0),xe}function W(k,se){var Z=B(k);Z[1].v=k.read_shift(2);var J=Z[1].v>>1;if(Z[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return Z[1].v=J,Z}function re(k,se){var Z=B(k),J=k.read_shift(4),xe=k.read_shift(4),be=k.read_shift(2);if(be==65535)return J===0&&xe===3221225472?(Z[1].t="e",Z[1].v=15):J===0&&xe===3489660928?(Z[1].t="e",Z[1].v=42):Z[1].v=0,Z;var Se=be&32768;return be=(be&32767)-16446,Z[1].v=(1-Se*2)*(xe*Math.pow(2,be+32)+J*Math.pow(2,be)),Z}function Te(k,se,Z,J){var xe=pe(14);if(xe.write_shift(2,k),xe.write_shift(1,Z),xe.write_shift(1,se),J==0)return xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(2,65535),xe;var be=0,Se=0,Ye=0,De=0;return J<0&&(be=1,J=-J),Se=Math.log2(J)|0,J/=Math.pow(2,Se-31),De=J>>>0,(De&2147483648)==0&&(J/=2,++Se,De=J>>>0),J-=De,De|=2147483648,De>>>=0,J*=Math.pow(2,32),Ye=J>>>0,xe.write_shift(4,Ye),xe.write_shift(4,De),Se+=16383+(be?32768:0),xe.write_shift(2,Se),xe}function Fe(k,se){var Z=re(k);return k.l+=se-14,Z}function we(k,se){var Z=B(k),J=k.read_shift(4);return Z[1].v=J>>6,Z}function q(k,se){var Z=B(k),J=k.read_shift(8,"f");return Z[1].v=J,Z}function ee(k,se){var Z=q(k);return k.l+=se-12,Z}function Pe(k,se){return k[k.l+se-1]==0?k.read_shift(se,"cstr"):""}function qe(k,se){var Z=k[k.l++];Z>se-1&&(Z=se-1);for(var J="";J.length<Z;)J+=String.fromCharCode(k[k.l++]);return J}function P(k,se,Z){if(!(!Z.qpro||se<21)){var J=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var xe=k.read_shift(se-21,"cstr");return[J,xe]}}function ye(k,se){for(var Z={},J=k.l+se;k.l<J;){var xe=k.read_shift(2);if(xe==14e3){for(Z[xe]=[0,""],Z[xe][0]=k.read_shift(2);k[k.l];)Z[xe][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return Z}function ve(k,se){var Z=pe(5+k.length);Z.write_shift(2,14e3),Z.write_shift(2,se);for(var J=0;J<k.length;++J){var xe=k.charCodeAt(J);Z[Z.l++]=xe>127?95:xe}return Z[Z.l++]=0,Z}var ge={0:{n:"BOF",f:hg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:b},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:y},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Pe},222:{n:"SHEETNAMELP",f:qe},255:{n:"BOF",f:hg},21506:{n:"WKSNF",f:hg},65535:{n:""}},Ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:re},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:Fe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ye},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:we},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Pe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:P},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},He={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Ie(k){var se=k.read_shift(2),Z=k.read_shift(1);if(Z!=0)throw"unsupported QPW string type "+Z.toString(16);return k.read_shift(se,"sbcs-cont")}function Ge(k,se){mi(k,0);var Z=se||{},J={};Z.dense&&(J["!data"]=[]);var xe=[],be="",Se={s:{r:-1,c:-1},e:{r:-1,c:-1}},Ye=0,De=0,nt=0,rt=0,ht={SheetNames:[],Sheets:{}},Rt=[];e:for(;k.l<k.length;){var kt=k.read_shift(2),nn=k.read_shift(2),Qe=k.slice(k.l,k.l+nn);switch(mi(Qe,0),kt){case 1:if(Qe.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var Ct=Qe.read_shift(4),je=(Qe.length-Qe.l)/Ct|0,Tn=0;Tn<Ct;++Tn){var zt=Qe.l+je,It={};Qe.l+=2,It.numFmtId=Qe.read_shift(2),He[It.numFmtId]&&(It.z=He[It.numFmtId]),Qe.l=zt,Rt.push(It)}break;case 1025:break;case 1026:break;case 1031:for(Qe.l+=12;Qe.l<Qe.length;)Ye=Qe.read_shift(2),De=Qe.read_shift(1),xe.push(Qe.read_shift(Ye,"cstr"));break;case 1032:break;case 1537:{var on=Qe.read_shift(2);J={},Z.dense&&(J["!data"]=[]),Se.s.c=Qe.read_shift(2),Se.e.c=Qe.read_shift(2),Se.s.r=Qe.read_shift(4),Se.e.r=Qe.read_shift(4),Qe.l+=4,Qe.l+2<Qe.length&&(Ye=Qe.read_shift(2),De=Qe.read_shift(1),be=Ye==0?"":Qe.read_shift(Ye,"cstr")),be||(be=gn(on))}break;case 1538:{if(Se.s.c>255||Se.s.r>999999)break;Se.e.c<Se.s.c&&(Se.e.c=Se.s.c),Se.e.r<Se.s.r&&(Se.e.r=Se.s.r),J["!ref"]=or(Se),my(ht,J,be)}break;case 2561:nt=Qe.read_shift(2),Se.e.c<nt&&(Se.e.c=nt),Se.s.c>nt&&(Se.s.c=nt),rt=Qe.read_shift(4),Se.s.r>rt&&(Se.s.r=rt),rt=Qe.read_shift(4),Se.e.r<rt&&(Se.e.r=rt);break;case 3073:{rt=Qe.read_shift(4),Ye=Qe.read_shift(4),Se.s.r>rt&&(Se.s.r=rt),Se.e.r<rt+Ye-1&&(Se.e.r=rt+Ye-1);for(var Kn=gn(nt);Qe.l<Qe.length;){var Ht={t:"z"},Bn=Qe.read_shift(1),Ei=-1;Bn&128&&(Ei=Qe.read_shift(2));var Hi=Bn&64?Qe.read_shift(2)-1:0;switch(Bn&31){case 0:break;case 1:break;case 2:Ht={t:"n",v:Qe.read_shift(2)};break;case 3:Ht={t:"n",v:Qe.read_shift(2,"i")};break;case 4:Ht={t:"n",v:cy(Qe)};break;case 5:Ht={t:"n",v:Qe.read_shift(8,"f")};break;case 7:Ht={t:"s",v:xe[De=Qe.read_shift(4)-1]};break;case 8:Ht={t:"n",v:Qe.read_shift(8,"f")},Qe.l+=2,Qe.l+=4,isNaN(Ht.v)&&(Ht={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(Bn&31)}Ei!=-1&&(Rt[Ei-1]||{}).z&&(Ht.z=Rt[Ei-1].z);var cr=0;if(Bn&32)switch(Bn&31){case 2:cr=Qe.read_shift(2);break;case 3:cr=Qe.read_shift(2,"i");break;case 7:cr=Qe.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Bn&31)}if(!(!Z.sheetStubs&&Ht.t=="z")){var Ai=ti(Ht);Ht.t=="n"&&Ht.z&&Cc(Ht.z)&&Z.cellDates&&(Ai.v=ju(Ht.v),Ai.t=typeof Ai.v=="number"?"n":"d"),J["!data"]!=null?(J["!data"][rt]||(J["!data"][rt]=[]),J["!data"][rt][nt]=Ai):J[Kn+yn(rt)]=Ai}for(++rt,--Ye;Hi-- >0&&Ye>=0;){if(Bn&32)switch(Bn&31){case 2:Ht={t:"n",v:Ht.v+cr&65535};break;case 3:Ht={t:"n",v:Ht.v+cr&65535},Ht.v>32767&&(Ht.v-=65536);break;case 7:Ht={t:"s",v:xe[De=De+cr>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Bn&31)}else switch(Bn&31){case 1:Ht={t:"z"};break;case 2:Ht={t:"n",v:Qe.read_shift(2)};break;case 7:Ht={t:"s",v:xe[De=Qe.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Bn&31)}!Z.sheetStubs&&Ht.t=="z"||(J["!data"]!=null?(J["!data"][rt]||(J["!data"][rt]=[]),J["!data"][rt][nt]=Ht):J[Kn+yn(rt)]=Ht),++rt,--Ye}}}break;case 3074:{nt=Qe.read_shift(2),rt=Qe.read_shift(4);var fs=Ie(Qe);J["!data"]!=null?(J["!data"][rt]||(J["!data"][rt]=[]),J["!data"][rt][nt]={t:"s",v:fs}):J[gn(nt)+yn(rt)]={t:"s",v:fs}}break}k.l+=nn}return ht}return{sheet_to_wk1:i,book_to_wk3:a,to_workbook:e}}(),iH=/^\s|\s$|[\t\n\r]/;function sH(n,e){if(!e.bookSST)return"";var t=[lr];t[t.length]=Xe("sst",null,{xmlns:vf[0],count:n.Count,uniqueCount:n.Unique});for(var r=0;r!=n.length;++r)if(n[r]!=null){var i=n[r],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),typeof i.t!="string"&&(i.t=String(i.t)),i.t.match(iH)&&(a+=' xml:space="preserve"'),a+=">"+Bt(i.t)+"</t>"),a+="</si>",t[t.length]=a}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function aH(n){return[n.read_shift(4),n.read_shift(4)]}function oH(n,e){return e||(e=pe(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var lH=Y7;function cH(n){var e=Jr();Me(e,159,oH(n));for(var t=0;t<n.length;++t)Me(e,19,lH(n[t]));return Me(e,160),e.end()}function uH(n){for(var e=[],t=n.split(""),r=0;r<t.length;++r)e[r]=t[r].charCodeAt(0);return e}function FD(n){var e=0,t,r=uH(n),i=r.length+1,a,o,c,f,h;for(t=Sc(i),t[0]=r.length,a=1;a!=i;++a)t[a]=r[a-1];for(a=i-1;a>=0;--a)o=t[a],c=(e&16384)===0?0:1,f=e<<1&32767,h=c|f,e=h^o;return e^52811}function fH(n,e){var t=["{\\rtf1\\ansi"];if(!n["!ref"])return t[0]+"}";for(var r=Dn(n["!ref"]),i,a=n["!data"]!=null,o=[],c=r.s.r;c<=r.e.r;++c){t.push("\\trowd\\trautofit1");for(var f=r.s.c;f<=r.e.c;++f)t.push("\\cellx"+(f+1));for(t.push("\\pard\\intbl"),a&&(o=n["!data"][c]||[]),f=r.s.c;f<=r.e.c;++f){var h=Pn({r:c,c:f});if(i=a?o[f]:n[h],!i||i.v==null&&(!i.f||i.F)){t.push(" \\cell");continue}t.push(" "+(i.w||(Ro(i),i.w)||"").replace(/[\r\n]/g,"\\par ")),t.push("\\cell")}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}function AS(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var hH=6,So=hH;function Hg(n){return Math.floor((n+Math.round(128/So)/256)*So)}function zg(n){return Math.floor((n-5)/So*100+.5)/100}function F_(n){return Math.round((n*So+5)/So*256)/256}function fy(n){n.width?(n.wpx=Hg(n.width),n.wch=zg(n.wpx),n.MDW=So):n.wpx?(n.wch=zg(n.wpx),n.width=F_(n.wch),n.MDW=So):typeof n.wch=="number"&&(n.width=F_(n.wch),n.wpx=Hg(n.width),n.MDW=So),n.customWidth&&delete n.customWidth}var dH=96,PD=dH;function jg(n){return n*96/PD}function BD(n){return n*PD/96}function pH(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var r=t[0];r<=t[1];++r)n[r]!=null&&(e[e.length]=Xe("numFmt",null,{numFmtId:r,formatCode:Bt(n[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Xe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function gH(n){var e=[];return e[e.length]=Xe("cellXfs",null),n.forEach(function(t){e[e.length]=Xe("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Xe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function mH(n,e){var t=[lr,Xe("styleSheet",null,{xmlns:vf[0],"xmlns:vt":Er.vt})],r;return n.SSF&&(r=pH(n.SSF))!=null&&(t[t.length]=r),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=gH(e.cellXfs))&&(t[t.length]=r),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function vH(n,e){var t=n.read_shift(2),r=ei(n);return[t,r]}function _H(n,e,t){t||(t=pe(6+4*e.length)),t.write_shift(2,n),mr(e,t);var r=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),r}function xH(n,e,t){var r={};r.sz=n.read_shift(2)/20;var i=t9(n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var a=n.read_shift(2);switch(a===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=n.read_shift(1);o!=0&&(r.underline=o);var c=n.read_shift(1);c>0&&(r.family=c);var f=n.read_shift(1);switch(f>0&&(r.charset=f),n.l++,r.color=e9(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ei(n),r}function yH(n,e){e||(e=pe(25+4*32)),e.write_shift(2,n.sz*20),n9(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Bg(n.color,e);var r=0;return r=2,e.write_shift(1,r),mr(n.name,e),e.length>e.l?e.slice(0,e.l):e}var bH=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],e_,EH=Pa;function wS(n,e){e||(e=pe(4*3+8*7+16*1)),e_||(e_=Zx(bH));var t=e_[n.patternType];t==null&&(t=40),e.write_shift(4,t);var r=0;if(t!=40)for(Bg({auto:1},e),Bg({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function AH(n,e){var t=n.l+e,r=n.read_shift(2),i=n.read_shift(2);return n.l=t,{ixfe:r,numFmtId:i}}function UD(n,e,t){t||(t=pe(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var r=0;return t.write_shift(1,r),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Qh(n,e){return e||(e=pe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var wH=Pa;function SH(n,e){return e||(e=pe(51)),e.write_shift(1,0),Qh(null,e),Qh(null,e),Qh(null,e),Qh(null,e),Qh(null,e),e.length>e.l?e.slice(0,e.l):e}function TH(n,e){return e||(e=pe(12+4*10)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Ld(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function CH(n,e,t){var r=pe(2052);return r.write_shift(4,n),Ld(e,r),Ld(t,r),r.length>r.l?r.slice(0,r.l):r}function DH(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++t}),t!=0&&(Me(n,615,Js(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Me(n,44,_H(i,e[i]))}),Me(n,616))}}function OH(n){var e=1;Me(n,611,Js(e)),Me(n,43,yH({sz:12,color:{theme:1},name:"Calibri",family:2})),Me(n,612)}function RH(n){var e=2;Me(n,603,Js(e)),Me(n,45,wS({patternType:"none"})),Me(n,45,wS({patternType:"gray125"})),Me(n,604)}function NH(n){var e=1;Me(n,613,Js(e)),Me(n,46,SH()),Me(n,614)}function LH(n){var e=1;Me(n,626,Js(e)),Me(n,47,UD({numFmtId:0},65535)),Me(n,627)}function MH(n,e){Me(n,617,Js(e.length)),e.forEach(function(t){Me(n,47,UD(t,0))}),Me(n,618)}function IH(n){var e=1;Me(n,619,Js(e)),Me(n,48,TH({xfId:0,name:"Normal"})),Me(n,620)}function kH(n){var e=0;Me(n,505,Js(e)),Me(n,506)}function FH(n){var e=0;Me(n,508,CH(e,"TableStyleMedium9","PivotStyleMedium4")),Me(n,509)}function PH(n,e){var t=Jr();return Me(t,278),DH(t,n.SSF),OH(t),RH(t),NH(t),LH(t),MH(t,e.cellXfs),IH(t),kH(t),FH(t),Me(t,279),t.end()}function HD(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[lr];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function BH(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:ei(n)}}function UH(n){var e=pe(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),mr(n.name,e),e.slice(0,e.l)}function HH(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function zH(n){var e=pe(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function jH(n,e){var t=pe(8+2*e.length);return t.write_shift(4,n),mr(e,t),t.slice(0,t.l)}function $H(n){return n.l+=4,n.read_shift(4)!=0}function GH(n,e){var t=pe(8);return t.write_shift(4,n),t.write_shift(4,1),t}function VH(){var n=Jr();return Me(n,332),Me(n,334,Js(1)),Me(n,335,UH({name:"XLDAPR",version:12e4,flags:3496657072})),Me(n,336),Me(n,339,jH(1,"XLDAPR")),Me(n,52),Me(n,35,Js(514)),Me(n,4096,Js(0)),Me(n,4097,Os(1)),Me(n,36),Me(n,53),Me(n,340),Me(n,337,GH(1)),Me(n,51,zH([[1,0]])),Me(n,338),Me(n,333),n.end()}function WH(){var n=[lr];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function XH(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=Pn(t);var r=n.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function zD(n,e,t){var r=[21600,21600],i=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Xe("xml",null,{"xmlns:v":ns.v,"xmlns:o":ns.o,"xmlns:x":ns.x,"xmlns:mv":ns.mv}).replace(/\/>/,">"),Xe("o:shapelayout",Xe("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"})],o=65536*n,c=e||[];return c.length>0&&a.push(Xe("v:shapetype",[Xe("v:stroke",null,{joinstyle:"miter"}),Xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:r.join(","),"o:spt":202,path:i})),c.forEach(function(f){++o,a.push(YH(f,o))}),a.push("</xml>"),a.join("")}function YH(n,e,t){var r=Mn(n[0]),i={color2:"#BEFF82",type:"gradient"};i.type=="gradient"&&(i.angle="-180");var a=i.type=="gradient"?Xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=Xe("v:fill",a,i),c={on:"t",obscured:"t"};return["<v:shape"+Od({id:"_x0000_s"+e,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,Xe("v:shadow",null,c),Xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ir("x:Anchor",[r.c+1,0,r.r+1,0,r.c+3,20,r.r+5,20].join(",")),Ir("x:AutoFill","False"),Ir("x:Row",String(r.r)),Ir("x:Column",String(r.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function qH(n){var e=[lr,Xe("comments",null,{xmlns:vf[0]})],t=[];return e.push("<authors>"),n.forEach(function(r){r[1].forEach(function(i){var a=Bt(i.a);t.indexOf(a)==-1&&(t.push(a),e.push("<author>"+a+"</author>")),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(r){var i=0,a=[],o=0;if(r[1][0]&&r[1][0].T&&r[1][0].ID&&(i=t.indexOf("tc="+r[1][0].ID)),r[1].forEach(function(h){h.a&&(i=t.indexOf(Bt(h.a))),h.T&&++o,a.push(h.t==null?"":Bt(h.t))}),o===0)r[1].forEach(function(h){e.push('<comment ref="'+r[0]+'" authorId="'+t.indexOf(Bt(h.a))+'"><text>'),e.push(Ir("t",h.t==null?"":Bt(h.t))),e.push("</text></comment>")});else{r[1][0]&&r[1][0].T&&r[1][0].ID&&(i=t.indexOf("tc="+r[1][0].ID)),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>');for(var c=`Comment:
    `+a[0]+`
`,f=1;f<a.length;++f)c+=`Reply:
    `+a[f]+`
`;e.push(Ir("t",Bt(c))),e.push("</text></comment>")}}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function jD(n,e,t){var r=[lr,Xe("ThreadedComments",null,{xmlns:Er.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var f={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};c==0?a=f.id:f.parentId=a,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),r.push(Xe("threadedComment",Ir("text",o.t||""),f))})}),r.push("</ThreadedComments>"),r.join("")}function $D(n){var e=[lr,Xe("personList",null,{xmlns:Er.TCMNT,"xmlns:x":vf[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,r){e.push(Xe("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function KH(n){var e={};e.iauthor=n.read_shift(4);var t=Pc(n);return e.rfx=t.s,e.ref=Pn(t.s),n.l+=16,e}function QH(n,e){return e==null&&(e=pe(36)),e.write_shift(4,n[1].iauthor),yf(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var ZH=ei;function SS(n){return mr(n.slice(0,54))}function JH(n){var e=Jr(),t=[];return Me(e,628),Me(e,630),n.forEach(function(r){r[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),Me(e,632,SS(i.a)),i.T&&i.ID&&t.indexOf("tc="+i.ID)==-1&&(t.push("tc="+i.ID),Me(e,632,SS("tc="+i.ID))))})}),Me(e,631),Me(e,633),n.forEach(function(r){r[1].forEach(function(i){var a=-1;i.ID&&(a=t.indexOf("tc="+i.ID)),a==-1&&r[1][0].T&&r[1][0].ID&&(a=t.indexOf("tc="+r[1][0].ID)),a==-1&&(a=t.indexOf(i.a)),i.iauthor=a;var o={s:Mn(r[0]),e:Mn(r[0])};Me(e,635,QH([o,i])),i.t&&i.t.length>0&&Me(e,637,K7(i)),Me(e,636),delete i.iauthor})}),Me(e,634),Me(e,629),e.end()}function ez(n,e){e.FullPaths.forEach(function(t,r){if(r!=0){var i=t.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&An.utils.cfb_add(n,i,e.FileIndex[r].content)}})}var tz=["xlsb","xlsm","xlam","biff8","xla"],TS=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(r,i,a,o){var c=!1,f=!1;a.length==0?f=!0:a.charAt(0)=="["&&(f=!0,a=a.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=e.c:--d,f?h+=e.r:--h,i+(c?"":"$")+gn(d)+(f?"":"$")+yn(h)}return function(i,a){return e=a,i.replace(n,t)}}(),Cm=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{Cm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var Dm=function(){return function(e,t){return e.replace(Cm,function(r,i,a,o,c,f){var h=ay(o)-(a?0:t.c),d=sy(f)-(c?0:t.r),g=c=="$"?d+1:d==0?"":"["+d+"]",m=a=="$"?h+1:h==0?"":"["+h+"]";return i+"R"+g+"C"+m})}}();function nz(n,e){return n.replace(Cm,function(t,r,i,a,o,c){return r+(i=="$"?i+a:gn(ay(a)+e.c))+(o=="$"?o+c:yn(sy(c)+e.r))})}function rz(n){return n.length!=1}function nr(n){n.l+=1}function wl(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function GD(n,e,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return VD(n);t.biff==12&&(r=4)}var i=n.read_shift(r),a=n.read_shift(r),o=wl(n),c=wl(n);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function VD(n){var e=wl(n),t=wl(n),r=n.read_shift(1),i=n.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function iz(n,e,t){if(t.biff<8)return VD(n);var r=n.read_shift(t.biff==12?4:2),i=n.read_shift(t.biff==12?4:2),a=wl(n),o=wl(n);return{s:{r,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function WD(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return sz(n);var r=n.read_shift(t&&t.biff==12?4:2),i=wl(n);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function sz(n){var e=wl(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function az(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function oz(n,e,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return lz(n);var i=n.read_shift(r>=12?4:2),a=n.read_shift(2),o=(a&16384)>>14,c=(a&32768)>>15;if(a&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:c}}function lz(n){var e=n.read_shift(2),t=n.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:i,rRel:r}}function cz(n,e,t){var r=(n[n.l++]&96)>>5,i=GD(n,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function uz(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2,"i"),a=8;if(t)switch(t.biff){case 5:n.l+=12,a=6;break;case 12:a=12;break}var o=GD(n,a,t);return[r,i,o]}function fz(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function hz(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),a=8;if(t)switch(t.biff){case 5:n.l+=12,a=6;break;case 12:a=12;break}return n.l+=a,[r,i]}function dz(n,e,t){var r=(n[n.l++]&96)>>5,i=iz(n,e-1,t);return[r,i]}function pz(n,e,t){var r=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[r]}function CS(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function gz(n,e,t){n.l+=2;for(var r=n.read_shift(t&&t.biff==2?1:2),i=[],a=0;a<=r;++a)i.push(n.read_shift(t&&t.biff==2?1:2));return i}function mz(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function vz(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(t&&t.biff==2?1:2)]}function _z(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function xz(n,e,t){var r=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[r]}function XD(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function yz(n){return n.read_shift(2),XD(n)}function bz(n){return n.read_shift(2),XD(n)}function Ez(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=WD(n,0,t);return[r,i]}function Az(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=oz(n,0,t);return[r,i]}function wz(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var a=WD(n,0,t);return[r,i,a]}function Sz(n,e,t){var r=(n[n.l]&96)>>5;n.l+=1;var i=n.read_shift(t&&t.biff<=3?1:2);return[Fj[i],KD[i],r]}function Tz(n,e,t){var r=n[n.l++],i=n.read_shift(1),a=t&&t.biff<=3?[r==88?-1:0,n.read_shift(1)]:Cz(n);return[i,(a[0]===0?KD:kj)[a[1]]]}function Cz(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function Dz(n,e,t){n.l+=t&&t.biff==2?3:4}function Oz(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function Rz(n){return n.l++,bi[n.read_shift(1)]}function Nz(n){return n.l++,n.read_shift(2)}function Lz(n){return n.l++,n.read_shift(1)!==0}function Mz(n){return n.l++,bf(n)}function Iz(n,e,t){return n.l++,ND(n,e-1,t)}function kz(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=y9(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=bi[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=bf(n);break;case 2:t[1]=w9(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function Fz(n,e,t){for(var r=n.read_shift(t.biff==12?4:2),i=[],a=0;a!=r;++a)i.push((t.biff==12?Pc:C9)(n));return i}function Pz(n,e,t){var r=0,i=0;t.biff==12?(r=n.read_shift(4),i=n.read_shift(4)):(i=1+n.read_shift(1),r=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var a=0,o=[];a!=r&&(o[a]=[]);++a)for(var c=0;c!=i;++c)o[a][c]=kz(n,t.biff);return o}function Bz(n,e,t){var r=n.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,a=n.read_shift(i);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,a]}function Uz(n,e,t){if(t.biff==5)return Hz(n);var r=n.read_shift(1)>>>5&3,i=n.read_shift(2),a=n.read_shift(4);return[r,i,a]}function Hz(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[e,t,r]}function zz(n,e,t){var r=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function jz(n,e,t){var r=n.read_shift(1)>>>5&3,i=n.read_shift(t&&t.biff==2?1:2);return[r,i]}function $z(n,e,t){var r=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[r]}function Gz(n,e,t){var r=(n[n.l++]&96)>>5,i=n.read_shift(2),a=4;if(t)switch(t.biff){case 5:a=15;break;case 12:a=6;break}return n.l+=a,[r,i]}var Vz=Pa,Wz=Pa,Xz=Pa;function t0(n,e,t){return n.l+=2,[az(n)]}function hy(n){return n.l+=6,[]}var Yz=t0,qz=hy,Kz=hy,Qz=t0;function YD(n){return n.l+=2,[hg(n),n.read_shift(2)&1]}var Zz=t0,Jz=YD,ej=hy,tj=t0,nj=t0,rj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ij(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),r=n.read_shift(4),i=n.read_shift(2),a=n.read_shift(2),o=rj[t>>2&31];return{ixti:e,coltype:t&3,rt:o,idx:r,c:i,C:a}}function sj(n){return n.l+=2,[n.read_shift(4)]}function aj(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function oj(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function lj(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function cj(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function uj(n){return n.l+=4,[0,0]}var DS={1:{n:"PtgExp",f:Oz},2:{n:"PtgTbl",f:Xz},3:{n:"PtgAdd",f:nr},4:{n:"PtgSub",f:nr},5:{n:"PtgMul",f:nr},6:{n:"PtgDiv",f:nr},7:{n:"PtgPower",f:nr},8:{n:"PtgConcat",f:nr},9:{n:"PtgLt",f:nr},10:{n:"PtgLe",f:nr},11:{n:"PtgEq",f:nr},12:{n:"PtgGe",f:nr},13:{n:"PtgGt",f:nr},14:{n:"PtgNe",f:nr},15:{n:"PtgIsect",f:nr},16:{n:"PtgUnion",f:nr},17:{n:"PtgRange",f:nr},18:{n:"PtgUplus",f:nr},19:{n:"PtgUminus",f:nr},20:{n:"PtgPercent",f:nr},21:{n:"PtgParen",f:nr},22:{n:"PtgMissArg",f:nr},23:{n:"PtgStr",f:Iz},26:{n:"PtgSheet",f:aj},27:{n:"PtgEndSheet",f:oj},28:{n:"PtgErr",f:Rz},29:{n:"PtgBool",f:Lz},30:{n:"PtgInt",f:Nz},31:{n:"PtgNum",f:Mz},32:{n:"PtgArray",f:pz},33:{n:"PtgFunc",f:Sz},34:{n:"PtgFuncVar",f:Tz},35:{n:"PtgName",f:Bz},36:{n:"PtgRef",f:Ez},37:{n:"PtgArea",f:cz},38:{n:"PtgMemArea",f:zz},39:{n:"PtgMemErr",f:Vz},40:{n:"PtgMemNoMem",f:Wz},41:{n:"PtgMemFunc",f:jz},42:{n:"PtgRefErr",f:$z},43:{n:"PtgAreaErr",f:fz},44:{n:"PtgRefN",f:Az},45:{n:"PtgAreaN",f:dz},46:{n:"PtgMemAreaN",f:lj},47:{n:"PtgMemNoMemN",f:cj},57:{n:"PtgNameX",f:Uz},58:{n:"PtgRef3d",f:wz},59:{n:"PtgArea3d",f:uz},60:{n:"PtgRefErr3d",f:Gz},61:{n:"PtgAreaErr3d",f:hz},255:{}},fj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hj={1:{n:"PtgElfLel",f:YD},2:{n:"PtgElfRw",f:tj},3:{n:"PtgElfCol",f:Yz},6:{n:"PtgElfRwV",f:nj},7:{n:"PtgElfColV",f:Qz},10:{n:"PtgElfRadical",f:Zz},11:{n:"PtgElfRadicalS",f:ej},13:{n:"PtgElfColS",f:qz},15:{n:"PtgElfColSV",f:Kz},16:{n:"PtgElfRadicalLel",f:Jz},25:{n:"PtgList",f:ij},29:{n:"PtgSxName",f:sj},255:{}},dj={0:{n:"PtgAttrNoop",f:uj},1:{n:"PtgAttrSemi",f:xz},2:{n:"PtgAttrIf",f:vz},4:{n:"PtgAttrChoose",f:gz},8:{n:"PtgAttrGoto",f:mz},16:{n:"PtgAttrSum",f:Dz},32:{n:"PtgAttrBaxcel",f:CS},33:{n:"PtgAttrBaxcel",f:CS},64:{n:"PtgAttrSpace",f:yz},65:{n:"PtgAttrSpaceSemi",f:bz},128:{n:"PtgAttrIfError",f:_z},255:{}};function pj(n,e,t,r){if(r.biff<8)return Pa(n,e);for(var i=n.l+e,a=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=Pz(n,0,r),a.push(t[o][1]);break;case"PtgMemArea":t[o][2]=Fz(n,t[o][1],r),a.push(t[o][2]);break;case"PtgExp":r&&r.biff==12&&(t[o][1][1]=n.read_shift(4),a.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return e=i-n.l,e!==0&&a.push(Pa(n,e)),a}function gj(n,e,t){for(var r=n.l+e,i,a,o=[];r!=n.l;)e=r-n.l,a=n[n.l],i=DS[a]||DS[fj[a]],(a===24||a===25)&&(i=(a===24?hj:dj)[n[n.l+1]]),!i||!i.f?Pa(n,e):o.push([i.n,i.f(n,e,t)]);return o}function mj(n){for(var e=[],t=0;t<n.length;++t){for(var r=n[t],i=[],a=0;a<r.length;++a){var o=r[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var vj={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _j(n,e){var t=n.lastIndexOf("!"),r=e.lastIndexOf("!");return t==-1&&r==-1?n+":"+e:t>0&&r>0&&n.slice(0,t).toLowerCase()==e.slice(0,r).toLowerCase()?n+":"+e.slice(r+1):(console.error("Cannot hydrate range",n,e),n+":"+e)}function qD(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(n[r[0]][0]){case 357:return i=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return n[r[0]][0][3]?(i=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function OS(n,e,t){var r=qD(n,e,t);return r=="#REF"?r:Nd(r,t)}function lf(n,e,t,r,i){var a=i&&i.biff||8,o={s:{c:0,r:0}},c=[],f,h,d,g=0,m=0,v,y="";if(!n[0]||!n[0][0])return"";for(var b=-1,A="",w=0,C=n[0].length;w<C;++w){var T=n[0][w];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),h=c.pop(),b>=0){switch(n[0][b][1][0]){case 0:A=Ln(" ",n[0][b][1][1]);break;case 1:A=Ln("\r",n[0][b][1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][b][1][0])}h=h+A,b=-1}c.push(h+vj[T[0]]+f);break;case"PtgIsect":f=c.pop(),h=c.pop(),c.push(h+" "+f);break;case"PtgUnion":f=c.pop(),h=c.pop(),c.push(h+","+f);break;case"PtgRange":f=c.pop(),h=c.pop(),c.push(_j(h,f));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=fd(T[1][1],o,i),c.push(hd(d,a));break;case"PtgRefN":d=t?fd(T[1][1],t,i):T[1][1],c.push(hd(d,a));break;case"PtgRef3d":g=T[1][1],d=fd(T[1][2],o,i),y=OS(r,g,i),c.push(y+"!"+hd(d,a));break;case"PtgFunc":case"PtgFuncVar":var R=T[1][0],N=T[1][1];R||(R=0),R&=127;var I=R==0?[]:c.slice(-R);c.length-=R,N==="User"&&(N=I.shift()),c.push(N+"("+I.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":v=uS(T[1][1],t?{s:t}:o,i),c.push(Kv(v,i));break;case"PtgArea":v=uS(T[1][1],o,i),c.push(Kv(v,i));break;case"PtgArea3d":g=T[1][1],v=T[1][2],y=OS(r,g,i),c.push(y+"!"+Kv(v,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=T[1][2];var D=(r.names||[])[m-1]||(r[0]||[])[m],B=D?D.Name:"SH33TJSNAME"+String(m);B&&B.slice(0,6)=="_xlfn."&&!i.xlfn&&(B=B.slice(6)),c.push(B);break;case"PtgNameX":var U=T[1][1];m=T[1][2];var Y;if(i.biff<=5)U<0&&(U=-U),r[U]&&(Y=r[U][m]);else{var W="";if(((r[U]||[])[0]||[])[0]==14849||(((r[U]||[])[0]||[])[0]==1025?r[U][m]&&r[U][m].itab>0&&(W=r.SheetNames[r[U][m].itab-1]+"!"):W=r.SheetNames[m-1]+"!"),r[U]&&r[U][m])W+=r[U][m].Name;else if(r[0]&&r[0][m])W+=r[0][m].Name;else{var re=(qD(r,U,i)||"").split(";;");re[m-1]?W=re[m-1]:W+="SH33TJSERRX"}c.push(W);break}Y||(Y={Name:"SH33TJSERRY"}),c.push(Y.Name);break;case"PtgParen":var Te="(",Fe=")";if(b>=0){switch(A="",n[0][b][1][0]){case 2:Te=Ln(" ",n[0][b][1][1])+Te;break;case 3:Te=Ln("\r",n[0][b][1][1])+Te;break;case 4:Fe=Ln(" ",n[0][b][1][1])+Fe;break;case 5:Fe=Ln("\r",n[0][b][1][1])+Fe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][b][1][0])}b=-1}c.push(Te+c.pop()+Fe);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:T[1][1],r:T[1][0]};var we={c:t.c,r:t.r};if(r.sharedf[Pn(d)]){var q=r.sharedf[Pn(d)];c.push(lf(q,o,we,r,i))}else{var ee=!1;for(f=0;f!=r.arrayf.length;++f)if(h=r.arrayf[f],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(lf(h[1],o,we,r,i)),ee=!0;break}ee||c.push(T[1])}break;case"PtgArray":c.push("{"+mj(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var Pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&b>=0&&Pe.indexOf(n[0][w][0])==-1){T=n[0][b];var qe=!0;switch(T[1][0]){case 4:qe=!1;case 0:A=Ln(" ",T[1][1]);break;case 5:qe=!1;case 1:A=Ln("\r",T[1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((qe?A:"")+c.pop()+(qe?"":A)),b=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]=="TRUE"?!0:c[0]=="FALSE"?!1:c[0]}function xj(n){if(n==null){var e=pe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return Dc(n);return Dc(0)}function yj(n,e,t,r,i){var a=Oc(e,t,i),o=xj(n.v),c=pe(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var h=pe(n.bf.length),d=0;d<n.bf.length;++d)h[d]=n.bf[d];var g=sr([a,o,c,h]);return g}function Om(n,e,t){var r=n.read_shift(4),i=gj(n,r,t),a=n.read_shift(4),o=a>0?pj(n,a,i,t):null;return[i,o]}var bj=Om,Rm=Om,Ej=Om,Aj=Om;function RS(n){if((n|0)==n&&n<Math.pow(2,16)&&n>=0){var e=pe(11);return e.write_shift(4,3),e.write_shift(1,30),e.write_shift(2,n),e.write_shift(4,0),e}var t=pe(17);return t.write_shift(4,11),t.write_shift(1,31),t.write_shift(8,n),t.write_shift(4,0),t}function wj(n){var e=pe(10);return e.write_shift(4,2),e.write_shift(1,28),e.write_shift(1,n),e.write_shift(4,0),e}function Sj(n){var e=pe(10);return e.write_shift(4,2),e.write_shift(1,29),e.write_shift(1,n?1:0),e.write_shift(4,0),e}function Tj(n){var e=pe(7);e.write_shift(4,3+2*n.length),e.write_shift(1,23),e.write_shift(2,n.length);var t=pe(2*n.length);t.write_shift(2*n.length,n,"utf16le");var r=pe(4);return r.write_shift(4,0),sr([e,t,r])}function Cj(n){var e=Mn(n),t=pe(15);return t.write_shift(4,7),t.write_shift(1,36),t.write_shift(4,e.r),t.write_shift(2,e.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),t.write_shift(4,0),t}function Dj(n,e){var t=n.lastIndexOf("!"),r=n.slice(0,t);n=n.slice(t+1);var i=Mn(n);r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var a=pe(17);return a.write_shift(4,9),a.write_shift(1,58),a.write_shift(2,2+e.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(r.toLowerCase())),a.write_shift(4,i.r),a.write_shift(2,i.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),a.write_shift(4,0),a}function Oj(n,e){var t=n.lastIndexOf("!"),r=n.slice(0,t);n=n.slice(t+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=pe(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+e.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(r.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}function Rj(n){var e=n.split(":"),t=e[0],r=pe(23);r.write_shift(4,15),t=e[0];var i=Mn(t);return r.write_shift(1,36),r.write_shift(4,i.r),r.write_shift(2,i.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),t=e[1],i=Mn(t),r.write_shift(1,36),r.write_shift(4,i.r),r.write_shift(2,i.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),r.write_shift(4,0),r.write_shift(1,17),r.write_shift(4,0),r}function Nj(n,e){var t=n.lastIndexOf("!"),r=n.slice(0,t);n=n.slice(t+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=n.split(":"),a=pe(27);a.write_shift(4,19);var o=i[0],c=Mn(o);return a.write_shift(1,58),a.write_shift(2,2+e.SheetNames.map(function(f){return f.toLowerCase()}).indexOf(r.toLowerCase())),a.write_shift(4,c.r),a.write_shift(2,c.c|(o.charAt(0)=="$"?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),o=i[1],c=Mn(o),a.write_shift(1,58),a.write_shift(2,2+e.SheetNames.map(function(f){return f.toLowerCase()}).indexOf(r.toLowerCase())),a.write_shift(4,c.r),a.write_shift(2,c.c|(o.charAt(0)=="$"?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),a.write_shift(1,17),a.write_shift(4,0),a}function Lj(n,e){var t=n.lastIndexOf("!"),r=n.slice(0,t);n=n.slice(t+1),r.charAt(0)=="'"&&(r=r.slice(1,-1).replace(/''/g,"'"));var i=Fr(n),a=pe(23);return a.write_shift(4,15),a.write_shift(1,59),a.write_shift(2,2+e.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(r.toLowerCase())),a.write_shift(4,i.s.r),a.write_shift(4,i.e.r),a.write_shift(2,i.s.c),a.write_shift(2,i.e.c),a.write_shift(4,0),a}function Mj(n,e){if(typeof n=="number")return RS(n);if(typeof n=="boolean")return Sj(n);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(n))return wj(+Ma[n]);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Cj(n);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Rj(n);if(n.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Lj(n,e);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Dj(n,e);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return Nj(n,e);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(n))return Oj(n,e);if(/^".*"$/.test(n))return Tj(n);if(/^[+-]\d+$/.test(n))return RS(parseInt(n,10));throw"Formula |"+n+"| not supported for XLSB"}var Ij=Mj,kj={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},KD={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Fj={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Pj(n){var e="of:="+n.replace(Cm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function QD(n){return n.replace(/!/,".").replace(/:/,":.")}var dd=typeof Map<"u";function dy(n,e,t){var r=0,i=n.length;if(t){if(dd?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var a=dd?t.get(e):t[e];r<a.length;++r)if(n[a[r]].t===e)return n.Count++,a[r]}}else for(;r<i;++r)if(n[r].t===e)return n.Count++,r;return n[i]={t:e},n.Count++,n.Unique++,t&&(dd?(t.has(e)||t.set(e,[]),t.get(e).push(i)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(i))),i}function Nm(n,e){var t={min:n+1,max:n+1},r=-1;return e.MDW&&(So=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?r=zg(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(t.width=F_(r),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function ZD(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Ol(n,e,t){var r=t.revssf[e.z!=null?e.z:"General"],i=60,a=n.length;if(r==null&&t.ssf){for(;i<392;++i)if(t.ssf[i]==null){u7(e.z,i),t.ssf[i]=e.z,t.revssf[e.z]=r=i;break}}for(i=0;i!=a;++i)if(n[i].numFmtId===r)return i;return n[a]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function Bj(n,e,t){if(n&&n["!ref"]){var r=Dn(n["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function Uj(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+or(n[t])+'"/>';return e+"</mergeCells>"}function Hj(n,e,t,r,i){var a=!1,o={},c=null;if(r.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[t];try{e.Workbook&&(f=e.Workbook.Sheets[t].CodeName||f)}catch{}a=!0,o.codeName=Dd(Bt(f))}if(n&&n["!outline"]){var h={summaryBelow:1,summaryRight:1};n["!outline"].above&&(h.summaryBelow=0),n["!outline"].left&&(h.summaryRight=0),c=(c||"")+Xe("outlinePr",null,h)}!a&&!c||(i[i.length]=Xe("sheetPr",c,o))}var zj=["objects","scenarios","selectLockedCells","selectUnlockedCells"],jj=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $j(n){var e={sheet:1};return zj.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),jj.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=FD(n.password).toString(16).toUpperCase()),Xe("sheetProtection",null,e)}function Gj(n){return ZD(n),Xe("pageMargins",null,n)}function Vj(n,e){for(var t=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(t[t.length]=Xe("col",null,Nm(i,r)));return t[t.length]="</cols>",t.join("")}function Wj(n,e,t,r){var i=typeof n.ref=="string"?n.ref:or(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var a=t.Workbook.Names,o=Fr(i);o.s.r==o.e.r&&(o.e.r=Fr(e["!ref"]).e.r,i=or(o));for(var c=0;c<a.length;++c){var f=a[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==r){f.Ref=Nd(t.SheetNames[r])+"!"+Rd(i);break}}return c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+t.SheetNames[r]+"'!"+i}),Xe("autoFilter",null,{ref:i})}function Xj(n,e,t,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Xe("sheetViews",Xe("sheetView",null,i),{})}function Yj(n,e,t,r,i,a,o){if(n.c&&t["!comments"].push([e,n.c]),(n.v===void 0||n.t==="z"&&!(r||{}).sheetStubs)&&typeof n.f!="string"&&typeof n.z>"u")return"";var c="",f=n.t,h=n.v;if(n.t!=="z")switch(n.t){case"b":c=n.v?"1":"0";break;case"n":isNaN(n.v)?(n.t="e",c=bi[n.v=36]):isFinite(n.v)?c=""+n.v:(n.t="e",c=bi[n.v=7]);break;case"e":c=bi[n.v];break;case"d":if(r&&r.cellDates){var d=Ui(n.v,o);c=d.toISOString(),d.getUTCFullYear()<1900&&(c=c.slice(c.indexOf("T")+1).replace("Z",""))}else n=ti(n),n.t="n",c=""+(n.v=Pr(Ui(n.v,o),o));typeof n.z>"u"&&(n.z=Cn[14]);break;default:c=n.v;break}var g=n.t=="z"||n.v==null?"":Ir("v",Bt(c)),m={r:e},v=Ol(r.cellXfs,n,r);switch(v!==0&&(m.s=v),n.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){g=Ir("v",""+dy(r.Strings,n.v,r.revStrings)),m.t="s";break}else m.t="str";break}if(n.t!=f&&(n.t=f,n.v=h),typeof n.f=="string"&&n.f){var y=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;g=Xe("f",Bt(n.f),y)+(n.v!=null?g:"")}return n.l&&(n.l.display=Bt(c),t["!links"].push([e,n.l])),n.D&&(m.cm=1),Xe("c",g,m)}function qj(n,e,t,r){var i=[],a=[],o=Dn(n["!ref"]),c="",f,h="",d=[],g=0,m=0,v=n["!rows"],y=n["!data"]!=null,b=y?n["!data"]:[],A={r:h},w,C=-1,T=(((r||{}).Workbook||{}).WBProps||{}).date1904;for(m=o.s.c;m<=o.e.c;++m)d[m]=gn(m);for(g=o.s.r;g<=o.e.r;++g){a=[],h=yn(g);var R=y?b[g]:[];for(m=o.s.c;m<=o.e.c;++m){f=d[m]+h;var N=y?R[m]:n[f];N!==void 0&&(c=Yj(N,f,n,e,t,r,T))!=null&&a.push(c)}(a.length>0||v&&v[g])&&(A={r:h},v&&v[g]&&(w=v[g],w.hidden&&(A.hidden=1),C=-1,w.hpx?C=jg(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(A.ht=C,A.customHeight=1),w.level&&(A.outlineLevel=w.level)),i[i.length]=Xe("row",a.join(""),A))}if(v)for(;g<v.length;++g)v&&v[g]&&(A={r:g+1},w=v[g],w.hidden&&(A.hidden=1),C=-1,w.hpx?C=jg(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(A.ht=C,A.customHeight=1),w.level&&(A.outlineLevel=w.level),i[i.length]=Xe("row","",A));return i.join("")}function Kj(n,e,t,r){var i=[lr,Xe("worksheet",null,{xmlns:vf[0],"xmlns:r":Er.r})],a=t.SheetNames[n],o=0,c="",f=t.Sheets[a];f==null&&(f={});var h=f["!ref"]||"A1",d=Dn(h);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=or(d)}r||(r={}),f["!comments"]=[];var g=[];Hj(f,t,n,e,i),i[i.length]=Xe("dimension",null,{ref:h}),i[i.length]=Xj(f,e,n,t),e.sheetFormat&&(i[i.length]=Xe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(i[i.length]=Vj(f,f["!cols"])),i[o=i.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=qj(f,e,n,t),c.length>0&&(i[i.length]=c)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),f["!protect"]&&(i[i.length]=$j(f["!protect"])),f["!autofilter"]!=null&&(i[i.length]=Wj(f["!autofilter"],f,t,n)),f["!merges"]!=null&&f["!merges"].length>0&&(i[i.length]=Uj(f["!merges"]));var m=-1,v,y=-1;return f["!links"].length>0&&(i[i.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(v={ref:b[0]},b[1].Target.charAt(0)!="#"&&(y=sn(r,-1,Bt(b[1].Target).replace(/#[\s\S]*$/,""),Qt.HLINK),v["r:id"]="rId"+y),(m=b[1].Target.indexOf("#"))>-1&&(v.location=Bt(b[1].Target.slice(m+1))),b[1].Tooltip&&(v.tooltip=Bt(b[1].Tooltip)),v.display=b[1].display,i[i.length]=Xe("hyperlink",null,v))}),i[i.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(i[i.length]=Gj(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ir("ignoredErrors",Xe("ignoredError",null,{numberStoredAsText:1,sqref:h}))),g.length>0&&(y=sn(r,-1,"../drawings/drawing"+(n+1)+".xml",Qt.DRAW),i[i.length]=Xe("drawing",null,{"r:id":"rId"+y}),f["!drawing"]=g),f["!comments"].length>0&&(y=sn(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Qt.VML),i[i.length]=Xe("legacyDrawing",null,{"r:id":"rId"+y}),f["!legacy"]=y),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Qj(n,e){var t={},r=n.l+e;t.r=n.read_shift(4),n.l+=4;var i=n.read_shift(2);n.l+=1;var a=n.read_shift(1);return n.l=r,a&7&&(t.level=a&7),a&16&&(t.hidden=!0),a&32&&(t.hpt=i/20),t}function Zj(n,e,t){var r=pe(145),i=(t["!rows"]||[])[n]||{};r.write_shift(4,n),r.write_shift(4,0);var a=320;i.hpx?a=jg(i.hpx)*20:i.hpt&&(a=i.hpt*20),r.write_shift(2,a),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var c=0,f=r.l;r.l+=4;for(var h={r:n,c:0},d=t["!data"]!=null,g=0;g<16;++g)if(!(e.s.c>g+1<<10||e.e.c<g<<10)){for(var m=-1,v=-1,y=g<<10;y<g+1<<10;++y){h.c=y;var b=d?(t["!data"][h.r]||[])[h.c]:t[Pn(h)];b&&(m<0&&(m=y),v=y)}m<0||(++c,r.write_shift(4,m),r.write_shift(4,v))}var A=r.l;return r.l=f,r.write_shift(4,c),r.l=A,r.length>r.l?r.slice(0,r.l):r}function Jj(n,e,t,r){var i=Zj(r,t,e);(i.length>17||(e["!rows"]||[])[r])&&Me(n,0,i)}var e$=Pc,t$=yf;function n$(){}function r$(n,e){var t={},r=n[n.l];return++n.l,t.above=!(r&64),t.left=!(r&128),n.l+=18,t.name=Q7(n),t}function i$(n,e,t){t==null&&(t=pe(84+4*n.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),t.write_shift(1,r);for(var i=1;i<3;++i)t.write_shift(1,0);return Bg({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),vD(n,t),t.slice(0,t.l)}function s$(n){var e=Ps(n);return[e]}function a$(n,e,t){return t==null&&(t=pe(8)),Ic(e,t)}function o$(n){var e=kc(n);return[e]}function l$(n,e,t){return t==null&&(t=pe(4)),Fc(e,t)}function c$(n){var e=Ps(n),t=n.read_shift(1);return[e,t,"b"]}function u$(n,e,t){return t==null&&(t=pe(9)),Ic(e,t),t.write_shift(1,n.v?1:0),t}function f$(n){var e=kc(n),t=n.read_shift(1);return[e,t,"b"]}function h$(n,e,t){return t==null&&(t=pe(5)),Fc(e,t),t.write_shift(1,n.v?1:0),t}function d$(n){var e=Ps(n),t=n.read_shift(1);return[e,t,"e"]}function t_(n,e,t){return t==null&&(t=pe(9)),Ic(e,t),t.write_shift(1,n.v),t}function p$(n){var e=kc(n),t=n.read_shift(1);return[e,t,"e"]}function n_(n,e,t){return t==null&&(t=pe(8)),Fc(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function g$(n){var e=Ps(n),t=n.read_shift(4);return[e,t,"s"]}function m$(n,e,t){return t==null&&(t=pe(12)),Ic(e,t),t.write_shift(4,e.v),t}function v$(n){var e=kc(n),t=n.read_shift(4);return[e,t,"s"]}function _$(n,e,t){return t==null&&(t=pe(8)),Fc(e,t),t.write_shift(4,e.v),t}function x$(n){var e=Ps(n),t=bf(n);return[e,t,"n"]}function y$(n,e,t){return t==null&&(t=pe(16)),Ic(e,t),Dc(n.v,t),t}function b$(n){var e=kc(n),t=bf(n);return[e,t,"n"]}function E$(n,e,t){return t==null&&(t=pe(12)),Fc(e,t),Dc(n.v,t),t}function A$(n){var e=Ps(n),t=cy(n);return[e,t,"n"]}function w$(n,e,t){return t==null&&(t=pe(12)),Ic(e,t),_D(n.v,t),t}function S$(n){var e=kc(n),t=cy(n);return[e,t,"n"]}function T$(n,e,t){return t==null&&(t=pe(8)),Fc(e,t),_D(n.v,t),t}function C$(n){var e=Ps(n),t=oy(n);return[e,t,"is"]}function D$(n){var e=Ps(n),t=ei(n);return[e,t,"str"]}function O$(n,e,t){var r=n.v==null?"":String(n.v);return t==null&&(t=pe(12+4*n.v.length)),Ic(e,t),mr(r,t),t.length>t.l?t.slice(0,t.l):t}function R$(n){var e=kc(n),t=ei(n);return[e,t,"str"]}function N$(n,e,t){var r=n.v==null?"":String(n.v);return t==null&&(t=pe(8+4*r.length)),Fc(e,t),mr(r,t),t.length>t.l?t.slice(0,t.l):t}function L$(n,e,t){var r=n.l+e,i=Ps(n);i.r=t["!row"];var a=n.read_shift(1),o=[i,a,"b"];if(t.cellFormula){n.l+=2;var c=Rm(n,r-n.l,t);o[3]=lf(c,null,i,t.supbooks,t)}else n.l=r;return o}function M$(n,e,t){var r=n.l+e,i=Ps(n);i.r=t["!row"];var a=n.read_shift(1),o=[i,a,"e"];if(t.cellFormula){n.l+=2;var c=Rm(n,r-n.l,t);o[3]=lf(c,null,i,t.supbooks,t)}else n.l=r;return o}function I$(n,e,t){var r=n.l+e,i=Ps(n);i.r=t["!row"];var a=bf(n),o=[i,a,"n"];if(t.cellFormula){n.l+=2;var c=Rm(n,r-n.l,t);o[3]=lf(c,null,i,t.supbooks,t)}else n.l=r;return o}function k$(n,e,t){var r=n.l+e,i=Ps(n);i.r=t["!row"];var a=ei(n),o=[i,a,"str"];if(t.cellFormula){n.l+=2;var c=Rm(n,r-n.l,t);o[3]=lf(c,null,i,t.supbooks,t)}else n.l=r;return o}var F$=Pc,P$=yf;function B$(n,e){return e==null&&(e=pe(4)),e.write_shift(4,n),e}function U$(n,e){var t=n.l+e,r=Pc(n),i=Tm(n),a=ei(n),o=ei(n),c=ei(n);n.l=t;var f={rfx:r,relId:i,loc:a,display:c};return o&&(f.Tooltip=o),f}function H$(n,e){var t=pe(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));yf({s:Mn(n[0]),e:Mn(n[0])},t),ly("rId"+e,t);var r=n[1].Target.indexOf("#"),i=r==-1?"":n[1].Target.slice(r+1);return mr(i||"",t),mr(n[1].Tooltip||"",t),mr("",t),t.slice(0,t.l)}function z$(){}function j$(n,e,t){var r=n.l+e,i=xD(n),a=n.read_shift(1),o=[i];if(o[2]=a,t.cellFormula){var c=bj(n,r-n.l,t);o[1]=c}else n.l=r;return o}function $$(n,e,t){var r=n.l+e,i=Pc(n),a=[i];if(t.cellFormula){var o=Aj(n,r-n.l,t);a[1]=o,n.l=r}else n.l=r;return a}function G$(n,e,t){t==null&&(t=pe(18));var r=Nm(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(r.width||10)*256),t.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),t.write_shift(2,i),t}var JD=["left","right","top","bottom","header","footer"];function V$(n){var e={};return JD.forEach(function(t){e[t]=bf(n)}),e}function W$(n,e){return e==null&&(e=pe(6*8)),ZD(n),JD.forEach(function(t){Dc(n[t],e)}),e}function X$(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function Y$(n,e,t){t==null&&(t=pe(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function q$(n){var e=pe(24);return e.write_shift(4,4),e.write_shift(4,1),yf(n,e),e}function K$(n,e){return e==null&&(e=pe(16*4+2)),e.write_shift(2,n.password?FD(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function Q$(){}function Z$(){}function J$(n,e,t,r,i,a,o,c){var f={r:t,c:r};if(e.c&&a["!comments"].push([Pn(f),e.c]),e.v===void 0)return!1;var h="";switch(e.t){case"b":h=e.v?"1":"0";break;case"d":e=ti(e),e.z=e.z||Cn[14],e.v=Pr(Ui(e.v,c),c),e.t="n";break;case"n":case"e":h=""+e.v;break;default:h=e.v;break}switch(f.s=Ol(i.cellXfs,e,i),e.l&&a["!links"].push([Pn(f),e.l]),e.t){case"s":case"str":return i.bookSST?(h=dy(i.Strings,e.v==null?"":String(e.v),i.revStrings),f.t="s",f.v=h,o?Me(n,18,_$(e,f)):Me(n,7,m$(e,f))):(f.t="str",o?Me(n,17,N$(e,f)):Me(n,6,O$(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Me(n,13,T$(e,f)):Me(n,2,w$(e,f)):isFinite(e.v)?o?Me(n,16,E$(e,f)):Me(n,5,y$(e,f)):(f.t="e",isNaN(e.v)?o?Me(n,14,n_({v:36},f)):Me(n,3,t_({v:36},f)):o?Me(n,14,n_({v:7},f)):Me(n,3,t_({v:7},f))),!0;case"b":return f.t="b",o?Me(n,15,h$(e,f)):Me(n,4,u$(e,f)),!0;case"e":return f.t="e",o?Me(n,14,n_(e,f)):Me(n,3,t_(e,f)),!0}return o?Me(n,12,l$(e,f)):Me(n,1,a$(e,f)),!0}function eG(n,e,t,r,i){var a=Dn(e["!ref"]||"A1"),o="",c=[],f=(((i||{}).Workbook||{}).WBProps||{}).date1904;Me(n,145);var h=e["!data"]!=null,d=h?e["!data"][a.s.r]:[],g=a.e.r;e["!rows"]&&(g=Math.max(a.e.r,e["!rows"].length-1));for(var m=a.s.r;m<=g;++m)if(o=yn(m),h&&(d=e["!data"][m]),Jj(n,e,a,m),!(h&&!d)){var v=!1;if(m<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){m===a.s.r&&(c[y]=gn(y));var b=h?d[y]:e[c[y]+o];if(!b){v=!1;continue}v=J$(n,b,m,y,r,e,v,f)}}Me(n,146)}function tG(n,e){!e||!e["!merges"]||(Me(n,177,B$(e["!merges"].length)),e["!merges"].forEach(function(t){Me(n,176,P$(t))}),Me(n,178))}function nG(n,e){!e||!e["!cols"]||(Me(n,390),e["!cols"].forEach(function(t,r){t&&Me(n,60,G$(r,t))}),Me(n,391))}function rG(n,e){!e||!e["!ref"]||(Me(n,648),Me(n,649,q$(Dn(e["!ref"]))),Me(n,650))}function iG(n,e,t){e["!links"].forEach(function(r){if(r[1].Target){var i=sn(t,-1,r[1].Target.replace(/#[\s\S]*$/,""),Qt.HLINK);Me(n,494,H$(r,i))}}),delete e["!links"]}function sG(n,e,t,r){if(e["!comments"].length>0){var i=sn(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Qt.VML);Me(n,551,ly("rId"+i)),e["!legacy"]=i}}function aG(n,e,t,r){if(e["!autofilter"]){var i=e["!autofilter"],a=typeof i.ref=="string"?i.ref:or(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,c=Fr(a);c.s.r==c.e.r&&(c.e.r=Fr(e["!ref"]).e.r,a=or(c));for(var f=0;f<o.length;++f){var h=o[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==r){h.Ref=Nd(t.SheetNames[r])+"!"+Rd(a);break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:Nd(t.SheetNames[r])+"!"+Rd(a)}),Me(n,161,yf(Dn(a))),Me(n,162)}}function oG(n,e,t){Me(n,133),Me(n,137,Y$(e,t)),Me(n,138),Me(n,134)}function lG(n,e){e["!protect"]&&Me(n,535,K$(e["!protect"]))}function cG(n,e,t,r){var i=Jr(),a=t.SheetNames[n],o=t.Sheets[a]||{},c=a;try{t&&t.Workbook&&(c=t.Workbook.Sheets[n].CodeName||c)}catch{}var f=Dn(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Me(i,129),(t.vbaraw||o["!outline"])&&Me(i,147,i$(c,o["!outline"])),Me(i,148,t$(f)),oG(i,o,t.Workbook),nG(i,o),eG(i,o,n,e,t),lG(i,o),aG(i,o,t,n),tG(i,o),iG(i,o,r),o["!margins"]&&Me(i,476,W$(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&rG(i,o),sG(i,o,n,r),Me(i,130),i.end()}function uG(n,e){n.l+=10;var t=ei(n);return{name:t}}var fG=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function hG(n){return!n.Workbook||!n.Workbook.WBProps?"false":D7(n.Workbook.WBProps.date1904)?"true":"false"}var dG=":][*?/\\".split("");function eO(n,e){try{if(n=="")throw new Error("Sheet name cannot be blank");if(n.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(n.charCodeAt(0)==39||n.charCodeAt(n.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(n.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");dG.forEach(function(t){if(n.indexOf(t)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(t){throw t}return!0}function pG(n,e,t){n.forEach(function(r,i){eO(r);for(var a=0;a<i;++a)if(r==n[a])throw new Error("Duplicate Sheet Name: "+r);if(t){var o=e&&e[i]&&e[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function gG(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];pG(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)Bj(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t);n.SheetNames.forEach(function(r,i){var a=n.Sheets[r];if(!(!a||!a["!autofilter"])){var o;n.Workbook||(n.Workbook={}),n.Workbook.Names||(n.Workbook.Names=[]),n.Workbook.Names.forEach(function(f){f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i&&(o=f)});var c=Nd(r)+"!"+Rd(a["!autofilter"].ref);o?o.Ref=c:n.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:c})}})}function mG(n){var e=[lr];e[e.length]=Xe("workbook",null,{xmlns:vf[0],"xmlns:r":Er.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(fG.forEach(function(c){n.Workbook.WBProps[c[0]]!=null&&n.Workbook.WBProps[c[0]]!=c[1]&&(r[c[0]]=n.Workbook.WBProps[c[0]])}),n.Workbook.WBProps.CodeName&&(r.codeName=n.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=Xe("workbookPr",null,r);var i=n.Workbook&&n.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=n.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==n.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=n.SheetNames.length;++a){var o={name:Bt(n.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Xe("sheet",null,o)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(e[e.length]=Xe("definedName",Bt(c.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function vG(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=k_(n),t.name=ei(n),t}function _G(n,e){return e||(e=pe(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),ly(n.strRelID,e),mr(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function xG(n,e){var t={},r=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var i=e>8?ei(n):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function yG(n,e){e||(e=pe(72));var t=0;return n&&(n.date1904&&(t|=1),n.filterPrivacy&&(t|=8)),e.write_shift(4,t),e.write_shift(4,0),vD(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function bG(n,e,t){var r=n.l+e,i=n.read_shift(4);n.l+=1;var a=n.read_shift(4),o=Z7(n),c,f="";try{c=Ej(n,0,t);try{f=Tm(n)}catch{}}catch{console.error("Could not parse defined name "+o)}i&32&&(o="_xlnm."+o),n.l=r;var h={Name:o,Ptg:c,Flags:i};return a<268435455&&(h.Sheet=a),f&&(h.Comment=f),h}function EG(n,e){var t=pe(9),r=0,i=n.Name;u9.indexOf(i)>-1&&(r|=32,i=i.slice(6)),t.write_shift(4,r),t.write_shift(1,0),t.write_shift(4,n.Sheet==null?4294967295:n.Sheet);var a=[t,mr(i),Ij(n.Ref,e)];if(n.Comment)a.push(Ld(n.Comment));else{var o=pe(4);o.write_shift(4,4294967295),a.push(o)}return sr(a)}function AG(n,e){Me(n,143);for(var t=0;t!=e.SheetNames.length;++t){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,i={Hidden:r,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Me(n,156,_G(i))}Me(n,144)}function wG(n,e){e||(e=pe(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return mr("SheetJS",e),mr(Og.version,e),mr(Og.version,e),mr("7262",e),e.length>e.l?e.slice(0,e.l):e}function SG(n,e){e||(e=pe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function TG(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,r=0,i=-1,a=-1;r<t.length;++r)!t[r]||!t[r].Hidden&&i==-1?i=r:t[r].Hidden==1&&a==-1&&(a=r);a>i||(Me(n,135),Me(n,158,SG(i)),Me(n,136))}}function CG(n,e){!e.Workbook||!e.Workbook.Names||e.Workbook.Names.forEach(function(t){try{if(t.Flags&14)return;Me(n,39,EG(t,e))}catch{console.error("Could not serialize defined name "+JSON.stringify(t))}})}function DG(n){var e=n.SheetNames.length,t=pe(12*e+28);t.write_shift(4,e+2),t.write_shift(4,0),t.write_shift(4,-2),t.write_shift(4,-2),t.write_shift(4,0),t.write_shift(4,-1),t.write_shift(4,-1);for(var r=0;r<e;++r)t.write_shift(4,0),t.write_shift(4,r),t.write_shift(4,r);return t}function OG(n,e){Me(n,353),Me(n,357),Me(n,362,DG(e)),Me(n,354)}function RG(n,e){var t=Jr();return Me(t,131),Me(t,128,wG()),Me(t,153,yG(n.Workbook&&n.Workbook.WBProps||null)),TG(t,n),AG(t,n),OG(t,n),(n.Workbook||{}).Names&&CG(t,n),Me(t,132),t.end()}function NG(n,e){var t=[];return n.Props&&t.push(g9(n.Props,e)),n.Custprops&&t.push(m9(n.Props,n.Custprops)),t.join("")}function LG(n){return(((n||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function MG(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var a=[];a.push(Xe("NumberFormat",null,{"ss:Format":Bt(Cn[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};t.push(Xe("Style",a.join(""),o))}),Xe("Styles",t.join(""))}function tO(n){return Xe("NamedRange",null,{"ss:Name":n.Name.slice(0,6)=="_xlnm."?n.Name.slice(6):n.Name,"ss:RefersTo":"="+Dm(n.Ref,{r:0,c:0})})}function IG(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||t.push(tO(i)))}return Xe("Names",t.join(""))}function kG(n,e,t,r){if(!n||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,a=[],o=0;o<i.length;++o){var c=i[o];c.Sheet==t&&(c.Name.match(/^_xlfn\./)||a.push(tO(c)))}return a.join("")}function FG(n,e,t,r){if(!n)return"";var i=[];if(n["!margins"]&&(i.push("<PageSetup>"),n["!margins"].header&&i.push(Xe("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&i.push(Xe("Footer",null,{"x:Margin":n["!margins"].footer})),i.push(Xe("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t])if(r.Workbook.Sheets[t].Hidden)i.push(Xe("Visible",r.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<t&&!(r.Workbook.Sheets[a]&&!r.Workbook.Sheets[a].Hidden);++a);a==t&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),n["!protect"]&&(i.push(Ir("ProtectContents","True")),n["!protect"].objects&&i.push(Ir("ProtectObjects","True")),n["!protect"].scenarios&&i.push(Ir("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?i.push(Ir("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&i.push(Ir("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){n["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Xe("WorksheetOptions",i.join(""),{xmlns:ns.x})}function PG(n){return n.map(function(e){var t=C7(e.t||""),r=Xe("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"}),i={};return e.a&&(i["ss:Author"]=e.a),n.hidden||(i["ss:ShowAlways"]="1"),Xe("Comment",r,i)}).join("")}function BG(n,e,t,r,i,a,o){if(!n||n.v==null&&n.f==null)return"";var c={};if(n.f&&(c["ss:Formula"]="="+Bt(Dm(n.f,o))),n.F&&n.F.slice(0,e.length)==e){var f=Mn(n.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(n.l&&n.l.Target&&(c["ss:HRef"]=Bt(n.l.Target),n.l.Tooltip&&(c["x:HRefScreenTip"]=Bt(n.l.Tooltip))),t["!merges"])for(var h=t["!merges"],d=0;d!=h.length;++d)h[d].s.c!=o.c||h[d].s.r!=o.r||(h[d].e.c>h[d].s.c&&(c["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(c["ss:MergeDown"]=h[d].e.r-h[d].s.r));var g="",m="";switch(n.t){case"z":if(!r.sheetStubs)return"";break;case"n":isFinite(n.v)?(g="Number",m=String(n.v)):(g="Error",m=bi[isNaN(n.v)?36:7]);break;case"b":g="Boolean",m=n.v?"1":"0";break;case"e":g="Error",m=bi[n.v];break;case"d":g="DateTime",m=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Cn[14]);break;case"s":g="String",m=T7(n.v||"");break}var v=Ol(r.cellXfs,n,r);c["ss:StyleID"]="s"+(21+v),c["ss:Index"]=o.c+1;var y=n.v!=null?m:"",b=n.t=="z"?"":'<Data ss:Type="'+g+'">'+y+"</Data>";return(n.c||[]).length>0&&(b+=PG(n.c)),Xe("Cell",b,c)}function UG(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=BD(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function HG(n,e,t,r){if(!n["!ref"])return"";var i=Dn(n["!ref"]),a=n["!merges"]||[],o=0,c=[];n["!cols"]&&n["!cols"].forEach(function(A,w){fy(A);var C=!!A.width,T=Nm(w,A),R={"ss:Index":w+1};C&&(R["ss:Width"]=Hg(T.width)),A.hidden&&(R["ss:Hidden"]="1"),c.push(Xe("Column",null,R))});for(var f=n["!data"]!=null,h={r:0,c:0},d=i.s.r;d<=i.e.r;++d){var g=[UG(d,(n["!rows"]||[])[d])];h.r=d;for(var m=i.s.c;m<=i.e.c;++m){h.c=m;var v=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>m)&&!(a[o].s.r>d)&&!(a[o].e.c<m)&&!(a[o].e.r<d)){(a[o].s.c!=m||a[o].s.r!=d)&&(v=!0);break}if(!v){var y=gn(m)+yn(d),b=f?(n["!data"][d]||[])[m]:n[y];g.push(BG(b,y,n,e,t,r,h))}}g.push("</Row>"),g.length>2&&c.push(g.join(""))}return c.join("")}function zG(n,e,t){var r=[],i=t.SheetNames[n],a=t.Sheets[i],o=a?kG(a,e,n,t):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=a?HG(a,e,n,t):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(FG(a,e,n,t)),a&&a["!autofilter"]&&r.push('<AutoFilter x:Range="'+Dm(Rd(a["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),r.join("")}function jG(n,e){e||(e={}),n.SSF||(n.SSF=ti(Cn)),n.SSF&&(Am(),Em(n.SSF),e.revssf=wm(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Ol(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(NG(n,e)),t.push(LG(n)),t.push(""),t.push(IG(n));for(var r=0;r<n.SheetNames.length;++r)t.push(Xe("Worksheet",zG(r,e,n),{"ss:Name":Bt(n.SheetNames[r])}));return t[2]=MG(n,e),lr+Xe("Workbook",t.join(""),{xmlns:ns.ss,"xmlns:o":ns.o,"xmlns:x":ns.x,"xmlns:ss":ns.ss,"xmlns:dt":ns.dt,"xmlns:html":ns.html})}var r_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $G(n,e){var t=[],r=[],i=[],a=0,o,c=tS(hS,"n"),f=tS(dS,"n");if(n.Props)for(o=ar(n.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(c,o[a])?t:Object.prototype.hasOwnProperty.call(f,o[a])?r:i).push([o[a],n.Props[o[a]]]);if(n.Custprops)for(o=ar(n.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(n.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(c,o[a])?t:Object.prototype.hasOwnProperty.call(f,o[a])?r:i).push([o[a],n.Custprops[o[a]]]);var h=[];for(a=0;a<i.length;++a)OD.indexOf(i[a][0])>-1||TD.indexOf(i[a][0])>-1||i[a][1]!=null&&h.push(i[a]);r.length&&An.utils.cfb_add(e,"/SummaryInformation",_S(r,r_.SI,f,dS)),(t.length||h.length)&&An.utils.cfb_add(e,"/DocumentSummaryInformation",_S(t,r_.DSI,c,hS,h.length?h:null,r_.UDI))}function GG(n,e){var t=e||{},r=An.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return An.utils.cfb_add(r,i,rO(n,t)),t.biff==8&&(n.Props||n.Custprops)&&$G(n,r),t.biff==8&&n.vbaraw&&ez(r,An.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),r}var VG={0:{f:Qj},1:{f:s$},2:{f:A$},3:{f:d$},4:{f:c$},5:{f:x$},6:{f:D$},7:{f:g$},8:{f:k$},9:{f:I$},10:{f:L$},11:{f:M$},12:{f:o$},13:{f:S$},14:{f:p$},15:{f:f$},16:{f:b$},17:{f:R$},18:{f:v$},19:{f:oy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bG},40:{},42:{},43:{f:xH},44:{f:vH},45:{f:EH},46:{f:wH},47:{f:AH},48:{},49:{f:V7},50:{},51:{f:HH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:q9},62:{f:C$},63:{f:XH},64:{f:Q$},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:X$},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:r$},148:{f:e$,p:16},151:{f:z$},152:{},153:{f:xG},154:{},155:{},156:{f:vG},157:{},158:{},159:{T:1,f:aH},160:{T:-1},161:{T:1,f:Pc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:F$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:BH},336:{T:-1},337:{f:$H,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:k_},357:{},358:{},359:{},360:{T:1},361:{},362:{f:G9},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:j$},427:{f:$$},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:V$},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:n$},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:U$},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:k_},551:{f:Tm},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ZH},633:{T:1},634:{T:-1},635:{T:1,f:KH},636:{T:-1},637:{f:q7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:uG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Z$},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Be(n,e,t,r){var i=e;if(!isNaN(i)){var a=r||(t||[]).length||0,o=n.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&iy(t)&&n.push(t)}}function WG(n,e,t,r){var i=(t||[]).length||0;if(i<=8224)return Be(n,e,t,i);var a=e;if(!isNaN(a)){for(var o=t.parts||[],c=0,f=0,h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;var d=n.next(4);for(d.write_shift(2,a),d.write_shift(2,h),n.push(t.slice(f,f+h)),f+=h;f<i;){for(d=n.next(4),d.write_shift(2,60),h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;d.write_shift(2,h),n.push(t.slice(f,f+h)),f+=h}}}function i_(n,e,t,r){var i=pe(9);return e0(i,n,e),RD(t,r||"b",i),i}function XG(n,e,t){var r=pe(8+2*t.length);return e0(r,n,e),r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function nO(n,e){e.forEach(function(t){var r=t[0].map(function(a){return a.t}).join("");if(r.length<=2048)return Be(n,28,Jv(r,t[1],t[2]));Be(n,28,Jv(r.slice(0,2048),t[1],t[2],r.length));for(var i=2048;i<r.length;i+=2048)Be(n,28,Jv(r.slice(i,Math.min(i+2048,r.length)),-1,-1,Math.min(2048,r.length-i)))})}function YG(n,e,t,r,i,a){var o=0;e.z!=null&&(o=i._BIFF2FmtTable.indexOf(e.z),o==-1&&(i._BIFF2FmtTable.push(e.z),o=i._BIFF2FmtTable.length-1));var c=0;if(e.z!=null){for(;c<i.cellXfs.length&&i.cellXfs[c].numFmtId!=o;++c);c==i.cellXfs.length&&i.cellXfs.push({numFmtId:o})}if(e.v!=null)switch(e.t){case"d":case"n":var f=e.t=="d"?Pr(Ui(e.v,a),a):e.v;i.biff==2&&f==(f|0)&&f>=0&&f<65536?Be(n,2,J9(t,r,f,c,o)):isNaN(f)?Be(n,5,i_(t,r,36,"e")):isFinite(f)?Be(n,3,Z9(t,r,f,c,o)):Be(n,5,i_(t,r,7,"e"));return;case"b":case"e":Be(n,5,i_(t,r,e.v,e.t));return;case"s":case"str":Be(n,4,XG(t,r,e.v==null?"":String(e.v).slice(0,255)));return}Be(n,1,e0(null,t,r))}function qG(n,e,t,r,i){var a=e["!data"]!=null,o=Dn(e["!ref"]||"A1"),c="",f=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.r,16383)}for(var h=(((i||{}).Workbook||{}).WBProps||{}).date1904,d=[],g=[],m=o.s.c;m<=o.e.c;++m)f[m]=gn(m);for(var v=o.s.r;v<=o.e.r;++v)for(a&&(d=e["!data"][v]||[]),c=yn(v),m=o.s.c;m<=o.e.c;++m){var y=a?d[m]:e[f[m]+c];y&&(YG(n,y,v,m,r,h),y.c&&g.push([y.c,v,m]))}nO(n,g)}function KG(n,e){for(var t=e||{},r=Jr(),i=0,a=0;a<n.SheetNames.length;++a)n.SheetNames[a]==t.sheet&&(i=a);if(i==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);Be(r,t.biff==4?1033:t.biff==3?521:9,uy(n,16,t)),((n.Workbook||{}).WBProps||{}).date1904&&Be(r,34,Kr(!0)),t.cellXfs=[{numFmtId:0}],t._BIFF2FmtTable=["General"],t._Fonts=[];var o=Jr();return qG(o,n.Sheets[n.SheetNames[i]],i,t,n),t._BIFF2FmtTable.forEach(function(c){t.biff<=3?Be(r,30,P9(c)):Be(r,1054,B9(c))}),t.cellXfs.forEach(function(c){switch(t.biff){case 2:Be(r,67,H9(c));break;case 3:Be(r,579,ID(c));break;case 4:Be(r,1091,z9(c));break}}),delete t._BIFF2FmtTable,delete t.cellXfs,delete t._Fonts,r.push(o.end()),Be(r,10),r.end()}var qs=1,Ds=[];function QG(){var n=pe(82+8*Ds.length);n.write_shift(2,15),n.write_shift(2,61440),n.write_shift(4,74+8*Ds.length);{n.write_shift(2,0),n.write_shift(2,61446),n.write_shift(4,16+8*Ds.length);{n.write_shift(4,qs),n.write_shift(4,Ds.length+1);for(var e=0,t=0;t<Ds.length;++t)e+=Ds[t]&&Ds[t][1]||0;n.write_shift(4,e),n.write_shift(4,Ds.length)}Ds.forEach(function(r){n.write_shift(4,r[0]),n.write_shift(4,r[2])})}return n.write_shift(2,51),n.write_shift(2,61451),n.write_shift(4,18),n.write_shift(2,191),n.write_shift(4,524296),n.write_shift(2,385),n.write_shift(4,134217793),n.write_shift(2,448),n.write_shift(4,134217792),n.write_shift(2,64),n.write_shift(2,61726),n.write_shift(4,16),n.write_shift(4,134217741),n.write_shift(4,134217740),n.write_shift(4,134217751),n.write_shift(4,268435703),n}function ZG(n,e){var t=[],r=0,i=Jr(),a=qs,o;e.forEach(function(f,h){var d="",g=f[0].map(function(T){return T.a&&!d&&(d=T.a),T.t}).join("");++qs;{var m=pe(150);m.write_shift(2,15),m.write_shift(2,61444),m.write_shift(4,150),m.write_shift(2,3234),m.write_shift(2,61450),m.write_shift(4,8),m.write_shift(4,qs),m.write_shift(4,2560),m.write_shift(2,227),m.write_shift(2,61451),m.write_shift(4,84),m.write_shift(2,128),m.write_shift(4,0),m.write_shift(2,139),m.write_shift(4,2),m.write_shift(2,191),m.write_shift(4,524296),m.write_shift(2,344),m.l+=4,m.write_shift(2,385),m.write_shift(4,134217808),m.write_shift(2,387),m.write_shift(4,134217808),m.write_shift(2,389),m.write_shift(4,268435700),m.write_shift(2,447),m.write_shift(4,1048592),m.write_shift(2,448),m.write_shift(4,134217809),m.write_shift(2,451),m.write_shift(4,268435700),m.write_shift(2,513),m.write_shift(4,134217809),m.write_shift(2,515),m.write_shift(4,268435700),m.write_shift(2,575),m.write_shift(4,196609),m.write_shift(2,959),m.write_shift(4,131072|(f[0].hidden?2:0)),m.l+=2,m.write_shift(2,61456),m.write_shift(4,18),m.write_shift(2,3),m.write_shift(2,f[2]+2),m.l+=2,m.write_shift(2,f[1]+1),m.l+=2,m.write_shift(2,f[2]+4),m.l+=2,m.write_shift(2,f[1]+5),m.l+=2,m.l+=2,m.write_shift(2,61457),m.l+=4,m.l=150,h==0?o=m:Be(i,236,m)}r+=150;{var v=pe(52);v.write_shift(2,21),v.write_shift(2,18),v.write_shift(2,25),v.write_shift(2,qs),v.write_shift(2,0),v.l=22,v.write_shift(2,13),v.write_shift(2,22),v.write_shift(4,1651663474),v.write_shift(4,2503426821),v.write_shift(4,2150634280),v.write_shift(4,1768515844+qs*256),v.write_shift(2,0),v.write_shift(4,0),v.l+=4,Be(i,93,v)}{var y=pe(8);y.l+=2,y.write_shift(2,61453),y.l+=4,Be(i,236,y)}r+=8;{var b=pe(18);b.write_shift(2,18),b.l+=8,b.write_shift(2,g.length),b.write_shift(2,16),b.l+=4,Be(i,438,b);{var A=pe(1+g.length);A.write_shift(1,0),A.write_shift(g.length,g,"sbcs"),Be(i,60,A)}{var w=pe(16);w.l+=8,w.write_shift(2,g.length),w.l+=6,Be(i,60,w)}}{var C=pe(12+d.length);C.write_shift(2,f[1]),C.write_shift(2,f[2]),C.write_shift(2,0|(f[0].hidden?0:2)),C.write_shift(2,qs),C.write_shift(2,d.length),C.write_shift(1,0),C.write_shift(d.length,d,"sbcs"),C.l++,t.push(C)}});{var c=pe(80);c.write_shift(2,15),c.write_shift(2,61442),c.write_shift(4,r+c.length-8),c.write_shift(2,16),c.write_shift(2,61448),c.write_shift(4,8),c.write_shift(4,e.length+1),c.write_shift(4,qs),c.write_shift(2,15),c.write_shift(2,61443),c.write_shift(4,r+48),c.write_shift(2,15),c.write_shift(2,61444),c.write_shift(4,40),c.write_shift(2,1),c.write_shift(2,61449),c.write_shift(4,16),c.l+=16,c.write_shift(2,2),c.write_shift(2,61450),c.write_shift(4,8),c.write_shift(4,a),c.write_shift(4,5),Be(n,236,o?sr([c,o]):c)}n.push(i.end()),t.forEach(function(f){Be(n,28,f)}),Ds.push([a,e.length+1,qs]),++qs}function JG(n,e,t){Be(n,49,M9({sz:12,name:"Arial"},t))}function eV(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Be(n,1054,F9(i,e[i],t))})}function tV(n,e){var t=pe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Be(n,2151,t),t=pe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),MD(Dn(e["!ref"]||"A1"),t),t.write_shift(4,4),Be(n,2152,t)}function nV(n,e){for(var t=0;t<16;++t)Be(n,224,yS({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){Be(n,224,yS(r,0,e))})}function rV(n,e){for(var t=0;t<e["!links"].length;++t){var r=e["!links"][t];Be(n,440,W9(r)),r[1].Tooltip&&Be(n,2048,X9(r))}delete e["!links"]}function iV(n,e){if(e){var t=0;e.forEach(function(r,i){++t<=256&&r&&Be(n,125,K9(Nm(i,r),i))})}}function sV(n,e,t,r,i,a){var o=16+Ol(i.cellXfs,e,i);if(e.v==null&&!e.bf){Be(n,513,Oc(t,r,o));return}if(e.bf)Be(n,6,yj(e,t,r,i,o));else switch(e.t){case"d":case"n":var c=e.t=="d"?Pr(Ui(e.v,a),a):e.v;isNaN(c)?Be(n,517,Zv(t,r,36,o,i,"e")):isFinite(c)?Be(n,515,$9(t,r,c,o)):Be(n,517,Zv(t,r,7,o,i,"e"));break;case"b":case"e":Be(n,517,Zv(t,r,e.v,o,i,e.t));break;case"s":case"str":if(i.bookSST){var f=dy(i.Strings,e.v==null?"":String(e.v),i.revStrings);Be(n,253,I9(t,r,f,o))}else Be(n,516,k9(t,r,(e.v==null?"":String(e.v)).slice(0,255),o,i));break;default:Be(n,513,Oc(t,r,o))}}function aV(n,e,t){var r=Jr(),i=t.SheetNames[n],a=t.Sheets[i]||{},o=(t||{}).Workbook||{},c=(o.Sheets||[])[n]||{},f=a["!data"]!=null,h=e.biff==8,d="",g=[],m=Dn(a["!ref"]||"A1"),v=h?65536:16384;if(m.e.c>255||m.e.r>=v){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV"+v);m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.r,v-1)}Be(r,2057,uy(t,16,e)),Be(r,13,Os(1)),Be(r,12,Os(100)),Be(r,15,Kr(!0)),Be(r,17,Kr(!1)),Be(r,16,Dc(.001)),Be(r,95,Kr(!0)),Be(r,42,Kr(!1)),Be(r,43,Kr(!1)),Be(r,130,Os(1)),Be(r,128,j9()),Be(r,131,Kr(!1)),Be(r,132,Kr(!1)),h&&iV(r,a["!cols"]),Be(r,512,U9(m,e));var y=(((t||{}).Workbook||{}).WBProps||{}).date1904;h&&(a["!links"]=[]);for(var b=m.s.c;b<=m.e.c;++b)g[b]=gn(b);for(var A=[],w=[],C=m.s.r;C<=m.e.r;++C)for(f&&(w=a["!data"][C]||[]),d=yn(C),b=m.s.c;b<=m.e.c;++b){var T=f?w[b]:a[g[b]+d];T&&(sV(r,T,C,b,e,y),h&&T.l&&a["!links"].push([g[b]+d,T.l]),T.c&&A.push([T.c,C,b]))}var R=c.CodeName||c.name||i;return h?ZG(r,A):nO(r,A),h&&Be(r,574,L9((o.Views||[])[0])),h&&(a["!merges"]||[]).length&&Be(r,229,V9(a["!merges"])),h&&rV(r,a),Be(r,442,LD(R)),h&&tV(r,a),Be(r,10),r.end()}function oV(n,e,t){var r=Jr(),i=(n||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},c=t.biff==8,f=t.biff==5;if(Be(r,2057,uy(n,5,t)),t.bookType=="xla"&&Be(r,135),Be(r,225,c?Os(1200):null),Be(r,193,x9(2)),f&&Be(r,191),f&&Be(r,192),Be(r,226),Be(r,92,D9("SheetJS",t)),Be(r,66,Os(c?1200:1252)),c&&Be(r,353,Os(0)),c&&Be(r,448),Be(r,317,Q9(n.SheetNames.length)),c&&n.vbaraw&&Be(r,211),c&&n.vbaraw){var h=o.CodeName||"ThisWorkbook";Be(r,442,LD(h))}Be(r,156,Os(17)),Be(r,25,Kr(!1)),Be(r,18,Kr(!1)),Be(r,19,Os(0)),c&&Be(r,431,Kr(!1)),c&&Be(r,444,Os(0)),Be(r,61,N9()),Be(r,64,Kr(!1)),Be(r,141,Os(0)),Be(r,34,Kr(hG(n)=="true")),Be(r,14,Kr(!0)),c&&Be(r,439,Kr(!1)),Be(r,218,Os(0)),JG(r,n,t),eV(r,n.SSF,t),nV(r,t),c&&Be(r,352,Kr(!1));var d=r.end(),g=Jr();c&&Be(g,140,Y9()),c&&Ds.length&&Be(g,235,QG()),c&&t.Strings&&WG(g,252,R9(t.Strings)),Be(g,10);var m=g.end(),v=Jr(),y=0,b=0;for(b=0;b<n.SheetNames.length;++b)y+=(c?12:11)+(c?2:1)*n.SheetNames[b].length;var A=d.length+y+m.length;for(b=0;b<n.SheetNames.length;++b){var w=a[b]||{};Be(v,133,O9({pos:A,hs:w.Hidden||0,dt:0,name:n.SheetNames[b]},t)),A+=e[b].length}var C=v.end();if(y!=C.length)throw new Error("BS8 "+y+" != "+C.length);var T=[];return d.length&&T.push(d),C.length&&T.push(C),m.length&&T.push(m),sr(T)}function lV(n,e){var t=e||{},r=[];n&&!n.SSF&&(n.SSF=ti(Cn)),n&&n.SSF&&(Am(),Em(n.SSF),t.revssf=wm(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),qs=1,Ds=[],t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,py(t),t.cellXfs=[],Ol(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var i=0;i<n.SheetNames.length;++i)r[r.length]=aV(i,t,n);return r.unshift(oV(n,r,t)),sr(r)}function rO(n,e){for(var t=0;t<=n.SheetNames.length;++t){var r=n.Sheets[n.SheetNames[t]];if(!(!r||!r["!ref"])){var i=Fr(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost."),i.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond row 65536.  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return lV(n,e);case 4:case 3:case 2:return KG(n,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function cV(n,e,t,r){for(var i=n["!merges"]||[],a=[],o={},c=n["!data"]!=null,f=e.s.c;f<=e.e.c;++f){for(var h=0,d=0,g=0;g<i.length;++g)if(!(i[g].s.r>t||i[g].s.c>f)&&!(i[g].e.r<t||i[g].e.c<f)){if(i[g].s.r<t||i[g].s.c<f){h=-1;break}h=i[g].e.r-i[g].s.r+1,d=i[g].e.c-i[g].s.c+1;break}if(!(h<0)){var m=gn(f)+yn(t),v=c?(n["!data"][t]||[])[f]:n[m];v&&v.t=="n"&&v.v!=null&&!isFinite(v.v)&&(isNaN(v.v)?v={t:"e",v:36,w:bi[36]}:v={t:"e",v:7,w:bi[7]});var y=v&&v.v!=null&&(v.h||Yv(v.w||(Ro(v),v.w)||""))||"";o={},h>1&&(o.rowspan=h),d>1&&(o.colspan=d),r.editable?y='<span contenteditable="true">'+y+"</span>":v&&(o["data-t"]=v&&v.t||"z",v.v!=null&&(o["data-v"]=Yv(v.v instanceof Date?v.v.toISOString():v.v)),v.z!=null&&(o["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+Yv(v.l.Target)+'">'+y+"</a>")),o.id=(r.id||"sjs")+"-"+m,a.push(Xe("td",y,o))}}var b="<tr>";return b+a.join("")+"</tr>"}var uV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fV="</body></html>";function hV(n,e,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function iO(n,e){var t=e||{},r=t.header!=null?t.header:uV,i=t.footer!=null?t.footer:fV,a=[r],o=Fr(n["!ref"]||"A1");if(a.push(hV(n,o,t)),n["!ref"])for(var c=o.s.r;c<=o.e.r;++c)a.push(cV(n,o,c,t));return a.push("</table>"+i),a.join("")}function sO(n,e,t){var r=e.rows;if(!r)throw"Unsupported origin when "+e.tagName+" is not a TABLE";var i=t||{},a=n["!data"]!=null,o=0,c=0;if(i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var f=typeof i.origin=="string"?Mn(i.origin):i.origin;o=f.r,c=f.c}var h=Math.min(i.sheetRows||1e7,r.length),d={s:{r:0,c:0},e:{r:o,c}};if(n["!ref"]){var g=Fr(n["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),o==-1&&(d.e.r=o=g.e.r+1)}var m=[],v=0,y=n["!rows"]||(n["!rows"]=[]),b=0,A=0,w=0,C=0,T=0,R=0;for(n["!cols"]||(n["!cols"]=[]);b<r.length&&A<h;++b){var N=r[b];if(NS(N)){if(i.display)continue;y[A]={hidden:!0}}var I=N.cells;for(w=C=0;w<I.length;++w){var D=I[w];if(!(i.display&&NS(D))){var B=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):O7(D.innerHTML),U=D.getAttribute("data-z")||D.getAttribute("z");for(v=0;v<m.length;++v){var Y=m[v];Y.s.c==C+c&&Y.s.r<A+o&&A+o<=Y.e.r&&(C=Y.e.c+1-c,v=-1)}R=+D.getAttribute("colspan")||1,((T=+D.getAttribute("rowspan")||1)>1||R>1)&&m.push({s:{r:A+o,c:C+c},e:{r:A+o+(T||1)-1,c:C+c+(R||1)-1}});var W={t:"s",v:B},re=D.getAttribute("data-t")||D.getAttribute("t")||"";B!=null&&(B.length==0?W.t=re||"z":i.raw||B.trim().length==0||re=="s"||(re=="e"&&bi[+B]?W={t:"e",v:+B,w:bi[+B]}:B==="TRUE"?W={t:"b",v:!0}:B==="FALSE"?W={t:"b",v:!1}:isNaN(wo(B))?isNaN(Fg(B).getDate())?B.charCodeAt(0)==35&&Ma[B]!=null&&(W={t:"e",v:Ma[B],w:B}):(W={t:"d",v:Ui(B)},i.UTC&&(W.v=Sm(W.v)),i.cellDates||(W={t:"n",v:Pr(W.v)}),W.z=i.dateNF||Cn[14]):W={t:"n",v:wo(B)})),W.z===void 0&&U!=null&&(W.z=U);var Te="",Fe=D.getElementsByTagName("A");if(Fe&&Fe.length)for(var we=0;we<Fe.length&&!(Fe[we].hasAttribute("href")&&(Te=Fe[we].getAttribute("href"),Te.charAt(0)!="#"));++we);Te&&Te.charAt(0)!="#"&&Te.slice(0,11).toLowerCase()!="javascript:"&&(W.l={Target:Te}),a?(n["!data"][A+o]||(n["!data"][A+o]=[]),n["!data"][A+o][C+c]=W):n[Pn({c:C+c,r:A+o})]=W,d.e.c<C+c&&(d.e.c=C+c),C+=R}}++A}return m.length&&(n["!merges"]=(n["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,A-1+o),n["!ref"]=or(d),A>=h&&(n["!fullref"]=or((d.e.r=r.length-b+A-1+o,d))),n}function aO(n,e){var t=e||{},r={};return t.dense&&(r["!data"]=[]),sO(r,n,e)}function dV(n,e){var t=_f(aO(n,e),e);return t}function NS(n){var e="",t=pV(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function pV(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var gV=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Od({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return lr+e}}();function mV(n,e){var t="number",r="",i={"style:name":e},a="",o=0;n=n.replace(/"[$]"/g,"$");e:{if(n.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+n),n=n.slice(0,n.indexOf(";"))),n=="@"){t="text",r="<number:text-content/>";break e}if(n.indexOf(/\$/)>-1&&(t="currency"),n[o]=='"'){for(a="";n[++o]!='"'||n[++o]=='"';)a+=n[o];--o,n[o+1]=="*"?(o++,r+="<number:fill-character>"+Bt(a.replace(/""/g,'"'))+"</number:fill-character>"):r+="<number:text>"+Bt(a.replace(/""/g,'"'))+"</number:text>",n=n.slice(o+1),o=0}var c=n.match(/# (\?+)\/(\?+)/);if(c){r+=Xe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":c[1].length,"number:max-denominator-value":Math.max(+c[1].replace(/./g,"9"),+c[2].replace(/./g,"9"))});break e}if(c=n.match(/# (\?+)\/(\d+)/)){r+=Xe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":c[1].length,"number:denominator-value":+c[2]});break e}if(c=n.match(/\b(\d+)(|\.\d+)%/)){t="percentage",r+=Xe("number:number",null,{"number:decimal-places":c[2]&&c.length-1||0,"number:min-decimal-places":c[2]&&c.length-1||0,"number:min-integer-digits":c[1].length})+"<number:text>%</number:text>";break e}var f=!1;if(["y","m","d"].indexOf(n[0])>-1){t="date";t:for(;o<n.length;++o)switch(a=n[o].toLowerCase()){case"h":case"s":f=!0,--o;break t;case"m":n:for(var h=o+1;h<n.length;++h)switch(n[h]){case"y":case"d":break n;case"h":case"s":f=!0,--o;break t}case"y":case"d":for(;(n[++o]||"").toLowerCase()==a[0];)a+=a[0];switch(--o,a){case"y":case"yy":r+="<number:year/>";break;case"yyy":case"yyyy":r+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":r+='<number:month number:style="'+(a.length%2?"short":"long")+'" number:textual="'+(a.length>=3?"true":"false")+'"/>';break;case"d":case"dd":r+='<number:day number:style="'+(a.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":r+='<number:day-of-week number:style="'+(a.length%2?"short":"long")+'"/>';break}break;case'"':for(;n[++o]!='"'||n[++o]=='"';)a+=n[o];--o,r+="<number:text>"+Bt(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":a=n[++o],r+="<number:text>"+Bt(a)+"</number:text>";break;case"/":case":":r+="<number:text>"+Bt(a)+"</number:text>";break;default:console.error("unrecognized character "+a+" in ODF format "+n)}if(!f)break e;n=n.slice(o+1),o=0}if(n.match(/^\[?[hms]/)){for(t=="number"&&(t="time"),n.match(/\[/)&&(n=n.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");o<n.length;++o)switch(a=n[o].toLowerCase()){case"h":case"m":case"s":for(;(n[++o]||"").toLowerCase()==a[0];)a+=a[0];switch(--o,a){case"h":case"hh":r+='<number:hours number:style="'+(a.length%2?"short":"long")+'"/>';break;case"m":case"mm":r+='<number:minutes number:style="'+(a.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(n[o+1]==".")do a+=n[o+1],++o;while(n[o+1]=="0");r+='<number:seconds number:style="'+(a.match("ss")?"long":"short")+'"'+(a.match(/\./)?' number:decimal-places="'+(a.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;n[++o]!='"'||n[++o]=='"';)a+=n[o];--o,r+="<number:text>"+Bt(a.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":r+="<number:text>"+Bt(a)+"</number:text>";break;case"a":if(n.slice(o,o+3).toLowerCase()=="a/p"){r+="<number:am-pm/>",o+=2;break}if(n.slice(o,o+5).toLowerCase()=="am/pm"){r+="<number:am-pm/>",o+=4;break}default:console.error("unrecognized character "+a+" in ODF format "+n)}break e}if(n.indexOf(/\$/)>-1&&(t="currency"),n[0]=="$"&&(r+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',n=n.slice(1),o=0),o=0,n[o]=='"'){for(;n[++o]!='"'||n[++o]=='"';)a+=n[o];--o,n[o+1]=="*"?(o++,r+="<number:fill-character>"+Bt(a.replace(/""/g,'"'))+"</number:fill-character>"):r+="<number:text>"+Bt(a.replace(/""/g,'"'))+"</number:text>",n=n.slice(o+1),o=0}var d=n.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!d||!d[0])console.error("Could not find numeric part of "+n);else{var g=d[1].replace(/,/g,"");r+="<number:"+(d[3]?"scientific-":"")+'number number:min-integer-digits="'+(g.indexOf("0")==-1?"0":g.length-g.indexOf("0"))+'"'+(d[0].indexOf(",")>-1?' number:grouping="true"':"")+(d[2]&&' number:decimal-places="'+(d[2].length-1)+'"'||' number:decimal-places="0"')+(d[3]&&d[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(d[3]?' number:min-exponent-digits="'+d[3].match(/0+/)[0].length+'"':"")+"></number:"+(d[3]?"scientific-":"")+"number>",o=d.index+d[0].length}if(n[o]=='"'){for(a="";n[++o]!='"'||n[++o]=='"';)a+=n[o];--o,r+="<number:text>"+Bt(a.replace(/""/g,'"'))+"</number:text>"}}return r?Xe("number:"+t+"-style",r,i):(console.error("Could not generate ODS number format for |"+n+"|"),"")}function LS(n,e,t){for(var r=[],i=0;i<n.length;++i){var a=n[i];a&&a.Sheet==(t==-1?null:t)&&r.push(a)}return r.length?`      <table:named-expressions>
`+r.map(function(o){var c=(t==-1?"$":"")+QD(o.Ref);return"        "+Xe("table:named-range",null,{"table:name":o.Name,"table:cell-range-address":c,"table:base-cell-address":c.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var MS=function(){var n=function(i,a){return Bt(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=function(i,a,o,c,f,h){var d=[];d.push('      <table:table table:name="'+Bt(a.SheetNames[o])+`" table:style-name="ta1">
`);var g=0,m=0,v=Fr(i["!ref"]||"A1"),y=i["!merges"]||[],b=0,A=i["!data"]!=null;if(i["!cols"])for(m=0;m<=v.e.c;++m)d.push("        <table:table-column"+(i["!cols"][m]?' table:style-name="co'+i["!cols"][m].ods+'"':"")+`></table:table-column>
`);var w="",C=i["!rows"]||[];for(g=0;g<v.s.r;++g)w=C[g]?' table:style-name="ro'+C[g].ods+'"':"",d.push("        <table:table-row"+w+`></table:table-row>
`);for(;g<=v.e.r;++g){for(w=C[g]?' table:style-name="ro'+C[g].ods+'"':"",d.push("        <table:table-row"+w+`>
`),m=0;m<v.s.c;++m)d.push(e);for(;m<=v.e.c;++m){var T=!1,R={},N="";for(b=0;b!=y.length;++b)if(!(y[b].s.c>m)&&!(y[b].s.r>g)&&!(y[b].e.c<m)&&!(y[b].e.r<g)){(y[b].s.c!=m||y[b].s.r!=g)&&(T=!0),R["table:number-columns-spanned"]=y[b].e.c-y[b].s.c+1,R["table:number-rows-spanned"]=y[b].e.r-y[b].s.r+1;break}if(T){d.push(`          <table:covered-table-cell/>
`);continue}var I=Pn({r:g,c:m}),D=A?(i["!data"][g]||[])[m]:i[I];if(D&&D.f&&(R["table:formula"]=Bt(Pj(D.f)),D.F&&D.F.slice(0,I.length)==I)){var B=Fr(D.F);R["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,R["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!D){d.push(e);continue}switch(D.t){case"b":N=D.v?"TRUE":"FALSE",R["office:value-type"]="boolean",R["office:boolean-value"]=D.v?"true":"false";break;case"n":isFinite(D.v)?(N=D.w||String(D.v||0),R["office:value-type"]="float",R["office:value"]=D.v||0):(isNaN(D.v)?(N="#NUM!",R["table:formula"]="of:=#NUM!"):(N="#DIV/0!",R["table:formula"]="of:="+(D.v<0?"-":"")+"1/0"),R["office:string-value"]="",R["office:value-type"]="string",R["calcext:value-type"]="error");break;case"s":case"str":N=D.v==null?"":D.v,R["office:value-type"]="string";break;case"d":N=D.w||Ui(D.v,h).toISOString(),R["office:value-type"]="date",R["office:date-value"]=Ui(D.v,h).toISOString(),R["table:style-name"]="ce1";break;default:d.push(e);continue}var U=n(N);if(D.l&&D.l.Target){var Y=D.l.Target;Y=Y.charAt(0)=="#"?"#"+QD(Y.slice(1)):Y,Y.charAt(0)!="#"&&!Y.match(/^\w+:/)&&(Y="../"+Y),U=Xe("text:a",U,{"xlink:href":Y.replace(/&/g,"&amp;")})}f[D.z]&&(R["table:style-name"]="ce"+f[D.z].slice(1));var W=Xe("text:p",U,{});if(D.c){for(var re="",Te="",Fe={},we=0;we<D.c.length;++we)!re&&D.c[we].a&&(re=D.c[we].a),Te+="<text:p>"+n(D.c[we].t)+"</text:p>";D.c.hidden||(Fe["office:display"]=!0),W=Xe("office:annotation",Te,Fe)+W}d.push("          "+Xe("table:table-cell",W,R)+`
`)}d.push(`        </table:table-row>
`)}return(a.Workbook||{}).Names&&d.push(LS(a.Workbook.Names,a.SheetNames,o)),d.push(`      </table:table>
`),d.join("")},r=function(i,a){i.push(` <office:automatic-styles>
`);var o=0;a.SheetNames.map(function(d){return a.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var m=d["!cols"][g];if(m.width==null&&m.wpx==null&&m.wch==null)continue;fy(m),m.ods=o;var v=d["!cols"][g].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(d){return a.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=c;var m=d["!rows"][g].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var f={},h=69;return a.SheetNames.map(function(d){return a.Sheets[d]}).forEach(function(d){if(d){var g=d["!data"]!=null;if(d["!ref"])for(var m=Fr(d["!ref"]),v=0;v<=m.e.r;++v)for(var y=0;y<=m.e.c;++y){var b=g?(d["!data"][v]||[])[y]:d[Pn({r:v,c:y})];if(!(!b||!b.z||b.z.toLowerCase()=="general")&&!f[b.z]){var A=mV(b.z,"N"+h);A&&(f[b.z]="N"+h,++h,i.push(A+`
`))}}}}),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),ar(f).forEach(function(d){i.push('<style:style style:name="ce'+f[d].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+f[d]+`"/>
`)}),i.push(` </office:automatic-styles>
`),f};return function(a,o){var c=[lr],f=Od({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Od({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+f+h+`>
`),c.push(wD().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):c.push("<office:document-content"+f+`>
`);var d=r(c,a);c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`),((a.Workbook||{}).WBProps||{}).date1904&&c.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var g=0;g!=a.SheetNames.length;++g)c.push(t(a.Sheets[a.SheetNames[g]],a,g,o,d,((a.Workbook||{}).WBProps||{}).date1904));return(a.Workbook||{}).Names&&c.push(LS(a.Workbook.Names,a.SheetNames,-1)),c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function oO(n,e){if(e.bookType=="fods")return MS(n,e);var t=ey(),r="",i=[],a=[];return r="mimetype",Pt(t,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",Pt(t,r,MS(n,e)),i.push([r,"text/xml"]),a.push([r,"ContentFile"]),r="styles.xml",Pt(t,r,gV(n,e)),i.push([r,"text/xml"]),a.push([r,"StylesFile"]),r="meta.xml",Pt(t,r,lr+wD()),i.push([r,"text/xml"]),a.push([r,"MetadataFile"]),r="manifest.rdf",Pt(t,r,p9(a)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",Pt(t,r,h9(i)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var vi=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function $g(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function Md(n){return typeof TextDecoder<"u"?new TextDecoder().decode(n):$u(Tc(n))}function pi(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):ts(Dd(n))}function Sl(n){for(var e=0,t=0;t<n.length;++t)e+=n[t].length;var r=new Uint8Array(e),i=0;for(t=0;t<n.length;++t){var a=n[t],o=a.length;if(o<250)for(var c=0;c<o;++c)r[i++]=a[c];else r.set(a,i),i+=o}return r}function vV(n,e,t){var r=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-16,i=t/Math.pow(10,r-6176);n[e+15]|=r>>7,n[e+14]|=(r&127)<<1;for(var a=0;i>=1;++a,i/=256)n[e+a]=i&255;n[e+15]|=t>=0?0:128}function Id(n,e){var t=e.l,r=n[t]&127;e:if(n[t++]>=128&&(r|=(n[t]&127)<<7,n[t++]<128||(r|=(n[t]&127)<<14,n[t++]<128)||(r|=(n[t]&127)<<21,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(r+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e.l=t,r}function ot(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e[vi](0,t)}function lO(n){for(var e={l:0},t=[];e.l<n.length;)t.push(Id(n,e));return t}function cO(n){return Sl(n.map(function(e){return ot(e)}))}function ss(n){var e=0,t=n[e]&127;return n[e++]<128||(t|=(n[e]&127)<<7,n[e++]<128)||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128)||(t|=(n[e]&15)<<28),t}function gt(n){for(var e=[],t={l:0};t.l<n.length;){var r=t.l,i=Id(n,t),a=i&7;i=i/8|0;var o,c=t.l;switch(a){case 0:{for(;n[c++]>=128;);o=n[vi](t.l,c),t.l=c}break;case 1:o=n[vi](c,c+8),t.l=c+8;break;case 2:{var f=Id(n,t);o=n[vi](t.l,t.l+f),t.l+=f}break;case 5:o=n[vi](c,c+4),t.l=c+4;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(r))}var h={data:o,type:a};e[i]==null&&(e[i]=[]),e[i].push(h)}return e}function lt(n){var e=[];return n.forEach(function(t,r){r!=0&&t.forEach(function(i){i.data&&(e.push(ot(r*8+i.type)),i.type==2&&e.push(ot(i.data.length)),e.push(i.data))})}),Sl(e)}function Gg(n,e){return n?.map(function(t){return e(t.data)})||[]}function Vg(n){for(var e,t=[],r={l:0};r.l<n.length;){var i=Id(n,r),a=gt(n[vi](r.l,r.l+i));r.l+=i;var o={id:ss(a[1][0].data),messages:[]};a[2].forEach(function(c){var f=gt(c.data),h=ss(f[3][0].data);o.messages.push({meta:f,data:n[vi](r.l,r.l+h)}),r.l+=h}),(e=a[3])!=null&&e[0]&&(o.merge=ss(a[3][0].data)>>>0>0),t.push(o)}return t}function Wu(n){var e=[];return n.forEach(function(t){var r=[[],[{data:ot(t.id),type:0}],[]];t.merge!=null&&(r[3]=[{data:ot(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:ot(o.data.length)}],r[2].push({data:lt(o.meta),type:2})});var a=lt(r);e.push(ot(a.length)),e.push(a),i.forEach(function(o){return e.push(o)})}),Sl(e)}function _V(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t={l:0},r=Id(e,t),i=[],a=t.l;a<e.length;){var o=e[a]&3;if(o==0){var c=e[a++]>>2;if(c<60)++c;else{var f=c-59;c=e[a],f>1&&(c|=e[a+1]<<8),f>2&&(c|=e[a+2]<<16),f>3&&(c|=e[a+3]<<24),c>>>=0,c++,a+=f}i.push(e[vi](a,a+c)),a+=c;continue}else{var h=0,d=0;if(o==1?(d=(e[a]>>2&7)+4,h=(e[a++]&224)<<3,h|=e[a++]):(d=(e[a++]>>2)+1,o==2?(h=e[a]|e[a+1]<<8,a+=2):(h=(e[a]|e[a+1]<<8|e[a+2]<<16|e[a+3]<<24)>>>0,a+=4)),h==0)throw new Error("Invalid offset 0");for(var g=i.length-1,m=h;g>=0&&m>=i[g].length;)m-=i[g].length,--g;if(g<0)if(m==0)m=i[g=0].length;else throw new Error("Invalid offset beyond length");if(d<m)i.push(i[g][vi](i[g].length-m,i[g].length-m+d));else{for(m>0&&(i.push(i[g][vi](i[g].length-m)),d-=m),++g;d>=i[g].length;)i.push(i[g]),d-=i[g].length,++g;d&&i.push(i[g][vi](0,d))}i.length>25&&(i=[Sl(i)])}}for(var v=0,y=0;y<i.length;++y)v+=i[y].length;if(v!=r)throw new Error("Unexpected length: ".concat(v," != ").concat(r));return i}function Wg(n){Array.isArray(n)&&(n=new Uint8Array(n));for(var e=[],t=0;t<n.length;){var r=n[t++],i=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push.apply(e,_V(r,n[vi](t,t+i))),t+=i}if(t!==n.length)throw new Error("data is not a valid framed stream!");return e.length==1?e[0]:Sl(e)}function Xu(n){for(var e=[],t=0;t<n.length;){var r=Math.min(n.length-t,268435455),i=new Uint8Array(4);e.push(i);var a=ot(r),o=a.length;e.push(a),r<=60?(o++,e.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(n[vi](t,t+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,t+=r}return Sl(e)}function s_(n,e){var t=new Uint8Array(32),r=$g(t),i=12,a=0;switch(t[0]=5,n.t){case"n":if(n.z&&Cc(n.z)){t[1]=5,r.setFloat64(i,(ju(n.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=4,i+=8;break}else t[1]=2,vV(t,i,n.v),a|=1,i+=16;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),a|=2,i+=8;break;case"s":{var o=n.v==null?"":String(n.v);if(n.l){var c=e.rsst.findIndex(function(h){var d;return h.v==o&&h.l==((d=n.l)==null?void 0:d.Target)});c==-1&&(e.rsst[c=e.rsst.length]={v:o,l:n.l.Target}),t[1]=9,r.setUint32(i,c,!0),a|=16,i+=4}else{var f=e.sst.indexOf(o);f==-1&&(e.sst[f=e.sst.length]=o),t[1]=3,r.setUint32(i,f,!0),a|=8,i+=4}}break;case"d":t[1]=5,r.setFloat64(i,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=4,i+=8;break;case"z":t[1]=0;break;default:throw"unsupported cell type "+n.t}return n.c&&(e.cmnt.push(xV(n.c)),r.setUint32(i,e.cmnt.length-1,!0),a|=524288,i+=4),r.setUint32(8,a,!0),t[vi](0,i)}function a_(n,e){var t=new Uint8Array(32),r=$g(t),i=12,a=0,o="";switch(t[0]=4,n.t){case"n":break;case"b":break;case"s":if(o=n.v==null?"":String(n.v),n.l){var c=e.rsst.findIndex(function(h){var d;return h.v==o&&h.l==((d=n.l)==null?void 0:d.Target)});c==-1&&(e.rsst[c=e.rsst.length]={v:o,l:n.l.Target}),t[1]=9,r.setUint32(i,c,!0),a|=512,i+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+n.t}switch(n.c&&(r.setUint32(i,e.cmnt.length-1,!0),a|=4096,i+=4),n.t){case"n":t[1]=2,r.setFloat64(i,n.v,!0),a|=32,i+=8;break;case"b":t[1]=6,r.setFloat64(i,n.v?1:0,!0),a|=32,i+=8;break;case"s":if(o=n.v==null?"":String(n.v),!n.l){var f=e.sst.indexOf(o);f==-1&&(e.sst[f=e.sst.length]=o),t[1]=3,r.setUint32(i,f,!0),a|=16,i+=4}break;case"d":t[1]=5,r.setFloat64(i,(n.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),a|=64,i+=8;break;case"z":t[1]=0;break;default:throw"unsupported cell type "+n.t}return r.setUint32(8,a,!0),t[vi](0,i)}function rr(n){var e=gt(n);return ss(e[1][0].data)}function qr(n){return lt([[],[{type:0,data:ot(n)}]])}function Yr(n,e){var t,r=(t=n.messages[0].meta[5])!=null&&t[0]?lO(n.messages[0].meta[5][0].data):[],i=r.indexOf(e);i==-1&&(r.push(e),n.messages[0].meta[5]=[{type:2,data:cO(r)}])}function _o(n,e){var t,r=(t=n.messages[0].meta[5])!=null&&t[0]?lO(n.messages[0].meta[5][0].data):[];n.messages[0].meta[5]=[{type:2,data:cO(r.filter(function(i){return i!=e}))}]}function xV(n){for(var e={a:"",t:"",replies:[]},t=0;t<n.length;++t)t==0?(e.a=n[t].a,e.t=n[t].t):e.replies.push({a:n[t].a,t:n[t].t});return e}function yV(n,e,t){var r,i,a,o=[[],[{type:0,data:ot(0)}],[{type:0,data:ot(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ot(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:ot(1)}]];if(!((r=o[6])!=null&&r[0])||!((i=o[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var c=0;if(o[7][0].data.length<2*n.length){var f=new Uint8Array(2*n.length);f.set(o[7][0].data),o[7][0].data=f}if(o[4][0].data.length<2*n.length){var h=new Uint8Array(2*n.length);h.set(o[4][0].data),o[4][0].data=h}for(var d=$g(o[7][0].data),g=0,m=[],v=$g(o[4][0].data),y=0,b=[],A=4,w=0;w<n.length;++w){if(n[w]==null||n[w].t=="z"&&!((a=n[w].c)!=null&&a.length)||n[w].t=="e"){d.setUint16(w*2,65535,!0),v.setUint16(w*2,65535);continue}d.setUint16(w*2,g/A,!0),v.setUint16(w*2,y/A,!0);var C,T;switch(n[w].t){case"d":if(n[w].v instanceof Date){C=s_(n[w],e),T=a_(n[w],e);break}C=s_(n[w],e),T=a_(n[w],e);break;case"s":case"n":case"b":case"z":C=s_(n[w],e),T=a_(n[w],e);break;default:throw new Error("Unsupported value "+n[w])}m.push(C),g+=C.length,b.push(T),y+=T.length,++c}for(o[2][0].data=ot(c),o[5][0].data=ot(5);w<o[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),v.setUint16(w*2,65535,!0);return o[6][0].data=Sl(m),o[3][0].data=Sl(b),o[8]=[{type:0,data:ot(1)}],o}function P_(n,e){return{meta:[[],[{type:0,data:ot(n)}]],data:e}}function Ra(n,e){e.last||(e.last=927262);for(var t=e.last;t<2e6;++t)if(!e[t])return e[e.last=t]=n,t;throw new Error("Too many messages")}function bV(n){var e={},t=[];return n.FileIndex.map(function(r,i){return[r,n.FullPaths[i]]}).forEach(function(r){var i=r[0],a=r[1];i.type==2&&i.name.match(/\.iwa/)&&i.content[0]==0&&Vg(Wg(i.content)).forEach(function(o){t.push(o.id),e[o.id]={deps:[],location:a,type:ss(o.messages[0].meta[1][0].data)}})}),n.FileIndex.forEach(function(r){r.name.match(/\.iwa/)&&r.content[0]==0&&Vg(Wg(r.content)).forEach(function(i){i.messages.forEach(function(a){[5,6].forEach(function(o){a.meta[o]&&a.meta[o].forEach(function(c){e[i.id].deps.push(ss(c.data))})})})})}),e}function rg(n,e,t){return lt([[],[{type:0,data:ot(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([n/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:ot(1)}]])}function IS(n){switch(n){case 0:return rg(99,222,171);case 1:return rg(162,197,240);case 2:return rg(255,189,189)}return rg(Math.random()*255,Math.random()*255,Math.random()*255)}function EV(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=An.read(e.numbers,{type:"base64"}),r=bV(t),i=Na(t,r,1);if(i==null)throw"Could not find message ".concat(1," in Numbers template");var a=Gg(gt(i.messages[0].data)[1],rr);if(a.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return n.SheetNames.forEach(function(o,c){c>=1&&(wV(t,r,c+1),i=Na(t,r,1),a=Gg(gt(i.messages[0].data)[1],rr)),SV(t,r,n.Sheets[o],o,c,a[c])}),t}function pn(n,e,t,r){var i=An.find(n,e[t].location);if(!i)throw"Could not find ".concat(e[t].location," in Numbers template");var a=Vg(Wg(i.content)),o=a.find(function(c){return c.id==t});r(o,a),i.content=Xu(Wu(a)),i.size=i.content.length}function Na(n,e,t){var r=An.find(n,e[t].location);if(!r)throw"Could not find ".concat(e[t].location," in Numbers template");var i=Vg(Wg(r.content)),a=i.find(function(o){return o.id==t});return a}function B_(n,e,t){n[3].push({type:2,data:lt([[],[{type:0,data:ot(e)}],[{type:2,data:pi(t.replace(/-[\s\S]*$/,""))}],[{type:2,data:pi(t)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ot(0)}],[],[{type:0,data:ot(0)}]])}),n[1]=[{type:0,data:ot(Math.max(e+1,ss(n[1][0].data)))}]}function ac(n,e,t,r,i,a){a||(a=Ra({deps:[],location:"",type:e},i));var o="".concat(r,"-").concat(a,".iwa");i[a].location="Root Entry"+o,An.utils.cfb_add(n,o,Xu(Wu([{id:a,messages:[P_(e,lt(t))]}])));var c=o.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return pn(n,i,2,function(f){var h=gt(f.messages[0].data);B_(h,a||0,c),f.messages[0].data=lt(h)}),a}function Fi(n,e,t,r){var i=e[t].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),a=n[3].findIndex(function(c){var f,h,d=gt(c.data);return(f=d[3])!=null&&f[0]?Md(d[3][0].data)==i:!!((h=d[2])!=null&&h[0]&&Md(d[2][0].data)==i)}),o=gt(n[3][a].data);o[6]||(o[6]=[]),(Array.isArray(r)?r:[r]).forEach(function(c){o[6].push({type:2,data:lt([[],[{type:0,data:ot(c)}]])})}),n[3][a].data=lt(o)}function AV(n,e,t,r){var i=e[t].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),a=n[3].findIndex(function(c){var f,h,d=gt(c.data);return(f=d[3])!=null&&f[0]?Md(d[3][0].data)==i:!!((h=d[2])!=null&&h[0]&&Md(d[2][0].data)==i)}),o=gt(n[3][a].data);o[6]||(o[6]=[]),o[6]=o[6].filter(function(c){return ss(gt(c.data)[1][0].data)!=r}),n[3][a].data=lt(o)}function wV(n,e,t){var r=-1,i=-1,a={};pn(n,e,1,function(f,h){var d=gt(f.messages[0].data);r=rr(gt(f.messages[0].data)[1][0].data),i=Ra({deps:[1],location:e[r].location,type:2},e),a[r]=i,Yr(f,i),d[1].push({type:2,data:qr(i)});var g=Na(n,e,r);g.id=i,e[1].location==e[i].location?h.push(g):pn(n,e,i,function(m,v){return v.push(g)}),f.messages[0].data=lt(d)});var o=-1;pn(n,e,i,function(f,h){for(var d=gt(f.messages[0].data),g=3;g<=69;++g)delete d[g];var m=Gg(d[2],rr);m.forEach(function(y){return _o(f,y)}),o=Ra({deps:[i],location:e[m[0]].location,type:e[m[0]].type},e),Yr(f,o),a[m[0]]=o,d[2]=[{type:2,data:qr(o)}];var v=Na(n,e,m[0]);v.id=o,e[m[0]].location==e[i].location?h.push(v):(pn(n,e,2,function(y){var b=gt(y.messages[0].data);Fi(b,e,i,o),y.messages[0].data=lt(b)}),pn(n,e,o,function(y,b){return b.push(v)})),f.messages[0].data=lt(d)});var c=-1;pn(n,e,o,function(f,h){for(var d=gt(f.messages[0].data),g=gt(d[1][0].data),m=3;m<=69;++m)delete g[m];var v=rr(g[2][0].data);g[2][0].data=qr(a[v]),d[1][0].data=lt(g);var y=rr(d[2][0].data);_o(f,y),c=Ra({deps:[o],location:e[y].location,type:e[y].type},e),Yr(f,c),a[y]=c,d[2][0].data=qr(c);var b=Na(n,e,y);b.id=c,e[o].location==e[c].location?h.push(b):pn(n,e,c,function(A,w){return w.push(b)}),f.messages[0].data=lt(d)}),pn(n,e,c,function(f,h){var d,g,m=gt(f.messages[0].data),v=Md(m[1][0].data),y=v.replace(/-[A-Z0-9]*/,"-".concat(("0000"+t.toString(16)).slice(-4)));if(m[1][0].data=pi(y),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(N){return delete m[N]}),m[45]){var b=gt(m[45][0].data),A=rr(b[1][0].data);_o(f,A),delete m[45]}if(m[70]){var w=gt(m[70][0].data);(d=w[2])==null||d.forEach(function(N){var I=gt(N.data);[2,3].map(function(D){return I[D][0]}).forEach(function(D){var B=gt(D.data);if(B[8]){var U=rr(B[8][0].data);_o(f,U)}})}),delete m[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(N){if(m[N]){var I=rr(m[N][0].data);delete m[N],_o(f,I)}});var C=gt(m[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(N){var I;if((I=C[N])!=null&&I[0]){var D=rr(C[N][0].data),B=Ra({deps:[c],location:e[D].location,type:e[D].type},e);_o(f,D),Yr(f,B),a[D]=B;var U=Na(n,e,D);if(U.id=B,e[D].location==e[c].location)h.push(U);else{e[B].location=e[D].location.replace(D.toString(),B.toString()),e[B].location==e[D].location&&(e[B].location=e[B].location.replace(/\.iwa/,"-".concat(B,".iwa"))),An.utils.cfb_add(n,e[B].location,Xu(Wu([U])));var Y=e[B].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");pn(n,e,2,function(W){var re=gt(W.messages[0].data);B_(re,B,Y),Fi(re,e,c,B),W.messages[0].data=lt(re)})}C[N][0].data=qr(B)}});var T=gt(C[1][0].data);(g=T[2])==null||g.forEach(function(N){var I=rr(N.data),D=Ra({deps:[c],location:e[I].location,type:e[I].type},e);_o(f,I),Yr(f,D),a[I]=D;var B=Na(n,e,I);if(B.id=D,e[I].location==e[c].location)h.push(B);else{e[D].location=e[I].location.replace(I.toString(),D.toString()),e[D].location==e[I].location&&(e[D].location=e[D].location.replace(/\.iwa/,"-".concat(D,".iwa"))),An.utils.cfb_add(n,e[D].location,Xu(Wu([B])));var U=e[D].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");pn(n,e,2,function(Y){var W=gt(Y.messages[0].data);B_(W,D,U),Fi(W,e,c,D),Y.messages[0].data=lt(W)})}N.data=qr(D)}),C[1][0].data=lt(T);var R=gt(C[3][0].data);R[1].forEach(function(N){var I=gt(N.data),D=rr(I[2][0].data),B=a[D];if(!a[D]){B=Ra({deps:[c],location:"",type:e[D].type},e),e[B].location="Root Entry/Index/Tables/Tile-".concat(B,".iwa"),a[D]=B;var U=Na(n,e,D);U.id=B,_o(f,D),Yr(f,B),An.utils.cfb_add(n,"/Index/Tables/Tile-".concat(B,".iwa"),Xu(Wu([U]))),pn(n,e,2,function(Y){var W=gt(Y.messages[0].data);W[3].push({type:2,data:lt([[],[{type:0,data:ot(B)}],[{type:2,data:pi("Tables/Tile")}],[{type:2,data:pi("Tables/Tile-".concat(B))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ot(0)}],[],[{type:0,data:ot(0)}]])}),W[1]=[{type:0,data:ot(Math.max(B+1,ss(W[1][0].data)))}],Fi(W,e,c,B),Y.messages[0].data=lt(W)})}I[2][0].data=qr(B),N.data=lt(I)}),C[3][0].data=lt(R)}m[4][0].data=lt(C),f.messages[0].data=lt(m)})}function SV(n,e,t,r,i,a){var o=[];pn(n,e,a,function(h){var d=gt(h.messages[0].data);d[1]=[{type:2,data:pi(r)}],o=Gg(d[2],rr),h.messages[0].data=lt(d)});var c=Na(n,e,o[0]),f=rr(gt(c.messages[0].data)[2][0].data);pn(n,e,f,function(h,d){return TV(n,e,t,h,d,f)})}function TV(n,e,t,r,i,a){if(!t["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var o=Fr(t["!ref"]);o.s.r=o.s.c=0;var c=!1;o.e.c>999&&(c=!0,o.e.c=999),o.e.r>999999&&(c=!0,o.e.r=999999),c&&console.error("Truncating to ".concat(or(o)));var f=[];if(t["!data"])f=t["!data"];else{for(var h=[],d=0;d<=o.e.c;++d)h[d]=gn(d);for(var g=0;g<=o.e.r;++g){f[g]=[];var m=""+(g+1);for(d=0;d<=o.e.c;++d){var v=t[h[d]+m];v&&(f[g][d]=v)}}}var y={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},b=gt(r.messages[0].data);{b[6][0].data=ot(o.e.r+1),b[7][0].data=ot(o.e.c+1),delete b[46];var A=gt(b[4][0].data);{var w=rr(gt(A[1][0].data)[2][0].data);pn(n,e,w,function(ve,ge){var Ce,He=gt(ve.messages[0].data);if((Ce=He?.[2])!=null&&Ce[0])for(var Ie=0;Ie<f.length;++Ie){var Ge=gt(He[2][0].data);Ge[1][0].data=ot(Ie),Ge[4][0].data=ot(f[Ie].length),He[2][Ie]={type:He[2][0].type,data:lt(Ge)}}ve.messages[0].data=lt(He)});var C=rr(A[2][0].data);pn(n,e,C,function(ve,ge){for(var Ce=gt(ve.messages[0].data),He=0;He<=o.e.c;++He){var Ie=gt(Ce[2][0].data);Ie[1][0].data=ot(He),Ie[4][0].data=ot(o.e.r+1),Ce[2][He]={type:Ce[2][0].type,data:lt(Ie)}}ve.messages[0].data=lt(Ce)});var T=gt(A[9][0].data);T[1]=[];var R=gt(A[3][0].data);{var N=256;R[2]=[{type:0,data:ot(N)}];var I=rr(gt(R[1][0].data)[2][0].data),D=function(){var ve=Na(n,e,2),ge=gt(ve.messages[0].data),Ce=ge[3].filter(function(He){return ss(gt(He.data)[1][0].data)==I});return Ce?.length?ss(gt(Ce[0].data)[12][0].data):0}();An.utils.cfb_del(n,e[I].location),pn(n,e,2,function(ve){var ge=gt(ve.messages[0].data);ge[3]=ge[3].filter(function(Ce){return ss(gt(Ce.data)[1][0].data)!=I}),AV(ge,e,a,I),ve.messages[0].data=lt(ge)}),_o(r,I),R[1]=[];for(var B=Math.ceil((o.e.r+1)/N),U=0;U<B;++U){var Y=Ra({deps:[],location:"",type:6002},e);e[Y].location="Root Entry/Index/Tables/Tile-".concat(Y,".iwa");for(var W=[[],[{type:0,data:ot(0)}],[{type:0,data:ot(Math.min(o.e.r+1,(U+1)*N))}],[{type:0,data:ot(0)}],[{type:0,data:ot(Math.min((U+1)*N,o.e.r+1)-U*N)}],[],[{type:0,data:ot(5)}],[{type:0,data:ot(1)}],[{type:0,data:ot(1)}]],re=U*N;re<=Math.min(o.e.r,(U+1)*N-1);++re){var Te=yV(f[re],y);Te[1][0].data=ot(re-U*N),W[5].push({data:lt(Te),type:2})}R[1].push({type:2,data:lt([[],[{type:0,data:ot(U)}],[{type:2,data:qr(Y)}]])});var Fe={id:Y,messages:[P_(6002,lt(W))]},we=Xu(Wu([Fe]));An.utils.cfb_add(n,"/Index/Tables/Tile-".concat(Y,".iwa"),we),pn(n,e,2,function(ve){var ge=gt(ve.messages[0].data);ge[3].push({type:2,data:lt([[],[{type:0,data:ot(Y)}],[{type:2,data:pi("Tables/Tile")}],[{type:2,data:pi("Tables/Tile-".concat(Y))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:ot(0)}],[],[{type:0,data:ot(D)}]])}),ge[1]=[{type:0,data:ot(Math.max(Y+1,ss(ge[1][0].data)))}],Fi(ge,e,a,Y),ve.messages[0].data=lt(ge)}),Yr(r,Y),T[1].push({type:2,data:lt([[],[{type:0,data:ot(U*N)}],[{type:0,data:ot(U)}]])})}}if(A[3][0].data=lt(R),A[9][0].data=lt(T),A[10]=[{type:2,data:new Uint8Array([])}],t["!merges"]){var q=Ra({type:6144,deps:[a],location:e[a].location},e);i.push({id:q,messages:[P_(6144,lt([[],t["!merges"].map(function(ve){return{type:2,data:lt([[],[{type:2,data:lt([[],[{type:5,data:new Uint8Array(new Uint16Array([ve.s.r,ve.s.c]).buffer)}]])}],[{type:2,data:lt([[],[{type:5,data:new Uint8Array(new Uint16Array([ve.e.r-ve.s.r+1,ve.e.c-ve.s.c+1]).buffer)}]])}]])}})]))]}),A[13]=[{type:2,data:qr(q)}],pn(n,e,2,function(ve){var ge=gt(ve.messages[0].data);Fi(ge,e,a,q),ve.messages[0].data=lt(ge)}),Yr(r,q)}else delete A[13];var ee=rr(A[4][0].data);pn(n,e,ee,function(ve){var ge=gt(ve.messages[0].data);ge[3]=[],y.sst.forEach(function(Ce,He){He!=0&&ge[3].push({type:2,data:lt([[],[{type:0,data:ot(He)}],[{type:0,data:ot(1)}],[{type:2,data:pi(Ce)}]])})}),ve.messages[0].data=lt(ge)});var Pe=rr(A[17][0].data);if(pn(n,e,Pe,function(ve){var ge=gt(ve.messages[0].data);ge[3]=[];var Ce=[904980,903835,903815,903845];y.rsst.forEach(function(He,Ie){if(Ie!=0){var Ge=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:pi(He.v)}]];Ge[10]=[{type:0,data:new Uint8Array([1])}],Ge[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Ge[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Ge[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Ge[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Ge[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Ge[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Ge[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Ge[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var k=Ra({deps:[],location:"",type:2001},e),se=[];if(He.l){var Z=ac(n,2032,[[],[],[{type:2,data:pi(He.l)}]],"/Index/Tables/DataList",e);Ge[11]=[];var J=[[],[]];J[1]||(J[1]=[]),J[1].push({type:2,data:lt([[],[{type:0,data:ot(0)}],[{type:2,data:qr(Z)}]])}),Ge[11][0]={type:2,data:lt(J)},se.push(Z)}ac(n,2001,Ge,"/Index/Tables/DataList",e,k),pn(n,e,k,function(be){Ce.forEach(function(Se){return Yr(be,Se)}),se.forEach(function(Se){return Yr(be,Se)})});var xe=ac(n,6218,[[],[{type:2,data:qr(k)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",e);pn(n,e,xe,function(be){return Yr(be,k)}),ge[3].push({type:2,data:lt([[],[{type:0,data:ot(Ie)}],[{type:0,data:ot(1)}],[],[],[],[],[],[],[{type:2,data:qr(xe)}]])}),Yr(ve,xe),pn(n,e,2,function(be){var Se=gt(be.messages[0].data);Fi(Se,e,Pe,xe),Fi(Se,e,xe,k),Fi(Se,e,k,se),Fi(Se,e,k,Ce),be.messages[0].data=lt(Se)})}}),ve.messages[0].data=lt(ge)}),y.cmnt.length>1){var qe=rr(A[19][0].data),P={},ye=0;pn(n,e,qe,function(ve){var ge=gt(ve.messages[0].data);ge[3]=[],y.cmnt.forEach(function(Ce,He){if(He!=0){var Ie=[];Ce.replies&&Ce.replies.forEach(function(se){P[se.a||""]||(P[se.a||""]=ac(n,212,[[],[{type:2,data:pi(se.a||"")}],[{type:2,data:IS(++ye)}],[],[{type:0,data:ot(0)}]],"/Index/Tables/DataList",e));var Z=P[se.a||""],J=ac(n,3056,[[],[{type:2,data:pi(se.t||"")}],[{type:2,data:lt([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:qr(Z)}]],"/Index/Tables/DataList",e);pn(n,e,J,function(xe){return Yr(xe,Z)}),Ie.push(J),pn(n,e,2,function(xe){var be=gt(xe.messages[0].data);Fi(be,e,J,Z),xe.messages[0].data=lt(be)})}),P[Ce.a||""]||(P[Ce.a||""]=ac(n,212,[[],[{type:2,data:pi(Ce.a||"")}],[{type:2,data:IS(++ye)}],[],[{type:0,data:ot(0)}]],"/Index/Tables/DataList",e));var Ge=P[Ce.a||""],k=ac(n,3056,[[],[{type:2,data:pi(Ce.t||"")}],[{type:2,data:lt([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:qr(Ge)}],Ie.map(function(se){return{type:2,data:qr(se)}}),[{type:2,data:lt([[],[{type:0,data:ot(He)}],[{type:0,data:ot(0)}]])}]],"/Index/Tables/DataList",e);pn(n,e,k,function(se){Yr(se,Ge),Ie.forEach(function(Z){return Yr(se,Z)})}),ge[3].push({type:2,data:lt([[],[{type:0,data:ot(He)}],[{type:0,data:ot(1)}],[],[],[],[],[],[],[],[{type:2,data:qr(k)}]])}),Yr(ve,k),pn(n,e,2,function(se){var Z=gt(se.messages[0].data);Fi(Z,e,qe,k),Fi(Z,e,k,Ge),Ie.length&&Fi(Z,e,k,Ie),se.messages[0].data=lt(Z)})}}),ge[2][0].data=ot(y.cmnt.length+1),ve.messages[0].data=lt(ge)})}}b[4][0].data=lt(A)}r.messages[0].data=lt(b)}function CV(n){return function(t){for(var r=0;r!=n.length;++r){var i=n[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function py(n){CV([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function DV(n,e){n&&!n.SSF&&(n.SSF=ti(Cn)),n&&n.SSF&&(Am(),Em(n.SSF),e.revssf=wm(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,dd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="bin",r=!0,i=bD();py(e=e||{});var a=ey(),o="",c=0;if(e.cellXfs=[],Ol(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",Pt(a,o,SD(n.Props,e)),i.coreprops.push(o),sn(e.rels,2,o,Qt.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],h=0;h<n.SheetNames.length;++h)(n.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(n.SheetNames[h]);n.Props.SheetNames=f}n.Props.Worksheets=n.Props.SheetNames.length,Pt(a,o,CD(n.Props)),i.extprops.push(o),sn(e.rels,3,o,Qt.EXT_PROPS),n.Custprops!==n.Props&&ar(n.Custprops||{}).length>0&&(o="docProps/custom.xml",Pt(a,o,DD(n.Custprops)),i.custprops.push(o),sn(e.rels,4,o,Qt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,c=1;c<=n.SheetNames.length;++c){var g={"!id":{}},m=n.Sheets[n.SheetNames[c-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+c+"."+t,Pt(a,o,cG(c-1,e,n,g)),i.sheets.push(o),sn(e.wbrels,-1,"worksheets/sheet"+c+"."+t,Qt.WS[0])}if(m){var y=m["!comments"],b=!1,A="";if(y&&y.length>0){var w=!1;y.forEach(function(T){T[1].forEach(function(R){R.T==!0&&(w=!0)})}),w&&(A="xl/threadedComments/threadedComment"+c+".xml",Pt(a,A,jD(y,d,e)),i.threadedcomments.push(A),sn(g,-1,"../threadedComments/threadedComment"+c+".xml",Qt.TCMNT)),A="xl/comments"+c+"."+t,Pt(a,A,JH(y)),i.comments.push(A),sn(g,-1,"../comments"+c+"."+t,Qt.CMNT),b=!0}m["!legacy"]&&b&&Pt(a,"xl/drawings/vmlDrawing"+c+".vml",zD(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&Pt(a,AD(o),Gu(g))}e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,Pt(a,o,cH(e.Strings)),i.strs.push(o),sn(e.wbrels,-1,"sharedStrings."+t,Qt.SST)),o="xl/workbook."+t,Pt(a,o,RG(n)),i.workbooks.push(o),sn(e.rels,1,o,Qt.WB),o="xl/theme/theme1.xml";var C=HD(n.Themes,e);return Pt(a,o,C),i.themes.push(o),sn(e.wbrels,-1,"theme/theme1.xml",Qt.THEME),o="xl/styles."+t,Pt(a,o,PH(n,e)),i.styles.push(o),sn(e.wbrels,-1,"styles."+t,Qt.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",Pt(a,o,n.vbaraw),i.vba.push(o),sn(e.wbrels,-1,"vbaProject.bin",Qt.VBA)),o="xl/metadata."+t,Pt(a,o,VH()),i.metadata.push(o),sn(e.wbrels,-1,"metadata."+t,Qt.XLMETA),d.length>1&&(o="xl/persons/person.xml",Pt(a,o,$D(d)),i.people.push(o),sn(e.wbrels,-1,"persons/person.xml",Qt.PEOPLE)),Pt(a,"[Content_Types].xml",ED(i,e)),Pt(a,"_rels/.rels",Gu(e.rels)),Pt(a,"xl/_rels/workbook."+t+".rels",Gu(e.wbrels)),delete e.revssf,delete e.ssf,a}function OV(n,e){n&&!n.SSF&&(n.SSF=ti(Cn)),n&&n.SSF&&(Am(),Em(n.SSF),e.revssf=wm(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,dd?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",r=tz.indexOf(e.bookType)>-1,i=bD();py(e=e||{});var a=ey(),o="",c=0;if(e.cellXfs=[],Ol(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),o="docProps/core.xml",Pt(a,o,SD(n.Props,e)),i.coreprops.push(o),sn(e.rels,2,o,Qt.CORE_PROPS),o="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var f=[],h=0;h<n.SheetNames.length;++h)(n.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(n.SheetNames[h]);n.Props.SheetNames=f}n.Props.Worksheets=n.Props.SheetNames.length,Pt(a,o,CD(n.Props)),i.extprops.push(o),sn(e.rels,3,o,Qt.EXT_PROPS),n.Custprops!==n.Props&&ar(n.Custprops||{}).length>0&&(o="docProps/custom.xml",Pt(a,o,DD(n.Custprops)),i.custprops.push(o),sn(e.rels,4,o,Qt.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,c=1;c<=n.SheetNames.length;++c){var g={"!id":{}},m=n.Sheets[n.SheetNames[c-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+c+"."+t,Pt(a,o,Kj(c-1,e,n,g)),i.sheets.push(o),sn(e.wbrels,-1,"worksheets/sheet"+c+"."+t,Qt.WS[0])}if(m){var y=m["!comments"],b=!1,A="";if(y&&y.length>0){var w=!1;y.forEach(function(C){C[1].forEach(function(T){T.T==!0&&(w=!0)})}),w&&(A="xl/threadedComments/threadedComment"+c+".xml",Pt(a,A,jD(y,d,e)),i.threadedcomments.push(A),sn(g,-1,"../threadedComments/threadedComment"+c+".xml",Qt.TCMNT)),A="xl/comments"+c+"."+t,Pt(a,A,qH(y)),i.comments.push(A),sn(g,-1,"../comments"+c+"."+t,Qt.CMNT),b=!0}m["!legacy"]&&b&&Pt(a,"xl/drawings/vmlDrawing"+c+".vml",zD(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&Pt(a,AD(o),Gu(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+t,Pt(a,o,sH(e.Strings,e)),i.strs.push(o),sn(e.wbrels,-1,"sharedStrings."+t,Qt.SST)),o="xl/workbook."+t,Pt(a,o,mG(n)),i.workbooks.push(o),sn(e.rels,1,o,Qt.WB),o="xl/theme/theme1.xml",Pt(a,o,HD(n.Themes,e)),i.themes.push(o),sn(e.wbrels,-1,"theme/theme1.xml",Qt.THEME),o="xl/styles."+t,Pt(a,o,mH(n,e)),i.styles.push(o),sn(e.wbrels,-1,"styles."+t,Qt.STY),n.vbaraw&&r&&(o="xl/vbaProject.bin",Pt(a,o,n.vbaraw),i.vba.push(o),sn(e.wbrels,-1,"vbaProject.bin",Qt.VBA)),o="xl/metadata."+t,Pt(a,o,WH()),i.metadata.push(o),sn(e.wbrels,-1,"metadata."+t,Qt.XLMETA),d.length>1&&(o="xl/persons/person.xml",Pt(a,o,$D(d)),i.people.push(o),sn(e.wbrels,-1,"persons/person.xml",Qt.PEOPLE)),Pt(a,"[Content_Types].xml",ED(i,e)),Pt(a,"_rels/.rels",Gu(e.rels)),Pt(a,"xl/_rels/workbook."+t+".rels",Gu(e.wbrels)),delete e.revssf,delete e.ssf,a}function RV(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=Al(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function uO(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Zd(e.file,An.write(n,{type:an?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return An.write(n,e)}function NV(n,e){switch(e.bookType){case"ods":return oO(n,e);case"numbers":return EV(n,e);case"xlsb":return DV(n,e);default:return OV(n,e)}}function LV(n,e){var t=ti(e||{}),r=NV(n,t);return MV(r,t)}function MV(n,e){var t={},r=an?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=r;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=n.FullPaths?An.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(bm(i))}return e.password&&typeof encrypt_agile<"u"?uO(encrypt_agile(i,e.password),e):e.type==="file"?Zd(e.file,i):e.type=="string"?$u(i):i}function IV(n,e){var t=e||{},r=GG(n,t);return uO(r,t)}function Ta(n,e,t){t||(t="");var r=t+n;switch(e.type){case"base64":return Rg(Dd(r));case"binary":return Dd(r);case"string":return n;case"file":return Zd(e.file,r,"utf8");case"buffer":return an?Ba(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ta(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function kV(n,e){switch(e.type){case"base64":return kU(n);case"binary":return n;case"string":return n;case"file":return Zd(e.file,n,"binary");case"buffer":return an?Ba(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ig(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",r=0;r<n.length;++r)t+=String.fromCharCode(n[r]);return e.type=="base64"?Rg(t):e.type=="string"?$u(t):t;case"file":return Zd(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function fO(n,e){IU(),gG(n);var t=ti(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var r=fO(n,t);return t.type="array",bm(r)}var i=0;if(t.sheet&&(typeof t.sheet=="number"?i=t.sheet:i=n.SheetNames.indexOf(t.sheet),!n.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ta(jG(n,t),t);case"slk":case"sylk":return Ta(tH.from_sheet(n.Sheets[n.SheetNames[i]],t,n),t);case"htm":case"html":return Ta(iO(n.Sheets[n.SheetNames[i]],t),t);case"txt":return kV(hO(n.Sheets[n.SheetNames[i]],t),t);case"csv":return Ta(gy(n.Sheets[n.SheetNames[i]],t),t,"\uFEFF");case"dif":return Ta(nH.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"dbf":return ig(eH.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"prn":return Ta(rH.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"rtf":return Ta(fH(n.Sheets[n.SheetNames[i]]),t);case"eth":return Ta(kD.from_sheet(n.Sheets[n.SheetNames[i]],t),t);case"fods":return Ta(oO(n,t),t);case"wk1":return ig(ES.sheet_to_wk1(n.Sheets[n.SheetNames[i]],t),t);case"wk3":return ig(ES.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),ig(rO(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),IV(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return LV(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function FV(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function PV(n,e,t){var r=t||{};return r.type="file",r.file=e,FV(r),fO(n,r)}function BV(n,e,t,r,i,a,o){var c=yn(t),f=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,g=n["!data"]!=null,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:t,enumerable:!1})}catch{m.__rowNum__=t}else m.__rowNum__=t;if(!g||n["!data"][t])for(var v=e.s.c;v<=e.e.c;++v){var y=g?(n["!data"][t]||[])[v]:n[r[v]+c];if(y==null||y.t===void 0){if(f===void 0)continue;a[v]!=null&&(m[a[v]]=f);continue}var b=y.v;switch(y.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"b":case"n":if(!y.z||!Cc(y.z)||(b=ju(b),typeof b=="number"))break;case"d":o&&(o.UTC||o.raw===!1)||(b=of(new Date(b)));break;default:throw new Error("unrecognized type "+y.t)}if(a[v]!=null){if(b==null)if(y.t=="e"&&b===null)m[a[v]]=null;else if(f!==void 0)m[a[v]]=f;else if(h&&b===null)m[a[v]]=null;else continue;else m[a[v]]=(y.t==="n"&&typeof o.rawNumbers=="boolean"?o.rawNumbers:h)?b:Ro(y,b,o);b!=null&&(d=!1)}}return{row:m,isempty:d}}function U_(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,a=[],o=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},d=h.range!=null?h.range:n["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof d){case"string":f=Dn(d);break;case"number":f=Dn(n["!ref"]),f.s.r=d;break;default:f=d}r>0&&(i=0);var g=yn(f.s.r),m=[],v=[],y=0,b=0,A=n["!data"]!=null,w=f.s.r,C=0,T={};A&&!n["!data"][w]&&(n["!data"][w]=[]);var R=h.skipHidden&&n["!cols"]||[],N=h.skipHidden&&n["!rows"]||[];for(C=f.s.c;C<=f.e.c;++C)if(!(R[C]||{}).hidden)switch(m[C]=gn(C),t=A?n["!data"][w][C]:n[m[C]+g],r){case 1:a[C]=C-f.s.c;break;case 2:a[C]=m[C];break;case 3:a[C]=h.header[C-f.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),c=o=Ro(t,null,h),b=T[o]||0,!b)T[o]=1;else{do c=o+"_"+b++;while(T[c]);T[o]=b,T[c]=1}a[C]=c}for(w=f.s.r+i;w<=f.e.r;++w)if(!(N[w]||{}).hidden){var I=BV(n,f,w,m,r,a,h);(I.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(v[y++]=I.row)}return v.length=y,v}var kS=/"/g;function UV(n,e,t,r,i,a,o,c,f){for(var h=!0,d=[],g="",m=yn(t),v=n["!data"]!=null,y=v&&n["!data"][t]||[],b=e.s.c;b<=e.e.c;++b)if(r[b]){var A=v?y[b]:n[r[b]+m];if(A==null)g="";else if(A.v!=null){h=!1,g=""+(f.rawNumbers&&A.t=="n"?A.v:Ro(A,null,f));for(var w=0,C=0;w!==g.length;++w)if((C=g.charCodeAt(w))===i||C===a||C===34||f.forceQuotes){g='"'+g.replace(kS,'""')+'"';break}g=="ID"&&c==0&&d.length==0&&(g='"ID"')}else A.f!=null&&!A.F?(h=!1,g="="+A.f,g.indexOf(",")>=0&&(g='"'+g.replace(kS,'""')+'"')):g="";d.push(g)}if(f.strip)for(;d[d.length-1]==="";)--d.length;return f.blankrows===!1&&h?null:d.join(o)}function gy(n,e){var t=[],r=e??{};if(n==null||n["!ref"]==null)return"";for(var i=Dn(n["!ref"]),a=r.FS!==void 0?r.FS:",",o=a.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,f=c.charCodeAt(0),h="",d=[],g=r.skipHidden&&n["!cols"]||[],m=r.skipHidden&&n["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(g[v]||{}).hidden||(d[v]=gn(v));for(var y=0,b=i.s.r;b<=i.e.r;++b)(m[b]||{}).hidden||(h=UV(n,i,b,d,o,f,a,y,r),h!=null&&(h||r.blankrows!==!1)&&t.push((y++?c:"")+h));return t.join("")}function hO(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=gy(n,e);return t}function HV(n,e){var t="",r,i="";if(n==null||n["!ref"]==null)return[];var a=Dn(n["!ref"]),o="",c=[],f,h=[],d=n["!data"]!=null;for(f=a.s.c;f<=a.e.c;++f)c[f]=gn(f);for(var g=a.s.r;g<=a.e.r;++g)for(o=yn(g),f=a.s.c;f<=a.e.c;++f)if(t=c[f]+o,r=d?(n["!data"][g]||[])[f]:n[t],i="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;i=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)i=r.f;else{if(e&&e.values===!1)continue;if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)i=""+r.v;else if(r.t=="b")i=r.v?"TRUE":"FALSE";else if(r.w!==void 0)i="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?i="'"+r.v:i=""+r.v}}h[h.length]=t+"="+i}return h}function dO(n,e,t){var r=t||{},i=n?n["!data"]!=null:r.dense,a=+!r.skipHeader,o=n||{};!n&&i&&(o["!data"]=[]);var c=0,f=0;if(o&&r.origin!=null)if(typeof r.origin=="number")c=r.origin;else{var h=typeof r.origin=="string"?Mn(r.origin):r.origin;c=h.r,f=h.c}var d={s:{c:0,r:0},e:{c:f,r:c+e.length-1+a}};if(o["!ref"]){var g=Dn(o["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),c==-1&&(c=g.e.r+1,d.e.r=c+e.length-1+a)}else c==-1&&(c=0,d.e.r=e.length-1+a);var m=r.header||[],v=0,y=[];e.forEach(function(A,w){i&&!o["!data"][c+w+a]&&(o["!data"][c+w+a]=[]),i&&(y=o["!data"][c+w+a]),ar(A).forEach(function(C){(v=m.indexOf(C))==-1&&(m[v=m.length]=C);var T=A[C],R="z",N="",I=i?"":gn(f+v)+yn(c+w+a),D=i?y[f+v]:o[I];T&&typeof T=="object"&&!(T instanceof Date)?i?y[f+v]=T:o[I]=T:(typeof T=="number"?R="n":typeof T=="boolean"?R="b":typeof T=="string"?R="s":T instanceof Date?(R="d",r.UTC||(T=Sm(T)),r.cellDates||(R="n",T=Pr(T)),N=D!=null&&D.z&&Cc(D.z)?D.z:r.dateNF||Cn[14]):T===null&&r.nullError&&(R="e",T=0),D?(D.t=R,D.v=T,delete D.w,delete D.R,N&&(D.z=N)):i?y[f+v]=D={t:R,v:T}:o[I]=D={t:R,v:T},N&&(D.z=N))})}),d.e.c=Math.max(d.e.c,f+m.length-1);var b=yn(c);if(i&&!o["!data"][c]&&(o["!data"][c]=[]),a)for(v=0;v<m.length;++v)i?o["!data"][c][v+f]={t:"s",v:m[v]}:o[gn(v+f)+b]={t:"s",v:m[v]};return o["!ref"]=or(d),o}function zV(n,e){return dO(null,n,e)}function Xg(n,e,t){if(typeof e=="string"){if(n["!data"]!=null){var r=Mn(e);return n["!data"][r.r]||(n["!data"][r.r]=[]),n["!data"][r.r][r.c]||(n["!data"][r.r][r.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?Xg(n,Pn(e)):Xg(n,gn(t||0)+yn(e))}function jV(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function $V(n,e){var t={SheetNames:[],Sheets:{}};return n&&my(t,n,e||"Sheet1"),t}function my(n,e,t,r){var i=1;if(!t)for(;i<=65535&&n.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(t)>=0&&t.length<32){var a=t.match(/\d+$/);i=a&&+a[0]||0;var o=a&&t.slice(0,a.index)||t;for(++i;i<=65535&&n.SheetNames.indexOf(t=o+i)!=-1;++i);}if(eO(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function GV(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=jV(n,e);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[r].Hidden=t}function VV(n,e){return n.z=e,n}function pO(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function WV(n,e,t){return pO(n,"#"+e,t)}function XV(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function YV(n,e,t,r){for(var i=typeof e!="string"?e:Dn(e),a=typeof e=="string"?e:or(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var f=Xg(n,o,c);f.t="n",f.F=a,delete f.v,o==i.s.r&&c==i.s.c&&(f.f=t,r&&(f.D=!0))}var h=Fr(n["!ref"]);return h.s.r>i.s.r&&(h.s.r=i.s.r),h.s.c>i.s.c&&(h.s.c=i.s.c),h.e.r<i.e.r&&(h.e.r=i.e.r),h.e.c<i.e.c&&(h.e.c=i.e.c),n["!ref"]=or(h),n}var o_={encode_col:gn,encode_row:yn,encode_cell:Pn,encode_range:or,decode_col:ay,decode_row:sy,split_cell:$7,decode_cell:Mn,decode_range:Fr,format_cell:Ro,sheet_new:G7,sheet_add_aoa:mD,sheet_add_json:dO,sheet_add_dom:sO,aoa_to_sheet:xf,json_to_sheet:zV,table_to_sheet:aO,table_to_book:dV,sheet_to_csv:gy,sheet_to_txt:hO,sheet_to_json:U_,sheet_to_html:iO,sheet_to_formulae:HV,sheet_to_row_object_array:U_,sheet_get_cell:Xg,book_new:$V,book_append_sheet:my,book_set_sheet_visibility:GV,cell_set_number_format:VV,cell_set_hyperlink:pO,cell_set_internal_link:WV,cell_add_comment:XV,sheet_set_array_formula:YV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const qV=({extractedTexts:n})=>{const e=n.length>0?Object.keys(n[0]).filter(a=>a!=="pageNumber"):[],t=()=>{const a=JSON.stringify(n,null,2),o=new Blob([a],{type:"application/json"}),c=URL.createObjectURL(o),f=document.createElement("a");f.href=c,f.download="dados-extraidos.json",f.click(),URL.revokeObjectURL(c)},r=()=>{const a=["Pgina",...e],o=n.map(v=>{const y=[v.pageNumber];return e.forEach(b=>{const A=v[b];Array.isArray(A)?y.push(A.join("; ")):y.push(A||"")}),y}),h="\uFEFF"+[a,...o].map(v=>v.map(y=>`"${y}"`).join(",")).join(`
`),d=new Blob([h],{type:"text/csv;charset=utf-8;"}),g=URL.createObjectURL(d),m=document.createElement("a");m.href=g,m.download="dados-extraidos.csv",m.click(),URL.revokeObjectURL(g)},i=()=>{const a=n.map(f=>{const h={Pgina:f.pageNumber};return e.forEach(d=>{const g=f[d];Array.isArray(g)?h[d]=g.join("; "):h[d]=g||""}),h});var o=o_.json_to_sheet(a),c=o_.book_new();o_.book_append_sheet(c,o,"Dados extrados"),PV(c,"dados-pdf.xlsx")};return K.jsx("div",{className:"data-panel mt-5",children:!n||n.length<=0?K.jsx("div",{children:K.jsx("p",{className:"text-muted",children:"Os dados extrados sero exibidos aqui"})}):K.jsxs(K.Fragment,{children:[K.jsx("h5",{className:"mb-3 pb-2 border-bottom",children:"Dados Extrados"}),K.jsx("div",{className:"data-table mb-3",style:{maxHeight:"65vh",overflowY:"auto"},children:K.jsxs("table",{className:"table table-hover",children:[K.jsx("thead",{children:K.jsxs("tr",{children:[K.jsx("th",{scope:"col",style:{minWidth:"100px"},children:"#"}),e.map((a,o)=>K.jsx("th",{scope:"col",style:{minWidth:"100px"},children:a.toString()},`coluna${o}`))]})}),K.jsx("tbody",{children:n.map((a,o)=>K.jsxs("tr",{children:[K.jsx("th",{scope:"row",children:a.pageNumber}),e.map((c,f)=>{const h=a[c];return K.jsx("td",{children:h&&Array.isArray(h)?h.join(", "):h?h.toString():"-"},`area-${f}`)})]},`coluna-pag-${o}`))})]})}),K.jsx("hr",{className:"mt-3"}),K.jsx("h6",{className:"mb-3 text-start ms-3",children:"Exportar"}),K.jsxs("div",{className:"d-flex justify-content-start",children:[K.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:t,children:[K.jsx(ad,{className:"me-1",size:16}),"JSON"]}),K.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:r,children:[K.jsx(ad,{className:"me-1",size:16}),"CSV"]}),K.jsxs("button",{className:"menu-btn menu-btn-export ms-2",onClick:i,children:[K.jsx(ad,{className:"me-1",size:16}),"Excel"]})]})]})})};function KV(){const n=le.useRef(null),[e,t]=le.useState(null),[r,i]=le.useState([]),[a,o]=le.useState([]),[c,f]=le.useState(!1),[h,d]=le.useState(null),g=()=>{if(a.length>=10){alert("Limite de 10 reas atingido");return}o(D=>wU(D))},m=D=>{o(B=>SU(B,D))},v=(D,B)=>{o(U=>TU(U,D,B))},y=D=>{o(B=>CU(B,D))},b=D=>{d(D),f(!0)},A=D=>{h&&o(B=>DU(B,h,D)),f(!1),d(null)},w=async()=>{const D=n.current?.getDocument();if(!D)return;const B=await LU(a,D);i(B)},C=D=>{o(D)},T=()=>{f(!1),d(null)};le.useEffect(()=>{const D=U=>{U.key==="Escape"&&c&&T()},B=U=>{const Y=document.querySelector(".pdf-container");c&&!Y?.contains(U.target)&&T()};return document.addEventListener("keydown",D),document.addEventListener("mousedown",B),()=>{document.removeEventListener("keydown",D),document.removeEventListener("mousedown",B)}},[c]);const R=D=>{if(!D.destination)return;const B=D.source.index,U=D.destination.index;if(B===U)return;const Y=Array.from(a),[W]=Y.splice(B,1);Y.splice(U,0,W);const re=Y.map((Te,Fe)=>({...Te,order:Fe+1}));o(re)},N=(D,B)=>{o(a.map(U=>U.id===D?{...U,isMandatory:B}:U))},I=(D,B)=>{o(a.map(U=>U.id===D?{...U,type:B}:U))};return K.jsxs(K.Fragment,{children:[c&&K.jsx("div",{className:"selection-mode-overlay"}),K.jsx("div",{className:"container-fluid text-center px-xl-5",children:K.jsxs("div",{className:"row justify-content-center",children:[K.jsx("div",{className:"col-12 col-lg-6 col-xxl-3 col-xxxl-4",style:{maxWidth:"450px",minWidth:"300px"},children:K.jsx(NU,{children:K.jsx(AU,{onFileSelect:t,onExtractTexts:w,onStartAreaSelection:b,onClearArea:y,onDeleteArea:m,onRenameArea:v,onAddNewArea:g,onLoadPreset:C,onDragEnd:R,onToggleMandatory:N,onChangeAreaType:I,areas:a,hasFile:!!e})})}),K.jsx("div",{className:"col-12 col-lg-6 col-xxl-5 col-xxxl-4",children:K.jsx(eP,{ref:n,file:e,isSelectingActive:c,activeAreaId:h,onFinishSelection:A,areas:a})}),K.jsx("div",{className:"col-12 col-lg-6 col-xxl-4 col-xxxl-4",children:K.jsx(qV,{extractedTexts:r})})]})})]})}function QV(){return K.jsx("div",{children:K.jsx(KV,{})})}OR.createRoot(document.getElementById("root")).render(K.jsx(le.StrictMode,{children:K.jsx(QV,{})}));
